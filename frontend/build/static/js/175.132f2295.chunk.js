"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[175],{1175:(e,t,r)=>{r.r(t),r.d(t,{default:()=>me});var a=r(5043),s=r(2903),n=r(4117),o=r(2672),l=r(8018),i=r(2760),d=r(5648),c=r(7855),u=r(1801),m=r(1923),g=r(7488),x=r(8421),h=r(5989),p=r(6009),b=r(2013),y=r(6693),f=r(6159),w=r(1816),v=r(2453),j=r(9422),N=r(9379),k=r(1292),A=r(7353),S=r(4493),R=r(5620),D=r(579);const E={taskCreate:!0,taskUpdate:!0,taskDelete:!0,taskStatusChange:!0,requestCreate:!0,requestUpdate:!0,requestDelete:!0,requestStatusChange:!0,userCreate:!0,userUpdate:!0,userDelete:!0,roleCreate:!0,roleUpdate:!0,roleDelete:!0,worktimeStart:!0,worktimeStop:!0},C={task:["taskCreate","taskUpdate","taskDelete","taskStatusChange"],request:["requestCreate","requestUpdate","requestDelete","requestStatusChange"],user:["userCreate","userUpdate","userDelete"],role:["roleCreate","roleUpdate","roleDelete"],worktime:["worktimeStart","worktimeStop"]},M=()=>{const{t:e}=(0,n.Bd)(),[t,r]=(0,a.useState)(E),[s,o]=(0,a.useState)(!0),[i,d]=(0,a.useState)(!1),{showMessage:u}=(0,c.A)();(0,a.useEffect)((()=>{m()}),[]);const m=async()=>{try{o(!0),l.v.log("Starte Abruf der Benachrichtigungseinstellungen...");const e=await R.f.getUserSettings();if(l.v.log("Erhaltene Einstellungen:",e.data),null!==e&&void 0!==e&&e.data){const t=(0,N.A)((0,N.A)({},E),e.data);r(t),l.v.log("Einstellungen aktualisiert:",t)}else console.warn("Keine Daten vom Server erhalten, verwende Standardeinstellungen"),r(E)}catch(t){console.error("Fehler beim Laden der Benachrichtigungseinstellungen:",t),r(E),u(e("notifications.loadSettingsError"),"error")}finally{o(!1)}},g=async a=>{const{name:s,checked:n}=a.target,o=(0,N.A)((0,N.A)({},t),{},{[s]:n});r(o);try{d(!0),await R.f.updateUserSettings(o),u(e("notifications.saveSuccess"),"success")}catch(l){console.error("Fehler beim Speichern der Einstellungen:",l),u(e("notifications.saveError"),"error"),r(t)}finally{d(!1)}},x=e=>{const r=e.toLowerCase();return!!C[r]&&C[r].every((e=>!0===t[e]))},h=e=>{let{checked:t,onChange:r,name:a,label:s,description:n}=e;return(0,D.jsxs)("div",{className:"flex items-center justify-between gap-8 group relative",children:[(0,D.jsx)("div",{className:"flex-1",children:(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:s})}),(0,D.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer flex-shrink-0",children:[(0,D.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:t,onChange:r,name:a}),(0,D.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]}),n&&(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:n})]})},p=(a,s)=>(0,D.jsxs)("div",{className:"mb-6 mt-2",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsx)("div",{children:(0,D.jsx)("h3",{className:"text-lg font-medium dark:text-white",children:a})}),(0,D.jsx)(h,{checked:x(a),onChange:s=>(async(a,s)=>{const n=a.toLowerCase();if(!C[n])return;const o=(0,N.A)({},t);C[n].forEach((e=>{o[e]=s})),r(o);try{d(!0),await R.f.updateUserSettings(o),u(e("notifications.saveSuccess"),"success")}catch(l){console.error("Fehler beim Speichern der Einstellungen:",l),u(e("notifications.saveError"),"error"),r(t)}finally{d(!1)}})(a,s.target.checked),name:"".concat(a.toLowerCase(),"All"),label:e("notifications.all")})]}),(0,D.jsx)("div",{className:"space-y-4",children:s.map((e=>{let{name:r,label:a,description:s}=e;return(0,D.jsx)(h,{checked:t[r],onChange:g,name:r,label:a,description:s},r)}))})]});return s?(0,D.jsx)(k.A,{children:e("notifications.loading")}):(0,D.jsxs)(A.A,{className:"p-4",children:[(0,D.jsx)(k.A,{variant:"body2",className:"text-gray-600 dark:text-gray-400 mb-6",children:e("notifications.description")}),(0,D.jsx)("div",{className:"mb-8 mt-2",children:(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsxs)("div",{className:"group relative",children:[(0,D.jsx)("h3",{className:"text-lg font-medium dark:text-white",children:e("notifications.allNotifications")}),(0,D.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e("notifications.allNotificationsDescription")}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("notifications.allNotificationsDescription")})]}),(0,D.jsx)(h,{checked:!!t&&Object.values(t).every((e=>!0===e)),onChange:a=>(async a=>{const s=Object.keys(t).reduce(((e,t)=>(e[t]=a,e)),(0,N.A)({},E));r(s);try{d(!0),await R.f.updateUserSettings(s),u(e("notifications.saveSuccess"),"success")}catch(n){console.error("Fehler beim Speichern der Einstellungen:",n),u(e("notifications.saveError"),"error"),r(t)}finally{d(!1)}})(a.target.checked),name:"allNotifications",label:""})]})}),(0,D.jsx)(S.A,{className:"my-8"}),p(e("notifications.categories.tasks"),[{name:"taskCreate",label:e("notifications.events.taskCreate"),description:e("notifications.events.taskCreateDescription")},{name:"taskUpdate",label:e("notifications.events.taskUpdate"),description:e("notifications.events.taskUpdateDescription")},{name:"taskDelete",label:e("notifications.events.taskDelete"),description:e("notifications.events.taskDeleteDescription")},{name:"taskStatusChange",label:e("notifications.events.taskStatusChange"),description:e("notifications.events.taskStatusChangeDescription")}]),(0,D.jsx)(S.A,{className:"my-8"}),p(e("notifications.categories.requests"),[{name:"requestCreate",label:e("notifications.events.requestCreate"),description:e("notifications.events.requestCreateDescription")},{name:"requestUpdate",label:e("notifications.events.requestUpdate"),description:e("notifications.events.requestUpdateDescription")},{name:"requestDelete",label:e("notifications.events.requestDelete"),description:e("notifications.events.requestDeleteDescription")},{name:"requestStatusChange",label:e("notifications.events.requestStatusChange"),description:e("notifications.events.requestStatusChangeDescription")}]),(0,D.jsx)(S.A,{className:"my-8"}),p(e("notifications.categories.usersAndRoles"),[{name:"userCreate",label:e("notifications.events.userCreate"),description:e("notifications.events.userCreateDescription")},{name:"userUpdate",label:e("notifications.events.userUpdate"),description:e("notifications.events.userUpdateDescription")},{name:"userDelete",label:e("notifications.events.userDelete"),description:e("notifications.events.userDeleteDescription")},{name:"roleCreate",label:e("notifications.events.roleCreate"),description:e("notifications.events.roleCreateDescription")},{name:"roleUpdate",label:e("notifications.events.roleUpdate"),description:e("notifications.events.roleUpdateDescription")},{name:"roleDelete",label:e("notifications.events.roleDelete"),description:e("notifications.events.roleDeleteDescription")}]),(0,D.jsx)(S.A,{className:"my-8"}),p(e("notifications.categories.worktime"),[{name:"worktimeStart",label:e("notifications.events.worktimeStart"),description:e("notifications.events.worktimeStartDescription")},{name:"worktimeStop",label:e("notifications.events.worktimeStop"),description:e("notifications.events.worktimeStopDescription")}])]})};var P=r(6443),T=r(7591);const _=e=>{let{isOpen:t,onClose:r,onSave:s,currentSettings:o}=e;const{t:l}=(0,n.Bd)(),[i,d]=(0,a.useState)({monthlyReportEnabled:!0,monthlyReportDay:o.monthlyReportDay||25,monthlyReportRecipient:o.monthlyReportRecipient||""}),[c,u]=(0,a.useState)(!1),[m,x]=(0,a.useState)({}),h=()=>{d({monthlyReportEnabled:!0,monthlyReportDay:o.monthlyReportDay||25,monthlyReportRecipient:o.monthlyReportRecipient||""}),x({}),r()},p=(e,t)=>{d((r=>(0,N.A)((0,N.A)({},r),{},{[e]:t}))),m[e]&&x((t=>(0,N.A)((0,N.A)({},t),{},{[e]:""})))};return(0,D.jsxs)(P.lG,{open:t,onClose:h,className:"relative z-50",children:[(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,D.jsx)(P.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:(0,D.jsxs)("div",{className:"p-6",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,D.jsx)(P.lG.Title,{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Automatische Monatsabrechnung einrichten"}),(0,D.jsx)("button",{onClick:h,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",children:(0,D.jsx)(T.A,{className:"h-6 w-6"})})]}),(0,D.jsx)("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:(0,D.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"Konfigurieren Sie die automatische Generierung von monatlichen Beratungsabrechnungen. Diese werden automatisch am gew\xe4hlten Tag des Monats erstellt und an den angegebenen Empf\xe4nger adressiert."})}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"monthlyReportDay",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Abrechnungstag im Monat"}),(0,D.jsx)("select",{id:"monthlyReportDay",className:"mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ".concat(m.monthlyReportDay?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"),value:i.monthlyReportDay,onChange:e=>p("monthlyReportDay",parseInt(e.target.value)),children:Array.from({length:28},((e,t)=>t+1)).map((e=>(0,D.jsxs)("option",{value:e,children:[e,"."]},e)))}),m.monthlyReportDay&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:m.monthlyReportDay}),(0,D.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Tag im Monat, an dem die Abrechnung automatisch erstellt wird (1-28)"})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{htmlFor:"monthlyReportRecipient",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[l("monthlyReport.recipient")," *"]}),(0,D.jsx)("textarea",{id:"monthlyReportRecipient",rows:3,className:"mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ".concat(m.monthlyReportRecipient?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"),value:i.monthlyReportRecipient,onChange:e=>p("monthlyReportRecipient",e.target.value),placeholder:l("monthlyReport.recipientPlaceholder")}),m.monthlyReportRecipient&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:m.monthlyReportRecipient}),(0,D.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Vollst\xe4ndige Adresse des Empf\xe4ngers (Arbeitgeber) f\xfcr die monatliche Abrechnung"})]})]}),i.monthlyReportRecipient.trim()&&(0,D.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[(0,D.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Vorschau:"}),(0,D.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,D.jsxs)("p",{children:["\ud83d\udcc5 ",(0,D.jsx)("strong",{children:"Abrechnungszeitraum:"})," ",i.monthlyReportDay,". des Vormonats bis ",i.monthlyReportDay-1,". des aktuellen Monats"]}),(0,D.jsxs)("p",{className:"mt-1",children:["\ud83d\udce7 ",(0,D.jsx)("strong",{children:"Empf\xe4nger:"})]}),(0,D.jsx)("div",{className:"ml-4 mt-1 font-mono text-xs bg-white dark:bg-gray-800 p-2 rounded border",children:i.monthlyReportRecipient.split("\n").map(((e,t)=>(0,D.jsx)("div",{children:e},t)))})]})]}),(0,D.jsxs)("div",{className:"mt-6 flex items-center justify-end space-x-3",children:[(0,D.jsx)("button",{type:"button",onClick:h,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:l("common.cancel"),children:(0,D.jsx)(T.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{onClick:async()=>{if((()=>{const e={};return i.monthlyReportRecipient.trim()||(e.monthlyReportRecipient=l("monthlyReport.recipientRequired")),(i.monthlyReportDay<1||i.monthlyReportDay>28)&&(e.monthlyReportDay="Abrechnungstag muss zwischen 1 und 28 liegen"),x(e),0===Object.keys(e).length})())try{u(!0),await s(i),g.oR.success(l("monthlyReport.saveSuccess")),r()}catch(e){g.oR.error(l("monthlyReport.saveError"))}finally{u(!1)}},disabled:c||!i.monthlyReportRecipient.trim(),className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:c?"Speichere...":"Aktivieren",children:c?(0,D.jsx)(w.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(j.A,{className:"h-5 w-5"})})]})]})})})]})};var U=r(9399),L=r(9248),I=r(4538),F=r(2704),O=r(7012),q=r(3641);const B=()=>{var e;const{t:t}=(0,n.Bd)(),{user:r}=(0,o.As)(),[s,l]=(0,a.useState)([]),[i,d]=(0,a.useState)([]),[c,x]=(0,a.useState)(!1),[h,p]=(0,a.useState)(!1),b=e=>t("database.tables.".concat(e,".description"),{defaultValue:""}),[y,f]=(0,a.useState)(null),[v,j]=(0,a.useState)(""),[N,k]=(0,a.useState)(!1),[A,S]=(0,a.useState)(0),[R,E]=(0,a.useState)(""),[C,M]=(0,a.useState)(!1),[P,T]=(0,a.useState)(0);(0,a.useEffect)((()=>{_(),B()}),[]),(0,a.useEffect)((()=>{if(A>0){const e=setTimeout((()=>S(A-1)),1e3);return()=>clearTimeout(e)}}),[A]),(0,a.useEffect)((()=>{if(P>0){const e=setTimeout((()=>T(P-1)),1e3);return()=>clearTimeout(e)}}),[P]);const _=async()=>{try{const e=await m.A.get(u.Sn.DATABASE.TABLES);l(e.data)}catch(e){console.error("Fehler beim Laden der Tabellen:",e),g.oR.error(t("database.loadTablesError"))}},B=async()=>{try{p(!0);const e=await m.A.get(u.Sn.DATABASE.LOGS);d(e.data)}catch(e){console.error(t("database.loadLogsError"),e)}finally{p(!1)}},z=()=>{M(!0),T(5)},V=e=>{switch(e){case"low":return"text-yellow-600 bg-yellow-50 border-yellow-200 dark:text-yellow-400 dark:bg-yellow-900/20 dark:border-yellow-700";case"medium":return"text-orange-600 bg-orange-50 border-orange-200 dark:text-orange-400 dark:bg-orange-900/20 dark:border-orange-700";case"high":return"text-red-600 bg-red-50 border-red-200 dark:text-red-400 dark:bg-red-900/20 dark:border-red-700";default:return"text-gray-600 bg-gray-50 border-gray-200 dark:text-gray-400 dark:bg-gray-700 dark:border-gray-600"}},W=e=>{switch(e){case"success":return"text-green-600 dark:text-green-400";case"error":return"text-red-600 dark:text-red-400";case"start":return"text-blue-600 dark:text-blue-400";default:return"text-gray-600 dark:text-gray-400"}};return r&&r.roles.some((e=>"Admin"===e.role.name))?(0,D.jsxs)("div",{className:"space-y-8",children:[(0,D.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6",children:(0,D.jsxs)("div",{className:"flex items-start",children:[(0,D.jsx)(U.A,{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400 mr-3 mt-1"}),(0,D.jsxs)("div",{children:[(0,D.jsx)("h3",{className:"text-lg font-medium text-yellow-800 dark:text-yellow-200 mb-2",children:t("database.warningTitle")}),(0,D.jsxs)("ul",{className:"text-yellow-700 dark:text-yellow-300 text-sm space-y-1",children:[(0,D.jsxs)("li",{children:["\u2022 ",t("database.warning1")]}),(0,D.jsxs)("li",{children:["\u2022 ",t("database.warning2")]}),(0,D.jsxs)("li",{children:["\u2022 ",t("database.warning3")]}),(0,D.jsxs)("li",{children:["\u2022 ",t("database.warning4")]})]})]})]})}),(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6",children:[(0,D.jsxs)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4 flex items-center",children:[(0,D.jsx)(L.A,{className:"h-5 w-5 mr-2"}),t("database.resetTablesTitle")]}),(0,D.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map((e=>{return(0,D.jsxs)("div",{className:"border rounded-lg p-4 ".concat(V(e.danger)),children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,D.jsx)("h4",{className:"font-medium",children:(r=e.name,t("database.tables.".concat(r,".displayName"),{defaultValue:r}))}),(0,D.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat("high"===e.danger?"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300":"medium"===e.danger?"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300"),children:"high"===e.danger?t("database.danger.high"):"medium"===e.danger?t("database.danger.medium"):t("database.danger.low")})]}),(0,D.jsx)("p",{className:"text-sm mb-3",children:b(e.name)||e.description}),(0,D.jsxs)("div",{className:"flex items-center text-sm mb-3",children:[(0,D.jsx)(I.A,{className:"h-4 w-4 mr-1"}),t("database.seedDataRestored")]}),(0,D.jsxs)("div",{className:"space-y-2",children:["client"===e.name&&(0,D.jsx)("button",{onClick:z,disabled:c,className:"w-full p-2 bg-orange-600 text-white rounded hover:bg-orange-700 disabled:opacity-50 transition-colors flex items-center justify-center",title:t("database.deleteDemoClients"),children:(0,D.jsx)(L.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{onClick:()=>(e=>{f(e),k(!0),S(5)})(e.name),disabled:c,className:"w-full p-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50 transition-colors flex items-center justify-center",title:t("database.resetAndRefill"),children:(0,D.jsx)(w.A,{className:"h-5 w-5"})})]})]},e.name);var r}))})]}),(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsxs)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center",children:[(0,D.jsx)(F.A,{className:"h-5 w-5 mr-2"}),t("database.operationsTitle")]}),(0,D.jsx)("button",{onClick:B,disabled:h,className:"p-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 transition-colors",title:t("common.refresh"),children:(0,D.jsx)(w.A,{className:"h-5 w-5"})})]}),h?(0,D.jsx)("div",{className:"text-center py-4",children:t("database.loadingLogs")}):0===i.length?(0,D.jsx)("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:t("database.noLogsAvailable")}):(0,D.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:i.map(((e,r)=>(0,D.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded text-sm",children:[(0,D.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,D.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:new Date(e.timestamp).toLocaleString()}),(0,D.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.operation}),(0,D.jsxs)("span",{className:"font-medium ".concat(W(e.status)),children:["success"===e.status?"\u2713":"error"===e.status?"\u2717":"\u2022"," ",t("database.logStatus.".concat(e.status))]})]}),e.error&&(0,D.jsx)("span",{className:"text-red-600 dark:text-red-400 text-xs max-w-xs truncate",children:e.error})]},r)))})]}),N&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[(0,D.jsxs)("div",{className:"flex items-center mb-4",children:[(0,D.jsx)(U.A,{className:"h-6 w-6 text-orange-600 mr-2"}),(0,D.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t("database.confirmResetTitle")})]}),(0,D.jsxs)("div",{className:"mb-4",children:[(0,D.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-2",children:t("database.confirmResetMessage",{tableName:null===(e=s.find((e=>e.name===y)))||void 0===e?void 0:e.displayName})}),(0,D.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:t("database.confirmResetWarning")}),A>0&&(0,D.jsxs)("div",{className:"flex items-center text-orange-600 dark:text-orange-400 mb-3",children:[(0,D.jsx)(O.A,{className:"h-4 w-4 mr-1"}),t("database.reflectionTime",{seconds:A})]})]}),(0,D.jsxs)("div",{className:"mb-4",children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,D.jsx)(q.A,{className:"h-4 w-4 inline mr-1"}),t("database.adminPasswordLabel")]}),(0,D.jsx)("input",{type:"password",value:v,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:t("database.adminPasswordPlaceholder")})]}),(0,D.jsxs)("div",{className:"flex space-x-3",children:[(0,D.jsx)("button",{onClick:async()=>{if(y&&v)if(A>0)g.oR.error(t("database.waitSeconds",{seconds:A}));else try{x(!0),await m.A.post(u.Sn.DATABASE.RESET_TABLE,{tableName:y,adminPassword:v}),g.oR.success(t("database.resetTableSuccess",{tableName:y})),k(!1),f(null),j(""),B()}catch(a){var e,r;g.oR.error((null===(e=a.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||t("database.resetTableError"))}finally{x(!1)}else g.oR.error(t("database.passwordRequired"))},disabled:c||A>0||!v,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded hover:bg-orange-700 disabled:opacity-50 transition-colors",children:t(c?"database.resetting":"common.confirm")}),(0,D.jsx)("button",{onClick:()=>{k(!1),f(null),j(""),S(0)},disabled:c,className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors",children:t("common.cancel")})]})]})}),C&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[(0,D.jsxs)("div",{className:"flex items-center mb-4",children:[(0,D.jsx)(U.A,{className:"h-6 w-6 text-orange-600 mr-2"}),(0,D.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t("database.confirmDeleteDemoClientsTitle")})]}),(0,D.jsxs)("div",{className:"mb-4",children:[(0,D.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-2",children:t("database.confirmDeleteDemoClientsMessage")}),(0,D.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:t("database.confirmDeleteDemoClientsWarning")}),P>0&&(0,D.jsxs)("div",{className:"flex items-center text-orange-600 dark:text-orange-400 mb-3",children:[(0,D.jsx)(O.A,{className:"h-4 w-4 mr-1"}),t("database.reflectionTime",{seconds:P})]})]}),(0,D.jsxs)("div",{className:"mb-4",children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,D.jsx)(q.A,{className:"h-4 w-4 inline mr-1"}),t("database.adminPasswordLabel")]}),(0,D.jsx)("input",{type:"password",value:R,onChange:e=>E(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:t("database.adminPasswordPlaceholder")})]}),(0,D.jsxs)("div",{className:"flex space-x-3",children:[(0,D.jsx)("button",{onClick:async()=>{if(R)if(P>0)g.oR.error(t("database.waitSeconds",{seconds:P}));else try{x(!0);await m.A.post(u.Sn.DATABASE.DELETE_DEMO_CLIENTS,{adminPassword:R});g.oR.success(t("database.deleteDemoClientsSuccess")),M(!1),E(""),B()}catch(a){var e,r;g.oR.error((null===(e=a.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||t("database.deleteDemoClientsError"))}finally{x(!1)}else g.oR.error(t("database.passwordRequired"))},disabled:c||P>0||!R,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded hover:bg-orange-700 disabled:opacity-50 transition-colors",children:t(c?"database.deleting":"common.confirm")}),(0,D.jsx)("button",{onClick:()=>{M(!1),E(""),T(0)},disabled:c,className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors",children:t("common.cancel")})]})]})})]}):(0,D.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6 text-center",children:[(0,D.jsx)(U.A,{className:"h-12 w-12 text-red-600 dark:text-red-400 mx-auto mb-4"}),(0,D.jsx)("p",{className:"text-red-800 dark:text-red-200 font-medium",children:t("database.noPermission")}),(0,D.jsx)("p",{className:"text-red-600 dark:text-red-400 text-sm mt-2",children:t("database.adminOnly")})]})};var z=r(8662),V=r(8010),W=r(9670),G=r(4832),H=r(9531),Y=r(6940),K=r(8153),$=r(2811);const Z="/password-manager",J={getAll:async()=>(await m.A.get(Z)).data,getById:async e=>(await m.A.get(u.Sn.PASSWORD_MANAGER.BY_ID(e))).data,getPassword:async e=>(await m.A.get(u.Sn.PASSWORD_MANAGER.PASSWORD(e))).data,create:async e=>(await m.A.post(Z,e)).data,update:async(e,t)=>(await m.A.put(u.Sn.PASSWORD_MANAGER.BY_ID(e),t)).data,async delete(e){await m.A.delete(u.Sn.PASSWORD_MANAGER.BY_ID(e))},async generatePassword(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await m.A.post(u.Sn.PASSWORD_MANAGER.GENERATE_PASSWORD,e)).data},getAuditLogs:async e=>(await m.A.get(u.Sn.PASSWORD_MANAGER.AUDIT_LOGS(e))).data,getPermissions:async e=>(await m.A.get(u.Sn.PASSWORD_MANAGER.PERMISSIONS(e))).data,async updatePermissions(e,t){await m.A.put(u.Sn.PASSWORD_MANAGER.PERMISSIONS(e),t)},async logPasswordCopy(e){await m.A.post(u.Sn.PASSWORD_MANAGER.COPY_PASSWORD(e))}};var Q=r(5657);const X=e=>{let{isOpen:t,onClose:r,entry:s,onEntrySaved:o}=e;const{t:l}=(0,n.Bd)(),{openSidepane:i,closeSidepane:d}=(0,Q.N)(),[c,u]=(0,a.useState)(window.innerWidth<640),[m,x]=(0,a.useState)(window.innerWidth>1070),[h,p]=(0,a.useState)(""),[b,f]=(0,a.useState)(""),[v,N]=(0,a.useState)(""),[k,A]=(0,a.useState)(""),[S,R]=(0,a.useState)(""),[E,C]=(0,a.useState)(!1),[M,_]=(0,a.useState)(null),[U,L]=(0,a.useState)(!1),[I,F]=(0,a.useState)(!1),[O,q]=(0,a.useState)(null);(0,a.useEffect)((()=>{const e=()=>{u(window.innerWidth<640),x(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,a.useEffect)((()=>(t?i():d(),()=>{d()})),[t,i,d]),(0,a.useEffect)((()=>{t&&(s?(p(s.title||""),f(s.url||""),N(s.username||""),A(s.password||""),R(s.notes||""),C(!1)):(p(""),f(""),N(""),A(""),R(""),C(!1)),_(null),q(null))}),[t,s]),(0,a.useEffect)((()=>{k?B(k):q(null)}),[k]);const B=e=>{let t=0;e.length>=8&&t++,e.length>=12&&t++,e.length>=16&&t++,/[a-z]/.test(e)&&t++,/[A-Z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[^a-zA-Z0-9]/.test(e)&&t++,q(t<=2?"weak":t<=4?"medium":t<=6?"strong":"veryStrong")},z=()=>{switch(O){case"weak":return"bg-red-500";case"medium":return"bg-yellow-500";case"strong":return"bg-blue-500";case"veryStrong":return"bg-green-500";default:return"bg-gray-300"}},V=()=>{switch(O){case"weak":return l("passwordManager.passwordStrengthWeak");case"medium":return l("passwordManager.passwordStrengthMedium");case"strong":return l("passwordManager.passwordStrengthStrong");case"veryStrong":return l("passwordManager.passwordStrengthVeryStrong");default:return""}},W=async()=>{try{F(!0);const e=await J.generatePassword({length:16,includeNumbers:!0,includeSymbols:!0});A(e.password),C(!0)}catch(M){console.error("Error generating password:",M),g.oR.error(l("passwordManager.error")||"Fehler beim Generieren des Passworts")}finally{F(!1)}},Y=async e=>{e.preventDefault(),_(null),L(!0);try{if(!h.trim())return _(l("passwordManager.titleRequired")),void L(!1);if(!k.trim())return _(l("passwordManager.passwordRequired")),void L(!1);if(b&&!(e=>{if(!e)return!0;try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(t){return!1}})(b))return _(l("passwordManager.urlInvalid")),void L(!1);if(s){const e={title:h.trim(),url:b.trim()||void 0,username:v.trim()||void 0,password:k.trim(),notes:S.trim()||void 0},t=await J.update(s.id,e);o(t),g.oR.success(l("passwordManager.editEntry")||"Eintrag erfolgreich aktualisiert")}else{const e={title:h.trim(),url:b.trim()||void 0,username:v.trim()||void 0,password:k.trim(),notes:S.trim()||void 0},t=await J.create(e);o(t),g.oR.success(l("passwordManager.createEntry")||"Eintrag erfolgreich erstellt")}K()}catch(M){var t,r;console.error("Error saving password entry:",M),_((null===(t=M.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||M.message||l("passwordManager.error"))}finally{L(!1)}},K=()=>{p(""),f(""),N(""),A(""),R(""),C(!1),_(null),q(null),r()};return c?(0,D.jsxs)(P.lG,{open:t,onClose:K,className:"relative z-50",children:[(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,D.jsxs)(P.lG.Panel,{className:"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] flex flex-col",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)(P.lG.Title,{className:"text-lg font-semibold dark:text-white",children:l(s?"passwordManager.editEntry":"passwordManager.createEntry")}),(0,D.jsx)("button",{onClick:K,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(T.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[M&&(0,D.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:M}),(0,D.jsxs)("form",{onSubmit:Y,className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[l("passwordManager.entryTitle")," *"]}),(0,D.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:l("passwordManager.entryUrl")}),(0,D.jsx)("input",{type:"url",value:b,onChange:e=>f(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"https://example.com"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:l("passwordManager.entryUsername")}),(0,D.jsx)("input",{type:"text",value:v,onChange:e=>N(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[l("passwordManager.entryPassword")," *"]}),(0,D.jsxs)("div",{className:"mt-1 flex gap-2",children:[(0,D.jsxs)("div",{className:"flex-1 relative",children:[(0,D.jsx)("input",{type:E?"text":"password",value:k,onChange:e=>A(e.target.value),className:"block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 pr-10 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0}),(0,D.jsx)("button",{type:"button",onClick:()=>C(!E),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:E?(0,D.jsx)(G.A,{className:"h-5 w-5"}):(0,D.jsx)(H.A,{className:"h-5 w-5"})})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:W,disabled:I,className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",title:l("passwordManager.generatePassword"),children:I?(0,D.jsx)(w.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("passwordManager.generatePassword")})]})]}),O&&(0,D.jsx)("div",{className:"mt-2",children:(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[(0,D.jsx)("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,D.jsx)("div",{className:"h-full ".concat(z()," transition-all duration-300"),style:{width:"weak"===O?"25%":"medium"===O?"50%":"strong"===O?"75%":"100%"}})}),(0,D.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:V()})]})})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:l("passwordManager.entryNotes")}),(0,D.jsx)("textarea",{value:S,onChange:e=>R(e.target.value),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,D.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:K,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,D.jsx)(T.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("passwordManager.cancel")})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",disabled:U,children:U?(0,D.jsx)(w.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(j.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l(U?"common.saving":"passwordManager.save")})]})]})]})]})]})})]}):(0,D.jsxs)(D.Fragment,{children:[t&&!m&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/10 sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,D.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:l(s?"passwordManager.editEntry":"passwordManager.createEntry")}),(0,D.jsx)("button",{onClick:K,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(T.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[M&&(0,D.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:M}),(0,D.jsxs)("form",{onSubmit:Y,className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[l("passwordManager.entryTitle")," *"]}),(0,D.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:l("passwordManager.entryUrl")}),(0,D.jsx)("input",{type:"url",value:b,onChange:e=>f(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"https://example.com"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:l("passwordManager.entryUsername")}),(0,D.jsx)("input",{type:"text",value:v,onChange:e=>N(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[l("passwordManager.entryPassword")," *"]}),(0,D.jsxs)("div",{className:"mt-1 flex gap-2",children:[(0,D.jsxs)("div",{className:"flex-1 relative",children:[(0,D.jsx)("input",{type:E?"text":"password",value:k,onChange:e=>A(e.target.value),className:"block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 pr-10 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0}),(0,D.jsx)("button",{type:"button",onClick:()=>C(!E),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:E?(0,D.jsx)(G.A,{className:"h-5 w-5"}):(0,D.jsx)(H.A,{className:"h-5 w-5"})})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:W,disabled:I,className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",title:l("passwordManager.generatePassword"),children:I?(0,D.jsx)(w.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("passwordManager.generatePassword")})]})]}),O&&(0,D.jsx)("div",{className:"mt-2",children:(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[(0,D.jsx)("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,D.jsx)("div",{className:"h-full ".concat(z()," transition-all duration-300"),style:{width:"weak"===O?"25%":"medium"===O?"50%":"strong"===O?"75%":"100%"}})}),(0,D.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:V()})]})})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:l("passwordManager.entryNotes")}),(0,D.jsx)("textarea",{value:S,onChange:e=>R(e.target.value),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,D.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:K,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,D.jsx)(T.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("passwordManager.cancel")})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",disabled:U,children:U?(0,D.jsx)(w.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(j.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l(U?"common.saving":"passwordManager.save")})]})]})]})]})]})]})};var ee=r(7504),te=r(4129);const re=e=>{let{isOpen:t,onClose:r,entryId:s,onPermissionsUpdated:o}=e;const{t:l}=(0,n.Bd)(),[i,d]=(0,a.useState)([]),[c,x]=(0,a.useState)([]),[h,p]=(0,a.useState)([]),[b,y]=(0,a.useState)([]),[f,v]=(0,a.useState)(!1),[k,A]=(0,a.useState)(!1),[S,R]=(0,a.useState)(""),[E,C]=(0,a.useState)("");(0,a.useEffect)((()=>{t&&s&&M()}),[t,s]);const M=async()=>{try{v(!0);const[e,t,r]=await Promise.all([J.getPermissions(s),m.A.get(u.Sn.ROLES.BASE),m.A.get(u.Sn.USERS.BASE)]);d(e.rolePermissions),x(e.userPermissions),p(t.data||[]),y(r.data||[])}catch(e){console.error("Error loading permissions:",e),g.oR.error(l("passwordManager.errorLoadingPermissions")||"Fehler beim Laden der Berechtigungen")}finally{v(!1)}},_=(e,t,r)=>{"role"===e?d(i.map((e=>e.roleId===t?(0,N.A)((0,N.A)({},e),{},{[r]:!e[r]}):e))):x(c.map((e=>e.userId===t?(0,N.A)((0,N.A)({},e),{},{[r]:!e[r]}):e)))},U=h.filter((e=>!i.find((t=>t.roleId===e.id)))),L=b.filter((e=>!c.find((t=>t.userId===e.id))));return(0,D.jsxs)(P.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,D.jsxs)(P.lG.Panel,{className:"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] flex flex-col",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)(P.lG.Title,{className:"text-lg font-semibold dark:text-white",children:l("passwordManager.managePermissions")}),(0,D.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(T.A,{className:"h-6 w-6"})})]}),(0,D.jsx)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:f?(0,D.jsx)("div",{className:"text-center py-8",children:(0,D.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:l("common.loading")})}):(0,D.jsxs)("div",{className:"space-y-6",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,D.jsxs)("h3",{className:"text-md font-semibold dark:text-white flex items-center gap-2",children:[(0,D.jsx)(ee.A,{className:"h-5 w-5"}),l("passwordManager.rolePermissions")]}),U.length>0&&(0,D.jsxs)("div",{className:"flex gap-2",children:[(0,D.jsxs)("select",{value:S,onChange:e=>R(Number(e.target.value)||""),className:"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,D.jsx)("option",{value:"",children:l("passwordManager.selectRole")}),U.map((e=>(0,D.jsx)("option",{value:e.id,children:e.name},e.id)))]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>{if(!S||i.find((e=>e.roleId===S)))return;const e=h.find((e=>e.id===S));e&&(d([...i,{id:0,passwordEntryId:s,roleId:S,canView:!1,canEdit:!1,canDelete:!1,role:{id:e.id,name:e.name}}]),R(""))},className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-md",title:l("common.add"),children:(0,D.jsx)(z.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("common.add")})]})]})]}),0===i.length?(0,D.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:l("passwordManager.noRolePermissions")}):(0,D.jsx)("div",{className:"space-y-2",children:i.map((e=>{var t;return(0,D.jsxs)("div",{className:"p-3 border border-gray-200 dark:border-gray-700 rounded-md",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,D.jsx)("span",{className:"font-medium dark:text-white",children:(null===(t=e.role)||void 0===t?void 0:t.name)||"Rolle ".concat(e.roleId)}),(0,D.jsx)("button",{onClick:()=>{return t=e.roleId,void d(i.filter((e=>e.roleId!==t)));var t},className:"text-red-600 dark:text-red-400 hover:text-red-700 text-sm",children:l("common.remove")})]}),(0,D.jsxs)("div",{className:"flex gap-4",children:[(0,D.jsxs)("label",{className:"flex items-center gap-2",children:[(0,D.jsx)("input",{type:"checkbox",checked:e.canView,onChange:()=>_("role",e.roleId,"canView"),className:"rounded"}),(0,D.jsx)("span",{className:"text-sm dark:text-gray-300",children:l("passwordManager.canView")})]}),(0,D.jsxs)("label",{className:"flex items-center gap-2",children:[(0,D.jsx)("input",{type:"checkbox",checked:e.canEdit,onChange:()=>_("role",e.roleId,"canEdit"),className:"rounded"}),(0,D.jsx)("span",{className:"text-sm dark:text-gray-300",children:l("passwordManager.canEdit")})]}),(0,D.jsxs)("label",{className:"flex items-center gap-2",children:[(0,D.jsx)("input",{type:"checkbox",checked:e.canDelete,onChange:()=>_("role",e.roleId,"canDelete"),className:"rounded"}),(0,D.jsx)("span",{className:"text-sm dark:text-gray-300",children:l("passwordManager.canDelete")})]})]})]},e.roleId)}))})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,D.jsxs)("h3",{className:"text-md font-semibold dark:text-white flex items-center gap-2",children:[(0,D.jsx)(te.A,{className:"h-5 w-5"}),l("passwordManager.userPermissions")]}),L.length>0&&(0,D.jsxs)("div",{className:"flex gap-2",children:[(0,D.jsxs)("select",{value:E,onChange:e=>C(Number(e.target.value)||""),className:"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,D.jsx)("option",{value:"",children:l("passwordManager.selectUser")}),L.map((e=>(0,D.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName," (",e.email,")"]},e.id)))]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>{if(!E||c.find((e=>e.userId===E)))return;const e=b.find((e=>e.id===E));e&&(x([...c,{id:0,passwordEntryId:s,userId:E,canView:!1,canEdit:!1,canDelete:!1,user:{id:e.id,firstName:e.firstName,lastName:e.lastName,email:e.email}}]),C(""))},className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-md",title:l("common.add"),children:(0,D.jsx)(z.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("common.add")})]})]})]}),0===c.length?(0,D.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:l("passwordManager.noUserPermissions")}):(0,D.jsx)("div",{className:"space-y-2",children:c.map((e=>{var t,r,a;return(0,D.jsxs)("div",{className:"p-3 border border-gray-200 dark:border-gray-700 rounded-md",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,D.jsxs)("span",{className:"font-medium dark:text-white",children:[null===(t=e.user)||void 0===t?void 0:t.firstName," ",null===(r=e.user)||void 0===r?void 0:r.lastName," (",null===(a=e.user)||void 0===a?void 0:a.email,")"]}),(0,D.jsx)("button",{onClick:()=>{return t=e.userId,void x(c.filter((e=>e.userId!==t)));var t},className:"text-red-600 dark:text-red-400 hover:text-red-700 text-sm",children:l("common.remove")})]}),(0,D.jsxs)("div",{className:"flex gap-4",children:[(0,D.jsxs)("label",{className:"flex items-center gap-2",children:[(0,D.jsx)("input",{type:"checkbox",checked:e.canView,onChange:()=>_("user",e.userId,"canView"),className:"rounded"}),(0,D.jsx)("span",{className:"text-sm dark:text-gray-300",children:l("passwordManager.canView")})]}),(0,D.jsxs)("label",{className:"flex items-center gap-2",children:[(0,D.jsx)("input",{type:"checkbox",checked:e.canEdit,onChange:()=>_("user",e.userId,"canEdit"),className:"rounded"}),(0,D.jsx)("span",{className:"text-sm dark:text-gray-300",children:l("passwordManager.canEdit")})]}),(0,D.jsxs)("label",{className:"flex items-center gap-2",children:[(0,D.jsx)("input",{type:"checkbox",checked:e.canDelete,onChange:()=>_("user",e.userId,"canDelete"),className:"rounded"}),(0,D.jsx)("span",{className:"text-sm dark:text-gray-300",children:l("passwordManager.canDelete")})]})]})]},e.userId)}))})]})]})}),(0,D.jsxs)("div",{className:"flex items-center justify-end gap-2 p-4 border-t dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("button",{onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600",children:l("common.cancel")}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:async()=>{try{A(!0);const e={rolePermissions:i.map((e=>({roleId:e.roleId,canView:e.canView,canEdit:e.canEdit,canDelete:e.canDelete}))),userPermissions:c.map((e=>({userId:e.userId,canView:e.canView,canEdit:e.canEdit,canDelete:e.canDelete})))};await J.updatePermissions(s,e),g.oR.success(l("passwordManager.permissionsUpdated")||"Berechtigungen erfolgreich aktualisiert"),o(),r()}catch(e){console.error("Error saving permissions:",e),g.oR.error(l("passwordManager.errorSavingPermissions")||"Fehler beim Speichern der Berechtigungen")}finally{A(!1)}},disabled:k,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:l("common.save"),children:k?(0,D.jsx)(w.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(j.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("common.save")})]})]})]})})]})},ae=e=>{let{isOpen:t,onClose:r,entryId:s}=e;const{t:o}=(0,n.Bd)(),[l,i]=(0,a.useState)([]),[d,c]=(0,a.useState)(!1);(0,a.useEffect)((()=>{t&&s&&u()}),[t,s]);const u=async()=>{try{c(!0);const e=await J.getAuditLogs(s);i(e)}catch(e){console.error("Error loading audit logs:",e),g.oR.error(o("passwordManager.errorLoadingAuditLogs")||"Fehler beim Laden der Audit-Logs")}finally{c(!1)}},m=e=>{const t=new Date(e);return new Intl.DateTimeFormat("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(t)};return(0,D.jsxs)(P.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,D.jsxs)(P.lG.Panel,{className:"mx-auto max-w-3xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] flex flex-col",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,D.jsxs)(P.lG.Title,{className:"text-lg font-semibold dark:text-white flex items-center gap-2",children:[(0,D.jsx)(O.A,{className:"h-5 w-5"}),o("passwordManager.auditLogs")]}),(0,D.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(T.A,{className:"h-6 w-6"})})]}),(0,D.jsx)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:d?(0,D.jsx)("div",{className:"text-center py-8",children:(0,D.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:o("common.loading")})}):0===l.length?(0,D.jsx)("div",{className:"text-center py-8",children:(0,D.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:o("passwordManager.noAuditLogs")})}):(0,D.jsx)("div",{className:"space-y-3",children:l.map((e=>{return(0,D.jsxs)("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-md",children:[(0,D.jsx)("div",{className:"flex items-start justify-between mb-2",children:(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,D.jsx)("span",{className:"font-semibold dark:text-white",children:(t=e.action,{view:o("passwordManager.auditLogActionView")||"Anzeigen",view_password:o("passwordManager.auditLogActionViewPassword")||"Passwort anzeigen",copy_password:o("passwordManager.auditLogActionCopyPassword")||"Passwort kopieren",create:o("passwordManager.auditLogActionCreate")||"Erstellen",update:o("passwordManager.auditLogActionUpdate")||"Aktualisieren",delete:o("passwordManager.auditLogActionDelete")||"L\xf6schen"}[t]||t)}),e.user&&(0,D.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["von ",e.user.firstName," ",e.user.lastName]})]}),(0,D.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[(0,D.jsx)(O.A,{className:"h-4 w-4"}),m(e.createdAt)]})]})}),e.details&&Object.keys(e.details).length>0&&(0,D.jsx)("div",{className:"mt-2 p-2 bg-gray-50 dark:bg-gray-900 rounded text-sm",children:(0,D.jsx)("pre",{className:"text-xs text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:JSON.stringify(e.details,null,2)})}),(e.ipAddress||e.userAgent)&&(0,D.jsxs)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:[e.ipAddress&&(0,D.jsxs)("div",{children:["IP: ",e.ipAddress]}),e.userAgent&&(0,D.jsxs)("div",{children:["User-Agent: ",e.userAgent]})]})]},e.id);var t}))})}),(0,D.jsx)("div",{className:"flex items-center justify-end p-4 border-t dark:border-gray-700 flex-shrink-0",children:(0,D.jsx)("button",{onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600",children:o("common.close")})})]})})]})};var se=r(4426),ne=r(7829),oe=r(9462),le=r(6400);const ie="password-manager-table",de=()=>{const{t:e}=(0,n.Bd)(),{hasPermission:t}=(0,i.S)(),{user:r}=(0,o.As)(),[s,l]=(0,a.useState)([]),[d,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),[x,h]=(0,a.useState)(null),[p,b]=(0,a.useState)(null),[y,f]=(0,a.useState)({}),[w,v]=(0,a.useState)(null),[j,k]=(0,a.useState)(null),[A,S]=(0,a.useState)([]),[R,E]=(0,a.useState)([]),[C,M]=(0,a.useState)(!1),[P,T]=(0,a.useState)(""),[_,U]=(0,a.useState)(null),I=(0,a.useMemo)((()=>[{id:"title",label:e("passwordManager.entryTitle")},{id:"url",label:e("passwordManager.entryUrl")},{id:"username",label:e("passwordManager.entryUsername")},{id:"notes",label:e("passwordManager.entryNotes")},{id:"createdAt",label:e("passwordManager.sortByCreated")},{id:"updatedAt",label:e("passwordManager.sortByUpdated")},{id:"createdBy",label:e("common.createdBy")}]),[e]),F=t("password_manager","read","page"),q=t("password_entry_create","write","button"),B=t("password_manager","write","page"),Z=t("password_manager","write","page");(0,a.useEffect)((()=>{F&&Q()}),[F]);const Q=async()=>{try{c(!0);const e=await J.getAll();l(e)}catch(t){console.error("Error loading password entries:",t),g.oR.error(e("passwordManager.error")||"Fehler beim Laden der Eintr\xe4ge")}finally{c(!1)}},ee=e=>{if(!e)return!1;try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(t){return!1}},te=(e,t)=>{S(e),E(t)},de=()=>{S([]),E([]),T(""),U(null)},ce=async(e,t,r,a)=>{T(e),U(t),te(r,a)},ue=(0,oe.b)(),{loadFilters:me}=ue;(0,a.useEffect)((()=>{(async()=>{if(!F)return;const e=(await me(ie)).find((e=>"Alle Eintr\xe4ge"===e.name));e&&await ce(e.name,e.id,e.conditions,e.operators)})()}),[F,me,ce]);const ge={title:(e,t)=>{var r;const a=(null===(r=e.title)||void 0===r?void 0:r.toLowerCase())||"";return xe(a,t)},url:(e,t)=>{var r;const a=(null===(r=e.url)||void 0===r?void 0:r.toLowerCase())||"";return xe(a,t)},username:(e,t)=>{var r;const a=(null===(r=e.username)||void 0===r?void 0:r.toLowerCase())||"";return xe(a,t)},notes:(e,t)=>{var r;const a=(null===(r=e.notes)||void 0===r?void 0:r.toLowerCase())||"";return xe(a,t)},createdAt:(e,t)=>he(new Date(e.createdAt),t),updatedAt:(e,t)=>he(new Date(e.updatedAt),t),createdBy:(e,t)=>{const r=e.createdBy?"".concat(e.createdBy.firstName," ").concat(e.createdBy.lastName).toLowerCase():"";return xe(r,t)}},xe=(e,t)=>{const r=(t.value||"").toLowerCase();switch(t.operator){case"equals":return e===r;case"contains":return e.includes(r);case"startsWith":return e.startsWith(r);case"endsWith":return e.endsWith(r);case"isNull":return!e;case"isNotNull":return!!e;default:return!1}},he=(e,t)=>{const r=t.value?new Date(t.value):null;if(!r||isNaN(r.getTime()))return!1;const a=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(r.getFullYear(),r.getMonth(),r.getDate());switch(t.operator){case"equals":return a.getTime()===s.getTime();case"before":return a.getTime()<s.getTime();case"after":return a.getTime()>s.getTime();default:return!1}},pe=(e,t)=>{switch(t){case"title":return e.title;case"url":return e.url;case"username":return e.username;case"notes":return e.notes;case"createdAt":return e.createdAt;case"updatedAt":return e.updatedAt;case"createdBy":return e.createdBy?"".concat(e.createdBy.firstName," ").concat(e.createdBy.lastName):"";default:return e[t]}},be=(0,a.useMemo)((()=>{let e=[...s];return A.length>0&&(e=(0,le.W5)(e,A,R,pe,ge)),e.sort(((e,t)=>{const r=new Date(e.createdAt).getTime();return new Date(t.createdAt).getTime()-r})),e}),[s,A,R]);return F?(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsx)("div",{className:"flex items-center",children:q&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>{h(null),m(!0)},className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":e("passwordManager.createEntry"),children:(0,D.jsx)(z.A,{className:"h-4 w-4"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("passwordManager.createEntry")})]})}),(0,D.jsx)("div",{className:"flex items-center gap-2",children:(0,D.jsx)("div",{className:"relative",children:(0,D.jsxs)("button",{className:"p-2 rounded-md border ".concat(A.length>0?"border-blue-300 bg-blue-50 text-blue-600":"border-gray-300 hover:bg-gray-100"),onClick:()=>M(!C),title:e("common.filter"),children:[(0,D.jsx)(V.A,{className:"h-5 w-5"}),A.length>0&&(0,D.jsx)("span",{className:"absolute top-0 right-0 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center",children:A.length})]})})})]}),C&&(0,D.jsx)("div",{className:"px-3 sm:px-4 md:px-6",children:(0,D.jsx)(se.A,{columns:I,onApply:te,onReset:de,savedConditions:A,savedOperators:R,tableId:ie})}),(0,D.jsx)("div",{className:"px-3 sm:px-4 md:px-6",children:(0,D.jsx)(ne.A,{tableId:ie,onSelectFilter:(e,t)=>te(e,t),onReset:de,activeFilterName:P,selectedFilterId:_,onFilterChange:ce,defaultFilterName:"Alle Eintr\xe4ge"})}),d?(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 text-center",children:(0,D.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:e("passwordManager.loading")})}):0===be.length?(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 text-center",children:(0,D.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:A.length>0?e("passwordManager.noEntriesFiltered","Keine Eintr\xe4ge gefunden"):e("passwordManager.noEntries")})}):(0,D.jsx)("div",{className:"space-y-3",children:be.map((t=>(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-4",children:(0,D.jsxs)("div",{className:"flex items-start justify-between",children:[(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:t.title}),t.url&&(0,D.jsx)("div",{className:"mb-2",children:(0,D.jsxs)("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1",onClick:r=>{ee(t.url||"")||(r.preventDefault(),g.oR.error(e("passwordManager.urlInvalid")))},children:[(0,D.jsx)(W.A,{className:"h-4 w-4"}),t.url]})}),t.username&&(0,D.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:[(0,D.jsxs)("span",{className:"font-medium",children:[e("passwordManager.entryUsername"),":"]})," ",t.username]}),p===t.id&&y[t.id]&&(0,D.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1 font-mono",children:[(0,D.jsxs)("span",{className:"font-medium",children:[e("passwordManager.entryPassword"),":"]})," ",y[t.id]]}),t.notes&&(0,D.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:t.notes}),(0,D.jsxs)("div",{className:"mt-3 flex items-center gap-2 flex-wrap",children:[(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>(async t=>{try{if(p===t.id)return void b(null);if(!y[t.id]){const e=await J.getPassword(t.id);f((r=>(0,N.A)((0,N.A)({},r),{},{[t.id]:e.password})))}b(t.id)}catch(r){console.error("Error showing password:",r),g.oR.error(e("passwordManager.error")||"Fehler beim Anzeigen des Passworts")}})(t),className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:p===t.id?e("passwordManager.hidePassword"):e("passwordManager.showPassword"),children:p===t.id?(0,D.jsx)(G.A,{className:"h-5 w-5"}):(0,D.jsx)(H.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:p===t.id?e("passwordManager.hidePassword"):e("passwordManager.showPassword")})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>(async t=>{try{if(!y[t.id]){const e=await J.getPassword(t.id);f((r=>(0,N.A)((0,N.A)({},r),{},{[t.id]:e.password})))}const a=y[t.id];await navigator.clipboard.writeText(a);try{await J.logPasswordCopy(t.id)}catch(r){console.warn("Error logging password copy:",r)}g.oR.success(e("passwordManager.passwordCopied"))}catch(a){console.error("Error copying password:",a),g.oR.error(e("passwordManager.errorCopyingPassword"))}})(t),className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:e("passwordManager.copyPassword"),children:(0,D.jsx)(Y.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("passwordManager.copyPassword")})]}),t.url&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>(async t=>{try{if(!y[t.id]){const e=await J.getPassword(t.id);f((r=>(0,N.A)((0,N.A)({},r),{},{[t.id]:e.password})))}const a=y[t.id];await navigator.clipboard.writeText(a);try{await J.logPasswordCopy(t.id)}catch(r){console.warn("Error logging password copy:",r)}t.url&&ee(t.url)?(window.open(t.url,"_blank","noopener,noreferrer"),g.oR.success(e("passwordManager.passwordCopiedAndOpened"))):g.oR.success(e("passwordManager.passwordCopied"))}catch(a){console.error("Error opening and copying password:",a),g.oR.error(e("passwordManager.errorCopyingPassword"))}})(t),className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md",title:e("passwordManager.openAndCopy"),children:(0,D.jsx)(W.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("passwordManager.openAndCopy")})]})]})]}),(0,D.jsxs)("div",{className:"flex items-center gap-2 ml-4 flex-wrap",children:[r&&t.createdById===r.id&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("button",{onClick:()=>v(t.id),className:"p-2 text-purple-600 dark:text-purple-400 hover:bg-purple-50 dark:hover:bg-purple-900/20 rounded-md",title:e("passwordManager.managePermissions"),children:(0,D.jsx)(K.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{onClick:()=>k(t.id),className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-900/20 rounded-md",title:e("passwordManager.auditLogs"),children:(0,D.jsx)(O.A,{className:"h-5 w-5"})})]}),B&&(0,D.jsx)("button",{onClick:()=>(e=>{h(e),m(!0)})(t),className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md",title:e("passwordManager.editEntry"),children:(0,D.jsx)($.A,{className:"h-5 w-5"})}),Z&&(0,D.jsx)("button",{onClick:()=>(async t=>{if(window.confirm(e("passwordManager.deleteConfirm")))try{await J.delete(t.id),l((e=>e.filter((e=>e.id!==t.id)))),g.oR.success(e("passwordManager.deleteEntry")||"Eintrag erfolgreich gel\xf6scht")}catch(s){var r,a;console.error("Error deleting entry:",s),g.oR.error((null===(r=s.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||e("passwordManager.error")||"Fehler beim L\xf6schen")}})(t),className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md",title:e("passwordManager.deleteEntry"),children:(0,D.jsx)(L.A,{className:"h-5 w-5"})})]})]})},t.id)))}),(0,D.jsx)(X,{isOpen:u,onClose:()=>{m(!1),h(null)},entry:x,onEntrySaved:e=>{x?(l((t=>t.map((t=>t.id===e.id?e:t)))),h(null)):l((t=>[e,...t])),m(!1),h(null)}}),w&&(0,D.jsx)(re,{isOpen:!!w,onClose:()=>v(null),entryId:w,onPermissionsUpdated:()=>{Q(),v(null)}}),j&&(0,D.jsx)(ae,{isOpen:!!j,onClose:()=>k(null),entryId:j})]}):(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:(0,D.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:e("passwordManager.error")||"Keine Berechtigung f\xfcr den Passwort-Manager"})})};var ce=r(8625),ue=r(3216);const me=()=>{const{user:e,fetchCurrentUser:t}=(0,o.As)(),{isAdmin:r,canView:N}=(0,i.S)(),{isDarkMode:k,toggleDarkMode:A}=(0,x.D)(),{showMessage:S}=(0,c.A)(),{t:R}=(0,n.Bd)(),{activeLanguage:E,organizationLanguage:C,setUserLanguage:P,isLoading:T}=(0,d.o)(),{resetTour:U,startTour:L}=(0,ce.z)(),I=(0,ue.Zp)(),[F,O]=(0,a.useState)(""),[q,z]=(0,a.useState)(!1),[V,W]=(0,a.useState)(null),[G,H]=(0,a.useState)(null),[Y,K]=(0,a.useState)(!1),[$,Z]=(0,a.useState)(null),J=(0,a.useRef)(null),Q=(0,a.useRef)(null);(0,a.useEffect)((()=>{Q.current&&Q.current!==G&&URL.revokeObjectURL(Q.current),Q.current=G}),[G]),(0,a.useEffect)((()=>()=>{Q.current&&URL.revokeObjectURL(Q.current)}),[]);const[X,ee]=(0,a.useState)(!1),[te,re]=(0,a.useState)("personal");(0,a.useEffect)((()=>{const e=["personal","notifications"];N("system","tab")&&e.push("system"),N("password_manager","tab")&&e.push("password_manager"),e.includes(te)||re(e[0])}),[N,te]);const[ae,se]=(0,a.useState)({monthlyReportEnabled:!1,monthlyReportDay:25,monthlyReportRecipient:""}),[ne,oe]=(0,a.useState)(!0),[le,ie]=(0,a.useState)(!1);(0,a.useEffect)((()=>{l.v.log("User:",e),l.v.log("Is Admin:",r()),l.v.log("User Roles:",null===e||void 0===e?void 0:e.roles)}),[e,r]),(0,a.useEffect)((()=>{(async()=>{if(null!==e&&void 0!==e&&e.invoiceSettings)try{se({monthlyReportEnabled:e.invoiceSettings.monthlyReportEnabled||!1,monthlyReportDay:e.invoiceSettings.monthlyReportDay||25,monthlyReportRecipient:e.invoiceSettings.monthlyReportRecipient||""})}catch($){console.error("Fehler beim Laden der Monatsabrechnungs-Einstellungen:",$),S(R("errors.loadSettingsError"),"error")}finally{oe(!1)}else oe(!1)})()}),[e,S]);const me=async e=>{try{await m.A.put(u.Sn.USERS.INVOICE_SETTINGS,{monthlyReportEnabled:e.monthlyReportEnabled,monthlyReportDay:e.monthlyReportDay,monthlyReportRecipient:e.monthlyReportRecipient}),se(e),e.monthlyReportEnabled||g.oR.success(R("settings.monthlyReportDisabled"))}catch($){throw console.error("Fehler beim Speichern der Monatsabrechnungs-Einstellungen:",$),g.oR.error(R("errors.saveMonthlyReportSettingsError")),$}},ge=async e=>{K(!0),Z(null);const r=new FormData;r.append("logo",e);try{l.v.log("Starting upload..."),l.v.log("Selected file:",e);const s=localStorage.getItem("token");l.v.log("Token verf\xfcgbar:",!!s);const n={};s&&(n.Authorization="Bearer ".concat(s));const o=await fetch("".concat(u.H$,"/settings/logo"),{method:"POST",body:r,headers:n});l.v.log("Response Status:",o.status);const i=await o.text();if(l.v.log("Response Text:",i),!o.ok)throw new Error(i||R("errors.uploadFailed"));try{const e=JSON.parse(i);l.v.log("Response Data:",e),S(R("settings.logoUploadSuccess"),"success");try{await t(),l.v.log("User-Daten nach Logo-Upload neu geladen")}catch($){console.error("Fehler beim Neuladen der User-Daten:",$)}const r=document.getElementById("favicon");if(r){(new Date).getTime();try{const e=await fetch("".concat(u.H$,"/settings/logo/base64"));if(e.ok){const t=await e.json();r.href=t.logo}}catch($){console.error("Favicon konnte nicht aktualisiert werden:",$)}}}catch(a){throw console.error("Fehler beim Parsen der Antwort:",a),new Error(R("errors.invalidResponseFormat"))}W(null),H(null)}catch(s){console.error("Upload error:",s);const e=R("settings.logoUploadError")+": "+(s instanceof Error?s.message:R("errors.unknownError"));Z(e),S(e,"error")}finally{K(!1)}},xe=e=>{re(e),Z(null)};return e?(0,D.jsx)("div",{className:"min-h-screen dark:bg-gray-900",children:(0,D.jsxs)("div",{className:"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6",children:[(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,D.jsxs)("div",{className:"flex items-center mb-6",children:[(0,D.jsx)(h.A,{className:"h-6 w-6 mr-2"}),(0,D.jsx)("h2",{className:"text-xl font-semibold",children:R("settings.title")})]}),(0,D.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:(0,D.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,D.jsxs)("button",{className:"".concat("personal"===te?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center"),onClick:()=>xe("personal"),children:[(0,D.jsx)(p.A,{className:"h-4 w-4 mr-2"}),R("settings.personal")]}),(0,D.jsxs)("button",{className:"".concat("notifications"===te?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center"),onClick:()=>xe("notifications"),children:[(0,D.jsx)(s.A,{className:"h-4 w-4 mr-2"}),R("settings.notifications")]}),N("system","tab")&&(0,D.jsxs)("button",{className:"".concat("system"===te?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center"),onClick:()=>xe("system"),children:[(0,D.jsx)(b.A,{className:"h-4 w-4 mr-2"}),R("settings.system")]}),N("password_manager","tab")&&(0,D.jsxs)("button",{className:"".concat("password_manager"===te?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center"),onClick:()=>xe("password_manager"),children:[(0,D.jsx)(y.A,{className:"h-4 w-4 mr-2"}),R("settings.passwordManager")]})]})}),"personal"===te&&(0,D.jsxs)("div",{className:"space-y-6","data-onboarding":"settings-overview",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between border-b pb-6",children:[(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsx)("h3",{className:"text-lg font-medium dark:text-white",children:R("settings.language")}),(0,D.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:[R("settings.userLanguage"),C&&(0,D.jsxs)("span",{className:"block mt-1 text-xs",children:[R("settings.organizationLanguage"),": ",R("de"===C?"worktime.language.german":"es"===C?"worktime.language.spanish":"worktime.language.english")]})]})]}),(0,D.jsxs)("select",{value:F||E||(null===e||void 0===e?void 0:e.language)||"",onChange:async e=>{const t=e.target.value;if(O(t),t&&t!==E){z(!0);try{await P(t),S(R("common.save"),"success")}catch($){console.error("Fehler beim Speichern der Sprache:",$),S(R("errors.saveLanguageError"),"error")}finally{z(!1)}}},disabled:q||T,className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white ml-4",children:[(0,D.jsx)("option",{value:"",children:R("settings.useOrganizationLanguage")}),(0,D.jsx)("option",{value:"de",children:R("worktime.language.german")}),(0,D.jsx)("option",{value:"es",children:R("worktime.language.spanish")}),(0,D.jsx)("option",{value:"en",children:R("worktime.language.english")})]})]}),(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("h3",{className:"text-lg font-medium dark:text-white",children:R("settings.darkMode")}),(0,D.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:R("settings.darkModeDescription")})]}),(0,D.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:k,onChange:A}),(0,D.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),(0,D.jsx)("div",{className:"border-t pt-6",children:ne?(0,D.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:R("settings.loadingSettings")}):(0,D.jsx)("div",{className:"space-y-4",children:(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("h3",{className:"text-lg font-medium dark:text-white",children:R("settings.monthlyReport")}),(0,D.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:[R("settings.monthlyReportDescription"),ae.monthlyReportEnabled&&ae.monthlyReportRecipient&&(0,D.jsxs)("span",{className:"block text-sm text-green-600 dark:text-green-400 mt-1",children:["\u2713 ",R("settings.monthlyReportEnabled")," ",ae.monthlyReportRecipient.split("\n")[0]]})]})]}),(0,D.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:ae.monthlyReportEnabled,onChange:e=>{e.target.checked?ie(!0):me({monthlyReportEnabled:!1,monthlyReportDay:ae.monthlyReportDay,monthlyReportRecipient:ae.monthlyReportRecipient})}}),(0,D.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]})})}),(0,D.jsx)("div",{className:"border-t pt-6",children:(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,D.jsx)(f.A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),(0,D.jsx)("h3",{className:"text-lg font-medium dark:text-white",children:R("settings.onboarding.restart")})]}),(0,D.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:R("settings.onboarding.restartDescription")})]}),(0,D.jsx)("button",{onClick:async()=>{try{await U(),S(R("settings.onboarding.restart"),"success"),I("/dashboard"),setTimeout((()=>{L()}),500)}catch($){console.error("Fehler beim Zur\xfccksetzen der Tour:",$),S(R("errors.unknownError"),"error")}},className:"p-2 text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:R("onboarding.navigation.restart"),children:(0,D.jsx)(f.A,{className:"h-5 w-5"})})]})})]}),"notifications"===te&&(0,D.jsx)("div",{className:"space-y-4",children:(0,D.jsx)("div",{className:"p-0 -mt-4",children:(0,D.jsx)(M,{})})}),"system"===te&&(0,D.jsxs)("div",{className:"space-y-8",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("h3",{className:"text-lg font-medium mb-2 dark:text-white",children:R("settings.logoUpload")}),(0,D.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:R("settings.logoUploadDescription")})]}),(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[(0,D.jsx)("input",{ref:J,type:"file",accept:"image/png,image/jpeg",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if("image/png"!==r.type&&"image/jpeg"!==r.type)return Z(R("settings.fileUploadError")),void S(R("settings.fileUploadError"),"error");if(r.size>5242880)return Z(R("settings.fileSizeError")),void S(R("settings.fileSizeError"),"error");W(r),H(URL.createObjectURL(r)),Z(null),ge(r)}},className:"hidden",disabled:Y}),(0,D.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=J.current)||void 0===e?void 0:e.click()},disabled:Y,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:R(Y?"settings.logoUploading":"settings.logoUploadButton"),children:Y?(0,D.jsx)(w.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(v.A,{className:"h-5 w-5"})})]})]}),$&&(0,D.jsx)("div",{className:"text-red-600 dark:text-red-400 text-sm mt-2",children:$}),G&&(0,D.jsxs)("div",{className:"mt-4",children:[(0,D.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:R("settings.logoPreview")}),(0,D.jsx)("img",{src:G,alt:"Logo Vorschau",className:"max-w-xs h-auto rounded-lg shadow-sm"})]}),(0,D.jsxs)("div",{className:"border-t pt-6",children:[(0,D.jsx)("h3",{className:"text-lg font-medium mb-4 dark:text-white",children:R("settings.uploadDirectories")}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"taskAttachmentsPath",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:R("settings.taskAttachmentsPath")}),(0,D.jsx)("input",{type:"text",id:"taskAttachmentsPath",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white",defaultValue:"uploads/task-attachments",placeholder:R("settings.taskAttachmentsPathPlaceholder")}),(0,D.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:R("settings.taskAttachmentsPathDescription")})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"requestAttachmentsPath",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:R("settings.requestAttachmentsPath")}),(0,D.jsx)("input",{type:"text",id:"requestAttachmentsPath",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white",defaultValue:"uploads/request-attachments",placeholder:R("settings.requestAttachmentsPathPlaceholder")}),(0,D.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:R("settings.requestAttachmentsPathDescription")})]}),(0,D.jsx)("div",{className:"mt-4",children:(0,D.jsx)("button",{type:"button",onClick:async()=>{ee(!0);try{var e,t;null===(e=document.getElementById("taskAttachmentsPath"))||void 0===e||e.value,null===(t=document.getElementById("requestAttachmentsPath"))||void 0===t||t.value;await new Promise((e=>setTimeout(e,500))),g.oR.success(R("settings.saveDirectoriesSuccess"))}catch($){console.error("Fehler beim Speichern der Upload-Verzeichnisse:",$),g.oR.error(R("errors.saveUploadDirectoriesError"))}finally{ee(!1)}},disabled:X,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:R(X?"settings.savingDirectories":"settings.saveDirectories"),children:X?(0,D.jsx)(w.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(j.A,{className:"h-5 w-5"})})})]})]}),(0,D.jsxs)("div",{className:"border-t pt-6",children:[(0,D.jsx)("h3",{className:"text-lg font-medium mb-4 dark:text-white",children:R("settings.databaseManagement")}),(0,D.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:R("settings.databaseManagementDescription")}),(0,D.jsx)(B,{})]}),(0,D.jsx)("div",{className:"border-t pt-6",children:(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsx)("h3",{className:"text-lg font-medium mb-2 dark:text-white",children:"LobbyPMS: Vollst\xe4ndiger Sync"}),(0,D.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Synchronisiert alle Reservierungen mit Check-out ab gestern. Wird f\xfcr den ersten Sync oder manuelle Synchronisation verwendet."})]}),(0,D.jsx)("button",{onClick:async()=>{try{ee(!0);const e=await m.A.post(u.Sn.RESERVATIONS.SYNC_FULL);e.data.success?g.oR.success("Sync erfolgreich: ".concat(e.data.syncedCount," Reservierungen synchronisiert")):g.oR.error("Sync fehlgeschlagen")}catch($){console.error("Fehler beim vollst\xe4ndigen Sync:",$),g.oR.error($ instanceof Error?$.message:"Fehler beim vollst\xe4ndigen Sync")}finally{ee(!1)}},disabled:X,className:"p-2 text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",title:X?"Sync l\xe4uft...":"Vollst\xe4ndigen Sync starten",children:(0,D.jsx)(w.A,{className:"h-5 w-5 ".concat(X?"animate-spin":"")})})]})})]}),"password_manager"===te&&(0,D.jsx)("div",{className:"space-y-4",children:(0,D.jsx)(de,{})})]}),(0,D.jsx)(_,{isOpen:le,onClose:()=>ie(!1),onSave:me,currentSettings:ae})]})}):(0,D.jsx)("div",{children:R("common.loading")})}},6400:(e,t,r)=>{r.d(t,{Ac:()=>m,J1:()=>u,W5:()=>c});var a=r(1620),s=r(8605),n=r(4912),o=r(3695),l=r(8621),i=r(7744);const d=(e,t)=>{const{operator:r,value:a}=t;if(void 0===a)return console.error("evaluateCondition: value ist undefined",t),!1;if(null==e&&null==a)return"equals"===r;if(null==e||null==a)return"notEquals"===r;let s="",n="";try{const t=null==e?"":"string"===typeof e?e:String(e);if("string"!==typeof t)return!1;const r=t.toLowerCase();if(void 0===r||null===r||"string"!==typeof r)return!1;s=r;const o=null==a?"":"string"===typeof a?a:String(a);if("string"!==typeof o)return!1;const l=o.toLowerCase();if(void 0===l||null===l||"string"!==typeof l)return!1;n=l}catch(o){return!1}if("string"!==typeof s||"string"!==typeof n||void 0===s||void 0===n||null===s||null===n)return!1;switch(r){case"equals":return s===n;case"notEquals":return s!==n;case"contains":return s.includes(n);case"startsWith":return s.startsWith(n);case"endsWith":if(void 0===s||null===s)return console.error("endsWith: strField ist undefined/null",{strField:s,strValue:n,fieldValue:e,value:a,condition:t}),!1;if(void 0===n||null===n)return console.error("endsWith: strValue ist undefined/null",{strField:s,strValue:n,fieldValue:e,value:a,condition:t}),!1;if("string"!==typeof s)return console.error("endsWith: strField ist kein String",{strField:s,typeof:typeof s,strValue:n,fieldValue:e,value:a,condition:t}),!1;if("string"!==typeof n)return console.error("endsWith: strValue ist kein String",{strField:s,strValue:n,typeof:typeof n,fieldValue:e,value:a,condition:t}),!1;try{return s.endsWith(n)}catch(o){return console.error("endsWith: Fehler bei endsWith-Aufruf",o,{strField:s,strValue:n,fieldValue:e,value:a,condition:t}),!1}case"before":case"after":{const t=new Date(e),s=new Date(a);return!isNaN(t.getTime())&&!isNaN(s.getTime())&&("before"===r?t<s:t>s)}case"greaterThan":case"lessThan":{const t=parseFloat(String(e)),s=parseFloat(String(a));return!isNaN(t)&&!isNaN(s)&&("greaterThan"===r?t>s:t<s)}default:return!0}},c=(e,t,r,a,s)=>0===t.length?e:e.filter((e=>{let n=!0;for(let o=0;o<t.length;o++){const l=t[o];let i=!1;if(s&&s[l.column]){const t=s[l.column](e,l);if(null!==t)i=t;else{const t=a(e,l.column);i=d(t,l)}}else{const t=a(e,l.column);i=d(t,l)}if(0===o)n=i;else{n="AND"===(r[o-1]||"AND")?n&&i:n||i}}return n})),u=(e,t)=>{if(!e)return!1;const r=new Date(e);if(isNaN(r.getTime()))return!1;const d=r.getUTCFullYear(),c=r.getUTCMonth(),u=r.getUTCDate(),m=new Date(d,c,u);try{if("__THIS_WEEK__"===t.value){if("equals"===t.operator){const e=(0,a.k)(new Date,{weekStartsOn:1});e.setHours(0,0,0,0);const t=(0,s.$)(new Date,{weekStartsOn:1});return t.setHours(23,59,59,999),m>=e&&m<=t}const e=(0,a.k)(new Date,{weekStartsOn:1});e.setHours(0,0,0,0);const r=(0,s.$)(new Date,{weekStartsOn:1});return r.setHours(23,59,59,999),"before"===t.operator?m<r:"after"===t.operator&&m>e}if("__THIS_MONTH__"===t.value){if("equals"===t.operator){const e=(0,n.w)(new Date);e.setHours(0,0,0,0);const t=(0,o.p)(new Date);return t.setHours(23,59,59,999),m>=e&&m<=t}const e=(0,n.w)(new Date);e.setHours(0,0,0,0);const r=(0,o.p)(new Date);return r.setHours(23,59,59,999),"before"===t.operator?m<r:"after"===t.operator&&m>e}if("__THIS_YEAR__"===t.value){if("equals"===t.operator){const e=(0,l.D)(new Date);e.setHours(0,0,0,0);const t=(0,i.Q)(new Date);return t.setHours(23,59,59,999),m>=e&&m<=t}const e=(0,l.D)(new Date);e.setHours(0,0,0,0);const r=(0,i.Q)(new Date);return r.setHours(23,59,59,999),"before"===t.operator?m<r:"after"===t.operator&&m>e}let e;if("__TODAY__"===t.value){const t=new Date;t.setHours(0,0,0,0),e=t}else if("__WEEK_START__"===t.value){const t=(0,a.k)(new Date,{weekStartsOn:1});t.setHours(0,0,0,0),e=t}else if("__WEEK_END__"===t.value){const t=(0,s.$)(new Date,{weekStartsOn:1});t.setHours(23,59,59,999),e=t}else if("__MONTH_START__"===t.value){const t=(0,n.w)(new Date);t.setHours(0,0,0,0),e=t}else if("__MONTH_END__"===t.value){const t=(0,o.p)(new Date);t.setHours(23,59,59,999),e=t}else if("__YEAR_START__"===t.value){const t=(0,l.D)(new Date);t.setHours(0,0,0,0),e=t}else if("__YEAR_END__"===t.value){const t=(0,i.Q)(new Date);t.setHours(23,59,59,999),e=t}else{const r=new Date(t.value);if(isNaN(r.getTime()))return!1;const a=r.getUTCFullYear(),s=r.getUTCMonth(),n=r.getUTCDate();e=new Date(a,s,n)}switch(t.operator){case"equals":return m.getTime()===e.getTime();case"before":return m<e;case"after":return m>e;default:return!0}}catch(g){return console.error("[evaluateDateCondition] Error with placeholder ".concat(t.value,":"),g),!1}},m=(e,t,r,a)=>{const s=r.value||"";if(s.startsWith("user-")){const t=parseInt(s.replace("user-",""),10);if(isNaN(t))return!1;const a=e===t;return"notEquals"===r.operator?!a:a}if(s.startsWith("role-")){const e=parseInt(s.replace("role-",""),10);if(isNaN(e))return!1;const a=t===e;return"notEquals"===r.operator?!a:a}if(""===s)return!0;if(void 0!==a){const e=a.toLowerCase(),t=s.toLowerCase();if("equals"===r.operator)return e===t;if("notEquals"===r.operator)return e!==t;if("contains"===r.operator)return e.includes(t)}return!1}}}]);
//# sourceMappingURL=175.132f2295.chunk.js.map