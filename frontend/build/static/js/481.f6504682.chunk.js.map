{"version":3,"file":"static/js/481.f6504682.chunk.js","mappings":"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","sources":["components/PayrollComponent.tsx","components/InvoiceDetailModal.tsx","components/InvoiceManagementTab.tsx","components/MonthlyReportsTab.tsx","pages/Payroll.tsx","utils/filterLogic.ts"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { CalculatorIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { useOrganization } from '../contexts/OrganizationContext.tsx';\n\ninterface Hours {\n  regular: number;\n  overtime: number;\n  night: number;\n  holidayHours: number;\n  sundayHoliday: number;\n  overtimeNight: number;\n  overtimeSundayHoliday: number;\n  overtimeNightSundayHoliday: number;\n}\n\ninterface Payroll {\n  id: number;\n  userId: number;\n  periodStart: string;\n  periodEnd: string;\n  regularHours: number;\n  overtimeHours: number;\n  nightHours: number;\n  holidayHours: number;\n  sundayHolidayHours: number;\n  overtimeNightHours: number;\n  overtimeSundayHolidayHours: number;\n  overtimeNightSundayHolidayHours: number;\n  hourlyRate: number;\n  grossPay: number;\n  socialSecurity: number;\n  taxes: number;\n  netPay: number;\n  currency: string;\n  user: {\n    firstName: string;\n    lastName: string;\n    payrollCountry: string;\n    contractType: string | null;\n  };\n}\n\n// Lokale formatCurrency Funktion mit dynamischer Whrung\nconst formatCurrency = (amount: number, currency: string = 'CHF'): string => {\n  return new Intl.NumberFormat(\n    currency === 'CHF' ? 'de-CH' : 'es-CO',\n    {\n      style: 'currency',\n      currency: currency\n    }\n  ).format(amount);\n};\n\nconst PayrollComponent: React.FC = () => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const { hasPermission, getAccessLevel, loading: permissionsLoading } = usePermissions();\n  const canEditPayroll = hasPermission('payroll', 'write') || hasPermission('payroll', 'both');\n  const [hours, setHours] = useState<Hours>({\n    regular: 0,\n    overtime: 0,\n    night: 0,\n    holidayHours: 0,\n    sundayHoliday: 0,\n    overtimeNight: 0,\n    overtimeSundayHoliday: 0,\n    overtimeNightSundayHoliday: 0\n  });\n  const [payroll, setPayroll] = useState<Payroll | null>(null);\n  const [payrolls, setPayrolls] = useState<Payroll[]>([]);\n  const [selectedUser, setSelectedUser] = useState<number | null>(null);\n  const [allUsers, setAllUsers] = useState<{ id: number; firstName: string; lastName: string; payrollCountry?: string }[]>([]);\n  const { organization } = useOrganization();\n  const [periodStart, setPeriodStart] = useState<Date | null>(null);\n  const [periodEnd, setPeriodEnd] = useState<Date | null>(null);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n\n  //  FIX: Prfe Berechtigung fr payroll_reports Tab\n  const payrollAccessLevel = getAccessLevel('payroll_reports', 'tab');\n  const canSeeAllUsers = payrollAccessLevel === 'all_both' || payrollAccessLevel === 'all_read';\n\n  //  FIX: Bei own_both: Direkt eigenen User setzen (kein Dropdown)\n  useEffect(() => {\n    if (!canSeeAllUsers && user?.id && !selectedUser) {\n      // Bei own_both: Direkt eigenen User auswhlen\n      setSelectedUser(user.id);\n    }\n  }, [canSeeAllUsers, user?.id, selectedUser]);\n\n  //  FIX: Filtere User basierend auf Berechtigung\n  const users = useMemo(() => {\n    if (canSeeAllUsers) {\n      return allUsers; // Alle User anzeigen\n    }\n    // Bei own_both: Keine User-Liste ntig (Dropdown wird nicht angezeigt)\n    return [];\n  }, [allUsers, canSeeAllUsers]);\n\n  // Benutzer laden (nur wenn all_both - bei own_both nicht ntig)\n  useEffect(() => {\n    const fetchUsers = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.USERS.DROPDOWN);\n        setAllUsers(response.data);\n      } catch (error) {\n        console.error('Fehler beim Laden der Benutzer:', error);\n        setError(t('payroll.payrollComponent.usersLoadError'));\n      }\n    };\n\n    //  FIX: Nur User laden wenn all_both (bei own_both nicht ntig)\n    if (hasPermission('payroll_reports', 'read', 'tab') && canSeeAllUsers) {\n      fetchUsers();\n    }\n  }, [hasPermission, canSeeAllUsers, t]);\n\n  // Bestehende Abrechnungen laden, wenn ein Benutzer ausgewhlt wird\n  const fetchPayrolls = useCallback(async () => {\n    if (!selectedUser) return;\n\n    setLoading(true);\n    try {\n      const response = await axiosInstance.get(\n        `${API_ENDPOINTS.PAYROLL.BASE}?userId=${selectedUser}`\n      );\n      setPayrolls(response.data);\n      setLoading(false);\n    } catch (error) {\n      console.error('Fehler beim Laden der Abrechnungen:', error);\n      setError(t('payroll.payrollComponent.payrollsLoadError'));\n      setLoading(false);\n    }\n  }, [selectedUser, t]);\n\n  useEffect(() => {\n    if (selectedUser) {\n      fetchPayrolls();\n    }\n  }, [selectedUser, fetchPayrolls]);\n\n  // Helper-Funktion: Berechnet Standard-Periode basierend auf User\n  const getDefaultPeriod = (user: { payrollCountry?: string }): { start: Date; end: Date } => {\n    const now = new Date();\n    let start: Date;\n    let end: Date;\n\n    if (user.payrollCountry === 'CH') {\n      // Schweiz: Monatlich (1. bis 25.)\n      start = new Date(now.getFullYear(), now.getMonth(), 1);\n      end = new Date(now.getFullYear(), now.getMonth(), 25);\n    } else {\n      // Kolumbien: Quinzena (1.-15. oder 16.-Monatsende)\n      if (now.getDate() <= 15) {\n        start = new Date(now.getFullYear(), now.getMonth(), 1);\n        end = new Date(now.getFullYear(), now.getMonth(), 15);\n      } else {\n        start = new Date(now.getFullYear(), now.getMonth(), 16);\n        end = new Date(now.getFullYear(), now.getMonth() + 1, 0);\n      }\n    }\n\n    return { start, end };\n  };\n\n  // Funktion zum Abrufen der vorausgefllten Stunden\n  const fetchPrefilledHours = useCallback(async (userId: number, start: Date, end: Date) => {\n    try {\n      const response = await axiosInstance.get(\n        `${API_ENDPOINTS.PAYROLL.PREFILL_HOURS}?userId=${userId}&periodStart=${start.toISOString()}&periodEnd=${end.toISOString()}`\n      );\n      \n      setHours(response.data);\n    } catch (error) {\n      console.error('Fehler beim Abrufen der vorausgefllten Stunden:', error);\n      // Kein Fehler anzeigen, da dies optional ist\n    }\n  }, []);\n\n  // Beim User-Auswahl: Perioden setzen (Stunden werden durch periodStart/periodEnd useEffect vorausgefllt)\n  useEffect(() => {\n    if (selectedUser && users.length > 0) {\n      const user = users.find(u => u.id === selectedUser);\n      if (user) {\n        const defaultPeriod = getDefaultPeriod(user);\n        setPeriodStart(defaultPeriod.start);\n        setPeriodEnd(defaultPeriod.end);\n      }\n    } else {\n      setPeriodStart(null);\n      setPeriodEnd(null);\n    }\n  }, [selectedUser, users]);\n\n  // Beim Perioden-Wechsel: Stunden neu vorausfllen (nur wenn User bereits ausgewhlt)\n  useEffect(() => {\n    if (selectedUser && periodStart && periodEnd) {\n      fetchPrefilledHours(selectedUser, periodStart, periodEnd);\n    }\n  }, [periodStart, periodEnd, selectedUser, fetchPrefilledHours]);\n\n  const handleUserChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    const userId = Number(e.target.value);\n    setSelectedUser(userId || null);\n    setPayroll(null); // Reset Details bei User-Wechsel\n    setHours({\n      regular: 0,\n      overtime: 0,\n      night: 0,\n      holidayHours: 0,\n      sundayHoliday: 0,\n      overtimeNight: 0,\n      overtimeSundayHoliday: 0,\n      overtimeNightSundayHoliday: 0\n    }); // Reset Stunden\n  };\n\n  const handleHoursChange = (e: React.ChangeEvent<HTMLInputElement>, field: keyof Hours) => {\n    const value = Math.max(0, Number(e.target.value)); // Keine negativen Werte\n    setHours({ ...hours, [field]: value });\n  };\n\n  const saveHours = useCallback(async () => {\n    if (!selectedUser || !periodStart || !periodEnd) {\n      setError(t('payroll.payrollComponent.selectUserAndPeriod'));\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await axiosInstance.post(API_ENDPOINTS.PAYROLL.HOURS, {\n        userId: selectedUser,\n        hours,\n        periodStart: periodStart.toISOString(),\n        periodEnd: periodEnd.toISOString()\n      });\n\n      // Automatisch berechnen\n      const calculatedPayroll = await axiosInstance.get(\n        `${API_ENDPOINTS.PAYROLL.CALCULATE}?payrollId=${response.data.id}`\n      );\n      setPayroll(calculatedPayroll.data);\n\n      // Liste aktualisieren\n      fetchPayrolls();\n\n      setLoading(false);\n    } catch (error: any) {\n      console.error('Fehler beim Speichern der Stunden:', error);\n      \n      // Spezielle Fehlerbehandlung fr doppelte Perioden\n      if (error.response?.status === 400 && error.response?.data?.error?.includes('bereits eine Lohnabrechnung')) {\n        setError(t('payroll.payrollComponent.duplicatePeriodError', { \n          periodStart: periodStart.toLocaleDateString(),\n          periodEnd: periodEnd.toLocaleDateString()\n        }) || error.response.data.error);\n      } else {\n        setError(error.response?.data?.error || t('payroll.payrollComponent.saveError'));\n      }\n      setLoading(false);\n    }\n  }, [selectedUser, hours, periodStart, periodEnd, fetchPayrolls, t]);\n\n  const selectPayroll = useCallback(async (payrollId: number) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await axiosInstance.get(\n        `${API_ENDPOINTS.PAYROLL.CALCULATE}?payrollId=${payrollId}`\n      );\n      setPayroll(response.data);\n      setLoading(false);\n    } catch (error) {\n      console.error('Fehler beim Laden der Abrechnung:', error);\n      setError(t('payroll.payrollComponent.loadError'));\n      setLoading(false);\n    }\n  }, [t]);\n\n  const generatePDF = useCallback(async (payrollId: number) => {\n    try {\n      window.open(\n        `${window.location.origin}${API_ENDPOINTS.PAYROLL.PDF(payrollId)}`,\n        '_blank'\n      );\n    } catch (error) {\n      console.error('Fehler beim Generieren des PDFs:', error);\n      setError(t('payroll.payrollComponent.pdfError'));\n    }\n  }, [t]);\n\n  // Warte auf Berechtigungen\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6\">\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">\n            {t('common.loadingPermissions', { defaultValue: 'Berechtigungen werden geladen...' })}\n          </span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!hasPermission('payroll', 'read')) {\n    return (\n      <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6 text-center\">\n        <p className=\"text-red-800 dark:text-red-200\">\n          {t('payroll.payrollComponent.noPermission')}\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-2xl font-bold mb-6 dark:text-white\">{t('payroll.payrollComponent.title')}</h1>\n\n      {error && (\n        <div className=\"bg-red-100 dark:bg-red-900/20 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-200 px-4 py-3 rounded mb-4\">\n          {error}\n        </div>\n      )}\n\n      {/*  FIX: Dropdown nur anzeigen wenn all_both (bei own_both direkt eigene Abrechnung) */}\n      {canSeeAllUsers && (\n        <div className=\"mb-6\">\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n            {t('payroll.payrollComponent.selectEmployee')}\n          </label>\n          <select\n            className=\"border border-gray-300 dark:border-gray-600 rounded-md p-2 w-full dark:bg-gray-700 dark:text-white\"\n            value={selectedUser || ''}\n            onChange={handleUserChange}\n          >\n            <option value=\"\">-- {t('payroll.payrollComponent.pleaseSelect')} --</option>\n            {users.map(user => (\n              <option key={user.id} value={user.id}>\n                {user.firstName} {user.lastName}\n              </option>\n            ))}\n          </select>\n        </div>\n      )}\n\n      {selectedUser && (\n        <>\n          {/* Hinweis bei read-only */}\n          {!canEditPayroll && (\n            <div className=\"mb-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3\">\n              <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n                {t('payroll.payrollComponent.noEditPermission')}\n              </p>\n            </div>\n          )}\n\n          {/* Perioden-Auswahl */}\n          <div className=\"mb-6\">\n            <h2 className=\"text-xl font-semibold mb-4 dark:text-white\">{t('payroll.payrollComponent.period')}</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('payroll.payrollComponent.periodStart')}\n                </label>\n                <input\n                  type=\"date\"\n                  className=\"border border-gray-300 dark:border-gray-600 rounded-md p-2 w-full dark:bg-gray-700 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed\"\n                  value={periodStart ? periodStart.toISOString().split('T')[0] : ''}\n                  onChange={(e) => {\n                    const date = e.target.value ? new Date(e.target.value) : null;\n                    setPeriodStart(date);\n                  }}\n                  disabled={!canEditPayroll}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('payroll.payrollComponent.periodEnd')}\n                </label>\n                <input\n                  type=\"date\"\n                  className=\"border border-gray-300 dark:border-gray-600 rounded-md p-2 w-full dark:bg-gray-700 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed\"\n                  value={periodEnd ? periodEnd.toISOString().split('T')[0] : ''}\n                  onChange={(e) => {\n                    const date = e.target.value ? new Date(e.target.value) : null;\n                    setPeriodEnd(date);\n                  }}\n                  disabled={!canEditPayroll}\n                />\n              </div>\n            </div>\n          </div>\n\n          <div className=\"mb-6\">\n            <h2 className=\"text-xl font-semibold mb-4 dark:text-white\">{t('payroll.payrollComponent.enterHours')}</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('payroll.payrollComponent.regularHours')}\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"0\"\n                  step=\"0.5\"\n                  className=\"border border-gray-300 dark:border-gray-600 rounded-md p-2 w-full dark:bg-gray-700 dark:text-white\"\n                  value={hours.regular}\n                  onChange={(e) => handleHoursChange(e, 'regular')}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('payroll.payrollComponent.overtimeHours')}\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"0\"\n                  step=\"0.5\"\n                  className=\"border border-gray-300 dark:border-gray-600 rounded-md p-2 w-full dark:bg-gray-700 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed\"\n                  value={hours.overtime}\n                  onChange={(e) => handleHoursChange(e, 'overtime')}\n                  disabled={!canEditPayroll}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('payroll.payrollComponent.nightHours')}\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"0\"\n                  step=\"0.5\"\n                  className=\"border border-gray-300 dark:border-gray-600 rounded-md p-2 w-full dark:bg-gray-700 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed\"\n                  value={hours.night}\n                  onChange={(e) => handleHoursChange(e, 'night')}\n                  disabled={!canEditPayroll}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('payroll.payrollComponent.holidayHours')}\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"0\"\n                  step=\"0.5\"\n                  className=\"border border-gray-300 dark:border-gray-600 rounded-md p-2 w-full dark:bg-gray-700 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed\"\n                  value={hours.holidayHours}\n                  onChange={(e) => handleHoursChange(e, 'holidayHours')}\n                  disabled={!canEditPayroll}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('payroll.payrollComponent.sundayHolidayHours')}\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"0\"\n                  step=\"0.5\"\n                  className=\"border border-gray-300 dark:border-gray-600 rounded-md p-2 w-full dark:bg-gray-700 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed\"\n                  value={hours.sundayHoliday}\n                  onChange={(e) => handleHoursChange(e, 'sundayHoliday')}\n                  disabled={!canEditPayroll}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('payroll.payrollComponent.overtimeNightHours')}\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"0\"\n                  step=\"0.5\"\n                  className=\"border border-gray-300 dark:border-gray-600 rounded-md p-2 w-full dark:bg-gray-700 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed\"\n                  value={hours.overtimeNight}\n                  onChange={(e) => handleHoursChange(e, 'overtimeNight')}\n                  disabled={!canEditPayroll}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('payroll.payrollComponent.overtimeSundayHolidayHours')}\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"0\"\n                  step=\"0.5\"\n                  className=\"border border-gray-300 dark:border-gray-600 rounded-md p-2 w-full dark:bg-gray-700 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed\"\n                  value={hours.overtimeSundayHoliday}\n                  onChange={(e) => handleHoursChange(e, 'overtimeSundayHoliday')}\n                  disabled={!canEditPayroll}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('payroll.payrollComponent.overtimeNightSundayHolidayHours')}\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"0\"\n                  step=\"0.5\"\n                  className=\"border border-gray-300 dark:border-gray-600 rounded-md p-2 w-full dark:bg-gray-700 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed\"\n                  value={hours.overtimeNightSundayHoliday}\n                  onChange={(e) => handleHoursChange(e, 'overtimeNightSundayHoliday')}\n                  disabled={!canEditPayroll}\n                />\n              </div>\n            </div>\n\n            <button\n              className=\"mt-4 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:bg-blue-300 dark:disabled:bg-blue-800 disabled:cursor-not-allowed\"\n              onClick={saveHours}\n              disabled={loading || !canEditPayroll}\n            >\n              {loading ? t('payroll.payrollComponent.saving') : t('payroll.payrollComponent.saveAndCalculate')}\n            </button>\n          </div>\n\n          {payrolls.length > 0 && (\n            <div className=\"mb-6\">\n              <h2 className=\"text-xl font-semibold mb-4 dark:text-white\">{t('payroll.payrollComponent.existingPayrolls')}</h2>\n              <div className=\"overflow-x-auto\">\n                <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                  <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                    <tr>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                        {t('payroll.payrollComponent.period')}\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                        {t('payroll.payrollComponent.totalHours')}\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                        {t('payroll.payrollComponent.grossPay')}\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                        {t('payroll.payrollComponent.netPay')}\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                        {t('payroll.payrollComponent.actions')}\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                    {payrolls.map(item => (\n                      <tr key={item.id}>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100\">\n                          {new Date(item.periodStart).toLocaleDateString()} - {new Date(item.periodEnd).toLocaleDateString()}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100\">\n                          {item.regularHours + item.overtimeHours + item.nightHours + item.holidayHours +\n                           item.sundayHolidayHours + item.overtimeNightHours + item.overtimeSundayHolidayHours +\n                           item.overtimeNightSundayHolidayHours}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100\">\n                          {formatCurrency(Number(item.grossPay), item.currency)}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100\">\n                          {formatCurrency(Number(item.netPay), item.currency)}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm\">\n                          <button\n                            className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 mr-3\"\n                            onClick={() => selectPayroll(item.id)}\n                          >\n                            {t('payroll.payrollComponent.details')}\n                          </button>\n                          <button\n                            className=\"text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300\"\n                            onClick={() => generatePDF(item.id)}\n                          >\n                            PDF\n                          </button>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          )}\n\n          {payroll && (\n            <div className=\"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow-sm\">\n              <h2 className=\"text-xl font-semibold mb-4 dark:text-white\">{t('payroll.payrollComponent.payrollDetails')}</h2>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\n                <div>\n                  <h3 className=\"font-medium text-gray-700 dark:text-gray-300\">{t('payroll.payrollComponent.employee')}</h3>\n                  <p className=\"text-gray-900 dark:text-gray-100\">{payroll.user.firstName} {payroll.user.lastName}</p>\n                </div>\n                <div>\n                  <h3 className=\"font-medium text-gray-700 dark:text-gray-300\">{t('payroll.payrollComponent.period')}</h3>\n                  <p className=\"text-gray-900 dark:text-gray-100\">{new Date(payroll.periodStart).toLocaleDateString()} - {new Date(payroll.periodEnd).toLocaleDateString()}</p>\n                </div>\n                <div>\n                  <h3 className=\"font-medium text-gray-700 dark:text-gray-300\">{t('payroll.payrollComponent.country')}</h3>\n                  <p className=\"text-gray-900 dark:text-gray-100\">{t(`countries.${payroll.user.payrollCountry}`)}</p>\n                </div>\n                {payroll.user.payrollCountry === 'CO' && payroll.user.contractType && (\n                  <div>\n                    <h3 className=\"font-medium text-gray-700 dark:text-gray-300\">{t('payroll.payrollComponent.contractType')}</h3>\n                    <p className=\"text-gray-900 dark:text-gray-100\">{formatContractType(payroll.user.contractType, t)}</p>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"border-t border-gray-200 dark:border-gray-600 pt-4 mb-4\">\n                <h3 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('payroll.payrollComponent.workingHours')}</h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n                  <div>\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">{t('payroll.payrollComponent.regularHours')}</p>\n                    <p className=\"font-medium text-gray-900 dark:text-gray-100\">{payroll.regularHours}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">{t('payroll.payrollComponent.overtimeHours')}</p>\n                    <p className=\"font-medium text-gray-900 dark:text-gray-100\">{payroll.overtimeHours}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">{t('payroll.payrollComponent.nightHours')}</p>\n                    <p className=\"font-medium text-gray-900 dark:text-gray-100\">{payroll.nightHours}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">{t('payroll.payrollComponent.holidaySundayHours')}</p>\n                    <p className=\"font-medium text-gray-900 dark:text-gray-100\">{payroll.holidayHours + payroll.sundayHolidayHours}</p>\n                  </div>\n                  {payroll.user.payrollCountry === 'CO' && (\n                    <>\n                      <div>\n                        <p className=\"text-sm text-gray-500 dark:text-gray-400\">{t('payroll.payrollComponent.overtimeNightHours')}</p>\n                        <p className=\"font-medium text-gray-900 dark:text-gray-100\">{payroll.overtimeNightHours}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-gray-500 dark:text-gray-400\">{t('payroll.payrollComponent.overtimeSundayHolidayHours')}</p>\n                        <p className=\"font-medium text-gray-900 dark:text-gray-100\">{payroll.overtimeSundayHolidayHours}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-gray-500 dark:text-gray-400\">{t('payroll.payrollComponent.overtimeNightSundayHolidayHours')}</p>\n                        <p className=\"font-medium text-gray-900 dark:text-gray-100\">{payroll.overtimeNightSundayHolidayHours}</p>\n                      </div>\n                    </>\n                  )}\n                </div>\n              </div>\n\n              <div className=\"border-t border-gray-200 dark:border-gray-600 pt-4\">\n                <h3 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('payroll.payrollComponent.calculation')}</h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  <div>\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">{t('payroll.payrollComponent.hourlyRate')}</p>\n                    <p className=\"font-medium text-gray-900 dark:text-gray-100\">{formatCurrency(Number(payroll.hourlyRate), payroll.currency)}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">{t('payroll.payrollComponent.grossPay')}</p>\n                    <p className=\"font-medium text-gray-900 dark:text-gray-100\">{formatCurrency(Number(payroll.grossPay), payroll.currency)}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">{t('payroll.payrollComponent.socialSecurity')}</p>\n                    <p className=\"font-medium text-gray-900 dark:text-gray-100\">{formatCurrency(Number(payroll.socialSecurity), payroll.currency)}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">{t('payroll.payrollComponent.taxes')}</p>\n                    <p className=\"font-medium text-gray-900 dark:text-gray-100\">{formatCurrency(Number(payroll.taxes), payroll.currency)}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">{t('payroll.payrollComponent.netPay')}</p>\n                    <p className=\"font-medium font-bold text-gray-900 dark:text-gray-100\">{formatCurrency(Number(payroll.netPay), payroll.currency)}</p>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"mt-6\">\n                <button\n                  className=\"bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-600\"\n                  onClick={() => generatePDF(payroll.id)}\n                >\n                  {t('payroll.payrollComponent.generatePDF')}\n                </button>\n\n                <div className=\"mt-4 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md\">\n                  <h3 className=\"font-medium text-blue-800 dark:text-blue-200 mb-2\">{t('payroll.payrollComponent.paymentInstruction')}</h3>\n                  <p className=\"text-blue-700 dark:text-blue-300\"><strong>{t('payroll.payrollComponent.recipient')}:</strong> {payroll.user.firstName} {payroll.user.lastName}</p>\n                  <p className=\"text-blue-700 dark:text-blue-300\"><strong>{t('payroll.payrollComponent.amount')}:</strong> {formatCurrency(Number(payroll.netPay), payroll.currency)}</p>\n                  <p className=\"text-blue-700 dark:text-blue-300\"><strong>{t('payroll.payrollComponent.paymentReason')}:</strong> {t('payroll.payrollComponent.salary')} {new Date(payroll.periodStart).toLocaleDateString()} - {new Date(payroll.periodEnd).toLocaleDateString()}</p>\n                  <p className=\"text-blue-700 dark:text-blue-300\"><strong>{t('payroll.payrollComponent.payUntil')}:</strong> {new Date(new Date(payroll.periodEnd).getTime() + 5 * 24 * 60 * 60 * 1000).toLocaleDateString()}</p>\n                </div>\n              </div>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\n// Hilfsfunktion zum Formatieren der Vertragsart (wird innerhalb der Komponente verwendet)\nconst formatContractType = (contractType: string, t: (key: string) => string): string => {\n  const translationKey = `payroll.payrollComponent.contractTypes.${contractType}`;\n  const translated = t(translationKey);\n  // Falls bersetzung nicht gefunden, gib den contractType zurck\n  return translated !== translationKey ? translated : contractType;\n};\n\nexport default PayrollComponent;\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { \n  XMarkIcon, \n  DocumentArrowDownIcon,\n  CurrencyDollarIcon,\n  CalendarIcon,\n  UserIcon,\n  BuildingOfficeIcon,\n  ClockIcon,\n  ArrowPathIcon,\n  LinkIcon\n} from '@heroicons/react/24/outline';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport useMessage from '../hooks/useMessage.ts';\nimport { calculateDuration, formatTime } from '../utils/dateUtils.ts';\n\ninterface InvoiceDetail {\n  id: number;\n  invoiceNumber: string;\n  clientId: number;\n  userId: number;\n  issueDate: string;\n  dueDate: string;\n  status: 'DRAFT' | 'SENT' | 'PAID' | 'OVERDUE' | 'CANCELLED';\n  subtotal: number;\n  vatRate?: number;\n  vatAmount?: number;\n  total: number;\n  currency: string;\n  paymentTerms: string;\n  notes?: string;\n  pdfPath?: string;\n  qrReference?: string;\n  createdAt: string;\n  updatedAt: string;\n  client: {\n    id: number;\n    name: string;\n    company?: string;\n    email?: string;\n    phone?: string;\n    address?: string;\n  };\n  user: {\n    id: number;\n    firstName: string;\n    lastName: string;\n    email: string;\n  };\n  items: Array<{\n    id: number;\n    description: string;\n    quantity: number;\n    unitPrice: number;\n    amount: number;\n    workTime: {\n      id: number;\n      startTime: string;\n      endTime: string;\n      notes?: string;\n      branch: {\n        name: string;\n      };\n    };\n  }>;\n  payments: Array<{\n    id: number;\n    amount: number;\n    paymentDate: string;\n    paymentMethod: string;\n    reference?: string;\n    notes?: string;\n    createdAt: string;\n  }>;\n}\n\ninterface InvoiceDetailModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  invoiceId: number;\n  onInvoiceUpdated: () => void;\n}\n\nconst getStatusBadge = (status: InvoiceDetail['status']) => {\n  const statusConfig = {\n    DRAFT: { label: 'Entwurf', color: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300' },\n    SENT: { label: 'Gesendet', color: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300' },\n    PAID: { label: 'Bezahlt', color: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300' },\n    OVERDUE: { label: 'berfllig', color: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300' },\n    CANCELLED: { label: 'Storniert', color: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300' }\n  };\n\n  const config = statusConfig[status];\n  return (\n    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${config.color}`}>\n      {config.label}\n    </span>\n  );\n};\n\nconst InvoiceDetailModal: React.FC<InvoiceDetailModalProps> = ({\n  isOpen,\n  onClose,\n  invoiceId,\n  onInvoiceUpdated\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [invoice, setInvoice] = useState<InvoiceDetail | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isMarkingAsPaid, setIsMarkingAsPaid] = useState(false);\n\n  useEffect(() => {\n    if (isOpen && invoiceId) {\n      loadInvoiceDetails();\n    }\n  }, [isOpen, invoiceId]);\n\n  const loadInvoiceDetails = async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.CONSULTATION_INVOICES.BY_ID(invoiceId));\n      setInvoice(response.data);\n      setError(null);\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Rechnungsdetails:', error);\n      setError('Fehler beim Laden der Rechnungsdetails');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDownloadPdf = async () => {\n    if (!invoice) return;\n    \n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.CONSULTATION_INVOICES.GENERATE_PDF(invoice.id),\n        { \n          responseType: 'blob',\n          headers: {\n            'Accept': 'application/pdf'\n          }\n        }\n      );\n      \n      // Erstelle Blob und Download-Link\n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const url = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `Rechnung_${invoice.invoiceNumber}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(url);\n      \n      showMessage(t('invoice.downloadSuccess', { defaultValue: 'PDF erfolgreich heruntergeladen' }), 'success');\n    } catch (error: any) {\n      console.error('Fehler beim Download der PDF:', error);\n      showMessage(error.response?.data?.message || t('invoice.downloadError', { defaultValue: 'Fehler beim Download der PDF' }), 'error');\n    }\n  };\n\n  const handleMarkAsPaid = async () => {\n    if (!invoice) return;\n\n    try {\n      setIsMarkingAsPaid(true);\n      \n      await axiosInstance.post(\n        API_ENDPOINTS.CONSULTATION_INVOICES.MARK_PAID(invoice.id),\n        {\n          amount: invoice.total,\n          paymentDate: new Date().toISOString(),\n          paymentMethod: 'Manual',\n          reference: 'Manuelle Zahlung'\n        }\n      );\n      \n      showMessage(t('invoice.markPaidSuccess', { defaultValue: 'Rechnung als bezahlt markiert' }), 'success');\n      loadInvoiceDetails(); // Refresh details\n      onInvoiceUpdated(); // Refresh parent list\n    } catch (error: any) {\n      showMessage(error.response?.data?.message || t('invoice.markPaidError', { defaultValue: 'Fehler beim Markieren als bezahlt' }), 'error');\n    } finally {\n      setIsMarkingAsPaid(false);\n    }\n  };\n\n  const getTotalPaid = () => {\n    if (!invoice?.payments) return 0;\n    return invoice.payments.reduce((sum, payment) => sum + Number(payment.amount), 0);\n  };\n\n  const getRemainingAmount = () => {\n    if (!invoice) return 0;\n    return Number(invoice.total) - getTotalPaid();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      \n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n        <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\n          <div className=\"p-6\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between mb-6\">\n              <div className=\"flex items-center space-x-4\">\n                <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                  Rechnungsdetails\n                </Dialog.Title>\n                {invoice && getStatusBadge(invoice.status)}\n              </div>\n              <button\n                onClick={onClose}\n                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            {loading ? (\n              <div className=\"animate-pulse space-y-4\">\n                <div className=\"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/3\"></div>\n                <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2\"></div>\n                <div className=\"h-32 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n              </div>\n            ) : error ? (\n              <div className=\"text-center text-red-600 dark:text-red-400 py-6\">\n                {error}\n              </div>\n            ) : invoice ? (\n              <div className=\"space-y-6\">\n                {/* Rechnungsinformationen */}\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-6\">\n                  <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\n                    Rechnungsinformationen\n                  </h3>\n                  \n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        Rechnungsnummer\n                      </label>\n                      <p className=\"text-gray-900 dark:text-white font-mono\">\n                        {invoice.invoiceNumber}\n                      </p>\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        Rechnungsdatum\n                      </label>\n                      <p className=\"text-gray-900 dark:text-white\">\n                        {format(new Date(invoice.issueDate), 'dd.MM.yyyy', { locale: de })}\n                      </p>\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        Flligkeitsdatum\n                      </label>\n                      <p className=\"text-gray-900 dark:text-white\">\n                        {format(new Date(invoice.dueDate), 'dd.MM.yyyy', { locale: de })}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Client und Berater Informationen */}\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  {/* Client */}\n                  <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n                    <h3 className=\"text-lg font-medium text-blue-800 dark:text-blue-200 mb-3 flex items-center\">\n                      <UserIcon className=\"h-5 w-5 mr-2\" />\n                      Kunde\n                    </h3>\n                    <div className=\"space-y-2 text-sm\">\n                      <p className=\"font-medium text-gray-900 dark:text-white\">\n                        {invoice.client.name}\n                      </p>\n                      {invoice.client.company && (\n                        <p className=\"text-gray-600 dark:text-gray-400\">\n                          {invoice.client.company}\n                        </p>\n                      )}\n                      {invoice.client.email && (\n                        <p className=\"text-gray-600 dark:text-gray-400\">\n                          {invoice.client.email}\n                        </p>\n                      )}\n                      {invoice.client.phone && (\n                        <p className=\"text-gray-600 dark:text-gray-400\">\n                          {invoice.client.phone}\n                        </p>\n                      )}\n                      {invoice.client.address && (\n                        <p className=\"text-gray-600 dark:text-gray-400\">\n                          {invoice.client.address}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n\n                  {/* Berater */}\n                  <div className=\"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4\">\n                    <h3 className=\"text-lg font-medium text-green-800 dark:text-green-200 mb-3 flex items-center\">\n                      <BuildingOfficeIcon className=\"h-5 w-5 mr-2\" />\n                      Berater\n                    </h3>\n                    <div className=\"space-y-2 text-sm\">\n                      <p className=\"font-medium text-gray-900 dark:text-white\">\n                        {invoice.user.firstName} {invoice.user.lastName}\n                      </p>\n                      <p className=\"text-gray-600 dark:text-gray-400\">\n                        {invoice.user.email}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Beratungen */}\n                <div>\n                  <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4 flex items-center\">\n                    <ClockIcon className=\"h-5 w-5 mr-2\" />\n                    Abgerechnete Beratungen ({invoice.items.length})\n                  </h3>\n                  \n                  <div className=\"overflow-x-auto\">\n                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                      <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                        <tr>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                            Datum & Zeit\n                          </th>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                            Dauer\n                          </th>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                            Niederlassung\n                          </th>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                            Stundensatz\n                          </th>\n                          <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                            Betrag\n                          </th>\n                        </tr>\n                      </thead>\n                      <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                        {invoice.items.map((item) => (\n                          <tr key={item.id} className=\"hover:bg-gray-50 dark:hover:bg-gray-700\">\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200\">\n                              <div>\n                                <div className=\"font-medium\">\n                                  {formatTime(item.workTime.startTime)}\n                                </div>\n                                <div className=\"text-gray-500 dark:text-gray-400 text-xs\">\n                                  {format(new Date(item.workTime.startTime), 'dd.MM.yyyy', { locale: de })}\n                                </div>\n                              </div>\n                            </td>\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200\">\n                              {calculateDuration(item.workTime.startTime, item.workTime.endTime)}\n                            </td>\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200\">\n                              {item.workTime.branch.name}\n                            </td>\n                            <td className=\"px-4 py-2 text-right text-sm text-gray-900 dark:text-gray-200\">\n                              {invoice.currency} {Number(item.unitPrice).toFixed(2)}\n                            </td>\n                            <td className=\"px-4 py-2 text-right text-sm text-gray-900 dark:text-gray-200\">\n                              {invoice.currency} {Number(item.amount).toFixed(2)}\n                            </td>\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n\n                {/* Rechnungssumme */}\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-6\">\n                  <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\n                    Rechnungssumme\n                  </h3>\n                  \n                  <div className=\"space-y-2\">\n                    <div className=\"flex justify-between\">\n                      <span>Zwischensumme:</span>\n                      <span>{invoice.currency} {Number(invoice.subtotal).toFixed(2)}</span>\n                    </div>\n                    {invoice.vatRate && invoice.vatAmount && (\n                      <div className=\"flex justify-between\">\n                        <span>MwSt. ({Number(invoice.vatRate).toFixed(1)}%):</span>\n                        <span>{invoice.currency} {Number(invoice.vatAmount).toFixed(2)}</span>\n                      </div>\n                    )}\n                    <div className=\"flex justify-between border-t border-gray-200 dark:border-gray-600 pt-2 font-bold\">\n                      <span>Gesamtbetrag:</span>\n                      <span>{invoice.currency} {Number(invoice.total).toFixed(2)}</span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Zahlungen */}\n                {invoice.payments.length > 0 && (\n                  <div>\n                    <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4 flex items-center\">\n                      <CurrencyDollarIcon className=\"h-5 w-5 mr-2\" />\n                      Zahlungen ({invoice.payments.length})\n                    </h3>\n                    \n                    <div className=\"space-y-3\">\n                      {invoice.payments.map((payment) => (\n                        <div\n                          key={payment.id}\n                          className=\"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4\"\n                        >\n                          <div className=\"flex justify-between items-start\">\n                            <div>\n                              <p className=\"font-medium text-green-800 dark:text-green-200\">\n                                {invoice.currency} {Number(payment.amount).toFixed(2)}\n                              </p>\n                              <p className=\"text-sm text-green-600 dark:text-green-400\">\n                                {format(new Date(payment.paymentDate), 'dd.MM.yyyy HH:mm', { locale: de })}\n                              </p>\n                              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                                {payment.paymentMethod}\n                                {payment.reference && ` - ${payment.reference}`}\n                              </p>\n                            </div>\n                          </div>\n                        </div>\n                      ))}\n                      \n                      {/* Zahlungsbersicht */}\n                      <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n                        <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                          <div>\n                            <span className=\"text-blue-600 dark:text-blue-400\">Bezahlt:</span>\n                            <span className=\"ml-2 font-medium\">\n                              {invoice.currency} {getTotalPaid().toFixed(2)}\n                            </span>\n                          </div>\n                          <div>\n                            <span className=\"text-blue-600 dark:text-blue-400\">Ausstehend:</span>\n                            <span className=\"ml-2 font-medium\">\n                              {invoice.currency} {getRemainingAmount().toFixed(2)}\n                            </span>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {/* Notizen */}\n                {invoice.notes && (\n                  <div>\n                    <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\n                      Notizen\n                    </h3>\n                    <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4\">\n                      <p className=\"text-gray-900 dark:text-white whitespace-pre-wrap\">\n                        {invoice.notes}\n                      </p>\n                    </div>\n                  </div>\n                )}\n\n                {/* Aktionen */}\n                <div className=\"flex items-center justify-end space-x-3 pt-6 border-t border-gray-200 dark:border-gray-700\">\n                  <button\n                    onClick={handleDownloadPdf}\n                    className=\"p-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 rounded-md\"\n                    title=\"PDF herunterladen\"\n                  >\n                    <DocumentArrowDownIcon className=\"h-5 w-5\" />\n                  </button>\n                  \n                  {invoice.status !== 'PAID' && invoice.status !== 'CANCELLED' && getRemainingAmount() > 0 && (\n                    <button\n                      onClick={handleMarkAsPaid}\n                      disabled={isMarkingAsPaid}\n                      className=\"p-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 dark:bg-green-700 dark:hover:bg-green-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={isMarkingAsPaid ? 'Verarbeitung...' : 'Als bezahlt markieren'}\n                    >\n                      {isMarkingAsPaid ? (\n                        <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                      ) : (\n                        <CurrencyDollarIcon className=\"h-5 w-5\" />\n                      )}\n                    </button>\n                  )}\n                  \n                  <button\n                    onClick={onClose}\n                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                    title={t('common.close')}\n                  >\n                    <XMarkIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              </div>\n            ) : null}\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default InvoiceDetailModal; ","import React, { useState, useEffect, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { \n  MagnifyingGlassIcon,\n  FunnelIcon,\n  ArrowsUpDownIcon,\n  DocumentArrowDownIcon,\n  PlusIcon,\n  CurrencyDollarIcon,\n  ChevronDownIcon,\n  PencilIcon,\n  TrashIcon,\n  CheckIcon,\n  XMarkIcon,\n  ArrowPathIcon,\n  CalendarIcon,\n  ClockIcon,\n  Squares2X2Icon,\n  TableCellsIcon,\n  UserIcon,\n  BuildingOfficeIcon\n} from '@heroicons/react/24/outline';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useTableSettings } from '../hooks/useTableSettings.ts';\nimport TableColumnConfig from '../components/TableColumnConfig.tsx';\nimport FilterPane from '../components/FilterPane.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport InvoiceDetailModal from '../components/InvoiceDetailModal.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport { applyFilters } from '../utils/filterLogic.ts';\nimport { toast } from 'react-toastify';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport DataCard, { MetadataItem } from '../components/shared/DataCard.tsx';\nimport CardGrid from '../components/shared/CardGrid.tsx';\n\ninterface ConsultationInvoice {\n  id: number;\n  invoiceNumber: string;\n  clientId: number;\n  userId: number;\n  issueDate: string;\n  dueDate: string;\n  status: 'DRAFT' | 'SENT' | 'PAID' | 'OVERDUE' | 'CANCELLED';\n  subtotal: number;\n  vatRate?: number;\n  vatAmount?: number;\n  total: number;\n  currency: string;\n  paymentTerms: string;\n  notes?: string;\n  pdfPath?: string;\n  qrReference?: string;\n  createdAt: string;\n  updatedAt: string;\n  client: {\n    id: number;\n    name: string;\n    company?: string;\n    email?: string;\n  };\n  user: {\n    id: number;\n    firstName: string;\n    lastName: string;\n  };\n  items: Array<{\n    id: number;\n    description: string;\n    quantity: number;\n    unitPrice: number;\n    amount: number;\n  }>;\n  payments?: Array<{\n    id: number;\n    amount: number;\n    paymentDate: string;\n    paymentMethod: string;\n    reference?: string;\n  }>;\n}\n\ninterface SortConfig {\n  key: keyof ConsultationInvoice | 'client.name';\n  direction: 'asc' | 'desc';\n}\n\n// Standardreihenfolge der Spalten (IDs)\nconst defaultColumnOrder = ['expand', 'invoiceNumber', 'client', 'issueDate', 'dueDate', 'total', 'status', 'actions'];\nconst INVOICES_TABLE_ID = 'invoice-management';\n\n// Card-Einstellungen Standardwerte\nconst defaultCardMetadata = ['invoiceNumber', 'client', 'issueDate', 'dueDate', 'total', 'status'];\nconst defaultCardColumnOrder = ['invoiceNumber', 'client', 'issueDate', 'dueDate', 'total', 'status'];\n//  ENTFERNT: defaultCardSortDirections\n// Hauptsortierung wird jetzt aus Settings geladen (pro Benutzer gespeichert)\n\n// Mapping zwischen Tabellen-Spalten-IDs und Card-Metadaten-IDs\nconst tableToCardMapping: Record<string, string[]> = {\n  'expand': [], // Keine Card-Entsprechung\n  'invoiceNumber': ['invoiceNumber'],\n  'client': ['client'],\n  'issueDate': ['issueDate'],\n  'dueDate': ['dueDate'],\n  'total': ['total'],\n  'status': ['status'],\n  'actions': [] // Keine Card-Entsprechung\n};\n\n// Reverse Mapping: Card-Metadaten -> Tabellen-Spalten\nconst cardToTableMapping: Record<string, string> = {\n  'invoiceNumber': 'invoiceNumber',\n  'client': 'client',\n  'issueDate': 'issueDate',\n  'dueDate': 'dueDate',\n  'total': 'total',\n  'status': 'status'\n};\n\n// Helfer-Funktion: Tabellen-Spalte ausgeblendet -> Card-Metadaten ausblenden\nconst getHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n  const hiddenCardMetadata = new Set<string>();\n  hiddenTableColumns.forEach(tableCol => {\n    const cardMetadata = tableToCardMapping[tableCol] || [];\n    cardMetadata.forEach(cardMeta => hiddenCardMetadata.add(cardMeta));\n  });\n  return hiddenCardMetadata;\n};\n\n// Helfer-Funktion: Card-Metadaten zu Tabellen-Spalten konvertieren\nconst getCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n  const cardMetadata: string[] = [];\n  columnOrder.forEach(tableCol => {\n    const cardMeta = tableToCardMapping[tableCol];\n    if (cardMeta && cardMeta.length > 0) {\n      cardMetadata.push(...cardMeta);\n    }\n  });\n  return cardMetadata;\n};\n\n\ninterface InvoiceManagementTabProps {\n  selectedInvoiceId?: number | null;\n}\n\nconst InvoiceManagementTab: React.FC<InvoiceManagementTabProps> = ({ selectedInvoiceId: initialSelectedInvoiceId }) => {\n  const { t } = useTranslation();\n  const { hasPermission } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [invoices, setInvoices] = useState<ConsultationInvoice[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  \n  // Filter States\n  const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  // Detail Modal State\n  const [selectedInvoiceId, setSelectedInvoiceId] = useState<number | null>(initialSelectedInvoiceId || null);\n  const [isDetailModalOpen, setIsDetailModalOpen] = useState(false);\n  \n  // Expand/Collapse States (nach Tasks & Requests Standard)\n  const [expandedRows, setExpandedRows] = useState<Set<number>>(new Set());\n  \n  // Sidepane States (nach Tasks & Requests Standard) \n  const [isEditSidepaneOpen, setIsEditSidepaneOpen] = useState(false);\n  const [editingInvoice, setEditingInvoice] = useState<ConsultationInvoice | null>(null);\n  \n  // Position States fr Position-Bearbeitung innerhalb Sidepane\n  const [editingPositions, setEditingPositions] = useState<Record<number, any[]>>({});\n  \n  // Berechtigungsprfungen\n  const canViewInvoices = hasPermission('consultation_invoices', 'read', 'table');\n  const canEditInvoices = hasPermission('invoice_mark_paid', 'write', 'button');\n  const canDownloadInvoices = hasPermission('invoice_download', 'read', 'button');\n  \n  // Table Settings\n  const {\n    settings,\n    isLoading: isLoadingSettings,\n    updateColumnOrder,\n    updateHiddenColumns,\n    toggleColumnVisibility,\n    isColumnVisible,\n    updateViewMode,\n    updateSortConfig\n  } = useTableSettings(INVOICES_TABLE_ID, {\n    defaultColumnOrder,\n    defaultHiddenColumns: [],\n    defaultViewMode: 'cards'\n  });\n\n  const [isColumnConfigOpen, setIsColumnConfigOpen] = useState(false);\n\n  // Verfgbare Spalten (dynamisch aus bersetzungen)\n  const availableColumns = useMemo(() => [\n    { id: 'expand', label: '', shortLabel: '' }, // Expand-Button Spalte\n    { id: 'invoiceNumber', label: t('invoices.columns.invoiceNumber'), shortLabel: t('invoices.columns.invoiceNumber').substring(0, 2) },\n    { id: 'client', label: t('invoices.columns.client'), shortLabel: t('invoices.columns.client') },\n    { id: 'issueDate', label: t('invoices.columns.issueDate'), shortLabel: t('common.today').substring(0, 3) },\n    { id: 'dueDate', label: t('invoices.columns.dueDate'), shortLabel: t('invoices.columns.dueDate').substring(0, 5) },\n    { id: 'total', label: t('invoices.columns.total'), shortLabel: t('invoices.columns.total') },\n    { id: 'status', label: t('invoices.columns.status'), shortLabel: t('invoices.columns.status') },\n    { id: 'actions', label: t('common.actions'), shortLabel: t('common.actions').substring(0, 3) }\n  ], [t]);\n  \n  // Hauptsortierung aus Settings laden (fr Table & Cards synchron)\n  const sortConfig: SortConfig = settings.sortConfig || { key: 'issueDate', direction: 'desc' };\n  \n  // Hauptsortierung Handler (fr Table & Cards synchron)\n  const handleMainSortChange = (key: string, direction: 'asc' | 'desc') => {\n    updateSortConfig({ key: key as SortConfig['key'], direction });\n  };\n  \n  // Status-Konfiguration (mit bersetzungen)\n  const statusConfig = useMemo(() => ({\n    DRAFT: { label: t('invoices.status.draft'), color: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300' },\n    SENT: { label: t('invoices.status.sent'), color: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300' },\n    PAID: { label: t('invoices.status.paid'), color: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300' },\n    OVERDUE: { label: t('invoices.status.overdue'), color: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300' },\n    CANCELLED: { label: t('invoices.status.cancelled'), color: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300' }\n  }), [t]);\n  \n  const getStatusBadge = (status: ConsultationInvoice['status']) => {\n    const config = statusConfig[status];\n    return (\n      <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${config.color}`}>\n        {config.label}\n      </span>\n    );\n  };\n\n  // View-Mode aus Settings laden\n  const viewMode = settings.viewMode || 'cards';\n\n  // Abgeleitete Werte fr Card-Ansicht aus Tabellen-Settings\n  const cardMetadataOrder = useMemo(() => {\n    return getCardMetadataFromColumnOrder(settings.columnOrder || defaultColumnOrder);\n  }, [settings.columnOrder]);\n\n  // Versteckte Card-Metadaten aus hiddenColumns ableiten\n  const hiddenCardMetadata = useMemo(() => {\n    return getHiddenCardMetadata(settings.hiddenColumns || []);\n  }, [settings.hiddenColumns]);\n\n  // Sichtbare Card-Metadaten (alle Card-Metadaten minus versteckte)\n  const visibleCardMetadata = useMemo(() => {\n    return new Set(cardMetadataOrder.filter(meta => !hiddenCardMetadata.has(meta)));\n  }, [cardMetadataOrder, hiddenCardMetadata]);\n\n  // CSS-Klasse fr Container-Box setzen (fr CSS-basierte Schattierungs-Entfernung)\n  useEffect(() => {\n    const wrapper = document.querySelector('.dashboard-invoices-wrapper');\n    if (wrapper) {\n      if (viewMode === 'cards') {\n        wrapper.classList.add('cards-mode');\n      } else {\n        wrapper.classList.remove('cards-mode');\n      }\n    }\n  }, [viewMode]);\n\n  useEffect(() => {\n    loadInvoices();\n  }, []);\n\n  // Auto-open detail modal wenn selectedInvoiceId von auen gesetzt wird\n  useEffect(() => {\n    if (initialSelectedInvoiceId && invoices.length > 0) {\n      const invoice = invoices.find(inv => inv.id === initialSelectedInvoiceId);\n      if (invoice) {\n        setSelectedInvoiceId(initialSelectedInvoiceId);\n        setIsDetailModalOpen(true);\n      }\n    }\n  }, [initialSelectedInvoiceId, invoices]);\n\n  const loadInvoices = async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.CONSULTATION_INVOICES.BASE);\n      setInvoices(response.data);\n      setError(null);\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Rechnungen:', error);\n      setError(t('invoice.loadError'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSort = (key: SortConfig['key']) => {\n    // Table-Header-Sortierung: Aktualisiert Hauptsortierung direkt (synchron fr Table & Cards)\n    const newDirection = sortConfig.key === key && sortConfig.direction === 'asc' ? 'desc' : 'asc';\n    updateSortConfig({ key, direction: newDirection });\n  };\n\n  const handleDownloadPdf = async (invoiceId: number, invoiceNumber: string) => {\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.CONSULTATION_INVOICES.GENERATE_PDF(invoiceId),\n        { \n          responseType: 'blob',\n          headers: {\n            'Accept': 'application/pdf'\n          }\n        }\n      );\n      \n      // Erstelle Blob und Download-Link\n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const url = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `Rechnung_${invoiceNumber}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(url);\n      \n      toast.success(t('invoice.downloadSuccess'));\n    } catch (error: any) {\n      console.error('Fehler beim Download der PDF:', error);\n      toast.error(error.response?.data?.message || t('invoice.downloadError'));\n    }\n  };\n\n  const handleMarkAsPaid = async (invoiceId: number) => {\n    try {\n      await axiosInstance.post(\n        API_ENDPOINTS.CONSULTATION_INVOICES.MARK_PAID(invoiceId),\n        {\n          amount: invoices.find(inv => inv.id === invoiceId)?.total || 0,\n          paymentDate: new Date().toISOString(),\n          paymentMethod: 'Manual',\n          reference: 'Manuelle Zahlung'\n        }\n      );\n      \n      toast.success(t('invoice.markPaidSuccess'));\n      loadInvoices(); // Refresh list\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || t('invoice.markPaidError'));\n    }\n  };\n\n  // Expand/Collapse Handler (nach Tasks & Requests Standard)\n  const toggleExpanded = (invoiceId: number) => {\n    setExpandedRows(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(invoiceId)) {\n        newSet.delete(invoiceId);\n      } else {\n        newSet.add(invoiceId);\n      }\n      return newSet;\n    });\n  };\n\n  // berwache Bildschirmgre\n  useEffect(() => {\n    const handleResize = () => {\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isEditSidepaneOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isEditSidepaneOpen, openSidepane, closeSidepane]);\n\n  // Sidepane Handler (nach Tasks & Requests Standard)\n  const openEditSidepane = (invoice: ConsultationInvoice) => {\n    setEditingInvoice(invoice);\n    setIsEditSidepaneOpen(true);\n  };\n\n  const closeEditSidepane = () => {\n    setIsEditSidepaneOpen(false);\n    setEditingInvoice(null);\n    setEditingPositions({});\n  };\n\n  // Filter-Funktionen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n  \n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  // Gefilterte und sortierte Rechnungen\n  const filteredAndSortedInvoices = useMemo(() => {\n    let filtered = invoices;\n\n    // Globale Suche\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(invoice => {\n        //  OPTIMIERUNG: Frhes Beenden bei Match\n        if (invoice.invoiceNumber.toLowerCase().includes(searchLower)) return true;\n        if (invoice.client.name.toLowerCase().includes(searchLower)) return true;\n        if (invoice.client.company && invoice.client.company.toLowerCase().includes(searchLower)) return true;\n        \n        //  OPTIMIERUNG: Template-String nur wenn ntig\n        const userName = `${invoice.user.firstName} ${invoice.user.lastName}`.toLowerCase();\n        if (userName.includes(searchLower)) return true;\n        \n        return false; // Kein Match gefunden\n      });\n    }\n\n    // Erweiterte Filter anwenden mit zentraler Filter-Logik\n    if (filterConditions.length > 0) {\n      // Column-Evaluatoren fr Invoices (exakt gleiche Logik wie vorher)\n      const columnEvaluators: any = {\n        'client': (invoice: ConsultationInvoice, cond: FilterCondition) => {\n          const clientName = invoice.client.name.toLowerCase();\n          const value = (cond.value as string || '').toLowerCase();\n          if (cond.operator === 'contains') return clientName.includes(value);\n          if (cond.operator === 'equals') return invoice.client.name === cond.value;\n          return null;\n        },\n        'status': (invoice: ConsultationInvoice, cond: FilterCondition) => {\n          if (cond.operator === 'equals') return invoice.status === cond.value;\n          return null;\n        },\n        'total': (invoice: ConsultationInvoice, cond: FilterCondition) => {\n          const amount = invoice.total;\n          const compareValue = parseFloat(cond.value as string);\n          if (isNaN(compareValue)) return false;\n          if (cond.operator === 'greaterThan') return amount > compareValue;\n          if (cond.operator === 'lessThan') return amount < compareValue;\n          if (cond.operator === 'equals') return Math.abs(amount - compareValue) < 0.01;\n          return null;\n        }\n      };\n\n      const getFieldValue = (invoice: ConsultationInvoice, columnId: string): any => {\n        switch (columnId) {\n          case 'client': return invoice.client.name;\n          case 'status': return invoice.status;\n          case 'total': return invoice.total;\n          default: return (invoice as any)[columnId];\n        }\n      };\n\n      filtered = applyFilters(\n        filtered,\n        filterConditions,\n        filterLogicalOperators,\n        getFieldValue,\n        columnEvaluators\n      );\n    }\n\n    // Sortierung\n    if (viewMode === 'cards') {\n      // Multi-Sortierung fr Cards-Mode\n      const sortableColumns = cardMetadataOrder.filter(colId => visibleCardMetadata.has(colId));\n      \n      filtered.sort((a, b) => {\n        for (const columnId of sortableColumns) {\n          const direction = cardSortDirections[columnId] || 'asc';\n          let valueA: any, valueB: any;\n          \n          switch (columnId) {\n            case 'invoiceNumber':\n              valueA = a.invoiceNumber.toLowerCase();\n              valueB = b.invoiceNumber.toLowerCase();\n              break;\n            case 'client':\n              valueA = a.client.name.toLowerCase();\n              valueB = b.client.name.toLowerCase();\n              break;\n            case 'issueDate':\n              valueA = new Date(a.issueDate).getTime();\n              valueB = new Date(b.issueDate).getTime();\n              break;\n            case 'dueDate':\n              valueA = new Date(a.dueDate).getTime();\n              valueB = new Date(b.dueDate).getTime();\n              break;\n            case 'total':\n              valueA = Number(a.total);\n              valueB = Number(b.total);\n              break;\n            case 'status':\n              valueA = a.status.toLowerCase();\n              valueB = b.status.toLowerCase();\n              break;\n            default:\n              continue; // berspringe unbekannte Spalten\n          }\n          \n          // Vergleich basierend auf Typ\n          let comparison = 0;\n          if (typeof valueA === 'number' && typeof valueB === 'number') {\n            comparison = valueA - valueB;\n          } else {\n            //  OPTIMIERUNG: Vermeide String() Konvertierung wenn bereits String\n            const strA = typeof valueA === 'string' ? valueA : String(valueA);\n            const strB = typeof valueB === 'string' ? valueB : String(valueB);\n            comparison = strA.localeCompare(strB);\n          }\n          \n          // Sortierrichtung anwenden\n          if (direction === 'desc') {\n            comparison = -comparison;\n          }\n          \n          // Wenn unterschiedlich, gebe Vergleich zurck\n          if (comparison !== 0) {\n            return comparison;\n          }\n        }\n        return 0; // Alle Spalten identisch\n      });\n    } else {\n      // Tabellen-Mode: Einzel-Sortierung wie bisher\n      filtered.sort((a, b) => {\n        let aValue: any;\n        let bValue: any;\n\n        switch (sortConfig.key) {\n          case 'issueDate':\n            aValue = new Date(a.issueDate).getTime();\n            bValue = new Date(b.issueDate).getTime();\n            break;\n          case 'dueDate':\n            aValue = new Date(a.dueDate).getTime();\n            bValue = new Date(b.dueDate).getTime();\n            break;\n          case 'client.name':\n            aValue = a.client.name;\n            bValue = b.client.name;\n            break;\n          case 'total':\n            aValue = a.total;\n            bValue = b.total;\n            break;\n          case 'invoiceNumber':\n            aValue = a.invoiceNumber;\n            bValue = b.invoiceNumber;\n            break;\n          default:\n            return 0;\n        }\n\n        if (aValue < bValue) return sortConfig.direction === 'asc' ? -1 : 1;\n        if (aValue > bValue) return sortConfig.direction === 'asc' ? 1 : -1;\n        return 0;\n      });\n    }\n\n    return filtered;\n  }, [invoices, searchTerm, filterConditions, filterLogicalOperators, sortConfig, viewMode, cardMetadataOrder, visibleCardMetadata]);\n\n  const renderSortableHeader = (columnId: string, label: string, sortKey?: SortConfig['key']) => (\n    <th\n      key={columnId}\n      className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer select-none\"\n      onClick={() => sortKey && handleSort(sortKey)}\n    >\n      <div className=\"flex items-center space-x-1\">\n        <span>{label}</span>\n        {sortKey && sortConfig.key === sortKey && (\n          <span>{sortConfig.direction === 'asc' ? '' : ''}</span>\n        )}\n      </div>\n    </th>\n  );\n\n  if (loading && invoices.length === 0) {\n    return (\n      <div className=\"animate-pulse\">\n        <div className=\"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-4\"></div>\n        <div className=\"space-y-3\">\n          {[...Array(5)].map((_, i) => (\n            <div key={i} className=\"h-12 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  // Prfe Berechtigungen\n  if (!canViewInvoices) {\n    return (\n      <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-4\">\n        <div className=\"flex\">\n          <div className=\"ml-3\">\n            <h3 className=\"text-sm font-medium text-red-800 dark:text-red-200\">\n              Keine Berechtigung\n            </h3>\n            <div className=\"mt-2 text-sm text-red-700 dark:text-red-300\">\n              <p>Sie haben keine Berechtigung, Rechnungen anzuzeigen.</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-6 px-3 sm:px-4 md:px-6 -mx-3 sm:-mx-4 md:-mx-6\">\n        <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n          Beratungsrechnungen\n        </h2>\n        <div className=\"flex items-center space-x-2\">\n          <div className=\"relative group\">\n            <button\n              onClick={() => setIsFilterModalOpen(true)}\n              className={`p-2 rounded-md ${\n                filterConditions.length > 0\n                  ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400'\n                  : 'bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300'\n              } hover:bg-gray-200 dark:hover:bg-gray-600 relative`}\n            >\n              <FunnelIcon className=\"h-5 w-5\" />\n              {filterConditions.length > 0 && (\n                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                  {filterConditions.length}\n                </span>\n              )}\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('common.filter')}\n            </div>\n          </div>\n          {/* View-Mode Toggle */}\n          <div className=\"relative group\">\n            <button\n              type=\"button\"\n              className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n                viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n              }`}\n              onClick={() => updateViewMode(viewMode === 'table' ? 'cards' : 'table')}\n            >\n              {viewMode === 'table' ? (\n                <Squares2X2Icon className=\"h-5 w-5\" />\n              ) : (\n                <TableCellsIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n            </div>\n          </div>\n          \n          <div className=\"relative group\">\n            <button\n              onClick={() => setIsColumnConfigOpen(true)}\n              className=\"p-2 bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600\"\n            >\n              <ArrowsUpDownIcon className=\"h-5 w-5\" />\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Suchfeld */}\n      <div className=\"relative mb-6 px-3 sm:px-4 md:px-6 -mx-3 sm:-mx-4 md:-mx-6\">\n        <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n          <MagnifyingGlassIcon className=\"h-5 w-5 text-gray-400\" />\n        </div>\n        <input\n          type=\"text\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          className=\"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\n          placeholder={t('invoices.searchPlaceholder')}\n        />\n      </div>\n\n      {/* Gespeicherte Filter */}\n      <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6 -mx-3 sm:-mx-4 md:-mx-6'}>\n        <SavedFilterTags\n        tableId={INVOICES_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n      />\n      </div>\n\n      {/* Tabelle oder Cards */}\n      {error ? (\n        <div className=\"text-center text-red-600 dark:text-red-400 py-6 px-3 sm:px-4 md:px-6 -mx-3 sm:-mx-4 md:-mx-6\">\n          {error}\n        </div>\n      ) : viewMode === 'table' ? (\n        /* Tabellen-Ansicht */\n        <div className=\"dashboard-invoices-wrapper overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n          <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n            <thead className=\"bg-gray-50 dark:bg-gray-700\">\n              <tr>\n                {settings.columnOrder\n                  .filter(columnId => isColumnVisible(columnId))\n                  .map(columnId => {\n                    const column = availableColumns.find(col => col.id === columnId);\n                    if (!column) return null;\n                    \n                    switch (columnId) {\n                      case 'expand':\n                        return (\n                          <th key=\"expand\" className=\"px-3 sm:px-4 md:px-6 py-3 text-left w-12\">\n                            {/* Leerer Header fr Expand-Spalte */}\n                          </th>\n                        );\n                      case 'invoiceNumber':\n                        return renderSortableHeader('invoiceNumber', column.label, 'invoiceNumber');\n                      case 'client':\n                        return renderSortableHeader('client', column.label, 'client.name');\n                      case 'issueDate':\n                        return renderSortableHeader('issueDate', column.label, 'issueDate');\n                      case 'dueDate':\n                        return renderSortableHeader('dueDate', column.label, 'dueDate');\n                      case 'total':\n                        return renderSortableHeader('total', column.label, 'total');\n                      case 'status':\n                        return renderSortableHeader('status', column.label, 'status');\n                      default:\n                        return renderSortableHeader(columnId, column.label);\n                    }\n                  })}\n              </tr>\n            </thead>\n            <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n              {filteredAndSortedInvoices.map((invoice) => (\n                <React.Fragment key={invoice.id}>\n                  <tr className=\"hover:bg-gray-50 dark:hover:bg-gray-700\">\n                    {isColumnVisible('expand') && (\n                      <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                        <div className=\"relative group\">\n                          <button\n                            onClick={() => toggleExpanded(invoice.id)}\n                            className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n                          >\n                            <ChevronDownIcon \n                              className={`h-4 w-4 transition-transform ${\n                                expandedRows.has(invoice.id) ? 'rotate-180' : ''\n                              }`} \n                            />\n                          </button>\n                          <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {expandedRows.has(invoice.id) ? t('common.collapse') : t('common.expand')}\n                          </div>\n                        </div>\n                      </td>\n                    )}\n\n                    {isColumnVisible('invoiceNumber') && (\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-200\">\n                        {invoice.invoiceNumber}\n                      </td>\n                    )}\n                    \n                    {isColumnVisible('client') && (\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200\">\n                        <div>\n                          <div className=\"font-medium\">{invoice.client.name}</div>\n                          {invoice.client.company && (\n                            <div className=\"text-gray-500 dark:text-gray-400 text-xs\">\n                              {invoice.client.company}\n                            </div>\n                          )}\n                        </div>\n                      </td>\n                    )}\n                    \n                    {isColumnVisible('issueDate') && (\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200\">\n                        {format(new Date(invoice.issueDate), 'dd.MM.yyyy', { locale: de })}\n                      </td>\n                    )}\n                    \n                    {isColumnVisible('dueDate') && (\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200\">\n                        {format(new Date(invoice.dueDate), 'dd.MM.yyyy', { locale: de })}\n                      </td>\n                    )}\n                    \n                    {isColumnVisible('total') && (\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200\">\n                        {invoice.currency} {Number(invoice.total).toFixed(2)}\n                      </td>\n                    )}\n                    \n                    {isColumnVisible('status') && (\n                      <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                        {getStatusBadge(invoice.status)}\n                      </td>\n                    )}\n                    \n                    {isColumnVisible('actions') && (\n                      <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                        <div className=\"flex items-center justify-end space-x-2\">\n                          <div className=\"relative group\">\n                            <button\n                              onClick={() => openEditSidepane(invoice)}\n                              className=\"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                            >\n                              <PencilIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('common.edit')}\n                            </div>\n                          </div>\n                          {canDownloadInvoices && (\n                            <div className=\"relative group\">\n                              <button\n                                onClick={() => handleDownloadPdf(invoice.id, invoice.invoiceNumber)}\n                                className=\"text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                              >\n                                <DocumentArrowDownIcon className=\"h-5 w-5\" />\n                              </button>\n                              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('invoices.downloadPDF')}\n                              </div>\n                            </div>\n                          )}\n                          {canEditInvoices && invoice.status !== 'PAID' && invoice.status !== 'CANCELLED' && (\n                            <div className=\"relative group\">\n                              <button\n                                onClick={() => handleMarkAsPaid(invoice.id)}\n                                className=\"text-yellow-600 hover:text-yellow-800 dark:text-yellow-400 dark:hover:text-yellow-300\"\n                              >\n                                <CurrencyDollarIcon className=\"h-5 w-5\" />\n                              </button>\n                              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('invoices.markAsPaid')}\n                              </div>\n                            </div>\n                          )}\n                        </div>\n                      </td>\n                    )}\n                  </tr>\n\n                  {/* Erweiterte Details-Zeile */}\n                  {expandedRows.has(invoice.id) && (\n                    <tr className=\"bg-gray-50 dark:bg-gray-900\">\n                      <td colSpan={settings.columnOrder.filter(col => isColumnVisible(col)).length} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                        <div className=\"space-y-4\">\n                          <h4 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                            {t('invoices.detailsAndPositions')}\n                          </h4>\n                          \n                          {/* Rechnungsinformationen */}\n                          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('invoices.columns.invoiceNumber')}\n                              </label>\n                              <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                {invoice.invoiceNumber}\n                              </div>\n                            </div>\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('invoices.consultant')}\n                              </label>\n                              <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                {invoice.user ? `${invoice.user.firstName} ${invoice.user.lastName}` : t('common.unknown')}\n                              </div>\n                            </div>\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('invoices.paymentTerms')}\n                              </label>\n                              <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                {invoice.paymentTerms}\n                              </div>\n                            </div>\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('invoices.subtotal')}\n                              </label>\n                              <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                {invoice.currency} {Number(invoice.subtotal).toFixed(2)}\n                              </div>\n                            </div>\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('invoices.vat')}\n                              </label>\n                              <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                {invoice.vatAmount ? `${invoice.currency} ${Number(invoice.vatAmount).toFixed(2)} (${invoice.vatRate}%)` : t('invoices.noVat')}\n                              </div>\n                            </div>\n                          </div>\n\n                          {/* Notizen */}\n                          {invoice.notes && (\n                            <div className=\"mb-6\">\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                {t('invoices.notes')}\n                              </label>\n                              <div className=\"text-sm text-gray-900 dark:text-gray-200 bg-white dark:bg-gray-800 p-3 rounded border\">\n                                {invoice.notes}\n                              </div>\n                            </div>\n                          )}\n\n                          {/* Rechnungspositionen */}\n                          <div>\n                            <div className=\"flex items-center justify-between mb-4\">\n                              <h5 className=\"text-md font-medium text-gray-900 dark:text-white\">\n                                {t('invoices.items', { count: invoice.items?.length || 0 })}\n                              </h5>\n                              <button\n                                onClick={() => openEditSidepane(invoice)}\n                                className=\"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700\"\n                              >\n                                <PencilIcon className=\"h-4 w-4 mr-2\" />\n                                {t('invoices.editItems')}\n                              </button>\n                            </div>\n                            \n                            {invoice.items && invoice.items.length > 0 ? (\n                              <div className=\"overflow-x-auto\">\n                                <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                  <thead className=\"bg-gray-100 dark:bg-gray-700\">\n                                    <tr>\n                                      <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                        {t('invoices.itemDescription')}\n                                      </th>\n                                      <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                        {t('invoices.itemQuantity')}\n                                      </th>\n                                      <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                        {t('invoices.itemUnitPrice')}\n                                      </th>\n                                      <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                        {t('invoices.itemAmount')}\n                                      </th>\n                                    </tr>\n                                  </thead>\n                                  <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                    {invoice.items.map((item) => (\n                                      <tr key={item.id}>\n                                        <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                          {item.description}\n                                        </td>\n                                        <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                          {Number(item.quantity).toFixed(2)}\n                                        </td>\n                                        <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                          {invoice.currency} {Number(item.unitPrice).toFixed(2)}\n                                        </td>\n                                        <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                          {invoice.currency} {Number(item.amount).toFixed(2)}\n                                        </td>\n                                      </tr>\n                                    ))}\n                                  </tbody>\n                                </table>\n                              </div>\n                            ) : (\n                              <div className=\"text-center text-gray-500 dark:text-gray-400 py-4\">\n                                {t('invoices.noItems')}\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      </td>\n                    </tr>\n                  )}\n                </React.Fragment>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      ) : (\n        /* Card-Ansicht */\n        <div className=\"dashboard-invoices-wrapper -mx-3 sm:-mx-4 md:-mx-6\">\n          {filteredAndSortedInvoices.length === 0 ? (\n            <div className=\"text-center py-8 text-sm text-gray-500 dark:text-gray-400\">\n              {t('invoices.noInvoicesFound')}\n            </div>\n          ) : (\n            <CardGrid gap=\"md\">\n              {filteredAndSortedInvoices.map((invoice) => {\n                const isExpanded = expandedRows.has(invoice.id);\n\n                // Metadaten fr Card aufbauen\n                const metadata: MetadataItem[] = [];\n\n                if (visibleCardMetadata.has('invoiceNumber')) {\n                  metadata.push({\n                    label: t('invoices.columns.invoiceNumber'),\n                    value: invoice.invoiceNumber,\n                    icon: <DocumentArrowDownIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                if (visibleCardMetadata.has('client')) {\n                  metadata.push({\n                    label: t('invoices.columns.client'),\n                    value: invoice.client.company \n                      ? `${invoice.client.name} (${invoice.client.company})`\n                      : invoice.client.name,\n                    icon: <BuildingOfficeIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                if (visibleCardMetadata.has('issueDate')) {\n                  metadata.push({\n                    label: t('invoices.columns.issueDate'),\n                    value: format(new Date(invoice.issueDate), 'dd.MM.yyyy', { locale: de }),\n                    icon: <CalendarIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                if (visibleCardMetadata.has('dueDate')) {\n                  metadata.push({\n                    label: t('invoices.columns.dueDate'),\n                    value: format(new Date(invoice.dueDate), 'dd.MM.yyyy', { locale: de }),\n                    icon: <CalendarIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                if (visibleCardMetadata.has('total')) {\n                  metadata.push({\n                    label: t('invoices.columns.total'),\n                    value: `${invoice.currency} ${Number(invoice.total).toFixed(2)}`,\n                    icon: <CurrencyDollarIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                // Status wird ber das status-Prop der DataCard angezeigt, nicht als Metadata\n                // Status-Konfiguration\n                const statusConfig = {\n                  DRAFT: { label: t('invoices.status.draft'), color: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300' },\n                  SENT: { label: t('invoices.status.sent'), color: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300' },\n                  PAID: { label: t('invoices.status.paid'), color: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300' },\n                  OVERDUE: { label: t('invoices.status.overdue'), color: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300' },\n                  CANCELLED: { label: t('invoices.status.cancelled'), color: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300' }\n                };\n                const invoiceStatus = statusConfig[invoice.status];\n\n                // Action-Buttons\n                const actions = (\n                  <div className=\"flex items-center justify-end space-x-2\">\n                    <div className=\"relative group\">\n                      <button\n                        onClick={() => openEditSidepane(invoice)}\n                        className=\"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('common.edit')}\n                      </div>\n                    </div>\n                    {canDownloadInvoices && (\n                      <div className=\"relative group\">\n                        <button\n                          onClick={() => handleDownloadPdf(invoice.id, invoice.invoiceNumber)}\n                          className=\"text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                        >\n                          <DocumentArrowDownIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('invoice.downloadPdfTitle')}\n                        </div>\n                      </div>\n                    )}\n                    {canEditInvoices && invoice.status !== 'PAID' && invoice.status !== 'CANCELLED' && (\n                      <div className=\"relative group\">\n                        <button\n                          onClick={() => handleMarkAsPaid(invoice.id)}\n                          className=\"text-yellow-600 hover:text-yellow-800 dark:text-yellow-400 dark:hover:text-yellow-300\"\n                        >\n                          <CurrencyDollarIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          Als bezahlt markieren\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                );\n\n                // Expandable Content fr Details\n                const expandableContent = (\n                  <div className=\"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                    <h4 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\n                      Rechnungsdetails & Positionen\n                    </h4>\n                    \n                    {/* Rechnungsinformationen */}\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                          Rechnungsnummer\n                        </label>\n                        <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                          {invoice.invoiceNumber}\n                        </div>\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                          Berater\n                        </label>\n                        <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                          {invoice.user ? `${invoice.user.firstName} ${invoice.user.lastName}` : 'Unbekannt'}\n                        </div>\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                          Zahlungsbedingungen\n                        </label>\n                        <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                          {invoice.paymentTerms}\n                        </div>\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                          Untertotal\n                        </label>\n                        <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                          {invoice.currency} {Number(invoice.subtotal).toFixed(2)}\n                        </div>\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                          MwSt.\n                        </label>\n                        <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                          {invoice.vatAmount ? `${invoice.currency} ${Number(invoice.vatAmount).toFixed(2)} (${invoice.vatRate}%)` : 'Keine MwSt.'}\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Notizen */}\n                    {invoice.notes && (\n                      <div className=\"mb-6\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                          {t('invoices.notes')}\n                        </label>\n                        <div className=\"text-sm text-gray-900 dark:text-gray-200 bg-white dark:bg-gray-800 p-3 rounded border\">\n                          {invoice.notes}\n                        </div>\n                      </div>\n                    )}\n\n                    {/* Rechnungspositionen */}\n                    <div>\n                      <div className=\"flex items-center justify-between mb-4\">\n                        <h5 className=\"text-md font-medium text-gray-900 dark:text-white\">\n                          Rechnungspositionen ({invoice.items?.length || 0})\n                        </h5>\n                        <button\n                          onClick={() => openEditSidepane(invoice)}\n                          className=\"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700\"\n                        >\n                          <PencilIcon className=\"h-4 w-4 mr-2\" />\n                          Positionen bearbeiten\n                        </button>\n                      </div>\n                      \n                      {invoice.items && invoice.items.length > 0 ? (\n                        <div className=\"overflow-x-auto\">\n                          <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                            <thead className=\"bg-gray-100 dark:bg-gray-700\">\n                              <tr>\n                                <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                  {t('invoices.itemDescription')}\n                                </th>\n                                <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                  {t('invoices.itemQuantity')}\n                                </th>\n                                <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                  {t('invoices.itemUnitPrice')}\n                                </th>\n                                <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                  {t('invoices.itemAmount')}\n                                </th>\n                              </tr>\n                            </thead>\n                            <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                              {invoice.items.map((item) => (\n                                <tr key={item.id}>\n                                  <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                    {item.description}\n                                  </td>\n                                  <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                    {Number(item.quantity).toFixed(2)}\n                                  </td>\n                                  <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                    {invoice.currency} {Number(item.unitPrice).toFixed(2)}\n                                  </td>\n                                  <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                    {invoice.currency} {Number(item.amount).toFixed(2)}\n                                  </td>\n                                </tr>\n                              ))}\n                            </tbody>\n                          </table>\n                        </div>\n                      ) : (\n                        <div className=\"text-center text-gray-500 dark:text-gray-400 py-4\">\n                          Keine Rechnungspositionen vorhanden\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                );\n\n                return (\n                  <DataCard\n                    key={invoice.id}\n                    title={invoice.invoiceNumber}\n                    status={{\n                      label: invoiceStatus.label,\n                      color: invoiceStatus.color\n                    }}\n                    metadata={metadata}\n                    actions={actions}\n                    expandable={{\n                      isExpanded: isExpanded,\n                      content: expandableContent,\n                      onToggle: () => toggleExpanded(invoice.id)\n                    }}\n                  />\n                );\n              })}\n            </CardGrid>\n          )}\n        </div>\n      )}\n\n      {/* Filter Modal */}\n      {isFilterModalOpen && (\n        <FilterPane\n          columns={[\n            { id: 'client', label: t('invoices.columns.client') },\n            { id: 'status', label: t('invoices.columns.status') },\n            { id: 'total', label: `${t('invoices.columns.total')} (CHF)` }\n          ]}\n          onApply={applyFilterConditions}\n          onReset={resetFilterConditions}\n          savedConditions={filterConditions}\n          savedOperators={filterLogicalOperators}\n          tableId={INVOICES_TABLE_ID}\n        />\n      )}\n\n      {/* Column Config Modal */}\n      <TableColumnConfig\n        isOpen={isColumnConfigOpen}\n        onOpenChange={setIsColumnConfigOpen}\n        columns={availableColumns}\n        columnOrder={settings.columnOrder}\n        visibleColumns={availableColumns.filter(col => !settings.hiddenColumns.includes(col.id)).map(col => col.id)}\n        onToggleColumnVisibility={(columnId) => toggleColumnVisibility(columnId)}\n        mainSortConfig={sortConfig}\n        onMainSortChange={handleMainSortChange}\n        showMainSort={true}\n      />\n\n      {/* Detail Modal */}\n      {isDetailModalOpen && selectedInvoiceId && (\n        <InvoiceDetailModal\n          isOpen={isDetailModalOpen}\n          onClose={() => {\n            setIsDetailModalOpen(false);\n            setSelectedInvoiceId(null);\n          }}\n          invoiceId={selectedInvoiceId}\n          onInvoiceUpdated={loadInvoices}\n        />\n      )}\n\n      {/* Edit Sidepane (nach Tasks & Requests Standard) */}\n      {isEditSidepaneOpen && editingInvoice && (\n        <div className=\"fixed inset-0 overflow-hidden z-50\" aria-labelledby=\"slide-over-title\" role=\"dialog\" aria-modal=\"true\">\n          <div className=\"absolute inset-0 overflow-hidden\">\n            {/* Backdrop - nur bei <= 1070px */}\n            {!isLargeScreen && (\n              <div className=\"absolute inset-0 bg-gray-500 bg-opacity-75 transition-opacity sidepane-overlay sidepane-backdrop\" onClick={closeEditSidepane}></div>\n            )}\n            \n            {/* Panel - beginnt unter der Topbar */}\n            <div className=\"fixed top-16 bottom-0 right-0 pl-10 max-w-full flex sidepane-panel sidepane-panel-container\" style={{\n              transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)'\n            }}>\n              <div className=\"w-screen max-w-2xl\">\n                <div className=\"h-full flex flex-col bg-white dark:bg-gray-800 shadow-xl overflow-y-scroll\">\n                  {/* Header */}\n                  <div className=\"px-4 py-6 bg-gray-50 dark:bg-gray-700 sm:px-6\">\n                    <div className=\"flex items-center justify-between\">\n                      <h2 className=\"text-lg font-medium text-gray-900 dark:text-white\" id=\"slide-over-title\">\n                        {t('invoices.editSidepane.title', { invoiceNumber: editingInvoice.invoiceNumber })}\n                      </h2>\n                      <div className=\"ml-3 h-7 flex items-center\">\n                        <button\n                          type=\"button\"\n                          className=\"bg-gray-50 dark:bg-gray-700 rounded-md text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                          onClick={closeEditSidepane}\n                        >\n                          <span className=\"sr-only\">{t('common.close')}</span>\n                          <XMarkIcon className=\"h-6 w-6\" aria-hidden=\"true\" />\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Content */}\n                  <div className=\"flex-1 px-4 py-6 sm:px-6\">\n                    <div className=\"space-y-6\">\n                      \n                      {/* Grundinformationen */}\n                      <div>\n                        <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\n                          {t('invoices.editSidepane.basicInfo')}\n                        </h3>\n                        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                              {t('invoices.invoiceNumber')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={editingInvoice.invoiceNumber}\n                              disabled\n                              className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                            />\n                          </div>\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                              {t('invoices.status')}\n                            </label>\n                            <select\n                              value={editingInvoice.status}\n                              className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                            >\n                              <option value=\"DRAFT\">{t('invoices.status.draft')}</option>\n                              <option value=\"SENT\">{t('invoices.status.sent')}</option>\n                              <option value=\"PAID\">{t('invoices.status.paid')}</option>\n                              <option value=\"OVERDUE\">{t('invoices.status.overdue')}</option>\n                              <option value=\"CANCELLED\">{t('invoices.status.cancelled')}</option>\n                            </select>\n                          </div>\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                              {t('invoices.editSidepane.issueDate')}\n                            </label>\n                            <input\n                              type=\"date\"\n                              value={editingInvoice.issueDate.split('T')[0]}\n                              className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                            />\n                          </div>\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                              {t('invoices.editSidepane.dueDate')}\n                            </label>\n                            <input\n                              type=\"date\"\n                              value={editingInvoice.dueDate.split('T')[0]}\n                              className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                            />\n                          </div>\n                        </div>\n                      </div>\n\n                      {/* Notizen */}\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                          {t('invoices.notes')}\n                        </label>\n                        <textarea\n                          rows={3}\n                          value={editingInvoice.notes || ''}\n                          className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                          placeholder={t('invoices.editSidepane.notesPlaceholder')}\n                        />\n                      </div>\n\n                      {/* Rechnungspositionen */}\n                      <div>\n                        <div className=\"flex items-center justify-between mb-4\">\n                          <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                            {t('invoices.editSidepane.items')}\n                          </h3>\n                          <button\n                            type=\"button\"\n                            className=\"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                          >\n                            <PlusIcon className=\"h-4 w-4 mr-2\" />\n                            {t('invoices.editSidepane.addItem')}\n                          </button>\n                        </div>\n\n                        <div className=\"space-y-3\">\n                          {editingInvoice.items?.map((item, index) => (\n                            <div key={item.id || index} className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-4\">\n                              <div className=\"grid grid-cols-1 sm:grid-cols-4 gap-4\">\n                                <div className=\"sm:col-span-2\">\n                                  <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300\">\n                                    {t('invoices.itemDescription')}\n                                  </label>\n                                  <input\n                                    type=\"text\"\n                                    value={item.description}\n                                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                                  />\n                                </div>\n                                <div>\n                                  <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300\">\n                                    {t('invoices.editSidepane.hours')}\n                                  </label>\n                                  <input\n                                    type=\"number\"\n                                    step=\"0.01\"\n                                    value={item.quantity}\n                                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                                  />\n                                </div>\n                                <div>\n                                  <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300\">\n                                    {t('invoices.itemUnitPrice')}\n                                  </label>\n                                  <div className=\"flex items-center space-x-2\">\n                                    <input\n                                      type=\"number\"\n                                      step=\"0.01\"\n                                      value={item.unitPrice}\n                                      className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                                    />\n                                    <div className=\"relative group mt-1\">\n                                      <button\n                                        type=\"button\"\n                                        className=\"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300\"\n                                      >\n                                        <TrashIcon className=\"h-4 w-4\" />\n                                      </button>\n                                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('invoices.deletePosition')}\n                                      </div>\n                                    </div>\n                                  </div>\n                                </div>\n                              </div>\n                              <div className=\"mt-2 text-right\">\n                                <span className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                  {t('invoices.itemAmount')}: {editingInvoice.currency} {Number(item.amount).toFixed(2)}\n                                </span>\n                              </div>\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n\n                      {/* Totals */}\n                      <div className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-4\">\n                        <div className=\"space-y-2\">\n                          <div className=\"flex justify-between\">\n                            <span className=\"text-sm text-gray-600 dark:text-gray-400\">{t('invoices.subtotal')}:</span>\n                            <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                              {editingInvoice.currency} {Number(editingInvoice.subtotal).toFixed(2)}\n                            </span>\n                          </div>\n                          {editingInvoice.vatAmount && (\n                            <div className=\"flex justify-between\">\n                              <span className=\"text-sm text-gray-600 dark:text-gray-400\">\n                                {t('invoices.vat')} ({editingInvoice.vatRate}%):\n                              </span>\n                              <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                                {editingInvoice.currency} {Number(editingInvoice.vatAmount).toFixed(2)}\n                              </span>\n                            </div>\n                          )}\n                          <div className=\"flex justify-between pt-2 border-t border-gray-200 dark:border-gray-600\">\n                            <span className=\"text-base font-medium text-gray-900 dark:text-white\">{t('invoices.editSidepane.total')}:</span>\n                            <span className=\"text-base font-bold text-gray-900 dark:text-white\">\n                              {editingInvoice.currency} {Number(editingInvoice.total).toFixed(2)}\n                            </span>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Footer */}\n                  <div className=\"flex-shrink-0 px-4 py-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600\">\n                    <div className=\"flex justify-end space-x-3\">\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                          onClick={closeEditSidepane}\n                        >\n                          <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('common.cancel')}\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                        >\n                          <CheckIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('common.save')}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default InvoiceManagementTab; ","import React, { useState, useEffect, useRef, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport { \n  DocumentArrowDownIcon, \n  TrashIcon, \n  PlusIcon,\n  EyeIcon,\n  ClockIcon,\n  CheckCircleIcon,\n  ExclamationTriangleIcon,\n  ChevronDownIcon,\n  PencilIcon,\n  CheckIcon,\n  XMarkIcon,\n  CalendarIcon,\n  Squares2X2Icon,\n  TableCellsIcon,\n  BuildingOfficeIcon,\n  UserIcon\n} from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { toast } from 'react-toastify';\nimport { MonthlyConsultationReport, UnbilledConsultationsCheck } from '../types/monthlyConsultationReport.ts';\nimport { calculateDuration } from '../utils/dateUtils.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport { useTableSettings } from '../hooks/useTableSettings.ts';\nimport { logger } from '../utils/logger.ts';\nimport DataCard, { MetadataItem } from './shared/DataCard.tsx';\nimport CardGrid from './shared/CardGrid.tsx';\n\ninterface MonthlyReportsTabProps {\n  selectedReportId?: number | null;\n}\n\n// Standardreihenfolge der Spalten (IDs)\nconst defaultColumnOrder = ['expand', 'reportNumber', 'period', 'recipient', 'totalHours', 'status', 'actions'];\nconst MONTHLY_REPORTS_TABLE_ID = 'monthly-reports-table';\n\n// Card-Einstellungen Standardwerte\nconst defaultCardMetadata = ['reportNumber', 'period', 'recipient', 'totalHours', 'status'];\nconst defaultCardColumnOrder = ['reportNumber', 'period', 'recipient', 'totalHours', 'status'];\n//  ENTFERNT: defaultCardSortDirections\n// Hauptsortierung wird jetzt aus Settings geladen (pro Benutzer gespeichert)\n\n// Mapping zwischen Tabellen-Spalten-IDs und Card-Metadaten-IDs\nconst tableToCardMapping: Record<string, string[]> = {\n  'expand': [], // Keine Card-Entsprechung\n  'reportNumber': ['reportNumber'],\n  'period': ['period'],\n  'recipient': ['recipient'],\n  'totalHours': ['totalHours'],\n  'status': ['status'],\n  'actions': [] // Keine Card-Entsprechung\n};\n\n// Reverse Mapping: Card-Metadaten -> Tabellen-Spalten\nconst cardToTableMapping: Record<string, string> = {\n  'reportNumber': 'reportNumber',\n  'period': 'period',\n  'recipient': 'recipient',\n  'totalHours': 'totalHours',\n  'status': 'status'\n};\n\n// Helfer-Funktion: Tabellen-Spalte ausgeblendet -> Card-Metadaten ausblenden\nconst getHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n  const hiddenCardMetadata = new Set<string>();\n  hiddenTableColumns.forEach(tableCol => {\n    const cardMetadata = tableToCardMapping[tableCol] || [];\n    cardMetadata.forEach(cardMeta => hiddenCardMetadata.add(cardMeta));\n  });\n  return hiddenCardMetadata;\n};\n\n// Helfer-Funktion: Card-Metadaten zu Tabellen-Spalten konvertieren\nconst getCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n  const cardMetadata: string[] = [];\n  columnOrder.forEach(tableCol => {\n    const cardMeta = tableToCardMapping[tableCol];\n    if (cardMeta && cardMeta.length > 0) {\n      cardMetadata.push(...cardMeta);\n    }\n  });\n  return cardMetadata;\n};\n\nconst MonthlyReportsTab: React.FC<MonthlyReportsTabProps> = ({ selectedReportId }) => {\n  const { t } = useTranslation();\n  const { openSidepane, closeSidepane } = useSidepane();\n  \n  // Definition der verfgbaren Spalten (dynamisch aus bersetzungen)\n  const availableColumns = useMemo(() => [\n    { id: 'expand', label: '', shortLabel: '' }, // Expand-Button Spalte\n    { id: 'reportNumber', label: t('analytics.monthlyReports.columns.reportNumber'), shortLabel: t('analytics.monthlyReports.shortLabels.reportNumber') },\n    { id: 'period', label: t('analytics.monthlyReports.columns.period'), shortLabel: t('analytics.monthlyReports.shortLabels.period') },\n    { id: 'recipient', label: t('analytics.monthlyReports.columns.recipient'), shortLabel: t('analytics.monthlyReports.shortLabels.recipient') },\n    { id: 'totalHours', label: t('analytics.monthlyReports.columns.totalHours'), shortLabel: t('analytics.monthlyReports.shortLabels.totalHours') },\n    { id: 'status', label: t('analytics.monthlyReports.columns.status'), shortLabel: t('analytics.monthlyReports.shortLabels.status') },\n    { id: 'actions', label: t('analytics.monthlyReports.columns.actions'), shortLabel: t('analytics.monthlyReports.shortLabels.actions') }\n  ], [t]);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [reports, setReports] = useState<MonthlyConsultationReport[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [generating, setGenerating] = useState(false);\n  const [unbilledCheck, setUnbilledCheck] = useState<UnbilledConsultationsCheck | null>(null);\n  const selectedReportRef = useRef<HTMLTableRowElement>(null);\n  \n  // Expand/Collapse States (nach Tasks & Requests Standard)\n  const [expandedRows, setExpandedRows] = useState<Set<number>>(new Set());\n\n  // Table Settings\n  const {\n    settings,\n    isLoading: isLoadingSettings,\n    updateColumnOrder,\n    updateHiddenColumns,\n    toggleColumnVisibility,\n    isColumnVisible,\n    updateViewMode,\n    updateSortConfig\n  } = useTableSettings(MONTHLY_REPORTS_TABLE_ID, {\n    defaultColumnOrder,\n    defaultHiddenColumns: [],\n    defaultViewMode: 'cards'\n  });\n\n  // View-Mode aus Settings laden\n  const viewMode = settings.viewMode || 'cards';\n  \n  // Hauptsortierung aus Settings laden (fr Table & Cards synchron)\n  type MonthlyReportSortConfig = { key: string; direction: 'asc' | 'desc' };\n  const sortConfig: MonthlyReportSortConfig = settings.sortConfig || { key: 'period', direction: 'desc' };\n  \n  // Hauptsortierung Handler (fr Table & Cards synchron)\n  const handleMainSortChange = (key: string, direction: 'asc' | 'desc') => {\n    updateSortConfig({ key, direction });\n  };\n\n  // Abgeleitete Werte fr Card-Ansicht aus Tabellen-Settings\n  const cardMetadataOrder = React.useMemo(() => {\n    return getCardMetadataFromColumnOrder(settings.columnOrder || defaultColumnOrder);\n  }, [settings.columnOrder]);\n\n  // Versteckte Card-Metadaten aus hiddenColumns ableiten\n  const hiddenCardMetadata = React.useMemo(() => {\n    return getHiddenCardMetadata(settings.hiddenColumns || []);\n  }, [settings.hiddenColumns]);\n\n  // Sichtbare Card-Metadaten (alle Card-Metadaten minus versteckte)\n  const visibleCardMetadata = React.useMemo(() => {\n    return new Set(cardMetadataOrder.filter(meta => !hiddenCardMetadata.has(meta)));\n  }, [cardMetadataOrder, hiddenCardMetadata]);\n\n  // CSS-Klasse fr Container-Box setzen (fr CSS-basierte Schattierungs-Entfernung)\n  useEffect(() => {\n    const wrapper = document.querySelector('.dashboard-monthly-reports-wrapper');\n    if (wrapper) {\n      if (viewMode === 'cards') {\n        wrapper.classList.add('cards-mode');\n      } else {\n        wrapper.classList.remove('cards-mode');\n      }\n    }\n  }, [viewMode]);\n\n  // Sortierte Reports (fr Table & Cards synchron)\n  const sortedReports = React.useMemo(() => {\n      const sorted = [...reports];\n      \n    // Hauptsortierung anwenden\n    if (sortConfig.key) {\n          let valueA: any, valueB: any;\n          \n      switch (sortConfig.key) {\n            case 'reportNumber':\n          valueA = sorted[0]?.reportNumber?.toLowerCase() || '';\n          valueB = sorted[1]?.reportNumber?.toLowerCase() || '';\n              break;\n            case 'period':\n          valueA = sorted[0]?.periodStart ? new Date(sorted[0].periodStart).getTime() : 0;\n          valueB = sorted[1]?.periodStart ? new Date(sorted[1].periodStart).getTime() : 0;\n              break;\n            case 'recipient':\n          valueA = sorted[0]?.recipient?.toLowerCase() || '';\n          valueB = sorted[1]?.recipient?.toLowerCase() || '';\n              break;\n            case 'totalHours':\n          valueA = Number(sorted[0]?.totalHours) || 0;\n          valueB = Number(sorted[1]?.totalHours) || 0;\n              break;\n            case 'status':\n          valueA = sorted[0]?.status?.toLowerCase() || '';\n          valueB = sorted[1]?.status?.toLowerCase() || '';\n              break;\n            default:\n          return sorted;\n      }\n      \n      sorted.sort((a, b) => {\n        let aValue: any, bValue: any;\n        \n        switch (sortConfig.key) {\n          case 'reportNumber':\n            aValue = a.reportNumber?.toLowerCase() || '';\n            bValue = b.reportNumber?.toLowerCase() || '';\n            break;\n          case 'period':\n            aValue = a.periodStart ? new Date(a.periodStart).getTime() : 0;\n            bValue = b.periodStart ? new Date(b.periodStart).getTime() : 0;\n            break;\n          case 'recipient':\n            aValue = a.recipient?.toLowerCase() || '';\n            bValue = b.recipient?.toLowerCase() || '';\n            break;\n          case 'totalHours':\n            aValue = Number(a.totalHours) || 0;\n            bValue = Number(b.totalHours) || 0;\n            break;\n          case 'status':\n            aValue = a.status?.toLowerCase() || '';\n            bValue = b.status?.toLowerCase() || '';\n            break;\n          default:\n            return 0;\n        }\n        \n          let comparison = 0;\n        if (typeof aValue === 'number' && typeof bValue === 'number') {\n          comparison = aValue - bValue;\n          } else {\n          //  OPTIMIERUNG: Vermeide String() Konvertierung wenn bereits String\n          const strA = typeof aValue === 'string' ? aValue : String(aValue);\n          const strB = typeof bValue === 'string' ? bValue : String(bValue);\n          comparison = strA.localeCompare(strB);\n          }\n          \n        return sortConfig.direction === 'asc' ? comparison : -comparison;\n      });\n          }\n      \n      return sorted;\n  }, [reports, sortConfig]);\n  \n  // Sidepane States - Ersetzt durch Client-Beratungen-Sidepane\n  const [isClientConsultationsSidepaneOpen, setIsClientConsultationsSidepaneOpen] = useState(false);\n  const [editingClientId, setEditingClientId] = useState<number | null>(null);\n  const [editingClientName, setEditingClientName] = useState<string>('');\n  const [clientConsultations, setClientConsultations] = useState<any[]>([]);\n  const [loadingConsultations, setLoadingConsultations] = useState(false);\n\n  useEffect(() => {\n    loadReports();\n    checkUnbilledConsultations();\n  }, []);\n\n  // berwache Bildschirmgre\n  useEffect(() => {\n    const handleResize = () => {\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isClientConsultationsSidepaneOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isClientConsultationsSidepaneOpen, openSidepane, closeSidepane]);\n\n  // Auto-scroll to selected report\n  useEffect(() => {\n    let timeoutId: ReturnType<typeof setTimeout> | null = null;\n    \n    if (selectedReportId && reports.length > 0 && selectedReportRef.current) {\n      selectedReportRef.current.scrollIntoView({ behavior: 'smooth', block: 'center' });\n      \n      // Highlight the row temporarily\n      selectedReportRef.current.style.backgroundColor = '#dbeafe';\n      timeoutId = setTimeout(() => {\n        if (selectedReportRef.current) {\n          selectedReportRef.current.style.backgroundColor = '';\n        }\n      }, 2000);\n    }\n    \n    //  MEMORY FIX: Cleanup Timer bei Unmount/Re-render\n    return () => {\n      if (timeoutId) clearTimeout(timeoutId);\n    };\n  }, [selectedReportId, reports]);\n\n  const loadReports = async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.MONTHLY_CONSULTATION_REPORTS.BASE);\n      setReports(response.data);\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Monatsberichte:', error);\n      toast.error(t('analytics.monthlyReports.loadError'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const checkUnbilledConsultations = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.MONTHLY_CONSULTATION_REPORTS.CHECK_UNBILLED);\n      setUnbilledCheck(response.data);\n    } catch (error) {\n      console.error('Fehler beim Prfen der nicht-abgerechneten Beratungen:', error);\n    }\n  };\n\n  const handleGenerateReport = async () => {\n    logger.log('DEBUG: handleGenerateReport called');\n    try {\n      const response = await axiosInstance.post(API_ENDPOINTS.MONTHLY_CONSULTATION_REPORTS.GENERATE_AUTOMATIC);\n      logger.log('DEBUG: API response:', response);\n      await loadReports();\n      toast.success(t('analytics.monthlyReports.generateSuccess'));\n    } catch (error: any) {\n      console.error('DEBUG: Error generating report:', error);\n      logger.log('DEBUG: Error details:', {\n        status: error.response?.status,\n        data: error.response?.data,\n        message: error.message\n      });\n      toast.error(error.response?.data?.message || t('analytics.monthlyReports.generateError'));\n    }\n  };\n\n  const downloadPDF = async (report: MonthlyConsultationReport) => {\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.MONTHLY_CONSULTATION_REPORTS.PDF(report.id),\n        { responseType: 'blob' }\n      );\n      \n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const url = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `${report.reportNumber}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(url);\n    } catch (error) {\n      toast.error(t('analytics.monthlyReports.downloadError'));\n    }\n  };\n\n  const deleteReport = async (reportId: number) => {\n    if (!window.confirm(t('analytics.monthlyReports.confirmDelete'))) {\n      return;\n    }\n\n    try {\n      await axiosInstance.delete(API_ENDPOINTS.MONTHLY_CONSULTATION_REPORTS.BY_ID(reportId));\n      setReports(prev => prev.filter(r => r.id !== reportId));\n      toast.success(t('analytics.monthlyReports.deleteSuccess'));\n      checkUnbilledConsultations();\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || t('analytics.monthlyReports.deleteError'));\n    }\n  };\n\n  // Expand/Collapse Handler (nach Tasks & Requests Standard)\n  const toggleExpanded = (reportId: number) => {\n    setExpandedRows(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(reportId)) {\n        newSet.delete(reportId);\n      } else {\n        newSet.add(reportId);\n      }\n      return newSet;\n    });\n  };\n\n  // Ersetzt openEditSidepane - wird nicht mehr bentigt\n  const openClientConsultationsSidepane = async (clientId: number, clientName: string, reportId: number) => {\n    setEditingClientId(clientId);\n    setEditingClientName(clientName);\n    setIsClientConsultationsSidepaneOpen(true);\n    \n    // Lade die Beratungen fr diesen Client im Berichtszeitraum\n    await loadClientConsultations(clientId, reportId);\n  };\n\n  const closeClientConsultationsSidepane = () => {\n    setIsClientConsultationsSidepaneOpen(false);\n    setEditingClientId(null);\n    setEditingClientName('');\n    setClientConsultations([]);\n  };\n\n  const loadClientConsultations = async (clientId: number, reportId: number) => {\n    try {\n      setLoadingConsultations(true);\n      // Hole die Report-Details um den Zeitraum zu bekommen\n      const report = reports.find(r => r.id === reportId);\n      if (!report) return;\n\n      const response = await axiosInstance.get(`${API_ENDPOINTS.CONSULTATIONS.BASE}?clientId=${clientId}&from=${report.periodStart}&to=${report.periodEnd}`);\n      setClientConsultations(response.data);\n    } catch (error) {\n      console.error('Fehler beim Laden der Client-Beratungen:', error);\n      toast.error(t('analytics.monthlyReports.consultationsLoadError'));\n    } finally {\n      setLoadingConsultations(false);\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'GENERATED':\n        return <ClockIcon className=\"h-5 w-5 text-blue-500\" />;\n      case 'SENT':\n        return <CheckCircleIcon className=\"h-5 w-5 text-green-500\" />;\n      case 'ARCHIVED':\n        return <EyeIcon className=\"h-5 w-5 text-gray-500\" />;\n      default:\n        return <ClockIcon className=\"h-5 w-5 text-gray-500\" />;\n    }\n  };\n\n  const getStatusText = (status: string) => {\n    switch (status) {\n      case 'GENERATED':\n        return t('analytics.monthlyReports.status.generated');\n      case 'SENT':\n        return t('analytics.monthlyReports.status.sent');\n      case 'ARCHIVED':\n        return t('analytics.monthlyReports.status.archived');\n      default:\n        return status;\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-4\"></div>\n          <div className=\"space-y-3\">\n            {[...Array(3)].map((_, i) => (\n              <div key={i} className=\"h-12 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      <div className=\"flex items-center justify-between mb-6 px-3 sm:px-4 md:px-6 -mx-3 sm:-mx-4 md:-mx-6\">\n        <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n          {t('analytics.monthlyReports.title')}\n        </h2>\n      </div>\n\n      {/* Unbilled Consultations Warning */}\n      {unbilledCheck?.hasUnbilledConsultations && (\n        <div className=\"mb-6 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4\">\n          <div className=\"flex items-start\">\n            <ExclamationTriangleIcon className=\"h-5 w-5 text-yellow-600 dark:text-yellow-400 mt-0.5 mr-3\" />\n            <div className=\"flex-1\">\n              <h3 className=\"text-sm font-medium text-yellow-800 dark:text-yellow-200\">\n                {t('analytics.monthlyReports.unbilledWarning.title')}\n              </h3>\n              <p className=\"text-sm text-yellow-700 dark:text-yellow-300 mt-1\">\n                {t('analytics.monthlyReports.unbilledWarning.message', { count: unbilledCheck.count })}\n              </p>\n              <button\n                onClick={handleGenerateReport}\n                disabled={generating}\n                className=\"mt-3 inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-yellow-800 dark:text-yellow-200 bg-yellow-100 dark:bg-yellow-800 hover:bg-yellow-200 dark:hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 disabled:opacity-50\"\n              >\n                <PlusIcon className=\"h-4 w-4 mr-2\" />\n                {generating ? t('analytics.monthlyReports.unbilledWarning.creating') : t('analytics.monthlyReports.unbilledWarning.createButton')}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Reports List */}\n      {viewMode === 'table' ? (\n        /* Tabellen-Ansicht */\n        <div className=\"dashboard-monthly-reports-wrapper bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden -mx-3 sm:-mx-4 md:-mx-6\">\n        <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n          <thead className=\"bg-gray-50 dark:bg-gray-700\">\n            <tr>\n              <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left w-12\">\n                {/* Expand-Button Spalte */}\n              </th>\n              <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                {t('analytics.monthlyReports.columns.reportNumber')}\n              </th>\n              <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                {t('analytics.monthlyReports.columns.period')}\n              </th>\n              <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                {t('analytics.monthlyReports.columns.recipient')}\n              </th>\n              <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                {t('analytics.monthlyReports.columns.totalHours')}\n              </th>\n              <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                {t('analytics.monthlyReports.columns.status')}\n              </th>\n              <th className=\"px-3 sm:px-4 md:px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                {t('analytics.monthlyReports.columns.actions')}\n              </th>\n            </tr>\n          </thead>\n          <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n            {reports.map((report) => (\n              <React.Fragment key={report.id}>\n                <tr \n                  className=\"hover:bg-gray-50 dark:hover:bg-gray-700\" \n                  ref={selectedReportId === report.id ? selectedReportRef : null}\n                >\n                  <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                    <div className=\"relative group\">\n                      <button\n                        onClick={() => toggleExpanded(report.id)}\n                        className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n                      >\n                        <ChevronDownIcon \n                          className={`h-4 w-4 transition-transform ${\n                            expandedRows.has(report.id) ? 'rotate-180' : ''\n                          }`} \n                        />\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {expandedRows.has(report.id) ? t('common.collapse') : t('common.expand')}\n                      </div>\n                    </div>\n                  </td>\n                  <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                    <div className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                      {report.reportNumber}\n                    </div>\n                    <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                      {format(new Date(report.generatedAt), 'dd.MM.yyyy HH:mm', { locale: de })}\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white\">\n                    {format(new Date(report.periodStart), 'dd.MM.yyyy', { locale: de })} - {' '}\n                    {format(new Date(report.periodEnd), 'dd.MM.yyyy', { locale: de })}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white\">\n                    {report.recipient}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white\">\n                    {Number(report.totalHours).toFixed(2)} h\n                  </td>\n                  <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                    <div className=\"flex items-center\">\n                      {getStatusIcon(report.status)}\n                      <span className=\"ml-2 text-sm text-gray-900 dark:text-white\">\n                        {getStatusText(report.status)}\n                      </span>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                    <div className=\"flex items-center justify-end space-x-2\">\n                      <div className=\"relative group\">\n                        <button\n                          onClick={() => downloadPDF(report)}\n                          className=\"text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                        >\n                          <DocumentArrowDownIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('analytics.monthlyReports.downloadTitle')}\n                        </div>\n                      </div>\n                    </div>\n                  </td>\n                </tr>\n\n                {/* Erweiterte Details-Zeile */}\n                {expandedRows.has(report.id) && (\n                  <tr className=\"bg-gray-50 dark:bg-gray-900\">\n                    <td colSpan={7} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                      <div className=\"space-y-4\">\n                        {/* Abrechnungspositionen - Ohne Detail-Informationen darber */}\n                        <div>\n                          <h5 className=\"text-md font-medium text-gray-900 dark:text-white mb-4\">\n                            {t('analytics.monthlyReports.billingPositions', { count: report.items?.length || 0 })}\n                          </h5>\n                          \n                          {report.items && report.items.length > 0 ? (\n                            <div className=\"overflow-x-auto\">\n                              <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                <thead className=\"bg-gray-100 dark:bg-gray-700\">\n                                  <tr>\n                                    <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                      {t('analytics.monthlyReports.client')}\n                                    </th>\n                                    <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                      {t('analytics.monthlyReports.consultationCount')}\n                                    </th>\n                                    <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                      {t('analytics.monthlyReports.columns.totalHours')}\n                                    </th>\n                                    <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                      {t('analytics.monthlyReports.actions')}\n                                    </th>\n                                  </tr>\n                                </thead>\n                                <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                  {report.items.map((item) => (\n                                    <tr key={item.id}>\n                                      <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                        {item.clientName}\n                                      </td>\n                                      <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                        {item.consultationCount}\n                                      </td>\n                                      <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200 font-semibold\">\n                                        {Number(item.totalHours).toFixed(2)} h\n                                      </td>\n                                      <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                        <div className=\"relative group\">\n                                          <button\n                                            onClick={() => openClientConsultationsSidepane(item.clientId, item.clientName, report.id)}\n                                            className=\"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                          >\n                                            <PencilIcon className=\"h-4 w-4\" />\n                                          </button>\n                                          <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {t('analytics.monthlyReports.editConsultationsTitle')}\n                                          </div>\n                                        </div>\n                                      </td>\n                                    </tr>\n                                  ))}\n                                </tbody>\n                              </table>\n                            </div>\n                          ) : (\n                            <div className=\"text-center text-gray-500 dark:text-gray-400 py-4\">\n                              {t('analytics.monthlyReports.noPositions')}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </td>\n                  </tr>\n                )}\n              </React.Fragment>\n            ))}\n          </tbody>\n        </table>\n      </div>\n      ) : (\n        /* Card-Ansicht */\n        <div className=\"dashboard-monthly-reports-wrapper -mx-3 sm:-mx-4 md:-mx-6\">\n          {sortedReports.length === 0 ? (\n            <div className=\"text-center py-8 text-sm text-gray-500 dark:text-gray-400\">\n              {t('analytics.monthlyReports.noReports')}\n            </div>\n          ) : (\n            <CardGrid gap=\"md\">\n              {sortedReports.map((report) => {\n                const isExpanded = expandedRows.has(report.id);\n\n                // Metadaten fr Card aufbauen\n                const metadata: MetadataItem[] = [];\n\n                if (visibleCardMetadata.has('reportNumber')) {\n                  metadata.push({\n                    label: t('analytics.monthlyReports.metadata.reportNumber'),\n                    value: report.reportNumber,\n                    icon: <DocumentArrowDownIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                if (visibleCardMetadata.has('period')) {\n                  metadata.push({\n                    label: t('analytics.monthlyReports.metadata.period'),\n                    value: `${format(new Date(report.periodStart), 'dd.MM.yyyy', { locale: de })} - ${format(new Date(report.periodEnd), 'dd.MM.yyyy', { locale: de })}`,\n                    icon: <CalendarIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                if (visibleCardMetadata.has('recipient')) {\n                  metadata.push({\n                    label: t('analytics.monthlyReports.metadata.recipient'),\n                    value: report.recipient,\n                    icon: <BuildingOfficeIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                if (visibleCardMetadata.has('totalHours')) {\n                  metadata.push({\n                    label: t('analytics.monthlyReports.metadata.totalHours'),\n                    value: `${Number(report.totalHours).toFixed(2)} h`,\n                    icon: <ClockIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                // Status-Konfiguration\n                const statusConfig = {\n                  GENERATED: { label: t('analytics.monthlyReports.status.generated'), color: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300' },\n                  SENT: { label: t('analytics.monthlyReports.status.sent'), color: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300' },\n                  ARCHIVED: { label: t('analytics.monthlyReports.status.archived'), color: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300' }\n                };\n                const reportStatus = statusConfig[report.status];\n\n                // Action-Buttons\n                const actions = (\n                  <div className=\"flex items-center justify-end space-x-2\">\n                    <div className=\"relative group\">\n                      <button\n                        onClick={() => downloadPDF(report)}\n                        className=\"text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                      >\n                        <DocumentArrowDownIcon className=\"h-5 w-5\" />\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        PDF herunterladen\n                      </div>\n                    </div>\n                  </div>\n                );\n\n                // Expandable Content fr Details\n                const expandableContent = (\n                  <div className=\"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                    <h5 className=\"text-md font-medium text-gray-900 dark:text-white mb-4\">\n                      Abrechnungspositionen ({report.items?.length || 0})\n                    </h5>\n                    \n                    {report.items && report.items.length > 0 ? (\n                      <div className=\"overflow-x-auto\">\n                        <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                          <thead className=\"bg-gray-100 dark:bg-gray-700\">\n                            <tr>\n                              <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                Client\n                              </th>\n                              <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                Anzahl Beratungen\n                              </th>\n                              <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                Stunden\n                              </th>\n                              <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                Aktionen\n                              </th>\n                            </tr>\n                          </thead>\n                          <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                            {report.items.map((item) => (\n                              <tr key={item.id}>\n                                <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                  {item.clientName}\n                                </td>\n                                <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                  {item.consultationCount}\n                                </td>\n                                <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200 font-semibold\">\n                                  {Number(item.totalHours).toFixed(2)} h\n                                </td>\n                                <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-gray-200\">\n                                  <div className=\"relative group\">\n                                    <button\n                                      onClick={() => openClientConsultationsSidepane(item.clientId, item.clientName, report.id)}\n                                      className=\"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                    >\n                                      <PencilIcon className=\"h-4 w-4\" />\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                      {t('analytics.monthlyReports.editConsultationsTitle')}\n                                    </div>\n                                  </div>\n                                </td>\n                              </tr>\n                            ))}\n                          </tbody>\n                        </table>\n                      </div>\n                    ) : (\n                      <div className=\"text-center text-gray-500 dark:text-gray-400 py-4\">\n                        Keine Abrechnungspositionen vorhanden\n                      </div>\n                    )}\n                  </div>\n                );\n\n                return (\n                  <DataCard\n                    key={report.id}\n                    title={report.reportNumber}\n                    subtitle={format(new Date(report.generatedAt), 'dd.MM.yyyy HH:mm', { locale: de })}\n                    status={{\n                      label: reportStatus.label,\n                      color: reportStatus.color\n                    }}\n                    metadata={metadata}\n                    actions={actions}\n                    expandable={{\n                      isExpanded: isExpanded,\n                      content: expandableContent,\n                      onToggle: () => toggleExpanded(report.id)\n                    }}\n                  />\n                );\n              })}\n            </CardGrid>\n          )}\n        </div>\n      )}\n\n      {/* Client Consultations Sidepane (Ersetzt das alte Edit Sidepane) */}\n      {isClientConsultationsSidepaneOpen && editingClientId && (\n        <div className=\"fixed inset-0 overflow-hidden z-50\" aria-labelledby=\"slide-over-title\" role=\"dialog\" aria-modal=\"true\">\n          <div className=\"absolute inset-0 overflow-hidden\">\n            {/* Backdrop - nur bei <= 1070px */}\n            {!isLargeScreen && (\n              <div className=\"absolute inset-0 bg-gray-500 bg-opacity-75 transition-opacity sidepane-overlay sidepane-backdrop\" onClick={closeClientConsultationsSidepane}></div>\n            )}\n            \n            {/* Panel - beginnt unter der Topbar */}\n            <div className=\"fixed top-16 bottom-0 right-0 pl-10 max-w-full flex sidepane-panel sidepane-panel-container\" style={{\n              transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)'\n            }}>\n              <div className=\"w-screen max-w-3xl\">\n                <div className=\"h-full flex flex-col bg-white dark:bg-gray-800 shadow-xl overflow-y-scroll\">\n                  {/* Header */}\n                  <div className=\"px-4 py-6 bg-gray-50 dark:bg-gray-700 sm:px-6\">\n                    <div className=\"flex items-center justify-between\">\n                      <h2 className=\"text-lg font-medium text-gray-900 dark:text-white\" id=\"slide-over-title\">\n                        {t('analytics.monthlyReports.editConsultations', { clientName: editingClientName })}\n                      </h2>\n                      <div className=\"ml-3 h-7 flex items-center\">\n                        <button\n                          type=\"button\"\n                          className=\"bg-gray-50 dark:bg-gray-700 rounded-md text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                          onClick={closeClientConsultationsSidepane}\n                        >\n                          <span className=\"sr-only\">{t('analytics.monthlyReports.closePanel')}</span>\n                          <XMarkIcon className=\"h-6 w-6\" aria-hidden=\"true\" />\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Content */}\n                  <div className=\"flex-1 px-4 py-6 sm:px-6\">\n                    <div className=\"space-y-6\">\n                      \n                      {/* Info */}\n                      <div className=\"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4\">\n                        <p className=\"text-sm text-blue-700 dark:text-blue-300\">\n                          <span dangerouslySetInnerHTML={{ __html: t('analytics.monthlyReports.info', { clientName: editingClientName }) }} />\n                        </p>\n                      </div>\n\n                      {/* Action Buttons */}\n                      <div className=\"flex justify-between items-center\">\n                        <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                          {t('analytics.monthlyReports.consultationsCount', { count: clientConsultations.length })}\n                        </h3>\n                        <button\n                          type=\"button\"\n                          className=\"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                        >\n                          <PlusIcon className=\"h-4 w-4 mr-2\" />\n                          {t('analytics.monthlyReports.addConsultation')}\n                        </button>\n                      </div>\n\n                      {/* Consultations List */}\n                      {loadingConsultations ? (\n                        <div className=\"text-center py-4\">\n                          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto\"></div>\n                          <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-2\">{t('analytics.monthlyReports.loadingConsultations')}</p>\n                        </div>\n                      ) : clientConsultations.length > 0 ? (\n                        <div className=\"space-y-3\">\n                          {clientConsultations.map((consultation) => (\n                            <div key={consultation.id} className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-4\">\n                              <div className=\"flex items-center justify-between\">\n                                <div className=\"flex-1\">\n                                  <div className=\"flex items-center space-x-4\">\n                                    <div>\n                                      <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300\">\n                                        {t('analytics.monthlyReports.startTime')}\n                                      </label>\n                                      <input\n                                        type=\"datetime-local\"\n                                        value={consultation.startTime ? new Date(consultation.startTime).toISOString().slice(0, 16) : ''}\n                                        className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                                      />\n                                    </div>\n                                    <div>\n                                      <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300\">\n                                        {t('analytics.monthlyReports.endTime')}\n                                      </label>\n                                      <input\n                                        type=\"datetime-local\"\n                                        value={consultation.endTime ? new Date(consultation.endTime).toISOString().slice(0, 16) : ''}\n                                        className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                                      />\n                                    </div>\n                                    <div className=\"flex-1\">\n                                      <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300\">\n                                        {t('analytics.monthlyReports.notes')}\n                                      </label>\n                                      <input\n                                        type=\"text\"\n                                        value={consultation.notes || ''}\n                                        className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                                        placeholder={t('consultations.notesPlaceholder')}\n                                      />\n                                    </div>\n                                  </div>\n                                  <div className=\"mt-2 text-xs text-gray-500 dark:text-gray-400\">\n                                    {t('consultations.duration')}: {consultation.endTime ? calculateDuration(consultation.startTime, consultation.endTime) : t('worktime.running')}\n                                  </div>\n                                </div>\n                                <div className=\"flex items-center space-x-2 ml-4\">\n                                  <div className=\"relative group\">\n                                    <button\n                                      type=\"button\"\n                                      className=\"text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                                    >\n                                      <CheckIcon className=\"h-4 w-4\" />\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                      {t('common.save')}\n                                    </div>\n                                  </div>\n                                  <div className=\"relative group\">\n                                    <button\n                                      type=\"button\"\n                                      className=\"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300\"\n                                    >\n                                      <TrashIcon className=\"h-4 w-4\" />\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                      {t('common.delete')}\n                                    </div>\n                                  </div>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                        </div>\n                      ) : (\n                        <div className=\"text-center text-gray-500 dark:text-gray-400 py-8\">\n                          <ClockIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-300 dark:text-gray-600\" />\n                          <p>{t('consultations.noConsultationsFound')}</p>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n\n                  {/* Footer */}\n                  <div className=\"flex-shrink-0 px-4 py-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600\">\n                    <div className=\"flex justify-end space-x-3\">\n                      <button\n                        type=\"button\"\n                        className=\"bg-white dark:bg-gray-600 py-2 px-4 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                        onClick={closeClientConsultationsSidepane}\n                      >\n                        {t('common.close')}\n                      </button>\n                      <button\n                        type=\"button\"\n                        className=\"bg-blue-600 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                      >\n                        {t('settings.saveAllChanges')}\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default MonthlyReportsTab; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useLocation } from 'react-router-dom';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport PayrollComponent from '../components/PayrollComponent.tsx';\nimport InvoiceManagementTab from '../components/InvoiceManagementTab.tsx';\nimport MonthlyReportsTab from '../components/MonthlyReportsTab.tsx';\nimport { CalculatorIcon, DocumentTextIcon, ClipboardDocumentListIcon } from '@heroicons/react/24/outline';\n\ntype TabType = 'invoices' | 'monthly-reports' | 'payroll';\n\nconst Payroll: React.FC = () => {\n  const { t } = useTranslation();\n  const { canView } = usePermissions();\n  const location = useLocation();\n  const [activeTab, setActiveTab] = useState<TabType>('invoices');\n  const [selectedInvoiceId, setSelectedInvoiceId] = useState<number | null>(null);\n  const [selectedReportId, setSelectedReportId] = useState<number | null>(null);\n\n  // URL-Parameter verarbeiten\n  useEffect(() => {\n    const queryParams = new URLSearchParams(location.search);\n    const tabParam = queryParams.get('tab') as TabType;\n    const invoiceIdParam = queryParams.get('invoiceId');\n    const reportIdParam = queryParams.get('reportId');\n\n    if (tabParam && ['invoices', 'monthly-reports', 'payroll'].includes(tabParam)) {\n      setActiveTab(tabParam);\n    }\n\n    if (invoiceIdParam) {\n      const invoiceId = parseInt(invoiceIdParam, 10);\n      if (!isNaN(invoiceId)) {\n        setSelectedInvoiceId(invoiceId);\n      }\n    }\n\n    if (reportIdParam) {\n      const reportId = parseInt(reportIdParam, 10);\n      if (!isNaN(reportId)) {\n        setSelectedReportId(reportId);\n      }\n    }\n  }, [location.search]);\n\n  //  FIX: Tabs basierend auf Berechtigungen filtern\n  const allTabs = [\n    {\n      id: 'invoices' as TabType,\n      entity: 'consultation_invoices',\n      name: t('payroll.tabs.invoices'),\n      icon: DocumentTextIcon,\n      component: <InvoiceManagementTab />\n    },\n    {\n      id: 'monthly-reports' as TabType,\n      entity: 'monthly_reports',\n      name: t('payroll.tabs.monthlyReports'),\n      icon: ClipboardDocumentListIcon,\n      component: <MonthlyReportsTab />\n    },\n    {\n      id: 'payroll' as TabType,\n      entity: 'payroll_reports',\n      name: t('payroll.tabs.payroll'),\n      icon: CalculatorIcon,\n      component: <PayrollComponent />\n    }\n  ];\n\n  // Filtere Tabs basierend auf Berechtigungen\n  const tabs = allTabs.filter(tab => canView(tab.entity, 'tab'));\n\n  //  FIX: Default Tab setzen basierend auf verfgbaren Tabs\n  useEffect(() => {\n    if (tabs.length > 0 && !tabs.find(t => t.id === activeTab)) {\n      setActiveTab(tabs[0].id);\n    }\n  }, [tabs, activeTab]);\n\n  return (\n    <div className=\"min-h-screen dark:bg-gray-900\">\n      <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          {/* Tab Headers */}\n          <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n            <nav className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden\">\n              {tabs.map((tab) => {\n                const Icon = tab.icon;\n                return (\n                  <button\n                    key={tab.id}\n                    onClick={() => setActiveTab(tab.id)}\n                    className={`group inline-flex items-center pb-2 sm:pb-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ${\n                      activeTab === tab.id\n                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                        : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                    }`}\n                  >\n                    <Icon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                    {tab.name}\n                  </button>\n                );\n              })}\n            </nav>\n          </div>\n\n          {/* Tab Content */}\n          <div className=\"mt-6\">\n            {tabs.find(tab => tab.id === activeTab)?.component}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Payroll; ","/**\r\n * Zentrale Filter-Logik zur Eliminierung von Code-Duplikation\r\n * \r\n * Diese Datei konsolidiert die Filter-Logik, die zuvor in mehreren Komponenten\r\n * dupliziert war (Requests.tsx, Worktracker.tsx, InvoiceManagementTab.tsx, etc.)\r\n * \r\n * WICHTIG: Die Logik ist exakt identisch mit der vorherigen Implementierung.\r\n * Nur die Code-Duplikation wurde entfernt, keine Funktionalittsnderung!\r\n */\r\n\r\nimport { startOfWeek, endOfWeek, startOfMonth, endOfMonth, startOfYear, endOfYear } from 'date-fns';\r\n\r\nexport interface FilterCondition {\r\n  column: string;\r\n  operator: string;\r\n  value: string | number | Date | null;\r\n}\r\n\r\n/**\r\n * Evaluates a single filter condition against a field value\r\n * @param fieldValue - The value to test against\r\n * @param condition - The filter condition to apply\r\n * @returns true if condition is met, false otherwise\r\n */\r\nexport const evaluateCondition = (\r\n  fieldValue: any,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  const { operator, value } = condition;\r\n  \r\n  // Sicherstellen, dass value definiert ist\r\n  if (value === undefined) {\r\n    console.error('evaluateCondition: value ist undefined', condition);\r\n    return false;\r\n  }\r\n  \r\n  // Handle null/undefined values\r\n  if (fieldValue == null && value == null) {\r\n    return operator === 'equals';\r\n  }\r\n  if (fieldValue == null || value == null) {\r\n    if (operator === 'notEquals') return true;\r\n    return false;\r\n  }\r\n\r\n  // String operations\r\n  // Sicherstellen, dass fieldValue und value Strings sind, bevor toLowerCase() aufgerufen wird\r\n  let strField: string = '';\r\n  let strValue: string = '';\r\n  \r\n  try {\r\n    // Konvertiere fieldValue zu String, auch wenn es ein Objekt ist\r\n    const fieldValueStr = fieldValue == null ? '' : (typeof fieldValue === 'string' ? fieldValue : String(fieldValue));\r\n    if (typeof fieldValueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerField = fieldValueStr.toLowerCase();\r\n    if (lowerField === undefined || lowerField === null || typeof lowerField !== 'string') {\r\n      return false;\r\n    }\r\n    strField = lowerField;\r\n    \r\n    // Konvertiere value zu String, auch wenn es ein Objekt ist\r\n    const valueStr = value == null ? '' : (typeof value === 'string' ? value : String(value));\r\n    if (typeof valueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerValue = valueStr.toLowerCase();\r\n    if (lowerValue === undefined || lowerValue === null || typeof lowerValue !== 'string') {\r\n      return false;\r\n    }\r\n    strValue = lowerValue;\r\n  } catch (error) {\r\n    // Falls toLowerCase() fehlschlgt, gebe false zurck\r\n    return false;\r\n  }\r\n\r\n  // Sicherstellen, dass strField und strValue Strings sind und nicht undefined\r\n  if (typeof strField !== 'string' || typeof strValue !== 'string' || strField === undefined || strValue === undefined || strField === null || strValue === null) {\r\n    return false;\r\n  }\r\n\r\n  switch (operator) {\r\n    case 'equals':\r\n      return strField === strValue;\r\n    case 'notEquals':\r\n      return strField !== strValue;\r\n    case 'contains':\r\n      return strField.includes(strValue);\r\n    case 'startsWith':\r\n      return strField.startsWith(strValue);\r\n    case 'endsWith':\r\n      // Explizite Prfung, dass strField und strValue Strings sind, bevor endsWith aufgerufen wird\r\n      if (strField === undefined || strField === null) {\r\n        console.error('endsWith: strField ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (strValue === undefined || strValue === null) {\r\n        console.error('endsWith: strValue ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strField !== 'string') {\r\n        console.error('endsWith: strField ist kein String', { strField, typeof: typeof strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strValue !== 'string') {\r\n        console.error('endsWith: strValue ist kein String', { strField, strValue, typeof: typeof strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      try {\r\n        return strField.endsWith(strValue);\r\n      } catch (error) {\r\n        console.error('endsWith: Fehler bei endsWith-Aufruf', error, { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n    case 'before':\r\n    case 'after': {\r\n      // Date operations\r\n      const fieldDate = new Date(fieldValue);\r\n      const valueDate = new Date(value as string);\r\n      if (isNaN(fieldDate.getTime()) || isNaN(valueDate.getTime())) {\r\n        return false;\r\n      }\r\n      return operator === 'before' \r\n        ? fieldDate < valueDate \r\n        : fieldDate > valueDate;\r\n    }\r\n    case 'greaterThan':\r\n    case 'lessThan': {\r\n      // Numeric operations\r\n      const fieldNum = parseFloat(String(fieldValue));\r\n      const valueNum = parseFloat(String(value));\r\n      if (isNaN(fieldNum) || isNaN(valueNum)) {\r\n        return false;\r\n      }\r\n      return operator === 'greaterThan'\r\n        ? fieldNum > valueNum\r\n        : fieldNum < valueNum;\r\n    }\r\n    default:\r\n      return true;\r\n  }\r\n};\r\n\r\n/**\r\n * Type for getting field values from items\r\n */\r\nexport type GetFieldValue<T> = (item: T, columnId: string) => any;\r\n\r\n/**\r\n * Type for column-specific evaluation handlers\r\n * Returns true if condition is met, false otherwise\r\n */\r\nexport type ColumnEvaluator<T> = (item: T, condition: FilterCondition) => boolean | null;\r\n\r\n/**\r\n * Applies filter conditions to an array of items\r\n * \r\n * @param items - Array of items to filter\r\n * @param conditions - Array of filter conditions\r\n * @param operators - Array of logical operators ('AND' | 'OR') between conditions\r\n * @param getFieldValue - Function to extract field values from items\r\n * @param columnEvaluators - Optional map of column-specific evaluators for custom logic\r\n * @returns Filtered array of items\r\n * \r\n * @example\r\n * // Standard usage with getFieldValue\r\n * const filtered = applyFilters(items, conditions, operators, (item, col) => item[col]);\r\n * \r\n * // With custom column evaluators\r\n * const filtered = applyFilters(\r\n *   items,\r\n *   conditions,\r\n *   operators,\r\n *   (item, col) => item[col],\r\n *   {\r\n *     'responsible': (item, condition) => {\r\n *       // Custom logic for responsible column\r\n *       return evaluateUserRoleCondition(item.responsible?.id, item.role?.id, condition);\r\n *     }\r\n *   }\r\n * );\r\n */\r\nexport const applyFilters = <T>(\r\n  items: T[],\r\n  conditions: FilterCondition[],\r\n  operators: ('AND' | 'OR')[],\r\n  getFieldValue: GetFieldValue<T>,\r\n  columnEvaluators?: Record<string, ColumnEvaluator<T>>\r\n): T[] => {\r\n  if (conditions.length === 0) {\r\n    return items;\r\n  }\r\n\r\n  return items.filter(item => {\r\n    let result = true;\r\n\r\n    for (let i = 0; i < conditions.length; i++) {\r\n      const condition = conditions[i];\r\n      let conditionMet = false;\r\n\r\n      // Check if there's a custom evaluator for this column\r\n      if (columnEvaluators && columnEvaluators[condition.column]) {\r\n        const customResult = columnEvaluators[condition.column](item, condition);\r\n        if (customResult !== null) {\r\n          conditionMet = customResult;\r\n        } else {\r\n          // Fallback to standard evaluation if custom evaluator returns null\r\n          const fieldValue = getFieldValue(item, condition.column);\r\n          conditionMet = evaluateCondition(fieldValue, condition);\r\n        }\r\n      } else {\r\n        // Standard evaluation\r\n        const fieldValue = getFieldValue(item, condition.column);\r\n        conditionMet = evaluateCondition(fieldValue, condition);\r\n      }\r\n\r\n      // Apply logical operators\r\n      if (i === 0) {\r\n        result = conditionMet;\r\n      } else {\r\n        const operator = operators[i - 1] || 'AND';\r\n        result = operator === 'AND' \r\n          ? (result && conditionMet) \r\n          : (result || conditionMet);\r\n      }\r\n    }\r\n\r\n    return result;\r\n  });\r\n};\r\n\r\n/**\r\n * Helper function to evaluate date conditions with proper date comparison\r\n * Supports __TODAY__ as a dynamic date value\r\n * \r\n * WICHTIG: Extrahiert nur den Datumsteil (Jahr, Monat, Tag) ohne Zeitzone,\r\n * um Zeitzone-Konvertierungsprobleme zu vermeiden (verhindert Tag-Versatz)\r\n */\r\nexport const evaluateDateCondition = (\r\n  dateValue: Date | string | null | undefined,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  if (!dateValue) {\r\n    return false;\r\n  }\r\n\r\n  const date = new Date(dateValue);\r\n  if (isNaN(date.getTime())) {\r\n    return false;\r\n  }\r\n\r\n  // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n  // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n  const dateYear = date.getUTCFullYear();\r\n  const dateMonth = date.getUTCMonth();\r\n  const dateDay = date.getUTCDate();\r\n  // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n  const normalizedDate = new Date(dateYear, dateMonth, dateDay);\r\n\r\n  //  PHASE 5: Handle Zeitraum-Platzhalter (__THIS_WEEK__, __THIS_MONTH__, __THIS_YEAR__)\r\n  // Diese funktionieren analog zu __TODAY__, aber fr Zeitrume\r\n  try {\r\n    if (condition.value === '__THIS_WEEK__') {\r\n      if (condition.operator === 'equals') {\r\n        const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekStart.setHours(0, 0, 0, 0);\r\n        const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= weekStart && normalizedDate <= weekEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Woche als einzelnes Datum\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < weekEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > weekStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_MONTH__') {\r\n      if (condition.operator === 'equals') {\r\n        const monthStart = startOfMonth(new Date());\r\n        monthStart.setHours(0, 0, 0, 0);\r\n        const monthEnd = endOfMonth(new Date());\r\n        monthEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= monthStart && normalizedDate <= monthEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Monat als einzelnes Datum\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < monthEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > monthStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_YEAR__') {\r\n      if (condition.operator === 'equals') {\r\n        const yearStart = startOfYear(new Date());\r\n        yearStart.setHours(0, 0, 0, 0);\r\n        const yearEnd = endOfYear(new Date());\r\n        yearEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= yearStart && normalizedDate <= yearEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Jahr als einzelnes Datum\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < yearEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > yearStart;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    // Handle __TODAY__, __WEEK_START__, __WEEK_END__, __MONTH_START__, __MONTH_END__, __YEAR_START__, __YEAR_END__ dynamic dates\r\n    let conditionDate: Date;\r\n    if (condition.value === '__TODAY__') {\r\n      // Get today's date in local timezone (set to midnight)\r\n      const localToday = new Date();\r\n      localToday.setHours(0, 0, 0, 0);\r\n      conditionDate = localToday;\r\n    } else if (condition.value === '__WEEK_START__') {\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      conditionDate = weekStart;\r\n    } else if (condition.value === '__WEEK_END__') {\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = weekEnd;\r\n    } else if (condition.value === '__MONTH_START__') {\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      conditionDate = monthStart;\r\n    } else if (condition.value === '__MONTH_END__') {\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = monthEnd;\r\n    } else if (condition.value === '__YEAR_START__') {\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      conditionDate = yearStart;\r\n    } else if (condition.value === '__YEAR_END__') {\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = yearEnd;\r\n    } else {\r\n      const conditionDateRaw = new Date(condition.value as string);\r\n      if (isNaN(conditionDateRaw.getTime())) {\r\n        return false;\r\n      }\r\n      // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n      // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n      const conditionYear = conditionDateRaw.getUTCFullYear();\r\n      const conditionMonth = conditionDateRaw.getUTCMonth();\r\n      const conditionDay = conditionDateRaw.getUTCDate();\r\n      // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n      conditionDate = new Date(conditionYear, conditionMonth, conditionDay);\r\n    }\r\n\r\n    switch (condition.operator) {\r\n      case 'equals':\r\n        return normalizedDate.getTime() === conditionDate.getTime();\r\n      case 'before':\r\n        return normalizedDate < conditionDate;\r\n      case 'after':\r\n        return normalizedDate > conditionDate;\r\n      default:\r\n        return true;\r\n    }\r\n  } catch (error) {\r\n    //  PHASE 5: Error Handling fr ungltige Platzhalter-Werte\r\n    console.error(`[evaluateDateCondition] Error with placeholder ${condition.value}:`, error);\r\n    return false; // Fallback: Filter schliet Datensatz aus\r\n  }\r\n};\r\n\r\n/**\r\n * Helper function to evaluate user/role conditions with user-{id} or role-{id} format\r\n * Supports both user-{id} and role-{id} formats, plus text fallback for legacy support\r\n */\r\nexport const evaluateUserRoleCondition = (\r\n  userId: number | null | undefined,\r\n  roleId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  textValue?: string  // Optional: text representation for fallback (e.g. \"John Doe\")\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = userId === targetUserId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = roleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  if (textValue !== undefined) {\r\n    const textValueLower = textValue.toLowerCase();\r\n    const valueLower = value.toLowerCase();\r\n    if (condition.operator === 'equals') {\r\n      return textValueLower === valueLower;\r\n    } else if (condition.operator === 'notEquals') {\r\n      return textValueLower !== valueLower;\r\n    } else if (condition.operator === 'contains') {\r\n      return textValueLower.includes(valueLower);\r\n    }\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n/**\r\n * Helper function for combined responsible/qualityControl filter (specific to Tasks)\r\n */\r\nexport const evaluateResponsibleAndQualityControl = (\r\n  responsibleId: number | null | undefined,\r\n  responsibleRoleId: number | null | undefined,\r\n  qualityControlId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  responsibleText?: string,\r\n  qualityControlText?: string\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format - matches either responsible OR qualityControl\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = (responsibleId === targetUserId) || (qualityControlId === targetUserId);\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format - only matches with responsible role\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = responsibleRoleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  const valueLower = value.toLowerCase();\r\n  if (condition.operator === 'equals') {\r\n    return (responsibleText?.toLowerCase() === valueLower) || (qualityControlText?.toLowerCase() === valueLower);\r\n  } else if (condition.operator === 'notEquals') {\r\n    return (responsibleText?.toLowerCase() !== valueLower) && (qualityControlText?.toLowerCase() !== valueLower);\r\n  } else if (condition.operator === 'contains') {\r\n    return (responsibleText?.toLowerCase()?.includes(valueLower) ?? false) || (qualityControlText?.toLowerCase()?.includes(valueLower) ?? false);\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n"],"names":["formatCurrency","amount","currency","arguments","length","undefined","Intl","NumberFormat","style","format","formatContractType","contractType","t","translationKey","concat","translated","PayrollComponent","useTranslation","user","useAuth","hasPermission","getAccessLevel","loading","permissionsLoading","usePermissions","canEditPayroll","hours","setHours","useState","regular","overtime","night","holidayHours","sundayHoliday","overtimeNight","overtimeSundayHoliday","overtimeNightSundayHoliday","payroll","setPayroll","payrolls","setPayrolls","selectedUser","setSelectedUser","allUsers","setAllUsers","organization","useOrganization","periodStart","setPeriodStart","periodEnd","setPeriodEnd","setLoading","error","setError","payrollAccessLevel","canSeeAllUsers","useEffect","id","users","useMemo","async","response","axiosInstance","get","API_ENDPOINTS","USERS","DROPDOWN","data","console","fetchUsers","fetchPayrolls","useCallback","PAYROLL","BASE","fetchPrefilledHours","userId","start","end","PREFILL_HOURS","toISOString","find","u","defaultPeriod","now","Date","payrollCountry","getFullYear","getMonth","getDate","getDefaultPeriod","handleHoursChange","e","field","value","Math","max","Number","target","_objectSpread","saveHours","post","HOURS","calculatedPayroll","CALCULATE","_error$response","_error$response2","_error$response2$data","_error$response2$data2","_error$response3","_error$response3$data","status","includes","toLocaleDateString","selectPayroll","payrollId","generatePDF","window","open","location","origin","PDF","_jsx","className","children","_jsxs","defaultValue","onChange","map","firstName","lastName","_Fragment","type","split","date","disabled","min","step","onClick","item","regularHours","overtimeHours","nightHours","sundayHolidayHours","overtimeNightHours","overtimeSundayHolidayHours","overtimeNightSundayHolidayHours","grossPay","netPay","hourlyRate","socialSecurity","taxes","getTime","getStatusBadge","config","DRAFT","label","color","SENT","PAID","OVERDUE","CANCELLED","_ref","isOpen","onClose","invoiceId","onInvoiceUpdated","showMessage","useMessage","invoice","setInvoice","isMarkingAsPaid","setIsMarkingAsPaid","loadInvoiceDetails","CONSULTATION_INVOICES","BY_ID","getTotalPaid","payments","reduce","sum","payment","getRemainingAmount","total","Dialog","Panel","Title","XMarkIcon","invoiceNumber","issueDate","locale","de","dueDate","UserIcon","client","name","company","email","phone","address","BuildingOfficeIcon","ClockIcon","items","formatTime","workTime","startTime","calculateDuration","endTime","branch","unitPrice","toFixed","subtotal","vatRate","vatAmount","CurrencyDollarIcon","paymentDate","paymentMethod","reference","notes","GENERATE_PDF","responseType","headers","blob","Blob","url","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","_error$response$data","message","title","DocumentArrowDownIcon","MARK_PAID","ArrowPathIcon","defaultColumnOrder","INVOICES_TABLE_ID","tableToCardMapping","_editingInvoice$items","selectedInvoiceId","initialSelectedInvoiceId","openSidepane","closeSidepane","useSidepane","isLargeScreen","setIsLargeScreen","innerWidth","invoices","setInvoices","searchTerm","setSearchTerm","isFilterModalOpen","setIsFilterModalOpen","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","setSelectedInvoiceId","isDetailModalOpen","setIsDetailModalOpen","expandedRows","setExpandedRows","Set","isEditSidepaneOpen","setIsEditSidepaneOpen","editingInvoice","setEditingInvoice","editingPositions","setEditingPositions","canViewInvoices","canEditInvoices","canDownloadInvoices","settings","isLoading","isLoadingSettings","updateColumnOrder","updateHiddenColumns","toggleColumnVisibility","isColumnVisible","updateViewMode","updateSortConfig","useTableSettings","defaultHiddenColumns","defaultViewMode","isColumnConfigOpen","setIsColumnConfigOpen","availableColumns","shortLabel","substring","sortConfig","key","direction","statusConfig","viewMode","cardMetadataOrder","columnOrder","cardMetadata","forEach","tableCol","cardMeta","push","getCardMetadataFromColumnOrder","hiddenCardMetadata","hiddenTableColumns","add","getHiddenCardMetadata","hiddenColumns","visibleCardMetadata","filter","meta","has","wrapper","querySelector","classList","remove","loadInvoices","inv","handleDownloadPdf","toast","success","handleMarkAsPaid","_invoices$find","toggleExpanded","prev","newSet","delete","handleResize","addEventListener","removeEventListener","openEditSidepane","closeEditSidepane","applyFilterConditions","conditions","operators","resetFilterConditions","filteredAndSortedInvoices","filtered","searchLower","toLowerCase","columnEvaluators","cond","clientName","operator","compareValue","parseFloat","isNaN","abs","getFieldValue","columnId","applyFilters","sortableColumns","colId","sort","a","b","cardSortDirections","valueA","valueB","comparison","strA","String","strB","localeCompare","aValue","bValue","renderSortableHeader","sortKey","newDirection","handleSort","Array","_","i","FunnelIcon","Squares2X2Icon","TableCellsIcon","ArrowsUpDownIcon","MagnifyingGlassIcon","placeholder","SavedFilterTags","tableId","onSelectFilter","onReset","onFilterChange","handleFilterChange","column","col","_invoice$items","React","ChevronDownIcon","PencilIcon","colSpan","paymentTerms","count","description","quantity","CardGrid","gap","_invoice$items2","isExpanded","metadata","icon","CalendarIcon","invoiceStatus","actions","expandableContent","DataCard","expandable","content","onToggle","FilterPane","columns","onApply","savedConditions","savedOperators","TableColumnConfig","onOpenChange","visibleColumns","onToggleColumnVisibility","mainSortConfig","onMainSortChange","handleMainSortChange","showMainSort","InvoiceDetailModal","role","transition","rows","PlusIcon","index","TrashIcon","CheckIcon","selectedReportId","reports","setReports","generating","setGenerating","unbilledCheck","setUnbilledCheck","selectedReportRef","useRef","sortedReports","_sorted$","_sorted$$reportNumber","_sorted$2","_sorted$2$reportNumbe","_sorted$3","_sorted$4","_sorted$5","_sorted$5$recipient","_sorted$6","_sorted$6$recipient","_sorted$7","_sorted$8","_sorted$9","_sorted$9$status","_sorted$10","_sorted$10$status","sorted","reportNumber","recipient","totalHours","_a$reportNumber","_b$reportNumber","_a$recipient","_b$recipient","_a$status","_b$status","isClientConsultationsSidepaneOpen","setIsClientConsultationsSidepaneOpen","editingClientId","setEditingClientId","editingClientName","setEditingClientName","clientConsultations","setClientConsultations","loadingConsultations","setLoadingConsultations","loadReports","checkUnbilledConsultations","timeoutId","current","scrollIntoView","behavior","block","backgroundColor","setTimeout","clearTimeout","MONTHLY_CONSULTATION_REPORTS","CHECK_UNBILLED","downloadPDF","report","reportId","openClientConsultationsSidepane","clientId","loadClientConsultations","closeClientConsultationsSidepane","r","CONSULTATIONS","getStatusIcon","CheckCircleIcon","EyeIcon","getStatusText","hasUnbilledConsultations","ExclamationTriangleIcon","logger","log","GENERATE_AUTOMATIC","_report$items","ref","generatedAt","consultationCount","_report$items2","reportStatus","GENERATED","ARCHIVED","subtitle","dangerouslySetInnerHTML","__html","consultation","slice","Payroll","_tabs$find","canView","useLocation","activeTab","setActiveTab","setSelectedReportId","queryParams","URLSearchParams","search","tabParam","invoiceIdParam","reportIdParam","parseInt","tabs","entity","DocumentTextIcon","component","InvoiceManagementTab","ClipboardDocumentListIcon","MonthlyReportsTab","CalculatorIcon","tab","Icon","evaluateCondition","fieldValue","condition","strField","strValue","fieldValueStr","lowerField","valueStr","lowerValue","startsWith","typeof","endsWith","fieldDate","valueDate","fieldNum","valueNum","result","conditionMet","customResult","evaluateDateCondition","dateValue","dateYear","getUTCFullYear","dateMonth","getUTCMonth","dateDay","getUTCDate","normalizedDate","weekStart","startOfWeek","weekStartsOn","weekEnd","endOfWeek","monthStart","startOfMonth","monthEnd","endOfMonth","yearStart","startOfYear","yearEnd","endOfYear","conditionDate","localToday","conditionDateRaw","conditionYear","conditionMonth","conditionDay","evaluateUserRoleCondition","roleId","textValue","targetUserId","replace","matches","targetRoleId","textValueLower","valueLower"],"sourceRoot":""}