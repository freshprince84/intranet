{"version":3,"file":"static/js/692.97c662b8.chunk.js","mappings":"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","sources":["components/FilterRow.tsx","components/FilterLogicalOperator.tsx","components/FilterPane.tsx","components/SavedFilterTags.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { TrashIcon, PlusCircleIcon, ArrowUpIcon, ArrowDownIcon, ChevronUpIcon, ChevronDownIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\n\nexport interface FilterCondition {\n  column: string;\n  operator: string;\n  value: string | number | Date | null;\n}\n\ninterface TableColumn {\n  id: string;\n  label: string;\n}\n\ninterface FilterRowProps {\n  condition: FilterCondition;\n  onChange: (condition: FilterCondition) => void;\n  onDelete: () => void;\n  onAdd: () => void;\n  columns: TableColumn[];\n  isFirst: boolean;\n  isLast: boolean;\n  sortDirection?: 'asc' | 'desc';\n  sortPriority?: number;\n  onSortDirectionChange?: (direction: 'asc' | 'desc') => void;\n  onPriorityChange?: (priority: number) => void;\n  canMoveUp?: boolean;\n  canMoveDown?: boolean;\n}\n\n// Neue Interfaces für Benutzer und Rollen\ninterface User {\n  id: number;\n  firstName: string;\n  lastName: string;\n}\n\ninterface Role {\n  id: number;\n  name: string;\n}\n\ninterface Branch {\n  id: number;\n  name: string;\n}\n\nconst getOperatorsByColumnType = (columnId: string, t: (key: string) => string): { value: string; label: string }[] => {\n  // Standard-Text-Operatoren\n  const textOperators = [\n    { value: 'equals', label: t('filter.operators.equals') },\n    { value: 'contains', label: t('filter.operators.contains') },\n    { value: 'startsWith', label: t('filter.operators.startsWith') },\n    { value: 'endsWith', label: t('filter.operators.endsWith') }\n  ];\n\n  // Datum-Operatoren (benutzerfreundliche Labels)\n  const dateOperators = [\n    { value: 'equals', label: t('filter.operators.isExactly') },\n    { value: 'after', label: t('filter.operators.after') },\n    { value: 'before', label: t('filter.operators.before') },\n    { value: 'between', label: t('filter.operators.between') }\n  ];\n\n  // Dauer-Operatoren (für Zeitspannen und Zahlen)\n  const durationOperators = [\n    { value: 'equals', label: t('filter.operators.isEqual') },\n    { value: 'greaterThan', label: t('filter.operators.greaterThan') },\n    { value: 'lessThan', label: t('filter.operators.lessThan') }\n  ];\n\n  // Status-Operatoren (für Enum-Werte)\n  const statusOperators = [\n    { value: 'equals', label: t('filter.operators.equals') },\n    { value: 'notEquals', label: t('filter.operators.notEquals') }\n  ];\n\n  // Je nach Spaltentyp entsprechende Operatoren zurückgeben\n  if (columnId === 'dueDate' || columnId === 'startTime' || columnId === 'checkInDate' || columnId === 'checkOutDate' || columnId === 'arrivalTime') {\n    return dateOperators;\n  } else if (columnId === 'duration' || columnId === 'amount') {\n    return durationOperators;\n  } else if (columnId === 'status' || columnId === 'paymentStatus') {\n    return statusOperators;\n  } else if (columnId === 'responsible' || columnId === 'qualityControl' || columnId === 'responsibleAndQualityControl') {\n    return statusOperators;\n  } else {\n    return textOperators;\n  }\n};\n\nconst FilterRow: React.FC<FilterRowProps> = ({ \n  condition, \n  onChange, \n  onDelete, \n  onAdd,\n  columns, \n  isFirst,\n  isLast,\n  sortDirection,\n  sortPriority,\n  onSortDirectionChange,\n  onPriorityChange,\n  canMoveUp = false,\n  canMoveDown = false\n}) => {\n  const { t } = useTranslation();\n  const [operators, setOperators] = useState<{ value: string; label: string }[]>([]);\n  // States für Benutzer, Rollen und Branches\n  const [users, setUsers] = useState<User[]>([]);\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [branches, setBranches] = useState<Branch[]>([]);\n  const [loadingUsers, setLoadingUsers] = useState(false);\n  const [loadingRoles, setLoadingRoles] = useState(false);\n  const [loadingBranches, setLoadingBranches] = useState(false);\n  \n  // Operatoren aktualisieren, wenn sich die Spalte ändert\n  useEffect(() => {\n    setOperators(getOperatorsByColumnType(condition.column, t));\n  }, [condition.column, t]);\n  \n  // Laden der Benutzer, Rollen und Branches, wenn benötigt\n  useEffect(() => {\n    const loadUsersAndRoles = async () => {\n      const token = localStorage.getItem('token');\n      if (!token) return;\n      \n      // WICHTIG: requestedBy, responsible, qualityControl und responsibleAndQualityControl benötigen Dropdowns\n      if (condition.column === 'requestedBy' || condition.column === 'responsible' || condition.column === 'qualityControl' || condition.column === 'responsibleAndQualityControl') {\n        // Benutzer laden (nur aktive Benutzer)\n        setLoadingUsers(true);\n        try {\n          const response = await axiosInstance.get('/users/dropdown');\n          setUsers(response.data);\n        } catch (error) {\n          console.error('Fehler beim Laden der Benutzer:', error);\n        } finally {\n          setLoadingUsers(false);\n        }\n        \n        // Tabellen-Typ erkennen (wie bei Status-Dropdown)\n        const isRequestTable = columns.some(col => col.id === 'requestedBy' || col.id === 'createTodo');\n        const isTaskTable = columns.some(col => col.id === 'responsible' || col.id === 'qualityControl');\n        \n        // Rollen laden NUR für Tasks, NICHT für Requests\n        // requestedBy: NUR bei Tasks (aber Tasks haben kein requestedBy, also nie)\n        // responsible: NUR bei Tasks\n        // responsibleAndQualityControl: NUR bei Tasks\n        if ((condition.column === 'responsible' || condition.column === 'responsibleAndQualityControl') && isTaskTable) {\n          setLoadingRoles(true);\n          try {\n            const response = await axiosInstance.get('/roles');\n            setRoles(response.data);\n          } catch (error) {\n            console.error('Fehler beim Laden der Rollen:', error);\n          } finally {\n            setLoadingRoles(false);\n          }\n        }\n      }\n      \n      // Branches laden für branch-Spalte\n      if (condition.column === 'branch') {\n        setLoadingBranches(true);\n        try {\n          const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n          setBranches(response.data);\n        } catch (error) {\n          console.error('Fehler beim Laden der Branches:', error);\n        } finally {\n          setLoadingBranches(false);\n        }\n      }\n    };\n    \n    loadUsersAndRoles();\n  }, [condition.column]);\n  \n  // Rendert das Eingabefeld basierend auf Spalte und Operator\n  const renderValueInput = (\n    columnId: string, \n    operator: string, \n    value: string | number | Date | null, \n    onChange: (value: string | number | Date | null) => void\n  ) => {\n    // Für Status ein Dropdown rendern\n    if (columnId === 'status') {\n      // Überprüfen welche Tabelle wir filtern (über Columns-Array)\n      const isRequestTable = columns.some(col => col.id === 'requestedBy' || col.id === 'createTodo');\n      const isTaskTable = columns.some(col => col.id === 'responsible' || col.id === 'qualityControl');\n      const isInvoiceTable = columns.some(col => col.id === 'client') && !columns.some(col => col.id === 'responsible');\n      \n      if (isRequestTable) {\n        // Request-Status-Optionen\n        return (\n          <select\n            className=\"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={value as string || ''}\n            onChange={(e) => onChange(e.target.value)}\n          >\n            <option value=\"\">{t('filter.row.pleaseSelect')}</option>\n            <option value=\"approval\">{t('filter.row.status.approval')}</option>\n            <option value=\"approved\">{t('filter.row.status.approved')}</option>\n            <option value=\"to_improve\">{t('filter.row.status.to_improve')}</option>\n            <option value=\"denied\">{t('filter.row.status.denied')}</option>\n          </select>\n        );\n      } else if (isTaskTable) {\n        // Task-Status-Optionen\n        return (\n          <select\n            className=\"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={value as string || ''}\n            onChange={(e) => onChange(e.target.value)}\n          >\n            <option value=\"\">{t('filter.row.pleaseSelect')}</option>\n            <option value=\"open\">{t('filter.row.status.open')}</option>\n            <option value=\"in_progress\">{t('filter.row.status.in_progress')}</option>\n            <option value=\"improval\">{t('filter.row.status.improval')}</option>\n            <option value=\"quality_control\">{t('filter.row.status.quality_control')}</option>\n            <option value=\"done\">{t('filter.row.status.done')}</option>\n          </select>\n        );\n      } else if (isInvoiceTable) {\n        // Invoice-Status-Optionen\n        return (\n          <select\n            className=\"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={value as string || ''}\n            onChange={(e) => onChange(e.target.value)}\n          >\n            <option value=\"\">{t('filter.row.pleaseSelect')}</option>\n            <option value=\"DRAFT\">{t('filter.row.status.draft')}</option>\n            <option value=\"SENT\">{t('filter.row.status.sent')}</option>\n            <option value=\"PAID\">{t('filter.row.status.paid')}</option>\n            <option value=\"OVERDUE\">{t('filter.row.status.overdue')}</option>\n            <option value=\"CANCELLED\">{t('filter.row.status.cancelled')}</option>\n          </select>\n        );\n      } else {\n        // Fallback für andere Tabellen mit Status\n        return (\n          <select\n            className=\"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={value as string || ''}\n            onChange={(e) => onChange(e.target.value)}\n          >\n            <option value=\"\">{t('filter.row.pleaseSelect')}</option>\n            <option value=\"open\">{t('filter.row.status.open')}</option>\n            <option value=\"in_progress\">{t('filter.row.status.in_progress')}</option>\n            <option value=\"done\">{t('filter.row.status.done')}</option>\n          </select>\n        );\n      }\n    }\n    \n    // Für requestedBy, responsible und responsibleAndQualityControl ein Dropdown mit Benutzern und Rollen rendern\n    // WICHTIG: Diese Spalten müssen IMMER Dropdowns verwenden, keine Text-Eingabe\n    if (columnId === 'requestedBy' || columnId === 'responsible' || columnId === 'responsibleAndQualityControl') {\n      // Tabellen-Typ erkennen (wie bei Status-Dropdown)\n      const isRequestTable = columns.some(col => col.id === 'requestedBy' || col.id === 'createTodo');\n      const isTaskTable = columns.some(col => col.id === 'responsible' || col.id === 'qualityControl');\n      \n      // Bestimme ob Rollen angezeigt werden sollen\n      // requestedBy: Nur Users (bei Requests, keine Rollen)\n      // responsible: Users + Roles (bei Tasks), nur Users (bei Requests)\n      // responsibleAndQualityControl: Users + Roles (bei Tasks)\n      const showRoles = (columnId === 'responsible' || columnId === 'responsibleAndQualityControl') && isTaskTable;\n      \n      return (\n        <select\n          className=\"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n          value={value as string || ''}\n          onChange={(e) => onChange(e.target.value)}\n          disabled={loadingUsers || (showRoles && loadingRoles)}\n        >\n            <option value=\"\">{t('filter.row.pleaseSelect')}</option>\n          \n          {users.length > 0 && (\n            <optgroup label={t('filter.row.groups.users')}>\n              {users.map(user => (\n                <option key={`user-${user.id}`} value={`user-${user.id}`}>\n                  {user.firstName} {user.lastName}\n                </option>\n              ))}\n            </optgroup>\n          )}\n          \n          {showRoles && roles.length > 0 && (\n            <optgroup label={t('filter.row.groups.roles')}>\n              {roles.map(role => (\n                <option key={`role-${role.id}`} value={`role-${role.id}`}>\n                  {role.name}\n                </option>\n              ))}\n            </optgroup>\n          )}\n          \n          {(loadingUsers || (showRoles && loadingRoles)) && (\n            <option value=\"\" disabled>{t('filter.row.loadingData')}</option>\n          )}\n        </select>\n      );\n    }\n    \n    // Für Qualitätskontrolle ein Dropdown nur mit Benutzern rendern\n    if (columnId === 'qualityControl') {\n      return (\n        <select\n          className=\"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n          value={value as string || ''}\n          onChange={(e) => onChange(e.target.value)}\n          disabled={loadingUsers}\n        >\n            <option value=\"\">{t('filter.row.pleaseSelect')}</option>\n          \n          {users.length > 0 && (\n            <optgroup label={t('filter.row.groups.users')}>\n              {users.map(user => (\n                <option key={`user-${user.id}`} value={`user-${user.id}`}>\n                  {user.firstName} {user.lastName}\n                </option>\n              ))}\n            </optgroup>\n          )}\n          \n          {loadingUsers && (\n            <option value=\"\" disabled>{t('filter.row.loadingUsers')}</option>\n          )}\n        </select>\n      );\n    }\n    \n    // Für Typ ein Dropdown rendern (nur für Requests)\n    if (columnId === 'type') {\n      const isRequestTable = columns.some(col => col.id === 'requestedBy' || col.id === 'createTodo');\n      if (isRequestTable) {\n        return (\n          <select\n            className=\"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={value as string || ''}\n            onChange={(e) => onChange(e.target.value)}\n          >\n            <option value=\"\">{t('filter.row.pleaseSelect')}</option>\n            <option value=\"vacation\">{t('requests.types.vacation')}</option>\n            <option value=\"improvement_suggestion\">{t('requests.types.improvement_suggestion')}</option>\n            <option value=\"sick_leave\">{t('requests.types.sick_leave')}</option>\n            <option value=\"employment_certificate\">{t('requests.types.employment_certificate')}</option>\n            <option value=\"other\">{t('requests.types.other')}</option>\n          </select>\n        );\n      }\n    }\n    \n    // Für Branch ein Dropdown rendern\n    if (columnId === 'branch') {\n      return (\n        <select\n          className=\"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n          value={value as string || ''}\n          onChange={(e) => onChange(e.target.value)}\n          disabled={loadingBranches}\n        >\n          <option value=\"\">{t('filter.row.pleaseSelect')}</option>\n          {branches.length > 0 && (\n            branches.map(branch => (\n              <option key={branch.id} value={branch.name}>\n                {branch.name}\n              </option>\n            ))\n          )}\n          {loadingBranches && (\n            <option value=\"\" disabled>{t('filter.row.loadingData')}</option>\n          )}\n        </select>\n      );\n    }\n    \n    // Für Datumsfelder ein Datumseingabefeld rendern\n    if (columnId === 'dueDate' || columnId === 'startTime' || columnId === 'checkInDate' || columnId === 'checkOutDate' || columnId === 'arrivalTime') {\n      // Prüfe ob der Wert eine Variable ist\n      const isVariable = value === '__TODAY__';\n      const isCustomDate = !isVariable && value;\n      \n      return (\n        <div className=\"space-y-2\">\n          {/* Auswahl zwischen Datum und Variable */}\n          <select\n            className=\"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-xs bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full\"\n            value={isVariable ? 'variable' : 'date'}\n            onChange={(e) => {\n              if (e.target.value === 'variable') {\n                onChange('__TODAY__');\n              } else {\n                onChange('');\n              }\n            }}\n          >\n            <option value=\"date\">{t('filter.row.selectDate')}</option>\n            <option value=\"variable\">{t('filter.row.currentDay')}</option>\n          </select>\n          \n          {/* Datum-Input nur anzeigen wenn nicht Variable */}\n          {!isVariable && (\n            <input\n              type=\"date\"\n              className=\"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n              value={value as string || ''}\n              onChange={(e) => onChange(e.target.value)}\n            />\n          )}\n          \n          {/* Variable-Anzeige */}\n          {isVariable && (\n            <div className=\"px-2 py-1 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md text-blue-700 dark:text-blue-300 text-xs\">\n              📅 {t('filter.row.dynamicDay')}\n            </div>\n          )}\n        </div>\n      );\n    }\n    \n    // Standard-Texteingabe für alle anderen Felder\n    return (\n      <input\n        type=\"text\"\n        className=\"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-xs bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full\"\n        value={value as string || ''}\n        onChange={(e) => onChange(e.target.value)}\n        placeholder={t('filter.row.enterValue')}\n      />\n    );\n  };\n  \n  return (\n    <div className=\"flex items-center gap-2\">\n      {/* Spalten-Auswahl - feste Breite */}\n      <div className=\"w-[180px] flex-shrink-0\">\n        <select\n          className=\"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-xs bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full\"\n          value={condition.column}\n          onChange={(e) => onChange({ \n            ...condition, \n            column: e.target.value, \n            operator: operators[0]?.value || 'equals',\n            value: null  // ✅ VALUE ZURÜCKSETZEN beim Spaltenwechsel\n          })}\n        >\n          <option value=\"\">{t('filter.row.selectColumn')}</option>\n          {columns.map((column) => (\n            <option key={column.id} value={column.id}>\n              {column.label}\n            </option>\n          ))}\n        </select>\n      </div>\n      \n      {/* Operator-Auswahl - feste Breite */}\n      <div className=\"w-[140px] flex-shrink-0\">\n        <select\n          className=\"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-xs bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full\"\n          value={condition.operator}\n          onChange={(e) => onChange({ ...condition, operator: e.target.value })}\n        >\n          {operators.map((op) => (\n            <option key={op.value} value={op.value}>\n              {op.label}\n            </option>\n          ))}\n        </select>\n      </div>\n      \n      {/* Wert-Eingabe - flexibel */}\n      <div className=\"flex-1 min-w-0\">\n        {renderValueInput(\n          condition.column, \n          condition.operator, \n          condition.value, \n          (value) => onChange({ ...condition, value })\n        )}\n      </div>\n      \n      {/* Sortierrichtung und Priorität (nur wenn Spalte ausgewählt ist) - feste Breite */}\n      <div className=\"w-[60px] flex-shrink-0 flex items-center justify-center\">\n        {condition.column !== '' && onSortDirectionChange && (\n          <div className=\"flex items-center gap-1\">\n            {/* Prioritäts-Anzeige und -Steuerung */}\n            {sortPriority !== undefined && sortPriority > 0 && (\n              <div className=\"flex flex-col items-center gap-0.5\">\n                {canMoveUp && onPriorityChange && (\n                  <div className=\"relative group\">\n                    <button\n                      type=\"button\"\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        onPriorityChange(sortPriority - 1);\n                      }}\n                      className=\"p-0.5 text-gray-400 dark:text-gray-500 hover:text-blue-600 dark:hover:text-blue-500 rounded transition-colors\"\n                    >\n                      <ChevronUpIcon className=\"h-3 w-3\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {t('filter.row.moveUp')}\n                    </div>\n                  </div>\n                )}\n                <span className=\"text-xs font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 px-1.5 py-0.5 rounded min-w-[1.5rem] text-center\">\n                  {sortPriority}\n                </span>\n                {canMoveDown && onPriorityChange && (\n                  <div className=\"relative group\">\n                    <button\n                      type=\"button\"\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        onPriorityChange(sortPriority + 1);\n                      }}\n                      className=\"p-0.5 text-gray-400 dark:text-gray-500 hover:text-blue-600 dark:hover:text-blue-500 rounded transition-colors\"\n                    >\n                      <ChevronDownIcon className=\"h-3 w-3\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {t('filter.row.moveDown')}\n                    </div>\n                  </div>\n                )}\n              </div>\n            )}\n            \n            {/* Sortierrichtung-Button */}\n            <div className=\"relative group\">\n              <button\n                type=\"button\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  const currentDirection = sortDirection || 'asc';\n                  const newDirection = currentDirection === 'asc' ? 'desc' : 'asc';\n                  onSortDirectionChange(newDirection);\n                }}\n                className=\"p-1.5 text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-500 rounded-md transition-colors border border-gray-300 dark:border-gray-600 hover:border-blue-500 dark:hover:border-blue-400\"\n              >\n                {(sortDirection || 'asc') === 'asc' ? (\n                  <ArrowUpIcon className=\"h-4 w-4\" />\n                ) : (\n                  <ArrowDownIcon className=\"h-4 w-4\" />\n                )}\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {(sortDirection || 'asc') === 'asc' ? t('filter.row.sortAscending') : t('filter.row.sortDescending')}\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n      \n      {/* Aktions-Buttons - feste Breite mit Platzhalter */}\n      <div className=\"w-[60px] flex-shrink-0 flex gap-1 justify-end\">\n        {/* Löschen-Button */}\n        <div className=\"relative group\">\n          <button\n            type=\"button\"\n            onClick={onDelete}\n            className=\"p-1 text-gray-500 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-500 rounded-md transition-colors disabled:opacity-30 disabled:cursor-not-allowed\"\n            disabled={isFirst && !isLast}\n          >\n            <TrashIcon className=\"h-4 w-4\" />\n          </button>\n          <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n            {t('filter.row.removeCondition')}\n          </div>\n        </div>\n        \n        {/* Hinzufügen-Button oder Platzhalter */}\n        {isLast ? (\n          <div className=\"relative group\">\n            <button\n              type=\"button\"\n              onClick={onAdd}\n              className=\"p-1 text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-500 rounded-md transition-colors\"\n            >\n              <PlusCircleIcon className=\"h-4 w-4\" />\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('filter.row.addCondition')}\n            </div>\n          </div>\n        ) : (\n          <div className=\"w-[28px] flex-shrink-0\" /> // Platzhalter für vertikale Bündigkeit\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default FilterRow; ","import React, { useState, useRef, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PlusIcon } from '@heroicons/react/24/outline';\n\ninterface FilterLogicalOperatorProps {\n  operator: 'AND' | 'OR';\n  onChange: (operator: 'AND' | 'OR') => void;\n}\n\nconst FilterLogicalOperator: React.FC<FilterLogicalOperatorProps> = ({ operator, onChange }) => {\n  const { t } = useTranslation();\n  const [isOpen, setIsOpen] = useState(false);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [isOpen]);\n\n  const handleSelect = (value: 'AND' | 'OR') => {\n    onChange(value);\n    setIsOpen(false);\n  };\n\n  return (\n    <div className=\"flex items-center justify-start my-4 relative pl-[180px]\" ref={dropdownRef}>\n      <button\n        type=\"button\"\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"px-0.5 py-0.5 border border-gray-300 dark:border-gray-600 rounded-md text-xs font-medium bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-center flex items-center justify-center gap-1\"\n        style={{ width: '42px', minWidth: '42px', maxWidth: '42px', overflow: 'hidden' }}\n      >\n        {operator === 'AND' ? (\n          <>\n            <PlusIcon className=\"h-3 w-3 flex-shrink-0\" />\n            <span className=\"truncate\">{t('filter.logicalOperators.and')}</span>\n          </>\n        ) : (\n          <>\n            <span className=\"text-xs\">∨</span>\n            <span className=\"truncate\">{t('filter.logicalOperators.or')}</span>\n          </>\n        )}\n      </button>\n      \n      {isOpen && (\n        <div className=\"absolute top-full left-0 mt-1 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-50 min-w-[42px]\">\n          <button\n            type=\"button\"\n            onClick={() => handleSelect('AND')}\n            className={`w-full px-2 py-1 text-xs text-left hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-1.5 ${\n              operator === 'AND' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'text-gray-700 dark:text-gray-300'\n            }`}\n          >\n            <PlusIcon className=\"h-3 w-3 flex-shrink-0\" />\n            <span>{t('filter.logicalOperators.and')}</span>\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => handleSelect('OR')}\n            className={`w-full px-2 py-1 text-xs text-left hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-1.5 ${\n              operator === 'OR' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'text-gray-700 dark:text-gray-300'\n            }`}\n          >\n            <span className=\"text-xs\">∨</span>\n            <span>{t('filter.logicalOperators.or')}</span>\n          </button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default FilterLogicalOperator; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { CheckIcon, XMarkIcon, ArrowPathIcon, BookmarkIcon } from '@heroicons/react/24/outline';\nimport FilterRow, { FilterCondition } from './FilterRow.tsx';\nimport FilterLogicalOperator from './FilterLogicalOperator.tsx';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface TableColumn {\n  id: string;\n  label: string;\n}\n\ninterface SortDirection {\n  column: string;\n  direction: 'asc' | 'desc';\n  priority: number;\n  conditionIndex: number; // Index der Filterzeile, zu der diese Sortierrichtung gehört\n}\n\ninterface FilterPaneProps {\n  columns: TableColumn[];\n  onApply: (conditions: FilterCondition[], logicalOperators: ('AND' | 'OR')[]) => void;\n  onReset: () => void;\n  savedConditions?: FilterCondition[];\n  savedOperators?: ('AND' | 'OR')[];\n  savedSortDirections?: SortDirection[];\n  onSortDirectionsChange?: (sortDirections: SortDirection[]) => void;\n  tableId: string; // Tabellen-ID für die gespeicherten Filter\n}\n\nconst FilterPane: React.FC<FilterPaneProps> = ({ \n  columns,\n  onApply,\n  onReset,\n  savedConditions,\n  savedOperators,\n  savedSortDirections,\n  onSortDirectionsChange,\n  tableId\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  // Initialisiere mit einem leeren Filter, wenn keine gespeicherten Filter vorhanden sind\n  const [conditions, setConditions] = useState<FilterCondition[]>(\n    savedConditions && savedConditions.length > 0 \n      ? savedConditions \n      : [{ column: '', operator: 'equals', value: null }]\n  );\n  \n  // Initialisiere mit AND als Standard-Operator\n  const [logicalOperators, setLogicalOperators] = useState<('AND' | 'OR')[]>(\n    savedOperators && savedOperators.length > 0\n      ? savedOperators\n      : []\n  );\n  \n  // Initialisiere Sortierrichtungen (Array-basiert mit Priorität)\n  // WICHTIG: Sicherstellen, dass sortDirections immer ein Array ist\n  const [sortDirections, setSortDirections] = useState<SortDirection[]>(() => {\n    if (!savedSortDirections) return [];\n    if (Array.isArray(savedSortDirections)) return savedSortDirections;\n    // Fallback: Wenn es kein Array ist, leeres Array zurückgeben\n    console.warn('sortDirections ist kein Array:', savedSortDirections);\n    return [];\n  });\n\n  // Zustand für das Speichern von Filtern\n  const [showSaveInput, setShowSaveInput] = useState(false);\n  const [filterName, setFilterName] = useState('');\n  \n  // Lade bestehende Filter, um Konflikte mit Standardfiltern zu vermeiden\n  const [existingFilters, setExistingFilters] = useState<{ id: number, name: string }[]>([]);\n  \n  useEffect(() => {\n    const fetchExistingFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          return;\n        }\n        \n        const response = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(tableId)\n        );\n        \n        setExistingFilters(response.data.map((filter: any) => ({ id: filter.id, name: filter.name })));\n      } catch (err) {\n        console.error(t('filter.loadError'), err);\n      }\n    };\n    \n    fetchExistingFilters();\n  }, [tableId]);\n  \n  // Initialisiere Bedingungen und Operatoren nur wenn sich die Props von außen ändern\n  // Verwende useRef, um die vorherigen Werte zu speichern und nur bei echten Änderungen zu aktualisieren\n  const prevSavedConditionsRef = useRef<FilterCondition[] | undefined>(savedConditions);\n  const prevSavedOperatorsRef = useRef<('AND' | 'OR')[] | undefined>(savedOperators);\n  const prevSavedSortDirectionsRef = useRef<SortDirection[] | undefined>(savedSortDirections);\n  \n  useEffect(() => {\n    // Prüfe, ob sich die Props wirklich geändert haben (nicht durch lokale State-Änderungen)\n    const conditionsChanged = JSON.stringify(prevSavedConditionsRef.current) !== JSON.stringify(savedConditions);\n    const operatorsChanged = JSON.stringify(prevSavedOperatorsRef.current) !== JSON.stringify(savedOperators);\n    const sortDirectionsChanged = JSON.stringify(prevSavedSortDirectionsRef.current) !== JSON.stringify(savedSortDirections);\n    \n    if (conditionsChanged && savedConditions) {\n      if (savedConditions.length > 0) {\n        setConditions(savedConditions);\n      } else if (savedConditions.length === 0) {\n        // Reset: Setze auf Standard\n        setConditions([{ column: '', operator: 'equals', value: null }]);\n      }\n      prevSavedConditionsRef.current = savedConditions;\n    }\n    \n    if (operatorsChanged && savedOperators !== undefined) {\n      setLogicalOperators(savedOperators);\n      prevSavedOperatorsRef.current = savedOperators;\n    }\n    \n    if (sortDirectionsChanged && savedSortDirections !== undefined) {\n      // Sicherstellen, dass savedSortDirections ein Array ist\n      const validSortDirections = Array.isArray(savedSortDirections) \n        ? savedSortDirections \n        : [];\n      setSortDirections(validSortDirections);\n      prevSavedSortDirectionsRef.current = validSortDirections;\n    }\n  }, [savedConditions, savedOperators, savedSortDirections]);\n  \n  // Hilfsfunktion: Prioritäten neu nummerieren (1, 2, 3, ...)\n  const renumberPriorities = (sortDirs: SortDirection[]): SortDirection[] => {\n    return sortDirs\n      .sort((a, b) => a.priority - b.priority)\n      .map((sd, index) => ({ ...sd, priority: index + 1 }));\n  };\n  \n  // Hilfsfunktion: Sortierrichtung für eine Zeile finden\n  const getSortDirectionForIndex = (index: number): SortDirection | undefined => {\n    // Sicherstellen, dass sortDirections ein Array ist\n    if (!Array.isArray(sortDirections)) {\n      console.warn('sortDirections ist kein Array in getSortDirectionForIndex:', sortDirections);\n      return undefined;\n    }\n    return sortDirections.find(sd => sd.conditionIndex === index);\n  };\n  \n  const handleConditionChange = (index: number, newCondition: FilterCondition) => {\n    const newConditions = [...conditions];\n    const oldCondition = newConditions[index];\n    newConditions[index] = newCondition;\n    setConditions(newConditions);\n    \n    // Wenn sich die Spalte geändert hat, aktualisiere Sortierrichtungen\n    if (oldCondition.column !== newCondition.column) {\n      // Sicherstellen, dass sortDirections ein Array ist\n      const safeSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n      let newSortDirections = [...safeSortDirections];\n      \n      // Entferne Sortierrichtung für diese Zeile (wenn vorhanden)\n      if (oldCondition.column) {\n        const oldSortDirIndex = newSortDirections.findIndex(sd => sd.conditionIndex === index);\n        if (oldSortDirIndex >= 0) {\n          newSortDirections.splice(oldSortDirIndex, 1);\n        }\n      }\n      \n      // Setze Standard-Sortierrichtung für neue Spalte (nur wenn Spalte ausgewählt)\n      if (newCondition.column && newCondition.column !== '') {\n        // Prüfe, ob bereits eine Sortierrichtung für diese Zeile existiert\n        const existingSortDir = newSortDirections.find(sd => sd.conditionIndex === index);\n        if (!existingSortDir) {\n          // Finde die höchste Priorität\n          const maxPriority = newSortDirections.length > 0 \n            ? Math.max(...newSortDirections.map(sd => sd.priority))\n            : 0;\n          \n          // Füge neue Sortierrichtung hinzu (mit conditionIndex)\n          newSortDirections.push({\n            column: newCondition.column,\n            direction: 'asc',\n            priority: maxPriority + 1,\n            conditionIndex: index\n          });\n        }\n      }\n      \n      // Prioritäten neu nummerieren\n      newSortDirections = renumberPriorities(newSortDirections);\n      \n      setSortDirections(newSortDirections);\n      if (onSortDirectionsChange) {\n        onSortDirectionsChange(newSortDirections);\n      }\n    }\n  };\n  \n  const handleOperatorChange = (index: number, newOperator: 'AND' | 'OR') => {\n    const newOperators = [...logicalOperators];\n    newOperators[index] = newOperator;\n    setLogicalOperators(newOperators);\n  };\n  \n  const handleAddCondition = () => {\n    setConditions([...conditions, { column: '', operator: 'equals', value: null }]);\n    \n    // Füge standardmäßig einen AND-Operator hinzu\n    if (conditions.length > 0) {\n      setLogicalOperators([...logicalOperators, 'AND']);\n    }\n  };\n  \n  const handleDeleteCondition = (index: number) => {\n    // Entferne die Bedingung\n    const newConditions = [...conditions];\n    newConditions.splice(index, 1);\n    setConditions(newConditions);\n    \n    // Entferne auch den entsprechenden Operator, falls vorhanden\n    if (index > 0) {\n      const newOperators = [...logicalOperators];\n      newOperators.splice(index - 1, 1);\n      setLogicalOperators(newOperators);\n    }\n    \n    // Entferne Sortierrichtung für diese Zeile und aktualisiere Indizes\n    // Sicherstellen, dass sortDirections ein Array ist\n    const safeSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n    let newSortDirections = safeSortDirections\n      .filter(sd => sd.conditionIndex !== index) // Entferne Sortierrichtung für gelöschte Zeile\n      .map(sd => {\n        // Aktualisiere conditionIndex für alle Zeilen nach der gelöschten\n        if (sd.conditionIndex > index) {\n          return { ...sd, conditionIndex: sd.conditionIndex - 1 };\n        }\n        return sd;\n      });\n    \n    // Prioritäten neu nummerieren\n    newSortDirections = renumberPriorities(newSortDirections);\n    \n    setSortDirections(newSortDirections);\n    if (onSortDirectionsChange) {\n      onSortDirectionsChange(newSortDirections);\n    }\n  };\n  \n  const handleSortDirectionChange = (index: number, direction: 'asc' | 'desc') => {\n    const condition = conditions[index];\n    if (condition && condition.column) {\n      // Sicherstellen, dass sortDirections ein Array ist\n      const safeSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n      let newSortDirections = [...safeSortDirections];\n      const existingIndex = newSortDirections.findIndex(sd => sd.conditionIndex === index);\n      \n      if (existingIndex >= 0) {\n        // Aktualisiere bestehende Sortierrichtung\n        newSortDirections[existingIndex] = {\n          ...newSortDirections[existingIndex],\n          direction\n        };\n      } else {\n        // Erstelle neue Sortierrichtung\n        const maxPriority = newSortDirections.length > 0 \n          ? Math.max(...newSortDirections.map(sd => sd.priority))\n          : 0;\n        newSortDirections.push({\n          column: condition.column,\n          direction,\n          priority: maxPriority + 1,\n          conditionIndex: index\n        });\n        // Prioritäten neu nummerieren\n        newSortDirections = renumberPriorities(newSortDirections);\n      }\n      \n      setSortDirections(newSortDirections);\n      if (onSortDirectionsChange) {\n        onSortDirectionsChange(newSortDirections);\n      }\n    }\n  };\n  \n  const handlePriorityChange = (index: number, newPriority: number) => {\n    const condition = conditions[index];\n    if (condition && condition.column) {\n      // Sicherstellen, dass sortDirections ein Array ist\n      const safeSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n      let newSortDirections = [...safeSortDirections];\n      const existingIndex = newSortDirections.findIndex(sd => sd.conditionIndex === index);\n      \n      if (existingIndex >= 0) {\n        const currentPriority = newSortDirections[existingIndex].priority;\n        \n        // Tausche Prioritäten mit der anderen Zeile\n        const otherIndex = newSortDirections.findIndex(sd => sd.priority === newPriority);\n        if (otherIndex >= 0) {\n          newSortDirections[otherIndex].priority = currentPriority;\n        }\n        \n        newSortDirections[existingIndex].priority = newPriority;\n        \n        // Prioritäten neu nummerieren\n        newSortDirections = renumberPriorities(newSortDirections);\n        \n        setSortDirections(newSortDirections);\n        if (onSortDirectionsChange) {\n          onSortDirectionsChange(newSortDirections);\n        }\n      }\n    }\n  };\n  \n  const handleApplyFilters = () => {\n    // Nur gültige Bedingungen senden (bei denen mindestens eine Spalte ausgewählt ist)\n    const validConditions = conditions.filter(c => c.column !== '');\n    onApply(validConditions, logicalOperators);\n  };\n  \n  const handleResetFilters = () => {\n    setConditions([{ column: '', operator: 'equals', value: null }]);\n    setLogicalOperators([]);\n    setSortDirections([]);\n    if (onSortDirectionsChange) {\n      onSortDirectionsChange([]);\n    }\n    onReset();\n  };\n\n  // Funktion zum Speichern des aktuellen Filters\n  const handleSaveFilter = async () => {\n    if (!filterName.trim()) {\n      showMessage(t('filter.noName'), 'error');\n      return;\n    }\n\n    // Prüfe, ob der Name ein reservierter Standardfilter-Name ist\n    if (filterName === 'Archiv' || filterName === 'Aktuell') {\n      showMessage(t('filter.reservedNames'), 'error');\n      return;\n    }\n\n    // Prüfe, ob ein Standardfilter mit diesem Namen bereits existiert\n    const standardFilterExists = existingFilters.some(filter => \n      (filter.name === 'Archiv' || filter.name === 'Aktuell') && filter.name === filterName\n    );\n    \n    if (standardFilterExists) {\n      showMessage(t('filter.cannotOverwriteStandard'), 'error');\n      return;\n    }\n\n    // Nur gültige Bedingungen senden\n    const validConditions = conditions.filter(c => c.column !== '');\n    \n    if (validConditions.length === 0) {\n      showMessage(t('filter.noConditions'), 'error');\n      return;\n    }\n\n    try {\n      const token = localStorage.getItem('token');\n      \n      if (!token) {\n        showMessage(t('filter.notAuthenticated'), 'error');\n        return;\n      }\n      \n      const response = await axiosInstance.post(\n        API_ENDPOINTS.SAVED_FILTERS.BASE,\n        {\n          tableId,\n          name: filterName,\n          conditions: validConditions,\n          operators: logicalOperators,\n          sortDirections: sortDirections\n        }\n      );\n      \n      showMessage(t('filter.saveSuccess'), 'success');\n      setShowSaveInput(false);\n      setFilterName('');\n      \n      // Aktualisiere die Filter-Tags sofort, damit der neue Filter angezeigt wird\n      if ((window as any).refreshSavedFilters) {\n        (window as any).refreshSavedFilters();\n      }\n    } catch (err) {\n      console.error('Fehler beim Speichern des Filters:', err);\n      showMessage(t('filter.saveError'), 'error');\n    }\n  };\n  \n  return (\n    <div className=\"mt-4 p-4 bg-white dark:bg-gray-800 rounded-lg\">\n      <h3 className=\"text-base font-medium text-gray-700 dark:text-gray-200 mb-3\">{t('filter.title')}</h3>\n      \n      <div className=\"space-y-2\">\n        {conditions.map((condition, index) => (\n          <React.Fragment key={index}>\n            <FilterRow\n              condition={condition}\n              onChange={(newCondition) => handleConditionChange(index, newCondition)}\n              onDelete={() => handleDeleteCondition(index)}\n              onAdd={handleAddCondition}\n              columns={columns}\n              isFirst={index === 0}\n              isLast={index === conditions.length - 1}\n              sortDirection={(() => {\n                const sortDir = getSortDirectionForIndex(index);\n                return sortDir ? sortDir.direction : undefined;\n              })()}\n              sortPriority={(() => {\n                const sortDir = getSortDirectionForIndex(index);\n                return sortDir ? sortDir.priority : undefined;\n              })()}\n              onSortDirectionChange={condition.column && condition.column !== '' ? (direction) => {\n                handleSortDirectionChange(index, direction);\n              } : undefined}\n              onPriorityChange={(() => {\n                const sortDir = getSortDirectionForIndex(index);\n                if (sortDir) {\n                  return (newPriority: number) => handlePriorityChange(index, newPriority);\n                }\n                return undefined;\n              })()}\n              canMoveUp={(() => {\n                const sortDir = getSortDirectionForIndex(index);\n                if (sortDir && sortDir.priority > 1) {\n                  return true;\n                }\n                return false;\n              })()}\n              canMoveDown={(() => {\n                const sortDir = getSortDirectionForIndex(index);\n                if (sortDir) {\n                  const safeSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n                  const maxPriority = safeSortDirections.length > 0 \n                    ? Math.max(...safeSortDirections.map(sd => sd.priority))\n                    : 0;\n                  return sortDir.priority < maxPriority;\n                }\n                return false;\n              })()}\n            />\n            \n            {/* Operator zwischen Bedingungen einfügen (aber nicht nach der letzten) */}\n            {index < conditions.length - 1 && (\n              <FilterLogicalOperator\n                operator={logicalOperators[index] || 'AND'}\n                onChange={(newOperator) => handleOperatorChange(index, newOperator)}\n              />\n            )}\n          </React.Fragment>\n        ))}\n      </div>\n      \n      {/* Speicher-Interface */}\n      {showSaveInput ? (\n        <div className=\"mt-4 flex gap-2 items-center\">\n          <input\n            type=\"text\"\n            className=\"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white flex-grow\"\n            placeholder={t('filter.filterName')}\n            value={filterName}\n            onChange={(e) => setFilterName(e.target.value)}\n          />\n          <button\n            onClick={handleSaveFilter}\n            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n            title={t('filter.saveFilter')}\n          >\n            <BookmarkIcon className=\"h-5 w-5\" />\n          </button>\n          <button\n            onClick={() => setShowSaveInput(false)}\n            className=\"p-2 bg-white text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700 transition-colors\"\n            title={t('filter.cancel')}\n          >\n            <XMarkIcon className=\"h-5 w-5\" />\n          </button>\n        </div>\n      ) : (\n        <div className=\"flex justify-end gap-2 mt-4\">\n          <button\n            onClick={handleResetFilters}\n            className=\"p-2 bg-white text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700 transition-colors\"\n            title={t('filter.reset')}\n          >\n            <ArrowPathIcon className=\"h-5 w-5\" />\n          </button>\n          <button\n            onClick={() => setShowSaveInput(true)}\n            className=\"p-2 bg-white text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700 transition-colors\"\n            title={t('filter.save')}\n          >\n            <BookmarkIcon className=\"h-5 w-5\" />\n          </button>\n          <button\n            onClick={handleApplyFilters}\n            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n            title={t('filter.apply')}\n          >\n            <CheckIcon className=\"h-5 w-5\" />\n          </button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default FilterPane; ","import React, { useState, useEffect, useMemo, useRef, useLayoutEffect, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { XMarkIcon, ChevronDownIcon, PencilIcon, CheckIcon, TrashIcon } from '@heroicons/react/24/outline';\nimport { FilterCondition } from './FilterRow.tsx';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface SortDirection {\n  column: string;\n  direction: 'asc' | 'desc';\n  priority: number;\n  conditionIndex: number;\n}\n\ninterface SavedFilter {\n  id: number;\n  name: string;\n  tableId: string;\n  conditions: FilterCondition[];\n  operators: ('AND' | 'OR')[];\n  sortDirections?: SortDirection[];\n  groupId?: number | null;\n  order?: number;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\ninterface FilterGroup {\n  id: number;\n  name: string;\n  tableId: string;\n  order: number;\n  filters: SavedFilter[];\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface SavedFilterTagsProps {\n  tableId: string;\n  onSelectFilter: (conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections?: SortDirection[]) => void;\n  onReset: () => void;\n  activeFilterName?: string;\n  selectedFilterId?: number | null;\n  onFilterChange?: (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections?: SortDirection[]) => void;\n  defaultFilterName?: string;\n}\n\nconst SavedFilterTags: React.FC<SavedFilterTagsProps> = ({ \n  tableId, \n  onSelectFilter, \n  onReset,\n  activeFilterName,\n  selectedFilterId,\n  onFilterChange,\n  defaultFilterName = 'Heute'\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  \n  // Übersetze Filter-Namen beim Anzeigen\n  const translateFilterName = (name: string): string => {\n    // Standard-Filter übersetzen (auch wenn als Übersetzungsschlüssel gespeichert)\n    if (name === 'Archiv' || name === 'tasks.filters.archive' || name === 'requests.filters.archiv') {\n      return tableId === 'worktracker-todos' ? t('tasks.filters.archive') : t('requests.filters.archiv');\n    }\n    if (name === 'Aktuell' || name === 'tasks.filters.current' || name === 'requests.filters.aktuell') {\n      return tableId === 'worktracker-todos' ? t('tasks.filters.current') : t('requests.filters.aktuell');\n    }\n    if (name === 'Heute' || name === 'Hoy') return t('common.today', 'Heute');\n    if (name === 'Woche') return t('common.week', 'Woche');\n    if (name === 'Aktive') return t('common.active', 'Aktive');\n    if (name === 'Alle') return t('common.all', 'Alle');\n    // Für alle anderen Namen, gib sie unverändert zurück (z.B. Client-Namen)\n    return name;\n  };\n  \n  // Übersetze Filtergruppen-Namen beim Anzeigen\n  const translateGroupName = (groupName: string): string => {\n    // Standard-Filtergruppen übersetzen\n    if (groupName === 'Roles' || groupName === 'Rollen') {\n      return t('filter.row.groups.roles', 'Rollen');\n    }\n    if (groupName === 'Users' || groupName === 'Benutzer' || groupName === 'Usuarios') {\n      return t('filter.row.groups.users', 'Benutzer');\n    }\n    // Für alle anderen Gruppennamen, gib sie unverändert zurück\n    return groupName;\n  };\n  \n  const [savedFilters, setSavedFilters] = useState<SavedFilter[]>([]);\n  const [filterGroups, setFilterGroups] = useState<FilterGroup[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [recentClientNames, setRecentClientNames] = useState<string[]>([]);\n  \n  // ✅ KRITISCH: Ref verhindert mehrfache Anwendung des Default-Filters (Endlosschleife)\n  const defaultFilterAppliedRef = useRef<boolean>(false);\n  \n  // Responsive Tag-Display States (optimiert)\n  const containerRef = useRef<HTMLDivElement>(null);\n  const tagRefs = useRef<Map<number, HTMLDivElement>>(new Map());\n  const [visibleTagCount, setVisibleTagCount] = useState(4); // Fallback für SSR\n  const [containerWidth, setContainerWidth] = useState(0);\n  const [measuredTagWidths, setMeasuredTagWidths] = useState<Map<number, number>>(new Map());\n  const [isMeasuring, setIsMeasuring] = useState(true); // Initial alle Tags rendern für Messung\n  const resizeTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  \n  // Dropdown State für überlaufende Tags\n  const [isDropdownOpen, setIsDropdownOpen] = useState(false);\n  \n  // Drag & Drop States\n  const [draggedFilterId, setDraggedFilterId] = useState<number | null>(null);\n  const [dragOverFilterId, setDragOverFilterId] = useState<number | null>(null);\n  const [dragOverGroupId, setDragOverGroupId] = useState<number | 'new-group' | null>(null);\n  \n  // Gruppen-Dropdown States (pro Gruppe)\n  const [openGroupDropdowns, setOpenGroupDropdowns] = useState<Set<number>>(new Set());\n  \n  // Gruppen-Umbenennung States\n  const [editingGroupId, setEditingGroupId] = useState<number | null>(null);\n  const [editingGroupName, setEditingGroupName] = useState<string>('');\n\n  // Refresh Filter-Liste und Gruppen (für external updates) - MUSS vor cleanupExcessiveClientFilters sein!\n  const refreshFilters = useCallback(async () => {\n    try {\n      const [filtersResponse, groupsResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(tableId)),\n        axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.GROUPS.BY_TABLE(tableId))\n      ]);\n      \n      const filters = Array.isArray(filtersResponse.data) ? filtersResponse.data.filter(f => f != null) : [];\n      const groups = Array.isArray(groupsResponse.data) ? groupsResponse.data.filter(g => g != null) : [];\n      \n      setSavedFilters(filters);\n      setFilterGroups(groups);\n    } catch (error) {\n      console.error('Fehler beim Neuladen der Filter:', error);\n    }\n  }, [tableId]);\n\n  // Bereinigungsfunktion für überschüssige Client-Filter\n  const cleanupExcessiveClientFilters = useCallback(async (currentClientNames: string[]) => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(tableId));\n      const existingFilters = response.data;\n      \n      // Finde alle Client-Filter (Filter deren Name in recentClientNames ist)\n      const clientFilters = existingFilters.filter((filter: SavedFilter) => \n        currentClientNames.includes(filter.name)\n      );\n      \n      // Wenn mehr als 5 Client-Filter vorhanden sind, lösche die ältesten\n      if (clientFilters.length > 5) {\n        const filtersToDelete = clientFilters\n          .sort((a: any, b: any) => new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime())\n          .slice(0, clientFilters.length - 5);\n        \n        for (const filterToDelete of filtersToDelete) {\n          await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(filterToDelete.id));\n        }\n        \n        // Refresh die Filter-Liste\n        await refreshFilters();\n      }\n    } catch (error) {\n      console.error('Fehler beim Bereinigen der Client-Filter:', error);\n    }\n  }, [tableId, refreshFilters]);\n\n  // Recent Clients laden (mit useCallback für stabilen Event-Listener)\n  const loadRecentClients = useCallback(async () => {\n    if (tableId === 'consultations-table') {\n      try {\n        console.log('🔄 SavedFilterTags: Loading recent clients...');\n        const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.RECENT);\n        // Verwende die Reihenfolge der API-Antwort direkt (Backend sortiert bereits richtig)\n        const clientNames = response.data.map((client: any) => client.name);\n        console.log('📋 SavedFilterTags: Recent client names:', clientNames);\n        setRecentClientNames(clientNames);\n        \n        // Auto-Bereinigung: Lösche überschüssige Recent Client Filter (LRU-basiert)\n        await cleanupExcessiveClientFilters(clientNames);\n      } catch (error) {\n        console.error('❌ SavedFilterTags: Error loading recent clients:', error);\n        // Stille Behandlung - normale Situation wenn noch keine Clients beraten wurden\n      }\n    }\n  }, [tableId, cleanupExcessiveClientFilters]);\n\n  // Event-Listener für Consultation-Änderungen (z.B. neue Beratung gestartet)\n  useEffect(() => {\n    const handleConsultationChanged = () => {\n      console.log('🔔 SavedFilterTags: Received consultationChanged event');\n      loadRecentClients();\n    };\n\n    window.addEventListener('consultationChanged', handleConsultationChanged);\n    \n    return () => {\n      window.removeEventListener('consultationChanged', handleConsultationChanged);\n    };\n  }, [loadRecentClients]);\n\n  // Lade Recent Clients für Consultation-Tabelle beim ersten Render\n  useEffect(() => {\n    loadRecentClients();\n  }, [loadRecentClients]);\n\n  // Lade gespeicherte Filter und Gruppen beim ersten Render\n  // ✅ KRITISCH: Ref verhindert mehrfache Anwendung des Default-Filters (Endlosschleife)\n  useEffect(() => {\n    // ✅ Reset Ref wenn tableId sich ändert\n    defaultFilterAppliedRef.current = false;\n    \n    const fetchData = async () => {\n      try {\n        setLoading(true);\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          setError('Nicht authentifiziert');\n          return;\n        }\n        \n        // Lade Filter und Gruppen parallel\n        const [filtersResponse, groupsResponse] = await Promise.all([\n          axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(tableId)),\n          axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.GROUPS.BY_TABLE(tableId))\n        ]);\n        \n        // Sicherstellen, dass response.data ein Array ist\n        const filters = Array.isArray(filtersResponse.data) ? filtersResponse.data.filter(f => f != null) : [];\n        const groups = Array.isArray(groupsResponse.data) ? groupsResponse.data.filter(g => g != null) : [];\n        \n        setSavedFilters(filters);\n        setFilterGroups(groups);\n\n        // ✅ KRITISCH: Default-Filter nur EINMAL anwenden (verhindert Endlosschleife)\n        // ✅ ZUSÄTZLICH: Prüfe selectedFilterId, um zu verhindern, dass Filter erneut angewendet wird\n        if (defaultFilterName && !activeFilterName && !selectedFilterId && !defaultFilterAppliedRef.current) {\n          // ✅ Suche nach Filter mit exaktem Namen oder alternativen Namen (für Migration)\n          const defaultFilter = filters.find((filter: SavedFilter) => {\n            if (!filter || !filter.name) return false;\n            // Exakte Übereinstimmung\n            if (filter.name === defaultFilterName) return true;\n            // Alternative Namen für \"Aktuell\"\n            if (defaultFilterName === 'Aktuell' && (filter.name === 'tasks.filters.current' || filter.name === 'requests.filters.aktuell')) return true;\n            // Alternative Namen für \"Hoy\"\n            if (defaultFilterName === 'Hoy' && (filter.name === 'Heute' || filter.name === 'common.today')) return true;\n            return false;\n          });\n          \n          if (defaultFilter) {\n            // ✅ Markiere als angewendet, BEVOR onFilterChange aufgerufen wird\n            defaultFilterAppliedRef.current = true;\n            \n            // ✅ FIX: Einheitliches Format - immer Array (nicht undefined)\n            const validSortDirections = Array.isArray(defaultFilter.sortDirections) ? defaultFilter.sortDirections : [];\n            if (onFilterChange) {\n              // Controlled Mode: Verwende onFilterChange\n              onFilterChange(defaultFilter.name, defaultFilter.id, defaultFilter.conditions, defaultFilter.operators, validSortDirections);\n            } else {\n              // Uncontrolled Mode: Verwende onSelectFilter\n              onSelectFilter(defaultFilter.conditions, defaultFilter.operators, validSortDirections);\n            }\n          } else if (defaultFilterName && process.env.NODE_ENV === 'development') {\n            // ✅ Debug: Log wenn Filter nicht gefunden wird\n            console.warn(`[SavedFilterTags] Default-Filter \"${defaultFilterName}\" nicht gefunden. Verfügbare Filter:`, filters.map(f => f?.name));\n          }\n          \n          // ✅ FIX: Wenn kein Default-Filter gefunden wurde, lade Daten ohne Filter (Fallback)\n          // ✅ Dies verhindert, dass keine Daten angezeigt werden, wenn Default-Filter fehlt\n          if (!defaultFilter && defaultFilterName && onFilterChange) {\n            // Lade Daten ohne Filter (leere Bedingungen)\n            onFilterChange('', null, [], [], undefined);\n          }\n        }\n      } catch (err) {\n        console.error('Fehler beim Laden der gespeicherten Filter:', err);\n        setError('Fehler beim Laden der gespeicherten Filter');\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    fetchData();\n  }, [tableId]); // ✅ NUR tableId - onFilterChange/onSelectFilter können sich ändern und verursachen Endlosschleife\n\n  // ✅ MEMORY: Cleanup - Filter Arrays beim Unmount löschen\n  useEffect(() => {\n    return () => {\n      setSavedFilters([]);\n      setFilterGroups([]);\n    };\n  }, []); // Nur beim Unmount ausführen\n\n  // Expose refresh function für Parent-Komponenten\n  useEffect(() => {\n    // Erstelle eine globale Referenz für externe Updates\n    (window as any).refreshSavedFilters = refreshFilters;\n    return () => {\n      delete (window as any).refreshSavedFilters;\n    };\n  }, [refreshFilters]);\n\n  // Dropdown schließen bei Klick außerhalb\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (isDropdownOpen && !(event.target as Element).closest('.relative')) {\n        setIsDropdownOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [isDropdownOpen]);\n  \n  // Wähle einen gespeicherten Filter aus\n  const handleSelectFilter = (filter: SavedFilter) => {\n    console.log('🔄 SavedFilterTags: handleSelectFilter called', {\n      filterName: filter.name,\n      filterId: filter.id,\n      conditionsCount: filter.conditions?.length || 0,\n      operatorsCount: filter.operators?.length || 0,\n      sortDirectionsCount: filter.sortDirections?.length || 0,\n      hasOnFilterChange: !!onFilterChange\n    });\n    \n    // ✅ FIX: Einheitliches Format - immer Array (nicht undefined)\n    const validSortDirections = Array.isArray(filter.sortDirections) ? filter.sortDirections : [];\n    \n    if (onFilterChange) {\n      // Controlled component\n      console.log('📋 SavedFilterTags: Calling onFilterChange (controlled)');\n      onFilterChange(filter.name, filter.id, filter.conditions, filter.operators, validSortDirections);\n    } else {\n      // Backward compatibility - uncontrolled component\n      console.log('📋 SavedFilterTags: Calling onSelectFilter (uncontrolled)');\n      onSelectFilter(filter.conditions, filter.operators, validSortDirections);\n    }\n  };\n  \n  // Lösche einen gespeicherten Filter\n  const handleDeleteFilter = async (e: React.MouseEvent, filterId: number) => {\n    e.stopPropagation();\n    \n    const filterToDelete = savedFilters.find(filter => filter.id === filterId);\n    if (filterToDelete && isStandardFilter(filterToDelete.name)) {\n      showMessage(t('filter.cannotDeleteStandard', { defaultValue: 'Standard-Filter können nicht gelöscht werden' }), 'error');\n      return;\n    }\n    \n    try {\n      const token = localStorage.getItem('token');\n      \n      if (!token) {\n        setError('Nicht authentifiziert');\n        return;\n      }\n      \n      await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(filterId));\n      \n      setSavedFilters(savedFilters.filter(filter => filter.id !== filterId));\n      \n      // Wenn der aktuell ausgewählte Filter gelöscht wurde\n      if (selectedFilterId === filterId || (!onFilterChange && filterId)) {\n        if (onFilterChange) {\n          // Controlled: Parent entscheidet was passiert\n          onFilterChange('', null, [], [], []);\n        } else {\n          // Uncontrolled: Reset\n          onReset();\n        }\n      }\n      \n      showMessage(t('filter.deleteSuccess', { defaultValue: 'Filter erfolgreich gelöscht' }), 'success');\n    } catch (err) {\n      console.error('Fehler beim Löschen des Filters:', err);\n      showMessage(t('filter.deleteError', { defaultValue: 'Fehler beim Löschen des Filters' }), 'error');\n    }\n  };\n  \n  // Prüfen, ob ein Filter ein Standard-Filter ist\n  const isStandardFilter = (filterName: string) => {\n    // Erkenne auch Übersetzungsschlüssel\n    const standardFilterNames = [\n      'Archiv', 'Aktuell', 'Aktive', 'Alle', 'Heute', 'Woche', 'Hoy',\n      'tasks.filters.archive', 'tasks.filters.current',\n      'requests.filters.archiv', 'requests.filters.aktuell'\n    ];\n    \n    if (standardFilterNames.includes(filterName)) {\n      return true;\n    }\n    \n    if (tableId === 'consultations-table') {\n      if (filterName === 'Archiv' || filterName === 'Heute' || filterName === 'Woche') {\n        return true;\n      }\n      if (recentClientNames.includes(filterName)) {\n        return true;\n      }\n    }\n    \n    return false;\n  };\n\n  // Sortiere Filter nach gewünschter Reihenfolge (nur nicht-gruppierte Filter)\n  const sortedFilters = useMemo(() => {\n    // Filtere nur nicht-gruppierte Filter heraus\n    const ungroupedFilters = savedFilters.filter(f => f != null && !f.groupId);\n    \n    // Sortierung für Consultations\n    if (tableId === 'consultations-table') {\n      console.log('🔧 SavedFilterTags: Sorting filters...');\n      console.log('📋 SavedFilterTags: recentClientNames:', recentClientNames);\n      console.log('🗂️ SavedFilterTags: savedFilters:', ungroupedFilters.map(f => f.name));\n\n      const heute = ungroupedFilters.find(f => f != null && f.name === 'Heute');\n      const woche = ungroupedFilters.find(f => f != null && f.name === 'Woche');\n      const archiv = ungroupedFilters.find(f => f != null && f.name === 'Archiv');\n      \n      // Recent Client Filter in der exakten Reihenfolge der Recent Clients API sortieren\n      const sortedRecentClientFilters = recentClientNames\n        .map(clientName => ungroupedFilters.find(f => f != null && f.name === clientName))\n        .filter(filter => filter != null) as SavedFilter[];\n      \n      console.log('✅ SavedFilterTags: sortedRecentClientFilters:', sortedRecentClientFilters.map(f => f.name));\n      \n      const customFilters = ungroupedFilters.filter(f => \n        f != null && \n        !['Heute', 'Woche', 'Archiv'].includes(f.name) && \n        !recentClientNames.includes(f.name)\n      );\n      \n      console.log('🔧 SavedFilterTags: customFilters:', customFilters.map(f => f.name));\n\n      const orderedFilters: SavedFilter[] = [];\n      \n      if (heute) orderedFilters.push(heute);\n      if (woche) orderedFilters.push(woche);\n      orderedFilters.push(...sortedRecentClientFilters);\n      orderedFilters.push(...customFilters);\n      if (archiv) orderedFilters.push(archiv);\n      \n      console.log('🎯 SavedFilterTags: Final filter order:', orderedFilters.map(f => f.name));\n      \n      return orderedFilters;\n    }\n\n    // Sortierung für Requests/Tasks - Aktuell zuerst, dann Archiv\n    if (tableId === 'requests-table' || tableId === 'worktracker-todos') {\n      const aktuell = ungroupedFilters.find(f => f != null && f.name === 'Aktuell');\n      const archiv = ungroupedFilters.find(f => f != null && f.name === 'Archiv');\n      \n      // Rest der Filter (außer Aktuell und Archiv)\n      const customFilters = ungroupedFilters.filter(f => \n        f != null && f.name !== 'Aktuell' && f.name !== 'Archiv'\n      );\n      \n      const orderedFilters: SavedFilter[] = [];\n      \n      // Aktuell immer zuerst\n      if (aktuell) orderedFilters.push(aktuell);\n      // Dann custom Filters\n      orderedFilters.push(...customFilters);\n      // Archiv immer zuletzt\n      if (archiv) orderedFilters.push(archiv);\n      \n      return orderedFilters;\n    }\n\n    // Für alle anderen Tabellen: Keine Sortierung\n    return ungroupedFilters;\n  }, [savedFilters, recentClientNames, tableId]);\n\n  // Optimistische Filter-Anzeige für bessere UX (MOVED BEFORE EARLY RETURNS)\n  const showOptimisticFilters = savedFilters.length === 0 && loading;\n  \n  const optimisticFilters = useMemo(() => {\n    if (!showOptimisticFilters) return [];\n    return Array(3).fill(null).map((_, i) => ({\n      id: `placeholder-${i}`,\n      name: i === 0 ? 'Heute' : i === 1 ? 'Woche' : '████████',\n      isPlaceholder: true,\n      tableId,\n      conditions: [],\n      operators: []\n    }));\n  }, [showOptimisticFilters, tableId]);\n\n  const displayFilters = showOptimisticFilters ? optimisticFilters : sortedFilters.filter(f => f != null);\n  // Beim Messen: Alle Tags rendern, sonst nur sichtbare\n  const currentVisibleCount = showOptimisticFilters \n    ? optimisticFilters.length \n    : (isMeasuring ? sortedFilters.length : visibleTagCount);\n\n  // Tag-Breiten-Berechnung: Verwende gemessene Breiten wenn verfügbar, sonst aggressive Schätzung\n  const averageTagWidth = useMemo(() => {\n    if (sortedFilters.length === 0) return 75;\n    \n    // Wenn wir gemessene Breiten haben, verwende diese\n    if (measuredTagWidths.size > 0) {\n      const widths = Array.from(measuredTagWidths.values());\n      return widths.reduce((sum, width) => sum + width, 0) / widths.length;\n    }\n    \n    // Fallback: Aggressivere Schätzung (4.5px pro Zeichen - optimistischer für große Bildschirme)\n    return sortedFilters\n      .filter(filter => filter != null)\n      .reduce((sum, filter) => {\n        // Aggressivere Schätzung: ~4.5px pro Zeichen + 24px Padding + optional Delete-Button\n        const deleteButtonWidth = !isStandardFilter(filter.name) ? 18 : 0;\n        return sum + (filter.name.length * 4.5 + 24 + deleteButtonWidth);\n      }, 0) / sortedFilters.filter(filter => filter != null).length;\n  }, [sortedFilters, measuredTagWidths]);\n\n  // Optimierte Sichtbarkeits-Berechnung mit useCallback\n  const calculateVisibleTags = useCallback(() => {\n    if (!containerRef.current || sortedFilters.length === 0) return;\n    // Nicht berechnen während Messung\n    if (isMeasuring) return;\n\n    const container = containerRef.current;\n    const currentWidth = container.clientWidth;\n\n    // Nur neu berechnen wenn sich die Breite signifikant geändert hat (>= 10px)\n    if (Math.abs(currentWidth - containerWidth) < 10 && containerWidth > 0) return;\n\n    setContainerWidth(currentWidth);\n\n    // Reduzierte, realistischere UI-Element-Breiten\n    const DROPDOWN_BUTTON_WIDTH = 60; // Reduziert von 70\n    const GAP_BETWEEN_TAGS = 6; // gap-1.5 = 6px\n    const BUFFER = 4; // Minimaler Puffer\n\n    const availableWidth = currentWidth - BUFFER;\n\n    // Verwende gemessene Breiten wenn verfügbar, sonst Durchschnitt\n    let totalWidth = 0;\n    let measuredCount = 0;\n\n    // Berechne Gesamtbreite der Tags mit gemessenen Breiten\n    sortedFilters.forEach((filter) => {\n      const measuredWidth = measuredTagWidths.get(filter.id);\n      if (measuredWidth) {\n        totalWidth += measuredWidth + GAP_BETWEEN_TAGS;\n        measuredCount++;\n      }\n    });\n\n    // Wenn wir gemessene Breiten für alle Tags haben, verwende diese\n    if (measuredCount === sortedFilters.length && totalWidth > 0) {\n      const totalWidthWithoutLastGap = totalWidth - GAP_BETWEEN_TAGS;\n\n      // Prüfe ob alle Tags ohne Dropdown passen\n      if (totalWidthWithoutLastGap <= availableWidth) {\n        setVisibleTagCount(sortedFilters.length);\n        return;\n      }\n\n      // Prüfe ob alle Tags mit Dropdown passen\n      const availableWithDropdown = availableWidth - DROPDOWN_BUTTON_WIDTH - GAP_BETWEEN_TAGS;\n      if (totalWidthWithoutLastGap <= availableWithDropdown) {\n        setVisibleTagCount(sortedFilters.length);\n        return;\n      }\n\n      // Berechne wie viele Tags mit Dropdown passen\n      let cumulativeWidth = 0;\n      let visibleCount = 0;\n      for (const filter of sortedFilters) {\n        const width = measuredTagWidths.get(filter.id) || averageTagWidth;\n        if (cumulativeWidth + width + GAP_BETWEEN_TAGS <= availableWithDropdown) {\n          cumulativeWidth += width + GAP_BETWEEN_TAGS;\n          visibleCount++;\n        } else {\n          break;\n        }\n      }\n      setVisibleTagCount(Math.max(1, visibleCount));\n      return;\n    }\n\n    // Fallback: Verwende Durchschnittsbreite\n    const maxPossibleTags = Math.max(1, Math.floor(availableWidth / (averageTagWidth + GAP_BETWEEN_TAGS)));\n\n    if (maxPossibleTags >= sortedFilters.length) {\n      // Alle Tags passen rein - zeige alle\n      setVisibleTagCount(sortedFilters.length);\n    } else {\n      // Prüfe ob alle Tags mit Dropdown passen würden\n      const availableWithDropdown = availableWidth - DROPDOWN_BUTTON_WIDTH - GAP_BETWEEN_TAGS;\n      const maxTagsWithDropdown = Math.max(1, Math.floor(availableWithDropdown / (averageTagWidth + GAP_BETWEEN_TAGS)));\n\n      if (maxTagsWithDropdown >= sortedFilters.length) {\n        // Alle Tags passen mit Dropdown - zeige alle\n        setVisibleTagCount(sortedFilters.length);\n      } else {\n        // Zeige berechnete Anzahl\n        setVisibleTagCount(Math.max(1, maxTagsWithDropdown));\n      }\n    }\n  }, [sortedFilters, averageTagWidth, containerWidth, isMeasuring, measuredTagWidths]);\n\n  // Debounced ResizeObserver für bessere Performance\n  const handleResize = useCallback(() => {\n    if (resizeTimeoutRef.current) {\n      clearTimeout(resizeTimeoutRef.current);\n    }\n    \n    resizeTimeoutRef.current = setTimeout(() => {\n      calculateVisibleTags();\n    }, 100); // 100ms Debounce für Filter-Tags (schneller als Client-Tags)\n  }, [calculateVisibleTags]);\n\n  // Optimierter ResizeObserver\n  useEffect(() => {\n    if (!containerRef.current) return;\n\n    const resizeObserver = new ResizeObserver(handleResize);\n    resizeObserver.observe(containerRef.current);\n    \n    // Auch Window-Resize überwachen für bessere Abdeckung\n    window.addEventListener('resize', handleResize);\n\n    return () => {\n      resizeObserver.disconnect();\n      window.removeEventListener('resize', handleResize);\n      if (resizeTimeoutRef.current) {\n        clearTimeout(resizeTimeoutRef.current);\n      }\n    };\n  }, [handleResize]);\n\n  // Messung der tatsächlichen Tag-Breiten nach Render\n  useLayoutEffect(() => {\n    if (sortedFilters.length === 0) return;\n\n    const widths = new Map<number, number>();\n    let hasMeasurements = false;\n\n    // Beim ersten Messen: Alle Tags messen (wenn isMeasuring true)\n    // Später: Nur die sichtbaren + ein paar mehr messen\n    const tagsToMeasure = isMeasuring\n      ? sortedFilters.length\n      : Math.min(visibleTagCount + 5, sortedFilters.length);\n\n    sortedFilters.slice(0, tagsToMeasure).forEach((filter) => {\n      const tagElement = tagRefs.current.get(filter.id);\n      if (tagElement) {\n        const width = tagElement.offsetWidth;\n        if (width > 0) {\n          widths.set(filter.id, width);\n          hasMeasurements = true;\n        }\n      }\n    });\n\n    if (hasMeasurements) {\n      // State-Updates verzögern um React Error #185 zu vermeiden\n      const shouldEndMeasuring = isMeasuring;\n      setTimeout(() => {\n        setMeasuredTagWidths(widths);\n        // Nach erfolgreicher Messung: Messmodus beenden und neu berechnen\n        if (shouldEndMeasuring) {\n          setIsMeasuring(false);\n          // Trigger Neuberechnung durch setTimeout (nach State-Update)\n          setTimeout(() => {\n            if (containerRef.current) {\n              calculateVisibleTags();\n            }\n          }, 0);\n        }\n      }, 0);\n    }\n  }, [sortedFilters, visibleTagCount, isMeasuring, calculateVisibleTags]);\n\n  // Initial calculation nach Filter-Änderungen (nur wenn nicht im Messmodus)\n  useLayoutEffect(() => {\n    if (!isMeasuring) {\n      calculateVisibleTags();\n    }\n  }, [calculateVisibleTags, isMeasuring]);\n  \n  // Reset Messmodus wenn sich Filter ändern\n  useEffect(() => {\n    if (sortedFilters.length > 0) {\n      setIsMeasuring(true);\n      setMeasuredTagWidths(new Map());\n    }\n  }, [sortedFilters.length]);\n\n  // Sortiere Gruppen nach order (MUSS vor frühen Returns sein!)\n  const sortedGroups = useMemo(() => {\n    return [...filterGroups].sort((a, b) => a.order - b.order);\n  }, [filterGroups]);\n\n  // Drag & Drop Handler\n  const handleDragStart = (e: React.DragEvent, filterId: number) => {\n    e.dataTransfer.effectAllowed = 'move';\n    setDraggedFilterId(filterId);\n  };\n\n  const handleDragOver = (e: React.DragEvent, targetId: number | 'new-group', type: 'filter' | 'group') => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n    \n    if (type === 'filter') {\n      setDragOverFilterId(targetId as number);\n    } else {\n      setDragOverGroupId(targetId);\n    }\n  };\n\n  const handleDragEnd = () => {\n    setDraggedFilterId(null);\n    setDragOverFilterId(null);\n    setDragOverGroupId(null);\n  };\n\n  const handleDrop = async (e: React.DragEvent, targetId: number | 'new-group', type: 'filter' | 'group') => {\n    e.preventDefault();\n    \n    if (!draggedFilterId) return;\n    \n    // Verhindere, dass ein Filter auf sich selbst gezogen wird\n    if (type === 'filter' && draggedFilterId === targetId) {\n      handleDragEnd();\n      return;\n    }\n    \n    try {\n      if (type === 'group') {\n        // Filter auf Gruppe gezogen -> Zu Gruppe hinzufügen\n        await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.GROUPS.ADD_FILTER(draggedFilterId, targetId as number));\n        showMessage(t('filter.addToGroupSuccess', { defaultValue: 'Filter zur Gruppe hinzugefügt' }), 'success');\n      } else {\n        // Filter auf Filter gezogen -> Zu bestehender Gruppe hinzufügen oder neue erstellen\n        const targetFilter = savedFilters.find(f => f.id === targetId as number);\n        if (!targetFilter) {\n          handleDragEnd();\n          return;\n        }\n        \n        if (targetFilter.groupId) {\n          // Füge zu bestehender Gruppe hinzu\n          await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.GROUPS.ADD_FILTER(draggedFilterId, targetFilter.groupId));\n          showMessage(t('filter.addToGroupSuccess', { defaultValue: 'Filter zur Gruppe hinzugefügt' }), 'success');\n        } else {\n          // Erstelle neue Gruppe mit beiden Filtern\n          const groupName = `Gruppe ${filterGroups.length + 1}`;\n          const groupResponse = await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.GROUPS.CREATE, {\n            tableId,\n            name: groupName\n          });\n          \n          const newGroup = groupResponse.data;\n          \n          await Promise.all([\n            axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.GROUPS.ADD_FILTER(draggedFilterId, newGroup.id)),\n            axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.GROUPS.ADD_FILTER(targetFilter.id, newGroup.id))\n          ]);\n          \n          showMessage(t('filter.createGroupSuccess', { defaultValue: 'Gruppe erstellt' }), 'success');\n        }\n      }\n      \n      // Refresh Filter-Liste\n      await refreshFilters();\n    } catch (err) {\n      console.error('Fehler beim Gruppieren der Filter:', err);\n      showMessage(t('filter.groupError', { defaultValue: 'Fehler beim Gruppieren der Filter' }), 'error');\n    } finally {\n      handleDragEnd();\n    }\n  };\n\n  // Gruppen-Management\n  const toggleGroupDropdown = (groupId: number) => {\n    setOpenGroupDropdowns(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(groupId)) {\n        newSet.delete(groupId);\n      } else {\n        newSet.add(groupId);\n      }\n      return newSet;\n    });\n  };\n\n  const handleUngroupFilters = async (groupId: number) => {\n    try {\n      await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.GROUPS.DELETE(groupId));\n      showMessage(t('filter.ungroupSuccess', { defaultValue: 'Gruppe aufgelöst' }), 'success');\n      await refreshFilters();\n      setOpenGroupDropdowns(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(groupId);\n        return newSet;\n      });\n    } catch (err) {\n      console.error('Fehler beim Auflösen der Gruppe:', err);\n      showMessage(t('filter.ungroupError', { defaultValue: 'Fehler beim Auflösen der Gruppe' }), 'error');\n    }\n  };\n\n  const handleStartEditGroup = (group: FilterGroup) => {\n    setEditingGroupId(group.id);\n    setEditingGroupName(group.name);\n  };\n\n  const handleCancelEditGroup = () => {\n    setEditingGroupId(null);\n    setEditingGroupName('');\n  };\n\n  const handleSaveGroupName = async (groupId: number) => {\n    if (!editingGroupName.trim()) {\n      showMessage(t('filter.groupNameRequired', { defaultValue: 'Gruppenname darf nicht leer sein' }), 'error');\n      return;\n    }\n\n    try {\n      await axiosInstance.put(API_ENDPOINTS.SAVED_FILTERS.GROUPS.UPDATE(groupId), {\n        name: editingGroupName.trim()\n      });\n      showMessage(t('filter.renameGroupSuccess', { defaultValue: 'Gruppe umbenannt' }), 'success');\n      await refreshFilters();\n      setEditingGroupId(null);\n      setEditingGroupName('');\n    } catch (err: any) {\n      console.error('Fehler beim Umbenennen der Gruppe:', err);\n      const errorMessage = err.response?.data?.message || 'Fehler beim Umbenennen der Gruppe';\n      showMessage(errorMessage, 'error');\n    }\n  };\n\n  // Bestimme welcher Filter aktiv ist\n  const getActiveFilterId = () => {\n    if (onFilterChange) {\n      // Controlled component - verwende selectedFilterId prop\n      return selectedFilterId;\n    } else {\n      // Uncontrolled - fallback auf internen State (legacy)\n      return null; // In legacy mode nicht visuell hervorheben\n    }\n  };\n  \n  if (loading) {\n    return <div className=\"flex justify-center items-center py-2\">{t('common.loadingFilters')}</div>;\n  }\n  \n  if (error) {\n    return <div className=\"text-red-500 py-2\">{error}</div>;\n  }\n  \n  if (savedFilters.length === 0 && filterGroups.length === 0) {\n    return null;\n  }\n\n  return (\n    <div ref={containerRef} className=\"flex items-center gap-1.5 sm:gap-2 mb-3 mt-1 overflow-x-auto overflow-y-hidden\">\n      {/* Dynamische Anzahl Filter inline anzeigen mit optimistischer Anzeige */}\n      <div className=\"flex items-center gap-1.5 sm:gap-2 flex-1 min-w-0 flex-nowrap\">\n        {/* Gruppen-Dropdowns */}\n        {sortedGroups.map(group => {\n          // Prüfe, ob ein Filter aus dieser Gruppe aktiv ist\n          const activeFilterInGroup = group.filters.find(f => getActiveFilterId() === f.id);\n          const translatedGroupName = translateGroupName(group.name);\n          const displayName = activeFilterInGroup \n            ? translateFilterName(activeFilterInGroup.name)\n            : `${translatedGroupName} (${group.filters.length})`;\n          \n          return (\n          <div key={group.id} className=\"relative flex-shrink-0\">\n            <div className=\"relative group\">\n              <button\n                onClick={() => toggleGroupDropdown(group.id)}\n                onDragOver={(e) => handleDragOver(e, group.id, 'group')}\n                onDrop={(e) => handleDrop(e, group.id, 'group')}\n                className={`flex items-center px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-xs sm:text-sm font-medium bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300 border border-purple-300 dark:border-purple-700 hover:bg-purple-200 dark:hover:bg-purple-800 transition-colors ${\n                  dragOverGroupId === group.id ? 'ring-2 ring-purple-500' : ''\n                } ${activeFilterInGroup ? 'ring-2 ring-purple-500' : ''}`}\n              >\n                <span className=\"truncate max-w-[4rem] sm:max-w-[100px]\">\n                  {displayName}\n                </span>\n                <ChevronDownIcon className={`h-3 w-3 sm:h-4 sm:w-4 ml-0.5 sm:ml-1 transition-transform ${openGroupDropdowns.has(group.id) ? 'rotate-180' : ''}`} />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {activeFilterInGroup ? displayName : `${translatedGroupName} (${group.filters.length})`}\n              </div>\n            </div>\n            \n            {/* Gruppen-Dropdown */}\n            {openGroupDropdowns.has(group.id) && (\n              <div className=\"absolute top-full left-0 mt-1 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-50 min-w-[200px]\">\n                {group.filters.map(filter => (\n                  <div\n                    key={filter.id}\n                    onClick={() => {\n                      handleSelectFilter(filter);\n                      toggleGroupDropdown(group.id);\n                    }}\n                    className={`flex items-center justify-between px-3 py-2 text-sm cursor-pointer transition-colors ${\n                      getActiveFilterId() === filter.id\n                        ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300'\n                        : 'text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700'\n                    } ${isStandardFilter(filter.name) ? 'font-bold' : ''}`}\n                  >\n                    <span className=\"truncate flex-1\">{translateFilterName(filter.name)}</span>\n                  </div>\n                ))}\n                <div className=\"border-t border-gray-200 dark:border-gray-700 mt-1 pt-1\">\n                  {editingGroupId === group.id ? (\n                    <div className=\"px-3 py-2\">\n                      <input\n                        type=\"text\"\n                        value={editingGroupName}\n                        onChange={(e) => setEditingGroupName(e.target.value)}\n                        onKeyDown={(e) => {\n                          if (e.key === 'Enter') {\n                            handleSaveGroupName(group.id);\n                          } else if (e.key === 'Escape') {\n                            handleCancelEditGroup();\n                          }\n                        }}\n                        className=\"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        autoFocus\n                        onClick={(e) => e.stopPropagation()}\n                      />\n                      <div className=\"flex gap-2 mt-2 justify-end\">\n                        <div className=\"relative group\">\n                          <button\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleSaveGroupName(group.id);\n                            }}\n                            className=\"p-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors\"\n                          >\n                            <CheckIcon className=\"h-4 w-4\" />\n                          </button>\n                          <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            Speichern\n                          </div>\n                        </div>\n                        <div className=\"relative group\">\n                          <button\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleCancelEditGroup();\n                            }}\n                            className=\"p-2 rounded-md bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-400 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors\"\n                          >\n                            <XMarkIcon className=\"h-4 w-4\" />\n                          </button>\n                          <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            Abbrechen\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ) : (\n                    <>\n                      <div className=\"relative group\">\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            handleStartEditGroup(group);\n                          }}\n                          className=\"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 w-full text-left transition-colors\"\n                        >\n                          <PencilIcon className=\"h-4 w-4\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          Gruppe umbenennen\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            handleUngroupFilters(group.id);\n                          }}\n                          className=\"flex items-center gap-2 px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 w-full text-left transition-colors\"\n                        >\n                          <TrashIcon className=\"h-4 w-4\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('filter.ungroup')}\n                        </div>\n                      </div>\n                    </>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n          );\n        })}\n        \n        {/* Einzelne Filter-Tags */}\n        {displayFilters.slice(0, currentVisibleCount).map(filter => (\n          <div\n            key={filter.id}\n            ref={(el) => {\n              if (el && !filter.isPlaceholder) {\n                tagRefs.current.set(filter.id, el);\n              } else if (!el) {\n                tagRefs.current.delete(filter.id);\n              }\n            }}\n            draggable={true}\n            onDragStart={(e) => handleDragStart(e, filter.id)}\n            onDragOver={(e) => handleDragOver(e, filter.id, 'filter')}\n            onDrop={(e) => handleDrop(e, filter.id, 'filter')}\n            onDragEnd={handleDragEnd}\n            onClick={() => !filter.isPlaceholder && handleSelectFilter(filter)}\n            className={`relative group flex items-center px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-xs sm:text-sm font-medium cursor-pointer transition-colors flex-shrink-0 ${\n              filter.isPlaceholder\n                ? 'bg-gray-200 dark:bg-gray-600 text-gray-400 dark:text-gray-500 animate-pulse cursor-default'\n                : draggedFilterId === filter.id\n                  ? 'opacity-50'\n                  : dragOverFilterId === filter.id\n                    ? 'ring-2 ring-blue-500'\n                    : getActiveFilterId() === filter.id\n                      ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 border border-blue-300 dark:border-blue-700'\n                      : 'bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-200 dark:hover:bg-gray-600'\n            } ${!filter.isPlaceholder && isStandardFilter(filter.name) ? 'font-bold' : ''}`}\n          >\n            <span className=\"truncate max-w-[4rem] sm:max-w-[100px]\">\n              {filter.isPlaceholder && filter.name === '████████' ? (\n                <span className=\"inline-block w-16 h-4 bg-gray-300 dark:bg-gray-500 rounded animate-pulse\"></span>\n              ) : (\n                translateFilterName(filter.name)\n              )}\n            </span>\n            {!filter.isPlaceholder && !isStandardFilter(filter.name) && (\n                <button\n                  onClick={(e) => handleDeleteFilter(e, filter.id)}\n                className=\"ml-1 sm:ml-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 focus:outline-none\"\n                >\n                  <XMarkIcon className=\"h-3 w-3 sm:h-4 sm:w-4\" />\n                </button>\n            )}\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {filter.isPlaceholder ? t('common.loading') : translateFilterName(filter.name)}\n            </div>\n          </div>\n        ))}\n        \n        {/* Dropdown nur bei echten Filtern und tatsächlichem Platzmangel */}\n        {!showOptimisticFilters && sortedFilters.length > visibleTagCount && (\n          <div className=\"relative flex-shrink-0\">\n            <div className=\"relative group\">\n              <button\n                onClick={() => setIsDropdownOpen(!isDropdownOpen)}\n                className=\"inline-flex items-center px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-xs sm:text-sm font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors border border-gray-300 dark:border-gray-600\"\n              >\n                <span>+{sortedFilters.length - visibleTagCount}</span>\n                <ChevronDownIcon className={`h-3 w-3 sm:h-4 sm:w-4 ml-0.5 sm:ml-1 transition-transform ${isDropdownOpen ? 'rotate-180' : ''}`} />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                Weitere Filter anzeigen\n              </div>\n            </div>\n            \n            {/* Dropdown-Menu */}\n            {isDropdownOpen && (\n              <div className=\"absolute top-full left-0 mt-1 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-50 min-w-[200px] max-w-[300px]\">\n                {sortedFilters.slice(visibleTagCount).map(filter => (\n                  <div\n                    key={filter.id}\n                    onClick={() => {\n                      handleSelectFilter(filter);\n                      setIsDropdownOpen(false);\n                    }}\n                    className={`flex items-center justify-between px-3 py-2 text-sm cursor-pointer transition-colors ${\n                      getActiveFilterId() === filter.id\n                        ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300'\n                        : 'text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700'\n                    } ${isStandardFilter(filter.name) ? 'font-bold' : ''}`}\n                  >\n                    <span className=\"truncate flex-1\">{translateFilterName(filter.name)}</span>\n                    {!isStandardFilter(filter.name) && (\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            handleDeleteFilter(e, filter.id);\n                            setIsDropdownOpen(false);\n                          }}\n                        className=\"ml-2 flex-shrink-0 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 focus:outline-none\"\n                        >\n                          <XMarkIcon className=\"h-4 w-4\" />\n                        </button>\n                    )}\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SavedFilterTags; "],"names":["_ref","condition","onChange","onDelete","onAdd","columns","isFirst","isLast","sortDirection","sortPriority","onSortDirectionChange","onPriorityChange","canMoveUp","canMoveDown","t","useTranslation","operators","setOperators","useState","users","setUsers","roles","setRoles","branches","setBranches","loadingUsers","setLoadingUsers","loadingRoles","setLoadingRoles","loadingBranches","setLoadingBranches","useEffect","getOperatorsByColumnType","columnId","textOperators","value","label","dateOperators","durationOperators","statusOperators","column","async","localStorage","getItem","response","axiosInstance","get","data","error","console","some","col","id","isTaskTable","API_ENDPOINTS","BRANCHES","BASE","loadUsersAndRoles","_jsxs","className","children","_jsx","e","_operators$","_objectSpread","target","operator","map","op","renderValueInput","isRequestTable","isInvoiceTable","showRoles","disabled","length","user","concat","firstName","lastName","role","name","branch","isVariable","type","placeholder","undefined","onClick","stopPropagation","ChevronUpIcon","ChevronDownIcon","ArrowUpIcon","ArrowDownIcon","TrashIcon","PlusCircleIcon","isOpen","setIsOpen","dropdownRef","useRef","handleClickOutside","event","current","contains","document","addEventListener","removeEventListener","handleSelect","ref","style","width","minWidth","maxWidth","overflow","_Fragment","PlusIcon","onApply","onReset","savedConditions","savedOperators","savedSortDirections","onSortDirectionsChange","tableId","showMessage","useMessage","conditions","setConditions","logicalOperators","setLogicalOperators","sortDirections","setSortDirections","Array","isArray","warn","showSaveInput","setShowSaveInput","filterName","setFilterName","existingFilters","setExistingFilters","SAVED_FILTERS","BY_TABLE","filter","err","fetchExistingFilters","prevSavedConditionsRef","prevSavedOperatorsRef","prevSavedSortDirectionsRef","conditionsChanged","JSON","stringify","operatorsChanged","sortDirectionsChanged","validSortDirections","renumberPriorities","sortDirs","sort","a","b","priority","sd","index","getSortDirectionForIndex","find","conditionIndex","handleAddCondition","React","FilterRow","newCondition","handleConditionChange","newConditions","oldCondition","newSortDirections","oldSortDirIndex","findIndex","splice","maxPriority","Math","max","push","direction","newOperators","handleDeleteCondition","sortDir","handleSortDirectionChange","existingIndex","newPriority","handlePriorityChange","currentPriority","otherIndex","safeSortDirections","FilterLogicalOperator","newOperator","handleOperatorChange","trim","validConditions","c","post","window","refreshSavedFilters","title","BookmarkIcon","XMarkIcon","handleResetFilters","ArrowPathIcon","handleApplyFilters","CheckIcon","onSelectFilter","activeFilterName","selectedFilterId","onFilterChange","defaultFilterName","translateFilterName","savedFilters","setSavedFilters","filterGroups","setFilterGroups","loading","setLoading","setError","recentClientNames","setRecentClientNames","defaultFilterAppliedRef","containerRef","tagRefs","Map","visibleTagCount","setVisibleTagCount","containerWidth","setContainerWidth","measuredTagWidths","setMeasuredTagWidths","isMeasuring","setIsMeasuring","resizeTimeoutRef","isDropdownOpen","setIsDropdownOpen","draggedFilterId","setDraggedFilterId","dragOverFilterId","setDragOverFilterId","dragOverGroupId","setDragOverGroupId","openGroupDropdowns","setOpenGroupDropdowns","Set","editingGroupId","setEditingGroupId","editingGroupName","setEditingGroupName","refreshFilters","useCallback","filtersResponse","groupsResponse","Promise","all","GROUPS","filters","f","groups","g","cleanupExcessiveClientFilters","clientFilters","currentClientNames","includes","filtersToDelete","Date","createdAt","getTime","slice","filterToDelete","delete","BY_ID","loadRecentClients","log","clientNames","CLIENTS","RECENT","client","handleConsultationChanged","defaultFilter","fetchData","closest","handleSelectFilter","_filter$conditions","_filter$operators","_filter$sortDirection","filterId","conditionsCount","operatorsCount","sortDirectionsCount","hasOnFilterChange","handleDeleteFilter","isStandardFilter","defaultValue","sortedFilters","useMemo","ungroupedFilters","groupId","heute","woche","archiv","sortedRecentClientFilters","clientName","customFilters","orderedFilters","aktuell","showOptimisticFilters","optimisticFilters","fill","_","i","isPlaceholder","displayFilters","currentVisibleCount","averageTagWidth","size","widths","from","values","reduce","sum","deleteButtonWidth","calculateVisibleTags","currentWidth","clientWidth","abs","availableWidth","totalWidth","measuredCount","forEach","measuredWidth","totalWidthWithoutLastGap","availableWithDropdown","cumulativeWidth","visibleCount","floor","maxTagsWithDropdown","handleResize","clearTimeout","setTimeout","resizeObserver","ResizeObserver","observe","disconnect","useLayoutEffect","hasMeasurements","tagsToMeasure","min","tagElement","offsetWidth","set","shouldEndMeasuring","sortedGroups","order","handleDragOver","targetId","preventDefault","dataTransfer","dropEffect","handleDragEnd","handleDrop","ADD_FILTER","targetFilter","groupName","newGroup","CREATE","toggleGroupDropdown","prev","newSet","has","add","handleCancelEditGroup","handleSaveGroupName","put","UPDATE","_err$response","_err$response$data","errorMessage","message","getActiveFilterId","group","activeFilterInGroup","translatedGroupName","displayName","onDragOver","onDrop","onKeyDown","key","autoFocus","handleStartEditGroup","PencilIcon","DELETE","handleUngroupFilters","el","draggable","onDragStart","handleDragStart","effectAllowed","onDragEnd"],"sourceRoot":""}