{"version":3,"file":"static/js/77.f949a163.chunk.js","mappings":"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","sources":["components/reservations/CreateReservationModal.tsx","types/reservation.ts","services/reservationService.ts","components/CerebroArticleSelector.tsx","components/CreateTaskModal.tsx","components/TaskDataBox.tsx","components/EmailTemplateBox.tsx","components/SocialSecurityCompletionBox.tsx","components/EditTaskModal.tsx","components/reservations/SendInvitationSidepane.tsx","components/WorktimeTracker.tsx","pages/Worktracker.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon } from '@heroicons/react/24/outline';\r\nimport { reservationService, CreateReservationData } from '../../services/reservationService.ts';\r\nimport { Reservation } from '../../types/reservation.ts';\r\nimport useMessage from '../../hooks/useMessage.ts';\r\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\r\n\r\ninterface CreateReservationModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onReservationCreated: (newReservation: Reservation) => void;\r\n}\r\n\r\nconst CreateReservationModal: React.FC<CreateReservationModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onReservationCreated\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { showMessage } = useMessage();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n\r\n  const [guestName, setGuestName] = useState('');\r\n  const [contact, setContact] = useState('');\r\n  const [amount, setAmount] = useState('');\r\n  const [currency, setCurrency] = useState('COP');\r\n  const [contactType, setContactType] = useState<'phone' | 'email' | null>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Erkenne automatisch ob es Telefonnummer oder Email ist\r\n  const detectContactType = (value: string): 'phone' | 'email' | null => {\r\n    if (!value || value.trim().length === 0) {\r\n      return null;\r\n    }\r\n    // Email-Format: enthlt @ und .\r\n    if (value.includes('@') && value.includes('.')) {\r\n      return 'email';\r\n    }\r\n    // Telefonnummer: enthlt nur Ziffern, +, Leerzeichen, Bindestriche\r\n    return 'phone';\r\n  };\r\n\r\n  const handleContactChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const value = e.target.value;\r\n    setContact(value);\r\n    setContactType(detectContactType(value));\r\n  };\r\n\r\n  const handleAmountChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const value = e.target.value;\r\n    // Erlaube nur Zahlen und Dezimalpunkt\r\n    if (value === '' || /^\\d*\\.?\\d*$/.test(value)) {\r\n      setAmount(value);\r\n    }\r\n  };\r\n\r\n  // Responsive-Verhalten\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    handleResize();\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n    };\r\n  }, []);\r\n\r\n  // Sidepane-Status verwalten\r\n  useEffect(() => {\r\n    if (isOpen && !isMobile) {\r\n      openSidepane();\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n\r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, isMobile, openSidepane, closeSidepane]);\r\n\r\n  // Reset form when modal closes\r\n  useEffect(() => {\r\n    if (!isOpen) {\r\n      setGuestName('');\r\n      setContact('');\r\n      setAmount('');\r\n      setCurrency('COP');\r\n      setContactType(null);\r\n      setError(null);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n\r\n    // Validierung\r\n    if (!guestName || guestName.trim().length === 0) {\r\n      setError(t('reservations.createReservation.errors.guestNameRequired', 'Gast-Name ist erforderlich'));\r\n      return;\r\n    }\r\n\r\n    if (!contact || contact.trim().length === 0) {\r\n      setError(t('reservations.createReservation.errors.contactRequired', 'Kontaktinformation ist erforderlich'));\r\n      return;\r\n    }\r\n\r\n    if (!amount || parseFloat(amount) <= 0) {\r\n      setError(t('reservations.createReservation.errors.amountRequired', 'Betrag muss eine positive Zahl sein'));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      const data: CreateReservationData = {\r\n        guestName: guestName.trim(),\r\n        contact: contact.trim(),\r\n        amount: parseFloat(amount),\r\n        currency: currency\r\n      };\r\n\r\n      console.log('[CreateReservationModal] Sende Daten:', data);\r\n      console.log('[CreateReservationModal] API Endpoint:', '/api/reservations');\r\n      const newReservation = await reservationService.create(data);\r\n      console.log('[CreateReservationModal] Reservierung erstellt:', newReservation);\r\n      \r\n      showMessage(\r\n        t('reservations.createReservation.success', 'Reservierung erfolgreich erstellt'),\r\n        'success'\r\n      );\r\n\r\n      onReservationCreated(newReservation);\r\n      onClose();\r\n    } catch (err: any) {\r\n      console.error('[CreateReservationModal] Fehler beim Erstellen der Reservierung:', err);\r\n      console.error('[CreateReservationModal] Error Response:', err.response);\r\n      console.error('[CreateReservationModal] Error Status:', err.response?.status);\r\n      console.error('[CreateReservationModal] Error Data:', err.response?.data);\r\n      const errorMessage = err.response?.data?.message || err.message ||\r\n        t('reservations.createReservation.errors.createError', 'Fehler beim Erstellen der Reservierung');\r\n      setError(errorMessage);\r\n      showMessage(errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    onClose();\r\n  };\r\n\r\n  // Fr Mobile (< 640px) - Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n            <div className=\"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\r\n              <div className=\"flex items-center justify-between mb-4\">\r\n                <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                  {t('reservations.createReservation.title', 'Neue Reservierung')}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={handleClose}\r\n                  className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n\r\n            {error && (\r\n              <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded\">\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            <form onSubmit={handleSubmit}>\r\n              {/* Gast-Name */}\r\n              <div className=\"mb-4\">\r\n                <label htmlFor=\"guestName\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  {t('reservations.createReservation.guestName', 'Gast-Name')} *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"guestName\"\r\n                  value={guestName}\r\n                  onChange={(e) => setGuestName(e.target.value)}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              {/* Kontakt */}\r\n              <div className=\"mb-4\">\r\n                <label htmlFor=\"contact\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  {t('reservations.createReservation.contact', 'Telefonnummer oder Email')} *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"contact\"\r\n                  value={contact}\r\n                  onChange={handleContactChange}\r\n                  placeholder={t('reservations.createReservation.contactPlaceholder', 'z.B. +573001234567 oder email@example.com')}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  required\r\n                />\r\n                {contactType && (\r\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                    {contactType === 'email'\r\n                      ? t('reservations.createReservation.detectedEmail', 'Email erkannt')\r\n                      : t('reservations.createReservation.detectedPhone', 'Telefonnummer erkannt')\r\n                    }\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Betrag & Whrung */}\r\n              <div className=\"grid grid-cols-2 gap-4 mb-4\">\r\n                <div>\r\n                  <label htmlFor=\"amount\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                    {t('reservations.createReservation.amount', 'Betrag')} *\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    id=\"amount\"\r\n                    value={amount}\r\n                    onChange={handleAmountChange}\r\n                    placeholder=\"0.00\"\r\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                    required\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label htmlFor=\"currency\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                    {t('reservations.createReservation.currency', 'Whrung')}\r\n                  </label>\r\n                  <select\r\n                    id=\"currency\"\r\n                    value={currency}\r\n                    onChange={(e) => setCurrency(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  >\r\n                    <option value=\"COP\">COP</option>\r\n                    <option value=\"USD\">USD</option>\r\n                    <option value=\"EUR\">EUR</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n\r\n              <p className=\"mb-4 text-sm text-gray-500 dark:text-gray-400\">\r\n                {t('reservations.createReservation.hint', 'Nach der Erstellung wird automatisch eine WhatsApp-Nachricht mit Zahlungslink versendet (wenn Telefonnummer angegeben).')}\r\n              </p>\r\n\r\n              {/* Buttons */}\r\n              <div className=\"flex justify-end space-x-3\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={onClose}\r\n                  className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                >\r\n                  {t('common.cancel', 'Abbrechen')}\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={loading}\r\n                  className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                >\r\n                  {loading\r\n                    ? t('common.creating', 'Wird erstellt...')\r\n                    : t('common.create', 'Erstellen')\r\n                  }\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n    );\r\n  }\r\n\r\n  // Fr Desktop (ab 640px) - Sidepane\r\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \r\n          aria-hidden=\"true\" \r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div \r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('reservations.createReservation.title', 'Neue Reservierung')}\r\n          </h2>\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {error && (\r\n            <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded\">\r\n              {error}\r\n            </div>\r\n          )}\r\n\r\n          <form onSubmit={handleSubmit}>\r\n            {/* Gast-Name */}\r\n            <div className=\"mb-4\">\r\n              <label htmlFor=\"guestName\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                {t('reservations.createReservation.guestName', 'Gast-Name')} *\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"guestName\"\r\n                value={guestName}\r\n                onChange={(e) => setGuestName(e.target.value)}\r\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                required\r\n              />\r\n            </div>\r\n\r\n            {/* Kontakt */}\r\n            <div className=\"mb-4\">\r\n              <label htmlFor=\"contact\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                {t('reservations.createReservation.contact', 'Telefonnummer oder Email')} *\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"contact\"\r\n                value={contact}\r\n                onChange={handleContactChange}\r\n                placeholder={t('reservations.createReservation.contactPlaceholder', 'z.B. +573001234567 oder email@example.com')}\r\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                required\r\n              />\r\n              {contactType && (\r\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                  {contactType === 'email'\r\n                    ? t('reservations.createReservation.detectedEmail', 'Email erkannt')\r\n                    : t('reservations.createReservation.detectedPhone', 'Telefonnummer erkannt')\r\n                  }\r\n                </p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Betrag & Whrung */}\r\n            <div className=\"grid grid-cols-2 gap-4 mb-4\">\r\n              <div>\r\n                <label htmlFor=\"amount\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  {t('reservations.createReservation.amount', 'Betrag')} *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"amount\"\r\n                  value={amount}\r\n                  onChange={handleAmountChange}\r\n                  placeholder=\"0.00\"\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  required\r\n                />\r\n              </div>\r\n              <div>\r\n                <label htmlFor=\"currency\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  {t('reservations.createReservation.currency', 'Whrung')}\r\n                </label>\r\n                <select\r\n                  id=\"currency\"\r\n                  value={currency}\r\n                  onChange={(e) => setCurrency(e.target.value)}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                >\r\n                  <option value=\"COP\">COP</option>\r\n                  <option value=\"USD\">USD</option>\r\n                  <option value=\"EUR\">EUR</option>\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            <p className=\"mb-4 text-sm text-gray-500 dark:text-gray-400\">\r\n              {t('reservations.createReservation.hint', 'Nach der Erstellung wird automatisch eine WhatsApp-Nachricht mit Zahlungslink versendet (wenn Telefonnummer angegeben).')}\r\n            </p>\r\n\r\n            {/* Buttons */}\r\n            <div className=\"flex justify-end space-x-3\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleClose}\r\n                className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n              >\r\n                {t('common.cancel', 'Abbrechen')}\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading}\r\n                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {loading\r\n                  ? t('common.creating', 'Wird erstellt...')\r\n                  : t('common.create', 'Erstellen')\r\n                }\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CreateReservationModal;\r\n\r\n","/**\r\n * Reservation Types fr Frontend\r\n */\r\n\r\nexport enum ReservationStatus {\r\n  CONFIRMED = 'confirmed',\r\n  NOTIFICATION_SENT = 'notification_sent',\r\n  CHECKED_IN = 'checked_in',\r\n  CHECKED_OUT = 'checked_out',\r\n  CANCELLED = 'cancelled',\r\n  NO_SHOW = 'no_show'\r\n}\r\n\r\nexport enum PaymentStatus {\r\n  PENDING = 'pending',\r\n  PAID = 'paid',\r\n  PARTIALLY_PAID = 'partially_paid',\r\n  REFUNDED = 'refunded'\r\n}\r\n\r\nexport interface Reservation {\r\n  id: number;\r\n  lobbyReservationId?: string | null;\r\n  guestName: string;\r\n  guestEmail?: string | null;\r\n  guestPhone?: string | null;\r\n  checkInDate: string; // ISO date string\r\n  checkOutDate: string; // ISO date string\r\n  arrivalTime?: string | null; // ISO datetime string\r\n  roomNumber?: string | null;\r\n  roomDescription?: string | null;\r\n  status: ReservationStatus;\r\n  paymentStatus: PaymentStatus;\r\n  amount?: number | string | null; // Betrag der Reservierung\r\n  currency?: string | null; // Whrung (COP, USD, EUR, etc.)\r\n  paymentLink?: string | null;\r\n  doorPin?: string | null;\r\n  doorAppName?: string | null;\r\n  ttlLockId?: string | null;\r\n  ttlLockPassword?: string | null;\r\n  onlineCheckInCompleted: boolean;\r\n  onlineCheckInCompletedAt?: string | null; // ISO datetime string\r\n  sireRegistered: boolean;\r\n  sireRegistrationId?: string | null;\r\n  sireRegisteredAt?: string | null; // ISO datetime string\r\n  sireRegistrationError?: string | null;\r\n  sentMessage?: string | null; // Versendete WhatsApp-Nachricht\r\n  sentMessageAt?: string | null; // ISO datetime string\r\n  guestNationality?: string | null;\r\n  guestPassportNumber?: string | null;\r\n  guestBirthDate?: string | null; // ISO date string\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  branch?: {\r\n    id: number;\r\n    name: string;\r\n  } | null;\r\n  taskId?: number | null;\r\n  createdAt: string; // ISO datetime string\r\n  updatedAt: string; // ISO datetime string\r\n}\r\n\r\nexport interface ReservationSyncHistory {\r\n  id: number;\r\n  reservationId: number;\r\n  syncType: 'created' | 'updated' | 'status_changed';\r\n  syncData?: any;\r\n  success: boolean;\r\n  errorMessage?: string | null;\r\n  syncedAt: string; // ISO datetime string\r\n}\r\n\r\n","import axiosInstance from '../config/axios.ts';\r\nimport { Reservation } from '../types/reservation.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\n\r\n// WICHTIG: axiosInstance hat bereits baseURL mit /api, daher nur /reservations hier\r\nconst API_BASE = '/reservations';\r\n\r\nexport interface CreateReservationData {\r\n  guestName: string;\r\n  contact: string; // Telefonnummer oder Email\r\n  amount: number;\r\n  currency?: string; // Default: \"COP\"\r\n}\r\n\r\nexport const reservationService = {\r\n  /**\r\n   * Erstellt eine neue Reservierung\r\n   */\r\n  async create(data: CreateReservationData): Promise<Reservation> {\r\n    console.log('[reservationService] POST zu:', API_BASE);\r\n    console.log('[reservationService] Daten:', data);\r\n    const response = await axiosInstance.post(API_BASE, data);\r\n    console.log('[reservationService] Response:', response);\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Holt eine Reservierung nach ID\r\n   */\r\n  async getById(id: number): Promise<Reservation> {\r\n    const response = await axiosInstance.get(`${API_BASE}/${id}`);\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Aktualisiert Kontaktinformation (Telefonnummer oder Email)\r\n   */\r\n  async updateGuestContact(id: number, contact: string): Promise<Reservation> {\r\n    const response = await axiosInstance.put(`${API_BASE}/${id}/guest-contact`, {\r\n      contact\r\n    });\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Generiert PIN-Code und sendet Mitteilung (unabhngig von Zahlungsstatus/Check-in-Status)\r\n   */\r\n  async generatePinAndSend(id: number): Promise<Reservation> {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.RESERVATION.GENERATE_PIN_AND_SEND(id));\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Sendet Reservation-Einladung manuell (mit optionalen Parametern)\r\n   */\r\n  async sendInvitation(\r\n    id: number,\r\n    options?: {\r\n      guestPhone?: string;\r\n      guestEmail?: string;\r\n      customMessage?: string;\r\n      amount?: number;\r\n      currency?: string;\r\n    }\r\n  ): Promise<Reservation> {\r\n    const response = await axiosInstance.post(\r\n      API_ENDPOINTS.RESERVATION.SEND_INVITATION(id),\r\n      options || {}\r\n    );\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Holt Notification-Logs fr eine Reservierung\r\n   */\r\n  async getNotificationLogs(id: number): Promise<ReservationNotificationLog[]> {\r\n    const response = await axiosInstance.get(\r\n      API_ENDPOINTS.RESERVATION.NOTIFICATION_LOGS(id)\r\n    );\r\n    return response.data.data || response.data;\r\n  }\r\n};\r\n\r\nexport interface ReservationNotificationLog {\r\n  id: number;\r\n  reservationId: number;\r\n  notificationType: 'invitation' | 'pin' | 'checkin_confirmation';\r\n  channel: 'whatsapp' | 'email' | 'both';\r\n  success: boolean;\r\n  sentAt: string; // ISO datetime string\r\n  sentTo?: string | null;\r\n  message?: string | null;\r\n  paymentLink?: string | null;\r\n  checkInLink?: string | null;\r\n  errorMessage?: string | null;\r\n  createdAt: string; // ISO datetime string\r\n}\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { MagnifyingGlassIcon } from '@heroicons/react/24/solid';\nimport { XCircleIcon } from '@heroicons/react/24/solid';\nimport debounce from 'lodash/debounce';\n\ninterface CerebroArticle {\n  id: number;\n  title: string;\n  slug: string;\n  content?: string;\n}\n\ninterface CerebroArticleSelectorProps {\n  onArticleSelected: (article: CerebroArticle) => void;\n  excludeArticleIds?: number[];\n  selectedArticles?: CerebroArticle[];\n  onArticleRemove?: (articleId: number) => void;\n}\n\nconst CerebroArticleSelector: React.FC<CerebroArticleSelectorProps> = ({\n  onArticleSelected,\n  excludeArticleIds = [],\n  selectedArticles,\n  onArticleRemove\n}) => {\n  const [articles, setArticles] = useState<CerebroArticle[]>([]);\n  const [selectedArticleId, setSelectedArticleId] = useState<number | null>(null);\n  const [selectedArticlePreview, setSelectedArticlePreview] = useState<CerebroArticle | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Alle Artikel beim Laden abrufen\n  useEffect(() => {\n    const fetchAllArticles = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        \n        const response = await axiosInstance.get(API_ENDPOINTS.CEREBRO.ARTICLES.BASE);\n        \n        // Filtere bereits ausgewhlte Artikel\n        const filteredArticles = response.data.filter(\n          (article: CerebroArticle) => !excludeArticleIds.includes(article.id)\n        );\n        \n        setArticles(filteredArticles);\n      } catch (err) {\n        console.error('Fehler beim Abrufen der Artikel:', err);\n        // Einfachere Fehlerbehandlung ohne axios-Import\n        const axiosError = err as any;\n        setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchAllArticles();\n  }, [excludeArticleIds]);\n\n  // Artikeldetails abrufen, wenn ein Artikel ausgewhlt wird\n  const fetchArticleDetails = async (articleId: number) => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.CEREBRO.ARTICLES.BY_ID(articleId));\n      setSelectedArticlePreview(response.data);\n    } catch (err) {\n      console.error('Fehler beim Abrufen der Artikeldetails:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleArticleSelect = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    const articleId = parseInt(e.target.value, 10);\n    \n    if (!isNaN(articleId)) {\n      setSelectedArticleId(articleId);\n      \n      // Artikel aus der Liste finden\n      const selectedArticle = articles.find(article => article.id === articleId);\n      \n      if (selectedArticle) {\n        // Artikeldetails abrufen fr die Vorschau\n        fetchArticleDetails(articleId);\n      }\n    } else {\n      setSelectedArticleId(null);\n      setSelectedArticlePreview(null);\n    }\n  };\n\n  const handleArticleConfirm = () => {\n    if (selectedArticleId !== null) {\n      const selectedArticle = articles.find(article => article.id === selectedArticleId);\n      if (selectedArticle) {\n        onArticleSelected(selectedArticle);\n        setSelectedArticleId(null);\n        setSelectedArticlePreview(null);\n      }\n    }\n  };\n\n  return (\n    <div className=\"mt-4\">\n      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n        Cerebro-Artikel verknpfen\n      </label>\n      \n      <div className=\"flex flex-col gap-3\">\n        <div className=\"flex items-center gap-2\">\n          <select\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={selectedArticleId || ''}\n            onChange={handleArticleSelect}\n          >\n            <option value=\"\">-- Artikel auswhlen --</option>\n            {articles.map((article) => (\n              <option key={article.id} value={article.id}>\n                {article.title}\n              </option>\n            ))}\n          </select>\n          \n          <button\n            type=\"button\"\n            onClick={handleArticleConfirm}\n            disabled={selectedArticleId === null}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            Verknpfen\n          </button>\n        </div>\n\n        {loading && (\n          <div className=\"text-sm text-gray-500\">\n            Lade Artikel...\n          </div>\n        )}\n        \n        {error && (\n          <div className=\"text-sm text-red-600\">\n            {error}\n          </div>\n        )}\n        \n        {selectedArticlePreview && (\n          <div className=\"mt-2 p-4 border border-gray-300 rounded-md bg-gray-50\">\n            <h4 className=\"font-medium text-lg mb-2\">{selectedArticlePreview.title}</h4>\n            <div className=\"prose prose-sm max-w-none\">\n              {selectedArticlePreview.content ? (\n                <div className=\"text-sm text-gray-700 max-h-40 overflow-y-auto\">\n                  {selectedArticlePreview.content.substring(0, 300)}\n                  {selectedArticlePreview.content.length > 300 && '...'}\n                </div>\n              ) : (\n                <p className=\"text-sm text-gray-500 italic\">Kein Inhalt verfgbar</p>\n              )}\n            </div>\n            <div className=\"mt-2\">\n              <a \n                href={`/cerebro/articles/${selectedArticlePreview.slug}`}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-sm text-blue-600 hover:underline\"\n              >\n                Artikel ffnen\n              </a>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default CerebroArticleSelector; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ArrowPathIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport CerebroArticleSelector from './CerebroArticleSelector.tsx';\nimport MarkdownPreview from './MarkdownPreview.tsx';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface User {\n    id: number;\n    firstName: string;\n    lastName: string;\n}\n\ninterface Role {\n    id: number;\n    name: string;\n}\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface CerebroArticle {\n    id: number;\n    title: string;\n    slug: string;\n    content?: string;\n}\n\ninterface TaskAttachment {\n    id?: number;\n    fileName: string;\n    fileType: string;\n    fileSize: number;\n    filePath?: string;\n    uploadedAt?: string;\n    file?: File; // Fr temporre Anhnge vor dem Hochladen\n}\n\ninterface CreateTaskModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTaskCreated: (newTask: Task) => void;\n}\n\ninterface Task {\n    id: number;\n    title: string;\n    description: string | null;\n    status: 'open' | 'in_progress' | 'improval' | 'quality_control' | 'done';\n    responsible: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    responsibleId: number | null;\n    role: {\n        id: number;\n        name: string;\n    } | null;\n    roleId: number | null;\n    qualityControl: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    branch: {\n        id: number;\n        name: string;\n    };\n    dueDate: string | null;\n    requestId: number | null;\n}\n\nconst CreateTaskModal = ({ isOpen, onClose, onTaskCreated }: CreateTaskModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { openSidepane, closeSidepane } = useSidepane();\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [title, setTitle] = useState('');\n    const [description, setDescription] = useState('');\n    const [assigneeType, setAssigneeType] = useState<'user' | 'role'>('user');\n    const [responsibleId, setResponsibleId] = useState<number | ''>('');\n    const [roleId, setRoleId] = useState<number | ''>('');\n    const [qualityControlId, setQualityControlId] = useState<number | ''>('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    const [dueDate, setDueDate] = useState('');\n    const [users, setUsers] = useState<User[]>([]);\n    const [roles, setRoles] = useState<Role[]>([]);\n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [selectedArticles, setSelectedArticles] = useState<CerebroArticle[]>([]);\n    const [activeTab, setActiveTab] = useState<'data' | 'cerebro'>('data');\n    const [temporaryAttachments, setTemporaryAttachments] = useState<TaskAttachment[]>([]);\n    const [uploading, setUploading] = useState(false);\n    const fileInputRef = useRef<HTMLInputElement>(null);\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n    const getDefaultDueDate = () => {\n        const date = new Date();\n        date.setDate(date.getDate() + 7);\n        return date.toISOString().split('T')[0];\n    };\n\n    useEffect(() => {\n        if (isOpen) {\n            fetchUsers();\n            fetchRoles();\n            fetchBranches();\n            \n            if (user) {\n                setQualityControlId(user.id);\n            }\n            \n            setDueDate(getDefaultDueDate());\n        }\n    }, [isOpen, user]);\n\n    useEffect(() => {\n        if (branches.length > 0 && branchId === '') {\n            if (branches.length === 1) {\n                setBranchId(branches[0].id);\n            } else if (branches.length > 1) {\n                setBranchId(branches[0].id);\n            }\n        }\n    }, [branches, branchId]);\n    \n    useEffect(() => {\n        // Prfen der Bildschirmgre beim Mounten\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        // Initial prfen\n        checkScreenSize();\n        \n        // Event-Listener fr Grennderungen\n        window.addEventListener('resize', checkScreenSize);\n        \n        // Cleanup\n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    const fetchUsers = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n\n            console.log('Lade Benutzer fr CreateTaskModal...');\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.USERS.DROPDOWN);\n            \n            console.log('Benutzer geladen:', response.data.length);\n            setUsers(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Benutzer:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.createTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.createTask.errors.loadUsersError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchRoles = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.ROLES.BASE);\n            setRoles(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Rollen:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.createTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.createTask.errors.loadRolesError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchBranches = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n\n            console.log('Lade Niederlassungen fr CreateTaskModal...');\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n            \n            console.log('Niederlassungen geladen:', response.data.length);\n            setBranches(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Niederlassungen:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.createTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.createTask.errors.loadBranchesError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const handlePaste = async (event: React.ClipboardEvent) => {\n        const items = event.clipboardData.items;\n        \n        for (let i = 0; i < items.length; i++) {\n            const item = items[i];\n            \n            // Prfen, ob das eingefgte Element ein Bild ist\n            if (item.type.indexOf('image') === 0) {\n                event.preventDefault(); // Standardeingabe verhindern\n                \n                const file = item.getAsFile();\n                if (file) {\n                    await handleTemporaryAttachment(file);\n                }\n                return;\n            }\n        }\n    };\n\n    const handleDrop = async (event: React.DragEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n        \n        if (event.dataTransfer.files && event.dataTransfer.files.length > 0) {\n            const file = event.dataTransfer.files[0];\n            await handleTemporaryAttachment(file);\n        }\n    };\n\n    const handleDragOver = (event: React.DragEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    const handleTemporaryAttachment = async (file: File) => {\n        setUploading(true);\n        setError(null);\n\n        try {\n            // Erstelle einen temporren Anhang\n            const newAttachment: TaskAttachment = {\n                fileName: file.name,\n                fileType: file.type,\n                fileSize: file.size,\n                file: file // Speichern der Datei fr spteren Upload\n            };\n            \n            setTemporaryAttachments(prev => [...prev, newAttachment]);\n\n            // Fge Markdown-Link ins Textarea ein (fr Card-Anzeige)\n            // Bilder werden zustzlich als groe Vorschau unter dem Textarea angezeigt\n            let insertText = '';\n            if (file.type.startsWith('image/')) {\n                // Hinweis: Wir verwenden hier den Platzhalter, da die Datei erst nach dem Erstellen hochgeladen wird\n                // Die tatschliche URL wird nach dem erfolgreichen Upload im Backend gesetzt\n                insertText = `\\n![${file.name}](${t('tasks.createTask.form.uploadAfterCreate')})\\n`;\n            } else {\n                // Fr andere Dateien einen temporren Platzhalter\n                insertText = `\\n[${file.name}](${t('tasks.createTask.form.uploadAfterCreate')})\\n`;\n            }\n            \n            // Fge den Link an der aktuellen Cursorposition ein\n            if (textareaRef.current) {\n                const cursorPos = textareaRef.current.selectionStart;\n                const textBefore = description.substring(0, cursorPos);\n                const textAfter = description.substring(cursorPos);\n                \n                setDescription(textBefore + insertText + textAfter);\n                \n                // Setze den Cursor hinter den eingefgten Link\n                setTimeout(() => {\n                    if (textareaRef.current) {\n                        const newPos = cursorPos + insertText.length;\n                        textareaRef.current.selectionStart = newPos;\n                        textareaRef.current.selectionEnd = newPos;\n                        textareaRef.current.focus();\n                    }\n                }, 0);\n            } else {\n                setDescription(description + insertText);\n            }\n        } catch (err) {\n            console.error('Fehler beim Verarbeiten der Datei:', err);\n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        } finally {\n            setUploading(false);\n        }\n    };\n\n    const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n        const files = event.target.files;\n        if (!files || files.length === 0) return;\n\n        const file = files[0];\n        await handleTemporaryAttachment(file);\n        \n        // Zurcksetzen des Datei-Inputs\n        if (fileInputRef.current) {\n            fileInputRef.current.value = '';\n        }\n    };\n\n    const handleRemoveTemporaryAttachment = (index: number) => {\n        // Finde den zu entfernenden Anhang\n        const attachmentToRemove = temporaryAttachments[index];\n        \n        if (attachmentToRemove) {\n            // Entferne den Anhang aus dem temporaryAttachments-Array\n            setTemporaryAttachments(temporaryAttachments.filter((_, i) => i !== index));\n            \n            // Entferne auch den Verweis im Beschreibungstext\n            if (attachmentToRemove.fileName) {\n                // Suche nach Bild- und Link-Markdown mit dem Dateinamen\n                const escapedFileName = attachmentToRemove.fileName.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                const uploadText = t('tasks.createTask.form.uploadAfterCreate');\n                const imagePattern = new RegExp(`!\\\\[${escapedFileName}\\\\]\\\\(${uploadText.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\)`, 'g');\n                const linkPattern = new RegExp(`\\\\[${escapedFileName}\\\\]\\\\(${uploadText.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\)`, 'g');\n                \n                // Bereinige die Beschreibung\n                const newDescription = description\n                    .replace(imagePattern, '')\n                    .replace(linkPattern, '')\n                    // Entferne berschssige Leerzeilen, die durch das Entfernen entstehen knnten\n                    .replace(/\\n{3,}/g, '\\n\\n');\n                \n                setDescription(newDescription);\n            }\n        }\n    };\n\n    const uploadTemporaryAttachments = async (taskId: number) => {\n        if (temporaryAttachments.length === 0) return;\n        \n        try {\n            setLoading(true);\n            \n            // Upload jeder temporren Datei\n            for (const attachment of temporaryAttachments) {\n                if (!attachment.file) continue;\n                \n                const formData = new FormData();\n                formData.append('file', attachment.file);\n                \n                await axiosInstance.post(\n                    API_ENDPOINTS.TASKS.ATTACHMENTS(taskId),\n                    formData,\n                    {\n                        headers: {\n                            'Content-Type': 'multipart/form-data',\n                        },\n                    }\n                );\n            }\n            \n            console.log(`${temporaryAttachments.length} Anhnge erfolgreich hochgeladen.`);\n        } catch (err) {\n            console.error('Fehler beim Hochladen der Anhnge:', err);\n            // Wir zeigen hier keinen Fehler, da der Task bereits erstellt wurde\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n        setLoading(true);\n\n        try {\n            // Validierung\n            if (!title || (!responsibleId && !roleId) || !branchId) {\n                setError(t('tasks.createTask.errors.fillAllFields'));\n                setLoading(false);\n                return;\n            }\n\n            if (responsibleId && roleId) {\n                setError(t('tasks.createTask.errors.chooseUserOrRole'));\n                setLoading(false);\n                return;\n            }\n\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                setLoading(false);\n                return;\n            }\n\n            // Validiere die IDs\n            const branch = Number(branchId);\n            const qualityControl = qualityControlId ? Number(qualityControlId) : null;\n            const responsible = responsibleId ? Number(responsibleId) : null;\n            const role = roleId ? Number(roleId) : null;\n\n            if ((responsibleId && isNaN(responsible!)) || \n                (roleId && isNaN(role!)) || \n                isNaN(branch) || \n                (qualityControlId && isNaN(qualityControl!))) {\n                setError(t('tasks.createTask.errors.invalidIds'));\n                setLoading(false);\n                return;\n            }\n\n            // Basisdaten fr die Anfrage vorbereiten\n            const taskData: any = {\n                title,\n                description,\n                status: 'open',\n                qualityControlId: qualityControl,\n                branchId: branch,\n                dueDate\n            };\n\n            // Nur ein Feld hinzufgen - entweder responsibleId oder roleId, aber nicht beide\n            if (assigneeType === 'user' && responsibleId) {\n                taskData.responsibleId = responsibleId;\n            } else if (assigneeType === 'role' && roleId) {\n                taskData.roleId = roleId;\n            }\n\n            const response = await axiosInstance.post(API_ENDPOINTS.TASKS.BASE, taskData);\n\n            const newTaskId = response.data.id;\n            \n            // Verknpfe Cerebro-Artikel, falls vorhanden\n            if (selectedArticles.length > 0) {\n                await Promise.all(\n                    selectedArticles.map(article => \n                        axiosInstance.post(API_ENDPOINTS.TASKS.LINK_CARTICLE(newTaskId, article.id))\n                    )\n                );\n            }\n            \n            // Lade temporre Anhnge hoch, falls vorhanden\n            await uploadTemporaryAttachments(newTaskId);\n            \n            console.log('Task erfolgreich erstellt:', response.data);\n            // bergebe den neuen Task an den Callback\n            onTaskCreated(response.data);\n            handleClose();\n        } catch (err) {\n            console.error('Fehler beim Erstellen des Tasks:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.error || axiosError.message || t('tasks.createTask.errors.createError'));\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        setTitle('');\n        setDescription('');\n        setAssigneeType('user');\n        setResponsibleId('');\n        setRoleId('');\n        setQualityControlId('');\n        setBranchId('');\n        setDueDate('');\n        setError(null);\n        setSelectedArticles([]);\n        setTemporaryAttachments([]);\n        onClose();\n    };\n\n    const handleAddArticle = (article: CerebroArticle) => {\n        setSelectedArticles(prev => [...prev, article]);\n    };\n    \n    const handleRemoveArticle = (articleId: number) => {\n        setSelectedArticles(prev => prev.filter(a => a.id !== articleId));\n    };\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                                {t('tasks.createTask.title')}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <TaskForm \n                            error={error}\n                            title={title}\n                            setTitle={setTitle}\n                            description={description}\n                            setDescription={setDescription}\n                            assigneeType={assigneeType}\n                            setAssigneeType={setAssigneeType}\n                            responsibleId={responsibleId}\n                            setResponsibleId={setResponsibleId}\n                            roleId={roleId}\n                            setRoleId={setRoleId}\n                            qualityControlId={qualityControlId}\n                            setQualityControlId={setQualityControlId}\n                            branchId={branchId}\n                            setBranchId={setBranchId}\n                            dueDate={dueDate}\n                            setDueDate={setDueDate}\n                            users={users}\n                            roles={roles}\n                            branches={branches}\n                            loading={loading}\n                            handleSubmit={handleSubmit}\n                            handleClose={handleClose}\n                            selectedArticles={selectedArticles}\n                            onArticleSelect={handleAddArticle}\n                            onArticleRemove={handleRemoveArticle}\n                            uploading={uploading}\n                            temporaryAttachments={temporaryAttachments}\n                            onFileUpload={handleFileUpload}\n                            onRemoveAttachment={handleRemoveTemporaryAttachment}\n                            textareaRef={textareaRef}\n                            fileInputRef={fileInputRef}\n                            handlePaste={handlePaste}\n                            handleDrop={handleDrop}\n                            handleDragOver={handleDragOver}\n                        />\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tasks.createTask.title')}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <TaskForm \n                        error={error}\n                        title={title}\n                        setTitle={setTitle}\n                        description={description}\n                        setDescription={setDescription}\n                        assigneeType={assigneeType}\n                        setAssigneeType={setAssigneeType}\n                        responsibleId={responsibleId}\n                        setResponsibleId={setResponsibleId}\n                        roleId={roleId}\n                        setRoleId={setRoleId}\n                        qualityControlId={qualityControlId}\n                        setQualityControlId={setQualityControlId}\n                        branchId={branchId}\n                        setBranchId={setBranchId}\n                        dueDate={dueDate}\n                        setDueDate={setDueDate}\n                        users={users}\n                        roles={roles}\n                        branches={branches}\n                        loading={loading}\n                        handleSubmit={handleSubmit}\n                        handleClose={handleClose}\n                        selectedArticles={selectedArticles}\n                        onArticleSelect={handleAddArticle}\n                        onArticleRemove={handleRemoveArticle}\n                        uploading={uploading}\n                        temporaryAttachments={temporaryAttachments}\n                        onFileUpload={handleFileUpload}\n                        onRemoveAttachment={handleRemoveTemporaryAttachment}\n                        textareaRef={textareaRef}\n                        fileInputRef={fileInputRef}\n                        handlePaste={handlePaste}\n                        handleDrop={handleDrop}\n                        handleDragOver={handleDragOver}\n                    />\n                </div>\n            </div>\n        </>\n    );\n};\n\n// Ausgelagerte Formular-Komponente, um Code-Duplizierung zu vermeiden\ninterface TaskFormProps {\n    error: string | null;\n    title: string;\n    setTitle: (value: string) => void;\n    description: string;\n    setDescription: (value: string) => void;\n    assigneeType: 'user' | 'role';\n    setAssigneeType: (value: 'user' | 'role') => void;\n    responsibleId: number | '';\n    setResponsibleId: (value: number | '') => void;\n    roleId: number | '';\n    setRoleId: (value: number | '') => void;\n    qualityControlId: number | '';\n    setQualityControlId: (value: number | '') => void;\n    branchId: number | '';\n    setBranchId: (value: number | '') => void;\n    dueDate: string;\n    setDueDate: (value: string) => void;\n    users: User[];\n    roles: Role[];\n    branches: Branch[];\n    loading: boolean;\n    handleSubmit: (e: React.FormEvent) => Promise<void>;\n    handleClose: () => void;\n    selectedArticles: CerebroArticle[];\n    onArticleSelect: (article: CerebroArticle) => void;\n    onArticleRemove: (articleId: number) => void;\n    uploading?: boolean;\n    temporaryAttachments?: TaskAttachment[];\n    onFileUpload?: (event: React.ChangeEvent<HTMLInputElement>) => Promise<void>;\n    onRemoveAttachment?: (index: number) => void;\n    textareaRef?: React.RefObject<HTMLTextAreaElement>;\n    fileInputRef?: React.RefObject<HTMLInputElement>;\n    handlePaste?: (event: React.ClipboardEvent) => Promise<void>;\n    handleDrop?: (event: React.DragEvent) => Promise<void>;\n    handleDragOver?: (event: React.DragEvent) => void;\n}\n\nconst TaskForm: React.FC<TaskFormProps> = ({\n    error,\n    title,\n    setTitle,\n    description,\n    setDescription,\n    assigneeType,\n    setAssigneeType,\n    responsibleId,\n    setResponsibleId,\n    roleId,\n    setRoleId,\n    qualityControlId,\n    setQualityControlId,\n    branchId,\n    setBranchId,\n    dueDate,\n    setDueDate,\n    users,\n    roles,\n    branches,\n    loading,\n    handleSubmit,\n    handleClose,\n    selectedArticles,\n    onArticleSelect,\n    onArticleRemove,\n    uploading = false,\n    temporaryAttachments = [],\n    onFileUpload,\n    onRemoveAttachment,\n    textareaRef,\n    fileInputRef,\n    handlePaste,\n    handleDrop,\n    handleDragOver,\n}) => {\n    const { t } = useTranslation();\n    const [activeTab, setActiveTab] = useState<'data' | 'cerebro'>('data');\n    \n    return (\n        <form onSubmit={handleSubmit} className=\"space-y-4\" noValidate>\n            {error && (\n                <div className=\"bg-red-100 dark:bg-red-900 border-l-4 border-red-500 dark:border-red-700 text-red-700 dark:text-red-300 p-4 mb-4\">\n                    <p>{error}</p>\n                </div>\n            )}\n\n            {/* Tabs Navigation */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n                <nav className=\"-mb-px flex space-x-4\" aria-label=\"Tabs\">\n                    <button\n                        type=\"button\"\n                        className={`${\n                            activeTab === 'data'\n                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600'\n                        } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                        onClick={() => setActiveTab('data')}\n                    >\n                        Daten\n                    </button>\n                    <button\n                        type=\"button\"\n                        className={`${\n                            activeTab === 'cerebro'\n                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600'\n                        } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                        onClick={() => setActiveTab('cerebro')}\n                    >\n                        Cerebro Artikel\n                    </button>\n                </nav>\n            </div>\n\n            {/* Data Tab Content */}\n            {activeTab === 'data' && (\n                <>\n                    <div>\n                        <label htmlFor=\"title\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.title')} *\n                        </label>\n                        <input\n                            type=\"text\"\n                            id=\"title\"\n                            value={title}\n                            onChange={(e) => setTitle(e.target.value)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                            required\n                        />\n                    </div>\n\n                    <div className=\"space-y-4\">\n                        <div>\n                            <label htmlFor=\"description_sidepane\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.createTask.form.description')}\n                            </label>\n                            <div className=\"relative\">\n                                <textarea\n                                    ref={textareaRef}\n                                    id=\"description_task_create\"\n                                    rows={6}\n                                    className=\"block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm\"\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    onPaste={handlePaste}\n                                    onDrop={handleDrop}\n                                    onDragOver={handleDragOver}\n                                    placeholder={t('tasks.createTask.form.descriptionPlaceholder')}\n                                />\n                                {/* Heftklammer-Icon zum Hinzufgen von Dateien */}\n                                <div className=\"relative group absolute bottom-2 left-2\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => fileInputRef?.current?.click()}\n                                        className=\"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400 focus:outline-none\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\" />\n                                        </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tasks.createTask.form.fileUpload')}\n                                    </div>\n                                </div>\n                                <input\n                                    ref={fileInputRef}\n                                    type=\"file\"\n                                    onChange={onFileUpload}\n                                    className=\"hidden\"\n                                />\n                                {uploading && (\n                                    <div className=\"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-70 dark:bg-opacity-70\">\n                                        <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('tasks.createTask.form.uploading')}</span>\n                                    </div>\n                                )}\n                            </div>\n                            {/* Anzeige der temporren Anhnge direkt unter dem Textfeld */}\n                            {temporaryAttachments && temporaryAttachments.length > 0 && (\n                                <div className=\"mt-2\">\n                                    <ul className=\"flex flex-wrap gap-2\">\n                                        {temporaryAttachments.map((attachment, index) => (\n                                            <li key={index} className=\"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-md px-2 py-1 relative group\">\n                                                <span className=\"text-sm font-medium text-gray-800 dark:text-gray-300\">\n                                                    {attachment.fileName}\n                                                </span>\n                                                <div className=\"flex ml-2\">\n                                                    <div className=\"relative group ml-1\">\n                                                        <button\n                                                            type=\"button\"\n                                                            onClick={() => onRemoveAttachment?.(index)}\n                                                            className=\"text-red-600 hover:text-red-900\"\n                                                        >\n                                                            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                                                            </svg>\n                                                        </button>\n                                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                            {t('tasks.createTask.form.remove')}\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                                {/* Tooltip fr Bildvorschau bei Bild-Dateien */}\n                                                {attachment.fileType.startsWith('image/') && attachment.file && (\n                                                    <div className=\"absolute z-10 bg-white dark:bg-gray-800 p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 dark:border-gray-700 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                                        <img \n                                                            src={URL.createObjectURL(attachment.file)}\n                                                            alt={attachment.fileName}\n                                                            className=\"max-w-[200px] max-h-[150px] object-contain\"\n                                                        />\n                                                    </div>\n                                                )}\n                                            </li>\n                                        ))}\n                                    </ul>\n                                </div>\n                            )}\n                        </div>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.responsibleFor')} *\n                        </label>\n                        <div className=\"flex space-x-4\">\n                            <label className=\"inline-flex items-center\">\n                                <input\n                                    type=\"radio\"\n                                    className=\"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600\"\n                                    name=\"assigneeType\"\n                                    value=\"user\"\n                                    checked={assigneeType === 'user'}\n                                    onChange={() => {\n                                        setAssigneeType('user');\n                                        setRoleId('');\n                                    }}\n                                />\n                                <span className=\"ml-2 dark:text-gray-300\">{t('tasks.createTask.form.user')}</span>\n                            </label>\n                            <label className=\"inline-flex items-center\">\n                                <input\n                                    type=\"radio\"\n                                    className=\"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600\"\n                                    name=\"assigneeType\"\n                                    value=\"role\"\n                                    checked={assigneeType === 'role'}\n                                    onChange={() => {\n                                        setAssigneeType('role');\n                                        setResponsibleId('');\n                                    }}\n                                />\n                                <span className=\"ml-2 dark:text-gray-300\">{t('tasks.createTask.form.role')}</span>\n                            </label>\n                        </div>\n                    </div>\n\n                    {assigneeType === 'user' ? (\n                        <div>\n                            <label htmlFor=\"responsible\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.createTask.form.responsibleUser')} *\n                            </label>\n                            <select\n                                id=\"responsible\"\n                                value={responsibleId}\n                                onChange={(e) => setResponsibleId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                required\n                            >\n                                <option value=\"\">{t('tasks.createTask.form.pleaseSelect')}</option>\n                                {Array.isArray(users) && users.map(user => (\n                                    <option key={user.id} value={user.id}>\n                                        {user.firstName} {user.lastName}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n                    ) : (\n                        <div>\n                            <label htmlFor=\"role\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.createTask.form.responsibleRole')} *\n                            </label>\n                            <select\n                                id=\"role\"\n                                value={roleId}\n                                onChange={(e) => setRoleId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                required\n                            >\n                                <option value=\"\">{t('tasks.createTask.form.pleaseSelect')}</option>\n                                {Array.isArray(roles) && roles.map(role => (\n                                    <option key={role.id} value={role.id}>\n                                        {role.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n                    )}\n\n                    <div>\n                        <label htmlFor=\"qualityControl\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.qualityControl')}\n                        </label>\n                        <select\n                            id=\"qualityControl\"\n                            value={qualityControlId}\n                            onChange={(e) => setQualityControlId(e.target.value ? Number(e.target.value) : '')}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        >\n                            <option value=\"\">{t('tasks.createTask.form.noQualityControl')}</option>\n                            {Array.isArray(users) && users.map(user => (\n                                <option key={user.id} value={user.id}>\n                                    {user.firstName} {user.lastName}\n                                </option>\n                            ))}\n                        </select>\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"branch\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.branch')} *\n                        </label>\n                        <select\n                            id=\"branch\"\n                            value={branchId}\n                            onChange={(e) => setBranchId(Number(e.target.value))}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                            required\n                        >\n                            <option value=\"\">{t('common.pleaseSelect')}</option>\n                            {Array.isArray(branches) && branches.map(branch => (\n                                <option key={branch.id} value={branch.id}>\n                                    {branch.name}\n                                </option>\n                            ))}\n                        </select>\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"dueDate\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.dueDate')}\n                        </label>\n                        <input\n                            type=\"date\"\n                            id=\"dueDate\"\n                            value={dueDate}\n                            onChange={(e) => setDueDate(e.target.value)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        />\n                    </div>\n                </>\n            )}\n\n            {/* Cerebro Articles Tab Content */}\n            {activeTab === 'cerebro' && (\n                <div>\n                    <div className=\"mb-4\">\n                        <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Verknpfte Cerebro-Artikel</h3>\n                        \n                        {selectedArticles.length > 0 ? (\n                            <ul className=\"mt-2 space-y-2\">\n                                {selectedArticles.map(article => (\n                                    <li key={article.id} className=\"flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 rounded\">\n                                        <span className=\"dark:text-gray-300\">{article.title}</span>\n                                        <button\n                                            type=\"button\"\n                                            onClick={() => onArticleRemove(article.id)}\n                                            className=\"text-red-600 hover:text-red-800\"\n                                        >\n                                            {t('tasks.createTask.form.remove')}\n                                        </button>\n                                    </li>\n                                ))}\n                            </ul>\n                        ) : (\n                            <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">{t('tasks.createTask.form.noArticlesLinked')}</p>\n                        )}\n                    </div>\n                    \n                    <CerebroArticleSelector\n                        onArticleSelected={onArticleSelect}\n                        excludeArticleIds={selectedArticles.map(a => a.id)}\n                        selectedArticles={selectedArticles}\n                        onArticleRemove={onArticleRemove}\n                    />\n                </div>\n            )}\n\n            <div className=\"flex justify-end gap-3 pt-4\">\n                <div className=\"relative group\">\n                    <button\n                        type=\"button\"\n                        onClick={handleClose}\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                    >\n                        <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.createTask.form.cancel')}\n                    </div>\n                </div>\n                <div className=\"relative group\">\n                    <button\n                        type=\"submit\"\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                        disabled={loading}\n                    >\n                        {loading ? (\n                            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                        ) : (\n                            <CheckIcon className=\"h-5 w-5\" />\n                        )}\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {loading ? t('tasks.createTask.form.creating') : t('tasks.createTask.form.create')}\n                    </div>\n                </div>\n            </div>\n        </form>\n    );\n};\n\nexport default CreateTaskModal; ","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { ClipboardDocumentIcon } from '@heroicons/react/24/outline';\r\nimport useMessage from '../hooks/useMessage.ts';\r\n\r\ninterface Task {\r\n  id: number;\r\n  title: string;\r\n  description: string | null;\r\n  [key: string]: any;\r\n}\r\n\r\ninterface TaskDataBoxProps {\r\n  task: Task;\r\n}\r\n\r\nconst TaskDataBox: React.FC<TaskDataBoxProps> = ({ task }) => {\r\n  const { t } = useTranslation();\r\n  const { showMessage } = useMessage();\r\n\r\n  // Extrahiere automatisch generierte Daten aus task.description oder task.metadata\r\n  // Prfe ob Task ein Lebenszyklus-Task ist\r\n  const isLifecycleTask = task.title?.includes('ARL') || \r\n                          task.title?.includes('EPS') || \r\n                          task.title?.includes('Pension') || \r\n                          task.title?.includes('Caja') ||\r\n                          task.description?.includes('lifecycle');\r\n\r\n  // Versuche Daten aus description zu extrahieren (JSON-Format)\r\n  let autoGeneratedData: Record<string, any> = {};\r\n  \r\n  if (task.description) {\r\n    try {\r\n      // Versuche JSON aus description zu extrahieren\r\n      const jsonMatch = task.description.match(/\\{[\\s\\S]*\\}/);\r\n      if (jsonMatch) {\r\n        autoGeneratedData = JSON.parse(jsonMatch[0]);\r\n      }\r\n    } catch (e) {\r\n      // Kein JSON gefunden, versuche strukturierte Daten zu extrahieren\r\n      const lines = task.description.split('\\n');\r\n      lines.forEach(line => {\r\n        const match = line.match(/([^:]+):\\s*(.+)/);\r\n        if (match) {\r\n          const key = match[1].trim();\r\n          const value = match[2].trim();\r\n          autoGeneratedData[key] = value;\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  // Wenn keine Daten gefunden wurden und es ein Lebenszyklus-Task ist, zeige Standard-Daten\r\n  if (Object.keys(autoGeneratedData).length === 0 && isLifecycleTask) {\r\n    autoGeneratedData = {\r\n      taskType: task.title,\r\n      description: task.description || t('lifecycle.noDataAvailable')\r\n    };\r\n  }\r\n\r\n  const handleCopyData = async () => {\r\n    try {\r\n      const dataString = JSON.stringify(autoGeneratedData, null, 2);\r\n      await navigator.clipboard.writeText(dataString);\r\n      showMessage(t('lifecycle.dataCopied', { defaultValue: 'Daten in Zwischenablage kopiert' }), 'success');\r\n    } catch (error) {\r\n      console.error('Fehler beim Kopieren:', error);\r\n      showMessage(t('lifecycle.copyError', { defaultValue: 'Fehler beim Kopieren' }), 'error');\r\n    }\r\n  };\r\n\r\n  // Zeige Box nur wenn es ein Lebenszyklus-Task ist oder Daten vorhanden sind\r\n  if (!isLifecycleTask && Object.keys(autoGeneratedData).length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-4\">\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <h3 className=\"text-lg font-semibold flex items-center dark:text-white\">\r\n          <ClipboardDocumentIcon className=\"h-5 w-5 mr-2\" />\r\n          {t('lifecycle.autoGeneratedData', { defaultValue: 'Automatisch generierte Daten' })}\r\n        </h3>\r\n        <button\r\n          onClick={handleCopyData}\r\n          className=\"text-blue-600 dark:text-blue-400 hover:underline text-sm\"\r\n        >\r\n          {t('lifecycle.copyData', { defaultValue: 'Daten kopieren' })}\r\n        </button>\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        {Object.keys(autoGeneratedData).length > 0 ? (\r\n          Object.entries(autoGeneratedData).map(([key, value]) => (\r\n            <div key={key} className=\"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2\">\r\n              <span className=\"font-medium w-full sm:w-1/3 dark:text-gray-300\">\r\n                {t(`lifecycle.${key}`) || key}:\r\n              </span>\r\n              <span className=\"text-gray-600 dark:text-gray-400 flex-1 break-words\">\r\n                {typeof value === 'object' ? JSON.stringify(value, null, 2) : String(value)}\r\n              </span>\r\n            </div>\r\n          ))\r\n        ) : (\r\n          <div className=\"text-gray-500 dark:text-gray-400 text-sm\">\r\n            {t('lifecycle.noDataAvailable', { defaultValue: 'Keine automatisch generierten Daten verfgbar' })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TaskDataBox;\r\n\r\n","import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { EnvelopeIcon, PaperAirplaneIcon, ArrowPathIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Task {\n  id: number;\n  title: string;\n  description: string | null;\n  [key: string]: any;\n}\n\ninterface EmailTemplateBoxProps {\n  task: Task;\n}\n\nconst EmailTemplateBox: React.FC<EmailTemplateBoxProps> = ({ task }) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [emailTemplate, setEmailTemplate] = useState<string>('');\n  const [loading, setLoading] = useState(false);\n  const [emailSent, setEmailSent] = useState(false);\n  const [generating, setGenerating] = useState(false);\n\n  // Prfe ob Task ein Lebenszyklus-Task ist\n  const isLifecycleTask = task.title?.includes('ARL') || \n                          task.title?.includes('EPS') || \n                          task.title?.includes('Pension') || \n                          task.title?.includes('Caja') ||\n                          task.description?.includes('lifecycle');\n\n  // Zeige Box nur wenn es ein Lebenszyklus-Task ist\n  if (!isLifecycleTask) {\n    return null;\n  }\n\n  const handleGenerateTemplate = async () => {\n    setGenerating(true);\n    try {\n      // API-Call zum Generieren der Email-Vorlage\n      // TODO: Endpoint implementieren wenn Backend bereit ist\n      // const response = await axiosInstance.post(`/api/tasks/${task.id}/generate-email`);\n      // setEmailTemplate(response.data.template);\n      \n      // Temporr: Generiere einfache Vorlage basierend auf Task-Daten\n      const template = `Sehr geehrte Damen und Herren,\n\nim Rahmen des Onboarding-Prozesses bentigen wir die Anmeldung fr ${task.title}.\n\nBitte senden Sie uns die erforderlichen Informationen zurck.\n\nMit freundlichen Gren\nIhr Team`;\n      \n      setEmailTemplate(template);\n      showMessage(t('lifecycle.templateGenerated', { defaultValue: 'Email-Vorlage generiert' }), 'success');\n    } catch (error: any) {\n      console.error('Fehler beim Generieren der Email-Vorlage:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.templateGenerationError', { defaultValue: 'Fehler beim Generieren der Vorlage' }),\n        'error'\n      );\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const handleSendEmail = async () => {\n    if (!emailTemplate.trim()) {\n      showMessage(t('lifecycle.templateRequired', { defaultValue: 'Bitte generieren Sie zuerst eine Vorlage' }), 'warning');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      // API-Call zum Versenden der Email\n      // TODO: Endpoint implementieren wenn Backend bereit ist\n      // await axiosInstance.post(`/api/tasks/${task.id}/send-email`, {\n      //   template: emailTemplate\n      // });\n      \n      // Temporr: Simuliere Versand\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      setEmailSent(true);\n      showMessage(t('lifecycle.emailSent', { defaultValue: 'Email erfolgreich versendet' }), 'success');\n    } catch (error: any) {\n      console.error('Fehler beim Versenden der Email:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.emailSendError', { defaultValue: 'Fehler beim Versenden der Email' }),\n        'error'\n      );\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-4\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold flex items-center dark:text-white\">\n          <EnvelopeIcon className=\"h-5 w-5 mr-2\" />\n          {t('lifecycle.emailTemplate', { defaultValue: 'Email-Vorlage' })}\n        </h3>\n        <button\n          onClick={handleGenerateTemplate}\n          disabled={generating}\n          className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center text-sm\"\n        >\n          {generating ? (\n            <>\n              <ArrowPathIcon className=\"h-4 w-4 mr-2 animate-spin\" />\n              {t('common.generating', { defaultValue: 'Generiere...' })}\n            </>\n          ) : (\n            t('lifecycle.generateTemplate', { defaultValue: 'Vorlage generieren' })\n          )}\n        </button>\n      </div>\n      \n      {emailTemplate && (\n        <div className=\"space-y-4\">\n          <textarea\n            value={emailTemplate}\n            onChange={(e) => {\n              setEmailTemplate(e.target.value);\n              setEmailSent(false);\n            }}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            rows={10}\n            placeholder={t('lifecycle.templatePlaceholder', { defaultValue: 'Email-Vorlage wird hier angezeigt...' })}\n          />\n          <div className=\"flex justify-end\">\n            <button\n              onClick={handleSendEmail}\n              disabled={loading || emailSent}\n              className=\"p-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? t('common.sending', { defaultValue: 'Sende...' }) : emailSent ? t('lifecycle.emailSent', { defaultValue: 'Versendet' }) : t('lifecycle.sendEmail', { defaultValue: 'Email versenden' })}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : emailSent ? (\n                <CheckIcon className=\"h-5 w-5\" />\n              ) : (\n                <PaperAirplaneIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </div>\n      )}\n      \n      {!emailTemplate && (\n        <div className=\"text-gray-500 dark:text-gray-400 text-sm text-center py-4\">\n          {t('lifecycle.noTemplate', { defaultValue: 'Klicken Sie auf \"Vorlage generieren\" um eine Email-Vorlage zu erstellen' })}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default EmailTemplateBox;\n\n","import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Task {\n  id: number;\n  title: string;\n  description: string | null;\n  responsibleId: number | null;\n  [key: string]: any;\n}\n\ninterface SocialSecurityCompletionBoxProps {\n  task: Task;\n  onComplete?: () => void;\n}\n\nconst SocialSecurityCompletionBox: React.FC<SocialSecurityCompletionBoxProps> = ({\n  task,\n  onComplete\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [formData, setFormData] = useState({\n    registrationNumber: '',\n    provider: '',\n    registrationDate: '',\n    notes: ''\n  });\n  const [loading, setLoading] = useState(false);\n\n  // Prfe ob Task ein Lebenszyklus-Task ist\n  const isLifecycleTask = task.title?.includes('ARL') || \n                          task.title?.includes('EPS') || \n                          task.title?.includes('Pension') || \n                          task.title?.includes('Caja') ||\n                          task.description?.includes('lifecycle');\n\n  // Bestimme Typ der Sozialversicherung aus Task-Titel\n  const getSocialSecurityType = (): string | null => {\n    if (task.title?.includes('ARL')) return 'arl';\n    if (task.title?.includes('EPS')) return 'eps';\n    if (task.title?.includes('Pension')) return 'pension';\n    if (task.title?.includes('Caja')) return 'caja';\n    return null;\n  };\n\n  // Zeige Box nur wenn es ein Lebenszyklus-Task ist\n  if (!isLifecycleTask) {\n    return null;\n  }\n\n  const socialSecurityType = getSocialSecurityType();\n\n  // Extrahiere userId aus task (muss aus task.responsibleId oder task.description kommen)\n  // TODO: Backend sollte userId in task-Metadaten bereitstellen\n  const extractUserId = (): number | null => {\n    // Versuche userId aus description zu extrahieren\n    if (task.description) {\n      const userIdMatch = task.description.match(/userId[:\\s]+(\\d+)/i);\n      if (userIdMatch) {\n        return parseInt(userIdMatch[1], 10);\n      }\n    }\n    // Fallback: verwende responsibleId (wenn es der User selbst ist)\n    return task.responsibleId;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    \n    try {\n      const userId = extractUserId();\n      if (!userId || !socialSecurityType) {\n        showMessage(\n          t('lifecycle.missingData', { defaultValue: 'Benutzer-ID oder Sozialversicherungs-Typ fehlt' }),\n          'error'\n        );\n        return;\n      }\n\n      // API-Call zum Abschlieen der Anmeldung\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, socialSecurityType),\n        {\n          status: 'registered',\n          registrationNumber: formData.registrationNumber,\n          provider: formData.provider,\n          registrationDate: formData.registrationDate,\n          notes: formData.notes,\n          completedAt: new Date().toISOString()\n        }\n      );\n\n      showMessage(\n        t('lifecycle.registrationCompleted', { defaultValue: 'Anmeldung erfolgreich abgeschlossen' }),\n        'success'\n      );\n\n      // Formular zurcksetzen\n      setFormData({\n        registrationNumber: '',\n        provider: '',\n        registrationDate: '',\n        notes: ''\n      });\n\n      if (onComplete) {\n        onComplete();\n      }\n    } catch (error: any) {\n      console.error('Fehler beim Abschlieen der Anmeldung:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.registrationError', { defaultValue: 'Fehler beim Abschlieen der Anmeldung' }),\n        'error'\n      );\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-4\">\n      <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">\n        {t('lifecycle.completeRegistration', { defaultValue: 'Anmeldung abschlieen' })}\n      </h3>\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('lifecycle.registrationNumber', { defaultValue: 'Registrierungsnummer' })} *\n          </label>\n          <input\n            type=\"text\"\n            value={formData.registrationNumber}\n            onChange={(e) => setFormData({ ...formData, registrationNumber: e.target.value })}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n            placeholder={t('lifecycle.registrationNumberPlaceholder', { defaultValue: 'z.B. 123456789' })}\n          />\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('lifecycle.provider', { defaultValue: 'Anbieter' })} *\n          </label>\n          <input\n            type=\"text\"\n            value={formData.provider}\n            onChange={(e) => setFormData({ ...formData, provider: e.target.value })}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n            placeholder={t('lifecycle.providerPlaceholder', { defaultValue: 'z.B. ARL Sura, EPS Sanitas' })}\n          />\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('lifecycle.registrationDate', { defaultValue: 'Anmeldedatum' })} *\n          </label>\n          <input\n            type=\"date\"\n            value={formData.registrationDate}\n            onChange={(e) => setFormData({ ...formData, registrationDate: e.target.value })}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n          />\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('lifecycle.notes', { defaultValue: 'Notizen' })}\n          </label>\n          <textarea\n            value={formData.notes}\n            onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            rows={3}\n            placeholder={t('lifecycle.notesPlaceholder', { defaultValue: 'Zustzliche Informationen...' })}\n          />\n        </div>\n        <div className=\"flex justify-end\">\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"p-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n            title={loading ? t('common.saving', { defaultValue: 'Speichere...' }) : t('lifecycle.complete', { defaultValue: 'Abschlieen' })}\n          >\n            {loading ? (\n              <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n            ) : (\n              <CheckIcon className=\"h-5 w-5\" />\n            )}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default SocialSecurityCompletionBox;\n\n","import React, { useEffect, useState, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS, getTaskAttachmentUrl } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport CerebroArticleSelector from './CerebroArticleSelector.tsx';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, TrashIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport MarkdownPreview from './MarkdownPreview.tsx';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport TaskDataBox from './TaskDataBox.tsx';\nimport EmailTemplateBox from './EmailTemplateBox.tsx';\nimport SocialSecurityCompletionBox from './SocialSecurityCompletionBox.tsx';\n\ninterface User {\n    id: number;\n    firstName: string;\n    lastName: string;\n}\n\ninterface Role {\n    id: number;\n    name: string;\n}\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface TaskAttachment {\n    id: number;\n    fileName: string;\n    fileType: string;\n    fileSize: number;\n    filePath: string;\n    uploadedAt: string;\n    file?: File;\n}\n\ninterface CerebroArticle {\n    id: number;\n    title: string;\n    slug: string;\n    content?: string;\n}\n\ninterface Task {\n    id: number;\n    title: string;\n    description: string | null;\n    status: 'open' | 'in_progress' | 'improval' | 'quality_control' | 'done';\n    responsible: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    responsibleId: number | null;\n    role: {\n        id: number;\n        name: string;\n    } | null;\n    roleId: number | null;\n    qualityControl: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    branch: {\n        id: number;\n        name: string;\n    };\n    dueDate: string | null;\n    requestId: number | null;\n    attachments?: TaskAttachment[];\n}\n\ninterface EditTaskModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTaskUpdated: (updatedTask: Task) => void;\n    task: Task;\n}\n\nconst EditTaskModal: React.FC<EditTaskModalProps> = ({ isOpen, onClose, onTaskUpdated, task }) => {\n    const { t } = useTranslation();\n    const { hasPermission } = usePermissions();\n    const { user } = useAuth();\n    const { openSidepane, closeSidepane } = useSidepane();\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    // Entferne Bild-Markdown-Links aus der Beschreibung (fr Textarea-Anzeige)\n    const removeImageMarkdown = (text: string): string => {\n        if (!text) return '';\n        // Entferne alle Bild-Markdown-Links: ![alt](url)\n        return text.replace(/!\\[([^\\]]*)\\]\\([^)]+\\)/g, '').trim();\n    };\n    \n    const [title, setTitle] = useState(task.title || '');\n    const [description, setDescription] = useState(removeImageMarkdown(task.description || ''));\n    // Speichere die originale Beschreibung (mit Bildern) fr das Speichern\n    const originalDescription = task.description || '';\n    const [status, setStatus] = useState(task.status || 'open');\n    const [assigneeType, setAssigneeType] = useState<'user' | 'role'>(task.roleId ? 'role' : 'user');\n    const [responsibleId, setResponsibleId] = useState<number | null>(task.responsibleId || null);\n    const [roleId, setRoleId] = useState<number | null>(task.roleId || null);\n    const [qualityControlId, setQualityControlId] = useState<number | null>(task.qualityControl?.id || null);\n    const [branchId, setBranchId] = useState<number>(task.branch?.id || 0);\n    const [attachments, setAttachments] = useState<TaskAttachment[]>(task.attachments || []);\n    const [temporaryAttachments, setTemporaryAttachments] = useState<TaskAttachment[]>([]);\n    const [uploading, setUploading] = useState(false);\n    // Liste der whrend der Bearbeitung hochgeladenen Attachments (fr Cleanup bei Abbrechen)\n    const [uploadedDuringEdit, setUploadedDuringEdit] = useState<number[]>([]);\n    const fileInputRef = useRef<HTMLInputElement>(null);\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n    // Formatiere das Datum im Format YYYY-MM-DD fr das HTML-Datumseingabefeld\n    const formatDate = (dateString: string | null): string | null => {\n        if (!dateString) return null;\n        \n        // Versuche das Datum zu parsen\n        const date = new Date(dateString);\n        if (isNaN(date.getTime())) return null; // Ungltiges Datum\n        \n        // Formatiere als YYYY-MM-DD\n        return date.toISOString().split('T')[0];\n    };\n\n    const [dueDate, setDueDate] = useState<string | null>(formatDate(task.dueDate));\n    const [users, setUsers] = useState<User[]>([]);\n    const [roles, setRoles] = useState<Role[]>([]);\n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [confirmDelete, setConfirmDelete] = useState(false);\n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [linkedArticles, setLinkedArticles] = useState<CerebroArticle[]>([]);\n    const [activeTab, setActiveTab] = useState<'data' | 'cerebro'>('data');\n\n    const canDeleteTask = hasPermission('tasks', 'both', 'table');\n\n    // Responsive Design: berwache Fensterbreite\n    useEffect(() => {\n        const handleResize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        window.addEventListener('resize', handleResize);\n        return () => window.removeEventListener('resize', handleResize);\n    }, []);\n\n    // Cleanup: Lsche hochgeladene Attachments wenn Modal ohne Speichern geschlossen wird\n    useEffect(() => {\n        if (!isOpen && uploadedDuringEdit.length > 0) {\n            // Modal wurde geschlossen - lsche alle whrend der Bearbeitung hochgeladenen Attachments\n            const cleanup = async () => {\n                for (const attachmentId of uploadedDuringEdit) {\n                    try {\n                        await axiosInstance.delete(API_ENDPOINTS.TASKS.ATTACHMENT(task.id, attachmentId));\n                        console.log(`Task Attachment ${attachmentId} gelscht (Modal ohne Speichern geschlossen)`);\n                    } catch (err) {\n                        console.error(`Fehler beim Lschen von Task Attachment ${attachmentId}:`, err);\n                    }\n                }\n                setUploadedDuringEdit([]);\n            };\n            cleanup();\n        }\n    }, [isOpen, uploadedDuringEdit, task.id]);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    useEffect(() => {\n        if (isOpen) {\n            fetchUsers();\n            fetchRoles();\n            fetchBranches();\n            fetchLinkedArticles();\n            fetchAttachments();\n        }\n    }, [isOpen, task.id]);\n\n    const fetchUsers = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.USERS.DROPDOWN);\n            setUsers(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Benutzer:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.editTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.editTask.errors.loadUsersError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchRoles = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.ROLES.BASE);\n            setRoles(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Rollen:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.editTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.editTask.errors.loadRolesError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchBranches = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n            setBranches(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Niederlassungen:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.editTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.editTask.errors.loadBranchesError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchLinkedArticles = async () => {\n        try {\n            setError(null);\n            const response = await axiosInstance.get(API_ENDPOINTS.TASKS.CARTICLES(task.id));\n            setLinkedArticles(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der verknpften Artikel:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const fetchAttachments = async () => {\n        try {\n            setError(null);\n            const response = await axiosInstance.get(API_ENDPOINTS.TASKS.ATTACHMENTS(task.id));\n            setAttachments(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Anhnge:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n            setAttachments([]);\n        }\n    };\n\n    const handlePaste = async (event: React.ClipboardEvent) => {\n        const items = event.clipboardData.items;\n        \n        for (let i = 0; i < items.length; i++) {\n            const item = items[i];\n            \n            // Prfen, ob das eingefgte Element ein Bild ist\n            if (item.type.indexOf('image') === 0) {\n                event.preventDefault(); // Standardeingabe verhindern\n                \n                const file = item.getAsFile();\n                if (file) {\n                    await uploadFileAndInsertLink(file);\n                }\n                return;\n            }\n        }\n    };\n\n    const handleDrop = async (event: React.DragEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n        \n        if (event.dataTransfer.files && event.dataTransfer.files.length > 0) {\n            const file = event.dataTransfer.files[0];\n            await uploadFileAndInsertLink(file);\n        }\n    };\n\n    const handleDragOver = (event: React.DragEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    const uploadFileAndInsertLink = async (file: File) => {\n        setUploading(true);\n        setError(null);\n\n        try {\n            const formData = new FormData();\n            formData.append('file', file);\n\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.TASKS.ATTACHMENTS(task.id),\n                formData,\n                {\n                    headers: {\n                        'Content-Type': 'multipart/form-data',\n                    },\n                }\n            );\n\n            const newAttachment = response.data;\n            setAttachments([...attachments, newAttachment]);\n            // Merke diese Attachment-ID fr mgliches Cleanup\n            setUploadedDuringEdit(prev => [...prev, newAttachment.id]);\n\n            // Fr Bilder: KEIN Markdown-Link ins Textarea einfgen (wird beim Speichern automatisch hinzugefgt)\n            // Fr andere Dateien: Link ins Textarea einfgen\n            if (!newAttachment.fileType.startsWith('image/')) {\n                const insertText = `\\n[${newAttachment.fileName}](${getTaskAttachmentUrl(task.id, newAttachment.id)})\\n`;\n                \n                // Fge den Link an der aktuellen Cursorposition ein\n                if (textareaRef.current) {\n                    const cursorPos = textareaRef.current.selectionStart;\n                    const textBefore = description.substring(0, cursorPos);\n                    const textAfter = description.substring(cursorPos);\n                    \n                    setDescription(textBefore + insertText + textAfter);\n                    \n                    // Setze den Cursor hinter den eingefgten Link\n                    setTimeout(() => {\n                        if (textareaRef.current) {\n                            const newPos = cursorPos + insertText.length;\n                            textareaRef.current.selectionStart = newPos;\n                            textareaRef.current.selectionEnd = newPos;\n                            textareaRef.current.focus();\n                        }\n                    }, 0);\n                } else {\n                    setDescription(description + insertText);\n                }\n            }\n        } catch (err) {\n            console.error('Fehler beim Verarbeiten der Datei:', err);\n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        } finally {\n            setUploading(false);\n        }\n    };\n\n    const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n        const files = event.target.files;\n        if (!files || files.length === 0) return;\n\n        const file = files[0];\n        await uploadFileAndInsertLink(file);\n        \n        // Zurcksetzen des Datei-Inputs\n        if (fileInputRef.current) {\n            fileInputRef.current.value = '';\n        }\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n        setLoading(true);\n\n        try {\n            // Validierung\n            if (!title || !status || !branchId) {\n                setError(t('tasks.editTask.errors.fillAllFields'));\n                setLoading(false);\n                return;\n            }\n\n            // berprfen, ob entweder Benutzer oder Rolle ausgewhlt wurde\n            if (assigneeType === 'user' && !responsibleId) {\n                setError(t('tasks.editTask.form.chooseUser'));\n                setLoading(false);\n                return;\n            }\n            \n            if (assigneeType === 'role' && !roleId) {\n                setError(t('tasks.editTask.form.chooseRole'));\n                setLoading(false);\n                return;\n            }\n\n            // Verwende description (vom Textarea) als Basis\n            // Fge Markdown-Links fr Bilder automatisch hinzu (falls noch nicht vorhanden)\n            let finalDescription = description || ''; // WICHTIG: Verwende description als Basis, nicht originalDescription\n            const imageAttachments = attachments.filter(att => att.fileType?.startsWith('image/') && att.id);\n            \n            // Extrahiere bereits vorhandene Bilder aus originalDescription (falls vorhanden)\n            const existingImagePattern = /!\\[([^\\]]*)\\]\\([^)]+\\)/g;\n            const existingImages: string[] = [];\n            let match;\n            if (originalDescription) {\n                while ((match = existingImagePattern.exec(originalDescription)) !== null) {\n                    existingImages.push(match[0]);\n                }\n            }\n            \n            // Fge alle Bilder hinzu (sowohl neue als auch bereits vorhandene)\n            for (const attachment of imageAttachments) {\n                const imageUrl = getTaskAttachmentUrl(task.id, attachment.id!);\n                const imageMarkdown = `![${attachment.fileName}](${imageUrl})`;\n                \n                // Prfe, ob dieser Bild-Link bereits in der Beschreibung vorhanden ist\n                const escapedFileName = attachment.fileName.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                const imagePattern = new RegExp(`!\\\\[${escapedFileName}\\\\]\\\\([^)]+\\\\)`, 'g');\n                \n                if (!imagePattern.test(finalDescription)) {\n                    // Bild-Link ist noch nicht in der Beschreibung, fge ihn hinzu\n                    finalDescription = finalDescription ? `${finalDescription}\\n${imageMarkdown}` : imageMarkdown;\n                }\n            }\n            \n            // Fge auch bereits vorhandene Bilder hinzu, die nicht in attachments sind (z.B. von anderen Quellen)\n            for (const existingImage of existingImages) {\n                if (!finalDescription.includes(existingImage)) {\n                    finalDescription = finalDescription ? `${finalDescription}\\n${existingImage}` : existingImage;\n                }\n            }\n\n            // Basis-Daten fr die Anfrage\n            const taskData: any = {\n                title,\n                description: finalDescription,\n                status,\n                qualityControlId,\n                branchId,\n                dueDate\n            };\n\n            // Entweder responsibleId oder roleId hinzufgen, nicht beides\n            if (assigneeType === 'user') {\n                taskData.responsibleId = responsibleId;\n                taskData.roleId = null; // Rolle explizit auf null setzen, um sie zu entfernen\n            } else if (assigneeType === 'role') {\n                taskData.roleId = roleId;\n                taskData.responsibleId = null; // Benutzer explizit auf null setzen, um ihn zu entfernen\n            }\n\n            const response = await axiosInstance.put(`${API_ENDPOINTS.TASKS.BASE}/${task.id}`, taskData);\n\n            console.log('Task aktualisiert:', response.data);\n            \n            // Hole den aktualisierten Task vom Server (inkl. Attachments)\n            const updatedTaskResponse = await axiosInstance.get(API_ENDPOINTS.TASKS.BY_ID(task.id));\n            \n            // Attachments sind bereits in der Response enthalten\n            // URL-Generierung fr Attachments hinzufgen\n            if (updatedTaskResponse.data.attachments) {\n                updatedTaskResponse.data.attachments = updatedTaskResponse.data.attachments.map((att: any) => ({\n                    id: att.id,\n                    fileName: att.fileName,\n                    fileType: att.fileType,\n                    fileSize: att.fileSize,\n                    filePath: att.filePath,\n                    uploadedAt: att.uploadedAt,\n                    url: getTaskAttachmentUrl(task.id, att.id)\n                }));\n            } else {\n                updatedTaskResponse.data.attachments = [];\n            }\n            \n            // bergebe den aktualisierten Task an den Callback\n            // Reset uploadedDuringEdit da erfolgreich gespeichert\n            setUploadedDuringEdit([]);\n            onTaskUpdated(updatedTaskResponse.data);\n            onClose();\n        } catch (err) {\n            console.error('Fehler beim Aktualisieren des Tasks:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleDelete = async () => {\n        if (!confirmDelete) {\n            setConfirmDelete(true);\n            return;\n        }\n        \n        try {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n\n            await axiosInstance.delete(API_ENDPOINTS.TASKS.BY_ID(task.id));\n\n            // Beim Lschen wird kein Task zurckgegeben, daher undefined bergeben\n            onTaskUpdated(undefined as any);\n            onClose();\n        } catch (err) {\n            console.error('Delete Error:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleAddArticle = async (article: CerebroArticle) => {\n        try {\n            setError(null);\n            \n            await axiosInstance.post(\n                API_ENDPOINTS.TASKS.LINK_CARTICLE(task.id, article.id)\n            );\n            \n            setLinkedArticles(prev => [...prev, article]);\n        } catch (err) {\n            console.error('Fehler beim Verknpfen des Artikels:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n    \n    const handleRemoveArticle = async (articleId: number) => {\n        try {\n            setError(null);\n            \n            await axiosInstance.delete(\n                API_ENDPOINTS.TASKS.UNLINK_CARTICLE(task.id, articleId)\n            );\n            \n            setLinkedArticles(prev => prev.filter(a => a.id !== articleId));\n        } catch (err) {\n            console.error('Fehler beim Entfernen der Artikelverknpfung:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleDeleteAttachment = async (attachmentId: number) => {\n        try {\n            setError(null);\n            \n            // Finde den zu entfernenden Anhang\n            const attachmentToRemove = attachments.find(a => a.id === attachmentId);\n            \n            if (attachmentToRemove) {\n                await axiosInstance.delete(API_ENDPOINTS.TASKS.ATTACHMENT(task.id, attachmentId));\n                \n                // Entferne den Anhang aus der Liste\n                setAttachments(attachments.filter(attachment => attachment.id !== attachmentId));\n                \n                // Entferne auch die Verweise im Beschreibungstext\n                if (attachmentToRemove.fileName) {\n                    // Erzeuge URL-Muster fr diesen Anhang\n                    const attachmentUrl = getTaskAttachmentUrl(task.id, attachmentId);\n                    const escapedAttachmentUrl = attachmentUrl.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                    \n                    // Suche nach Bild- und Link-Markdown\n                    const imagePattern = new RegExp(`!\\\\[(.*?)\\\\]\\\\(${escapedAttachmentUrl}\\\\)`, 'g');\n                    const linkPattern = new RegExp(`\\\\[(.*?)\\\\]\\\\(${escapedAttachmentUrl}\\\\)`, 'g');\n                    \n                    // Bereinige die Beschreibung\n                    const newDescription = description\n                        .replace(imagePattern, '')\n                        .replace(linkPattern, '')\n                        // Entferne berschssige Leerzeilen, die durch das Entfernen entstehen knnten\n                        .replace(/\\n{3,}/g, '\\n\\n');\n                    \n                    setDescription(newDescription);\n                }\n            }\n        } catch (err) {\n            console.error('Fehler beim Lschen des Anhangs:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleDownloadAttachment = async (attachment: TaskAttachment) => {\n        try {\n            const response = await axiosInstance.get(\n                API_ENDPOINTS.TASKS.ATTACHMENT(task.id, attachment.id),\n                { responseType: 'blob' }\n            );\n            \n            // Blob-URL erstellen und Download auslsen\n            const url = window.URL.createObjectURL(new Blob([response.data]));\n            const link = document.createElement('a');\n            link.href = url;\n            link.setAttribute('download', attachment.fileName);\n            document.body.appendChild(link);\n            link.click();\n            link.remove();\n        } catch (err) {\n            console.error('Fehler beim Herunterladen des Anhangs:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleRemoveTemporaryAttachment = (index: number) => {\n        // Finde den zu entfernenden Anhang\n        const attachmentToRemove = temporaryAttachments[index];\n        \n        if (attachmentToRemove) {\n            // Entferne den Anhang aus dem temporaryAttachments-Array\n            setTemporaryAttachments(temporaryAttachments.filter((_, i) => i !== index));\n            \n            // Entferne auch den Verweis im Beschreibungstext\n            if (attachmentToRemove.fileName) {\n                // Suche nach Bild- und Link-Markdown mit dem Dateinamen\n                const escapedFileName = attachmentToRemove.fileName.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                const uploadText = t('tasks.editTask.form.uploadAfterCreate');\n                const imagePattern = new RegExp(`!\\\\[${escapedFileName}\\\\]\\\\(${uploadText.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\)`, 'g');\n                const linkPattern = new RegExp(`\\\\[${escapedFileName}\\\\]\\\\(${uploadText.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\)`, 'g');\n                \n                // Bereinige die Beschreibung\n                const newDescription = description\n                    .replace(imagePattern, '')\n                    .replace(linkPattern, '')\n                    // Entferne berschssige Leerzeilen, die durch das Entfernen entstehen knnten\n                    .replace(/\\n{3,}/g, '\\n\\n');\n                \n                setDescription(newDescription);\n            }\n        }\n    };\n\n    const renderForm = () => (\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Tabs Navigation */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n                <nav className=\"-mb-px flex space-x-4\" aria-label=\"Tabs\">\n                    <button\n                        type=\"button\"\n                        className={`${\n                            activeTab === 'data'\n                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600'\n                        } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                        onClick={() => setActiveTab('data')}\n                    >\n                        {t('tasks.editTask.tabs.data')}\n                    </button>\n                    <button\n                        type=\"button\"\n                        className={`${\n                            activeTab === 'cerebro'\n                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600'\n                        } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                        onClick={() => setActiveTab('cerebro')}\n                    >\n                        {t('tasks.editTask.tabs.cerebro')}\n                    </button>\n                </nav>\n            </div>\n\n            {/* Data Tab Content */}\n            {activeTab === 'data' && (\n                <>\n                    <div>\n                        <label htmlFor=\"title\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.title')}\n                        </label>\n                        <input\n                            type=\"text\"\n                            id=\"title\"\n                            value={title}\n                            onChange={(e) => setTitle(e.target.value)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                            required\n                        />\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"description_edit\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.description')}\n                        </label>\n                        <div className=\"relative\">\n                            <textarea\n                                ref={textareaRef}\n                                id=\"description_edit\"\n                                rows={6}\n                                className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                value={description}\n                                onChange={(e) => setDescription(e.target.value)}\n                                onPaste={handlePaste}\n                                onDrop={handleDrop}\n                                onDragOver={handleDragOver}\n                                placeholder={t('tasks.editTask.form.descriptionPlaceholder')}\n                            />\n                            <div className=\"relative group absolute bottom-2 left-2\">\n                                <button\n                                    type=\"button\"\n                                    onClick={() => fileInputRef.current?.click()}\n                                    className=\"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400 focus:outline-none\"\n                                >\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\" />\n                                    </svg>\n                                </button>\n                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                    {t('tasks.editTask.form.fileUpload')}\n                                </div>\n                            </div>\n                            <input\n                                ref={fileInputRef}\n                                type=\"file\"\n                                onChange={handleFileUpload}\n                                className=\"hidden\"\n                            />\n                            {uploading && (\n                                <div className=\"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-70 dark:bg-opacity-70\">\n                                    <span className=\"text-sm text-gray-600 dark:text-gray-300\">{t('tasks.editTask.form.uploading')}</span>\n                                </div>\n                            )}\n                        </div>\n                        {renderAttachments()}\n                        {renderTemporaryAttachments()}\n                        {/* Bilder werden bereits im Textarea als Markdown angezeigt und in der Card durch MarkdownPreview mit showImagePreview={true} */}\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"status\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.status')}\n                        </label>\n                        <select\n                            id=\"status\"\n                            value={status}\n                            onChange={(e) => setStatus(e.target.value as Task['status'])}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        >\n                            <option value=\"open\">{t('tasks.status.open')}</option>\n                            <option value=\"in_progress\">{t('tasks.status.in_progress')}</option>\n                            <option value=\"improval\">{t('tasks.status.improval')}</option>\n                            <option value=\"quality_control\">{t('tasks.status.quality_control')}</option>\n                            <option value=\"done\">{t('tasks.status.done')}</option>\n                        </select>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.responsibleFor')} *\n                        </label>\n                        <div className=\"flex space-x-4\">\n                            <label className=\"inline-flex items-center\">\n                                <input\n                                    type=\"radio\"\n                                    className=\"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600\"\n                                    name=\"assigneeType\"\n                                    value=\"user\"\n                                    checked={assigneeType === 'user'}\n                                    onChange={() => {\n                                        setAssigneeType('user');\n                                        setRoleId(null);\n                                    }}\n                                />\n                                <span className=\"ml-2 dark:text-gray-300\">{t('tasks.editTask.form.user')}</span>\n                            </label>\n                            <label className=\"inline-flex items-center\">\n                                <input\n                                    type=\"radio\"\n                                    className=\"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600\"\n                                    name=\"assigneeType\"\n                                    value=\"role\"\n                                    checked={assigneeType === 'role'}\n                                    onChange={() => {\n                                        setAssigneeType('role');\n                                        setResponsibleId(null);\n                                    }}\n                                />\n                                <span className=\"ml-2 dark:text-gray-300\">{t('tasks.editTask.form.role')}</span>\n                            </label>\n                        </div>\n                    </div>\n\n                    {assigneeType === 'user' ? (\n                        <div>\n                            <label htmlFor=\"responsible\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.editTask.form.responsibleUser')} *\n                            </label>\n                            <select\n                                id=\"responsible\"\n                                value={responsibleId === null ? '' : responsibleId}\n                                onChange={(e) => setResponsibleId(e.target.value ? Number(e.target.value) : null)}\n                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                required={assigneeType === 'user'}\n                            >\n                                <option value=\"\">{t('tasks.editTask.form.pleaseSelect')}</option>\n                                {Array.isArray(users) && users.map(user => (\n                                    <option key={user.id} value={user.id}>\n                                        {user.firstName} {user.lastName}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n                    ) : (\n                        <div>\n                            <label htmlFor=\"role\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.editTask.form.responsibleRole')} *\n                            </label>\n                            <select\n                                id=\"role\"\n                                value={roleId === null ? '' : roleId}\n                                onChange={(e) => setRoleId(e.target.value ? Number(e.target.value) : null)}\n                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                required={assigneeType === 'role'}\n                            >\n                                <option value=\"\">{t('tasks.editTask.form.pleaseSelect')}</option>\n                                {Array.isArray(roles) && roles.map(role => (\n                                    <option key={role.id} value={role.id}>\n                                        {role.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n                    )}\n\n                    <div>\n                        <label htmlFor=\"qualityControl\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.qualityControl')}\n                        </label>\n                        <select\n                            id=\"qualityControl\"\n                            value={qualityControlId === null ? '' : qualityControlId}\n                            onChange={(e) => setQualityControlId(e.target.value ? Number(e.target.value) : null)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        >\n                            <option value=\"\">{t('tasks.editTask.form.noQualityControl')}</option>\n                            {Array.isArray(users) && users.map(user => (\n                                <option key={user.id} value={user.id}>\n                                    {user.firstName} {user.lastName}\n                                </option>\n                            ))}\n                        </select>\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"branch\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.branch')}\n                        </label>\n                        <select\n                            id=\"branch\"\n                            value={branchId === 0 ? '' : branchId}\n                            onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : 0)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                            required\n                        >\n                            <option value=\"\">{t('common.pleaseSelect')}</option>\n                            {Array.isArray(branches) && branches.map(branch => (\n                                <option key={branch.id} value={branch.id}>\n                                    {branch.name}\n                                </option>\n                            ))}\n                        </select>\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"dueDate\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.dueDate')}\n                        </label>\n                        <input\n                            type=\"date\"\n                            id=\"dueDate\"\n                            value={dueDate || ''}\n                            onChange={(e) => {\n                                // Wenn das Feld leer ist, setze auf null\n                                if (!e.target.value) {\n                                    setDueDate(null);\n                                } else {\n                                    // Ansonsten behalte das Format YYYY-MM-DD bei\n                                    setDueDate(e.target.value);\n                                }\n                            }}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        />\n                    </div>\n                </>\n            )}\n\n            {/* Cerebro Articles Tab Content */}\n            {activeTab === 'cerebro' && (\n                <div>\n                    {linkedArticles.length > 0 && (\n                        <div className=\"mb-4\">\n                            <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('tasks.editTask.form.linkedCerebroArticles')}</h3>\n                            <ul className=\"space-y-2\">\n                                {linkedArticles.map(article => (\n                                    <li key={article.id} className=\"flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 rounded\">\n                                        <a \n                                            href={`/cerebro/articles/${article.slug}`} \n                                            target=\"_blank\" \n                                            rel=\"noopener noreferrer\"\n                                            className=\"text-blue-600 hover:underline dark:text-blue-400 dark:hover:text-blue-300\"\n                                        >\n                                            {article.title}\n                                        </a>\n                                        <button\n                                            type=\"button\"\n                                            onClick={() => handleRemoveArticle(article.id)}\n                                            className=\"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300\"\n                                        >\n                                            {t('tasks.editTask.form.remove')}\n                                        </button>\n                                    </li>\n                                ))}\n                            </ul>\n                        </div>\n                    )}\n\n                    <CerebroArticleSelector \n                        onArticleSelected={handleAddArticle}\n                        excludeArticleIds={linkedArticles.map(a => a.id)}\n                        selectedArticles={linkedArticles}\n                        onArticleRemove={handleRemoveArticle}\n                    />\n                </div>\n            )}\n\n            {/* Lifecycle Task Boxes - nur fr Lebenszyklus-Tasks */}\n            {activeTab === 'data' && (task.title?.includes('ARL') || \n                                      task.title?.includes('EPS') || \n                                      task.title?.includes('Pension') || \n                                      task.title?.includes('Caja') ||\n                                      task.description?.includes('lifecycle')) && (\n                <>\n                    <TaskDataBox task={task} />\n                    <EmailTemplateBox task={task} />\n                    <SocialSecurityCompletionBox \n                        task={task} \n                        onComplete={() => {\n                            // Optional: Task neu laden oder Status aktualisieren\n                            if (onTaskUpdated) {\n                                // Task wird automatisch aktualisiert wenn Modal geschlossen wird\n                            }\n                        }} \n                    />\n                </>\n            )}\n                \n            <div className=\"flex justify-between pt-4\">\n                {canDeleteTask && (\n                    <div className=\"relative group\">\n                        <button\n                            type=\"button\"\n                            onClick={handleDelete}\n                            className={`p-2 rounded-md ${\n                                confirmDelete\n                                    ? 'bg-red-600 text-white dark:bg-red-700 dark:text-white hover:bg-red-700 dark:hover:bg-red-600'\n                                    : 'text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300'\n                            }`}\n                        >\n                            {confirmDelete ? (\n                                <CheckIcon className=\"h-5 w-5\" />\n                            ) : (\n                                <TrashIcon className=\"h-5 w-5\" />\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {confirmDelete ? t('tasks.editTask.form.confirmDelete') : t('tasks.editTask.form.delete')}\n                        </div>\n                    </div>\n                )}\n                <div className=\"flex gap-2\">\n                    <div className=\"relative group\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                        >\n                            <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {t('tasks.editTask.form.cancel')}\n                        </div>\n                    </div>\n                    <div className=\"relative group\">\n                        <button\n                            type=\"submit\"\n                            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                            disabled={loading}\n                        >\n                            {loading ? (\n                                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                            ) : (\n                                <CheckIcon className=\"h-5 w-5\" />\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {loading ? t('tasks.editTask.form.saving') : t('tasks.editTask.form.save')}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </form>\n    );\n\n    const renderAttachments = () => {\n        if (attachments.length === 0) return null;\n        \n        return (\n            <div className=\"mt-2\">\n                <ul className=\"flex flex-wrap gap-2\">\n                    {attachments.map((attachment) => (\n                        <li key={attachment.id} className=\"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-md px-2 py-1 relative group\">\n                            <span className=\"text-sm font-medium text-gray-800 dark:text-gray-300\">\n                                {attachment.fileName}\n                            </span>\n                            <div className=\"flex ml-2\">\n                                <div className=\"relative group mr-1\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => handleDownloadAttachment(attachment)}\n                                        className=\"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\n                                        </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tasks.editTask.form.download')}\n                                    </div>\n                                </div>\n                                <div className=\"relative group ml-1\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => handleDeleteAttachment(attachment.id)}\n                                        className=\"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                                        </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tasks.editTask.form.remove')}\n                                    </div>\n                                </div>\n                            </div>\n                            {/* Tooltip fr Bildvorschau bei Bild-Dateien */}\n                            {attachment.fileType.startsWith('image/') && (\n                                <div className=\"absolute z-10 bg-white dark:bg-gray-800 p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 dark:border-gray-600 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                    <img \n                                        src={getTaskAttachmentUrl(task.id, attachment.id)}\n                                        alt={attachment.fileName}\n                                        className=\"max-w-[200px] max-h-[150px] object-contain\"\n                                    />\n                                </div>\n                            )}\n                        </li>\n                    ))}\n                </ul>\n            </div>\n        );\n    };\n\n    const renderTemporaryAttachments = () => {\n        if (temporaryAttachments.length === 0) return null;\n        \n        return (\n            <div className=\"mt-2\">\n                <ul className=\"flex flex-wrap gap-2\">\n                    {temporaryAttachments.map((attachment, index) => (\n                        <li key={`temp-${index}`} className=\"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-md px-2 py-1 relative group\">\n                            <span className=\"text-sm font-medium text-gray-800 dark:text-gray-300\">\n                                {attachment.fileName}\n                            </span>\n                            <div className=\"flex ml-2\">\n                                <div className=\"relative group ml-1\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => handleRemoveTemporaryAttachment(index)}\n                                        className=\"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                                        </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tasks.editTask.form.remove')}\n                                    </div>\n                                </div>\n                            </div>\n                            {/* Tooltip fr Bildvorschau bei Bild-Dateien */}\n                            {attachment.fileType?.startsWith('image/') && attachment.file && (\n                                <div className=\"absolute z-10 bg-white dark:bg-gray-800 p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 dark:border-gray-600 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                    <img \n                                        src={URL.createObjectURL(attachment.file)}\n                                        alt={attachment.fileName}\n                                        className=\"max-w-[200px] max-h-[150px] object-contain\"\n                                    />\n                                </div>\n                            )}\n                        </li>\n                    ))}\n                </ul>\n            </div>\n        );\n    };\n\n    if (!isOpen) return null;\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                                {t('tasks.editTask.title')}\n                            </Dialog.Title>\n                            <button\n                                onClick={onClose}\n                                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <div className=\"p-4\">\n                            {error && (\n                                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                                    {error}\n                                </div>\n                            )}\n\n                            {renderForm()}\n                        </div>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n\n    // Fr Desktop (ab 640px) - Sidepane\n    // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    onClick={onClose}\n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                            {t('tasks.editTask.title')}\n                    </h2>\n                    <button\n                        onClick={onClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    {error && (\n                        <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                            {error}\n                        </div>\n                    )}\n\n                    {renderForm()}\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default EditTaskModal; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { XMarkIcon } from '@heroicons/react/24/outline';\nimport { reservationService } from '../../services/reservationService.ts';\nimport { Reservation } from '../../types/reservation.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface SendInvitationSidepaneProps {\n  isOpen: boolean;\n  onClose: () => void;\n  reservation: Reservation;\n  onSuccess: () => void;\n}\n\nconst SendInvitationSidepane: React.FC<SendInvitationSidepaneProps> = ({\n  isOpen,\n  onClose,\n  reservation,\n  onSuccess\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n\n  // Formular-Felder\n  const [guestPhone, setGuestPhone] = useState(reservation.guestPhone || '');\n  const [guestEmail, setGuestEmail] = useState(reservation.guestEmail || '');\n  const [customMessage, setCustomMessage] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [previewMessage, setPreviewMessage] = useState('');\n\n  // Standard-Nachricht generieren\n  const generateStandardMessage = () => {\n    const amount = reservation.amount || 0;\n    const currency = reservation.currency || 'COP';\n    return `Hola {{guestName}},\n\nBienvenido a La Familia Hostel!\n\nTu reserva ha sido confirmada.\nCargos: ${amount} ${currency}\n\nPuedes realizar el check-in en lnea ahora:\n{{checkInLink}}\n\nPor favor, realiza el pago:\n{{paymentLink}}\n\nTe esperamos!`;\n  };\n\n  // Initialisiere Standard-Nachricht beim ffnen\n  useEffect(() => {\n    if (isOpen && !customMessage) {\n      setCustomMessage(generateStandardMessage());\n    }\n  }, [isOpen, reservation]);\n\n  // Preview-Nachricht generieren (mit echten Links)\n  useEffect(() => {\n    if (customMessage) {\n      // Generiere LobbyPMS Check-in-Link (analog zu Backend generateLobbyPmsCheckInLink)\n      // Format: https://app.lobbypms.com/checkinonline/confirmar?codigo={id}&email={email}&lg={language}\n      const email = guestEmail || reservation.guestEmail || '';\n      let checkInLink = '[Check-in-Link wird generiert]';\n      if (email) {\n        const codigo = reservation.id.toString();\n        const baseUrl = 'https://app.lobbypms.com/checkinonline/confirmar';\n        const params = new URLSearchParams();\n        params.append('codigo', codigo);\n        params.append('email', email);\n        params.append('lg', 'GB'); // Standard: Englisch\n        checkInLink = `${baseUrl}?${params.toString()}`;\n      }\n      \n      // Verwende bestehenden Payment-Link oder Fallback\n      const paymentLink = reservation.paymentLink || '[Zahlungslink wird erstellt]';\n      \n      let preview = customMessage\n        .replace(/\\{\\{guestName\\}\\}/g, reservation.guestName)\n        .replace(/\\{\\{checkInLink\\}\\}/g, checkInLink)\n        .replace(/\\{\\{paymentLink\\}\\}/g, paymentLink);\n      setPreviewMessage(preview);\n    }\n  }, [customMessage, reservation.guestName, reservation.paymentLink, reservation.id, reservation.guestEmail, guestEmail]);\n\n  // Responsive-Verhalten\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n\n    window.addEventListener('resize', handleResize);\n    handleResize();\n\n    return () => {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen && !isMobile) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n\n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, isMobile, openSidepane, closeSidepane]);\n\n  // Reset form when sidepane closes\n  useEffect(() => {\n    if (!isOpen) {\n      setGuestPhone(reservation.guestPhone || '');\n      setGuestEmail(reservation.guestEmail || '');\n      setCustomMessage('');\n      setError(null);\n      setPreviewMessage('');\n    }\n  }, [isOpen, reservation]);\n\n  const handleClose = () => {\n    setError(null);\n    onClose();\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n\n    // Validierung: Mindestens eine Kontaktinfo muss vorhanden sein\n    if (!guestPhone && !guestEmail) {\n      setError(t('reservations.sendInvitation.noContact', 'Bitte geben Sie mindestens eine Telefonnummer oder E-Mail-Adresse an.'));\n      return;\n    }\n\n    try {\n      setLoading(true);\n\n      await reservationService.sendInvitation(reservation.id, {\n        guestPhone: guestPhone || undefined,\n        guestEmail: guestEmail || undefined,\n        customMessage: customMessage || undefined\n      });\n\n      showMessage(\n        t('reservations.sendInvitation.success', 'Einladung erfolgreich versendet'),\n        'success'\n      );\n      onSuccess();\n      handleClose();\n    } catch (err: any) {\n      console.error('Fehler beim Versenden der Einladung:', err);\n      const errorMessage = err.response?.data?.message || \n        t('reservations.sendInvitation.error', 'Fehler beim Versenden der Einladung');\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Warnung anzeigen, wenn bereits versendet wurde\n  const alreadySent = reservation.sentMessageAt;\n\n  // Fr Mobile (< 640px) - Dialog (Modal)\n  if (isMobile) {\n    return (\n      <div\n        className={`fixed inset-0 z-50 overflow-y-auto ${isOpen ? '' : 'hidden'}`}\n        aria-labelledby=\"modal-title\"\n        role=\"dialog\"\n        aria-modal=\"true\"\n      >\n        <div className=\"flex min-h-screen items-end justify-center p-4 text-center sm:items-center sm:p-0\">\n          <div\n            className=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\"\n            onClick={handleClose}\n          />\n\n          <div className=\"relative transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <h2 className=\"text-lg font-semibold dark:text-white\">\n                {t('reservations.sendInvitation.title', 'Einladung senden')}\n              </h2>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <div className=\"p-4 overflow-y-auto max-h-[calc(100vh-200px)]\">\n              {renderForm()}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('reservations.sendInvitation.title', 'Einladung senden')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {renderForm()}\n        </div>\n      </div>\n    </>\n  );\n\n  function renderForm() {\n    return (\n      <>\n        {error && (\n          <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded\">\n            {error}\n          </div>\n        )}\n\n        {alreadySent && (\n          <div className=\"mb-4 p-3 bg-yellow-100 dark:bg-yellow-900 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-200 rounded\">\n            <p className=\"text-sm\">\n              {t('reservations.sendInvitation.alreadySent', 'Bereits versendet am')}: {new Date(reservation.sentMessageAt!).toLocaleString()}\n            </p>\n            <p className=\"text-xs mt-1\">\n              {t('reservations.sendInvitation.canResend', 'Sie knnen die Einladung erneut senden.')}\n            </p>\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {/* Kontaktinfo */}\n          <div>\n            <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\n              {t('reservations.sendInvitation.contactInfo', 'Kontaktinformationen')}\n            </h3>\n\n            <div className=\"space-y-3\">\n              {/* Telefonnummer */}\n              <div>\n                <label htmlFor=\"guestPhone\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('reservations.phone', 'Telefonnummer')}\n                </label>\n                <input\n                  type=\"tel\"\n                  id=\"guestPhone\"\n                  value={guestPhone}\n                  onChange={(e) => setGuestPhone(e.target.value)}\n                  placeholder=\"+573001234567\"\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                />\n              </div>\n\n              {/* E-Mail */}\n              <div>\n                <label htmlFor=\"guestEmail\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('reservations.email', 'E-Mail')}\n                </label>\n                <input\n                  type=\"email\"\n                  id=\"guestEmail\"\n                  value={guestEmail}\n                  onChange={(e) => setGuestEmail(e.target.value)}\n                  placeholder=\"email@example.com\"\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Nachricht */}\n          <div>\n            <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\n              {t('reservations.sendInvitation.message', 'Nachricht')}\n            </h3>\n\n            <div className=\"space-y-3\">\n              {/* Textarea fr Nachricht */}\n              <div>\n                <label htmlFor=\"customMessage\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('reservations.sendInvitation.messageLabel', 'Nachricht (editierbar)')}\n                </label>\n                <textarea\n                  id=\"customMessage\"\n                  value={customMessage}\n                  onChange={(e) => setCustomMessage(e.target.value)}\n                  rows={10}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white font-mono text-xs\"\n                  placeholder={generateStandardMessage()}\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('reservations.sendInvitation.messageVariables', 'Verfgbare Variablen: {{guestName}}, {{checkInLink}}, {{paymentLink}}')}\n                </p>\n              </div>\n\n              {/* Preview */}\n              {previewMessage && (\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('reservations.sendInvitation.preview', 'Vorschau')}\n                  </label>\n                  <div className=\"p-3 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-md text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                    {previewMessage}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Buttons */}\n          <div className=\"flex justify-end space-x-3 pt-4 border-t dark:border-gray-700\">\n            <button\n              type=\"button\"\n              onClick={handleClose}\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              {t('common.cancel', 'Abbrechen')}\n            </button>\n            <button\n              type=\"submit\"\n              disabled={loading || (!guestPhone && !guestEmail)}\n              className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading\n                ? t('reservations.sendInvitation.sending', 'Wird gesendet...')\n                : t('reservations.sendInvitation.send', 'Senden')\n              }\n            </button>\n          </div>\n        </form>\n      </>\n    );\n  }\n};\n\nexport default SendInvitationSidepane;\n\n","import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { ClockIcon, ListBulletIcon, ArrowPathIcon, ExclamationTriangleIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useWorktime } from '../contexts/WorktimeContext.tsx';\nimport { useBranch } from '../contexts/BranchContext.tsx';\nimport { useOrganization } from '../contexts/OrganizationContext.tsx';\nimport { WorktimeModal } from './WorktimeModal.tsx';\n\n// Wir entfernen die benutzerdefinierten API-URL-Definitionen und verwenden die direkte URL,\n// um Konflikte mit der globalen Axios-Konfiguration zu vermeiden\n// const API_BASE_URL = 'http://localhost:5000';\n// const API_URL = `${API_BASE_URL}/api`;\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface WorkTime {\n    id: number;\n    startTime: Date;\n    endTime: Date | null;\n    branchId: number;\n    userId: number;\n    organizationId: number | null;\n    branch: {\n        id: number;\n        name: string;\n    };\n}\n\ninterface WorktimeModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nconst WorktimeTracker: React.FC = () => {\n    /* CLAUDE-ANCHOR: a7c238f1-9d6a-42e5-8af1-6d8b2e9a4f18 - WORKTIME_TRACKER_COMPONENT */\n    const { t } = useTranslation();\n    const [isTracking, setIsTracking] = useState(false);\n    const [startTime, setStartTime] = useState<Date | null>(null);\n    const [elapsedTime, setElapsedTime] = useState<string>('00:00:00');\n    const [activeWorktime, setActiveWorktime] = useState<WorkTime | null>(null);\n    const [isLoading, setIsLoading] = useState(true);\n    const [showWorkTimeModal, setShowWorkTimeModal] = useState(false);\n    const [statusError, setStatusError] = useState<string | null>(null);\n    const { user } = useAuth();\n    const { isTracking: contextTracking, updateTrackingStatus, checkTrackingStatus } = useWorktime();\n    const { branches, selectedBranch, setSelectedBranch } = useBranch();\n    const { organization } = useOrganization();\n\n    // Prfe ob aktive WorkTime zu anderer Organisation gehrt\n    const isDifferentOrganization = useMemo(() => {\n        if (!activeWorktime || !organization) return false;\n        // Beide null = standalone User, keine Warnung\n        if (activeWorktime.organizationId === null && organization.id === undefined) return false;\n        // Vergleich: WorkTime gehrt zu anderer Organisation\n        return activeWorktime.organizationId !== organization.id;\n    }, [activeWorktime, organization]);\n\n    // Funktion zum Abrufen des aktiven Worktime-Status\n    const checkActiveWorktime = useCallback(async () => {\n        try {\n            setIsLoading(true);\n            setStatusError(null);\n            \n            console.log('Prfe aktive Zeiterfassung...');\n            console.log('Benutzer geladen:', user?.id);\n            \n            const token = localStorage.getItem('token');\n            console.log('Token vorhanden:', token ? 'Ja' : 'Nein');\n            \n            if (!token) {\n                console.error('Kein Authentifizierungstoken gefunden');\n                setStatusError(t('worktime.tracker.notAuthenticated'));\n                setIsLoading(false);\n                return;\n            }\n            \n            try {\n                // Verwende axiosInstance statt direktem axios\n                const response = await axiosInstance.get(API_ENDPOINTS.WORKTIME.ACTIVE);\n                \n                console.log('API-Antwort Status:', response.status);\n                \n                const data = response.data;\n                console.log('Aktive Zeiterfassung Daten:', data);\n                \n                if (data && data.active === true) {\n                    console.log('Aktive Zeiterfassung gefunden:', data.id);\n                    // Startzeit setzen und Timer initialisieren\n                    // Entferne das 'Z' am Ende des Strings, damit JS den Zeitstempel nicht als UTC interpretiert\n                    const startISOString = data.startTime.endsWith('Z') \n                        ? data.startTime.substring(0, data.startTime.length - 1)\n                        : data.startTime;\n                    \n                    const startTimeDate = new Date(startISOString);\n                    \n                    // Initial berechnete Zeit anzeigen\n                    const now = new Date();\n                    const diff = now.getTime() - startTimeDate.getTime();\n                    const totalSeconds = Math.floor(diff / 1000);\n                    const hours = Math.floor(totalSeconds / 3600);\n                    const minutes = Math.floor((totalSeconds % 3600) / 60);\n                    const seconds = totalSeconds % 60;\n                    \n                    // Alle State-Updates in einem Batch zusammenfassen, um nur einen Re-Render zu verursachen\n                    setActiveWorktime(data);\n                    setStartTime(startTimeDate);\n                    setElapsedTime(\n                        `${hours.toString().padStart(2, '0')}:${minutes\n                            .toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`\n                    );\n                    setIsTracking(true);\n                    \n                    // Nur Branch setzen, wenn es sich gendert hat (vermeidet unntigen Re-Render)\n                    if (selectedBranch !== data.branchId) {\n                        setSelectedBranch(data.branchId);\n                    }\n                    \n                    // Aktualisiere den globalen Tracking-Status\n                    updateTrackingStatus(true);\n                } else {\n                    console.log('Keine aktive Zeiterfassung vorhanden');\n                    // Alle State-Updates in einem Batch zusammenfassen\n                    setIsTracking(false);\n                    setActiveWorktime(null);\n                    setStartTime(null);\n                    setElapsedTime('00:00:00');\n                    \n                    // Aktualisiere den globalen Tracking-Status\n                    updateTrackingStatus(false);\n                }\n            } catch (error) {\n                console.error('Fehler beim Abrufen der aktiven Zeiterfassung:', error);\n                \n                // Einfachere Fehlerbehandlung ohne axios-Import\n                const axiosError = error as any;\n                if (axiosError.code === 'ERR_NETWORK') {\n                    setStatusError(t('worktime.tracker.connectionError'));\n                } else {\n                    setStatusError(`${t('worktime.tracker.errorFetch')}: ${axiosError.response?.data?.message || axiosError.message}`);\n                }\n            }\n        } finally {\n            setIsLoading(false);\n        }\n    }, [user?.id, updateTrackingStatus, selectedBranch, organization]);\n    \n    //  PERFORMANCE: Verwende WorktimeContext statt eigenen Request\n    // Initiale Prfung: Verwende isTracking aus WorktimeContext (wird bereits beim Seitenaufruf geladen)\n    useEffect(() => {\n        if (user) {\n            // WorktimeContext ldt bereits beim Mount, verwende diesen Status\n            // Warte auf contextTracking (kann undefined sein beim ersten Render)\n            if (contextTracking !== undefined) {\n                // Context ist geladen, verwende diesen Status\n                setIsTracking(contextTracking);\n                setIsLoading(false);\n            }\n            // Wenn contextTracking noch undefined ist, warten wir einfach\n            // WorktimeContext wird den Status automatisch laden\n        } else {\n            setIsLoading(false);\n        }\n    }, [user, contextTracking]);\n\n    // Timer-Logik\n    useEffect(() => {\n        let intervalId: number;\n\n        if (isTracking && startTime) {\n            intervalId = window.setInterval(() => {\n                const now = new Date();\n                const diff = now.getTime() - startTime.getTime();\n                \n                // Berechnung mit Millisekunden, um negative Werte zu vermeiden\n                const totalSeconds = Math.floor(diff / 1000);\n                const hours = Math.floor(totalSeconds / 3600);\n                const minutes = Math.floor((totalSeconds % 3600) / 60);\n                const seconds = totalSeconds % 60;\n\n                setElapsedTime(\n                    `${hours.toString().padStart(2, '0')}:${minutes\n                        .toString()\n                        .padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`\n                );\n            }, 1000);\n        }\n\n        return () => {\n            if (intervalId) {\n                clearInterval(intervalId);\n            }\n        };\n    }, [isTracking, startTime]);\n\n    const handleToggleTracking = async () => {\n        if (isTracking) {\n            await handleStopTracking();\n        } else {\n            await handleStartTracking();\n        }\n    };\n\n    const handleStartTracking = async () => {\n        if (!selectedBranch) {\n            alert(t('worktime.tracker.selectBranch'));\n            return;\n        }\n\n        try {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                console.error('Kein Authentifizierungstoken gefunden');\n                alert(t('worktime.tracker.notAuthenticatedMessage'));\n                return;\n            }\n            \n            // Verwende axiosInstance statt direktem axios\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.WORKTIME.START,\n                {\n                    branchId: selectedBranch,\n                    // Die aktuelle Zeit mit Bercksichtigung der Zeitzonenverschiebung senden\n                    // Da die Datenbank in UTC speichert, mssen wir die lokale Zeit so senden,\n                    // dass sie nach der automatischen UTC-Umwandlung korrekt ist\n                    startTime: new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000)\n                },\n                {\n                    headers: {\n                        'Authorization': `Bearer ${token}`,\n                        'Content-Type': 'application/json'\n                    }\n                }\n            );\n\n            const data = response.data;\n            \n            // Erstelle ein Date-Objekt ohne Zeitzonenumrechnung\n            // Entferne das 'Z' am Ende des Strings, damit JS den Zeitstempel nicht als UTC interpretiert\n            const startISOString = data.startTime.endsWith('Z') \n                ? data.startTime.substring(0, data.startTime.length - 1)\n                : data.startTime;\n            \n            const startTimeDate = new Date(startISOString);\n            \n            // Initial berechnete Zeit anzeigen (0:00:00 beim Start)\n            // Alle State-Updates in einem Batch zusammenfassen, um nur einen Re-Render zu verursachen\n            setActiveWorktime(data);\n            setStartTime(startTimeDate);\n            setElapsedTime('00:00:00');\n            setIsTracking(true);\n            \n            // Aktualisiere den globalen Tracking-Status\n            updateTrackingStatus(true);\n        } catch (error) {\n            console.error('Fehler:', error);\n            \n            // Detaillierte Fehlerbehandlung\n            let errorMessage = t('worktime.tracker.errorStart');\n            if (error.response) {\n                errorMessage = error.response.data?.message || `Fehler (Status: ${error.response.status})`;\n            }\n            \n            alert(errorMessage);\n        }\n    };\n\n    const handleStopTracking = async () => {\n        try {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                console.error('Kein Authentifizierungstoken gefunden');\n                alert(t('worktime.tracker.notAuthenticatedMessage'));\n                return;\n            }\n            \n            // Verwende axiosInstance statt direktem axios\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.WORKTIME.STOP,\n                {\n                    // Die aktuelle Zeit mit Bercksichtigung der Zeitzonenverschiebung senden\n                    endTime: new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000)\n                },\n                {\n                    headers: {\n                        'Authorization': `Bearer ${token}`,\n                        'Content-Type': 'application/json'\n                    }\n                }\n            );\n\n            // Alle State-Updates in einem Batch zusammenfassen, um nur einen Re-Render zu verursachen\n            setIsTracking(false);\n            setActiveWorktime(null);\n            setStartTime(null);\n            setElapsedTime('00:00:00');\n            \n            // Aktualisiere den globalen Tracking-Status\n            updateTrackingStatus(false);\n        } catch (error) {\n            console.error('Fehler:', error);\n            \n            // Detaillierte Fehlerbehandlung\n            let errorMessage = t('worktime.tracker.errorStop');\n            if (error.response) {\n                errorMessage = error.response.data?.message || `Fehler (Status: ${error.response.status})`;\n            }\n            \n            alert(errorMessage);\n        }\n    };\n\n    const openWorkTimeModal = () => {\n        setShowWorkTimeModal(true);\n    };\n\n    const closeWorkTimeModal = () => {\n        setShowWorkTimeModal(false);\n    };\n\n    // Branch-Name memoized berechnen (vermeidet unntige Re-Berechnungen)\n    const branchName = useMemo(() => {\n        if (!activeWorktime) return null;\n        return branches.find(b => b.id === activeWorktime.branchId)?.name || t('worktime.tracker.unknown');\n    }, [branches, activeWorktime]);\n\n    // Manuelle Statusaktualisierung\n    const handleRefreshStatus = () => {\n        checkActiveWorktime();\n    };\n\n    // Manuelle Zeiterfassung forciert stoppen (fr Notflle)\n    const handleForceStop = async () => {\n        if (!window.confirm(t('worktime.tracker.forceStopConfirm'))) {\n            return;\n        }\n        \n        try {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                console.error('Kein Authentifizierungstoken gefunden');\n                alert(t('worktime.tracker.notAuthenticatedMessage'));\n                return;\n            }\n            \n            // Verwende axiosInstance statt direktem axios\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.WORKTIME.STOP,\n                {\n                    // Die aktuelle Zeit mit Bercksichtigung der Zeitzonenverschiebung senden\n                    endTime: new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000),\n                    force: true\n                },\n                {\n                    headers: {\n                        'Authorization': `Bearer ${token}`,\n                        'Content-Type': 'application/json'\n                    }\n                }\n            );\n\n            setIsTracking(false);\n            setStartTime(null);\n            setElapsedTime('00:00:00');\n            setActiveWorktime(null);\n            setStatusError(null);\n            alert(t('worktime.tracker.forceStopSuccess'));\n            \n            // Aktualisiere den globalen Tracking-Status\n            updateTrackingStatus(false);\n        } catch (error) {\n            console.error('Fehler:', error);\n            setStatusError(`Fehler beim Stoppen: ${error.response?.status || 'Netzwerkfehler'}`);\n            alert(t('worktime.tracker.forceStopError'));\n        }\n    };\n\n    // Formatiere das Startdatum fr die lokale Anzeige\n    const formatStartDate = (dateString: string | number | Date) => {\n        // Entferne das 'Z' am Ende des Strings, damit JS den Zeitstempel nicht als UTC interpretiert\n        if (typeof dateString === 'string' && dateString.endsWith('Z')) {\n            dateString = dateString.substring(0, dateString.length - 1);\n        }\n        \n        const date = new Date(dateString);\n        \n        // Tag, Monat und Jahr aus lokaler Zeit extrahieren\n        const day = date.getDate().toString().padStart(2, '0');\n        const month = (date.getMonth() + 1).toString().padStart(2, '0');\n        const year = date.getFullYear();\n        \n        // Stunden, Minuten und Sekunden aus lokaler Zeit extrahieren\n        const hours = date.getHours().toString().padStart(2, '0');\n        const minutes = date.getMinutes().toString().padStart(2, '0');\n        const seconds = date.getSeconds().toString().padStart(2, '0');\n        \n        // Im deutschen Format zurckgeben\n        return `${day}.${month}.${year}, ${hours}:${minutes}:${seconds}`;\n    };\n\n    if (isLoading) {\n        return (\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-6\">\n                <div className=\"flex justify-center items-center h-32\">\n                    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-gray-300\"></div>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 sm:mb-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-xl font-semibold flex items-center dark:text-white\">\n                    <ClockIcon className=\"h-6 w-6 mr-2\" />\n                    {t('worktime.tracker.title')}\n                </h2>\n            </div>\n            \n            {statusError && (\n                <div className=\"mb-4 p-2 bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-300 border border-red-200 dark:border-red-700 rounded-md flex justify-between items-center\">\n                    <span>{statusError}</span>\n                    {statusError !== t('worktime.tracker.noActiveTracking') && (\n                        <button \n                            onClick={handleForceStop}\n                            className=\"text-sm bg-red-100 hover:bg-red-200 text-red-700 dark:bg-red-800 dark:hover:bg-red-700 dark:text-red-300 px-2 py-1 rounded-md\"\n                        >\n                            {t('worktime.tracker.stop')} {t('common.force', 'Erzwingen')}\n                        </button>\n                    )}\n                </div>\n            )}\n\n            {/* Warnung wenn WorkTime zu anderer Organisation gehrt */}\n            {isTracking && isDifferentOrganization && (\n                <div className=\"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200 border border-yellow-200 dark:border-yellow-700 rounded-md flex items-start\">\n                    <ExclamationTriangleIcon className=\"h-5 w-5 mr-2 mt-0.5 flex-shrink-0\" />\n                    <div className=\"flex-1\">\n                        <p className=\"font-medium\">{t('worktime.tracker.differentOrganizationWarning.title', 'Hinweis: Andere Organisation')}</p>\n                        <p className=\"text-sm mt-1\">\n                            {t('worktime.tracker.differentOrganizationWarning.message', 'Diese Zeiterfassung wurde in einer anderen Organisation gestartet. Sie wird nach dem Stoppen der Organisation zugeordnet, in der sie gestartet wurde.')}\n                        </p>\n                    </div>\n                </div>\n            )}\n            \n            {/* Ein-/Ausschalter fr die Zeiterfassung - verkleinert */}\n            <div className=\"flex items-start justify-center mb-4\">\n                <div className=\"flex flex-col items-center\">\n                    <label className=\"relative inline-flex items-center cursor-pointer\">\n                        <input \n                            type=\"checkbox\" \n                            className=\"sr-only peer\" \n                            checked={isTracking}\n                            onChange={handleToggleTracking}\n                            disabled={!selectedBranch && !isTracking}\n                            data-onboarding={isTracking ? \"stop-worktime\" : \"start-worktime\"}\n                        />\n                        <div className={`w-20 h-10 rounded-full \n                            ${isTracking \n                                ? 'bg-green-500 shadow-lg shadow-green-200 dark:shadow-green-900/20' \n                                : 'bg-gray-300 dark:bg-gray-600'\n                            }\n                            before:content-[''] before:absolute before:top-0 before:left-0 before:bottom-0 before:right-0 \n                            peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-700\n                            peer-checked:after:translate-x-10\n                            after:content-[''] after:absolute after:top-1 after:left-1\n                            after:bg-white dark:after:bg-gray-200 after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full\n                            after:h-8 after:w-8 after:transition-all after:duration-300 ease-in-out\n                            transition-colors duration-300`}>\n                        </div>\n                    </label>\n                    <span className=\"mt-2 text-sm font-medium\">\n                        {isTracking \n                            ? <span className=\"text-green-600 dark:text-green-400 font-bold\">{t('worktime.tracker.running')}</span> \n                            : <span className=\"text-gray-600 dark:text-gray-400\">{t('worktime.tracker.start')}</span>\n                        }\n                    </span>\n                </div>\n\n                {/* Icon-Button zum ffnen des Modals */}\n                <button \n                    onClick={openWorkTimeModal}\n                    className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-2 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-blue-700 shadow-sm flex items-center justify-center ml-8 mt-1\"\n                    title={t('worktime.tracker.showTimes')}\n                >\n                    <ListBulletIcon className=\"h-6 w-6\" />\n                </button>\n            </div>\n\n            {/* Informationen zur aktiven Zeiterfassung oder Platzhalter */}\n            <div className={`p-2 my-2 rounded-md text-sm ${isTracking && activeWorktime ? 'bg-green-50 dark:bg-green-900/20 dark:text-green-200' : 'bg-gray-50 dark:bg-gray-700 dark:text-gray-300'}`}>\n                {isTracking && activeWorktime ? (\n                    <>\n                        <p><strong>{t('worktime.tracker.activeTracking')}</strong> {elapsedTime}</p>\n                        <p><strong>{t('worktime.tracker.started')}</strong> {formatStartDate(startTime || Date.now())}</p>\n                        <p><strong>{t('worktime.tracker.selectBranchLabel')}:</strong> {branchName || t('worktime.tracker.unknown')}</p>\n                    </>\n                ) : (\n                    <>\n                        <p>&nbsp;</p>\n                        <p>&nbsp;</p>\n                        <p>&nbsp;</p>\n                    </>\n                )}\n            </div>\n\n            {/* WorkTime Modal */}\n            {showWorkTimeModal && (\n                <WorktimeModal isOpen={showWorkTimeModal} onClose={closeWorkTimeModal} />\n            )}\n        </div>\n    );\n};\n\nexport default WorktimeTracker; ","import React, { useEffect, useState, useMemo, useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useLocation } from 'react-router-dom';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useTableSettings } from '../hooks/useTableSettings.ts';\nimport TableColumnConfig from '../components/TableColumnConfig.tsx';\nimport { PencilIcon, TrashIcon, PlusIcon, ArrowLeftIcon, ArrowRightIcon, CheckCircleIcon, ArrowsUpDownIcon, FunnelIcon, XMarkIcon, DocumentDuplicateIcon, InformationCircleIcon, ClipboardDocumentListIcon, ArrowPathIcon, Squares2X2Icon, TableCellsIcon, UserIcon, BuildingOfficeIcon, CalendarIcon, ChevronLeftIcon, ChevronRightIcon, HomeIcon, EnvelopeIcon, PhoneIcon, LinkIcon, CurrencyDollarIcon, ClockIcon, KeyIcon, PaperAirplaneIcon } from '@heroicons/react/24/outline';\nimport CreateTaskModal from '../components/CreateTaskModal.tsx';\nimport EditTaskModal from '../components/EditTaskModal.tsx';\nimport CreateReservationModal from '../components/reservations/CreateReservationModal.tsx';\nimport SendInvitationSidepane from '../components/reservations/SendInvitationSidepane.tsx';\nimport { Reservation, ReservationStatus, PaymentStatus } from '../types/reservation.ts';\nimport { useNavigate } from 'react-router-dom';\nimport useMessage from '../hooks/useMessage.ts';\nimport WorktimeTracker from '../components/WorktimeTracker.tsx';\nimport WorktimeList from '../components/WorktimeList.tsx';\nimport { API_ENDPOINTS, getTaskAttachmentUrl } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { applyFilters, evaluateDateCondition, evaluateUserRoleCondition, evaluateResponsibleAndQualityControl } from '../utils/filterLogic.ts';\nimport { toast } from 'react-toastify';\nimport MarkdownPreview from '../components/MarkdownPreview.tsx';\nimport { getExpiryStatus, getExpiryColorClasses, createDueDateMetadataItem } from '../utils/expiryUtils.ts';\nimport { getStatusText, getStatusColor } from '../utils/statusUtils.tsx';\nimport DataCard, { MetadataItem } from '../components/shared/DataCard.tsx';\nimport CardGrid from '../components/shared/CardGrid.tsx';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport { reservationService } from '../services/reservationService.ts';\n\ninterface Task {\n    id: number;\n    title: string;\n    description: string | null;\n    status: 'open' | 'in_progress' | 'improval' | 'quality_control' | 'done';\n    responsible: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    responsibleId: number | null;\n    role: {\n        id: number;\n        name: string;\n    } | null;\n    roleId: number | null;\n    qualityControl: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    branch: {\n        id: number;\n        name: string;\n    };\n    dueDate: string | null;\n    requestId: number | null;\n    attachments?: Array<{\n        id: number;\n        fileName: string;\n        fileType: string;\n        fileSize?: number;\n        filePath?: string;\n        uploadedAt?: string;\n        url: string;\n    }>;\n}\n\ninterface SortConfig {\n    key: keyof Task | 'responsible.firstName' | 'qualityControl.firstName' | 'branch.name';\n    direction: 'asc' | 'desc';\n}\n\n// Standard-Spaltenreihenfolge (wird in der Komponente neu definiert)\nconst defaultColumnOrder = ['title', 'responsibleAndQualityControl', 'status', 'dueDate', 'branch', 'actions'];\n\n// Definiere eine tableId fr die To-Dos Tabelle\nconst TODOS_TABLE_ID = 'worktracker-todos';\n\n// Definiere eine tableId fr die Reservations Tabelle\nconst RESERVATIONS_TABLE_ID = 'worktracker-reservations';\n\n// Card-Einstellungen Standardwerte\nconst defaultCardMetadata = ['title', 'status', 'responsible', 'qualityControl', 'branch', 'dueDate', 'description'];\nconst defaultCardColumnOrder = ['title', 'status', 'responsible', 'qualityControl', 'branch', 'dueDate', 'description'];\nconst defaultCardSortDirections: Record<string, 'asc' | 'desc'> = {\n  title: 'asc',\n  status: 'asc',\n  responsible: 'asc',\n  qualityControl: 'asc',\n  branch: 'asc',\n  dueDate: 'asc',\n  description: 'asc'\n};\n\n// Mapping zwischen Tabellen-Spalten-IDs und Card-Metadaten-IDs\n// Tabellen-Spalte -> Card-Metadaten (kann Array sein fr 1:N Mapping)\nconst tableToCardMapping: Record<string, string[]> = {\n  'title': ['title'],\n  'status': ['status'],\n  'responsibleAndQualityControl': ['responsible', 'qualityControl'], // 1 Tabelle-Spalte -> 2 Card-Metadaten\n  'branch': ['branch'],\n  'dueDate': ['dueDate'],\n  'actions': [], // Keine Card-Entsprechung\n  'description': ['description'] // Nur in Cards verfgbar\n};\n\n// Reverse Mapping: Card-Metadaten -> Tabellen-Spalten\nconst cardToTableMapping: Record<string, string> = {\n  'title': 'title',\n  'status': 'status',\n  'responsible': 'responsibleAndQualityControl',\n  'qualityControl': 'responsibleAndQualityControl',\n  'branch': 'branch',\n  'dueDate': 'dueDate',\n  'description': 'description'\n};\n\n// Helfer-Funktion: Tabellen-Spalte ausgeblendet -> Card-Metadaten ausblenden\nconst getHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n  const hiddenCardMetadata = new Set<string>();\n  hiddenTableColumns.forEach(tableCol => {\n    const cardMetadata = tableToCardMapping[tableCol] || [];\n    cardMetadata.forEach(cardMeta => hiddenCardMetadata.add(cardMeta));\n  });\n  return hiddenCardMetadata;\n};\n\n// Helfer-Funktion: Card-Metadaten zu Tabellen-Spalten konvertieren\nconst getCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n  const cardMetadata: string[] = [];\n  columnOrder.forEach(tableCol => {\n    const cardMeta = tableToCardMapping[tableCol];\n    if (cardMeta && cardMeta.length > 0) {\n      cardMetadata.push(...cardMeta);\n    }\n  });\n  // Beschreibung hinzufgen, wenn nicht schon vorhanden\n  if (!cardMetadata.includes('description')) {\n    cardMetadata.push('description');\n  }\n  return cardMetadata;\n};\n\nconst Worktracker: React.FC = () => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { hasPermission, permissions } = usePermissions();\n    const location = useLocation();\n    const navigate = useNavigate();\n    const { showMessage } = useMessage();\n    \n    // Definiere die verfgbaren Spalten fr die Tabelle (dynamisch aus bersetzungen)\n    const availableColumns = useMemo(() => [\n        { id: 'title', label: t('tasks.columns.title'), shortLabel: t('tasks.columns.title') },\n        { id: 'status', label: t('tasks.columns.status'), shortLabel: t('tasks.columns.status') },\n        { id: 'responsibleAndQualityControl', label: t('tasks.columns.responsibleAndQualityControl'), shortLabel: t('tasks.columns.responsibleAndQualityControl').split('/')[0] },\n        { id: 'branch', label: t('tasks.columns.branch'), shortLabel: t('tasks.columns.branch').substring(0, 5) },\n        { id: 'dueDate', label: t('tasks.columns.dueDate'), shortLabel: t('tasks.columns.dueDate').substring(0, 5) },\n        { id: 'actions', label: t('tasks.columns.actions'), shortLabel: t('common.actions').substring(0, 3) },\n    ], [t]);\n\n    // Definiere zustzliche Spalten, die nur fr den Filter verfgbar sind, nicht fr die Tabellenanzeige\n    const filterOnlyColumns = useMemo(() => [\n        { id: 'responsible', label: t('tasks.columns.responsible'), shortLabel: t('tasks.columns.responsible').substring(0, 3) },\n        { id: 'qualityControl', label: t('tasks.columns.qualityControl'), shortLabel: t('tasks.columns.qualityControl').substring(0, 2) },\n    ], [t]);\n    \n    // Reservations-Spalten\n    const availableReservationColumns = useMemo(() => [\n        { id: 'guestName', label: t('reservations.columns.guestName', 'Gast'), shortLabel: t('reservations.columns.guestName', 'Gast').substring(0, 4) },\n        { id: 'status', label: t('reservations.columns.status', 'Status'), shortLabel: t('reservations.columns.status', 'Status').substring(0, 3) },\n        { id: 'paymentStatus', label: t('reservations.columns.paymentStatus', 'Zahlungsstatus'), shortLabel: t('reservations.columns.paymentStatus', 'Zahlungsstatus').substring(0, 3) },\n        { id: 'checkInDate', label: t('reservations.columns.checkInDate', 'Check-in'), shortLabel: t('reservations.columns.checkInDate', 'Check-in').substring(0, 5) },\n        { id: 'checkOutDate', label: t('reservations.columns.checkOutDate', 'Check-out'), shortLabel: t('reservations.columns.checkOutDate', 'Check-out').substring(0, 5) },\n        { id: 'roomNumber', label: t('reservations.columns.roomNumber', 'Zimmer'), shortLabel: t('reservations.columns.roomNumber', 'Zimmer').substring(0, 3) },\n        { id: 'guestEmail', label: t('reservations.columns.guestEmail', 'E-Mail'), shortLabel: t('reservations.columns.guestEmail', 'E-Mail').substring(0, 3) },\n        { id: 'guestPhone', label: t('reservations.columns.guestPhone', 'Telefon'), shortLabel: t('reservations.columns.guestPhone', 'Telefon').substring(0, 3) },\n        { id: 'amount', label: t('reservations.columns.amount', 'Betrag'), shortLabel: t('reservations.columns.amount', 'Betrag').substring(0, 3) },\n        { id: 'arrivalTime', label: t('reservations.columns.arrivalTime', 'Ankunftszeit'), shortLabel: t('reservations.columns.arrivalTime', 'Ankunftszeit').substring(0, 3) },\n        { id: 'actions', label: t('reservations.columns.actions', 'Aktionen'), shortLabel: t('common.actions').substring(0, 3) },\n    ], [t]);\n    \n    // Reservations Filter-Spalten (zustzliche Spalten nur fr Filter)\n    const reservationFilterOnlyColumns = useMemo(() => [\n        { id: 'onlineCheckInCompleted', label: t('reservations.columns.onlineCheckInCompleted', 'Online Check-in'), shortLabel: t('reservations.columns.onlineCheckInCompleted', 'Online Check-in').substring(0, 3) },\n        { id: 'doorPin', label: t('reservations.columns.doorPin', 'Tr-PIN'), shortLabel: t('reservations.columns.doorPin', 'Tr-PIN').substring(0, 3) },\n    ], [t]);\n    \n    // Status-bersetzungen (verwende zentrale Utils mit bersetzungsuntersttzung)\n    // WICHTIG: Funktionalitt bleibt identisch - nur Code-Duplikation entfernt!\n    const getStatusLabel = (status: Task['status']): string => {\n        return getStatusText(status, 'task', t);\n    };\n    // Tab-State\n    const [activeTab, setActiveTab] = useState<'todos' | 'reservations'>('todos');\n    \n    const [tasks, setTasks] = useState<Task[]>([]);\n    const [allTasks, setAllTasks] = useState<Task[]>([]); // Alle Tasks (fr Hintergrund-Laden und Filter-Wechsel)\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n    const [searchTerm, setSearchTerm] = useState('');\n    const [statusFilter, setStatusFilter] = useState<Task['status'] | 'all'>('all');\n    \n    // Reservations-States\n    const [reservations, setReservations] = useState<Reservation[]>([]);\n    const [reservationsLoading, setReservationsLoading] = useState(false);\n    const [reservationsError, setReservationsError] = useState<string | null>(null);\n    const [reservationSearchTerm, setReservationSearchTerm] = useState('');\n    const [reservationFilterStatus, setReservationFilterStatus] = useState<ReservationStatus | 'all'>('all');\n    const [reservationFilterPaymentStatus, setReservationFilterPaymentStatus] = useState<PaymentStatus | 'all'>('all');\n    const [isCreateReservationModalOpen, setIsCreateReservationModalOpen] = useState(false);\n    const [syncingReservations, setSyncingReservations] = useState(false);\n    const [generatingPinForReservation, setGeneratingPinForReservation] = useState<number | null>(null);\n    const [selectedReservationForInvitation, setSelectedReservationForInvitation] = useState<Reservation | null>(null);\n    const [isSendInvitationSidepaneOpen, setIsSendInvitationSidepaneOpen] = useState(false);\n    \n    // Reservations Filter States (analog zu Tasks)\n    const [reservationFilterConditions, setReservationFilterConditions] = useState<FilterCondition[]>([]);\n    const [reservationFilterLogicalOperators, setReservationFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [reservationFilterSortDirections, setReservationFilterSortDirections] = useState<Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>>([]);\n    const [reservationActiveFilterName, setReservationActiveFilterName] = useState<string>('');\n    const [reservationSelectedFilterId, setReservationSelectedFilterId] = useState<number | null>(null);\n    \n    // State fr erweiterte Filterbedingungen\n    const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n    const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [filterSortDirections, setFilterSortDirections] = useState<Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>>([]);\n    \n    // Filter State Management (Controlled Mode)\n    const [activeFilterName, setActiveFilterName] = useState<string>('');\n    const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n    \n    const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n    // Tabellen-Header-Sortierung (nur fr Tabellen-Ansicht)\n    const [tableSortConfig, setTableSortConfig] = useState<SortConfig>({ key: 'dueDate', direction: 'asc' });\n    const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n    const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n    const [selectedTask, setSelectedTask] = useState<Task | null>(null);\n    const [copiedTask, setCopiedTask] = useState<Task | null>(null);\n\n    // Tabellen-Einstellungen laden - Tasks\n    const {\n        settings: tasksSettings,\n        isLoading: isLoadingTasksSettings,\n        updateColumnOrder: updateTasksColumnOrder,\n        updateHiddenColumns: updateTasksHiddenColumns,\n        toggleColumnVisibility: toggleTasksColumnVisibility,\n        isColumnVisible: isTasksColumnVisible,\n        updateViewMode: updateTasksViewMode\n    } = useTableSettings('worktracker_tasks', {\n        defaultColumnOrder,\n        defaultHiddenColumns: [],\n        defaultViewMode: 'cards'\n    });\n    \n    // Tabellen-Einstellungen laden - Reservations\n    const defaultReservationColumnOrder = ['guestName', 'status', 'paymentStatus', 'checkInDate', 'checkOutDate', 'roomNumber', 'actions'];\n    const {\n        settings: reservationsSettings,\n        isLoading: isLoadingReservationsSettings,\n        updateColumnOrder: updateReservationsColumnOrder,\n        updateHiddenColumns: updateReservationsHiddenColumns,\n        toggleColumnVisibility: toggleReservationsColumnVisibility,\n        isColumnVisible: isReservationsColumnVisible,\n        updateViewMode: updateReservationsViewMode\n    } = useTableSettings('worktracker-reservations', {\n        defaultColumnOrder: defaultReservationColumnOrder,\n        defaultHiddenColumns: [],\n        defaultViewMode: 'cards'\n    });\n    \n    // Dynamische Settings basierend auf activeTab\n    const settings = activeTab === 'todos' ? tasksSettings : reservationsSettings;\n    const isLoadingSettings = activeTab === 'todos' ? isLoadingTasksSettings : isLoadingReservationsSettings;\n    const updateColumnOrder = activeTab === 'todos' ? updateTasksColumnOrder : updateReservationsColumnOrder;\n    const updateHiddenColumns = activeTab === 'todos' ? updateTasksHiddenColumns : updateReservationsHiddenColumns;\n    const toggleColumnVisibility = activeTab === 'todos' ? toggleTasksColumnVisibility : toggleReservationsColumnVisibility;\n    const isColumnVisible = activeTab === 'todos' ? isTasksColumnVisible : isReservationsColumnVisible;\n    const updateViewMode = activeTab === 'todos' ? updateTasksViewMode : updateReservationsViewMode;\n\n    const [draggedColumn, setDraggedColumn] = useState<string | null>(null);\n    const [dragOverColumn, setDragOverColumn] = useState<string | null>(null);\n    const [displayLimit, setDisplayLimit] = useState<number>(10);\n\n    // View-Mode aus Settings laden\n    const viewMode = settings.viewMode || 'cards';\n\n    // Abgeleitete Werte fr Card-Ansicht aus Tabellen-Settings\n    // Card-Metadaten-Reihenfolge aus columnOrder ableiten\n    const cardMetadataOrder = useMemo(() => {\n        return getCardMetadataFromColumnOrder(settings.columnOrder || defaultColumnOrder);\n    }, [settings.columnOrder]);\n\n    // Versteckte Card-Metadaten aus hiddenColumns ableiten\n    const hiddenCardMetadata = useMemo(() => {\n        return getHiddenCardMetadata(settings.hiddenColumns || []);\n    }, [settings.hiddenColumns]);\n\n    // Sichtbare Card-Metadaten (alle Card-Metadaten minus versteckte)\n    const visibleCardMetadata = useMemo(() => {\n        return new Set(cardMetadataOrder.filter(meta => !hiddenCardMetadata.has(meta)));\n    }, [cardMetadataOrder, hiddenCardMetadata]);\n\n    // CSS-Klasse fr Container-Box setzen (fr CSS-basierte Schattierungs-Entfernung)\n    useEffect(() => {\n        const wrappers = document.querySelectorAll('.dashboard-tasks-wrapper');\n        wrappers.forEach(wrapper => {\n            if (viewMode === 'cards') {\n                wrapper.classList.add('cards-mode');\n            } else {\n                wrapper.classList.remove('cards-mode');\n            }\n        });\n    }, [viewMode]);\n\n    // Ref um sicherzustellen, dass loadTasks nur einmal beim Mount aufgerufen wird\n    // (auch bei React.StrictMode doppelter Ausfhrung)\n    const hasLoadedRef = useRef(false);\n\n    // Funktion zum Neu Laden der Tasks\n    const loadTasks = async (filterId?: number, filterConditions?: any[], background = false) => {\n        try {\n            if (!background) {\n                setLoading(true);\n            }\n            \n            // Baue Query-Parameter\n            const params: any = {};\n            if (filterId) {\n                params.filterId = filterId;\n            } else if (filterConditions && filterConditions.length > 0) {\n                params.filterConditions = JSON.stringify({\n                    conditions: filterConditions,\n                    operators: filterLogicalOperators\n                });\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.TASKS.BASE, { params });\n            const tasksData = response.data;\n            \n            // Attachments sind bereits in der Response enthalten\n            // URL-Generierung fr Attachments hinzufgen\n            // Sicherstellen, dass keine undefined/null Werte im Array sind\n            const tasksWithAttachments = tasksData\n                .filter((task: Task) => task != null)\n                .map((task: Task) => {\n                    const attachments = (task.attachments || [])\n                        .filter((att: any) => att != null)\n                        .map((att: any) => ({\n                            id: att.id,\n                            fileName: att.fileName,\n                            fileType: att.fileType,\n                            fileSize: att.fileSize,\n                            filePath: att.filePath,\n                            uploadedAt: att.uploadedAt,\n                            url: getTaskAttachmentUrl(task.id, att.id)\n                        }));\n                    \n                    return {\n                        ...task,\n                        attachments: attachments\n                    };\n                });\n            \n            if (background) {\n                // Hintergrund-Laden: Speichere in allTasks\n                console.log(' Alle Tasks im Hintergrund geladen:', tasksWithAttachments.length, 'Tasks');\n                setAllTasks(tasksWithAttachments);\n            } else {\n                // Vordergrund-Laden: Zeige sofort an\n                console.log(' Tasks geladen:', tasksWithAttachments.length, 'Tasks');\n                setTasks(tasksWithAttachments);\n            }\n            setError(null);\n        } catch (error) {\n            console.error('Fehler beim Laden der Tasks:', error);\n            if (!background) {\n                setError(t('worktime.messages.tasksLoadError'));\n            }\n        } finally {\n            if (!background) {\n                setLoading(false);\n            }\n        }\n    };\n\n    const handleGeneratePinAndSend = async (reservationId: number) => {\n        try {\n            setGeneratingPinForReservation(reservationId);\n            await reservationService.generatePinAndSend(reservationId);\n            showMessage(t('reservations.pinGeneratedAndSent', 'PIN-Code generiert und Mitteilung versendet'), 'success');\n            await loadReservations(); // Aktualisiere Liste\n        } catch (error: any) {\n            console.error('Fehler beim Generieren des PIN-Codes und Versenden der Mitteilung:', error);\n            showMessage(\n                error.response?.data?.message || t('reservations.pinGenerateError', 'Fehler beim Generieren des PIN-Codes und Versenden der Mitteilung'),\n                'error'\n            );\n        } finally {\n            setGeneratingPinForReservation(null);\n        }\n    };\n\n    // Funktion zum Laden der Reservations\n    const loadReservations = async () => {\n        try {\n            setReservationsLoading(true);\n            setReservationsError(null);\n            const response = await axiosInstance.get(API_ENDPOINTS.RESERVATION.BASE);\n            const reservationsData = response.data?.data || response.data || [];\n            console.log(' Reservations geladen:', reservationsData.length, 'Reservations');\n            setReservations(reservationsData);\n        } catch (err: any) {\n            console.error('Fehler beim Laden der Reservations:', err);\n            const errorMessage = err.response?.data?.message || t('reservations.loadError', 'Fehler beim Laden der Reservations');\n            setReservationsError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setReservationsLoading(false);\n        }\n    };\n\n    // Lade Reservations, wenn Tab aktiv ist\n    useEffect(() => {\n        if (activeTab === 'reservations' && hasPermission('reservations', 'read', 'table')) {\n            loadReservations();\n        }\n    }, [activeTab]);\n\n    // Lade Tasks beim ersten Render (nur einmal, auch bei React.StrictMode)\n    useEffect(() => {\n        if (!hasLoadedRef.current) {\n            hasLoadedRef.current = true;\n            loadTasks();\n        }\n    }, []);\n\n    // URL-Parameter fr editTask verarbeiten\n    useEffect(() => {\n        if (tasks.length > 0) {\n            const queryParams = new URLSearchParams(location.search);\n            const editTaskId = queryParams.get('editTask');\n            \n            if (editTaskId) {\n                const taskId = parseInt(editTaskId, 10);\n                if (!isNaN(taskId)) {\n                    const task = tasks.find(t => t.id === taskId);\n                    if (task) {\n                        setSelectedTask(task);\n                        setIsEditModalOpen(true);\n                    }\n                }\n            }\n        }\n    }, [tasks, location.search]);\n\n    // Initialer Default-Filter setzen und Tasks laden (Controlled Mode)\n    useEffect(() => {\n        const setInitialFilterAndLoad = async () => {\n            try {\n                const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(TODOS_TABLE_ID));\n                const filters = response.data;\n                \n                const aktuellFilter = filters.find((filter: any) => filter.name === 'Aktuell');\n                if (aktuellFilter) {\n                    // 1. Filter-State setzen\n                    setActiveFilterName(t('tasks.filters.current'));\n                    setSelectedFilterId(aktuellFilter.id);\n                    \n                    // Migration: Altes Format zu neuem Format konvertieren\n                    let sortDirections = aktuellFilter.sortDirections || [];\n                    if (Array.isArray(sortDirections) && sortDirections.length > 0) {\n                        // Bereits neues Format\n                    } else if (sortDirections && typeof sortDirections === 'object' && !Array.isArray(sortDirections)) {\n                        // Altes Format: Record -> Array konvertieren\n                        sortDirections = Object.entries(sortDirections as Record<string, 'asc' | 'desc'>).map(([column, direction], index) => ({\n                            column,\n                            direction,\n                            priority: index + 1,\n                            conditionIndex: filterConditions.findIndex(c => c.column === column)\n                        }));\n                    }\n                    applyFilterConditions(aktuellFilter.conditions, aktuellFilter.operators, sortDirections);\n                    \n                    // 2. Tasks mit Standardfilter laden (server-seitig gefiltert)\n                    await loadTasks(aktuellFilter.id);\n                    \n                    // 3. Restliche Tasks im Hintergrund laden (fr Filter-Wechsel)\n                    setTimeout(() => {\n                        loadTasks(undefined, undefined, true);\n                    }, 2000); // 2 Sekunden Verzgerung, damit initiale Ladezeit nicht beeinflusst wird\n                } else {\n                    // Fallback: Alle Tasks laden (ohne Filter)\n                    await loadTasks();\n                }\n            } catch (error) {\n                console.error('Fehler beim Setzen des initialen Filters:', error);\n                // Fallback: Alle Tasks laden\n                await loadTasks();\n            }\n        };\n\n        setInitialFilterAndLoad();\n    }, []);\n\n    // Standard-Filter erstellen und speichern\n    useEffect(() => {\n        const createStandardFilters = async () => {\n            try {\n                const token = localStorage.getItem('token');\n                \n                if (!token) {\n                    console.error('Nicht authentifiziert');\n                    return;\n                }\n\n                // Prfen, ob die Standard-Filter bereits existieren\n                const existingFiltersResponse = await axiosInstance.get(\n                    `${API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(TODOS_TABLE_ID)}`,\n                    {\n                        headers: {\n                            Authorization: `Bearer ${token}`\n                        }\n                    }\n                );\n\n                const existingFilters = existingFiltersResponse.data || [];\n                const archivFilterExists = existingFilters.some(filter => filter.name === 'Archiv');\n                const aktuellFilterExists = existingFilters.some(filter => filter.name === 'Aktuell');\n\n                // Erstelle \"Archiv\"-Filter, wenn er noch nicht existiert\n                if (!archivFilterExists) {\n                    const archivFilter = {\n                        tableId: TODOS_TABLE_ID,\n                        name: 'Archiv', // Immer auf Deutsch speichern, wird beim Anzeigen bersetzt\n                        conditions: [\n                            { column: 'status', operator: 'equals', value: 'done' }\n                        ],\n                        operators: []\n                    };\n\n                    await axiosInstance.post(\n                        `${API_ENDPOINTS.SAVED_FILTERS.BASE}`,\n                        archivFilter,\n                        {\n                            headers: {\n                                Authorization: `Bearer ${token}`\n                            }\n                        }\n                    );\n                }\n\n                // Erstelle \"Aktuell\"-Filter, wenn er noch nicht existiert\n                if (!aktuellFilterExists) {\n                    const aktuellFilter = {\n                        tableId: TODOS_TABLE_ID,\n                        name: 'Aktuell', // Immer auf Deutsch speichern, wird beim Anzeigen bersetzt\n                        conditions: [\n                            { column: 'status', operator: 'notEquals', value: 'done' }\n                        ],\n                        operators: []\n                    };\n\n                    await axiosInstance.post(\n                        `${API_ENDPOINTS.SAVED_FILTERS.BASE}`,\n                        aktuellFilter,\n                        {\n                            headers: {\n                                Authorization: `Bearer ${token}`\n                            }\n                        }\n                    );\n                }\n            } catch (error) {\n                console.error('Fehler beim Erstellen der Standard-Filter:', error);\n            }\n        };\n\n        createStandardFilters();\n    }, []);\n\n    // getStatusColor und getStatusText werden jetzt von statusUtils verwendet (siehe getStatusLabel oben)\n\n    const handleStatusChange = async (taskId: number, newStatus: Task['status']) => {\n        try {\n            // Optimistisches Update: State sofort aktualisieren\n            setTasks(prevTasks => {\n                const validTasks = prevTasks.filter(task => task != null);\n                return validTasks.map(task => \n                    task.id === taskId ? { ...task, status: newStatus } : task\n                );\n            });\n\n            await axiosInstance.patch(API_ENDPOINTS.TASKS.BY_ID(taskId), { status: newStatus });\n            toast.success(t('worktime.messages.taskUpdated'));\n        } catch (error) {\n            // Rollback bei Fehler: Vollstndiges Reload\n            console.error('Fehler beim Aktualisieren des Status:', error);\n            loadTasks();\n                toast.error(t('worktime.messages.taskUpdatedError'));\n        }\n    };\n\n    const handleEditClick = (task: Task) => {\n        setSelectedTask(task);\n        setIsEditModalOpen(true);\n    };\n\n    const isResponsibleForTask = (task: Task) => {\n        if (task.responsible) {\n            return task.responsible.id === user?.id;\n        } else if (task.role) {\n            // Prfe, ob der Benutzer die angegebene Rolle hat\n            return user?.roles?.some(userRole => userRole.role?.id === task.role?.id) || false;\n        }\n        return false;\n    };\n\n    const isQualityControlForTask = (task: Task) => {\n        return task.qualityControl?.id === user?.id;\n    };\n\n    const handleSort = (key: SortConfig['key']) => {\n        // Nur fr Tabellen-Ansicht (Header-Sortierung)\n        if (viewMode === 'table') {\n            setTableSortConfig(current => ({\n                key,\n                direction: current.key === key && current.direction === 'asc' ? 'desc' : 'asc'\n            }));\n        }\n    };\n\n    const renderStatusButtons = (task: Task): JSX.Element[] => {\n        const buttons: JSX.Element[] = [];\n        \n        // Prfe, ob der Benutzer Schreibberechtigungen fr Tasks hat\n        const canModifyTasks = hasPermission('tasks', 'write', 'table');\n        \n        if (!canModifyTasks) return buttons;\n        \n        // Zurck-Button (links)\n        if (task.status === 'in_progress' && isResponsibleForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"back\"\n                        onClick={() => handleStatusChange(task.id, 'open')}\n                        className=\"p-1.5 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600\"\n                    >\n                        <ArrowLeftIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.backToOpen')}\n                    </div>\n                </div>\n            );\n        } else if (task.status === 'quality_control' && isResponsibleForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"back\"\n                        onClick={() => handleStatusChange(task.id, 'in_progress')}\n                        className=\"p-1.5 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600\"\n                    >\n                        <ArrowLeftIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.backToInProgress')}\n                    </div>\n                </div>\n            );\n        } else if (task.status === 'done' && isQualityControlForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"back\"\n                        onClick={() => handleStatusChange(task.id, 'quality_control')}\n                        className=\"p-2 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600\"\n                    >\n                        <ArrowLeftIcon className=\"h-6 w-6\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.backToQualityControl')}\n                    </div>\n                </div>\n            );\n        }\n\n        // Weiter-Button (rechts)\n        if (task.status === 'open' && isResponsibleForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"forward\"\n                        onClick={() => handleStatusChange(task.id, 'in_progress')}\n                        className=\"p-1.5 bg-blue-600 dark:bg-blue-500 text-white rounded hover:bg-blue-700 dark:hover:bg-blue-600\"\n                    >\n                        <ArrowRightIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.setInProgress')}\n                    </div>\n                </div>\n            );\n        } else if (task.status === 'in_progress' && isResponsibleForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"forward\"\n                        onClick={() => handleStatusChange(task.id, 'quality_control')}\n                        className=\"p-1.5 bg-purple-600 dark:bg-purple-500 text-white rounded hover:bg-purple-700 dark:hover:bg-purple-600\"\n                    >\n                        <ArrowRightIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.setQualityControl')}\n                    </div>\n                </div>\n            );\n        } else if (task.status === 'quality_control' && isQualityControlForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"forward\"\n                        onClick={() => handleStatusChange(task.id, 'done')}\n                        className=\"p-1.5 bg-green-600 dark:bg-green-500 text-white rounded hover:bg-green-700 dark:hover:bg-green-600\"\n                    >\n                        <ArrowRightIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.markDone')}\n                    </div>\n                </div>\n            );\n        }\n\n        return buttons;\n    };\n\n    const getActiveFilterCount = () => {\n        if (activeTab === 'todos') {\n            return filterConditions.length;\n        } else {\n            return reservationFilterConditions.length;\n        }\n    };\n\n    const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections?: Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>) => {\n        setFilterConditions(conditions);\n        setFilterLogicalOperators(operators);\n        if (sortDirections !== undefined) {\n            // Sicherstellen, dass sortDirections ein Array ist\n            const validSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n            setFilterSortDirections(validSortDirections);\n        }\n    };\n    \n    const resetFilterConditions = () => {\n        setFilterConditions([]);\n        setFilterLogicalOperators([]);\n        setFilterSortDirections([]);\n        setActiveFilterName('');\n        setSelectedFilterId(null);\n    };\n    \n    // Reservations Filter Functions\n    const applyReservationFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections?: Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>) => {\n        setReservationFilterConditions(conditions);\n        setReservationFilterLogicalOperators(operators);\n        if (sortDirections !== undefined) {\n            const validSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n            setReservationFilterSortDirections(validSortDirections);\n        }\n    };\n    \n    const resetReservationFilterConditions = () => {\n        setReservationFilterConditions([]);\n        setReservationFilterLogicalOperators([]);\n        setReservationFilterSortDirections([]);\n        setReservationActiveFilterName('');\n        setReservationSelectedFilterId(null);\n    };\n    \n    // Filter Change Handler (Controlled Mode)\n    const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections?: Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>) => {\n        if (activeTab === 'todos') {\n            setActiveFilterName(name);\n            setSelectedFilterId(id);\n            applyFilterConditions(conditions, operators, sortDirections);\n            \n            // Wenn Filter-ID vorhanden (Standardfilter): Server-seitig laden\n            // Sonst: Client-seitig filtern (komplexe Filter)\n            if (id) {\n                await loadTasks(id);\n            }\n            // Wenn kein ID: Client-seitiges Filtering wird automatisch durch filteredAndSortedTasks angewendet\n        } else {\n            setReservationActiveFilterName(name);\n            setReservationSelectedFilterId(id);\n            applyReservationFilterConditions(conditions, operators, sortDirections);\n        }\n    };\n\n    const getStatusPriority = (status: Task['status']): number => {\n        switch (status) {\n            case 'open': return 1;\n            case 'in_progress': return 2;\n            case 'improval': return 3;\n            case 'quality_control': return 4;\n            case 'done': return 5;\n            default: return 99; // Fallback fr unbekannte Status\n        }\n    };\n\n    // Status-Farben fr Reservations\n    const getReservationStatusColor = (status: ReservationStatus): string => {\n        switch (status) {\n            case ReservationStatus.CONFIRMED:\n                return 'bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200';\n            case ReservationStatus.NOTIFICATION_SENT:\n                return 'bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200';\n            case ReservationStatus.CHECKED_IN:\n                return 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200';\n            case ReservationStatus.CHECKED_OUT:\n                return 'bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200';\n            case ReservationStatus.CANCELLED:\n                return 'bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200';\n            case ReservationStatus.NO_SHOW:\n                return 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200';\n            default:\n                return 'bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200';\n        }\n    };\n\n    const getPaymentStatusColor = (status: PaymentStatus): string => {\n        switch (status) {\n            case PaymentStatus.PAID:\n                return 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200';\n            case PaymentStatus.PARTIALLY_PAID:\n                return 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200';\n            case PaymentStatus.REFUNDED:\n                return 'bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200';\n            case PaymentStatus.PENDING:\n            default:\n                return 'bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200';\n        }\n    };\n\n    const filteredAndSortedTasks = useMemo(() => {\n        // Verwende allTasks, wenn verfgbar und kein Standardfilter aktiv (fr komplexe Filter)\n        // Sonst verwende tasks (bereits server-seitig gefiltert)\n        const tasksToFilter = (allTasks.length > 0 && !selectedFilterId) ? allTasks : tasks;\n        \n        console.log(' Filtere Tasks:', tasksToFilter.length, 'Tasks vorhanden');\n        console.log(' Filterbedingungen:', filterConditions);\n        console.log(' Verwende:', allTasks.length > 0 && !selectedFilterId ? 'allTasks (client-seitig)' : 'tasks (server-seitig gefiltert)');\n        \n        // Sicherstellen, dass keine undefined/null Werte im Array sind\n        const validTasks = tasksToFilter.filter(task => task != null);\n        const filtered = validTasks\n            .filter(task => {\n                // Globale Suchfunktion\n                if (searchTerm) {\n                    const searchLower = searchTerm.toLowerCase();\n                    const matchesSearch = \n                        task.title.toLowerCase().includes(searchLower) ||\n                        (task.description && task.description.toLowerCase().includes(searchLower)) ||\n                        (task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}`.toLowerCase().includes(searchLower) : false) ||\n                        (task.role ? task.role.name.toLowerCase().includes(searchLower) : false) ||\n                        (task.qualityControl && `${task.qualityControl.firstName} ${task.qualityControl.lastName}`.toLowerCase().includes(searchLower)) ||\n                        task.branch.name.toLowerCase().includes(searchLower);\n                    \n                    if (!matchesSearch) return false;\n                }\n                \n                // Wenn erweiterte Filterbedingungen definiert sind, wende diese an\n                if (filterConditions.length > 0) {\n                    // Column-Evaluatoren fr Tasks mit korrekter User/Role-Logik\n                    const columnEvaluators: any = {\n                        'title': (task: Task, cond: FilterCondition) => {\n                            const value = (cond.value as string || '').toLowerCase();\n                            const title = task.title.toLowerCase();\n                            if (cond.operator === 'equals') return task.title === cond.value;\n                            if (cond.operator === 'contains') return title.includes(value);\n                            if (cond.operator === 'startsWith') return title.startsWith(value);\n                            if (cond.operator === 'endsWith') return title.endsWith(value);\n                            return null;\n                        },\n                        'status': (task: Task, cond: FilterCondition) => {\n                            if (cond.operator === 'equals') return task.status === cond.value;\n                            if (cond.operator === 'notEquals') return task.status !== cond.value;\n                            return null;\n                        },\n                        'responsible': (task: Task, cond: FilterCondition) => {\n                            // Untersttzt user-{id} und role-{id} Format\n                            const responsibleName = task.responsible\n                                ? `${task.responsible.firstName} ${task.responsible.lastName}`\n                                : task.role\n                                    ? task.role.name\n                                    : '';\n                            return evaluateUserRoleCondition(\n                                task.responsible?.id || null,\n                                task.role?.id || null,\n                                cond,\n                                responsibleName\n                            );\n                        },\n                        'qualityControl': (task: Task, cond: FilterCondition) => {\n                            // Untersttzt nur user-{id} Format (keine Rollen)\n                            const qualityControlName = task.qualityControl\n                                ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}`\n                                : '';\n                            return evaluateUserRoleCondition(\n                                task.qualityControl?.id || null,\n                                null, // QualityControl hat keine Rollen\n                                cond,\n                                qualityControlName\n                            );\n                        },\n                        'responsibleAndQualityControl': (task: Task, cond: FilterCondition) => {\n                            // Untersttzt user-{id} und role-{id} Format fr beide Felder\n                            const responsibleName = task.responsible\n                                ? `${task.responsible.firstName} ${task.responsible.lastName}`\n                                : task.role\n                                    ? task.role.name\n                                    : '';\n                            const qualityControlName = task.qualityControl\n                                ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}`\n                                : '';\n                            return evaluateResponsibleAndQualityControl(\n                                task.responsible?.id || null,\n                                task.role?.id || null,\n                                task.qualityControl?.id || null,\n                                cond,\n                                responsibleName,\n                                qualityControlName\n                            );\n                        },\n                        'branch': (task: Task, cond: FilterCondition) => {\n                            const branchName = task.branch.name.toLowerCase();\n                            const value = (cond.value as string || '').toLowerCase();\n                            if (cond.operator === 'equals') return branchName === value;\n                            if (cond.operator === 'contains') return branchName.includes(value);\n                            return null;\n                        },\n                        'dueDate': (task: Task, cond: FilterCondition) => {\n                            return evaluateDateCondition(task.dueDate, cond);\n                        }\n                    };\n\n                    const getFieldValue = (task: Task, columnId: string): any => {\n                        switch (columnId) {\n                            case 'title': return task.title;\n                            case 'status': return task.status;\n                            case 'responsible': return task.responsible\n                                ? `${task.responsible.firstName} ${task.responsible.lastName}`\n                                : task.role\n                                    ? task.role.name\n                                    : '';\n                            case 'qualityControl': return task.qualityControl\n                                ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}`\n                                : '';\n                            case 'responsibleAndQualityControl': return task.responsible\n                                ? `${task.responsible.firstName} ${task.responsible.lastName}`\n                                : task.role\n                                    ? task.role.name\n                                    : '';\n                            case 'branch': return task.branch.name;\n                            case 'dueDate': return task.dueDate;\n                            default: return (task as any)[columnId];\n                        }\n                    };\n\n                    // Wende Filter mit zentraler Logik an (nur fr dieses einzelne Item)\n                    const filtered = applyFilters(\n                        [task],\n                        filterConditions,\n                        filterLogicalOperators,\n                        getFieldValue,\n                        columnEvaluators\n                    );\n                    \n                    if (filtered.length === 0) return false;\n                }\n                \n                return true;\n            });\n        \n        console.log(' Gefilterte Tasks:', filtered.length, 'von', tasks.length);\n        \n        // Hilfsfunktion zum Extrahieren von Werten fr Sortierung\n        const getSortValue = (task: Task, columnId: string): any => {\n            switch (columnId) {\n                case 'title':\n                    return task.title.toLowerCase();\n                case 'status':\n                    return getStatusPriority(task.status);\n                case 'responsible':\n                case 'responsibleAndQualityControl':\n                    return task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}`.toLowerCase() : (task.role ? `Rolle: ${task.role.name}`.toLowerCase() : '');\n                case 'qualityControl':\n                    return task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}`.toLowerCase() : '';\n                case 'branch':\n                    return task.branch.name.toLowerCase();\n                case 'dueDate':\n                    return task.dueDate ? new Date(task.dueDate).getTime() : Number.MAX_SAFE_INTEGER;\n                case 'description':\n                    return (task.description || '').toLowerCase();\n                default:\n                    return '';\n            }\n        };\n        \n        const sorted = filtered.sort((a, b) => {\n            // 1. Prioritt: Filter-Sortierrichtungen (wenn Filter aktiv)\n            if (filterSortDirections.length > 0 && filterConditions.length > 0) {\n                // Sortiere nach Prioritt (1, 2, 3, ...)\n                const sortedByPriority = [...filterSortDirections].sort((sd1, sd2) => sd1.priority - sd2.priority);\n                \n                for (const sortDir of sortedByPriority) {\n                    const valueA = getSortValue(a, sortDir.column);\n                    const valueB = getSortValue(b, sortDir.column);\n                    \n                    let comparison = 0;\n                    if (typeof valueA === 'number' && typeof valueB === 'number') {\n                        comparison = valueA - valueB;\n                    } else {\n                        comparison = String(valueA).localeCompare(String(valueB));\n                    }\n                    \n                    if (sortDir.direction === 'desc') {\n                        comparison = -comparison;\n                    }\n                    \n                    if (comparison !== 0) {\n                        return comparison;\n                    }\n                }\n                return 0;\n            }\n            \n            // 2. Prioritt: Tabellen-Header-Sortierung (nur fr Tabellen-Ansicht, wenn kein Filter aktiv)\n            if (viewMode === 'table' && tableSortConfig.key) {\n                let valueA: any, valueB: any;\n                \n                switch (tableSortConfig.key) {\n                    case 'title':\n                        valueA = a.title;\n                        valueB = b.title;\n                        break;\n                    case 'status':\n                        valueA = getStatusPriority(a.status);\n                        valueB = getStatusPriority(b.status);\n                        break;\n                    case 'responsible.firstName':\n                        valueA = a.responsible ? `${a.responsible.firstName} ${a.responsible.lastName}` : (a.role ? `Rolle: ${a.role.name}` : '');\n                        valueB = b.responsible ? `${b.responsible.firstName} ${b.responsible.lastName}` : (b.role ? `Rolle: ${b.role.name}` : '');\n                        break;\n                    case 'qualityControl.firstName':\n                        valueA = a.qualityControl ? `${a.qualityControl.firstName} ${a.qualityControl.lastName}` : '';\n                        valueB = b.qualityControl ? `${b.qualityControl.firstName} ${b.qualityControl.lastName}` : '';\n                        break;\n                    case 'branch.name':\n                        valueA = a.branch.name;\n                        valueB = b.branch.name;\n                        break;\n                    case 'dueDate':\n                        valueA = a.dueDate ? new Date(a.dueDate).getTime() : Number.MAX_SAFE_INTEGER;\n                        valueB = b.dueDate ? new Date(b.dueDate).getTime() : Number.MAX_SAFE_INTEGER;\n                        break;\n                    default:\n                        valueA = a[tableSortConfig.key as keyof Task];\n                        valueB = b[tableSortConfig.key as keyof Task];\n                }\n                \n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    return tableSortConfig.direction === 'asc' ? valueA - valueB : valueB - valueA;\n                } else {\n                    const comparison = String(valueA).localeCompare(String(valueB));\n                    return tableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 3. Fallback: Standardsortierung (wenn keine benutzerdefinierte Sortierung)\n            const aDate = a.dueDate ? new Date(a.dueDate).getTime() : Number.MAX_SAFE_INTEGER;\n            const bDate = b.dueDate ? new Date(b.dueDate).getTime() : Number.MAX_SAFE_INTEGER;\n            \n            if (aDate !== bDate) {\n                return aDate - bDate;\n            }\n            \n            const aStatusPrio = getStatusPriority(a.status);\n            const bStatusPrio = getStatusPriority(b.status);\n            \n            if (aStatusPrio !== bStatusPrio) {\n                return aStatusPrio - bStatusPrio;\n            }\n            \n            return a.title.localeCompare(b.title);\n        });\n        \n        console.log(' Gefilterte und sortierte Tasks:', sorted.length);\n        return sorted;\n    }, [tasks, allTasks, selectedFilterId, searchTerm, tableSortConfig, getStatusPriority, filterConditions, filterLogicalOperators, filterSortDirections, viewMode]);\n\n    // Filter- und Sortierlogik fr Reservations\n    const filteredAndSortedReservations = useMemo(() => {\n        console.log(' Filtere Reservations:', reservations.length, 'Reservations vorhanden');\n        const validReservations = reservations.filter(reservation => reservation != null);\n        \n        const filtered = validReservations.filter(reservation => {\n            // Status-Filter\n            if (reservationFilterStatus !== 'all' && reservation.status !== reservationFilterStatus) {\n                return false;\n            }\n            \n            // Payment-Status-Filter\n            if (reservationFilterPaymentStatus !== 'all' && reservation.paymentStatus !== reservationFilterPaymentStatus) {\n                return false;\n            }\n            \n            // Such-Filter\n            if (reservationSearchTerm) {\n                const searchLower = reservationSearchTerm.toLowerCase();\n                const matchesSearch = \n                    reservation.guestName.toLowerCase().includes(searchLower) ||\n                    (reservation.guestEmail && reservation.guestEmail.toLowerCase().includes(searchLower)) ||\n                    (reservation.guestPhone && reservation.guestPhone.toLowerCase().includes(searchLower)) ||\n                    (reservation.roomNumber && reservation.roomNumber.toLowerCase().includes(searchLower)) ||\n                    (reservation.lobbyReservationId && reservation.lobbyReservationId.toLowerCase().includes(searchLower));\n                \n                if (!matchesSearch) return false;\n            }\n            \n            return true;\n        });\n        \n        // Sortiere nach Check-in-Datum (neueste zuerst)\n        const sorted = [...filtered].sort((a, b) => {\n            return new Date(b.checkInDate).getTime() - new Date(a.checkInDate).getTime();\n        });\n        \n        console.log(' Gefilterte und sortierte Reservations:', sorted.length);\n        return sorted;\n    }, [reservations, reservationFilterStatus, reservationFilterPaymentStatus, reservationSearchTerm]);\n\n    // Handler fr das Verschieben von Spalten per Drag & Drop\n    const handleMoveColumn = (dragIndex: number, hoverIndex: number) => {\n        // Neue Spaltenreihenfolge erstellen\n        const newColumnOrder = [...settings.columnOrder];\n        const draggedColumn = newColumnOrder[dragIndex];\n        \n        // Spalten neu anordnen\n        newColumnOrder.splice(dragIndex, 1); // Entferne die gezogene Spalte\n        newColumnOrder.splice(hoverIndex, 0, draggedColumn); // Fge sie an der neuen Position ein\n        \n        // Aktualisiere die Spaltenreihenfolge\n        updateColumnOrder(newColumnOrder);\n    };\n\n    // Handler fr Drag & Drop direkt in der Tabelle\n    const handleDragStart = (columnId: string) => {\n        setDraggedColumn(columnId);\n    };\n\n    const handleDragOver = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n        if (draggedColumn && draggedColumn !== columnId) {\n            setDragOverColumn(columnId);\n        }\n    };\n\n    const handleDrop = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n        if (draggedColumn && draggedColumn !== columnId) {\n            const dragIndex = settings.columnOrder.indexOf(draggedColumn);\n            const hoverIndex = settings.columnOrder.indexOf(columnId);\n            \n            if (dragIndex > -1 && hoverIndex > -1) {\n                handleMoveColumn(dragIndex, hoverIndex);\n            }\n        }\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n\n    const handleDragEnd = () => {\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n\n    // Filtern und sortieren der Spalten gem den Benutzereinstellungen\n    // Sicherstellen, dass alle Spalten aus defaultColumnOrder in columnOrder enthalten sind\n    const completeColumnOrder = useMemo(() => {\n        const currentOrder = settings.columnOrder || [];\n        // Sicherstellen, dass keine undefined/null Werte im Array sind\n        const validOrder = currentOrder.filter(id => id != null && typeof id === 'string');\n        // Fehlende Spalten aus defaultColumnOrder hinzufgen (dynamisch basierend auf activeTab)\n        const defaultOrder = activeTab === 'todos' ? defaultColumnOrder : defaultReservationColumnOrder;\n        const missingColumns = defaultOrder.filter(id => !validOrder.includes(id));\n        return [...validOrder, ...missingColumns];\n    }, [settings.columnOrder, activeTab, defaultColumnOrder, defaultReservationColumnOrder]);\n\n    const visibleColumnIds = completeColumnOrder.filter(id => id != null && typeof id === 'string' && isColumnVisible(id));\n\n    // Funktion zum Kopieren eines Tasks\n    const handleCopyTask = async (task: Task) => {\n        try {\n            // Kopie des Tasks erstellen mit angepasstem Titel\n            const copiedTaskData = {\n                title: `${task.title}-Kopie`,\n                description: task.description,\n                status: 'open', // Immer als \"offen\" erstellen\n                responsibleId: task.responsible ? task.responsible.id : null,\n                roleId: task.role ? task.role.id : null,\n                qualityControlId: task.qualityControl?.id || null,\n                branchId: task.branch.id,\n                dueDate: task.dueDate\n            };\n\n            // Task erstellen\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.TASKS.BASE,\n                copiedTaskData\n            );\n\n            // Optimistisches Update: Neuen Task zur Liste hinzufgen statt vollstndigem Reload\n            setTasks(prevTasks => [response.data, ...prevTasks]);\n            \n            // Bearbeitungsmodal fr den kopierten Task ffnen\n            setSelectedTask(response.data);\n            setIsEditModalOpen(true);\n            \n        } catch (err) {\n            console.error('Fehler beim Kopieren des Tasks:', err);\n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleDeleteTask = async (taskId: number) => {\n        if (window.confirm(t('worktime.messages.taskDeleteConfirm'))) {\n            console.log(' Starte Lschung von Task:', taskId);\n            console.log(' Aktuelle Tasks vor Lschung:', tasks.length);\n            \n            // Optimistisches Update: Task sofort aus Liste entfernen fr sofortiges Feedback\n            // Sicherstellen, dass keine undefined/null Werte im Array bleiben\n            setTasks(prevTasks => {\n                const filtered = prevTasks.filter(task => task != null && task.id !== taskId);\n                console.log(' Tasks nach Filterung:', filtered.length, 'von', prevTasks.length);\n                return filtered;\n            });\n\n            try {\n                console.log(' Sende Delete-Request...');\n                await axiosInstance.delete(API_ENDPOINTS.TASKS.BY_ID(taskId));\n                console.log(' Delete erfolgreich');\n                // Erfolgs-Rckmeldung anzeigen\n                toast.success(t('worktime.messages.taskDeleted'));\n            } catch (error) {\n                // Rollback bei Fehler: Vollstndiges Reload\n                console.error(' Fehler beim Lschen der Aufgabe:', error);\n                loadTasks();\n                toast.error(t('worktime.messages.taskDeletedError'));\n            }\n        }\n    };\n\n    const handleSaveTask = async (task: Task) => {\n        try {\n            await axiosInstance.put(API_ENDPOINTS.TASKS.BY_ID(task.id), task);\n            // Aktualisiere die Aufgabenliste\n            loadTasks();\n            setIsEditModalOpen(false);\n            setSelectedTask(null);\n            toast.success(t('worktime.messages.taskUpdated'));\n        } catch (error) {\n            console.error('Fehler beim Speichern der Aufgabe:', error);\n                toast.error(t('worktime.messages.taskSaveError'));\n        }\n    };\n\n    return (\n        <div className=\"min-h-screen dark:bg-gray-900\">\n            <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\n                {/* Neu angeordnete UI-Elemente in einer Zeile */}\n                <div className=\"w-full mb-4\">\n                    {/* Auf mobilen Gerten wird diese Reihenfolge angezeigt - Tasks oben, Zeiterfassung unten */}\n                    <div className=\"block sm:hidden w-full\">\n                    {/* Tasks */}\n                        <div className=\"dashboard-tasks-wrapper bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 w-full mb-20\">\n                            <div className=\"flex items-center justify-between px-3 sm:px-4 md:px-6\">\n                                {/* Linke Seite: \"Neuer Task\"-Button */}\n                                <div className=\"flex items-center\">\n                                    {hasPermission('tasks', 'write', 'table') && (\n                                        <div className=\"relative group\">\n                                            <button \n                                                onClick={() => setIsCreateModalOpen(true)}\n                                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                                style={{ width: '30.19px', height: '30.19px' }}\n                                                aria-label={t('tasks.createTask')}\n                                            >\n                                                <PlusIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {t('tasks.createTask')}\n                                            </div>\n                                        </div>\n                                    )}\n                                </div>\n                                \n                                {/* Mitte: Titel */}\n                                <div className=\"flex items-center\">\n                                    <CheckCircleIcon className=\"h-4 w-4 sm:h-6 sm:w-6 mr-1 sm:mr-2 dark:text-white\" />\n                                    <h2 className=\"text-base sm:text-xl font-semibold dark:text-white\">\n                                        {activeTab === 'todos' ? t('tasks.title') : t('reservations.title', 'Reservations')}\n                                    </h2>\n                                </div>\n                                \n                                {/* Rechte Seite: Suchfeld, Filter-Button, Status-Filter, Spalten-Konfiguration */}\n                                <div className=\"flex items-center gap-1.5\">\n                                    <input\n                                        type=\"text\"\n                                        placeholder={t('common.search') + '...'}\n                                        className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                                        value={searchTerm}\n                                        onChange={(e) => setSearchTerm(e.target.value)}\n                                    />\n                                    \n                                    {/* View-Mode Toggle */}\n                                    <div className=\"relative group\">\n                                        <button\n                                            className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n                                                viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n                                            }`}\n                                            onClick={() => updateViewMode(viewMode === 'table' ? 'cards' : 'table')}\n                                        >\n                                            {viewMode === 'table' ? (\n                                                <Squares2X2Icon className=\"h-5 w-5\" />\n                                            ) : (\n                                                <TableCellsIcon className=\"h-5 w-5\" />\n                                            )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Filter-Button */}\n                                    <div className=\"relative group ml-1\">\n                                        <button\n                                            className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n                                            onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                                        >\n                                            <FunnelIcon className=\"h-5 w-5\" />\n                                            {getActiveFilterCount() > 0 && (\n                                                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                                    {getActiveFilterCount()}\n                                                </span>\n                                            )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {t('common.filter')}\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Spalten-Konfiguration */}\n                                    <div className=\"ml-1\">\n                                        <TableColumnConfig \n                                            columns={activeTab === 'todos'\n                                                ? (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'title', label: t('tasks.columns.title') },\n                                                        { id: 'status', label: t('tasks.columns.status') },\n                                                        { id: 'responsible', label: t('tasks.columns.responsible') },\n                                                        { id: 'qualityControl', label: t('tasks.columns.qualityControl') },\n                                                        { id: 'branch', label: t('tasks.columns.branch') },\n                                                        { id: 'dueDate', label: t('tasks.columns.dueDate') },\n                                                        { id: 'description', label: t('tasks.columns.description') }\n                                                    ]\n                                                    : availableColumns)\n                                                : (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'guestName', label: t('reservations.columns.guestName', 'Gast') },\n                                                        { id: 'status', label: t('reservations.columns.status', 'Status') },\n                                                        { id: 'paymentStatus', label: t('reservations.columns.paymentStatus', 'Zahlungsstatus') },\n                                                        { id: 'checkInDate', label: t('reservations.columns.checkInDate', 'Check-in') },\n                                                        { id: 'checkOutDate', label: t('reservations.columns.checkOutDate', 'Check-out') },\n                                                        { id: 'roomNumber', label: t('reservations.columns.roomNumber', 'Zimmer') },\n                                                        { id: 'guestEmail', label: t('reservations.columns.guestEmail', 'E-Mail') },\n                                                        { id: 'guestPhone', label: t('reservations.columns.guestPhone', 'Telefon') },\n                                                        { id: 'amount', label: t('reservations.columns.amount', 'Betrag') },\n                                                        { id: 'arrivalTime', label: t('reservations.columns.arrivalTime', 'Ankunftszeit') }\n                                                    ]\n                                                    : availableReservationColumns)}\n                                            visibleColumns={viewMode === 'cards'\n                                                ? Array.from(visibleCardMetadata)\n                                                : visibleColumnIds}\n                                            columnOrder={viewMode === 'cards'\n                                                ? cardMetadataOrder\n                                                : settings.columnOrder}\n                                            onToggleColumnVisibility={(columnId) => {\n                                                if (viewMode === 'cards') {\n                                                    // Fr Cards: Mapping zurck zu Tabellen-Spalten\n                                                    const tableColumn = cardToTableMapping[columnId];\n                                                    if (tableColumn) {\n                                                        // Spezielle Logik fr responsibleAndQualityControl\n                                                        if (tableColumn === 'responsibleAndQualityControl') {\n                                                            // Prfe ob beide bereits ausgeblendet sind\n                                                            const otherCardMeta = columnId === 'responsible' ? 'qualityControl' : 'responsible';\n                                                            const otherHidden = hiddenCardMetadata.has(otherCardMeta);\n                                                            const currentlyHidden = settings.hiddenColumns.includes(tableColumn);\n                                                            \n                                                            if (currentlyHidden && !otherHidden) {\n                                                                // Eine der beiden wird wieder angezeigt, also responsibleAndQualityControl wieder anzeigen\n                                                                toggleColumnVisibility(tableColumn);\n                                                            } else if (!currentlyHidden && otherHidden) {\n                                                                // Die andere ist bereits ausgeblendet, also responsibleAndQualityControl ausblenden\n                                                                toggleColumnVisibility(tableColumn);\n                                                            } else if (!currentlyHidden) {\n                                                                // Erste wird ausgeblendet, responsibleAndQualityControl ausblenden\n                                                                toggleColumnVisibility(tableColumn);\n                                                            } else {\n                                                                // Beide sind ausgeblendet, eine wird wieder angezeigt\n                                                                toggleColumnVisibility(tableColumn);\n                                                            }\n                                                        } else {\n                                                            // Normale Spalte: direkt ein/ausblenden\n                                                            toggleColumnVisibility(tableColumn);\n                                                        }\n                                                    }\n                                                } else {\n                                                    toggleColumnVisibility(columnId);\n                                                }\n                                            }}\n                                            onMoveColumn={viewMode === 'cards'\n                                                ? (dragIndex: number, hoverIndex: number) => {\n                                                    const newCardOrder = [...cardMetadataOrder];\n                                                    const dragged = newCardOrder[dragIndex];\n                                                    newCardOrder.splice(dragIndex, 1);\n                                                    newCardOrder.splice(hoverIndex, 0, dragged);\n                                                    \n                                                    // Konvertiere zurck zu Tabellen-Spalten-Reihenfolge\n                                                    const newTableOrder: string[] = [];\n                                                    const usedTableColumns = new Set<string>();\n                                                    \n                                                    newCardOrder.forEach(cardMeta => {\n                                                        const tableCol = cardToTableMapping[cardMeta];\n                                                        if (tableCol && !usedTableColumns.has(tableCol)) {\n                                                            usedTableColumns.add(tableCol);\n                                                            newTableOrder.push(tableCol);\n                                                        }\n                                                    });\n                                                    \n                                                    // Fge fehlende Tabellen-Spalten hinzu\n                                                    availableColumns.forEach(col => {\n                                                        if (!newTableOrder.includes(col.id) && col.id !== 'actions') {\n                                                            newTableOrder.push(col.id);\n                                                        }\n                                                    });\n                                                    \n                                                    updateColumnOrder(newTableOrder);\n                                                }\n                                                : handleMoveColumn}\n                                            buttonTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                                            modalTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                                            onClose={() => {}}\n                                        />\n                                    </div>\n                                </div>\n                            </div>\n\n                            {/* Tab-Navigation */}\n                            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6 px-3 sm:px-4 md:px-6\">\n                                <nav className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden\">\n                                    <button\n                                        onClick={() => setActiveTab('todos')}\n                                        className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ${\n                                            activeTab === 'todos'\n                                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                        }`}\n                                    >\n                                        {t('tasks.title', \"To Do's\")}\n                                    </button>\n                                    {hasPermission('reservations', 'read', 'table') && (\n                                        <button\n                                            onClick={() => setActiveTab('reservations')}\n                                            className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ${\n                                                activeTab === 'reservations'\n                                                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                            }`}\n                                        >\n                                            {t('reservations.title', 'Reservations')}\n                                        </button>\n                                    )}\n                                </nav>\n                            </div>\n\n                            {/* Filter-Pane */}\n                            {isFilterModalOpen && (\n                                <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n                                    {activeTab === 'todos' ? (\n                                        <FilterPane\n                                            columns={[...availableColumns, ...filterOnlyColumns]}\n                                            onApply={applyFilterConditions}\n                                            onReset={resetFilterConditions}\n                                            savedConditions={filterConditions}\n                                            savedOperators={filterLogicalOperators}\n                                            savedSortDirections={filterSortDirections}\n                                            onSortDirectionsChange={setFilterSortDirections}\n                                            tableId={TODOS_TABLE_ID}\n                                        />\n                                    ) : (\n                                        <FilterPane\n                                            columns={[...availableReservationColumns, ...reservationFilterOnlyColumns]}\n                                            onApply={applyReservationFilterConditions}\n                                            onReset={resetReservationFilterConditions}\n                                            savedConditions={reservationFilterConditions}\n                                            savedOperators={reservationFilterLogicalOperators}\n                                            savedSortDirections={reservationFilterSortDirections}\n                                            onSortDirectionsChange={setReservationFilterSortDirections}\n                                            tableId={RESERVATIONS_TABLE_ID}\n                                        />\n                                    )}\n                                </div>\n                            )}\n\n                            {/* Gespeicherte Filter als Tags anzeigen */}\n                            {(\n                                <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n                                    <SavedFilterTags\n                                    tableId={activeTab === 'todos' ? TODOS_TABLE_ID : RESERVATIONS_TABLE_ID}\n                                    onSelectFilter={activeTab === 'todos' ? applyFilterConditions : applyReservationFilterConditions}\n                                    onReset={activeTab === 'todos' ? resetFilterConditions : resetReservationFilterConditions}\n                                    activeFilterName={activeTab === 'todos' ? activeFilterName : reservationActiveFilterName}\n                                    selectedFilterId={activeTab === 'todos' ? selectedFilterId : reservationSelectedFilterId}\n                                    onFilterChange={handleFilterChange}\n                                    defaultFilterName={activeTab === 'todos' ? t('tasks.filters.current') : t('reservations.filters.current', 'Aktuell')}\n                                />\n                                </div>\n                            )}\n                            \n                            {/* Tabelle oder Cards - nur aktiven Tab rendern */}\n                            {activeTab === 'todos' && viewMode === 'table' ? (\n                                /* Tabellen-Ansicht - Tasks */\n                                <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                        <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <tr>\n                                                {visibleColumnIds.map((columnId) => {\n                                                    const column = availableColumns.find(col => col.id === columnId);\n                                                    if (!column) return null;\n                                                    \n                                                    return (\n                                                        <th\n                                                            key={columnId}\n                                                            scope=\"col\"\n                                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                                            draggable={true}\n                                                            onDragStart={() => handleDragStart(columnId)}\n                                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                                            onDrop={(e) => handleDrop(e, columnId)}\n                                                            onDragEnd={handleDragEnd}\n                                                        >\n                                                            <div className=\"flex items-center\">\n                                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                                {columnId !== 'actions' && (\n                                                                    <button \n                                                                        onClick={() => handleSort(columnId as keyof Task)}\n                                                                        className=\"ml-1 focus:outline-none\"\n                                                                    >\n                                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                                    </button>\n                                                                )}\n                                                            </div>\n                                                        </th>\n                                                    );\n                                                })}\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                            {loading ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-4 text-center\">\n                                                        <div className=\"flex justify-center\">\n                                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : error ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-red-600 dark:text-red-400\">\n                                                        {error}\n                                                    </td>\n                                                </tr>\n                                            ) : filteredAndSortedTasks.length === 0 ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                                                        <div className=\"flex flex-col items-center justify-center gap-4\">\n                                                        <ClipboardDocumentListIcon className=\"h-10 w-10 text-gray-400 dark:text-gray-500\" />\n                                                        <div className=\"text-sm\">{t('tasks.noTasksFound')}</div>\n                                                    </div>\n                                                </td>\n                                            </tr>\n                                        ) : (\n                                            <>\n                                            {filteredAndSortedTasks.slice(0, displayLimit).map(task => {\n                                            const expiryStatus = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                            const expiryColors = getExpiryColorClasses(expiryStatus);\n                                            \n                                            return (\n                                                <tr \n                                                    key={task.id} \n                                                    className={`hover:bg-gray-50 dark:hover:bg-gray-700 ${\n                                                        expiryStatus !== 'none' ? `${expiryColors.bgClass} ${expiryColors.borderClass} border-l-4` : ''\n                                                    }`}\n                                                >\n                                                    {visibleColumnIds.map(columnId => {\n                                                    switch (columnId) {\n                                                        case 'title':\n                                                            return (\n                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words flex items-center\">\n                                                                        {task.title}\n                                                                            {task.description && (\n                                                                                <div className=\"ml-2 relative group\">\n                                                                                    <button \n                                                                                        className=\"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        <InformationCircleIcon className=\"h-5 w-5\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('tasks.showDescription')}\n                                                                                    </div>\n                                                                                    <div className=\"absolute left-0 mt-2 p-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 shadow-lg rounded-md border border-gray-200 dark:border-gray-700 w-144 max-h-96 overflow-y-auto min-w-[36rem] z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                                                                        <MarkdownPreview content={task.description} showImagePreview={true} />\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'status':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(task.status, 'task')} dark:bg-opacity-30 status-col`}>\n                                                                            {task.status}\n                                                                        </span>\n                                                                    </td>\n                                                                );\n                                                            case 'responsibleAndQualityControl':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"flex flex-col\">\n                                                                            <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline\">{t('tasks.columns.responsible')}:</span>\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden\">{t('tasks.columns.responsible').substring(0, 3)}:</span><br />\n                                                                                {task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}` : task.role ? task.role.name : '-'}\n                                                                            </div>\n                                                                            <div className=\"text-sm text-gray-900 dark:text-gray-200 mt-1\">\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline\">{t('tasks.qualityControlLabel')}</span>\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden\">{t('tasks.columns.qualityControl').substring(0, 2)}:</span><br />\n                                                                                {task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}` : '-'}\n                                                                            </div>\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'branch':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"text-sm text-gray-900 dark:text-gray-200\">{task.branch.name}</div>\n                                                                    </td>\n                                                                );\n                                                            case 'dueDate':\n                                                                const expiryStatusForDate = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                                                const expiryColorsForDate = getExpiryColorClasses(expiryStatusForDate);\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className={`text-sm ${expiryStatusForDate !== 'none' ? expiryColorsForDate.textClass : 'text-gray-900 dark:text-gray-200'}`}>\n                                                                            {task.dueDate ? new Date(task.dueDate).toLocaleDateString() : '-'}\n                                                                            {expiryStatusForDate !== 'none' && (\n                                                                                <span className=\"ml-2 text-xs\"></span>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'actions':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"flex space-x-2 action-buttons\">\n                                                                            <div className=\"status-buttons\">\n                                                                                {renderStatusButtons(task)}\n                                                                            </div>\n                                                                            {hasPermission('tasks', 'write', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => {\n                                                                                            setSelectedTask(task);\n                                                                                            setIsEditModalOpen(true);\n                                                                                        }}\n                                                                                        className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                    >\n                                                                                        <PencilIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('common.edit')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                            {hasPermission('tasks', 'both', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => handleCopyTask(task)}\n                                                                                        className=\"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                                                                                    >\n                                                                                        <DocumentDuplicateIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('tasks.actions.copy')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                            {hasPermission('tasks', 'delete', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => handleDeleteTask(task.id)}\n                                                                                        className=\"p-1.5 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300\"\n                                                                                    >\n                                                                                        <TrashIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('common.delete')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            default:\n                                                                return null;\n                                                        }\n                                                    })}\n                                                    </tr>\n                                                );\n                                            })}\n                                            </>\n                                        )}\n                                    </tbody>\n                                </table>\n                            </div>\n                            ) : activeTab === 'todos' ? (\n                                /* Card-Ansicht - Tasks - ohne Box-Schattierung, Cards auf voller Breite */\n                                <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n                                    {loading ? (\n                                        <div className=\"flex justify-center py-12\">\n                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                        </div>\n                                    ) : error ? (\n                                        <div className=\"flex justify-center py-12 text-red-600 dark:text-red-400\">\n                                            {error}\n                                        </div>\n                                    ) : filteredAndSortedTasks.length === 0 ? (\n                                        <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n                                            <ClipboardDocumentListIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n                                            <div className=\"text-sm\">Keine To Do's gefunden</div>\n                                        </div>\n                                    ) : (\n                                        <CardGrid>\n                                            {filteredAndSortedTasks.slice(0, displayLimit).map(task => {\n                                                const expiryStatus = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                                \n                                                // Metadaten basierend auf sichtbaren Einstellungen - strukturiert nach Position\n                                                const metadata: MetadataItem[] = [];\n                                                \n                                                // Links: Niederlassung\n                                                if (visibleCardMetadata.has('branch')) {\n                                                    metadata.push({\n                                                        icon: <BuildingOfficeIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.branch'),\n                                                        value: task.branch.name,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Haupt-Metadaten: Verantwortlicher & Qualittskontrolle\n                                                if (visibleCardMetadata.has('responsible')) {\n                                                    // Benutzernamen auf 4 Zeichen krzen\n                                                    const responsibleValue = task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}` : (task.role ? task.role.name : '-');\n                                                    const shortenedName = responsibleValue.length > 4 && responsibleValue !== '-' ? responsibleValue.substring(0, 4) : responsibleValue;\n                                                    metadata.push({\n                                                        icon: <UserIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.responsible'),\n                                                        value: shortenedName,\n                                                        section: 'main'\n                                                    });\n                                                }\n                                                if (visibleCardMetadata.has('qualityControl')) {\n                                                    // Benutzernamen auf 4 Zeichen krzen\n                                                    const qualityControlValue = task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}` : '-';\n                                                    const shortenedName = qualityControlValue.length > 4 && qualityControlValue !== '-' ? qualityControlValue.substring(0, 4) : qualityControlValue;\n                                                    metadata.push({\n                                                        icon: <UserIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.qualityControl'),\n                                                        value: shortenedName,\n                                                        section: 'main-second'\n                                                    });\n                                                }\n                                                \n                                                // Rechts: Flligkeit (erste Zeile rechts, neben Status)\n                                                if (visibleCardMetadata.has('dueDate')) {\n                                                    const dueDateItem = createDueDateMetadataItem(\n                                                        task.dueDate,\n                                                        'todo',\n                                                        task.title,\n                                                        task.description,\n                                                        <CalendarIcon className=\"h-4 w-4\" />,\n                                                        t('tasks.columns.dueDate'),\n                                                        (date) => format(date, 'dd.MM.yyyy', { locale: de }),\n                                                        false // Keine Badge-Art, nur Text\n                                                    );\n                                                    metadata.push({\n                                                        ...dueDateItem,\n                                                        section: 'right-inline' // Neue Section fr inline rechts (neben Status)\n                                                    });\n                                                }\n                                                \n                                                // Full-Width: Beschreibung\n                                                if (visibleCardMetadata.has('description') && task.description) {\n                                                    metadata.push({\n                                                        label: t('tasks.columns.description'),\n                                                        value: '',\n                                                        descriptionContent: task.description,\n                                                        attachmentMetadata: task.attachments || [], // Attachment-Metadaten fr Vorschau\n                                                        section: 'full'\n                                                    });\n                                                }\n                                                \n                                                // Action-Buttons\n                                                const actionButtons = (\n                                                    <div className=\"flex items-center space-x-2\">\n                                                        {/* Status-Buttons */}\n                                                        <div className=\"status-buttons\">\n                                                            {renderStatusButtons(task)}\n                                                        </div>\n                                                        {hasPermission('tasks', 'write', 'table') && (\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedTask(task);\n                                                                    setIsEditModalOpen(true);\n                                                                }}\n                                                                                    className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                >\n                                                                <PencilIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                        )}\n                                                        {hasPermission('tasks', 'both', 'table') && (\n                                                            <div className=\"relative group\">\n                                                                <button\n                                                                    onClick={(e) => {\n                                                                        e.stopPropagation();\n                                                                        handleCopyTask(task);\n                                                                    }}\n                                                                    className=\"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                                                                >\n                                                                    <DocumentDuplicateIcon className=\"h-4 w-4\" />\n                                                                </button>\n                                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                    {t('tasks.actions.copy')}\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                );\n                                                \n                                                return (\n                                                    <DataCard\n                                                        key={task.id}\n                                                        title={\n                                                          <span>\n                                                            <span className=\"text-xs text-gray-600 dark:text-gray-400\">{task.id}:</span>{' '}\n                                                            <span>{task.title}</span>\n                                                          </span>\n                                                        }\n                                                        status={{\n                                                            label: getStatusText(task.status, 'task', t),\n                                                            color: getStatusColor(task.status, 'task'),\n                                                            onPreviousClick: undefined,\n                                                            onNextClick: undefined\n                                                        }}\n                                                        metadata={metadata}\n                                                        actions={actionButtons}\n                                                    />\n                                                );\n                                            })}\n                                        </CardGrid>\n                                    )}\n                                </div>\n                            ) : null}\n                            \n                            {/* \"Mehr anzeigen\" Button - Mobil - Tasks */}\n                            {activeTab === 'todos' && filteredAndSortedTasks.length > displayLimit && (\n                                <div className=\"mt-4 flex justify-center\">\n                                    <button\n                                        className=\"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600\"\n                                        onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                                    >\n                                        {t('common.showMore')} ({filteredAndSortedTasks.length - displayLimit} {t('common.remaining')})\n                                    </button>\n                                </div>\n                            )}\n                            \n                            {/* Reservations Rendering - Cards */}\n                            {activeTab === 'reservations' && viewMode === 'cards' && (\n                                <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n                                    {reservationsLoading ? (\n                                        <div className=\"flex justify-center py-12\">\n                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                        </div>\n                                    ) : reservationsError ? (\n                                        <div className=\"flex justify-center py-12 text-red-600 dark:text-red-400\">\n                                            {reservationsError}\n                                        </div>\n                                    ) : filteredAndSortedReservations.length === 0 ? (\n                                        <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n                                            <CalendarIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n                                            <div className=\"text-sm\">\n                                                {reservationSearchTerm || reservationFilterStatus !== 'all' || reservationFilterPaymentStatus !== 'all'\n                                                    ? t('reservations.noResults', 'Keine Reservations gefunden')\n                                                    : t('reservations.noReservations', 'Keine Reservations vorhanden')}\n                                            </div>\n                                        </div>\n                                    ) : (\n                                        <CardGrid>\n                                            {filteredAndSortedReservations.slice(0, displayLimit).map(reservation => {\n                                                const formatDate = (dateString: string) => {\n                                                    try {\n                                                        return format(new Date(dateString), 'dd.MM.yyyy', { locale: de });\n                                                    } catch {\n                                                        return dateString;\n                                                    }\n                                                };\n                                                \n                                                // Metadaten fr Reservation-Card\n                                                const metadata: MetadataItem[] = [];\n                                                \n                                                // Haupt-Metadaten: Check-in/Check-out (rechts oben, unverndert)\n                                                metadata.push({\n                                                    icon: <CalendarIcon className=\"h-4 w-4\" />,\n                                                    label: t('reservations.checkInOut', 'Check-in/Check-out'),\n                                                    value: `${formatDate(reservation.checkInDate)} - ${formatDate(reservation.checkOutDate)}`,\n                                                    section: 'main'\n                                                });\n                                                \n                                                // Zweite Zeile: Zimmernummer\n                                                if (reservation.roomNumber) {\n                                                    metadata.push({\n                                                        icon: <HomeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.roomNumber,\n                                                        section: 'main-second'\n                                                    });\n                                                }\n                                                \n                                                // Links: Telefon/Email unter Titel (gleiche Zeile wie Status)\n                                                if (reservation.guestEmail) {\n                                                    metadata.push({\n                                                        icon: <EnvelopeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.guestEmail,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                if (reservation.guestPhone) {\n                                                    metadata.push({\n                                                        icon: <PhoneIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.guestPhone,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Mitte: Zahlungslink (gleiche Hhe wie Payment Status)\n                                                if (reservation.paymentLink) {\n                                                    metadata.push({\n                                                        icon: <LinkIcon className=\"h-4 w-4\" />,\n                                                        value: (\n                                                            <a \n                                                                href={reservation.paymentLink} \n                                                                target=\"_blank\" \n                                                                rel=\"noopener noreferrer\"\n                                                                onClick={(e) => e.stopPropagation()}\n                                                                className=\"text-gray-900 dark:text-white break-all\"\n                                                            >\n                                                                {t('reservations.paymentLink', 'Zahlungslink')}\n                                                            </a>\n                                                        ),\n                                                        section: 'center'\n                                                    });\n                                                }\n                                                \n                                                // Mitte: Check-in Link (direkt unter Zahlungslink)\n                                                const checkInLink = reservation.guestEmail \n                                                    ? `https://app.lobbypms.com/checkinonline/confirmar?codigo=${reservation.id}&email=${encodeURIComponent(reservation.guestEmail)}&lg=GB`\n                                                    : null;\n                                                if (checkInLink) {\n                                                    metadata.push({\n                                                    icon: <LinkIcon className=\"h-4 w-4\" />,\n                                                    value: (\n                                                        <div className=\"relative group\">\n                                                            <a \n                                                                href={checkInLink} \n                                                                target=\"_blank\" \n                                                                rel=\"noopener noreferrer\"\n                                                                onClick={(e) => e.stopPropagation()}\n                                                                className=\"text-gray-900 dark:text-white\"\n                                                            >\n                                                                {t('reservations.checkInLink', 'Check-in Link')}\n                                                            </a>\n                                                            <div className=\"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {checkInLink}\n                                                            </div>\n                                                        </div>\n                                                    ),\n                                                    section: 'center'\n                                                    });\n                                                }\n                                                \n                                                // Rechts: Reservation Status als erstes Badge (mit Label)\n                                                metadata.push({\n                                                    label: t('reservations.status', 'Status'),\n                                                    value: (\n                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getReservationStatusColor(reservation.status)}`}>\n                                                            {t(`reservations.status.${reservation.status}`, reservation.status)}\n                                                        </span>\n                                                    ),\n                                                    section: 'right'\n                                                });\n                                                \n                                                // Rechts: Payment Status als zweites Badge (direkt unter Reservation Status)\n                                                metadata.push({\n                                                    label: t('reservations.paymentStatus', 'Zahlungsstatus'),\n                                                    value: (\n                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getPaymentStatusColor(reservation.paymentStatus)}`}>\n                                                            {t(`reservations.paymentStatus.${reservation.paymentStatus}`, reservation.paymentStatus)}\n                                                        </span>\n                                                    ),\n                                                    section: 'right'\n                                                });\n                                                \n                                                // Betrag und Whrung (wenn vorhanden)\n                                                if (reservation.amount) {\n                                                    const amountValue = typeof reservation.amount === 'string' \n                                                        ? parseFloat(reservation.amount).toFixed(2)\n                                                        : typeof reservation.amount === 'number'\n                                                        ? reservation.amount.toFixed(2)\n                                                        : '0.00';\n                                                    metadata.push({\n                                                        icon: <CurrencyDollarIcon className=\"h-4 w-4\" />,\n                                                        label: t('reservations.amount', 'Betrag'),\n                                                        value: `${amountValue} ${reservation.currency || 'COP'}`,\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Ankunftszeit (wenn vorhanden)\n                                                if (reservation.arrivalTime) {\n                                                    const formatDateTime = (dateString: string) => {\n                                                        try {\n                                                            return format(new Date(dateString), 'dd.MM.yyyy HH:mm', { locale: de });\n                                                        } catch {\n                                                            return dateString;\n                                                        }\n                                                    };\n                                                    metadata.push({\n                                                        icon: <ClockIcon className=\"h-4 w-4\" />,\n                                                        label: t('reservations.arrivalTime', 'Ankunftszeit'),\n                                                        value: formatDateTime(reservation.arrivalTime),\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Tr-PIN (wenn vorhanden)\n                                                if (reservation.doorPin) {\n                                                    metadata.push({\n                                                        icon: <KeyIcon className=\"h-4 w-4\" />,\n                                                        label: reservation.doorAppName || t('reservations.doorPin', 'Tr-PIN'),\n                                                        value: reservation.doorPin,\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Online Check-in Status\n                                                if (reservation.onlineCheckInCompleted) {\n                                                    metadata.push({\n                                                        icon: <CheckCircleIcon className=\"h-4 w-4 text-green-600\" />,\n                                                        label: t('reservations.onlineCheckIn', 'Online Check-in'),\n                                                        value: t('reservations.completed', 'Abgeschlossen'),\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Versendete Nachricht (als Chatverlauf formatiert)\n                                                if (reservation.sentMessage) {\n                                                    const formatMessageDate = (dateString: string | null) => {\n                                                        if (!dateString) return '';\n                                                        try {\n                                                            return format(new Date(dateString), 'dd.MM.yyyy HH:mm', { locale: de });\n                                                        } catch {\n                                                            return dateString;\n                                                        }\n                                                    };\n                                                    \n                                                    metadata.push({\n                                                        label: t('reservations.sentMessage', 'Versendete Nachricht'),\n                                                        value: reservation.sentMessageAt \n                                                            ? `${t('reservations.sentAt', 'Versendet am')} ${formatMessageDate(reservation.sentMessageAt)}`\n                                                            : '',\n                                                        descriptionContent: reservation.sentMessage, // String direkt bergeben, DataCard formatiert es\n                                                        section: 'full'\n                                                    });\n                                                }\n                                                \n                                                // Action-Button fr PIN-Generierung und Mitteilungsversand\n                                                const hasWritePermission = hasPermission('reservations', 'write', 'table');\n                                                // Debug: Log fr Berechtigungsprfung (nur fr erste Reservation) - IMMER loggen\n                                                if (reservation.id === filteredAndSortedReservations[0]?.id) {\n                                                    console.log('[Reservations] Berechtigungsprfung:', {\n                                                        hasWritePermission,\n                                                        reservationId: reservation.id,\n                                                        entity: 'reservations',\n                                                        accessLevel: 'write',\n                                                        entityType: 'table',\n                                                        actionButtonsWillBeCreated: hasWritePermission\n                                                    });\n                                                }\n                                                const actionButtons = hasWritePermission ? (\n                                                    <div className=\"flex items-center space-x-2\">\n                                                        {/* Einladung senden Button */}\n                                                        <div className=\"relative group\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedReservationForInvitation(reservation);\n                                                                    setIsSendInvitationSidepaneOpen(true);\n                                                                }}\n                                                                className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                title={t('reservations.sendInvitation', 'Einladung senden')}\n                                                            >\n                                                                <PaperAirplaneIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {t('reservations.sendInvitation', 'Einladung senden')}\n                                                            </div>\n                                                        </div>\n                                                        \n                                                        {/* Key-Button fr PIN-Generierung */}\n                                                        <div className=\"relative group\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    handleGeneratePinAndSend(reservation.id);\n                                                                }}\n                                                                disabled={generatingPinForReservation === reservation.id}\n                                                                className=\"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300 disabled:opacity-50 disabled:cursor-not-allowed\"\n                                                                title={t('reservations.generatePinAndSend', 'PIN generieren & Mitteilung versenden')}\n                                                            >\n                                                                {generatingPinForReservation === reservation.id ? (\n                                                                    <ArrowPathIcon className=\"h-4 w-4 animate-spin\" />\n                                                                ) : (\n                                                                    <KeyIcon className=\"h-4 w-4\" />\n                                                                )}\n                                                            </button>\n                                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {t('reservations.generatePinAndSend', 'PIN generieren & Mitteilung versenden')}\n                                                            </div>\n                                                        </div>\n                                                    </div>\n                                                ) : null;\n                                                \n                                                return (\n                                                    <DataCard\n                                                        key={reservation.id}\n                                                        title={reservation.guestName}\n                                                        subtitle={reservation.lobbyReservationId ? `ID: ${reservation.lobbyReservationId}` : undefined}\n                                                        metadata={metadata}\n                                                        actions={actionButtons}\n                                                    />\n                                                );\n                                            })}\n                                        </CardGrid>\n                                    )}\n                                </div>\n                            )}\n                            \n                            {/* Reservations Rendering - Tabelle (optional, analog zu Tasks) */}\n                            {activeTab === 'reservations' && viewMode === 'table' && (\n                                <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                        <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <tr>\n                                                <th scope=\"col\" className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                                    {t('reservations.guestName', 'Gast')}\n                                                </th>\n                                                <th scope=\"col\" className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                                    {t('reservations.status', 'Status')}\n                                                </th>\n                                                <th scope=\"col\" className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                                    {t('reservations.paymentStatus', 'Zahlungsstatus')}\n                                                </th>\n                                                <th scope=\"col\" className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                                    {t('reservations.checkInOut', 'Check-in/Check-out')}\n                                                </th>\n                                                <th scope=\"col\" className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                                    {t('reservations.room', 'Zimmer')}\n                                                </th>\n                                                <th scope=\"col\" className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                                    {t('common.actions', 'Aktionen')}\n                                                </th>\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                            {reservationsLoading ? (\n                                                <tr>\n                                                    <td colSpan={6} className=\"px-3 sm:px-4 md:px-6 py-4 text-center\">\n                                                        <div className=\"flex justify-center\">\n                                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : reservationsError ? (\n                                                <tr>\n                                                    <td colSpan={6} className=\"px-6 py-4 text-center text-red-600 dark:text-red-400\">\n                                                        {reservationsError}\n                                                    </td>\n                                                </tr>\n                                            ) : filteredAndSortedReservations.length === 0 ? (\n                                                <tr>\n                                                    <td colSpan={6} className=\"px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                                                        <div className=\"flex flex-col items-center justify-center gap-4\">\n                                                            <CalendarIcon className=\"h-10 w-10 text-gray-400 dark:text-gray-500\" />\n                                                            <div className=\"text-sm\">\n                                                                {reservationSearchTerm || reservationFilterStatus !== 'all' || reservationFilterPaymentStatus !== 'all'\n                                                                    ? t('reservations.noResults', 'Keine Reservations gefunden')\n                                                                    : t('reservations.noReservations', 'Keine Reservations vorhanden')}\n                                                            </div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : (\n                                                <>\n                                                    {filteredAndSortedReservations.slice(0, displayLimit).map(reservation => {\n                                                        const formatDate = (dateString: string) => {\n                                                            try {\n                                                                return format(new Date(dateString), 'dd.MM.yyyy', { locale: de });\n                                                            } catch {\n                                                                return dateString;\n                                                            }\n                                                        };\n                                                        \n                                                        return (\n                                                            <tr \n                                                                key={reservation.id} \n                                                                className=\"hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer\"\n                                                                onClick={() => navigate(`/reservations/${reservation.id}`)}\n                                                            >\n                                                                <td className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words\">\n                                                                        {reservation.guestName}\n                                                                        {reservation.lobbyReservationId && (\n                                                                            <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                                                                ID: {reservation.lobbyReservationId}\n                                                                            </div>\n                                                                        )}\n                                                                    </div>\n                                                                </td>\n                                                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getReservationStatusColor(reservation.status)}`}>\n                                                                        {t(`reservations.status.${reservation.status}`, reservation.status)}\n                                                                    </span>\n                                                                </td>\n                                                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getPaymentStatusColor(reservation.paymentStatus)}`}>\n                                                                        {t(`reservations.paymentStatus.${reservation.paymentStatus}`, reservation.paymentStatus)}\n                                                                    </span>\n                                                                </td>\n                                                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                        {formatDate(reservation.checkInDate)} - {formatDate(reservation.checkOutDate)}\n                                                                    </div>\n                                                                </td>\n                                                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                        {reservation.roomNumber || '-'}\n                                                                    </div>\n                                                                </td>\n                                                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                    <div className=\"flex space-x-2 action-buttons\">\n                                                                        {hasPermission('reservations', 'write', 'table') && (\n                                                                            <>\n                                                                                {/* Einladung senden Button */}\n                                                                            <div className=\"relative group\">\n                                                                                <button\n                                                                                    onClick={(e) => {\n                                                                                        e.stopPropagation();\n                                                                                            setSelectedReservationForInvitation(reservation);\n                                                                                            setIsSendInvitationSidepaneOpen(true);\n                                                                                    }}\n                                                                                    className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                        title={t('reservations.sendInvitation', 'Einladung senden')}\n                                                                                    >\n                                                                                        <PaperAirplaneIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('reservations.sendInvitation', 'Einladung senden')}\n                                                                                    </div>\n                                                                                </div>\n                                                                                \n                                                                                {/* Key-Button fr PIN-Generierung */}\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={(e) => {\n                                                                                            e.stopPropagation();\n                                                                                            handleGeneratePinAndSend(reservation.id);\n                                                                                        }}\n                                                                                        disabled={generatingPinForReservation === reservation.id}\n                                                                                        className=\"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300 disabled:opacity-50 disabled:cursor-not-allowed\"\n                                                                                        title={t('reservations.generatePinAndSend', 'PIN generieren & Mitteilung versenden')}\n                                                                                    >\n                                                                                        {generatingPinForReservation === reservation.id ? (\n                                                                                            <ArrowPathIcon className=\"h-4 w-4 animate-spin\" />\n                                                                                        ) : (\n                                                                                            <KeyIcon className=\"h-4 w-4\" />\n                                                                                        )}\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('reservations.generatePinAndSend', 'PIN generieren & Mitteilung versenden')}\n                                                                                    </div>\n                                                                                </div>\n                                                                                \n                                                                                {/* Details Button */}\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={(e) => {\n                                                                                            e.stopPropagation();\n                                                                                            navigate(`/reservations/${reservation.id}`);\n                                                                                        }}\n                                                                                        className=\"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                        title={t('common.viewDetails', 'Details anzeigen')}\n                                                                                >\n                                                                                    <InformationCircleIcon className=\"h-4 w-4\" />\n                                                                                </button>\n                                                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                    {t('common.viewDetails', 'Details anzeigen')}\n                                                                                </div>\n                                                                            </div>\n                                                                            </>\n                                                                        )}\n                                                                    </div>\n                                                                </td>\n                                                            </tr>\n                                                        );\n                                                    })}\n                                                </>\n                                            )}\n                                        </tbody>\n                                    </table>\n                                </div>\n                            )}\n                            \n                            {/* \"Mehr anzeigen\" Button - Reservations */}\n                            {activeTab === 'reservations' && filteredAndSortedReservations.length > displayLimit && (\n                                <div className=\"mt-4 flex justify-center\">\n                                    <button\n                                        className=\"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600\"\n                                        onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                                    >\n                                        {t('common.showMore')} ({filteredAndSortedReservations.length - displayLimit} {t('common.remaining')})\n                                    </button>\n                                </div>\n                            )}\n                        </div>\n                        \n                        {/* Zeiterfassung - auf Mobilgerten fixiert ber dem Footermen */}\n                        <div className=\"fixed bottom-13 left-0 right-0 w-full bg-white dark:bg-gray-800 z-9 shadow-lg border-t-0 dark:border-t dark:border-gray-700\">\n                            <WorktimeTracker />\n                        </div>\n                    </div>\n\n                    {/* Auf greren Gerten bleibt die ursprngliche Reihenfolge - Zeiterfassung oben, Tasks unten */}\n                    <div className=\"hidden sm:block\">\n                        {/* Zeiterfassung */}\n                        <div className=\"mb-8\">\n                            <WorktimeTracker />\n                        </div>\n                        \n                        {/* Tasks - vollstndiger Inhalt fr Desktop-Ansicht */}\n                        <div className=\"dashboard-tasks-wrapper bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 w-full mb-20\">\n                            <div className=\"flex items-center mb-4 justify-between px-3 sm:px-4 md:px-6\">\n                                {/* Linke Seite: \"Neuer Task/Reservation\"-Button */}\n                                <div className=\"flex items-center\">\n                                    {activeTab === 'todos' && hasPermission('tasks', 'write', 'table') && (\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={() => setIsCreateModalOpen(true)}\n                                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                                style={{ width: '30.19px', height: '30.19px' }}\n                                                aria-label={t('tasks.createTask')}\n                                                data-onboarding=\"create-task-button\"\n                                            >\n                                                <PlusIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {t('tasks.createTask')}\n                                            </div>\n                                        </div>\n                                    )}\n                                    {activeTab === 'reservations' && hasPermission('reservations', 'write', 'table') && (\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={() => setIsCreateReservationModalOpen(true)}\n                                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                                style={{ width: '30.19px', height: '30.19px' }}\n                                                aria-label={t('reservations.createReservation.button', 'Neue Reservierung')}\n                                            >\n                                                <PlusIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {t('reservations.createReservation.button', 'Neue Reservierung')}\n                                            </div>\n                                        </div>\n                                    )}\n                                </div>\n                                \n                                {/* Mitte: Titel */}\n                                <div className=\"flex items-center\">\n                                    <CheckCircleIcon className=\"h-6 w-6 mr-2 dark:text-white\" />\n                                    <h2 className=\"text-xl font-semibold dark:text-white\">\n                                        {activeTab === 'todos' ? t('tasks.title') : t('reservations.title', 'Reservations')}\n                                    </h2>\n                                </div>\n                                \n                                {/* Rechte Seite: Suchfeld, Sync-Button (nur Reservations), Filter-Button, Status-Filter, Spalten-Konfiguration */}\n                                <div className=\"flex items-center gap-1.5\">\n                                    <input\n                                        type=\"text\"\n                                        placeholder={t('common.search') + '...'}\n                                        className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                                        value={activeTab === 'todos' ? searchTerm : reservationSearchTerm}\n                                        onChange={(e) => {\n                                            if (activeTab === 'todos') {\n                                                setSearchTerm(e.target.value);\n                                            } else {\n                                                setReservationSearchTerm(e.target.value);\n                                            }\n                                        }}\n                                    />\n                                    \n                                    {/* Sync-Button fr Reservations */}\n                                    {activeTab === 'reservations' && (\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={async () => {\n                                                    try {\n                                                        setSyncingReservations(true);\n                                                        await axiosInstance.post(API_ENDPOINTS.RESERVATIONS.SYNC);\n                                                        showMessage(t('reservations.syncSuccess', 'Reservations erfolgreich synchronisiert'), 'success');\n                                                        await loadReservations();\n                                                    } catch (err: any) {\n                                                        console.error('Fehler beim Synchronisieren:', err);\n                                                        showMessage(\n                                                            err.response?.data?.message || t('reservations.syncError', 'Fehler beim Synchronisieren'),\n                                                            'error'\n                                                        );\n                                                    } finally {\n                                                        setSyncingReservations(false);\n                                                    }\n                                                }}\n                                                disabled={syncingReservations}\n                                                className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                                            >\n                                                <ArrowPathIcon className={`h-5 w-5 ${syncingReservations ? 'animate-spin' : ''}`} />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {syncingReservations ? t('reservations.syncing', 'Synchronisiere...') : t('reservations.sync', 'Synchronisieren')}\n                                            </div>\n                                        </div>\n                                    )}\n                                    \n                                    {/* View-Mode Toggle */}\n                                    <div className=\"relative group\">\n                                        <button\n                                            className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n                                                viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n                                            }`}\n                                            onClick={() => updateViewMode(viewMode === 'table' ? 'cards' : 'table')}\n                                        >\n                                            {viewMode === 'table' ? (\n                                                <Squares2X2Icon className=\"h-5 w-5\" />\n                                            ) : (\n                                                <TableCellsIcon className=\"h-5 w-5\" />\n                                            )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Filter-Button */}\n                                    <div className=\"relative group ml-1\">\n                                        <button\n                                            className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n                                            onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                                        >\n                                            <FunnelIcon className=\"h-5 w-5\" />\n                                            {getActiveFilterCount() > 0 && (\n                                                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                                    {getActiveFilterCount()}\n                                                </span>\n                                            )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {t('common.filter')}\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Spalten-Konfiguration */}\n                                    <div className=\"ml-1\">\n                                        <TableColumnConfig\n                                            columns={activeTab === 'todos'\n                                                ? (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'title', label: t('tasks.columns.title') },\n                                                        { id: 'status', label: t('tasks.columns.status') },\n                                                        { id: 'responsible', label: t('tasks.columns.responsible') },\n                                                        { id: 'qualityControl', label: t('tasks.columns.qualityControl') },\n                                                        { id: 'branch', label: t('tasks.columns.branch') },\n                                                        { id: 'dueDate', label: t('tasks.columns.dueDate') },\n                                                        { id: 'description', label: t('tasks.columns.description') }\n                                                    ]\n                                                    : availableColumns)\n                                                : (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'guestName', label: t('reservations.columns.guestName', 'Gast') },\n                                                        { id: 'status', label: t('reservations.columns.status', 'Status') },\n                                                        { id: 'paymentStatus', label: t('reservations.columns.paymentStatus', 'Zahlungsstatus') },\n                                                        { id: 'checkInDate', label: t('reservations.columns.checkInDate', 'Check-in') },\n                                                        { id: 'checkOutDate', label: t('reservations.columns.checkOutDate', 'Check-out') },\n                                                        { id: 'roomNumber', label: t('reservations.columns.roomNumber', 'Zimmer') },\n                                                        { id: 'guestEmail', label: t('reservations.columns.guestEmail', 'E-Mail') },\n                                                        { id: 'guestPhone', label: t('reservations.columns.guestPhone', 'Telefon') },\n                                                        { id: 'amount', label: t('reservations.columns.amount', 'Betrag') },\n                                                        { id: 'arrivalTime', label: t('reservations.columns.arrivalTime', 'Ankunftszeit') }\n                                                    ]\n                                                    : availableReservationColumns)}\n                                            visibleColumns={viewMode === 'cards'\n                                                ? Array.from(visibleCardMetadata)\n                                                : visibleColumnIds}\n                                            columnOrder={viewMode === 'cards'\n                                                ? cardMetadataOrder\n                                                : settings.columnOrder}\n                                            onToggleColumnVisibility={(columnId) => {\n                                                if (viewMode === 'cards') {\n                                                    const tableColumn = cardToTableMapping[columnId];\n                                                    if (tableColumn) {\n                                                        // Spezielle Logik fr responsibleAndQualityControl\n                                                        if (tableColumn === 'responsibleAndQualityControl') {\n                                                            // Prfe ob beide bereits ausgeblendet sind\n                                                            const otherCardMeta = columnId === 'responsible' ? 'qualityControl' : 'responsible';\n                                                            const otherHidden = hiddenCardMetadata.has(otherCardMeta);\n                                                            const currentlyHidden = settings.hiddenColumns.includes(tableColumn);\n                                                            \n                                                            if (currentlyHidden && !otherHidden) {\n                                                                // Eine der beiden wird wieder angezeigt, also responsibleAndQualityControl wieder anzeigen\n                                                                toggleColumnVisibility(tableColumn);\n                                                            } else if (!currentlyHidden && otherHidden) {\n                                                                // Die andere ist bereits ausgeblendet, also responsibleAndQualityControl ausblenden\n                                                                toggleColumnVisibility(tableColumn);\n                                                            } else if (!currentlyHidden) {\n                                                                // Erste wird ausgeblendet, responsibleAndQualityControl ausblenden\n                                                                toggleColumnVisibility(tableColumn);\n                                                            } else {\n                                                                // Beide sind ausgeblendet, eine wird wieder angezeigt\n                                                                toggleColumnVisibility(tableColumn);\n                                                            }\n                                                        } else {\n                                                            // Normale Spalte: direkt ein/ausblenden\n                                                            toggleColumnVisibility(tableColumn);\n                                                        }\n                                                    }\n                                                } else {\n                                                    toggleColumnVisibility(columnId);\n                                                }\n                                            }}\n                                            onMoveColumn={viewMode === 'cards'\n                                                ? (dragIndex: number, hoverIndex: number) => {\n                                                    const newCardOrder = [...cardMetadataOrder];\n                                                    const dragged = newCardOrder[dragIndex];\n                                                    newCardOrder.splice(dragIndex, 1);\n                                                    newCardOrder.splice(hoverIndex, 0, dragged);\n                                                    \n                                                    const newTableOrder: string[] = [];\n                                                    const usedTableColumns = new Set<string>();\n                                                    \n                                                    newCardOrder.forEach(cardMeta => {\n                                                        const tableCol = cardToTableMapping[cardMeta];\n                                                        if (tableCol && !usedTableColumns.has(tableCol)) {\n                                                            usedTableColumns.add(tableCol);\n                                                            newTableOrder.push(tableCol);\n                                                        }\n                                                    });\n                                                    \n                                                    availableColumns.forEach(col => {\n                                                        if (!newTableOrder.includes(col.id) && col.id !== 'actions') {\n                                                            newTableOrder.push(col.id);\n                                                        }\n                                                    });\n                                                    \n                                                    updateColumnOrder(newTableOrder);\n                                                }\n                                                : handleMoveColumn}\n                                            buttonTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                                            modalTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                                            onClose={() => {}}\n                                        />\n                                    </div>\n                                </div>\n                            </div>\n\n                            {/* Tab-Navigation */}\n                            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6 px-3 sm:px-4 md:px-6\">\n                                <nav className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden\">\n                                    <button\n                                        onClick={() => setActiveTab('todos')}\n                                        className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ${\n                                            activeTab === 'todos'\n                                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                        }`}\n                                    >\n                                        {t('tasks.title', \"To Do's\")}\n                                    </button>\n                                    {hasPermission('reservations', 'read', 'table') && (\n                                        <button\n                                            onClick={() => setActiveTab('reservations')}\n                                            className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ${\n                                                activeTab === 'reservations'\n                                                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                            }`}\n                                        >\n                                            {t('reservations.title', 'Reservations')}\n                                        </button>\n                                    )}\n                                </nav>\n                            </div>\n\n                            {/* Filter-Pane */}\n                            {isFilterModalOpen && (\n                                <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n                                    {activeTab === 'todos' ? (\n                                        <FilterPane\n                                            columns={[...availableColumns, ...filterOnlyColumns]}\n                                            onApply={applyFilterConditions}\n                                            onReset={resetFilterConditions}\n                                            savedConditions={filterConditions}\n                                            savedOperators={filterLogicalOperators}\n                                            savedSortDirections={filterSortDirections}\n                                            onSortDirectionsChange={setFilterSortDirections}\n                                            tableId={TODOS_TABLE_ID}\n                                        />\n                                    ) : (\n                                        <FilterPane\n                                            columns={[...availableReservationColumns, ...reservationFilterOnlyColumns]}\n                                            onApply={applyReservationFilterConditions}\n                                            onReset={resetReservationFilterConditions}\n                                            savedConditions={reservationFilterConditions}\n                                            savedOperators={reservationFilterLogicalOperators}\n                                            savedSortDirections={reservationFilterSortDirections}\n                                            onSortDirectionsChange={setReservationFilterSortDirections}\n                                            tableId={RESERVATIONS_TABLE_ID}\n                                        />\n                                    )}\n                                </div>\n                            )}\n\n                            {/* Gespeicherte Filter als Tags anzeigen */}\n                            <SavedFilterTags\n                                tableId={activeTab === 'todos' ? TODOS_TABLE_ID : RESERVATIONS_TABLE_ID}\n                                onSelectFilter={activeTab === 'todos' ? applyFilterConditions : applyReservationFilterConditions}\n                                onReset={activeTab === 'todos' ? resetFilterConditions : resetReservationFilterConditions}\n                                activeFilterName={activeTab === 'todos' ? activeFilterName : reservationActiveFilterName}\n                                selectedFilterId={activeTab === 'todos' ? selectedFilterId : reservationSelectedFilterId}\n                                onFilterChange={handleFilterChange}\n                                defaultFilterName={activeTab === 'todos' ? t('tasks.filters.current') : t('reservations.filters.current', 'Aktuell')}\n                            />\n\n                            {/* Tabelle oder Cards */}\n                            {viewMode === 'table' ? (\n                                /* Tabellen-Ansicht */\n                                <div className=\"overflow-x-auto\">\n                                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\" data-onboarding=\"task-list\">\n                                        <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <tr>\n                                                {visibleColumnIds.map((columnId) => {\n                                                    const column = availableColumns.find(col => col.id === columnId);\n                                                    if (!column) return null;\n\n                                                    return (\n                                                        <th \n                                                            key={columnId}\n                                                            scope=\"col\"\n                                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                                            draggable={true}\n                                                            onDragStart={() => handleDragStart(columnId)}\n                                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                                            onDrop={(e) => handleDrop(e, columnId)}\n                                                            onDragEnd={handleDragEnd}\n                                                        >\n                                                            <div className=\"flex items-center\">\n                                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                                {columnId !== 'actions' && (\n                                                                    <button \n                                                                        onClick={() => handleSort(columnId as keyof Task)}\n                                                                        className=\"ml-1 focus:outline-none\"\n                                                                    >\n                                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                                    </button>\n                                                                )}\n                                                            </div>\n                                                        </th>\n                                                    );\n                                                })}\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                            {loading ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-4 text-center\">\n                                                        <div className=\"flex justify-center\">\n                                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : error ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-red-600 dark:text-red-400\">\n                                                        {error}\n                                                    </td>\n                                                </tr>\n                                            ) : filteredAndSortedTasks.length === 0 ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                                                        <div className=\"flex flex-col items-center justify-center gap-4\">\n                                                        <ClipboardDocumentListIcon className=\"h-10 w-10 text-gray-400 dark:text-gray-500\" />\n                                                        <div className=\"text-sm\">{t('tasks.noTasksFound')}</div>\n                                                    </div>\n                                                </td>\n                                            </tr>\n                                        ) : (\n                                            <>\n                                            {filteredAndSortedTasks.slice(0, displayLimit).map(task => {\n                                            const expiryStatus = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                            const expiryColors = getExpiryColorClasses(expiryStatus);\n                                            \n                                            return (\n                                                <tr \n                                                    key={task.id} \n                                                    className={`hover:bg-gray-50 dark:hover:bg-gray-700 ${\n                                                        expiryStatus !== 'none' ? `${expiryColors.bgClass} ${expiryColors.borderClass} border-l-4` : ''\n                                                    }`}\n                                                >\n                                                    {visibleColumnIds.map(columnId => {\n                                                    switch (columnId) {\n                                                        case 'title':\n                                                            return (\n                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words flex items-center\">\n                                                                        {task.title}\n                                                                            {task.description && (\n                                                                                <div className=\"ml-2 relative group\">\n                                                                                    <button \n                                                                                        className=\"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        <InformationCircleIcon className=\"h-5 w-5\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('tasks.showDescription')}\n                                                                                    </div>\n                                                                                    <div className=\"absolute left-0 mt-2 p-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 shadow-lg rounded-md border border-gray-200 dark:border-gray-700 w-144 max-h-96 overflow-y-auto min-w-[36rem] z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                                                                        <MarkdownPreview content={task.description} showImagePreview={true} />\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'status':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(task.status, 'task')} dark:bg-opacity-30 status-col`}>\n                                                                            {task.status}\n                                                                        </span>\n                                                                    </td>\n                                                                );\n                                                            case 'responsibleAndQualityControl':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"flex flex-col\">\n                                                                            <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline\">{t('tasks.columns.responsible')}:</span>\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden\">{t('tasks.columns.responsible').substring(0, 3)}:</span><br />\n                                                                                {task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}` : task.role ? task.role.name : '-'}\n                                                                            </div>\n                                                                            <div className=\"text-sm text-gray-900 dark:text-gray-200 mt-1\">\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline\">{t('tasks.qualityControlLabel')}</span>\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden\">{t('tasks.columns.qualityControl').substring(0, 2)}:</span><br />\n                                                                                {task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}` : '-'}\n                                                                            </div>\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'branch':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"text-sm text-gray-900 dark:text-gray-200\">{task.branch.name}</div>\n                                                                    </td>\n                                                                );\n                                                            case 'dueDate':\n                                                                const expiryStatusForDate2 = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                                                const expiryColorsForDate2 = getExpiryColorClasses(expiryStatusForDate2);\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className={`text-sm ${expiryStatusForDate2 !== 'none' ? expiryColorsForDate2.textClass : 'text-gray-900 dark:text-gray-200'}`}>\n                                                                            {task.dueDate ? new Date(task.dueDate).toLocaleDateString() : '-'}\n                                                                            {expiryStatusForDate2 !== 'none' && (\n                                                                                <span className=\"ml-2 text-xs\"></span>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'actions':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"flex space-x-2 action-buttons\">\n                                                                            <div className=\"status-buttons\">\n                                                                                {renderStatusButtons(task)}\n                                                                            </div>\n                                                                            {hasPermission('tasks', 'write', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => {\n                                                                                            setSelectedTask(task);\n                                                                                            setIsEditModalOpen(true);\n                                                                                        }}\n                                                                                        className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                    >\n                                                                                        <PencilIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('common.edit')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                            {hasPermission('tasks', 'both', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => handleCopyTask(task)}\n                                                                                        className=\"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                                                                                    >\n                                                                                        <DocumentDuplicateIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('tasks.actions.copy')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                            {hasPermission('tasks', 'delete', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => handleDeleteTask(task.id)}\n                                                                                        className=\"p-1.5 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300\"\n                                                                                    >\n                                                                                        <TrashIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('common.delete')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            default:\n                                                                return null;\n                                                        }\n                                                    })}\n                                                    </tr>\n                                                );\n                                            })}\n                                            </>\n                                        )}\n                                    </tbody>\n                                </table>\n                            </div>\n                            ) : activeTab === 'todos' ? (\n                                /* Card-Ansicht - Tasks - ohne Box-Schattierung, Cards auf voller Breite */\n                                <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n                                    {loading ? (\n                                        <div className=\"flex justify-center py-12\">\n                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                        </div>\n                                    ) : error ? (\n                                        <div className=\"flex justify-center py-12 text-red-600 dark:text-red-400\">\n                                            {error}\n                                        </div>\n                                    ) : filteredAndSortedTasks.length === 0 ? (\n                                        <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n                                            <ClipboardDocumentListIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n                                            <div className=\"text-sm\">Keine To Do's gefunden</div>\n                                        </div>\n                                    ) : (\n                                        <CardGrid>\n                                            {filteredAndSortedTasks.slice(0, displayLimit).map(task => {\n                                                const expiryStatus = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                                \n                                                // Metadaten basierend auf sichtbaren Einstellungen - strukturiert nach Position\n                                                const metadata: MetadataItem[] = [];\n                                                \n                                                // Links: Niederlassung\n                                                if (visibleCardMetadata.has('branch')) {\n                                                    metadata.push({\n                                                        icon: <BuildingOfficeIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.branch'),\n                                                        value: task.branch.name,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Haupt-Metadaten: Verantwortlicher & Qualittskontrolle\n                                                if (visibleCardMetadata.has('responsible')) {\n                                                    // Benutzernamen auf 4 Zeichen krzen\n                                                    const responsibleValue = task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}` : (task.role ? task.role.name : '-');\n                                                    const shortenedName = responsibleValue.length > 4 && responsibleValue !== '-' ? responsibleValue.substring(0, 4) : responsibleValue;\n                                                    metadata.push({\n                                                        icon: <UserIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.responsible'),\n                                                        value: shortenedName,\n                                                        section: 'main'\n                                                    });\n                                                }\n                                                if (visibleCardMetadata.has('qualityControl')) {\n                                                    // Benutzernamen auf 4 Zeichen krzen\n                                                    const qualityControlValue = task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}` : '-';\n                                                    const shortenedName = qualityControlValue.length > 4 && qualityControlValue !== '-' ? qualityControlValue.substring(0, 4) : qualityControlValue;\n                                                    metadata.push({\n                                                        icon: <UserIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.qualityControl'),\n                                                        value: shortenedName,\n                                                        section: 'main-second'\n                                                    });\n                                                }\n                                                \n                                                // Rechts: Flligkeit (erste Zeile rechts, neben Status)\n                                                if (visibleCardMetadata.has('dueDate')) {\n                                                    const dueDateItem = createDueDateMetadataItem(\n                                                        task.dueDate,\n                                                        'todo',\n                                                        task.title,\n                                                        task.description,\n                                                        <CalendarIcon className=\"h-4 w-4\" />,\n                                                        t('tasks.columns.dueDate'),\n                                                        (date) => format(date, 'dd.MM.yyyy', { locale: de }),\n                                                        false // Keine Badge-Art, nur Text\n                                                    );\n                                                    metadata.push({\n                                                        ...dueDateItem,\n                                                        section: 'right-inline' // Neue Section fr inline rechts (neben Status)\n                                                    });\n                                                }\n                                                \n                                                // Full-Width: Beschreibung\n                                                if (visibleCardMetadata.has('description') && task.description) {\n                                                    metadata.push({\n                                                        label: t('tasks.columns.description'),\n                                                        value: '',\n                                                        descriptionContent: task.description,\n                                                        attachmentMetadata: task.attachments || [], // Attachment-Metadaten fr Vorschau\n                                                        section: 'full'\n                                                    });\n                                                }\n                                                \n                                                // Action-Buttons\n                                                const actionButtons = (\n                                                    <div className=\"flex items-center space-x-2\">\n                                                        {/* Status-Buttons */}\n                                                        <div className=\"status-buttons\">\n                                                            {renderStatusButtons(task)}\n                                                        </div>\n                                                        {hasPermission('tasks', 'write', 'table') && (\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedTask(task);\n                                                                    setIsEditModalOpen(true);\n                                                                }}\n                                                                                    className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                >\n                                                                <PencilIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                        )}\n                                                        {hasPermission('tasks', 'both', 'table') && (\n                                                            <div className=\"relative group\">\n                                                                <button\n                                                                    onClick={(e) => {\n                                                                        e.stopPropagation();\n                                                                        handleCopyTask(task);\n                                                                    }}\n                                                                    className=\"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                                                                >\n                                                                    <DocumentDuplicateIcon className=\"h-4 w-4\" />\n                                                                </button>\n                                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                    {t('tasks.actions.copy')}\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                );\n                                                \n                                                return (\n                                                    <DataCard\n                                                        key={task.id}\n                                                        title={\n                                                          <span>\n                                                            <span className=\"text-xs text-gray-600 dark:text-gray-400\">{task.id}:</span>{' '}\n                                                            <span>{task.title}</span>\n                                                          </span>\n                                                        }\n                                                        status={{\n                                                            label: getStatusText(task.status, 'task', t),\n                                                            color: getStatusColor(task.status, 'task'),\n                                                            onPreviousClick: undefined,\n                                                            onNextClick: undefined\n                                                        }}\n                                                        metadata={metadata}\n                                                        actions={actionButtons}\n                                                    />\n                                                );\n                                            })}\n                                        </CardGrid>\n                                    )}\n                                </div>\n                            ) : null}\n                            \n                            {/* \"Mehr anzeigen\" Button - Desktop - Tasks */}\n                            {activeTab === 'todos' && filteredAndSortedTasks.length > displayLimit && (\n                                <div className=\"mt-4 flex justify-center\">\n                                    <button\n                                        className=\"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600\"\n                                        onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                                    >\n                                        {t('common.showMore')} ({filteredAndSortedTasks.length - displayLimit} {t('common.remaining')})\n                                    </button>\n                                </div>\n                            )}\n                            \n                            {/* Reservations Rendering - Desktop - Cards */}\n                            {activeTab === 'reservations' && viewMode === 'cards' && (\n                                <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n                                    {reservationsLoading ? (\n                                        <div className=\"flex justify-center py-12\">\n                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                        </div>\n                                    ) : reservationsError ? (\n                                        <div className=\"flex justify-center py-12 text-red-600 dark:text-red-400\">\n                                            {reservationsError}\n                                        </div>\n                                    ) : filteredAndSortedReservations.length === 0 ? (\n                                        <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n                                            <CalendarIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n                                            <div className=\"text-sm\">\n                                                {reservationSearchTerm || reservationFilterStatus !== 'all' || reservationFilterPaymentStatus !== 'all'\n                                                    ? t('reservations.noResults', 'Keine Reservations gefunden')\n                                                    : t('reservations.noReservations', 'Keine Reservations vorhanden')}\n                                            </div>\n                                        </div>\n                                    ) : (\n                                        <CardGrid>\n                                            {filteredAndSortedReservations.slice(0, displayLimit).map(reservation => {\n                                                const formatDate = (dateString: string) => {\n                                                    try {\n                                                        return format(new Date(dateString), 'dd.MM.yyyy', { locale: de });\n                                                    } catch {\n                                                        return dateString;\n                                                    }\n                                                };\n                                                \n                                                // Metadaten fr Reservation-Card\n                                                const metadata: MetadataItem[] = [];\n                                                \n                                                // Haupt-Metadaten: Check-in/Check-out (rechts oben, unverndert)\n                                                metadata.push({\n                                                    icon: <CalendarIcon className=\"h-4 w-4\" />,\n                                                    label: t('reservations.checkInOut', 'Check-in/Check-out'),\n                                                    value: `${formatDate(reservation.checkInDate)} - ${formatDate(reservation.checkOutDate)}`,\n                                                    section: 'main'\n                                                });\n                                                \n                                                // Zweite Zeile: Zimmernummer\n                                                if (reservation.roomNumber) {\n                                                    metadata.push({\n                                                        icon: <HomeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.roomNumber,\n                                                        section: 'main-second'\n                                                    });\n                                                }\n                                                \n                                                // Links: Telefon/Email unter Titel (gleiche Zeile wie Status)\n                                                if (reservation.guestEmail) {\n                                                    metadata.push({\n                                                        icon: <EnvelopeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.guestEmail,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                if (reservation.guestPhone) {\n                                                    metadata.push({\n                                                        icon: <PhoneIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.guestPhone,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Mitte: Zahlungslink (gleiche Hhe wie Payment Status)\n                                                if (reservation.paymentLink) {\n                                                    metadata.push({\n                                                        icon: <LinkIcon className=\"h-4 w-4\" />,\n                                                        value: (\n                                                            <a \n                                                                href={reservation.paymentLink} \n                                                                target=\"_blank\" \n                                                                rel=\"noopener noreferrer\"\n                                                                onClick={(e) => e.stopPropagation()}\n                                                                className=\"text-gray-900 dark:text-white break-all\"\n                                                            >\n                                                                {t('reservations.paymentLink', 'Zahlungslink')}\n                                                            </a>\n                                                        ),\n                                                        section: 'center'\n                                                    });\n                                                }\n                                                \n                                                // Mitte: Check-in Link (direkt unter Zahlungslink)\n                                                const checkInLink = reservation.guestEmail \n                                                    ? `https://app.lobbypms.com/checkinonline/confirmar?codigo=${reservation.id}&email=${encodeURIComponent(reservation.guestEmail)}&lg=GB`\n                                                    : null;\n                                                if (checkInLink) {\n                                                    metadata.push({\n                                                    icon: <LinkIcon className=\"h-4 w-4\" />,\n                                                    value: (\n                                                        <div className=\"relative group\">\n                                                            <a \n                                                                href={checkInLink} \n                                                                target=\"_blank\" \n                                                                rel=\"noopener noreferrer\"\n                                                                onClick={(e) => e.stopPropagation()}\n                                                                className=\"text-gray-900 dark:text-white\"\n                                                            >\n                                                                {t('reservations.checkInLink', 'Check-in Link')}\n                                                            </a>\n                                                            <div className=\"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {checkInLink}\n                                                            </div>\n                                                        </div>\n                                                    ),\n                                                    section: 'center'\n                                                    });\n                                                }\n                                                \n                                                // Rechts: Reservation Status als erstes Badge (mit Label)\n                                                metadata.push({\n                                                    label: t('reservations.status', 'Status'),\n                                                    value: (\n                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getReservationStatusColor(reservation.status)}`}>\n                                                            {t(`reservations.status.${reservation.status}`, reservation.status)}\n                                                        </span>\n                                                    ),\n                                                    section: 'right'\n                                                });\n                                                \n                                                // Rechts: Payment Status als zweites Badge (direkt unter Reservation Status)\n                                                metadata.push({\n                                                    label: t('reservations.paymentStatus', 'Zahlungsstatus'),\n                                                    value: (\n                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getPaymentStatusColor(reservation.paymentStatus)}`}>\n                                                            {t(`reservations.paymentStatus.${reservation.paymentStatus}`, reservation.paymentStatus)}\n                                                        </span>\n                                                    ),\n                                                    section: 'right'\n                                                });\n                                                \n                                                // Betrag und Whrung (wenn vorhanden)\n                                                if (reservation.amount) {\n                                                    const amountValue = typeof reservation.amount === 'string' \n                                                        ? parseFloat(reservation.amount).toFixed(2)\n                                                        : typeof reservation.amount === 'number'\n                                                        ? reservation.amount.toFixed(2)\n                                                        : '0.00';\n                                                    metadata.push({\n                                                        icon: <CurrencyDollarIcon className=\"h-4 w-4\" />,\n                                                        label: t('reservations.amount', 'Betrag'),\n                                                        value: `${amountValue} ${reservation.currency || 'COP'}`,\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Ankunftszeit (wenn vorhanden)\n                                                if (reservation.arrivalTime) {\n                                                    const formatDateTime = (dateString: string) => {\n                                                        try {\n                                                            return format(new Date(dateString), 'dd.MM.yyyy HH:mm', { locale: de });\n                                                        } catch {\n                                                            return dateString;\n                                                        }\n                                                    };\n                                                    metadata.push({\n                                                        icon: <ClockIcon className=\"h-4 w-4\" />,\n                                                        label: t('reservations.arrivalTime', 'Ankunftszeit'),\n                                                        value: formatDateTime(reservation.arrivalTime),\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Tr-PIN (wenn vorhanden)\n                                                if (reservation.doorPin) {\n                                                    metadata.push({\n                                                        icon: <KeyIcon className=\"h-4 w-4\" />,\n                                                        label: reservation.doorAppName || t('reservations.doorPin', 'Tr-PIN'),\n                                                        value: reservation.doorPin,\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Online Check-in Status\n                                                if (reservation.onlineCheckInCompleted) {\n                                                    metadata.push({\n                                                        icon: <CheckCircleIcon className=\"h-4 w-4 text-green-600\" />,\n                                                        label: t('reservations.onlineCheckIn', 'Online Check-in'),\n                                                        value: t('reservations.completed', 'Abgeschlossen'),\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Versendete Nachricht (als Chatverlauf formatiert)\n                                                if (reservation.sentMessage) {\n                                                    const formatMessageDate = (dateString: string | null) => {\n                                                        if (!dateString) return '';\n                                                        try {\n                                                            return format(new Date(dateString), 'dd.MM.yyyy HH:mm', { locale: de });\n                                                        } catch {\n                                                            return dateString;\n                                                        }\n                                                    };\n                                                    \n                                                    metadata.push({\n                                                        label: t('reservations.sentMessage', 'Versendete Nachricht'),\n                                                        value: reservation.sentMessageAt \n                                                            ? `${t('reservations.sentAt', 'Versendet am')} ${formatMessageDate(reservation.sentMessageAt)}`\n                                                            : '',\n                                                        descriptionContent: reservation.sentMessage, // String direkt bergeben, DataCard formatiert es\n                                                        section: 'full'\n                                                    });\n                                                }\n                                                \n                                                // Action-Buttons fr Einladung senden und PIN-Generierung\n                                                const hasWritePermission = hasPermission('reservations', 'write', 'table');\n                                                const actionButtons = hasWritePermission ? (\n                                                    <div className=\"flex items-center space-x-2\">\n                                                        {/* Einladung senden Button */}\n                                                        <div className=\"relative group\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedReservationForInvitation(reservation);\n                                                                    setIsSendInvitationSidepaneOpen(true);\n                                                                }}\n                                                                className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                title={t('reservations.sendInvitation', 'Einladung senden')}\n                                                            >\n                                                                <PaperAirplaneIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {t('reservations.sendInvitation', 'Einladung senden')}\n                                                            </div>\n                                                        </div>\n                                                        \n                                                        {/* Key-Button fr PIN-Generierung */}\n                                                        <div className=\"relative group\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    handleGeneratePinAndSend(reservation.id);\n                                                                }}\n                                                                disabled={generatingPinForReservation === reservation.id}\n                                                                className=\"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300 disabled:opacity-50 disabled:cursor-not-allowed\"\n                                                                title={t('reservations.generatePinAndSend', 'PIN generieren & Mitteilung versenden')}\n                                                            >\n                                                                {generatingPinForReservation === reservation.id ? (\n                                                                    <ArrowPathIcon className=\"h-4 w-4 animate-spin\" />\n                                                                ) : (\n                                                                    <KeyIcon className=\"h-4 w-4\" />\n                                                                )}\n                                                            </button>\n                                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {t('reservations.generatePinAndSend', 'PIN generieren & Mitteilung versenden')}\n                                                            </div>\n                                                        </div>\n                                                    </div>\n                                                ) : null;\n                                                \n                                                return (\n                                                    <DataCard\n                                                        key={reservation.id}\n                                                        title={reservation.guestName}\n                                                        subtitle={reservation.lobbyReservationId ? `ID: ${reservation.lobbyReservationId}` : undefined}\n                                                        metadata={metadata}\n                                                        actions={actionButtons}\n                                                    />\n                                                );\n                                            })}\n                                        </CardGrid>\n                                    )}\n                                </div>\n                            )}\n                            \n                            {/* Reservations Rendering - Desktop - Tabelle */}\n                            {activeTab === 'reservations' && viewMode === 'table' && (\n                                <div className=\"overflow-x-auto\">\n                                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                        <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <tr>\n                                                <th scope=\"col\" className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                                    {t('reservations.guestName', 'Gast')}\n                                                </th>\n                                                <th scope=\"col\" className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                                    {t('reservations.status', 'Status')}\n                                                </th>\n                                                <th scope=\"col\" className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                                    {t('reservations.paymentStatus', 'Zahlungsstatus')}\n                                                </th>\n                                                <th scope=\"col\" className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                                    {t('reservations.checkInOut', 'Check-in/Check-out')}\n                                                </th>\n                                                <th scope=\"col\" className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                                    {t('reservations.room', 'Zimmer')}\n                                                </th>\n                                                <th scope=\"col\" className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                                                    {t('common.actions', 'Aktionen')}\n                                                </th>\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                            {reservationsLoading ? (\n                                                <tr>\n                                                    <td colSpan={6} className=\"px-3 sm:px-4 md:px-6 py-4 text-center\">\n                                                        <div className=\"flex justify-center\">\n                                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : reservationsError ? (\n                                                <tr>\n                                                    <td colSpan={6} className=\"px-6 py-4 text-center text-red-600 dark:text-red-400\">\n                                                        {reservationsError}\n                                                    </td>\n                                                </tr>\n                                            ) : filteredAndSortedReservations.length === 0 ? (\n                                                <tr>\n                                                    <td colSpan={6} className=\"px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                                                        <div className=\"flex flex-col items-center justify-center gap-4\">\n                                                            <CalendarIcon className=\"h-10 w-10 text-gray-400 dark:text-gray-500\" />\n                                                            <div className=\"text-sm\">\n                                                                {reservationSearchTerm || reservationFilterStatus !== 'all' || reservationFilterPaymentStatus !== 'all'\n                                                                    ? t('reservations.noResults', 'Keine Reservations gefunden')\n                                                                    : t('reservations.noReservations', 'Keine Reservations vorhanden')}\n                                                            </div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : (\n                                                <>\n                                                    {filteredAndSortedReservations.slice(0, displayLimit).map(reservation => {\n                                                        const formatDate = (dateString: string) => {\n                                                            try {\n                                                                return format(new Date(dateString), 'dd.MM.yyyy', { locale: de });\n                                                            } catch {\n                                                                return dateString;\n                                                            }\n                                                        };\n                                                        \n                                                        return (\n                                                            <tr \n                                                                key={reservation.id} \n                                                                className=\"hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer\"\n                                                                onClick={() => navigate(`/reservations/${reservation.id}`)}\n                                                            >\n                                                                <td className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words\">\n                                                                        {reservation.guestName}\n                                                                        {reservation.lobbyReservationId && (\n                                                                            <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                                                                ID: {reservation.lobbyReservationId}\n                                                                            </div>\n                                                                        )}\n                                                                    </div>\n                                                                </td>\n                                                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getReservationStatusColor(reservation.status)}`}>\n                                                                        {t(`reservations.status.${reservation.status}`, reservation.status)}\n                                                                    </span>\n                                                                </td>\n                                                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getPaymentStatusColor(reservation.paymentStatus)}`}>\n                                                                        {t(`reservations.paymentStatus.${reservation.paymentStatus}`, reservation.paymentStatus)}\n                                                                    </span>\n                                                                </td>\n                                                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                        {formatDate(reservation.checkInDate)} - {formatDate(reservation.checkOutDate)}\n                                                                    </div>\n                                                                </td>\n                                                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                        {reservation.roomNumber || '-'}\n                                                                    </div>\n                                                                </td>\n                                                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                    <div className=\"flex space-x-2 action-buttons\">\n                                                                        {hasPermission('reservations', 'write', 'table') && (\n                                                                            <>\n                                                                                {/* Einladung senden Button */}\n                                                                            <div className=\"relative group\">\n                                                                                <button\n                                                                                    onClick={(e) => {\n                                                                                        e.stopPropagation();\n                                                                                            setSelectedReservationForInvitation(reservation);\n                                                                                            setIsSendInvitationSidepaneOpen(true);\n                                                                                    }}\n                                                                                    className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                        title={t('reservations.sendInvitation', 'Einladung senden')}\n                                                                                    >\n                                                                                        <PaperAirplaneIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('reservations.sendInvitation', 'Einladung senden')}\n                                                                                    </div>\n                                                                                </div>\n                                                                                \n                                                                                {/* Key-Button fr PIN-Generierung */}\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={(e) => {\n                                                                                            e.stopPropagation();\n                                                                                            handleGeneratePinAndSend(reservation.id);\n                                                                                        }}\n                                                                                        disabled={generatingPinForReservation === reservation.id}\n                                                                                        className=\"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300 disabled:opacity-50 disabled:cursor-not-allowed\"\n                                                                                        title={t('reservations.generatePinAndSend', 'PIN generieren & Mitteilung versenden')}\n                                                                                    >\n                                                                                        {generatingPinForReservation === reservation.id ? (\n                                                                                            <ArrowPathIcon className=\"h-4 w-4 animate-spin\" />\n                                                                                        ) : (\n                                                                                            <KeyIcon className=\"h-4 w-4\" />\n                                                                                        )}\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('reservations.generatePinAndSend', 'PIN generieren & Mitteilung versenden')}\n                                                                                    </div>\n                                                                                </div>\n                                                                                \n                                                                                {/* Details Button */}\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={(e) => {\n                                                                                            e.stopPropagation();\n                                                                                            navigate(`/reservations/${reservation.id}`);\n                                                                                        }}\n                                                                                        className=\"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                        title={t('common.viewDetails', 'Details anzeigen')}\n                                                                                >\n                                                                                    <InformationCircleIcon className=\"h-4 w-4\" />\n                                                                                </button>\n                                                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                    {t('common.viewDetails', 'Details anzeigen')}\n                                                                                </div>\n                                                                            </div>\n                                                                            </>\n                                                                        )}\n                                                                    </div>\n                                                                </td>\n                                                            </tr>\n                                                        );\n                                                    })}\n                                                </>\n                                            )}\n                                        </tbody>\n                                    </table>\n                                </div>\n                            )}\n                            \n                            {/* \"Mehr anzeigen\" Button - Desktop - Reservations */}\n                            {activeTab === 'reservations' && filteredAndSortedReservations.length > displayLimit && (\n                                <div className=\"mt-4 flex justify-center\">\n                                    <button\n                                        className=\"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600\"\n                                        onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                                    >\n                                        {t('common.showMore')} ({filteredAndSortedReservations.length - displayLimit} {t('common.remaining')})\n                                    </button>\n                                </div>\n                            )}\n                            \n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n            {/* Die Modals fr beide Ansichten (mobil und desktop) */}\n            <CreateTaskModal \n                isOpen={isCreateModalOpen}\n                onClose={() => setIsCreateModalOpen(false)}\n                onTaskCreated={(newTask) => {\n                    // Optimistisches Update: Neuen Task zur Liste hinzufgen statt vollstndigem Reload\n                    if (newTask != null) {\n                        setTasks(prevTasks => {\n                            const validTasks = prevTasks.filter(task => task != null);\n                            return [newTask, ...validTasks];\n                        });\n                        setIsEditModalOpen(true);\n                        setSelectedTask(newTask);\n                    }\n                }}\n            />\n            \n            {selectedTask && (\n                <EditTaskModal\n                    isOpen={isEditModalOpen}\n                    onClose={() => {\n                        setIsEditModalOpen(false);\n                        setSelectedTask(null);\n                    }}\n                    onTaskUpdated={(updatedTask) => {\n                        // Optimistisches Update: Task in Liste aktualisieren statt vollstndigem Reload\n                        if (updatedTask != null) {\n                            setTasks(prevTasks => \n                                prevTasks\n                                    .filter(task => task != null)\n                                    .map(task => \n                                        task.id === updatedTask.id ? updatedTask : task\n                                    )\n                            );\n                            setIsEditModalOpen(false);\n                            setSelectedTask(null);\n                            toast.success(t('worktime.messages.taskUpdated'));\n                        }\n                    }}\n                    task={selectedTask}\n                />\n            )}\n            \n            {/* Create Reservation Modal */}\n            <CreateReservationModal\n                isOpen={isCreateReservationModalOpen}\n                onClose={() => setIsCreateReservationModalOpen(false)}\n                onReservationCreated={async (newReservation) => {\n                    // Wechsle zum Reservations-Tab\n                    setActiveTab('reservations');\n                    // Lade Reservations neu, um den aktualisierten Status zu erhalten\n                    await loadReservations();\n                }}\n            />\n            \n            {/* Send Invitation Sidepane */}\n            {selectedReservationForInvitation && (\n                <SendInvitationSidepane\n                    isOpen={isSendInvitationSidepaneOpen}\n                    onClose={() => {\n                        setIsSendInvitationSidepaneOpen(false);\n                        setSelectedReservationForInvitation(null);\n                    }}\n                    reservation={selectedReservationForInvitation}\n                    onSuccess={async () => {\n                        // Lade Reservations neu, um den aktualisierten Status zu erhalten\n                        await loadReservations();\n                    }}\n                />\n            )}\n        </div>\n    );\n};\n\nexport default Worktracker; "],"names":["_ref","isOpen","onClose","onReservationCreated","t","useTranslation","showMessage","useMessage","openSidepane","closeSidepane","useSidepane","isMobile","setIsMobile","useState","window","innerWidth","isLargeScreen","setIsLargeScreen","guestName","setGuestName","contact","setContact","amount","setAmount","currency","setCurrency","contactType","setContactType","error","setError","loading","setLoading","handleContactChange","e","value","target","trim","length","includes","detectContactType","handleAmountChange","test","useEffect","handleResize","addEventListener","removeEventListener","handleSubmit","async","preventDefault","parseFloat","data","console","log","newReservation","reservationService","create","err","_err$response","_err$response2","_err$response3","_err$response3$data","response","status","errorMessage","message","handleClose","_jsxs","Dialog","open","className","children","_jsx","Panel","Title","onClick","XMarkIcon","onSubmit","htmlFor","type","id","onChange","required","placeholder","disabled","_Fragment","style","opacity","transition","concat","pointerEvents","role","ReservationStatus","PaymentStatus","API_BASE","axiosInstance","post","getById","get","updateGuestContact","put","generatePinAndSend","API_ENDPOINTS","RESERVATION","GENERATE_PIN_AND_SEND","sendInvitation","options","SEND_INVITATION","getNotificationLogs","NOTIFICATION_LOGS","onArticleSelected","excludeArticleIds","selectedArticles","onArticleRemove","articles","setArticles","selectedArticleId","setSelectedArticleId","selectedArticlePreview","setSelectedArticlePreview","filteredArticles","CEREBRO","ARTICLES","BASE","filter","article","_axiosError$response","_axiosError$response$","axiosError","fetchAllArticles","articleId","parseInt","isNaN","find","BY_ID","fetchArticleDetails","map","title","handleArticleConfirm","selectedArticle","content","substring","href","slug","rel","TaskForm","_ref2","setTitle","description","setDescription","assigneeType","setAssigneeType","responsibleId","setResponsibleId","roleId","setRoleId","qualityControlId","setQualityControlId","branchId","setBranchId","dueDate","setDueDate","users","roles","branches","onArticleSelect","uploading","temporaryAttachments","onFileUpload","onRemoveAttachment","textareaRef","fileInputRef","handlePaste","handleDrop","handleDragOver","activeTab","setActiveTab","noValidate","ref","rows","onPaste","onDrop","onDragOver","_fileInputRef$current","current","click","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","attachment","index","fileName","fileType","startsWith","file","src","URL","createObjectURL","alt","name","checked","Number","Array","isArray","user","firstName","lastName","branch","CerebroArticleSelector","a","ArrowPathIcon","CheckIcon","onTaskCreated","useAuth","setUsers","setRoles","setBranches","setSelectedArticles","setTemporaryAttachments","setUploading","useRef","fetchUsers","fetchRoles","fetchBranches","getDefaultDueDate","date","Date","setDate","getDate","toISOString","split","checkScreenSize","localStorage","getItem","USERS","DROPDOWN","code","ROLES","_axiosError$response2","_axiosError$response3","BRANCHES","_axiosError$response4","_axiosError$response5","items","event","clipboardData","i","item","indexOf","getAsFile","handleTemporaryAttachment","stopPropagation","dataTransfer","files","newAttachment","fileSize","size","prev","insertText","cursorPos","selectionStart","textBefore","textAfter","setTimeout","newPos","selectionEnd","focus","_axiosError$response6","_axiosError$response7","handleFileUpload","handleRemoveTemporaryAttachment","attachmentToRemove","_","escapedFileName","replace","uploadText","imagePattern","RegExp","linkPattern","newDescription","qualityControl","responsible","taskData","TASKS","newTaskId","Promise","all","LINK_CARTICLE","formData","FormData","append","ATTACHMENTS","taskId","headers","uploadTemporaryAttachments","_axiosError$response8","_axiosError$response9","handleAddArticle","handleRemoveArticle","_task$title","_task$title2","_task$title3","_task$title4","_task$description","task","isLifecycleTask","autoGeneratedData","jsonMatch","match","JSON","parse","forEach","line","key","Object","keys","taskType","ClipboardDocumentIcon","defaultValue","dataString","stringify","navigator","clipboard","writeText","entries","String","emailTemplate","setEmailTemplate","emailSent","setEmailSent","generating","setGenerating","EnvelopeIcon","template","_error$response","_error$response$data","resolve","_error$response2","_error$response2$data","PaperAirplaneIcon","onComplete","setFormData","registrationNumber","provider","registrationDate","notes","socialSecurityType","getSocialSecurityType","_task$title5","_task$title6","_task$title7","_task$title8","userId","extractUserId","userIdMatch","LIFECYCLE","SOCIAL_SECURITY","completedAt","_objectSpread","_task$qualityControl","_task$branch","onTaskUpdated","hasPermission","usePermissions","text","originalDescription","setStatus","attachments","setAttachments","uploadedDuringEdit","setUploadedDuringEdit","dateString","getTime","formatDate","confirmDelete","setConfirmDelete","linkedArticles","setLinkedArticles","canDeleteTask","attachmentId","delete","ATTACHMENT","cleanup","fetchLinkedArticles","fetchAttachments","CARTICLES","uploadFileAndInsertLink","getTaskAttachmentUrl","_axiosError$response10","_axiosError$response11","finalDescription","imageAttachments","att","_att$fileType","existingImagePattern","existingImages","exec","push","imageUrl","imageMarkdown","existingImage","updatedTaskResponse","filePath","uploadedAt","url","_axiosError$response12","_axiosError$response13","handleDelete","undefined","_axiosError$response14","_axiosError$response15","_axiosError$response16","_axiosError$response17","UNLINK_CARTICLE","_axiosError$response18","_axiosError$response19","renderForm","renderAttachments","renderTemporaryAttachments","TaskDataBox","EmailTemplateBox","SocialSecurityCompletionBox","TrashIcon","responseType","Blob","link","document","createElement","setAttribute","body","appendChild","remove","_axiosError$response22","_axiosError$response23","handleDownloadAttachment","escapedAttachmentUrl","_axiosError$response20","_axiosError$response21","handleDeleteAttachment","_attachment$fileType","reservation","onSuccess","guestPhone","setGuestPhone","guestEmail","setGuestEmail","customMessage","setCustomMessage","previewMessage","setPreviewMessage","generateStandardMessage","email","checkInLink","codigo","toString","baseUrl","params","URLSearchParams","paymentLink","preview","_err$response$data","alreadySent","sentMessageAt","toLocaleString","WorktimeTracker","isTracking","setIsTracking","startTime","setStartTime","elapsedTime","setElapsedTime","activeWorktime","setActiveWorktime","isLoading","setIsLoading","showWorkTimeModal","setShowWorkTimeModal","statusError","setStatusError","contextTracking","updateTrackingStatus","checkTrackingStatus","useWorktime","selectedBranch","setSelectedBranch","useBranch","organization","useOrganization","isDifferentOrganization","useMemo","organizationId","useCallback","token","WORKTIME","ACTIVE","active","startISOString","endsWith","startTimeDate","diff","totalSeconds","Math","floor","hours","minutes","seconds","padStart","intervalId","setInterval","clearInterval","handleStartTracking","alert","START","getTimezoneOffset","handleStopTracking","STOP","endTime","_error$response$data2","branchName","_branches$find","b","ClockIcon","confirm","force","ExclamationTriangleIcon","openWorkTimeModal","ListBulletIcon","day","month","getMonth","year","getFullYear","getHours","getMinutes","getSeconds","formatStartDate","now","WorktimeModal","closeWorkTimeModal","defaultColumnOrder","TODOS_TABLE_ID","RESERVATIONS_TABLE_ID","tableToCardMapping","cardToTableMapping","Worktracker","permissions","location","useLocation","navigate","useNavigate","availableColumns","label","shortLabel","filterOnlyColumns","availableReservationColumns","reservationFilterOnlyColumns","tasks","setTasks","allTasks","setAllTasks","searchTerm","setSearchTerm","statusFilter","setStatusFilter","reservations","setReservations","reservationsLoading","setReservationsLoading","reservationsError","setReservationsError","reservationSearchTerm","setReservationSearchTerm","reservationFilterStatus","setReservationFilterStatus","reservationFilterPaymentStatus","setReservationFilterPaymentStatus","isCreateReservationModalOpen","setIsCreateReservationModalOpen","syncingReservations","setSyncingReservations","generatingPinForReservation","setGeneratingPinForReservation","selectedReservationForInvitation","setSelectedReservationForInvitation","isSendInvitationSidepaneOpen","setIsSendInvitationSidepaneOpen","reservationFilterConditions","setReservationFilterConditions","reservationFilterLogicalOperators","setReservationFilterLogicalOperators","reservationFilterSortDirections","setReservationFilterSortDirections","reservationActiveFilterName","setReservationActiveFilterName","reservationSelectedFilterId","setReservationSelectedFilterId","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","filterSortDirections","setFilterSortDirections","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","isFilterModalOpen","setIsFilterModalOpen","tableSortConfig","setTableSortConfig","direction","isCreateModalOpen","setIsCreateModalOpen","isEditModalOpen","setIsEditModalOpen","selectedTask","setSelectedTask","copiedTask","setCopiedTask","settings","tasksSettings","isLoadingTasksSettings","updateColumnOrder","updateTasksColumnOrder","updateHiddenColumns","updateTasksHiddenColumns","toggleColumnVisibility","toggleTasksColumnVisibility","isColumnVisible","isTasksColumnVisible","updateViewMode","updateTasksViewMode","useTableSettings","defaultHiddenColumns","defaultViewMode","defaultReservationColumnOrder","reservationsSettings","isLoadingReservationsSettings","updateReservationsColumnOrder","updateReservationsHiddenColumns","toggleReservationsColumnVisibility","isReservationsColumnVisible","updateReservationsViewMode","draggedColumn","setDraggedColumn","dragOverColumn","setDragOverColumn","displayLimit","setDisplayLimit","viewMode","cardMetadataOrder","columnOrder","cardMetadata","tableCol","cardMeta","getCardMetadataFromColumnOrder","hiddenCardMetadata","hiddenTableColumns","Set","add","getHiddenCardMetadata","hiddenColumns","visibleCardMetadata","meta","has","querySelectorAll","wrapper","classList","hasLoadedRef","loadTasks","filterId","background","arguments","conditions","operators","tasksWithAttachments","handleGeneratePinAndSend","reservationId","loadReservations","_response$data","reservationsData","editTaskId","search","SAVED_FILTERS","BY_TABLE","aktuellFilter","sortDirections","column","priority","conditionIndex","findIndex","c","applyFilterConditions","setInitialFilterAndLoad","existingFilters","Authorization","archivFilterExists","some","aktuellFilterExists","archivFilter","tableId","operator","createStandardFilters","handleStatusChange","newStatus","prevTasks","patch","toast","success","isResponsibleForTask","_user$roles","userRole","_userRole$role","_task$role","isQualityControlForTask","handleSort","renderStatusButtons","buttons","ArrowLeftIcon","ArrowRightIcon","getActiveFilterCount","validSortDirections","resetFilterConditions","applyReservationFilterConditions","resetReservationFilterConditions","handleFilterChange","getStatusPriority","getReservationStatusColor","CONFIRMED","NOTIFICATION_SENT","CHECKED_IN","CHECKED_OUT","CANCELLED","NO_SHOW","getPaymentStatusColor","PAID","PARTIALLY_PAID","REFUNDED","PENDING","filteredAndSortedTasks","tasksToFilter","filtered","searchLower","toLowerCase","columnEvaluators","cond","_task$responsible","_task$role2","responsibleName","evaluateUserRoleCondition","_task$qualityControl2","qualityControlName","responsibleAndQualityControl","_task$responsible2","_task$role3","_task$qualityControl3","evaluateResponsibleAndQualityControl","evaluateDateCondition","getFieldValue","columnId","applyFilters","getSortValue","MAX_SAFE_INTEGER","sorted","sort","sortedByPriority","sd1","sd2","sortDir","valueA","valueB","comparison","localeCompare","aDate","bDate","aStatusPrio","bStatusPrio","filteredAndSortedReservations","validReservations","paymentStatus","roomNumber","lobbyReservationId","checkInDate","handleMoveColumn","dragIndex","hoverIndex","newColumnOrder","splice","handleDragStart","handleDragEnd","visibleColumnIds","validOrder","missingColumns","handleCopyTask","_task$qualityControl4","copiedTaskData","handleDeleteTask","width","height","PlusIcon","CheckCircleIcon","Squares2X2Icon","TableCellsIcon","FunnelIcon","TableColumnConfig","columns","visibleColumns","from","onToggleColumnVisibility","tableColumn","otherCardMeta","onMoveColumn","newCardOrder","dragged","newTableOrder","usedTableColumns","col","buttonTitle","modalTitle","FilterPane","onApply","onReset","savedConditions","savedOperators","savedSortDirections","onSortDirectionsChange","SavedFilterTags","onSelectFilter","onFilterChange","defaultFilterName","scope","draggable","onDragStart","onDragEnd","ArrowsUpDownIcon","colSpan","ClipboardDocumentListIcon","slice","expiryStatus","getExpiryStatus","expiryColors","getExpiryColorClasses","bgClass","borderClass","InformationCircleIcon","MarkdownPreview","showImagePreview","getStatusColor","expiryStatusForDate","expiryColorsForDate","textClass","toLocaleDateString","PencilIcon","DocumentDuplicateIcon","CardGrid","metadata","icon","BuildingOfficeIcon","section","responsibleValue","shortenedName","UserIcon","qualityControlValue","dueDateItem","createDueDateMetadataItem","CalendarIcon","format","locale","de","descriptionContent","attachmentMetadata","actionButtons","DataCard","getStatusText","color","onPreviousClick","onNextClick","actions","prevLimit","_filteredAndSortedRes","_unused","checkOutDate","HomeIcon","PhoneIcon","LinkIcon","encodeURIComponent","amountValue","toFixed","CurrencyDollarIcon","arrivalTime","formatDateTime","_unused2","doorPin","KeyIcon","doorAppName","onlineCheckInCompleted","sentMessage","formatMessageDate","_unused3","hasWritePermission","entity","accessLevel","entityType","actionButtonsWillBeCreated","subtitle","_unused4","RESERVATIONS","SYNC","_err$response2$data","expiryStatusForDate2","expiryColorsForDate2","_unused5","_unused6","_unused7","_unused8","CreateTaskModal","newTask","validTasks","EditTaskModal","updatedTask","CreateReservationModal","SendInvitationSidepane"],"sourceRoot":""}