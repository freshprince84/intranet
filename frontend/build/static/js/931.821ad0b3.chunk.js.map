{"version":3,"file":"static/js/931.821ad0b3.chunk.js","mappings":"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","sources":["components/CertificateCreationModal.tsx","components/ContractCreationModal.tsx","components/CertificateEditModal.tsx","components/ContractEditModal.tsx","components/SocialSecurityEditor.tsx","components/OffboardingStartModal.tsx","components/OffboardingCompleteModal.tsx","components/LifecycleView.tsx","components/UserManagementTab.tsx","components/RoleManagementTab.tsx","components/BranchManagementTab.tsx","components/organization/CreateOrganizationModal.tsx","components/organization/JoinOrganizationModal.tsx","components/organization/RoleConfigurationTab.tsx","components/organization/DocumentConfigurationTab.tsx","components/organization/SMTPConfigurationTab.tsx","utils/urlValidation.ts","components/organization/ApiConfigurationTab.tsx","components/organization/EditOrganizationModal.tsx","components/organization/MyJoinRequestsList.tsx","components/organization/OrganizationSettings.tsx","components/organization/ProcessJoinRequestModal.tsx","components/organization/JoinRequestsList.tsx","pages/Organisation.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, UserIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface CertificateCreationModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCertificateCreated: () => void;\n  userId: number;\n  userName: string;\n}\n\ninterface UserData {\n  firstName: string;\n  lastName: string;\n  identificationNumber: string | null;\n  contractStartDate: string | null;\n  contractEndDate: string | null;\n  contractType: string | null;\n  salary: number | null;\n  position: string | null;\n}\n\nconst CertificateCreationModal: React.FC<CertificateCreationModalProps> = ({\n  isOpen,\n  onClose,\n  onCertificateCreated,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { user: currentUser } = useAuth();\n  const { isHR, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [activeTab, setActiveTab] = useState<'data' | 'text'>('data');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [userData, setUserData] = useState<UserData | null>(null);\n  const [issueDate, setIssueDate] = useState(new Date().toISOString().split('T')[0]);\n  const [certificateType, setCertificateType] = useState('employment');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [uploading, setUploading] = useState(false);\n  const [availableTemplates, setAvailableTemplates] = useState<Array<{type: string; version: string; path: string}>>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null);\n  const [useTemplate, setUseTemplate] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR()) {\n      showMessage('Nur HR oder Admin knnen Arbeitszeugnisse erstellen', 'error');\n      onClose();\n    }\n  }, [isHR, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      fetchUserData();\n      fetchTemplates();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const fetchTemplates = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      const templates: Array<{type: string; version: string; path: string}> = [];\n      \n      if (documentTemplates.employmentCertificate) {\n        templates.push({\n          type: 'employmentCertificate',\n          version: documentTemplates.employmentCertificate.version,\n          path: documentTemplates.employmentCertificate.path\n        });\n      }\n      \n      setAvailableTemplates(templates);\n      if (templates.length > 0) {\n        setSelectedTemplate(templates[0].type);\n        setUseTemplate(true);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Templates:', err);\n      // Kein Fehler anzeigen, Templates sind optional\n    }\n  };\n\n  const fetchUserData = async () => {\n    try {\n      const [userResponse, lifecycleResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.USERS.BY_ID(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId))\n      ]);\n\n      const user = userResponse.data;\n      const lifecycle = lifecycleResponse.data.lifecycle;\n\n      const userDataObj = {\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        identificationNumber: user.identificationNumber || null,\n        contractStartDate: lifecycle?.contractStartDate || null,\n        contractEndDate: lifecycle?.contractEndDate || null,\n        contractType: lifecycle?.contractType || null,\n        salary: user.salary || null,\n        position: null // TODO: Aus Rollen ableiten\n      };\n\n      setUserData(userDataObj);\n\n      // Automatische Vorausfllung: Ausstellungsdatum auf heute setzen (wenn noch nicht gesetzt)\n      if (!issueDate || issueDate === new Date().toISOString().split('T')[0]) {\n        setIssueDate(new Date().toISOString().split('T')[0]);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der User-Daten:', err);\n      setError('Fehler beim Laden der Daten');\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) { // 10MB\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      setUseTemplate(false); // Deaktiviere Template wenn PDF hochgeladen wird\n      // Erstelle Preview-URL\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n    }\n  };\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const validateForm = (): string | null => {\n    if (!useTemplate && !pdfFile) {\n      return 'Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch';\n    }\n    if (!issueDate) {\n      return 'Bitte geben Sie ein Ausstellungsdatum an';\n    }\n    const issueDateObj = new Date(issueDate);\n    if (isNaN(issueDateObj.getTime())) {\n      return 'Ungltiges Ausstellungsdatum';\n    }\n    if (issueDateObj > new Date()) {\n      return 'Ausstellungsdatum darf nicht in der Zukunft liegen';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Client-seitige Validierung\n    const validationError = validateForm();\n    if (validationError) {\n      setError(validationError);\n      showMessage(validationError, 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      let pdfPath: string | undefined = undefined;\n      let templateUsed: string | null = null;\n      let templateVersion: string | null = null;\n\n      // Wenn Template verwendet werden soll und kein PDF hochgeladen wurde\n      if (useTemplate && selectedTemplate && !pdfFile) {\n        const template = availableTemplates.find(t => t.type === selectedTemplate);\n        if (template) {\n          templateUsed = template.type;\n          templateVersion = template.version;\n          // PDF wird vom Backend generiert\n        }\n      } else if (pdfFile) {\n        // PDF wurde hochgeladen - verwende dieses\n        pdfPath = `temp-${Date.now()}-${pdfFile.name}`; // Temporr\n      } else {\n        showMessage('Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch', 'error');\n        setLoading(false);\n        return;\n      }\n\n      const certificateData = {\n        certificateType,\n        issueDate: new Date(issueDate),\n        pdfPath,\n        templateUsed,\n        templateVersion\n      };\n\n      await axiosInstance.post(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATES(userId),\n        certificateData\n      );\n\n      showMessage('Arbeitszeugnis erfolgreich erstellt', 'success');\n      onCertificateCreated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      setIssueDate(new Date().toISOString().split('T')[0]);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Erstellen des Arbeitszeugnisses:', err);\n      setError(err.response?.data?.message || 'Fehler beim Erstellen des Arbeitszeugnisses');\n      showMessage('Fehler beim Erstellen des Arbeitszeugnisses', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {/* Overlay - nur auf Mobile und Desktop (nicht Large Desktop) */}\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n          `}\n          style={{\n            animation: isMobile ? 'none' : 'slideIn 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94)'\n          }}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitszeugnis erstellen\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Fr: <span className=\"font-medium dark:text-white\">{userName}</span>\n              </p>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n              <nav className=\"-mb-px flex space-x-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('data')}\n                  className={`${\n                    activeTab === 'data'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Daten\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('text')}\n                  className={`${\n                    activeTab === 'text'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  PDF hochladen\n                </button>\n              </nav>\n            </div>\n\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            {/* Tab Content */}\n            {activeTab === 'data' && (\n              <div className=\"space-y-4\">\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4\">\n                  <h3 className=\"text-sm font-semibold dark:text-white mb-3\">\n                    Automatisch erkannte Daten\n                  </h3>\n                  <div className=\"space-y-2 text-sm\">\n                    {userData && (\n                      <>\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4 text-gray-400\" />\n                          <span className=\"text-gray-600 dark:text-gray-400\">Name:</span>\n                          <span className=\"dark:text-white\">\n                            {userData.firstName} {userData.lastName}\n                          </span>\n                        </div>\n                        {userData.identificationNumber && (\n                          <div className=\"flex items-center space-x-2\">\n                            <DocumentTextIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Cdula:</span>\n                            <span className=\"dark:text-white\">{userData.identificationNumber}</span>\n                          </div>\n                        )}\n                        {userData.contractStartDate && (\n                          <div className=\"flex items-center space-x-2\">\n                            <CalendarIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Eintrittsdatum:</span>\n                            <span className=\"dark:text-white\">\n                              {new Date(userData.contractStartDate).toLocaleDateString('de-DE')}\n                            </span>\n                          </div>\n                        )}\n                        {userData.contractEndDate && (\n                          <div className=\"flex items-center space-x-2\">\n                            <CalendarIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Austrittsdatum:</span>\n                            <span className=\"dark:text-white\">\n                              {new Date(userData.contractEndDate).toLocaleDateString('de-DE')}\n                            </span>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Ausstellungsdatum <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={issueDate}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setIssueDate(value);\n                      // Validierung: Datum darf nicht in der Zukunft liegen\n                      if (value && new Date(value) > new Date()) {\n                        setError('Ausstellungsdatum darf nicht in der Zukunft liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    max={new Date().toISOString().split('T')[0]}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && issueDate && new Date(issueDate) > new Date()\n                        ? 'border-red-500 dark:border-red-500' \n                        : error && !issueDate\n                        ? 'border-red-500 dark:border-red-500'\n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    required\n                    aria-invalid={(!issueDate || (issueDate && new Date(issueDate) > new Date())) ? true : undefined}\n                    aria-describedby={(!issueDate || (issueDate && new Date(issueDate) > new Date())) ? \"issueDate-error\" : undefined}\n                  />\n                  {error && (!issueDate || (issueDate && new Date(issueDate) > new Date())) && (\n                    <p id=\"issueDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                  {!error && (\n                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                      Das Datum darf nicht in der Zukunft liegen\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Zertifikat-Typ <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={certificateType}\n                    onChange={(e) => setCertificateType(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    required\n                  >\n                    <option value=\"employment\">Arbeitszeugnis</option>\n                    <option value=\"salary\">Gehaltsbescheinigung</option>\n                    <option value=\"work_experience\">Arbeitsbescheinigung</option>\n                  </select>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'text' && (\n              <div className=\"space-y-4\">\n                {/* Template-Auswahl */}\n                {availableTemplates.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Template verwenden\n                    </label>\n                    <div className=\"flex items-center space-x-3 mb-4\">\n                      <input\n                        type=\"checkbox\"\n                        checked={useTemplate}\n                        onChange={(e) => {\n                          setUseTemplate(e.target.checked);\n                          if (e.target.checked && pdfFile) {\n                            // Wenn Template aktiviert wird, entferne PDF\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      />\n                      <label className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        Template fr automatische PDF-Generierung verwenden\n                      </label>\n                    </div>\n                    {useTemplate && (\n                      <select\n                        value={selectedTemplate || ''}\n                        onChange={(e) => setSelectedTemplate(e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4\"\n                      >\n                        {availableTemplates.map((template) => (\n                          <option key={template.type} value={template.type}>\n                            Arbeitszeugnis (Version {template.version})\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    {useTemplate ? 'ODER PDF-Datei hochladen' : 'PDF-Datei hochladen'} {!useTemplate && <span className=\"text-red-500\">*</span>}\n                  </label>\n                  <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\".pdf\"\n                      onChange={handleFileSelect}\n                      className=\"hidden\"\n                    />\n                    {!pdfFile ? (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => fileInputRef.current?.click()}\n                          className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                        >\n                          PDF-Datei auswhlen\n                        </button>\n                        <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                          oder Datei hierher ziehen\n                        </p>\n                        <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                          Max. 10MB\n                        </p>\n                      </div>\n                    ) : (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                        <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                          {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                        </p>\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                            if (fileInputRef.current) {\n                              fileInputRef.current.value = '';\n                            }\n                          }}\n                          className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                        >\n                          Datei entfernen\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* PDF-Vorschau */}\n                {pdfPreviewUrl && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl}#view=FitH`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || (!pdfFile && !useTemplate)}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird erstellt...' : 'Erstellen'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default CertificateCreationModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, UserIcon, CurrencyDollarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface ContractCreationModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onContractCreated: () => void;\n  userId: number;\n  userName: string;\n}\n\ninterface UserData {\n  firstName: string;\n  lastName: string;\n  identificationNumber: string | null;\n  contractStartDate: string | null;\n  contractEndDate: string | null;\n  contractType: string | null;\n  salary: number | null;\n  position: string | null;\n}\n\nconst ContractCreationModal: React.FC<ContractCreationModalProps> = ({\n  isOpen,\n  onClose,\n  onContractCreated,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { user: currentUser } = useAuth();\n  const { isHR, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [activeTab, setActiveTab] = useState<'data' | 'text'>('data');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [userData, setUserData] = useState<UserData | null>(null);\n  const [contractType, setContractType] = useState('employment');\n  const [startDate, setStartDate] = useState(new Date().toISOString().split('T')[0]);\n  const [endDate, setEndDate] = useState<string>('');\n  const [salary, setSalary] = useState<string>('');\n  const [workingHours, setWorkingHours] = useState<string>('');\n  const [position, setPosition] = useState<string>('');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [availableTemplates, setAvailableTemplates] = useState<Array<{type: string; version: string; path: string}>>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null);\n  const [useTemplate, setUseTemplate] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR()) {\n      showMessage('Nur HR oder Admin knnen Arbeitsvertrge erstellen', 'error');\n      onClose();\n    }\n  }, [isHR, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      fetchUserData();\n      fetchTemplates();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const fetchTemplates = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      const templates: Array<{type: string; version: string; path: string}> = [];\n      \n      if (documentTemplates.employmentContract) {\n        templates.push({\n          type: 'employmentContract',\n          version: documentTemplates.employmentContract.version,\n          path: documentTemplates.employmentContract.path\n        });\n      }\n      \n      setAvailableTemplates(templates);\n      if (templates.length > 0) {\n        setSelectedTemplate(templates[0].type);\n        setUseTemplate(true);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Templates:', err);\n      // Kein Fehler anzeigen, Templates sind optional\n    }\n  };\n\n  const fetchUserData = async () => {\n    try {\n      const [userResponse, lifecycleResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.USERS.BY_ID(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId))\n      ]);\n\n      const user = userResponse.data;\n      const lifecycle = lifecycleResponse.data.lifecycle;\n\n      const data: UserData = {\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        identificationNumber: user.identificationNumber || null,\n        contractStartDate: lifecycle?.contractStartDate || null,\n        contractEndDate: lifecycle?.contractEndDate || null,\n        contractType: lifecycle?.contractType || null,\n        salary: user.salary || null,\n        position: null\n      };\n\n      setUserData(data);\n      \n      // Setze Standard-Werte\n      if (data.contractStartDate) {\n        setStartDate(new Date(data.contractStartDate).toISOString().split('T')[0]);\n      }\n      if (data.contractEndDate) {\n        setEndDate(new Date(data.contractEndDate).toISOString().split('T')[0]);\n      }\n      if (data.salary) {\n        setSalary(data.salary.toString());\n      }\n      if (data.contractType) {\n        setContractType(data.contractType);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der User-Daten:', err);\n      setError('Fehler beim Laden der Daten');\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) { // 10MB\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      setUseTemplate(false); // Deaktiviere Template wenn PDF hochgeladen wird\n      // Erstelle Preview-URL\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n    }\n  };\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const validateForm = (): string | null => {\n    if (!useTemplate && !pdfFile) {\n      return 'Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch';\n    }\n    if (!startDate) {\n      return 'Bitte geben Sie ein Startdatum an';\n    }\n    const startDateObj = new Date(startDate);\n    if (isNaN(startDateObj.getTime())) {\n      return 'Ungltiges Startdatum';\n    }\n    if (endDate) {\n      const endDateObj = new Date(endDate);\n      if (isNaN(endDateObj.getTime())) {\n        return 'Ungltiges Enddatum';\n      }\n      if (endDateObj < startDateObj) {\n        return 'Enddatum muss nach dem Startdatum liegen';\n      }\n    }\n    if (salary && parseFloat(salary) < 0) {\n      return 'Gehalt darf nicht negativ sein';\n    }\n    if (workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)) {\n      return 'Arbeitsstunden mssen zwischen 0 und 168 liegen';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Client-seitige Validierung\n    const validationError = validateForm();\n    if (validationError) {\n      setError(validationError);\n      showMessage(validationError, 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      let pdfPath: string | undefined = undefined;\n      let templateUsed: string | null = null;\n      let templateVersion: string | null = null;\n\n      // Wenn Template verwendet werden soll und kein PDF hochgeladen wurde\n      if (useTemplate && selectedTemplate && !pdfFile) {\n        const template = availableTemplates.find(t => t.type === selectedTemplate);\n        if (template) {\n          templateUsed = template.type;\n          templateVersion = template.version;\n          // PDF wird vom Backend generiert\n        }\n      } else if (pdfFile) {\n        // PDF wurde hochgeladen - verwende dieses\n        pdfPath = `temp-${Date.now()}-${pdfFile.name}`; // Temporr\n      } else {\n        showMessage('Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch', 'error');\n        setLoading(false);\n        return;\n      }\n\n      const contractData = {\n        contractType,\n        startDate: new Date(startDate),\n        endDate: endDate ? new Date(endDate) : null,\n        salary: salary ? parseFloat(salary) : null,\n        workingHours: workingHours ? parseFloat(workingHours) : null,\n        position: position || null,\n        pdfPath,\n        templateUsed,\n        templateVersion\n      };\n\n      await axiosInstance.post(\n        API_ENDPOINTS.LIFECYCLE.CONTRACTS(userId),\n        contractData\n      );\n\n      showMessage('Arbeitsvertrag erfolgreich erstellt', 'success');\n      onContractCreated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      setStartDate(new Date().toISOString().split('T')[0]);\n      setEndDate('');\n      setSalary('');\n      setWorkingHours('');\n      setPosition('');\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Erstellen des Arbeitsvertrags:', err);\n      setError(err.response?.data?.message || 'Fehler beim Erstellen des Arbeitsvertrags');\n      showMessage('Fehler beim Erstellen des Arbeitsvertrags', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {/* Overlay */}\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitsvertrag erstellen\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Fr: <span className=\"font-medium dark:text-white\">{userName}</span>\n              </p>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n              <nav className=\"-mb-px flex space-x-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('data')}\n                  className={`${\n                    activeTab === 'data'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Vertragsdaten\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('text')}\n                  className={`${\n                    activeTab === 'text'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  PDF hochladen\n                </button>\n              </nav>\n            </div>\n\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            {/* Tab Content */}\n            {activeTab === 'data' && (\n              <div className=\"space-y-4\">\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4\">\n                  <h3 className=\"text-sm font-semibold dark:text-white mb-3\">\n                    Automatisch erkannte Daten\n                  </h3>\n                  <div className=\"space-y-2 text-sm\">\n                    {userData && (\n                      <>\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4 text-gray-400\" />\n                          <span className=\"text-gray-600 dark:text-gray-400\">Name:</span>\n                          <span className=\"dark:text-white\">\n                            {userData.firstName} {userData.lastName}\n                          </span>\n                        </div>\n                        {userData.identificationNumber && (\n                          <div className=\"flex items-center space-x-2\">\n                            <DocumentTextIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Cdula:</span>\n                            <span className=\"dark:text-white\">{userData.identificationNumber}</span>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Vertragstyp <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={contractType}\n                    onChange={(e) => setContractType(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  >\n                    <option value=\"employment\">Arbeitsvertrag</option>\n                    <option value=\"amendment\">Vertragsnderung</option>\n                    <option value=\"extension\">Vertragsverlngerung</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Startdatum <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={startDate}\n                    onChange={(e) => {\n                      setStartDate(e.target.value);\n                      setError(null); // Clear error when user starts typing\n                    }}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && !startDate \n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    required\n                    aria-invalid={!startDate}\n                    aria-describedby={!startDate ? \"startDate-error\" : undefined}\n                  />\n                  {error && !startDate && (\n                    <p id=\"startDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Enddatum (optional)\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={endDate}\n                    onChange={(e) => {\n                      setEndDate(e.target.value);\n                      // Wenn Enddatum gesetzt wird, prfe ob es nach Startdatum liegt\n                      if (e.target.value && startDate && new Date(e.target.value) < new Date(startDate)) {\n                        setError('Enddatum muss nach dem Startdatum liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    min={startDate || undefined}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && endDate && startDate && new Date(endDate) < new Date(startDate)\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    aria-invalid={endDate && startDate && new Date(endDate) < new Date(startDate) ? true : undefined}\n                    aria-describedby={endDate && startDate && new Date(endDate) < new Date(startDate) ? \"endDate-error\" : undefined}\n                  />\n                  {error && endDate && startDate && new Date(endDate) < new Date(startDate) && (\n                    <p id=\"endDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Position\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={position}\n                    onChange={(e) => setPosition(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    placeholder=\"z.B. Frontend-Entwickler\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Gehalt (optional)\n                  </label>\n                  <div className=\"relative\">\n                    <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                    <input\n                      type=\"number\"\n                      value={salary}\n                      onChange={(e) => {\n                        const value = e.target.value;\n                        setSalary(value);\n                        // Validierung: Gehalt darf nicht negativ sein\n                        if (value && parseFloat(value) < 0) {\n                          setError('Gehalt darf nicht negativ sein');\n                        } else {\n                          setError(null); // Clear error when valid\n                        }\n                      }}\n                      className={`w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                        error && salary && parseFloat(salary) < 0\n                          ? 'border-red-500 dark:border-red-500' \n                          : 'border-gray-300 dark:border-gray-600'\n                      }`}\n                      placeholder=\"0.00\"\n                      step=\"0.01\"\n                      min=\"0\"\n                      aria-invalid={salary && parseFloat(salary) < 0 ? true : undefined}\n                      aria-describedby={salary && parseFloat(salary) < 0 ? \"salary-error\" : undefined}\n                    />\n                  </div>\n                  {error && salary && parseFloat(salary) < 0 && (\n                    <p id=\"salary-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Arbeitsstunden/Woche (optional)\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={workingHours}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setWorkingHours(value);\n                      // Validierung: Arbeitsstunden mssen zwischen 0 und 168 liegen\n                      if (value && (parseFloat(value) < 0 || parseFloat(value) > 168)) {\n                        setError('Arbeitsstunden mssen zwischen 0 und 168 liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    placeholder=\"40\"\n                    step=\"0.1\"\n                    min=\"0\"\n                    max=\"168\"\n                    aria-invalid={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? true : undefined}\n                    aria-describedby={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? \"workingHours-error\" : undefined}\n                  />\n                  {error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) && (\n                    <p id=\"workingHours-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                    Maximal 168 Stunden pro Woche (24h  7 Tage)\n                  </p>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'text' && (\n              <div className=\"space-y-4\">\n                {/* Template-Auswahl */}\n                {availableTemplates.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Template verwenden\n                    </label>\n                    <div className=\"flex items-center space-x-3 mb-4\">\n                      <input\n                        type=\"checkbox\"\n                        checked={useTemplate}\n                        onChange={(e) => {\n                          setUseTemplate(e.target.checked);\n                          if (e.target.checked && pdfFile) {\n                            // Wenn Template aktiviert wird, entferne PDF\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      />\n                      <label className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        Template fr automatische PDF-Generierung verwenden\n                      </label>\n                    </div>\n                    {useTemplate && (\n                      <select\n                        value={selectedTemplate || ''}\n                        onChange={(e) => setSelectedTemplate(e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4\"\n                      >\n                        {availableTemplates.map((template) => (\n                          <option key={template.type} value={template.type}>\n                            Arbeitsvertrag (Version {template.version})\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    {useTemplate ? 'ODER PDF-Datei hochladen' : 'PDF-Datei hochladen'} {!useTemplate && <span className=\"text-red-500\">*</span>}\n                  </label>\n                  <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\".pdf\"\n                      onChange={handleFileSelect}\n                      className=\"hidden\"\n                    />\n                    {!pdfFile ? (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => fileInputRef.current?.click()}\n                          className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                        >\n                          PDF-Datei auswhlen\n                        </button>\n                        <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                          oder Datei hierher ziehen\n                        </p>\n                        <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                          Max. 10MB\n                        </p>\n                      </div>\n                    ) : (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                        <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                          {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                        </p>\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                            if (fileInputRef.current) {\n                              fileInputRef.current.value = '';\n                            }\n                          }}\n                          className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                        >\n                          Datei entfernen\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* PDF-Vorschau */}\n                {pdfPreviewUrl && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl}#view=FitH`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || (!pdfFile && !useTemplate) || !startDate}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird erstellt...' : 'Erstellen'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default ContractCreationModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon } from '@heroicons/react/24/outline';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport { usePermissions } from '../hooks/usePermissions.ts';\r\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\r\nimport useMessage from '../hooks/useMessage.ts';\r\n\r\ninterface Certificate {\r\n  id: number;\r\n  certificateType: string;\r\n  issueDate: string;\r\n  templateUsed: string | null;\r\n  templateVersion: string | null;\r\n  isLatest: boolean;\r\n}\r\n\r\ninterface CertificateEditModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onCertificateUpdated: () => void;\r\n  userId: number;\r\n  certificate: Certificate;\r\n}\r\n\r\nconst CertificateEditModal: React.FC<CertificateEditModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onCertificateUpdated,\r\n  userId,\r\n  certificate\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { isHR } = usePermissions();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const { showMessage } = useMessage();\r\n  \r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  \r\n  // Form-Daten\r\n  const [issueDate, setIssueDate] = useState(\r\n    certificate.issueDate ? new Date(certificate.issueDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]\r\n  );\r\n  const [certificateType, setCertificateType] = useState(certificate.certificateType || 'employment');\r\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\r\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\r\n  const [existingPdfUrl, setExistingPdfUrl] = useState<string | null>(null);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  // Prfe Berechtigung\r\n  useEffect(() => {\r\n    if (!isHR()) {\r\n      showMessage('Nur HR oder Admin knnen Arbeitszeugnisse bearbeiten', 'error');\r\n      onClose();\r\n    }\r\n  }, [isHR, onClose, showMessage]);\r\n\r\n  // Responsive Erkennung\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  // Sidepane-Status verwalten\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      // Lade bestehende PDF-URL wenn vorhanden\r\n      if (certificate.id) {\r\n        setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certificate.id));\r\n      }\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane, certificate.id, userId]);\r\n\r\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\r\n  useEffect(() => {\r\n    return () => {\r\n      if (pdfPreviewUrl) {\r\n        URL.revokeObjectURL(pdfPreviewUrl);\r\n      }\r\n    };\r\n  }, [pdfPreviewUrl]);\r\n\r\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0];\r\n    if (file) {\r\n      if (file.type !== 'application/pdf') {\r\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\r\n        return;\r\n      }\r\n      if (file.size > 10 * 1024 * 1024) {\r\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\r\n        return;\r\n      }\r\n      setPdfFile(file);\r\n      // Erstelle Preview-URL fr neue Datei\r\n      const url = URL.createObjectURL(file);\r\n      setPdfPreviewUrl(url);\r\n      setExistingPdfUrl(null); // Verstecke bestehende PDF wenn neue hochgeladen wird\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const updateData: any = {\r\n        issueDate: new Date(issueDate),\r\n        certificateType\r\n      };\r\n\r\n      // Nur pdfPath aktualisieren, wenn neue Datei hochgeladen wurde\r\n      if (pdfFile) {\r\n        updateData.pdfPath = `temp-${Date.now()}-${pdfFile.name}`;\r\n        updateData.templateVersion = certificate.templateVersion || '1.0';\r\n      }\r\n\r\n      await axiosInstance.put(\r\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATE(userId, certificate.id),\r\n        updateData\r\n      );\r\n\r\n      showMessage('Arbeitszeugnis erfolgreich aktualisiert', 'success');\r\n      onCertificateUpdated();\r\n      onClose();\r\n      \r\n      // Reset form\r\n      if (pdfPreviewUrl) {\r\n        URL.revokeObjectURL(pdfPreviewUrl);\r\n        setPdfPreviewUrl(null);\r\n      }\r\n      setPdfFile(null);\r\n      if (fileInputRef.current) {\r\n        fileInputRef.current.value = '';\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Aktualisieren des Arbeitszeugnisses:', err);\r\n      setError(err.response?.data?.message || 'Fehler beim Aktualisieren des Arbeitszeugnisses');\r\n      showMessage('Fehler beim Aktualisieren des Arbeitszeugnisses', 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (!isHR()) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      {(!isLargeScreen || isMobile) && (\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n      )}\r\n\r\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\r\n        <Dialog.Panel\r\n          className={`\r\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\r\n            ${isMobile ? '' : 'top-16'}\r\n            bg-white dark:bg-gray-800 shadow-xl\r\n            transform transition-transform duration-350 ease-out\r\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\r\n            flex flex-col\r\n            max-h-[calc(100vh-4rem)]\r\n          `}\r\n        >\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\r\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\r\n                Arbeitszeugnis bearbeiten\r\n              </Dialog.Title>\r\n            </div>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\r\n            >\r\n              <XMarkIcon className=\"h-6 w-6\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Content */}\r\n          <div className=\"flex-1 overflow-y-auto p-6\">\r\n            {error && (\r\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\r\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\r\n              </div>\r\n            )}\r\n\r\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                  Ausstellungsdatum\r\n                </label>\r\n                <input\r\n                  type=\"date\"\r\n                  value={issueDate}\r\n                  onChange={(e) => {\r\n                    const value = e.target.value;\r\n                    setIssueDate(value);\r\n                    // Validierung: Datum darf nicht in der Zukunft liegen\r\n                    if (value && new Date(value) > new Date()) {\r\n                      setError('Ausstellungsdatum darf nicht in der Zukunft liegen');\r\n                    } else {\r\n                      setError(null); // Clear error when valid\r\n                    }\r\n                  }}\r\n                  max={new Date().toISOString().split('T')[0]}\r\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\r\n                    error && issueDate && new Date(issueDate) > new Date()\r\n                      ? 'border-red-500 dark:border-red-500' \r\n                      : 'border-gray-300 dark:border-gray-600'\r\n                  }`}\r\n                  aria-invalid={issueDate && new Date(issueDate) > new Date() ? true : undefined}\r\n                  aria-describedby={issueDate && new Date(issueDate) > new Date() ? \"issueDate-error\" : undefined}\r\n                />\r\n                {error && issueDate && new Date(issueDate) > new Date() && (\r\n                  <p id=\"issueDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\r\n                    {error}\r\n                  </p>\r\n                )}\r\n                {!error && (\r\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                    Das Datum darf nicht in der Zukunft liegen\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                  Zertifikat-Typ\r\n                </label>\r\n                <select\r\n                  value={certificateType}\r\n                  onChange={(e) => setCertificateType(e.target.value)}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\r\n                >\r\n                  <option value=\"employment\">Arbeitszeugnis</option>\r\n                  <option value=\"salary\">Gehaltsbescheinigung</option>\r\n                  <option value=\"work_experience\">Arbeitsbescheinigung</option>\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  PDF-Datei aktualisieren (optional)\r\n                </label>\r\n                <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\r\n                  <input\r\n                    ref={fileInputRef}\r\n                    type=\"file\"\r\n                    accept=\".pdf\"\r\n                    onChange={handleFileSelect}\r\n                    className=\"hidden\"\r\n                  />\r\n                  {!pdfFile ? (\r\n                    <div>\r\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => fileInputRef.current?.click()}\r\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\r\n                      >\r\n                        Neue PDF-Datei auswhlen\r\n                      </button>\r\n                      <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\r\n                        oder Datei hierher ziehen\r\n                      </p>\r\n                      <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\r\n                        Max. 10MB\r\n                      </p>\r\n                    </div>\r\n                  ) : (\r\n                    <div>\r\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\r\n                      <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\r\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\r\n                        {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\r\n                      </p>\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => {\r\n                          setPdfFile(null);\r\n                          if (pdfPreviewUrl) {\r\n                            URL.revokeObjectURL(pdfPreviewUrl);\r\n                            setPdfPreviewUrl(null);\r\n                          }\r\n                          setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certificate.id));\r\n                          if (fileInputRef.current) {\r\n                            fileInputRef.current.value = '';\r\n                          }\r\n                        }}\r\n                        className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\r\n                      >\r\n                        Datei entfernen\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* PDF-Vorschau */}\r\n                {(pdfPreviewUrl || existingPdfUrl) && (\r\n                  <div className=\"mt-4\">\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                      PDF-Vorschau\r\n                    </label>\r\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\r\n                      <iframe \r\n                        src={`${pdfPreviewUrl || existingPdfUrl}${pdfPreviewUrl ? '#view=FitH' : '?preview=true#view=FitH'}`}\r\n                        className=\"w-full rounded border dark:border-gray-600\"\r\n                        style={{ height: '400px' }}\r\n                        title=\"PDF-Vorschau\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4\">\r\n                <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\r\n                  <strong>Hinweis:</strong> Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt.\r\n                  Eine neue Version wird erstellt (isLatest = true).\r\n                </p>\r\n              </div>\r\n            </form>\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={onClose}\r\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n            >\r\n              Abbrechen\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleSubmit}\r\n              disabled={loading}\r\n              className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 dark:bg-blue-500 rounded-md hover:bg-blue-700 dark:hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2\"\r\n            >\r\n              {loading ? (\r\n                <>\r\n                  <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\r\n                  <span>Wird aktualisiert...</span>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <CheckIcon className=\"h-4 w-4\" />\r\n                  <span>Aktualisieren</span>\r\n                </>\r\n              )}\r\n            </button>\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default CertificateEditModal;\r\n\r\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, CurrencyDollarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Contract {\n  id: number;\n  contractType: string;\n  startDate: string;\n  endDate: string | null;\n  salary: number | null;\n  workingHours: number | null;\n  position: string | null;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n}\n\ninterface ContractEditModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onContractUpdated: () => void;\n  userId: number;\n  contract: Contract;\n}\n\nconst ContractEditModal: React.FC<ContractEditModalProps> = ({\n  isOpen,\n  onClose,\n  onContractUpdated,\n  userId,\n  contract\n}) => {\n  const { t } = useTranslation();\n  const { isHR } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [contractType, setContractType] = useState(contract.contractType || 'employment');\n  const [startDate, setStartDate] = useState(\n    contract.startDate ? new Date(contract.startDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]\n  );\n  const [endDate, setEndDate] = useState(\n    contract.endDate ? new Date(contract.endDate).toISOString().split('T')[0] : ''\n  );\n  const [salary, setSalary] = useState(contract.salary ? contract.salary.toString() : '');\n  const [workingHours, setWorkingHours] = useState(contract.workingHours ? contract.workingHours.toString() : '');\n  const [position, setPosition] = useState(contract.position || '');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [existingPdfUrl, setExistingPdfUrl] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung\n  useEffect(() => {\n    if (!isHR()) {\n      showMessage('Nur HR oder Admin knnen Arbeitsvertrge bearbeiten', 'error');\n      onClose();\n    }\n  }, [isHR, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Lade bestehende PDF-URL wenn vorhanden\n      if (contract.id) {\n        setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contract.id));\n      }\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane, contract.id, userId]);\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) {\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      // Erstelle Preview-URL fr neue Datei\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n      setExistingPdfUrl(null); // Verstecke bestehende PDF wenn neue hochgeladen wird\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!startDate) {\n      showMessage('Bitte geben Sie ein Startdatum an', 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const updateData: any = {\n        contractType,\n        startDate: new Date(startDate),\n        endDate: endDate ? new Date(endDate) : null,\n        salary: salary ? parseFloat(salary) : null,\n        workingHours: workingHours ? parseFloat(workingHours) : null,\n        position: position || null\n      };\n\n      // Nur pdfPath aktualisieren, wenn neue Datei hochgeladen wurde\n      if (pdfFile) {\n        updateData.pdfPath = `temp-${Date.now()}-${pdfFile.name}`;\n        updateData.templateVersion = contract.templateVersion || '1.0';\n      }\n\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.CONTRACT(userId, contract.id),\n        updateData\n      );\n\n      showMessage('Arbeitsvertrag erfolgreich aktualisiert', 'success');\n      onContractUpdated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Aktualisieren des Arbeitsvertrags:', err);\n      setError(err.response?.data?.message || 'Fehler beim Aktualisieren des Arbeitsvertrags');\n      showMessage('Fehler beim Aktualisieren des Arbeitsvertrags', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitsvertrag bearbeiten\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Vertragstyp <span className=\"text-red-500\">*</span>\n                </label>\n                <select\n                  value={contractType}\n                  onChange={(e) => setContractType(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                >\n                  <option value=\"employment\">Arbeitsvertrag</option>\n                  <option value=\"amendment\">Vertragsnderung</option>\n                  <option value=\"extension\">Vertragsverlngerung</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Startdatum <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"date\"\n                  value={startDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setStartDate(value);\n                    // Wenn Enddatum gesetzt ist, prfe ob es nach Startdatum liegt\n                    if (endDate && value && new Date(endDate) < new Date(value)) {\n                      setError('Enddatum muss nach dem Startdatum liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && !startDate \n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  required\n                  aria-invalid={!startDate ? true : undefined}\n                  aria-describedby={!startDate ? \"startDate-error\" : undefined}\n                />\n                {error && !startDate && (\n                  <p id=\"startDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Enddatum (optional)\n                </label>\n                <input\n                  type=\"date\"\n                  value={endDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setEndDate(value);\n                    // Wenn Enddatum gesetzt wird, prfe ob es nach Startdatum liegt\n                    if (value && startDate && new Date(value) < new Date(startDate)) {\n                      setError('Enddatum muss nach dem Startdatum liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  min={startDate || undefined}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && endDate && startDate && new Date(endDate) < new Date(startDate)\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  aria-invalid={endDate && startDate && new Date(endDate) < new Date(startDate) ? true : undefined}\n                  aria-describedby={endDate && startDate && new Date(endDate) < new Date(startDate) ? \"endDate-error\" : undefined}\n                />\n                {error && endDate && startDate && new Date(endDate) < new Date(startDate) && (\n                  <p id=\"endDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Position\n                </label>\n                <input\n                  type=\"text\"\n                  value={position}\n                  onChange={(e) => setPosition(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  placeholder=\"z.B. Frontend-Entwickler\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Gehalt (optional)\n                </label>\n                <div className=\"relative\">\n                  <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                  <input\n                    type=\"number\"\n                    value={salary}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setSalary(value);\n                      // Validierung: Gehalt darf nicht negativ sein\n                      if (value && parseFloat(value) < 0) {\n                        setError('Gehalt darf nicht negativ sein');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    className={`w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && salary && parseFloat(salary) < 0\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    placeholder=\"0.00\"\n                    step=\"0.01\"\n                    min=\"0\"\n                    aria-invalid={salary && parseFloat(salary) < 0 ? true : undefined}\n                    aria-describedby={salary && parseFloat(salary) < 0 ? \"salary-error\" : undefined}\n                  />\n                </div>\n                {error && salary && parseFloat(salary) < 0 && (\n                  <p id=\"salary-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Arbeitsstunden/Woche (optional)\n                </label>\n                <input\n                  type=\"number\"\n                  value={workingHours}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setWorkingHours(value);\n                    // Validierung: Arbeitsstunden mssen zwischen 0 und 168 liegen\n                    if (value && (parseFloat(value) < 0 || parseFloat(value) > 168)) {\n                      setError('Arbeitsstunden mssen zwischen 0 und 168 liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  placeholder=\"40\"\n                  step=\"0.1\"\n                  min=\"0\"\n                  max=\"168\"\n                  aria-invalid={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? true : undefined}\n                  aria-describedby={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? \"workingHours-error\" : undefined}\n                />\n                {error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) && (\n                  <p id=\"workingHours-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  Maximal 168 Stunden pro Woche (24h  7 Tage)\n                </p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  PDF-Datei aktualisieren (optional)\n                </label>\n                <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  {!pdfFile ? (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                      <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                      >\n                        Neue PDF-Datei auswhlen\n                      </button>\n                      <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                        oder Datei hierher ziehen\n                      </p>\n                      <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                        Max. 10MB\n                      </p>\n                    </div>\n                  ) : (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                      <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                        {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          setPdfFile(null);\n                          if (pdfPreviewUrl) {\n                            URL.revokeObjectURL(pdfPreviewUrl);\n                            setPdfPreviewUrl(null);\n                          }\n                          setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contract.id));\n                          if (fileInputRef.current) {\n                            fileInputRef.current.value = '';\n                          }\n                        }}\n                        className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                      >\n                        Datei entfernen\n                      </button>\n                    </div>\n                  )}\n                </div>\n\n                {/* PDF-Vorschau */}\n                {(pdfPreviewUrl || existingPdfUrl) && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl || existingPdfUrl}${pdfPreviewUrl ? '#view=FitH' : '?preview=true#view=FitH'}`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4\">\n                <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n                  <strong>Hinweis:</strong> Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt.\n                  Eine neue Version wird erstellt (isLatest = true).\n                </p>\n              </div>\n            </form>\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || !startDate}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird aktualisiert...' : 'Aktualisieren'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default ContractEditModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n  CheckCircleIcon,\n  ClockIcon,\n  XCircleIcon,\n  PencilIcon,\n  EnvelopeIcon,\n  DocumentTextIcon\n} from '@heroicons/react/24/outline';\n// Social Security Editor Component\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface SocialSecurityRegistration {\n  id: number;\n  registrationType: string;\n  registrationNumber: string | null;\n  provider: string | null;\n  registrationDate: string | null;\n  status: string;\n  notes: string | null;\n  completedAt: string | null;\n}\n\ninterface SocialSecurityEditorProps {\n  userId: number;\n  lifecycleId: number;\n  onUpdate?: () => void;\n}\n\ntype SocialSecurityType = 'arl' | 'eps' | 'pension' | 'caja';\n\nconst SocialSecurityEditor: React.FC<SocialSecurityEditorProps> = ({\n  userId,\n  lifecycleId,\n  onUpdate\n}) => {\n  const { t } = useTranslation();\n  const { isLegal, isAdmin } = usePermissions();\n  const { showMessage } = useMessage();\n  \n  const [registrations, setRegistrations] = useState<Record<SocialSecurityType, SocialSecurityRegistration | null>>({\n    arl: null,\n    eps: null,\n    pension: null,\n    caja: null\n  });\n  const [loading, setLoading] = useState(true);\n  const [editingType, setEditingType] = useState<SocialSecurityType | null>(null);\n  const [formData, setFormData] = useState({\n    status: 'pending' as string,\n    registrationNumber: '',\n    provider: '',\n    registrationDate: '',\n    notes: ''\n  });\n  const [saving, setSaving] = useState(false);\n  const loadingRef = useRef(false);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  useEffect(() => {\n    // Prfe Berechtigung und lade nur einmal pro userId/lifecycleId\n    const hasPermission = isLegal() || isAdmin();\n    if (!hasPermission || !userId || !lifecycleId) {\n      setLoading(false);\n      return;\n    }\n\n    // Verhindere mehrfaches gleichzeitiges Laden\n    if (loadingRef.current) {\n      return;\n    }\n\n    // Breche vorherige Requests ab\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n\n    // Erstelle neuen AbortController\n    const abortController = new AbortController();\n    abortControllerRef.current = abortController;\n\n    const loadRegistrations = async () => {\n      loadingRef.current = true;\n      setLoading(true);\n      try {\n        const types: SocialSecurityType[] = ['arl', 'eps', 'pension', 'caja'];\n        const registrationPromises = types.map(async (type) => {\n          // Prfe ob Request abgebrochen wurde\n          if (abortController.signal.aborted) {\n            return { type, registration: null };\n          }\n\n          try {\n            const response = await axiosInstance.get(\n              API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, type),\n              {\n                timeout: 5000, // 5 Sekunden Timeout\n                signal: abortController.signal\n              }\n            );\n            return { type, registration: response.data };\n          } catch (error: any) {\n            // Ignoriere Abort-Errors (AbortError oder CanceledError von Axios)\n            if (error.name === 'AbortError' || error.name === 'CanceledError' || abortController.signal.aborted) {\n              return { type, registration: null };\n            }\n            // Behandle 404 als \"nicht vorhanden\" (normal)\n            if (error.response?.status === 404) {\n              return { type, registration: null };\n            }\n            // Behandle Network Errors und Timeouts\n            if (error.code === 'ERR_NETWORK' || error.code === 'ECONNABORTED' || error.message?.includes('ERR_INSUFFICIENT_RESOURCES')) {\n              console.warn(`Network error loading ${type}, treating as not found`);\n              return { type, registration: null };\n            }\n            console.error(`Error loading ${type}:`, error);\n            return { type, registration: null };\n          }\n        });\n\n        const results = await Promise.all(registrationPromises);\n        \n        // Prfe erneut ob Request abgebrochen wurde\n        if (abortController.signal.aborted) {\n          return;\n        }\n\n        const newRegistrations: Record<SocialSecurityType, SocialSecurityRegistration | null> = {\n          arl: null,\n          eps: null,\n          pension: null,\n          caja: null\n        };\n\n        results.forEach(({ type, registration }) => {\n          if (registration) {\n            newRegistrations[type as SocialSecurityType] = {\n              id: registration.id || 0,\n              registrationType: type,\n              registrationNumber: registration.registrationNumber || null,\n              provider: registration.provider || null,\n              registrationDate: registration.registrationDate || null,\n              status: registration.status || 'pending',\n              notes: registration.notes || null,\n              completedAt: registration.completedAt || null\n            };\n          }\n        });\n\n        setRegistrations(newRegistrations);\n      } catch (error: any) {\n        // Ignoriere Abort-Errors (AbortError oder CanceledError von Axios)\n        if (error.name === 'AbortError' || error.name === 'CanceledError' || abortController.signal.aborted) {\n          return;\n        }\n        console.error('Error loading registrations:', error);\n        showMessage(t('socialSecurity.loadError'), 'error');\n      } finally {\n        // Setze loading immer auf false, auch bei Abbruch\n        setLoading(false);\n        loadingRef.current = false;\n      }\n    };\n\n    loadRegistrations();\n\n    // Cleanup: Breche Request ab wenn Component unmountet oder Dependencies sich ndern\n    return () => {\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n      loadingRef.current = false;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userId, lifecycleId]); // isLegal und isAdmin sind Funktionen, nicht als Dependencies\n\n  const handleEdit = (type: SocialSecurityType) => {\n    const registration = registrations[type];\n    if (registration) {\n      setFormData({\n        status: registration.status,\n        registrationNumber: registration.registrationNumber || '',\n        provider: registration.provider || '',\n        registrationDate: registration.registrationDate \n          ? new Date(registration.registrationDate).toISOString().split('T')[0]\n          : '',\n        notes: registration.notes || ''\n      });\n    } else {\n      setFormData({\n        status: 'pending',\n        registrationNumber: '',\n        provider: '',\n        registrationDate: '',\n        notes: ''\n      });\n    }\n    setEditingType(type);\n  };\n\n  const handleCancel = () => {\n    setEditingType(null);\n    setFormData({\n      status: 'pending',\n      registrationNumber: '',\n      provider: '',\n      registrationDate: '',\n      notes: ''\n    });\n  };\n\n  const handleSave = async () => {\n    if (!editingType) return;\n\n    setSaving(true);\n    try {\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, editingType),\n        {\n          status: formData.status,\n          number: formData.registrationNumber || undefined,\n          provider: formData.provider || undefined,\n          registrationDate: formData.registrationDate \n            ? new Date(formData.registrationDate).toISOString()\n            : undefined,\n          notes: formData.notes || undefined\n        }\n      );\n\n      showMessage('Sozialversicherung erfolgreich aktualisiert', 'success');\n      setEditingType(null);\n      // Lade Registrierungen neu nach Update\n      await loadRegistrations();\n      // onUpdate nur aufrufen, wenn es eine Funktion ist (verhindert Re-Render-Loops)\n      if (onUpdate && typeof onUpdate === 'function') {\n        onUpdate();\n      }\n    } catch (error: any) {\n      console.error('Error updating social security:', error);\n      showMessage(\n        error.response?.data?.message || t('socialSecurity.updateError'),\n        'error'\n      );\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'registered':\n        return <CheckCircleIcon className=\"h-5 w-5 text-green-500\" />;\n      case 'pending':\n        return <ClockIcon className=\"h-5 w-5 text-yellow-500\" />;\n      case 'failed':\n        return <XCircleIcon className=\"h-5 w-5 text-red-500\" />;\n      case 'not_required':\n        return <CheckCircleIcon className=\"h-5 w-5 text-gray-400\" />;\n      case 'deregistered':\n        return <XCircleIcon className=\"h-5 w-5 text-gray-400\" />;\n      default:\n        return <ClockIcon className=\"h-5 w-5 text-gray-400\" />;\n    }\n  };\n\n  const getStatusLabel = (status: string) => {\n    const labelKey = `lifecycle.socialSecurityStatus.${status}`;\n    return t(labelKey) || status;\n  };\n\n  const getTypeLabel = (type: SocialSecurityType) => {\n    const labels: Record<SocialSecurityType, string> = {\n      arl: 'ARL (Risiko-Arbeit)',\n      eps: 'EPS (Gesundheit)',\n      pension: 'Pension',\n      caja: 'Caja de Compensacin'\n    };\n    return labels[type];\n  };\n\n  if (!isLegal() && !isAdmin()) {\n    return null;\n  }\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  const types: SocialSecurityType[] = ['arl', 'eps', 'pension', 'caja'];\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n          <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n          {t('lifecycle.socialSecurity', { defaultValue: 'Sozialversicherungen' })}\n        </h3>\n      </div>\n\n      <div className=\"space-y-4\">\n        {types.map((type) => {\n          const registration = registrations[type];\n          const isEditing = editingType === type;\n\n          return (\n            <div\n              key={type}\n              className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\"\n            >\n              {!isEditing ? (\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex items-start space-x-3 flex-1\">\n                    {getStatusIcon(registration?.status || 'pending')}\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center space-x-2 mb-2\">\n                        <h4 className=\"font-medium dark:text-white uppercase\">\n                          {getTypeLabel(type)}\n                        </h4>\n                        <span className=\"text-sm font-medium dark:text-white\">\n                          {getStatusLabel(registration?.status || 'pending')}\n                        </span>\n                      </div>\n                      {registration && (\n                        <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                          {registration.provider && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.provider')}:</span> {registration.provider}\n                            </div>\n                          )}\n                          {registration.registrationNumber && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.number')}:</span> {registration.registrationNumber}\n                            </div>\n                          )}\n                          {registration.registrationDate && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.registrationDate')}:</span>{' '}\n                              {new Date(registration.registrationDate).toLocaleDateString('de-DE')}\n                            </div>\n                          )}\n                          {registration.notes && (\n                            <div className=\"mt-2\">\n                              <span className=\"font-medium\">{t('socialSecurity.notes')}:</span>\n                              <p className=\"text-gray-500 dark:text-gray-400 mt-1\">\n                                {registration.notes}\n                              </p>\n                            </div>\n                          )}\n                          {registration.completedAt && (\n                            <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\n                              {t('socialSecurity.completedAt')}{' '}\n                              {new Date(registration.completedAt).toLocaleDateString('de-DE')}\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      {!registration && (\n                        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                          {t('socialSecurity.notRegistered')}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                  <button\n                    onClick={() => handleEdit(type)}\n                    className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition ml-4\"\n                    title={t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  >\n                    <PencilIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium dark:text-white uppercase mb-3\">\n                    {t('socialSecurity.editType', { type: getTypeLabel(type) })}\n                  </h4>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('socialSecurity.status')} <span className=\"text-red-500\">*</span>\n                    </label>\n                    <select\n                      value={formData.status}\n                      onChange={(e) => setFormData({ ...formData, status: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    >\n                      <option value=\"not_required\">Nicht erforderlich</option>\n                      <option value=\"pending\">Ausstehend</option>\n                      <option value=\"registered\">Registriert</option>\n                      <option value=\"failed\">Fehlgeschlagen</option>\n                      <option value=\"deregistered\">Abgemeldet</option>\n                    </select>\n                  </div>\n\n                  {formData.status === 'registered' && (\n                    <>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.registrationNumber')}\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={formData.registrationNumber}\n                          onChange={(e) => setFormData({ ...formData, registrationNumber: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                          placeholder=\"z.B. 123456789\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.provider')}\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={formData.provider}\n                          onChange={(e) => setFormData({ ...formData, provider: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                          placeholder=\"z.B. ARL Sura, EPS Sanitas\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.registrationDate')}\n                        </label>\n                        <input\n                          type=\"date\"\n                          value={formData.registrationDate}\n                          onChange={(e) => setFormData({ ...formData, registrationDate: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                        />\n                      </div>\n                    </>\n                  )}\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('socialSecurity.notes')}\n                    </label>\n                    <textarea\n                      value={formData.notes}\n                      onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      rows={3}\n                      placeholder={t('socialSecurity.additionalInfo')}\n                    />\n                  </div>\n\n                  <div className=\"flex items-center justify-end space-x-3\">\n                    <button\n                      onClick={handleCancel}\n                      disabled={saving}\n                      className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50\"\n                    >\n                      {t('common.cancel')}\n                    </button>\n                    <button\n                      onClick={handleSave}\n                      disabled={saving}\n                      className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 dark:bg-blue-500 rounded-md hover:bg-blue-700 dark:hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2\"\n                    >\n                      {saving ? (\n                        <>\n                          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\n                          <span>{t('common.saving')}</span>\n                        </>\n                      ) : (\n                        <>\n                          <CheckCircleIcon className=\"h-4 w-4\" />\n                          <span>{t('common.save')}</span>\n                        </>\n                      )}\n                    </button>\n                  </div>\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default SocialSecurityEditor;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ExclamationTriangleIcon, CalendarIcon, ArrowPathIcon, ArrowRightIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface OffboardingStartModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onOffboardingStarted: () => void;\n  userId: number;\n  userName: string;\n}\n\nconst OffboardingStartModal: React.FC<OffboardingStartModalProps> = ({\n  isOpen,\n  onClose,\n  onOffboardingStarted,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [exitDate, setExitDate] = useState('');\n  const [exitReason, setExitReason] = useState('');\n  \n  // Validierung\n  const [validationErrors, setValidationErrors] = useState<{\n    exitDate?: string;\n    exitReason?: string;\n  }>({});\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Setze Standard-Datum auf heute\n      const today = new Date().toISOString().split('T')[0];\n      setExitDate(today);\n      setExitReason('');\n      setError(null);\n      setValidationErrors({});\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = (): boolean => {\n    const errors: { exitDate?: string; exitReason?: string } = {};\n\n    // Validierung: exitDate\n    if (!exitDate) {\n      errors.exitDate = t('lifecycle.offboarding.exitDateRequired', { defaultValue: 'Austrittsdatum ist erforderlich' });\n    } else {\n      const selectedDate = new Date(exitDate);\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      \n      // exitDate darf in der Vergangenheit liegen (rckwirkende Erfassung erlaubt)\n      // Aber nicht zu weit in der Zukunft (max. 1 Jahr)\n      const maxDate = new Date();\n      maxDate.setFullYear(maxDate.getFullYear() + 1);\n      \n      if (selectedDate > maxDate) {\n        errors.exitDate = t('lifecycle.offboarding.exitDateTooFar', { defaultValue: 'Austrittsdatum darf nicht mehr als 1 Jahr in der Zukunft liegen' });\n      }\n    }\n\n    // Validierung: exitReason\n    if (!exitReason || exitReason.trim().length === 0) {\n      errors.exitReason = t('lifecycle.offboarding.exitReasonRequired', { defaultValue: 'Austrittsgrund ist erforderlich' });\n    } else if (exitReason.trim().length < 10) {\n      errors.exitReason = t('lifecycle.offboarding.exitReasonTooShort', { defaultValue: 'Austrittsgrund muss mindestens 10 Zeichen lang sein' });\n    }\n\n    setValidationErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\n        status: 'offboarding',\n        exitDate: exitDate,\n        exitReason: exitReason.trim()\n      });\n\n      showMessage(\n        t('lifecycle.offboarding.started', { defaultValue: 'Offboarding erfolgreich gestartet' }),\n        'success'\n      );\n      \n      onOffboardingStarted();\n      onClose();\n    } catch (err: any) {\n      console.error('Fehler beim Starten des Offboarding:', err);\n      const errorMessage = err.response?.data?.message || \n        t('lifecycle.offboarding.startError', { defaultValue: 'Fehler beim Starten des Offboarding' });\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const renderForm = () => (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      {/* Warnung */}\n      <div className=\"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4\">\n        <div className=\"flex items-start\">\n          <ExclamationTriangleIcon className=\"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5 mr-3 flex-shrink-0\" />\n          <div className=\"text-sm text-orange-800 dark:text-orange-200\">\n            <p className=\"font-medium mb-1\">\n              {t('lifecycle.offboarding.warningTitle', { defaultValue: 'Wichtiger Hinweis' })}\n            </p>\n            <p>\n              {t('lifecycle.offboarding.warningText', { defaultValue: 'Durch das Starten des Offboarding-Prozesses werden automatisch Tasks erstellt. Dieser Vorgang kann nicht rckgngig gemacht werden.' })}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* User-Info */}\n      <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">\n          {t('lifecycle.offboarding.user', { defaultValue: 'Mitarbeiter' })}\n        </p>\n        <p className=\"font-medium dark:text-white\">{userName}</p>\n      </div>\n\n      {/* exitDate */}\n      <div>\n        <label htmlFor=\"exitDate\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {t('lifecycle.offboarding.exitDate', { defaultValue: 'Austrittsdatum' })} *\n        </label>\n        <div className=\"relative\">\n          <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n            <CalendarIcon className=\"h-5 w-5 text-gray-400\" />\n          </div>\n          <input\n            type=\"date\"\n            id=\"exitDate\"\n            value={exitDate}\n            onChange={(e) => {\n              setExitDate(e.target.value);\n              if (validationErrors.exitDate) {\n                setValidationErrors(prev => ({ ...prev, exitDate: undefined }));\n              }\n            }}\n            className={`block w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n              validationErrors.exitDate\n                ? 'border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500'\n                : 'border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500'\n            }`}\n            required\n          />\n        </div>\n        {validationErrors.exitDate && (\n          <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{validationErrors.exitDate}</p>\n        )}\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n          {t('lifecycle.offboarding.exitDateHint', { defaultValue: 'Das Datum, an dem der Mitarbeiter die Organisation verlsst' })}\n        </p>\n      </div>\n\n      {/* exitReason */}\n      <div>\n        <label htmlFor=\"exitReason\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {t('lifecycle.offboarding.exitReason', { defaultValue: 'Austrittsgrund' })} *\n        </label>\n        <textarea\n          id=\"exitReason\"\n          value={exitReason}\n          onChange={(e) => {\n            setExitReason(e.target.value);\n            if (validationErrors.exitReason) {\n              setValidationErrors(prev => ({ ...prev, exitReason: undefined }));\n            }\n          }}\n          rows={4}\n          className={`block w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n            validationErrors.exitReason\n              ? 'border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500'\n              : 'border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500'\n          }`}\n          placeholder={t('lifecycle.offboarding.exitReasonPlaceholder', { defaultValue: 'z.B. Kndigung, Vertragsende, etc.' })}\n          required\n        />\n        {validationErrors.exitReason && (\n          <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{validationErrors.exitReason}</p>\n        )}\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n          {t('lifecycle.offboarding.exitReasonHint', { defaultValue: 'Mindestens 10 Zeichen. Beschreiben Sie den Grund fr den Austritt.' })}\n        </p>\n      </div>\n\n      {/* Error-Message */}\n      {error && (\n        <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n          <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n        </div>\n      )}\n\n      {/* Buttons */}\n      <div className=\"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n        <button\n          type=\"button\"\n          onClick={onClose}\n          disabled={loading}\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\n          title={t('common.cancel', { defaultValue: 'Abbrechen' })}\n        >\n          <XMarkIcon className=\"h-5 w-5\" />\n        </button>\n        <button\n          type=\"submit\"\n          disabled={loading}\n          className=\"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n          title={loading ? t('common.saving', { defaultValue: 'Speichern...' }) : t('lifecycle.offboarding.startButton', { defaultValue: 'Offboarding starten' })}\n        >\n          {loading ? (\n            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n          ) : (\n            <ArrowRightIcon className=\"h-5 w-5\" />\n          )}\n        </button>\n      </div>\n    </form>\n  );\n\n  if (!isOpen) return null;\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('lifecycle.offboarding.startTitle', { defaultValue: 'Offboarding starten' })}\n              </Dialog.Title>\n              <button\n                onClick={onClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <div className=\"p-4\">\n              {renderForm()}\n            </div>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={onClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('lifecycle.offboarding.startTitle', { defaultValue: 'Offboarding starten' })}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {renderForm()}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default OffboardingStartModal;\n\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, ExclamationTriangleIcon, CheckCircleIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\r\nimport useMessage from '../hooks/useMessage.ts';\r\n\r\ninterface Task {\r\n  id: number;\r\n  title: string;\r\n  description: string | null;\r\n  status: string;\r\n  dueDate: string | null;\r\n  createdAt: string;\r\n}\r\n\r\ninterface OffboardingCompleteModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onOffboardingCompleted: () => void;\r\n  userId: number;\r\n  userName: string;\r\n  offboardingTasks: Task[];\r\n}\r\n\r\nconst OffboardingCompleteModal: React.FC<OffboardingCompleteModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onOffboardingCompleted,\r\n  userId,\r\n  userName,\r\n  offboardingTasks\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const { showMessage } = useMessage();\r\n  \r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [confirmText, setConfirmText] = useState('');\r\n  \r\n  // Prfe, ob alle Tasks abgeschlossen sind\r\n  const completedTasks = offboardingTasks.filter(task => task.status === 'done');\r\n  const allTasksCompleted = offboardingTasks.length > 0 && completedTasks.length === offboardingTasks.length;\r\n  const requiredConfirmText = userName.trim().toLowerCase();\r\n  \r\n  // Responsive Erkennung\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n  \r\n  // Sidepane-Status verwalten\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      // Reset form on open\r\n      setConfirmText('');\r\n      setError(null);\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane]);\r\n  \r\n  const validateForm = () => {\r\n    if (confirmText.trim().toLowerCase() !== requiredConfirmText) {\r\n      setError(t('lifecycle.offboarding.complete.confirmTextMismatch', { defaultValue: 'Besttigungstext stimmt nicht berein' }));\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  \r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\r\n        status: 'archived'\r\n      });\r\n      \r\n      showMessage(\r\n        t('lifecycle.offboarding.complete.success', { defaultValue: 'Offboarding erfolgreich abgeschlossen' }),\r\n        'success'\r\n      );\r\n      \r\n      onOffboardingCompleted();\r\n      onClose();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Abschlieen des Offboarding:', err);\r\n      const errorMessage = err.response?.data?.message || \r\n        t('lifecycle.offboarding.complete.error', { defaultValue: 'Fehler beim Abschlieen des Offboarding' });\r\n      setError(errorMessage);\r\n      showMessage(errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  const renderForm = () => (\r\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n      {/* User Info */}\r\n      <div className=\"bg-gray-50 dark:bg-gray-700 p-3 rounded-md flex items-center space-x-3\">\r\n        <CheckCircleIcon className=\"h-5 w-5 text-gray-500 dark:text-gray-400\" />\r\n        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n          {t('lifecycle.offboarding.complete.user', { defaultValue: 'Mitarbeiter' })}: {userName}\r\n        </span>\r\n      </div>\r\n      \r\n      {/* Tasks Status */}\r\n      {offboardingTasks.length > 0 && (\r\n        <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-md\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n            {t('lifecycle.offboarding.complete.tasksStatus', { defaultValue: 'Status der Offboarding-Aufgaben' })}\r\n          </h4>\r\n          <div className=\"space-y-2\">\r\n            {offboardingTasks.map((task) => {\r\n                  const isCompleted = task.status === 'done';\r\n              return (\r\n                <div\r\n                  key={task.id}\r\n                  className={`flex items-center space-x-2 text-sm ${\r\n                    isCompleted\r\n                      ? 'text-green-700 dark:text-green-300'\r\n                      : 'text-orange-700 dark:text-orange-300'\r\n                  }`}\r\n                >\r\n                  {isCompleted ? (\r\n                    <CheckCircleIcon className=\"h-4 w-4 flex-shrink-0\" />\r\n                  ) : (\r\n                    <ExclamationTriangleIcon className=\"h-4 w-4 flex-shrink-0\" />\r\n                  )}\r\n                  <span>{task.title}</span>\r\n                  <span className=\"ml-auto text-xs\">\r\n                    {isCompleted\r\n                      ? `(${t('common.done', { defaultValue: 'Abgeschlossen' })})`\r\n                      : `(${t('common.open', { defaultValue: 'Offen' })})`}\r\n                  </span>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Warning wenn nicht alle Tasks abgeschlossen */}\r\n      {!allTasksCompleted && offboardingTasks.length > 0 && (\r\n        <div className=\"bg-orange-50 dark:bg-orange-900/20 border-l-4 border-orange-400 p-4\">\r\n          <div className=\"flex\">\r\n            <div className=\"flex-shrink-0\">\r\n              <ExclamationTriangleIcon className=\"h-5 w-5 text-orange-400\" aria-hidden=\"true\" />\r\n            </div>\r\n            <div className=\"ml-3\">\r\n              <h3 className=\"text-sm font-medium text-orange-800 dark:text-orange-300\">\r\n                {t('lifecycle.offboarding.complete.warningTitle', { defaultValue: 'Nicht alle Aufgaben abgeschlossen' })}\r\n              </h3>\r\n              <div className=\"mt-2 text-sm text-orange-700 dark:text-orange-200\">\r\n                <p>\r\n                  {t('lifecycle.offboarding.complete.warningText', { \r\n                    defaultValue: 'Es sind noch nicht alle Offboarding-Aufgaben abgeschlossen. Sie knnen das Offboarding trotzdem abschlieen, aber es wird empfohlen, alle Aufgaben zuerst zu erledigen.'\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Info wenn alle Tasks abgeschlossen */}\r\n      {allTasksCompleted && (\r\n        <div className=\"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-400 p-4\">\r\n          <div className=\"flex\">\r\n            <div className=\"flex-shrink-0\">\r\n              <CheckCircleIcon className=\"h-5 w-5 text-green-400\" aria-hidden=\"true\" />\r\n            </div>\r\n            <div className=\"ml-3\">\r\n              <h3 className=\"text-sm font-medium text-green-800 dark:text-green-300\">\r\n                {t('lifecycle.offboarding.complete.allTasksCompleted', { defaultValue: 'Alle Aufgaben abgeschlossen' })}\r\n              </h3>\r\n              <div className=\"mt-2 text-sm text-green-700 dark:text-green-200\">\r\n                <p>\r\n                  {t('lifecycle.offboarding.complete.allTasksCompletedText', { \r\n                    defaultValue: 'Alle Offboarding-Aufgaben sind abgeschlossen. Sie knnen das Offboarding jetzt abschlieen.'\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Confirm Text Input */}\r\n      <div>\r\n        <label htmlFor=\"confirmText\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('lifecycle.offboarding.complete.confirmLabel', { userName }) || \r\n            `Besttigen Sie durch Eingabe des Namens: \"${userName}\"`} *\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"confirmText\"\r\n          value={confirmText}\r\n          onChange={(e) => {\r\n            setConfirmText(e.target.value);\r\n            setError(null);\r\n          }}\r\n          className={`w-full px-3 py-2 border ${\r\n            error && error.includes('Besttigung') ? 'border-red-500' : 'border-gray-300'\r\n          } dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500`}\r\n          placeholder={userName}\r\n          required\r\n        />\r\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n          {t('lifecycle.offboarding.complete.confirmHint', { \r\n            defaultValue: 'Geben Sie den vollstndigen Namen des Mitarbeiters ein, um das Offboarding abzuschlieen'\r\n          })}\r\n        </p>\r\n      </div>\r\n      \r\n      {/* Final Warning */}\r\n      <div className=\"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\r\n        <div className=\"flex\">\r\n          <div className=\"flex-shrink-0\">\r\n            <ExclamationTriangleIcon className=\"h-5 w-5 text-red-400\" aria-hidden=\"true\" />\r\n          </div>\r\n          <div className=\"ml-3\">\r\n            <h3 className=\"text-sm font-medium text-red-800 dark:text-red-300\">\r\n              {t('lifecycle.offboarding.complete.finalWarningTitle', { defaultValue: 'Wichtiger Hinweis' })}\r\n            </h3>\r\n            <div className=\"mt-2 text-sm text-red-700 dark:text-red-200\">\r\n              <p>\r\n                {t('lifecycle.offboarding.complete.finalWarningText', { \r\n                  defaultValue: 'Durch das Abschlieen des Offboarding wird der Mitarbeiter archiviert. Dieser Vorgang kann nicht rckgngig gemacht werden.'\r\n                })}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Submit Button */}\r\n      <div className=\"flex justify-end space-x-3\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={onClose}\r\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          disabled={loading}\r\n          title={t('common.cancel', { defaultValue: 'Abbrechen' })}\r\n        >\r\n          <XMarkIcon className=\"h-5 w-5\" />\r\n        </button>\r\n        <button\r\n          type=\"submit\"\r\n          className=\"p-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          disabled={loading || confirmText.trim().toLowerCase() !== requiredConfirmText}\r\n          title={loading ? t('common.saving', { defaultValue: 'Speichern...' }) : t('lifecycle.offboarding.complete.button', { defaultValue: 'Offboarding abschlieen' })}\r\n        >\r\n          {loading ? (\r\n            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n          ) : (\r\n            <CheckCircleIcon className=\"h-5 w-5\" />\r\n          )}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n  \r\n  if (!isOpen) return null;\r\n  \r\n  // Fr Mobile (unter 640px) - klassisches Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n            {/* Header */}\r\n            <div className=\"px-6 py-4 border-b dark:border-gray-700\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                  {t('lifecycle.offboarding.complete.title', { defaultValue: 'Offboarding abschlieen' })}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Form */}\r\n            <div className=\"p-6\">\r\n              {error && (\r\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\r\n                  {error}\r\n                </div>\r\n              )}\r\n              {renderForm()}\r\n            </div>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n  \r\n  // Fr Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div\r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\"\r\n          aria-hidden=\"true\"\r\n          onClick={onClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div\r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${\r\n          isOpen ? 'translate-x-0' : 'translate-x-full'\r\n        }`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('lifecycle.offboarding.complete.title', { defaultValue: 'Offboarding abschlieen' })}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n        \r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {error && (\r\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\r\n              {error}\r\n            </div>\r\n          )}\r\n          {renderForm()}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default OffboardingCompleteModal;\r\n\r\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { \n  CheckCircleIcon, \n  ClockIcon, \n  XCircleIcon,\n  DocumentTextIcon,\n  BuildingOfficeIcon,\n  PlusIcon,\n  PencilIcon,\n  ArrowDownTrayIcon,\n  CalendarIcon,\n  UserIcon,\n  ArrowRightIcon\n} from '@heroicons/react/24/outline';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport useMessage from '../hooks/useMessage.ts';\nimport CertificateCreationModal from './CertificateCreationModal.tsx';\nimport ContractCreationModal from './ContractCreationModal.tsx';\nimport CertificateEditModal from './CertificateEditModal.tsx';\nimport ContractEditModal from './ContractEditModal.tsx';\nimport SocialSecurityEditor from './SocialSecurityEditor.tsx';\nimport OffboardingStartModal from './OffboardingStartModal.tsx';\nimport OffboardingCompleteModal from './OffboardingCompleteModal.tsx';\n\ninterface LifecycleViewProps {\n  userId: number;\n  userName: string;\n}\n\ninterface LifecycleData {\n  lifecycle: {\n    id: number;\n    status: string;\n    onboardingStartedAt: string | null;\n    onboardingCompletedAt: string | null;\n    contractStartDate: string | null;\n    contractEndDate: string | null;\n    exitDate: string | null;\n    exitReason: string | null;\n    offboardingStartedAt: string | null;\n    offboardingCompletedAt: string | null;\n  };\n  progress: {\n    completed: number;\n    total: number;\n    percent: number;\n  };\n  socialSecurityRegistrations?: Array<{\n    id: number;\n    registrationType: string;\n    status: string;\n    registrationNumber: string | null;\n    provider: string | null;\n    registrationDate: string | null;\n  }>;\n}\n\ninterface Task {\n  id: number;\n  title: string;\n  description: string | null;\n  status: string;\n  dueDate: string | null;\n  createdAt: string;\n}\n\ninterface Certificate {\n  id: number;\n  certificateType: string;\n  issueDate: string;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n  generatedBy: number | null;\n  generatedByUser: {\n    id: number;\n    firstName: string;\n    lastName: string;\n  } | null;\n  createdAt: string;\n}\n\ninterface Contract {\n  id: number;\n  contractType: string;\n  startDate: string;\n  endDate: string | null;\n  salary: number | null;\n  workingHours: number | null;\n  position: string | null;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n  generatedBy: number | null;\n  generatedByUser: {\n    id: number;\n    firstName: string;\n    lastName: string;\n  } | null;\n  createdAt: string;\n}\n\nconst LifecycleView: React.FC<LifecycleViewProps> = ({ userId, userName }) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin } = usePermissions();\n  const { showMessage } = useMessage();\n  \n  const [lifecycleData, setLifecycleData] = useState<LifecycleData | null>(null);\n  const [certificates, setCertificates] = useState<Certificate[]>([]);\n  const [contracts, setContracts] = useState<Contract[]>([]);\n  const [offboardingTasks, setOffboardingTasks] = useState<Task[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Modal States\n  const [isCertificateCreateModalOpen, setIsCertificateCreateModalOpen] = useState(false);\n  const [isContractCreateModalOpen, setIsContractCreateModalOpen] = useState(false);\n  const [editingCertificate, setEditingCertificate] = useState<Certificate | null>(null);\n  const [editingContract, setEditingContract] = useState<Contract | null>(null);\n  \n  const [downloadingCertId, setDownloadingCertId] = useState<number | null>(null);\n  const [downloadingContractId, setDownloadingContractId] = useState<number | null>(null);\n  const [isOffboardingStartModalOpen, setIsOffboardingStartModalOpen] = useState(false);\n  const [isOffboardingCompleteModalOpen, setIsOffboardingCompleteModalOpen] = useState(false);\n  const [isEditContractDatesModalOpen, setIsEditContractDatesModalOpen] = useState(false);\n  const [editingContractStartDate, setEditingContractStartDate] = useState<string>('');\n  const [editingContractEndDate, setEditingContractEndDate] = useState<string>('');\n\n  const fetchDataRef = useRef(false);\n\n  const fetchData = useCallback(async () => {\n    // Verhindere mehrfaches gleichzeitiges Laden\n    if (fetchDataRef.current) {\n      return;\n    }\n    \n    try {\n      fetchDataRef.current = true;\n      setLoading(true);\n      const [lifecycleResponse, certsResponse, contractsResponse, tasksResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.CERTIFICATES(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.CONTRACTS(userId)),\n        axiosInstance.get(API_ENDPOINTS.TASKS.BY_USER(userId)).catch(() => ({ data: [] })) // Optional, falls fehlschlgt\n      ]);\n      \n      setLifecycleData(lifecycleResponse.data);\n      setCertificates(certsResponse.data?.certificates || []);\n      setContracts(contractsResponse.data?.contracts || []);\n      \n      // Filtere Offboarding-Tasks (die 3 spezifischen Tasks)\n      const allTasks = tasksResponse.data || [];\n      const offboardingTaskTitles = [\n        'Crear certificado laboral',\n        'Realizar liquidacin final',\n        'Desafiliar de seguridad social'\n      ];\n      const filteredTasks = allTasks.filter((task: Task) => \n        offboardingTaskTitles.includes(task.title)\n      );\n      setOffboardingTasks(filteredTasks);\n      \n      setError(null);\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Lebenszyklus-Daten:', err);\n      setError(err.response?.data?.message || 'Fehler beim Laden der Daten');\n      showMessage('Fehler beim Laden der Daten', 'error');\n    } finally {\n      setLoading(false);\n      fetchDataRef.current = false;\n    }\n  }, [userId]); // showMessage entfernt, da es sich ndern kann\n\n  useEffect(() => {\n    fetchDataRef.current = false; // Reset beim userId-Wechsel\n    fetchData();\n  }, [fetchData]);\n\n  const handleDownloadCertificate = async (certId: number) => {\n    setDownloadingCertId(certId);\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certId),\n        { responseType: 'blob' }\n      );\n      \n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = `arbeitszeugnis-${certId}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadUrl);\n      \n      showMessage('Arbeitszeugnis erfolgreich heruntergeladen', 'success');\n    } catch (err: any) {\n      console.error('Fehler beim Herunterladen:', err);\n      showMessage('Fehler beim Herunterladen des Arbeitszeugnisses', 'error');\n    } finally {\n      setDownloadingCertId(null);\n    }\n  };\n\n  const handleEditContractDates = () => {\n    if (!lifecycleData?.lifecycle) return;\n    \n    setEditingContractStartDate(\n      lifecycleData.lifecycle.contractStartDate \n        ? new Date(lifecycleData.lifecycle.contractStartDate).toISOString().split('T')[0]\n        : ''\n    );\n    setEditingContractEndDate(\n      lifecycleData.lifecycle.contractEndDate \n        ? new Date(lifecycleData.lifecycle.contractEndDate).toISOString().split('T')[0]\n        : ''\n    );\n    setIsEditContractDatesModalOpen(true);\n  };\n\n  const handleSaveContractDates = async () => {\n    try {\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\n        status: lifecycleData?.lifecycle.status || 'active',\n        contractStartDate: editingContractStartDate || null,\n        contractEndDate: editingContractEndDate || null\n      });\n      \n      showMessage('Vertragsdaten erfolgreich aktualisiert', 'success');\n      setIsEditContractDatesModalOpen(false);\n      fetchData();\n    } catch (err: any) {\n      console.error('Fehler beim Speichern der Vertragsdaten:', err);\n      showMessage('Fehler beim Speichern der Vertragsdaten', 'error');\n    }\n  };\n\n  const handleDownloadContract = async (contractId: number) => {\n    setDownloadingContractId(contractId);\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contractId),\n        { responseType: 'blob' }\n      );\n      \n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = `arbeitsvertrag-${contractId}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadUrl);\n      \n      showMessage('Arbeitsvertrag erfolgreich heruntergeladen', 'success');\n    } catch (err: any) {\n      console.error('Fehler beim Herunterladen:', err);\n      showMessage('Fehler beim Herunterladen des Arbeitsvertrags', 'error');\n    } finally {\n      setDownloadingContractId(null);\n    }\n  };\n\n  const getStatusBadge = (status: string) => {\n    const statusConfig: Record<string, { color: string; labelKey: string }> = {\n      onboarding: { color: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300', labelKey: 'lifecycle.status.onboarding' },\n      active: { color: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300', labelKey: 'lifecycle.status.active' },\n      contract_change: { color: 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300', labelKey: 'lifecycle.status.contract_change' },\n      offboarding: { color: 'bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300', labelKey: 'lifecycle.status.offboarding' },\n      archived: { color: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300', labelKey: 'lifecycle.status.archived' }\n    };\n\n    const config = statusConfig[status] || { color: 'bg-gray-100 text-gray-800', labelKey: status };\n    \n    return (\n      <span className={`px-3 py-1 rounded-full text-sm font-medium ${config.color}`}>\n        {t(config.labelKey) || status}\n      </span>\n    );\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('de-DE', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n          <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!lifecycleData) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <p className=\"text-gray-500 dark:text-gray-400\">{t('lifecycle.noData', { defaultValue: 'Keine Lebenszyklus-Daten verfgbar' })}</p>\n      </div>\n    );\n  }\n\n  const { lifecycle, progress, socialSecurityRegistrations = [] } = lifecycleData;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Status-Box */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <BuildingOfficeIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.statusTitle')}\n          </h3>\n          <div className=\"flex items-center space-x-3\">\n          {getStatusBadge(lifecycle.status)}\n            {/* Offboarding-Start-Button (nur fr HR/Admin, nur wenn Status = \"active\") */}\n            {(isHR() || isAdmin()) && lifecycle.status === 'active' && (\n              <button\n                onClick={() => setIsOffboardingStartModalOpen(true)}\n                className=\"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500\"\n                title={t('lifecycle.offboarding.startButton', { defaultValue: 'Offboarding starten' })}\n              >\n                <ArrowRightIcon className=\"h-5 w-5\" />\n              </button>\n            )}\n            {/* Offboarding-Abschluss-Button (nur fr HR/Admin, nur wenn Status = \"offboarding\") */}\n            {(isHR() || isAdmin()) && lifecycle.status === 'offboarding' && (\n              <button\n                onClick={() => setIsOffboardingCompleteModalOpen(true)}\n                className=\"p-2 bg-red-600 dark:bg-red-700 text-white rounded-md hover:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n                title={t('lifecycle.offboarding.complete.button', { defaultValue: 'Offboarding abschlieen' })}\n              >\n                <CheckCircleIcon className=\"h-5 w-5\" />\n              </button>\n            )}\n          </div>\n        </div>\n\n        <div className=\"space-y-2 text-sm\">\n          {lifecycle.onboardingStartedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.onboardingStarted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.onboardingStartedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.onboardingCompletedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.onboardingCompleted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.onboardingCompletedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.contractStart')}</span>\n            <div className=\"flex items-center space-x-2\">\n              {lifecycle.contractStartDate ? (\n                <span className=\"dark:text-white\">\n                  {new Date(lifecycle.contractStartDate).toLocaleDateString('de-DE')}\n                </span>\n              ) : (\n                <span className=\"text-gray-400 italic text-sm\">{t('lifecycle.notSet', { defaultValue: 'Nicht gesetzt' })}</span>\n              )}\n              {(isHR() || isAdmin()) && (\n                <button\n                  onClick={() => handleEditContractDates()}\n                  className=\"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition\"\n                  title={t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                >\n                  <PencilIcon className=\"h-4 w-4\" />\n                </button>\n              )}\n            </div>\n          </div>\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.contractEnd')}</span>\n            <div className=\"flex items-center space-x-2\">\n              {lifecycle.contractEndDate ? (\n                <span className=\"dark:text-white\">\n                  {new Date(lifecycle.contractEndDate).toLocaleDateString('de-DE')}\n                </span>\n              ) : (\n                <span className=\"text-gray-400 italic text-sm\">{t('lifecycle.notSet', { defaultValue: 'Nicht gesetzt' })}</span>\n              )}\n              {(isHR() || isAdmin()) && (\n                <button\n                  onClick={() => handleEditContractDates()}\n                  className=\"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition\"\n                  title={t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                >\n                  <PencilIcon className=\"h-4 w-4\" />\n                </button>\n              )}\n            </div>\n          </div>\n          {lifecycle.offboardingStartedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.offboardingStarted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.offboardingStartedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.exitDate && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.exitDate')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.exitDate).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.exitReason && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.exitReason')}</span>\n              <span className=\"dark:text-white\">{lifecycle.exitReason}</span>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Progress-Bar - Onboarding */}\n      {lifecycle.status === 'onboarding' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold dark:text-white mb-4\">{t('lifecycle.progressTitle')}</h3>\n          <div className=\"space-y-2\">\n            <div className=\"flex justify-between text-sm mb-2\">\n              <span className=\"text-gray-600 dark:text-gray-400\">\n                {t('lifecycle.progressSteps', { completed: progress.completed, total: progress.total })}\n              </span>\n              <span className=\"font-medium dark:text-white\">{progress.percent}%</span>\n            </div>\n            <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3\">\n              <div\n                className=\"bg-blue-600 h-3 rounded-full transition-all duration-300\"\n                style={{ width: `${progress.percent}%` }}\n              ></div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Progress-Bar - Offboarding */}\n      {lifecycle.status === 'offboarding' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold dark:text-white mb-4\">{t('lifecycle.offboarding.progressTitle', { defaultValue: 'Offboarding-Fortschritt' })}</h3>\n          <div className=\"space-y-4\">\n            {/* Progress-Bar */}\n            {(() => {\n              const completedTasks = offboardingTasks.filter(task => task.status === 'done').length;\n              const totalTasks = offboardingTasks.length || 3; // Fallback: 3 Tasks\n              const percent = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;\n              \n              return (\n                <>\n                  <div className=\"flex justify-between text-sm mb-2\">\n                    <span className=\"text-gray-600 dark:text-gray-400\">\n                      {t('lifecycle.offboarding.progressSteps', { completed: completedTasks, total: totalTasks }) || `${completedTasks} von ${totalTasks} Schritten abgeschlossen`}\n                    </span>\n                    <span className=\"font-medium dark:text-white\">{percent}%</span>\n                  </div>\n                  <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3\">\n                    <div\n                      className=\"bg-orange-600 h-3 rounded-full transition-all duration-300\"\n                      style={{ width: `${percent}%` }}\n                    ></div>\n                  </div>\n                </>\n              );\n            })()}\n            \n            {/* Offboarding-Tasks Liste */}\n            {offboardingTasks.length > 0 && (\n              <div className=\"mt-4 space-y-2\">\n                <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  {t('lifecycle.offboarding.tasksTitle', { defaultValue: 'Offboarding-Aufgaben' })}\n                </h4>\n                {offboardingTasks.map((task) => {\n                  const isCompleted = task.status === 'done';\n                  return (\n                    <div\n                      key={task.id}\n                      className={`flex items-center justify-between p-3 rounded-lg border ${\n                        isCompleted\n                          ? 'bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800'\n                          : 'bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600'\n                      }`}\n                    >\n                      <div className=\"flex items-center space-x-3 flex-1\">\n                        {isCompleted ? (\n                          <CheckCircleIcon className=\"h-5 w-5 text-green-600 dark:text-green-400 flex-shrink-0\" />\n                        ) : (\n                          <ClockIcon className=\"h-5 w-5 text-orange-600 dark:text-orange-400 flex-shrink-0\" />\n                        )}\n                        <div className=\"flex-1 min-w-0\">\n                          <p className={`text-sm font-medium ${isCompleted ? 'text-green-800 dark:text-green-200' : 'text-gray-800 dark:text-gray-200'}`}>\n                            {task.title}\n                          </p>\n                          {task.description && (\n                            <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-1 truncate\">\n                              {task.description}\n                            </p>\n                          )}\n                        </div>\n                      </div>\n                      <span className={`text-xs px-2 py-1 rounded ${\n                        isCompleted\n                          ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200'\n                          : 'bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200'\n                      }`}>\n                        {isCompleted\n                          ? t('common.done', { defaultValue: 'Abgeschlossen' })\n                          : t('common.open', { defaultValue: 'Offen' })}\n                      </span>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Dokumente - Arbeitszeugnisse */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.certificates')}\n          </h3>\n          {isHR() && (\n            <button\n              onClick={() => setIsCertificateCreateModalOpen(true)}\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('lifecycle.createCertificate')}\n              aria-label={t('lifecycle.createCertificate')}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n            </button>\n          )}\n        </div>\n\n        {certificates.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noCertificates')}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {certificates.map((cert) => (\n              <div\n                key={cert.id}\n                className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition\"\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <h4 className=\"font-medium dark:text-white\">\n                        {t('lifecycle.certificate')}\n                        {cert.certificateType !== 'employment' && ` (${cert.certificateType})`}\n                      </h4>\n                      {cert.isLatest && (\n                        <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center\">\n                          <CheckCircleIcon className=\"h-3 w-3 mr-1\" />\n                          {t('lifecycle.current')}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                      <div className=\"flex items-center space-x-2\">\n                        <CalendarIcon className=\"h-4 w-4\" />\n                        <span>{t('lifecycle.issuedOn')} {formatDate(cert.issueDate)}</span>\n                      </div>\n                      {cert.generatedByUser && (\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4\" />\n                          <span>\n                            {t('lifecycle.createdBy')} {cert.generatedByUser.firstName} {cert.generatedByUser.lastName}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2 ml-4\">\n                    {isHR() && (\n                      <button\n                        onClick={() => setEditingCertificate(cert)}\n                        className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition\"\n                        title={t('lifecycle.edit')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                      </button>\n                    )}\n                    <button\n                      onClick={() => handleDownloadCertificate(cert.id)}\n                      disabled={downloadingCertId === cert.id}\n                      className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={t('lifecycle.download')}\n                    >\n                      {downloadingCertId === cert.id ? (\n                        <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                      ) : (\n                        <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                      )}\n                    </button>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Dokumente - Arbeitsvertrge */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.contracts')}\n          </h3>\n          {isHR() && (\n            <button\n              onClick={() => setIsContractCreateModalOpen(true)}\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('lifecycle.createContract')}\n              aria-label={t('lifecycle.createContract')}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n            </button>\n          )}\n        </div>\n\n        {contracts.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noContracts')}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {contracts.map((contract) => (\n              <div\n                key={contract.id}\n                className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition\"\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <h4 className=\"font-medium dark:text-white\">\n                        {t('lifecycle.contract')}\n                        {contract.contractType !== 'employment' && ` (${contract.contractType})`}\n                      </h4>\n                      {contract.isLatest && (\n                        <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center\">\n                          <CheckCircleIcon className=\"h-3 w-3 mr-1\" />\n                          {t('lifecycle.current')}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                      <div className=\"flex items-center space-x-2\">\n                        <CalendarIcon className=\"h-4 w-4\" />\n                        <span>\n                          {formatDate(contract.startDate)}\n                          {contract.endDate && ` - ${formatDate(contract.endDate)}`}\n                        </span>\n                      </div>\n                      {contract.position && (\n                        <div>{t('lifecycle.position')} {contract.position}</div>\n                      )}\n                      {contract.salary && (\n                        <div>{t('lifecycle.salary')} {contract.salary.toLocaleString('de-DE', { style: 'currency', currency: 'EUR' })}</div>\n                      )}\n                      {contract.workingHours && (\n                        <div>{t('lifecycle.workingHours')} {contract.workingHours}h/Woche</div>\n                      )}\n                      {contract.generatedByUser && (\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4\" />\n                          <span>\n                            {t('lifecycle.createdBy')} {contract.generatedByUser.firstName} {contract.generatedByUser.lastName}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2 ml-4\">\n                    {isHR() && (\n                      <button\n                        onClick={() => setEditingContract(contract)}\n                        className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition\"\n                        title={t('lifecycle.edit')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                      </button>\n                    )}\n                    <button\n                      onClick={() => handleDownloadContract(contract.id)}\n                      disabled={downloadingContractId === contract.id}\n                      className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={t('lifecycle.download')}\n                    >\n                      {downloadingContractId === contract.id ? (\n                        <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                      ) : (\n                        <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                      )}\n                    </button>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Social Security Status - Anzeige fr alle */}\n      {socialSecurityRegistrations.length > 0 && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold dark:text-white mb-4 flex items-center\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.socialSecurity')}\n          </h3>\n          <div className=\"space-y-3\">\n            {socialSecurityRegistrations.map((registration) => (\n              <div\n                key={registration.id}\n                className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg\"\n              >\n                <div className=\"flex items-center space-x-3\">\n                  {registration.status === 'registered' ? (\n                    <CheckCircleIcon className=\"h-5 w-5 text-green-500\" />\n                  ) : registration.status === 'pending' ? (\n                    <ClockIcon className=\"h-5 w-5 text-yellow-500\" />\n                  ) : (\n                    <XCircleIcon className=\"h-5 w-5 text-red-500\" />\n                  )}\n                  <div>\n                    <div className=\"font-medium dark:text-white uppercase\">\n                      {registration.registrationType}\n                    </div>\n                    {registration.provider && (\n                      <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        {registration.provider}\n                      </div>\n                    )}\n                    {registration.registrationNumber && (\n                      <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        Nr: {registration.registrationNumber}\n                      </div>\n                    )}\n                  </div>\n                </div>\n                <span className=\"text-sm font-medium dark:text-white\">\n                  {t(`lifecycle.socialSecurityStatus.${registration.status}`) || registration.status}\n                </span>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Social Security Editor - Nur fr Legal/Admin */}\n      {lifecycleData?.lifecycle && (\n        <SocialSecurityEditor\n          userId={userId}\n          lifecycleId={lifecycleData.lifecycle.id}\n          onUpdate={fetchData}\n        />\n      )}\n\n      {/* Modals */}\n      <CertificateCreationModal\n        isOpen={isCertificateCreateModalOpen}\n        onClose={() => setIsCertificateCreateModalOpen(false)}\n        onCertificateCreated={() => {\n          fetchData();\n          setIsCertificateCreateModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n\n      <ContractCreationModal\n        isOpen={isContractCreateModalOpen}\n        onClose={() => setIsContractCreateModalOpen(false)}\n        onContractCreated={() => {\n          fetchData();\n          setIsContractCreateModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n\n      {editingCertificate && (\n        <CertificateEditModal\n          isOpen={!!editingCertificate}\n          onClose={() => setEditingCertificate(null)}\n          onCertificateUpdated={() => {\n            fetchData();\n            setEditingCertificate(null);\n          }}\n          userId={userId}\n          certificate={editingCertificate}\n        />\n      )}\n\n      {editingContract && (\n        <ContractEditModal\n          isOpen={!!editingContract}\n          onClose={() => setEditingContract(null)}\n          onContractUpdated={() => {\n            fetchData();\n            setEditingContract(null);\n          }}\n          userId={userId}\n          contract={editingContract}\n        />\n      )}\n\n      {/* Offboarding-Start-Modal */}\n      <OffboardingStartModal\n        isOpen={isOffboardingStartModalOpen}\n        onClose={() => setIsOffboardingStartModalOpen(false)}\n        onOffboardingStarted={() => {\n          fetchData();\n          setIsOffboardingStartModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n      \n      {/* Offboarding-Abschluss-Modal */}\n      <OffboardingCompleteModal\n        isOpen={isOffboardingCompleteModalOpen}\n        onClose={() => setIsOffboardingCompleteModalOpen(false)}\n        onOffboardingCompleted={() => {\n          fetchData();\n          setIsOffboardingCompleteModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n        offboardingTasks={offboardingTasks}\n      />\n\n      {/* Modal zum Bearbeiten der Vertragsdaten */}\n      {isEditContractDatesModalOpen && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md mx-4\">\n            <h2 className=\"text-xl font-semibold dark:text-white mb-4\">\n              {t('lifecycle.editContractDates', { defaultValue: 'Vertragsdaten bearbeiten' })}\n            </h2>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('lifecycle.contractStart', { defaultValue: 'Vertragsbeginn' })} *\n                </label>\n                <input\n                  type=\"date\"\n                  value={editingContractStartDate}\n                  onChange={(e) => setEditingContractStartDate(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  required\n                />\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('lifecycle.contractEnd', { defaultValue: 'Vertragsende' })} (optional)\n                </label>\n                <input\n                  type=\"date\"\n                  value={editingContractEndDate}\n                  onChange={(e) => setEditingContractEndDate(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('lifecycle.contractEndHint', { defaultValue: 'Nur bei befristeten Vertrgen ausfllen' })}\n                </p>\n              </div>\n            </div>\n            \n            <div className=\"flex justify-end space-x-3 mt-6\">\n              <button\n                onClick={() => setIsEditContractDatesModalOpen(false)}\n                className=\"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition\"\n              >\n                {t('common.cancel', { defaultValue: 'Abbrechen' })}\n              </button>\n              <button\n                onClick={handleSaveContractDates}\n                disabled={!editingContractStartDate}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {t('common.save', { defaultValue: 'Speichern' })}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LifecycleView;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { userApi, roleApi } from '../api/apiClient.ts';\nimport { User, Role } from '../types/interfaces.ts';\nimport { CheckIcon, PlusIcon, PencilIcon, DocumentTextIcon, UserCircleIcon, ShieldCheckIcon, XMarkIcon, ArrowPathIcon, BuildingOfficeIcon } from '@heroicons/react/24/outline';\nimport useMessage from '../hooks/useMessage.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport IdentificationDocumentList from './IdentificationDocumentList.tsx';\nimport LifecycleView from './LifecycleView.tsx';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface UserManagementTabProps {\n  onError: (error: string) => void;\n}\n\n// Lnder und Sprachen werden dynamisch aus bersetzungen geladen\n\n// Definiere Rollen, die immer vorhanden sein sollten (z.B. Admin-Rolle)\nconst fixedRoles = [1, 2, 999]; // Admin (1), User (2) und Hamburger (999) sind fixe Rollen\n\n// Vertragstypen fr Kolumbien (CO)\nconst CONTRACT_TYPES = [\n  { code: 'tiempo_completo', name: 'Tiempo Completo (>21 Tage/Monat)' },\n  { code: 'tiempo_parcial_7', name: 'Tiempo Parcial (7 Tage/Monat)' },\n  { code: 'tiempo_parcial_14', name: 'Tiempo Parcial (14 Tage/Monat)' },\n  { code: 'tiempo_parcial_21', name: 'Tiempo Parcial (21 Tage/Monat)' },\n  { code: 'servicios_externos', name: 'Servicios Externos (Stundenbasiert)' }\n];\n\n// Gemeinsame Debug-Komponente hinzufgen\nconst RoleDebugInfo = ({ title, data }: { title: string, data: any }) => (\n  <div className=\"mb-2 p-2 border border-gray-300 rounded bg-gray-50\">\n    <h5 className=\"font-bold text-sm\">{title}</h5>\n    <pre className=\"text-xs overflow-auto max-h-24\">\n      {JSON.stringify(data, null, 2)}\n    </pre>\n  </div>\n);\n\nconst UserManagementTab = ({ onError }: UserManagementTabProps): JSX.Element => {\n  const { t } = useTranslation();\n  \n  // Lnder fr die Auswahl (dynamisch aus bersetzungen)\n  const COUNTRIES = [\n    { code: 'CO', name: t('countries.CO') },\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'DE', name: t('countries.DE') },\n    { code: 'AT', name: t('countries.AT') }\n  ];\n\n  // Lnder fr die Payroll-Auswahl (dynamisch aus bersetzungen)\n  const PAYROLL_COUNTRIES = [\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'CO', name: t('countries.CO') }\n  ];\n\n  // Sprachen fr die Auswahl (dynamisch aus bersetzungen)\n  const LANGUAGES = [\n    { code: 'es', name: t('languages.es') },\n    { code: 'de', name: t('languages.de') },\n    { code: 'en', name: t('languages.en') }\n  ];\n  \n  // Benutzer-States\n  const [users, setUsers] = useState<User[]>([]);\n  const [selectedUser, setSelectedUser] = useState<User | null>(null);\n  const [userFormData, setUserFormData] = useState<Partial<User>>({});\n  const [isEditingUser, setIsEditingUser] = useState(false);\n  const [selectedRoles, setSelectedRoles] = useState<number[]>([]);\n  const [isDebugMode, setIsDebugMode] = useState(false);\n  const [roleWarning, setRoleWarning] = useState<string | null>(null);\n  const { showMessage } = useMessage();\n  const { isAdmin } = usePermissions();\n  \n  // Neuer State fr Rollen\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState(false);\n  \n  // Neuer State fr die aktive Unterseite\n  const [activeUserTab, setActiveUserTab] = useState<'details' | 'documents' | 'roles' | 'lifecycle'>('details');\n  \n  // State fr Active/Inactive Filter\n  const [userFilterTab, setUserFilterTab] = useState<'active' | 'inactive'>('active');\n  \n  // State fr Benutzererstellung\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n  const [isMobile, setIsMobile] = useState<boolean>(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [newUserFormData, setNewUserFormData] = useState({\n    email: '',\n    password: '',\n    firstName: '',\n    lastName: ''\n  });\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isCreateModalOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isCreateModalOpen, openSidepane, closeSidepane]);\n\n  // Alle Benutzer (fr Filterung)\n  const [allUsers, setAllUsers] = useState<User[]>([]);\n\n  // Initialisierung - Laden von Benutzern\n  useEffect(() => {\n    fetchAllUsers();\n  }, []);\n\n  // Benutzerdaten laden - Verwende gefilterten Endpoint, damit nur Benutzer der eigenen Organisation angezeigt werden\n  const fetchAllUsers = async () => {\n    try {\n      const response = await userApi.getAll();\n      setAllUsers(response.data);\n      // Initial: Nur aktive Benutzer anzeigen\n      filterUsersByActiveStatus('active', response.data);\n    } catch (err) {\n      handleError(err);\n    }\n  };\n\n  // Benutzer nach Active/Inactive filtern und alphabetisch sortieren\n  const filterUsersByActiveStatus = (status: 'active' | 'inactive', usersToFilter: User[] = allUsers) => {\n    const filtered = usersToFilter.filter(user => {\n      const isActive = user.active !== undefined ? user.active : true; // Default: true\n      return status === 'active' ? isActive : !isActive;\n    });\n    \n    // Alphabetisch sortieren nach username, dann firstName\n    const sorted = filtered.sort((a, b) => {\n      const aUsername = (a.username || '').toLowerCase();\n      const bUsername = (b.username || '').toLowerCase();\n      const aFirstName = (a.firstName || '').toLowerCase();\n      const bFirstName = (b.firstName || '').toLowerCase();\n      \n      // Zuerst nach username sortieren\n      if (aUsername !== bUsername) {\n        return aUsername.localeCompare(bUsername);\n      }\n      // Wenn username gleich, nach Vorname sortieren\n      return aFirstName.localeCompare(bFirstName);\n    });\n    \n    setUsers(sorted);\n  };\n\n  // Wenn Filter-Tab wechselt, Benutzerliste neu filtern\n  useEffect(() => {\n    if (allUsers.length > 0) {\n      filterUsersByActiveStatus(userFilterTab, allUsers);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userFilterTab]);\n  \n  // Rollen laden - Wird erst aufgerufen, wenn ein Benutzer ausgewhlt wurde\n  const fetchRoles = async () => {\n    try {\n      setLoadingRoles(true);\n      \n      // Fallback-Rollen fr den Notfall bereithalten\n      const fallbackRoles = [\n        { id: 1, name: 'admin', description: 'Administrator mit allen Rechten', permissions: [] },\n        { id: 2, name: 'user', description: 'Standardbenutzer', permissions: [] },\n        { id: 999, name: 'hamburger', description: 'Hamburger-Rolle fr neue Benutzer', permissions: [] }\n      ];\n      \n      try {\n        const response = await roleApi.getAll();\n        if (response.data && Array.isArray(response.data) && response.data.length > 0) {\n          setRoles(response.data);\n          console.log(`${response.data.length} Rollen erfolgreich geladen`);\n        } else {\n          console.warn('Keine Rollen vom Server erhalten, verwende Fallback');\n          setRoles(fallbackRoles);\n        }\n      } catch (error) {\n        console.warn('Fehler beim Laden der Rollen, verwende Fallback:', error);\n        setRoles(fallbackRoles);\n      }\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  // Detaillierte Benutzerdaten laden\n  const fetchUserDetails = async (userId: number) => {\n    try {\n      if (!userId || isNaN(userId)) {\n        setSelectedUser(null);\n        return;\n      }\n      \n      console.log('Lade Benutzerdetails fr ID:', userId);\n      const response = await userApi.getById(userId);\n      \n      const userData = {\n        ...response.data,\n        active: response.data.active !== undefined ? response.data.active : true,\n        birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n      };\n      \n      // Extrahiere Rollen-IDs aus der verschachtelten Struktur\n      let roleIds: number[] = [];\n      \n      if (response.data.roles && Array.isArray(response.data.roles)) {\n        console.log('Rollenstruktur (Typ):', typeof response.data.roles, 'Lnge:', response.data.roles.length);\n        \n        // Struktur: roles: [{ role: { id, name, ... } }]\n        if (response.data.roles.length > 0 && response.data.roles[0].role) {\n          roleIds = response.data.roles.map(userRole => userRole.role.id);\n          console.log('Extrahierte Rollen-IDs aus verschachtelter Struktur:', roleIds);\n        }\n        // Fallback fr andere Formate\n        else if (response.data.roles.length > 0) {\n          if (typeof response.data.roles[0] === 'number') {\n            roleIds = response.data.roles;\n          } else if (response.data.roles[0].roleId) {\n            roleIds = response.data.roles.map(role => role.roleId);\n          } else if (response.data.roles[0].id) {\n            roleIds = response.data.roles.map(role => role.id);\n          }\n        }\n      } else {\n        console.warn('Rollen fehlen oder sind kein Array:', response.data.roles);\n      }\n      \n      // Wenn keine Rollen gefunden wurden, probieren wir, diese aus roles in der Response direkt zu extrahieren\n      if (roleIds.length === 0 && response.data.role) {\n        console.log('Versuche Rollen aus role-Eigenschaft zu extrahieren:', response.data.role);\n        if (Array.isArray(response.data.role)) {\n          roleIds = response.data.role.map((r: any) => r.id);\n        } else if (typeof response.data.role === 'object' && response.data.role !== null) {\n          roleIds = [response.data.role.id];\n        }\n      }\n      \n      console.log('Endgltige extrahierte Rollen-IDs:', roleIds);\n      \n      setSelectedUser(userData);\n      setUserFormData(userData);\n      setSelectedRoles(roleIds);\n      \n      // Rollen nur einmal laden, wenn sie noch nicht geladen wurden\n      if (roles.length === 0) {\n        await fetchRoles();\n      }\n    } catch (err) {\n      console.error('Fehler beim Laden der Benutzerdetails:', err);\n      handleError(err);\n    }\n  };\n\n  // Fehlerbehandlung\n  const handleError = (err: any) => {\n    let message = 'Ein Fehler ist aufgetreten';\n    if (err.response?.data?.message) {\n      message = err.response.data.message;\n    } else if (err instanceof Error) {\n      message = err.message;\n    }\n    \n    // Fehler \"Ungltige Rollen-ID\" nicht weitergeben, wenn kein Benutzer ausgewhlt ist\n    if (message.includes('Ungltige Rollen-ID') && !selectedUser) {\n      console.warn('Fehler unterdrckt, da kein Benutzer ausgewhlt ist:', message);\n      return;\n    }\n    \n    onError(message);\n  };\n\n  // Handler fr Auswahl eines Benutzers\n  const handleUserSelect = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const userId = parseInt(event.target.value, 10);\n    if (userId && !isNaN(userId)) {\n      fetchUserDetails(userId);\n    } else {\n      setSelectedUser(null);\n      setUserFormData({});\n      setSelectedRoles([]);\n    }\n  };\n\n  // Erweitere den handleUserInputChange\n  const handleUserInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value, type } = e.target;\n    let finalValue: string | number | null = value;\n    \n    // Korrekte Typenkonvertierung fr numerische Felder\n    if (type === 'number') {\n      // Wenn das Feld leer ist, setzen wir null statt NaN\n      finalValue = value === '' ? null : Number(value);\n    }\n    \n    setUserFormData({ ...userFormData, [name]: finalValue });\n    setIsEditingUser(true); // Aktiviere Edit-Modus sobald etwas gendert wird\n  };\n\n  // Abbrechen der Bearbeitung\n  const handleCancelEdit = () => {\n    if (selectedUser) {\n      setUserFormData({\n        ...selectedUser,\n        birthday: selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : null\n      });\n    }\n    setIsEditingUser(false);\n  };\n\n  // Speichern der Benutzerdaten\n  const handleUserSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!selectedUser || !selectedUser.id) {\n      onError('Kein Benutzer ausgewhlt');\n      showMessage('Kein Benutzer ausgewhlt', 'error');\n      return;\n    }\n\n    try {\n      // Validierung\n      if (!userFormData.username?.trim()) throw new Error('Benutzername ist erforderlich');\n      if (!userFormData.email?.trim()) throw new Error('E-Mail ist erforderlich');\n      if (!userFormData.firstName?.trim()) throw new Error('Vorname ist erforderlich');\n      if (!userFormData.lastName?.trim()) throw new Error('Nachname ist erforderlich');\n\n      // Bereite die Daten korrekt vor\n      const dataToSend = {\n        ...userFormData,\n        // Korrekte Behandlung von numerischen Werten\n        salary: userFormData.salary === null || userFormData.salary === undefined || userFormData.salary === '' as any\n          ? null \n          : typeof userFormData.salary === 'string' \n            ? parseFloat(userFormData.salary) \n            : userFormData.salary,\n        normalWorkingHours: userFormData.normalWorkingHours === null || userFormData.normalWorkingHours === undefined || userFormData.normalWorkingHours === '' as any\n          ? 7.6 \n          : typeof userFormData.normalWorkingHours === 'string' \n            ? parseFloat(userFormData.normalWorkingHours) \n            : userFormData.normalWorkingHours,\n        hourlyRate: userFormData.hourlyRate === null || userFormData.hourlyRate === undefined || userFormData.hourlyRate === '' as any\n          ? null \n          : typeof userFormData.hourlyRate === 'string' \n            ? userFormData.hourlyRate  // Keine Konvertierung fr Decimal-Werte, da sie als Strings bergeben werden sollten\n            : userFormData.hourlyRate.toString(),  // Konvertierung zu String fr Decimal-Werte\n        monthlySalary: userFormData.monthlySalary === null || userFormData.monthlySalary === undefined || userFormData.monthlySalary === '' as any\n          ? null \n          : typeof userFormData.monthlySalary === 'string' \n            ? parseFloat(userFormData.monthlySalary) \n            : userFormData.monthlySalary,\n        birthday: userFormData.birthday || null\n      };\n\n      console.log('Sende Daten zum Server:', dataToSend);\n\n      // Update Benutzerdaten\n      const response = await userApi.update(selectedUser.id, dataToSend);\n\n      if (response.data) {\n        const updatedData = {\n          ...response.data,\n          birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n        };\n        setSelectedUser(updatedData);\n        setUserFormData({\n          ...updatedData,\n          birthday: updatedData.birthday ? new Date(updatedData.birthday).toISOString().split('T')[0] : null\n        });\n        \n        // Optimistisches Update: User in allUsers und users aktualisieren\n        setAllUsers(prevUsers => \n          prevUsers.map(user => \n            user.id === updatedData.id ? updatedData : user\n          )\n        );\n        \n        // Benutzerliste neu filtern basierend auf aktuellem Tab\n        filterUsersByActiveStatus(userFilterTab, allUsers.map(user => \n          user.id === updatedData.id ? updatedData : user\n        ));\n        \n        showMessage('Benutzerprofil erfolgreich aktualisiert', 'success');\n        setIsEditingUser(false);\n      }\n    } catch (err) {\n      console.error('Fehler beim Speichern der Benutzerdaten:', err);\n      // Bei Fehler: Rollback durch vollstndiges Reload\n      await fetchAllUsers();\n      if (err.response?.status === 400) {\n        const errorMsg = `Validierungsfehler: ${err.response?.data?.message || 'Bitte berprfe die eingegebenen Daten'}`;\n        onError(errorMsg);\n        showMessage(errorMsg, 'error');\n      } else if (err.response?.status === 404) {\n        onError('Benutzer wurde nicht gefunden');\n        showMessage('Benutzer wurde nicht gefunden', 'error');\n      } else {\n        handleError(err);\n      }\n    }\n  };\n\n  // Benutzer aktivieren/deaktivieren\n  const handleToggleActive = async () => {\n    if (!selectedUser || !selectedUser.id) {\n      showMessage('Kein Benutzer ausgewhlt', 'error');\n      return;\n    }\n\n    // Verhindere, dass der Admin-Benutzer sich selbst deaktiviert\n    const currentUserId = parseInt(localStorage.getItem('userId') || '0', 10);\n    if (selectedUser.id === currentUserId) {\n      showMessage('Du kannst dich nicht selbst deaktivieren', 'warning');\n      return;\n    }\n\n    try {\n      // Aktueller Status: wenn undefined, dann true (Default)\n      const currentActiveStatus = selectedUser.active !== undefined ? selectedUser.active : true;\n      const newActiveStatus = !currentActiveStatus;\n      \n      console.log('Toggle active:', { \n        currentActiveStatus, \n        newActiveStatus, \n        selectedUser,\n        selectedUserActive: selectedUser.active,\n        userId: selectedUser.id\n      });\n      \n      const updatePayload = { active: newActiveStatus };\n      console.log('Sending update payload:', updatePayload, 'Type of active:', typeof newActiveStatus);\n      \n      // Update Benutzer\n      const response = await userApi.update(selectedUser.id, updatePayload);\n      \n      console.log('Update response:', response.data);\n\n      if (response.data) {\n        const updatedData = {\n          ...response.data,\n          active: response.data.active !== undefined ? response.data.active : true,\n          birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n        };\n        \n        console.log('Updated user data:', updatedData);\n        \n        setSelectedUser(updatedData);\n        setUserFormData({\n          ...updatedData,\n          birthday: updatedData.birthday ? new Date(updatedData.birthday).toISOString().split('T')[0] : null\n        });\n        \n        // Optimistisches Update: User in allUsers und users aktualisieren\n        setAllUsers(prevUsers => \n          prevUsers.map(user => \n            user.id === updatedData.id ? updatedData : user\n          )\n        );\n        \n        // Benutzerliste neu filtern basierend auf aktuellem Tab\n        filterUsersByActiveStatus(userFilterTab, allUsers.map(user => \n          user.id === updatedData.id ? updatedData : user\n        ));\n        \n        // Benutzerliste neu laden, um sicherzustellen, dass alles synchron ist\n        await fetchAllUsers();\n        \n        showMessage(\n          newActiveStatus \n            ? 'Benutzer erfolgreich aktiviert' \n            : 'Benutzer erfolgreich deaktiviert',\n          'success'\n        );\n      }\n    } catch (err) {\n      console.error('Fehler beim Aktivieren/Deaktivieren des Benutzers:', err);\n      handleError(err);\n      // Bei Fehler: Benutzerliste neu laden\n      await fetchAllUsers();\n    }\n  };\n\n  // Toggle Rolle fr einen Benutzer (hinzufgen/entfernen)\n  const toggleRole = async (roleId: number) => {\n    if (!roleId || !selectedUser) return;\n    \n    // Prfe, ob es sich um eine fixe Rolle handelt - Nur fr Admin-Benutzer (ID: 1) sind Admin-Rollen (ID: 1) nicht entfernbar\n    if (roleId === 1 && selectedUser.id === 1 && selectedRoles.includes(roleId)) {\n      showMessage('Die Admin-Rolle kann vom Admin-Benutzer nicht entfernt werden', 'warning');\n      return;\n    }\n    \n    try {\n      console.log('Toggle Rolle:', roleId, 'fr Benutzer:', selectedUser.id);\n      console.log('Aktuelle ausgewhlte Rollen:', selectedRoles);\n      \n      // berprfen, ob die Rolle bereits zugewiesen ist\n      const isRoleSelected = selectedRoles.includes(roleId);\n      \n      const newSelectedRoles = isRoleSelected\n        ? selectedRoles.filter(id => id !== roleId)\n        : [...selectedRoles, roleId];\n      \n      console.log('Neue ausgewhlte Rollen:', newSelectedRoles);\n      \n      // Optimistisches UI-Update\n      setSelectedRoles(newSelectedRoles);\n      \n      // API-Aufruf zur Aktualisierung der Rollen\n      console.log('Sende Rollenaktualisierung an API:', { userId: selectedUser.id, roleIds: newSelectedRoles });\n      const response = await userApi.updateRoles(selectedUser.id, newSelectedRoles);\n      console.log('API-Antwort bei Rollenaktualisierung:', response.data);\n      \n      // Benutzer nach dem Update neu laden\n      await fetchUserDetails(selectedUser.id);\n      \n      // Erfolgsmeldung anzeigen mit showMessage statt setUserSuccess\n      showMessage(\n        isRoleSelected\n          ? `Rolle erfolgreich entfernt`\n          : `Rolle erfolgreich zugewiesen`,\n        'success'\n      );\n    } catch (error) {\n      // Bei Fehler auf vorherigen Zustand zurcksetzen\n      console.error('Fehler beim Aktualisieren der Rollen:', error);\n      fetchUserDetails(selectedUser.id);\n      handleError(error);\n      showMessage('Fehler beim Aktualisieren der Rollen', 'error');\n    }\n  };\n\n  // Initialisiere FormData wenn Benutzer ausgewhlt wird\n  useEffect(() => {\n    if (selectedUser) {\n      setUserFormData({\n        ...selectedUser,\n        birthday: selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : null\n      });\n      setIsEditingUser(false); // Starte im Read-Only Modus\n    }\n  }, [selectedUser]);\n\n  // Handler fr neue Benutzer-Formular\n  const handleNewUserInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setNewUserFormData({ ...newUserFormData, [name]: value });\n  };\n\n  // Neuen Benutzer erstellen\n  const handleCreateUser = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Validierung\n    if (!newUserFormData.email || !newUserFormData.password || !newUserFormData.firstName || !newUserFormData.lastName) {\n      showMessage('Bitte fllen Sie alle Felder aus', 'error');\n      return;\n    }\n\n    // E-Mail-Format validieren\n    if (!newUserFormData.email.match(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/)) {\n      showMessage('Ungltiges E-Mail-Format', 'error');\n      return;\n    }\n\n    try {\n      const response = await userApi.create(newUserFormData);\n      \n      // Optimistisches Update: User zu allUsers hinzufgen\n      if (response.data) {\n        const newUser = {\n          ...response.data,\n          active: response.data.active !== undefined ? response.data.active : true\n        };\n        setAllUsers(prevUsers => [newUser, ...prevUsers]);\n        \n        // Wenn aktueller Tab \"active\" ist und neuer User aktiv ist, auch zu users hinzufgen\n        if (userFilterTab === 'active' && newUser.active) {\n          setUsers(prevUsers => [newUser, ...prevUsers]);\n        }\n      }\n      \n      showMessage('Benutzer erfolgreich erstellt', 'success');\n      setIsCreateModalOpen(false);\n      setNewUserFormData({\n        email: '',\n        password: '',\n        firstName: '',\n        lastName: ''\n      });\n    } catch (err: any) {\n      // Bei Fehler: Rollback durch vollstndiges Reload\n      await fetchAllUsers();\n      const errorMessage = err.response?.data?.message || 'Fehler beim Erstellen des Benutzers';\n      showMessage(errorMessage, 'error');\n      onError(errorMessage);\n    }\n  };\n\n  return (\n    <div className=\"container mx-auto px-4 pb-6\">\n      {/* Die lokale Erfolgsmeldungs-Anzeige wird entfernt, da wir jetzt HeaderMessage verwenden */}\n      {/* {userSuccess && (\n        <div className=\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4\">\n          {userSuccess}\n        </div>\n      )} */}\n\n      {/* Titelzeile: Button links, Dropdown rechts */}\n      <div className=\"mb-6\">\n        <div className=\"flex items-center gap-4\">\n          {/* Linke Seite: \"Neuer Benutzer\"-Button */}\n          <div className=\"flex items-center\">\n            {isAdmin() && (\n              <button\n                onClick={() => setIsCreateModalOpen(true)}\n                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                style={{ width: '30.19px', height: '30.19px' }}\n                title={t('users.create')}\n                aria-label={t('users.create')}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n              </button>\n            )}\n          </div>\n          \n          {/* Rechts: Benutzer-Dropdown mit Active/Inactive Tabs */}\n          <div className=\"flex-1\">\n            <label htmlFor=\"userSelect\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              {t('users.title')}\n            </label>\n            \n            {/* Active/Inactive Tabs */}\n            <div className=\"flex gap-2 mb-2\">\n              <button\n                type=\"button\"\n                onClick={() => setUserFilterTab('active')}\n                className={`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${\n                  userFilterTab === 'active'\n                    ? 'bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400'\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600'\n                }`}\n              >\n                {t('users.active')}\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setUserFilterTab('inactive')}\n                className={`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${\n                  userFilterTab === 'inactive'\n                    ? 'bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400'\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600'\n                }`}\n              >\n                {t('users.inactive')}\n              </button>\n            </div>\n            \n            <select\n              id=\"userSelect\"\n              onChange={handleUserSelect}\n              className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n            >\n              <option value=\"\">-- {t('users.title')} {t('common.select')} --</option>\n              {users.map(user => (\n                <option key={user.id} value={user.id}>\n                  {user.firstName} {user.lastName} ({user.username})\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n      </div>\n\n      {selectedUser && (\n        <div>\n          <div className=\"flex justify-between items-center mb-4\">\n            <div className=\"flex items-center gap-3\">\n              <h2 className=\"text-xl font-semibold dark:text-white\">\n                {t('users.title')}: {selectedUser.firstName} {selectedUser.lastName}\n              </h2>\n              {selectedUser.active !== undefined && (\n                <span className={`px-2 py-1 rounded text-xs font-medium ${\n                  selectedUser.active \n                    ? 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300' \n                    : 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300'\n                }`}>\n                  {selectedUser.active ? t('users.active') : t('users.inactive')}\n                </span>\n              )}\n            </div>\n            {isAdmin() && (\n              <button\n                onClick={handleToggleActive}\n                className={`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${\n                  selectedUser.active\n                    ? 'bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30'\n                    : 'bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900/20 dark:text-green-400 dark:hover:bg-green-900/30'\n                }`}\n                title={selectedUser.active ? t('users.deactivate') : t('users.activate')}\n              >\n                {selectedUser.active ? (\n                  <>\n                    <XMarkIcon className=\"h-5 w-5\" />\n                    {t('users.deactivate')}\n                  </>\n                ) : (\n                  <>\n                    <CheckIcon className=\"h-5 w-5\" />\n                    {t('users.activate')}\n                  </>\n                )}\n              </button>\n            )}\n          </div>\n\n          {/* Tabs fr Benutzerdetails, Dokumente und Rollen */}\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow mb-6\">\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n              <nav className=\"flex -mb-px\">\n                <button\n                  onClick={() => setActiveUserTab('details')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'details'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <UserCircleIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('users.title')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('documents')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'documents'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <DocumentTextIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('profile.documents')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('roles')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'roles'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <ShieldCheckIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('roles.title')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('lifecycle')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'lifecycle'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <BuildingOfficeIcon className=\"h-5 w-5 inline mr-2\" />\n                  Lebenszyklus\n                </button>\n              </nav>\n            </div>\n          </div>\n\n          {/* Benutzerdetails Formular */}\n          {activeUserTab === 'details' && (\n            <form onSubmit={handleUserSubmit} className=\"bg-white dark:bg-gray-800 rounded-lg shadow p-6\">\n              {/* Bestehender Code fr Benutzerdetails */}\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-6\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.username')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"username\"\n                    value={userFormData.username || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.email')}\n                  </label>\n                  <input\n                    type=\"email\"\n                    name=\"email\"\n                    value={userFormData.email || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.firstName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"firstName\"\n                    value={userFormData.firstName || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.lastName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"lastName\"\n                    value={userFormData.lastName || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.birthday')}\n                  </label>\n                  <input\n                    type=\"date\"\n                    name=\"birthday\"\n                    value={userFormData.birthday || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.bankDetails')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"bankDetails\"\n                    value={userFormData.bankDetails || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.contract')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"contract\"\n                    value={userFormData.contract || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.salary')}\n                  </label>\n                  <input\n                    type=\"number\"\n                    name=\"salary\"\n                    value={userFormData.salary === null || userFormData.salary === undefined ? '' : userFormData.salary}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.normalWorkingHours')}\n                  </label>\n                  <input\n                    type=\"number\"\n                    step=\"0.1\"\n                    name=\"normalWorkingHours\"\n                    value={userFormData.normalWorkingHours === null || userFormData.normalWorkingHours === undefined ? '7.6' : userFormData.normalWorkingHours}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.country')}\n                  </label>\n                  <select\n                    name=\"country\"\n                    value={userFormData.country || 'CO'}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  >\n                    {COUNTRIES.map((country) => (\n                      <option key={country.code} value={country.code}>\n                        {country.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.language')}\n                  </label>\n                  <select\n                    name=\"language\"\n                    value={userFormData.language || 'es'}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  >\n                    {LANGUAGES.map((language) => (\n                      <option key={language.code} value={language.code}>\n                        {language.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n              </div>\n\n              {/* Lohnabrechnung-Einstellungen */}\n              <div className=\"mt-4 border-t pt-4\">\n                <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('users.form.payrollSettings')}</h3>\n                \n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('users.form.payrollCountry')}\n                    </label>\n                    <select\n                      name=\"payrollCountry\"\n                      value={userFormData.payrollCountry || selectedUser.payrollCountry || 'CH'}\n                      onChange={handleUserInputChange}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    >\n                      {PAYROLL_COUNTRIES.map(country => (\n                        <option key={country.code} value={country.code}>\n                          {country.name}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  \n                  {(userFormData.payrollCountry === 'CO' || \n                    (selectedUser.payrollCountry === 'CO' && !userFormData.payrollCountry)) && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('users.form.contractType')}\n                      </label>\n                      <select\n                        name=\"contractType\"\n                        value={userFormData.contractType || ''}\n                        onChange={handleUserInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      >\n                        <option value=\"\">Bitte auswhlen</option>\n                        {CONTRACT_TYPES.map(type => (\n                          <option key={type.code} value={type.code}>\n                            {type.name}\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                  )}\n                </div>\n                \n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('users.form.hourlyRate')} ({(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? 'CHF' : 'COP'})\n                    </label>\n                    <input\n                      type=\"number\"\n                      name=\"hourlyRate\"\n                      min=\"0\"\n                      step={(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? '0.05' : '1'}\n                      value={userFormData.hourlyRate === null || userFormData.hourlyRate === undefined ? '' : userFormData.hourlyRate}\n                      onChange={handleUserInputChange}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      placeholder={(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? 'z.B. 45.00' : 'z.B. 50000'}\n                    />\n                  </div>\n                  \n                  {((userFormData.payrollCountry === 'CO' || selectedUser.payrollCountry === 'CO') && \n                    (userFormData.contractType !== 'servicios_externos' && selectedUser.contractType !== 'servicios_externos') &&\n                    (userFormData.contractType || selectedUser.contractType)) && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('users.form.monthlySalary')} (COP)\n                      </label>\n                      <input\n                        type=\"number\"\n                        name=\"monthlySalary\"\n                        min=\"0\"\n                        step=\"1000\"\n                        value={userFormData.monthlySalary === null || userFormData.monthlySalary === undefined ? '' : userFormData.monthlySalary}\n                        onChange={handleUserInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                        placeholder=\"z.B. 3500000\"\n                      />\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {isEditingUser && (\n                <div className=\"mt-4 flex justify-end gap-3\">\n                  <button\n                    type=\"button\"\n                    onClick={handleCancelEdit}\n                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                    title={t('common.cancel')}\n                  >\n                    <XMarkIcon className=\"h-5 w-5\" />\n                  </button>\n                  <button\n                    type=\"submit\"\n                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                    title={t('common.save')}\n                  >\n                    <CheckIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              )}\n            </form>\n          )}\n\n          {/* Identifikationsdokumente Tab */}\n          {activeUserTab === 'documents' && (\n            <IdentificationDocumentList userId={selectedUser.id} isAdmin={true} />\n          )}\n\n          {/* Rollen Tab */}\n          {activeUserTab === 'roles' && (\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow p-6\">\n              {/* Rollenzuweisung - nur anzeigen, wenn Rollen geladen wurden */}\n              {loadingRoles ? (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('roleAssignment.title')}</h3>\n                  <p className=\"dark:text-gray-300\">{t('roleAssignment.loading')}</p>\n                </div>\n              ) : roles.length > 0 && (\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('roleAssignment.title')}</h3>\n                  \n                  {/* berprfung auf unbekannte Rollen */}\n                  {selectedRoles.some(roleId => !roles.some(role => role.id === roleId)) && (\n                    <div className=\"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4\">\n                      <p className=\"font-bold\">{t('roleAssignment.unknownRolesWarning')}</p>\n                      <p>{t('roleAssignment.unknownRolesMessage', { ids: selectedRoles.filter(roleId => !roles.some(role => role.id === roleId)).join(', ') })}</p>\n                      <p className=\"mt-2 text-sm\">{t('roleAssignment.availableRoleIds', { ids: roles.map(r => r.id).join(', ') })}</p>\n                    </div>\n                  )}\n                  \n                  {/* Aktuell zugewiesene Rollen */}\n                  <div className=\"mb-4\">\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('roleAssignment.currentRoles')}</h4>\n                    {selectedRoles.length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('roleAssignment.noRolesAssigned')}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {/* Bekannte zugewiesene Rollen */}\n                        {roles\n                          .filter(role => selectedRoles.includes(role.id))\n                          .map(role => {\n                            // Eine Rolle ist nur dann nicht entfernbar, wenn es sich um die Admin-Rolle (ID: 1) fr den Admin-Benutzer (ID: 1) handelt\n                            const isFixedRole = role.id === 1 && selectedUser && selectedUser.id === 1;\n                            return (\n                              <div \n                                key={role.id} \n                                className={`border rounded-lg p-4 ${isFixedRole ? 'border-green-500 bg-green-50 dark:bg-green-900/20 dark:border-green-700 cursor-not-allowed' : 'border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 cursor-pointer'}`}\n                                onClick={() => !isFixedRole && toggleRole(role.id)}\n                              >\n                                <div className=\"flex justify-between items-center\">\n                                  <div>\n                                    <h4 className=\"font-medium flex items-center dark:text-white\">\n                                      {role.name}\n                                      {isFixedRole && (\n                                        <span className=\"ml-2 text-xs bg-green-600 text-white px-2 py-0.5 rounded-full\">\n                                          {t('roleAssignment.fixed')}\n                                        </span>\n                                      )}\n                                    </h4>\n                                    <p className=\"text-sm text-gray-600 dark:text-gray-400\">{role.description}</p>\n                                  </div>\n                                  <div className={`flex items-center ${isFixedRole ? 'text-gray-400 dark:text-gray-500' : 'text-blue-600 dark:text-blue-400'}`}>\n                                    <span className=\"mr-2 text-sm\">{isFixedRole ? t('roleAssignment.fixedAssigned') : t('roleAssignment.remove')}</span>\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </div>\n                                </div>\n                              </div>\n                            );\n                          })}\n                        \n                        {/* Unbekannte zugewiesene Rollen */}\n                        {selectedRoles\n                          .filter(roleId => !roles.some(role => role.id === roleId))\n                          .map(roleId => (\n                            <div \n                              key={`unknown-${roleId}`} \n                              className=\"border border-orange-500 bg-orange-50 rounded-lg p-4\"\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{t('roleAssignment.unknownRole', { id: roleId })}</h4>\n                                  <p className=\"text-sm text-orange-600\">{t('roleAssignment.unknownRoleDescription')}</p>\n                                </div>\n                                <div className=\"flex items-center text-orange-600\">\n                                  <span className=\"mr-2 text-sm\">{t('roleAssignment.remove')}</span>\n                                  <button \n                                    onClick={() => toggleRole(roleId)}\n                                    className=\"focus:outline-none\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </button>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Verfgbare Rollen */}\n                  <div>\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('roleAssignment.availableRoles')}</h4>\n                    {roles.filter(role => !selectedRoles.includes(role.id)).length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('roleAssignment.noRolesAvailable')}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {roles\n                          .filter(role => !selectedRoles.includes(role.id))\n                          .map(role => (\n                            <div \n                              key={role.id} \n                              className=\"border border-gray-300 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50\"\n                              onClick={() => toggleRole(role.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{role.name}</h4>\n                                  <p className=\"text-sm text-gray-600\">{role.description}</p>\n                                </div>\n                                <div className=\"flex items-center text-gray-500 hover:text-blue-600\">\n                                  <span className=\"mr-2 text-sm\">{t('roleAssignment.add')}</span>\n                                  <PlusIcon className=\"h-5 w-5\" />\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Lebenszyklus Tab */}\n          {activeUserTab === 'lifecycle' && selectedUser && (\n            <LifecycleView \n              userId={selectedUser.id} \n              userName={`${selectedUser.firstName} ${selectedUser.lastName}`}\n            />\n          )}\n        </div>\n      )}\n\n      {/* Sidepane/Modal fr Benutzererstellung */}\n      {isCreateModalOpen && (\n        <>\n          {/* Fr Mobile (unter 640px) - klassisches Modal */}\n          {isMobile ? (\n            <Dialog open={isCreateModalOpen} onClose={() => setIsCreateModalOpen(false)} className=\"relative z-50\">\n              <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n              \n              <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                  {/* Header */}\n                  <div className=\"px-6 py-4 border-b dark:border-gray-700\">\n                    <div className=\"flex items-center justify-between\">\n                      <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                        {t('organisation.createUser.title')}\n                      </Dialog.Title>\n                      <button\n                        onClick={() => setIsCreateModalOpen(false)}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                      >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                      </button>\n                    </div>\n                  </div>\n                  \n                  {/* Form */}\n                  <form onSubmit={handleCreateUser} className=\"p-6\">\n                    <div className=\"space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.email')} *\n                        </label>\n                        <input\n                          type=\"email\"\n                          name=\"email\"\n                          value={newUserFormData.email}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.password')} *\n                        </label>\n                        <input\n                          type=\"password\"\n                          name=\"password\"\n                          value={newUserFormData.password}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.firstName')} *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"firstName\"\n                          value={newUserFormData.firstName}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.lastName')} *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"lastName\"\n                          value={newUserFormData.lastName}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                    </div>\n                    \n                    {/* Footer */}\n                    <div className=\"mt-6 flex justify-end gap-3\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setIsCreateModalOpen(false)}\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                        title={t('common.cancel')}\n                      >\n                        <XMarkIcon className=\"h-5 w-5\" />\n                      </button>\n                      <button\n                        type=\"submit\"\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                        title={t('organisation.createUser.create')}\n                      >\n                        <CheckIcon className=\"h-5 w-5\" />\n                      </button>\n                    </div>\n                  </form>\n                </Dialog.Panel>\n              </div>\n            </Dialog>\n          ) : (\n            // Fr Desktop (ab 640px) - Sidepane\n            // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n            <>\n              {/* Backdrop - nur wenn offen und <= 1070px */}\n              {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n              {isCreateModalOpen && !isLargeScreen && (\n                <div \n                  className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                  aria-hidden=\"true\" \n                  style={{\n                    opacity: isCreateModalOpen ? 1 : 0,\n                    transition: 'opacity 300ms ease-out'\n                  }}\n                />\n              )}\n              \n              {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n              <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isCreateModalOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                  transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                  pointerEvents: isCreateModalOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isCreateModalOpen}\n                role=\"dialog\"\n                aria-modal={isCreateModalOpen}\n              >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                  <h2 className=\"text-lg font-semibold dark:text-white\">\n                    {t('organisation.createUser.title')}\n                  </h2>\n                  <button\n                    onClick={() => setIsCreateModalOpen(false)}\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                <div className=\"flex flex-col flex-1 min-h-0\">\n                  <form onSubmit={handleCreateUser} className=\"flex flex-col flex-1 min-h-0\">\n                    <div className=\"p-4 overflow-y-auto flex-1 min-h-0 space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.email')} *\n                        </label>\n                      <input\n                        type=\"email\"\n                        name=\"email\"\n                        value={newUserFormData.email}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.password')} *\n                      </label>\n                      <input\n                        type=\"password\"\n                        name=\"password\"\n                        value={newUserFormData.password}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.firstName')} *\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"firstName\"\n                        value={newUserFormData.firstName}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.lastName')} *\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"lastName\"\n                        value={newUserFormData.lastName}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                      </div>\n                    </div>\n                    \n                    {/* Footer */}\n                    <div className=\"flex justify-end gap-3 border-t dark:border-gray-700 pt-4 px-4 flex-shrink-0\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setIsCreateModalOpen(false)}\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                        title={t('common.cancel')}\n                      >\n                        <XMarkIcon className=\"h-5 w-5\" />\n                      </button>\n                      <button\n                        type=\"submit\"\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                        title={t('organisation.createUser.create')}\n                      >\n                        <CheckIcon className=\"h-5 w-5\" />\n                      </button>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default UserManagementTab; ","import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { roleApi } from '../api/apiClient.ts';\nimport { Role, AccessLevel } from '../types/interfaces.ts';\nimport { PencilIcon, TrashIcon, PlusIcon, FunnelIcon, XMarkIcon, CheckIcon, ArrowPathIcon, DocumentDuplicateIcon, ChevronDownIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { ErrorCategory } from '../services/ErrorHandler.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface RoleManagementTabProps {\n  onRolesChange?: () => void;\n  onError: (error: string) => void;\n  readOnly?: boolean;\n}\n\n// Definiere Seiten, die immer sichtbar sein sollen (ohne Berechtigungsprfung)\nconst alwaysVisiblePages = ['dashboard', 'worktracker', 'cerebro', 'settings', 'profile'];\n\n// ALLE SEITEN IM SYSTEM (synchron mit Backend)\nconst defaultPages = [\n  'dashboard',\n  'worktracker',\n  'consultations',\n  'team_worktime_control', // = workcenter\n  'payroll', // = lohnabrechnung\n  'organization_management', // = organisation (Hauptseite)\n  'cerebro',\n  'settings',\n  'profile'\n];\n\n// ALLE TABELLEN IM SYSTEM (synchron mit Backend)\nconst defaultTables = [\n  'requests',           // auf dashboard\n  'tasks',             // auf worktracker\n  'users',             // auf organization_management\n  'roles',             // auf organization_management\n  'organization',      // auf organization_management\n  'organization_join_requests', // auf organization_management\n  'organization_users',  // auf organization_management\n  'team_worktime',     // auf team_worktime_control\n  'worktime',          // auf worktracker\n  'clients',           // auf consultations\n  'consultation_invoices', // auf consultations\n  'branches',          // auf settings/system\n  'notifications',     // allgemein\n  'settings',          // auf settings\n  'monthly_reports'    // auf consultations/reports\n];\n\n// ALLE BUTTONS IM SYSTEM (synchron mit Backend)\nconst defaultButtons = [\n  // Database Management Buttons (Settings/System)\n  'database_reset_table',\n  'database_logs',\n  \n  // Invoice Functions Buttons\n  'invoice_create',\n  'invoice_download', \n  'invoice_mark_paid',\n  'invoice_settings',\n  \n  // Todo/Task Buttons (Worktracker)\n  'todo_create',\n  'todo_edit',\n  'todo_delete',\n  'task_create',\n  'task_edit', \n  'task_delete',\n  \n  // User Management Buttons\n  'user_create',\n  'user_edit',\n  'user_delete',\n  'role_assign',\n  'role_create',\n  'role_edit',\n  'role_delete',\n  \n  // Organization Management Buttons\n  'organization_create',\n  'organization_edit',\n  'organization_delete',\n  \n  // Worktime Buttons\n  'worktime_start',\n  'worktime_stop', \n  'worktime_edit',\n  'worktime_delete',\n  \n  // General Cerebro Button\n  'cerebro',\n  \n  // Consultation Buttons\n  'consultation_start',\n  'consultation_stop',\n  'consultation_edit',\n  \n  // Client Management Buttons\n  'client_create',\n  'client_edit',\n  'client_delete',\n  \n  // Settings Buttons\n  'settings_system',\n  'settings_notifications',\n  'settings_profile',\n  \n  // Payroll Buttons\n  'payroll_generate',\n  'payroll_export',\n  'payroll_edit'\n];\n\n// Definiert die Zuordnung von Tabellen zu ihren bergeordneten Seiten\nconst tableToPageMapping = {\n  'requests': 'dashboard',\n  'tasks': 'worktracker',\n  'users': 'organization_management',\n  'roles': 'organization_management',\n  'organization': 'organization_management',\n  'organization_join_requests': 'organization_management',\n  'organization_users': 'organization_management',\n  'team_worktime': 'team_worktime_control',\n  'worktime': 'worktracker',\n  'clients': 'consultations',\n  'consultation_invoices': 'consultations',\n  'branches': 'settings',\n  'notifications': 'general',\n  'settings': 'settings',\n  'monthly_reports': 'consultations'\n};\n\n// Definiert die Zuordnung von Buttons zu ihren bergeordneten Seiten/Bereichen\nconst buttonToPageMapping = {\n  'database_reset_table': 'settings',\n  'database_logs': 'settings',\n  'invoice_create': 'consultations',\n  'invoice_download': 'consultations',\n  'invoice_mark_paid': 'consultations',\n  'invoice_settings': 'consultations',\n  'todo_create': 'worktracker',\n  'todo_edit': 'worktracker',\n  'todo_delete': 'worktracker',\n  'task_create': 'worktracker',\n  'task_edit': 'worktracker',\n  'task_delete': 'worktracker',\n  'user_create': 'organization_management',\n  'user_edit': 'organization_management',\n  'user_delete': 'organization_management',\n  'role_assign': 'organization_management',\n  'role_create': 'organization_management',\n  'role_edit': 'organization_management',\n  'role_delete': 'organization_management',\n  'organization_create': 'organization_management',\n  'organization_edit': 'organization_management',\n  'organization_delete': 'organization_management',\n  'worktime_start': 'worktracker',\n  'worktime_stop': 'worktracker',\n  'worktime_edit': 'worktracker',\n  'worktime_delete': 'worktracker',\n  'cerebro': 'cerebro',\n  'consultation_start': 'consultations',\n  'consultation_stop': 'consultations',\n  'consultation_edit': 'consultations',\n  'client_create': 'consultations',\n  'client_edit': 'consultations',\n  'client_delete': 'consultations',\n  'settings_system': 'settings',\n  'settings_notifications': 'settings',\n  'settings_profile': 'settings',\n  'payroll_generate': 'payroll',\n  'payroll_export': 'payroll',\n  'payroll_edit': 'payroll'\n};\n\n// Definiert die Zuordnung von Buttons zu ihren zugehrigen Tabellen\nconst buttonToTableMapping: Record<string, string | null> = {\n  // Worktime Buttons  worktime Tabelle\n  'worktime_start': 'worktime',\n  'worktime_stop': 'worktime',\n  'worktime_edit': 'worktime',\n  'worktime_delete': 'worktime',\n  // Task/Todo Buttons  tasks Tabelle\n  'task_create': 'tasks',\n  'task_edit': 'tasks',\n  'task_delete': 'tasks',\n  'todo_create': 'tasks',\n  'todo_edit': 'tasks',\n  'todo_delete': 'tasks',\n  // Client Buttons  clients Tabelle\n  'client_create': 'clients',\n  'client_edit': 'clients',\n  'client_delete': 'clients',\n  'consultation_start': 'clients',\n  'consultation_stop': 'clients',\n  'consultation_edit': 'clients',\n  // Invoice Buttons  consultation_invoices Tabelle\n  'invoice_create': 'consultation_invoices',\n  'invoice_download': 'consultation_invoices',\n  'invoice_mark_paid': 'consultation_invoices',\n  'invoice_settings': 'consultation_invoices',\n  // User Management Buttons  users/roles Tabellen\n  'user_create': 'users',\n  'user_edit': 'users',\n  'user_delete': 'users',\n  'role_assign': 'roles',\n  'role_create': 'roles',\n  'role_edit': 'roles',\n  'role_delete': 'roles',\n  // Organization Management Buttons  organization Tabelle\n  'organization_create': 'organization',\n  'organization_edit': 'organization',\n  'organization_delete': 'organization',\n  // Settings Buttons  settings Tabelle\n  'settings_system': 'settings',\n  'settings_notifications': 'settings',\n  'settings_profile': 'settings',\n  // Buttons ohne direkte Tabelle-Zuordnung\n  'database_reset_table': null,\n  'database_logs': null,\n  'cerebro': null,\n  'payroll_generate': null,\n  'payroll_export': null,\n  'payroll_edit': null\n};\n\n// Display-Name-Mapping fr Seiten (DB-Interne Bezeichnung  Frontend-Bezeichnung)\n// Wird dynamisch aus bersetzungen geladen\n\n// Display-Name-Mapping fr Tabellen (DB-Interne Bezeichnung  Frontend-Bezeichnung)\n// Wird dynamisch aus bersetzungen geladen\n\n// Display-Name-Mapping fr Buttons wird dynamisch in der Komponente geladen\n\n// TableID fr gespeicherte Filter\nconst ROLES_TABLE_ID = 'roles-table';\n\n// Standardrollen-IDs (fr Rollen ohne Organisation)\nconst STANDARD_ROLE_IDS = [1, 2, 999]; // Admin (1), User (2), Hamburger (999)\n\n// Standardrollen-Namen (drfen nicht bearbeitet/gelscht werden, egal von welcher Organisation)\nconst STANDARD_ROLE_NAMES = ['Admin', 'User', 'Hamburger'];\n\n// Helper-Funktion zur Prfung ob es sich um eine Standardrolle handelt\nconst isStandardRole = (roleId: number, roleName?: string): boolean => {\n  // Prfe zuerst auf Standard-IDs (fr Rollen ohne Organisation)\n  if (STANDARD_ROLE_IDS.includes(roleId)) {\n    return true;\n  }\n  // Prfe auf Standard-Namen (fr Rollen in Organisationen)\n  if (roleName && STANDARD_ROLE_NAMES.includes(roleName)) {\n    return true;\n  }\n  return false;\n};\n\ninterface RoleFormData {\n  name: string;\n  description: string;\n  permissions: {\n    entity: string;\n    entityType: string;\n    accessLevel: AccessLevel;\n  }[];\n}\n\n\n// RoleCard-Komponente fr mobile Ansicht\nconst RoleCard: React.FC<{\n  role: Role;\n  onEdit: (role: Role) => void;\n  onDelete: (roleId: number) => void;\n  onCopy: (role: Role) => void;\n  canEdit: boolean;\n  canDelete: boolean;\n  canCopy: boolean;\n}> = ({ role, onEdit, onDelete, onCopy, canEdit, canDelete, canCopy }) => {\n  const { t } = useTranslation();\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4 mb-4\">\n      {/* Header mit Rollenname und Aktionen */}\n      <div className=\"flex justify-between items-start mb-2\">\n        <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{role.name}</h3>\n        \n        <div className=\"flex space-x-2\">\n          {canCopy && (\n            <button\n              onClick={() => onCopy(role)}\n              className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n              title={t('roles.actions.copy')}\n            >\n              <DocumentDuplicateIcon className=\"h-5 w-5\" />\n            </button>\n          )}\n          \n          {canEdit && (\n            <button\n              onClick={() => onEdit(role)}\n              className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n              title={t('roles.actions.edit')}\n            >\n              <PencilIcon className=\"h-5 w-5\" />\n            </button>\n          )}\n          \n          {canDelete && (\n            <button\n              onClick={() => onDelete(role.id)}\n              className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n              title={t('roles.actions.delete')}\n            >\n              <TrashIcon className=\"h-5 w-5\" />\n            </button>\n          )}\n        </div>\n      </div>\n      \n      {/* Beschreibung */}\n      <p className=\"text-sm text-gray-600 dark:text-gray-400\">{role.description || t('roles.noDescription')}</p>\n      \n      {/* Berechtigungen - kompakt */}\n      <div className=\"mt-2\">\n        <h4 className=\"text-sm font-medium text-gray-900 dark:text-white mb-1\">{t('roles.permissions')}:</h4>\n        <div className=\"flex flex-wrap gap-1\">\n          {role.permissions\n            .filter(perm => perm.accessLevel !== 'none') // Nur relevante Berechtigungen anzeigen\n            .slice(0, 8) // Begrenze die Anzahl der angezeigten Berechtigungen\n            .map(permission => (\n              <span \n                key={`${permission.entity}-${permission.entityType}`}\n                className=\"text-xs bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 px-2 py-1 rounded\"\n              >\n                {permission.entity}: {permission.accessLevel}\n              </span>\n            ))}\n          {role.permissions.filter(perm => perm.accessLevel !== 'none').length > 8 && (\n            <span className=\"text-xs bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-300 px-2 py-1 rounded\">\n                +{role.permissions.filter(perm => perm.accessLevel !== 'none').length - 8} {t('common.showMore')}\n            </span>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst RoleManagementTab: React.FC<RoleManagementTabProps> = ({ onRolesChange, onError, readOnly = false }) => {\n  const { t } = useTranslation();\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [editingRole, setEditingRole] = useState<Role | null>(null);\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loading, setLoading] = useState(true);\n  \n  // Display-Name-Mapping fr Seiten (dynamisch aus bersetzungen)\n  const pageDisplayNames = useMemo(() => ({\n    'dashboard': t('roles.pages.dashboard'),\n    'worktracker': t('roles.pages.worktracker'),\n    'consultations': t('roles.pages.consultations'),\n    'team_worktime_control': t('roles.pages.team_worktime_control'),\n    'payroll': t('roles.pages.payroll'),\n    'organization_management': t('roles.pages.organization_management'), // Organisation-Seite (Hauptseite)\n    'cerebro': t('roles.pages.cerebro'),\n    'settings': t('roles.pages.settings'),\n    'profile': t('roles.pages.profile')\n  }), [t]);\n\n  // Display-Name-Mapping fr Tabellen (dynamisch aus bersetzungen)\n  const tableDisplayNames = useMemo(() => ({\n    'tasks': t('roles.tables.tasks'),\n    'worktime': t('roles.tables.worktime'),\n    'users': t('roles.tables.users'),\n    'roles': t('roles.tables.roles'),\n    'organization': t('roles.tables.organization'),\n    'organization_join_requests': t('roles.tables.organization_join_requests'),\n    'organization_users': t('roles.tables.organization_users'),\n    'clients': t('roles.tables.clients'),\n    'consultation_invoices': t('roles.tables.consultation_invoices'),\n    'requests': t('roles.tables.requests'),\n    'team_worktime': t('roles.tables.team_worktime'),\n    'settings': t('roles.tables.settings'),\n    'notifications': t('roles.tables.notifications'),\n    'branches': t('roles.tables.branches'),\n    'monthly_reports': t('roles.tables.monthly_reports')\n  }), [t]);\n\n  // Display-Name-Mapping fr Buttons (dynamisch aus bersetzungen)\n  const buttonDisplayNames = useMemo(() => ({\n    'worktime_start': t('roles.buttons.worktime_start'),\n    'worktime_stop': t('roles.buttons.worktime_stop'),\n    'worktime_edit': t('roles.buttons.worktime_edit'),\n    'worktime_delete': t('roles.buttons.worktime_delete'),\n    'task_create': t('roles.buttons.task_create'),\n    'task_edit': t('roles.buttons.task_edit'),\n    'task_delete': t('roles.buttons.task_delete'),\n    'todo_create': t('roles.buttons.todo_create'),\n    'todo_edit': t('roles.buttons.todo_edit'),\n    'todo_delete': t('roles.buttons.todo_delete'),\n    'client_create': t('roles.buttons.client_create'),\n    'client_edit': t('roles.buttons.client_edit'),\n    'client_delete': t('roles.buttons.client_delete'),\n    'consultation_start': t('roles.buttons.consultation_start'),\n    'consultation_stop': t('roles.buttons.consultation_stop'),\n    'consultation_edit': t('roles.buttons.consultation_edit'),\n    'invoice_create': t('roles.buttons.invoice_create'),\n    'invoice_download': t('roles.buttons.invoice_download'),\n    'invoice_mark_paid': t('roles.buttons.invoice_mark_paid'),\n    'invoice_settings': t('roles.buttons.invoice_settings'),\n    'user_create': t('roles.buttons.user_create'),\n    'user_edit': t('roles.buttons.user_edit'),\n    'user_delete': t('roles.buttons.user_delete'),\n    'role_assign': t('roles.buttons.role_assign'),\n    'role_create': t('roles.buttons.role_create'),\n    'role_edit': t('roles.buttons.role_edit'),\n    'role_delete': t('roles.buttons.role_delete'),\n    'organization_create': t('roles.buttons.organization_create'),\n    'organization_edit': t('roles.buttons.organization_edit'),\n    'organization_delete': t('roles.buttons.organization_delete'),\n    'settings_system': t('roles.buttons.settings_system'),\n    'settings_notifications': t('roles.buttons.settings_notifications'),\n    'settings_profile': t('roles.buttons.settings_profile'),\n    'database_reset_table': t('roles.buttons.database_reset_table'),\n    'database_logs': t('roles.buttons.database_logs'),\n    'payroll_generate': t('roles.buttons.payroll_generate'),\n    'payroll_export': t('roles.buttons.payroll_export'),\n    'payroll_edit': t('roles.buttons.payroll_edit'),\n    'cerebro': t('roles.buttons.cerebro')\n  }), [t]);\n  const [formData, setFormData] = useState<RoleFormData>({\n    name: '',\n    description: '',\n    permissions: [\n      // Seiten-Berechtigungen\n      ...defaultPages.map(page => ({\n        entity: page,\n        entityType: 'page',\n        accessLevel: 'none' as AccessLevel\n      })),\n      // Tabellen-Berechtigungen\n      ...defaultTables.map(table => ({\n        entity: table,\n        entityType: 'table',\n        accessLevel: 'none' as AccessLevel\n      })),\n      // Button-Berechtigungen\n      ...defaultButtons.map(button => ({\n        entity: button,\n        entityType: 'button',\n        accessLevel: 'none' as AccessLevel\n      }))\n    ]\n  });\n  const [error, setError] = useState<string | null>(null);\n  const { hasPermission } = usePermissions();\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n  \n  // Neue State-Variablen fr erweiterte Filterbedingungen\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  // Responsiveness Hook (640px wie Standard)\n  const [isMobile, setIsMobile] = useState<boolean>(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  \n  // Neue Fehlerbehandlung hinzufgen\n  const { handleError, handleValidationError } = useError();\n  \n  // Neue State-Variablen fr die Berechtigungen\n  const [isAddPermissionModalOpen, setIsAddPermissionModalOpen] = useState(false);\n  const [selectedPermission, setSelectedPermission] = useState<string | null>(null);\n  const [displayLimit, setDisplayLimit] = useState<number>(10);\n  \n  // berwache Bildschirmgre\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isModalOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isModalOpen, openSidepane, closeSidepane]);\n\n  // Aktualisiere die fetchRoles-Funktion, um den neuen ErrorHandler zu nutzen\n  const fetchRoles = useCallback(async () => {\n    setLoading(true);\n    console.log('DEBUGAUSGABE: Hole Rollen vom Server...');\n    \n    try {\n      const response = await roleApi.getAll();\n      console.log('DEBUGAUSGABE: Rollen erfolgreich geholt:', response.data);\n      setRoles(response.data);\n      setError(null);\n    } catch (error) {\n      console.error('DEBUGAUSGABE: Fehler beim Abrufen der Rollen:', error);\n      // Nutze den neuen ErrorHandler\n      handleError(error, { \n        component: 'RoleManagementTab', \n        action: 'fetchRoles' \n      });\n      // Rufe auch den bergebenen onError auf, falls vorhanden\n      if (onError) {\n        onError('Fehler beim Laden der Rollen');\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [handleError, onError]);\n\n  // Direkt Rollen laden\n  useEffect(() => {\n    fetchRoles();\n  }, [fetchRoles]);\n\n  // Speichern einer Rolle\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n    \n    if (!formData.name) {\n      handleValidationError('Rollenname darf nicht leer sein', { name: 'Rollenname ist erforderlich' });\n      return;\n    }\n    \n    if (editingRole) {\n      // Stelle sicher, dass die immer sichtbaren Seiten auch tatschlich auf 'both' gesetzt sind\n      const updatedPermissions = formData.permissions.map(permission => {\n        if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n          return { ...permission, accessLevel: 'both' };\n        }\n        return permission;\n      });\n      \n      // Filtere nur die relevanten Berechtigungen (nicht 'none')\n      const filteredPermissions = updatedPermissions\n        .filter(permission => permission.accessLevel !== 'none')\n        .map(permission => ({\n          entity: permission.entity,\n          entityType: permission.entityType,\n          accessLevel: permission.accessLevel\n        }));\n      \n      if (!editingRole.id || isNaN(editingRole.id)) {\n        console.warn('DEBUGAUSGABE: Ungltige Rollen-ID erkannt, Bearbeitung abgebrochen');\n        handleError('Ungltige Rollen-ID, Bearbeitung abgebrochen', { \n          component: 'RoleManagementTab',\n          roleId: editingRole.id\n        });\n        return;\n      }\n      \n      // berprfen, ob es sich um eine geschtzte Rolle handelt\n      if (isStandardRole(editingRole.id, editingRole.name)) {\n        console.warn(`DEBUGAUSGABE: Versuch, geschtzte Rolle mit ID ${editingRole.id} zu bearbeiten`);\n        handleError({\n          message: 'Geschtzte Systemrollen knnen nicht bearbeitet werden',\n          name: 'PermissionError'\n        }, {\n          component: 'RoleManagementTab',\n          roleId: editingRole.id,\n          category: ErrorCategory.PERMISSION\n        });\n        setIsModalOpen(false);\n        return;\n      }\n      \n      // berprfen, ob die Rolle noch in der aktuellen Liste existiert\n      const roleExists = roles.some(r => r.id === editingRole.id);\n      if (!roleExists) {\n        console.error(`DEBUGAUSGABE: Rolle mit ID ${editingRole.id} existiert nicht in der aktuellen Liste`);\n        handleError(`Rolle mit ID ${editingRole.id} existiert nicht mehr. Bitte aktualisieren Sie die Seite.`, {\n          component: 'RoleManagementTab',\n          roleId: editingRole.id\n        });\n        setIsModalOpen(false);\n        // Rollen neu laden, um die Anzeige zu aktualisieren\n        await fetchRoles();\n        return;\n      }\n      \n      console.log(`DEBUGAUSGABE: Bearbeite Rolle mit ID ${editingRole.id}`);\n      \n      try {\n        console.log('DEBUGAUSGABE: Sende Aktualisierung an API:', {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        });\n        \n        const dataToSend = {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        };\n        \n        console.log('DEBUGAUSGABE: Vor dem API-Aufruf roleApi.update');\n        const response = await roleApi.update(editingRole.id, dataToSend);\n        console.log('DEBUGAUSGABE: Nach dem API-Aufruf roleApi.update');\n        console.log('DEBUGAUSGABE: API-Antwort bei Rollenaktualisierung:', response);\n        await fetchRoles();\n      } catch (updateError) {\n        console.error('DEBUGAUSGABE: Fehler bei Rollenaktualisierung:', updateError);\n        if (updateError.response) {\n          // Spezifischere Fehlerbehandlung\n          if (updateError.response.data.meta && updateError.response.data.meta.cause === \"Record to update not found.\") {\n            handleError('Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.', {\n              component: 'RoleManagementTab',\n              roleId: editingRole.id\n            });\n            setIsModalOpen(false);\n            // Rollenliste aktualisieren, um Frontend zu synchronisieren\n            await fetchRoles();\n          } else {\n            handleError(updateError.response.data.message || 'Fehler beim Aktualisieren der Rolle', {\n              component: 'RoleManagementTab',\n              roleId: editingRole.id\n            });\n          }\n        } else {\n          handleError('Fehler beim Aktualisieren der Rolle', {\n            component: 'RoleManagementTab',\n            roleId: editingRole.id\n          });\n        }\n        return;\n      }\n    } else {\n      // Erstellen einer neuen Rolle\n      try {\n        // Stelle sicher, dass die immer sichtbaren Seiten auch tatschlich auf 'both' gesetzt sind\n        const updatedPermissions = formData.permissions.map(permission => {\n          if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n            return { ...permission, accessLevel: 'both' };\n          }\n          return permission;\n        });\n        \n        // Filtere nur die relevanten Berechtigungen (nicht 'none')\n        const filteredPermissions = updatedPermissions\n          .filter(permission => permission.accessLevel !== 'none')\n          .map(permission => ({\n            entity: permission.entity,\n            entityType: permission.entityType,\n            accessLevel: permission.accessLevel\n          }));\n        \n        console.log('DEBUGAUSGABE: Sende Daten an API fr neue Rolle:', {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        });\n        \n        const dataToSend = {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        };\n        \n        console.log('DEBUGAUSGABE: Vor dem API-Aufruf roleApi.create');\n        const response = await roleApi.create(dataToSend);\n        console.log('DEBUGAUSGABE: Nach dem API-Aufruf roleApi.create');\n        console.log('DEBUGAUSGABE: API-Antwort beim Erstellen der Rolle:', response);\n        await fetchRoles();\n      } catch (createError) {\n        console.error('DEBUGAUSGABE: Fehler bei API-Anfrage zum Erstellen der Rolle:', createError);\n        if (createError.response) {\n          handleError(createError.response.data.message || 'Fehler beim Erstellen der Rolle', {\n            component: 'RoleManagementTab'\n          });\n        } else {\n          handleError('Fehler beim Erstellen der Rolle', {\n            component: 'RoleManagementTab'\n          });\n        }\n        return;\n      }\n    }\n    \n    if (onRolesChange) onRolesChange();\n    \n    setIsModalOpen(false);\n    resetForm();\n  };\n\n  // Lschen einer Rolle\n  const handleDelete = async (roleId: number) => {\n    if (!roleId || isNaN(roleId)) {\n      console.warn('Ungltige Rollen-ID erkannt, Lschvorgang abgebrochen');\n      handleError('Ungltige Rollen-ID, Lschvorgang abgebrochen', {\n        component: 'RoleManagementTab',\n        roleId: roleId\n      });\n      return;\n    }\n    \n    // Finde die Rolle in der Liste, um den Namen zu prfen\n    const role = roles.find(r => r.id === roleId);\n    \n    // berprfen, ob es sich um eine geschtzte Rolle handelt\n    if (role && isStandardRole(roleId, role.name)) {\n      console.warn(`Versuch, geschtzte Rolle mit ID ${roleId} (${role.name}) zu lschen`);\n      handleError('Geschtzte Systemrollen knnen nicht gelscht werden', {\n        component: 'RoleManagementTab',\n        roleId: roleId\n      });\n      return;\n    }\n    \n    if (!window.confirm('Mchten Sie diese Rolle wirklich lschen?')) return;\n    \n    try {\n      console.log(`Starte Lschvorgang fr Rolle mit ID ${roleId}`);\n      \n      // berprfen, ob die Rolle in der aktuellen Liste existiert\n      const roleExists = roles.some(r => r.id === roleId);\n      if (!roleExists) {\n        console.error(`Rolle mit ID ${roleId} existiert nicht in der aktuellen Liste`);\n        handleError(`Rolle mit ID ${roleId} existiert nicht mehr. Bitte aktualisieren Sie die Seite.`, {\n          component: 'RoleManagementTab',\n          roleId: roleId\n        });\n        // Rollen neu laden, um die Anzeige zu aktualisieren\n        await fetchRoles();\n        return;\n      }\n      \n      // Bei Mock-Daten lokales Lschen (wird nicht verwendet)\n      if (false) {\n        console.log('Lsche Mock-Rolle');\n        const updatedRoles = roles.filter(role => role.id !== roleId);\n        setRoles(updatedRoles);\n      } else {\n        console.log('Sende Lschanfrage an API');\n        \n        try {\n          const response = await roleApi.delete(roleId);\n          console.log('API-Antwort beim Lschen der Rolle:', response);\n          \n          // Nach erfolgreichem Lschen die Rollenliste aktualisieren\n          await fetchRoles();\n          console.log('Rollenliste nach Lschen aktualisiert');\n        } catch (deleteError) {\n          console.error('API-Fehler beim Lschen der Rolle:', deleteError);\n          \n          if (deleteError.response) {\n            console.error('API-Fehlerdaten:', deleteError.response.data);\n            \n            // Spezifischere Fehlerbehandlung\n            if (deleteError.response.data.meta && deleteError.response.data.meta.cause === \"Record to delete does not exist.\") {\n              handleError('Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.', {\n                component: 'RoleManagementTab',\n                roleId: roleId\n              });\n              // Rollenliste aktualisieren, um Frontend zu synchronisieren\n              await fetchRoles();\n            } else {\n              handleError(deleteError.response.data.message || t('roleManagement.deleteError'), {\n                component: 'RoleManagementTab',\n                roleId: roleId\n              });\n            }\n          } else {\n            handleError(t('roleManagement.networkError'), {\n              component: 'RoleManagementTab',\n              roleId: roleId\n            });\n          }\n          return;\n        }\n      }\n      \n      console.log('Rolle erfolgreich gelscht');\n      if (onRolesChange) onRolesChange();\n    } catch (err) {\n      console.error(t('roleManagement.unhandledError'), err);\n      handleError(err);\n      \n      // Bei einem unbehandelten Fehler trotzdem versuchen, die Rollenliste zu aktualisieren\n      try {\n        await fetchRoles();\n      } catch (refreshError) {\n        console.error('Fehler beim Aktualisieren der Rollenliste nach fehlgeschlagenem Lschvorgang:', refreshError);\n      }\n    }\n  };\n\n  // Kopieren einer Rolle (fr Standardrollen)\n  const handleCopyRole = async (role: Role) => {\n    try {\n      if (!role || !role.id) {\n        handleError('Ungltige Rolle zum Kopieren', {\n          component: 'RoleManagementTab'\n        });\n        return;\n      }\n\n      // Kopie der Rolle erstellen mit angepasstem Namen\n      const copiedRoleData = {\n        name: `${role.name}-Kopie`,\n        description: role.description || '',\n        permissions: role.permissions\n          .filter(permission => permission.accessLevel !== 'none')\n          .map(permission => ({\n            entity: permission.entity,\n            entityType: permission.entityType,\n            accessLevel: permission.accessLevel\n          }))\n      };\n\n      console.log('DEBUGAUSGABE: Kopiere Rolle:', role.name, 'mit Daten:', copiedRoleData);\n\n      // Rolle erstellen\n      const response = await roleApi.create(copiedRoleData);\n      console.log('DEBUGAUSGABE: Rolle erfolgreich kopiert:', response.data);\n\n      // Optimistisches Update: Neue Rolle zur Liste hinzufgen\n      setRoles(prevRoles => [response.data, ...prevRoles]);\n      \n      // Bearbeitungsmodal fr die kopierte Rolle ffnen\n      prepareRoleForEditing(response.data);\n      \n      if (onRolesChange) onRolesChange();\n    } catch (err) {\n      console.error('DEBUGAUSGABE: Fehler beim Kopieren der Rolle:', err);\n      handleError(err, {\n        component: 'RoleManagementTab',\n        roleId: role.id\n      });\n    }\n  };\n\n  // Rolle zum Bearbeiten vorbereiten\n  const prepareRoleForEditing = (role: Role) => {\n    // Verhindere das Bearbeiten von geschtzten Rollen\n    if (isStandardRole(role.id, role.name)) {\n      handleError('Geschtzte Systemrollen knnen nicht bearbeitet werden', {\n        component: 'RoleManagementTab',\n        roleId: role.id\n      });\n      return;\n    }\n    \n    // Alle mglichen Berechtigungen erstellen (Seiten, Tabellen und Buttons)\n    const allPermissions = [\n      ...defaultPages.map(page => ({\n        entity: page,\n        entityType: 'page',\n        // Fr die immer sichtbaren Seiten 'both' als Standard setzen\n        accessLevel: alwaysVisiblePages.includes(page) ? 'both' as AccessLevel : 'none' as AccessLevel\n      })),\n      ...defaultTables.map(table => ({\n        entity: table,\n        entityType: 'table',\n        accessLevel: 'none' as AccessLevel\n      })),\n      ...defaultButtons.map(button => ({\n        entity: button,\n        entityType: 'button',\n        accessLevel: 'none' as AccessLevel\n      }))\n    ];\n\n    // Vorhandene Berechtigungen bernehmen\n    role.permissions.forEach(permission => {\n      const existingPermIndex = allPermissions.findIndex(\n        p => p.entity === permission.entity && p.entityType === permission.entityType\n      );\n      \n      if (existingPermIndex !== -1) {\n        // Stelle sicher, dass alwaysVisiblePages immer 'both' als AccessLevel haben\n        if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n          allPermissions[existingPermIndex].accessLevel = 'both';\n        } else {\n          allPermissions[existingPermIndex].accessLevel = permission.accessLevel;\n        }\n      }\n    });\n\n    setFormData({\n      name: role.name,\n      description: role.description || '',\n      permissions: allPermissions\n    });\n    \n    setEditingRole(role);\n    setIsModalOpen(true);\n  };\n\n  // Formular fr neue Rolle zurcksetzen\n  const resetForm = () => {\n    setEditingRole(null);\n    setFormData({\n      name: '',\n      description: '',\n      permissions: [\n        // Seiten-Berechtigungen\n        ...defaultPages.map(page => ({\n          entity: page,\n          entityType: 'page',\n          // Fr die immer sichtbaren Seiten 'both' als Standard setzen\n          accessLevel: alwaysVisiblePages.includes(page) ? 'both' as AccessLevel : 'none' as AccessLevel\n        })),\n        // Tabellen-Berechtigungen\n        ...defaultTables.map(table => ({\n          entity: table,\n          entityType: 'table',\n          accessLevel: 'none' as AccessLevel\n        })),\n        // Button-Berechtigungen\n        ...defaultButtons.map(button => ({\n          entity: button,\n          entityType: 'button',\n          accessLevel: 'none' as AccessLevel\n        }))\n      ]\n    });\n  };\n\n  // Setzt alle Seitenberechtigungen (auer die immer sichtbaren) auf den gleichen Wert\n  const setAllPagePermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'page' && !alwaysVisiblePages.includes(p.entity))\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Setzt alle Tabellen-Berechtigungen auf den gleichen Wert\n  const setAllTablePermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'table')\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Setzt alle Button-Berechtigungen auf den gleichen Wert\n  const setAllButtonPermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'button')\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Funktion zum Zhlen der aktiven Filter\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  // Filtern und sortieren der Rollen\n  const filteredAndSortedRoles = useMemo(() => {\n    return roles\n      .filter(role => {\n        // Globale Suche\n        if (searchTerm) {\n          const searchLower = searchTerm.toLowerCase();\n          const matchesSearch = \n            role.name.toLowerCase().includes(searchLower) ||\n            (role.description && role.description.toLowerCase().includes(searchLower));\n          \n          if (!matchesSearch) return false;\n        }\n        \n        // Prfe erweiterte Filterbedingungen, wenn vorhanden\n        if (filterConditions.length > 0) {\n          // Implementiere die logische Verknpfung der Bedingungen (UND/ODER)\n          let result = filterConditions.length > 0;\n          \n          for (let i = 0; i < filterConditions.length; i++) {\n            const condition = filterConditions[i];\n            let conditionMet = false;\n            \n            switch (condition.column) {\n              case 'name':\n                if (condition.operator === 'equals') {\n                  conditionMet = role.name.toLowerCase() === (condition.value as string || '').toLowerCase();\n                } else if (condition.operator === 'contains') {\n                  conditionMet = role.name.toLowerCase().includes((condition.value as string || '').toLowerCase());\n                } else if (condition.operator === 'startsWith') {\n                  conditionMet = role.name.toLowerCase().startsWith((condition.value as string || '').toLowerCase());\n                }\n                break;\n              \n              case 'description':\n                if (!role.description) {\n                  conditionMet = false;\n                  break;\n                }\n                \n                if (condition.operator === 'equals') {\n                  conditionMet = role.description.toLowerCase() === (condition.value as string || '').toLowerCase();\n                } else if (condition.operator === 'contains') {\n                  conditionMet = role.description.toLowerCase().includes((condition.value as string || '').toLowerCase());\n                } else if (condition.operator === 'startsWith') {\n                  conditionMet = role.description.toLowerCase().startsWith((condition.value as string || '').toLowerCase());\n                }\n                break;\n              \n              case 'permissions':\n                // Vereinfachter Filter fr Berechtigungen - zhle die Anzahl der Berechtigungen mit dem angegebenen Level\n                const accessLevel = condition.value as AccessLevel;\n                const count = role.permissions.filter(p => p.accessLevel === accessLevel).length;\n                \n                if (condition.operator === 'greaterThan') {\n                  conditionMet = count > 0;\n                } else if (condition.operator === 'equals') {\n                  conditionMet = count > 0;\n                }\n                break;\n            }\n            \n            // Verknpfe das Ergebnis dieser Bedingung mit dem Gesamtergebnis\n            if (i === 0) {\n              result = conditionMet;\n            } else {\n              const operator = filterLogicalOperators[i - 1];\n              result = operator === 'AND' ? (result && conditionMet) : (result || conditionMet);\n            }\n          }\n          \n          if (!result) return false;\n        }\n        \n        return true;\n      })\n      .sort((a, b) => {\n        return a.name.localeCompare(b.name);\n      });\n  }, [roles, searchTerm, filterConditions, filterLogicalOperators]);\n\n  // Mobile Ansicht renderRoles-Funktion\n  const renderRoles = () => {\n    if (roles.length === 0) {\n      return (\n        <div className=\"p-4 bg-gray-50 rounded text-center\">\n          <p>Keine Rollen gefunden. Erstellen Sie eine neue Rolle mit dem Button oben.</p>\n        </div>\n      );\n    }\n    \n    if (isMobile) {\n      // Mobile Ansicht mit Karten\n      return (\n        <>\n          <div className=\"space-y-4\">\n            {filteredAndSortedRoles.slice(0, displayLimit).map((role) => (\n              <RoleCard \n                key={role.id} \n                role={role} \n                onEdit={prepareRoleForEditing}\n                onDelete={handleDelete}\n                onCopy={handleCopyRole}\n                canEdit={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canDelete={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canCopy={!readOnly && hasPermission('roles', 'write', 'table') && isStandardRole(role.id, role.name)}\n              />\n            ))}\n          </div>\n          \n          {/* \"Mehr anzeigen\" Button - Mobil */}\n          {filteredAndSortedRoles.length > displayLimit && (\n            <div className=\"mt-4 flex justify-center\">\n              <button\n                className=\"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                title={`Mehr anzeigen (${filteredAndSortedRoles.length - displayLimit} verbleibend)`}\n              >\n                <ChevronDownIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n          )}\n        </>\n      );\n    } else {\n      // Card-Ansicht fr grere Bildschirme\n      return (\n        <>\n          <div className=\"space-y-4\">\n            {filteredAndSortedRoles.slice(0, displayLimit).map((role) => (\n              <RoleCard \n                key={role.id} \n                role={role} \n                onEdit={prepareRoleForEditing}\n                onDelete={handleDelete}\n                onCopy={handleCopyRole}\n                canEdit={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canDelete={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canCopy={!readOnly && hasPermission('roles', 'write', 'table') && isStandardRole(role.id, role.name)}\n              />\n            ))}\n          </div>\n          \n          {/* \"Mehr anzeigen\" Button - Desktop */}\n          {filteredAndSortedRoles.length > displayLimit && (\n            <div className=\"mt-4 flex justify-center\">\n              <button\n                className=\"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                title={`Mehr anzeigen (${filteredAndSortedRoles.length - displayLimit} verbleibend)`}\n              >\n                <ChevronDownIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n          )}\n        </>\n      );\n    }\n  };\n\n  // Standard-Filter erstellen und speichern\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(ROLES_TABLE_ID)\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        const alleFilterExists = existingFilters.some(filter => filter.name === 'Alle');\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: ROLES_TABLE_ID,\n            name: 'Alle',\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\n            alleFilter\n          );\n          console.log('Alle-Filter fr Rollen erstellt');\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []);\n\n  // Initialer Default-Filter setzen (Controlled Mode)\n  useEffect(() => {\n    const setInitialFilter = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(ROLES_TABLE_ID));\n        const filters = response.data;\n        \n        const alleFilter = filters.find((filter: any) => filter.name === 'Alle');\n        if (alleFilter) {\n          setActiveFilterName('Alle');\n          setSelectedFilterId(alleFilter.id);\n          applyFilterConditions(alleFilter.conditions, alleFilter.operators);\n        }\n      } catch (error) {\n        console.error('Fehler beim Setzen des initialen Filters:', error);\n      }\n    };\n\n    setInitialFilter();\n  }, []);\n\n  // Funktion zum Anwenden von Filterbedingungen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n  \n  // Funktion zum Zurcksetzen der Filter\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n  \n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  return (\n    <div>\n      {/* Spaltenanzeige und Suche */}\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          {/* Linke Seite: \"Neue Rolle erstellen\"-Button */}\n          <div className=\"flex items-center\">\n            {!readOnly && hasPermission('roles', 'write', 'table') && (\n              <button\n                onClick={() => setIsModalOpen(true)}\n                className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                style={{ width: '30.19px', height: '30.19px' }}\n                title={t('roles.createRole')}\n                aria-label={t('roles.createRole')}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n              </button>\n            )}\n          </div>\n          \n          {/* Mitte: Titel - Kein Titel in der Mitte notwendig bei dieser Komponente, da der Tab-Header bereits den Titel zeigt */}\n          <div></div>\n          \n          {/* Rechte Seite: Suchfeld, Filter-Button, Spalten-Konfiguration */}\n          <div className=\"flex items-center gap-1.5\">\n            <input\n              type=\"text\"\n              placeholder=\"Suchen...\"\n              className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n            <button\n              className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100'} ml-1 relative`}\n              onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n              title=\"Filter\"\n            >\n              <FunnelIcon className=\"w-5 h-5\" />\n              {getActiveFilterCount() > 0 && (\n                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                  {getActiveFilterCount()}\n                </span>\n              )}\n            </button>\n          </div>\n        </div>\n\n        {/* Filter-Modal */}\n        {isFilterModalOpen && (\n          <FilterPane\n            columns={[\n              { id: 'name', label: 'Name' },\n              { id: 'description', label: 'Beschreibung' },\n              { id: 'permissions', label: 'Berechtigungen' }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={ROLES_TABLE_ID}\n          />\n        )}\n        \n        {/* Gespeicherte Filter als Tags anzeigen */}\n        <SavedFilterTags\n          tableId={ROLES_TABLE_ID}\n          onSelectFilter={applyFilterConditions}\n          onReset={resetFilterConditions}\n          activeFilterName={activeFilterName}\n          selectedFilterId={selectedFilterId}\n          onFilterChange={handleFilterChange}\n          defaultFilterName=\"Alle\"\n        />\n\n        {loading ? (\n          <div className=\"flex justify-center items-center py-8\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n          </div>\n        ) : (\n          renderRoles()\n        )}\n      </div>\n\n      {/* Modal/Sidepane fr Rollenerstellung/Bearbeitung */}\n      {isModalOpen && (\n        <>\n          {/* Mobile (unter 640px) - Modal */}\n          {isMobile ? (\n            <Dialog open={isModalOpen} onClose={() => setIsModalOpen(false)} className=\"relative z-50\">\n              <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n              \n              <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden\">\n                  {/* Header */}\n                  <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <div className=\"flex items-center justify-between\">\n                      <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                        {editingRole ? t('roles.editRole') : t('roles.createRole')}\n                      </Dialog.Title>\n                      <button\n                        onClick={() => setIsModalOpen(false)}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                      >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                      </button>\n                    </div>\n                  </div>\n                  \n                  {/* Form */}\n                  <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\n                    {/* Content - scrollbarer Bereich */}\n                    <div className=\"flex-1 overflow-y-auto min-h-0\">\n                      <div className=\"p-6 space-y-5\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Name</label>\n                  <input\n                    type=\"text\"\n                    value={formData.name}\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    required\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Beschreibung</label>\n                  <input\n                    type=\"text\"\n                    value={formData.description}\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n                  </div>\n                  \n                  <div className=\"mt-2\">\n                    <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.detailedPermissions')}</label>\n                        {/* Bulk Actions - kompakt integriert */}\n                        <div className=\"flex flex-wrap items-center gap-1.5\">\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllPagePermissions('both')}\n                            className=\"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800\"\n                            title={t('roles.form.activateAllPages')}\n                          >\n                            {t('roles.form.pagesChecked')}\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllPagePermissions('none')}\n                            className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            title={t('roles.form.deactivateAllPages')}\n                          >\n                            {t('roles.form.pagesUnchecked')}\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllTablePermissions('both')}\n                            className=\"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800\"\n                            title={t('roles.form.activateAllTables')}\n                          >\n                            {t('roles.form.tablesChecked')}\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllTablePermissions('none')}\n                            className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            title={t('roles.form.deactivateAllTables')}\n                          >\n                            {t('roles.form.tablesUnchecked')}\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllButtonPermissions('both')}\n                            className=\"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800\"\n                            title={t('roles.form.activateAllButtons')}\n                          >\n                            {t('roles.form.buttonsChecked')}\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllButtonPermissions('none')}\n                            className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            title={t('roles.form.deactivateAllButtons')}\n                          >\n                            {t('roles.form.buttonsUnchecked')}\n                          </button>\n                        </div>\n                    </div>\n                    \n                    <div className=\"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600\">\n                    {formData.permissions\n                      .filter(permission => \n                        permission.entityType === 'page'\n                      )\n                      .map((permission, index) => {\n                        const permIndex = formData.permissions.indexOf(permission);\n                        const isActive = permission.accessLevel === 'both';\n                        return (\n                          <div key={`permission-page-${permission.entity}-${index}`}>\n                            <div className=\"flex items-center justify-between\">\n                              <span className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">{pageDisplayNames[permission.entity] || permission.entity}</span>\n                              <label className={`inline-flex items-center ${alwaysVisiblePages.includes(permission.entity) ? 'cursor-not-allowed opacity-80' : 'cursor-pointer'}`}>\n                                <input\n                                  type=\"checkbox\"\n                                  className=\"sr-only peer\"\n                                  checked={isActive}\n                                  disabled={alwaysVisiblePages.includes(permission.entity)}\n                                  onChange={() => {\n                                    const newPermissions = [...formData.permissions];\n                                    newPermissions[permIndex] = {\n                                      ...permission,\n                                      accessLevel: isActive ? 'none' : 'both'\n                                    };\n                                    setFormData({ ...formData, permissions: newPermissions });\n                                  }}\n                                />\n                                <div className={`relative w-11 h-6 ${alwaysVisiblePages.includes(permission.entity) ? 'bg-blue-600 dark:bg-blue-700' : 'bg-gray-200 dark:bg-gray-700'} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700`}>\n                                  {alwaysVisiblePages.includes(permission.entity) && (\n                                    <span className=\"absolute inset-0 flex items-center justify-center text-xs text-white font-medium\">\n                                      Fix\n                                    </span>\n                                  )}\n                                </div>\n                              </label>\n                            </div>\n                            \n                            {/* Tabellen-Berechtigungen mit zugehrigen Buttons gruppiert */}\n                            {formData.permissions\n                              .filter(tablePerm => \n                                tablePerm.entityType === 'table' && \n                                tableToPageMapping[tablePerm.entity] === permission.entity\n                              )\n                              .sort((a, b) => {\n                                const aName = tableDisplayNames[a.entity] || a.entity;\n                                const bName = tableDisplayNames[b.entity] || b.entity;\n                                // Sortierung: users, roles, organization zuerst (in dieser Reihenfolge)\n                                const priorityOrder = ['users', 'roles', 'organization'];\n                                const aIndex = priorityOrder.indexOf(a.entity);\n                                const bIndex = priorityOrder.indexOf(b.entity);\n                                if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                if (aIndex !== -1) return -1;\n                                if (bIndex !== -1) return 1;\n                                return aName.localeCompare(bName);\n                              })\n                              .map((tablePerm, tableIndex) => {\n                                const tablePermIndex = formData.permissions.indexOf(tablePerm);\n                                const isTableActive = tablePerm.accessLevel === 'both';\n                                const tableEntity = tablePerm.entity;\n                                const tableDisplayName = tableDisplayNames[tableEntity] || tableEntity;\n                                \n                                // Finde alle Buttons, die zu dieser Tabelle gehren\n                                // Filtere Duplikate: task_* und todo_* sind dasselbe, nur task_* behalten\n                                const relatedButtons = formData.permissions\n                                  .filter(buttonPerm => \n                                    buttonPerm.entityType === 'button' && \n                                    buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                    buttonToTableMapping[buttonPerm.entity] === tableEntity &&\n                                    // Entferne todo_* Buttons wenn task_* existiert (sind dasselbe)\n                                    !(tableEntity === 'tasks' && buttonPerm.entity.startsWith('todo_'))\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = buttonDisplayNames[a.entity] || a.entity;\n                                    const bName = buttonDisplayNames[b.entity] || b.entity;\n                                    // Logische Reihenfolge: Start, Stop, Erstellen, Bearbeiten, Lschen, dann alphabetisch\n                                    const order = [\n                                      t('roleManagement.buttonOrder.start'),\n                                      t('roleManagement.buttonOrder.stop'),\n                                      t('roleManagement.buttonOrder.create'),\n                                      t('roleManagement.buttonOrder.edit'),\n                                      t('roleManagement.buttonOrder.delete')\n                                    ];\n                                    const aIndex = order.indexOf(aName);\n                                    const bIndex = order.indexOf(bName);\n                                    if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                    if (aIndex !== -1) return -1;\n                                    if (bIndex !== -1) return 1;\n                                    return aName.localeCompare(bName);\n                                  });\n                                \n                                return (\n                                  <div key={`table-permission-${tableEntity}-${tableIndex}`} className=\"mt-3\">\n                                    {/* Tabelle selbst */}\n                                    <div className=\"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600\">\n                                      <span className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\"> {tableDisplayName}</span>\n                                      <label className=\"inline-flex items-center cursor-pointer\">\n                                        <input\n                                          type=\"checkbox\"\n                                          className=\"sr-only peer\"\n                                          checked={isTableActive}\n                                          onChange={() => {\n                                            const newPermissions = [...formData.permissions];\n                                            newPermissions[tablePermIndex] = {\n                                              ...tablePerm,\n                                              accessLevel: isTableActive ? 'none' : 'both'\n                                            };\n                                            setFormData({ ...formData, permissions: newPermissions });\n                                          }}\n                                        />\n                                        <div className=\"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                        </div>\n                                      </label>\n                                    </div>\n                                    \n                                    {/* Zu dieser Tabelle gehrige Buttons */}\n                                    {relatedButtons.map((buttonPerm, buttonIndex) => {\n                                      const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                      const isButtonActive = buttonPerm.accessLevel === 'both';\n                                      const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                      return (\n                                        <div key={`button-permission-${buttonPerm.entity}-${buttonIndex}`} \n                                          className=\"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600\">\n                                          <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                          <label className=\"inline-flex items-center cursor-pointer\">\n                                            <input\n                                              type=\"checkbox\"\n                                              className=\"sr-only peer\"\n                                              checked={isButtonActive}\n                                              onChange={() => {\n                                                const newPermissions = [...formData.permissions];\n                                                newPermissions[buttonPermIndex] = {\n                                                  ...buttonPerm,\n                                                  accessLevel: isButtonActive ? 'none' : 'both'\n                                                };\n                                                setFormData({ ...formData, permissions: newPermissions });\n                                              }}\n                                            />\n                                            <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                            </div>\n                                          </label>\n                                        </div>\n                                      );\n                                    })}\n                                  </div>\n                                );\n                              })\n                            }\n                              \n                              {/* Button-Berechtigungen ohne Tabelle-Zuordnung (am Ende) */}\n                              {formData.permissions\n                                .filter(buttonPerm => \n                                  buttonPerm.entityType === 'button' && \n                                  buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                  !buttonToTableMapping[buttonPerm.entity]\n                                )\n                                .sort((a, b) => {\n                                  const aName = buttonDisplayNames[a.entity] || a.entity;\n                                  const bName = buttonDisplayNames[b.entity] || b.entity;\n                                  return aName.localeCompare(bName);\n                                })\n                                .map((buttonPerm, buttonIndex) => {\n                                  const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                  const isButtonActive = buttonPerm.accessLevel === 'both';\n                                  const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                  return (\n                                    <div key={`button-permission-${buttonPerm.entity}-${buttonIndex}`} \n                                      className=\"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600\">\n                                      <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                      <label className=\"inline-flex items-center cursor-pointer\">\n                                        <input\n                                          type=\"checkbox\"\n                                          className=\"sr-only peer\"\n                                          checked={isButtonActive}\n                                          onChange={() => {\n                                            const newPermissions = [...formData.permissions];\n                                            newPermissions[buttonPermIndex] = {\n                                              ...buttonPerm,\n                                              accessLevel: isButtonActive ? 'none' : 'both'\n                                            };\n                                            setFormData({ ...formData, permissions: newPermissions });\n                                          }}\n                                        />\n                                        <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                        </div>\n                                      </label>\n                          </div>\n                        );\n                      })\n                    }\n                            </div>\n                          );\n                        })\n                      }\n                    </div>\n                  </div>\n                    </div>\n                  </div>\n                  \n                  {/* Footer */}\n                  <div className=\"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-end gap-2 border-t dark:border-gray-600 flex-shrink-0\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setIsModalOpen(false)}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                      title=\"Abbrechen\"\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      type=\"submit\"\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                      title={editingRole ? 'Aktualisieren' : 'Erstellen'}\n                    >\n                      <CheckIcon className=\"h-5 w-5\" />\n                    </button>\n                  </div>\n                </form>\n              </Dialog.Panel>\n            </div>\n          </Dialog>\n          ) : (\n            /* Desktop (ab 640px) - Sidepane */\n            /* WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition */\n            <>\n              {/* Backdrop - nur wenn offen und <= 1070px */}\n              {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n              {isModalOpen && !isLargeScreen && (\n                <div \n                  className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                  aria-hidden=\"true\" \n                  style={{\n                    opacity: isModalOpen ? 1 : 0,\n                    transition: 'opacity 300ms ease-out'\n                  }}\n                />\n              )}\n              \n              {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n              <div \n                className={`fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isModalOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                  transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                  pointerEvents: isModalOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isModalOpen}\n                role=\"dialog\"\n                aria-modal={isModalOpen}\n              >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                  <h2 className=\"text-lg font-semibold dark:text-white\">\n                    {editingRole ? 'Rolle bearbeiten' : 'Neue Rolle erstellen'}\n                  </h2>\n                  <button\n                    onClick={() => setIsModalOpen(false)}\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                  <form onSubmit={handleSubmit} className=\"space-y-5\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.name')}</label>\n                        <input\n                          type=\"text\"\n                          value={formData.name}\n                          onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                          className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.description')}</label>\n                        <input\n                          type=\"text\"\n                          value={formData.description}\n                          onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                          className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                        />\n                      </div>\n                    </div>\n                    \n                    <div className=\"mt-2\">\n                      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Detaillierte Berechtigungen</label>\n                        {/* Bulk Actions */}\n                        <div className=\"flex flex-wrap items-center gap-1.5\">\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllPagePermissions('both')}\n                            className=\"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800\"\n                            title=\"Alle Seiten aktivieren\"\n                          >\n                            Seiten \n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllPagePermissions('none')}\n                            className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            title=\"Alle Seiten deaktivieren\"\n                          >\n                            Seiten \n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllTablePermissions('both')}\n                            className=\"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800\"\n                            title=\"Alle Tabellen aktivieren\"\n                          >\n                            Tabellen \n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllTablePermissions('none')}\n                            className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            title=\"Alle Tabellen deaktivieren\"\n                          >\n                            Tabellen \n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllButtonPermissions('both')}\n                            className=\"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800\"\n                            title=\"Alle Buttons aktivieren\"\n                          >\n                            Buttons \n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllButtonPermissions('none')}\n                            className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            title=\"Alle Buttons deaktivieren\"\n                          >\n                            Buttons \n                          </button>\n                        </div>\n                      </div>\n                      \n                      <div className=\"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600 max-h-[60vh]\">\n                        {formData.permissions\n                          .filter(permission => \n                            permission.entityType === 'page'\n                          )\n                          .map((permission, index) => {\n                            const permIndex = formData.permissions.indexOf(permission);\n                            const isActive = permission.accessLevel === 'both';\n                            return (\n                              <div key={`permission-page-desktop-${permission.entity}-${index}`}>\n                                <div className=\"flex items-center justify-between\">\n                                  <span className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">{pageDisplayNames[permission.entity] || permission.entity}</span>\n                                  <label className={`inline-flex items-center ${alwaysVisiblePages.includes(permission.entity) ? 'cursor-not-allowed opacity-80' : 'cursor-pointer'}`}>\n                                    <input\n                                      type=\"checkbox\"\n                                      className=\"sr-only peer\"\n                                      checked={isActive}\n                                      disabled={alwaysVisiblePages.includes(permission.entity)}\n                                      onChange={() => {\n                                        const newPermissions = [...formData.permissions];\n                                        newPermissions[permIndex] = {\n                                          ...permission,\n                                          accessLevel: isActive ? 'none' : 'both'\n                                        };\n                                        setFormData({ ...formData, permissions: newPermissions });\n                                      }}\n                                    />\n                                    <div className={`relative w-11 h-6 ${alwaysVisiblePages.includes(permission.entity) ? 'bg-blue-600 dark:bg-blue-700' : 'bg-gray-200 dark:bg-gray-700'} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700`}>\n                                      {alwaysVisiblePages.includes(permission.entity) && (\n                                        <span className=\"absolute inset-0 flex items-center justify-center text-xs text-white font-medium\">\n                                          Fix\n                                        </span>\n                                      )}\n                                    </div>\n                                  </label>\n                                </div>\n                                \n                                {/* Tabellen-Berechtigungen mit zugehrigen Buttons gruppiert */}\n                                {formData.permissions\n                                  .filter(tablePerm => \n                                    tablePerm.entityType === 'table' && \n                                    tableToPageMapping[tablePerm.entity] === permission.entity\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = tableDisplayNames[a.entity] || a.entity;\n                                    const bName = tableDisplayNames[b.entity] || b.entity;\n                                    return aName.localeCompare(bName);\n                                  })\n                                  .map((tablePerm, tableIndex) => {\n                                    const tablePermIndex = formData.permissions.indexOf(tablePerm);\n                                    const isTableActive = tablePerm.accessLevel === 'both';\n                                    const tableEntity = tablePerm.entity;\n                                    const tableDisplayName = tableDisplayNames[tableEntity] || tableEntity;\n                                    \n                                    // Finde alle Buttons, die zu dieser Tabelle gehren\n                                    const relatedButtons = formData.permissions\n                                      .filter(buttonPerm => \n                                        buttonPerm.entityType === 'button' && \n                                        buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                        buttonToTableMapping[buttonPerm.entity] === tableEntity &&\n                                        !(tableEntity === 'tasks' && buttonPerm.entity.startsWith('todo_'))\n                                      )\n                                      .sort((a, b) => {\n                                        const aName = buttonDisplayNames[a.entity] || a.entity;\n                                        const bName = buttonDisplayNames[b.entity] || b.entity;\n                                        const order = [\n                                      t('roleManagement.buttonOrder.start'),\n                                      t('roleManagement.buttonOrder.stop'),\n                                      t('roleManagement.buttonOrder.create'),\n                                      t('roleManagement.buttonOrder.edit'),\n                                      t('roleManagement.buttonOrder.delete')\n                                    ];\n                                        const aIndex = order.indexOf(aName);\n                                        const bIndex = order.indexOf(bName);\n                                        if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                        if (aIndex !== -1) return -1;\n                                        if (bIndex !== -1) return 1;\n                                        return aName.localeCompare(bName);\n                                      });\n                                    \n                                    return (\n                                      <div key={`table-permission-desktop-${tableEntity}-${tableIndex}`} className=\"mt-3\">\n                                        {/* Tabelle selbst */}\n                                        <div className=\"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600\">\n                                          <span className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\"> {tableDisplayName}</span>\n                                          <label className=\"inline-flex items-center cursor-pointer\">\n                                            <input\n                                              type=\"checkbox\"\n                                              className=\"sr-only peer\"\n                                              checked={isTableActive}\n                                              onChange={() => {\n                                                const newPermissions = [...formData.permissions];\n                                                newPermissions[tablePermIndex] = {\n                                                  ...tablePerm,\n                                                  accessLevel: isTableActive ? 'none' : 'both'\n                                                };\n                                                setFormData({ ...formData, permissions: newPermissions });\n                                              }}\n                                            />\n                                            <div className=\"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                            </div>\n                                          </label>\n                                        </div>\n                                        \n                                        {/* Zu dieser Tabelle gehrige Buttons */}\n                                        {relatedButtons.map((buttonPerm, buttonIndex) => {\n                                          const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                          const isButtonActive = buttonPerm.accessLevel === 'both';\n                                          const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                          return (\n                                            <div key={`button-permission-desktop-${buttonPerm.entity}-${buttonIndex}`} \n                                              className=\"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600\">\n                                              <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                              <label className=\"inline-flex items-center cursor-pointer\">\n                                                <input\n                                                  type=\"checkbox\"\n                                                  className=\"sr-only peer\"\n                                                  checked={isButtonActive}\n                                                  onChange={() => {\n                                                    const newPermissions = [...formData.permissions];\n                                                    newPermissions[buttonPermIndex] = {\n                                                      ...buttonPerm,\n                                                      accessLevel: isButtonActive ? 'none' : 'both'\n                                                    };\n                                                    setFormData({ ...formData, permissions: newPermissions });\n                                                  }}\n                                                />\n                                                <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                                </div>\n                                              </label>\n                                            </div>\n                                          );\n                                        })}\n                                      </div>\n                                    );\n                                  })\n                                }\n                                  \n                                {/* Button-Berechtigungen ohne Tabelle-Zuordnung (am Ende) */}\n                                {formData.permissions\n                                  .filter(buttonPerm => \n                                    buttonPerm.entityType === 'button' && \n                                    buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                    !buttonToTableMapping[buttonPerm.entity]\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = buttonDisplayNames[a.entity] || a.entity;\n                                    const bName = buttonDisplayNames[b.entity] || b.entity;\n                                    return aName.localeCompare(bName);\n                                  })\n                                  .map((buttonPerm, buttonIndex) => {\n                                    const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                    const isButtonActive = buttonPerm.accessLevel === 'both';\n                                    const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                    return (\n                                      <div key={`button-permission-desktop-${buttonPerm.entity}-${buttonIndex}`} \n                                        className=\"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600\">\n                                        <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                        <label className=\"inline-flex items-center cursor-pointer\">\n                                          <input\n                                            type=\"checkbox\"\n                                            className=\"sr-only peer\"\n                                            checked={isButtonActive}\n                                            onChange={() => {\n                                              const newPermissions = [...formData.permissions];\n                                              newPermissions[buttonPermIndex] = {\n                                                ...buttonPerm,\n                                                accessLevel: isButtonActive ? 'none' : 'both'\n                                              };\n                                              setFormData({ ...formData, permissions: newPermissions });\n                                            }}\n                                          />\n                                          <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                          </div>\n                                        </label>\n                                      </div>\n                                    );\n                                  })\n                                }\n                              </div>\n                            );\n                          })\n                        }\n                      </div>\n                    </div>\n\n                    {/* Buttons */}\n                    <div className=\"flex justify-end pt-4 gap-2\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setIsModalOpen(false)}\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                        title=\"Abbrechen\"\n                      >\n                        <XMarkIcon className=\"h-5 w-5\" />\n                      </button>\n                      <button\n                        type=\"submit\"\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                        title={editingRole ? 'Aktualisieren' : 'Erstellen'}\n                      >\n                        <CheckIcon className=\"h-5 w-5\" />\n                      </button>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default RoleManagementTab; ","import React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { PencilIcon, TrashIcon, PlusIcon, XMarkIcon, CheckIcon, FunnelIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { usePermissions } from '../hooks/usePermissions.ts';\r\nimport FilterPane from '../components/FilterPane.tsx';\r\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\r\nimport { FilterCondition } from '../components/FilterRow.tsx';\r\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\r\n\r\ninterface Branch {\r\n    id: number;\r\n    name: string;\r\n}\r\n\r\ninterface BranchManagementTabProps {\r\n    onError: (error: string) => void;\r\n}\r\n\r\n// BranchCard-Komponente fr mobile und Desktop-Ansicht\r\nconst BranchCard: React.FC<{\r\n    branch: Branch;\r\n    onEdit: (branch: Branch) => void;\r\n    onDelete: (branchId: number) => void;\r\n    canEdit: boolean;\r\n    canDelete: boolean;\r\n}> = ({ branch, onEdit, onDelete, canEdit, canDelete }) => {\r\n    const { t } = useTranslation();\r\n    return (\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4 mb-4\">\r\n            {/* Header mit Branchname und Aktionen */}\r\n            <div className=\"flex justify-between items-start mb-2\">\r\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{branch.name}</h3>\r\n                \r\n                <div className=\"flex space-x-2\">\r\n                    {canEdit && (\r\n                        <button\r\n                            onClick={() => onEdit(branch)}\r\n                            className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\r\n                            title={t('common.edit', { defaultValue: 'Bearbeiten' })}\r\n                        >\r\n                            <PencilIcon className=\"h-5 w-5\" />\r\n                        </button>\r\n                    )}\r\n                    \r\n                    {canDelete && (\r\n                        <button\r\n                            onClick={() => onDelete(branch.id)}\r\n                            className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\r\n                            title={t('common.delete', { defaultValue: 'Lschen' })}\r\n                        >\r\n                            <TrashIcon className=\"h-5 w-5\" />\r\n                        </button>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// TableID fr gespeicherte Filter\r\nconst BRANCHES_TABLE_ID = 'branches-table';\r\n\r\nconst BranchManagementTab: React.FC<BranchManagementTabProps> = ({ onError }) => {\r\n    const { t } = useTranslation();\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n    const [editingBranch, setEditingBranch] = useState<Branch | null>(null);\r\n    const [branches, setBranches] = useState<Branch[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [formData, setFormData] = useState({ name: '' });\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\r\n    const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\r\n    const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\r\n    const [activeFilterName, setActiveFilterName] = useState<string>('');\r\n    const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\r\n    const [displayLimit, setDisplayLimit] = useState(10);\r\n    const { hasPermission } = usePermissions();\r\n    const { openSidepane, closeSidepane } = useSidepane();\r\n\r\n    // Berechtigungen prfen\r\n    const canCreate = hasPermission('branches', 'write', 'table');\r\n    const canEdit = hasPermission('branches', 'write', 'table');\r\n    const canDelete = hasPermission('branches', 'write', 'table');\r\n\r\n    // Branches laden\r\n    const fetchBranches = useCallback(async () => {\r\n        setLoading(true);\r\n        try {\r\n            const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\r\n            setBranches(response.data);\r\n        } catch (error: any) {\r\n            console.error('Fehler beim Laden der Niederlassungen:', error);\r\n            const errorMessage = error.response?.data?.message || t('branches.loadError');\r\n            onError(errorMessage);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [onError]);\r\n\r\n    useEffect(() => {\r\n        fetchBranches();\r\n    }, [fetchBranches]);\r\n\r\n    // Sidepane ffnen/schlieen basierend auf Modal-Status\r\n    useEffect(() => {\r\n        if (isModalOpen) {\r\n            openSidepane();\r\n        } else {\r\n            closeSidepane();\r\n        }\r\n        \r\n        return () => {\r\n            closeSidepane();\r\n        };\r\n    }, [isModalOpen, openSidepane, closeSidepane]);\r\n\r\n    // Formular zurcksetzen\r\n    const resetForm = () => {\r\n        setFormData({ name: '' });\r\n        setEditingBranch(null);\r\n    };\r\n\r\n    // Modal ffnen fr neue Branch\r\n    const handleCreate = () => {\r\n        resetForm();\r\n        setIsModalOpen(true);\r\n    };\r\n\r\n    // Modal ffnen fr Bearbeitung\r\n    const handleEdit = (branch: Branch) => {\r\n        setEditingBranch(branch);\r\n        setFormData({ name: branch.name });\r\n        setIsModalOpen(true);\r\n    };\r\n\r\n    // Modal schlieen\r\n    const handleCloseModal = () => {\r\n        setIsModalOpen(false);\r\n        resetForm();\r\n    };\r\n\r\n    // Formular absenden\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        \r\n        if (!formData.name.trim()) {\r\n            onError(t('branches.nameRequired'));\r\n            return;\r\n        }\r\n\r\n        try {\r\n            if (editingBranch) {\r\n                // Branch aktualisieren\r\n                await axiosInstance.put(API_ENDPOINTS.BRANCHES.UPDATE(editingBranch.id), {\r\n                    name: formData.name.trim()\r\n                });\r\n            } else {\r\n                // Neue Branch erstellen\r\n                await axiosInstance.post(API_ENDPOINTS.BRANCHES.CREATE, {\r\n                    name: formData.name.trim()\r\n                });\r\n            }\r\n            \r\n            await fetchBranches();\r\n            handleCloseModal();\r\n        } catch (error: any) {\r\n            console.error('Fehler beim Speichern der Niederlassung:', error);\r\n            const errorMessage = error.response?.data?.message || t('branches.saveError');\r\n            onError(errorMessage);\r\n        }\r\n    };\r\n\r\n    // Branch lschen\r\n    const handleDelete = async (branchId: number) => {\r\n        if (!window.confirm(t('branches.deleteConfirm', { defaultValue: 'Mchten Sie diese Niederlassung wirklich lschen?' }))) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            await axiosInstance.delete(API_ENDPOINTS.BRANCHES.DELETE(branchId));\r\n            await fetchBranches();\r\n        } catch (error: any) {\r\n            console.error('Fehler beim Lschen der Niederlassung:', error);\r\n            const errorMessage = error.response?.data?.message || t('branches.deleteError');\r\n            onError(errorMessage);\r\n        }\r\n    };\r\n\r\n    // Funktion zum Zhlen der aktiven Filter\r\n    const getActiveFilterCount = () => {\r\n        return filterConditions.length;\r\n    };\r\n\r\n    // Filtern und sortieren der Branches\r\n    const filteredAndSortedBranches = useMemo(() => {\r\n        return branches\r\n            .filter(branch => {\r\n                // Globale Suche\r\n                if (searchTerm) {\r\n                    const searchLower = searchTerm.toLowerCase();\r\n                    const matchesSearch = branch.name.toLowerCase().includes(searchLower);\r\n                    \r\n                    if (!matchesSearch) return false;\r\n                }\r\n                \r\n                // Prfe erweiterte Filterbedingungen, wenn vorhanden\r\n                if (filterConditions.length > 0) {\r\n                    let result = filterConditions.length > 0;\r\n                    \r\n                    for (let i = 0; i < filterConditions.length; i++) {\r\n                        const condition = filterConditions[i];\r\n                        let conditionMet = false;\r\n                        \r\n                        switch (condition.column) {\r\n                            case 'name':\r\n                                if (condition.operator === 'equals') {\r\n                                    conditionMet = branch.name.toLowerCase() === (condition.value as string || '').toLowerCase();\r\n                                } else if (condition.operator === 'contains') {\r\n                                    conditionMet = branch.name.toLowerCase().includes((condition.value as string || '').toLowerCase());\r\n                                } else if (condition.operator === 'startsWith') {\r\n                                    conditionMet = branch.name.toLowerCase().startsWith((condition.value as string || '').toLowerCase());\r\n                                }\r\n                                break;\r\n                        }\r\n                        \r\n                        // Verknpfe das Ergebnis dieser Bedingung mit dem Gesamtergebnis\r\n                        if (i === 0) {\r\n                            result = conditionMet;\r\n                        } else {\r\n                            const operator = filterLogicalOperators[i - 1];\r\n                            result = operator === 'AND' ? (result && conditionMet) : (result || conditionMet);\r\n                        }\r\n                    }\r\n                    \r\n                    if (!result) return false;\r\n                }\r\n                \r\n                return true;\r\n            })\r\n            .sort((a, b) => {\r\n                return a.name.localeCompare(b.name);\r\n            });\r\n    }, [branches, searchTerm, filterConditions, filterLogicalOperators]);\r\n\r\n    // Funktion zum Anwenden von Filterbedingungen\r\n    const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\r\n        setFilterConditions(conditions);\r\n        setFilterLogicalOperators(operators);\r\n    };\r\n    \r\n    // Funktion zum Zurcksetzen der Filter\r\n    const resetFilterConditions = () => {\r\n        setFilterConditions([]);\r\n        setFilterLogicalOperators([]);\r\n        setActiveFilterName('');\r\n        setSelectedFilterId(null);\r\n    };\r\n    \r\n    // Filter Change Handler (Controlled Mode)\r\n    const handleFilterChange = (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\r\n        setActiveFilterName(name);\r\n        setSelectedFilterId(id);\r\n        applyFilterConditions(conditions, operators);\r\n    };\r\n\r\n    // Standard-Filter erstellen und speichern\r\n    useEffect(() => {\r\n        const createStandardFilters = async () => {\r\n            try {\r\n                const token = localStorage.getItem('token');\r\n                \r\n                if (!token) {\r\n                    console.error(t('common.notAuthenticated'));\r\n                    return;\r\n                }\r\n\r\n                // Prfen, ob die Standard-Filter bereits existieren\r\n                const existingFiltersResponse = await axiosInstance.get(\r\n                    API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(BRANCHES_TABLE_ID)\r\n                );\r\n\r\n                const existingFilters = existingFiltersResponse.data || [];\r\n                const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\r\n\r\n                // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\r\n                if (!alleFilterExists) {\r\n                    const alleFilter = {\r\n                        tableId: BRANCHES_TABLE_ID,\r\n                        name: 'Alle',\r\n                        conditions: [],\r\n                        operators: []\r\n                    };\r\n\r\n                    await axiosInstance.post(\r\n                        API_ENDPOINTS.SAVED_FILTERS.BASE,\r\n                        alleFilter\r\n                    );\r\n                    console.log(t('branches.filterCreated'));\r\n                }\r\n            } catch (error) {\r\n                console.error(t('branches.createStandardFiltersError'), error);\r\n            }\r\n        };\r\n\r\n        createStandardFilters();\r\n    }, []);\r\n\r\n    // Initialer Default-Filter setzen (Controlled Mode)\r\n    useEffect(() => {\r\n        const setInitialFilter = async () => {\r\n            try {\r\n                const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(BRANCHES_TABLE_ID));\r\n                const filters = response.data;\r\n                \r\n                const alleFilter = filters.find((filter: any) => filter.name === 'Alle');\r\n                if (alleFilter) {\r\n                    setActiveFilterName('Alle');\r\n                    setSelectedFilterId(alleFilter.id);\r\n                    applyFilterConditions(alleFilter.conditions, alleFilter.operators);\r\n                }\r\n            } catch (error) {\r\n                console.error(t('branches.setInitialFilterError'), error);\r\n            }\r\n        };\r\n\r\n        setInitialFilter();\r\n    }, []);\r\n\r\n    // Branches rendern\r\n    const renderBranches = () => {\r\n        if (filteredAndSortedBranches.length === 0) {\r\n            return (\r\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded text-center\">\r\n                    <p className=\"text-gray-600 dark:text-gray-400\">\r\n                        {t('branches.noBranches', { defaultValue: 'Keine Niederlassungen gefunden. Erstellen Sie eine neue Niederlassung mit dem Button oben.' })}\r\n                    </p>\r\n                </div>\r\n            );\r\n        }\r\n        \r\n        // Card-Ansicht\r\n        return (\r\n            <>\r\n                <div className=\"space-y-4\">\r\n                    {filteredAndSortedBranches.slice(0, displayLimit).map((branch) => (\r\n                        <BranchCard \r\n                            key={branch.id} \r\n                            branch={branch} \r\n                            onEdit={handleEdit}\r\n                            onDelete={handleDelete}\r\n                            canEdit={canEdit}\r\n                            canDelete={canDelete}\r\n                        />\r\n                    ))}\r\n                </div>\r\n                \r\n                {/* \"Mehr anzeigen\" Button */}\r\n                {filteredAndSortedBranches.length > displayLimit && (\r\n                    <div className=\"mt-4 flex justify-center\">\r\n                        <button\r\n                            className=\"px-4 py-2 text-sm font-medium text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\r\n                            onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\r\n                        >\r\n                            {t('common.showMore', { defaultValue: 'Mehr anzeigen' })} ({filteredAndSortedBranches.length - displayLimit} {t('common.remaining', { defaultValue: 'verbleibend' })})\r\n                        </button>\r\n                    </div>\r\n                )}\r\n            </>\r\n        );\r\n    };\r\n\r\n    // Mobile-Erkennung\r\n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n    \r\n    useEffect(() => {\r\n        const handleResize = () => {\r\n            setIsMobile(window.innerWidth < 640);\r\n        };\r\n        window.addEventListener('resize', handleResize);\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []);\r\n\r\n    return (\r\n        <div>\r\n            {/* Spaltenanzeige und Suche */}\r\n            <div className=\"space-y-4\">\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                    {/* Linke Seite: \"Neue Niederlassung erstellen\"-Button */}\r\n                    <div className=\"flex items-center\">\r\n                        {canCreate && (\r\n                            <button\r\n                                onClick={handleCreate}\r\n                                className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\r\n                                style={{ width: '30.19px', height: '30.19px' }}\r\n                                title={t('branches.create', { defaultValue: 'Neue Niederlassung' })}\r\n                                aria-label={t('branches.create', { defaultValue: 'Neue Niederlassung' })}\r\n                            >\r\n                                <PlusIcon className=\"h-4 w-4\" />\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                    \r\n                    {/* Mitte: Titel - Kein Titel in der Mitte notwendig bei dieser Komponente, da der Tab-Header bereits den Titel zeigt */}\r\n                    <div></div>\r\n                    \r\n                    {/* Rechte Seite: Suchfeld, Filter-Button */}\r\n                    <div className=\"flex items-center gap-1.5\">\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\r\n                            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\r\n                            value={searchTerm}\r\n                            onChange={(e) => setSearchTerm(e.target.value)}\r\n                        />\r\n                        <button\r\n                            className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100'} ml-1 relative`}\r\n                            onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\r\n                            title={t('common.filter', { defaultValue: 'Filter' })}\r\n                        >\r\n                            <FunnelIcon className=\"w-5 h-5\" />\r\n                            {getActiveFilterCount() > 0 && (\r\n                                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\r\n                                    {getActiveFilterCount()}\r\n                                </span>\r\n                            )}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Filter-Modal */}\r\n                {isFilterModalOpen && (\r\n                    <FilterPane\r\n                        columns={[\r\n                            { id: 'name', label: t('branches.name', { defaultValue: 'Name' }) }\r\n                        ]}\r\n                        onApply={applyFilterConditions}\r\n                        onReset={resetFilterConditions}\r\n                        savedConditions={filterConditions}\r\n                        savedOperators={filterLogicalOperators}\r\n                        tableId={BRANCHES_TABLE_ID}\r\n                    />\r\n                )}\r\n                \r\n                {/* Gespeicherte Filter als Tags anzeigen */}\r\n                <SavedFilterTags\r\n                    tableId={BRANCHES_TABLE_ID}\r\n                    onSelectFilter={applyFilterConditions}\r\n                    onReset={resetFilterConditions}\r\n                    activeFilterName={activeFilterName}\r\n                    selectedFilterId={selectedFilterId}\r\n                    onFilterChange={handleFilterChange}\r\n                    defaultFilterName=\"Alle\"\r\n                />\r\n\r\n                {loading ? (\r\n                    <div className=\"flex justify-center items-center py-8\">\r\n                        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\r\n                    </div>\r\n                ) : (\r\n                    renderBranches()\r\n                )}\r\n            </div>\r\n\r\n            {/* Modal/Sidepane fr Branch-Erstellung/Bearbeitung */}\r\n            {isModalOpen && (\r\n                <>\r\n                    {/* Mobile (unter 640px) - Modal */}\r\n                    {isMobile ? (\r\n                        <Dialog open={isModalOpen} onClose={handleCloseModal} className=\"relative z-50\">\r\n                            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n                            \r\n                            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n                                <Dialog.Panel className=\"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n                                    {/* Header */}\r\n                                    <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n                                        <div className=\"flex items-center justify-between\">\r\n                                            <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                                                {editingBranch \r\n                                                    ? t('branches.edit', { defaultValue: 'Niederlassung bearbeiten' })\r\n                                                    : t('branches.create', { defaultValue: 'Neue Niederlassung' })\r\n                                                }\r\n                                            </Dialog.Title>\r\n                                            <button\r\n                                                onClick={handleCloseModal}\r\n                                                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                                            >\r\n                                                <XMarkIcon className=\"h-6 w-6\" />\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                    \r\n                                    {/* Form */}\r\n                                    <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\r\n                                        <div>\r\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                                {t('branches.name', { defaultValue: 'Name' })}\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={formData.name}\r\n                                                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\r\n                                                required\r\n                                                autoFocus\r\n                                            />\r\n                                        </div>\r\n\r\n                                        {/* Buttons */}\r\n                                        <div className=\"flex justify-end pt-4 gap-2\">\r\n                                            <button\r\n                                                type=\"button\"\r\n                                                onClick={handleCloseModal}\r\n                                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n                                                title={t('common.cancel', { defaultValue: 'Abbrechen' })}\r\n                                            >\r\n                                                <XMarkIcon className=\"h-5 w-5\" />\r\n                                            </button>\r\n                                            <button\r\n                                                type=\"submit\"\r\n                                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\r\n                                                title={editingBranch ? t('common.update', { defaultValue: 'Aktualisieren' }) : t('common.create', { defaultValue: 'Erstellen' })}\r\n                                            >\r\n                                                <CheckIcon className=\"h-5 w-5\" />\r\n                                            </button>\r\n                                        </div>\r\n                                    </form>\r\n                                </Dialog.Panel>\r\n                            </div>\r\n                        </Dialog>\r\n                    ) : (\r\n                        // Desktop - Sidepane\r\n                        <div className=\"fixed inset-y-0 right-0 w-full sm:w-96 bg-white dark:bg-gray-800 shadow-xl z-50 flex flex-col\">\r\n                            {/* Header */}\r\n                            <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <h2 className=\"text-lg font-semibold dark:text-white\">\r\n                                        {editingBranch \r\n                                            ? t('branches.edit', { defaultValue: 'Niederlassung bearbeiten' })\r\n                                            : t('branches.create', { defaultValue: 'Neue Niederlassung' })\r\n                                        }\r\n                                    </h2>\r\n                                    <button\r\n                                        onClick={handleCloseModal}\r\n                                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                                    >\r\n                                        <XMarkIcon className=\"h-6 w-6\" />\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            {/* Form */}\r\n                            <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\r\n                                <div className=\"flex-1 overflow-y-auto min-h-0\">\r\n                                    <div className=\"p-6 space-y-4\">\r\n                                        <div>\r\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                                {t('branches.name', { defaultValue: 'Name' })}\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={formData.name}\r\n                                                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\r\n                                                required\r\n                                                autoFocus\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Buttons */}\r\n                                <div className=\"flex justify-end pt-4 gap-2 px-6 pb-6 border-t dark:border-gray-700\">\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        onClick={handleCloseModal}\r\n                                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n                                        title={t('common.cancel') || 'Abbrechen'}\r\n                                    >\r\n                                        <XMarkIcon className=\"h-5 w-5\" />\r\n                                    </button>\r\n                                    <button\r\n                                        type=\"submit\"\r\n                                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\r\n                                        title={editingBranch ? t('common.update', { defaultValue: 'Aktualisieren' }) : t('common.create', { defaultValue: 'Erstellen' })}\r\n                                    >\r\n                                        <CheckIcon className=\"h-5 w-5\" />\r\n                                    </button>\r\n                                </div>\r\n                            </form>\r\n                        </div>\r\n                    )}\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BranchManagementTab;\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { CreateOrganizationRequest } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\nimport { useAuth } from '../../hooks/useAuth.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nconst CreateOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<CreateOrganizationRequest>({\n    name: '',\n    displayName: '',\n    domain: ''\n  });\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  const { fetchCurrentUser } = useAuth();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.name.trim()) {\n      newErrors.name = t('organization.create.nameRequired');\n    }\n    \n    if (!formData.displayName.trim()) {\n      newErrors.displayName = t('organization.create.displayNameRequired');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      await organizationService.createOrganization(formData);\n      setErrors({});\n      showMessage(t('organization.create.createSuccess'), 'success');\n      \n      // WICHTIG: User und Berechtigungen neu laden nach Erstellen der Organisation\n      // Der User wurde der Admin-Rolle zugeordnet und hat jetzt neue Berechtigungen\n      await fetchCurrentUser();\n      \n      // Formular zurcksetzen\n      setFormData({\n        name: '',\n        displayName: '',\n        domain: ''\n      });\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.create.createError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    setFormData({\n      name: '',\n      displayName: '',\n      domain: ''\n    });\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.create.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label \n                    htmlFor=\"name\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.name')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"name\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.name \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.name && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"displayName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.displayName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"displayName\"\n                    name=\"displayName\"\n                    value={formData.displayName}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.displayName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.displayName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"domain\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.domain')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"domain\"\n                    name=\"domain\"\n                    value={formData.domain}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.create.creating') : t('organization.create.createButton')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.create.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label \n                htmlFor=\"name\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.name')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.name \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.name && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"displayName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.displayName')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"displayName\"\n                name=\"displayName\"\n                value={formData.displayName}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.displayName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.displayName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"domain\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.domain')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"domain\"\n                name=\"domain\"\n                value={formData.domain}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? t('organization.create.creating') : t('organization.create.createButton')}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default CreateOrganizationModal; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { CreateJoinRequestRequest, Organization } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nconst JoinOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<CreateJoinRequestRequest>({\n    organizationName: '',\n    message: ''\n  });\n  const [loading, setLoading] = useState<boolean>(false);\n  const [searching, setSearching] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [organizations, setOrganizations] = useState<Organization[]>([]);\n  const [showDropdown, setShowDropdown] = useState<boolean>(false);\n  const [selectedOrganization, setSelectedOrganization] = useState<Organization | null>(null);\n  const searchTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  const { showMessage } = useMessage();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  // Click outside handler fr Dropdown\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setShowDropdown(false);\n      }\n    };\n\n    if (showDropdown) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showDropdown]);\n\n  const searchOrganizations = async (searchTerm: string) => {\n    if (searchTerm.length < 2) {\n      setOrganizations([]);\n      setShowDropdown(false);\n      return;\n    }\n\n    try {\n      setSearching(true);\n      const results = await organizationService.searchOrganizations(searchTerm);\n      setOrganizations(results);\n      setShowDropdown(true);\n    } catch (err: any) {\n      console.error('Fehler bei der Organisationen-Suche:', err);\n      setOrganizations([]);\n    } finally {\n      setSearching(false);\n    }\n  };\n\n  const handleOrganizationInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setFormData(prev => ({ ...prev, organizationName: value }));\n    setSelectedOrganization(null);\n    \n    // Fehler lschen\n    if (errors.organizationName) {\n      setErrors(prev => ({ ...prev, organizationName: '' }));\n    }\n\n    // Debounce fr Suche\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current);\n    }\n\n    searchTimeoutRef.current = setTimeout(() => {\n      searchOrganizations(value);\n    }, 300);\n  };\n\n  const handleSelectOrganization = (org: Organization) => {\n    setSelectedOrganization(org);\n    setFormData(prev => ({ ...prev, organizationName: org.name }));\n    setShowDropdown(false);\n    setOrganizations([]);\n  };\n\n  const handleMessageChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setFormData(prev => ({ ...prev, message: e.target.value }));\n    if (errors.message) {\n      setErrors(prev => ({ ...prev, message: '' }));\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.organizationName.trim()) {\n      newErrors.organizationName = t('organization.join.nameRequired');\n    } else if (!selectedOrganization) {\n      newErrors.organizationName = t('organization.join.selectFromList');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      await organizationService.createJoinRequest(formData);\n      setErrors({});\n      showMessage(t('organization.join.sendSuccess'), 'success');\n      // Formular zurcksetzen\n      setFormData({\n        organizationName: '',\n        message: ''\n      });\n      setSelectedOrganization(null);\n      setOrganizations([]);\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.join.sendError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    setFormData({\n      organizationName: '',\n      message: ''\n    });\n    setSelectedOrganization(null);\n    setOrganizations([]);\n    setErrors({});\n    setShowDropdown(false);\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current);\n    }\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.join.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div className=\"relative\" ref={dropdownRef}>\n                  <label \n                    htmlFor=\"organizationName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.join.search')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"organizationName\"\n                    name=\"organizationName\"\n                    value={formData.organizationName}\n                    onChange={handleOrganizationInputChange}\n                    placeholder={t('organization.join.searchPlaceholder')}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.organizationName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.organizationName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.organizationName}</p>\n                  )}\n                  \n                  {/* Autocomplete Dropdown */}\n                  {showDropdown && (organizations.length > 0 || searching) && (\n                    <div className=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto\">\n                      {searching ? (\n                        <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                          {t('organization.join.searching')}\n                        </div>\n                      ) : organizations.length > 0 ? (\n                        organizations.map(org => (\n                          <button\n                            key={org.id}\n                            type=\"button\"\n                            onClick={() => handleSelectOrganization(org)}\n                            className=\"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none\"\n                          >\n                            <div className=\"font-medium text-gray-900 dark:text-white\">\n                              {org.displayName || org.name}\n                            </div>\n                            {org.displayName && (\n                              <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                {org.name}\n                              </div>\n                            )}\n                          </button>\n                        ))\n                      ) : (\n                        <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                          {t('organization.join.noOrganizations')}\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"message\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.join.message')}\n                  </label>\n                  <textarea\n                    id=\"message\"\n                    name=\"message\"\n                    value={formData.message || ''}\n                    onChange={handleMessageChange}\n                    rows={3}\n                    placeholder={t('organization.join.messagePlaceholder')}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.join.sending') : t('organization.join.send')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.join.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"relative\" ref={dropdownRef}>\n              <label \n                htmlFor=\"organizationName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.join.search')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"organizationName\"\n                name=\"organizationName\"\n                value={formData.organizationName}\n                onChange={handleOrganizationInputChange}\n                placeholder={t('organization.join.searchPlaceholder')}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.organizationName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.organizationName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.organizationName}</p>\n              )}\n              \n              {/* Autocomplete Dropdown */}\n              {showDropdown && (organizations.length > 0 || searching) && (\n                <div className=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto\">\n                  {searching ? (\n                    <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                      {t('organization.join.searching')}\n                    </div>\n                  ) : organizations.length > 0 ? (\n                    organizations.map(org => (\n                      <button\n                        key={org.id}\n                        type=\"button\"\n                        onClick={() => handleSelectOrganization(org)}\n                        className=\"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none\"\n                      >\n                        <div className=\"font-medium text-gray-900 dark:text-white\">\n                          {org.displayName || org.name}\n                        </div>\n                        {org.displayName && (\n                          <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                            {org.name}\n                          </div>\n                        )}\n                      </button>\n                    ))\n                  ) : (\n                    <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                      {t('organization.join.noOrganizations')}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"message\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.join.message')}\n              </label>\n              <textarea\n                id=\"message\"\n                name=\"message\"\n                value={formData.message || ''}\n                onChange={handleMessageChange}\n                rows={3}\n                placeholder={t('organization.join.messagePlaceholder')}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? t('organization.join.sending') : t('organization.join.send')}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default JoinOrganizationModal; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { roleApi } from '../../api/apiClient.ts';\nimport { Role } from '../../types/interfaces.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\n\ninterface Organization {\n  id: number;\n  displayName?: string;\n  name?: string;\n  settings?: any;\n}\n\ninterface RoleConfigurationTabProps {\n  organization: Organization | null;\n  onSave?: () => void;\n}\n\nconst RoleConfigurationTab: React.FC<RoleConfigurationTabProps> = ({\n  organization,\n  onSave\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [lifecycleRoles, setLifecycleRoles] = useState<{\n    adminRoleId?: number | null;\n    hrRoleId?: number | null;\n    legalRoleId?: number | null;\n    employeeRoleIds?: number[];\n  }>({});\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [loadingRoles, setLoadingRoles] = useState(false);\n\n  useEffect(() => {\n    if (organization) {\n      loadRoles();\n      loadLifecycleRoles();\n    }\n  }, [organization]);\n\n  const loadRoles = async () => {\n    setLoadingRoles(true);\n    try {\n      const response = await roleApi.getAll();\n      if (response.data && Array.isArray(response.data)) {\n        setRoles(response.data);\n      }\n    } catch (error) {\n      console.error('Fehler beim Laden der Rollen:', error);\n      showMessage(\n        t('lifecycle.loadRolesError', { defaultValue: 'Fehler beim Laden der Rollen' }),\n        'error'\n      );\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  const loadLifecycleRoles = async () => {\n    setLoading(true);\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.LIFECYCLE_ROLES);\n      setLifecycleRoles(response.data.lifecycleRoles || {});\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Lebenszyklus-Rollen:', error);\n      // Wenn 404, dann gibt es noch keine Konfiguration - das ist OK\n      if (error.response?.status !== 404) {\n        showMessage(\n          error.response?.data?.message || t('lifecycle.loadLifecycleRolesError', { defaultValue: 'Fehler beim Laden der Konfiguration' }),\n          'error'\n        );\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSave = async () => {\n    setSaving(true);\n    try {\n      // Konvertiere zu Number oder null (verhindert, dass 0 oder undefined als String gesendet wird)\n      const prepareRoleId = (id: number | null | undefined): number | null => {\n        if (id === null || id === undefined || id === 0) {\n          return null;\n        }\n        return Number(id);\n      };\n\n      await axiosInstance.put(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.LIFECYCLE_ROLES, {\n        adminRoleId: prepareRoleId(lifecycleRoles.adminRoleId),\n        hrRoleId: prepareRoleId(lifecycleRoles.hrRoleId),\n        legalRoleId: prepareRoleId(lifecycleRoles.legalRoleId),\n        employeeRoleIds: (lifecycleRoles.employeeRoleIds || []).map(prepareRoleId).filter((id): id is number => id !== null)\n      });\n      showMessage(\n        t('lifecycle.rolesSaved', { defaultValue: 'Rollen-Konfiguration erfolgreich gespeichert' }),\n        'success'\n      );\n      if (onSave) {\n        onSave();\n      }\n    } catch (error: any) {\n      console.error('Fehler beim Speichern:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.saveError', { defaultValue: 'Fehler beim Speichern' }),\n        'error'\n      );\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleAssignStandardRoles = () => {\n    // Finde Standard-Rollen\n    const adminRole = roles.find(r => r.name.toLowerCase().includes('admin') || r.name.toLowerCase().includes('administrator'));\n    const hrRole = roles.find(r => r.name.toLowerCase().includes('hr') || r.name.toLowerCase().includes('human'));\n    const legalRole = roles.find(r => r.name.toLowerCase() === 'derecho' || r.name.toLowerCase().includes('legal'));\n\n    setLifecycleRoles({\n      ...lifecycleRoles,\n      adminRoleId: adminRole?.id || null,\n      hrRoleId: hrRole?.id || null,\n      legalRoleId: legalRole?.id || null\n    });\n\n    showMessage(\n      t('lifecycle.standardRolesAssigned', { defaultValue: 'Standard-Rollen zugewiesen' }),\n      'success'\n    );\n  };\n\n  if (loading && !lifecycleRoles) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <ArrowPathIcon className=\"h-6 w-6 animate-spin text-gray-400\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.lifecycleRoles.title', { defaultValue: 'Lebenszyklus-Rollen' })}\n          </h3>\n          <button\n            onClick={handleAssignStandardRoles}\n            className=\"px-3 py-1.5 text-sm font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors\"\n          >\n            {t('lifecycle.assignStandardRoles', { defaultValue: 'Standard-Rollen zuweisen' })}\n          </button>\n        </div>\n        \n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              {t('organization.lifecycleRoles.admin', { defaultValue: 'Admin-Rolle' })}\n            </label>\n            <select\n              value={lifecycleRoles.adminRoleId || ''}\n              onChange={(e) => {\n                const value = e.target.value;\n                setLifecycleRoles({ \n                ...lifecycleRoles, \n                  adminRoleId: (value && value !== '' && !isNaN(parseInt(value, 10))) ? parseInt(value, 10) : null \n                });\n              }}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              disabled={loadingRoles}\n            >\n              <option value=\"\">{t('common.pleaseSelect')}</option>\n              {roles.map(role => (\n                <option key={role.id} value={role.id}>\n                  {role.name}\n                </option>\n              ))}\n            </select>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              {t('organization.lifecycleRoles.hr', { defaultValue: 'HR-Rolle' })}\n            </label>\n            <select\n              value={lifecycleRoles.hrRoleId || ''}\n              onChange={(e) => {\n                const value = e.target.value;\n                setLifecycleRoles({ \n                ...lifecycleRoles, \n                  hrRoleId: (value && value !== '' && !isNaN(parseInt(value, 10))) ? parseInt(value, 10) : null \n                });\n              }}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              disabled={loadingRoles}\n            >\n              <option value=\"\">{t('common.pleaseSelect')}</option>\n              {roles.map(role => (\n                <option key={role.id} value={role.id}>\n                  {role.name}\n                </option>\n              ))}\n            </select>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              {t('organization.lifecycleRoles.legal', { defaultValue: 'Legal-Rolle' })}\n            </label>\n            <select\n              value={lifecycleRoles.legalRoleId || ''}\n              onChange={(e) => {\n                const value = e.target.value;\n                setLifecycleRoles({ \n                ...lifecycleRoles, \n                  legalRoleId: (value && value !== '' && !isNaN(parseInt(value, 10))) ? parseInt(value, 10) : null \n                });\n              }}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              disabled={loadingRoles}\n            >\n              <option value=\"\">{t('common.pleaseSelect')}</option>\n              {roles.map(role => (\n                <option key={role.id} value={role.id}>\n                  {role.name}\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n        \n        <div className=\"mt-6 flex justify-end\">\n          <button\n            onClick={handleSave}\n            disabled={saving || loadingRoles}\n            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            title={saving ? t('common.saving', { defaultValue: 'Speichere...' }) : t('common.save', { defaultValue: 'Speichern' })}\n          >\n            {saving ? (\n              <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n            ) : (\n              <CheckIcon className=\"h-5 w-5\" />\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default RoleConfigurationTab;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { DocumentTextIcon, ArrowPathIcon, CheckIcon, PlusIcon, TrashIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../../config/axios.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { organizationService } from '../../services/organizationService.ts';\n\ninterface Organization {\n  id: number;\n  displayName?: string;\n  name?: string;\n  settings?: any;\n}\n\ninterface DocumentConfigurationTabProps {\n  organization: Organization | null;\n  onSave?: () => void;\n}\n\ninterface DocumentTemplate {\n  id?: number;\n  name: string;\n  type: 'certificate' | 'contract';\n  filePath?: string;\n  version?: string;\n}\n\nconst DocumentConfigurationTab: React.FC<DocumentConfigurationTabProps> = ({\n  organization,\n  onSave\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [templates, setTemplates] = useState<DocumentTemplate[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const [templateType, setTemplateType] = useState<'certificate' | 'contract'>('certificate');\n  const fileInputRef = React.useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    if (organization) {\n      loadTemplates();\n    }\n  }, [organization]);\n\n  const loadTemplates = async () => {\n    setLoading(true);\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      \n      // Konvertiere zu Template-Array\n      const templatesList: DocumentTemplate[] = [];\n      if (documentTemplates.employmentCertificate) {\n        templatesList.push({\n          name: 'Arbeitszeugnis',\n          type: 'certificate',\n          filePath: documentTemplates.employmentCertificate.path,\n          version: documentTemplates.employmentCertificate.version\n        });\n      }\n      if (documentTemplates.employmentContract) {\n        templatesList.push({\n          name: 'Arbeitsvertrag',\n          type: 'contract',\n          filePath: documentTemplates.employmentContract.path,\n          version: documentTemplates.employmentContract.version\n        });\n      }\n      \n      setTemplates(templatesList);\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Templates:', error);\n      if (error.response?.status !== 404) {\n        showMessage(\n          error.response?.data?.message || t('lifecycle.loadTemplatesError', { defaultValue: 'Fehler beim Laden der Templates' }),\n          'error'\n        );\n      }\n      setTemplates([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // Prfe Dateityp\n    if (file.type !== 'application/pdf') {\n      showMessage(\n        t('lifecycle.onlyPdfAllowed', { defaultValue: 'Nur PDF-Dateien sind erlaubt' }),\n        'error'\n      );\n      return;\n    }\n\n    setUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('type', templateType === 'certificate' ? 'employmentCertificate' : 'employmentContract');\n\n      const response = await axiosInstance.post(\n        API_ENDPOINTS.ORGANIZATION_LIFECYCLE.UPLOAD_TEMPLATE,\n        formData,\n        {\n          headers: { 'Content-Type': 'multipart/form-data' }\n        }\n      );\n      \n      showMessage(\n        response.data.message || t('lifecycle.templateUploaded', { defaultValue: 'Template erfolgreich hochgeladen' }),\n        'success'\n      );\n      \n      // Lade Templates neu\n      loadTemplates();\n    } catch (error: any) {\n      console.error('Fehler beim Hochladen:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.uploadError', { defaultValue: 'Fehler beim Hochladen' }),\n        'error'\n      );\n    } finally {\n      setUploading(false);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    }\n  };\n\n  const handleDeleteTemplate = async (templateType: 'certificate' | 'contract') => {\n    if (!window.confirm(t('lifecycle.deleteTemplateConfirm', { defaultValue: 'Template wirklich lschen?' }))) {\n      return;\n    }\n\n    try {\n      // Hole aktuelle Organisation\n      const orgResponse = await axiosInstance.get(API_ENDPOINTS.ORGANIZATIONS.CURRENT);\n      const settings = orgResponse.data.settings || {};\n      \n      // Entferne Template\n      if (settings.documentTemplates) {\n        const typeKey = templateType === 'certificate' ? 'employmentCertificate' : 'employmentContract';\n        delete settings.documentTemplates[typeKey];\n        \n        // Aktualisiere Organisation\n        await axiosInstance.put(API_ENDPOINTS.ORGANIZATIONS.CURRENT, {\n          settings\n        });\n      }\n      \n      showMessage(\n        t('lifecycle.templateDeleted', { defaultValue: 'Template erfolgreich gelscht' }),\n        'success'\n      );\n      \n      // Lade Templates neu\n      loadTemplates();\n    } catch (error: any) {\n      console.error('Fehler beim Lschen:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.deleteError', { defaultValue: 'Fehler beim Lschen' }),\n        'error'\n      );\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <ArrowPathIcon className=\"h-6 w-6 animate-spin text-gray-400\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold flex items-center dark:text-white\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('organization.documentTemplates', { defaultValue: 'Dokumenten-Templates' })}\n          </h3>\n          <div className=\"flex items-center space-x-2\">\n            <select\n              value={templateType}\n              onChange={(e) => setTemplateType(e.target.value as 'certificate' | 'contract')}\n              className=\"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n            >\n              <option value=\"certificate\">Arbeitszeugnis</option>\n              <option value=\"contract\">Arbeitsvertrag</option>\n            </select>\n            <button\n              onClick={() => fileInputRef.current?.click()}\n              disabled={uploading}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n              title={uploading ? t('common.uploading', { defaultValue: 'Lade hoch...' }) : t('lifecycle.uploadTemplate', { defaultValue: 'Template hochladen' })}\n            >\n              {uploading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <PlusIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept=\".pdf\"\n            onChange={handleFileUpload}\n            className=\"hidden\"\n          />\n        </div>\n        \n        {templates.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noTemplates', { defaultValue: 'Keine Templates vorhanden' })}</p>\n            <p className=\"text-sm mt-2\">{t('lifecycle.uploadFirstTemplate', { defaultValue: 'Laden Sie Ihr erstes Template hoch' })}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-2\">\n            {templates.map((template) => (\n              <div\n                key={template.type}\n                className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg\"\n              >\n                <div>\n                  <div className=\"font-medium dark:text-white\">{template.name}</div>\n                  <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                    {template.type === 'certificate' \n                      ? t('lifecycle.certificate', { defaultValue: 'Arbeitszeugnis' })\n                      : t('lifecycle.contract', { defaultValue: 'Arbeitsvertrag' })}\n                    {template.version && ` - Version ${template.version}`}\n                  </div>\n                  {template.filePath && (\n                    <div className=\"text-xs text-gray-400 dark:text-gray-500 mt-1\">\n                      {template.filePath}\n                    </div>\n                  )}\n                </div>\n                <button\n                  onClick={() => handleDeleteTemplate(template.type)}\n                  className=\"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900 rounded-md\"\n                  title={t('common.delete', { defaultValue: 'Lschen' })}\n                >\n                  <TrashIcon className=\"h-5 w-5\" />\n                </button>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n      \n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold flex items-center dark:text-white\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('organization.documentSignatures', { defaultValue: 'Dokumenten-Signaturen' })}\n          </h3>\n        </div>\n        \n        <SignatureUploadSection \n          organization={organization}\n          onUpload={loadTemplates}\n        />\n      </div>\n      \n      <FieldPositionConfiguration \n        organization={organization}\n        onSave={onSave}\n      />\n    </div>\n  );\n};\n\ninterface SignatureUploadSectionProps {\n  organization: Organization | null;\n  onUpload: () => void;\n}\n\nconst SignatureUploadSection: React.FC<SignatureUploadSectionProps> = ({\n  organization,\n  onUpload\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [signatures, setSignatures] = useState<Array<{\n    type: 'certificate' | 'contract';\n    signerName: string;\n    signerPosition?: string;\n    path: string;\n    position?: {\n      x: number;\n      y: number;\n      page: number;\n    };\n  }>>([]);\n  const [loading, setLoading] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const [signatureType, setSignatureType] = useState<'certificate' | 'contract'>('certificate');\n  const [signerName, setSignerName] = useState('');\n  const [signerPosition, setSignerPosition] = useState('');\n  const [positionX, setPositionX] = useState<string>('400');\n  const [positionY, setPositionY] = useState<string>('100');\n  const [positionPage, setPositionPage] = useState<string>('1');\n  const fileInputRef = React.useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    if (organization) {\n      loadSignatures();\n    }\n  }, [organization]);\n\n  const loadSignatures = async () => {\n    setLoading(true);\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_SIGNATURES);\n      const documentSignatures = response.data.documentSignatures || {};\n      \n      const signaturesList: Array<{\n        type: 'certificate' | 'contract';\n        signerName: string;\n        signerPosition?: string;\n        path: string;\n        position?: {\n          x: number;\n          y: number;\n          page: number;\n        };\n      }> = [];\n      \n      if (documentSignatures.employmentCertificate) {\n        signaturesList.push({\n          type: 'certificate',\n          signerName: documentSignatures.employmentCertificate.signerName,\n          signerPosition: documentSignatures.employmentCertificate.signerPosition,\n          path: documentSignatures.employmentCertificate.path,\n          position: documentSignatures.employmentCertificate.position\n        });\n      }\n      if (documentSignatures.employmentContract) {\n        signaturesList.push({\n          type: 'contract',\n          signerName: documentSignatures.employmentContract.signerName,\n          signerPosition: documentSignatures.employmentContract.signerPosition,\n          path: documentSignatures.employmentContract.path,\n          position: documentSignatures.employmentContract.position\n        });\n      }\n      \n      setSignatures(signaturesList);\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Signaturen:', error);\n      if (error.response?.status !== 404) {\n        showMessage(\n          error.response?.data?.message || t('lifecycle.loadSignaturesError', { defaultValue: 'Fehler beim Laden der Signaturen' }),\n          'error'\n        );\n      }\n      setSignatures([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // Prfe Dateityp\n    const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'application/pdf'];\n    if (!allowedTypes.includes(file.type)) {\n      showMessage(\n        t('lifecycle.onlyImageOrPdfAllowed', { defaultValue: 'Nur Bilder (JPEG, PNG, GIF) oder PDF-Dateien sind erlaubt' }),\n        'error'\n      );\n      return;\n    }\n\n    if (!signerName.trim()) {\n      showMessage(\n        t('lifecycle.signerNameRequired', { defaultValue: 'Name des Unterzeichners ist erforderlich' }),\n        'error'\n      );\n      return;\n    }\n\n    setUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('type', signatureType === 'certificate' ? 'employmentCertificate' : 'employmentContract');\n      formData.append('signerName', signerName);\n      if (signerPosition) {\n        formData.append('signerPosition', signerPosition);\n      }\n      // Positionen hinzufgen\n      formData.append('positionX', positionX || '400');\n      formData.append('positionY', positionY || '100');\n      formData.append('page', positionPage || '1');\n\n      const response = await axiosInstance.post(\n        API_ENDPOINTS.ORGANIZATION_LIFECYCLE.UPLOAD_SIGNATURE,\n        formData,\n        {\n          headers: { 'Content-Type': 'multipart/form-data' }\n        }\n      );\n      \n      showMessage(\n        response.data.message || t('lifecycle.signatureUploaded', { defaultValue: 'Signatur erfolgreich hochgeladen' }),\n        'success'\n      );\n      \n      // Reset form\n      setSignerName('');\n      setSignerPosition('');\n      setPositionX('400');\n      setPositionY('100');\n      setPositionPage('1');\n      \n      // Lade Signaturen neu\n      loadSignatures();\n      onUpload();\n    } catch (error: any) {\n      console.error('Fehler beim Hochladen:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.uploadError', { defaultValue: 'Fehler beim Hochladen' }),\n        'error'\n      );\n    } finally {\n      setUploading(false);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    }\n  };\n\n  const handleDeleteSignature = async (signatureType: 'certificate' | 'contract') => {\n    if (!window.confirm(t('lifecycle.deleteSignatureConfirm', { defaultValue: 'Signatur wirklich lschen?' }))) {\n      return;\n    }\n\n    try {\n      const orgResponse = await axiosInstance.get(API_ENDPOINTS.ORGANIZATIONS.CURRENT);\n      const settings = orgResponse.data.settings || {};\n      \n      if (settings.documentSignatures) {\n        const typeKey = signatureType === 'certificate' ? 'employmentCertificate' : 'employmentContract';\n        delete settings.documentSignatures[typeKey];\n        \n        await axiosInstance.put(API_ENDPOINTS.ORGANIZATIONS.CURRENT, {\n          settings\n        });\n      }\n      \n      showMessage(\n        t('lifecycle.signatureDeleted', { defaultValue: 'Signatur erfolgreich gelscht' }),\n        'success'\n      );\n      \n      loadSignatures();\n    } catch (error: any) {\n      console.error('Fehler beim Lschen:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.deleteError', { defaultValue: 'Fehler beim Lschen' }),\n        'error'\n      );\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-4\">\n        <ArrowPathIcon className=\"h-5 w-5 animate-spin text-gray-400\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"border border-gray-300 dark:border-gray-600 rounded-lg p-4\">\n        <div className=\"space-y-3\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              {t('lifecycle.signatureType', { defaultValue: 'Signatur-Typ' })}\n            </label>\n            <select\n              value={signatureType}\n              onChange={(e) => setSignatureType(e.target.value as 'certificate' | 'contract')}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n            >\n              <option value=\"certificate\">{t('lifecycle.certificate', { defaultValue: 'Arbeitszeugnis' })}</option>\n              <option value=\"contract\">{t('lifecycle.contract', { defaultValue: 'Arbeitsvertrag' })}</option>\n            </select>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              {t('lifecycle.signerName', { defaultValue: 'Name des Unterzeichners' })} <span className=\"text-red-500\">*</span>\n            </label>\n            <input\n              type=\"text\"\n              value={signerName}\n              onChange={(e) => setSignerName(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n              placeholder={t('lifecycle.signerNamePlaceholder', { defaultValue: 'z.B. Stefan Bossart' })}\n            />\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              {t('lifecycle.signerPosition', { defaultValue: 'Position' })}\n            </label>\n            <input\n              type=\"text\"\n              value={signerPosition}\n              onChange={(e) => setSignerPosition(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n              placeholder={t('lifecycle.signerPositionPlaceholder', { defaultValue: 'z.B. Geschftsfhrer' })}\n            />\n          </div>\n          \n          <div className=\"border-t border-gray-200 dark:border-gray-700 pt-3\">\n            <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\n              {t('lifecycle.signaturePosition', { defaultValue: 'Signatur-Position im PDF' })}\n            </h4>\n            <div className=\"grid grid-cols-3 gap-3\">\n              <div>\n                <label className=\"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1\">\n                  {t('lifecycle.positionX', { defaultValue: 'X (horizontal)' })}\n                </label>\n                <input\n                  type=\"number\"\n                  value={positionX}\n                  onChange={(e) => setPositionX(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n                  placeholder=\"400\"\n                  min=\"0\"\n                />\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                  {t('lifecycle.positionXHint', { defaultValue: '0 = links' })}\n                </p>\n              </div>\n              <div>\n                <label className=\"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1\">\n                  {t('lifecycle.positionY', { defaultValue: 'Y (vertikal)' })}\n                </label>\n                <input\n                  type=\"number\"\n                  value={positionY}\n                  onChange={(e) => setPositionY(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n                  placeholder=\"100\"\n                  min=\"0\"\n                />\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                  {t('lifecycle.positionYHint', { defaultValue: '0 = unten' })}\n                </p>\n              </div>\n              <div>\n                <label className=\"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1\">\n                  {t('lifecycle.positionPage', { defaultValue: 'Seite' })}\n                </label>\n                <input\n                  type=\"number\"\n                  value={positionPage}\n                  onChange={(e) => setPositionPage(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n                  placeholder=\"1\"\n                  min=\"1\"\n                />\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                  {t('lifecycle.positionPageHint', { defaultValue: 'Seitennummer' })}\n                </p>\n              </div>\n            </div>\n            <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\n              {t('lifecycle.signaturePositionHint', { defaultValue: 'Koordinaten in PDF-Punkten (1 Punkt = 1/72 Zoll). A4: 595 x 842 Punkte. Standard: X=400, Y=100, Seite=1' })}\n            </p>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              {t('lifecycle.signatureFile', { defaultValue: 'Signatur-Datei' })} <span className=\"text-red-500\">*</span>\n            </label>\n            <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center\">\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\"image/jpeg,image/png,image/gif,application/pdf\"\n                onChange={handleFileUpload}\n                className=\"hidden\"\n              />\n              <button\n                onClick={() => fileInputRef.current?.click()}\n                disabled={uploading || !signerName.trim()}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {uploading ? (\n                  <span className=\"flex items-center space-x-2\">\n                    <ArrowPathIcon className=\"h-4 w-4 animate-spin\" />\n                    <span>{t('common.uploading', { defaultValue: 'Lade hoch...' })}</span>\n                  </span>\n                ) : (\n                  t('lifecycle.selectSignatureFile', { defaultValue: 'Datei auswhlen' })\n                )}\n              </button>\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\n                {t('lifecycle.signatureFileHint', { defaultValue: 'JPEG, PNG, GIF oder PDF (max. 5MB)' })}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      {signatures.length > 0 && (\n        <div className=\"space-y-2\">\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n            {t('lifecycle.uploadedSignatures', { defaultValue: 'Hochgeladene Signaturen' })}\n          </h4>\n          {signatures.map((signature) => (\n            <div\n              key={signature.type}\n              className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg\"\n            >\n              <div>\n                <div className=\"font-medium dark:text-white\">\n                  {signature.type === 'certificate' \n                    ? t('lifecycle.certificate', { defaultValue: 'Arbeitszeugnis' })\n                    : t('lifecycle.contract', { defaultValue: 'Arbeitsvertrag' })}\n                </div>\n                <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                  {signature.signerName}\n                  {signature.signerPosition && ` - ${signature.signerPosition}`}\n                </div>\n                {signature.position && (\n                  <div className=\"text-xs text-gray-400 dark:text-gray-500 mt-1\">\n                    {t('lifecycle.position', { defaultValue: 'Position' })}: X={signature.position.x}, Y={signature.position.y}, {t('lifecycle.page', { defaultValue: 'Seite' })} {signature.position.page}\n                  </div>\n                )}\n              </div>\n              <button\n                onClick={() => handleDeleteSignature(signature.type)}\n                className=\"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900 rounded-md\"\n                title={t('common.delete', { defaultValue: 'Lschen' })}\n              >\n                <TrashIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\ninterface FieldPositionConfigurationProps {\n  organization: Organization | null;\n  onSave?: () => void;\n}\n\nconst FieldPositionConfiguration: React.FC<FieldPositionConfigurationProps> = ({\n  organization,\n  onSave\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [templateType, setTemplateType] = useState<'certificate' | 'contract'>('certificate');\n  const [fields, setFields] = useState<Record<string, { x: number; y: number; fontSize?: number }>>({});\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n\n  // Standard-Felder fr Certificate und Contract\n  const certificateFields = ['userName', 'organizationName', 'currentDate', 'identificationNumber', 'startDate', 'endDate'];\n  const contractFields = ['userName', 'organizationName', 'currentDate', 'identificationNumber', 'startDate', 'endDate', 'position', 'salary', 'workingHours'];\n\n  useEffect(() => {\n    if (organization) {\n      loadFields();\n    }\n  }, [organization, templateType]);\n\n  const loadFields = async () => {\n    try {\n      const settings = organization?.settings as any;\n      const templateSettings = settings?.documentTemplates?.[templateType === 'certificate' ? 'employmentCertificate' : 'employmentContract'];\n      const savedFields = templateSettings?.fields || {};\n      \n      // Standard-Positionen (A4: 595.28 x 841.89 Punkte)\n      // Y-Koordinate: 0 ist unten, 841.89 ist oben (PDF-Koordinatensystem)\n      const pageHeight = 841.89;\n      const margin = 50;\n      const lineHeight = 20;\n      let currentY = pageHeight - margin - 30;\n      \n      // Lade gespeicherte Felder oder verwende Standard-Werte (synchronisiert mit Backend)\n      const defaultFields: Record<string, { x: number; y: number; fontSize?: number }> = {};\n      const fieldList = templateType === 'certificate' ? certificateFields : contractFields;\n      \n      // Standard-Positionen (wie im Backend getDefaultFieldPositions)\n      const defaultPositions: Record<string, { x: number; y: number; fontSize?: number }> = {\n        userName: { x: margin, y: currentY, fontSize: 14 },\n        organizationName: { x: margin, y: currentY - lineHeight, fontSize: 12 },\n        currentDate: { x: margin, y: currentY - lineHeight * 2, fontSize: 12 },\n        identificationNumber: { x: margin, y: currentY - lineHeight * 3, fontSize: 12 },\n        startDate: { x: margin, y: currentY - lineHeight * 4, fontSize: 12 },\n        endDate: { x: margin, y: currentY - lineHeight * 5, fontSize: 12 }\n      };\n      \n      if (templateType === 'contract') {\n        defaultPositions.position = { x: margin, y: currentY - lineHeight * 6, fontSize: 12 };\n        defaultPositions.salary = { x: margin, y: currentY - lineHeight * 7, fontSize: 12 };\n        defaultPositions.workingHours = { x: margin, y: currentY - lineHeight * 8, fontSize: 12 };\n      }\n      \n      fieldList.forEach((fieldName) => {\n        defaultFields[fieldName] = savedFields[fieldName] || defaultPositions[fieldName] || {\n          x: margin,\n          y: currentY,\n          fontSize: fieldName === 'userName' ? 14 : 12\n        };\n      });\n      \n      setFields(defaultFields);\n    } catch (error) {\n      console.error('Fehler beim Laden der Felder:', error);\n    }\n  };\n\n  const handleFieldChange = (fieldName: string, property: 'x' | 'y' | 'fontSize', value: string) => {\n    setFields(prev => ({\n      ...prev,\n      [fieldName]: {\n        ...prev[fieldName],\n        [property]: property === 'fontSize' ? parseFloat(value) || 12 : parseFloat(value) || 0\n      }\n    }));\n  };\n\n  const handleSave = async () => {\n    setSaving(true);\n    try {\n      const orgResponse = await axiosInstance.get(API_ENDPOINTS.ORGANIZATIONS.CURRENT);\n      const currentSettings = orgResponse.data.settings || {};\n      \n      if (!currentSettings.documentTemplates) {\n        currentSettings.documentTemplates = {};\n      }\n      \n      const typeKey = templateType === 'certificate' ? 'employmentCertificate' : 'employmentContract';\n      if (!currentSettings.documentTemplates[typeKey]) {\n        currentSettings.documentTemplates[typeKey] = {};\n      }\n      \n      currentSettings.documentTemplates[typeKey].fields = fields;\n      \n      await organizationService.updateOrganization({\n        settings: currentSettings\n      });\n      \n      showMessage(\n        t('lifecycle.fieldPositionsSaved', { defaultValue: 'Feld-Positionen erfolgreich gespeichert' }),\n        'success'\n      );\n      \n      if (onSave) {\n        onSave();\n      }\n    } catch (error: any) {\n      console.error('Fehler beim Speichern:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.saveError', { defaultValue: 'Fehler beim Speichern' }),\n        'error'\n      );\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleReset = async () => {\n    if (window.confirm(t('lifecycle.resetFieldPositionsConfirm', { defaultValue: 'Positionen auf Standardwerte zurcksetzen?' }))) {\n      // Setze Felder auf Standard-Werte zurck\n      const pageHeight = 841.89;\n      const margin = 50;\n      const lineHeight = 20;\n      let currentY = pageHeight - margin - 30;\n      \n      const defaultPositions: Record<string, { x: number; y: number; fontSize?: number }> = {\n        userName: { x: margin, y: currentY, fontSize: 14 },\n        organizationName: { x: margin, y: currentY - lineHeight, fontSize: 12 },\n        currentDate: { x: margin, y: currentY - lineHeight * 2, fontSize: 12 },\n        identificationNumber: { x: margin, y: currentY - lineHeight * 3, fontSize: 12 },\n        startDate: { x: margin, y: currentY - lineHeight * 4, fontSize: 12 },\n        endDate: { x: margin, y: currentY - lineHeight * 5, fontSize: 12 }\n      };\n      \n      if (templateType === 'contract') {\n        defaultPositions.position = { x: margin, y: currentY - lineHeight * 6, fontSize: 12 };\n        defaultPositions.salary = { x: margin, y: currentY - lineHeight * 7, fontSize: 12 };\n        defaultPositions.workingHours = { x: margin, y: currentY - lineHeight * 8, fontSize: 12 };\n      }\n      \n      const fieldList = templateType === 'certificate' ? certificateFields : contractFields;\n      const resetFields: Record<string, { x: number; y: number; fontSize?: number }> = {};\n      \n      fieldList.forEach((fieldName) => {\n        resetFields[fieldName] = defaultPositions[fieldName] || {\n          x: margin,\n          y: currentY,\n          fontSize: fieldName === 'userName' ? 14 : 12\n        };\n      });\n      \n      setFields(resetFields);\n    }\n  };\n\n  const fieldList = templateType === 'certificate' ? certificateFields : contractFields;\n  const fieldLabels: Record<string, string> = {\n    userName: t('lifecycle.fieldUserName', { defaultValue: 'Benutzername' }),\n    organizationName: t('lifecycle.fieldOrganizationName', { defaultValue: 'Organisationsname' }),\n    currentDate: t('lifecycle.fieldCurrentDate', { defaultValue: 'Aktuelles Datum' }),\n    identificationNumber: t('lifecycle.fieldIdentificationNumber', { defaultValue: 'Ausweisnummer' }),\n    startDate: t('lifecycle.fieldStartDate', { defaultValue: 'Startdatum' }),\n    endDate: t('lifecycle.fieldEndDate', { defaultValue: 'Enddatum' }),\n    position: t('lifecycle.fieldPosition', { defaultValue: 'Position' }),\n    salary: t('lifecycle.fieldSalary', { defaultValue: 'Gehalt' }),\n    workingHours: t('lifecycle.fieldWorkingHours', { defaultValue: 'Arbeitsstunden' })\n  };\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold dark:text-white\">\n          {t('organization.fieldPositions', { defaultValue: 'Feld-Positionen konfigurieren' })}\n        </h3>\n        <div className=\"flex items-center space-x-2\">\n          <select\n            value={templateType}\n            onChange={(e) => setTemplateType(e.target.value as 'certificate' | 'contract')}\n            className=\"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n          >\n            <option value=\"certificate\">{t('lifecycle.certificate', { defaultValue: 'Certificado Laboral' })}</option>\n            <option value=\"contract\">{t('lifecycle.contract', { defaultValue: 'Contrato de Trabajo' })}</option>\n          </select>\n        </div>\n      </div>\n      \n      <div className=\"space-y-4\">\n        <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3\">\n          <p className=\"text-sm text-blue-800 dark:text-blue-200 font-medium mb-1\">\n            {t('lifecycle.fieldPositionsInfo', { defaultValue: 'Konfigurieren Sie die Positionen der Felder im Template-PDF.' })}\n          </p>\n          <p className=\"text-xs text-blue-700 dark:text-blue-300\">\n            {t('lifecycle.fieldPositionsHint', { defaultValue: 'Koordinaten in PDF-Punkten. A4: 595 x 842 Punkte. Y=0 ist unten, Y=842 ist oben. X=0 ist links, X=595 ist rechts.' })}\n          </p>\n        </div>\n        \n        <div className=\"space-y-3 max-h-96 overflow-y-auto\">\n          {fieldList.map((fieldName) => (\n            <div key={fieldName} className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-3\">\n              <div className=\"font-medium text-sm dark:text-white mb-2\">\n                {fieldLabels[fieldName] || fieldName}\n              </div>\n              <div className=\"grid grid-cols-3 gap-2\">\n                <div>\n                  <label className=\"block text-xs text-gray-600 dark:text-gray-400 mb-1\">\n                    X\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={fields[fieldName]?.x || 0}\n                    onChange={(e) => handleFieldChange(fieldName, 'x', e.target.value)}\n                    className=\"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n                    min=\"0\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-xs text-gray-600 dark:text-gray-400 mb-1\">\n                    Y\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={fields[fieldName]?.y || 0}\n                    onChange={(e) => handleFieldChange(fieldName, 'y', e.target.value)}\n                    className=\"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n                    min=\"0\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-xs text-gray-600 dark:text-gray-400 mb-1\">\n                    {t('lifecycle.fontSize', { defaultValue: 'Schriftgre' })}\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={fields[fieldName]?.fontSize || 12}\n                    onChange={(e) => handleFieldChange(fieldName, 'fontSize', e.target.value)}\n                    className=\"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n                    min=\"8\"\n                    max=\"72\"\n                  />\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n        \n        <div className=\"flex items-center justify-end space-x-2 pt-2 border-t border-gray-200 dark:border-gray-700\">\n          <button\n            onClick={handleReset}\n            className=\"px-4 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 dark:text-white\"\n          >\n            {t('common.reset', { defaultValue: 'Zurcksetzen' })}\n          </button>\n          <button\n            onClick={handleSave}\n            disabled={saving}\n            className=\"px-4 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-700 dark:hover:bg-blue-800\"\n          >\n            {saving ? (\n              <span className=\"flex items-center space-x-2\">\n                <ArrowPathIcon className=\"h-4 w-4 animate-spin\" />\n                <span>{t('common.saving', { defaultValue: 'Speichern...' })}</span>\n              </span>\n            ) : (\n              t('common.save', { defaultValue: 'Speichern' })\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default DocumentConfigurationTab;\n\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { EnvelopeIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport { organizationService } from '../../services/organizationService.ts';\r\nimport { Organization } from '../../types/organization.ts';\r\nimport useMessage from '../../hooks/useMessage.ts';\r\n\r\ninterface Props {\r\n  organization: Organization | null;\r\n  onSave?: () => void;\r\n}\r\n\r\nconst SMTPConfigurationTab: React.FC<Props> = ({ organization, onSave }) => {\r\n  const { t } = useTranslation();\r\n  const { showMessage } = useMessage();\r\n  const [loading, setLoading] = useState(false);\r\n  const [smtpSettings, setSmtpSettings] = useState({\r\n    smtpHost: '',\r\n    smtpPort: '587',\r\n    smtpUser: '',\r\n    smtpPass: '',\r\n    smtpFromEmail: '',\r\n    smtpFromName: ''\r\n  });\r\n  const [showPassword, setShowPassword] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (organization?.settings) {\r\n      const settings = organization.settings as any;\r\n      setSmtpSettings({\r\n        smtpHost: settings.smtpHost || '',\r\n        smtpPort: settings.smtpPort?.toString() || '587',\r\n        smtpUser: settings.smtpUser || '',\r\n        smtpPass: settings.smtpPass || '',\r\n        smtpFromEmail: settings.smtpFromEmail || (organization?.domain ? `noreply@${organization.domain}` : ''),\r\n        smtpFromName: settings.smtpFromName || organization?.displayName || ''\r\n      });\r\n    }\r\n  }, [organization]);\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const { name, value } = e.target;\r\n    setSmtpSettings(prev => ({\r\n      ...prev,\r\n      [name]: value\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!smtpSettings.smtpHost || !smtpSettings.smtpUser || !smtpSettings.smtpPass) {\r\n      showMessage(t('organization.smtp.requiredFields'), 'error');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      \r\n      const settings = {\r\n        ...(organization?.settings || {}),\r\n        smtpHost: smtpSettings.smtpHost,\r\n        smtpPort: parseInt(smtpSettings.smtpPort) || 587,\r\n        smtpUser: smtpSettings.smtpUser,\r\n        smtpPass: smtpSettings.smtpPass,\r\n        smtpFromEmail: smtpSettings.smtpFromEmail,\r\n        smtpFromName: smtpSettings.smtpFromName\r\n      };\r\n\r\n      await organizationService.updateOrganization({\r\n        settings: settings\r\n      });\r\n      \r\n      showMessage(t('organization.smtp.saveSuccess'), 'success');\r\n      if (onSave) {\r\n        onSave();\r\n      }\r\n    } catch (error: any) {\r\n      const errorMessage = error.response?.data?.message || t('organization.smtp.saveError');\r\n      showMessage(errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleClear = () => {\r\n    setSmtpSettings({\r\n      smtpHost: '',\r\n      smtpPort: '587',\r\n      smtpUser: '',\r\n      smtpPass: '',\r\n      smtpFromEmail: organization?.domain ? `noreply@${organization.domain}` : '',\r\n      smtpFromName: organization?.displayName || ''\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center gap-2 mb-4\">\r\n        <EnvelopeIcon className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\r\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\r\n          {t('organization.smtp.title')}\r\n        </h3>\r\n      </div>\r\n\r\n      <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\r\n        {t('organization.smtp.description')}\r\n      </p>\r\n\r\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n        <div>\r\n          <label htmlFor=\"smtpHost\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n            {t('organization.smtp.host')} <span className=\"text-red-500\">*</span>\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            id=\"smtpHost\"\r\n            name=\"smtpHost\"\r\n            value={smtpSettings.smtpHost}\r\n            onChange={handleChange}\r\n            placeholder=\"smtp.example.com\"\r\n            required\r\n            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\r\n          />\r\n          <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n            {t('organization.smtp.hostHint')}\r\n          </p>\r\n        </div>\r\n\r\n        <div>\r\n          <label htmlFor=\"smtpPort\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n            {t('organization.smtp.port')} <span className=\"text-red-500\">*</span>\r\n          </label>\r\n          <input\r\n            type=\"number\"\r\n            id=\"smtpPort\"\r\n            name=\"smtpPort\"\r\n            value={smtpSettings.smtpPort}\r\n            onChange={handleChange}\r\n            placeholder=\"587\"\r\n            required\r\n            min=\"1\"\r\n            max=\"65535\"\r\n            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\r\n          />\r\n          <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n            {t('organization.smtp.portHint')}\r\n          </p>\r\n        </div>\r\n\r\n        <div>\r\n          <label htmlFor=\"smtpUser\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n            {t('organization.smtp.user')} <span className=\"text-red-500\">*</span>\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            id=\"smtpUser\"\r\n            name=\"smtpUser\"\r\n            value={smtpSettings.smtpUser}\r\n            onChange={handleChange}\r\n            placeholder=\"noreply@example.com\"\r\n            required\r\n            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\r\n          />\r\n          <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n            {t('organization.smtp.userHint')}\r\n          </p>\r\n        </div>\r\n\r\n        <div>\r\n          <label htmlFor=\"smtpPass\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n            {t('organization.smtp.password')} <span className=\"text-red-500\">*</span>\r\n          </label>\r\n          <div className=\"relative\">\r\n            <input\r\n              type={showPassword ? 'text' : 'password'}\r\n              id=\"smtpPass\"\r\n              name=\"smtpPass\"\r\n              value={smtpSettings.smtpPass}\r\n              onChange={handleChange}\r\n              placeholder=\"\"\r\n              required\r\n              className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\r\n            />\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setShowPassword(!showPassword)}\r\n              className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n            >\r\n              {showPassword ? (\r\n                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\r\n                </svg>\r\n              ) : (\r\n                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\r\n                </svg>\r\n              )}\r\n            </button>\r\n          </div>\r\n          <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n            {t('organization.smtp.passwordHint')}\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"border-t pt-4\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\r\n            {t('organization.smtp.fromSettings')}\r\n          </h4>\r\n          \r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label htmlFor=\"smtpFromEmail\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                {t('organization.smtp.fromEmail')}\r\n              </label>\r\n              <input\r\n                type=\"email\"\r\n                id=\"smtpFromEmail\"\r\n                name=\"smtpFromEmail\"\r\n                value={smtpSettings.smtpFromEmail}\r\n                onChange={handleChange}\r\n                placeholder=\"noreply@example.com\"\r\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\r\n              />\r\n              <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                {t('organization.smtp.fromEmailHint')}\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <label htmlFor=\"smtpFromName\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                {t('organization.smtp.fromName')}\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"smtpFromName\"\r\n                name=\"smtpFromName\"\r\n                value={smtpSettings.smtpFromName}\r\n                onChange={handleChange}\r\n                placeholder={organization?.displayName || 'Intranet'}\r\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\r\n              />\r\n              <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                {t('organization.smtp.fromNameHint')}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md p-4\">\r\n          <p className=\"text-sm text-blue-800 dark:text-blue-200\">\r\n            <strong>{t('organization.smtp.infoTitle')}</strong>\r\n          </p>\r\n          <ul className=\"mt-2 text-sm text-blue-700 dark:text-blue-300 list-disc list-inside space-y-1\">\r\n            <li>{t('organization.smtp.info1')}</li>\r\n            <li>{t('organization.smtp.info2')}</li>\r\n            <li>{t('organization.smtp.info3')}</li>\r\n          </ul>\r\n        </div>\r\n\r\n        <div className=\"flex justify-end gap-2 pt-4\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleClear}\r\n            className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n          >\r\n            {t('organization.smtp.clear')}\r\n          </button>\r\n          <button\r\n            type=\"submit\"\r\n            disabled={loading}\r\n            className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 dark:bg-blue-700 rounded-md hover:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\r\n          >\r\n            {loading ? (\r\n              <>\r\n                <ArrowPathIcon className=\"h-4 w-4 animate-spin\" />\r\n                {t('organization.saving')}\r\n              </>\r\n            ) : (\r\n              <>\r\n                <CheckIcon className=\"h-4 w-4\" />\r\n                {t('common.save')}\r\n              </>\r\n            )}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SMTPConfigurationTab;\r\n\r\n","/**\r\n * URL-Validierung fr API-Endpunkte (Frontend)\r\n * \r\n * Verhindert SSRF durch Whitelist-basierte Validierung\r\n */\r\n\r\nconst ALLOWED_DOMAINS = {\r\n  lobbyPms: ['app.lobbypms.com'],\r\n  ttlock: ['open.ttlock.com'],\r\n  sire: ['api.sire.gov.co'],\r\n  boldPayment: ['api.bold.co', 'sandbox.bold.co'],\r\n} as const;\r\n\r\nexport type ApiService = keyof typeof ALLOWED_DOMAINS;\r\n\r\n/**\r\n * Validiert eine API-URL gegen eine Whitelist\r\n * \r\n * @param url - Die zu validierende URL\r\n * @param service - Der API-Service\r\n * @returns true wenn URL gltig ist, false sonst\r\n */\r\nexport const validateApiUrl = (url: string, service: ApiService): boolean => {\r\n  if (!url || typeof url !== 'string') {\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    const parsed = new URL(url);\r\n    const allowedDomains = ALLOWED_DOMAINS[service];\r\n\r\n    return allowedDomains.some(domain => {\r\n      // Exakte bereinstimmung\r\n      if (parsed.hostname === domain) {\r\n        return true;\r\n      }\r\n\r\n      // Subdomain (z.B. api.app.lobbypms.com)\r\n      if (parsed.hostname.endsWith(`.${domain}`)) {\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    });\r\n  } catch (error) {\r\n    // Ungltige URL\r\n    return false;\r\n  }\r\n};\r\n\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { KeyIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { Organization, OrganizationSettings } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport { validateApiUrl } from '../../utils/urlValidation.ts';\n\n// Feste LobbyPMS API URL\nconst LOBBYPMS_API_URL = 'https://app.lobbypms.com/api';\n\ninterface Props {\n  organization: Organization | null;\n  onSave?: () => void;\n}\n\nconst ApiConfigurationTab: React.FC<Props> = ({ organization, onSave }) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const { canManageOrganization, loading: permissionsLoading } = usePermissions();\n  const [loading, setLoading] = useState(false);\n  const [apiSettings, setApiSettings] = useState({\n    // LobbyPMS\n    lobbyPmsApiKey: '',\n    lobbyPmsPropertyId: '',\n    lobbyPmsSyncEnabled: false,\n    lobbyPmsAutoCreateTasks: false,\n    lobbyPmsLateCheckInThreshold: '22:00',\n    \n    // TTLock\n    ttlockClientId: '',\n    ttlockClientSecret: '',\n    ttlockApiUrl: 'https://open.ttlock.com',\n    \n    // SIRE\n    sireApiUrl: '',\n    sireApiKey: '',\n    sireApiSecret: '',\n    sireEnabled: false,\n    sireAutoRegisterOnCheckIn: false,\n    sirePropertyCode: '',\n    \n    // Bold Payment\n    boldPaymentApiKey: '',\n    boldPaymentMerchantId: '',\n    boldPaymentEnvironment: 'sandbox' as 'sandbox' | 'production',\n    \n    // WhatsApp\n    whatsappProvider: 'twilio' as 'twilio' | 'whatsapp-business-api',\n    whatsappApiKey: '',\n    whatsappApiSecret: '',\n    whatsappPhoneNumberId: ''\n  });\n  const [showSecrets, setShowSecrets] = useState<Record<string, boolean>>({});\n\n  useEffect(() => {\n    if (organization?.settings) {\n      const settings = organization.settings as OrganizationSettings;\n      const lobbyPms = settings.lobbyPms || {};\n      const doorSystem = settings.doorSystem || {};\n      const sire = settings.sire || {};\n      const boldPayment = settings.boldPayment || {};\n      const whatsapp = settings.whatsapp || {};\n      \n      setApiSettings({\n        lobbyPmsApiKey: lobbyPms.apiKey || '',\n        lobbyPmsPropertyId: lobbyPms.propertyId || '',\n        lobbyPmsSyncEnabled: lobbyPms.syncEnabled || false,\n        lobbyPmsAutoCreateTasks: lobbyPms.autoCreateTasks || false,\n        lobbyPmsLateCheckInThreshold: lobbyPms.lateCheckInThreshold || '22:00',\n        \n        ttlockClientId: doorSystem.clientId || '',\n        ttlockClientSecret: doorSystem.clientSecret || '',\n        ttlockApiUrl: doorSystem.apiUrl || 'https://open.ttlock.com',\n        \n        sireApiUrl: sire.apiUrl || '',\n        sireApiKey: sire.apiKey || '',\n        sireApiSecret: sire.apiSecret || '',\n        sireEnabled: sire.enabled || false,\n        sireAutoRegisterOnCheckIn: sire.autoRegisterOnCheckIn || false,\n        sirePropertyCode: sire.propertyCode || '',\n        \n        boldPaymentApiKey: boldPayment.apiKey || '',\n        boldPaymentMerchantId: boldPayment.merchantId || '',\n        boldPaymentEnvironment: boldPayment.environment || 'sandbox',\n        \n        whatsappProvider: (whatsapp.provider as 'twilio' | 'whatsapp-business-api') || 'twilio',\n        whatsappApiKey: whatsapp.apiKey || '',\n        whatsappApiSecret: whatsapp.apiSecret || '',\n        whatsappPhoneNumberId: whatsapp.phoneNumberId || ''\n      });\n    }\n  }, [organization]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value, type } = e.target;\n    const checked = (e.target as HTMLInputElement).checked;\n    \n    setApiSettings(prev => ({\n      ...prev,\n      [name]: type === 'checkbox' ? checked : value\n    }));\n  };\n\n  const toggleShowSecret = (key: string) => {\n    setShowSecrets(prev => ({\n      ...prev,\n      [key]: !prev[key]\n    }));\n  };\n\n  const handleClear = () => {\n    setApiSettings({\n      lobbyPmsApiKey: '',\n      lobbyPmsPropertyId: '',\n      lobbyPmsSyncEnabled: false,\n      lobbyPmsAutoCreateTasks: false,\n      lobbyPmsLateCheckInThreshold: '22:00',\n      ttlockClientId: '',\n      ttlockClientSecret: '',\n      ttlockApiUrl: 'https://open.ttlock.com',\n      sireApiUrl: '',\n      sireApiKey: '',\n      sireApiSecret: '',\n      sireEnabled: false,\n      sireAutoRegisterOnCheckIn: false,\n      sirePropertyCode: '',\n        boldPaymentApiKey: '',\n        boldPaymentMerchantId: '',\n        boldPaymentEnvironment: 'sandbox',\n        whatsappProvider: 'twilio' as 'twilio' | 'whatsapp-business-api',\n        whatsappApiKey: '',\n        whatsappApiSecret: '',\n        whatsappPhoneNumberId: ''\n    });\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    //  VALIDIERUNG: Prfe Pflichtfelder\n    if (apiSettings.lobbyPmsSyncEnabled) {\n      if (!apiSettings.lobbyPmsApiKey) {\n        showMessage(t('organization.api.validation.apiKeyRequired'), 'error');\n        return;\n      }\n    }\n\n    //  URL-VALIDIERUNG: Prfe alle URLs\n    if (apiSettings.ttlockApiUrl && !validateApiUrl(apiSettings.ttlockApiUrl, 'ttlock')) {\n      showMessage(t('organization.api.validation.invalidUrl'), 'error');\n      return;\n    }\n    if (apiSettings.sireApiUrl && !validateApiUrl(apiSettings.sireApiUrl, 'sire')) {\n      showMessage(t('organization.api.validation.invalidUrl'), 'error');\n      return;\n    }\n\n    //  ZEITFORMAT-VALIDIERUNG: Prfe lateCheckInThreshold\n    if (apiSettings.lobbyPmsLateCheckInThreshold && !/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(apiSettings.lobbyPmsLateCheckInThreshold)) {\n      showMessage(t('organization.api.validation.invalidTimeFormat'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      \n      const currentSettings = (organization?.settings || {}) as OrganizationSettings;\n      const settings: OrganizationSettings = {\n        ...currentSettings,\n        lobbyPms: {\n          ...currentSettings.lobbyPms,\n          apiUrl: LOBBYPMS_API_URL, // Feste URL\n          apiKey: apiSettings.lobbyPmsApiKey || undefined,\n          propertyId: apiSettings.lobbyPmsPropertyId || undefined,\n          syncEnabled: apiSettings.lobbyPmsSyncEnabled,\n          autoCreateTasks: apiSettings.lobbyPmsAutoCreateTasks,\n          lateCheckInThreshold: apiSettings.lobbyPmsLateCheckInThreshold || undefined\n        },\n        doorSystem: {\n          ...currentSettings.doorSystem,\n          provider: 'ttlock' as const,\n          apiUrl: apiSettings.ttlockApiUrl || undefined,\n          clientId: apiSettings.ttlockClientId || undefined,\n          clientSecret: apiSettings.ttlockClientSecret || undefined\n        },\n        sire: {\n          ...currentSettings.sire,\n          apiUrl: apiSettings.sireApiUrl || undefined,\n          apiKey: apiSettings.sireApiKey || undefined,\n          apiSecret: apiSettings.sireApiSecret || undefined,\n          enabled: apiSettings.sireEnabled,\n          autoRegisterOnCheckIn: apiSettings.sireAutoRegisterOnCheckIn,\n          propertyCode: apiSettings.sirePropertyCode || undefined\n        },\n        boldPayment: {\n          ...currentSettings.boldPayment,\n          apiKey: apiSettings.boldPaymentApiKey || undefined,\n          merchantId: apiSettings.boldPaymentMerchantId || undefined,\n          environment: apiSettings.boldPaymentEnvironment\n        },\n        whatsapp: {\n          ...currentSettings.whatsapp,\n          provider: apiSettings.whatsappProvider,\n          apiKey: apiSettings.whatsappApiKey || undefined,\n          apiSecret: apiSettings.whatsappApiSecret || undefined,\n          phoneNumberId: apiSettings.whatsappPhoneNumberId || undefined\n        }\n      };\n\n      await organizationService.updateOrganization({\n        settings: settings\n      });\n      \n      showMessage(t('organization.api.saveSuccess'), 'success');\n      if (onSave) {\n        onSave();\n      }\n    } catch (error: any) {\n      console.error('Error saving API settings:', error);\n      \n      // Detaillierte Fehlermeldung\n      let errorMessage = t('organization.api.saveError');\n      \n      if (error.response?.data) {\n        const data = error.response.data;\n        \n        // Spezifische Fehlermeldung vom Backend\n        if (data.message) {\n          errorMessage = data.message;\n        }\n        \n        // Validierungsfehler anzeigen\n        if (data.errors && Array.isArray(data.errors)) {\n          const validationErrors = data.errors\n            .map((err: any) => `${err.path?.join('.') || ''}: ${err.message || ''}`)\n            .filter((msg: string) => msg)\n            .join(', ');\n          \n          if (validationErrors) {\n            errorMessage += ` (${validationErrors})`;\n          }\n          \n          // URL-Fehler anzeigen (wenn errors Strings sind)\n          if (data.errors.length > 0 && typeof data.errors[0] === 'string') {\n            errorMessage = data.errors.join(', ');\n          }\n        }\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      \n      showMessage(errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const SecretInput: React.FC<{\n    name: string;\n    value: string;\n    onChange: (e: React.ChangeEvent<HTMLInputElement>) => void;\n    placeholder?: string;\n    label: string;\n    required?: boolean;\n  }> = ({ name, value, onChange, placeholder, label, required = false }) => {\n    const showSecret = showSecrets[name] || false;\n    \n    return (\n      <div>\n        <label htmlFor={name} className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {label} {required && <span className=\"text-red-500\">*</span>}\n        </label>\n        <div className=\"relative\">\n          <input\n            type={showSecret ? 'text' : 'password'}\n            id={name}\n            name={name}\n            value={value}\n            onChange={onChange}\n            placeholder={placeholder || ''}\n            required={required}\n            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n          />\n          <button\n            type=\"button\"\n            onClick={() => toggleShowSecret(name)}\n            className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            {showSecret ? (\n              <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n              </svg>\n            ) : (\n              <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n              </svg>\n            )}\n          </button>\n        </div>\n      </div>\n    );\n  };\n\n  //  BERECHTIGUNGSPRFUNG\n  if (permissionsLoading) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <ArrowPathIcon className=\"h-6 w-6 animate-spin text-gray-400\" />\n        <span className=\"ml-3 text-gray-600 dark:text-gray-400\">{t('common.loadingPermissions')}</span>\n      </div>\n    );\n  }\n\n  if (!canManageOrganization()) {\n    return (\n      <div className=\"text-center py-8\">\n        <p className=\"text-gray-500 dark:text-gray-400\">{t('organization.api.noPermission')}</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center gap-2 mb-4\">\n        <KeyIcon className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n          {t('organization.api.title')}\n        </h3>\n      </div>\n\n      <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\n        {t('organization.api.description')}\n      </p>\n\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {/* LobbyPMS */}\n        <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n          <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n            {t('organization.api.lobbyPms.title')}\n          </h4>\n          \n          <div className=\"space-y-4\">\n            <SecretInput\n              name=\"lobbyPmsApiKey\"\n              value={apiSettings.lobbyPmsApiKey}\n              onChange={handleChange}\n              label={t('organization.api.lobbyPms.apiKey')}\n              placeholder=\"API Token\"\n            />\n\n            <div>\n              <label htmlFor=\"lobbyPmsPropertyId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.lobbyPms.propertyId')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"lobbyPmsPropertyId\"\n                name=\"lobbyPmsPropertyId\"\n                value={apiSettings.lobbyPmsPropertyId}\n                onChange={handleChange}\n                placeholder=\"Property ID\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <label className=\"flex items-center\">\n                <input\n                  type=\"checkbox\"\n                  name=\"lobbyPmsSyncEnabled\"\n                  checked={apiSettings.lobbyPmsSyncEnabled}\n                  onChange={handleChange}\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n                <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                  {t('organization.api.lobbyPms.syncEnabled')}\n                </span>\n              </label>\n\n              <label className=\"flex items-center\">\n                <input\n                  type=\"checkbox\"\n                  name=\"lobbyPmsAutoCreateTasks\"\n                  checked={apiSettings.lobbyPmsAutoCreateTasks}\n                  onChange={handleChange}\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n                <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                  {t('organization.api.lobbyPms.autoCreateTasks')}\n                </span>\n              </label>\n            </div>\n\n            <div>\n              <label htmlFor=\"lobbyPmsLateCheckInThreshold\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.lobbyPms.lateCheckInThreshold')}\n              </label>\n              <input\n                type=\"time\"\n                id=\"lobbyPmsLateCheckInThreshold\"\n                name=\"lobbyPmsLateCheckInThreshold\"\n                value={apiSettings.lobbyPmsLateCheckInThreshold}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* TTLock */}\n        <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n          <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n            {t('organization.api.ttlock.title')}\n          </h4>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"ttlockApiUrl\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.ttlock.apiUrl')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"ttlockApiUrl\"\n                name=\"ttlockApiUrl\"\n                value={apiSettings.ttlockApiUrl}\n                onChange={handleChange}\n                placeholder=\"https://open.ttlock.com\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"ttlockClientId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.ttlock.clientId')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"ttlockClientId\"\n                name=\"ttlockClientId\"\n                value={apiSettings.ttlockClientId}\n                onChange={handleChange}\n                placeholder=\"Client ID\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <SecretInput\n              name=\"ttlockClientSecret\"\n              value={apiSettings.ttlockClientSecret}\n              onChange={handleChange}\n              label={t('organization.api.ttlock.clientSecret')}\n              placeholder=\"Client Secret\"\n            />\n          </div>\n        </div>\n\n        {/* SIRE */}\n        <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n          <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n            {t('organization.api.sire.title')}\n          </h4>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"sireApiUrl\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.sire.apiUrl')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"sireApiUrl\"\n                name=\"sireApiUrl\"\n                value={apiSettings.sireApiUrl}\n                onChange={handleChange}\n                placeholder=\"https://api.sire.gov.co\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <SecretInput\n              name=\"sireApiKey\"\n              value={apiSettings.sireApiKey}\n              onChange={handleChange}\n              label={t('organization.api.sire.apiKey')}\n              placeholder=\"API Key\"\n            />\n\n            <SecretInput\n              name=\"sireApiSecret\"\n              value={apiSettings.sireApiSecret}\n              onChange={handleChange}\n              label={t('organization.api.sire.apiSecret')}\n              placeholder=\"API Secret\"\n            />\n\n            <div>\n              <label htmlFor=\"sirePropertyCode\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.sire.propertyCode')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"sirePropertyCode\"\n                name=\"sirePropertyCode\"\n                value={apiSettings.sirePropertyCode}\n                onChange={handleChange}\n                placeholder=\"Property Code\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <label className=\"flex items-center\">\n                <input\n                  type=\"checkbox\"\n                  name=\"sireEnabled\"\n                  checked={apiSettings.sireEnabled}\n                  onChange={handleChange}\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n                <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                  {t('organization.api.sire.enabled')}\n                </span>\n              </label>\n\n              <label className=\"flex items-center\">\n                <input\n                  type=\"checkbox\"\n                  name=\"sireAutoRegisterOnCheckIn\"\n                  checked={apiSettings.sireAutoRegisterOnCheckIn}\n                  onChange={handleChange}\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n                <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                  {t('organization.api.sire.autoRegisterOnCheckIn')}\n                </span>\n              </label>\n            </div>\n          </div>\n        </div>\n\n        {/* Bold Payment */}\n        <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n          <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n            {t('organization.api.boldPayment.title')}\n          </h4>\n          \n          <div className=\"space-y-4\">\n            <SecretInput\n              name=\"boldPaymentApiKey\"\n              value={apiSettings.boldPaymentApiKey}\n              onChange={handleChange}\n              label={t('organization.api.boldPayment.apiKey')}\n              placeholder=\"API Key\"\n            />\n\n            <div>\n              <label htmlFor=\"boldPaymentMerchantId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.boldPayment.merchantId')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"boldPaymentMerchantId\"\n                name=\"boldPaymentMerchantId\"\n                value={apiSettings.boldPaymentMerchantId}\n                onChange={handleChange}\n                placeholder=\"Merchant ID\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"boldPaymentEnvironment\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.boldPayment.environment')}\n              </label>\n              <select\n                id=\"boldPaymentEnvironment\"\n                name=\"boldPaymentEnvironment\"\n                value={apiSettings.boldPaymentEnvironment}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              >\n                <option value=\"sandbox\">{t('organization.api.boldPayment.sandbox')}</option>\n                <option value=\"production\">{t('organization.api.boldPayment.production')}</option>\n              </select>\n            </div>\n          </div>\n        </div>\n\n        {/* WhatsApp */}\n        <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n          <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n            {t('organization.api.whatsapp.title')}\n          </h4>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"whatsappProvider\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.whatsapp.provider')}\n              </label>\n              <select\n                id=\"whatsappProvider\"\n                name=\"whatsappProvider\"\n                value={apiSettings.whatsappProvider}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              >\n                <option value=\"twilio\">{t('organization.api.whatsapp.providerTwilio')}</option>\n                <option value=\"whatsapp-business-api\">{t('organization.api.whatsapp.providerBusinessApi')}</option>\n              </select>\n            </div>\n\n            <SecretInput\n              name=\"whatsappApiKey\"\n              value={apiSettings.whatsappApiKey}\n              onChange={handleChange}\n              label={t('organization.api.whatsapp.apiKey')}\n              placeholder=\"API Key / Access Token\"\n            />\n\n            <SecretInput\n              name=\"whatsappApiSecret\"\n              value={apiSettings.whatsappApiSecret}\n              onChange={handleChange}\n              label={t('organization.api.whatsapp.apiSecret')}\n              placeholder=\"API Secret (optional)\"\n            />\n\n            <div>\n              <label htmlFor=\"whatsappPhoneNumberId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.whatsapp.phoneNumberId')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"whatsappPhoneNumberId\"\n                name=\"whatsappPhoneNumberId\"\n                value={apiSettings.whatsappPhoneNumberId}\n                onChange={handleChange}\n                placeholder=\"Phone Number ID\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"flex justify-end gap-2 pt-4\">\n          <button\n            type=\"button\"\n            onClick={handleClear}\n            className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\n          >\n            {t('organization.api.clear')}\n          </button>\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 dark:bg-blue-700 rounded-md hover:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\n          >\n            {loading ? (\n              <>\n                <ArrowPathIcon className=\"h-4 w-4 animate-spin\" />\n                {t('organization.saving')}\n              </>\n            ) : (\n              <>\n                <CheckIcon className=\"h-4 w-4\" />\n                {t('common.save')}\n              </>\n            )}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default ApiConfigurationTab;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { UpdateOrganizationRequest, Organization } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\nimport { useLanguage } from '../../hooks/useLanguage.ts';\nimport RoleConfigurationTab from './RoleConfigurationTab.tsx';\nimport DocumentConfigurationTab from './DocumentConfigurationTab.tsx';\nimport SMTPConfigurationTab from './SMTPConfigurationTab.tsx';\nimport ApiConfigurationTab from './ApiConfigurationTab.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n  organization: Organization | null;\n}\n\nconst EditOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess, organization }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<UpdateOrganizationRequest>({\n    displayName: '',\n    domain: '',\n    logo: '',\n    country: null,\n    nit: null,\n    settings: {}\n  });\n  const [selectedCountry, setSelectedCountry] = useState<string>('');\n  const [nit, setNit] = useState<string>('');\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  const { organizationLanguage, setOrganizationLanguage } = useLanguage();\n  const [selectedOrgLanguage, setSelectedOrgLanguage] = useState<string>('');\n  const [savingOrgLanguage, setSavingOrgLanguage] = useState<boolean>(false);\n  const [activeTab, setActiveTab] = useState<'general' | 'roles' | 'documents' | 'smtp' | 'api'>('general');\n\n  // Lnder-Liste\n  const COUNTRIES = [\n    { code: 'CO', name: t('countries.CO') },\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'DE', name: t('countries.DE') },\n    { code: 'AT', name: t('countries.AT') }\n  ];\n\n  // Lade Organisations-Daten wenn Modal geffnet wird\n  useEffect(() => {\n    if (isOpen && organization) {\n      const orgSettings = organization.settings || {};\n      setFormData({\n        displayName: organization.displayName || '',\n        domain: organization.domain || '',\n        logo: organization.logo || '',\n        country: organization.country || null,\n        nit: organization.nit || null,\n        settings: orgSettings\n      });\n      \n      // Setze Land direkt aus organization (statt aus settings)\n      setSelectedCountry(organization.country || '');\n      setNit(organization.nit || '');\n      \n      // Lade Organisation-Sprache\n      const loadOrgLanguage = async () => {\n        try {\n          const langResponse = await organizationService.getOrganizationLanguage();\n          setSelectedOrgLanguage(langResponse.language || '');\n        } catch (langError) {\n          console.error(t('organization.loadLanguageError'), langError);\n          setSelectedOrgLanguage('');\n        }\n      };\n      \n      loadOrgLanguage();\n    }\n  }, [isOpen, organization, t]);\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    if (name === 'country') {\n      setSelectedCountry(value);\n      setFormData(prev => ({\n        ...prev,\n        country: value || null\n      }));\n      // Wenn Country nicht \"CO\" ist, NIT zurcksetzen\n      if (value !== 'CO') {\n        setNit('');\n        setFormData(prev => ({\n          ...prev,\n          nit: null\n        }));\n      }\n    } else if (name === 'nit') {\n      setNit(value);\n      setFormData(prev => ({\n        ...prev,\n        nit: value || null\n      }));\n    } else {\n      setFormData(prev => ({ ...prev, [name]: value }));\n    }\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    try {\n      setLoading(true);\n      setErrors({});\n      await organizationService.updateOrganization(formData);\n      showMessage(t('organization.updateSuccess'), 'success');\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.updateError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    if (organization) {\n      const orgSettings = organization.settings || {};\n      setFormData({\n        displayName: organization.displayName || '',\n        domain: organization.domain || '',\n        logo: organization.logo || '',\n        country: organization.country || null,\n        nit: organization.nit || null,\n        settings: orgSettings\n      });\n      setSelectedCountry(organization.country || '');\n      setNit(organization.nit || '');\n    }\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.edit.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label \n                    htmlFor=\"displayName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.displayName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"displayName\"\n                    name=\"displayName\"\n                    value={formData.displayName || ''}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.displayName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.displayName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"domain\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.domain')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"domain\"\n                    name=\"domain\"\n                    value={formData.domain || ''}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"logo\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.logoUrl')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"logo\"\n                    name=\"logo\"\n                    value={formData.logo || ''}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n\n                {/* Land */}\n                <div className=\"border-t pt-4\">\n                  <label \n                    htmlFor=\"country\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.country')}\n                  </label>\n                  <select\n                    id=\"country\"\n                    name=\"country\"\n                    value={selectedCountry}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  >\n                    <option value=\"\">{t('organization.selectCountry')}</option>\n                    {COUNTRIES.map((country) => (\n                      <option key={country.code} value={country.code}>\n                        {country.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                {/* Organisation-Sprache */}\n                <div className=\"border-t pt-4\">\n                  <label \n                    htmlFor=\"organizationLanguage\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.language')}\n                  </label>\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\n                    {t('organization.languageDescription')}\n                  </p>\n                  <select\n                    id=\"organizationLanguage\"\n                    value={selectedOrgLanguage || organizationLanguage || ''}\n                    onChange={async (e) => {\n                      const newLanguage = e.target.value;\n                      setSelectedOrgLanguage(newLanguage);\n                      if (newLanguage && newLanguage !== organizationLanguage) {\n                        setSavingOrgLanguage(true);\n                        try {\n                          await setOrganizationLanguage(newLanguage);\n                          showMessage(t('common.save'), 'success');\n                        } catch (error) {\n                          console.error(t('organization.saveLanguageError'), error);\n                          showMessage(t('worktime.messages.orgLanguageError'), 'error');\n                        } finally {\n                          setSavingOrgLanguage(false);\n                        }\n                      }\n                    }}\n                    disabled={savingOrgLanguage || loading}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed\"\n                  >\n                    <option value=\"\">{t('settings.useOrganizationLanguage')} ({t('worktime.language.fallback')}: {t('worktime.language.german')})</option>\n                    <option value=\"de\">{t('worktime.language.german')}</option>\n                    <option value=\"es\">{t('worktime.language.spanish')}</option>\n                    <option value=\"en\">{t('worktime.language.english')}</option>\n                  </select>\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.saving') : t('common.save')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.edit.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        {/* Tabs Navigation */}\n        <div className=\"border-b border-gray-200 dark:border-gray-700\">\n          <nav className=\"-mb-px flex space-x-4 px-4\" aria-label=\"Tabs\">\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('general')}\n              className={`${\n                activeTab === 'general'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.general')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('roles')}\n              className={`${\n                activeTab === 'roles'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.roles')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('documents')}\n              className={`${\n                activeTab === 'documents'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.documents')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('smtp')}\n              className={`${\n                activeTab === 'smtp'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.smtp')}\n            </button>\n            {selectedCountry === 'CO' && (\n              <button\n                type=\"button\"\n                onClick={() => setActiveTab('api')}\n                className={`${\n                  activeTab === 'api'\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n              >\n                {t('organization.tabs.api')}\n              </button>\n            )}\n          </nav>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          {activeTab === 'general' && (\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label \n                htmlFor=\"displayName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.displayName')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"displayName\"\n                name=\"displayName\"\n                value={formData.displayName || ''}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.displayName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.displayName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"domain\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.domain')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"domain\"\n                name=\"domain\"\n                value={formData.domain || ''}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"logo\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.logoUrl')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"logo\"\n                name=\"logo\"\n                value={formData.logo || ''}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            {/* Land */}\n            <div className=\"border-t pt-4\">\n              <label \n                htmlFor=\"country\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.country')}\n              </label>\n              <select\n                id=\"country\"\n                name=\"country\"\n                value={selectedCountry}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              >\n                <option value=\"\">{t('organization.selectCountry')}</option>\n                {COUNTRIES.map((country) => (\n                  <option key={country.code} value={country.code}>\n                    {country.name}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            {/* NIT (nur fr Kolumbien) */}\n            {selectedCountry === 'CO' && (\n              <div>\n                <label \n                  htmlFor=\"nit\" \n                  className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                >\n                  {t('organization.nit')}\n                </label>\n                <input\n                  type=\"text\"\n                  id=\"nit\"\n                  name=\"nit\"\n                  value={nit}\n                  onChange={handleChange}\n                  placeholder={t('organization.nitDescription')}\n                  className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('organization.nitDescription')}\n                </p>\n              </div>\n            )}\n\n            {/* Organisation-Sprache */}\n            <div className=\"border-t pt-4\">\n              <label \n                htmlFor=\"organizationLanguage\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.language')}\n              </label>\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\n                {t('organization.languageDescription')}\n              </p>\n              <select\n                id=\"organizationLanguage\"\n                value={selectedOrgLanguage || organizationLanguage || ''}\n                onChange={async (e) => {\n                  const newLanguage = e.target.value;\n                  setSelectedOrgLanguage(newLanguage);\n                  if (newLanguage && newLanguage !== organizationLanguage) {\n                    setSavingOrgLanguage(true);\n                    try {\n                      await setOrganizationLanguage(newLanguage);\n                      showMessage(t('common.save'), 'success');\n                    } catch (error) {\n                      console.error('Fehler beim Speichern der Organisation-Sprache:', error);\n                      showMessage(t('worktime.messages.orgLanguageError'), 'error');\n                    } finally {\n                      setSavingOrgLanguage(false);\n                    }\n                  }\n                }}\n                disabled={savingOrgLanguage || loading}\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed\"\n              >\n                <option value=\"\">{t('settings.useOrganizationLanguage')} ({t('worktime.language.fallback')}: {t('worktime.language.german')})</option>\n                <option value=\"de\">{t('worktime.language.german')}</option>\n                <option value=\"es\">{t('worktime.language.spanish')}</option>\n                <option value=\"en\">{t('worktime.language.english')}</option>\n              </select>\n            </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.saving') : t('common.save')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          )}\n\n          {activeTab === 'roles' && (\n            <RoleConfigurationTab \n              organization={organization}\n              onSave={() => {\n                if (onSuccess) {\n                  onSuccess();\n                }\n              }}\n            />\n          )}\n\n          {activeTab === 'documents' && (\n            <DocumentConfigurationTab \n              organization={organization}\n              onSave={() => {\n                if (onSuccess) {\n                  onSuccess();\n                }\n              }}\n            />\n          )}\n\n          {activeTab === 'smtp' && (\n            <SMTPConfigurationTab \n              organization={organization}\n              onSave={() => {\n                if (onSuccess) {\n                  onSuccess();\n                }\n              }}\n            />\n          )}\n\n          {activeTab === 'api' && selectedCountry === 'CO' && (\n            <ApiConfigurationTab \n              organization={organization}\n              onSave={() => {\n                if (onSuccess) {\n                  onSuccess();\n                }\n              }}\n            />\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default EditOrganizationModal;\n\n","import React, { useState, useEffect, useMemo, useRef } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { XMarkIcon, ArrowPathIcon, FunnelIcon } from '@heroicons/react/24/outline';\r\nimport { organizationService } from '../../services/organizationService.ts';\r\nimport { OrganizationJoinRequest } from '../../types/organization.ts';\r\nimport useMessage from '../../hooks/useMessage.ts';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport FilterPane from '../FilterPane.tsx';\r\nimport SavedFilterTags from '../SavedFilterTags.tsx';\r\nimport { FilterCondition } from '../FilterRow.tsx';\r\nimport axiosInstance from '../../config/axios.ts';\r\n\r\n// Status-Badge Funktionen\r\nconst getStatusColor = (status: string) => {\r\n  switch (status) {\r\n    case 'pending':\r\n      return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';\r\n    case 'approved':\r\n      return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\r\n    case 'rejected':\r\n      return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\r\n    case 'withdrawn':\r\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\r\n    default:\r\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\r\n  }\r\n};\r\n\r\nconst getStatusText = (status: string, t: any) => {\r\n  switch (status) {\r\n    case 'pending':\r\n      return t('joinRequestsList.status.pending');\r\n    case 'approved':\r\n      return t('joinRequestsList.status.approved');\r\n    case 'rejected':\r\n      return t('joinRequestsList.status.rejected');\r\n    case 'withdrawn':\r\n      return t('joinRequestsList.status.withdrawn');\r\n    default:\r\n      return status;\r\n  }\r\n};\r\n\r\nconst MY_JOIN_REQUESTS_TABLE_ID = 'my-join-requests-table';\r\n\r\nconst MyJoinRequestsList: React.FC = () => {\r\n  const { t } = useTranslation();\r\n  const [joinRequests, setJoinRequests] = useState<OrganizationJoinRequest[]>([]);\r\n  const [loading, setLoading] = useState<boolean>(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState<boolean>(false);\r\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\r\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState<string>('');\r\n  const { showMessage } = useMessage();\r\n  const mountedRef = useRef(true);\r\n  const [withdrawingId, setWithdrawingId] = useState<number | null>(null);\r\n  \r\n  // Filter State Management (Controlled Mode)\r\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\r\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      mountedRef.current = false;\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log('MyJoinRequestsList: useEffect called - component mounted');\r\n    \r\n    // WICHTIG: State beim Mount zurcksetzen, um Caching zwischen Usern zu vermeiden\r\n    console.log('MyJoinRequestsList: Resetting state on mount to prevent data leaks');\r\n    setJoinRequests([]);\r\n    setError(null);\r\n    setLoading(true);\r\n    \r\n    let isMounted = true;\r\n    \r\n    const fetchMyJoinRequests = async () => {\r\n      if (!isMounted) {\r\n        console.log('MyJoinRequestsList: Component unmounted, skipping fetch');\r\n        return;\r\n      }\r\n      \r\n      console.log('MyJoinRequestsList: Starting fetch');\r\n      \r\n      // Timeout nach 10 Sekunden\r\n      const timeoutId = setTimeout(() => {\r\n        if (isMounted) {\r\n          console.error('Request timeout after 10 seconds');\r\n          setError('Anfrage dauert zu lange. Bitte Seite neu laden.');\r\n          setLoading(false);\r\n        }\r\n      }, 10000);\r\n      \r\n      try {\r\n        console.log('MyJoinRequestsList: Setting loading to true');\r\n        setLoading(true);\r\n        setError(null);\r\n        \r\n        // Debug: Log die URL die aufgerufen wird\r\n        console.log('MyJoinRequestsList: Fetching my join requests from:', API_ENDPOINTS.ORGANIZATIONS.MY_JOIN_REQUESTS);\r\n        \r\n        const requests = await organizationService.getMyJoinRequests();\r\n        \r\n        console.log('MyJoinRequestsList: Received requests:', requests);\r\n        console.log('MyJoinRequestsList: Requests type:', typeof requests);\r\n        console.log('MyJoinRequestsList: Requests isArray:', Array.isArray(requests));\r\n        console.log('MyJoinRequestsList: Requests length:', requests?.length || 0);\r\n        \r\n        // SICHERHEIT: Validiere, dass alle Anfragen wirklich Arrays sind\r\n        if (!Array.isArray(requests)) {\r\n          console.error(' MyJoinRequestsList: Response is not an array!', requests);\r\n          throw new Error('Ungltige Antwort vom Server');\r\n        }\r\n        \r\n        clearTimeout(timeoutId);\r\n        \r\n        // State immer setzen, auch wenn Component unmounted ist\r\n        // (React kann den State trotzdem setzen, wenn Component wieder gemountet wird)\r\n        if (isMounted) {\r\n          console.log('MyJoinRequestsList: Setting joinRequests state');\r\n          setJoinRequests(requests);\r\n          console.log('MyJoinRequestsList: State updated with', requests.length, 'requests');\r\n        } else {\r\n          console.log('MyJoinRequestsList: Component was unmounted, but setting state anyway');\r\n          setJoinRequests(requests);\r\n        }\r\n      } catch (err: any) {\r\n        clearTimeout(timeoutId);\r\n        \r\n        if (!isMounted) {\r\n          console.log('MyJoinRequestsList: Component unmounted during error, skipping error handling');\r\n          return;\r\n        }\r\n        \r\n        console.error('MyJoinRequestsList: Error fetching my join requests:', err);\r\n        console.error('MyJoinRequestsList: Error response:', err.response);\r\n        console.error('MyJoinRequestsList: Error status:', err.response?.status);\r\n        console.error('MyJoinRequestsList: Error data:', err.response?.data);\r\n        \r\n        const errorMessage = err.response?.data?.message || err.message || t('myJoinRequests.loadError');\r\n        setError(errorMessage);\r\n        setTimeout(() => {\r\n          showMessage(errorMessage, 'error');\r\n        }, 0);\r\n      } finally {\r\n        if (isMounted) {\r\n          console.log('MyJoinRequestsList: Setting loading to false');\r\n          setLoading(false);\r\n        } else {\r\n          // Auch wenn unmounted, loading auf false setzen\r\n          console.log('MyJoinRequestsList: Component unmounted, but setting loading to false anyway');\r\n          setLoading(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    // IMMER neu laden beim Mount (auch beim Tab-Wechsel zurck)\r\n    fetchMyJoinRequests();\r\n    \r\n    return () => {\r\n      console.log('MyJoinRequestsList: useEffect cleanup - component unmounting');\r\n      isMounted = false;\r\n      mountedRef.current = false;\r\n      // State beim Unmount zurcksetzen\r\n      setJoinRequests([]);\r\n      setError(null);\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const handleWithdraw = async (requestId: number) => {\r\n    if (!window.confirm(t('myJoinRequests.confirmWithdraw'))) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setWithdrawingId(requestId);\r\n      await organizationService.withdrawJoinRequest(requestId);\r\n      \r\n      // Update local state\r\n      setJoinRequests(prev => \r\n        prev.map(req => \r\n          req.id === requestId \r\n            ? { ...req, status: 'withdrawn' as const, processedAt: new Date().toISOString() }\r\n            : req\r\n        )\r\n      );\r\n      \r\n      showMessage(t('myJoinRequests.withdrawSuccess'), 'success');\r\n    } catch (err: any) {\r\n      const errorMessage = err.response?.data?.message || t('myJoinRequests.withdrawError');\r\n      showMessage(errorMessage, 'error');\r\n    } finally {\r\n      setWithdrawingId(null);\r\n    }\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    const date = new Date(dateString);\r\n    return date.toLocaleDateString('de-DE', {\r\n      year: 'numeric',\r\n      month: 'long',\r\n      day: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  // Filter-Funktionen\r\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\r\n    setFilterConditions(conditions);\r\n    setFilterLogicalOperators(operators);\r\n  };\r\n\r\n  const resetFilterConditions = () => {\r\n    setFilterConditions([]);\r\n    setFilterLogicalOperators([]);\r\n    setActiveFilterName('');\r\n    setSelectedFilterId(null);\r\n  };\r\n\r\n  // Filter Change Handler (Controlled Mode)\r\n  const handleFilterChange = (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\r\n    setActiveFilterName(name);\r\n    setSelectedFilterId(id);\r\n    applyFilterConditions(conditions, operators);\r\n  };\r\n\r\n  const getActiveFilterCount = () => {\r\n    return filterConditions.length;\r\n  };\r\n\r\n  // Initialer Default-Filter setzen (Controlled Mode)\r\n  useEffect(() => {\r\n    const setInitialFilter = async () => {\r\n      try {\r\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(MY_JOIN_REQUESTS_TABLE_ID));\r\n        const filters = response.data;\r\n        \r\n        const alleFilter = filters.find((filter: any) => filter.name === 'Alle');\r\n        if (alleFilter) {\r\n          setActiveFilterName('Alle');\r\n          setSelectedFilterId(alleFilter.id);\r\n          applyFilterConditions(alleFilter.conditions, alleFilter.operators);\r\n        }\r\n      } catch (error) {\r\n        console.error('Fehler beim Setzen des initialen Filters:', error);\r\n      }\r\n    };\r\n\r\n    setInitialFilter();\r\n  }, []);\r\n\r\n  // Standard-Filter erstellen und speichern\r\n  useEffect(() => {\r\n    const createStandardFilters = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        \r\n        if (!token) {\r\n          console.error('Nicht authentifiziert');\r\n          return;\r\n        }\r\n\r\n        // Prfen, ob die Standard-Filter bereits existieren\r\n        const existingFiltersResponse = await axiosInstance.get(\r\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(MY_JOIN_REQUESTS_TABLE_ID)\r\n        );\r\n\r\n        const existingFilters = existingFiltersResponse.data || [];\r\n        const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\r\n\r\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\r\n        if (!alleFilterExists) {\r\n          const alleFilter = {\r\n            tableId: MY_JOIN_REQUESTS_TABLE_ID,\r\n            name: 'Alle',\r\n            conditions: [],\r\n            operators: []\r\n          };\r\n\r\n          await axiosInstance.post(\r\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\r\n            alleFilter\r\n          );\r\n          console.log('Alle-Filter fr Meine Beitrittsanfragen erstellt');\r\n        }\r\n      } catch (error) {\r\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\r\n      }\r\n    };\r\n\r\n    createStandardFilters();\r\n  }, []);\r\n\r\n  // Gefilterte Join-Requests\r\n  const filteredJoinRequests = useMemo(() => {\r\n    let filtered = [...joinRequests];\r\n\r\n    // Suchfeld-Filter\r\n    if (searchTerm) {\r\n      const searchLower = searchTerm.toLowerCase();\r\n      filtered = filtered.filter(request => {\r\n        const orgName = (request.organization.displayName || request.organization.name || '').toLowerCase();\r\n        const message = request.message?.toLowerCase() || '';\r\n        return orgName.includes(searchLower) || message.includes(searchLower);\r\n      });\r\n    }\r\n\r\n    // Filter-Bedingungen aus FilterPane\r\n    if (filterConditions.length > 0) {\r\n      filtered = filterConditions.reduce((acc, condition, index) => {\r\n        if (!condition.column || condition.value === null || condition.value === '') {\r\n          return acc;\r\n        }\r\n\r\n        const operator = condition.operator;\r\n        const value = condition.value;\r\n\r\n        return acc.filter(request => {\r\n          switch (condition.column) {\r\n            case 'organization':\r\n              const orgName = (request.organization.displayName || request.organization.name || '').toLowerCase();\r\n              const searchValue = String(value).toLowerCase();\r\n              \r\n              if (operator === 'contains') {\r\n                return orgName.includes(searchValue);\r\n              } else if (operator === 'equals') {\r\n                return orgName === searchValue;\r\n              } else if (operator === 'startsWith') {\r\n                return orgName.startsWith(searchValue);\r\n              }\r\n              return false;\r\n\r\n            case 'message':\r\n              const message = request.message?.toLowerCase() || '';\r\n              const msgValue = String(value).toLowerCase();\r\n              \r\n              if (operator === 'contains') {\r\n                return message.includes(msgValue);\r\n              } else if (operator === 'equals') {\r\n                return message === msgValue;\r\n              } else if (operator === 'startsWith') {\r\n                return message.startsWith(msgValue);\r\n              }\r\n              return false;\r\n\r\n            case 'status':\r\n              if (operator === 'equals') {\r\n                return request.status === value;\r\n              }\r\n              return false;\r\n\r\n            default:\r\n              return true;\r\n          }\r\n        });\r\n      }, filtered);\r\n    }\r\n\r\n    return filtered;\r\n  }, [joinRequests, searchTerm, filterConditions, filterLogicalOperators]);\r\n\r\n  return (\r\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\r\n      {/* Titelzeile mit Icon, Suchfeld, Filter-Button */}\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <h2 className=\"text-xl font-semibold dark:text-white\">\r\n          {t('myJoinRequests.title')}\r\n        </h2>\r\n        \r\n        <div className=\"flex items-center gap-1.5\">\r\n          {/* Suchfeld */}\r\n          <input\r\n            type=\"text\"\r\n            placeholder={t('common.search') || 'Suchen...'}\r\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n          />\r\n\r\n          {/* Filter-Button */}\r\n          <button\r\n            className={`p-2 rounded-md border ${getActiveFilterCount() > 0 ? 'border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\r\n            onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\r\n            title={t('common.filter')}\r\n          >\r\n            <FunnelIcon className=\"h-5 w-5\" />\r\n            {getActiveFilterCount() > 0 && (\r\n              <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\r\n                {getActiveFilterCount()}\r\n              </span>\r\n            )}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filter-Panel */}\r\n      {isFilterPanelOpen && (\r\n        <div className=\"mb-4\">\r\n          <FilterPane\r\n            columns={[\r\n              { id: 'organization', label: t('myJoinRequests.filter.organization') || 'Organisation' },\r\n              { id: 'message', label: t('joinRequestsList.filter.message') },\r\n              { id: 'status', label: t('joinRequestsList.status.title') || 'Status' }\r\n            ]}\r\n            onApply={applyFilterConditions}\r\n            onReset={resetFilterConditions}\r\n            savedConditions={filterConditions}\r\n            savedOperators={filterLogicalOperators}\r\n            tableId={MY_JOIN_REQUESTS_TABLE_ID}\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* Gespeicherte Filter als Tags anzeigen */}\r\n      <SavedFilterTags\r\n        tableId={MY_JOIN_REQUESTS_TABLE_ID}\r\n        onSelectFilter={applyFilterConditions}\r\n        onReset={resetFilterConditions}\r\n        activeFilterName={activeFilterName}\r\n        selectedFilterId={selectedFilterId}\r\n        onFilterChange={handleFilterChange}\r\n        defaultFilterName=\"Alle\"\r\n      />\r\n\r\n      {/* Error Display */}\r\n      {error && (\r\n        <div className=\"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {/* Loading State */}\r\n      {loading ? (\r\n        <div className=\"flex items-center justify-center py-8\">\r\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\r\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('myJoinRequests.loading')}</span>\r\n        </div>\r\n      ) : joinRequests.length === 0 ? (\r\n        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\r\n          {t('myJoinRequests.noRequests')}\r\n        </div>\r\n      ) : (\r\n        /* Cards fr Join-Requests */\r\n        <div className=\"space-y-4\">\r\n          {filteredJoinRequests.map(request => (\r\n            <div\r\n              key={request.id}\r\n              className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\"\r\n            >\r\n              <div className=\"flex items-start justify-between\">\r\n                <div className=\"flex-1\">\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <div>\r\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\r\n                        {request.organization.displayName || request.organization.name}\r\n                      </h3>\r\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                        {formatDate(request.createdAt)}\r\n                      </p>\r\n                    </div>\r\n                    <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(request.status)}`}>\r\n                      {getStatusText(request.status, t)}\r\n                    </span>\r\n                  </div>\r\n\r\n                  {request.message && (\r\n                    <div className=\"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\r\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\r\n                        <span className=\"font-medium\">{t('joinRequestsList.filter.message')}:</span> {request.message}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n\r\n                  {request.response && (\r\n                    <div className=\"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700\">\r\n                      <p className=\"text-sm text-blue-700 dark:text-blue-300\">\r\n                        <span className=\"font-medium\">{t('joinRequestsList.response')}:</span> {request.response}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n\r\n                  {request.processor && (\r\n                    <div className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\r\n                      {t('myJoinRequests.processedBy')}: {request.processor.firstName} {request.processor.lastName}\r\n                      {request.processedAt && ` - ${formatDate(request.processedAt)}`}\r\n                    </div>\r\n                  )}\r\n\r\n                  {request.status === 'pending' && (\r\n                    <div className=\"mt-4 flex items-center gap-2\">\r\n                      <button \r\n                        onClick={() => handleWithdraw(request.id)}\r\n                        disabled={withdrawingId === request.id}\r\n                        className=\"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-md dark:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 flex items-center disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                      >\r\n                        {withdrawingId === request.id ? (\r\n                          <>\r\n                            <ArrowPathIcon className=\"h-4 w-4 mr-1 animate-spin\" />\r\n                            {t('myJoinRequests.withdrawing')}\r\n                          </>\r\n                        ) : (\r\n                          <>\r\n                            <XMarkIcon className=\"h-4 w-4 mr-1\" />\r\n                            {t('myJoinRequests.withdraw')}\r\n                          </>\r\n                        )}\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MyJoinRequestsList;\r\n\r\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { BuildingOfficeIcon, PlusIcon, UserPlusIcon, UserGroupIcon, ShieldCheckIcon, EnvelopeIcon, ChartBarIcon, PencilIcon } from '@heroicons/react/24/outline';\nimport { useTranslation } from 'react-i18next';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { Organization } from '../../types/organization.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useOrganization } from '../../contexts/OrganizationContext.tsx';\nimport CreateOrganizationModal from './CreateOrganizationModal.tsx';\nimport JoinOrganizationModal from './JoinOrganizationModal.tsx';\nimport EditOrganizationModal from './EditOrganizationModal.tsx';\nimport MyJoinRequestsList from './MyJoinRequestsList.tsx';\n\ninterface OrganizationStats {\n  currentUsers: number;\n  maxUsers: number;\n  availableSlots: number;\n  utilizationPercent: number;\n  _count: {\n    roles: number;\n    joinRequests: number;\n    invitations: number;\n  };\n}\n\nconst OrganizationSettings: React.FC = () => {\n  const [organization, setOrganization] = useState<Organization | null>(null);\n  const [stats, setStats] = useState<OrganizationStats | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [loadingStats, setLoadingStats] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState<boolean>(false);\n  const [isJoinModalOpen, setIsJoinModalOpen] = useState<boolean>(false);\n  const [isEditModalOpen, setIsEditModalOpen] = useState<boolean>(false);\n  const { canViewOrganization, canManageOrganization, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  const { t } = useTranslation();\n  const { refreshOrganization } = useOrganization();\n\n  const fetchOrganization = useCallback(async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const org = await organizationService.getCurrentOrganization();\n      setOrganization(org);\n      \n      // Statistiken laden\n      try {\n        setLoadingStats(true);\n        const statsData = await organizationService.getOrganizationStats();\n        setStats(statsData);\n      } catch (statsErr: any) {\n        console.error('Fehler beim Laden der Statistiken:', statsErr);\n        // Statistiken-Fehler nicht kritisch, keine Error-Message\n      } finally {\n        setLoadingStats(false);\n      }\n    } catch (err: any) {\n      // Prfe ob es ein 404-Fehler ist (keine Organisation gefunden)\n      if (err.response?.status === 404 && err.response?.data?.hasOrganization === false) {\n        // Benutzer hat keine Organisation - das ist OK, setze Error aber nicht kritisch\n        // Verwende IMMER die bersetzung, nicht die Backend-Nachricht\n        setError(t('organization.notFound'));\n        setOrganization(null);\n        // Zeige Info-Message statt Error\n        showMessage(t('organization.notFound'), 'info');\n      } else {\n        // Andere Fehler - kritisch\n        const errorMessage = err.response?.data?.message || t('organization.loadError');\n        setError(errorMessage);\n        showMessage(errorMessage, 'error');\n      }\n    } finally {\n      setLoading(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const hasInitialLoadRef = useRef(false);\n\n  useEffect(() => {\n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      return;\n    }\n\n    // Nur einmal beim initialen Load ausfhren\n    if (hasInitialLoadRef.current) {\n      return;\n    }\n\n    const hasPermission = canViewOrganization();\n    if (hasPermission) {\n      hasInitialLoadRef.current = true;\n      fetchOrganization();\n    } else {\n      setError(t('organization.noPermission'));\n      setLoading(false);\n      hasInitialLoadRef.current = true;\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [permissionsLoading]);\n\n  const handleEditSuccess = () => {\n    fetchOrganization();\n    // Aktualisiere auch den OrganizationContext\n    refreshOrganization();\n  };\n\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('common.loadingPermissions')}</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canViewOrganization()) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n          <div className=\"p-4 text-red-600 dark:text-red-400\">\n          {t('organization.noPermission')}\n        </div>\n      </div>\n    );\n  }\n\n  const handleCreateSuccess = () => {\n    fetchOrganization();\n  };\n\n  const handleJoinSuccess = () => {\n    // Nach Beitritt: Organisation neu laden\n    fetchOrganization();\n  };\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        {/* Titelzeile mit Action-Buttons */}\n        <div className=\"flex items-center mb-4 sm:mb-4\">\n          {/* Linke Seite: Action-Buttons */}\n          <div className=\"flex items-center\">\n            {/* Button: Neue Organisation erstellen - immer sichtbar (nicht nur fr Admins) */}\n            <button\n              onClick={() => setIsCreateModalOpen(true)}\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('organization.createOrganization')}\n              aria-label={t('organization.createOrganization')}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n            </button>\n            \n            {/* Button: Organisation beitreten - immer sichtbar */}\n            <button\n              onClick={() => setIsJoinModalOpen(true)}\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center ml-2\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('organization.joinOrganization')}\n              aria-label={t('organization.joinOrganization')}\n            >\n              <UserPlusIcon className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('common.loadingOrganization')}</span>\n        </div>\n      ) : (\n        <>\n          {/* Error/Info Display */}\n          {error && (\n            <div className={`mb-4 p-4 border rounded ${\n              !organization \n                ? 'bg-blue-50 dark:bg-blue-900/30 border-blue-400 dark:border-blue-700 text-blue-700 dark:text-blue-300'\n                : 'bg-red-100 dark:bg-red-900 border-red-400 dark:border-red-700 text-red-700 dark:text-red-300'\n            }`}>\n              <div className=\"flex items-start\">\n                <div className=\"flex-shrink-0\">\n                  {!organization ? (\n                    <UserGroupIcon className=\"h-5 w-5\" />\n                  ) : (\n                    <span className=\"text-red-600 dark:text-red-400\"></span>\n                  )}\n                </div>\n                <div className=\"ml-3 flex-1\">\n                  <p className=\"font-medium\">{error}</p>\n                  {!organization && (\n                    <p className=\"mt-2 text-sm\">{t('organization.createOrJoinHint')}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Card-Ansicht - nur anzeigen wenn Organisation existiert */}\n          {organization ? (\n            <>\n            {/* Card mit Organisations-Infos */}\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-4\">\n            <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white flex items-center\">\n                        <BuildingOfficeIcon className=\"h-5 w-5 mr-2\" />\n                        {organization.displayName || organization.name}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                        {organization.domain || t('organization.noDomain')}\n                      </p>\n            </div>\n                    {canManageOrganization() && (\n                      <button\n                        onClick={() => setIsEditModalOpen(true)}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                        title={t('organization.edit.title')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                      </button>\n                    )}\n            </div>\n\n                  {/* Organisations-Infos */}\n                  <div className=\"space-y-3\">\n                    {organization.subscriptionPlan && (\n            <div>\n                        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">{t('organization.subscriptionPlan')}:</span>\n                        <span className=\"ml-2 text-sm text-gray-900 dark:text-white capitalize\">{organization.subscriptionPlan}</span>\n              </div>\n            )}\n              </div>\n\n                  {/* Statistiken direkt in der Card */}\n          {stats && (\n                    <>\n            <div className=\"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700\">\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">{t('organization.statistics')}</h3>\n              {loadingStats ? (\n                <div className=\"flex items-center justify-center py-4\">\n                  <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-2\"></div>\n                  <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('common.loadingStatistics')}</span>\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {/* Benutzer Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-blue-100 dark:bg-blue-900/30 rounded-lg p-3\">\n                        <UserGroupIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.users')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats.currentUsers} / {stats.maxUsers}\n                        </p>\n                            {stats.utilizationPercent !== undefined && (\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            {stats.utilizationPercent}% {t('organization.utilizationPercent')}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Rollen Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-purple-100 dark:bg-purple-900/30 rounded-lg p-3\">\n                        <ShieldCheckIcon className=\"h-6 w-6 text-purple-600 dark:text-purple-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.roles')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats._count.roles}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Beitrittsanfragen Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg p-3\">\n                        <EnvelopeIcon className=\"h-6 w-6 text-yellow-600 dark:text-yellow-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.joinRequests')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats._count.joinRequests}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Einladungen Card */}\n                  {stats._count.invitations !== undefined && (\n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 bg-green-100 dark:bg-green-900/30 rounded-lg p-3\">\n                          <EnvelopeIcon className=\"h-6 w-6 text-green-600 dark:text-green-400\" />\n                        </div>\n                        <div className=\"ml-4\">\n                          <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.invitations')}</p>\n                          <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                            {stats._count.invitations}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Auslastung Card */}\n                  {stats.utilizationPercent !== undefined && (\n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg p-3\">\n                          <ChartBarIcon className=\"h-6 w-6 text-indigo-600 dark:text-indigo-400\" />\n                        </div>\n                        <div className=\"ml-4\">\n                          <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.utilization')}</p>\n                          <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                            {stats.utilizationPercent}%\n                          </p>\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            {stats.availableSlots} {t('organization.availableSlots')}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n                    </>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            </>\n          ) : (\n            /* Keine Organisation - zeige Hinweis */\n            <div className=\"text-center py-8\">\n            <UserGroupIcon className=\"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500 mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\n              {t('organization.notFound')}\n            </h3>\n            <p className=\"text-gray-600 dark:text-gray-400\">\n              {t('organization.createOrJoinHint')}\n            </p>\n          </div>\n        )}\n        </>\n      )}\n      </div>\n\n      {/* Meine Beitrittsanfragen - immer anzeigen */}\n      <MyJoinRequestsList />\n\n      {/* Modals */}\n      <CreateOrganizationModal\n        isOpen={isCreateModalOpen}\n        onClose={() => setIsCreateModalOpen(false)}\n        onSuccess={handleCreateSuccess}\n      />\n\n      <JoinOrganizationModal\n        isOpen={isJoinModalOpen}\n        onClose={() => setIsJoinModalOpen(false)}\n        onSuccess={handleJoinSuccess}\n      />\n\n      <EditOrganizationModal\n        isOpen={isEditModalOpen}\n        onClose={() => setIsEditModalOpen(false)}\n        onSuccess={handleEditSuccess}\n        organization={organization}\n      />\n    </>\n  );\n};\n\nexport default OrganizationSettings; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon, XCircleIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest, ProcessJoinRequestRequest } from '../../types/organization.ts';\nimport { roleApi } from '../../api/apiClient.ts';\nimport { Role } from '../../types/interfaces.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  joinRequest: OrganizationJoinRequest | null;\n  onSuccess: () => void;\n}\n\nconst ProcessJoinRequestModal: React.FC<Props> = ({ isOpen, onClose, joinRequest, onSuccess }) => {\n  const { t } = useTranslation();\n  const [action, setAction] = useState<'approve' | 'reject'>('approve');\n  const [roleId, setRoleId] = useState<number | null>(null);\n  const [response, setResponse] = useState<string>('');\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState<boolean>(false);\n  const [saving, setSaving] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  useEffect(() => {\n    if (isOpen && joinRequest) {\n      // Reset form when modal opens\n      setAction('approve');\n      setRoleId(null);\n      setResponse('');\n      setErrors({});\n      \n      // Load roles for the organization\n      if (joinRequest.organizationId) {\n        fetchRoles();\n      }\n    }\n  }, [isOpen, joinRequest]);\n\n  const fetchRoles = async () => {\n    try {\n      setLoadingRoles(true);\n      const response = await roleApi.getAll();\n      if (response.data && Array.isArray(response.data)) {\n        setRoles(response.data);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Rollen:', err);\n      showMessage(t('joinRequest.loadRolesError'), 'error');\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (action === 'approve' && !roleId) {\n      newErrors.roleId = t('joinRequest.selectRoleError');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    if (!joinRequest) {\n      return;\n    }\n    \n    try {\n      setSaving(true);\n      const data: ProcessJoinRequestRequest = {\n        action,\n        response: response.trim() || undefined,\n        roleId: action === 'approve' ? roleId || undefined : undefined\n      };\n      \n      await organizationService.processJoinRequest(joinRequest.id, data);\n      showMessage(\n        action === 'approve' ? t('joinRequest.approveSuccess') : t('joinRequest.rejectSuccess'),\n        'success'\n      );\n      \n      // Reset form\n      setAction('approve');\n      setRoleId(null);\n      setResponse('');\n      setErrors({});\n      \n      onClose();\n      onSuccess();\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('joinRequest.processError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleClose = () => {\n    setAction('approve');\n    setRoleId(null);\n    setResponse('');\n    setErrors({});\n    onClose();\n  };\n\n  if (!joinRequest) {\n    return null;\n  }\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('joinRequest.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                {/* Antragsteller Info */}\n                <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                  <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.applicant')}:</p>\n                  <p className=\"text-sm text-gray-900 dark:text-white\">\n                    {joinRequest.requester.firstName} {joinRequest.requester.lastName}\n                  </p>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.requester.email}</p>\n                  {joinRequest.message && (\n                    <div className=\"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.message')}:</p>\n                      <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.message}</p>\n                    </div>\n                  )}\n                </div>\n\n                {/* Aktion (Genehmigen/Ablehnen) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('joinRequest.actionRequired')}\n                  </label>\n                  <div className=\"flex gap-4 mt-2\">\n                    <label className=\"flex items-center\">\n                      <input\n                        type=\"radio\"\n                        value=\"approve\"\n                        checked={action === 'approve'}\n                        onChange={(e) => {\n                          setAction(e.target.value as 'approve' | 'reject');\n                          setErrors({});\n                        }}\n                        className=\"mr-2 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.approve')}</span>\n                    </label>\n                    <label className=\"flex items-center\">\n                      <input\n                        type=\"radio\"\n                        value=\"reject\"\n                        checked={action === 'reject'}\n                        onChange={(e) => {\n                          setAction(e.target.value as 'approve' | 'reject');\n                          setErrors({});\n                        }}\n                        className=\"mr-2 text-red-600 focus:ring-red-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.reject')}</span>\n                    </label>\n                  </div>\n                </div>\n\n                {/* Rollenauswahl (nur bei Genehmigung) */}\n                {action === 'approve' && (\n                  <div>\n                    <label \n                      htmlFor=\"roleId\" \n                      className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                    >\n                      {t('joinRequest.assignRole')}\n                    </label>\n                    {loadingRoles ? (\n                      <div className=\"flex items-center py-2\">\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n                        <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('joinRequest.loadingRoles')}</span>\n                      </div>\n                    ) : (\n                      <select\n                        id=\"roleId\"\n                        value={roleId || ''}\n                        onChange={(e) => {\n                          setRoleId(Number(e.target.value) || null);\n                          if (errors.roleId) {\n                            setErrors(prev => ({ ...prev, roleId: '' }));\n                          }\n                        }}\n                        className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                          errors.roleId \n                            ? 'border-red-300 dark:border-red-600' \n                            : 'border-gray-300 dark:border-gray-600'\n                        }`}\n                      >\n                        <option value=\"\">{t('joinRequest.selectRole')}</option>\n                        {roles.map(role => (\n                          <option key={role.id} value={role.id}>\n                            {role.name} {role.description ? `- ${role.description}` : ''}\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                    {errors.roleId && (\n                      <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.roleId}</p>\n                    )}\n                  </div>\n                )}\n\n                {/* Antwort-Message */}\n                <div>\n                  <label \n                    htmlFor=\"response\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('joinRequest.response')}\n                  </label>\n                  <textarea\n                    id=\"response\"\n                    value={response}\n                    onChange={(e) => setResponse(e.target.value)}\n                    rows={3}\n                    placeholder={t('joinRequest.addOptional', { type: action === 'approve' ? t('joinRequest.welcomeMessage') : t('joinRequest.rejectionReason') })}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={saving}\n                  className={`p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ${\n                    action === 'approve'\n                      ? 'bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500'\n                      : 'bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500'\n                  }`}\n                  title={saving ? (action === 'approve' ? t('joinRequest.approving') : t('joinRequest.rejecting')) : (action === 'approve' ? t('joinRequest.approve') : t('joinRequest.reject'))}\n                >\n                  {saving ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : action === 'approve' ? (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  ) : (\n                    <XCircleIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('joinRequest.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Antragsteller Info */}\n            <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n              <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.applicant')}:</p>\n              <p className=\"text-sm text-gray-900 dark:text-white\">\n                {joinRequest.requester.firstName} {joinRequest.requester.lastName}\n              </p>\n              <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.requester.email}</p>\n              {joinRequest.message && (\n                <div className=\"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600\">\n                  <p className=\"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.message')}:</p>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.message}</p>\n                </div>\n              )}\n            </div>\n\n            {/* Aktion (Genehmigen/Ablehnen) */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('joinRequest.actionRequired')}\n              </label>\n              <div className=\"flex gap-4 mt-2\">\n                <label className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    value=\"approve\"\n                    checked={action === 'approve'}\n                    onChange={(e) => {\n                      setAction(e.target.value as 'approve' | 'reject');\n                      setErrors({});\n                    }}\n                    className=\"mr-2 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.approve')}</span>\n                </label>\n                <label className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    value=\"reject\"\n                    checked={action === 'reject'}\n                    onChange={(e) => {\n                      setAction(e.target.value as 'approve' | 'reject');\n                      setErrors({});\n                    }}\n                    className=\"mr-2 text-red-600 focus:ring-red-500\"\n                  />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.reject')}</span>\n                </label>\n              </div>\n            </div>\n\n            {/* Rollenauswahl (nur bei Genehmigung) */}\n            {action === 'approve' && (\n              <div>\n                <label \n                  htmlFor=\"roleId\" \n                  className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                >\n                  {t('joinRequest.assignRole')}\n                </label>\n                {loadingRoles ? (\n                  <div className=\"flex items-center py-2\">\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n                    <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('joinRequest.loadingRoles')}</span>\n                  </div>\n                ) : (\n                  <select\n                    id=\"roleId\"\n                    value={roleId || ''}\n                    onChange={(e) => {\n                      setRoleId(Number(e.target.value) || null);\n                      if (errors.roleId) {\n                        setErrors(prev => ({ ...prev, roleId: '' }));\n                      }\n                    }}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.roleId \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  >\n                    <option value=\"\">{t('joinRequest.selectRole')}</option>\n                    {roles.map(role => (\n                      <option key={role.id} value={role.id}>\n                        {role.name} {role.description ? `- ${role.description}` : ''}\n                      </option>\n                    ))}\n                  </select>\n                )}\n                {errors.roleId && (\n                  <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.roleId}</p>\n                )}\n              </div>\n            )}\n\n            {/* Antwort-Message */}\n            <div>\n              <label \n                htmlFor=\"response\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('joinRequest.response')}\n              </label>\n              <textarea\n                id=\"response\"\n                value={response}\n                onChange={(e) => setResponse(e.target.value)}\n                rows={3}\n                placeholder={t('joinRequest.addOptional', { type: action === 'approve' ? t('joinRequest.welcomeMessage') : t('joinRequest.rejectionReason') })}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={saving}\n                className={`p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ${\n                  action === 'approve'\n                    ? 'bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500'\n                    : 'bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500'\n                }`}\n                title={saving ? (action === 'approve' ? 'Genehmige...' : 'Lehne ab...') : (action === 'approve' ? 'Genehmigen' : 'Ablehnen')}\n              >\n                {saving ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : action === 'approve' ? (\n                  <CheckIcon className=\"h-5 w-5\" />\n                ) : (\n                  <XCircleIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default ProcessJoinRequestModal;\n\n","import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { UserPlusIcon, FunnelIcon, PencilIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest } from '../../types/organization.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport ProcessJoinRequestModal from './ProcessJoinRequestModal.tsx';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\n\n// Status-Badge Funktionen\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case 'pending':\n      return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';\n    case 'approved':\n      return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\n    case 'rejected':\n      return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\n    case 'withdrawn':\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n    default:\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n  }\n};\n\nconst getStatusText = (status: string, t: any) => {\n  switch (status) {\n    case 'pending':\n      return t('joinRequestsList.status.pending');\n    case 'approved':\n      return t('joinRequestsList.status.approved');\n    case 'rejected':\n      return t('joinRequestsList.status.rejected');\n    case 'withdrawn':\n      return t('joinRequestsList.status.withdrawn');\n    default:\n      return status;\n  }\n};\n\nconst JOIN_REQUESTS_TABLE_ID = 'join-requests-table';\n\nconst JoinRequestsList: React.FC = () => {\n  const { t } = useTranslation();\n  const [joinRequests, setJoinRequests] = useState<OrganizationJoinRequest[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState<boolean>(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [isProcessModalOpen, setIsProcessModalOpen] = useState<boolean>(false);\n  const [selectedRequest, setSelectedRequest] = useState<OrganizationJoinRequest | null>(null);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  const { canViewJoinRequests, canManageJoinRequests, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  const mountedRef = useRef(true);\n  const hasInitialLoadRef = useRef(false);\n\n  // Debug: Log permissionsLoading nderungen\n  useEffect(() => {\n    console.log('[JoinRequestsList] permissionsLoading gendert:', permissionsLoading);\n  }, [permissionsLoading]);\n\n  // Reset beim Mount - wichtig fr Neuladen wenn Komponente neu gemountet wird\n  useEffect(() => {\n    console.log('[JoinRequestsList] Component mounted, reset hasInitialLoadRef');\n    hasInitialLoadRef.current = false;\n    mountedRef.current = true;\n    \n    return () => {\n      console.log('[JoinRequestsList] Component unmounting');\n      mountedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    console.log('[JoinRequestsList] useEffect triggered', { \n      permissionsLoading, \n      hasInitialLoad: hasInitialLoadRef.current,\n      joinRequestsCount: joinRequests.length \n    });\n    \n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      console.log('[JoinRequestsList] Warte auf Berechtigungen...');\n      return;\n    }\n\n    // Prfe Berechtigung direkt\n    const hasPermission = canViewJoinRequests();\n    console.log('[JoinRequestsList] Berechtigung geprft:', hasPermission);\n    \n    if (!hasPermission) {\n      console.log('[JoinRequestsList] Keine Berechtigung zum Anzeigen');\n      setError(t('joinRequestsList.noPermission'));\n      setLoading(false);\n      hasInitialLoadRef.current = true;\n      return;\n    }\n\n    // WICHTIG: Nur laden wenn noch nicht erfolgreich geladen wurde\n    // Das verhindert unntige Re-Fetches bei jedem permissionsLoading-Change\n    if (hasInitialLoadRef.current) {\n      console.log('[JoinRequestsList] Bereits geladen, berspringe Fetch');\n      return;\n    }\n\n    console.log('[JoinRequestsList] Starte Fetch der Join Requests...');\n    \n    const fetchJoinRequests = async () => {\n      if (!mountedRef.current) {\n        console.log('[JoinRequestsList] Component unmounted, breche ab');\n        return;\n      }\n      \n      try {\n        console.log('[JoinRequestsList] Setze loading auf true');\n        setLoading(true);\n        setError(null);\n        \n        console.log('[JoinRequestsList] Rufe organizationService.getJoinRequests() auf...');\n        console.log('[JoinRequestsList] API Endpoint:', API_ENDPOINTS.ORGANIZATIONS.JOIN_REQUESTS);\n        \n        const requests = await organizationService.getJoinRequests();\n        \n        console.log('[JoinRequestsList] Antwort erhalten:', requests);\n        console.log('[JoinRequestsList] Antwort Typ:', typeof requests);\n        console.log('[JoinRequestsList] Ist Array:', Array.isArray(requests));\n        console.log('[JoinRequestsList] Ist null/undefined:', requests === null || requests === undefined);\n        \n        if (!mountedRef.current) {\n          console.log('[JoinRequestsList] Component whrend Request unmounted');\n          return;\n        }\n        \n        // Validiere, dass die Antwort vorhanden ist\n        if (requests === null || requests === undefined) {\n          console.error('[JoinRequestsList]  Antwort ist null oder undefined!');\n          throw new Error('Ungltige Antwort vom Server: Antwort ist null oder undefined');\n        }\n        \n        // Validiere, dass die Antwort ein Array ist\n        if (!Array.isArray(requests)) {\n          console.error('[JoinRequestsList]  Antwort ist kein Array!', requests);\n          throw new Error('Ungltige Antwort vom Server: Erwartetes Array, erhalten: ' + typeof requests);\n        }\n        \n        console.log('[JoinRequestsList]  Setze', requests.length, 'Join Requests');\n        setJoinRequests(requests);\n        setError(null); // Fehler zurcksetzen bei Erfolg\n        hasInitialLoadRef.current = true; // Nur bei Erfolg setzen\n      } catch (err: any) {\n        console.error('[JoinRequestsList]  Fehler beim Laden:', err);\n        console.error('[JoinRequestsList] Fehler Details:', {\n          message: err.message,\n          response: err.response,\n          status: err.response?.status,\n          data: err.response?.data,\n          stack: err.stack\n        });\n        \n        if (!mountedRef.current) {\n          console.log('[JoinRequestsList] Component whrend Error-Handling unmounted');\n          return;\n        }\n        \n        const errorMessage = err.response?.data?.message || err.message || t('joinRequestsList.loadError', { defaultValue: 'Fehler beim Laden der Beitrittsanfragen' });\n        console.log('[JoinRequestsList] Zeige Fehlermeldung:', errorMessage);\n        setError(errorMessage);\n        // showMessage nur auerhalb useEffect verwenden, um Re-Renders zu vermeiden\n        // Verwende setTimeout, um es asynchron auszufhren\n        setTimeout(() => {\n          showMessage(errorMessage, 'error');\n        }, 0);\n        // Bei Fehler NICHT hasInitialLoadRef setzen, damit bei nchstem permissionsLoading-Change neu geladen wird\n      } finally {\n        if (mountedRef.current) {\n          console.log('[JoinRequestsList] Setze loading auf false');\n          setLoading(false);\n        }\n      }\n    };\n\n    fetchJoinRequests();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [permissionsLoading]); // canViewJoinRequests ist eine Funktion, nicht als Dependency\n\n  const handleOpenProcessModal = (request: OrganizationJoinRequest) => {\n    if (!canManageJoinRequests()) {\n      const errorMessage = t('joinRequestsList.noPermissionEdit');\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n      return;\n    }\n    setSelectedRequest(request);\n    setIsProcessModalOpen(true);\n  };\n\n  const handleProcessSuccess = async () => {\n    // Neulade die Liste nach erfolgreicher Bearbeitung\n    // Reset das Flag, damit neu geladen werden kann\n    hasInitialLoadRef.current = false;\n    \n    try {\n      setLoading(true);\n      const requests = await organizationService.getJoinRequests();\n      setJoinRequests(requests);\n      setError(null);\n      hasInitialLoadRef.current = true;\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || 'Fehler beim Laden der Beitrittsanfragen';\n      setError(errorMessage);\n      hasInitialLoadRef.current = true;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Filter-Funktionen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n\n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  // Initialer Default-Filter setzen (Controlled Mode)\n  useEffect(() => {\n    const setInitialFilter = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(JOIN_REQUESTS_TABLE_ID));\n        const filters = response.data;\n        \n        const alleFilter = filters.find((filter: any) => filter.name === 'Alle');\n        if (alleFilter) {\n          setActiveFilterName('Alle');\n          setSelectedFilterId(alleFilter.id);\n          applyFilterConditions(alleFilter.conditions, alleFilter.operators);\n        }\n      } catch (error) {\n        console.error('Fehler beim Setzen des initialen Filters:', error);\n      }\n    };\n\n    setInitialFilter();\n  }, []);\n\n  // Standard-Filter erstellen und speichern\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(JOIN_REQUESTS_TABLE_ID)\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: JOIN_REQUESTS_TABLE_ID,\n            name: 'Alle',\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\n            alleFilter\n          );\n          console.log('Alle-Filter fr Join Requests erstellt');\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []);\n\n  // Gefilterte Join-Requests\n  const filteredJoinRequests = useMemo(() => {\n    let filtered = [...joinRequests];\n\n    // Suchfeld-Filter\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(request => {\n        const requesterName = `${request.requester.firstName} ${request.requester.lastName}`.toLowerCase();\n        const requesterEmail = request.requester.email?.toLowerCase() || '';\n        const message = request.message?.toLowerCase() || '';\n        return requesterName.includes(searchLower) || requesterEmail.includes(searchLower) || message.includes(searchLower);\n      });\n    }\n\n    // Filter-Bedingungen aus FilterPane\n    if (filterConditions.length > 0) {\n      filtered = filterConditions.reduce((acc, condition, index) => {\n        if (!condition.column || condition.value === null || condition.value === '') {\n          return acc;\n        }\n\n        const operator = condition.operator;\n        const value = condition.value;\n\n        return acc.filter(request => {\n          switch (condition.column) {\n            case 'requester':\n              const requesterName = `${request.requester.firstName} ${request.requester.lastName}`.toLowerCase();\n              const requesterEmail = request.requester.email?.toLowerCase() || '';\n              const searchValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return requesterName.includes(searchValue) || requesterEmail.includes(searchValue);\n              } else if (operator === 'equals') {\n                return requesterName === searchValue || requesterEmail === searchValue;\n              } else if (operator === 'startsWith') {\n                return requesterName.startsWith(searchValue) || requesterEmail.startsWith(searchValue);\n    }\n              return false;\n\n            case 'message':\n              const message = request.message?.toLowerCase() || '';\n              const msgValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return message.includes(msgValue);\n              } else if (operator === 'equals') {\n                return message === msgValue;\n              } else if (operator === 'startsWith') {\n                return message.startsWith(msgValue);\n              }\n              return false;\n\n            case 'status':\n              if (operator === 'equals') {\n                return request.status === value;\n              }\n              return false;\n\n            default:\n              return true;\n          }\n        });\n      }, filtered);\n    }\n\n    return filtered;\n  }, [joinRequests, searchTerm, filterConditions, filterLogicalOperators]);\n\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('joinRequestsList.loadingPermissions')}</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canViewJoinRequests()) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n      <div className=\"p-4 text-red-600 dark:text-red-400\">\n        {t('joinRequestsList.noPermission')}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 sm:p-6 mb-6\">\n      {/* Titelzeile mit Icon, Suchfeld, Filter-Button */}\n      <div className=\"flex items-center justify-between mb-4 sm:mb-4\">\n        <h2 className=\"text-xl sm:text-xl font-semibold flex items-center dark:text-white\">\n          <UserPlusIcon className=\"h-6 w-6 sm:h-6 sm:w-6 mr-2 sm:mr-2\" />\n          {t('joinRequestsList.title')}\n        </h2>\n        \n        <div className=\"flex items-center gap-1.5\">\n          {/* Suchfeld */}\n          <input\n            type=\"text\"\n            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n\n          {/* Filter-Button */}\n          <button\n            className={`p-2 rounded-md border ${getActiveFilterCount() > 0 ? 'border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n            onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n            title={t('common.filter')}\n          >\n            <FunnelIcon className=\"h-5 w-5\" />\n            {getActiveFilterCount() > 0 && (\n              <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                {getActiveFilterCount()}\n              </span>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Filter-Panel */}\n      {isFilterPanelOpen && (\n        <div className=\"mb-4\">\n          <FilterPane\n            columns={[\n              { id: 'requester', label: t('joinRequestsList.filter.requester') },\n              { id: 'message', label: t('joinRequestsList.filter.message') },\n              { id: 'status', label: t('joinRequestsList.status.title', { defaultValue: 'Status' }) }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={JOIN_REQUESTS_TABLE_ID}\n          />\n        </div>\n      )}\n\n      {/* Gespeicherte Filter als Tags anzeigen */}\n      <SavedFilterTags\n        tableId={JOIN_REQUESTS_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n        defaultFilterName=\"Alle\"\n      />\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded\">\n          {error}\n        </div>\n      )}\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('joinRequestsList.loading')}</span>\n        </div>\n      ) : filteredJoinRequests.length === 0 ? (\n        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n          {joinRequests.length === 0 \n            ? t('joinRequestsList.noRequests')\n            : t('joinRequestsList.noMatching')}\n        </div>\n      ) : (\n        /* Cards fr Join-Requests */\n        <div className=\"space-y-4\">\n          {filteredJoinRequests.map(request => (\n            <div\n              key={request.id}\n              className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\"\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                        {request.requester.firstName} {request.requester.lastName}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        {request.requester.email}\n              </p>\n                    </div>\n                    <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(request.status)}`}>\n                      {getStatusText(request.status, t)}\n                    </span>\n                  </div>\n\n                  {request.message && (\n                    <div className=\"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.filter.message')}:</span> {request.message}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.response && (\n                    <div className=\"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700\">\n                      <p className=\"text-sm text-blue-700 dark:text-blue-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.response')}:</span> {request.response}\n                      </p>\n                    </div>\n                  )}\n\n              {request.status === 'pending' && canManageJoinRequests() && (\n                    <div className=\"mt-4 flex items-center gap-2\">\n                  <button \n                        onClick={() => handleOpenProcessModal(request)}\n                        className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-md dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center\"\n                      >\n                        <PencilIcon className=\"h-4 w-4 mr-1\" />\n                        {t('joinRequestsList.edit')}\n                  </button>\n                </div>\n              )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Process Join Request Modal */}\n      <ProcessJoinRequestModal\n        isOpen={isProcessModalOpen}\n        onClose={() => {\n          setIsProcessModalOpen(false);\n          setSelectedRequest(null);\n        }}\n        joinRequest={selectedRequest}\n        onSuccess={handleProcessSuccess}\n      />\n    </div>\n  );\n};\n\nexport default JoinRequestsList; ","import React, { useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { usePermissions } from '../hooks/usePermissions.ts';\r\nimport { UserGroupIcon, UserIcon, ShieldCheckIcon, MapPinIcon } from '@heroicons/react/24/outline';\r\nimport UserManagementTab from '../components/UserManagementTab.tsx';\r\nimport RoleManagementTab from '../components/RoleManagementTab.tsx';\r\nimport BranchManagementTab from '../components/BranchManagementTab.tsx';\r\nimport useMessage from '../hooks/useMessage.ts';\r\nimport OrganizationSettings from '../components/organization/OrganizationSettings.tsx';\r\nimport JoinRequestsList from '../components/organization/JoinRequestsList.tsx';\r\n\r\nconst Organisation: React.FC = () => {\r\n  const { t } = useTranslation();\r\n  // Gemeinsame States\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const { showMessage } = useMessage();\r\n\r\n  const { \r\n    isAdmin, \r\n    hasPermission, \r\n    canViewOrganization \r\n  } = usePermissions();\r\n\r\n  // Berechtigungen prfen\r\n  const canViewOrganisation = hasPermission('organization_management', 'read', 'page');\r\n  const canViewUsers = hasPermission('users', 'read', 'table');\r\n  const canViewRoles = hasPermission('roles', 'read', 'table');\r\n  const canViewBranches = hasPermission('branches', 'read', 'table');\r\n  const canViewOrg = canViewOrganization();\r\n\r\n  // Standard-Tab setzen: organization wenn verfgbar, sonst users wenn verfgbar, sonst roles, sonst branches\r\n  const defaultTab = canViewOrg ? 'organization' : (canViewUsers ? 'users' : (canViewRoles ? 'roles' : (canViewBranches ? 'branches' : 'organization')));\r\n  const [activeTabState, setActiveTabState] = useState<'users' | 'roles' | 'branches' | 'organization'>(defaultTab);\r\n\r\n  // Tab-Wechsel Handler - Fehler beim Wechsel zurcksetzen\r\n  const handleTabChange = (tab: 'users' | 'roles' | 'branches' | 'organization') => {\r\n    // Prfe Berechtigung fr den Tab\r\n    if (tab === 'users' && !canViewUsers) {\r\n      return; // Tab nicht aktivierbar\r\n    }\r\n    if (tab === 'roles' && !canViewRoles) {\r\n      return; // Tab nicht aktivierbar\r\n    }\r\n    if (tab === 'branches' && !canViewBranches) {\r\n      return; // Tab nicht aktivierbar\r\n    }\r\n    if (tab === 'organization' && !canViewOrg) {\r\n      return; // Tab nicht aktivierbar\r\n    }\r\n    setActiveTabState(tab);\r\n    setError(null);\r\n  };\r\n\r\n  // Gemeinsame Fehlerbehandlung\r\n  const handleError = (err: any) => {\r\n    let message = t('errors.unknownError');\r\n    if (err.response?.data?.message) {\r\n      message = err.response.data.message;\r\n    } else if (err instanceof Error) {\r\n      message = err.message;\r\n    }\r\n    setError(message);\r\n    showMessage(message, 'error');\r\n  };\r\n\r\n  // Keine Berechtigung fr die Seite\r\n  if (!canViewOrganisation) {\r\n    return <div className=\"p-4 text-red-600 dark:text-red-400\">{t('organisation.noPermission')}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen dark:bg-gray-900\">\r\n      <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\r\n          {/* Header mit Icon */}\r\n          <div className=\"flex items-center mb-6\">\r\n            <UserGroupIcon className=\"h-6 w-6 mr-2 dark:text-white\" />\r\n            <h2 className=\"text-xl font-semibold dark:text-white\">{t('organisation.title')}</h2>\r\n          </div>\r\n\r\n          {/* Tabs fr Navigation */}\r\n          <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\r\n            <nav className=\"-mb-px flex space-x-8\">\r\n              {/* Users Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\r\n              <button\r\n                className={`${\r\n                  activeTabState === 'users' && canViewUsers\r\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\r\n                    : !canViewUsers\r\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\r\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\r\n                } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center relative`}\r\n                onClick={() => canViewUsers && handleTabChange('users')}\r\n                disabled={!canViewUsers}\r\n              >\r\n                <UserIcon className=\"h-5 w-5 mr-2\" />\r\n                {t('organisation.tabs.users')}\r\n                {!canViewUsers && (\r\n                  <span className=\"ml-2 px-2 py-0.5 text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\r\n                    PRO\r\n                  </span>\r\n                )}\r\n              </button>\r\n\r\n              {/* Roles Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\r\n              <button\r\n                className={`${\r\n                  activeTabState === 'roles' && canViewRoles\r\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\r\n                    : !canViewRoles\r\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\r\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\r\n                } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center relative`}\r\n                onClick={() => canViewRoles && handleTabChange('roles')}\r\n                disabled={!canViewRoles}\r\n              >\r\n                <ShieldCheckIcon className=\"h-5 w-5 mr-2\" />\r\n                {t('organisation.tabs.roles')}\r\n                {!canViewRoles && (\r\n                  <span className=\"ml-2 px-2 py-0.5 text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\r\n                    PRO\r\n                  </span>\r\n                )}\r\n              </button>\r\n\r\n              {/* Branches Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\r\n              <button\r\n                className={`${\r\n                  activeTabState === 'branches' && canViewBranches\r\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\r\n                    : !canViewBranches\r\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\r\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\r\n                } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center relative`}\r\n                onClick={() => canViewBranches && handleTabChange('branches')}\r\n                disabled={!canViewBranches}\r\n              >\r\n                <MapPinIcon className=\"h-5 w-5 mr-2\" />\r\n                {t('organisation.tabs.branches', { defaultValue: 'Niederlassungen' })}\r\n                {!canViewBranches && (\r\n                  <span className=\"ml-2 px-2 py-0.5 text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\r\n                    PRO\r\n                  </span>\r\n                )}\r\n              </button>\r\n\r\n              {/* Organization Tab - sichtbar wenn berechtigt */}\r\n              {canViewOrg && (\r\n                <button\r\n                  className={`${\r\n                    activeTabState === 'organization'\r\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\r\n                      : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\r\n                  } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`}\r\n                  onClick={() => handleTabChange('organization')}\r\n                >\r\n                  <UserGroupIcon className=\"h-5 w-5 mr-2\" />\r\n                  {t('organisation.tabs.organization')}\r\n                </button>\r\n              )}\r\n            </nav>\r\n          </div>\r\n\r\n          {error && (\r\n            <div className=\"bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded mb-4\">\r\n              <p className=\"font-bold\">{t('organisation.error')}</p>\r\n              <p>{error}</p>\r\n            </div>\r\n          )}\r\n\r\n          {loading && <div className=\"p-4 dark:text-gray-300\">{t('organisation.loading')}</div>}\r\n\r\n          {/* Tab Inhalte */}\r\n          <div className=\"mt-6\">\r\n            {activeTabState === 'users' ? (\r\n              canViewUsers ? (\r\n                <UserManagementTab onError={handleError} />\r\n              ) : (\r\n                <div className=\"p-8 text-center\">\r\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\r\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\r\n                      PRO\r\n                    </span>\r\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\r\n                      {t('organisation.proFeature.users')}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              )\r\n            ) : activeTabState === 'roles' ? (\r\n              canViewRoles ? (\r\n                <RoleManagementTab onError={handleError} />\r\n              ) : (\r\n                <div className=\"p-8 text-center\">\r\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\r\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\r\n                      PRO\r\n                    </span>\r\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\r\n                      {t('organisation.proFeature.roles')}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              )\r\n            ) : activeTabState === 'branches' ? (\r\n              canViewBranches ? (\r\n                <BranchManagementTab onError={handleError} />\r\n              ) : (\r\n                <div className=\"p-8 text-center\">\r\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\r\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\r\n                      PRO\r\n                    </span>\r\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\r\n                      {t('organisation.proFeature.branches') || 'Niederlassungs-Verwaltung ist eine PRO-Funktion'}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              )\r\n            ) : activeTabState === 'organization' && canViewOrg ? (\r\n              <div className=\"space-y-6\">\r\n                <OrganizationSettings />\r\n                <JoinRequestsList />\r\n              </div>\r\n            ) : (\r\n              <div className=\"p-4 text-red-600 dark:text-red-400\">\r\n                {t('organisation.noPermissionForPage')}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Organisation;\r\n\r\n\r\n"],"names":["_ref","isOpen","onClose","onCertificateCreated","userId","userName","t","useTranslation","user","currentUser","useAuth","isHR","loading","permissionsLoading","usePermissions","openSidepane","closeSidepane","useSidepane","showMessage","useMessage","isMobile","setIsMobile","useState","window","innerWidth","isLargeScreen","setIsLargeScreen","activeTab","setActiveTab","setLoading","error","setError","userData","setUserData","issueDate","setIssueDate","Date","toISOString","split","certificateType","setCertificateType","pdfFile","setPdfFile","pdfPreviewUrl","setPdfPreviewUrl","uploading","setUploading","availableTemplates","setAvailableTemplates","selectedTemplate","setSelectedTemplate","useTemplate","setUseTemplate","fileInputRef","useRef","useEffect","handleResize","addEventListener","removeEventListener","fetchUserData","fetchTemplates","async","documentTemplates","axiosInstance","get","API_ENDPOINTS","ORGANIZATION_LIFECYCLE","DOCUMENT_TEMPLATES","data","templates","employmentCertificate","push","type","version","path","length","err","console","userResponse","lifecycleResponse","Promise","all","USERS","BY_ID","LIFECYCLE","BY_USER","lifecycle","userDataObj","firstName","lastName","identificationNumber","contractStartDate","contractEndDate","contractType","salary","position","URL","revokeObjectURL","_jsxs","Dialog","open","className","children","_jsx","Panel","concat","style","animation","DocumentTextIcon","Title","onClick","XMarkIcon","_Fragment","UserIcon","CalendarIcon","toLocaleDateString","value","onChange","e","target","max","required","undefined","id","checked","map","template","ref","accept","event","_event$target$files","file","files","size","url","createObjectURL","name","toFixed","current","_fileInputRef$current","click","src","height","title","preventDefault","validationError","validateForm","issueDateObj","isNaN","getTime","pdfPath","templateUsed","templateVersion","find","now","certificateData","post","CERTIFICATES","_err$response","_err$response$data","response","message","disabled","ArrowPathIcon","CheckIcon","onContractCreated","setContractType","startDate","setStartDate","endDate","setEndDate","setSalary","workingHours","setWorkingHours","setPosition","employmentContract","toString","min","placeholder","CurrencyDollarIcon","parseFloat","step","startDateObj","endDateObj","contractData","CONTRACTS","onCertificateUpdated","certificate","existingPdfUrl","setExistingPdfUrl","CERTIFICATE_DOWNLOAD","handleSubmit","updateData","put","CERTIFICATE","onSubmit","onContractUpdated","contract","CONTRACT_DOWNLOAD","CONTRACT","lifecycleId","onUpdate","isLegal","isAdmin","registrations","setRegistrations","arl","eps","pension","caja","editingType","setEditingType","formData","setFormData","status","registrationNumber","provider","registrationDate","notes","saving","setSaving","loadingRef","abortControllerRef","abort","abortController","AbortController","registrationPromises","signal","aborted","registration","SOCIAL_SECURITY","timeout","_error$response","_error$message","code","includes","warn","results","newRegistrations","forEach","_ref2","registrationType","completedAt","loadRegistrations","handleCancel","handleSave","number","_error$response2","_error$response2$data","getStatusIcon","CheckCircleIcon","ClockIcon","XCircleIcon","getStatusLabel","labelKey","getTypeLabel","defaultValue","isEditing","_objectSpread","rows","handleEdit","PencilIcon","onOffboardingStarted","exitDate","setExitDate","exitReason","setExitReason","validationErrors","setValidationErrors","today","errors","selectedDate","setHours","maxDate","setFullYear","getFullYear","trim","Object","keys","STATUS","errorMessage","renderForm","ExclamationTriangleIcon","htmlFor","prev","ArrowRightIcon","opacity","transition","pointerEvents","role","onOffboardingCompleted","offboardingTasks","confirmText","setConfirmText","completedTasks","filter","task","allTasksCompleted","requiredConfirmText","toLowerCase","isCompleted","lifecycleData","setLifecycleData","certificates","setCertificates","contracts","setContracts","setOffboardingTasks","isCertificateCreateModalOpen","setIsCertificateCreateModalOpen","isContractCreateModalOpen","setIsContractCreateModalOpen","editingCertificate","setEditingCertificate","editingContract","setEditingContract","downloadingCertId","setDownloadingCertId","downloadingContractId","setDownloadingContractId","isOffboardingStartModalOpen","setIsOffboardingStartModalOpen","isOffboardingCompleteModalOpen","setIsOffboardingCompleteModalOpen","isEditContractDatesModalOpen","setIsEditContractDatesModalOpen","editingContractStartDate","setEditingContractStartDate","editingContractEndDate","setEditingContractEndDate","fetchDataRef","fetchData","useCallback","_certsResponse$data","_contractsResponse$da","certsResponse","contractsResponse","tasksResponse","TASKS","catch","allTasks","offboardingTaskTitles","filteredTasks","handleEditContractDates","formatDate","dateString","year","month","day","progress","socialSecurityRegistrations","BuildingOfficeIcon","config","onboarding","color","active","contract_change","offboarding","archived","getStatusBadge","onboardingStartedAt","onboardingCompletedAt","offboardingStartedAt","completed","total","percent","width","totalTasks","Math","round","description","PlusIcon","cert","isLatest","generatedByUser","certId","responseType","blob","Blob","downloadUrl","link","document","createElement","href","download","body","appendChild","removeChild","handleDownloadCertificate","ArrowDownTrayIcon","toLocaleString","currency","contractId","handleDownloadContract","SocialSecurityEditor","CertificateCreationModal","ContractCreationModal","CertificateEditModal","ContractEditModal","OffboardingStartModal","OffboardingCompleteModal","CONTRACT_TYPES","onError","COUNTRIES","PAYROLL_COUNTRIES","LANGUAGES","users","setUsers","selectedUser","setSelectedUser","userFormData","setUserFormData","isEditingUser","setIsEditingUser","selectedRoles","setSelectedRoles","isDebugMode","setIsDebugMode","roleWarning","setRoleWarning","roles","setRoles","loadingRoles","setLoadingRoles","activeUserTab","setActiveUserTab","userFilterTab","setUserFilterTab","isCreateModalOpen","setIsCreateModalOpen","newUserFormData","setNewUserFormData","email","password","allUsers","setAllUsers","fetchAllUsers","userApi","getAll","filterUsersByActiveStatus","handleError","sorted","arguments","isActive","sort","a","b","aUsername","username","bUsername","aFirstName","bFirstName","localeCompare","fetchUserDetails","log","getById","birthday","roleIds","Array","isArray","userRole","roleId","r","fallbackRoles","permissions","roleApi","fetchRoles","Error","handleUserInputChange","finalValue","Number","toggleRole","isRoleSelected","newSelectedRoles","updateRoles","handleNewUserInputChange","handleCreateUser","match","create","newUser","prevUsers","_err$response5","_err$response5$data","parseInt","currentUserId","localStorage","getItem","currentActiveStatus","newActiveStatus","selectedUserActive","updatePayload","update","updatedData","UserCircleIcon","ShieldCheckIcon","_userFormData$usernam","_userFormData$email","_userFormData$firstNa","_userFormData$lastNam","dataToSend","normalWorkingHours","hourlyRate","monthlySalary","_err$response2","_err$response4","_err$response3","_err$response3$data","errorMsg","bankDetails","country","language","payrollCountry","handleCancelEdit","IdentificationDocumentList","some","ids","join","isFixedRole","xmlns","viewBox","fill","fillRule","d","clipRule","LifecycleView","alwaysVisiblePages","defaultPages","defaultTables","defaultButtons","tableToPageMapping","buttonToPageMapping","buttonToTableMapping","ROLES_TABLE_ID","STANDARD_ROLE_IDS","STANDARD_ROLE_NAMES","isStandardRole","roleName","RoleCard","onEdit","onDelete","onCopy","canEdit","canDelete","canCopy","DocumentDuplicateIcon","TrashIcon","perm","accessLevel","slice","permission","entity","entityType","onRolesChange","readOnly","isModalOpen","setIsModalOpen","editingRole","setEditingRole","pageDisplayNames","useMemo","tableDisplayNames","buttonDisplayNames","page","table","button","hasPermission","searchTerm","setSearchTerm","isFilterModalOpen","setIsFilterModalOpen","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","handleValidationError","useError","isAddPermissionModalOpen","setIsAddPermissionModalOpen","selectedPermission","setSelectedPermission","displayLimit","setDisplayLimit","component","action","filteredPermissions","category","ErrorCategory","PERMISSION","updateError","meta","cause","createError","resetForm","handleDelete","confirm","delete","deleteError","refreshError","handleCopyRole","copiedRoleData","prevRoles","prepareRoleForEditing","allPermissions","existingPermIndex","findIndex","p","setAllPagePermissions","newPermissions","permIndex","indexOf","setAllTablePermissions","setAllButtonPermissions","getActiveFilterCount","filteredAndSortedRoles","searchLower","result","i","condition","conditionMet","column","operator","startsWith","count","existingFilters","SAVED_FILTERS","BY_TABLE","alleFilter","tableId","conditions","operators","BASE","createStandardFilters","applyFilterConditions","setInitialFilter","resetFilterConditions","FunnelIcon","FilterPane","columns","label","onApply","onReset","savedConditions","savedOperators","SavedFilterTags","onSelectFilter","onFilterChange","handleFilterChange","defaultFilterName","prevLimit","ChevronDownIcon","index","tablePerm","aName","bName","priorityOrder","aIndex","bIndex","tableIndex","tablePermIndex","isTableActive","tableEntity","tableDisplayName","relatedButtons","buttonPerm","order","buttonIndex","buttonPermIndex","isButtonActive","buttonDisplayName","BranchCard","branch","BRANCHES_TABLE_ID","editingBranch","setEditingBranch","branches","setBranches","canCreate","fetchBranches","BRANCHES","_error$response$data","handleCloseModal","UPDATE","CREATE","DELETE","branchId","_error$response3","_error$response3$data","filteredAndSortedBranches","handleCreate","autoFocus","onSuccess","displayName","domain","setErrors","fetchCurrentUser","checkScreenSize","handleChange","newErrors","organizationService","createOrganization","submit","handleClose","organizationName","searching","setSearching","organizations","setOrganizations","showDropdown","setShowDropdown","selectedOrganization","setSelectedOrganization","searchTimeoutRef","dropdownRef","handleClickOutside","contains","handleOrganizationInputChange","clearTimeout","setTimeout","searchOrganizations","handleSelectOrganization","org","handleMessageChange","createJoinRequest","organization","onSave","lifecycleRoles","setLifecycleRoles","loadRoles","loadLifecycleRoles","LIFECYCLE_ROLES","handleAssignStandardRoles","adminRole","hrRole","legalRole","adminRoleId","hrRoleId","legalRoleId","prepareRoleId","employeeRoleIds","SignatureUploadSection","onUpload","signatures","setSignatures","signatureType","setSignatureType","signerName","setSignerName","signerPosition","setSignerPosition","positionX","setPositionX","positionY","setPositionY","positionPage","setPositionPage","React","loadSignatures","documentSignatures","DOCUMENT_SIGNATURES","signaturesList","_error$response5","_error$response6","_error$response6$data","_event$target$files2","FormData","append","UPLOAD_SIGNATURE","headers","_error$response7","_error$response7$data","_fileInputRef$current2","signature","x","y","settings","ORGANIZATIONS","CURRENT","typeKey","_error$response8","_error$response8$data","handleDeleteSignature","FieldPositionConfiguration","_ref3","templateType","setTemplateType","fields","setFields","certificateFields","contractFields","loadFields","_settings$documentTem","templateSettings","savedFields","margin","lineHeight","currentY","defaultFields","fieldList","defaultPositions","fontSize","currentDate","fieldName","handleFieldChange","property","fieldLabels","_fields$fieldName","_fields$fieldName2","_fields$fieldName3","resetFields","currentSettings","updateOrganization","_error$response9","_error$response9$data","setTemplates","loadTemplates","templatesList","filePath","UPLOAD_TEMPLATE","_error$response4","_error$response4$data","handleDeleteTemplate","smtpSettings","setSmtpSettings","smtpHost","smtpPort","smtpUser","smtpPass","smtpFromEmail","smtpFromName","showPassword","setShowPassword","_settings$smtpPort","EnvelopeIcon","stroke","strokeLinecap","strokeLinejoin","strokeWidth","handleClear","ALLOWED_DOMAINS","lobbyPms","ttlock","sire","boldPayment","validateApiUrl","service","parsed","hostname","endsWith","canManageOrganization","apiSettings","setApiSettings","lobbyPmsApiKey","lobbyPmsPropertyId","lobbyPmsSyncEnabled","lobbyPmsAutoCreateTasks","lobbyPmsLateCheckInThreshold","ttlockClientId","ttlockClientSecret","ttlockApiUrl","sireApiUrl","sireApiKey","sireApiSecret","sireEnabled","sireAutoRegisterOnCheckIn","sirePropertyCode","boldPaymentApiKey","boldPaymentMerchantId","boldPaymentEnvironment","whatsappProvider","whatsappApiKey","whatsappApiSecret","whatsappPhoneNumberId","showSecrets","setShowSecrets","doorSystem","whatsapp","apiKey","propertyId","syncEnabled","autoCreateTasks","lateCheckInThreshold","clientId","clientSecret","apiUrl","apiSecret","enabled","autoRegisterOnCheckIn","propertyCode","merchantId","environment","phoneNumberId","SecretInput","showSecret","toggleShowSecret","key","KeyIcon","test","_err$path","msg","logo","nit","selectedCountry","setSelectedCountry","setNit","organizationLanguage","setOrganizationLanguage","useLanguage","selectedOrgLanguage","setSelectedOrgLanguage","savingOrgLanguage","setSavingOrgLanguage","orgSettings","langResponse","getOrganizationLanguage","langError","loadOrgLanguage","newLanguage","RoleConfigurationTab","DocumentConfigurationTab","SMTPConfigurationTab","ApiConfigurationTab","getStatusColor","getStatusText","MY_JOIN_REQUESTS_TABLE_ID","MyJoinRequestsList","joinRequests","setJoinRequests","isFilterPanelOpen","setIsFilterPanelOpen","mountedRef","withdrawingId","setWithdrawingId","isMounted","timeoutId","MY_JOIN_REQUESTS","requests","getMyJoinRequests","fetchMyJoinRequests","hour","minute","filteredJoinRequests","filtered","request","_request$message","orgName","reduce","acc","_request$message2","searchValue","String","msgValue","createdAt","processor","processedAt","requestId","withdrawJoinRequest","req","_err$response4$data","handleWithdraw","OrganizationSettings","setOrganization","stats","setStats","loadingStats","setLoadingStats","isJoinModalOpen","setIsJoinModalOpen","isEditModalOpen","setIsEditModalOpen","canViewOrganization","refreshOrganization","useOrganization","fetchOrganization","getCurrentOrganization","statsData","getOrganizationStats","statsErr","_err$response2$data","hasOrganization","hasInitialLoadRef","UserPlusIcon","UserGroupIcon","subscriptionPlan","currentUsers","maxUsers","utilizationPercent","_count","invitations","ChartBarIcon","availableSlots","CreateOrganizationModal","handleCreateSuccess","JoinOrganizationModal","handleJoinSuccess","EditOrganizationModal","handleEditSuccess","joinRequest","setAction","setRoleId","setResponse","organizationId","processJoinRequest","requester","JOIN_REQUESTS_TABLE_ID","JoinRequestsList","isProcessModalOpen","setIsProcessModalOpen","selectedRequest","setSelectedRequest","canViewJoinRequests","canManageJoinRequests","hasInitialLoad","joinRequestsCount","JOIN_REQUESTS","getJoinRequests","stack","fetchJoinRequests","_request$requester$em","requesterName","requesterEmail","_request$requester$em2","handleOpenProcessModal","ProcessJoinRequestModal","Organisation","canViewOrganisation","canViewUsers","canViewRoles","canViewBranches","canViewOrg","defaultTab","activeTabState","setActiveTabState","handleTabChange","tab","MapPinIcon","UserManagementTab","RoleManagementTab","BranchManagementTab"],"sourceRoot":""}