"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[836],{4832:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(45),s=r(5043);const n=["title","titleId"];function o(e,t){let{title:r,titleId:o}=e,l=(0,a.A)(e,n);return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":o},l),r?s.createElement("title",{id:o},r):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const l=s.forwardRef(o)},6400:(e,t,r)=>{r.d(t,{Ac:()=>o,J1:()=>n,W5:()=>s,hw:()=>l});const a=(e,t)=>{const{operator:r,value:a}=t;if(void 0===a)return console.error("evaluateCondition: value ist undefined",t),!1;if(null==e&&null==a)return"equals"===r;if(null==e||null==a)return"notEquals"===r;let s="",n="";try{const t=null==e?"":"string"===typeof e?e:String(e);if("string"!==typeof t)return!1;const r=t.toLowerCase();if(void 0===r||null===r||"string"!==typeof r)return!1;s=r;const o=null==a?"":"string"===typeof a?a:String(a);if("string"!==typeof o)return!1;const l=o.toLowerCase();if(void 0===l||null===l||"string"!==typeof l)return!1;n=l}catch(o){return!1}if("string"!==typeof s||"string"!==typeof n||void 0===s||void 0===n||null===s||null===n)return!1;switch(r){case"equals":return s===n;case"notEquals":return s!==n;case"contains":return s.includes(n);case"startsWith":return s.startsWith(n);case"endsWith":if(void 0===s||null===s)return console.error("endsWith: strField ist undefined/null",{strField:s,strValue:n,fieldValue:e,value:a,condition:t}),!1;if(void 0===n||null===n)return console.error("endsWith: strValue ist undefined/null",{strField:s,strValue:n,fieldValue:e,value:a,condition:t}),!1;if("string"!==typeof s)return console.error("endsWith: strField ist kein String",{strField:s,typeof:typeof s,strValue:n,fieldValue:e,value:a,condition:t}),!1;if("string"!==typeof n)return console.error("endsWith: strValue ist kein String",{strField:s,strValue:n,typeof:typeof n,fieldValue:e,value:a,condition:t}),!1;try{return s.endsWith(n)}catch(o){return console.error("endsWith: Fehler bei endsWith-Aufruf",o,{strField:s,strValue:n,fieldValue:e,value:a,condition:t}),!1}case"before":case"after":{const t=new Date(e),s=new Date(a);return!isNaN(t.getTime())&&!isNaN(s.getTime())&&("before"===r?t<s:t>s)}case"greaterThan":case"lessThan":{const t=parseFloat(String(e)),s=parseFloat(String(a));return!isNaN(t)&&!isNaN(s)&&("greaterThan"===r?t>s:t<s)}default:return!0}},s=(e,t,r,s,n)=>0===t.length?e:e.filter((e=>{let o=!0;for(let l=0;l<t.length;l++){const i=t[l];let d=!1;if(n&&n[i.column]){const t=n[i.column](e,i);if(null!==t)d=t;else{const t=s(e,i.column);d=a(t,i)}}else{const t=s(e,i.column);d=a(t,i)}if(0===l)o=d;else{o="AND"===(r[l-1]||"AND")?o&&d:o||d}}return o})),n=(e,t)=>{if(!e)return!1;const r=new Date(e);if(isNaN(r.getTime()))return!1;const a=r.getUTCFullYear(),s=r.getUTCMonth(),n=r.getUTCDate(),o=new Date(a,s,n);let l;if("__TODAY__"===t.value){const e=new Date;e.setHours(0,0,0,0),l=e}else{const e=new Date(t.value);if(isNaN(e.getTime()))return!1;const r=e.getUTCFullYear(),a=e.getUTCMonth(),s=e.getUTCDate();l=new Date(r,a,s)}switch(t.operator){case"equals":return o.getTime()===l.getTime();case"before":return o<l;case"after":return o>l;default:return!0}},o=(e,t,r,a)=>{const s=r.value||"";if(s.startsWith("user-")){const t=parseInt(s.replace("user-",""),10);if(isNaN(t))return!1;const a=e===t;return"notEquals"===r.operator?!a:a}if(s.startsWith("role-")){const e=parseInt(s.replace("role-",""),10);if(isNaN(e))return!1;const a=t===e;return"notEquals"===r.operator?!a:a}if(""===s)return!0;if(void 0!==a){const e=a.toLowerCase(),t=s.toLowerCase();if("equals"===r.operator)return e===t;if("notEquals"===r.operator)return e!==t;if("contains"===r.operator)return e.includes(t)}return!1},l=(e,t,r,a,s,n)=>{const o=a.value||"";if(o.startsWith("user-")){const t=parseInt(o.replace("user-",""),10);if(isNaN(t))return!1;const s=e===t||r===t;return"notEquals"===a.operator?!s:s}if(o.startsWith("role-")){const e=parseInt(o.replace("role-",""),10);if(isNaN(e))return!1;const r=t===e;return"notEquals"===a.operator?!r:r}if(""===o)return!0;const l=o.toLowerCase();return"equals"===a.operator?(null===s||void 0===s?void 0:s.toLowerCase())===l||(null===n||void 0===n?void 0:n.toLowerCase())===l:"notEquals"===a.operator?(null===s||void 0===s?void 0:s.toLowerCase())!==l&&(null===n||void 0===n?void 0:n.toLowerCase())!==l:"contains"===a.operator&&(null!==(i=null===s||void 0===s||null===(d=s.toLowerCase())||void 0===d?void 0:d.includes(l))&&void 0!==i&&i||null!==(c=null===n||void 0===n||null===(m=n.toLowerCase())||void 0===m?void 0:m.includes(l))&&void 0!==c&&c);var i,d,c,m}},9531:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(45),s=r(5043);const n=["title","titleId"];function o(e,t){let{title:r,titleId:o}=e,l=(0,a.A)(e,n);return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":o},l),r?s.createElement("title",{id:o},r):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const l=s.forwardRef(o)},9670:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(45),s=r(5043);const n=["title","titleId"];function o(e,t){let{title:r,titleId:o}=e,l=(0,a.A)(e,n);return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":o},l),r?s.createElement("title",{id:o},r):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"}))}const l=s.forwardRef(o)},9836:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ke});var a=r(5043),s=r(2903),n=r(4117),o=r(2672),l=r(2760),i=r(5648),d=r(7855),c=r(1801),m=r(1923),u=r(7488),g=r(8421),x=r(45);const h=["title","titleId"];function p(e,t){let{title:r,titleId:s}=e,n=(0,x.A)(e,h);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),r?a.createElement("title",{id:s},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const b=a.forwardRef(p);var y=r(6009);const f=["title","titleId"];function w(e,t){let{title:r,titleId:s}=e,n=(0,x.A)(e,f);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),r?a.createElement("title",{id:s},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25"}))}const v=a.forwardRef(w);var j=r(6693);const k=["title","titleId"];function N(e,t){let{title:r,titleId:s}=e,n=(0,x.A)(e,k);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),r?a.createElement("title",{id:s},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.26 10.147a60.438 60.438 0 0 0-.491 6.347A48.62 48.62 0 0 1 12 20.904a48.62 48.62 0 0 1 8.232-4.41 60.46 60.46 0 0 0-.491-6.347m-15.482 0a50.636 50.636 0 0 0-2.658-.813A59.906 59.906 0 0 1 12 3.493a59.903 59.903 0 0 1 10.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.717 50.717 0 0 1 12 13.489a50.702 50.702 0 0 1 7.74-3.342M6.75 15a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm0 0v-3.675A55.378 55.378 0 0 1 12 8.443m-7.007 11.55A5.981 5.981 0 0 0 6.75 15.75v-1.5"}))}const A=a.forwardRef(N);var S=r(1816);const R=["title","titleId"];function C(e,t){let{title:r,titleId:s}=e,n=(0,x.A)(e,R);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),r?a.createElement("title",{id:s},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m6.75 12-3-3m0 0-3 3m3-3v6m-1.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const E=a.forwardRef(C);var D=r(9422),M=r(9379),L=r(1292),P=r(7353),I=r(4493),T=r(5620),U=r(579);const B={taskCreate:!0,taskUpdate:!0,taskDelete:!0,taskStatusChange:!0,requestCreate:!0,requestUpdate:!0,requestDelete:!0,requestStatusChange:!0,userCreate:!0,userUpdate:!0,userDelete:!0,roleCreate:!0,roleUpdate:!0,roleDelete:!0,worktimeStart:!0,worktimeStop:!0},q={task:["taskCreate","taskUpdate","taskDelete","taskStatusChange"],request:["requestCreate","requestUpdate","requestDelete","requestStatusChange"],user:["userCreate","userUpdate","userDelete"],role:["roleCreate","roleUpdate","roleDelete"],worktime:["worktimeStart","worktimeStop"]},F=()=>{const{t:e}=(0,n.Bd)(),[t,r]=(0,a.useState)(B),[s,o]=(0,a.useState)(!0),[l,i]=(0,a.useState)(!1),{showMessage:c}=(0,d.A)();(0,a.useEffect)((()=>{m()}),[]);const m=async()=>{try{o(!0),console.log("Starte Abruf der Benachrichtigungseinstellungen...");const e=await T.f.getUserSettings();if(console.log("Erhaltene Einstellungen:",e.data),null!==e&&void 0!==e&&e.data){const t=(0,M.A)((0,M.A)({},B),e.data);r(t),console.log("Einstellungen aktualisiert:",t)}else console.warn("Keine Daten vom Server erhalten, verwende Standardeinstellungen"),r(B)}catch(t){console.error("Fehler beim Laden der Benachrichtigungseinstellungen:",t),r(B),c(e("notifications.loadSettingsError"),"error")}finally{o(!1)}},u=async a=>{const{name:s,checked:n}=a.target,o=(0,M.A)((0,M.A)({},t),{},{[s]:n});r(o);try{i(!0),await T.f.updateUserSettings(o),c(e("notifications.saveSuccess"),"success")}catch(l){console.error("Fehler beim Speichern der Einstellungen:",l),c(e("notifications.saveError"),"error"),r(t)}finally{i(!1)}},g=e=>{const r=e.toLowerCase();return!!q[r]&&q[r].every((e=>!0===t[e]))},x=e=>{let{checked:t,onChange:r,name:a,label:s,description:n}=e;return(0,U.jsxs)("div",{className:"flex items-center justify-between gap-8 group relative",children:[(0,U.jsx)("div",{className:"flex-1",children:(0,U.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:s})}),(0,U.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer flex-shrink-0",children:[(0,U.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:t,onChange:r,name:a}),(0,U.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]}),n&&(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:n})]})},h=(a,s)=>(0,U.jsxs)("div",{className:"mb-6 mt-2",children:[(0,U.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,U.jsx)("div",{children:(0,U.jsx)("h3",{className:"text-lg font-medium dark:text-white",children:a})}),(0,U.jsx)(x,{checked:g(a),onChange:s=>(async(a,s)=>{const n=a.toLowerCase();if(!q[n])return;const o=(0,M.A)({},t);q[n].forEach((e=>{o[e]=s})),r(o);try{i(!0),await T.f.updateUserSettings(o),c(e("notifications.saveSuccess"),"success")}catch(l){console.error("Fehler beim Speichern der Einstellungen:",l),c(e("notifications.saveError"),"error"),r(t)}finally{i(!1)}})(a,s.target.checked),name:"".concat(a.toLowerCase(),"All"),label:e("notifications.all")})]}),(0,U.jsx)("div",{className:"space-y-4",children:s.map((e=>{let{name:r,label:a,description:s}=e;return(0,U.jsx)(x,{checked:t[r],onChange:u,name:r,label:a,description:s},r)}))})]});return s?(0,U.jsx)(L.A,{children:e("notifications.loading")}):(0,U.jsxs)(P.A,{className:"p-4",children:[(0,U.jsx)(L.A,{variant:"body2",className:"text-gray-600 dark:text-gray-400 mb-6",children:e("notifications.description")}),(0,U.jsx)("div",{className:"mb-8 mt-2",children:(0,U.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,U.jsxs)("div",{className:"group relative",children:[(0,U.jsx)("h3",{className:"text-lg font-medium dark:text-white",children:e("notifications.allNotifications")}),(0,U.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e("notifications.allNotificationsDescription")}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("notifications.allNotificationsDescription")})]}),(0,U.jsx)(x,{checked:!!t&&Object.values(t).every((e=>!0===e)),onChange:a=>(async a=>{const s=Object.keys(t).reduce(((e,t)=>(e[t]=a,e)),(0,M.A)({},B));r(s);try{i(!0),await T.f.updateUserSettings(s),c(e("notifications.saveSuccess"),"success")}catch(n){console.error("Fehler beim Speichern der Einstellungen:",n),c(e("notifications.saveError"),"error"),r(t)}finally{i(!1)}})(a.target.checked),name:"allNotifications",label:""})]})}),(0,U.jsx)(I.A,{className:"my-8"}),h(e("notifications.categories.tasks"),[{name:"taskCreate",label:e("notifications.events.taskCreate"),description:e("notifications.events.taskCreateDescription")},{name:"taskUpdate",label:e("notifications.events.taskUpdate"),description:e("notifications.events.taskUpdateDescription")},{name:"taskDelete",label:e("notifications.events.taskDelete"),description:e("notifications.events.taskDeleteDescription")},{name:"taskStatusChange",label:e("notifications.events.taskStatusChange"),description:e("notifications.events.taskStatusChangeDescription")}]),(0,U.jsx)(I.A,{className:"my-8"}),h(e("notifications.categories.requests"),[{name:"requestCreate",label:e("notifications.events.requestCreate"),description:e("notifications.events.requestCreateDescription")},{name:"requestUpdate",label:e("notifications.events.requestUpdate"),description:e("notifications.events.requestUpdateDescription")},{name:"requestDelete",label:e("notifications.events.requestDelete"),description:e("notifications.events.requestDeleteDescription")},{name:"requestStatusChange",label:e("notifications.events.requestStatusChange"),description:e("notifications.events.requestStatusChangeDescription")}]),(0,U.jsx)(I.A,{className:"my-8"}),h(e("notifications.categories.usersAndRoles"),[{name:"userCreate",label:e("notifications.events.userCreate"),description:e("notifications.events.userCreateDescription")},{name:"userUpdate",label:e("notifications.events.userUpdate"),description:e("notifications.events.userUpdateDescription")},{name:"userDelete",label:e("notifications.events.userDelete"),description:e("notifications.events.userDeleteDescription")},{name:"roleCreate",label:e("notifications.events.roleCreate"),description:e("notifications.events.roleCreateDescription")},{name:"roleUpdate",label:e("notifications.events.roleUpdate"),description:e("notifications.events.roleUpdateDescription")},{name:"roleDelete",label:e("notifications.events.roleDelete"),description:e("notifications.events.roleDeleteDescription")}]),(0,U.jsx)(I.A,{className:"my-8"}),h(e("notifications.categories.worktime"),[{name:"worktimeStart",label:e("notifications.events.worktimeStart"),description:e("notifications.events.worktimeStartDescription")},{name:"worktimeStop",label:e("notifications.events.worktimeStop"),description:e("notifications.events.worktimeStopDescription")}])]})};var O=r(6443),W=r(7591);const V=e=>{let{isOpen:t,onClose:r,onSave:s,currentSettings:o}=e;const{t:l}=(0,n.Bd)(),[i,d]=(0,a.useState)({monthlyReportEnabled:!0,monthlyReportDay:o.monthlyReportDay||25,monthlyReportRecipient:o.monthlyReportRecipient||""}),[c,m]=(0,a.useState)(!1),[g,x]=(0,a.useState)({}),h=()=>{d({monthlyReportEnabled:!0,monthlyReportDay:o.monthlyReportDay||25,monthlyReportRecipient:o.monthlyReportRecipient||""}),x({}),r()},p=(e,t)=>{d((r=>(0,M.A)((0,M.A)({},r),{},{[e]:t}))),g[e]&&x((t=>(0,M.A)((0,M.A)({},t),{},{[e]:""})))};return(0,U.jsxs)(O.lG,{open:t,onClose:h,className:"relative z-50",children:[(0,U.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,U.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,U.jsx)(O.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:(0,U.jsxs)("div",{className:"p-6",children:[(0,U.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,U.jsx)(O.lG.Title,{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Automatische Monatsabrechnung einrichten"}),(0,U.jsx)("button",{onClick:h,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",children:(0,U.jsx)(W.A,{className:"h-6 w-6"})})]}),(0,U.jsx)("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:(0,U.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"Konfigurieren Sie die automatische Generierung von monatlichen Beratungsabrechnungen. Diese werden automatisch am gew\xe4hlten Tag des Monats erstellt und an den angegebenen Empf\xe4nger adressiert."})}),(0,U.jsxs)("div",{className:"space-y-4",children:[(0,U.jsxs)("div",{children:[(0,U.jsx)("label",{htmlFor:"monthlyReportDay",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Abrechnungstag im Monat"}),(0,U.jsx)("select",{id:"monthlyReportDay",className:"mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ".concat(g.monthlyReportDay?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"),value:i.monthlyReportDay,onChange:e=>p("monthlyReportDay",parseInt(e.target.value)),children:Array.from({length:28},((e,t)=>t+1)).map((e=>(0,U.jsxs)("option",{value:e,children:[e,"."]},e)))}),g.monthlyReportDay&&(0,U.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:g.monthlyReportDay}),(0,U.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Tag im Monat, an dem die Abrechnung automatisch erstellt wird (1-28)"})]}),(0,U.jsxs)("div",{children:[(0,U.jsxs)("label",{htmlFor:"monthlyReportRecipient",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[l("monthlyReport.recipient")," *"]}),(0,U.jsx)("textarea",{id:"monthlyReportRecipient",rows:3,className:"mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ".concat(g.monthlyReportRecipient?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"),value:i.monthlyReportRecipient,onChange:e=>p("monthlyReportRecipient",e.target.value),placeholder:l("monthlyReport.recipientPlaceholder")}),g.monthlyReportRecipient&&(0,U.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:g.monthlyReportRecipient}),(0,U.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Vollst\xe4ndige Adresse des Empf\xe4ngers (Arbeitgeber) f\xfcr die monatliche Abrechnung"})]})]}),i.monthlyReportRecipient.trim()&&(0,U.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[(0,U.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Vorschau:"}),(0,U.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,U.jsxs)("p",{children:["\ud83d\udcc5 ",(0,U.jsx)("strong",{children:"Abrechnungszeitraum:"})," ",i.monthlyReportDay,". des Vormonats bis ",i.monthlyReportDay-1,". des aktuellen Monats"]}),(0,U.jsxs)("p",{className:"mt-1",children:["\ud83d\udce7 ",(0,U.jsx)("strong",{children:"Empf\xe4nger:"})]}),(0,U.jsx)("div",{className:"ml-4 mt-1 font-mono text-xs bg-white dark:bg-gray-800 p-2 rounded border",children:i.monthlyReportRecipient.split("\n").map(((e,t)=>(0,U.jsx)("div",{children:e},t)))})]})]}),(0,U.jsxs)("div",{className:"mt-6 flex items-center justify-end space-x-3",children:[(0,U.jsx)("button",{type:"button",onClick:h,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:l("common.cancel"),children:(0,U.jsx)(W.A,{className:"h-5 w-5"})}),(0,U.jsx)("button",{onClick:async()=>{if((()=>{const e={};return i.monthlyReportRecipient.trim()||(e.monthlyReportRecipient=l("monthlyReport.recipientRequired")),(i.monthlyReportDay<1||i.monthlyReportDay>28)&&(e.monthlyReportDay="Abrechnungstag muss zwischen 1 und 28 liegen"),x(e),0===Object.keys(e).length})())try{m(!0),await s(i),u.oR.success(l("monthlyReport.saveSuccess")),r()}catch(e){u.oR.error(l("monthlyReport.saveError"))}finally{m(!1)}},disabled:c||!i.monthlyReportRecipient.trim(),className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:c?"Speichere...":"Aktivieren",children:c?(0,U.jsx)(S.A,{className:"h-5 w-5 animate-spin"}):(0,U.jsx)(D.A,{className:"h-5 w-5"})})]})]})})})]})};var z=r(9399),_=r(9248),G=r(4538),H=r(2704),Z=r(7012);const Y=["title","titleId"];function K(e,t){let{title:r,titleId:s}=e,n=(0,x.A)(e,Y);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),r?a.createElement("title",{id:s},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"}))}const J=a.forwardRef(K),$=()=>{var e;const{t:t}=(0,n.Bd)(),{user:r}=(0,o.As)(),[s,l]=(0,a.useState)([]),[i,d]=(0,a.useState)([]),[g,x]=(0,a.useState)(!1),[h,p]=(0,a.useState)(!1),b=e=>t("database.tables.".concat(e,".description"),{defaultValue:""}),[y,f]=(0,a.useState)(null),[w,v]=(0,a.useState)(""),[j,k]=(0,a.useState)(!1),[N,A]=(0,a.useState)(0),[R,C]=(0,a.useState)(""),[E,D]=(0,a.useState)(!1),[M,L]=(0,a.useState)(0);(0,a.useEffect)((()=>{P(),I()}),[]),(0,a.useEffect)((()=>{if(N>0){const e=setTimeout((()=>A(N-1)),1e3);return()=>clearTimeout(e)}}),[N]),(0,a.useEffect)((()=>{if(M>0){const e=setTimeout((()=>L(M-1)),1e3);return()=>clearTimeout(e)}}),[M]);const P=async()=>{try{const e=await m.A.get(c.Sn.DATABASE.TABLES);l(e.data)}catch(e){console.error("Fehler beim Laden der Tabellen:",e),u.oR.error(t("database.loadTablesError"))}},I=async()=>{try{p(!0);const e=await m.A.get(c.Sn.DATABASE.LOGS);d(e.data)}catch(e){console.error(t("database.loadLogsError"),e)}finally{p(!1)}},T=()=>{D(!0),L(5)},B=e=>{switch(e){case"low":return"text-yellow-600 bg-yellow-50 border-yellow-200 dark:text-yellow-400 dark:bg-yellow-900/20 dark:border-yellow-700";case"medium":return"text-orange-600 bg-orange-50 border-orange-200 dark:text-orange-400 dark:bg-orange-900/20 dark:border-orange-700";case"high":return"text-red-600 bg-red-50 border-red-200 dark:text-red-400 dark:bg-red-900/20 dark:border-red-700";default:return"text-gray-600 bg-gray-50 border-gray-200 dark:text-gray-400 dark:bg-gray-700 dark:border-gray-600"}},q=e=>{switch(e){case"success":return"text-green-600 dark:text-green-400";case"error":return"text-red-600 dark:text-red-400";case"start":return"text-blue-600 dark:text-blue-400";default:return"text-gray-600 dark:text-gray-400"}};return r&&r.roles.some((e=>"Admin"===e.role.name))?(0,U.jsxs)("div",{className:"space-y-8",children:[(0,U.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6",children:(0,U.jsxs)("div",{className:"flex items-start",children:[(0,U.jsx)(z.A,{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400 mr-3 mt-1"}),(0,U.jsxs)("div",{children:[(0,U.jsx)("h3",{className:"text-lg font-medium text-yellow-800 dark:text-yellow-200 mb-2",children:t("database.warningTitle")}),(0,U.jsxs)("ul",{className:"text-yellow-700 dark:text-yellow-300 text-sm space-y-1",children:[(0,U.jsxs)("li",{children:["\u2022 ",t("database.warning1")]}),(0,U.jsxs)("li",{children:["\u2022 ",t("database.warning2")]}),(0,U.jsxs)("li",{children:["\u2022 ",t("database.warning3")]}),(0,U.jsxs)("li",{children:["\u2022 ",t("database.warning4")]})]})]})]})}),(0,U.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6",children:[(0,U.jsxs)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4 flex items-center",children:[(0,U.jsx)(_.A,{className:"h-5 w-5 mr-2"}),t("database.resetTablesTitle")]}),(0,U.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map((e=>{return(0,U.jsxs)("div",{className:"border rounded-lg p-4 ".concat(B(e.danger)),children:[(0,U.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,U.jsx)("h4",{className:"font-medium",children:(r=e.name,t("database.tables.".concat(r,".displayName"),{defaultValue:r}))}),(0,U.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat("high"===e.danger?"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300":"medium"===e.danger?"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300"),children:"high"===e.danger?t("database.danger.high"):"medium"===e.danger?t("database.danger.medium"):t("database.danger.low")})]}),(0,U.jsx)("p",{className:"text-sm mb-3",children:b(e.name)||e.description}),(0,U.jsxs)("div",{className:"flex items-center text-sm mb-3",children:[(0,U.jsx)(G.A,{className:"h-4 w-4 mr-1"}),t("database.seedDataRestored")]}),(0,U.jsxs)("div",{className:"space-y-2",children:["client"===e.name&&(0,U.jsx)("button",{onClick:T,disabled:g,className:"w-full p-2 bg-orange-600 text-white rounded hover:bg-orange-700 disabled:opacity-50 transition-colors flex items-center justify-center",title:t("database.deleteDemoClients"),children:(0,U.jsx)(_.A,{className:"h-5 w-5"})}),(0,U.jsx)("button",{onClick:()=>(e=>{f(e),k(!0),A(5)})(e.name),disabled:g,className:"w-full p-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50 transition-colors flex items-center justify-center",title:t("database.resetAndRefill"),children:(0,U.jsx)(S.A,{className:"h-5 w-5"})})]})]},e.name);var r}))})]}),(0,U.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6",children:[(0,U.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,U.jsxs)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center",children:[(0,U.jsx)(H.A,{className:"h-5 w-5 mr-2"}),t("database.operationsTitle")]}),(0,U.jsx)("button",{onClick:I,disabled:h,className:"p-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 transition-colors",title:t("common.refresh"),children:(0,U.jsx)(S.A,{className:"h-5 w-5"})})]}),h?(0,U.jsx)("div",{className:"text-center py-4",children:t("database.loadingLogs")}):0===i.length?(0,U.jsx)("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:t("database.noLogsAvailable")}):(0,U.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:i.map(((e,r)=>(0,U.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded text-sm",children:[(0,U.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,U.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:new Date(e.timestamp).toLocaleString()}),(0,U.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.operation}),(0,U.jsxs)("span",{className:"font-medium ".concat(q(e.status)),children:["success"===e.status?"\u2713":"error"===e.status?"\u2717":"\u2022"," ",t("database.logStatus.".concat(e.status))]})]}),e.error&&(0,U.jsx)("span",{className:"text-red-600 dark:text-red-400 text-xs max-w-xs truncate",children:e.error})]},r)))})]}),j&&(0,U.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,U.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[(0,U.jsxs)("div",{className:"flex items-center mb-4",children:[(0,U.jsx)(z.A,{className:"h-6 w-6 text-orange-600 mr-2"}),(0,U.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t("database.confirmResetTitle")})]}),(0,U.jsxs)("div",{className:"mb-4",children:[(0,U.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-2",children:t("database.confirmResetMessage",{tableName:null===(e=s.find((e=>e.name===y)))||void 0===e?void 0:e.displayName})}),(0,U.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:t("database.confirmResetWarning")}),N>0&&(0,U.jsxs)("div",{className:"flex items-center text-orange-600 dark:text-orange-400 mb-3",children:[(0,U.jsx)(Z.A,{className:"h-4 w-4 mr-1"}),t("database.reflectionTime",{seconds:N})]})]}),(0,U.jsxs)("div",{className:"mb-4",children:[(0,U.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,U.jsx)(J,{className:"h-4 w-4 inline mr-1"}),t("database.adminPasswordLabel")]}),(0,U.jsx)("input",{type:"password",value:w,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:t("database.adminPasswordPlaceholder")})]}),(0,U.jsxs)("div",{className:"flex space-x-3",children:[(0,U.jsx)("button",{onClick:async()=>{if(y&&w)if(N>0)u.oR.error(t("database.waitSeconds",{seconds:N}));else try{x(!0),await m.A.post(c.Sn.DATABASE.RESET_TABLE,{tableName:y,adminPassword:w}),u.oR.success(t("database.resetTableSuccess",{tableName:y})),k(!1),f(null),v(""),I()}catch(a){var e,r;u.oR.error((null===(e=a.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||t("database.resetTableError"))}finally{x(!1)}else u.oR.error(t("database.passwordRequired"))},disabled:g||N>0||!w,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded hover:bg-orange-700 disabled:opacity-50 transition-colors",children:t(g?"database.resetting":"common.confirm")}),(0,U.jsx)("button",{onClick:()=>{k(!1),f(null),v(""),A(0)},disabled:g,className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors",children:t("common.cancel")})]})]})}),E&&(0,U.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,U.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[(0,U.jsxs)("div",{className:"flex items-center mb-4",children:[(0,U.jsx)(z.A,{className:"h-6 w-6 text-orange-600 mr-2"}),(0,U.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t("database.confirmDeleteDemoClientsTitle")})]}),(0,U.jsxs)("div",{className:"mb-4",children:[(0,U.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-2",children:t("database.confirmDeleteDemoClientsMessage")}),(0,U.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:t("database.confirmDeleteDemoClientsWarning")}),M>0&&(0,U.jsxs)("div",{className:"flex items-center text-orange-600 dark:text-orange-400 mb-3",children:[(0,U.jsx)(Z.A,{className:"h-4 w-4 mr-1"}),t("database.reflectionTime",{seconds:M})]})]}),(0,U.jsxs)("div",{className:"mb-4",children:[(0,U.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,U.jsx)(J,{className:"h-4 w-4 inline mr-1"}),t("database.adminPasswordLabel")]}),(0,U.jsx)("input",{type:"password",value:R,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:t("database.adminPasswordPlaceholder")})]}),(0,U.jsxs)("div",{className:"flex space-x-3",children:[(0,U.jsx)("button",{onClick:async()=>{if(R)if(M>0)u.oR.error(t("database.waitSeconds",{seconds:M}));else try{x(!0);await m.A.post(c.Sn.DATABASE.DELETE_DEMO_CLIENTS,{adminPassword:R});u.oR.success(t("database.deleteDemoClientsSuccess")),D(!1),C(""),I()}catch(a){var e,r;u.oR.error((null===(e=a.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||t("database.deleteDemoClientsError"))}finally{x(!1)}else u.oR.error(t("database.passwordRequired"))},disabled:g||M>0||!R,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded hover:bg-orange-700 disabled:opacity-50 transition-colors",children:t(g?"database.deleting":"common.confirm")}),(0,U.jsx)("button",{onClick:()=>{D(!1),C(""),L(0)},disabled:g,className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors",children:t("common.cancel")})]})]})})]}):(0,U.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6 text-center",children:[(0,U.jsx)(z.A,{className:"h-12 w-12 text-red-600 dark:text-red-400 mx-auto mb-4"}),(0,U.jsx)("p",{className:"text-red-800 dark:text-red-200 font-medium",children:t("database.noPermission")}),(0,U.jsx)("p",{className:"text-red-600 dark:text-red-400 text-sm mt-2",children:t("database.adminOnly")})]})};var Q=r(8662),X=r(8010),ee=r(9670),te=r(4832),re=r(9531);const ae=["title","titleId"];function se(e,t){let{title:r,titleId:s}=e,n=(0,x.A)(e,ae);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),r?a.createElement("title",{id:s},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"}))}const ne=a.forwardRef(se);var oe=r(8153),le=r(2811);const ie="/password-manager",de={getAll:async()=>(await m.A.get(ie)).data,getById:async e=>(await m.A.get(c.Sn.PASSWORD_MANAGER.BY_ID(e))).data,getPassword:async e=>(await m.A.get(c.Sn.PASSWORD_MANAGER.PASSWORD(e))).data,create:async e=>(await m.A.post(ie,e)).data,update:async(e,t)=>(await m.A.put(c.Sn.PASSWORD_MANAGER.BY_ID(e),t)).data,async delete(e){await m.A.delete(c.Sn.PASSWORD_MANAGER.BY_ID(e))},async generatePassword(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await m.A.post(c.Sn.PASSWORD_MANAGER.GENERATE_PASSWORD,e)).data},getAuditLogs:async e=>(await m.A.get(c.Sn.PASSWORD_MANAGER.AUDIT_LOGS(e))).data,getPermissions:async e=>(await m.A.get(c.Sn.PASSWORD_MANAGER.PERMISSIONS(e))).data,async updatePermissions(e,t){await m.A.put(c.Sn.PASSWORD_MANAGER.PERMISSIONS(e),t)},async logPasswordCopy(e){await m.A.post(c.Sn.PASSWORD_MANAGER.COPY_PASSWORD(e))}};var ce=r(5657);const me=e=>{let{isOpen:t,onClose:r,entry:s,onEntrySaved:o}=e;const{t:l}=(0,n.Bd)(),{openSidepane:i,closeSidepane:d}=(0,ce.N)(),[c,m]=(0,a.useState)(window.innerWidth<640),[g,x]=(0,a.useState)(window.innerWidth>1070),[h,p]=(0,a.useState)(""),[b,y]=(0,a.useState)(""),[f,w]=(0,a.useState)(""),[v,k]=(0,a.useState)(""),[N,A]=(0,a.useState)(""),[R,C]=(0,a.useState)(!1),[E,M]=(0,a.useState)(null),[L,P]=(0,a.useState)(!1),[I,T]=(0,a.useState)(!1),[B,q]=(0,a.useState)(null);(0,a.useEffect)((()=>{const e=()=>{m(window.innerWidth<640),x(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,a.useEffect)((()=>(t?i():d(),()=>{d()})),[t,i,d]),(0,a.useEffect)((()=>{t&&(s?(p(s.title||""),y(s.url||""),w(s.username||""),k(s.password||""),A(s.notes||""),C(!1)):(p(""),y(""),w(""),k(""),A(""),C(!1)),M(null),q(null))}),[t,s]),(0,a.useEffect)((()=>{v?F(v):q(null)}),[v]);const F=e=>{let t=0;e.length>=8&&t++,e.length>=12&&t++,e.length>=16&&t++,/[a-z]/.test(e)&&t++,/[A-Z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[^a-zA-Z0-9]/.test(e)&&t++,q(t<=2?"weak":t<=4?"medium":t<=6?"strong":"veryStrong")},V=()=>{switch(B){case"weak":return"bg-red-500";case"medium":return"bg-yellow-500";case"strong":return"bg-blue-500";case"veryStrong":return"bg-green-500";default:return"bg-gray-300"}},z=()=>{switch(B){case"weak":return l("passwordManager.passwordStrengthWeak");case"medium":return l("passwordManager.passwordStrengthMedium");case"strong":return l("passwordManager.passwordStrengthStrong");case"veryStrong":return l("passwordManager.passwordStrengthVeryStrong");default:return""}},_=async()=>{try{T(!0);const e=await de.generatePassword({length:16,includeNumbers:!0,includeSymbols:!0});k(e.password),C(!0)}catch(E){console.error("Error generating password:",E),u.oR.error(l("passwordManager.error")||"Fehler beim Generieren des Passworts")}finally{T(!1)}},G=async e=>{e.preventDefault(),M(null),P(!0);try{if(!h.trim())return M(l("passwordManager.titleRequired")),void P(!1);if(!v.trim())return M(l("passwordManager.passwordRequired")),void P(!1);if(b&&!(e=>{if(!e)return!0;try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(t){return!1}})(b))return M(l("passwordManager.urlInvalid")),void P(!1);if(s){const e={title:h.trim(),url:b.trim()||void 0,username:f.trim()||void 0,password:v.trim(),notes:N.trim()||void 0},t=await de.update(s.id,e);o(t),u.oR.success(l("passwordManager.editEntry")||"Eintrag erfolgreich aktualisiert")}else{const e={title:h.trim(),url:b.trim()||void 0,username:f.trim()||void 0,password:v.trim(),notes:N.trim()||void 0},t=await de.create(e);o(t),u.oR.success(l("passwordManager.createEntry")||"Eintrag erfolgreich erstellt")}H()}catch(E){var t,r;console.error("Error saving password entry:",E),M((null===(t=E.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||E.message||l("passwordManager.error"))}finally{P(!1)}},H=()=>{p(""),y(""),w(""),k(""),A(""),C(!1),M(null),q(null),r()};return c?(0,U.jsxs)(O.lG,{open:t,onClose:H,className:"relative z-50",children:[(0,U.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,U.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,U.jsxs)(O.lG.Panel,{className:"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] flex flex-col",children:[(0,U.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,U.jsx)(O.lG.Title,{className:"text-lg font-semibold dark:text-white",children:l(s?"passwordManager.editEntry":"passwordManager.createEntry")}),(0,U.jsx)("button",{onClick:H,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,U.jsx)(W.A,{className:"h-6 w-6"})})]}),(0,U.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[E&&(0,U.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:E}),(0,U.jsxs)("form",{onSubmit:G,className:"space-y-4",children:[(0,U.jsxs)("div",{children:[(0,U.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[l("passwordManager.entryTitle")," *"]}),(0,U.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,U.jsxs)("div",{children:[(0,U.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:l("passwordManager.entryUrl")}),(0,U.jsx)("input",{type:"url",value:b,onChange:e=>y(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"https://example.com"})]}),(0,U.jsxs)("div",{children:[(0,U.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:l("passwordManager.entryUsername")}),(0,U.jsx)("input",{type:"text",value:f,onChange:e=>w(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,U.jsxs)("div",{children:[(0,U.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[l("passwordManager.entryPassword")," *"]}),(0,U.jsxs)("div",{className:"mt-1 flex gap-2",children:[(0,U.jsxs)("div",{className:"flex-1 relative",children:[(0,U.jsx)("input",{type:R?"text":"password",value:v,onChange:e=>k(e.target.value),className:"block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 pr-10 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0}),(0,U.jsx)("button",{type:"button",onClick:()=>C(!R),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:R?(0,U.jsx)(te.A,{className:"h-5 w-5"}):(0,U.jsx)(re.A,{className:"h-5 w-5"})})]}),(0,U.jsxs)("div",{className:"relative group",children:[(0,U.jsx)("button",{type:"button",onClick:_,disabled:I,className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",title:l("passwordManager.generatePassword"),children:I?(0,U.jsx)(S.A,{className:"h-5 w-5 animate-spin"}):(0,U.jsx)(j.A,{className:"h-5 w-5"})}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("passwordManager.generatePassword")})]})]}),B&&(0,U.jsx)("div",{className:"mt-2",children:(0,U.jsxs)("div",{className:"flex items-center gap-2",children:[(0,U.jsx)("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,U.jsx)("div",{className:"h-full ".concat(V()," transition-all duration-300"),style:{width:"weak"===B?"25%":"medium"===B?"50%":"strong"===B?"75%":"100%"}})}),(0,U.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:z()})]})})]}),(0,U.jsxs)("div",{children:[(0,U.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:l("passwordManager.entryNotes")}),(0,U.jsx)("textarea",{value:N,onChange:e=>A(e.target.value),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,U.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,U.jsxs)("div",{className:"relative group",children:[(0,U.jsx)("button",{type:"button",onClick:H,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,U.jsx)(W.A,{className:"h-5 w-5"})}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("passwordManager.cancel")})]}),(0,U.jsxs)("div",{className:"relative group",children:[(0,U.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",disabled:L,children:L?(0,U.jsx)(S.A,{className:"h-5 w-5 animate-spin"}):(0,U.jsx)(D.A,{className:"h-5 w-5"})}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l(L?"common.saving":"passwordManager.save")})]})]})]})]})]})})]}):(0,U.jsxs)(U.Fragment,{children:[t&&!g&&(0,U.jsx)("div",{className:"fixed inset-0 bg-black/10 sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,U.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,U.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,U.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:l(s?"passwordManager.editEntry":"passwordManager.createEntry")}),(0,U.jsx)("button",{onClick:H,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,U.jsx)(W.A,{className:"h-6 w-6"})})]}),(0,U.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[E&&(0,U.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:E}),(0,U.jsxs)("form",{onSubmit:G,className:"space-y-4",children:[(0,U.jsxs)("div",{children:[(0,U.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[l("passwordManager.entryTitle")," *"]}),(0,U.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,U.jsxs)("div",{children:[(0,U.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:l("passwordManager.entryUrl")}),(0,U.jsx)("input",{type:"url",value:b,onChange:e=>y(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"https://example.com"})]}),(0,U.jsxs)("div",{children:[(0,U.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:l("passwordManager.entryUsername")}),(0,U.jsx)("input",{type:"text",value:f,onChange:e=>w(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,U.jsxs)("div",{children:[(0,U.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[l("passwordManager.entryPassword")," *"]}),(0,U.jsxs)("div",{className:"mt-1 flex gap-2",children:[(0,U.jsxs)("div",{className:"flex-1 relative",children:[(0,U.jsx)("input",{type:R?"text":"password",value:v,onChange:e=>k(e.target.value),className:"block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 pr-10 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0}),(0,U.jsx)("button",{type:"button",onClick:()=>C(!R),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:R?(0,U.jsx)(te.A,{className:"h-5 w-5"}):(0,U.jsx)(re.A,{className:"h-5 w-5"})})]}),(0,U.jsxs)("div",{className:"relative group",children:[(0,U.jsx)("button",{type:"button",onClick:_,disabled:I,className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",title:l("passwordManager.generatePassword"),children:I?(0,U.jsx)(S.A,{className:"h-5 w-5 animate-spin"}):(0,U.jsx)(j.A,{className:"h-5 w-5"})}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("passwordManager.generatePassword")})]})]}),B&&(0,U.jsx)("div",{className:"mt-2",children:(0,U.jsxs)("div",{className:"flex items-center gap-2",children:[(0,U.jsx)("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,U.jsx)("div",{className:"h-full ".concat(V()," transition-all duration-300"),style:{width:"weak"===B?"25%":"medium"===B?"50%":"strong"===B?"75%":"100%"}})}),(0,U.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:z()})]})})]}),(0,U.jsxs)("div",{children:[(0,U.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:l("passwordManager.entryNotes")}),(0,U.jsx)("textarea",{value:N,onChange:e=>A(e.target.value),rows:3,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,U.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,U.jsxs)("div",{className:"relative group",children:[(0,U.jsx)("button",{type:"button",onClick:H,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,U.jsx)(W.A,{className:"h-5 w-5"})}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("passwordManager.cancel")})]}),(0,U.jsxs)("div",{className:"relative group",children:[(0,U.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",disabled:L,children:L?(0,U.jsx)(S.A,{className:"h-5 w-5 animate-spin"}):(0,U.jsx)(D.A,{className:"h-5 w-5"})}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l(L?"common.saving":"passwordManager.save")})]})]})]})]})]})]})};var ue=r(7504),ge=r(4129);const xe=e=>{let{isOpen:t,onClose:r,entryId:s,onPermissionsUpdated:o}=e;const{t:l}=(0,n.Bd)(),[i,d]=(0,a.useState)([]),[g,x]=(0,a.useState)([]),[h,p]=(0,a.useState)([]),[b,y]=(0,a.useState)([]),[f,w]=(0,a.useState)(!1),[v,j]=(0,a.useState)(!1),[k,N]=(0,a.useState)(""),[A,R]=(0,a.useState)("");(0,a.useEffect)((()=>{t&&s&&C()}),[t,s]);const C=async()=>{try{w(!0);const[e,t,r]=await Promise.all([de.getPermissions(s),m.A.get(c.Sn.ROLES.BASE),m.A.get(c.Sn.USERS.BASE)]);d(e.rolePermissions),x(e.userPermissions),p(t.data||[]),y(r.data||[])}catch(e){console.error("Error loading permissions:",e),u.oR.error(l("passwordManager.errorLoadingPermissions")||"Fehler beim Laden der Berechtigungen")}finally{w(!1)}},E=(e,t,r)=>{"role"===e?d(i.map((e=>e.roleId===t?(0,M.A)((0,M.A)({},e),{},{[r]:!e[r]}):e))):x(g.map((e=>e.userId===t?(0,M.A)((0,M.A)({},e),{},{[r]:!e[r]}):e)))},L=h.filter((e=>!i.find((t=>t.roleId===e.id)))),P=b.filter((e=>!g.find((t=>t.userId===e.id))));return(0,U.jsxs)(O.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,U.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,U.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,U.jsxs)(O.lG.Panel,{className:"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] flex flex-col",children:[(0,U.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,U.jsx)(O.lG.Title,{className:"text-lg font-semibold dark:text-white",children:l("passwordManager.managePermissions")}),(0,U.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,U.jsx)(W.A,{className:"h-6 w-6"})})]}),(0,U.jsx)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:f?(0,U.jsx)("div",{className:"text-center py-8",children:(0,U.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:l("common.loading")})}):(0,U.jsxs)("div",{className:"space-y-6",children:[(0,U.jsxs)("div",{children:[(0,U.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,U.jsxs)("h3",{className:"text-md font-semibold dark:text-white flex items-center gap-2",children:[(0,U.jsx)(ue.A,{className:"h-5 w-5"}),l("passwordManager.rolePermissions")]}),L.length>0&&(0,U.jsxs)("div",{className:"flex gap-2",children:[(0,U.jsxs)("select",{value:k,onChange:e=>N(Number(e.target.value)||""),className:"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,U.jsx)("option",{value:"",children:l("passwordManager.selectRole")}),L.map((e=>(0,U.jsx)("option",{value:e.id,children:e.name},e.id)))]}),(0,U.jsxs)("div",{className:"relative group",children:[(0,U.jsx)("button",{onClick:()=>{if(!k||i.find((e=>e.roleId===k)))return;const e=h.find((e=>e.id===k));e&&(d([...i,{id:0,passwordEntryId:s,roleId:k,canView:!1,canEdit:!1,canDelete:!1,role:{id:e.id,name:e.name}}]),N(""))},className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-md",title:l("common.add"),children:(0,U.jsx)(Q.A,{className:"h-5 w-5"})}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("common.add")})]})]})]}),0===i.length?(0,U.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:l("passwordManager.noRolePermissions")}):(0,U.jsx)("div",{className:"space-y-2",children:i.map((e=>{var t;return(0,U.jsxs)("div",{className:"p-3 border border-gray-200 dark:border-gray-700 rounded-md",children:[(0,U.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,U.jsx)("span",{className:"font-medium dark:text-white",children:(null===(t=e.role)||void 0===t?void 0:t.name)||"Rolle ".concat(e.roleId)}),(0,U.jsx)("button",{onClick:()=>{return t=e.roleId,void d(i.filter((e=>e.roleId!==t)));var t},className:"text-red-600 dark:text-red-400 hover:text-red-700 text-sm",children:l("common.remove")})]}),(0,U.jsxs)("div",{className:"flex gap-4",children:[(0,U.jsxs)("label",{className:"flex items-center gap-2",children:[(0,U.jsx)("input",{type:"checkbox",checked:e.canView,onChange:()=>E("role",e.roleId,"canView"),className:"rounded"}),(0,U.jsx)("span",{className:"text-sm dark:text-gray-300",children:l("passwordManager.canView")})]}),(0,U.jsxs)("label",{className:"flex items-center gap-2",children:[(0,U.jsx)("input",{type:"checkbox",checked:e.canEdit,onChange:()=>E("role",e.roleId,"canEdit"),className:"rounded"}),(0,U.jsx)("span",{className:"text-sm dark:text-gray-300",children:l("passwordManager.canEdit")})]}),(0,U.jsxs)("label",{className:"flex items-center gap-2",children:[(0,U.jsx)("input",{type:"checkbox",checked:e.canDelete,onChange:()=>E("role",e.roleId,"canDelete"),className:"rounded"}),(0,U.jsx)("span",{className:"text-sm dark:text-gray-300",children:l("passwordManager.canDelete")})]})]})]},e.roleId)}))})]}),(0,U.jsxs)("div",{children:[(0,U.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,U.jsxs)("h3",{className:"text-md font-semibold dark:text-white flex items-center gap-2",children:[(0,U.jsx)(ge.A,{className:"h-5 w-5"}),l("passwordManager.userPermissions")]}),P.length>0&&(0,U.jsxs)("div",{className:"flex gap-2",children:[(0,U.jsxs)("select",{value:A,onChange:e=>R(Number(e.target.value)||""),className:"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,U.jsx)("option",{value:"",children:l("passwordManager.selectUser")}),P.map((e=>(0,U.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName," (",e.email,")"]},e.id)))]}),(0,U.jsxs)("div",{className:"relative group",children:[(0,U.jsx)("button",{onClick:()=>{if(!A||g.find((e=>e.userId===A)))return;const e=b.find((e=>e.id===A));e&&(x([...g,{id:0,passwordEntryId:s,userId:A,canView:!1,canEdit:!1,canDelete:!1,user:{id:e.id,firstName:e.firstName,lastName:e.lastName,email:e.email}}]),R(""))},className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-md",title:l("common.add"),children:(0,U.jsx)(Q.A,{className:"h-5 w-5"})}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("common.add")})]})]})]}),0===g.length?(0,U.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:l("passwordManager.noUserPermissions")}):(0,U.jsx)("div",{className:"space-y-2",children:g.map((e=>{var t,r,a;return(0,U.jsxs)("div",{className:"p-3 border border-gray-200 dark:border-gray-700 rounded-md",children:[(0,U.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,U.jsxs)("span",{className:"font-medium dark:text-white",children:[null===(t=e.user)||void 0===t?void 0:t.firstName," ",null===(r=e.user)||void 0===r?void 0:r.lastName," (",null===(a=e.user)||void 0===a?void 0:a.email,")"]}),(0,U.jsx)("button",{onClick:()=>{return t=e.userId,void x(g.filter((e=>e.userId!==t)));var t},className:"text-red-600 dark:text-red-400 hover:text-red-700 text-sm",children:l("common.remove")})]}),(0,U.jsxs)("div",{className:"flex gap-4",children:[(0,U.jsxs)("label",{className:"flex items-center gap-2",children:[(0,U.jsx)("input",{type:"checkbox",checked:e.canView,onChange:()=>E("user",e.userId,"canView"),className:"rounded"}),(0,U.jsx)("span",{className:"text-sm dark:text-gray-300",children:l("passwordManager.canView")})]}),(0,U.jsxs)("label",{className:"flex items-center gap-2",children:[(0,U.jsx)("input",{type:"checkbox",checked:e.canEdit,onChange:()=>E("user",e.userId,"canEdit"),className:"rounded"}),(0,U.jsx)("span",{className:"text-sm dark:text-gray-300",children:l("passwordManager.canEdit")})]}),(0,U.jsxs)("label",{className:"flex items-center gap-2",children:[(0,U.jsx)("input",{type:"checkbox",checked:e.canDelete,onChange:()=>E("user",e.userId,"canDelete"),className:"rounded"}),(0,U.jsx)("span",{className:"text-sm dark:text-gray-300",children:l("passwordManager.canDelete")})]})]})]},e.userId)}))})]})]})}),(0,U.jsxs)("div",{className:"flex items-center justify-end gap-2 p-4 border-t dark:border-gray-700 flex-shrink-0",children:[(0,U.jsx)("button",{onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600",children:l("common.cancel")}),(0,U.jsxs)("div",{className:"relative group",children:[(0,U.jsx)("button",{onClick:async()=>{try{j(!0);const e={rolePermissions:i.map((e=>({roleId:e.roleId,canView:e.canView,canEdit:e.canEdit,canDelete:e.canDelete}))),userPermissions:g.map((e=>({userId:e.userId,canView:e.canView,canEdit:e.canEdit,canDelete:e.canDelete})))};await de.updatePermissions(s,e),u.oR.success(l("passwordManager.permissionsUpdated")||"Berechtigungen erfolgreich aktualisiert"),o(),r()}catch(e){console.error("Error saving permissions:",e),u.oR.error(l("passwordManager.errorSavingPermissions")||"Fehler beim Speichern der Berechtigungen")}finally{j(!1)}},disabled:v,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:l("common.save"),children:v?(0,U.jsx)(S.A,{className:"h-5 w-5 animate-spin"}):(0,U.jsx)(D.A,{className:"h-5 w-5"})}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:l("common.save")})]})]})]})})]})},he=e=>{let{isOpen:t,onClose:r,entryId:s}=e;const{t:o}=(0,n.Bd)(),[l,i]=(0,a.useState)([]),[d,c]=(0,a.useState)(!1);(0,a.useEffect)((()=>{t&&s&&m()}),[t,s]);const m=async()=>{try{c(!0);const e=await de.getAuditLogs(s);i(e)}catch(e){console.error("Error loading audit logs:",e),u.oR.error(o("passwordManager.errorLoadingAuditLogs")||"Fehler beim Laden der Audit-Logs")}finally{c(!1)}},g=e=>{const t=new Date(e);return new Intl.DateTimeFormat("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(t)};return(0,U.jsxs)(O.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,U.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,U.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,U.jsxs)(O.lG.Panel,{className:"mx-auto max-w-3xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] flex flex-col",children:[(0,U.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,U.jsxs)(O.lG.Title,{className:"text-lg font-semibold dark:text-white flex items-center gap-2",children:[(0,U.jsx)(Z.A,{className:"h-5 w-5"}),o("passwordManager.auditLogs")]}),(0,U.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,U.jsx)(W.A,{className:"h-6 w-6"})})]}),(0,U.jsx)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:d?(0,U.jsx)("div",{className:"text-center py-8",children:(0,U.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:o("common.loading")})}):0===l.length?(0,U.jsx)("div",{className:"text-center py-8",children:(0,U.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:o("passwordManager.noAuditLogs")})}):(0,U.jsx)("div",{className:"space-y-3",children:l.map((e=>{return(0,U.jsxs)("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-md",children:[(0,U.jsx)("div",{className:"flex items-start justify-between mb-2",children:(0,U.jsxs)("div",{className:"flex-1",children:[(0,U.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,U.jsx)("span",{className:"font-semibold dark:text-white",children:(t=e.action,{view:o("passwordManager.auditLogActionView")||"Anzeigen",view_password:o("passwordManager.auditLogActionViewPassword")||"Passwort anzeigen",copy_password:o("passwordManager.auditLogActionCopyPassword")||"Passwort kopieren",create:o("passwordManager.auditLogActionCreate")||"Erstellen",update:o("passwordManager.auditLogActionUpdate")||"Aktualisieren",delete:o("passwordManager.auditLogActionDelete")||"L\xf6schen"}[t]||t)}),e.user&&(0,U.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["von ",e.user.firstName," ",e.user.lastName]})]}),(0,U.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[(0,U.jsx)(Z.A,{className:"h-4 w-4"}),g(e.createdAt)]})]})}),e.details&&Object.keys(e.details).length>0&&(0,U.jsx)("div",{className:"mt-2 p-2 bg-gray-50 dark:bg-gray-900 rounded text-sm",children:(0,U.jsx)("pre",{className:"text-xs text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:JSON.stringify(e.details,null,2)})}),(e.ipAddress||e.userAgent)&&(0,U.jsxs)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:[e.ipAddress&&(0,U.jsxs)("div",{children:["IP: ",e.ipAddress]}),e.userAgent&&(0,U.jsxs)("div",{children:["User-Agent: ",e.userAgent]})]})]},e.id);var t}))})}),(0,U.jsx)("div",{className:"flex items-center justify-end p-4 border-t dark:border-gray-700 flex-shrink-0",children:(0,U.jsx)("button",{onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600",children:o("common.close")})})]})})]})};var pe=r(4426),be=r(7829),ye=r(6400);const fe="password-manager-table",we=()=>{const{t:e}=(0,n.Bd)(),{hasPermission:t}=(0,l.S)(),{user:r}=(0,o.As)(),[s,i]=(0,a.useState)([]),[d,c]=(0,a.useState)(!1),[m,g]=(0,a.useState)(!1),[x,h]=(0,a.useState)(null),[p,b]=(0,a.useState)(null),[y,f]=(0,a.useState)({}),[w,v]=(0,a.useState)(null),[j,k]=(0,a.useState)(null),[N,A]=(0,a.useState)([]),[S,R]=(0,a.useState)([]),[C,E]=(0,a.useState)([]),[D,L]=(0,a.useState)(!1),[P,I]=(0,a.useState)(""),[T,B]=(0,a.useState)(null),q=(0,a.useMemo)((()=>[{id:"title",label:e("passwordManager.entryTitle")},{id:"url",label:e("passwordManager.entryUrl")},{id:"username",label:e("passwordManager.entryUsername")},{id:"notes",label:e("passwordManager.entryNotes")},{id:"createdAt",label:e("passwordManager.sortByCreated")},{id:"updatedAt",label:e("passwordManager.sortByUpdated")},{id:"createdBy",label:e("common.createdBy")}]),[e]),F=t("password_manager","read","page"),O=t("password_entry_create","write","button"),W=t("password_manager","write","page"),V=t("password_manager","write","page");(0,a.useEffect)((()=>{F&&z()}),[F]);const z=async()=>{try{c(!0);const e=await de.getAll();i(e)}catch(t){console.error("Error loading password entries:",t),u.oR.error(e("passwordManager.error")||"Fehler beim Laden der Eintr\xe4ge")}finally{c(!1)}},G=e=>{if(!e)return!1;try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(t){return!1}},H=(e,t,r)=>{A(e),R(t),r&&E(r)},Y=()=>{A([]),R([]),E([]),I(""),B(null)},K={title:(e,t)=>{var r;const a=(null===(r=e.title)||void 0===r?void 0:r.toLowerCase())||"";return J(a,t)},url:(e,t)=>{var r;const a=(null===(r=e.url)||void 0===r?void 0:r.toLowerCase())||"";return J(a,t)},username:(e,t)=>{var r;const a=(null===(r=e.username)||void 0===r?void 0:r.toLowerCase())||"";return J(a,t)},notes:(e,t)=>{var r;const a=(null===(r=e.notes)||void 0===r?void 0:r.toLowerCase())||"";return J(a,t)},createdAt:(e,t)=>$(new Date(e.createdAt),t),updatedAt:(e,t)=>$(new Date(e.updatedAt),t),createdBy:(e,t)=>{const r=e.createdBy?"".concat(e.createdBy.firstName," ").concat(e.createdBy.lastName).toLowerCase():"";return J(r,t)}},J=(e,t)=>{const r=(t.value||"").toLowerCase();switch(t.operator){case"equals":return e===r;case"contains":return e.includes(r);case"startsWith":return e.startsWith(r);case"endsWith":return e.endsWith(r);case"isNull":return!e;case"isNotNull":return!!e;default:return!1}},$=(e,t)=>{const r=t.value?new Date(t.value):null;if(!r||isNaN(r.getTime()))return!1;const a=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(r.getFullYear(),r.getMonth(),r.getDate());switch(t.operator){case"equals":return a.getTime()===s.getTime();case"before":return a.getTime()<s.getTime();case"after":return a.getTime()>s.getTime();default:return!1}},ae=(e,t)=>{switch(t){case"title":return e.title;case"url":return e.url;case"username":return e.username;case"notes":return e.notes;case"createdAt":return e.createdAt;case"updatedAt":return e.updatedAt;case"createdBy":return e.createdBy?"".concat(e.createdBy.firstName," ").concat(e.createdBy.lastName):"";default:return e[t]}},se=(0,a.useMemo)((()=>{let e=[...s];return N.length>0&&(e=(0,ye.W5)(e,N,S,ae,K)),C.length>0?e.sort(((e,t)=>{for(const r of C.sort(((e,t)=>e.priority-t.priority))){const a=ae(e,r.column),s=ae(t,r.column);let n=0;if(n="string"===typeof a&&"string"===typeof s?a.toLowerCase().localeCompare(s.toLowerCase()):a instanceof Date&&s instanceof Date?a.getTime()-s.getTime():a>s?1:a<s?-1:0,0!==n)return"asc"===r.direction?n:-n}return 0})):e.sort(((e,t)=>{const r=new Date(e.createdAt).getTime();return new Date(t.createdAt).getTime()-r})),e}),[s,N,S,C]);return F?(0,U.jsxs)("div",{className:"space-y-4",children:[(0,U.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,U.jsx)("div",{className:"flex items-center",children:O&&(0,U.jsxs)("div",{className:"relative group",children:[(0,U.jsx)("button",{onClick:()=>{h(null),g(!0)},className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":e("passwordManager.createEntry"),children:(0,U.jsx)(Q.A,{className:"h-4 w-4"})}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("passwordManager.createEntry")})]})}),(0,U.jsx)("div",{className:"flex items-center gap-2",children:(0,U.jsx)("div",{className:"relative",children:(0,U.jsxs)("button",{className:"p-2 rounded-md border ".concat(N.length>0?"border-blue-300 bg-blue-50 text-blue-600":"border-gray-300 hover:bg-gray-100"),onClick:()=>L(!D),title:e("common.filter"),children:[(0,U.jsx)(X.A,{className:"h-5 w-5"}),N.length>0&&(0,U.jsx)("span",{className:"absolute top-0 right-0 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center",children:N.length})]})})})]}),D&&(0,U.jsx)("div",{className:"px-3 sm:px-4 md:px-6",children:(0,U.jsx)(pe.A,{columns:q,onApply:H,onReset:Y,savedConditions:N,savedOperators:S,savedSortDirections:C,onSortDirectionsChange:E,tableId:fe})}),(0,U.jsx)("div",{className:"px-3 sm:px-4 md:px-6",children:(0,U.jsx)(be.A,{tableId:fe,onSelectFilter:(e,t,r)=>H(e,t,r),onReset:Y,activeFilterName:P,selectedFilterId:T,onFilterChange:(e,t,r,a,s)=>{I(e),B(t),H(r,a,s)},defaultFilterName:e("passwordManager.allEntries","Alle Eintr\xe4ge")})}),d?(0,U.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 text-center",children:(0,U.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:e("passwordManager.loading")})}):0===se.length?(0,U.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 text-center",children:(0,U.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:N.length>0?e("passwordManager.noEntriesFiltered","Keine Eintr\xe4ge gefunden"):e("passwordManager.noEntries")})}):(0,U.jsx)("div",{className:"space-y-3",children:se.map((t=>(0,U.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-4",children:(0,U.jsxs)("div",{className:"flex items-start justify-between",children:[(0,U.jsxs)("div",{className:"flex-1",children:[(0,U.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:t.title}),t.url&&(0,U.jsx)("div",{className:"mb-2",children:(0,U.jsxs)("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1",onClick:r=>{G(t.url||"")||(r.preventDefault(),u.oR.error(e("passwordManager.urlInvalid")))},children:[(0,U.jsx)(ee.A,{className:"h-4 w-4"}),t.url]})}),t.username&&(0,U.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:[(0,U.jsxs)("span",{className:"font-medium",children:[e("passwordManager.entryUsername"),":"]})," ",t.username]}),p===t.id&&y[t.id]&&(0,U.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1 font-mono",children:[(0,U.jsxs)("span",{className:"font-medium",children:[e("passwordManager.entryPassword"),":"]})," ",y[t.id]]}),t.notes&&(0,U.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:t.notes}),(0,U.jsxs)("div",{className:"mt-3 flex items-center gap-2 flex-wrap",children:[(0,U.jsxs)("div",{className:"relative group",children:[(0,U.jsx)("button",{onClick:()=>(async t=>{try{if(!y[t.id]){const e=await de.getPassword(t.id);f((r=>(0,M.A)((0,M.A)({},r),{},{[t.id]:e.password})))}b(t.id)}catch(r){console.error("Error showing password:",r),u.oR.error(e("passwordManager.error")||"Fehler beim Anzeigen des Passworts")}})(t),className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:p===t.id?e("passwordManager.hidePassword"):e("passwordManager.showPassword"),children:p===t.id?(0,U.jsx)(te.A,{className:"h-5 w-5"}):(0,U.jsx)(re.A,{className:"h-5 w-5"})}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:p===t.id?e("passwordManager.hidePassword"):e("passwordManager.showPassword")})]}),(0,U.jsxs)("div",{className:"relative group",children:[(0,U.jsx)("button",{onClick:()=>(async t=>{try{if(!y[t.id]){const e=await de.getPassword(t.id);f((r=>(0,M.A)((0,M.A)({},r),{},{[t.id]:e.password})))}const a=y[t.id];await navigator.clipboard.writeText(a);try{await de.logPasswordCopy(t.id)}catch(r){console.warn("Error logging password copy:",r)}u.oR.success(e("passwordManager.passwordCopied"))}catch(a){console.error("Error copying password:",a),u.oR.error(e("passwordManager.errorCopyingPassword"))}})(t),className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:e("passwordManager.copyPassword"),children:(0,U.jsx)(ne,{className:"h-5 w-5"})}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("passwordManager.copyPassword")})]}),t.url&&(0,U.jsxs)("div",{className:"relative group",children:[(0,U.jsx)("button",{onClick:()=>(async t=>{try{if(!y[t.id]){const e=await de.getPassword(t.id);f((r=>(0,M.A)((0,M.A)({},r),{},{[t.id]:e.password})))}const a=y[t.id];await navigator.clipboard.writeText(a);try{await de.logPasswordCopy(t.id)}catch(r){console.warn("Error logging password copy:",r)}t.url&&G(t.url)?(window.open(t.url,"_blank","noopener,noreferrer"),u.oR.success(e("passwordManager.passwordCopiedAndOpened"))):u.oR.success(e("passwordManager.passwordCopied"))}catch(a){console.error("Error opening and copying password:",a),u.oR.error(e("passwordManager.errorCopyingPassword"))}})(t),className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md",title:e("passwordManager.openAndCopy"),children:(0,U.jsx)(ee.A,{className:"h-5 w-5"})}),(0,U.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("passwordManager.openAndCopy")})]})]})]}),(0,U.jsxs)("div",{className:"flex items-center gap-2 ml-4 flex-wrap",children:[r&&t.createdById===r.id&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("button",{onClick:()=>v(t.id),className:"p-2 text-purple-600 dark:text-purple-400 hover:bg-purple-50 dark:hover:bg-purple-900/20 rounded-md",title:e("passwordManager.managePermissions"),children:(0,U.jsx)(oe.A,{className:"h-5 w-5"})}),(0,U.jsx)("button",{onClick:()=>k(t.id),className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-900/20 rounded-md",title:e("passwordManager.auditLogs"),children:(0,U.jsx)(Z.A,{className:"h-5 w-5"})})]}),W&&(0,U.jsx)("button",{onClick:()=>(e=>{h(e),g(!0)})(t),className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md",title:e("passwordManager.editEntry"),children:(0,U.jsx)(le.A,{className:"h-5 w-5"})}),V&&(0,U.jsx)("button",{onClick:()=>(async t=>{if(window.confirm(e("passwordManager.deleteConfirm")))try{await de.delete(t.id),i((e=>e.filter((e=>e.id!==t.id)))),u.oR.success(e("passwordManager.deleteEntry")||"Eintrag erfolgreich gel\xf6scht")}catch(s){var r,a;console.error("Error deleting entry:",s),u.oR.error((null===(r=s.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||e("passwordManager.error")||"Fehler beim L\xf6schen")}})(t),className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md",title:e("passwordManager.deleteEntry"),children:(0,U.jsx)(_.A,{className:"h-5 w-5"})})]})]})},t.id)))}),(0,U.jsx)(me,{isOpen:m,onClose:()=>{g(!1),h(null)},entry:x,onEntrySaved:e=>{x?(i((t=>t.map((t=>t.id===e.id?e:t)))),h(null)):i((t=>[e,...t])),g(!1),h(null)}}),w&&(0,U.jsx)(xe,{isOpen:!!w,onClose:()=>v(null),entryId:w,onPermissionsUpdated:()=>{z(),v(null)}}),j&&(0,U.jsx)(he,{isOpen:!!j,onClose:()=>k(null),entryId:j})]}):(0,U.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:(0,U.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:e("passwordManager.error")||"Keine Berechtigung f\xfcr den Passwort-Manager"})})};var ve=r(8625),je=r(3216);const ke=()=>{const{user:e,fetchCurrentUser:t}=(0,o.As)(),{isAdmin:r}=(0,l.S)(),{isDarkMode:x,toggleDarkMode:h}=(0,g.D)(),{showMessage:p}=(0,d.A)(),{t:f}=(0,n.Bd)(),{activeLanguage:w,organizationLanguage:k,setUserLanguage:N,isLoading:R}=(0,i.o)(),{resetTour:C,startTour:M}=(0,ve.z)(),L=(0,je.Zp)(),[P,I]=(0,a.useState)(""),[T,B]=(0,a.useState)(!1),[q,O]=(0,a.useState)(null),[W,z]=(0,a.useState)(null),[_,G]=(0,a.useState)(!1),[H,Z]=(0,a.useState)(null),Y=(0,a.useRef)(null),[K,J]=(0,a.useState)(!1),[Q,X]=(0,a.useState)("personal"),[ee,te]=(0,a.useState)({monthlyReportEnabled:!1,monthlyReportDay:25,monthlyReportRecipient:""}),[re,ae]=(0,a.useState)(!0),[se,ne]=(0,a.useState)(!1);(0,a.useEffect)((()=>{console.log("User:",e),console.log("Is Admin:",r()),console.log("User Roles:",null===e||void 0===e?void 0:e.roles)}),[e,r]),(0,a.useEffect)((()=>{(async()=>{if(null!==e&&void 0!==e&&e.invoiceSettings)try{te({monthlyReportEnabled:e.invoiceSettings.monthlyReportEnabled||!1,monthlyReportDay:e.invoiceSettings.monthlyReportDay||25,monthlyReportRecipient:e.invoiceSettings.monthlyReportRecipient||""})}catch(H){console.error("Fehler beim Laden der Monatsabrechnungs-Einstellungen:",H),p(f("errors.loadSettingsError"),"error")}finally{ae(!1)}else ae(!1)})()}),[e,p]);const oe=async e=>{try{await m.A.put(c.Sn.USERS.INVOICE_SETTINGS,{monthlyReportEnabled:e.monthlyReportEnabled,monthlyReportDay:e.monthlyReportDay,monthlyReportRecipient:e.monthlyReportRecipient}),te(e),e.monthlyReportEnabled||u.oR.success(f("settings.monthlyReportDisabled"))}catch(H){throw console.error("Fehler beim Speichern der Monatsabrechnungs-Einstellungen:",H),u.oR.error(f("errors.saveMonthlyReportSettingsError")),H}},le=async e=>{G(!0),Z(null);const r=new FormData;r.append("logo",e);try{console.log("Starting upload..."),console.log("Selected file:",e);const s=localStorage.getItem("token");console.log("Token verf\xfcgbar:",!!s);const n={};s&&(n.Authorization="Bearer ".concat(s));const o=await fetch("".concat(c.H$,"/settings/logo"),{method:"POST",body:r,headers:n});console.log("Response Status:",o.status);const l=await o.text();if(console.log("Response Text:",l),!o.ok)throw new Error(l||f("errors.uploadFailed"));try{const e=JSON.parse(l);console.log("Response Data:",e),p(f("settings.logoUploadSuccess"),"success");try{await t(),console.log("User-Daten nach Logo-Upload neu geladen")}catch(H){console.error("Fehler beim Neuladen der User-Daten:",H)}const r=document.getElementById("favicon");if(r){(new Date).getTime();try{const e=await fetch("".concat(c.H$,"/settings/logo/base64"));if(e.ok){const t=await e.json();r.href=t.logo}}catch(H){console.error("Favicon konnte nicht aktualisiert werden:",H)}}}catch(a){throw console.error("Fehler beim Parsen der Antwort:",a),new Error(f("errors.invalidResponseFormat"))}O(null),z(null)}catch(s){console.error("Upload error:",s);const e=f("settings.logoUploadError")+": "+(s instanceof Error?s.message:f("errors.unknownError"));Z(e),p(e,"error")}finally{G(!1)}},ie=e=>{X(e),Z(null)};return e?(0,U.jsx)("div",{className:"min-h-screen dark:bg-gray-900",children:(0,U.jsxs)("div",{className:"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6",children:[(0,U.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,U.jsxs)("div",{className:"flex items-center mb-6",children:[(0,U.jsx)(b,{className:"h-6 w-6 mr-2"}),(0,U.jsx)("h2",{className:"text-xl font-semibold",children:f("settings.title")})]}),(0,U.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:(0,U.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,U.jsxs)("button",{className:"".concat("personal"===Q?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center"),onClick:()=>ie("personal"),children:[(0,U.jsx)(y.A,{className:"h-4 w-4 mr-2"}),f("settings.personal")]}),(0,U.jsxs)("button",{className:"".concat("notifications"===Q?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center"),onClick:()=>ie("notifications"),children:[(0,U.jsx)(s.A,{className:"h-4 w-4 mr-2"}),f("settings.notifications")]}),(0,U.jsxs)("button",{className:"".concat("system"===Q?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center"),onClick:()=>ie("system"),children:[(0,U.jsx)(v,{className:"h-4 w-4 mr-2"}),f("settings.system")]}),(0,U.jsxs)("button",{className:"".concat("password_manager"===Q?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center"),onClick:()=>ie("password_manager"),children:[(0,U.jsx)(j.A,{className:"h-4 w-4 mr-2"}),f("settings.passwordManager")]})]})}),"personal"===Q&&(0,U.jsxs)("div",{className:"space-y-6","data-onboarding":"settings-overview",children:[(0,U.jsxs)("div",{className:"flex items-center justify-between border-b pb-6",children:[(0,U.jsxs)("div",{className:"flex-1",children:[(0,U.jsx)("h3",{className:"text-lg font-medium dark:text-white",children:f("settings.language")}),(0,U.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:[f("settings.userLanguage"),k&&(0,U.jsxs)("span",{className:"block mt-1 text-xs",children:[f("settings.organizationLanguage"),": ",f("de"===k?"worktime.language.german":"es"===k?"worktime.language.spanish":"worktime.language.english")]})]})]}),(0,U.jsxs)("select",{value:P||w||(null===e||void 0===e?void 0:e.language)||"",onChange:async e=>{const t=e.target.value;if(I(t),t&&t!==w){B(!0);try{await N(t),p(f("common.save"),"success")}catch(H){console.error("Fehler beim Speichern der Sprache:",H),p(f("errors.saveLanguageError"),"error")}finally{B(!1)}}},disabled:T||R,className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white ml-4",children:[(0,U.jsx)("option",{value:"",children:f("settings.useOrganizationLanguage")}),(0,U.jsx)("option",{value:"de",children:f("worktime.language.german")}),(0,U.jsx)("option",{value:"es",children:f("worktime.language.spanish")}),(0,U.jsx)("option",{value:"en",children:f("worktime.language.english")})]})]}),(0,U.jsxs)("div",{className:"flex items-center justify-between",children:[(0,U.jsxs)("div",{children:[(0,U.jsx)("h3",{className:"text-lg font-medium dark:text-white",children:f("settings.darkMode")}),(0,U.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:f("settings.darkModeDescription")})]}),(0,U.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,U.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:x,onChange:h}),(0,U.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),(0,U.jsx)("div",{className:"border-t pt-6",children:re?(0,U.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:f("settings.loadingSettings")}):(0,U.jsx)("div",{className:"space-y-4",children:(0,U.jsxs)("div",{className:"flex items-center justify-between",children:[(0,U.jsxs)("div",{children:[(0,U.jsx)("h3",{className:"text-lg font-medium dark:text-white",children:f("settings.monthlyReport")}),(0,U.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:[f("settings.monthlyReportDescription"),ee.monthlyReportEnabled&&ee.monthlyReportRecipient&&(0,U.jsxs)("span",{className:"block text-sm text-green-600 dark:text-green-400 mt-1",children:["\u2713 ",f("settings.monthlyReportEnabled")," ",ee.monthlyReportRecipient.split("\n")[0]]})]})]}),(0,U.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,U.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:ee.monthlyReportEnabled,onChange:e=>{e.target.checked?ne(!0):oe({monthlyReportEnabled:!1,monthlyReportDay:ee.monthlyReportDay,monthlyReportRecipient:ee.monthlyReportRecipient})}}),(0,U.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]})})}),(0,U.jsx)("div",{className:"border-t pt-6",children:(0,U.jsxs)("div",{className:"flex items-center justify-between",children:[(0,U.jsxs)("div",{className:"flex-1",children:[(0,U.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,U.jsx)(A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),(0,U.jsx)("h3",{className:"text-lg font-medium dark:text-white",children:f("settings.onboarding.restart")})]}),(0,U.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:f("settings.onboarding.restartDescription")})]}),(0,U.jsx)("button",{onClick:async()=>{try{await C(),p(f("settings.onboarding.restart"),"success"),L("/dashboard"),setTimeout((()=>{M()}),500)}catch(H){console.error("Fehler beim Zur\xfccksetzen der Tour:",H),p(f("errors.unknownError"),"error")}},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors dark:bg-blue-700 dark:hover:bg-blue-800",children:f("onboarding.navigation.restart")})]})})]}),"notifications"===Q&&(0,U.jsx)("div",{className:"space-y-4",children:(0,U.jsx)("div",{className:"p-0 -mt-4",children:(0,U.jsx)(F,{})})}),"system"===Q&&(0,U.jsxs)("div",{className:"space-y-8",children:[(0,U.jsxs)("div",{className:"flex items-center justify-between",children:[(0,U.jsxs)("div",{children:[(0,U.jsx)("h3",{className:"text-lg font-medium mb-2 dark:text-white",children:f("settings.logoUpload")}),(0,U.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:f("settings.logoUploadDescription")})]}),(0,U.jsxs)("div",{className:"flex items-center gap-2",children:[(0,U.jsx)("input",{ref:Y,type:"file",accept:"image/png,image/jpeg",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if("image/png"!==r.type&&"image/jpeg"!==r.type)return Z(f("settings.fileUploadError")),void p(f("settings.fileUploadError"),"error");if(r.size>5242880)return Z(f("settings.fileSizeError")),void p(f("settings.fileSizeError"),"error");O(r),z(URL.createObjectURL(r)),Z(null),le(r)}},className:"hidden",disabled:_}),(0,U.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=Y.current)||void 0===e?void 0:e.click()},disabled:_,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:f(_?"settings.logoUploading":"settings.logoUploadButton"),children:_?(0,U.jsx)(S.A,{className:"h-5 w-5 animate-spin"}):(0,U.jsx)(E,{className:"h-5 w-5"})})]})]}),H&&(0,U.jsx)("div",{className:"text-red-600 dark:text-red-400 text-sm mt-2",children:H}),W&&(0,U.jsxs)("div",{className:"mt-4",children:[(0,U.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:f("settings.logoPreview")}),(0,U.jsx)("img",{src:W,alt:"Logo Vorschau",className:"max-w-xs h-auto rounded-lg shadow-sm"})]}),(0,U.jsxs)("div",{className:"border-t pt-6",children:[(0,U.jsx)("h3",{className:"text-lg font-medium mb-4 dark:text-white",children:f("settings.uploadDirectories")}),(0,U.jsxs)("div",{className:"space-y-4",children:[(0,U.jsxs)("div",{children:[(0,U.jsx)("label",{htmlFor:"taskAttachmentsPath",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:f("settings.taskAttachmentsPath")}),(0,U.jsx)("input",{type:"text",id:"taskAttachmentsPath",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white",defaultValue:"uploads/task-attachments",placeholder:f("settings.taskAttachmentsPathPlaceholder")}),(0,U.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:f("settings.taskAttachmentsPathDescription")})]}),(0,U.jsxs)("div",{children:[(0,U.jsx)("label",{htmlFor:"requestAttachmentsPath",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:f("settings.requestAttachmentsPath")}),(0,U.jsx)("input",{type:"text",id:"requestAttachmentsPath",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white",defaultValue:"uploads/request-attachments",placeholder:f("settings.requestAttachmentsPathPlaceholder")}),(0,U.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:f("settings.requestAttachmentsPathDescription")})]}),(0,U.jsx)("div",{className:"mt-4",children:(0,U.jsx)("button",{type:"button",onClick:async()=>{J(!0);try{var e,t;null===(e=document.getElementById("taskAttachmentsPath"))||void 0===e||e.value,null===(t=document.getElementById("requestAttachmentsPath"))||void 0===t||t.value;await new Promise((e=>setTimeout(e,500))),u.oR.success(f("settings.saveDirectoriesSuccess"))}catch(H){console.error("Fehler beim Speichern der Upload-Verzeichnisse:",H),u.oR.error(f("errors.saveUploadDirectoriesError"))}finally{J(!1)}},disabled:K,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:f(K?"settings.savingDirectories":"settings.saveDirectories"),children:K?(0,U.jsx)(S.A,{className:"h-5 w-5 animate-spin"}):(0,U.jsx)(D.A,{className:"h-5 w-5"})})})]})]}),(0,U.jsxs)("div",{className:"border-t pt-6",children:[(0,U.jsx)("h3",{className:"text-lg font-medium mb-4 dark:text-white",children:f("settings.databaseManagement")}),(0,U.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:f("settings.databaseManagementDescription")}),(0,U.jsx)($,{})]})]}),"password_manager"===Q&&(0,U.jsx)("div",{className:"space-y-4",children:(0,U.jsx)(we,{})})]}),(0,U.jsx)(V,{isOpen:se,onClose:()=>ne(!1),onSave:oe,currentSettings:ee})]})}):(0,U.jsx)("div",{children:f("common.loading")})}}}]);
//# sourceMappingURL=836.c49187e5.chunk.js.map