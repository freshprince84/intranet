{"version":3,"file":"static/js/513.4e94da0a.chunk.js","mappings":"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","sources":["utils/dateUtils.ts","api/clientApi.ts","components/EditClientModal.tsx","components/ClientSelectModal.tsx","components/CreateClientModal.tsx","api/consultationApi.ts","components/ConsultationTracker.tsx","components/LinkTaskModal.tsx","components/InvoiceSuccessModal.tsx","components/CreateInvoiceModal.tsx","components/ConsultationList.tsx","pages/Consultations.tsx"],"sourcesContent":["import { format, parseISO, differenceInMinutes, parse, getWeek, getYear, addDays, startOfWeek } from 'date-fns';\nimport { de } from 'date-fns/locale';\n\n/**\n * Utility-Funktionen fr die Datums- und Zeitverarbeitung im Frontend.\n * Diese Funktionen sorgen fr eine konsistente Handhabung von Datum und Zeit\n * in allen Komponenten.\n */\n\n/**\n * Formatiert ein Datum fr die Anzeige im deutschen Format.\n * @param dateString Das zu formatierende Datum im Format YYYY-MM-DD\n * @returns Formatiertes Datum im Format DD.MM.YYYY oder '-' bei Fehler\n */\nexport const formatDate = (dateString: string): string => {\n    if (!dateString) return '-';\n    \n    try {\n        // Wir erstellen ein neues Date-Objekt und setzen die Uhrzeit auf 12:00 Mittag\n        // um Probleme mit Zeitzonen zu vermeiden\n        const dateParts = dateString.split('-');\n        if (dateParts.length !== 3) return '-';\n        \n        const year = parseInt(dateParts[0]);\n        const month = parseInt(dateParts[1]) - 1; // Monate sind 0-basiert in JavaScript\n        const day = parseInt(dateParts[2]);\n        \n        const date = new Date(year, month, day, 12, 0, 0);\n        \n        return date.toLocaleDateString('de-DE', {\n            day: '2-digit',\n            month: '2-digit',\n            year: 'numeric'\n        });\n    } catch (error) {\n        console.error('Fehler beim Formatieren des Datums:', error);\n        return '-';\n    }\n};\n\n/**\n * Formatiert eine Zeit fr die Anzeige basierend auf UTC.\n * @param dateString Das zu formatierende Datum im ISO-Format\n * @returns Formatierte Zeit im Format HH:MM oder '-' bei Fehler\n */\nexport const formatTime = (dateString: string): string => {\n    if (!dateString) return '-';\n    \n    try {\n        // Direkt aus dem ISO-String die Uhrzeit extrahieren ohne Umrechnung\n        const date = parseISO(dateString);\n        \n        // Verwende UTC-Stunden und -Minuten, um die DB-Zeit direkt zu zeigen\n        const hours = date.getUTCHours().toString().padStart(2, '0');\n        const minutes = date.getUTCMinutes().toString().padStart(2, '0');\n        \n        return `${hours}:${minutes}`;\n    } catch (error) {\n        console.error(`Fehler beim Formatieren der Zeit fr ${dateString}:`, error);\n        return '-';\n    }\n};\n\n/**\n * Berechnet die Dauer zwischen zwei Zeitpunkten und formatiert sie als \"Nh Nm\".\n * @param startTime Startzeit im ISO-Format\n * @param endTime Endzeit im ISO-Format\n * @returns Formatierte Dauer als \"Nh Nm\" oder '-' bei Fehler\n */\nexport const calculateDuration = (startTime: string, endTime: string | null): string => {\n    if (!startTime || !endTime) return '-';\n    \n    try {\n        // Entferne das 'Z' am Ende der ISO-Strings, um Zeitzonenumrechnungen zu verhindern\n        const startISOString = startTime.endsWith('Z') \n            ? startTime.substring(0, startTime.length - 1)\n            : startTime;\n        \n        const endISOString = endTime.endsWith('Z') \n            ? endTime.substring(0, endTime.length - 1)\n            : endTime;\n        \n        const start = new Date(startISOString);\n        const end = new Date(endISOString);\n        \n        const durationMs = end.getTime() - start.getTime();\n        const durationMinutes = Math.floor(durationMs / (1000 * 60));\n        \n        const hours = Math.floor(durationMinutes / 60);\n        const minutes = durationMinutes % 60;\n        \n        return `${hours}h ${minutes}m`;\n    } catch (error) {\n        console.error('Fehler bei der Dauerberechnung:', error);\n        return '-';\n    }\n};\n\n/**\n * Konvertiert ein Wochenformat (YYYY-Www) in ein Datum (YYYY-MM-DD) fr den Montag dieser Woche.\n * @param weekString Wochenformat im Format YYYY-Www\n * @returns Datum des Montags der Woche im Format YYYY-MM-DD\n */\nexport const convertWeekToDate = (weekString: string): string => {\n    try {\n        // Format: YYYY-Www\n        const year = parseInt(weekString.substring(0, 4));\n        const week = parseInt(weekString.substring(6));\n        \n        // Alternative Methode zur Berechnung des Montags fr eine Kalenderwoche\n        // Statt parse mit yyyy und ww (was einen Fehler verursacht) verwenden wir\n        // einen direkten Algorithmus zur Berechnung\n        \n        // 1. Beginne mit dem ersten Tag des Jahres\n        const firstDayOfYear = new Date(Date.UTC(year, 0, 1, 12, 0, 0));\n        \n        // 2. Finde den ersten Donnerstag des Jahres (fr ISO-Wochen)\n        // Verschiebe den Tag, bis wir am ersten Donnerstag sind\n        const dayOfWeek = firstDayOfYear.getUTCDay(); // 0 = Sonntag, 4 = Donnerstag\n        const daysToThursday = dayOfWeek <= 4 ? 4 - dayOfWeek : 11 - dayOfWeek; // Falls Sonntag ist 7\n        const firstThursday = new Date(Date.UTC(year, 0, 1 + daysToThursday, 12, 0, 0));\n        \n        // 3. Der erste Donnerstag ist immer in der ersten Woche\n        // Jetzt berechnen wir den Donnerstag der gewnschten Woche\n        const targetThursday = new Date(Date.UTC(\n            firstThursday.getUTCFullYear(),\n            firstThursday.getUTCMonth(),\n            firstThursday.getUTCDate() + (7 * (week - 1)),\n            12, 0, 0\n        ));\n        \n        // 4. Berechne den Montag dieser Woche (3 Tage vor dem Donnerstag)\n        const monday = new Date(Date.UTC(\n            targetThursday.getUTCFullYear(),\n            targetThursday.getUTCMonth(),\n            targetThursday.getUTCDate() - 3,\n            12, 0, 0\n        ));\n        \n        // Formatiere das Datum als YYYY-MM-DD\n        const formattedDate = format(monday, 'yyyy-MM-dd');\n        \n        // Protokolliere das berechnete Datum fr Debug-Zwecke\n        console.log(`Konvertierte Woche ${weekString} zu Datum: ${formattedDate} (Wochentag: ${format(monday, 'EEEE', { locale: de })})`);\n        \n        // Zustzliche Sicherheitsberprfung: Stelle sicher, dass es ein Montag ist\n        if (format(monday, 'EEEE', { locale: de }) !== 'Montag') {\n            console.warn(`Berechnetes Datum ist kein Montag! Korrigiere...`);\n            // Finde den nchsten Montag\n            const correctedMonday = startOfWeek(monday, { weekStartsOn: 1 });\n            return format(correctedMonday, 'yyyy-MM-dd');\n        }\n        \n        return formattedDate;\n    } catch (error) {\n        console.error('Fehler beim Konvertieren des Wochendatums:', error);\n        // Im Fehlerfall den letzten Montag als Fallback verwenden\n        const fallbackMonday = startOfWeek(new Date(), { weekStartsOn: 1 });\n        return format(fallbackMonday, 'yyyy-MM-dd');\n    }\n};\n\n/**\n * Prft, ob ein Worktime-Eintrag fr den ausgewhlten Tag relevant ist.\n * @param worktime Der Worktime-Eintrag\n * @param selectedDate Ausgewhltes Datum im Format YYYY-MM-DD\n * @returns true, wenn der Eintrag fr den ausgewhlten Tag relevant ist\n */\nexport const isWorktimeRelevantForSelectedDate = (worktime: any, selectedDate: string): boolean => {\n    try {\n        if (!worktime || !worktime.startTime) return false;\n        \n        // Extrahiere nur den Datumsteil (YYYY-MM-DD) aus dem startTime ISO-String\n        const dateOnly = worktime.startTime.split('T')[0];\n        \n        // Vergleiche mit selectedDate\n        return dateOnly === selectedDate;\n    } catch (error) {\n        console.error(\"Fehler beim Prfen der Relevanz eines Worktime-Eintrags:\", error);\n        return false;\n    }\n};\n\n/**\n * Berechnet die Wochentage von Montag bis Sonntag basierend auf einem Startdatum.\n * @param weekStartDate Montag der Woche im Format YYYY-MM-DD\n * @returns Array von Objekten mit date und day Eigenschaften\n */\nexport const getWeekDays = (weekStartDate: string): Array<{ date: string; day: string }> => {\n    if (!weekStartDate) return [];\n    \n    // Beginne mit dem angegebenen Datum als Montag\n    const weekStart = new Date(weekStartDate);\n    \n    // Berechne alle 7 Tage der Woche\n    const weekDays: Array<{ date: string; day: string }> = [];\n    for (let i = 0; i < 7; i++) {\n        const day = addDays(weekStart, i);\n        const dayInfo = {\n            date: format(day, 'yyyy-MM-dd'),\n            day: format(day, 'EEEE', { locale: de })\n        };\n        weekDays.push(dayInfo);\n    }\n    \n    return weekDays;\n};\n\n/**\n * Formatiert ein ISO-DateTime fr die Anzeige im deutschen Format mit Uhrzeit.\n * Diese Funktion wird speziell fr Cerebro-Artikel verwendet.\n * @param dateTimeString Das zu formatierende Datum im ISO-Format (z.B. 2023-06-15T14:30:00Z)\n * @returns Formatiertes Datum und Uhrzeit im Format DD.MM.YYYY HH:MM\n */\nexport const formatDateTimeForCerebro = (dateTimeString: string): string => {\n    if (!dateTimeString) return '-';\n    \n    try {\n        const date = new Date(dateTimeString);\n        \n        // Datum und Uhrzeit im deutschen Format\n        return date.toLocaleDateString('de-DE', {\n            day: '2-digit',\n            month: '2-digit',\n            year: 'numeric',\n            hour: '2-digit',\n            minute: '2-digit'\n        });\n    } catch (error) {\n        console.error('Fehler beim Formatieren des Datums und der Zeit:', error);\n        return '-';\n    }\n};\n\n/**\n * Berechnet die Quinzena (15-Tage-Periode) fr ein gegebenes Datum.\n * Quinzenas sind monatsbasiert:\n * - Erste Quinzena: 1.-15. des Monats\n * - Zweite Quinzena: 16. bis letzter Tag des Monats\n * @param date Datum im Format YYYY-MM-DD\n * @returns Quinzena-String im Format YYYY-MM-Qq (z.B. \"2025-01-Q1\" fr erste Quinzena Januar)\n */\nexport const getQuinzenaFromDate = (date: string): string => {\n    try {\n        const dateObj = new Date(date + 'T12:00:00');\n        const year = dateObj.getFullYear();\n        const month = dateObj.getMonth() + 1; // 1-12\n        const day = dateObj.getDate();\n        \n        // Erste Quinzena: 1.-15., Zweite Quinzena: 16.-Monatsende\n        const quinzena = day <= 15 ? 1 : 2;\n        \n        return `${year}-${String(month).padStart(2, '0')}-Q${quinzena}`;\n    } catch (error) {\n        console.error('Fehler beim Berechnen der Quinzena:', error);\n        const today = new Date();\n        const year = today.getFullYear();\n        const month = today.getMonth() + 1;\n        return `${year}-${String(month).padStart(2, '0')}-Q1`;\n    }\n};\n\n/**\n * Konvertiert eine Quinzena (YYYY-MM-Qq) in das Startdatum (erster Tag der Quinzena).\n * @param quinzenaString Quinzena im Format YYYY-MM-Qq (z.B. \"2025-01-Q1\")\n * @returns Datum des ersten Tages der Quinzena im Format YYYY-MM-DD\n */\nexport const convertQuinzenaToDate = (quinzenaString: string): string => {\n    try {\n        // Format: YYYY-MM-Qq oder YYYY-Qqq (fr Rckwrtskompatibilitt)\n        let year: number, month: number, quinzena: number;\n        \n        if (quinzenaString.includes('-Q')) {\n            // Format: YYYY-MM-Qq oder YYYY-Qqq\n            const parts = quinzenaString.split('-Q');\n            const datePart = parts[0];\n            quinzena = parseInt(parts[1]);\n            \n            if (datePart.includes('-')) {\n                // Format: YYYY-MM-Qq\n                const dateParts = datePart.split('-');\n                year = parseInt(dateParts[0]);\n                month = parseInt(dateParts[1]);\n            } else {\n                // Format: YYYY-Qqq (Rckwrtskompatibilitt - berechne Monat basierend auf Quinzena)\n                year = parseInt(datePart);\n                // Fr alte Format: Q1 = Jan, Q2 = Feb, etc. (vereinfacht)\n                month = Math.ceil(quinzena / 2);\n            }\n        } else {\n            throw new Error('Ungltiges Quinzena-Format');\n        }\n        \n        // Erste Quinzena beginnt am 1., zweite am 16.\n        const startDay = quinzena === 1 ? 1 : 16;\n        \n        const quinzenaStart = new Date(Date.UTC(year, month - 1, startDay, 12, 0, 0));\n        return format(quinzenaStart, 'yyyy-MM-dd');\n    } catch (error) {\n        console.error('Fehler beim Konvertieren der Quinzena:', error);\n        const fallback = startOfWeek(new Date(), { weekStartsOn: 1 });\n        return format(fallback, 'yyyy-MM-dd');\n    }\n};\n\n/**\n * Berechnet alle Tage einer Quinzena basierend auf einem Startdatum.\n * Erste Quinzena: 15 Tage (1.-15.), Zweite Quinzena: variabel (16.-Monatsende)\n * @param quinzenaStartDate Erster Tag der Quinzena im Format YYYY-MM-DD\n * @returns Array von Objekten mit date und day Eigenschaften\n */\nexport const getQuinzenaDays = (quinzenaStartDate: string): Array<{ date: string; day: string }> => {\n    if (!quinzenaStartDate) return [];\n    \n    const start = new Date(quinzenaStartDate);\n    const year = start.getFullYear();\n    const month = start.getMonth(); // 0-11\n    const day = start.getDate();\n    \n    // Bestimme Anzahl der Tage in der Quinzena\n    let daysCount: number;\n    if (day === 1) {\n        // Erste Quinzena: immer 15 Tage\n        daysCount = 15;\n    } else {\n        // Zweite Quinzena: 16. bis Monatsende\n        // Berechne letzter Tag des Monats\n        const lastDayOfMonth = new Date(year, month + 1, 0).getDate();\n        daysCount = lastDayOfMonth - 15; // 16. bis Monatsende\n    }\n    \n    const quinzenaDays: Array<{ date: string; day: string }> = [];\n    \n    for (let i = 0; i < daysCount; i++) {\n        const currentDay = addDays(start, i);\n        const dayInfo = {\n            date: format(currentDay, 'yyyy-MM-dd'),\n            day: format(currentDay, 'EEEE', { locale: de })\n        };\n        quinzenaDays.push(dayInfo);\n    }\n    \n    return quinzenaDays;\n};\n\n/**\n * Berechnet die aktuelle Quinzena im Format YYYY-MM-Qq.\n * @returns Quinzena-String im Format YYYY-MM-Qq (z.B. \"2025-01-Q1\")\n */\nexport const getCurrentQuinzena = (): string => {\n    const today = new Date();\n    return getQuinzenaFromDate(format(today, 'yyyy-MM-dd'));\n};\n\n/**\n * Hilfsfunktionen fr die Datumsbehandlung im Frontend\n */\n\n/**\n * Erstellt ein Date-Objekt ohne Zeitzonenverschiebung\n * @param dateString Ein ISO-Zeitstring\n * @returns Date-Objekt mit korrigiertem Zeitzonenversatz\n */\nexport const createLocalDate = (dateString: string): Date => {\n  const date = new Date(dateString);\n  // Korrigiere den Zeitzonenversatz\n  return new Date(date.getTime() + date.getTimezoneOffset() * 60000);\n};\n\n/* CLAUDE-ANCHOR: TIMEZONE-CONVERSION-001 - Zentrale Timezone-sichere Konvertierung fr datetime-local Inputs */\n/**\n * KRITISCH: Konvertiert datetime-local Input-Werte korrekt fr die API.\n * \n * PROBLEM: datetime-local gibt lokale Zeit zurck (z.B. \"2024-01-15T14:01\")\n * Wenn wir einfach \":00.000\" anhngen, wird es als UTC interpretiert  5h Unterschied!\n * \n * LSUNG: Explizit als lokale Zeit interpretieren und korrekt formatieren.\n * \n * @param datetimeLocalValue Wert aus datetime-local Input (Format: \"YYYY-MM-DDTHH:mm\")\n * @returns ISO-String der als lokale Zeit interpretiert wird (ohne 'Z' Suffix)\n * \n * @example\n * Input: \"2024-01-15T14:01\" (User gibt 14:01 ein)\n * Output: \"2024-01-15T14:01:00.000\" (wird als lokale Zeit gespeichert)\n * Nicht: \"2024-01-15T14:01:00.000Z\" (wrde als UTC interpretiert)\n */\nexport const convertDatetimeLocalToApi = (datetimeLocalValue: string): string => {\n    if (!datetimeLocalValue) {\n        throw new Error('Datetime-local Wert ist erforderlich');\n    }\n    \n    try {\n        // datetime-local Format: \"YYYY-MM-DDTHH:mm\"\n        // Wir fgen nur Sekunden und Millisekunden hinzu, KEIN 'Z' Suffix\n        const apiFormat = `${datetimeLocalValue}:00.000`;\n        \n        // Zustzliche Validierung: Prfe ob das Format gltig ist\n        if (!/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}$/.test(apiFormat)) {\n            throw new Error(`Ungltiges Datumsformat: ${apiFormat}`);\n        }\n        \n        return apiFormat;\n    } catch (error) {\n        console.error('Fehler bei der Datetime-Local Konvertierung:', error);\n        throw new Error(`Konvertierung von datetime-local fehlgeschlagen: ${datetimeLocalValue}`);\n    }\n};\n\n/**\n * KRITISCH: Konvertiert API-Zeitstempel zurck zu datetime-local Format.\n * \n * Wird verwendet beim Bearbeiten von Zeiten - konvertiert DB-Zeit zurck zu Input-Format.\n * Behandelt sowohl UTC-Timestamps (mit 'Z') als auch lokale Timestamps (ohne 'Z').\n * \n * @param apiTimestamp Zeitstempel aus der API (ISO-String)\n * @returns Formatiert fr datetime-local Input (Format: \"YYYY-MM-DDTHH:mm\")\n * \n * @example\n * Input: \"2024-01-15T14:01:00.000Z\" (UTC aus DB)\n * Output: \"2024-01-15T14:01\" (fr datetime-local Input)\n */\nexport const convertApiToDatetimeLocal = (apiTimestamp: string): string => {\n    if (!apiTimestamp) {\n        throw new Error('API-Timestamp ist erforderlich');\n    }\n    \n    try {\n        // Entferne das 'Z' am Ende des Strings, damit JS den Zeitstempel nicht als UTC interpretiert\n        // Dies ist wichtig fr konsistente Zeitbehandlung\n        const localISOString = apiTimestamp.endsWith('Z')\n            ? apiTimestamp.substring(0, apiTimestamp.length - 1)\n            : apiTimestamp;\n        \n        const date = new Date(localISOString);\n        \n        // Validierung: Prfe ob das Datum gltig ist\n        if (isNaN(date.getTime())) {\n            throw new Error(`Ungltiger Zeitstempel: ${apiTimestamp}`);\n        }\n        \n        // Formatiere fr datetime-local Input: \"YYYY-MM-DDTHH:mm\"\n        const formattedDate = format(date, 'yyyy-MM-dd');\n        const formattedTime = format(date, 'HH:mm');\n        \n        return `${formattedDate}T${formattedTime}`;\n    } catch (error) {\n        console.error('Fehler bei der API-zu-Datetime-Local Konvertierung:', error);\n        throw new Error(`Konvertierung von API-Timestamp fehlgeschlagen: ${apiTimestamp}`);\n    }\n};\n\n/**\n * Formatiert die Gesamtdauer einer Liste von Beratungen in Stunden und Minuten.\n * Bercksichtigt nur abgeschlossene Beratungen (mit endTime).\n * \n * @param consultations Array von Consultation-Objekten\n * @returns Formatierte Gesamtdauer als \"Xh Ym\" oder \"0h 0m\" bei leerer Liste\n * \n * @example\n * // Bei Beratungen mit Gesamtdauer von 125 Minuten\n * formatTotalDuration(consultations) // \"2h 5m\"\n */\nexport const formatTotalDuration = (consultations: Array<{ startTime: string; endTime: string | null }>): string => {\n    try {\n        // Berechne die Gesamtdauer in Minuten\n        const totalMinutes = consultations.reduce((total, consultation) => {\n            // Nur abgeschlossene Beratungen bercksichtigen\n            if (!consultation.endTime) return total;\n            \n            // Berechne Dauer dieser Beratung in Minuten\n            const startTime = consultation.startTime.endsWith('Z') \n                ? consultation.startTime.substring(0, consultation.startTime.length - 1)\n                : consultation.startTime;\n            \n            const endTime = consultation.endTime.endsWith('Z') \n                ? consultation.endTime.substring(0, consultation.endTime.length - 1)\n                : consultation.endTime;\n            \n            const start = new Date(startTime);\n            const end = new Date(endTime);\n            \n            const durationMs = end.getTime() - start.getTime();\n            const durationMinutes = Math.floor(durationMs / (1000 * 60));\n            \n            return total + durationMinutes;\n        }, 0);\n        \n        // Konvertiere zu Stunden und Minuten\n        const hours = Math.floor(totalMinutes / 60);\n        const minutes = totalMinutes % 60;\n        \n        return `${hours}h ${minutes}m`;\n    } catch (error) {\n        console.error('Fehler bei der Formatierung der Gesamtdauer:', error);\n        return '0h 0m';\n    }\n};\n\n/**\n * Prft, ob eine Beratung bereits abgerechnet wurde.\n * \n * @param consultation Consultation-Objekt\n * @returns true wenn abgerechnet, false wenn nicht\n */\nexport const isConsultationInvoiced = (consultation: { invoiceItems?: Array<{ invoice: { status: string } }> }): boolean => {\n    return !!(consultation.invoiceItems && consultation.invoiceItems.length > 0);\n};\n\n/**\n * Holt die Rechnungsinformationen einer Beratung.\n * \n * @param consultation Consultation-Objekt\n * @returns Rechnungsinfo oder null wenn nicht abgerechnet\n */\nexport const getConsultationInvoiceInfo = (consultation: { invoiceItems?: Array<{ invoice: { id: number; invoiceNumber: string; status: string; issueDate: string; total: number } }> }) => {\n    if (!consultation.invoiceItems || consultation.invoiceItems.length === 0) {\n        return null;\n    }\n    \n    // Nimm die erste (und normalerweise einzige) Rechnung\n    const firstItem = consultation.invoiceItems[0];\n    return firstItem.invoice;\n};\n\n/**\n * Erstellt einen benutzerfreundlichen Text fr den Rechnungsstatus.\n * \n * @param status Rechnungsstatus\n * @returns Deutscher Status-Text\n */\nexport const getInvoiceStatusText = (status: 'DRAFT' | 'SENT' | 'PAID' | 'OVERDUE' | 'CANCELLED'): string => {\n    const statusMap = {\n        'DRAFT': 'Entwurf',\n        'SENT': 'Gesendet',\n        'PAID': 'Bezahlt',\n        'OVERDUE': 'berfllig',\n        'CANCELLED': 'Storniert'\n    };\n    return statusMap[status] || status;\n};\n\n/**\n * Gibt die Farbe fr einen Rechnungsstatus zurck.\n * \n * @param status Rechnungsstatus\n * @returns CSS-Klassen fr die Statusfarbe\n */\nexport const getInvoiceStatusColor = (status: 'DRAFT' | 'SENT' | 'PAID' | 'OVERDUE' | 'CANCELLED'): string => {\n    const colorMap = {\n        'DRAFT': 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300',\n        'SENT': 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300',\n        'PAID': 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300',\n        'OVERDUE': 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300',\n        'CANCELLED': 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300'\n    };\n    return colorMap[status] || 'bg-gray-100 text-gray-800';\n}; ","import axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\n\r\n/**\r\n * API-Funktionen fr die Client-Verwaltung\r\n */\r\n\r\nexport interface CreateClientData {\r\n  name: string;\r\n  company?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  address?: string;\r\n  notes?: string;\r\n}\r\n\r\nexport interface UpdateClientData {\r\n  name?: string;\r\n  company?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  address?: string;\r\n  notes?: string;\r\n  isActive?: boolean;\r\n}\r\n\r\n/**\r\n * Holt alle Clients\r\n * @returns Liste aller Clients\r\n */\r\nexport const getClients = async () => {\r\n  try {\r\n    const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.BASE);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden der Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Holt einen einzelnen Client mit seinen Beratungen\r\n * @param clientId ID des Clients\r\n * @returns Client mit seinen letzten Beratungen\r\n */\r\nexport const getClientById = async (clientId: number) => {\r\n  try {\r\n    const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.BY_ID(clientId));\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Erstellt einen neuen Client\r\n * @param data Client-Daten\r\n * @returns Der erstellte Client\r\n */\r\nexport const createClient = async (data: CreateClientData) => {\r\n  try {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.CLIENTS.BASE, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Erstellen des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Aktualisiert einen bestehenden Client\r\n * @param clientId ID des Clients\r\n * @param data Update-Daten\r\n * @returns Der aktualisierte Client\r\n */\r\nexport const updateClient = async (clientId: number, data: UpdateClientData) => {\r\n  try {\r\n    const response = await axiosInstance.put(API_ENDPOINTS.CLIENTS.BY_ID(clientId), data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Aktualisieren des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Lscht einen Client\r\n * @param clientId ID des Clients\r\n * @returns Status der Lschoperation\r\n */\r\nexport const deleteClient = async (clientId: number) => {\r\n  try {\r\n    const response = await axiosInstance.delete(API_ENDPOINTS.CLIENTS.BY_ID(clientId));\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Lschen des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Holt die zuletzt beratenen Clients\r\n * @returns Liste der zuletzt beratenen Clients\r\n */\r\nexport const getRecentClients = async () => {\r\n  try {\r\n    const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.RECENT);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden der zuletzt beratenen Clients:', error);\r\n    throw error;\r\n  }\r\n}; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, TrashIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { Client } from '../types/client.ts';\nimport { toast } from 'react-toastify';\nimport * as clientApi from '../api/clientApi.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface EditClientModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onClientUpdated?: (client: Client) => void;\n  onClientDeleted?: (clientId: number) => void;\n  client: Client | null;\n}\n\nconst EditClientModal: React.FC<EditClientModalProps> = ({\n  isOpen,\n  onClose,\n  onClientUpdated,\n  onClientDeleted,\n  client\n}) => {\n  const { t } = useTranslation();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [formData, setFormData] = useState({\n    name: '',\n    company: '',\n    email: '',\n    phone: '',\n    address: '',\n    notes: '',\n    isActive: true\n  });\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [loading, setLoading] = useState(false);\n  const [confirmDelete, setConfirmDelete] = useState(false);\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n\n  // Lade Client-Daten wenn Modal geffnet wird\n  useEffect(() => {\n    if (isOpen && client) {\n      setFormData({\n        name: client.name || '',\n        company: client.company || '',\n        email: client.email || '',\n        phone: client.phone || '',\n        address: client.address || '',\n        notes: client.notes || '',\n        isActive: client.isActive !== undefined ? client.isActive : true\n      });\n      setConfirmDelete(false);\n      setErrors({});\n    }\n  }, [isOpen, client]);\n\n  // berprfung der Bildschirmgre\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.name.trim()) {\n      newErrors.name = 'Name ist erforderlich';\n    }\n    \n    if (formData.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\n      newErrors.email = 'Ungltige E-Mail-Adresse';\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) return;\n    \n    if (!client) return;\n    \n    try {\n      setLoading(true);\n      const updated = await clientApi.updateClient(client.id, {\n        name: formData.name,\n        company: formData.company || undefined,\n        email: formData.email || undefined,\n        phone: formData.phone || undefined,\n        address: formData.address || undefined,\n        notes: formData.notes || undefined,\n        isActive: formData.isActive\n      });\n      \n      toast.success('Client erfolgreich aktualisiert');\n      onClientUpdated?.(updated);\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'Fehler beim Aktualisieren des Clients');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDelete = async () => {\n    if (!confirmDelete) {\n      setConfirmDelete(true);\n      return;\n    }\n    \n    if (!client) return;\n    \n    try {\n      setLoading(true);\n      await clientApi.deleteClient(client.id);\n      \n      toast.success('Client erfolgreich gelscht');\n      onClientDeleted?.(client.id);\n      onClose();\n    } catch (error: any) {\n      const errorMessage = error.response?.data?.message || 'Fehler beim Lschen des Clients';\n      const errorDetails = error.response?.data?.details;\n      const errorSuggestion = error.response?.data?.suggestion;\n      \n      // Zeige detaillierte Fehlermeldung bei Verknpfungen\n      if (error.response?.status === 409 && errorDetails) {\n        const details = Object.entries(errorDetails)\n          .filter(([_, count]) => (count as number) > 0)\n          .map(([key, count]) => `${count as number} ${key === 'workTimes' ? 'Zeiteintrge' : key === 'consultationInvoices' ? 'Rechnungen' : 'Monatsberichte'}`)\n          .join(', ');\n        \n        toast.error(`${errorMessage}. Verknpfungen: ${details}. ${errorSuggestion || ''}`);\n      } else {\n        toast.error(errorMessage);\n      }\n      \n      setConfirmDelete(false);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value, type } = e.target;\n    const checked = (e.target as HTMLInputElement).checked;\n    \n    setFormData(prev => ({\n      ...prev,\n      [name]: type === 'checkbox' ? checked : value\n    }));\n    \n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleClose = () => {\n    setConfirmDelete(false);\n    setErrors({});\n    onClose();\n  };\n\n  if (!client) return null;\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                Client bearbeiten\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              <div className=\"space-y-4\">\n                {/* Name */}\n                <div>\n                  <label htmlFor=\"name_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Name *\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"name_mobile\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.name \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.name && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n                  )}\n                </div>\n\n                {/* Firma */}\n                <div>\n                  <label htmlFor=\"company_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Firma\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"company_mobile\"\n                    name=\"company\"\n                    value={formData.company}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* E-Mail */}\n                <div>\n                  <label htmlFor=\"email_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    E-Mail\n                  </label>\n                  <input\n                    type=\"email\"\n                    id=\"email_mobile\"\n                    name=\"email\"\n                    value={formData.email}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.email \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.email && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n                  )}\n                </div>\n\n                {/* Telefon */}\n                <div>\n                  <label htmlFor=\"phone_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Telefon\n                  </label>\n                  <input\n                    type=\"tel\"\n                    id=\"phone_mobile\"\n                    name=\"phone\"\n                    value={formData.phone}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Adresse */}\n                <div>\n                  <label htmlFor=\"address_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Adresse\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"address_mobile\"\n                    name=\"address\"\n                    value={formData.address}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Notizen */}\n                <div>\n                  <label htmlFor=\"notes_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Notizen\n                  </label>\n                  <textarea\n                    id=\"notes_mobile\"\n                    name=\"notes\"\n                    rows={3}\n                    value={formData.notes}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Aktiv-Status */}\n                <div className=\"flex items-center\">\n                  <input\n                    type=\"checkbox\"\n                    id=\"isActive_mobile\"\n                    name=\"isActive\"\n                    checked={formData.isActive}\n                    onChange={handleChange}\n                    className=\"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:text-gray-300\"\n                  />\n                  <label htmlFor=\"isActive_mobile\" className=\"ml-2 block text-sm text-gray-700 dark:text-gray-300\">\n                    Aktiv\n                  </label>\n                </div>\n              </div>\n\n              {/* Buttons */}\n              <div className=\"mt-6 flex items-center justify-between\">\n                <button\n                  type=\"button\"\n                  onClick={handleDelete}\n                  disabled={loading}\n                  className={`inline-flex items-center px-4 py-2 border ${\n                    confirmDelete\n                      ? 'border-red-300 text-red-700 bg-red-50 dark:border-red-600 dark:text-red-400 dark:bg-red-900/20'\n                      : 'border-red-300 text-red-700 bg-white hover:bg-red-50 dark:border-red-600 dark:text-red-400 dark:bg-gray-700 dark:hover:bg-gray-600'\n                  } text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed`}\n                >\n                  <TrashIcon className=\"h-5 w-5 mr-2\" />\n                  {confirmDelete ? 'Wirklich lschen?' : 'Lschen'}\n                </button>\n\n                <div className=\"flex space-x-3\">\n                  <button\n                    type=\"button\"\n                    onClick={handleClose}\n                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                    title={t('common.cancel')}\n                  >\n                    <XMarkIcon className=\"h-5 w-5\" />\n                  </button>\n                  <button\n                    type=\"submit\"\n                    disabled={loading}\n                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                    title={loading ? 'Speichere...' : 'Speichern'}\n                  >\n                    {loading ? (\n                      <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                    ) : (\n                      <CheckIcon className=\"h-5 w-5\" />\n                    )}\n                  </button>\n                </div>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            Client bearbeiten\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {Object.keys(errors).length > 0 && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {Object.values(errors).map((error, idx) => (\n                <p key={idx}>{error}</p>\n              ))}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Name */}\n            <div>\n              <label htmlFor=\"name\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Name *\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.name \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.name && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n              )}\n            </div>\n\n            {/* Firma */}\n            <div>\n              <label htmlFor=\"company\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Firma\n              </label>\n              <input\n                type=\"text\"\n                id=\"company\"\n                name=\"company\"\n                value={formData.company}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* E-Mail */}\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                E-Mail\n              </label>\n              <input\n                type=\"email\"\n                id=\"email\"\n                name=\"email\"\n                value={formData.email}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.email \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.email && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n              )}\n            </div>\n\n            {/* Telefon */}\n            <div>\n              <label htmlFor=\"phone\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Telefon\n              </label>\n              <input\n                type=\"tel\"\n                id=\"phone\"\n                name=\"phone\"\n                value={formData.phone}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Adresse */}\n            <div>\n              <label htmlFor=\"address\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Adresse\n              </label>\n              <input\n                type=\"text\"\n                id=\"address\"\n                name=\"address\"\n                value={formData.address}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Notizen */}\n            <div>\n              <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Notizen\n              </label>\n              <textarea\n                id=\"notes\"\n                name=\"notes\"\n                rows={3}\n                value={formData.notes}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Aktiv-Status */}\n            <div className=\"flex items-center\">\n              <input\n                type=\"checkbox\"\n                id=\"isActive\"\n                name=\"isActive\"\n                checked={formData.isActive}\n                onChange={handleChange}\n                className=\"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:text-gray-300\"\n              />\n              <label htmlFor=\"isActive\" className=\"ml-2 block text-sm text-gray-700 dark:text-gray-300\">\n                Aktiv\n              </label>\n            </div>\n\n            {/* Buttons */}\n            <div className=\"flex items-center justify-between pt-4\">\n              <button\n                type=\"button\"\n                onClick={handleDelete}\n                disabled={loading}\n                className={`p-2 rounded-md ${\n                  confirmDelete\n                    ? 'bg-red-600 text-white dark:bg-red-700 dark:text-white hover:bg-red-700 dark:hover:bg-red-600'\n                    : 'text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300'\n                } disabled:opacity-50 disabled:cursor-not-allowed`}\n                title={confirmDelete ? 'Lschen besttigen' : 'Client lschen'}\n              >\n                {confirmDelete ? (\n                  <CheckIcon className=\"h-5 w-5\" />\n                ) : (\n                  <TrashIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n\n              <div className=\"flex gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                  title={loading ? 'Speichere...' : 'Speichern'}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default EditClientModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { Dialog } from '@headlessui/react';\nimport { useTranslation } from 'react-i18next';\nimport { MagnifyingGlassIcon, XMarkIcon, PlusIcon, PencilIcon, TrashIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { Client } from '../types/client.ts';\nimport { toast } from 'react-toastify';\nimport * as clientApi from '../api/clientApi.ts';\nimport EditClientModal from './EditClientModal.tsx';\n\ninterface ClientSelectModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSelect: (client: Client) => void;\n  onCreateNew: () => void;\n}\n\nconst ClientSelectModal: React.FC<ClientSelectModalProps> = ({\n  isOpen,\n  onClose,\n  onSelect,\n  onCreateNew\n}) => {\n  const { t } = useTranslation();\n  const [clients, setClients] = useState<Client[]>([]);\n  const [filteredClients, setFilteredClients] = useState<Client[]>([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [editingClient, setEditingClient] = useState<Client | null>(null);\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n\n  useEffect(() => {\n    if (isOpen) {\n      loadClients();\n    }\n  }, [isOpen]);\n\n  useEffect(() => {\n    if (searchTerm) {\n      const filtered = clients.filter(client => \n        client.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        (client.company && client.company.toLowerCase().includes(searchTerm.toLowerCase())) ||\n        (client.email && client.email.toLowerCase().includes(searchTerm.toLowerCase()))\n      );\n      setFilteredClients(filtered);\n    } else {\n      setFilteredClients(clients);\n    }\n  }, [searchTerm, clients]);\n\n  const loadClients = async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.BASE);\n      setClients(response.data);\n      setFilteredClients(response.data);\n    } catch (error) {\n      // Stille Behandlung - Fehler wird im UI durch leere Liste sichtbar\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleEdit = (client: Client, e: React.MouseEvent) => {\n    e.stopPropagation();\n    setEditingClient(client);\n    setIsEditModalOpen(true);\n  };\n\n  const handleDelete = async (client: Client, e: React.MouseEvent) => {\n    e.stopPropagation();\n    \n    if (!window.confirm(t('client.deleteConfirm', { name: client.name }))) {\n      return;\n    }\n\n    try {\n      await clientApi.deleteClient(client.id);\n      toast.success(t('client.deleteSuccess'));\n      loadClients(); // Liste neu laden\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || t('client.deleteError'));\n    }\n  };\n\n  const handleClientUpdated = (updatedClient: Client) => {\n    // Aktualisiere lokale Liste\n    const index = clients.findIndex(c => c.id === updatedClient.id);\n    if (index !== -1) {\n      const newClients = [...clients];\n      newClients[index] = updatedClient;\n      setClients(newClients);\n      setFilteredClients(newClients);\n    }\n    setIsEditModalOpen(false);\n    setEditingClient(null);\n  };\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      \n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n        <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n          <div className=\"p-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                Client auswhlen\n              </Dialog.Title>\n              <button\n                onClick={onClose}\n                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            {/* Suchfeld */}\n            <div className=\"relative mb-4\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <MagnifyingGlassIcon className=\"h-5 w-5 text-gray-400\" />\n              </div>\n              <input\n                type=\"text\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\n                placeholder=\"Client suchen...\"\n                autoFocus\n              />\n            </div>\n\n            {/* Client-Liste */}\n            <div className=\"max-h-96 overflow-y-auto\">\n              {loading ? (\n                <div className=\"text-center py-4 text-gray-500 dark:text-gray-400\">\n                  Lade Clients...\n                </div>\n              ) : filteredClients.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <p className=\"text-gray-500 dark:text-gray-400 mb-4\">\n                    {searchTerm ? 'Keine Clients gefunden' : 'Noch keine Clients vorhanden'}\n                  </p>\n                  <button\n                    onClick={onCreateNew}\n                    className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                  >\n                    <PlusIcon className=\"h-5 w-5 mr-2\" />\n                    Neuen Client anlegen\n                  </button>\n                </div>\n              ) : (\n                <ul className=\"divide-y divide-gray-200 dark:divide-gray-700\">\n                  {filteredClients.map((client) => (\n                    <li key={client.id}>\n                      <div className=\"flex items-center\">\n                        <button\n                          onClick={() => onSelect(client)}\n                          className=\"flex-1 px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 text-left transition-colors\"\n                        >\n                          <div>\n                            <p className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                              {client.name}\n                            </p>\n                            {client.company && (\n                              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                {client.company}\n                              </p>\n                            )}\n                            {client.email && (\n                              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                {client.email}\n                              </p>\n                            )}\n                          </div>\n                        </button>\n                        <div className=\"flex items-center space-x-2 px-2\">\n                          <button\n                            onClick={(e) => handleEdit(client, e)}\n                            className=\"p-2 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors\"\n                            title=\"Client bearbeiten\"\n                          >\n                            <PencilIcon className=\"h-5 w-5\" />\n                          </button>\n                          <button\n                            onClick={(e) => handleDelete(client, e)}\n                            className=\"p-2 text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors\"\n                            title={t('client.deleteTitle')}\n                          >\n                            <TrashIcon className=\"h-5 w-5\" />\n                          </button>\n                        </div>\n                      </div>\n                    </li>\n                  ))}\n                </ul>\n              )}\n            </div>\n\n            {/* Footer mit \"Neuer Client\" Button */}\n            {filteredClients.length > 0 && (\n              <div className=\"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                <button\n                  onClick={onCreateNew}\n                  className=\"w-full inline-flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                >\n                  <PlusIcon className=\"h-5 w-5 mr-2\" />\n                  Neuen Client anlegen\n                </button>\n              </div>\n            )}\n          </div>\n        </Dialog.Panel>\n      </div>\n\n      {/* Edit Modal */}\n      {editingClient && (\n        <EditClientModal\n          isOpen={isEditModalOpen}\n          onClose={() => {\n            setIsEditModalOpen(false);\n            setEditingClient(null);\n          }}\n          onClientUpdated={handleClientUpdated}\n          onClientDeleted={(clientId) => {\n            // Ldt Liste neu nach Lschung\n            loadClients();\n            setIsEditModalOpen(false);\n            setEditingClient(null);\n          }}\n          client={editingClient}\n        />\n      )}\n    </Dialog>\n  );\n};\n\nexport default ClientSelectModal; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { Client } from '../types/client.ts';\nimport { toast } from 'react-toastify';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface CreateClientModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSave: (client: Client) => void;\n}\n\nconst CreateClientModal: React.FC<CreateClientModalProps> = ({\n  isOpen,\n  onClose,\n  onSave\n}) => {\n  const { t } = useTranslation();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [formData, setFormData] = useState({\n    name: '',\n    company: '',\n    email: '',\n    phone: '',\n    address: '',\n    notes: ''\n  });\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [loading, setLoading] = useState(false);\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.name.trim()) {\n      newErrors.name = 'Name ist erforderlich';\n    }\n    \n    if (formData.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\n      newErrors.email = 'Ungltige E-Mail-Adresse';\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) return;\n    \n    try {\n      setLoading(true);\n      const response = await axiosInstance.post(API_ENDPOINTS.CLIENTS.BASE, {\n        ...formData,\n        company: formData.company || null,\n        email: formData.email || null,\n        phone: formData.phone || null,\n        address: formData.address || null,\n        notes: formData.notes || null\n      });\n      \n      toast.success('Client erfolgreich angelegt');\n      onSave(response.data);\n      \n      // Form zurcksetzen\n      setFormData({\n        name: '',\n        company: '',\n        email: '',\n        phone: '',\n        address: '',\n        notes: ''\n      });\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'Fehler beim Anlegen des Clients');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // berprfung der Bildschirmgre\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    // Initial prfen\n    checkScreenSize();\n    \n    // Event-Listener fr Grennderungen\n    window.addEventListener('resize', checkScreenSize);\n    \n    // Cleanup\n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleClose = () => {\n    // Form zurcksetzen\n    setFormData({\n      name: '',\n      company: '',\n      email: '',\n      phone: '',\n      address: '',\n      notes: ''\n    });\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                Neuen Client anlegen\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              <div className=\"space-y-4\">\n                {/* Name */}\n                <div>\n                  <label htmlFor=\"name_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Name *\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"name_mobile\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.name \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.name && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n                  )}\n                </div>\n\n                {/* Firma */}\n                <div>\n                  <label htmlFor=\"company_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Firma\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"company_mobile\"\n                    name=\"company\"\n                    value={formData.company}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* E-Mail */}\n                <div>\n                  <label htmlFor=\"email_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    E-Mail\n                  </label>\n                  <input\n                    type=\"email\"\n                    id=\"email_mobile\"\n                    name=\"email\"\n                    value={formData.email}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.email \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.email && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n                  )}\n                </div>\n\n                {/* Telefon */}\n                <div>\n                  <label htmlFor=\"phone_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Telefon\n                  </label>\n                  <input\n                    type=\"tel\"\n                    id=\"phone_mobile\"\n                    name=\"phone\"\n                    value={formData.phone}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Adresse */}\n                <div>\n                  <label htmlFor=\"address_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Adresse\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"address_mobile\"\n                    name=\"address\"\n                    value={formData.address}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Notizen */}\n                <div>\n                  <label htmlFor=\"notes_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Notizen\n                  </label>\n                  <textarea\n                    id=\"notes_mobile\"\n                    name=\"notes\"\n                    rows={3}\n                    value={formData.notes}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n              </div>\n\n              {/* Buttons */}\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? 'Speichere...' : 'Speichern'}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            Neuen Client anlegen\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {Object.keys(errors).length > 0 && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {Object.values(errors).map((error, idx) => (\n                <p key={idx}>{error}</p>\n              ))}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Name */}\n            <div>\n              <label htmlFor=\"name\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Name *\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.name \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.name && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n              )}\n            </div>\n\n            {/* Firma */}\n            <div>\n              <label htmlFor=\"company\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Firma\n              </label>\n              <input\n                type=\"text\"\n                id=\"company\"\n                name=\"company\"\n                value={formData.company}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* E-Mail */}\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                E-Mail\n              </label>\n              <input\n                type=\"email\"\n                id=\"email\"\n                name=\"email\"\n                value={formData.email}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.email \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.email && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n              )}\n            </div>\n\n            {/* Telefon */}\n            <div>\n              <label htmlFor=\"phone\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Telefon\n              </label>\n              <input\n                type=\"tel\"\n                id=\"phone\"\n                name=\"phone\"\n                value={formData.phone}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Adresse */}\n            <div>\n              <label htmlFor=\"address\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Adresse\n              </label>\n              <input\n                type=\"text\"\n                id=\"address\"\n                name=\"address\"\n                value={formData.address}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Notizen */}\n            <div>\n              <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Notizen\n              </label>\n              <textarea\n                id=\"notes\"\n                name=\"notes\"\n                rows={3}\n                value={formData.notes}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Buttons */}\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? 'Speichere...' : 'Speichern'}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default CreateClientModal; ","import axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\n\r\n/**\r\n * API-Funktionen fr das Consultation-Modul\r\n */\r\n\r\nexport interface StartConsultationData {\r\n  branchId: number;\r\n  clientId: number;\r\n  notes?: string;\r\n  startTime?: string;\r\n}\r\n\r\nexport interface StopConsultationData {\r\n  endTime?: string;\r\n  notes?: string;\r\n}\r\n\r\nexport interface UpdateNotesData {\r\n  notes: string;\r\n}\r\n\r\nexport interface LinkTaskData {\r\n  taskId: number;\r\n}\r\n\r\nexport interface CreateTaskData {\r\n  title: string;\r\n  description: string;\r\n  dueDate?: string;\r\n  branchId: number;\r\n  qualityControlId?: number;\r\n}\r\n\r\nexport interface UpdateTimeData {\r\n  startTime?: string;\r\n  endTime?: string;\r\n}\r\n\r\n/**\r\n * Startet eine neue Beratung\r\n * @param data Beratungsdaten (branchId, clientId, notes, startTime)\r\n * @returns Die erstellte Beratung\r\n */\r\nexport const startConsultation = async (data: StartConsultationData) => {\r\n  try {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.CONSULTATIONS.START, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Starten der Beratung:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Stoppt eine laufende Beratung\r\n * @param data Stopp-Daten (endTime, notes)\r\n * @returns Die aktualisierte Beratung\r\n */\r\nexport const stopConsultation = async (data: StopConsultationData) => {\r\n  try {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.CONSULTATIONS.STOP, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Stoppen der Beratung:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Holt alle Beratungen des aktuellen Benutzers\r\n * @param clientId Optionale Client-ID zum Filtern\r\n * @param from Optionales Start-Datum\r\n * @param to Optionales End-Datum\r\n * @returns Liste der Beratungen\r\n */\r\nexport const getConsultations = async (clientId?: number, from?: string, to?: string) => {\r\n  try {\r\n    const params = new URLSearchParams();\r\n    if (clientId) params.append('clientId', clientId.toString());\r\n    if (from) params.append('from', from);\r\n    if (to) params.append('to', to);\r\n    \r\n    const url = params.toString() \r\n      ? `${API_ENDPOINTS.CONSULTATIONS.BASE}?${params}`\r\n      : API_ENDPOINTS.CONSULTATIONS.BASE;\r\n      \r\n    const response = await axiosInstance.get(url);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden der Beratungen:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Aktualisiert die Notizen einer Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Notizen-Daten\r\n * @returns Die aktualisierte Beratung\r\n */\r\nexport const updateConsultationNotes = async (consultationId: number, data: UpdateNotesData) => {\r\n  try {\r\n    const response = await axiosInstance.patch(\r\n      API_ENDPOINTS.CONSULTATIONS.UPDATE_NOTES(consultationId), \r\n      data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Aktualisieren der Notizen:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Verknpft einen Task mit einer Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Task-Verknpfungsdaten\r\n * @returns Status der Verknpfung\r\n */\r\nexport const linkTaskToConsultation = async (consultationId: number, data: LinkTaskData) => {\r\n  try {\r\n    const response = await axiosInstance.post(\r\n      API_ENDPOINTS.CONSULTATIONS.LINK_TASK(consultationId), \r\n      data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Verknpfen des Tasks:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Erstellt einen neuen Task fr eine Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Task-Erstellungsdaten\r\n * @returns Der erstellte Task\r\n */\r\nexport const createTaskForConsultation = async (consultationId: number, data: CreateTaskData) => {\r\n  try {\r\n    const response = await axiosInstance.post(\r\n      API_ENDPOINTS.CONSULTATIONS.CREATE_TASK(consultationId), \r\n      data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Erstellen des Tasks:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Lscht eine Beratung\r\n * @param consultationId ID der Beratung\r\n * @returns Status der Lschoperation\r\n */\r\nexport const deleteConsultation = async (consultationId: number) => {\r\n  try {\r\n    const response = await axiosInstance.delete(API_ENDPOINTS.CONSULTATIONS.BY_ID(consultationId));\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Lschen der Beratung:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Aktualisiert die Start- oder Endzeit einer Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Zeit-Update-Daten (startTime oder endTime)\r\n * @returns Die aktualisierte Beratung\r\n */\r\nexport const updateConsultationTime = async (consultationId: number, data: UpdateTimeData) => {\r\n  try {\r\n    /* KONSISTENTE API-BEHANDLUNG:\r\n     * Diese Funktion kapselt die Zeit-Update-Logik und macht sie testbar und wartbar.\r\n     * Verwendet den WorkTime-Endpoint, da Consultations erweiterte WorkTime-Eintrge sind.\r\n     */\r\n    const response = await axiosInstance.put(`${API_ENDPOINTS.WORKTIME.BASE}/${consultationId}`, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Aktualisieren der Zeit:', error);\r\n    throw error;\r\n  }\r\n}; ","import React, { useState, useEffect, useRef, useLayoutEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PlayIcon, StopIcon, PlusIcon, ClockIcon, UserGroupIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { formatTime, calculateDuration } from '../utils/dateUtils.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { useBranch } from '../contexts/BranchContext.tsx';\nimport { toast } from 'react-toastify';\nimport ClientSelectModal from './ClientSelectModal.tsx';\nimport CreateClientModal from './CreateClientModal.tsx';\nimport { Client, Consultation } from '../types/client.ts';\nimport * as consultationApi from '../api/consultationApi.ts';\nimport * as clientApi from '../api/clientApi.ts';\n\n// Union-Type fr Client und Placeholder\ntype ClientOrPlaceholder = Client | {\n  id: string;\n  name: string;\n  isPlaceholder: boolean;\n  status?: 'past' | 'planned';\n  lastConsultationDate?: string;\n};\n\n// Type Guard fr Placeholder\nconst isPlaceholder = (client: ClientOrPlaceholder): client is { id: string; name: string; isPlaceholder: boolean; status?: 'past' | 'planned'; lastConsultationDate?: string; } => {\n  return 'isPlaceholder' in client && client.isPlaceholder === true;\n};\n\ninterface ConsultationTrackerProps {\n  onConsultationChange: () => void;\n  onConsultationStarted?: (clientName: string) => void;\n}\n\nconst ConsultationTracker: React.FC<ConsultationTrackerProps> = ({ onConsultationChange, onConsultationStarted }) => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const { selectedBranch } = useBranch();\n  const [activeConsultation, setActiveConsultation] = useState<Consultation | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [isStarting, setIsStarting] = useState(false);\n  const [isClientSelectModalOpen, setIsClientSelectModalOpen] = useState(false);\n  const [isCreateClientModalOpen, setIsCreateClientModalOpen] = useState(false);\n  const [selectedClient, setSelectedClient] = useState<Client | null>(null);\n  const [recentClients, setRecentClients] = useState<Client[]>([]);\n  const [notes, setNotes] = useState('');\n  const [lastStartedClientId, setLastStartedClientId] = useState<number | null>(null);\n  \n  // Responsive Tag-Display States (optimiert)\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [visibleTagCount, setVisibleTagCount] = useState(3); // Fallback fr SSR\n  const [containerWidth, setContainerWidth] = useState(0);\n  const resizeTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Manuelle Erfassung States\n  const [isManualEntry, setIsManualEntry] = useState(false);\n  const [manualStartTime, setManualStartTime] = useState('');\n  const [manualEndTime, setManualEndTime] = useState('');\n\n  useEffect(() => {\n    checkActiveConsultation();\n    loadRecentClients();\n  }, []);\n\n  const checkActiveConsultation = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.WORKTIME.ACTIVE);\n      if (response.data && response.data.clientId) {\n        setActiveConsultation(response.data);\n        setNotes(response.data.notes || '');\n      }\n    } catch (error) {\n      // Stille Behandlung - normale Situation wenn keine aktive Beratung luft\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadRecentClients = async () => {\n    try {\n      console.log('=== FRONTEND: loadRecentClients() called ===');\n      const clients = await clientApi.getRecentClients();\n      console.log('=== FRONTEND: received clients:', clients);\n      setRecentClients(clients || []);\n    } catch (error) {\n      console.error('=== FRONTEND: loadRecentClients() ERROR ===', error);\n      // Stille Behandlung - normale Situation wenn noch keine Clients beraten wurden\n    }\n  };\n\n  const handleStartConsultation = async (clientId: number, notes?: string) => {\n    if (!selectedBranch) {\n      toast.error(t('consultations.selectBranch'));\n      return;\n    }\n\n    try {\n      setIsStarting(true);\n      \n      // Zeitzone-korrigierte aktuelle Zeit (gleiche Logik wie bei stopConsultation)\n      const correctedStartTime = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000);\n      \n      const consultation = await consultationApi.startConsultation({\n        branchId: selectedBranch,\n        clientId,\n        notes: notes || '',\n        startTime: correctedStartTime.toISOString()\n      });\n\n      setActiveConsultation(consultation);\n      setNotes(notes || '');\n      setSelectedClient(null);\n      setIsClientSelectModalOpen(false);\n      \n      // Speichere den zuletzt gestarteten Client fr Tag-Priorisierung\n      setLastStartedClientId(clientId);\n      \n      // Sende Event fr SavedFilterTags Aktualisierung\n      window.dispatchEvent(new CustomEvent('consultationChanged'));\n      \n      // Entfernt: Frontend LRU-Logic - Backend sortiert bereits korrekt nach startTime DESC\n      // Lade Recent Clients neu vom Server (Backend liefert bereits richtige Sortierung)\n      loadRecentClients();\n      \n      // Callback fr Parent-Komponente - bergebe die neue Consultation\n      onConsultationChange?.(consultation);\n      \n      // Callback fr Filter-Wechsel (wenn Client-Name verfgbar)\n      if (onConsultationStarted && consultation.client?.name) {\n        onConsultationStarted(consultation.client.name);\n      }\n      \n      toast.success(t('consultations.started'));\n    } catch (error) {\n      console.error('Fehler beim Starten der Beratung:', error);\n      toast.error(t('consultations.startError'));\n    } finally {\n      setIsStarting(false);\n    }\n  };\n\n  const stopConsultation = async () => {\n    try {\n      const correctedEndTime = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000);\n      \n      const stoppedConsultation = await consultationApi.stopConsultation({\n        endTime: correctedEndTime.toISOString(),\n        notes: notes || undefined\n      });\n      setActiveConsultation(null);\n      setNotes('');\n      toast.success(t('consultations.stopped'));\n      // Recent Clients nach dem Stoppen aktualisieren\n      loadRecentClients();\n      // Beratungsliste aktualisieren - bergebe die aktualisierte Consultation\n      onConsultationChange?.(stoppedConsultation);\n      // Sende Event fr SavedFilterTags Aktualisierung\n      console.log(' ConsultationTracker: Sending consultationChanged event (stop)');\n      window.dispatchEvent(new CustomEvent('consultationChanged'));\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || t('consultations.stopError'));\n    }\n  };\n\n  const handleClientSelect = (client: Client) => {\n    setSelectedClient(client);\n    setIsClientSelectModalOpen(false);\n    if (!isManualEntry) {\n      handleStartConsultation(client.id, notes);\n    }\n  };\n\n  const handleCreateClient = () => {\n    setIsClientSelectModalOpen(false);\n    setIsCreateClientModalOpen(true);\n  };\n\n  const handleClientCreated = (client: Client) => {\n    setIsCreateClientModalOpen(false);\n    setSelectedClient(client);\n    // Entfernt: Automatischer Beratungsstart nach Client-Erstellung\n    // Client wird nur gespeichert, Beratung muss manuell gestartet werden\n    \n    // Recent Clients neu laden um den neuen Client anzuzeigen\n    loadRecentClients();\n    \n    // Success-Toast fr Client-Erstellung (wird bereits im Modal angezeigt)\n    // toast.success(`Client \"${client.name}\" wurde angelegt`);\n  };\n\n  /* CLAUDE-ANCHOR: CONSULTATION-MANUAL-SAVE-001 - Timezone-sichere manuelle Beratungserfassung */\n  const handleManualSave = async () => {\n    if (!selectedClient) {\n      toast.error('Bitte whlen Sie einen Client aus');\n      return;\n    }\n    if (!manualStartTime || !manualEndTime) {\n      toast.error('Bitte geben Sie Start- und Endzeit an');\n      return;\n    }\n    if (!selectedBranch) {\n      toast.error(t('consultations.selectBranch'));\n      return;\n    }\n\n    try {\n      setIsStarting(true);\n      \n      /* KRITISCHE TIMEZONE-BEHANDLUNG:\n       * Problem: Inkonsistenz zwischen normaler und manueller Beratung!\n       * \n       * NORMAL WORKING ():\n       * const correctedTime = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000);\n       * \n       * MANUAL BROKEN ():\n       * convertDatetimeLocalToApi() fhrt zu 5h Versatz\n       * \n       * LSUNG: Gleiche getTimezoneOffset-Logik fr beide verwenden!\n       * \n       * datetime-local Input: \"2024-01-15T14:01\"\n       *  new Date(\"2024-01-15T14:01\") erstellt lokales Date-Objekt\n       *  getTimezoneOffset() korrigiert zur gleichen Zeit wie bei normaler Beratung\n       *  KONSISTENTE Zeitbehandlung!\n       */\n      \n      //  KORRIGIERT: Verwende gleiche Logik wie bei normalem Start/Stop\n      const manualStart = new Date(manualStartTime);\n      const correctedStartTime = new Date(manualStart.getTime() - manualStart.getTimezoneOffset() * 60000);\n      \n      const manualEnd = new Date(manualEndTime);\n      const correctedEndTime = new Date(manualEnd.getTime() - manualEnd.getTimezoneOffset() * 60000);\n      \n      // Starte die Beratung mit der korrigierten Startzeit\n      const consultation = await consultationApi.startConsultation({\n        branchId: selectedBranch,\n        clientId: selectedClient.id,\n        notes: notes || '',\n        startTime: correctedStartTime.toISOString()  //  Konsistent mit normaler Beratung\n      });\n      \n      // Beende sie sofort mit der korrigierten Endzeit\n      const stoppedConsultation = await consultationApi.stopConsultation({\n        endTime: correctedEndTime.toISOString(),      //  Konsistent mit normaler Beratung\n        notes: notes || ''\n      });\n      \n      // Reset der Eingaben\n      setIsManualEntry(false);\n      setManualStartTime('');\n      setManualEndTime('');\n      setNotes('');\n      setSelectedClient(null);\n      \n      // Speichere den zuletzt gestarteten Client fr Tag-Priorisierung\n      setLastStartedClientId(selectedClient.id);\n      \n      // Sende Event fr SavedFilterTags Aktualisierung\n      console.log(' ConsultationTracker: Sending consultationChanged event (start)');\n      window.dispatchEvent(new CustomEvent('consultationChanged'));\n      \n      // Lade Recent Clients neu\n      loadRecentClients();\n      \n      // Callback fr Parent-Komponente - bergebe die beendete Consultation\n      onConsultationChange?.(stoppedConsultation);\n      \n      // Callback fr Filter-Wechsel\n      if (onConsultationStarted && selectedClient.name) {\n        onConsultationStarted(selectedClient.name);\n      }\n      \n      toast.success(t('consultations.manualSaveSuccess'));\n    } catch (error) {\n      console.error('Fehler beim Erfassen der Beratung:', error);\n      toast.error(t('consultations.manualSaveError'));\n    } finally {\n      setIsStarting(false);\n    }\n  };\n\n  const updateNotes = async () => {\n    if (!activeConsultation) return;\n    \n    try {\n      await consultationApi.updateConsultationNotes(activeConsultation.id, { notes });\n    } catch (error) {\n      // Stille Behandlung - Auto-Save sollte nicht strend sein\n    }\n  };\n\n  // Auto-save Notizen alle 30 Sekunden\n  useEffect(() => {\n    if (!activeConsultation || !notes) return;\n    \n    const timeout = setTimeout(() => {\n      updateNotes();\n    }, 30000);\n    \n    return () => clearTimeout(timeout);\n  }, [notes, activeConsultation]);\n\n  // Recent Clients aktualisieren wenn Fenster wieder fokussiert wird\n  useEffect(() => {\n    const handleFocus = () => {\n      loadRecentClients();\n    };\n\n    window.addEventListener('focus', handleFocus);\n    \n    return () => {\n      window.removeEventListener('focus', handleFocus);\n    };\n  }, []);\n\n  // Optimierte Tag-Breiten-Berechnung mit useMemo\n  const averageTagWidth = useMemo(() => {\n    if (recentClients.length === 0) return 85; // Reduzierter Fallback\n    \n    return recentClients.reduce((sum, client) => {\n      // Przisere Schtzung: ~6px pro Zeichen + 24px Padding\n      return sum + (client.name.length * 6 + 24);\n    }, 0) / recentClients.length;\n  }, [recentClients]);\n\n  // Optimierte Sichtbarkeits-Berechnung mit useCallback (vereinfacht ohne Dropdown)\n  const calculateVisibleTags = useCallback(() => {\n    if (!containerRef.current || recentClients.length === 0) return;\n\n    const container = containerRef.current;\n    const currentWidth = container.clientWidth;\n    \n    // Nur neu berechnen wenn sich die Breite signifikant gendert hat (>= 40px)\n    if (Math.abs(currentWidth - containerWidth) < 40) return;\n    \n    setContainerWidth(currentWidth);\n    \n    // Moderate responsive Abstnde fr bessere Tag-Anzeige\n    const isMobile = currentWidth < 768; // md breakpoint\n    const PLUS_BUTTON_WIDTH = 32; // Reduziert von 42\n    const GAPS_AND_MARGINS = isMobile ? 8 : 20; // Mobile: 8px, Desktop: 20px (weniger extrem)\n    const BUFFER = 12; // Reduziert von 16\n    \n    const availableWidth = currentWidth - PLUS_BUTTON_WIDTH - GAPS_AND_MARGINS - BUFFER;\n    \n    // Berechne maximal mgliche Tags (einfach soviele wie reinpassen)\n    const maxPossibleTags = Math.max(1, Math.floor(availableWidth / averageTagWidth));\n    \n    // Zeige soviele Tags wie reinpassen, maximal aber die verfgbaren\n    setVisibleTagCount(Math.min(maxPossibleTags, recentClients.length));\n  }, [recentClients, averageTagWidth, containerWidth]);\n\n  // Debounced ResizeObserver fr bessere Performance\n  const handleResize = useCallback(() => {\n    if (resizeTimeoutRef.current) {\n      clearTimeout(resizeTimeoutRef.current);\n    }\n    \n    resizeTimeoutRef.current = setTimeout(() => {\n      calculateVisibleTags();\n    }, 150); // 150ms Debounce fr smooth responsive behavior\n  }, [calculateVisibleTags]);\n\n  // Optimierter ResizeObserver\n  useEffect(() => {\n    if (!containerRef.current) return;\n\n    const resizeObserver = new ResizeObserver(handleResize);\n    resizeObserver.observe(containerRef.current);\n    \n    // Auch Window-Resize berwachen fr bessere Abdeckung\n    window.addEventListener('resize', handleResize);\n\n    return () => {\n      resizeObserver.disconnect();\n      window.removeEventListener('resize', handleResize);\n      if (resizeTimeoutRef.current) {\n        clearTimeout(resizeTimeoutRef.current);\n      }\n    };\n  }, [handleResize]);\n\n  // Initial calculation nach Client-nderungen\n  useLayoutEffect(() => {\n    calculateVisibleTags();\n  }, [calculateVisibleTags]);\n\n  // Optimistische Tag-Anzeige fr bessere UX\n  const showOptimisticTags = recentClients.length === 0 && loading;\n  const optimisticTags = useMemo(() => {\n    if (!showOptimisticTags) return [];\n    return Array(3).fill(null).map((_, i) => ({\n      id: `placeholder-${i}`,\n      name: '', // Placeholder\n      isPlaceholder: true,\n      status: undefined,\n      lastConsultationDate: undefined\n    }));\n  }, [showOptimisticTags]);\n\n  const displayTags = showOptimisticTags ? optimisticTags : recentClients;\n  const currentVisibleCount = showOptimisticTags ? optimisticTags.length : visibleTagCount;\n\n  // Sortiere displayTags: Zuletzt gestarteter Client zuerst\n  const sortedDisplayTags = useMemo(() => {\n    if (showOptimisticTags || !lastStartedClientId) {\n      return displayTags;\n    }\n    \n    // Finde den zuletzt gestarteten Client\n    const lastStartedClient = displayTags.find(client => client.id === lastStartedClientId);\n    if (!lastStartedClient) {\n      return displayTags;\n    }\n    \n    // Setze den zuletzt gestarteten Client an die erste Position\n    const otherClients = displayTags.filter(client => client.id !== lastStartedClientId);\n    return [lastStartedClient, ...otherClients];\n  }, [displayTags, lastStartedClientId, showOptimisticTags]);\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-4\"></div>\n          <div className=\"h-12 bg-gray-200 dark:bg-gray-700 rounded mb-2\"></div>\n          <div className=\"h-12 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white flex items-center pl-2 sm:pl-0\">\n            <UserGroupIcon className=\"h-6 w-6 mr-2 sm:h-6 sm:w-6 sm:mr-2\" />\n            {t('consultations.trackerTitle')}\n          </h2>\n          {activeConsultation && (\n            <div className=\"flex items-center text-green-600 dark:text-green-400\">\n              <ClockIcon className=\"h-5 w-5 mr-2 animate-pulse\" />\n              <span className=\"font-medium\">\n                {calculateDuration(activeConsultation.startTime, null)} - {activeConsultation.client?.name}\n              </span>\n            </div>\n          )}\n        </div>\n\n        {/* Aktive Beratung oder Start-Buttons */}\n        {activeConsultation ? (\n          <div className=\"space-y-4\">\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">{t('consultations.activeWith')}</p>\n              <p className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                {activeConsultation.client?.name}\n              </p>\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                {t('consultations.startedAt')}: {formatTime(activeConsultation.startTime)}\n              </p>\n            </div>\n\n            {/* Notizen-Bereich */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                {t('consultations.notesForConsultation')}\n              </label>\n              <textarea\n                value={notes}\n                onChange={(e) => setNotes(e.target.value)}\n                onBlur={updateNotes}\n                className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                rows={3}\n                placeholder={t('consultations.notesPlaceholder')}\n              />\n            </div>\n\n            <button\n              onClick={stopConsultation}\n              className=\"w-full flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n            >\n              <StopIcon className=\"h-5 w-5 mr-2\" />\n              {t('consultations.stop')}\n            </button>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {/* Zuletzt beratene Clients als Tags mit vereinfachtem responsive Layout (ohne Dropdown) */}\n            {(sortedDisplayTags.length > 0) && !isManualEntry && (\n              <div>\n                <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  {sortedDisplayTags.some(c => !isPlaceholder(c) && c.status === 'planned') ? \n                    t('consultations.recentAndPlanned') : \n                    t('consultations.recent')\n                  }\n                </p>\n                <div ref={containerRef} className=\"flex items-center gap-0.5 md:gap-6\">\n                  {/* Neuer Client Button - links positioniert mit extremen responsiven Abstnden */}\n                  <button\n                    onClick={() => setIsCreateClientModalOpen(true)}\n                    disabled={showOptimisticTags}\n                    className={`bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center flex-shrink-0 ${showOptimisticTags ? 'opacity-50 cursor-not-allowed' : ''}`}\n                    style={{ width: '30.19px', height: '30.19px' }}\n                    title={t('consultations.createClient')}\n                    aria-label={t('consultations.createClient')}\n                  >\n                    <PlusIcon className=\"h-4 w-4\" />\n                  </button>\n                  \n                  {/* Soviele Client-Tags wie reinpassen (ohne Dropdown) */}\n                  <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                    {sortedDisplayTags.slice(0, currentVisibleCount).map((client, index) => {\n                      const isPast = !isPlaceholder(client) && client.status === 'past';\n                      const isPlanned = !isPlaceholder(client) && client.status === 'planned';\n                      \n                      return (\n                        <button\n                          key={client.id}\n                          onClick={() => !isPlaceholder(client) && handleStartConsultation(Number(client.id), notes)}\n                          disabled={isPlaceholder(client)}\n                          className={`inline-flex items-center px-3 py-2 rounded-full text-sm font-medium flex-shrink-0 transition-colors ${\n                            isPlaceholder(client) \n                              ? 'bg-gray-200 dark:bg-gray-600 text-gray-400 dark:text-gray-500 animate-pulse cursor-default'\n                              : isPlanned\n                                ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 hover:bg-blue-200 dark:hover:bg-blue-900/50 cursor-pointer border border-blue-200 dark:border-blue-700'\n                                : 'bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600 cursor-pointer'\n                          }`}\n                          title={\n                            isPlaceholder(client) \n                              ? t('common.loading')\n                              : isPlanned\n                                ? t('consultations.plannedWith', { \n                                    clientName: client.name, \n                                    date: client.lastConsultationDate ? new Date(client.lastConsultationDate).toLocaleDateString('de-DE', { day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit' }) : ''\n                                  })\n                                : t('consultations.startWith', { \n                                    clientName: client.name,\n                                    date: client.lastConsultationDate ? new Date(client.lastConsultationDate).toLocaleDateString('de-DE') : ''\n                                  })\n                          }\n                        >\n                          {isPlanned && !isPlaceholder(client) && (\n                            <svg className=\"h-3 w-3 mr-1.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                              <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\" clipRule=\"evenodd\"/>\n                            </svg>\n                          )}\n                          <span className=\"truncate max-w-[120px]\">\n                            {isPlaceholder(client) ? (\n                              <span className=\"inline-block w-16 h-4 bg-gray-300 dark:bg-gray-500 rounded animate-pulse\"></span>\n                            ) : (\n                              client.name\n                            )}\n                          </span>\n                        </button>\n                      );\n                    })}\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Start-Buttons */}\n            <div className=\"flex gap-6\">\n              <button\n                onClick={() => setIsClientSelectModalOpen(true)}\n                className=\"w-2/3 flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                title={t('consultations.start')}\n              >\n                <PlayIcon className=\"h-5 w-5\" />\n              </button>\n\n              <button\n                onClick={() => {\n                  setIsManualEntry(!isManualEntry);\n                  setSelectedClient(null);\n                  setManualStartTime('');\n                  setManualEndTime('');\n                  setNotes('');\n                }}\n                className={`w-1/3 flex items-center justify-center px-4 py-3 border text-base font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${\n                  isManualEntry\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20'\n                    : 'border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600'\n                }`}\n                title={t('consultations.plan')}\n              >\n                <ClockIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n\n            {/* Manuelle Erfassung / Planen */}\n            {isManualEntry && (\n              <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 space-y-3\">\n                <h3 className=\"text-sm font-medium text-gray-900 dark:text-white mb-3\">\n                  {t('consultations.planConsultation')}\n                </h3>\n                \n                {/* Client-Auswahl */}\n                <div>\n                  <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('consultations.columns.client')}\n                  </label>\n                  {selectedClient ? (\n                    <div className=\"flex items-center justify-between bg-white dark:bg-gray-800 rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2\">\n                      <span className=\"text-sm text-gray-900 dark:text-white\">{selectedClient.name}</span>\n                      <button\n                        onClick={() => setIsClientSelectModalOpen(true)}\n                        className=\"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                      >\n                        {t('consultations.change')}\n                      </button>\n                    </div>\n                  ) : (\n                    <button\n                      onClick={() => setIsClientSelectModalOpen(true)}\n                      className=\"w-full text-left bg-white dark:bg-gray-800 rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 text-sm text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700\"\n                    >\n                      {t('consultations.selectClientPlaceholder')}\n                    </button>\n                  )}\n                </div>\n\n                {/* Zeit-Inputs */}\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('consultations.columns.startTime')}\n                    </label>\n                    <input\n                      type=\"datetime-local\"\n                      value={manualStartTime}\n                      onChange={(e) => setManualStartTime(e.target.value)}\n                      className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('consultations.columns.endTime')}\n                    </label>\n                    <input\n                      type=\"datetime-local\"\n                      value={manualEndTime}\n                      onChange={(e) => setManualEndTime(e.target.value)}\n                      className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    />\n                  </div>\n                </div>\n\n                {/* Notizen */}\n                <div>\n                  <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('consultations.columns.notes')}\n                  </label>\n                  <textarea\n                    value={notes}\n                    onChange={(e) => setNotes(e.target.value)}\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    rows={2}\n                    placeholder={t('consultations.optionalNotes')}\n                  />\n                </div>\n\n                {/* Speichern-Button */}\n                <div className=\"flex justify-end\">\n                  <button\n                    onClick={handleManualSave}\n                    disabled={!selectedClient || !manualStartTime || !manualEndTime}\n                    className=\"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    {t('consultations.saveConsultation')}\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Modals */}\n      <ClientSelectModal\n        isOpen={isClientSelectModalOpen}\n        onClose={() => setIsClientSelectModalOpen(false)}\n        onSelect={handleClientSelect}\n        onCreateNew={handleCreateClient}\n      />\n\n      <CreateClientModal\n        isOpen={isCreateClientModalOpen}\n        onClose={() => setIsCreateClientModalOpen(false)}\n        onSave={handleClientCreated}\n      />\n    </>\n  );\n};\n\nexport default ConsultationTracker; ","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, MagnifyingGlassIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { toast } from 'react-toastify';\r\n\r\ninterface Task {\r\n  id: number;\r\n  title: string;\r\n  status: string;\r\n  responsible?: {\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n}\r\n\r\ninterface LinkTaskModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  consultationId: number;\r\n  onTaskLinked: () => void;\r\n}\r\n\r\nconst LinkTaskModal: React.FC<LinkTaskModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  consultationId,\r\n  onTaskLinked\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const [tasks, setTasks] = useState<Task[]>([]);\r\n  const [filteredTasks, setFilteredTasks] = useState<Task[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedTaskId, setSelectedTaskId] = useState<number | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      loadTasks();\r\n    }\r\n  }, [isOpen]);\r\n\r\n  useEffect(() => {\r\n    if (searchTerm) {\r\n      const filtered = tasks.filter(task => \r\n        task.title.toLowerCase().includes(searchTerm.toLowerCase())\r\n      );\r\n      setFilteredTasks(filtered);\r\n    } else {\r\n      setFilteredTasks(tasks);\r\n    }\r\n  }, [searchTerm, tasks]);\r\n\r\n  const loadTasks = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await axiosInstance.get(API_ENDPOINTS.TASKS.BASE);\r\n      // Filtere nur offene und in Bearbeitung befindliche Tasks\r\n      const activeTasks = response.data.filter((task: Task) => \r\n        task.status === 'open' || task.status === 'in_progress'\r\n      );\r\n      setTasks(activeTasks);\r\n      setFilteredTasks(activeTasks);\r\n    } catch (error) {\r\n      toast.error(t('consultations.linkTask.loadError'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleLinkTask = async () => {\r\n    if (!selectedTaskId) {\r\n      toast.error(t('consultations.linkTask.selectTask'));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await axiosInstance.post(\r\n        API_ENDPOINTS.CONSULTATIONS.LINK_TASK(consultationId),\r\n        { taskId: selectedTaskId }\r\n      );\r\n      \r\n      toast.success(t('consultations.linkTask.success'));\r\n      onTaskLinked();\r\n      onClose();\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || t('consultations.linkTask.error'));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n      \r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n          <div className=\"p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                {t('consultations.linkTask.title')}\r\n              </Dialog.Title>\r\n              <button\r\n                onClick={onClose}\r\n                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n              >\r\n                <XMarkIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Suchfeld */}\r\n            <div className=\"relative mb-4\">\r\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                <MagnifyingGlassIcon className=\"h-5 w-5 text-gray-400\" />\r\n              </div>\r\n              <input\r\n                type=\"text\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n                placeholder={t('consultations.linkTask.searchPlaceholder')}\r\n                autoFocus\r\n              />\r\n            </div>\r\n\r\n            {/* Task-Liste */}\r\n            <div className=\"max-h-96 overflow-y-auto\">\r\n              {loading ? (\r\n                <div className=\"text-center py-4 text-gray-500 dark:text-gray-400\">\r\n                  {t('common.loading')}\r\n                </div>\r\n              ) : filteredTasks.length === 0 ? (\r\n                <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\r\n                  {t('consultations.linkTask.noTasksFound')}\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  {filteredTasks.map((task) => (\r\n                    <label\r\n                      key={task.id}\r\n                      className=\"flex items-center p-3 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer\"\r\n                    >\r\n                      <input\r\n                        type=\"radio\"\r\n                        name=\"task\"\r\n                        value={task.id}\r\n                        checked={selectedTaskId === task.id}\r\n                        onChange={() => setSelectedTaskId(task.id)}\r\n                        className=\"mr-3\"\r\n                      />\r\n                      <div className=\"flex-1\">\r\n                        <p className=\"font-medium text-gray-900 dark:text-white\">\r\n                          {task.title}\r\n                        </p>\r\n                        {task.responsible && (\r\n                          <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                            {t('tasks.columns.responsible')}: {task.responsible.firstName} {task.responsible.lastName}\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                      <span className={`px-2 py-1 text-xs rounded-full ${\r\n                        task.status === 'open' \r\n                          ? 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'\r\n                          : 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300'\r\n                      }`}>\r\n                        {task.status === 'open' ? t('tasks.status.open') : t('tasks.status.in_progress')}\r\n                      </span>\r\n                    </label>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Buttons */}\r\n            <div className=\"mt-6 flex items-center justify-end space-x-3\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={onClose}\r\n                className=\"px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n              >\r\n                {t('common.cancel')}\r\n              </button>\r\n              <button\r\n                onClick={handleLinkTask}\r\n                disabled={!selectedTaskId}\r\n                className=\"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {t('consultations.linkTask.link')}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default LinkTaskModal; ","import React, { useState } from 'react';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { \r\n  CheckCircleIcon, \r\n  XMarkIcon, \r\n  DocumentArrowDownIcon,\r\n  EyeIcon \r\n} from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { toast } from 'react-toastify';\r\n\r\ninterface InvoiceSuccessModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  invoiceId: number;\r\n  invoiceNumber: string;\r\n  totalAmount: string;\r\n  clientName: string;\r\n}\r\n\r\nconst InvoiceSuccessModal: React.FC<InvoiceSuccessModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  invoiceId,\r\n  invoiceNumber,\r\n  totalAmount,\r\n  clientName\r\n}) => {\r\n  const [downloadingPdf, setDownloadingPdf] = useState(false);\r\n\r\n  const handleDownloadPdf = async () => {\r\n    try {\r\n      setDownloadingPdf(true);\r\n      \r\n      const response = await axiosInstance.get(\r\n        API_ENDPOINTS.CONSULTATION_INVOICES.GENERATE_PDF(invoiceId),\r\n        { \r\n          responseType: 'blob',\r\n          headers: {\r\n            'Accept': 'application/pdf'\r\n          }\r\n        }\r\n      );\r\n      \r\n      // Erstelle Blob und Download-Link\r\n      const blob = new Blob([response.data], { type: 'application/pdf' });\r\n      const url = window.URL.createObjectURL(blob);\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      link.download = `Rechnung_${invoiceNumber}.pdf`;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n      window.URL.revokeObjectURL(url);\r\n      \r\n      toast.success('PDF erfolgreich heruntergeladen');\r\n    } catch (error: any) {\r\n      console.error('Fehler beim Download der PDF:', error);\r\n      toast.error(error.response?.data?.message || 'Fehler beim Download der PDF');\r\n    } finally {\r\n      setDownloadingPdf(false);\r\n    }\r\n  };\r\n\r\n  const handleViewInvoiceManagement = () => {\r\n    // TODO: Navigation zur Rechnungsverwaltung (wird in Phase 5 implementiert)\r\n    toast.info('Rechnungsverwaltung wird in Phase 5 implementiert');\r\n    onClose();\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n      \r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n          <div className=\"p-6\">\r\n            {/* Header mit Success Icon */}\r\n            <div className=\"flex items-center justify-between mb-6\">\r\n              <div className=\"flex items-center\">\r\n                <CheckCircleIcon className=\"h-8 w-8 text-green-500 mr-3\" />\r\n                <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                  Rechnung erstellt\r\n                </Dialog.Title>\r\n              </div>\r\n              <button\r\n                onClick={onClose}\r\n                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n              >\r\n                <XMarkIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Success Inhalt */}\r\n            <div className=\"space-y-4\">\r\n              <div className=\"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4\">\r\n                <h3 className=\"font-medium text-green-800 dark:text-green-200 mb-2\">\r\n                  Rechnung erfolgreich erstellt\r\n                </h3>\r\n                <div className=\"text-sm text-green-700 dark:text-green-300 space-y-1\">\r\n                  <p><strong>Rechnungsnummer:</strong> {invoiceNumber}</p>\r\n                  <p><strong>Kunde:</strong> {clientName}</p>\r\n                  <p><strong>Betrag:</strong> CHF {totalAmount}</p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Hinweise */}\r\n              <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\r\n                <h4 className=\"font-medium text-blue-800 dark:text-blue-200 mb-2\">\r\n                  Nchste Schritte\r\n                </h4>\r\n                <ul className=\"text-sm text-blue-700 dark:text-blue-300 space-y-1\">\r\n                  <li> PDF herunterladen und an Kunde senden</li>\r\n                  <li> Beratungen sind nun als abgerechnet markiert</li>\r\n                  <li> Rechnung in der Rechnungsverwaltung verwalten</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Aktionen */}\r\n            <div className=\"mt-6 flex flex-col space-y-3\">\r\n              <button\r\n                onClick={handleDownloadPdf}\r\n                disabled={downloadingPdf}\r\n                className=\"w-full flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {downloadingPdf ? (\r\n                  <>\r\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                    PDF wird generiert...\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <DocumentArrowDownIcon className=\"h-5 w-5 mr-2\" />\r\n                    PDF herunterladen\r\n                  </>\r\n                )}\r\n              </button>\r\n\r\n              <button\r\n                onClick={handleViewInvoiceManagement}\r\n                className=\"w-full flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n              >\r\n                <EyeIcon className=\"h-5 w-5 mr-2\" />\r\n                Zur Rechnungsverwaltung\r\n              </button>\r\n\r\n              <button\r\n                onClick={onClose}\r\n                className=\"w-full px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200\"\r\n              >\r\n                Schlieen\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default InvoiceSuccessModal; ","import React, { useState, useEffect, useCallback } from 'react';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon, DocumentTextIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { toast } from 'react-toastify';\nimport { Consultation } from '../types/client.ts';\nimport { calculateDuration, formatTime } from '../utils/dateUtils.ts';\nimport { format } from 'date-fns';\nimport InvoiceSuccessModal from './InvoiceSuccessModal.tsx';\n\ninterface CreateInvoiceModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  consultations: Consultation[];\n  onInvoiceCreated: (invoiceId: number) => void;\n}\n\ninterface InvoiceSettings {\n  companyName: string;\n  companyAddress: string;\n  companyZip: string;\n  companyCity: string;\n  companyCountry: string;\n  companyPhone?: string;\n  companyEmail?: string;\n  vatNumber?: string;\n  iban: string;\n  defaultHourlyRate: number;\n  defaultVatRate?: number;\n  invoicePrefix: string;\n  nextInvoiceNumber: number;\n}\n\ninterface CreatedInvoice {\n  id: number;\n  invoiceNumber: string;\n  total: number;\n  clientName: string;\n}\n\nconst CreateInvoiceModal: React.FC<CreateInvoiceModalProps> = ({\n  isOpen,\n  onClose,\n  consultations,\n  onInvoiceCreated\n}) => {\n  const { t } = useTranslation();\n  const { hasPermission } = usePermissions();\n  const [loading, setLoading] = useState(false);\n  const [settings, setSettings] = useState<InvoiceSettings | null>(null);\n  const [createdInvoice, setCreatedInvoice] = useState<CreatedInvoice | null>(null);\n  const [showSuccessModal, setShowSuccessModal] = useState(false);\n  const [formData, setFormData] = useState({\n    issueDate: format(new Date(), 'yyyy-MM-dd'),\n    dueDate: format(new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), 'yyyy-MM-dd'),\n    hourlyRate: 0,\n    vatRate: 0,\n    notes: ''\n  });\n\n  // Berechtigungsprfung\n  const canCreateInvoices = hasPermission('invoice_create', 'write', 'button');\n  \n  // loadInvoiceSettings Funktion MUSS vor useEffect definiert werden\n  const loadInvoiceSettings = useCallback(async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.INVOICE_SETTINGS.BASE);\n      const settingsData = response.data;\n      \n      setSettings(settingsData);\n      setFormData(prev => ({\n        ...prev,\n        hourlyRate: settingsData.defaultHourlyRate || 0,\n        vatRate: settingsData.defaultVatRate || 0\n      }));\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Rechnungseinstellungen:', error);\n      if (error.response?.status === 404) {\n        toast.error('Bitte konfigurieren Sie zuerst Ihre Rechnungseinstellungen');\n      } else {\n        toast.error('Fehler beim Laden der Rechnungseinstellungen');\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n  \n  // useEffect MUSS vor allen frhen Returns stehen!\n  useEffect(() => {\n    if (isOpen) {\n      loadInvoiceSettings();\n    }\n  }, [isOpen, loadInvoiceSettings]);\n\n  // Berechtigungsprfung - NACH useEffect\n  if (!canCreateInvoices) {\n    return (\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6\">\n            <div className=\"text-center\">\n              <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\n                Keine Berechtigung\n              </h3>\n              <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n                Sie haben keine Berechtigung, Rechnungen zu erstellen.\n              </p>\n              <button\n                onClick={onClose}\n                className=\"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400\"\n              >\n                Schlieen\n              </button>\n            </div>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!settings) {\n      toast.error('Rechnungseinstellungen konnten nicht geladen werden');\n      return;\n    }\n\n    if (consultations.length === 0) {\n      toast.error('Keine Beratungen zum Abrechnen vorhanden');\n      return;\n    }\n\n    // Validiere, dass alle Consultations den gleichen Client haben\n    const uniqueClientIds = [...new Set(consultations.map(c => c.clientId))];\n    if (uniqueClientIds.length > 1) {\n      toast.error('Alle Beratungen mssen den gleichen Kunden haben');\n      return;\n    }\n\n    const clientId = uniqueClientIds[0];\n    if (!clientId) {\n      toast.error('Kein gltiger Kunde in den Beratungen gefunden');\n      return;\n    }\n\n    try {\n      setLoading(true);\n\n      const response = await axiosInstance.post(\n        API_ENDPOINTS.CONSULTATION_INVOICES.CREATE_FROM_CONSULTATIONS,\n        {\n          consultationIds: consultations.map(c => c.id),\n          clientId: clientId,\n          issueDate: formData.issueDate,\n          dueDate: formData.dueDate,\n          hourlyRate: formData.hourlyRate,\n          vatRate: formData.vatRate || 0,\n          notes: formData.notes\n        }\n      );\n      \n      const invoice = response.data;\n      const clientName = consultations[0]?.client?.name || 'Unbekannt';\n      \n      setCreatedInvoice({\n        id: invoice.id,\n        invoiceNumber: invoice.invoiceNumber,\n        total: invoice.total,\n        clientName: clientName\n      });\n      \n      setShowSuccessModal(true);\n      onInvoiceCreated(invoice.id);\n      \n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'Fehler beim Erstellen der Rechnung');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n  };\n\n  const handleCloseAll = () => {\n    setShowSuccessModal(false);\n    setCreatedInvoice(null);\n    onClose();\n  };\n\n  // Berechnungen fr die Kostenbersicht\n  const totalHours = consultations.reduce((sum, consultation) => {\n    if (consultation.endTime) {\n      const duration = calculateDuration(consultation.startTime, consultation.endTime);\n      const hours = parseFloat(duration.replace('h', '').replace(',', '.'));\n      return sum + hours;\n    }\n    return sum;\n  }, 0);\n\n  const estimatedTotal = totalHours * formData.hourlyRate;\n  const vatAmount = formData.vatRate > 0 ? (estimatedTotal * formData.vatRate / 100) : 0;\n  const totalWithVat = estimatedTotal + vatAmount;\n\n  if (!isOpen) return null;\n\n  return (\n    <>\n      <Dialog open={isOpen && !showSuccessModal} onClose={onClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <form onSubmit={handleSubmit} className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                  Rechnung erstellen\n                </Dialog.Title>\n                <button\n                  type=\"button\"\n                  onClick={onClose}\n                  className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                >\n                  <XMarkIcon className=\"h-6 w-6\" />\n                </button>\n              </div>\n\n              {/* Beratungen bersicht */}\n              <div className=\"mb-6 bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4\">\n                <h3 className=\"font-medium text-gray-900 dark:text-white mb-3\">\n                  Zu verrechnende Beratungen\n                </h3>\n                <div className=\"space-y-2 max-h-40 overflow-y-auto\">\n                  {consultations.map((consultation) => (\n                    <div key={consultation.id} className=\"flex justify-between items-center text-sm\">\n                      <div>\n                        <span className=\"text-gray-900 dark:text-white\">\n                          {consultation.client?.name} - {formatTime(consultation.startTime)}\n                        </span>\n                      </div>\n                      <span className=\"text-gray-600 dark:text-gray-400\">\n                        {calculateDuration(consultation.startTime, consultation.endTime)}\n                      </span>\n                    </div>\n                  ))}\n                </div>\n                <div className=\"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600 flex justify-between text-sm font-medium\">\n                  <span>Gesamtdauer:</span>\n                  <span>{totalHours.toFixed(2)}h</span>\n                </div>\n              </div>\n\n              {/* Rechnungsdetails */}\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Rechnungsdatum\n                  </label>\n                  <input\n                    type=\"date\"\n                    name=\"issueDate\"\n                    value={formData.issueDate}\n                    onChange={handleChange}\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Flligkeitsdatum\n                  </label>\n                  <input\n                    type=\"date\"\n                    name=\"dueDate\"\n                    value={formData.dueDate}\n                    onChange={handleChange}\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Stundensatz (CHF)\n                  </label>\n                  <input\n                    type=\"number\"\n                    name=\"hourlyRate\"\n                    value={formData.hourlyRate}\n                    onChange={handleChange}\n                    step=\"0.01\"\n                    min=\"0\"\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    MwSt.-Satz (%)\n                  </label>\n                  <input\n                    type=\"number\"\n                    name=\"vatRate\"\n                    value={formData.vatRate}\n                    onChange={handleChange}\n                    step=\"0.1\"\n                    min=\"0\"\n                    max=\"100\"\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n              </div>\n\n              {/* Notizen */}\n              <div className=\"mb-6\">\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Zustzliche Notizen\n                </label>\n                <textarea\n                  name=\"notes\"\n                  value={formData.notes}\n                  onChange={handleChange}\n                  rows={3}\n                  className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  placeholder=\"Optionale Notizen zur Rechnung...\"\n                />\n              </div>\n\n              {/* Kostenbersicht */}\n              <div className=\"mb-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n                <h3 className=\"font-medium text-blue-800 dark:text-blue-200 mb-3\">\n                  Kostenbersicht\n                </h3>\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span>Beratungszeit ({totalHours.toFixed(2)}h  CHF {formData.hourlyRate}):</span>\n                    <span>CHF {estimatedTotal.toFixed(2)}</span>\n                  </div>\n                  {formData.vatRate > 0 && (\n                    <div className=\"flex justify-between\">\n                      <span>MwSt. ({formData.vatRate}%):</span>\n                      <span>CHF {vatAmount.toFixed(2)}</span>\n                    </div>\n                  )}\n                  <div className=\"border-t border-blue-200 dark:border-blue-700 pt-2 flex justify-between font-medium\">\n                    <span>Gesamtbetrag:</span>\n                    <span>CHF {totalWithVat.toFixed(2)}</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Buttons */}\n              <div className=\"flex items-center justify-end space-x-3\">\n                <button\n                  type=\"button\"\n                  onClick={onClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading || !settings || totalHours === 0}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? 'Erstelle Rechnung...' : 'Rechnung erstellen'}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <DocumentTextIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n\n      {/* Success Modal */}\n      {showSuccessModal && createdInvoice && (\n        <InvoiceSuccessModal\n          isOpen={showSuccessModal}\n          onClose={handleCloseAll}\n          invoiceId={createdInvoice.id}\n          invoiceNumber={createdInvoice.invoiceNumber}\n          totalAmount={Number(createdInvoice.total).toFixed(2)}\n          clientName={createdInvoice.clientName}\n        />\n      )}\n    </>\n  );\n};\n\nexport default CreateInvoiceModal; ","import React, { useState, useEffect, useMemo, useImperativeHandle, forwardRef, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { \n  ClockIcon, \n  FunnelIcon,\n  XMarkIcon,\n  LinkIcon,\n  TrashIcon,\n  DocumentTextIcon,\n  ChartBarIcon,\n  CheckIcon\n} from '@heroicons/react/24/outline';\nimport { useNavigate } from 'react-router-dom';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { \n  formatTime, \n  calculateDuration, \n  formatTotalDuration, \n  isConsultationInvoiced, \n  getConsultationInvoiceInfo,\n  getInvoiceStatusText,\n  getInvoiceStatusColor \n} from '../utils/dateUtils.ts';\nimport { Consultation, Client } from '../types/client.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { toast } from 'react-toastify';\nimport LinkTaskModal from './LinkTaskModal.tsx';\nimport FilterPane from './FilterPane.tsx';\nimport SavedFilterTags from './SavedFilterTags.tsx';\nimport { FilterCondition } from './FilterRow.tsx';\nimport * as consultationApi from '../api/consultationApi.ts';\nimport * as clientApi from '../api/clientApi.ts';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport CreateInvoiceModal from './CreateInvoiceModal.tsx';\n\n// TableID fr gespeicherte Filter\nconst CONSULTATIONS_TABLE_ID = 'consultations-table';\n\ninterface ConsultationListProps {\n  onConsultationChange?: () => void;\n}\n\n// Ref-Interface fr imperatives Handle\nexport interface ConsultationListRef {\n  refresh: () => void;\n  addConsultation?: (consultation: Consultation) => void;\n  updateConsultation?: (consultation: Consultation) => void;\n  removeConsultation?: (consultationId: number) => void;\n  activateClientFilter?: (clientName: string) => void;\n}\n\nconst ConsultationList = forwardRef<ConsultationListRef, ConsultationListProps>(({ onConsultationChange }, ref) => {\n  const { t } = useTranslation();\n  const { hasPermission } = usePermissions();\n  const navigate = useNavigate();\n  const [consultations, setConsultations] = useState<Consultation[]>([]);\n  const [recentClients, setRecentClients] = useState<Client[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [editingNotesId, setEditingNotesId] = useState<number | null>(null);\n  const [editingNotes, setEditingNotes] = useState('');\n  const [editingTimeId, setEditingTimeId] = useState<number | null>(null);\n  const [editingTimeType, setEditingTimeType] = useState<'startTime' | 'endTime' | null>(null);\n  const [editingTimeValue, setEditingTimeValue] = useState('');\n  const [linkTaskModalOpen, setLinkTaskModalOpen] = useState(false);\n  const [selectedConsultationId, setSelectedConsultationId] = useState<number | null>(null);\n\n  // Filter State Management\n  const [activeFilterName, setActiveFilterName] = useState<string>(t('consultations.filters.today'));\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n\n  // Invoice Creation State\n  const [showCreateInvoiceModal, setShowCreateInvoiceModal] = useState(false);\n\n  const loadConsultations = async () => {\n    try {\n      setLoading(true);\n      const consultations = await consultationApi.getConsultations();\n      setConsultations(consultations || []);\n      setError(null);\n    } catch (error) {\n      console.error('Fehler beim Laden der Beratungen:', error);\n      setError(t('consultations.loadError'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadRecentClients = async () => {\n    try {\n      const clients = await clientApi.getRecentClients();\n      setRecentClients(clients || []);\n    } catch (error) {\n      // Stille Behandlung - normale Situation wenn noch keine Clients beraten wurden\n    }\n  };\n\n  // Imperatives Handle fr Ref-basierte Refresh-Funktion\n  useImperativeHandle(ref, () => ({\n    refresh: loadConsultations,\n    addConsultation: (consultation: Consultation) => {\n      // Optimistisches Update: Fge Consultation zur Liste hinzu\n      setConsultations(prev => [consultation, ...prev]);\n    },\n    updateConsultation: (consultation: Consultation) => {\n      // Optimistisches Update: Aktualisiere Consultation in der Liste\n      setConsultations(prev => \n        prev.map(c => c.id === consultation.id ? consultation : c)\n      );\n    },\n    removeConsultation: (consultationId: number) => {\n      // Optimistisches Update: Entferne Consultation aus der Liste\n      setConsultations(prev => prev.filter(c => c.id !== consultationId));\n    },\n    activateClientFilter: createAndActivateClientFilter\n  }));\n\n  // Initial load\n  useEffect(() => {\n    loadConsultations();\n    loadRecentClients();\n  }, []);\n\n  // Initialer Default-Filter\n  useEffect(() => {\n    const setInitialFilter = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const filters = response.data;\n        \n        const heuteFilter = filters.find((filter: any) => filter.name === 'Heute');\n        if (heuteFilter) {\n          setActiveFilterName(t('consultations.filters.today'));\n          setSelectedFilterId(heuteFilter.id);\n          applyFilterConditions(heuteFilter.conditions, heuteFilter.operators);\n        }\n      } catch (error) {\n        console.error('Fehler beim Setzen des initialen Filters:', error);\n      }\n    };\n\n    setInitialFilter();\n  }, []);\n\n  // Filter Change Handler\n  const handleFilterChange = (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  // Client-Filter erstellen und aktivieren\n  const createAndActivateClientFilter = async (clientName: string) => {\n    try {\n      // Prfe ob Client-Filter bereits existiert\n      const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n      const existingFilters = response.data;\n      \n      let clientFilter = existingFilters.find((filter: any) => filter.name === clientName);\n      \n      if (!clientFilter) {\n        // Erstelle neuen Client-Filter\n        const newFilter = {\n          tableId: CONSULTATIONS_TABLE_ID,\n          name: clientName,\n          conditions: [\n            { column: 'client', operator: 'equals', value: clientName }\n          ],\n          operators: []\n        };\n        \n        const createResponse = await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, newFilter);\n        clientFilter = createResponse.data;\n        \n        // Refresh die Filter-Liste\n        if ((window as any).refreshSavedFilters) {\n          (window as any).refreshSavedFilters();\n        }\n      }\n      \n      // Aktiviere den Client-Filter\n      if (clientFilter) {\n        setActiveFilterName(clientName);\n        setSelectedFilterId(clientFilter.id);\n        applyFilterConditions(clientFilter.conditions, clientFilter.operators);\n      }\n    } catch (error) {\n      console.error('Fehler beim Erstellen/Aktivieren des Client-Filters:', error);\n    }\n  };\n\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        if (!token) return;\n\n        // Prfe, ob Standard-Filter bereits existieren\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const existingFilters = response.data;\n\n        // Lsche veralteten \"Alle\" Filter falls vorhanden\n        const alleFilter = existingFilters.find((filter: any) => filter.name === 'Alle');\n        if (alleFilter) {\n          try {\n            await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(alleFilter.id));\n            console.log('Veralteter \"Alle\" Filter gelscht');\n          } catch (error) {\n            console.error('Fehler beim Lschen des \"Alle\" Filters:', error);\n          }\n        }\n\n        // Lsche veralteten \"Diese Woche\" Filter falls vorhanden\n        const dieseWocheFilter = existingFilters.find((filter: any) => filter.name === 'Diese Woche');\n        if (dieseWocheFilter) {\n          try {\n            await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(dieseWocheFilter.id));\n            console.log('Veralteter \"Diese Woche\" Filter gelscht');\n          } catch (error) {\n            console.error('Fehler beim Lschen des \"Diese Woche\" Filters:', error);\n          }\n        }\n\n        const archivFilterExists = existingFilters.some((filter: any) => filter.name === 'Archiv');\n        const heuteFilterExists = existingFilters.some((filter: any) => filter.name === 'Heute');\n        const wocheFilterExists = existingFilters.some((filter: any) => filter.name === 'Woche');\n        const nichtAbgerechnetFilterExists = existingFilters.some((filter: any) => filter.name === 'Nicht abgerechnet');\n\n        // Erstelle \"Archiv\"-Filter (zeigt nur vergangene Beratungen - strikt vor heute)\n        if (!archivFilterExists) {\n          const today = new Date().toISOString().split('T')[0];\n          const archivFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: 'Archiv',\n            conditions: [\n              { column: 'startTime', operator: 'before', value: today }\n            ],\n            operators: []\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, archivFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Archiv-Filters:', error);\n          }\n        }\n\n        // Erstelle \"Heute\"-Filter\n        if (!heuteFilterExists) {\n          const heuteFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: t('consultations.filters.today'),\n            conditions: [\n              { column: 'startTime', operator: 'equals', value: '__TODAY__' }\n            ],\n            operators: []\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, heuteFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Heute-Filters:', error);\n          }\n        }\n\n        // Erstelle \"Woche\"-Filter (von heute bis heute + 7 Tage)\n        if (!wocheFilterExists) {\n          const wocheFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: t('consultations.filters.week'),\n            conditions: [\n              { column: 'startTime', operator: 'after', value: '__TODAY__' },\n              { column: 'startTime', operator: 'before', value: '__WEEK_FROM_TODAY__' }\n            ],\n            operators: ['AND']\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, wocheFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Woche-Filters:', error);\n          }\n        }\n\n        // Erstelle \"Nicht abgerechnet\"-Filter\n        if (!nichtAbgerechnetFilterExists) {\n          const nichtAbgerechnetFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: t('consultations.filters.unbilled'),\n            conditions: [\n              { column: 'invoiceStatus', operator: 'equals', value: 'nicht abgerechnet' }\n            ],\n            operators: []\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, nichtAbgerechnetFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Nicht abgerechnet-Filters:', error);\n          }\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []); // Nur einmal beim ersten Laden\n\n  // Aktualisiere bestehende Filter die alte statische Datumswerte haben\n  useEffect(() => {\n    const updateExistingFilters = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const existingFilters = response.data;\n\n        // Finde \"Heute\" Filter mit statischem Datum\n        const heuteFilter = existingFilters.find((filter: any) => filter.name === 'Heute');\n        if (heuteFilter && heuteFilter.conditions.length > 0) {\n          const condition = heuteFilter.conditions[0];\n          // Prfe ob es ein statisches Datum ist (Format: YYYY-MM-DD) anstatt unseres Markers\n          if (condition.value && condition.value !== '__TODAY__' && /^\\d{4}-\\d{2}-\\d{2}$/.test(condition.value)) {\n            console.log('Aktualisiere Heute-Filter mit dynamischem Marker...');\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, {\n              tableId: CONSULTATIONS_TABLE_ID,\n              name: t('consultations.filters.today'),\n              conditions: [\n                { column: 'startTime', operator: 'equals', value: '__TODAY__' }\n              ],\n              operators: []\n            });\n          }\n        }\n\n        // Finde \"Woche\" Filter mit statischen Datums\n        const wocheFilter = existingFilters.find((filter: any) => filter.name === 'Woche');\n        if (wocheFilter && wocheFilter.conditions.length >= 2) {\n          const firstCondition = wocheFilter.conditions[0];\n          const secondCondition = wocheFilter.conditions[1];\n          \n          // Prfe ob es statische Datumsangaben sind\n          const hasStaticDates = (\n            firstCondition.value !== '__TODAY__' && /^\\d{4}-\\d{2}-\\d{2}$/.test(firstCondition.value)\n          ) || (\n            secondCondition.value !== '__WEEK_FROM_TODAY__' && /^\\d{4}-\\d{2}-\\d{2}$/.test(secondCondition.value)\n          );\n\n          if (hasStaticDates) {\n            console.log('Aktualisiere Woche-Filter mit dynamischen Markern...');\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, {\n              tableId: CONSULTATIONS_TABLE_ID,\n              name: t('consultations.filters.week'),\n              conditions: [\n                { column: 'startTime', operator: 'after', value: '__TODAY__' },\n                { column: 'startTime', operator: 'before', value: '__WEEK_FROM_TODAY__' }\n              ],\n              operators: ['AND']\n            });\n          }\n        }\n      } catch (error) {\n        console.error('Fehler beim Aktualisieren bestehender Filter:', error);\n      }\n    };\n\n    // Nach kurzer Verzgerung ausfhren, damit die Standard-Filter-Erstellung abgeschlossen ist\n    const timeoutId = setTimeout(() => {\n      updateExistingFilters();\n    }, 1000);\n\n    return () => clearTimeout(timeoutId);\n  }, []); // Nur einmal beim ersten Laden\n\n  // Separater Effect fr Client-Filter-Management\n  useEffect(() => {\n    const updateClientFilters = async () => {\n      if (recentClients.length === 0) return; // Warte bis Recent Clients geladen sind\n      \n      try {\n        const token = localStorage.getItem('token');\n        if (!token) return;\n\n        // Hole aktuelle Filter\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const existingFilters = response.data;\n\n        // Finde alle bestehenden Client-Filter (alle Filter auer den Standard-Filtern)\n        const existingClientFilters = existingFilters.filter((filter: any) => \n          ![t('consultations.filters.archive'), t('consultations.filters.today'), t('consultations.filters.week')].includes(filter.name)\n        );\n        \n        // Aktuelle Recent Client Namen\n        const currentRecentClientNames = recentClients.map(client => client.name);\n        \n        // Lsche veraltete Client-Filter (die nicht mehr in Recent Clients sind)\n        for (const existingFilter of existingClientFilters) {\n          if (!currentRecentClientNames.includes(existingFilter.name)) {\n            try {\n              await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(existingFilter.id));\n              console.log(`Veralteter Client-Filter gelscht: ${existingFilter.name}`);\n            } catch (error) {\n              console.error(`Fehler beim Lschen des veralteten Client-Filters ${existingFilter.name}:`, error);\n            }\n          }\n        }\n        \n        // Erstelle neue Client-Filter fr aktuelle Recent Clients\n        for (const client of recentClients) {\n          const clientFilterName = client.name;\n          const clientFilterExists = existingFilters.some((filter: any) => filter.name === clientFilterName);\n          \n          if (!clientFilterExists) {\n            const clientFilter = {\n              tableId: CONSULTATIONS_TABLE_ID,\n              name: clientFilterName,\n              conditions: [\n                { column: 'client', operator: 'equals', value: client.name }\n              ],\n              operators: []\n            };\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, clientFilter);\n            console.log(`Neuer Client-Filter erstellt: ${clientFilterName}`);\n          }\n        }\n      } catch (error) {\n        console.error('Fehler beim Aktualisieren der Client-Filter:', error);\n      }\n    };\n\n    // Debounce um Race Conditions zu vermeiden\n    const timeoutId = setTimeout(() => {\n      updateClientFilters();\n    }, 500);\n\n    return () => clearTimeout(timeoutId);\n  }, [recentClients]);\n\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n  };\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  const updateNotes = async (consultationId: number, notes: string) => {\n    try {\n      await consultationApi.updateConsultationNotes(consultationId, { notes });\n      setConsultations(prev => \n        prev.map(consultation => \n          consultation.id === consultationId \n            ? { ...consultation, notes }\n            : consultation\n        )\n      );\n      toast.success(t('consultations.notesUpdated'));\n    } catch (error) {\n      console.error('Fehler beim Aktualisieren der Notizen:', error);\n      toast.error(t('consultations.notesUpdateError'));\n    }\n  };\n\n  const handleNotesEdit = (consultation: Consultation) => {\n    setEditingNotesId(consultation.id);\n    setEditingNotes(consultation.notes || '');\n  };\n\n  const handleNotesSave = (consultationId: number) => {\n    updateNotes(consultationId, editingNotes);\n    setEditingNotesId(null);\n  };\n\n  const handleNotesCancel = () => {\n    setEditingNotesId(null);\n    setEditingNotes('');\n  };\n\n  const handleTimeEdit = (consultation: Consultation, timeType: 'startTime' | 'endTime') => {\n    setEditingTimeId(consultation.id);\n    setEditingTimeType(timeType);\n    const currentTime = timeType === 'startTime' ? consultation.startTime : consultation.endTime;\n    if (currentTime) {\n      /* TIMEZONE-PROBLEM BEHOBEN:\n       * \n       * PROBLEM: Doppelte Timezone-Konvertierung!\n       * - DB-Zeit: \"2025-05-31T11:35:33.542Z\" (UTC)\n       * - new Date() konvertiert automatisch: 11:35 UTC  06:35 lokale Zeit\n       * - getTimezoneOffset-Addition: 06:35 + 5h = 11:35 lokale Zeit\n       * - Aber datetime-local zeigt: 16:35 (FALSCH!)\n       * \n       * LSUNG: UTC-Zeit direkt verwenden ohne zustzliche Konvertierung\n       * - DB-Zeit \"11:35 UTC\" soll im Input als \"11:35\" angezeigt werden\n       * - Keine getTimezoneOffset-Addition ntig!\n       */\n      \n      //  KORREKT: Direkte UTC-Zeit-Nutzung ohne doppelte Konvertierung\n      const dbTime = new Date(currentTime);\n      \n      // Verwende die UTC-Komponenten direkt fr datetime-local Input\n      const year = dbTime.getUTCFullYear();\n      const month = String(dbTime.getUTCMonth() + 1).padStart(2, '0');\n      const day = String(dbTime.getUTCDate()).padStart(2, '0');\n      const hours = String(dbTime.getUTCHours()).padStart(2, '0');\n      const minutes = String(dbTime.getUTCMinutes()).padStart(2, '0');\n      \n      const inputValue = `${year}-${month}-${day}T${hours}:${minutes}`;\n      \n      console.log(' DEBUG handleTimeEdit (KORRIGIERT):');\n      console.log('- DB Zeit (UTC):', currentTime);\n      console.log('- Extrahierte UTC-Komponenten:', `${hours}:${minutes}`);\n      console.log('- inputValue fr datetime-local:', inputValue);\n      \n      setEditingTimeValue(inputValue);\n    }\n  };\n\n  /* CLAUDE-ANCHOR: CONSULTATION-TIME-SAVE-001 - Timezone-sichere Zeitspeicherung */\n  const handleTimeSave = async (consultationId: number) => {\n    if (!editingTimeType || !editingTimeValue) return;\n    \n    try {\n      /* KONSISTENTE API-ARCHITEKTUR:\n       * Verwende die zentralisierte consultationApi.updateConsultationTime Funktion\n       * anstatt direkter axiosInstance Calls fr bessere Wartbarkeit und Testbarkeit\n       */\n      \n      //  KORREKT: Datetime-local Input direkt als UTC verwenden\n      const timeString = `${editingTimeValue}:00.000Z`;  // \"2025-05-31T11:35:00.000Z\"\n      \n      console.log(' DEBUG handleTimeSave (REFACTORED):');\n      console.log('- editingTimeValue (Input):', editingTimeValue);\n      console.log('- timeString fr API (UTC):', timeString);\n      console.log('- editingTimeType:', editingTimeType);\n      \n      //  REFACTORED: Verwende zentralisierte API-Funktion\n      const response = await consultationApi.updateConsultationTime(consultationId, {\n        [editingTimeType]: timeString\n      });\n      \n      setConsultations(prev => \n        prev.map(consultation => \n          consultation.id === consultationId \n            ? { ...consultation, [editingTimeType]: timeString }\n            : consultation\n        )\n      );\n      \n      toast.success(t('consultations.timeUpdated'));\n      setEditingTimeId(null);\n      setEditingTimeType(null);\n      setEditingTimeValue('');\n    } catch (error: any) {\n      console.error('Fehler beim Aktualisieren der Zeit:', error);\n      toast.error(`${t('consultations.timeUpdateError')}: ${error.response?.data?.message || error.message}`);\n    }\n  };\n\n  const handleTimeCancel = () => {\n    setEditingTimeId(null);\n    setEditingTimeType(null);\n    setEditingTimeValue('');\n  };\n\n  const handleLinkTask = (consultationId: number) => {\n    setSelectedConsultationId(consultationId);\n    setLinkTaskModalOpen(true);\n  };\n\n  const handleTaskLinked = (consultationId: number) => {\n    // Nach Task-Link: Lade nur die betroffene Consultation neu\n    // Fr jetzt: Reload der betroffenen Consultation (spter knnte optimiert werden)\n    loadConsultations();\n    onConsultationChange?.();\n  };\n\n  // Prfung ob Rechnung erstellt werden kann\n  const canCreateInvoice = () => {\n    // Prfe zuerst die Berechtigung\n    const canCreate = hasPermission('invoice_create', 'write', 'button');\n    if (!canCreate) return false;\n    \n    const hasConsultations = filteredConsultations.length > 0;\n    if (!hasConsultations) return false;\n    \n    // Filter mssen aktiv sein (auer Standard-Filter)\n    const hasActiveFilters = filterConditions.length > 0 || searchTerm.trim() !== '';\n    if (!hasActiveFilters) return false;\n    \n    // Alle Beratungen mssen abgeschlossen sein (endTime vorhanden)\n    const allCompleted = filteredConsultations.every(c => c.endTime);\n    if (!allCompleted) return false;\n    \n    // Keine bereits abgerechneten Beratungen\n    const hasInvoicedConsultations = filteredConsultations.some(c => isConsultationInvoiced(c));\n    if (hasInvoicedConsultations) return false;\n    \n    return true;\n  };\n\n  const handleCreateInvoice = () => {\n    setShowCreateInvoiceModal(true);\n  };\n\n  const handleDeleteConsultation = async (consultationId: number) => {\n    // Besttigungsdialog\n    if (!window.confirm(t('consultations.confirmDelete'))) {\n      return;\n    }\n\n    try {\n      await consultationApi.deleteConsultation(consultationId);\n      \n      // Entferne die Beratung aus der lokalen Liste\n      setConsultations(prev => prev.filter(consultation => consultation.id !== consultationId));\n      \n      toast.success(t('consultations.deleteSuccess'));\n      \n      // Informiere die bergeordnete Komponente ber die nderung\n      onConsultationChange?.();\n    } catch (error: any) {\n      console.error('Fehler beim Lschen der Beratung:', error);\n      const errorMessage = error.response?.data?.message || t('consultations.deleteError');\n      toast.error(errorMessage);\n    }\n  };\n\n  const applyFiltersAndSearch = useCallback((consultations: Consultation[]) => {\n    let filtered = consultations;\n\n    // Suchterm-Filter\n    if (searchTerm) {\n      const search = searchTerm.toLowerCase();\n      filtered = filtered.filter(consultation => \n        consultation.client?.name?.toLowerCase().includes(search) ||\n        consultation.notes?.toLowerCase().includes(search) ||\n        consultation.branch?.name?.toLowerCase().includes(search)\n      );\n    }\n\n    // Erweiterte Filter\n    if (filterConditions.length > 0) {\n      filtered = filtered.filter((consultation) => {\n        let result = true;\n        \n        for (let i = 0; i < filterConditions.length; i++) {\n          const condition = filterConditions[i];\n          let conditionResult = false;\n          \n          switch (condition.column) {\n            case 'client':\n              conditionResult = consultation.client?.name?.toLowerCase().includes(String(condition.value).toLowerCase()) || false;\n              break;\n            case 'branch':\n              conditionResult = consultation.branch?.name?.toLowerCase().includes(String(condition.value).toLowerCase()) || false;\n              break;\n            case 'notes':\n              conditionResult = consultation.notes?.toLowerCase().includes(String(condition.value).toLowerCase()) || false;\n              break;\n            case 'startTime':\n              const consultationDate = new Date(consultation.startTime).toISOString().split('T')[0];\n              let filterDate = String(condition.value);\n              \n              // Dynamische Datums-Marker verarbeiten\n              if (filterDate === '__TODAY__') {\n                //  KORREKT: Lokale Zeit verwenden (Timezone-Dokumentation befolgen)\n                const localToday = new Date();\n                const correctedToday = new Date(localToday.getTime() - localToday.getTimezoneOffset() * 60000);\n                filterDate = correctedToday.toISOString().split('T')[0];\n              } else if (filterDate === '__WEEK_FROM_TODAY__') {\n                //  KORREKT: Lokale Zeit verwenden (Timezone-Dokumentation befolgen)\n                const localToday = new Date();\n                const correctedToday = new Date(localToday.getTime() - localToday.getTimezoneOffset() * 60000);\n                const weekFromToday = new Date(correctedToday);\n                weekFromToday.setDate(correctedToday.getDate() + 7); // Heute + 7 Tage\n                filterDate = weekFromToday.toISOString().split('T')[0];\n              }\n              \n              switch (condition.operator) {\n                case 'after':\n                  conditionResult = consultationDate >= filterDate;\n                  break;\n                case 'before':\n                  conditionResult = consultationDate < filterDate;\n                  break;\n                case 'equals':\n                  conditionResult = consultationDate === filterDate;\n                  break;\n                default:\n                  conditionResult = false;\n              }\n              break;\n            case 'duration':\n              const duration = calculateDurationInMinutes(consultation.startTime, consultation.endTime);\n              const filterValue = Number(condition.value) * 60; // Convert hours to minutes\n              switch (condition.operator) {\n                case 'greater_than':\n                  conditionResult = duration > filterValue;\n                  break;\n                case 'less_than':\n                  conditionResult = duration < filterValue;\n                  break;\n                case 'equals':\n                  conditionResult = Math.abs(duration - filterValue) < 30; // 30-minute tolerance\n                  break;\n                default:\n                  conditionResult = false;\n              }\n              break;\n            case 'invoiceStatus':\n              const isInvoiced = isConsultationInvoiced(consultation);\n              const isInMonthlyReport = isConsultationInMonthlyReport(consultation);\n              const filterValueLower = String(condition.value).toLowerCase();\n              \n              if (filterValueLower === 'abgerechnet' || filterValueLower === 'invoiced' || filterValueLower === 'ja') {\n                conditionResult = isInvoiced || isInMonthlyReport;\n              } else if (filterValueLower === 'nicht abgerechnet' || filterValueLower === 'not invoiced' || filterValueLower === 'nein') {\n                conditionResult = !isInvoiced && !isInMonthlyReport;\n              } else if (filterValueLower === 'einzelrechnung' || filterValueLower === 'invoice') {\n                conditionResult = isInvoiced;\n              } else if (filterValueLower === 'monatsbericht' || filterValueLower === 'monthly report') {\n                conditionResult = isInMonthlyReport;\n              } else {\n                // Exact status match wenn ein spezifischer Status eingegeben wurde\n                if (isInvoiced) {\n                  const invoiceInfo = getConsultationInvoiceInfo(consultation);\n                  const statusText = invoiceInfo ? getInvoiceStatusText(invoiceInfo.status as any).toLowerCase() : '';\n                  conditionResult = statusText.includes(filterValueLower);\n                } else if (isInMonthlyReport) {\n                  const monthlyReportInfo = getConsultationMonthlyReportInfo(consultation);\n                  if (monthlyReportInfo) {\n                    const statusText = monthlyReportInfo.status === 'GENERATED' ? 'erstellt' : \n                                     monthlyReportInfo.status === 'SENT' ? 'gesendet' : 'archiviert';\n                    conditionResult = statusText.includes(filterValueLower);\n                  } else {\n                    conditionResult = false;\n                  }\n                } else {\n                  conditionResult = false;\n                }\n              }\n              break;\n            default:\n              conditionResult = false;\n          }\n          \n          if (i === 0) {\n            result = conditionResult;\n          } else {\n            const operator = filterLogicalOperators[i - 1];\n            if (operator === 'AND') {\n              result = result && conditionResult;\n            } else {\n              result = result || conditionResult;\n            }\n          }\n        }\n        \n        return result;\n      });\n    }\n\n    return filtered;\n  }, [consultations, searchTerm, filterConditions, filterLogicalOperators]);\n\n  const calculateDurationInMinutes = (startTime: string, endTime: string | null): number => {\n    if (!endTime) return 0;\n    const start = new Date(startTime);\n    const end = new Date(endTime);\n    return (end.getTime() - start.getTime()) / (1000 * 60);\n  };\n\n  // Timeline-Markierungen generieren\n  const generateTimelineMarkers = (consultations: Consultation[]) => {\n    const markers: Array<{\n      id: string;\n      type: 'day' | 'midday';\n      date: string;\n      label: string;\n      position: number; // Index position in der gefilterten Liste\n    }> = [];\n\n    consultations.forEach((consultation, index) => {\n      const currentDate = new Date(consultation.startTime);\n      const currentDay = format(currentDate, 'yyyy-MM-dd', { locale: de });\n      const currentHour = currentDate.getUTCHours(); // UTC verwenden statt getHours()\n      \n      // Prfe vorherige Beratung fr Tagesbergang\n      if (index > 0) {\n        const prevDate = new Date(consultations[index - 1].startTime);\n        const prevDay = format(prevDate, 'yyyy-MM-dd', { locale: de });\n        \n        if (currentDay !== prevDay) {\n          markers.push({\n            id: `day-${currentDay}`,\n            type: 'day',\n            date: currentDay,\n            label: format(currentDate, 'EEE, dd.MM.', { locale: de }),\n            position: index\n          });\n        }\n      } else if (index === 0) {\n        // Erste Beratung bekommt immer eine Tagesmarkierung\n        markers.push({\n          id: `day-${currentDay}`,\n          type: 'day', \n          date: currentDay,\n          label: format(currentDate, 'EEE, dd.MM.', { locale: de }),\n          position: index\n        });\n      }\n\n      // Prfe fr Mittag-Markierung (12:00 bergang) - jetzt mit UTC\n      if (index > 0) {\n        const prevDate = new Date(consultations[index - 1].startTime);\n        const prevHour = prevDate.getUTCHours(); // UTC verwenden statt getHours()\n        const prevDay = format(prevDate, 'yyyy-MM-dd', { locale: de });\n        \n        // Mittag-Markierung nur wenn am gleichen Tag und bergang ber 12:00 UTC\n        if (currentDay === prevDay && prevHour < 12 && currentHour >= 12) {\n          markers.push({\n            id: `midday-${currentDay}`,\n            type: 'midday',\n            date: currentDay,\n            label: t('consultations.midday'),\n            position: index\n          });\n        }\n      }\n    });\n\n    return markers;\n  };\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const filteredConsultations = useMemo(() => {\n    return applyFiltersAndSearch(consultations).sort((a, b) => {\n      return new Date(a.startTime).getTime() - new Date(b.startTime).getTime();\n    });\n  }, [consultations, filterConditions, filterLogicalOperators]);\n\n  // Total-Dauer aller sichtbaren Beratungen berechnen\n  const totalDuration = useMemo(() => {\n    return formatTotalDuration(filteredConsultations);\n  }, [filteredConsultations]);\n\n  // Timeline-Markierungen berechnen\n  const timelineMarkers = useMemo(() => {\n    return generateTimelineMarkers(filteredConsultations);\n  }, [filteredConsultations]);\n\n  // Helper function to check if consultation is billed in monthly report\n  const isConsultationInMonthlyReport = (consultation: Consultation): boolean => {\n    return consultation.monthlyReportId !== null && consultation.monthlyReportId !== undefined;\n  };\n\n  // Helper function to get monthly report info\n  const getConsultationMonthlyReportInfo = (consultation: Consultation) => {\n    return consultation.monthlyReport;\n  };\n\n  // Helper function to get the billing status\n  const getConsultationBillingStatus = (consultation: Consultation) => {\n    const isInvoiced = isConsultationInvoiced(consultation);\n    const isInMonthlyReport = isConsultationInMonthlyReport(consultation);\n    \n    if (isInvoiced) {\n      const invoiceInfo = getConsultationInvoiceInfo(consultation);\n      return {\n        type: 'invoice' as const,\n        status: t('consultations.invoice'),\n        info: invoiceInfo\n      };\n    } else if (isInMonthlyReport) {\n      const monthlyReportInfo = getConsultationMonthlyReportInfo(consultation);\n      return {\n        type: 'monthly' as const,\n        status: t('consultations.monthlyReport'),\n        info: monthlyReportInfo\n      };\n    }\n    \n    return null;\n  };\n\n  // Navigation functions\n  const navigateToMonthlyReports = (reportId?: number) => {\n    const url = reportId \n      ? `/payroll?tab=monthly-reports&reportId=${reportId}`\n      : '/payroll?tab=monthly-reports';\n    navigate(url);\n  };\n\n  const navigateToInvoices = (invoiceId?: number) => {\n    const url = invoiceId \n      ? `/payroll?tab=invoices&invoiceId=${invoiceId}`\n      : '/payroll?tab=invoices';\n    navigate(url);\n  };\n\n  const navigateToTask = (taskId: number) => {\n    navigate(`/worktracker?editTask=${taskId}`);\n  };\n\n  if (loading) return <div className=\"p-4\">{t('common.loading')}</div>;\n  if (error) return <div className=\"p-4 text-red-600\">{error}</div>;\n\n  return (\n    <>\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        {/* Header */}\n        <div className=\"flex items-center mb-6 justify-between px-2 sm:px-0\">\n          <div className=\"flex items-center\">\n            <ClockIcon className=\"h-6 w-6 mr-2 dark:text-white\" />\n            <div>\n              <h2 className=\"text-xl font-semibold dark:text-white\">{t('consultations.listTitle')}</h2>\n              {/* Total-Anzeige */}\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-0.5\">\n                {t('consultations.count', { count: filteredConsultations.length })} - {t('consultations.total')}: {totalDuration}\n              </p>\n            </div>\n          </div>\n          \n          <div className=\"flex items-center gap-1.5\">\n            <input\n              type=\"text\"\n              placeholder={t('common.searchPlaceholder')}\n              className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n            \n            <button\n              className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} ml-1 relative`}\n              onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n              title={t('consultations.advancedFilters')}\n            >\n              <FunnelIcon className=\"h-5 w-5\" />\n              {getActiveFilterCount() > 0 && (\n                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                  {getActiveFilterCount()}\n                </span>\n              )}\n            </button>\n\n            {/* Rechnung erstellen Button */}\n            {canCreateInvoice() && (\n              <button\n                onClick={handleCreateInvoice}\n                className=\"p-2 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors ml-2\"\n                title={t('consultations.createInvoiceFromFiltered')}\n              >\n                <DocumentTextIcon className=\"h-5 w-5\" />\n              </button>\n            )}\n          </div>\n        </div>\n\n        {/* Filter-Pane */}\n        {isFilterPanelOpen && (\n          <div className=\"px-2 sm:px-0\">\n            <FilterPane\n              columns={[\n                { id: 'client', label: t('consultations.columns.client') },\n                { id: 'branch', label: t('consultations.columns.branch') },\n                { id: 'notes', label: t('consultations.columns.notes') },\n                { id: 'startTime', label: t('consultations.columns.date') },\n                { id: 'duration', label: t('consultations.columns.durationHours') },\n                { id: 'invoiceStatus', label: t('consultations.columns.invoiceStatus') }\n              ]}\n              onApply={applyFilterConditions}\n              onReset={resetFilterConditions}\n              savedConditions={filterConditions}\n              savedOperators={filterLogicalOperators}\n              tableId={CONSULTATIONS_TABLE_ID}\n            />\n          </div>\n        )}\n        \n        {/* Gespeicherte Filter als Tags anzeigen */}\n        <div className=\"px-2 sm:px-0\">\n          <SavedFilterTags\n            tableId={CONSULTATIONS_TABLE_ID}\n            onSelectFilter={applyFilterConditions}\n            onReset={resetFilterConditions}\n            activeFilterName={activeFilterName}\n            selectedFilterId={selectedFilterId}\n            onFilterChange={handleFilterChange}\n          />\n        </div>\n\n        {/* Timeline + Cards Layout */}\n        <div className=\"space-y-0.5 sm:space-y-1\">\n          {filteredConsultations.length === 0 ? (\n            <div className=\"text-center py-12 px-2 sm:px-0\">\n              <ClockIcon className=\"h-12 w-12 text-gray-400 dark:text-gray-500 mx-auto mb-4\" />\n              <div>\n                <p className=\"font-medium text-gray-900 dark:text-white\">{t('consultations.noConsultationsFound')}</p>\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                  {searchTerm || filterConditions.length > 0\n                    ? t('consultations.tryOtherFilters')\n                    : t('consultations.noConsultationsYet')}\n                </p>\n              </div>\n            </div>\n          ) : (\n            filteredConsultations.map((consultation, index) => {\n              const dayMarker = timelineMarkers.find(m => m.type === 'day' && m.position === index);\n              const middayMarker = timelineMarkers.find(m => m.type === 'midday' && m.position === index);\n              \n              return (\n                <div key={consultation.id} className=\"relative\">\n                  {/* Tagesmarkierung ber der Card */}\n                  {dayMarker && (\n                    <div className=\"flex items-center mb-3 px-2 sm:px-0\">\n                      <div className=\"flex items-center\">\n                        <div className=\"w-3 h-3 rounded-full bg-blue-500 dark:bg-blue-400 border-2 border-white dark:border-gray-800\"></div>\n                        <div className=\"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300\">\n                          {dayMarker.label}\n                        </div>\n                      </div>\n                      <div className=\"flex-1 ml-4 h-px bg-gray-200 dark:bg-gray-600\"></div>\n                    </div>\n                  )}\n                  \n                  {/* Mittag-Markierung */}\n                  {middayMarker && (\n                    <div className=\"flex items-center mb-3 px-2 sm:px-0\">\n                      <div className=\"flex items-center\">\n                        <div className=\"w-1.5 h-1.5 rounded-full bg-gray-400 dark:bg-gray-500\"></div>\n                        <div className=\"ml-3 text-xs text-gray-500 dark:text-gray-400\">\n                          {middayMarker.label}\n                        </div>\n                      </div>\n                      <div className=\"flex-1 ml-4 h-px bg-gray-300 dark:bg-gray-600\"></div>\n                    </div>\n                  )}\n\n                  {/* Card ohne Timeline-Punkt */}\n                  <div className=\"bg-white dark:bg-gray-800 shadow rounded-lg md:border md:border-gray-200 md:dark:border-gray-700 hover:shadow-md transition-shadow\">\n                    {/* Card Content - 1/3 left, 2/3 right auf allen Bildschirmgren */}\n                    <div className=\"p-4\">\n                      <div className=\"grid grid-cols-3 gap-4\">\n                        {/* Left: Compact Info - 1/3 auf allen Bildschirmgren */}\n                        <div className=\"col-span-1 space-y-3\">\n                          {/* Client Header */}\n                          <div className=\"flex items-center space-x-2\">\n                            <div className=\"min-w-0 flex-1\">\n                              <h3 className=\"font-medium text-gray-900 dark:text-white text-sm truncate\">\n                                {consultation.client?.name}\n                              </h3>\n                              {consultation.client?.company && (\n                                <p className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">\n                                  {consultation.client.company}\n                                </p>\n                              )}\n                            </div>\n                          </div>\n\n                          {/* Billing Status Indicator */}\n                          {(() => {\n                            const billingStatus = getConsultationBillingStatus(consultation);\n                            \n                            if (billingStatus) {\n                              if (billingStatus.type === 'invoice') {\n                                // Individual invoice\n                                return (\n                                  <div className=\"flex items-center space-x-2\">\n                                    <div className=\"flex items-center space-x-1\">\n                                      <DocumentTextIcon className=\"h-4 w-4 text-green-600 dark:text-green-400\" />\n                                      <button \n                                        onClick={() => navigateToInvoices(billingStatus.info?.id)}\n                                        className=\"text-xs text-green-700 dark:text-green-400 font-medium hover:underline cursor-pointer\"\n                                      >\n                                        {t('consultations.invoice')}\n                                      </button>\n                                    </div>\n                                    {billingStatus.info && 'invoiceNumber' in billingStatus.info && (\n                                      <div className=\"flex items-center space-x-1\">\n                                        <button\n                                          onClick={() => navigateToInvoices(billingStatus.info?.id)}\n                                          className={`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium hover:opacity-80 cursor-pointer ${getInvoiceStatusColor(billingStatus.info.status as any)}`}\n                                          title={`Rechnung ${billingStatus.info.invoiceNumber} vom ${format(new Date(billingStatus.info.issueDate), 'dd.MM.yyyy', { locale: de })}`}\n                                        >\n                                          {getInvoiceStatusText(billingStatus.info.status as any)}\n                                        </button>\n                                      </div>\n                                    )}\n                                  </div>\n                                );\n                              } else if (billingStatus.type === 'monthly') {\n                                // Monthly report\n                                return (\n                                  <div className=\"flex items-center space-x-2\">\n                                    <div className=\"flex items-center space-x-1\">\n                                      <ChartBarIcon className=\"h-4 w-4 text-green-600 dark:text-green-400\" />\n                                      <button \n                                        onClick={() => navigateToMonthlyReports(billingStatus.info?.id)}\n                                        className=\"text-xs text-green-700 dark:text-green-400 font-medium hover:underline cursor-pointer\"\n                                      >\n                                        {t('consultations.monthlyReport')}\n                                      </button>\n                                    </div>\n                                    {billingStatus.info && 'reportNumber' in billingStatus.info && (\n                                      <div className=\"flex items-center space-x-1\">\n                                        <button \n                                          onClick={() => navigateToMonthlyReports(billingStatus.info?.id)}\n                                          className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300 hover:opacity-80 cursor-pointer\"\n                                          title={`Monatsbericht ${billingStatus.info.reportNumber}`}\n                                        >\n                                          {billingStatus.info.status === 'GENERATED' ? t('analytics.monthlyReports.status.generated') : \n                                           billingStatus.info.status === 'SENT' ? t('analytics.monthlyReports.status.sent') : t('analytics.monthlyReports.status.archived')}\n                                        </button>\n                                      </div>\n                                    )}\n                                  </div>\n                                );\n                              }\n                            }\n                            \n                            return null;\n                          })()}\n\n                          {/* Time Range - Single compact field */}\n                          <div>\n                            <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">{t('consultations.columns.time')}</p>\n                            <div className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                              {editingTimeId === consultation.id && editingTimeType === 'startTime' ? (\n                                <div className=\"flex items-center space-x-1\">\n                                  <input\n                                    type=\"datetime-local\"\n                                    value={editingTimeValue}\n                                    onChange={(e) => setEditingTimeValue(e.target.value)}\n                                    className=\"text-xs rounded border-gray-300 dark:border-gray-600 dark:bg-gray-700 w-full\"\n                                  />\n                                  <button\n                                    onClick={() => handleTimeSave(consultation.id)}\n                                    className=\"p-0.5 text-green-600 hover:text-green-700\"\n                                    title={t('common.save')}\n                                  >\n                                    <svg className=\"h-3 w-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                                    </svg>\n                                  </button>\n                                  <button\n                                    onClick={handleTimeCancel}\n                                    className=\"p-0.5 text-red-600 hover:text-red-700\"\n                                    title={t('common.cancel')}\n                                  >\n                                    <XMarkIcon className=\"h-3 w-3\" />\n                                  </button>\n                                </div>\n                              ) : editingTimeId === consultation.id && editingTimeType === 'endTime' ? (\n                                <div className=\"flex items-center space-x-1\">\n                                  <input\n                                    type=\"datetime-local\"\n                                    value={editingTimeValue}\n                                    onChange={(e) => setEditingTimeValue(e.target.value)}\n                                    className=\"text-xs rounded border-gray-300 dark:border-gray-600 dark:bg-gray-700 w-full\"\n                                  />\n                                  <button\n                                    onClick={() => handleTimeSave(consultation.id)}\n                                    className=\"p-0.5 text-green-600 hover:text-green-700\"\n                                    title={t('common.save')}\n                                  >\n                                    <svg className=\"h-3 w-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                                    </svg>\n                                  </button>\n                                  <button\n                                    onClick={handleTimeCancel}\n                                    className=\"p-0.5 text-red-600 hover:text-red-700\"\n                                    title={t('common.cancel')}\n                                  >\n                                    <XMarkIcon className=\"h-3 w-3\" />\n                                  </button>\n                                </div>\n                              ) : (\n                                <div className=\"flex items-center space-x-1\">\n                                  <button\n                                    onClick={() => handleTimeEdit(consultation, 'startTime')}\n                                    className=\"text-blue-600 hover:text-blue-700 dark:text-blue-400 hover:underline\"\n                                  >\n                                    {formatTime(consultation.startTime)}\n                                  </button>\n                                  <span className=\"text-gray-400\">-</span>\n                                  {consultation.endTime ? (\n                                    <button\n                                      onClick={() => handleTimeEdit(consultation, 'endTime')}\n                                      className=\"text-blue-600 hover:text-blue-700 dark:text-blue-400 hover:underline\"\n                                    >\n                                      {formatTime(consultation.endTime)}\n                                    </button>\n                                  ) : (\n                                    <div className=\"flex items-center\">\n                                      <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full mr-1 animate-pulse\"></div>\n                                      <span className=\"text-green-600 dark:text-green-400 text-xs\">{t('consultations.active')}</span>\n                                    </div>\n                                  )}\n                                </div>\n                              )}\n                            </div>\n                          </div>\n\n                          {/* Duration */}\n                          <div>\n                            <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">{t('consultations.columns.duration')}</p>\n                            <p className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                              {calculateDuration(consultation.startTime, consultation.endTime)}\n                            </p>\n                          </div>\n\n                          {/* Tasks - Compact */}\n                          {consultation.taskLinks && consultation.taskLinks.length > 0 && (\n                            <div>\n                              <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                {t('consultations.tasks', { count: consultation.taskLinks.length })}\n                              </p>\n                              <div className=\"space-y-1\">\n                                {consultation.taskLinks.slice(0, 2).map((taskLink) => (\n                                  <button\n                                    key={taskLink.id}\n                                    onClick={() => navigateToTask(taskLink.task.id)}\n                                    className=\"flex items-center text-xs text-blue-700 dark:text-blue-300 bg-blue-50 dark:bg-blue-900/20 rounded px-2 py-1 hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors cursor-pointer w-full text-left\"\n                                  >\n                                    <LinkIcon className=\"h-3 w-3 mr-1 flex-shrink-0\" />\n                                    <span className=\"truncate\">{taskLink.task.title}</span>\n                                  </button>\n                                ))}\n                                {consultation.taskLinks.length > 2 && (\n                                  <button\n                                    onClick={() => {\n                                      // Navigate to first task if more than 2 tasks\n                                      if (consultation.taskLinks && consultation.taskLinks.length > 0) {\n                                        navigateToTask(consultation.taskLinks[0].task.id);\n                                      }\n                                    }}\n                                    className=\"text-xs text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 cursor-pointer\"\n                                  >\n                                    {t('consultations.moreTasks', { count: consultation.taskLinks.length - 2 })}\n                                  </button>\n                                )}\n                              </div>\n                            </div>\n                          )}\n                        </div>\n\n                        {/* Right: Notes - 2/3 auf allen Bildschirmgren */}\n                        <div className=\"col-span-2 relative\">\n                          {/* Action Icons in der rechten oberen Ecke */}\n                          <div className=\"absolute top-0 right-0 flex items-center space-x-1 z-10\">\n                            {hasPermission('consultations', 'write') && (\n                              <button\n                                onClick={() => handleLinkTask(consultation.id)}\n                                className=\"p-1 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 rounded\"\n                                title={t('consultations.linkTask')}\n                              >\n                                <LinkIcon className=\"h-4 w-4\" />\n                              </button>\n                            )}\n                            {hasPermission('consultations', 'write') && consultation.endTime && (\n                              <button\n                                onClick={() => handleDeleteConsultation(consultation.id)}\n                                className=\"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400 rounded\"\n                                title={t('consultations.delete')}\n                              >\n                                <TrashIcon className=\"h-4 w-4\" />\n                              </button>\n                            )}\n                          </div>\n                          \n                          <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2\">{t('consultations.columns.notes')}</p>\n                          {editingNotesId === consultation.id ? (\n                            <div className=\"space-y-2\">\n                              <textarea\n                                value={editingNotes}\n                                onChange={(e) => setEditingNotes(e.target.value)}\n                                className=\"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm resize-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n                                rows={3}\n                                placeholder={t('consultations.notesPlaceholder')}\n                              />\n                              <div className=\"flex justify-end space-x-2\">\n                                <button\n                                  onClick={handleNotesCancel}\n                                  className=\"p-1.5 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                  title={t('common.cancel')}\n                                >\n                                  <XMarkIcon className=\"h-4 w-4\" />\n                                </button>\n                                <button\n                                  onClick={() => handleNotesSave(consultation.id)}\n                                  className=\"p-1.5 bg-blue-600 text-white hover:bg-blue-700 rounded-md\"\n                                  title={t('common.save')}\n                                >\n                                  <CheckIcon className=\"h-4 w-4\" />\n                                </button>\n                              </div>\n                            </div>\n                          ) : (\n                            <div \n                              className=\"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded p-2 min-h-[60px] border border-dashed border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 transition-colors\"\n                              onClick={() => handleNotesEdit(consultation)}\n                            >\n                              {consultation.notes ? (\n                                <p className=\"text-sm text-gray-900 dark:text-white whitespace-pre-wrap leading-relaxed\">\n                                  {consultation.notes}\n                                </p>\n                              ) : (\n                                <div className=\"flex items-center justify-center h-full text-center\">\n                                  <span className=\"text-xs text-gray-400 dark:text-gray-500\">\n                                    {t('consultations.addNotes')}\n                                  </span>\n                                </div>\n                              )}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              );\n            })\n          )}\n        </div>\n      </div>\n\n      {/* Link Task Modal */}\n      {linkTaskModalOpen && selectedConsultationId && (\n        <LinkTaskModal\n          isOpen={linkTaskModalOpen}\n          onClose={() => {\n            setLinkTaskModalOpen(false);\n            setSelectedConsultationId(null);\n          }}\n          consultationId={selectedConsultationId}\n          onTaskLinked={handleTaskLinked}\n        />\n      )}\n\n      {/* Create Invoice Modal */}\n      {showCreateInvoiceModal && (\n        <CreateInvoiceModal\n          isOpen={showCreateInvoiceModal}\n          onClose={() => setShowCreateInvoiceModal(false)}\n          consultations={filteredConsultations}\n          onInvoiceCreated={(invoiceId) => {\n            setShowCreateInvoiceModal(false);\n            // Nach Rechnungserstellung: Markiere betroffene Consultations als abgerechnet\n            // Fr jetzt: Reload der Liste (spter knnte optimiert werden)\n            loadConsultations();\n            toast.success(t('consultations.invoiceCreated'));\n          }}\n        />\n      )}\n    </>\n  );\n});\n\nexport default ConsultationList; ","import React, { useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport ConsultationTracker from '../components/ConsultationTracker.tsx';\nimport ConsultationList, { ConsultationListRef } from '../components/ConsultationList.tsx';\n\nconst Consultations: React.FC = () => {\n  const { t } = useTranslation();\n  const { hasPermission } = usePermissions();\n  const consultationListRef = useRef<ConsultationListRef>(null);\n\n  // Callback-Funktion fr das Neuladen der Beratungsliste (normale Aktionen)\n  const handleConsultationChange = useCallback((consultation?: any) => {\n    if (consultation && consultation.id) {\n      // Wenn eine Consultation bergeben wurde, verwenden wir den imperativen Handle\n      // um die Consultation zur Liste hinzuzufgen oder zu aktualisieren\n      // Prfe: Wenn endTime vorhanden, ist es ein Update (Stop), sonst ein Add (Start)\n      if (consultation.endTime) {\n        // Consultation wurde beendet - Update\n        consultationListRef.current?.updateConsultation?.(consultation);\n      } else {\n        // Consultation wurde gestartet - Add\n        consultationListRef.current?.addConsultation?.(consultation);\n      }\n    } else {\n      // Fallback: Vollstndiges Reload wenn keine Consultation bergeben\n      consultationListRef.current?.refresh();\n    }\n  }, []);\n\n  // Callback-Funktion fr das Starten einer Beratung (Filter wechseln)\n  const handleConsultationStarted = useCallback((clientName: string) => {\n    // Triggert ein Neuladen der Beratungsliste UND wechselt zum Client-Filter\n    consultationListRef.current?.refresh();\n    consultationListRef.current?.activateClientFilter?.(clientName);\n  }, []);\n\n  // Prfe Berechtigungen\n  if (!hasPermission('consultations', 'read')) {\n    return (\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-4\">\n          <div className=\"flex\">\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800 dark:text-red-200\">\n                {t('consultations.noPermission')}\n              </h3>\n              <div className=\"mt-2 text-sm text-red-700 dark:text-red-300\">\n                <p>{t('consultations.noPermissionMessage')}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen dark:bg-gray-900\">\n      <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\n        <div className=\"space-y-6\">\n        {/* Consultation Tracker */}\n        <ConsultationTracker \n          onConsultationChange={handleConsultationChange}\n          onConsultationStarted={handleConsultationStarted}\n        />\n\n        {/* Consultation List */}\n        <ConsultationList \n          ref={consultationListRef}\n          onConsultationChange={handleConsultationChange}\n        />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Consultations; "],"names":["formatDate","dateString","dateParts","split","length","year","parseInt","month","day","Date","toLocaleDateString","error","console","formatTime","date","parseISO","hours","getUTCHours","toString","padStart","minutes","getUTCMinutes","concat","calculateDuration","startTime","endTime","startISOString","endsWith","substring","endISOString","start","durationMs","getTime","durationMinutes","Math","floor","convertWeekToDate","weekString","week","dayOfWeek","UTC","getUTCDay","daysToThursday","firstThursday","targetThursday","getUTCFullYear","getUTCMonth","getUTCDate","monday","formattedDate","format","log","locale","de","warn","correctedMonday","startOfWeek","weekStartsOn","fallbackMonday","isWorktimeRelevantForSelectedDate","worktime","selectedDate","getWeekDays","weekStartDate","weekStart","weekDays","i","addDays","dayInfo","push","formatDateTimeForCerebro","dateTimeString","hour","minute","convertQuinzenaToDate","quinzenaString","quinzena","includes","Error","parts","datePart","ceil","startDay","quinzenaStart","fallback","getQuinzenaDays","quinzenaStartDate","getFullYear","getMonth","daysCount","getDate","quinzenaDays","currentDay","getCurrentQuinzena","today","dateObj","String","getQuinzenaFromDate","createLocalDate","getTimezoneOffset","formatTotalDuration","consultations","totalMinutes","reduce","total","consultation","isConsultationInvoiced","invoiceItems","getConsultationInvoiceInfo","invoice","getInvoiceStatusText","status","getInvoiceStatusColor","deleteClient","async","axiosInstance","delete","API_ENDPOINTS","CLIENTS","BY_ID","clientId","data","getRecentClients","get","RECENT","_ref","isOpen","onClose","onClientUpdated","onClientDeleted","client","t","useTranslation","openSidepane","closeSidepane","useSidepane","isLargeScreen","setIsLargeScreen","useState","window","innerWidth","formData","setFormData","name","company","email","phone","address","notes","isActive","errors","setErrors","loading","setLoading","confirmDelete","setConfirmDelete","isMobile","setIsMobile","useEffect","undefined","checkScreenSize","addEventListener","removeEventListener","handleSubmit","e","preventDefault","validateForm","newErrors","trim","test","Object","keys","updated","put","clientApi","id","toast","success","_error$response","_error$response$data","response","message","handleDelete","_error$response2","_error$response2$data","_error$response3","_error$response3$data","_error$response4","_error$response4$data","_error$response5","errorMessage","errorDetails","details","errorSuggestion","suggestion","entries","filter","_ref2","_","count","map","_ref3","key","join","handleChange","value","type","target","checked","prev","_objectSpread","handleClose","_jsxs","Dialog","open","className","children","_jsx","Panel","Title","onClick","XMarkIcon","onSubmit","htmlFor","onChange","rows","disabled","TrashIcon","title","ArrowPathIcon","CheckIcon","_Fragment","style","opacity","transition","pointerEvents","role","values","idx","onSelect","onCreateNew","clients","setClients","filteredClients","setFilteredClients","searchTerm","setSearchTerm","editingClient","setEditingClient","isEditModalOpen","setIsEditModalOpen","loadClients","filtered","toLowerCase","BASE","MagnifyingGlassIcon","placeholder","autoFocus","PlusIcon","handleEdit","stopPropagation","PencilIcon","confirm","EditClientModal","updatedClient","index","findIndex","c","newClients","onSave","post","startConsultation","CONSULTATIONS","START","stopConsultation","STOP","updateConsultationNotes","consultationId","patch","UPDATE_NOTES","isPlaceholder","_activeConsultation$c","_activeConsultation$c2","onConsultationChange","onConsultationStarted","user","useAuth","selectedBranch","useBranch","activeConsultation","setActiveConsultation","isStarting","setIsStarting","isClientSelectModalOpen","setIsClientSelectModalOpen","isCreateClientModalOpen","setIsCreateClientModalOpen","selectedClient","setSelectedClient","recentClients","setRecentClients","setNotes","lastStartedClientId","setLastStartedClientId","containerRef","useRef","visibleTagCount","setVisibleTagCount","containerWidth","setContainerWidth","resizeTimeoutRef","isManualEntry","setIsManualEntry","manualStartTime","setManualStartTime","manualEndTime","setManualEndTime","checkActiveConsultation","loadRecentClients","WORKTIME","ACTIVE","handleStartConsultation","_consultation$client","correctedStartTime","consultationApi","branchId","toISOString","dispatchEvent","CustomEvent","updateNotes","timeout","setTimeout","clearTimeout","handleFocus","averageTagWidth","useMemo","sum","calculateVisibleTags","useCallback","current","currentWidth","clientWidth","abs","availableWidth","maxPossibleTags","max","min","handleResize","resizeObserver","ResizeObserver","observe","disconnect","useLayoutEffect","showOptimisticTags","optimisticTags","Array","fill","lastConsultationDate","displayTags","currentVisibleCount","sortedDisplayTags","lastStartedClient","find","UserGroupIcon","ClockIcon","onBlur","correctedEndTime","stoppedConsultation","StopIcon","some","ref","width","height","slice","isPlanned","Number","clientName","viewBox","fillRule","d","clipRule","PlayIcon","manualStart","manualEnd","ClientSelectModal","handleCreateClient","CreateClientModal","onTaskLinked","tasks","setTasks","filteredTasks","setFilteredTasks","selectedTaskId","setSelectedTaskId","loadTasks","task","activeTasks","TASKS","responsible","firstName","lastName","LINK_TASK","taskId","invoiceId","invoiceNumber","totalAmount","downloadingPdf","setDownloadingPdf","CheckCircleIcon","CONSULTATION_INVOICES","GENERATE_PDF","responseType","headers","blob","Blob","url","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","DocumentArrowDownIcon","handleViewInvoiceManagement","info","EyeIcon","onInvoiceCreated","hasPermission","usePermissions","settings","setSettings","createdInvoice","setCreatedInvoice","showSuccessModal","setShowSuccessModal","issueDate","dueDate","now","hourlyRate","vatRate","canCreateInvoices","loadInvoiceSettings","settingsData","INVOICE_SETTINGS","defaultHourlyRate","defaultVatRate","totalHours","duration","parseFloat","replace","estimatedTotal","vatAmount","totalWithVat","uniqueClientIds","Set","_consultations$","_consultations$$clien","CREATE_FROM_CONSULTATIONS","consultationIds","toFixed","step","DocumentTextIcon","InvoiceSuccessModal","handleCloseAll","CONSULTATIONS_TABLE_ID","forwardRef","navigate","useNavigate","setConsultations","setError","isFilterPanelOpen","setIsFilterPanelOpen","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","editingNotesId","setEditingNotesId","editingNotes","setEditingNotes","editingTimeId","setEditingTimeId","editingTimeType","setEditingTimeType","editingTimeValue","setEditingTimeValue","linkTaskModalOpen","setLinkTaskModalOpen","selectedConsultationId","setSelectedConsultationId","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","showCreateInvoiceModal","setShowCreateInvoiceModal","loadConsultations","from","to","params","URLSearchParams","append","useImperativeHandle","refresh","addConsultation","updateConsultation","removeConsultation","activateClientFilter","createAndActivateClientFilter","SAVED_FILTERS","BY_TABLE","heuteFilter","applyFilterConditions","conditions","operators","setInitialFilter","clientFilter","newFilter","tableId","column","operator","refreshSavedFilters","localStorage","getItem","existingFilters","alleFilter","dieseWocheFilter","archivFilterExists","heuteFilterExists","wocheFilterExists","nichtAbgerechnetFilterExists","archivFilter","wocheFilter","nichtAbgerechnetFilter","createStandardFilters","timeoutId","condition","firstCondition","secondCondition","updateExistingFilters","existingClientFilters","currentRecentClientNames","existingFilter","clientFilterName","updateClientFilters","resetFilterConditions","getActiveFilterCount","handleNotesSave","handleNotesCancel","handleTimeEdit","timeType","currentTime","dbTime","inputValue","handleTimeSave","timeString","handleTimeCancel","handleDeleteConsultation","applyFiltersAndSearch","search","_consultation$client$","_consultation$notes","_consultation$branch","_consultation$branch$","branch","_consultation$client2","_consultation$client3","_consultation$branch2","_consultation$branch3","_consultation$notes2","result","conditionResult","consultationDate","filterDate","localToday","correctedToday","weekFromToday","setDate","calculateDurationInMinutes","filterValue","isInvoiced","isInMonthlyReport","isConsultationInMonthlyReport","filterValueLower","invoiceInfo","monthlyReportInfo","getConsultationMonthlyReportInfo","filteredConsultations","sort","a","b","totalDuration","timelineMarkers","markers","forEach","currentDate","currentHour","prevDate","label","position","prevHour","generateTimelineMarkers","monthlyReportId","monthlyReport","navigateToMonthlyReports","reportId","navigateToInvoices","navigateToTask","FunnelIcon","canCreateInvoice","every","handleCreateInvoice","FilterPane","columns","onApply","onReset","savedConditions","savedOperators","SavedFilterTags","onSelectFilter","onFilterChange","handleFilterChange","_consultation$client4","_consultation$client5","dayMarker","m","middayMarker","billingStatus","getConsultationBillingStatus","_billingStatus$info","_billingStatus$info2","ChartBarIcon","_billingStatus$info3","_billingStatus$info4","reportNumber","stroke","strokeLinecap","strokeLinejoin","strokeWidth","taskLinks","taskLink","LinkIcon","handleLinkTask","handleNotesEdit","LinkTaskModal","CreateInvoiceModal","Consultations","consultationListRef","handleConsultationChange","_consultationListRef$","_consultationListRef$2","_consultationListRef$3","_consultationListRef$4","_consultationListRef$5","call","handleConsultationStarted","_consultationListRef$6","_consultationListRef$7","_consultationListRef$8","ConsultationTracker","ConsultationList"],"sourceRoot":""}