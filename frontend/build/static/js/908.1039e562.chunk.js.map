{"version":3,"file":"static/js/908.1039e562.chunk.js","mappings":"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","sources":["components/shared/CardGrid.tsx","api/tableSettingsApi.ts","hooks/useTableSettings.ts","utils/filterLogic.ts","components/tours/CreateTourBookingModal.tsx","components/TableColumnConfig.tsx","components/CertificateCreationModal.tsx","components/ContractCreationModal.tsx","components/CertificateEditModal.tsx","components/ContractEditModal.tsx","components/SocialSecurityEditor.tsx","components/OffboardingStartModal.tsx","components/OffboardingCompleteModal.tsx","components/LifecycleView.tsx","components/UserManagementTab.tsx","components/RoleManagementTab.tsx","components/branches/RoomDescriptionsSection.tsx","components/BranchManagementTab.tsx","components/tours/CreateTourProviderModal.tsx","components/tours/EditTourProviderModal.tsx","components/tours/TourProvidersTab.tsx","types/tour.ts","components/tours/CreateTourModal.tsx","components/tours/EditTourModal.tsx","components/tours/TourDetailsModal.tsx","components/tours/TourExportDialog.tsx","components/tours/TourImageLightbox.tsx","components/tours/ToursTab.tsx","components/organization/CreateOrganizationModal.tsx","components/organization/JoinOrganizationModal.tsx","components/organization/EditOrganizationModal.tsx","components/organization/MyJoinRequestsList.tsx","components/organization/OrganizationSettings.tsx","components/organization/ProcessJoinRequestModal.tsx","components/organization/JoinRequestsList.tsx","pages/Organisation.tsx"],"sourcesContent":["import React from 'react';\n\nexport interface CardGridProps {\n  children: React.ReactNode;\n  columns?: {\n    mobile?: number;\n    tablet?: number;\n    desktop?: number;\n    largeDesktop?: number;\n  };\n  gap?: 'sm' | 'md' | 'lg';\n  className?: string;\n}\n\nconst CardGrid: React.FC<CardGridProps> = ({\n  children,\n  columns = {\n    mobile: 1,\n    tablet: 1,\n    desktop: 1,\n    largeDesktop: 1\n  },\n  gap = 'md',\n  className = ''\n}) => {\n  const gapClass = {\n    sm: 'gap-0.5',\n    md: 'gap-0.5',\n    lg: 'gap-1'\n  }[gap];\n\n  // Immer 1 Spalte fr bessere bersichtlichkeit - Cards nehmen volle Breite ein\n  return (\n    <div \n      className={`flex flex-col ${gapClass} ${className}`}\n    >\n      {children}\n    </div>\n  );\n};\n\nexport default CardGrid;\n\n","// import axios from 'axios';\nimport axiosInstance from '../config/axios.ts';\nimport { logger } from '../utils/logger.ts';\nimport { API_URL } from '../config/api.ts';\n\nexport interface TableSettings {\n  tableId: string;\n  columnOrder: string[];\n  hiddenColumns: string[];\n  viewMode?: 'table' | 'cards';\n  sortConfig?: { key: string; direction: 'asc' | 'desc' };\n}\n\n// Helfer-Funktion, um den localStorage-Schlssel fr eine Tabelle zu generieren\nconst getLocalStorageKey = (tableId: string) => `table_settings_${tableId}`;\n\n// API zum Verwalten der Tabelleneinstellungen\nexport const tableSettingsApi = {\n  // Benutzerspezifische Tabelleneinstellungen abrufen\n  getTableSettings: async (tableId: string): Promise<TableSettings> => {\n    try {\n      // Zuerst versuchen, Einstellungen vom API-Server zu laden\n      const response = await axiosInstance.get(`/table-settings/${tableId}`);\n      return response.data;\n    } catch (error) {\n      console.error('Fehler beim Abrufen der Tabelleneinstellungen vom Server:', error);\n      \n      // Fallback: Versuchen, aus dem localStorage zu laden\n      try {\n        const localStorageKey = getLocalStorageKey(tableId);\n        const storedSettings = localStorage.getItem(localStorageKey);\n        \n        if (storedSettings) {\n          return JSON.parse(storedSettings);\n        }\n      } catch (localError) {\n        console.error('Fehler beim Laden aus localStorage:', localError);\n      }\n      \n      // Default-Einstellungen zurckgeben, wenn keine gespeicherten verfgbar sind\n      return {\n        tableId,\n        columnOrder: [],\n        hiddenColumns: []\n      };\n    }\n  },\n  \n  // Tabelleneinstellungen speichern (server-side und localStorage)\n  saveTableSettings: async (settings: TableSettings): Promise<void> => {\n    try {\n      // Zum API-Server senden\n      await axiosInstance.post(`/table-settings`, settings);\n      \n      // Auch im localStorage speichern\n      const localStorageKey = getLocalStorageKey(settings.tableId);\n      localStorage.setItem(localStorageKey, JSON.stringify(settings));\n    } catch (error) {\n      console.error('Fehler beim Speichern der Tabelleneinstellungen auf dem Server:', error);\n      \n      // Trotzdem im localStorage speichern\n      try {\n        const localStorageKey = getLocalStorageKey(settings.tableId);\n        localStorage.setItem(localStorageKey, JSON.stringify(settings));\n      } catch (localError) {\n        console.error('Fehler beim Speichern im localStorage:', localError);\n      }\n    }\n  },\n  \n  // Tabelleneinstellungen zurcksetzen\n  resetTableSettings: (tableId: string): void => {\n    try {\n      const localStorageKey = getLocalStorageKey(tableId);\n      localStorage.removeItem(localStorageKey);\n      logger.log(`Tabelleneinstellungen fr ${tableId} zurckgesetzt`);\n    } catch (error) {\n      console.error('Fehler beim Zurcksetzen der Tabelleneinstellungen:', error);\n    }\n  }\n}; ","import { useState, useEffect, useCallback, useRef } from 'react';\nimport { tableSettingsApi, TableSettings } from '../api/tableSettingsApi.ts';\nimport { logger } from '../utils/logger.ts';\n\ninterface UseTableSettingsOptions {\n  defaultColumnOrder?: string[];\n  defaultHiddenColumns?: string[];\n  defaultViewMode?: 'table' | 'cards';\n  defaultVisibleCardMetadata?: string[];\n  defaultCardColumnOrder?: string[];\n  defaultCardSortDirections?: Record<string, 'asc' | 'desc'>;\n  defaultSortConfig?: { key: string; direction: 'asc' | 'desc' };\n}\n\n/**\n * Hook zum Verwalten von benutzerdefinierten Tabelleneinstellungen\n * @param tableId Eindeutige ID der Tabelle\n * @param options Optionale Standardwerte\n */\nexport const useTableSettings = (tableId: string, options?: UseTableSettingsOptions) => {\n  const [settings, setSettings] = useState<TableSettings>({\n    tableId,\n    columnOrder: options?.defaultColumnOrder || [],\n    hiddenColumns: options?.defaultHiddenColumns || []\n  });\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n\n  // Tabelleneinstellungen laden - beim Mount oder wenn tableId sich ndert\n  useEffect(() => {\n    let isMounted = true;\n    \n    const loadSettings = async () => {\n      try {\n        setIsLoading(true);\n        const loadedSettings = await tableSettingsApi.getTableSettings(tableId);\n        \n        if (!isMounted) return; // Component wurde bereits unmounted\n        \n        logger.log('Geladene Tabelleneinstellungen vom Server:', loadedSettings);\n        \n        // Wenn leere Einstellungen zurckgegeben werden, verwende die Standardwerte\n        if (loadedSettings.columnOrder.length === 0 && options?.defaultColumnOrder) {\n          loadedSettings.columnOrder = options.defaultColumnOrder;\n        }\n        \n        // View-Mode initialisieren, falls nicht vorhanden\n        if (!loadedSettings.viewMode && options?.defaultViewMode) {\n          loadedSettings.viewMode = options.defaultViewMode;\n        }\n        \n        // sortConfig initialisieren, falls nicht vorhanden\n        let needsSave = false;\n        if (!loadedSettings.sortConfig && options?.defaultSortConfig) {\n          loadedSettings.sortConfig = options.defaultSortConfig;\n          needsSave = true;\n        }\n        \n        logger.log('Finale Tabelleneinstellungen nach Initialisierung:', loadedSettings);\n        setSettings(loadedSettings);\n        setError(null);\n        \n        //  FIX: Speichere defaultSortConfig auch auf dem Server (nach setState, um Initialisierungsprobleme zu vermeiden)\n        if (needsSave) {\n          tableSettingsApi.saveTableSettings(loadedSettings).catch(err => {\n            setError(err instanceof Error ? err : new Error('Fehler beim Speichern der Standard-Sortierung'));\n            console.error('Fehler beim Speichern der Standard-Sortierung:', err);\n          });\n        }\n      } catch (err) {\n        if (!isMounted) return;\n        setError(err instanceof Error ? err : new Error('Fehler beim Laden der Einstellungen'));\n        console.error('Fehler beim Laden der Tabelleneinstellungen:', err);\n      } finally {\n        if (isMounted) {\n          setIsLoading(false);\n        }\n      }\n    };\n\n    loadSettings();\n    \n    return () => {\n      isMounted = false;\n    };\n  }, [tableId]); // NUR tableId als Dependency!\n\n  // Spaltenreihenfolge aktualisieren\n  const updateColumnOrder = useCallback(async (newColumnOrder: string[]) => {\n    try {\n      const updatedSettings = { ...settings, columnOrder: newColumnOrder };\n      setSettings(updatedSettings);\n      await tableSettingsApi.saveTableSettings(updatedSettings);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim Speichern der Spaltenreihenfolge'));\n      console.error('Fehler beim Speichern der Spaltenreihenfolge:', err);\n    }\n  }, [settings]);\n\n  // Versteckte Spalten aktualisieren\n  const updateHiddenColumns = useCallback(async (newHiddenColumns: string[]) => {\n    try {\n      //  FIX: Verwende funktionales Update, um stale closure zu vermeiden\n      setSettings(prevSettings => {\n        const updatedSettings = { ...prevSettings, hiddenColumns: newHiddenColumns };\n        tableSettingsApi.saveTableSettings(updatedSettings).catch(err => {\n          setError(err instanceof Error ? err : new Error('Fehler beim Speichern der versteckten Spalten'));\n          console.error('Fehler beim Speichern der versteckten Spalten:', err);\n        });\n        return updatedSettings;\n      });\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim Speichern der versteckten Spalten'));\n      console.error('Fehler beim Speichern der versteckten Spalten:', err);\n    }\n  }, []);\n\n  // Eine einzelne Spalte ein- oder ausblenden\n  const toggleColumnVisibility = useCallback(async (columnId: string) => {\n    try {\n      let newHiddenColumns: string[];\n      \n      if (settings.hiddenColumns.includes(columnId)) {\n        // Spalte einblenden (aus hiddenColumns entfernen)\n        newHiddenColumns = settings.hiddenColumns.filter(id => id !== columnId);\n      } else {\n        // Spalte ausblenden (zu hiddenColumns hinzufgen)\n        newHiddenColumns = [...settings.hiddenColumns, columnId];\n      }\n      \n      const updatedSettings = { ...settings, hiddenColumns: newHiddenColumns };\n      setSettings(updatedSettings);\n      await tableSettingsApi.saveTableSettings(updatedSettings);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim ndern der Spaltenansicht'));\n      console.error('Fehler beim ndern der Spaltenansicht:', err);\n    }\n  }, [settings]);\n\n  // View-Mode aktualisieren\n  const updateViewMode = useCallback(async (newViewMode: 'table' | 'cards') => {\n    try {\n      //  FIX: Verwende funktionales Update, um stale closure zu vermeiden\n      setSettings(prevSettings => {\n        const updatedSettings = { ...prevSettings, viewMode: newViewMode };\n        tableSettingsApi.saveTableSettings(updatedSettings).catch(err => {\n          setError(err instanceof Error ? err : new Error('Fehler beim Speichern des View-Modes'));\n          console.error('Fehler beim Speichern des View-Modes:', err);\n        });\n        return updatedSettings;\n      });\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim Speichern des View-Modes'));\n      console.error('Fehler beim Speichern des View-Modes:', err);\n    }\n  }, []);\n\n  // Sortierung aktualisieren\n  const updateSortConfig = useCallback(async (newSortConfig: { key: string; direction: 'asc' | 'desc' }) => {\n    try {\n      //  FIX: Verwende funktionales Update, um stale closure zu vermeiden\n      setSettings(prevSettings => {\n        const updatedSettings = { ...prevSettings, sortConfig: newSortConfig };\n        // Speichere asynchron (nicht await, da setState synchron sein muss)\n        tableSettingsApi.saveTableSettings(updatedSettings).catch(err => {\n          setError(err instanceof Error ? err : new Error('Fehler beim Speichern der Sortierung'));\n          console.error('Fehler beim Speichern der Sortierung:', err);\n        });\n        return updatedSettings;\n      });\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim Speichern der Sortierung'));\n      console.error('Fehler beim Speichern der Sortierung:', err);\n    }\n  }, []); //  FIX: Keine Dependencies mehr - verwendet funktionales Update\n\n  return {\n    settings,\n    isLoading,\n    error,\n    updateColumnOrder,\n    updateHiddenColumns,\n    toggleColumnVisibility,\n    isColumnVisible: (columnId: string) => !settings.hiddenColumns.includes(columnId),\n    updateViewMode,\n    updateSortConfig\n  };\n}; ","/**\r\n * Zentrale Filter-Logik zur Eliminierung von Code-Duplikation\r\n * \r\n * Diese Datei konsolidiert die Filter-Logik, die zuvor in mehreren Komponenten\r\n * dupliziert war (Requests.tsx, Worktracker.tsx, InvoiceManagementTab.tsx, etc.)\r\n * \r\n * WICHTIG: Die Logik ist exakt identisch mit der vorherigen Implementierung.\r\n * Nur die Code-Duplikation wurde entfernt, keine Funktionalittsnderung!\r\n */\r\n\r\nimport { startOfWeek, endOfWeek, startOfMonth, endOfMonth, startOfYear, endOfYear } from 'date-fns';\r\n\r\nexport interface FilterCondition {\r\n  column: string;\r\n  operator: string;\r\n  value: string | number | Date | null;\r\n}\r\n\r\n/**\r\n * Evaluates a single filter condition against a field value\r\n * @param fieldValue - The value to test against\r\n * @param condition - The filter condition to apply\r\n * @returns true if condition is met, false otherwise\r\n */\r\nexport const evaluateCondition = (\r\n  fieldValue: any,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  const { operator, value } = condition;\r\n  \r\n  // Sicherstellen, dass value definiert ist\r\n  if (value === undefined) {\r\n    console.error('evaluateCondition: value ist undefined', condition);\r\n    return false;\r\n  }\r\n  \r\n  // Handle null/undefined values\r\n  if (fieldValue == null && value == null) {\r\n    return operator === 'equals';\r\n  }\r\n  if (fieldValue == null || value == null) {\r\n    if (operator === 'notEquals') return true;\r\n    return false;\r\n  }\r\n\r\n  // String operations\r\n  // Sicherstellen, dass fieldValue und value Strings sind, bevor toLowerCase() aufgerufen wird\r\n  let strField: string = '';\r\n  let strValue: string = '';\r\n  \r\n  try {\r\n    // Konvertiere fieldValue zu String, auch wenn es ein Objekt ist\r\n    const fieldValueStr = fieldValue == null ? '' : (typeof fieldValue === 'string' ? fieldValue : String(fieldValue));\r\n    if (typeof fieldValueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerField = fieldValueStr.toLowerCase();\r\n    if (lowerField === undefined || lowerField === null || typeof lowerField !== 'string') {\r\n      return false;\r\n    }\r\n    strField = lowerField;\r\n    \r\n    // Konvertiere value zu String, auch wenn es ein Objekt ist\r\n    const valueStr = value == null ? '' : (typeof value === 'string' ? value : String(value));\r\n    if (typeof valueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerValue = valueStr.toLowerCase();\r\n    if (lowerValue === undefined || lowerValue === null || typeof lowerValue !== 'string') {\r\n      return false;\r\n    }\r\n    strValue = lowerValue;\r\n  } catch (error) {\r\n    // Falls toLowerCase() fehlschlgt, gebe false zurck\r\n    return false;\r\n  }\r\n\r\n  // Sicherstellen, dass strField und strValue Strings sind und nicht undefined\r\n  if (typeof strField !== 'string' || typeof strValue !== 'string' || strField === undefined || strValue === undefined || strField === null || strValue === null) {\r\n    return false;\r\n  }\r\n\r\n  switch (operator) {\r\n    case 'equals':\r\n      return strField === strValue;\r\n    case 'notEquals':\r\n      return strField !== strValue;\r\n    case 'contains':\r\n      return strField.includes(strValue);\r\n    case 'startsWith':\r\n      return strField.startsWith(strValue);\r\n    case 'endsWith':\r\n      // Explizite Prfung, dass strField und strValue Strings sind, bevor endsWith aufgerufen wird\r\n      if (strField === undefined || strField === null) {\r\n        console.error('endsWith: strField ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (strValue === undefined || strValue === null) {\r\n        console.error('endsWith: strValue ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strField !== 'string') {\r\n        console.error('endsWith: strField ist kein String', { strField, typeof: typeof strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strValue !== 'string') {\r\n        console.error('endsWith: strValue ist kein String', { strField, strValue, typeof: typeof strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      try {\r\n        return strField.endsWith(strValue);\r\n      } catch (error) {\r\n        console.error('endsWith: Fehler bei endsWith-Aufruf', error, { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n    case 'before':\r\n    case 'after': {\r\n      // Date operations\r\n      const fieldDate = new Date(fieldValue);\r\n      const valueDate = new Date(value as string);\r\n      if (isNaN(fieldDate.getTime()) || isNaN(valueDate.getTime())) {\r\n        return false;\r\n      }\r\n      return operator === 'before' \r\n        ? fieldDate < valueDate \r\n        : fieldDate > valueDate;\r\n    }\r\n    case 'greaterThan':\r\n    case 'lessThan': {\r\n      // Numeric operations\r\n      const fieldNum = parseFloat(String(fieldValue));\r\n      const valueNum = parseFloat(String(value));\r\n      if (isNaN(fieldNum) || isNaN(valueNum)) {\r\n        return false;\r\n      }\r\n      return operator === 'greaterThan'\r\n        ? fieldNum > valueNum\r\n        : fieldNum < valueNum;\r\n    }\r\n    default:\r\n      return true;\r\n  }\r\n};\r\n\r\n/**\r\n * Type for getting field values from items\r\n */\r\nexport type GetFieldValue<T> = (item: T, columnId: string) => any;\r\n\r\n/**\r\n * Type for column-specific evaluation handlers\r\n * Returns true if condition is met, false otherwise\r\n */\r\nexport type ColumnEvaluator<T> = (item: T, condition: FilterCondition) => boolean | null;\r\n\r\n/**\r\n * Applies filter conditions to an array of items\r\n * \r\n * @param items - Array of items to filter\r\n * @param conditions - Array of filter conditions\r\n * @param operators - Array of logical operators ('AND' | 'OR') between conditions\r\n * @param getFieldValue - Function to extract field values from items\r\n * @param columnEvaluators - Optional map of column-specific evaluators for custom logic\r\n * @returns Filtered array of items\r\n * \r\n * @example\r\n * // Standard usage with getFieldValue\r\n * const filtered = applyFilters(items, conditions, operators, (item, col) => item[col]);\r\n * \r\n * // With custom column evaluators\r\n * const filtered = applyFilters(\r\n *   items,\r\n *   conditions,\r\n *   operators,\r\n *   (item, col) => item[col],\r\n *   {\r\n *     'responsible': (item, condition) => {\r\n *       // Custom logic for responsible column\r\n *       return evaluateUserRoleCondition(item.responsible?.id, item.role?.id, condition);\r\n *     }\r\n *   }\r\n * );\r\n */\r\nexport const applyFilters = <T>(\r\n  items: T[],\r\n  conditions: FilterCondition[],\r\n  operators: ('AND' | 'OR')[],\r\n  getFieldValue: GetFieldValue<T>,\r\n  columnEvaluators?: Record<string, ColumnEvaluator<T>>\r\n): T[] => {\r\n  if (conditions.length === 0) {\r\n    return items;\r\n  }\r\n\r\n  return items.filter(item => {\r\n    let result = true;\r\n\r\n    for (let i = 0; i < conditions.length; i++) {\r\n      const condition = conditions[i];\r\n      let conditionMet = false;\r\n\r\n      // Check if there's a custom evaluator for this column\r\n      if (columnEvaluators && columnEvaluators[condition.column]) {\r\n        const customResult = columnEvaluators[condition.column](item, condition);\r\n        if (customResult !== null) {\r\n          conditionMet = customResult;\r\n        } else {\r\n          // Fallback to standard evaluation if custom evaluator returns null\r\n          const fieldValue = getFieldValue(item, condition.column);\r\n          conditionMet = evaluateCondition(fieldValue, condition);\r\n        }\r\n      } else {\r\n        // Standard evaluation\r\n        const fieldValue = getFieldValue(item, condition.column);\r\n        conditionMet = evaluateCondition(fieldValue, condition);\r\n      }\r\n\r\n      // Apply logical operators\r\n      if (i === 0) {\r\n        result = conditionMet;\r\n      } else {\r\n        const operator = operators[i - 1] || 'AND';\r\n        result = operator === 'AND' \r\n          ? (result && conditionMet) \r\n          : (result || conditionMet);\r\n      }\r\n    }\r\n\r\n    return result;\r\n  });\r\n};\r\n\r\n/**\r\n * Helper function to evaluate date conditions with proper date comparison\r\n * Supports __TODAY__ as a dynamic date value\r\n * \r\n * WICHTIG: Extrahiert nur den Datumsteil (Jahr, Monat, Tag) ohne Zeitzone,\r\n * um Zeitzone-Konvertierungsprobleme zu vermeiden (verhindert Tag-Versatz)\r\n */\r\nexport const evaluateDateCondition = (\r\n  dateValue: Date | string | null | undefined,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  if (!dateValue) {\r\n    return false;\r\n  }\r\n\r\n  const date = new Date(dateValue);\r\n  if (isNaN(date.getTime())) {\r\n    return false;\r\n  }\r\n\r\n  // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n  // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n  const dateYear = date.getUTCFullYear();\r\n  const dateMonth = date.getUTCMonth();\r\n  const dateDay = date.getUTCDate();\r\n  // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n  const normalizedDate = new Date(dateYear, dateMonth, dateDay);\r\n\r\n  //  PHASE 5: Handle Zeitraum-Platzhalter (__THIS_WEEK__, __THIS_MONTH__, __THIS_YEAR__)\r\n  // Diese funktionieren analog zu __TODAY__, aber fr Zeitrume\r\n  try {\r\n    if (condition.value === '__THIS_WEEK__') {\r\n      if (condition.operator === 'equals') {\r\n        const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekStart.setHours(0, 0, 0, 0);\r\n        const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= weekStart && normalizedDate <= weekEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Woche als einzelnes Datum\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < weekEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > weekStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_MONTH__') {\r\n      if (condition.operator === 'equals') {\r\n        const monthStart = startOfMonth(new Date());\r\n        monthStart.setHours(0, 0, 0, 0);\r\n        const monthEnd = endOfMonth(new Date());\r\n        monthEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= monthStart && normalizedDate <= monthEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Monat als einzelnes Datum\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < monthEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > monthStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_YEAR__') {\r\n      if (condition.operator === 'equals') {\r\n        const yearStart = startOfYear(new Date());\r\n        yearStart.setHours(0, 0, 0, 0);\r\n        const yearEnd = endOfYear(new Date());\r\n        yearEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= yearStart && normalizedDate <= yearEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Jahr als einzelnes Datum\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < yearEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > yearStart;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    // Handle __TODAY__, __WEEK_START__, __WEEK_END__, __MONTH_START__, __MONTH_END__, __YEAR_START__, __YEAR_END__ dynamic dates\r\n    let conditionDate: Date;\r\n    if (condition.value === '__TODAY__') {\r\n      // Get today's date in local timezone (set to midnight)\r\n      const localToday = new Date();\r\n      localToday.setHours(0, 0, 0, 0);\r\n      conditionDate = localToday;\r\n    } else if (condition.value === '__WEEK_START__') {\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      conditionDate = weekStart;\r\n    } else if (condition.value === '__WEEK_END__') {\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = weekEnd;\r\n    } else if (condition.value === '__MONTH_START__') {\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      conditionDate = monthStart;\r\n    } else if (condition.value === '__MONTH_END__') {\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = monthEnd;\r\n    } else if (condition.value === '__YEAR_START__') {\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      conditionDate = yearStart;\r\n    } else if (condition.value === '__YEAR_END__') {\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = yearEnd;\r\n    } else {\r\n      const conditionDateRaw = new Date(condition.value as string);\r\n      if (isNaN(conditionDateRaw.getTime())) {\r\n        return false;\r\n      }\r\n      // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n      // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n      const conditionYear = conditionDateRaw.getUTCFullYear();\r\n      const conditionMonth = conditionDateRaw.getUTCMonth();\r\n      const conditionDay = conditionDateRaw.getUTCDate();\r\n      // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n      conditionDate = new Date(conditionYear, conditionMonth, conditionDay);\r\n    }\r\n\r\n    switch (condition.operator) {\r\n      case 'equals':\r\n        return normalizedDate.getTime() === conditionDate.getTime();\r\n      case 'before':\r\n        return normalizedDate < conditionDate;\r\n      case 'after':\r\n        return normalizedDate > conditionDate;\r\n      default:\r\n        return true;\r\n    }\r\n  } catch (error) {\r\n    //  PHASE 5: Error Handling fr ungltige Platzhalter-Werte\r\n    console.error(`[evaluateDateCondition] Error with placeholder ${condition.value}:`, error);\r\n    return false; // Fallback: Filter schliet Datensatz aus\r\n  }\r\n};\r\n\r\n/**\r\n * Helper function to evaluate user/role conditions with user-{id} or role-{id} format\r\n * Supports both user-{id} and role-{id} formats, plus text fallback for legacy support\r\n */\r\nexport const evaluateUserRoleCondition = (\r\n  userId: number | null | undefined,\r\n  roleId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  textValue?: string  // Optional: text representation for fallback (e.g. \"John Doe\")\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = userId === targetUserId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = roleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  if (textValue !== undefined) {\r\n    const textValueLower = textValue.toLowerCase();\r\n    const valueLower = value.toLowerCase();\r\n    if (condition.operator === 'equals') {\r\n      return textValueLower === valueLower;\r\n    } else if (condition.operator === 'notEquals') {\r\n      return textValueLower !== valueLower;\r\n    } else if (condition.operator === 'contains') {\r\n      return textValueLower.includes(valueLower);\r\n    }\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n/**\r\n * Helper function for combined responsible/qualityControl filter (specific to Tasks)\r\n */\r\nexport const evaluateResponsibleAndQualityControl = (\r\n  responsibleId: number | null | undefined,\r\n  responsibleRoleId: number | null | undefined,\r\n  qualityControlId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  responsibleText?: string,\r\n  qualityControlText?: string\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format - matches either responsible OR qualityControl\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = (responsibleId === targetUserId) || (qualityControlId === targetUserId);\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format - only matches with responsible role\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = responsibleRoleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  const valueLower = value.toLowerCase();\r\n  if (condition.operator === 'equals') {\r\n    return (responsibleText?.toLowerCase() === valueLower) || (qualityControlText?.toLowerCase() === valueLower);\r\n  } else if (condition.operator === 'notEquals') {\r\n    return (responsibleText?.toLowerCase() !== valueLower) && (qualityControlText?.toLowerCase() !== valueLower);\r\n  } else if (condition.operator === 'contains') {\r\n    return (responsibleText?.toLowerCase()?.includes(valueLower) ?? false) || (qualityControlText?.toLowerCase()?.includes(valueLower) ?? false);\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourBooking, TourBookingStatus } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\n\ninterface CreateTourBookingModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onBookingCreated: (newBooking: TourBooking) => void;\n    tour?: Tour | null;\n}\n\nconst CreateTourBookingModal = ({ isOpen, onClose, onBookingCreated, tour: preselectedTour }: CreateTourBookingModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    \n    const [tourId, setTourId] = useState<number | ''>(preselectedTour?.id || '');\n    const [tourDate, setTourDate] = useState('');\n    const [numberOfParticipants, setNumberOfParticipants] = useState<number | ''>(1);\n    const [customerName, setCustomerName] = useState('');\n    const [customerEmail, setCustomerEmail] = useState('');\n    const [customerPhone, setCustomerPhone] = useState('');\n    const [customerNotes, setCustomerNotes] = useState('');\n    \n    const [tours, setTours] = useState<Tour[]>([]);\n    const [selectedTour, setSelectedTour] = useState<Tour | null>(preselectedTour || null);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Touren\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BASE, {\n                    params: { isActive: true }\n                });\n                const toursData = response.data?.data || response.data || [];\n                setTours(Array.isArray(toursData) ? toursData : []);\n            } catch (err: unknown) {\n                console.error('Error loading tours:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Setze preselectedTour wenn vorhanden\n    useEffect(() => {\n        if (preselectedTour) {\n            setTourId(preselectedTour.id);\n            setSelectedTour(preselectedTour);\n        }\n    }, [preselectedTour]);\n\n    // Update selectedTour when tourId changes\n    useEffect(() => {\n        if (tourId) {\n            const tour = tours.find(t => t.id === Number(tourId));\n            setSelectedTour(tour || null);\n        } else {\n            setSelectedTour(null);\n        }\n    }, [tourId, tours]);\n\n    // Reset form when modal opens/closes\n    useEffect(() => {\n        if (!isOpen) {\n            if (!preselectedTour) {\n                setTourId('');\n            }\n            setTourDate('');\n            setNumberOfParticipants(1);\n            setCustomerName('');\n            setCustomerEmail('');\n            setCustomerPhone('');\n            setCustomerNotes('');\n            setError(null);\n        }\n    }, [isOpen, preselectedTour]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierungen\n        if (!tourId) {\n            setError(t('tourBookings.validation.tourRequired', { defaultValue: 'Tour ist erforderlich' }));\n            return;\n        }\n\n        if (!tourDate) {\n            setError(t('tourBookings.validation.tourDateRequired', { defaultValue: 'Tour-Datum ist erforderlich' }));\n            return;\n        }\n\n        const tourDateObj = new Date(tourDate);\n        if (tourDateObj < new Date()) {\n            setError(t('tours.validation.tourDateFuture', { defaultValue: 'Tour-Datum muss in der Zukunft liegen' }));\n            return;\n        }\n\n        if (!numberOfParticipants || Number(numberOfParticipants) < 1) {\n            setError(t('tourBookings.validation.numberOfParticipantsMin', { defaultValue: 'Anzahl Teilnehmer muss >= 1 sein' }));\n            return;\n        }\n\n        if (!customerName.trim() || customerName.trim().length < 2) {\n            setError(t('tourBookings.validation.customerNameMinLength', { defaultValue: 'Kundenname muss mindestens 2 Zeichen lang sein' }));\n            return;\n        }\n\n        if (!customerPhone.trim() && !customerEmail.trim()) {\n            setError(t('tourBookings.validation.contactRequired', { defaultValue: 'Mindestens eine Kontaktinformation (Telefon oder E-Mail) ist erforderlich' }));\n            return;\n        }\n\n        // Validierung: Anzahl Teilnehmer zwischen min/max\n        if (selectedTour) {\n            const numPart = Number(numberOfParticipants);\n            if (selectedTour.minParticipants && numPart < selectedTour.minParticipants) {\n                setError(t('tours.validation.numberOfParticipantsRange', { \n                    defaultValue: 'Anzahl der Teilnehmer muss zwischen {min} und {max} sein',\n                    min: selectedTour.minParticipants,\n                    max: selectedTour.maxParticipants || ''\n                }));\n                return;\n            }\n            if (selectedTour.maxParticipants && numPart > selectedTour.maxParticipants) {\n                setError(t('tours.validation.numberOfParticipantsRange', { \n                    defaultValue: 'Anzahl der Teilnehmer muss zwischen {min} und {max} sein',\n                    min: selectedTour.minParticipants || 1,\n                    max: selectedTour.maxParticipants\n                }));\n                return;\n            }\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.post(API_ENDPOINTS.TOUR_BOOKINGS.BASE, {\n                tourId: Number(tourId),\n                tourDate,\n                numberOfParticipants: Number(numberOfParticipants),\n                customerName: customerName.trim(),\n                customerEmail: customerEmail.trim() || null,\n                customerPhone: customerPhone.trim() || null,\n                customerNotes: customerNotes.trim() || null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tourBookings.created', { defaultValue: 'Tour-Buchung erfolgreich erstellt' }),\n                    'success'\n                );\n                onBookingCreated(response.data.data);\n                onClose();\n            } else {\n                throw new Error(response.data?.message || t('tours.bookings.createError', { defaultValue: 'Fehler beim Erstellen der Buchung' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error creating booking:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                    <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                            {t('tourBookings.create', { defaultValue: 'Neue Tour-Buchung' })}\n                        </Dialog.Title>\n                        <button\n                            onClick={onClose}\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                        >\n                            <XMarkIcon className=\"h-6 w-6\" />\n                        </button>\n                    </div>\n\n                    <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.tour', { defaultValue: 'Tour' })} *\n                            </label>\n                            <select\n                                value={tourId}\n                                onChange={(e) => setTourId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData || !!preselectedTour}\n                            >\n                                <option value=\"\">{t('common.select', { defaultValue: 'Bitte whlen' })}</option>\n                                {tours.filter(t => t.isActive && t.title).map(tour => (\n                                    <option key={tour.id} value={tour.id}>\n                                        {tour.title || '-'}\n                                    </option>\n                                ))}\n                            </select>\n                            {selectedTour && (\n                                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                                    {selectedTour.minParticipants && selectedTour.maxParticipants\n                                        ? t('tourBookings.participantsRange', { \n                                            defaultValue: 'Teilnehmer: {min} - {max}',\n                                            min: selectedTour.minParticipants,\n                                            max: selectedTour.maxParticipants\n                                        })\n                                        : selectedTour.minParticipants\n                                        ? t('tourBookings.participantsMin', { \n                                            defaultValue: 'Min. Teilnehmer: {min}',\n                                            min: selectedTour.minParticipants\n                                        })\n                                        : selectedTour.maxParticipants\n                                        ? t('tourBookings.participantsMax', { \n                                            defaultValue: 'Max. Teilnehmer: {max}',\n                                            max: selectedTour.maxParticipants\n                                        })\n                                        : null}\n                                </p>\n                            )}\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.tourDate', { defaultValue: 'Tour-Datum' })} *\n                            </label>\n                            <input\n                                type=\"datetime-local\"\n                                value={tourDate}\n                                onChange={(e) => setTourDate(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.numberOfParticipants', { defaultValue: 'Anzahl Teilnehmer' })} *\n                            </label>\n                            <input\n                                type=\"number\"\n                                min={selectedTour?.minParticipants || 1}\n                                max={selectedTour?.maxParticipants || undefined}\n                                value={numberOfParticipants}\n                                onChange={(e) => setNumberOfParticipants(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerName', { defaultValue: 'Kundenname' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={customerName}\n                                onChange={(e) => setCustomerName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerPhone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={customerPhone}\n                                onChange={(e) => setCustomerPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerEmail', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={customerEmail}\n                                onChange={(e) => setCustomerEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerNotes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={customerNotes}\n                                onChange={(e) => setCustomerNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={onClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </Dialog.Panel>\n            </div>\n        </Dialog>\n    );\n};\n\nexport default CreateTourBookingModal;\n\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { EyeIcon, EyeSlashIcon, ArrowsUpDownIcon, ArrowUpIcon, ArrowDownIcon, XMarkIcon } from '@heroicons/react/24/outline';\n\ninterface Column {\n  id: string;\n  label: string;\n}\n\ninterface TableColumnConfigProps {\n  columns: Column[];\n  visibleColumns: string[];\n  columnOrder: string[];\n  onToggleColumnVisibility: (columnId: string) => void;\n  onMoveColumn?: (dragIndex: number, hoverIndex: number) => void; // Optional: Drag & Drop fr Spalten-Reihenfolge\n  onClose?: () => void; // Optional: Callback wenn Modal geschlossen wird\n  buttonTitle?: string; // Optional: Custom Button-Titel\n  modalTitle?: string; // Optional: Custom Modal-Titel\n  mainSortConfig?: { key: string; direction: 'asc' | 'desc' }; // Optional: Hauptsortierung (fr Table & Cards synchron)\n  onMainSortChange?: (key: string, direction: 'asc' | 'desc') => void; // Optional: Callback fr Hauptsortierung\n  showMainSort?: boolean; // Optional: Hauptsortierung anzeigen\n  isOpen?: boolean; // Optional: Externe Steuerung des Modal-Status (wenn nicht bergeben, wird interner State verwendet)\n  onOpenChange?: (open: boolean) => void; // Optional: Callback wenn Modal geffnet/geschlossen wird (fr externe Steuerung)\n}\n\ninterface DraggableItemProps {\n  id: string;\n  label: string;\n  index: number;\n  isVisible: boolean;\n  onToggleVisibility: (id: string) => void;\n  sortDirection?: 'asc' | 'desc'; // Optional: Sortierrichtung fr diese Spalte (wenn diese Spalte die Hauptsortierung ist)\n  onSortDirectionChange?: (id: string, direction: 'asc' | 'desc') => void; // Optional: Callback fr Hauptsortierung\n  showMainSort?: boolean; // Optional: Hauptsortierung anzeigen\n  isMainSort?: boolean; // Optional: Ist diese Spalte die Hauptsortierung?\n}\n\n// Komponente fr eine einzelne Spalte\nconst DraggableColumnItem: React.FC<DraggableItemProps> = ({ \n  id, \n  label, \n  index, \n  isVisible,\n  onToggleVisibility,\n  sortDirection,\n  onSortDirectionChange,\n  showMainSort = false,\n  isMainSort = false\n}) => {\n  const { t } = useTranslation();\n  \n  return (\n    <li \n      className=\"flex items-center justify-between px-2.5 py-2 rounded-md transition-colors duration-150 hover:bg-gray-50 dark:hover:bg-gray-700\"\n    >\n      <div className=\"flex items-center flex-1 min-w-0\">\n        <span className=\"text-sm dark:text-gray-300\">\n          {label}\n        </span>\n      </div>\n      <div className=\"flex items-center gap-2\">\n        {/* Hauptsortierung-Toggle: Nur anzeigen wenn onSortDirectionChange vorhanden ist */}\n        {onSortDirectionChange && (\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              // Wenn diese Spalte bereits die Hauptsortierung ist, toggle die Richtung\n              // Sonst setze diese Spalte als neue Hauptsortierung (Standard: 'asc')\n              const newDirection = isMainSort && sortDirection !== undefined \n                ? (sortDirection === 'asc' ? 'desc' : 'asc')\n                : 'asc';\n              onSortDirectionChange(id, newDirection);\n            }}\n            className={`inline-flex items-center justify-center p-1.5 rounded-md transition-colors duration-150 ${\n              isMainSort\n                ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-900/50'\n                : 'bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300'\n            }`}\n            title={\n              isMainSort && sortDirection !== undefined\n                ? `${t('tableColumn.mainSort')}: ${sortDirection === 'asc' ? t('tableColumn.ascending') : t('tableColumn.descending')} (${t('tableColumn.clickToToggle')})`\n                : `${t('tableColumn.setMainSort')} (${t('tableColumn.clickToSet')})`\n            }\n          >\n            {isMainSort && sortDirection === 'asc' ? (\n              <ArrowUpIcon className=\"h-4 w-4\" />\n            ) : isMainSort && sortDirection === 'desc' ? (\n              <ArrowDownIcon className=\"h-4 w-4\" />\n            ) : (\n              <ArrowsUpDownIcon className=\"h-4 w-4\" />\n            )}\n          </button>\n        )}\n        <button\n          onClick={() => onToggleVisibility(id)}\n          className=\"inline-flex items-center justify-center p-1.5 rounded-full bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150\"\n          title={isVisible ? t('tableColumn.hideColumn') : t('tableColumn.showColumn')}\n        >\n          {isVisible ? (\n            <EyeIcon className=\"w-4 h-4 dark:text-gray-300\" />\n          ) : (\n            <EyeSlashIcon className=\"w-4 h-4 text-gray-400 dark:text-gray-500\" />\n          )}\n        </button>\n      </div>\n    </li>\n  );\n};\n\nconst TableColumnConfig: React.FC<TableColumnConfigProps> = ({\n  columns,\n  visibleColumns,\n  columnOrder,\n  onToggleColumnVisibility,\n  onMoveColumn,\n  onClose,\n  buttonTitle,\n  modalTitle,\n  mainSortConfig,\n  onMainSortChange,\n  showMainSort = false,\n  isOpen: externalIsOpen,\n  onOpenChange\n}) => {\n  const { t } = useTranslation();\n  const defaultButtonTitle = buttonTitle || t('tableColumn.configure');\n  const defaultModalTitle = modalTitle || t('tableColumn.configure');\n  // Interner State nur verwenden, wenn keine externe Steuerung bergeben wurde\n  const [internalIsOpen, setInternalIsOpen] = useState(false);\n  const isOpen = externalIsOpen !== undefined ? externalIsOpen : internalIsOpen;\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  // Sortiere die Spalten gem der benutzerdefinierten Reihenfolge\n  const sortedColumns = [...columns].sort((a, b) => {\n    const indexA = columnOrder.indexOf(a.id);\n    const indexB = columnOrder.indexOf(b.id);\n    // Wenn eine Spalte nicht in columnOrder ist, platziere sie am Ende\n    if (indexA === -1) return 1;\n    if (indexB === -1) return -1;\n    return indexA - indexB;\n  });\n\n  // Handler zum Schlieen des Mens\n  const handleClose = useCallback(() => {\n    if (externalIsOpen !== undefined) {\n      // Externe Steuerung: onOpenChange aufrufen\n      onOpenChange?.(false);\n    } else {\n      // Interne Steuerung: internen State aktualisieren\n      setInternalIsOpen(false);\n    }\n    onClose?.();\n  }, [externalIsOpen, onOpenChange, onClose]);\n\n  // Handler zum ffnen des Mens\n  const handleOpen = useCallback(() => {\n    if (externalIsOpen !== undefined) {\n      // Externe Steuerung: onOpenChange aufrufen\n      onOpenChange?.(true);\n    } else {\n      // Interne Steuerung: internen State aktualisieren\n      setInternalIsOpen(true);\n    }\n  }, [externalIsOpen, onOpenChange]);\n\n  // Click outside handler\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n        handleClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [isOpen, handleClose]);\n\n  // Keyboard navigation: ESC zum Schlieen\n  useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 'Escape' && isOpen) {\n        handleClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleKeyDown);\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [isOpen, handleClose]);\n\n  return (\n    <div className=\"relative\" ref={menuRef}>\n      {/* Button nur anzeigen, wenn keine externe Steuerung vorhanden ist */}\n      {externalIsOpen === undefined && (\n        <button\n          className=\"inline-flex items-center justify-center p-2 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150\"\n          onClick={isOpen ? handleClose : handleOpen}\n          title={defaultButtonTitle}\n        >\n        {showMainSort ? (\n          <ArrowsUpDownIcon className=\"w-5 h-5\" />\n        ) : (\n          <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\" className=\"w-5 h-5\">\n            <path fillRule=\"evenodd\" d=\"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5A.75.75 0 012 10z\" clipRule=\"evenodd\" />\n          </svg>\n        )}\n        </button>\n      )}\n\n      {isOpen && (\n        <div \n          className=\"absolute right-0 mt-2 w-64 max-w-[calc(100vw-1rem)] bg-white dark:bg-gray-800 rounded-md shadow-lg z-50 border border-gray-300 dark:border-gray-600\"\n          role=\"dialog\"\n          aria-modal=\"true\"\n          aria-labelledby=\"table-column-config-title\"\n        >\n          <div className=\"px-3 py-2.5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between\">\n            <h3 id=\"table-column-config-title\" className=\"text-sm font-semibold text-gray-900 dark:text-white\">{defaultModalTitle}</h3>\n            <button\n              onClick={handleClose}\n              className=\"inline-flex items-center justify-center p-2 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150\"\n              title={t('common.close')}\n            >\n              <XMarkIcon className=\"w-5 h-5\" />\n            </button>\n          </div>\n          <ul className=\"px-2 py-1 max-h-64 overflow-y-auto\">\n            {sortedColumns.map((column, index) => {\n                const isVisible = visibleColumns.includes(column.id);\n                // Prfe ob diese Spalte die Hauptsortierung ist\n                const isMainSort = mainSortConfig?.key === column.id;\n                const sortDirection = isMainSort ? mainSortConfig.direction : undefined;\n                // Sort-Button fr alle Spalten anzeigen (unabhngig von Sichtbarkeit)\n                const showSortButton = showMainSort && onMainSortChange;\n                \n                return (\n                  <DraggableColumnItem\n                    key={column.id}\n                    id={column.id}\n                    label={column.label}\n                    index={index}\n                    isVisible={isVisible}\n                    onToggleVisibility={onToggleColumnVisibility}\n                    sortDirection={sortDirection}\n                    onSortDirectionChange={showSortButton ? onMainSortChange : undefined}\n                    showMainSort={showMainSort}\n                    isMainSort={isMainSort}\n                  />\n                );\n              })}\n          </ul>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default TableColumnConfig; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, UserIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface CertificateCreationModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCertificateCreated: () => void;\n  userId: number;\n  userName: string;\n}\n\ninterface UserData {\n  firstName: string;\n  lastName: string;\n  identificationNumber: string | null;\n  contractStartDate: string | null;\n  contractEndDate: string | null;\n  contractType: string | null;\n  salary: number | null;\n  position: string | null;\n}\n\nconst CertificateCreationModal: React.FC<CertificateCreationModalProps> = ({\n  isOpen,\n  onClose,\n  onCertificateCreated,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { user: currentUser } = useAuth();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [activeTab, setActiveTab] = useState<'data' | 'text'>('data');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [userData, setUserData] = useState<UserData | null>(null);\n  const [issueDate, setIssueDate] = useState(new Date().toISOString().split('T')[0]);\n  const [certificateType, setCertificateType] = useState('employment');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [uploading, setUploading] = useState(false);\n  const [availableTemplates, setAvailableTemplates] = useState<Array<{type: string; version: string; path: string}>>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null);\n  const [useTemplate, setUseTemplate] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitszeugnisse erstellen', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      fetchUserData();\n      fetchTemplates();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const fetchTemplates = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      const templates: Array<{type: string; version: string; path: string}> = [];\n      \n      if (documentTemplates.employmentCertificate) {\n        templates.push({\n          type: 'employmentCertificate',\n          version: documentTemplates.employmentCertificate.version,\n          path: documentTemplates.employmentCertificate.path\n        });\n      }\n      \n      setAvailableTemplates(templates);\n      if (templates.length > 0) {\n        setSelectedTemplate(templates[0].type);\n        setUseTemplate(true);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Templates:', err);\n      // Kein Fehler anzeigen, Templates sind optional\n    }\n  };\n\n  const fetchUserData = async () => {\n    try {\n      const [userResponse, lifecycleResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.USERS.BY_ID(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId))\n      ]);\n\n      const user = userResponse.data;\n      const lifecycle = lifecycleResponse.data.lifecycle;\n\n      const userDataObj = {\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        identificationNumber: user.identificationNumber || null,\n        contractStartDate: lifecycle?.contractStartDate || null,\n        contractEndDate: lifecycle?.contractEndDate || null,\n        contractType: lifecycle?.contractType || null,\n        salary: user.salary || null,\n        position: null // TODO: Aus Rollen ableiten\n      };\n\n      setUserData(userDataObj);\n\n      // Automatische Vorausfllung: Ausstellungsdatum auf heute setzen (wenn noch nicht gesetzt)\n      if (!issueDate || issueDate === new Date().toISOString().split('T')[0]) {\n        setIssueDate(new Date().toISOString().split('T')[0]);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der User-Daten:', err);\n      setError('Fehler beim Laden der Daten');\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) { // 10MB\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      setUseTemplate(false); // Deaktiviere Template wenn PDF hochgeladen wird\n      // Erstelle Preview-URL\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n    }\n  };\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const validateForm = (): string | null => {\n    if (!useTemplate && !pdfFile) {\n      return 'Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch';\n    }\n    if (!issueDate) {\n      return 'Bitte geben Sie ein Ausstellungsdatum an';\n    }\n    const issueDateObj = new Date(issueDate);\n    if (isNaN(issueDateObj.getTime())) {\n      return 'Ungltiges Ausstellungsdatum';\n    }\n    if (issueDateObj > new Date()) {\n      return 'Ausstellungsdatum darf nicht in der Zukunft liegen';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Client-seitige Validierung\n    const validationError = validateForm();\n    if (validationError) {\n      setError(validationError);\n      showMessage(validationError, 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      let pdfPath: string | undefined = undefined;\n      let templateUsed: string | null = null;\n      let templateVersion: string | null = null;\n\n      // Wenn Template verwendet werden soll und kein PDF hochgeladen wurde\n      if (useTemplate && selectedTemplate && !pdfFile) {\n        const template = availableTemplates.find(t => t.type === selectedTemplate);\n        if (template) {\n          templateUsed = template.type;\n          templateVersion = template.version;\n          // PDF wird vom Backend generiert\n        }\n      } else if (pdfFile) {\n        // PDF wurde hochgeladen - verwende dieses\n        pdfPath = `temp-${Date.now()}-${pdfFile.name}`; // Temporr\n      } else {\n        showMessage('Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch', 'error');\n        setLoading(false);\n        return;\n      }\n\n      const certificateData = {\n        certificateType,\n        issueDate: new Date(issueDate),\n        pdfPath,\n        templateUsed,\n        templateVersion\n      };\n\n      await axiosInstance.post(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATES(userId),\n        certificateData\n      );\n\n      showMessage('Arbeitszeugnis erfolgreich erstellt', 'success');\n      onCertificateCreated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      setIssueDate(new Date().toISOString().split('T')[0]);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Erstellen des Arbeitszeugnisses:', err);\n      setError(err.response?.data?.message || 'Fehler beim Erstellen des Arbeitszeugnisses');\n      showMessage('Fehler beim Erstellen des Arbeitszeugnisses', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {/* Overlay - nur auf Mobile und Desktop (nicht Large Desktop) */}\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n          style={{\n            animation: isMobile ? 'none' : 'slideIn 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94)'\n          }}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitszeugnis erstellen\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Fr: <span className=\"font-medium dark:text-white\">{userName}</span>\n              </p>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n              <nav className=\"-mb-px flex space-x-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('data')}\n                  className={`${\n                    activeTab === 'data'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Daten\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('text')}\n                  className={`${\n                    activeTab === 'text'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  PDF hochladen\n                </button>\n              </nav>\n            </div>\n\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            {/* Tab Content */}\n            {activeTab === 'data' && (\n              <div className=\"space-y-4\">\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4\">\n                  <h3 className=\"text-sm font-semibold dark:text-white mb-3\">\n                    Automatisch erkannte Daten\n                  </h3>\n                  <div className=\"space-y-2 text-sm\">\n                    {userData && (\n                      <>\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4 text-gray-400\" />\n                          <span className=\"text-gray-600 dark:text-gray-400\">Name:</span>\n                          <span className=\"dark:text-white\">\n                            {userData.firstName} {userData.lastName}\n                          </span>\n                        </div>\n                        {userData.identificationNumber && (\n                          <div className=\"flex items-center space-x-2\">\n                            <DocumentTextIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Cdula:</span>\n                            <span className=\"dark:text-white\">{userData.identificationNumber}</span>\n                          </div>\n                        )}\n                        {userData.contractStartDate && (\n                          <div className=\"flex items-center space-x-2\">\n                            <CalendarIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Eintrittsdatum:</span>\n                            <span className=\"dark:text-white\">\n                              {new Date(userData.contractStartDate).toLocaleDateString('de-DE')}\n                            </span>\n                          </div>\n                        )}\n                        {userData.contractEndDate && (\n                          <div className=\"flex items-center space-x-2\">\n                            <CalendarIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Austrittsdatum:</span>\n                            <span className=\"dark:text-white\">\n                              {new Date(userData.contractEndDate).toLocaleDateString('de-DE')}\n                            </span>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Ausstellungsdatum <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={issueDate}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setIssueDate(value);\n                      // Validierung: Datum darf nicht in der Zukunft liegen\n                      if (value && new Date(value) > new Date()) {\n                        setError('Ausstellungsdatum darf nicht in der Zukunft liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    max={new Date().toISOString().split('T')[0]}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && issueDate && new Date(issueDate) > new Date()\n                        ? 'border-red-500 dark:border-red-500' \n                        : error && !issueDate\n                        ? 'border-red-500 dark:border-red-500'\n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    required\n                    aria-invalid={(!issueDate || (issueDate && new Date(issueDate) > new Date())) ? true : undefined}\n                    aria-describedby={(!issueDate || (issueDate && new Date(issueDate) > new Date())) ? \"issueDate-error\" : undefined}\n                  />\n                  {error && (!issueDate || (issueDate && new Date(issueDate) > new Date())) && (\n                    <p id=\"issueDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                  {!error && (\n                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                      Das Datum darf nicht in der Zukunft liegen\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Zertifikat-Typ <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={certificateType}\n                    onChange={(e) => setCertificateType(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    required\n                  >\n                    <option value=\"employment\">Arbeitszeugnis</option>\n                    <option value=\"salary\">Gehaltsbescheinigung</option>\n                    <option value=\"work_experience\">Arbeitsbescheinigung</option>\n                  </select>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'text' && (\n              <div className=\"space-y-4\">\n                {/* Template-Auswahl */}\n                {availableTemplates.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Template verwenden\n                    </label>\n                    <div className=\"flex items-center space-x-3 mb-4\">\n                      <input\n                        type=\"checkbox\"\n                        checked={useTemplate}\n                        onChange={(e) => {\n                          setUseTemplate(e.target.checked);\n                          if (e.target.checked && pdfFile) {\n                            // Wenn Template aktiviert wird, entferne PDF\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      />\n                      <label className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        Template fr automatische PDF-Generierung verwenden\n                      </label>\n                    </div>\n                    {useTemplate && (\n                      <select\n                        value={selectedTemplate || ''}\n                        onChange={(e) => setSelectedTemplate(e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4\"\n                      >\n                        {availableTemplates.map((template) => (\n                          <option key={template.type} value={template.type}>\n                            Arbeitszeugnis (Version {template.version})\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    {useTemplate ? 'ODER PDF-Datei hochladen' : 'PDF-Datei hochladen'} {!useTemplate && <span className=\"text-red-500\">*</span>}\n                  </label>\n                  <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\".pdf\"\n                      onChange={handleFileSelect}\n                      className=\"hidden\"\n                    />\n                    {!pdfFile ? (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => fileInputRef.current?.click()}\n                          className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                        >\n                          PDF-Datei auswhlen\n                        </button>\n                        <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                          oder Datei hierher ziehen\n                        </p>\n                        <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                          Max. 10MB\n                        </p>\n                      </div>\n                    ) : (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                        <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                          {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                        </p>\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                            if (fileInputRef.current) {\n                              fileInputRef.current.value = '';\n                            }\n                          }}\n                          className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                        >\n                          Datei entfernen\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* PDF-Vorschau */}\n                {pdfPreviewUrl && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl}#view=FitH`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || (!pdfFile && !useTemplate)}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird erstellt...' : 'Erstellen'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default CertificateCreationModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, UserIcon, CurrencyDollarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface ContractCreationModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onContractCreated: () => void;\n  userId: number;\n  userName: string;\n}\n\ninterface UserData {\n  firstName: string;\n  lastName: string;\n  identificationNumber: string | null;\n  contractStartDate: string | null;\n  contractEndDate: string | null;\n  contractType: string | null;\n  salary: number | null;\n  position: string | null;\n}\n\nconst ContractCreationModal: React.FC<ContractCreationModalProps> = ({\n  isOpen,\n  onClose,\n  onContractCreated,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { user: currentUser } = useAuth();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [activeTab, setActiveTab] = useState<'data' | 'text'>('data');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [userData, setUserData] = useState<UserData | null>(null);\n  const [contractType, setContractType] = useState('employment');\n  const [startDate, setStartDate] = useState(new Date().toISOString().split('T')[0]);\n  const [endDate, setEndDate] = useState<string>('');\n  const [salary, setSalary] = useState<string>('');\n  const [workingHours, setWorkingHours] = useState<string>('');\n  const [position, setPosition] = useState<string>('');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [availableTemplates, setAvailableTemplates] = useState<Array<{type: string; version: string; path: string}>>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null);\n  const [useTemplate, setUseTemplate] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitsvertrge erstellen', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      fetchUserData();\n      fetchTemplates();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const fetchTemplates = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      const templates: Array<{type: string; version: string; path: string}> = [];\n      \n      if (documentTemplates.employmentContract) {\n        templates.push({\n          type: 'employmentContract',\n          version: documentTemplates.employmentContract.version,\n          path: documentTemplates.employmentContract.path\n        });\n      }\n      \n      setAvailableTemplates(templates);\n      if (templates.length > 0) {\n        setSelectedTemplate(templates[0].type);\n        setUseTemplate(true);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Templates:', err);\n      // Kein Fehler anzeigen, Templates sind optional\n    }\n  };\n\n  const fetchUserData = async () => {\n    try {\n      const [userResponse, lifecycleResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.USERS.BY_ID(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId))\n      ]);\n\n      const user = userResponse.data;\n      const lifecycle = lifecycleResponse.data.lifecycle;\n\n      const data: UserData = {\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        identificationNumber: user.identificationNumber || null,\n        contractStartDate: lifecycle?.contractStartDate || null,\n        contractEndDate: lifecycle?.contractEndDate || null,\n        contractType: lifecycle?.contractType || null,\n        salary: user.salary || null,\n        position: null\n      };\n\n      setUserData(data);\n      \n      // Setze Standard-Werte\n      if (data.contractStartDate) {\n        setStartDate(new Date(data.contractStartDate).toISOString().split('T')[0]);\n      }\n      if (data.contractEndDate) {\n        setEndDate(new Date(data.contractEndDate).toISOString().split('T')[0]);\n      }\n      if (data.salary) {\n        setSalary(data.salary.toString());\n      }\n      if (data.contractType) {\n        setContractType(data.contractType);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der User-Daten:', err);\n      setError('Fehler beim Laden der Daten');\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) { // 10MB\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      setUseTemplate(false); // Deaktiviere Template wenn PDF hochgeladen wird\n      // Erstelle Preview-URL\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n    }\n  };\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const validateForm = (): string | null => {\n    if (!useTemplate && !pdfFile) {\n      return 'Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch';\n    }\n    if (!startDate) {\n      return 'Bitte geben Sie ein Startdatum an';\n    }\n    const startDateObj = new Date(startDate);\n    if (isNaN(startDateObj.getTime())) {\n      return 'Ungltiges Startdatum';\n    }\n    if (endDate) {\n      const endDateObj = new Date(endDate);\n      if (isNaN(endDateObj.getTime())) {\n        return 'Ungltiges Enddatum';\n      }\n      if (endDateObj < startDateObj) {\n        return 'Enddatum muss nach dem Startdatum liegen';\n      }\n    }\n    if (salary && parseFloat(salary) < 0) {\n      return 'Gehalt darf nicht negativ sein';\n    }\n    if (workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)) {\n      return 'Arbeitsstunden mssen zwischen 0 und 168 liegen';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Client-seitige Validierung\n    const validationError = validateForm();\n    if (validationError) {\n      setError(validationError);\n      showMessage(validationError, 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      let pdfPath: string | undefined = undefined;\n      let templateUsed: string | null = null;\n      let templateVersion: string | null = null;\n\n      // Wenn Template verwendet werden soll und kein PDF hochgeladen wurde\n      if (useTemplate && selectedTemplate && !pdfFile) {\n        const template = availableTemplates.find(t => t.type === selectedTemplate);\n        if (template) {\n          templateUsed = template.type;\n          templateVersion = template.version;\n          // PDF wird vom Backend generiert\n        }\n      } else if (pdfFile) {\n        // PDF wurde hochgeladen - verwende dieses\n        pdfPath = `temp-${Date.now()}-${pdfFile.name}`; // Temporr\n      } else {\n        showMessage('Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch', 'error');\n        setLoading(false);\n        return;\n      }\n\n      const contractData = {\n        contractType,\n        startDate: new Date(startDate),\n        endDate: endDate ? new Date(endDate) : null,\n        salary: salary ? parseFloat(salary) : null,\n        workingHours: workingHours ? parseFloat(workingHours) : null,\n        position: position || null,\n        pdfPath,\n        templateUsed,\n        templateVersion\n      };\n\n      await axiosInstance.post(\n        API_ENDPOINTS.LIFECYCLE.CONTRACTS(userId),\n        contractData\n      );\n\n      showMessage('Arbeitsvertrag erfolgreich erstellt', 'success');\n      onContractCreated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      setStartDate(new Date().toISOString().split('T')[0]);\n      setEndDate('');\n      setSalary('');\n      setWorkingHours('');\n      setPosition('');\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Erstellen des Arbeitsvertrags:', err);\n      setError(err.response?.data?.message || 'Fehler beim Erstellen des Arbeitsvertrags');\n      showMessage('Fehler beim Erstellen des Arbeitsvertrags', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {/* Overlay */}\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitsvertrag erstellen\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Fr: <span className=\"font-medium dark:text-white\">{userName}</span>\n              </p>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n              <nav className=\"-mb-px flex space-x-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('data')}\n                  className={`${\n                    activeTab === 'data'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Vertragsdaten\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('text')}\n                  className={`${\n                    activeTab === 'text'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  PDF hochladen\n                </button>\n              </nav>\n            </div>\n\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            {/* Tab Content */}\n            {activeTab === 'data' && (\n              <div className=\"space-y-4\">\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4\">\n                  <h3 className=\"text-sm font-semibold dark:text-white mb-3\">\n                    Automatisch erkannte Daten\n                  </h3>\n                  <div className=\"space-y-2 text-sm\">\n                    {userData && (\n                      <>\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4 text-gray-400\" />\n                          <span className=\"text-gray-600 dark:text-gray-400\">Name:</span>\n                          <span className=\"dark:text-white\">\n                            {userData.firstName} {userData.lastName}\n                          </span>\n                        </div>\n                        {userData.identificationNumber && (\n                          <div className=\"flex items-center space-x-2\">\n                            <DocumentTextIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Cdula:</span>\n                            <span className=\"dark:text-white\">{userData.identificationNumber}</span>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Vertragstyp <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={contractType}\n                    onChange={(e) => setContractType(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  >\n                    <option value=\"employment\">Arbeitsvertrag</option>\n                    <option value=\"amendment\">Vertragsnderung</option>\n                    <option value=\"extension\">Vertragsverlngerung</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Startdatum <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={startDate}\n                    onChange={(e) => {\n                      setStartDate(e.target.value);\n                      setError(null); // Clear error when user starts typing\n                    }}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && !startDate \n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    required\n                    aria-invalid={!startDate}\n                    aria-describedby={!startDate ? \"startDate-error\" : undefined}\n                  />\n                  {error && !startDate && (\n                    <p id=\"startDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Enddatum (optional)\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={endDate}\n                    onChange={(e) => {\n                      setEndDate(e.target.value);\n                      // Wenn Enddatum gesetzt wird, prfe ob es nach Startdatum liegt\n                      if (e.target.value && startDate && new Date(e.target.value) < new Date(startDate)) {\n                        setError('Enddatum muss nach dem Startdatum liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    min={startDate || undefined}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && endDate && startDate && new Date(endDate) < new Date(startDate)\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    aria-invalid={endDate && startDate && new Date(endDate) < new Date(startDate) ? true : undefined}\n                    aria-describedby={endDate && startDate && new Date(endDate) < new Date(startDate) ? \"endDate-error\" : undefined}\n                  />\n                  {error && endDate && startDate && new Date(endDate) < new Date(startDate) && (\n                    <p id=\"endDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Position\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={position}\n                    onChange={(e) => setPosition(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    placeholder=\"z.B. Frontend-Entwickler\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Gehalt (optional)\n                  </label>\n                  <div className=\"relative\">\n                    <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                    <input\n                      type=\"number\"\n                      value={salary}\n                      onChange={(e) => {\n                        const value = e.target.value;\n                        setSalary(value);\n                        // Validierung: Gehalt darf nicht negativ sein\n                        if (value && parseFloat(value) < 0) {\n                          setError('Gehalt darf nicht negativ sein');\n                        } else {\n                          setError(null); // Clear error when valid\n                        }\n                      }}\n                      className={`w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                        error && salary && parseFloat(salary) < 0\n                          ? 'border-red-500 dark:border-red-500' \n                          : 'border-gray-300 dark:border-gray-600'\n                      }`}\n                      placeholder=\"0.00\"\n                      step=\"0.01\"\n                      min=\"0\"\n                      aria-invalid={salary && parseFloat(salary) < 0 ? true : undefined}\n                      aria-describedby={salary && parseFloat(salary) < 0 ? \"salary-error\" : undefined}\n                    />\n                  </div>\n                  {error && salary && parseFloat(salary) < 0 && (\n                    <p id=\"salary-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Arbeitsstunden/Woche (optional)\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={workingHours}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setWorkingHours(value);\n                      // Validierung: Arbeitsstunden mssen zwischen 0 und 168 liegen\n                      if (value && (parseFloat(value) < 0 || parseFloat(value) > 168)) {\n                        setError('Arbeitsstunden mssen zwischen 0 und 168 liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    placeholder=\"40\"\n                    step=\"0.1\"\n                    min=\"0\"\n                    max=\"168\"\n                    aria-invalid={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? true : undefined}\n                    aria-describedby={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? \"workingHours-error\" : undefined}\n                  />\n                  {error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) && (\n                    <p id=\"workingHours-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                    Maximal 168 Stunden pro Woche (24h  7 Tage)\n                  </p>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'text' && (\n              <div className=\"space-y-4\">\n                {/* Template-Auswahl */}\n                {availableTemplates.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Template verwenden\n                    </label>\n                    <div className=\"flex items-center space-x-3 mb-4\">\n                      <input\n                        type=\"checkbox\"\n                        checked={useTemplate}\n                        onChange={(e) => {\n                          setUseTemplate(e.target.checked);\n                          if (e.target.checked && pdfFile) {\n                            // Wenn Template aktiviert wird, entferne PDF\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      />\n                      <label className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        Template fr automatische PDF-Generierung verwenden\n                      </label>\n                    </div>\n                    {useTemplate && (\n                      <select\n                        value={selectedTemplate || ''}\n                        onChange={(e) => setSelectedTemplate(e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4\"\n                      >\n                        {availableTemplates.map((template) => (\n                          <option key={template.type} value={template.type}>\n                            Arbeitsvertrag (Version {template.version})\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    {useTemplate ? 'ODER PDF-Datei hochladen' : 'PDF-Datei hochladen'} {!useTemplate && <span className=\"text-red-500\">*</span>}\n                  </label>\n                  <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\".pdf\"\n                      onChange={handleFileSelect}\n                      className=\"hidden\"\n                    />\n                    {!pdfFile ? (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => fileInputRef.current?.click()}\n                          className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                        >\n                          PDF-Datei auswhlen\n                        </button>\n                        <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                          oder Datei hierher ziehen\n                        </p>\n                        <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                          Max. 10MB\n                        </p>\n                      </div>\n                    ) : (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                        <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                          {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                        </p>\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                            if (fileInputRef.current) {\n                              fileInputRef.current.value = '';\n                            }\n                          }}\n                          className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                        >\n                          Datei entfernen\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* PDF-Vorschau */}\n                {pdfPreviewUrl && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl}#view=FitH`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || (!pdfFile && !useTemplate) || !startDate}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird erstellt...' : 'Erstellen'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default ContractCreationModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Certificate {\n  id: number;\n  certificateType: string;\n  issueDate: string;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n}\n\ninterface CertificateEditModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCertificateUpdated: () => void;\n  userId: number;\n  certificate: Certificate;\n}\n\nconst CertificateEditModal: React.FC<CertificateEditModalProps> = ({\n  isOpen,\n  onClose,\n  onCertificateUpdated,\n  userId,\n  certificate\n}) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [issueDate, setIssueDate] = useState(\n    certificate.issueDate ? new Date(certificate.issueDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]\n  );\n  const [certificateType, setCertificateType] = useState(certificate.certificateType || 'employment');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [existingPdfUrl, setExistingPdfUrl] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitszeugnisse bearbeiten', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Lade bestehende PDF-URL wenn vorhanden\n      if (certificate.id) {\n        setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certificate.id));\n      }\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane, certificate.id, userId]);\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) {\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      // Erstelle Preview-URL fr neue Datei\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n      setExistingPdfUrl(null); // Verstecke bestehende PDF wenn neue hochgeladen wird\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const updateData: any = {\n        issueDate: new Date(issueDate),\n        certificateType\n      };\n\n      // Nur pdfPath aktualisieren, wenn neue Datei hochgeladen wurde\n      if (pdfFile) {\n        updateData.pdfPath = `temp-${Date.now()}-${pdfFile.name}`;\n        updateData.templateVersion = certificate.templateVersion || '1.0';\n      }\n\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATE(userId, certificate.id),\n        updateData\n      );\n\n      showMessage('Arbeitszeugnis erfolgreich aktualisiert', 'success');\n      onCertificateUpdated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Aktualisieren des Arbeitszeugnisses:', err);\n      setError(err.response?.data?.message || 'Fehler beim Aktualisieren des Arbeitszeugnisses');\n      showMessage('Fehler beim Aktualisieren des Arbeitszeugnisses', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitszeugnis bearbeiten\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Ausstellungsdatum\n                </label>\n                <input\n                  type=\"date\"\n                  value={issueDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setIssueDate(value);\n                    // Validierung: Datum darf nicht in der Zukunft liegen\n                    if (value && new Date(value) > new Date()) {\n                      setError('Ausstellungsdatum darf nicht in der Zukunft liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  max={new Date().toISOString().split('T')[0]}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && issueDate && new Date(issueDate) > new Date()\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  aria-invalid={issueDate && new Date(issueDate) > new Date() ? true : undefined}\n                  aria-describedby={issueDate && new Date(issueDate) > new Date() ? \"issueDate-error\" : undefined}\n                />\n                {error && issueDate && new Date(issueDate) > new Date() && (\n                  <p id=\"issueDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n                {!error && (\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                    Das Datum darf nicht in der Zukunft liegen\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Zertifikat-Typ\n                </label>\n                <select\n                  value={certificateType}\n                  onChange={(e) => setCertificateType(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                >\n                  <option value=\"employment\">Arbeitszeugnis</option>\n                  <option value=\"salary\">Gehaltsbescheinigung</option>\n                  <option value=\"work_experience\">Arbeitsbescheinigung</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  PDF-Datei aktualisieren (optional)\n                </label>\n                <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  {!pdfFile ? (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                      <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                      >\n                        Neue PDF-Datei auswhlen\n                      </button>\n                      <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                        oder Datei hierher ziehen\n                      </p>\n                      <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                        Max. 10MB\n                      </p>\n                    </div>\n                  ) : (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                      <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                        {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          setPdfFile(null);\n                          if (pdfPreviewUrl) {\n                            URL.revokeObjectURL(pdfPreviewUrl);\n                            setPdfPreviewUrl(null);\n                          }\n                          setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certificate.id));\n                          if (fileInputRef.current) {\n                            fileInputRef.current.value = '';\n                          }\n                        }}\n                        className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                      >\n                        Datei entfernen\n                      </button>\n                    </div>\n                  )}\n                </div>\n\n                {/* PDF-Vorschau */}\n                {(pdfPreviewUrl || existingPdfUrl) && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl || existingPdfUrl}${pdfPreviewUrl ? '#view=FitH' : '?preview=true#view=FitH'}`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4\">\n                <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n                  <strong>Hinweis:</strong> Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt.\n                  Eine neue Version wird erstellt (isLatest = true).\n                </p>\n              </div>\n            </form>\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird aktualisiert...' : 'Aktualisieren'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default CertificateEditModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, CurrencyDollarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Contract {\n  id: number;\n  contractType: string;\n  startDate: string;\n  endDate: string | null;\n  salary: number | null;\n  workingHours: number | null;\n  position: string | null;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n}\n\ninterface ContractEditModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onContractUpdated: () => void;\n  userId: number;\n  contract: Contract;\n}\n\nconst ContractEditModal: React.FC<ContractEditModalProps> = ({\n  isOpen,\n  onClose,\n  onContractUpdated,\n  userId,\n  contract\n}) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [contractType, setContractType] = useState(contract.contractType || 'employment');\n  const [startDate, setStartDate] = useState(\n    contract.startDate ? new Date(contract.startDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]\n  );\n  const [endDate, setEndDate] = useState(\n    contract.endDate ? new Date(contract.endDate).toISOString().split('T')[0] : ''\n  );\n  const [salary, setSalary] = useState(contract.salary ? contract.salary.toString() : '');\n  const [workingHours, setWorkingHours] = useState(contract.workingHours ? contract.workingHours.toString() : '');\n  const [position, setPosition] = useState(contract.position || '');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [existingPdfUrl, setExistingPdfUrl] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitsvertrge bearbeiten', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Lade bestehende PDF-URL wenn vorhanden\n      if (contract.id) {\n        setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contract.id));\n      }\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane, contract.id, userId]);\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) {\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      // Erstelle Preview-URL fr neue Datei\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n      setExistingPdfUrl(null); // Verstecke bestehende PDF wenn neue hochgeladen wird\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!startDate) {\n      showMessage('Bitte geben Sie ein Startdatum an', 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const updateData: any = {\n        contractType,\n        startDate: new Date(startDate),\n        endDate: endDate ? new Date(endDate) : null,\n        salary: salary ? parseFloat(salary) : null,\n        workingHours: workingHours ? parseFloat(workingHours) : null,\n        position: position || null\n      };\n\n      // Nur pdfPath aktualisieren, wenn neue Datei hochgeladen wurde\n      if (pdfFile) {\n        updateData.pdfPath = `temp-${Date.now()}-${pdfFile.name}`;\n        updateData.templateVersion = contract.templateVersion || '1.0';\n      }\n\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.CONTRACT(userId, contract.id),\n        updateData\n      );\n\n      showMessage('Arbeitsvertrag erfolgreich aktualisiert', 'success');\n      onContractUpdated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Aktualisieren des Arbeitsvertrags:', err);\n      setError(err.response?.data?.message || 'Fehler beim Aktualisieren des Arbeitsvertrags');\n      showMessage('Fehler beim Aktualisieren des Arbeitsvertrags', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitsvertrag bearbeiten\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Vertragstyp <span className=\"text-red-500\">*</span>\n                </label>\n                <select\n                  value={contractType}\n                  onChange={(e) => setContractType(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                >\n                  <option value=\"employment\">Arbeitsvertrag</option>\n                  <option value=\"amendment\">Vertragsnderung</option>\n                  <option value=\"extension\">Vertragsverlngerung</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Startdatum <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"date\"\n                  value={startDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setStartDate(value);\n                    // Wenn Enddatum gesetzt ist, prfe ob es nach Startdatum liegt\n                    if (endDate && value && new Date(endDate) < new Date(value)) {\n                      setError('Enddatum muss nach dem Startdatum liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && !startDate \n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  required\n                  aria-invalid={!startDate ? true : undefined}\n                  aria-describedby={!startDate ? \"startDate-error\" : undefined}\n                />\n                {error && !startDate && (\n                  <p id=\"startDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Enddatum (optional)\n                </label>\n                <input\n                  type=\"date\"\n                  value={endDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setEndDate(value);\n                    // Wenn Enddatum gesetzt wird, prfe ob es nach Startdatum liegt\n                    if (value && startDate && new Date(value) < new Date(startDate)) {\n                      setError('Enddatum muss nach dem Startdatum liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  min={startDate || undefined}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && endDate && startDate && new Date(endDate) < new Date(startDate)\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  aria-invalid={endDate && startDate && new Date(endDate) < new Date(startDate) ? true : undefined}\n                  aria-describedby={endDate && startDate && new Date(endDate) < new Date(startDate) ? \"endDate-error\" : undefined}\n                />\n                {error && endDate && startDate && new Date(endDate) < new Date(startDate) && (\n                  <p id=\"endDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Position\n                </label>\n                <input\n                  type=\"text\"\n                  value={position}\n                  onChange={(e) => setPosition(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  placeholder=\"z.B. Frontend-Entwickler\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Gehalt (optional)\n                </label>\n                <div className=\"relative\">\n                  <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                  <input\n                    type=\"number\"\n                    value={salary}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setSalary(value);\n                      // Validierung: Gehalt darf nicht negativ sein\n                      if (value && parseFloat(value) < 0) {\n                        setError('Gehalt darf nicht negativ sein');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    className={`w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && salary && parseFloat(salary) < 0\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    placeholder=\"0.00\"\n                    step=\"0.01\"\n                    min=\"0\"\n                    aria-invalid={salary && parseFloat(salary) < 0 ? true : undefined}\n                    aria-describedby={salary && parseFloat(salary) < 0 ? \"salary-error\" : undefined}\n                  />\n                </div>\n                {error && salary && parseFloat(salary) < 0 && (\n                  <p id=\"salary-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Arbeitsstunden/Woche (optional)\n                </label>\n                <input\n                  type=\"number\"\n                  value={workingHours}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setWorkingHours(value);\n                    // Validierung: Arbeitsstunden mssen zwischen 0 und 168 liegen\n                    if (value && (parseFloat(value) < 0 || parseFloat(value) > 168)) {\n                      setError('Arbeitsstunden mssen zwischen 0 und 168 liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  placeholder=\"40\"\n                  step=\"0.1\"\n                  min=\"0\"\n                  max=\"168\"\n                  aria-invalid={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? true : undefined}\n                  aria-describedby={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? \"workingHours-error\" : undefined}\n                />\n                {error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) && (\n                  <p id=\"workingHours-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  Maximal 168 Stunden pro Woche (24h  7 Tage)\n                </p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  PDF-Datei aktualisieren (optional)\n                </label>\n                <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  {!pdfFile ? (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                      <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                      >\n                        Neue PDF-Datei auswhlen\n                      </button>\n                      <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                        oder Datei hierher ziehen\n                      </p>\n                      <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                        Max. 10MB\n                      </p>\n                    </div>\n                  ) : (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                      <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                        {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          setPdfFile(null);\n                          if (pdfPreviewUrl) {\n                            URL.revokeObjectURL(pdfPreviewUrl);\n                            setPdfPreviewUrl(null);\n                          }\n                          setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contract.id));\n                          if (fileInputRef.current) {\n                            fileInputRef.current.value = '';\n                          }\n                        }}\n                        className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                      >\n                        Datei entfernen\n                      </button>\n                    </div>\n                  )}\n                </div>\n\n                {/* PDF-Vorschau */}\n                {(pdfPreviewUrl || existingPdfUrl) && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl || existingPdfUrl}${pdfPreviewUrl ? '#view=FitH' : '?preview=true#view=FitH'}`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4\">\n                <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n                  <strong>Hinweis:</strong> Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt.\n                  Eine neue Version wird erstellt (isLatest = true).\n                </p>\n              </div>\n            </form>\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || !startDate}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird aktualisiert...' : 'Aktualisieren'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default ContractEditModal;\n\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n  CheckCircleIcon,\n  ClockIcon,\n  XCircleIcon,\n  PencilIcon,\n  EnvelopeIcon,\n  DocumentTextIcon,\n  XMarkIcon,\n  ArrowPathIcon\n} from '@heroicons/react/24/outline';\n// Social Security Editor Component\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface SocialSecurityRegistration {\n  id: number;\n  registrationType: string;\n  registrationNumber: string | null;\n  provider: string | null;\n  registrationDate: string | null;\n  status: string;\n  notes: string | null;\n  completedAt: string | null;\n}\n\ninterface SocialSecurityEditorProps {\n  userId: number;\n  lifecycleId: number;\n  onUpdate?: () => void;\n}\n\ntype SocialSecurityType = 'arl' | 'eps' | 'pension' | 'caja';\n\nconst SocialSecurityEditor: React.FC<SocialSecurityEditorProps> = ({\n  userId,\n  lifecycleId,\n  onUpdate\n}) => {\n  const { t } = useTranslation();\n  const { isLegal, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  \n  const [registrations, setRegistrations] = useState<Record<SocialSecurityType, SocialSecurityRegistration | null>>({\n    arl: null,\n    eps: null,\n    pension: null,\n    caja: null\n  });\n  const [loading, setLoading] = useState(true);\n  const [editingType, setEditingType] = useState<SocialSecurityType | null>(null);\n  const [formData, setFormData] = useState({\n    status: 'pending' as string,\n    registrationNumber: '',\n    provider: '',\n    registrationDate: '',\n    notes: ''\n  });\n  const [saving, setSaving] = useState(false);\n  const loadingRef = useRef(false);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  // loadRegistrations auerhalb von useEffect definieren, damit es von handleSave aufgerufen werden kann\n  const loadRegistrations = useCallback(async () => {\n    // Erstelle neuen AbortController\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n    const abortController = new AbortController();\n    abortControllerRef.current = abortController;\n\n    loadingRef.current = true;\n    setLoading(true);\n    try {\n      const types: SocialSecurityType[] = ['arl', 'eps', 'pension', 'caja'];\n      const registrationPromises = types.map(async (type) => {\n        // Prfe ob Request abgebrochen wurde\n        if (abortController.signal.aborted) {\n          return { type, registration: null };\n        }\n\n        try {\n          const response = await axiosInstance.get(\n            API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, type),\n            {\n              timeout: 5000, // 5 Sekunden Timeout\n              signal: abortController.signal\n            }\n          );\n          return { type, registration: response.data };\n        } catch (error: any) {\n          // Ignoriere Abort-Errors (AbortError oder CanceledError von Axios)\n          if (error.name === 'AbortError' || error.name === 'CanceledError' || abortController.signal.aborted) {\n            return { type, registration: null };\n          }\n          // Behandle 404 als \"nicht vorhanden\" (normal)\n          if (error.response?.status === 404) {\n            return { type, registration: null };\n          }\n          // Behandle Network Errors und Timeouts\n          if (error.code === 'ERR_NETWORK' || error.code === 'ECONNABORTED' || error.message?.includes('ERR_INSUFFICIENT_RESOURCES')) {\n            console.warn(`Network error loading ${type}, treating as not found`);\n            return { type, registration: null };\n          }\n          console.error(`Error loading ${type}:`, error);\n          return { type, registration: null };\n        }\n      });\n\n      const results = await Promise.all(registrationPromises);\n      \n      // Prfe erneut ob Request abgebrochen wurde\n      if (abortController.signal.aborted) {\n        return;\n      }\n\n      const newRegistrations: Record<SocialSecurityType, SocialSecurityRegistration | null> = {\n        arl: null,\n        eps: null,\n        pension: null,\n        caja: null\n      };\n\n      results.forEach(({ type, registration }) => {\n        if (registration) {\n          // Backend gibt zurck: { id, type, status, number, provider, registeredAt, notes, completedAt }\n          // Mappe auf Frontend-Format: { id, registrationType, registrationNumber, provider, registrationDate, status, notes, completedAt }\n          newRegistrations[type as SocialSecurityType] = {\n            id: registration.id || 0,\n            registrationType: type,\n            registrationNumber: registration.number || registration.registrationNumber || null,\n            provider: registration.provider || null,\n            registrationDate: registration.registeredAt || registration.registrationDate || null,\n            status: registration.status || 'pending',\n            notes: registration.notes || null,\n            completedAt: registration.completedAt || null\n          };\n        }\n      });\n\n      setRegistrations(newRegistrations);\n    } catch (error: any) {\n      // Ignoriere Abort-Errors (AbortError oder CanceledError von Axios)\n      if (error.name === 'AbortError' || error.name === 'CanceledError' || abortController.signal.aborted) {\n        return;\n      }\n      console.error('Error loading registrations:', error);\n      showMessage(t('socialSecurity.loadError'), 'error');\n    } finally {\n      // Setze loading immer auf false, auch bei Abbruch\n      setLoading(false);\n      loadingRef.current = false;\n    }\n  }, [userId, t, showMessage]);\n\n  useEffect(() => {\n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      return;\n    }\n    \n    // Prfe Berechtigung und lade nur einmal pro userId/lifecycleId\n    const hasPermission = isLegal() || isAdmin();\n    if (!hasPermission || !userId || !lifecycleId) {\n      setLoading(false);\n      return;\n    }\n\n    // Verhindere mehrfaches gleichzeitiges Laden\n    if (loadingRef.current) {\n      return;\n    }\n\n    loadRegistrations();\n\n    // Cleanup: Breche Request ab wenn Component unmountet oder Dependencies sich ndern\n    return () => {\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n      loadingRef.current = false;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userId, lifecycleId, permissionsLoading]); // permissionsLoading als Dependency hinzugefgt\n\n  const handleEdit = (type: SocialSecurityType) => {\n    const registration = registrations[type];\n    if (registration) {\n      setFormData({\n        status: registration.status,\n        registrationNumber: registration.registrationNumber || '',\n        provider: registration.provider || '',\n        registrationDate: registration.registrationDate \n          ? new Date(registration.registrationDate).toISOString().split('T')[0]\n          : '',\n        notes: registration.notes || ''\n      });\n    } else {\n      setFormData({\n        status: 'pending',\n        registrationNumber: '',\n        provider: '',\n        registrationDate: '',\n        notes: ''\n      });\n    }\n    setEditingType(type);\n  };\n\n  const handleCancel = () => {\n    setEditingType(null);\n    setFormData({\n      status: 'pending',\n      registrationNumber: '',\n      provider: '',\n      registrationDate: '',\n      notes: ''\n    });\n  };\n\n  const handleSave = async () => {\n    if (!editingType) return;\n    \n    // Prfe Berechtigung nochmal vor dem Speichern\n    if (permissionsLoading) {\n      showMessage(t('common.loading', { defaultValue: 'Berechtigungen werden geladen...' }), 'warning');\n      return;\n    }\n    \n    if (!isLegal() && !isAdmin()) {\n      showMessage(t('lifecycle.noPermission', { defaultValue: 'Keine Berechtigung - nur Legal oder Admin' }), 'error');\n      return;\n    }\n\n    setSaving(true);\n    try {\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, editingType),\n        {\n          status: formData.status,\n          number: formData.registrationNumber || undefined,\n          provider: formData.provider || undefined,\n          registrationDate: formData.registrationDate \n            ? new Date(formData.registrationDate).toISOString()\n            : undefined,\n          notes: formData.notes || undefined\n        }\n      );\n\n      showMessage('Sozialversicherung erfolgreich aktualisiert', 'success');\n      setEditingType(null);\n      \n      // Warte kurz, damit Backend die Daten aktualisiert hat\n      await new Promise(resolve => setTimeout(resolve, 200));\n      \n      // Lade Registrierungen neu nach Update\n      await loadRegistrations();\n      \n      // onUpdate nur aufrufen, wenn es eine Funktion ist (verhindert Re-Render-Loops)\n      if (onUpdate && typeof onUpdate === 'function') {\n        // Rufe onUpdate auf, um LifecycleView zu aktualisieren\n        onUpdate();\n      }\n    } catch (error: any) {\n      console.error('Error updating social security:', error);\n      showMessage(\n        error.response?.data?.message || t('socialSecurity.updateError'),\n        'error'\n      );\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'registered':\n        return <CheckCircleIcon className=\"h-5 w-5 text-green-500\" />;\n      case 'pending':\n        return <ClockIcon className=\"h-5 w-5 text-yellow-500\" />;\n      case 'failed':\n        return <XCircleIcon className=\"h-5 w-5 text-red-500\" />;\n      case 'not_required':\n        return <CheckCircleIcon className=\"h-5 w-5 text-gray-400\" />;\n      case 'deregistered':\n        return <XCircleIcon className=\"h-5 w-5 text-gray-400\" />;\n      default:\n        return <ClockIcon className=\"h-5 w-5 text-gray-400\" />;\n    }\n  };\n\n  const getStatusLabel = (status: string) => {\n    const labelKey = `lifecycle.socialSecurityStatus.${status}`;\n    return t(labelKey) || status;\n  };\n\n  const getTypeLabel = (type: SocialSecurityType) => {\n    const labels: Record<SocialSecurityType, string> = {\n      arl: 'ARL (Risiko-Arbeit)',\n      eps: 'EPS (Gesundheit)',\n      pension: 'Pension',\n      caja: 'Caja de Compensacin'\n    };\n    return labels[type];\n  };\n\n  // Warte bis Berechtigungen geladen sind\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isLegal() && !isAdmin()) {\n    return null;\n  }\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  const types: SocialSecurityType[] = ['arl', 'eps', 'pension', 'caja'];\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n          <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n          {t('lifecycle.socialSecurity', { defaultValue: 'Sozialversicherungen' })}\n        </h3>\n      </div>\n\n      <div className=\"space-y-4\">\n        {types.map((type) => {\n          const registration = registrations[type];\n          const isEditing = editingType === type;\n\n          return (\n            <div\n              key={type}\n              className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\"\n            >\n              {!isEditing ? (\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex items-start space-x-3 flex-1\">\n                    {getStatusIcon(registration?.status || 'pending')}\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center space-x-2 mb-2\">\n                        <h4 className=\"font-medium dark:text-white uppercase\">\n                          {getTypeLabel(type)}\n                        </h4>\n                        <span className=\"text-sm font-medium dark:text-white\">\n                          {getStatusLabel(registration?.status || 'pending')}\n                        </span>\n                      </div>\n                      {registration && (\n                        <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                          {registration.provider && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.provider')}:</span> {registration.provider}\n                            </div>\n                          )}\n                          {registration.registrationNumber && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.number')}:</span> {registration.registrationNumber}\n                            </div>\n                          )}\n                          {registration.registrationDate && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.registrationDate')}:</span>{' '}\n                              {new Date(registration.registrationDate).toLocaleDateString('de-DE')}\n                            </div>\n                          )}\n                          {registration.notes && (\n                            <div className=\"mt-2\">\n                              <span className=\"font-medium\">{t('socialSecurity.notes')}:</span>\n                              <p className=\"text-gray-500 dark:text-gray-400 mt-1\">\n                                {registration.notes}\n                              </p>\n                            </div>\n                          )}\n                          {registration.completedAt && (\n                            <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\n                              {t('socialSecurity.completedAt')}{' '}\n                              {new Date(registration.completedAt).toLocaleDateString('de-DE')}\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      {!registration && (\n                        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                          {t('socialSecurity.notRegistered')}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                  <button\n                    onClick={() => handleEdit(type)}\n                    className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition ml-4\"\n                    title={t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  >\n                    <PencilIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium dark:text-white uppercase mb-3\">\n                    {t('socialSecurity.editType', { type: getTypeLabel(type) })}\n                  </h4>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('socialSecurity.status')} <span className=\"text-red-500\">*</span>\n                    </label>\n                    <select\n                      value={formData.status}\n                      onChange={(e) => setFormData({ ...formData, status: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    >\n                      <option value=\"not_required\">Nicht erforderlich</option>\n                      <option value=\"pending\">Ausstehend</option>\n                      <option value=\"registered\">Registriert</option>\n                      <option value=\"failed\">Fehlgeschlagen</option>\n                      <option value=\"deregistered\">Abgemeldet</option>\n                    </select>\n                  </div>\n\n                  {formData.status === 'registered' && (\n                    <>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.registrationNumber')}\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={formData.registrationNumber}\n                          onChange={(e) => setFormData({ ...formData, registrationNumber: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                          placeholder=\"z.B. 123456789\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.provider')}\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={formData.provider}\n                          onChange={(e) => setFormData({ ...formData, provider: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                          placeholder=\"z.B. ARL Sura, EPS Sanitas\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.registrationDate')}\n                        </label>\n                        <input\n                          type=\"date\"\n                          value={formData.registrationDate}\n                          onChange={(e) => setFormData({ ...formData, registrationDate: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                        />\n                      </div>\n                    </>\n                  )}\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('socialSecurity.notes')}\n                    </label>\n                    <textarea\n                      value={formData.notes}\n                      onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      rows={3}\n                      placeholder={t('socialSecurity.additionalInfo')}\n                    />\n                  </div>\n\n                  <div className=\"flex items-center justify-end space-x-3\">\n                    <button\n                      onClick={handleCancel}\n                      disabled={saving}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={t('common.cancel')}\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      onClick={handleSave}\n                      disabled={saving}\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={saving ? t('common.saving') : t('common.save')}\n                    >\n                      {saving ? (\n                        <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                      ) : (\n                        <CheckCircleIcon className=\"h-5 w-5\" />\n                      )}\n                    </button>\n                  </div>\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default SocialSecurityEditor;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ExclamationTriangleIcon, CalendarIcon, ArrowPathIcon, ArrowRightIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface OffboardingStartModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onOffboardingStarted: () => void;\n  userId: number;\n  userName: string;\n}\n\nconst OffboardingStartModal: React.FC<OffboardingStartModalProps> = ({\n  isOpen,\n  onClose,\n  onOffboardingStarted,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [exitDate, setExitDate] = useState('');\n  const [exitReason, setExitReason] = useState('');\n  \n  // Validierung\n  const [validationErrors, setValidationErrors] = useState<{\n    exitDate?: string;\n    exitReason?: string;\n  }>({});\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Setze Standard-Datum auf heute\n      const today = new Date().toISOString().split('T')[0];\n      setExitDate(today);\n      setExitReason('');\n      setError(null);\n      setValidationErrors({});\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = (): boolean => {\n    const errors: { exitDate?: string; exitReason?: string } = {};\n\n    // Validierung: exitDate\n    if (!exitDate) {\n      errors.exitDate = t('lifecycle.offboarding.exitDateRequired', { defaultValue: 'Austrittsdatum ist erforderlich' });\n    } else {\n      const selectedDate = new Date(exitDate);\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      \n      // exitDate darf in der Vergangenheit liegen (rckwirkende Erfassung erlaubt)\n      // Aber nicht zu weit in der Zukunft (max. 1 Jahr)\n      const maxDate = new Date();\n      maxDate.setFullYear(maxDate.getFullYear() + 1);\n      \n      if (selectedDate > maxDate) {\n        errors.exitDate = t('lifecycle.offboarding.exitDateTooFar', { defaultValue: 'Austrittsdatum darf nicht mehr als 1 Jahr in der Zukunft liegen' });\n      }\n    }\n\n    // Validierung: exitReason\n    if (!exitReason || exitReason.trim().length === 0) {\n      errors.exitReason = t('lifecycle.offboarding.exitReasonRequired', { defaultValue: 'Austrittsgrund ist erforderlich' });\n    } else if (exitReason.trim().length < 10) {\n      errors.exitReason = t('lifecycle.offboarding.exitReasonTooShort', { defaultValue: 'Austrittsgrund muss mindestens 10 Zeichen lang sein' });\n    }\n\n    setValidationErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\n        status: 'offboarding',\n        exitDate: exitDate,\n        exitReason: exitReason.trim()\n      });\n\n      showMessage(\n        t('lifecycle.offboarding.started', { defaultValue: 'Offboarding erfolgreich gestartet' }),\n        'success'\n      );\n      \n      onOffboardingStarted();\n      onClose();\n    } catch (err: any) {\n      console.error('Fehler beim Starten des Offboarding:', err);\n      const errorMessage = err.response?.data?.message || \n        t('lifecycle.offboarding.startError', { defaultValue: 'Fehler beim Starten des Offboarding' });\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const renderForm = () => (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      {/* Warnung */}\n      <div className=\"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4\">\n        <div className=\"flex items-start\">\n          <ExclamationTriangleIcon className=\"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5 mr-3 flex-shrink-0\" />\n          <div className=\"text-sm text-orange-800 dark:text-orange-200\">\n            <p className=\"font-medium mb-1\">\n              {t('lifecycle.offboarding.warningTitle', { defaultValue: 'Wichtiger Hinweis' })}\n            </p>\n            <p>\n              {t('lifecycle.offboarding.warningText', { defaultValue: 'Durch das Starten des Offboarding-Prozesses werden automatisch Tasks erstellt. Dieser Vorgang kann nicht rckgngig gemacht werden.' })}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* User-Info */}\n      <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">\n          {t('lifecycle.offboarding.user', { defaultValue: 'Mitarbeiter' })}\n        </p>\n        <p className=\"font-medium dark:text-white\">{userName}</p>\n      </div>\n\n      {/* exitDate */}\n      <div>\n        <label htmlFor=\"exitDate\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {t('lifecycle.offboarding.exitDate', { defaultValue: 'Austrittsdatum' })} *\n        </label>\n        <div className=\"relative\">\n          <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n            <CalendarIcon className=\"h-5 w-5 text-gray-400\" />\n          </div>\n          <input\n            type=\"date\"\n            id=\"exitDate\"\n            value={exitDate}\n            onChange={(e) => {\n              setExitDate(e.target.value);\n              if (validationErrors.exitDate) {\n                setValidationErrors(prev => ({ ...prev, exitDate: undefined }));\n              }\n            }}\n            className={`block w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n              validationErrors.exitDate\n                ? 'border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500'\n                : 'border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500'\n            }`}\n            required\n          />\n        </div>\n        {validationErrors.exitDate && (\n          <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{validationErrors.exitDate}</p>\n        )}\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n          {t('lifecycle.offboarding.exitDateHint', { defaultValue: 'Das Datum, an dem der Mitarbeiter die Organisation verlsst' })}\n        </p>\n      </div>\n\n      {/* exitReason */}\n      <div>\n        <label htmlFor=\"exitReason\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {t('lifecycle.offboarding.exitReason', { defaultValue: 'Austrittsgrund' })} *\n        </label>\n        <textarea\n          id=\"exitReason\"\n          value={exitReason}\n          onChange={(e) => {\n            setExitReason(e.target.value);\n            if (validationErrors.exitReason) {\n              setValidationErrors(prev => ({ ...prev, exitReason: undefined }));\n            }\n          }}\n          rows={4}\n          className={`block w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n            validationErrors.exitReason\n              ? 'border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500'\n              : 'border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500'\n          }`}\n          placeholder={t('lifecycle.offboarding.exitReasonPlaceholder', { defaultValue: 'z.B. Kndigung, Vertragsende, etc.' })}\n          required\n        />\n        {validationErrors.exitReason && (\n          <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{validationErrors.exitReason}</p>\n        )}\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n          {t('lifecycle.offboarding.exitReasonHint', { defaultValue: 'Mindestens 10 Zeichen. Beschreiben Sie den Grund fr den Austritt.' })}\n        </p>\n      </div>\n\n      {/* Error-Message */}\n      {error && (\n        <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n          <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n        </div>\n      )}\n\n      {/* Buttons */}\n      <div className=\"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n        <button\n          type=\"button\"\n          onClick={onClose}\n          disabled={loading}\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\n          title={t('common.cancel', { defaultValue: 'Abbrechen' })}\n        >\n          <XMarkIcon className=\"h-5 w-5\" />\n        </button>\n        <button\n          type=\"submit\"\n          disabled={loading}\n          className=\"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n          title={loading ? t('common.saving', { defaultValue: 'Speichern...' }) : t('lifecycle.offboarding.startButton', { defaultValue: 'Offboarding starten' })}\n        >\n          {loading ? (\n            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n          ) : (\n            <ArrowRightIcon className=\"h-5 w-5\" />\n          )}\n        </button>\n      </div>\n    </form>\n  );\n\n  if (!isOpen) return null;\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('lifecycle.offboarding.startTitle', { defaultValue: 'Offboarding starten' })}\n              </Dialog.Title>\n              <button\n                onClick={onClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <div className=\"p-4\">\n              {renderForm()}\n            </div>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={onClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('lifecycle.offboarding.startTitle', { defaultValue: 'Offboarding starten' })}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {renderForm()}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default OffboardingStartModal;\n\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, ExclamationTriangleIcon, CheckCircleIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\r\nimport useMessage from '../hooks/useMessage.ts';\r\n\r\ninterface Task {\r\n  id: number;\r\n  title: string;\r\n  description: string | null;\r\n  status: string;\r\n  dueDate: string | null;\r\n  createdAt: string;\r\n}\r\n\r\ninterface OffboardingCompleteModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onOffboardingCompleted: () => void;\r\n  userId: number;\r\n  userName: string;\r\n  offboardingTasks: Task[];\r\n}\r\n\r\nconst OffboardingCompleteModal: React.FC<OffboardingCompleteModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onOffboardingCompleted,\r\n  userId,\r\n  userName,\r\n  offboardingTasks\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const { showMessage } = useMessage();\r\n  \r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [confirmText, setConfirmText] = useState('');\r\n  \r\n  // Prfe, ob alle Tasks abgeschlossen sind\r\n  const completedTasks = offboardingTasks.filter(task => task.status === 'done');\r\n  const allTasksCompleted = offboardingTasks.length > 0 && completedTasks.length === offboardingTasks.length;\r\n  const requiredConfirmText = userName.trim().toLowerCase();\r\n  \r\n  // Responsive Erkennung\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n  \r\n  // Sidepane-Status verwalten\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      // Reset form on open\r\n      setConfirmText('');\r\n      setError(null);\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane]);\r\n  \r\n  const validateForm = () => {\r\n    if (confirmText.trim().toLowerCase() !== requiredConfirmText) {\r\n      setError(t('lifecycle.offboarding.complete.confirmTextMismatch', { defaultValue: 'Besttigungstext stimmt nicht berein' }));\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  \r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\r\n        status: 'archived'\r\n      });\r\n      \r\n      showMessage(\r\n        t('lifecycle.offboarding.complete.success', { defaultValue: 'Offboarding erfolgreich abgeschlossen' }),\r\n        'success'\r\n      );\r\n      \r\n      onOffboardingCompleted();\r\n      onClose();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Abschlieen des Offboarding:', err);\r\n      const errorMessage = err.response?.data?.message || \r\n        t('lifecycle.offboarding.complete.error', { defaultValue: 'Fehler beim Abschlieen des Offboarding' });\r\n      setError(errorMessage);\r\n      showMessage(errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  const renderForm = () => (\r\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n      {/* User Info */}\r\n      <div className=\"bg-gray-50 dark:bg-gray-700 p-3 rounded-md flex items-center space-x-3\">\r\n        <CheckCircleIcon className=\"h-5 w-5 text-gray-500 dark:text-gray-400\" />\r\n        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n          {t('lifecycle.offboarding.complete.user', { defaultValue: 'Mitarbeiter' })}: {userName}\r\n        </span>\r\n      </div>\r\n      \r\n      {/* Tasks Status */}\r\n      {offboardingTasks.length > 0 && (\r\n        <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-md\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n            {t('lifecycle.offboarding.complete.tasksStatus', { defaultValue: 'Status der Offboarding-Aufgaben' })}\r\n          </h4>\r\n          <div className=\"space-y-2\">\r\n            {offboardingTasks.map((task) => {\r\n                  const isCompleted = task.status === 'done';\r\n              return (\r\n                <div\r\n                  key={task.id}\r\n                  className={`flex items-center space-x-2 text-sm ${\r\n                    isCompleted\r\n                      ? 'text-green-700 dark:text-green-300'\r\n                      : 'text-orange-700 dark:text-orange-300'\r\n                  }`}\r\n                >\r\n                  {isCompleted ? (\r\n                    <CheckCircleIcon className=\"h-4 w-4 flex-shrink-0\" />\r\n                  ) : (\r\n                    <ExclamationTriangleIcon className=\"h-4 w-4 flex-shrink-0\" />\r\n                  )}\r\n                  <span>{task.title}</span>\r\n                  <span className=\"ml-auto text-xs\">\r\n                    {isCompleted\r\n                      ? `(${t('common.done', { defaultValue: 'Abgeschlossen' })})`\r\n                      : `(${t('common.open', { defaultValue: 'Offen' })})`}\r\n                  </span>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Warning wenn nicht alle Tasks abgeschlossen */}\r\n      {!allTasksCompleted && offboardingTasks.length > 0 && (\r\n        <div className=\"bg-orange-50 dark:bg-orange-900/20 border-l-4 border-orange-400 p-4\">\r\n          <div className=\"flex\">\r\n            <div className=\"flex-shrink-0\">\r\n              <ExclamationTriangleIcon className=\"h-5 w-5 text-orange-400\" aria-hidden=\"true\" />\r\n            </div>\r\n            <div className=\"ml-3\">\r\n              <h3 className=\"text-sm font-medium text-orange-800 dark:text-orange-300\">\r\n                {t('lifecycle.offboarding.complete.warningTitle', { defaultValue: 'Nicht alle Aufgaben abgeschlossen' })}\r\n              </h3>\r\n              <div className=\"mt-2 text-sm text-orange-700 dark:text-orange-200\">\r\n                <p>\r\n                  {t('lifecycle.offboarding.complete.warningText', { \r\n                    defaultValue: 'Es sind noch nicht alle Offboarding-Aufgaben abgeschlossen. Sie knnen das Offboarding trotzdem abschlieen, aber es wird empfohlen, alle Aufgaben zuerst zu erledigen.'\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Info wenn alle Tasks abgeschlossen */}\r\n      {allTasksCompleted && (\r\n        <div className=\"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-400 p-4\">\r\n          <div className=\"flex\">\r\n            <div className=\"flex-shrink-0\">\r\n              <CheckCircleIcon className=\"h-5 w-5 text-green-400\" aria-hidden=\"true\" />\r\n            </div>\r\n            <div className=\"ml-3\">\r\n              <h3 className=\"text-sm font-medium text-green-800 dark:text-green-300\">\r\n                {t('lifecycle.offboarding.complete.allTasksCompleted', { defaultValue: 'Alle Aufgaben abgeschlossen' })}\r\n              </h3>\r\n              <div className=\"mt-2 text-sm text-green-700 dark:text-green-200\">\r\n                <p>\r\n                  {t('lifecycle.offboarding.complete.allTasksCompletedText', { \r\n                    defaultValue: 'Alle Offboarding-Aufgaben sind abgeschlossen. Sie knnen das Offboarding jetzt abschlieen.'\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Confirm Text Input */}\r\n      <div>\r\n        <label htmlFor=\"confirmText\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('lifecycle.offboarding.complete.confirmLabel', { userName }) || \r\n            `Besttigen Sie durch Eingabe des Namens: \"${userName}\"`} *\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"confirmText\"\r\n          value={confirmText}\r\n          onChange={(e) => {\r\n            setConfirmText(e.target.value);\r\n            setError(null);\r\n          }}\r\n          className={`w-full px-3 py-2 border ${\r\n            error && error.includes('Besttigung') ? 'border-red-500' : 'border-gray-300'\r\n          } dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500`}\r\n          placeholder={userName}\r\n          required\r\n        />\r\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n          {t('lifecycle.offboarding.complete.confirmHint', { \r\n            defaultValue: 'Geben Sie den vollstndigen Namen des Mitarbeiters ein, um das Offboarding abzuschlieen'\r\n          })}\r\n        </p>\r\n      </div>\r\n      \r\n      {/* Final Warning */}\r\n      <div className=\"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\r\n        <div className=\"flex\">\r\n          <div className=\"flex-shrink-0\">\r\n            <ExclamationTriangleIcon className=\"h-5 w-5 text-red-400\" aria-hidden=\"true\" />\r\n          </div>\r\n          <div className=\"ml-3\">\r\n            <h3 className=\"text-sm font-medium text-red-800 dark:text-red-300\">\r\n              {t('lifecycle.offboarding.complete.finalWarningTitle', { defaultValue: 'Wichtiger Hinweis' })}\r\n            </h3>\r\n            <div className=\"mt-2 text-sm text-red-700 dark:text-red-200\">\r\n              <p>\r\n                {t('lifecycle.offboarding.complete.finalWarningText', { \r\n                  defaultValue: 'Durch das Abschlieen des Offboarding wird der Mitarbeiter archiviert. Dieser Vorgang kann nicht rckgngig gemacht werden.'\r\n                })}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Submit Button */}\r\n      <div className=\"flex justify-end space-x-3\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={onClose}\r\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          disabled={loading}\r\n          title={t('common.cancel', { defaultValue: 'Abbrechen' })}\r\n        >\r\n          <XMarkIcon className=\"h-5 w-5\" />\r\n        </button>\r\n        <button\r\n          type=\"submit\"\r\n          className=\"p-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          disabled={loading || confirmText.trim().toLowerCase() !== requiredConfirmText}\r\n          title={loading ? t('common.saving', { defaultValue: 'Speichern...' }) : t('lifecycle.offboarding.complete.button', { defaultValue: 'Offboarding abschlieen' })}\r\n        >\r\n          {loading ? (\r\n            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n          ) : (\r\n            <CheckCircleIcon className=\"h-5 w-5\" />\r\n          )}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n  \r\n  if (!isOpen) return null;\r\n  \r\n  // Fr Mobile (unter 640px) - klassisches Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n            {/* Header */}\r\n            <div className=\"px-6 py-4 border-b dark:border-gray-700\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                  {t('lifecycle.offboarding.complete.title', { defaultValue: 'Offboarding abschlieen' })}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Form */}\r\n            <div className=\"p-6\">\r\n              {error && (\r\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\r\n                  {error}\r\n                </div>\r\n              )}\r\n              {renderForm()}\r\n            </div>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n  \r\n  // Fr Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div\r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\"\r\n          aria-hidden=\"true\"\r\n          onClick={onClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div\r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${\r\n          isOpen ? 'translate-x-0' : 'translate-x-full'\r\n        }`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('lifecycle.offboarding.complete.title', { defaultValue: 'Offboarding abschlieen' })}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n        \r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {error && (\r\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\r\n              {error}\r\n            </div>\r\n          )}\r\n          {renderForm()}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default OffboardingCompleteModal;\r\n\r\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { \n  CheckCircleIcon, \n  ClockIcon, \n  XCircleIcon,\n  DocumentTextIcon,\n  BuildingOfficeIcon,\n  PlusIcon,\n  PencilIcon,\n  ArrowDownTrayIcon,\n  CalendarIcon,\n  UserIcon,\n  ArrowRightIcon\n} from '@heroicons/react/24/outline';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport useMessage from '../hooks/useMessage.ts';\nimport CertificateCreationModal from './CertificateCreationModal.tsx';\nimport ContractCreationModal from './ContractCreationModal.tsx';\nimport CertificateEditModal from './CertificateEditModal.tsx';\nimport ContractEditModal from './ContractEditModal.tsx';\nimport SocialSecurityEditor from './SocialSecurityEditor.tsx';\nimport OffboardingStartModal from './OffboardingStartModal.tsx';\nimport OffboardingCompleteModal from './OffboardingCompleteModal.tsx';\n\ninterface LifecycleViewProps {\n  userId: number;\n  userName: string;\n}\n\ninterface LifecycleData {\n  lifecycle: {\n    id: number;\n    status: string;\n    onboardingStartedAt: string | null;\n    onboardingCompletedAt: string | null;\n    contractStartDate: string | null;\n    contractEndDate: string | null;\n    exitDate: string | null;\n    exitReason: string | null;\n    offboardingStartedAt: string | null;\n    offboardingCompletedAt: string | null;\n  };\n  progress: {\n    completed: number;\n    total: number;\n    percent: number;\n  };\n  socialSecurityRegistrations?: Array<{\n    id: number;\n    registrationType: string;\n    status: string;\n    registrationNumber: string | null;\n    provider: string | null;\n    registrationDate: string | null;\n  }>;\n}\n\ninterface Task {\n  id: number;\n  title: string;\n  description: string | null;\n  status: string;\n  dueDate: string | null;\n  createdAt: string;\n}\n\ninterface Certificate {\n  id: number;\n  certificateType: string;\n  issueDate: string;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n  generatedBy: number | null;\n  generatedByUser: {\n    id: number;\n    firstName: string;\n    lastName: string;\n  } | null;\n  createdAt: string;\n}\n\ninterface Contract {\n  id: number;\n  contractType: string;\n  startDate: string;\n  endDate: string | null;\n  salary: number | null;\n  workingHours: number | null;\n  position: string | null;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n  generatedBy: number | null;\n  generatedByUser: {\n    id: number;\n    firstName: string;\n    lastName: string;\n  } | null;\n  createdAt: string;\n}\n\nconst LifecycleView: React.FC<LifecycleViewProps> = ({ userId, userName }) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin } = usePermissions();\n  const { showMessage } = useMessage();\n  \n  const [lifecycleData, setLifecycleData] = useState<LifecycleData | null>(null);\n  const [certificates, setCertificates] = useState<Certificate[]>([]);\n  const [contracts, setContracts] = useState<Contract[]>([]);\n  const [offboardingTasks, setOffboardingTasks] = useState<Task[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Modal States\n  const [isCertificateCreateModalOpen, setIsCertificateCreateModalOpen] = useState(false);\n  const [isContractCreateModalOpen, setIsContractCreateModalOpen] = useState(false);\n  const [editingCertificate, setEditingCertificate] = useState<Certificate | null>(null);\n  const [editingContract, setEditingContract] = useState<Contract | null>(null);\n  \n  const [downloadingCertId, setDownloadingCertId] = useState<number | null>(null);\n  const [downloadingContractId, setDownloadingContractId] = useState<number | null>(null);\n  const [isOffboardingStartModalOpen, setIsOffboardingStartModalOpen] = useState(false);\n  const [isOffboardingCompleteModalOpen, setIsOffboardingCompleteModalOpen] = useState(false);\n  const [isEditContractDatesModalOpen, setIsEditContractDatesModalOpen] = useState(false);\n  const [editingContractStartDate, setEditingContractStartDate] = useState<string>('');\n  const [editingContractEndDate, setEditingContractEndDate] = useState<string>('');\n\n  const fetchDataRef = useRef(false);\n  //  MEMORY FIX: Ref fr Mounted-Status und Timer-Cleanup\n  const isMountedRef = useRef(true);\n  const retryTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const statusChangeTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  const fetchData = useCallback(async (force: boolean = false) => {\n    // Verhindere mehrfaches gleichzeitiges Laden (auer wenn force=true)\n    if (fetchDataRef.current && !force) {\n      // Wenn bereits geladen wird, warte kurz und versuche es erneut\n      retryTimeoutRef.current = setTimeout(() => {\n        if (!fetchDataRef.current && isMountedRef.current) {\n          fetchData(true);\n        }\n      }, 500);\n      return;\n    }\n    \n    try {\n      fetchDataRef.current = true;\n      setLoading(true);\n      const [lifecycleResponse, certsResponse, contractsResponse, tasksResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.CERTIFICATES(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.CONTRACTS(userId)),\n        axiosInstance.get(API_ENDPOINTS.TASKS.BY_USER(userId)).catch(() => ({ data: [] })) // Optional, falls fehlschlgt\n      ]);\n      \n      //  MEMORY FIX: Nur State setzen wenn noch gemounted\n      if (!isMountedRef.current) return;\n      \n      setLifecycleData(lifecycleResponse.data);\n      setCertificates(certsResponse.data?.certificates || []);\n      setContracts(contractsResponse.data?.contracts || []);\n      \n      // Filtere Offboarding-Tasks (die 3 spezifischen Tasks)\n      const allTasks = tasksResponse.data || [];\n      const offboardingTaskTitles = [\n        'Crear certificado laboral',\n        'Realizar liquidacin final',\n        'Desafiliar de seguridad social'\n      ];\n      const filteredTasks = allTasks.filter((task: Task) => \n        offboardingTaskTitles.includes(task.title)\n      );\n      setOffboardingTasks(filteredTasks);\n      \n      // Prfe ob automatische Status-nderung ntig ist (wird im Backend gemacht, aber hier prfen wir fr UI-Feedback)\n      if (lifecycleResponse.data?.lifecycle?.status === 'onboarding' && lifecycleResponse.data?.progress?.percent === 100) {\n        // Status wird automatisch im Backend gendert, lade Daten nach kurzer Verzgerung neu\n        statusChangeTimeoutRef.current = setTimeout(() => {\n          if (isMountedRef.current) {\n            fetchData();\n          }\n        }, 1000);\n      }\n      \n      setError(null);\n    } catch (err: any) {\n      if (!isMountedRef.current) return;\n      console.error('Fehler beim Laden der Lebenszyklus-Daten:', err);\n      setError(err.response?.data?.message || 'Fehler beim Laden der Daten');\n      showMessage('Fehler beim Laden der Daten', 'error');\n    } finally {\n      setLoading(false);\n      fetchDataRef.current = false;\n    }\n  }, [userId]); // showMessage entfernt, da es sich ndern kann\n\n  useEffect(() => {\n    isMountedRef.current = true;\n    fetchDataRef.current = false; // Reset beim userId-Wechsel\n    fetchData();\n    \n    //  MEMORY FIX: Cleanup Timer bei Unmount\n    return () => {\n      isMountedRef.current = false;\n      if (retryTimeoutRef.current) clearTimeout(retryTimeoutRef.current);\n      if (statusChangeTimeoutRef.current) clearTimeout(statusChangeTimeoutRef.current);\n    };\n  }, [fetchData]);\n\n  const handleDownloadCertificate = async (certId: number) => {\n    setDownloadingCertId(certId);\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certId),\n        { responseType: 'blob' }\n      );\n      \n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = `arbeitszeugnis-${certId}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadUrl);\n      \n      showMessage('Arbeitszeugnis erfolgreich heruntergeladen', 'success');\n    } catch (err: any) {\n      console.error('Fehler beim Herunterladen:', err);\n      showMessage('Fehler beim Herunterladen des Arbeitszeugnisses', 'error');\n    } finally {\n      setDownloadingCertId(null);\n    }\n  };\n\n  const handleEditContractDates = () => {\n    if (!lifecycleData?.lifecycle) return;\n    \n    setEditingContractStartDate(\n      lifecycleData.lifecycle.contractStartDate \n        ? new Date(lifecycleData.lifecycle.contractStartDate).toISOString().split('T')[0]\n        : ''\n    );\n    setEditingContractEndDate(\n      lifecycleData.lifecycle.contractEndDate \n        ? new Date(lifecycleData.lifecycle.contractEndDate).toISOString().split('T')[0]\n        : ''\n    );\n    setIsEditContractDatesModalOpen(true);\n  };\n\n  const handleSaveContractDates = async () => {\n    try {\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\n        status: lifecycleData?.lifecycle.status || 'active',\n        contractStartDate: editingContractStartDate || null,\n        contractEndDate: editingContractEndDate || null\n      });\n      \n      showMessage('Vertragsdaten erfolgreich aktualisiert', 'success');\n      setIsEditContractDatesModalOpen(false);\n      fetchData();\n    } catch (err: any) {\n      console.error('Fehler beim Speichern der Vertragsdaten:', err);\n      showMessage('Fehler beim Speichern der Vertragsdaten', 'error');\n    }\n  };\n\n\n  const handleDownloadContract = async (contractId: number) => {\n    setDownloadingContractId(contractId);\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contractId),\n        { responseType: 'blob' }\n      );\n      \n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = `arbeitsvertrag-${contractId}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadUrl);\n      \n      showMessage('Arbeitsvertrag erfolgreich heruntergeladen', 'success');\n    } catch (err: any) {\n      console.error('Fehler beim Herunterladen:', err);\n      showMessage('Fehler beim Herunterladen des Arbeitsvertrags', 'error');\n    } finally {\n      setDownloadingContractId(null);\n    }\n  };\n\n  const getStatusBadge = (status: string, clickable: boolean = false) => {\n    const statusConfig: Record<string, { color: string; labelKey: string }> = {\n      onboarding: { color: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300', labelKey: 'lifecycle.status.onboarding' },\n      active: { color: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300', labelKey: 'lifecycle.status.active' },\n      contract_change: { color: 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300', labelKey: 'lifecycle.status.contract_change' },\n      offboarding: { color: 'bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300', labelKey: 'lifecycle.status.offboarding' },\n      archived: { color: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300', labelKey: 'lifecycle.status.archived' }\n    };\n\n    const config = statusConfig[status] || { color: 'bg-gray-100 text-gray-800', labelKey: status };\n    \n    return (\n      <span className={`px-3 py-1 rounded-full text-sm font-medium ${config.color} ${clickable ? 'cursor-pointer hover:opacity-80' : ''}`}>\n        {t(config.labelKey) || status}\n      </span>\n    );\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('de-DE', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n          <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!lifecycleData) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <p className=\"text-gray-500 dark:text-gray-400\">{t('lifecycle.noData', { defaultValue: 'Keine Lebenszyklus-Daten verfgbar' })}</p>\n      </div>\n    );\n  }\n\n  // Extrahiere socialSecurityRegistrations aus lifecycle (falls direkt vorhanden) oder aus lifecycleData\n  const socialSecurityRegistrations = lifecycleData.lifecycle?.socialSecurityRegistrations || lifecycleData.socialSecurityRegistrations || [];\n  const { lifecycle, progress } = lifecycleData;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Status-Box */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <BuildingOfficeIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.statusTitle')}\n          </h3>\n          <div className=\"flex items-center space-x-3\">\n          {/* Status-Badge (nur Anzeige, keine nderung mglich) */}\n          {getStatusBadge(lifecycle.status)}\n            {/* Offboarding-Start-Button (nur fr HR/Admin, nur wenn Status = \"active\") */}\n            {(isHR() || isAdmin()) && lifecycle.status === 'active' && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsOffboardingStartModalOpen(true)}\n                  className=\"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500\"\n                >\n                  <ArrowRightIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('lifecycle.offboarding.startButton', { defaultValue: 'Offboarding starten' })}\n                </div>\n              </div>\n            )}\n            {/* Offboarding-Abschluss-Button (nur fr HR/Admin, nur wenn Status = \"offboarding\") */}\n            {(isHR() || isAdmin()) && lifecycle.status === 'offboarding' && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsOffboardingCompleteModalOpen(true)}\n                  className=\"p-2 bg-red-600 dark:bg-red-700 text-white rounded-md hover:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n                >\n                  <CheckCircleIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('lifecycle.offboarding.complete.button', { defaultValue: 'Offboarding abschlieen' })}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        <div className=\"space-y-2 text-sm\">\n          {lifecycle.onboardingStartedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.onboardingStarted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.onboardingStartedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.onboardingCompletedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.onboardingCompleted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.onboardingCompletedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.contractStart')}</span>\n            <div className=\"flex items-center space-x-2\">\n              {lifecycle.contractStartDate ? (\n                <span className=\"dark:text-white\">\n                  {new Date(lifecycle.contractStartDate).toLocaleDateString('de-DE')}\n                </span>\n              ) : (\n                <span className=\"text-gray-400 italic text-sm\">{t('lifecycle.notSet', { defaultValue: 'Nicht gesetzt' })}</span>\n              )}\n              {(isHR() || isAdmin()) && (\n                <div className=\"relative group\">\n                  <button\n                    onClick={() => handleEditContractDates()}\n                    className=\"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition\"\n                  >\n                    <PencilIcon className=\"h-4 w-4\" />\n                  </button>\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                    {t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.contractEnd')}</span>\n            <div className=\"flex items-center space-x-2\">\n              {lifecycle.contractEndDate ? (\n                <span className=\"dark:text-white\">\n                  {new Date(lifecycle.contractEndDate).toLocaleDateString('de-DE')}\n                </span>\n              ) : (\n                <span className=\"text-gray-400 italic text-sm\">{t('lifecycle.notSet', { defaultValue: 'Nicht gesetzt' })}</span>\n              )}\n              {(isHR() || isAdmin()) && (\n                <div className=\"relative group\">\n                  <button\n                    onClick={() => handleEditContractDates()}\n                    className=\"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition\"\n                  >\n                    <PencilIcon className=\"h-4 w-4\" />\n                  </button>\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                    {t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n          {lifecycle.offboardingStartedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.offboardingStarted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.offboardingStartedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.exitDate && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.exitDate')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.exitDate).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.exitReason && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.exitReason')}</span>\n              <span className=\"dark:text-white\">{lifecycle.exitReason}</span>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Progress-Bar - Onboarding */}\n      {lifecycle.status === 'onboarding' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold dark:text-white mb-4\">{t('lifecycle.progressTitle')}</h3>\n          <div className=\"space-y-2\">\n            <div className=\"flex justify-between text-sm mb-2\">\n              <span className=\"text-gray-600 dark:text-gray-400\">\n                {t('lifecycle.progressSteps', { completed: progress.completed, total: progress.total })}\n              </span>\n              <span className=\"font-medium dark:text-white\">{progress.percent}%</span>\n            </div>\n            <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3\">\n              <div\n                className=\"bg-blue-600 h-3 rounded-full transition-all duration-300\"\n                style={{ width: `${progress.percent}%` }}\n              ></div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Progress-Bar - Offboarding */}\n      {lifecycle.status === 'offboarding' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold dark:text-white mb-4\">{t('lifecycle.offboarding.progressTitle', { defaultValue: 'Offboarding-Fortschritt' })}</h3>\n          <div className=\"space-y-4\">\n            {/* Progress-Bar */}\n            {(() => {\n              const completedTasks = offboardingTasks.filter(task => task.status === 'done').length;\n              const totalTasks = offboardingTasks.length || 3; // Fallback: 3 Tasks\n              const percent = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;\n              \n              return (\n                <>\n                  <div className=\"flex justify-between text-sm mb-2\">\n                    <span className=\"text-gray-600 dark:text-gray-400\">\n                      {t('lifecycle.offboarding.progressSteps', { completed: completedTasks, total: totalTasks }) || `${completedTasks} von ${totalTasks} Schritten abgeschlossen`}\n                    </span>\n                    <span className=\"font-medium dark:text-white\">{percent}%</span>\n                  </div>\n                  <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3\">\n                    <div\n                      className=\"bg-orange-600 h-3 rounded-full transition-all duration-300\"\n                      style={{ width: `${percent}%` }}\n                    ></div>\n                  </div>\n                </>\n              );\n            })()}\n            \n            {/* Offboarding-Tasks Liste */}\n            {offboardingTasks.length > 0 && (\n              <div className=\"mt-4 space-y-2\">\n                <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  {t('lifecycle.offboarding.tasksTitle', { defaultValue: 'Offboarding-Aufgaben' })}\n                </h4>\n                {offboardingTasks.map((task) => {\n                  const isCompleted = task.status === 'done';\n                  return (\n                    <div\n                      key={task.id}\n                      className={`flex items-center justify-between p-3 rounded-lg border ${\n                        isCompleted\n                          ? 'bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800'\n                          : 'bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600'\n                      }`}\n                    >\n                      <div className=\"flex items-center space-x-3 flex-1\">\n                        {isCompleted ? (\n                          <CheckCircleIcon className=\"h-5 w-5 text-green-600 dark:text-green-400 flex-shrink-0\" />\n                        ) : (\n                          <ClockIcon className=\"h-5 w-5 text-orange-600 dark:text-orange-400 flex-shrink-0\" />\n                        )}\n                        <div className=\"flex-1 min-w-0\">\n                          <p className={`text-sm font-medium ${isCompleted ? 'text-green-800 dark:text-green-200' : 'text-gray-800 dark:text-gray-200'}`}>\n                            {task.title}\n                          </p>\n                          {task.description && (\n                            <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-1 truncate\">\n                              {task.description}\n                            </p>\n                          )}\n                        </div>\n                      </div>\n                      <span className={`text-xs px-2 py-1 rounded ${\n                        isCompleted\n                          ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200'\n                          : 'bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200'\n                      }`}>\n                        {isCompleted\n                          ? t('common.done', { defaultValue: 'Abgeschlossen' })\n                          : t('common.open', { defaultValue: 'Offen' })}\n                      </span>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Dokumente - Arbeitszeugnisse */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.certificates')}\n          </h3>\n          {(isHR() || isAdmin()) && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => setIsCertificateCreateModalOpen(true)}\n                className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                style={{ width: '30.19px', height: '30.19px' }}\n                aria-label={t('lifecycle.createCertificate')}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('lifecycle.createCertificate')}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {certificates.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noCertificates')}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {certificates.map((cert) => (\n              <div\n                key={cert.id}\n                className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition\"\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <h4 className=\"font-medium dark:text-white\">\n                        {t('lifecycle.certificate')}\n                        {cert.certificateType !== 'employment' && ` (${cert.certificateType})`}\n                      </h4>\n                      {cert.isLatest && (\n                        <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center\">\n                          <CheckCircleIcon className=\"h-3 w-3 mr-1\" />\n                          {t('lifecycle.current')}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                      <div className=\"flex items-center space-x-2\">\n                        <CalendarIcon className=\"h-4 w-4\" />\n                        <span>{t('lifecycle.issuedOn')} {formatDate(cert.issueDate)}</span>\n                      </div>\n                      {cert.generatedByUser && (\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4\" />\n                          <span>\n                            {t('lifecycle.createdBy')} {cert.generatedByUser.firstName} {cert.generatedByUser.lastName}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2 ml-4\">\n                    {(isHR() || isAdmin()) && (\n                      <div className=\"relative group\">\n                        <button\n                          onClick={() => setEditingCertificate(cert)}\n                          className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition\"\n                        >\n                          <PencilIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('lifecycle.edit')}\n                        </div>\n                      </div>\n                    )}\n                    <div className=\"relative group\">\n                      <button\n                        onClick={() => handleDownloadCertificate(cert.id)}\n                        disabled={downloadingCertId === cert.id}\n                        className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {downloadingCertId === cert.id ? (\n                          <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                        ) : (\n                          <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                        )}\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('lifecycle.download')}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Dokumente - Arbeitsvertrge */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center mb-4\">\n          {(isHR() || isAdmin()) && (\n            <div className=\"relative group mr-3\">\n              <button\n                onClick={() => setIsContractCreateModalOpen(true)}\n                className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                style={{ width: '30.19px', height: '30.19px' }}\n                aria-label={t('lifecycle.createContract')}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('lifecycle.createContract')}\n              </div>\n            </div>\n          )}\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.contracts')}\n          </h3>\n        </div>\n\n        {contracts.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noContracts')}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {contracts.map((contract) => (\n              <div\n                key={contract.id}\n                className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition\"\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <h4 className=\"font-medium dark:text-white\">\n                        {t('lifecycle.contract')}\n                        {contract.contractType !== 'employment' && ` (${contract.contractType})`}\n                      </h4>\n                      {contract.isLatest && (\n                        <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center\">\n                          <CheckCircleIcon className=\"h-3 w-3 mr-1\" />\n                          {t('lifecycle.current')}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                      <div className=\"flex items-center space-x-2\">\n                        <CalendarIcon className=\"h-4 w-4\" />\n                        <span>\n                          {formatDate(contract.startDate)}\n                          {contract.endDate && ` - ${formatDate(contract.endDate)}`}\n                        </span>\n                      </div>\n                      {contract.position && (\n                        <div>{t('lifecycle.position')} {contract.position}</div>\n                      )}\n                      {contract.salary && (\n                        <div>{t('lifecycle.salary')} {contract.salary.toLocaleString('de-DE', { style: 'currency', currency: 'EUR' })}</div>\n                      )}\n                      {contract.workingHours && (\n                        <div>{t('lifecycle.workingHours')} {contract.workingHours}h/Woche</div>\n                      )}\n                      {contract.generatedByUser && (\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4\" />\n                          <span>\n                            {t('lifecycle.createdBy')} {contract.generatedByUser.firstName} {contract.generatedByUser.lastName}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2 ml-4\">\n                    {(isHR() || isAdmin()) && (\n                      <div className=\"relative group\">\n                        <button\n                          onClick={() => setEditingContract(contract)}\n                          className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition\"\n                        >\n                          <PencilIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('lifecycle.edit')}\n                        </div>\n                      </div>\n                    )}\n                    <div className=\"relative group\">\n                      <button\n                        onClick={() => handleDownloadContract(contract.id)}\n                        disabled={downloadingContractId === contract.id}\n                        className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {downloadingContractId === contract.id ? (\n                          <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                        ) : (\n                          <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                        )}\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('lifecycle.download')}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Social Security Editor - Nur fr Legal/Admin */}\n      {lifecycleData?.lifecycle && (\n        <SocialSecurityEditor\n          userId={userId}\n          lifecycleId={lifecycleData.lifecycle.id}\n          onUpdate={() => fetchData(true)}\n        />\n      )}\n\n      {/* Modals */}\n      <CertificateCreationModal\n        isOpen={isCertificateCreateModalOpen}\n        onClose={() => setIsCertificateCreateModalOpen(false)}\n        onCertificateCreated={() => {\n          fetchData();\n          setIsCertificateCreateModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n\n      <ContractCreationModal\n        isOpen={isContractCreateModalOpen}\n        onClose={() => setIsContractCreateModalOpen(false)}\n        onContractCreated={() => {\n          fetchData();\n          setIsContractCreateModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n\n      {editingCertificate && (\n        <CertificateEditModal\n          isOpen={!!editingCertificate}\n          onClose={() => setEditingCertificate(null)}\n          onCertificateUpdated={() => {\n            fetchData();\n            setEditingCertificate(null);\n          }}\n          userId={userId}\n          certificate={editingCertificate}\n        />\n      )}\n\n      {editingContract && (\n        <ContractEditModal\n          isOpen={!!editingContract}\n          onClose={() => setEditingContract(null)}\n          onContractUpdated={() => {\n            fetchData();\n            setEditingContract(null);\n          }}\n          userId={userId}\n          contract={editingContract}\n        />\n      )}\n\n      {/* Offboarding-Start-Modal */}\n      <OffboardingStartModal\n        isOpen={isOffboardingStartModalOpen}\n        onClose={() => setIsOffboardingStartModalOpen(false)}\n        onOffboardingStarted={() => {\n          fetchData();\n          setIsOffboardingStartModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n      \n      {/* Offboarding-Abschluss-Modal */}\n      <OffboardingCompleteModal\n        isOpen={isOffboardingCompleteModalOpen}\n        onClose={() => setIsOffboardingCompleteModalOpen(false)}\n        onOffboardingCompleted={() => {\n          fetchData();\n          setIsOffboardingCompleteModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n        offboardingTasks={offboardingTasks}\n      />\n\n      {/* Modal zum Bearbeiten der Vertragsdaten */}\n      {isEditContractDatesModalOpen && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md mx-4\">\n            <h2 className=\"text-xl font-semibold dark:text-white mb-4\">\n              {t('lifecycle.editContractDates', { defaultValue: 'Vertragsdaten bearbeiten' })}\n            </h2>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('lifecycle.contractStart', { defaultValue: 'Vertragsbeginn' })} *\n                </label>\n                <input\n                  type=\"date\"\n                  value={editingContractStartDate}\n                  onChange={(e) => setEditingContractStartDate(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  required\n                />\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('lifecycle.contractEnd', { defaultValue: 'Vertragsende' })} (optional)\n                </label>\n                <input\n                  type=\"date\"\n                  value={editingContractEndDate}\n                  onChange={(e) => setEditingContractEndDate(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('lifecycle.contractEndHint', { defaultValue: 'Nur bei befristeten Vertrgen ausfllen' })}\n                </p>\n              </div>\n            </div>\n            \n            <div className=\"flex justify-end space-x-3 mt-6\">\n              <button\n                onClick={() => setIsEditContractDatesModalOpen(false)}\n                className=\"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition\"\n              >\n                {t('common.cancel', { defaultValue: 'Abbrechen' })}\n              </button>\n              <button\n                onClick={handleSaveContractDates}\n                disabled={!editingContractStartDate}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {t('common.save', { defaultValue: 'Speichern' })}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LifecycleView;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { userApi, roleApi, branchApi } from '../api/apiClient.ts';\nimport { User, Role } from '../types/interfaces.ts';\nimport { CheckIcon, PlusIcon, PencilIcon, DocumentTextIcon, UserCircleIcon, ShieldCheckIcon, XMarkIcon, ArrowPathIcon, BuildingOfficeIcon, MapPinIcon } from '@heroicons/react/24/outline';\nimport useMessage from '../hooks/useMessage.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport IdentificationDocumentList from './IdentificationDocumentList.tsx';\nimport LifecycleView from './LifecycleView.tsx';\nimport { handleDirectDocumentUpload } from '../utils/documentUploadHandler.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { logger } from '../utils/logger.ts';\n\ninterface UserManagementTabProps {\n}\n\n// Lnder und Sprachen werden dynamisch aus bersetzungen geladen\n\n// Definiere Rollen, die immer vorhanden sein sollten (z.B. Admin-Rolle)\nconst fixedRoles = [1, 2, 999]; // Admin (1), User (2) und Hamburger (999) sind fixe Rollen\n\n// Vertragstypen fr Kolumbien (CO)\nconst CONTRACT_TYPES = [\n  { code: 'tiempo_completo', name: 'Tiempo Completo (>21 Tage/Monat)' },\n  { code: 'tiempo_parcial_7', name: 'Tiempo Parcial (7 Tage/Monat)' },\n  { code: 'tiempo_parcial_14', name: 'Tiempo Parcial (14 Tage/Monat)' },\n  { code: 'tiempo_parcial_21', name: 'Tiempo Parcial (21 Tage/Monat)' },\n  { code: 'prestacion_de_servicios', name: 'Prestacin de Servicios' },\n  { code: 'externo', name: 'Externo' }\n];\n\n// Gemeinsame Debug-Komponente hinzufgen\nconst RoleDebugInfo = ({ title, data }: { title: string, data: any }) => (\n  <div className=\"mb-2 p-2 border border-gray-300 rounded bg-gray-50\">\n    <h5 className=\"font-bold text-sm\">{title}</h5>\n    <pre className=\"text-xs overflow-auto max-h-24\">\n      {JSON.stringify(data, null, 2)}\n    </pre>\n  </div>\n);\n\nconst UserManagementTab = (): JSX.Element => {\n  const { t } = useTranslation();\n  const { handleError: handleErrorContext } = useError();\n  \n  // Lnder fr die Auswahl (dynamisch aus bersetzungen)\n  const COUNTRIES = [\n    { code: 'CO', name: t('countries.CO') },\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'DE', name: t('countries.DE') },\n    { code: 'AT', name: t('countries.AT') }\n  ];\n\n  // Lnder fr die Payroll-Auswahl (dynamisch aus bersetzungen)\n  const PAYROLL_COUNTRIES = [\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'CO', name: t('countries.CO') }\n  ];\n\n  // Sprachen fr die Auswahl (dynamisch aus bersetzungen)\n  const LANGUAGES = [\n    { code: 'es', name: t('languages.es') },\n    { code: 'de', name: t('languages.de') },\n    { code: 'en', name: t('languages.en') }\n  ];\n  \n  // Benutzer-States\n  const [users, setUsers] = useState<User[]>([]);\n  const [selectedUser, setSelectedUser] = useState<User | null>(null);\n  const [userFormData, setUserFormData] = useState<Partial<User>>({});\n  const [isEditingUser, setIsEditingUser] = useState(false);\n  const [selectedRoles, setSelectedRoles] = useState<number[]>([]);\n  const [lifecycleRefreshKey, setLifecycleRefreshKey] = useState(0);\n  const [isDebugMode, setIsDebugMode] = useState(false);\n  const [roleWarning, setRoleWarning] = useState<string | null>(null);\n  const { showMessage } = useMessage();\n  const { isAdmin } = usePermissions();\n  \n  // Neuer State fr Rollen\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState(false);\n  \n  // State fr Branches\n  const [branches, setBranches] = useState<Array<{ id: number; name: string }>>([]);\n  const [loadingBranches, setLoadingBranches] = useState(false);\n  const [selectedBranches, setSelectedBranches] = useState<number[]>([]);\n  \n  // Neuer State fr die aktive Unterseite\n  const [activeUserTab, setActiveUserTab] = useState<'details' | 'documents' | 'roles' | 'branches' | 'lifecycle'>('details');\n  \n  // State fr Active/Inactive Filter\n  const [userFilterTab, setUserFilterTab] = useState<'active' | 'inactive'>('active');\n  \n  // State fr Dokument-Upload\n  const [isUploading, setIsUploading] = useState(false);\n  const documentListRef = useRef<{ loadDocuments: () => void }>(null);\n  \n  // State fr Benutzererstellung\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n  const [isMobile, setIsMobile] = useState<boolean>(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [newUserFormData, setNewUserFormData] = useState({\n    email: '',\n    password: '',\n    firstName: '',\n    lastName: ''\n  });\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isCreateModalOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isCreateModalOpen, openSidepane, closeSidepane]);\n\n  // Alle Benutzer (fr Filterung)\n  const [allUsers, setAllUsers] = useState<User[]>([]);\n\n  // Initialisierung - Laden von Benutzern\n  useEffect(() => {\n    fetchAllUsers();\n  }, []);\n\n  // Benutzerdaten laden - Verwende gefilterten Endpoint, damit nur Benutzer der eigenen Organisation angezeigt werden\n  const fetchAllUsers = async () => {\n    try {\n      const response = await userApi.getAll();\n      setAllUsers(response.data);\n      // Initial: Nur aktive Benutzer anzeigen\n      filterUsersByActiveStatus('active', response.data);\n    } catch (err) {\n      handleError(err);\n    }\n  };\n\n  // Benutzer nach Active/Inactive filtern und alphabetisch sortieren\n  const filterUsersByActiveStatus = (status: 'active' | 'inactive', usersToFilter: User[] = allUsers) => {\n    const filtered = usersToFilter.filter(user => {\n      const isActive = user.active !== undefined ? user.active : true; // Default: true\n      return status === 'active' ? isActive : !isActive;\n    });\n    \n    // Alphabetisch sortieren nach username, dann firstName\n    const sorted = filtered.sort((a, b) => {\n      const aUsername = (a.username || '').toLowerCase();\n      const bUsername = (b.username || '').toLowerCase();\n      const aFirstName = (a.firstName || '').toLowerCase();\n      const bFirstName = (b.firstName || '').toLowerCase();\n      \n      // Zuerst nach username sortieren\n      if (aUsername !== bUsername) {\n        return aUsername.localeCompare(bUsername);\n      }\n      // Wenn username gleich, nach Vorname sortieren\n      return aFirstName.localeCompare(bFirstName);\n    });\n    \n    setUsers(sorted);\n  };\n\n  // Wenn Filter-Tab wechselt, Benutzerliste neu filtern\n  useEffect(() => {\n    if (allUsers.length > 0) {\n      filterUsersByActiveStatus(userFilterTab, allUsers);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userFilterTab]);\n  \n  // Rollen laden - Wird erst aufgerufen, wenn ein Benutzer ausgewhlt wurde\n  const fetchRoles = async () => {\n    try {\n      setLoadingRoles(true);\n      \n      // Fallback-Rollen fr den Notfall bereithalten\n      const fallbackRoles = [\n        { id: 1, name: 'admin', description: 'Administrator mit allen Rechten', permissions: [] },\n        { id: 2, name: 'user', description: 'Standardbenutzer', permissions: [] },\n        { id: 999, name: 'hamburger', description: 'Hamburger-Rolle fr neue Benutzer', permissions: [] }\n      ];\n      \n      try {\n        const response = await roleApi.getAll();\n        if (response.data && Array.isArray(response.data) && response.data.length > 0) {\n          setRoles(response.data);\n          logger.log(`${response.data.length} Rollen erfolgreich geladen`);\n        } else {\n          console.warn('Keine Rollen vom Server erhalten, verwende Fallback');\n          setRoles(fallbackRoles);\n        }\n      } catch (error) {\n        console.warn('Fehler beim Laden der Rollen, verwende Fallback:', error);\n        setRoles(fallbackRoles);\n      }\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  // Branches laden - Wird erst aufgerufen, wenn ein Benutzer ausgewhlt wurde\n  const fetchBranches = async () => {\n    try {\n      setLoadingBranches(true);\n      \n      try {\n        const response = await branchApi.getAll();\n        if (response.data && Array.isArray(response.data) && response.data.length > 0) {\n          setBranches(response.data);\n          logger.log(`${response.data.length} Branches erfolgreich geladen`);\n        } else {\n          console.warn('Keine Branches vom Server erhalten');\n          setBranches([]);\n        }\n      } catch (error) {\n        console.warn('Fehler beim Laden der Branches:', error);\n        setBranches([]);\n      }\n    } finally {\n      setLoadingBranches(false);\n    }\n  };\n\n  const handleDirectDocumentUploadWrapper = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (!e.target.files || e.target.files.length === 0) return;\n    if (!selectedUser) return;\n    \n    setIsUploading(true);\n    \n    const result = await handleDirectDocumentUpload(\n      e.target.files[0],\n      selectedUser.id,\n      async () => {\n        await fetchUserDetails(selectedUser.id);\n        // Warte kurz, damit Backend verarbeitet\n        await new Promise(resolve => setTimeout(resolve, 500));\n        // Lade Dokumente neu, wenn die Komponente gemountet ist\n        documentListRef.current?.loadDocuments();\n        showMessage(t('profile.documentUploadSuccess', { defaultValue: 'Dokument erfolgreich hochgeladen. Felder werden automatisch ausgefllt.' }), 'success');\n      },\n      (error) => {\n        showMessage(error, 'error');\n      }\n    );\n    \n    setIsUploading(false);\n    e.target.value = '';\n  };\n\n  // Detaillierte Benutzerdaten laden\n  const fetchUserDetails = async (userId: number) => {\n    try {\n      if (!userId || isNaN(userId)) {\n        setSelectedUser(null);\n        return;\n      }\n      \n      logger.log('Lade Benutzerdetails fr ID:', userId);\n      const response = await userApi.getById(userId);\n      \n      const userData = {\n        ...response.data,\n        active: response.data.active !== undefined ? response.data.active : true,\n        birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n      };\n      \n      // Extrahiere Rollen-IDs aus der verschachtelten Struktur\n      let roleIds: number[] = [];\n      \n      if (response.data.roles && Array.isArray(response.data.roles)) {\n        logger.log('Rollenstruktur (Typ):', typeof response.data.roles, 'Lnge:', response.data.roles.length);\n        \n        // Struktur: roles: [{ role: { id, name, ... } }]\n        if (response.data.roles.length > 0 && response.data.roles[0].role) {\n          roleIds = response.data.roles.map(userRole => userRole.role.id);\n          logger.log('Extrahierte Rollen-IDs aus verschachtelter Struktur:', roleIds);\n        }\n        // Fallback fr andere Formate\n        else if (response.data.roles.length > 0) {\n          if (typeof response.data.roles[0] === 'number') {\n            roleIds = response.data.roles;\n          } else if (response.data.roles[0].roleId) {\n            roleIds = response.data.roles.map(role => role.roleId);\n          } else if (response.data.roles[0].id) {\n            roleIds = response.data.roles.map(role => role.id);\n          }\n        }\n      } else {\n        console.warn('Rollen fehlen oder sind kein Array:', response.data.roles);\n      }\n      \n      // Wenn keine Rollen gefunden wurden, probieren wir, diese aus roles in der Response direkt zu extrahieren\n      if (roleIds.length === 0 && response.data.role) {\n        logger.log('Versuche Rollen aus role-Eigenschaft zu extrahieren:', response.data.role);\n        if (Array.isArray(response.data.role)) {\n          roleIds = response.data.role.map((r: any) => r.id);\n        } else if (typeof response.data.role === 'object' && response.data.role !== null) {\n          roleIds = [response.data.role.id];\n        }\n      }\n      \n      logger.log('Endgltige extrahierte Rollen-IDs:', roleIds);\n      \n      // Extrahiere Branch-IDs aus der verschachtelten Struktur\n      let branchIds: number[] = [];\n      \n      if (response.data.branches && Array.isArray(response.data.branches)) {\n        logger.log('Branches-Struktur (Typ):', typeof response.data.branches, 'Lnge:', response.data.branches.length);\n        \n        // Struktur: branches: [{ branch: { id, name, ... } }]\n        if (response.data.branches.length > 0 && response.data.branches[0].branch) {\n          branchIds = response.data.branches.map(userBranch => userBranch.branch.id);\n          logger.log('Extrahierte Branch-IDs aus verschachtelter Struktur:', branchIds);\n        }\n        // Fallback fr andere Formate\n        else if (response.data.branches.length > 0) {\n          if (typeof response.data.branches[0] === 'number') {\n            branchIds = response.data.branches;\n          } else if (response.data.branches[0].branchId) {\n            branchIds = response.data.branches.map(branch => branch.branchId);\n          } else if (response.data.branches[0].id) {\n            branchIds = response.data.branches.map(branch => branch.id);\n          }\n        }\n      } else {\n        console.warn('Branches fehlen oder sind kein Array:', response.data.branches);\n      }\n      \n      logger.log('Endgltige extrahierte Branch-IDs:', branchIds);\n      \n      setSelectedUser(userData);\n      setUserFormData(userData);\n      setSelectedRoles(roleIds);\n      setSelectedBranches(branchIds);\n      \n      // Rollen nur einmal laden, wenn sie noch nicht geladen wurden\n      if (roles.length === 0) {\n        await fetchRoles();\n      }\n      \n      // Branches nur einmal laden, wenn sie noch nicht geladen wurden\n      if (branches.length === 0) {\n        await fetchBranches();\n      }\n    } catch (err) {\n      console.error('Fehler beim Laden der Benutzerdetails:', err);\n      handleError(err);\n    }\n  };\n\n  // Fehlerbehandlung\n  const handleError = (err: any) => {\n    let message = 'Ein Fehler ist aufgetreten';\n    if (err.response?.data?.message) {\n      message = err.response.data.message;\n    } else if (err instanceof Error) {\n      message = err.message;\n    }\n    \n    // Fehler \"Ungltige Rollen-ID\" nicht weitergeben, wenn kein Benutzer ausgewhlt ist\n    if (message.includes('Ungltige Rollen-ID') && !selectedUser) {\n      console.warn('Fehler unterdrckt, da kein Benutzer ausgewhlt ist:', message);\n      return;\n    }\n    \n    handleErrorContext({ message });\n  };\n\n  // Handler fr Auswahl eines Benutzers\n  const handleUserSelect = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const userId = parseInt(event.target.value, 10);\n    if (userId && !isNaN(userId)) {\n      fetchUserDetails(userId);\n    } else {\n      setSelectedUser(null);\n      setUserFormData({});\n      setSelectedRoles([]);\n    }\n  };\n\n  // Erweitere den handleUserInputChange\n  const handleUserInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value, type } = e.target;\n    let finalValue: string | number | null = value;\n    \n    // Korrekte Typenkonvertierung fr numerische Felder\n    if (type === 'number') {\n      // Wenn das Feld leer ist, setzen wir null statt NaN\n      finalValue = value === '' ? null : Number(value);\n    }\n    \n    setUserFormData({ ...userFormData, [name]: finalValue });\n    setIsEditingUser(true); // Aktiviere Edit-Modus sobald etwas gendert wird\n  };\n\n  // Abbrechen der Bearbeitung\n  const handleCancelEdit = () => {\n    if (selectedUser) {\n      setUserFormData({\n        ...selectedUser,\n        birthday: selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : null\n      });\n    }\n    setIsEditingUser(false);\n  };\n\n  // Speichern der Benutzerdaten\n  const handleUserSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!selectedUser || !selectedUser.id) {\n      handleErrorContext({ message: 'Kein Benutzer ausgewhlt' });\n      showMessage('Kein Benutzer ausgewhlt', 'error');\n      return;\n    }\n\n    try {\n      // Validierung\n      if (!userFormData.username?.trim()) throw new Error('Benutzername ist erforderlich');\n      if (!userFormData.email?.trim()) throw new Error('E-Mail ist erforderlich');\n      // firstName, lastName, birthday werden nur von KI aus Dokument gesetzt, nicht manuell validiert\n\n      // Bereite die Daten korrekt vor\n      // Contract, Salary, Normal Working Hours werden zu Lifecycle verschoben\n      // firstName, lastName, birthday werden nur von KI aus Dokument gesetzt, nicht manuell editierbar\n      const dataToSend = {\n        username: userFormData.username,\n        email: userFormData.email,\n        bankDetails: userFormData.bankDetails || null,\n        gender: userFormData.gender || null,\n        phoneNumber: userFormData.phoneNumber || null,\n        language: userFormData.language || null,\n        // Payroll-Felder bleiben (sind separate Sektion)\n        hourlyRate: userFormData.hourlyRate === null || userFormData.hourlyRate === undefined || userFormData.hourlyRate === '' as any\n          ? null \n          : typeof userFormData.hourlyRate === 'string' \n            ? userFormData.hourlyRate  // Keine Konvertierung fr Decimal-Werte, da sie als Strings bergeben werden sollten\n            : userFormData.hourlyRate.toString(),  // Konvertierung zu String fr Decimal-Werte\n        monthlySalary: userFormData.monthlySalary === null || userFormData.monthlySalary === undefined || userFormData.monthlySalary === '' as any\n          ? null \n          : typeof userFormData.monthlySalary === 'string' \n            ? parseFloat(userFormData.monthlySalary) \n            : userFormData.monthlySalary,\n        payrollCountry: userFormData.payrollCountry || null,\n        contractType: userFormData.contractType || null,\n      };\n\n      logger.log('Sende Daten zum Server:', dataToSend);\n\n      // Update Benutzerdaten\n      const response = await userApi.update(selectedUser.id, dataToSend);\n\n      if (response.data) {\n        const updatedData = {\n          ...response.data,\n          birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n        };\n        setSelectedUser(updatedData);\n        setUserFormData({\n          ...updatedData,\n          birthday: updatedData.birthday ? new Date(updatedData.birthday).toISOString().split('T')[0] : null\n        });\n        \n        // Optimistisches Update: User in allUsers und users aktualisieren\n        setAllUsers(prevUsers => \n          prevUsers.map(user => \n            user.id === updatedData.id ? updatedData : user\n          )\n        );\n        \n        // Benutzerliste neu filtern basierend auf aktuellem Tab\n        filterUsersByActiveStatus(userFilterTab, allUsers.map(user => \n          user.id === updatedData.id ? updatedData : user\n        ));\n        \n        showMessage('Benutzerprofil erfolgreich aktualisiert', 'success');\n        setIsEditingUser(false);\n      }\n    } catch (err) {\n      console.error('Fehler beim Speichern der Benutzerdaten:', err);\n      // Bei Fehler: Rollback durch vollstndiges Reload\n      await fetchAllUsers();\n      if (err.response?.status === 400) {\n        const errorMsg = `Validierungsfehler: ${err.response?.data?.message || 'Bitte berprfe die eingegebenen Daten'}`;\n        handleErrorContext({ message: errorMsg });\n        showMessage(errorMsg, 'error');\n      } else if (err.response?.status === 404) {\n        handleErrorContext({ message: 'Benutzer wurde nicht gefunden' });\n        showMessage('Benutzer wurde nicht gefunden', 'error');\n      } else {\n        handleError(err);\n      }\n    }\n  };\n\n  // Benutzer aktivieren/deaktivieren\n  const handleToggleActive = async () => {\n    if (!selectedUser || !selectedUser.id) {\n      showMessage('Kein Benutzer ausgewhlt', 'error');\n      return;\n    }\n\n    // Verhindere, dass der Admin-Benutzer sich selbst deaktiviert\n    const currentUserId = parseInt(localStorage.getItem('userId') || '0', 10);\n    if (selectedUser.id === currentUserId) {\n      showMessage('Du kannst dich nicht selbst deaktivieren', 'warning');\n      return;\n    }\n\n    try {\n      // Aktueller Status: wenn undefined, dann true (Default)\n      const currentActiveStatus = selectedUser.active !== undefined ? selectedUser.active : true;\n      const newActiveStatus = !currentActiveStatus;\n      \n      logger.log('Toggle active:', { \n        currentActiveStatus, \n        newActiveStatus, \n        selectedUser,\n        selectedUserActive: selectedUser.active,\n        userId: selectedUser.id\n      });\n      \n      const updatePayload = { active: newActiveStatus };\n      logger.log('Sending update payload:', updatePayload, 'Type of active:', typeof newActiveStatus);\n      \n      // Update Benutzer\n      const response = await userApi.update(selectedUser.id, updatePayload);\n      \n      logger.log('Update response:', response.data);\n\n      if (response.data) {\n        const updatedData = {\n          ...response.data,\n          active: response.data.active !== undefined ? response.data.active : true,\n          birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n        };\n        \n        logger.log('Updated user data:', updatedData);\n        \n        setSelectedUser(updatedData);\n        setUserFormData({\n          ...updatedData,\n          birthday: updatedData.birthday ? new Date(updatedData.birthday).toISOString().split('T')[0] : null\n        });\n        \n        // Optimistisches Update: Berechne den aktualisierten Array direkt (vor State-Update)\n        // Dies verhindert Race Conditions bei schnellen, aufeinanderfolgenden Updates\n        const updatedAllUsers = allUsers.map(user => \n          user.id === updatedData.id ? updatedData : user\n        );\n        \n        // Update State mit dem berechneten Array\n        setAllUsers(updatedAllUsers);\n        \n        // Filtere mit dem aktualisierten Array (nicht mit allUsers, da State-Update asynchron ist)\n        filterUsersByActiveStatus(userFilterTab, updatedAllUsers);\n        \n        // fetchAllUsers() entfernt - optimistisches Update reicht aus\n        // Backend speichert korrekt, State ist bereits aktualisiert\n        // Nur bei Fehler wird fetchAllUsers() aufgerufen (siehe catch-Block)\n        \n        showMessage(\n          newActiveStatus \n            ? 'Benutzer erfolgreich aktiviert' \n            : 'Benutzer erfolgreich deaktiviert',\n          'success'\n        );\n      }\n    } catch (err) {\n      console.error('Fehler beim Aktivieren/Deaktivieren des Benutzers:', err);\n      handleError(err);\n      // Bei Fehler: Benutzerliste neu laden\n      await fetchAllUsers();\n    }\n  };\n\n  // Toggle Rolle fr einen Benutzer (hinzufgen/entfernen)\n  const toggleRole = async (roleId: number) => {\n    if (!roleId || !selectedUser) return;\n    \n    // Prfe, ob es sich um eine fixe Rolle handelt - Nur fr Admin-Benutzer (ID: 1) sind Admin-Rollen (ID: 1) nicht entfernbar\n    if (roleId === 1 && selectedUser.id === 1 && selectedRoles.includes(roleId)) {\n      showMessage('Die Admin-Rolle kann vom Admin-Benutzer nicht entfernt werden', 'warning');\n      return;\n    }\n    \n    try {\n      logger.log('Toggle Rolle:', roleId, 'fr Benutzer:', selectedUser.id);\n      logger.log('Aktuelle ausgewhlte Rollen:', selectedRoles);\n      \n      // berprfen, ob die Rolle bereits zugewiesen ist\n      const isRoleSelected = selectedRoles.includes(roleId);\n      \n      const newSelectedRoles = isRoleSelected\n        ? selectedRoles.filter(id => id !== roleId)\n        : [...selectedRoles, roleId];\n      \n      logger.log('Neue ausgewhlte Rollen:', newSelectedRoles);\n      \n      // Optimistisches UI-Update\n      setSelectedRoles(newSelectedRoles);\n      \n      // API-Aufruf zur Aktualisierung der Rollen\n      logger.log('Sende Rollenaktualisierung an API:', { userId: selectedUser.id, roleIds: newSelectedRoles });\n      const response = await userApi.updateRoles(selectedUser.id, newSelectedRoles);\n      logger.log('API-Antwort bei Rollenaktualisierung:', response.data);\n      \n      // Benutzer nach dem Update neu laden\n      await fetchUserDetails(selectedUser.id);\n      \n      // Erfolgsmeldung anzeigen mit showMessage statt setUserSuccess\n      showMessage(\n        isRoleSelected\n          ? `Rolle erfolgreich entfernt`\n          : `Rolle erfolgreich zugewiesen`,\n        'success'\n      );\n    } catch (error) {\n      // Bei Fehler auf vorherigen Zustand zurcksetzen\n      console.error('Fehler beim Aktualisieren der Rollen:', error);\n      fetchUserDetails(selectedUser.id);\n      handleError(error);\n      showMessage('Fehler beim Aktualisieren der Rollen', 'error');\n    }\n  };\n\n  // Toggle Branch fr einen Benutzer (hinzufgen/entfernen)\n  const toggleBranch = async (branchId: number) => {\n    if (!branchId || !selectedUser) return;\n    \n    try {\n      logger.log('Toggle Branch:', branchId, 'fr Benutzer:', selectedUser.id);\n      logger.log('Aktuelle ausgewhlte Branches:', selectedBranches);\n      \n      // berprfen, ob die Branch bereits zugewiesen ist\n      const isBranchSelected = selectedBranches.includes(branchId);\n      \n      const newSelectedBranches = isBranchSelected\n        ? selectedBranches.filter(id => id !== branchId)\n        : [...selectedBranches, branchId];\n      \n      logger.log('Neue ausgewhlte Branches:', newSelectedBranches);\n      \n      // Optimistisches UI-Update\n      setSelectedBranches(newSelectedBranches);\n      \n      // API-Aufruf zur Aktualisierung der Branches\n      logger.log('Sende Branch-Aktualisierung an API:', { userId: selectedUser.id, branchIds: newSelectedBranches });\n      const response = await userApi.updateBranches(selectedUser.id, newSelectedBranches);\n      logger.log('API-Antwort bei Branch-Aktualisierung:', response.data);\n      \n      // Benutzer nach dem Update neu laden\n      await fetchUserDetails(selectedUser.id);\n      \n      // Erfolgsmeldung anzeigen\n      showMessage(\n        isBranchSelected\n          ? `Branch erfolgreich entfernt`\n          : `Branch erfolgreich zugewiesen`,\n        'success'\n      );\n    } catch (error) {\n      // Bei Fehler auf vorherigen Zustand zurcksetzen\n      console.error('Fehler beim Aktualisieren der Branches:', error);\n      fetchUserDetails(selectedUser.id);\n      handleError(error);\n      showMessage('Fehler beim Aktualisieren der Branches', 'error');\n    }\n  };\n\n  // Initialisiere FormData wenn Benutzer ausgewhlt wird\n  useEffect(() => {\n    if (selectedUser) {\n      setUserFormData({\n        ...selectedUser,\n        birthday: selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : null\n      });\n      setIsEditingUser(false); // Starte im Read-Only Modus\n    }\n  }, [selectedUser]);\n\n  // Handler fr neue Benutzer-Formular\n  const handleNewUserInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setNewUserFormData({ ...newUserFormData, [name]: value });\n  };\n\n  // Neuen Benutzer erstellen\n  const handleCreateUser = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Validierung\n    if (!newUserFormData.email || !newUserFormData.password || !newUserFormData.firstName || !newUserFormData.lastName) {\n      showMessage('Bitte fllen Sie alle Felder aus', 'error');\n      return;\n    }\n\n    // E-Mail-Format validieren\n    if (!newUserFormData.email.match(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/)) {\n      showMessage('Ungltiges E-Mail-Format', 'error');\n      return;\n    }\n\n    try {\n      const response = await userApi.create(newUserFormData);\n      \n      // Optimistisches Update: User zu allUsers hinzufgen\n      if (response.data) {\n        const newUser = {\n          ...response.data,\n          active: response.data.active !== undefined ? response.data.active : true\n        };\n        setAllUsers(prevUsers => [newUser, ...prevUsers]);\n        \n        // Wenn aktueller Tab \"active\" ist und neuer User aktiv ist, auch zu users hinzufgen\n        if (userFilterTab === 'active' && newUser.active) {\n          setUsers(prevUsers => [newUser, ...prevUsers]);\n        }\n      }\n      \n      showMessage('Benutzer erfolgreich erstellt', 'success');\n      setIsCreateModalOpen(false);\n      setNewUserFormData({\n        email: '',\n        password: '',\n        firstName: '',\n        lastName: ''\n      });\n    } catch (err: any) {\n      // Bei Fehler: Rollback durch vollstndiges Reload\n      await fetchAllUsers();\n      const errorMessage = err.response?.data?.message || 'Fehler beim Erstellen des Benutzers';\n      showMessage(errorMessage, 'error');\n      handleErrorContext({ message: errorMessage });\n    }\n  };\n\n  return (\n    <div className=\"container mx-auto px-4 pb-6\">\n      {/* Die lokale Erfolgsmeldungs-Anzeige wird entfernt, da wir jetzt HeaderMessage verwenden */}\n      {/* {userSuccess && (\n        <div className=\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4\">\n          {userSuccess}\n        </div>\n      )} */}\n\n      {/* Titelzeile: Button links, Dropdown rechts */}\n      <div className=\"mb-6\">\n        <div className=\"flex items-start gap-4\">\n          {/* Linke Seite: \"Neuer Benutzer\"-Button */}\n          <div className=\"flex items-center pt-8\">\n            {isAdmin() && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsCreateModalOpen(true)}\n                  className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                  style={{ width: '30.19px', height: '30.19px' }}\n                  aria-label={t('users.create')}\n                >\n                  <PlusIcon className=\"h-4 w-4\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('users.create')}\n                </div>\n              </div>\n            )}\n          </div>\n          \n          {/* Rechts: Benutzer-Dropdown mit Active/Inactive Tabs */}\n          <div className=\"flex-1\">\n            {/* Active/Inactive Tabs */}\n            <div className=\"flex gap-2 mb-2\">\n              <button\n                type=\"button\"\n                onClick={() => setUserFilterTab('active')}\n                className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${\n                  userFilterTab === 'active'\n                    ? 'bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400'\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600'\n                }`}\n              >\n                {t('users.active')}\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setUserFilterTab('inactive')}\n                className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${\n                  userFilterTab === 'inactive'\n                    ? 'bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400'\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600'\n                }`}\n              >\n                {t('users.inactive')}\n              </button>\n            </div>\n            \n            <select\n              id=\"userSelect\"\n              onChange={handleUserSelect}\n              className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n            >\n              <option value=\"\">-- {t('common.select')} --</option>\n              {users.map(user => (\n                <option key={user.id} value={user.id}>\n                  {user.firstName} {user.lastName} ({user.username})\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n      </div>\n\n      {selectedUser && (\n        <div>\n          {/* Tabs fr Benutzerdetails, Dokumente und Rollen - zusammenhngende Box ohne Shadow/Border */}\n          <div className=\"bg-white dark:bg-gray-800 mb-6\">\n            {/* Tab-Navigation */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n              <nav className=\"flex -mb-px\">\n                <button\n                  onClick={() => setActiveUserTab('details')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'details'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <UserCircleIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('users.title')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('documents')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'documents'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <DocumentTextIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('profile.documents')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('roles')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'roles'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <ShieldCheckIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('roles.title')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('branches')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'branches'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <MapPinIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('branches.title') || 'Niederlassungen'}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('lifecycle')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'lifecycle'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <BuildingOfficeIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('lifecycle.tabTitle')}\n                </button>\n              </nav>\n          </div>\n\n            {/* Tab-Inhalte */}\n          {/* Benutzerdetails Formular */}\n          {activeUserTab === 'details' && (\n              <form onSubmit={handleUserSubmit} className=\"p-6\">\n              {/* Benutzerdetails - gleiche Reihenfolge wie Profile.tsx */}\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-6\">\n                {/* 1. Username, Email (nebeneinander - 2 Spalten) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.username')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"username\"\n                    value={userFormData.username || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.email')}\n                  </label>\n                  <input\n                    type=\"email\"\n                    name=\"email\"\n                    value={userFormData.email || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* 2. Language (allein - 1 Spalte) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.language')} <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    name=\"language\"\n                    value={userFormData.language || 'es'}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    required\n                  >\n                    {LANGUAGES.map((language) => (\n                      <option key={language.code} value={language.code}>\n                        {language.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                {/* 3. Dokumenten-Upload (prominent - volle Breite) */}\n                {selectedUser && (\n                  <div className=\"sm:col-span-2\">\n                    <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <h3 className=\"text-sm font-medium text-blue-900 dark:text-blue-200 mb-1\">\n                            {t('profile.identificationDocument', { defaultValue: 'Identifikationsdokument' })}\n                          </h3>\n                          <p className=\"text-xs text-blue-700 dark:text-blue-300\">\n                            {t('profile.uploadDocumentHint', { defaultValue: 'Bitte laden Sie das Identifikationsdokument (Cdula oder Pasaporte) hoch. Die Felder werden automatisch ausgefllt.' })}\n                          </p>\n                        </div>\n                        <input\n                          type=\"file\"\n                          id=\"documentUploadUserManagement\"\n                          accept=\"image/*\"\n                          className=\"hidden\"\n                          onChange={handleDirectDocumentUploadWrapper}\n                          disabled={isUploading}\n                        />\n                        <label\n                          htmlFor=\"documentUploadUserManagement\"\n                          className={`p-2 text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer ${isUploading ? 'opacity-50 cursor-not-allowed' : ''}`}\n                          title={t('profile.uploadDocument', { defaultValue: 'Dokument hochladen' })}\n                        >\n                          <DocumentTextIcon className=\"h-5 w-5\" />\n                        </label>\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {/* 4. ID-Dokument-Daten (readonly, alle Felder - korrekte Reihenfolge) */}\n                {/* Zeige Felder an, wenn User-Daten vorhanden sind (werden beim Upload extrahiert) */}\n                {(selectedUser.firstName || selectedUser.lastName || selectedUser.birthday || selectedUser.identificationNumber) && (\n                  <>\n                    {(() => {\n                      const latestDoc = selectedUser.identificationDocuments && selectedUser.identificationDocuments.length > 0 ? selectedUser.identificationDocuments[0] : null;\n                      return (\n                        <>\n                          {/* 1. Vorname */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('users.form.firstName')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.firstName || ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 2. Nachname */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('users.form.lastName')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.lastName || ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 3. Geburtsdatum */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.birthday')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 4. Land */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.country')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.country ? COUNTRIES.find(c => c.code === selectedUser.country)?.name || selectedUser.country : ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 5. Geschlecht (editierbar, falls KI nicht richtig erkannt hat) */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.gender')}\n                            </label>\n                            <select\n                              name=\"gender\"\n                              value={userFormData.gender || ''}\n                              onChange={handleUserInputChange}\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                            >\n                              <option value=\"\">{t('profile.selectGender')}</option>\n                              <option value=\"male\">{t('profile.genderMale')}</option>\n                              <option value=\"female\">{t('profile.genderFemale')}</option>\n                              <option value=\"other\">{t('profile.genderOther')}</option>\n                            </select>\n                          </div>\n\n                          {/* 6. Dokument-Typ */}\n                          {latestDoc && (\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.identificationType')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={\n                                latestDoc.documentType\n                                  ? (() => {\n                                      const typeMap: Record<string, string> = {\n                                        passport: t('identificationDocuments.types.passport'),\n                                        national_id: t('identificationDocuments.types.national_id'),\n                                        driving_license: t('identificationDocuments.types.driving_license'),\n                                        residence_permit: t('identificationDocuments.types.residence_permit'),\n                                        work_permit: t('identificationDocuments.types.work_permit'),\n                                        tax_id: t('identificationDocuments.types.tax_id'),\n                                        social_security: t('identificationDocuments.types.social_security'),\n                                      };\n                                      return typeMap[latestDoc.documentType] || latestDoc.documentType;\n                                    })()\n                                  : ''\n                              }\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n                          )}\n\n                          {/* 7. Dokument-Nummer */}\n                          {(selectedUser.identificationNumber || latestDoc?.documentNumber) && (\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.identificationNumber')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.identificationNumber || latestDoc?.documentNumber || ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n                          )}\n\n                          {/* 8. Ausstellungsdatum */}\n                          {latestDoc?.issueDate && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.identificationIssueDate') || 'Ausstellungsdatum'}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={new Date(latestDoc.issueDate).toISOString().split('T')[0]}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n\n                          {/* 9. Ablaufdatum */}\n                          {latestDoc?.expiryDate && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.identificationExpiryDate')}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={new Date(latestDoc.expiryDate).toISOString().split('T')[0]}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n\n                          {/* 10. Ausstellungsland */}\n                          {latestDoc?.issuingCountry && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.issuingCountry')}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={latestDoc.issuingCountry}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n\n                          {/* 11. Ausstellungsbehrde */}\n                          {latestDoc?.issuingAuthority && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.issuingAuthority')}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={latestDoc.issuingAuthority}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n                        </>\n                      );\n                    })()}\n                  </>\n                )}\n\n                {/* 5. Phone Number (allein - 1 Spalte, da Geschlecht jetzt in ID-Dokument-Daten) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.phoneNumber')}\n                  </label>\n                  <input\n                    type=\"tel\"\n                    name=\"phoneNumber\"\n                    value={userFormData.phoneNumber || ''}\n                    onChange={handleUserInputChange}\n                    placeholder=\"+573001234567\"\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                    {t('profile.phoneNumberHint')}\n                  </p>\n                </div>\n\n                {/* 6. Finanzdaten (Bank Details - 1 Spalte) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.bankDetails')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"bankDetails\"\n                    value={userFormData.bankDetails || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Contract, Salary, Normal Working Hours ENTFERNEN - werden zu Lifecycle verschoben */}\n              </div>\n\n              {/* Lohnabrechnung-Einstellungen */}\n              <div className=\"mt-4 border-t pt-4\">\n                <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('users.form.payrollSettings')}</h3>\n                \n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('users.form.payrollCountry')}\n                    </label>\n                    <select\n                      name=\"payrollCountry\"\n                      value={userFormData.payrollCountry || selectedUser.payrollCountry || 'CH'}\n                      onChange={handleUserInputChange}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    >\n                      {PAYROLL_COUNTRIES.map(country => (\n                        <option key={country.code} value={country.code}>\n                          {country.name}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  \n                  {(userFormData.payrollCountry === 'CO' || \n                    (selectedUser.payrollCountry === 'CO' && !userFormData.payrollCountry)) && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('users.form.contractType')}\n                      </label>\n                      <select\n                        name=\"contractType\"\n                        value={userFormData.contractType || ''}\n                        onChange={handleUserInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      >\n                        <option value=\"\">Bitte auswhlen</option>\n                        {CONTRACT_TYPES.map(type => (\n                          <option key={type.code} value={type.code}>\n                            {type.name}\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                  )}\n                </div>\n                \n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('users.form.hourlyRate')} ({(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? 'CHF' : 'COP'})\n                    </label>\n                    <input\n                      type=\"number\"\n                      name=\"hourlyRate\"\n                      min=\"0\"\n                      step={(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? '0.05' : '1'}\n                      value={userFormData.hourlyRate === null || userFormData.hourlyRate === undefined ? '' : userFormData.hourlyRate}\n                      onChange={handleUserInputChange}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      placeholder={(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? 'z.B. 45.00' : 'z.B. 50000'}\n                    />\n                  </div>\n                  \n                  {((userFormData.payrollCountry === 'CO' || selectedUser.payrollCountry === 'CO') && \n                    (userFormData.contractType !== 'servicios_externos' && selectedUser.contractType !== 'servicios_externos') &&\n                    (userFormData.contractType || selectedUser.contractType)) && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('users.form.monthlySalary')} (COP)\n                      </label>\n                      <input\n                        type=\"number\"\n                        name=\"monthlySalary\"\n                        min=\"0\"\n                        step=\"1000\"\n                        value={userFormData.monthlySalary === null || userFormData.monthlySalary === undefined ? '' : userFormData.monthlySalary}\n                        onChange={handleUserInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                        placeholder=\"z.B. 3500000\"\n                      />\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {isEditingUser && (\n                <div className=\"mt-4 flex justify-end gap-3\">\n                  <div className=\"relative group\">\n                    <button\n                      type=\"button\"\n                      onClick={handleCancelEdit}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {t('common.cancel')}\n                    </div>\n                  </div>\n                  <div className=\"relative group\">\n                    <button\n                      type=\"submit\"\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                    >\n                      <CheckIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {t('common.save')}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* Status-Badge und Activate/Deactivate Button unter den Profil-Feldern */}\n              <div className=\"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-between items-center\">\n                {selectedUser.active !== undefined && (\n                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                    selectedUser.active \n                      ? 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300' \n                      : 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300'\n                  }`}>\n                    {selectedUser.active ? t('users.active') : t('users.inactive')}\n                  </span>\n                )}\n                {isAdmin() && (\n                  <button\n                    onClick={handleToggleActive}\n                    className={`relative group flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${\n                      selectedUser.active\n                        ? 'bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30'\n                        : 'bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900/20 dark:text-green-400 dark:hover:bg-green-900/30'\n                    }`}\n                  >\n                    {selectedUser.active ? (\n                      <>\n                        <XMarkIcon className=\"h-5 w-5\" />\n                        {t('users.deactivate')}\n                      </>\n                    ) : (\n                      <>\n                        <CheckIcon className=\"h-5 w-5\" />\n                        {t('users.activate')}\n                      </>\n                    )}\n                  </button>\n                )}\n              </div>\n            </form>\n          )}\n\n          {/* Identifikationsdokumente Tab */}\n          {activeUserTab === 'documents' && (\n              <div className=\"p-6\">\n            <IdentificationDocumentList userId={selectedUser.id} isAdmin={true} ref={documentListRef} />\n              </div>\n          )}\n\n          {/* Rollen Tab */}\n          {activeUserTab === 'roles' && (\n              <div className=\"p-6\">\n              {/* Rollenzuweisung - nur anzeigen, wenn Rollen geladen wurden */}\n              {loadingRoles ? (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('roleAssignment.title')}</h3>\n                  <p className=\"dark:text-gray-300\">{t('roleAssignment.loading')}</p>\n                </div>\n              ) : roles.length > 0 && (\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('roleAssignment.title')}</h3>\n                  \n                  {/* berprfung auf unbekannte Rollen */}\n                  {selectedRoles.some(roleId => !roles.some(role => role.id === roleId)) && (\n                    <div className=\"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4\">\n                      <p className=\"font-bold\">{t('roleAssignment.unknownRolesWarning')}</p>\n                      <p>{t('roleAssignment.unknownRolesMessage', { ids: selectedRoles.filter(roleId => !roles.some(role => role.id === roleId)).join(', ') })}</p>\n                      <p className=\"mt-2 text-sm\">{t('roleAssignment.availableRoleIds', { ids: roles.map(r => r.id).join(', ') })}</p>\n                    </div>\n                  )}\n                  \n                  {/* Aktuell zugewiesene Rollen */}\n                  <div className=\"mb-4\">\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('roleAssignment.currentRoles')}</h4>\n                    {selectedRoles.length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('roleAssignment.noRolesAssigned')}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {/* Bekannte zugewiesene Rollen */}\n                        {roles\n                          .filter(role => selectedRoles.includes(role.id))\n                          .map(role => {\n                            // Eine Rolle ist nur dann nicht entfernbar, wenn es sich um die Admin-Rolle (ID: 1) fr den Admin-Benutzer (ID: 1) handelt\n                            const isFixedRole = role.id === 1 && selectedUser && selectedUser.id === 1;\n                            return (\n                              <div \n                                key={role.id} \n                                className={`border rounded-lg p-4 ${isFixedRole ? 'border-green-500 bg-green-50 dark:bg-green-900/20 dark:border-green-700 cursor-not-allowed' : 'border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 cursor-pointer'}`}\n                                onClick={() => !isFixedRole && toggleRole(role.id)}\n                              >\n                                <div className=\"flex justify-between items-center\">\n                                  <div>\n                                    <h4 className=\"font-medium flex items-center dark:text-white\">\n                                      {role.name}\n                                      {isFixedRole && (\n                                        <span className=\"ml-2 text-xs bg-green-600 text-white px-2 py-0.5 rounded-full\">\n                                          {t('roleAssignment.fixed')}\n                                        </span>\n                                      )}\n                                    </h4>\n                                    <p className=\"text-sm text-gray-600 dark:text-gray-400\">{role.description}</p>\n                                  </div>\n                                  <div className={`flex items-center ${isFixedRole ? 'text-gray-400 dark:text-gray-500' : 'text-blue-600 dark:text-blue-400'}`}>\n                                    <span className=\"mr-2 text-sm\">{isFixedRole ? t('roleAssignment.fixedAssigned') : t('roleAssignment.remove')}</span>\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </div>\n                                </div>\n                              </div>\n                            );\n                          })}\n                        \n                        {/* Unbekannte zugewiesene Rollen */}\n                        {selectedRoles\n                          .filter(roleId => !roles.some(role => role.id === roleId))\n                          .map(roleId => (\n                            <div \n                              key={`unknown-${roleId}`} \n                              className=\"border border-orange-500 bg-orange-50 rounded-lg p-4\"\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{t('roleAssignment.unknownRole', { id: roleId })}</h4>\n                                  <p className=\"text-sm text-orange-600\">{t('roleAssignment.unknownRoleDescription')}</p>\n                                </div>\n                                <div className=\"flex items-center text-orange-600\">\n                                  <span className=\"mr-2 text-sm\">{t('roleAssignment.remove')}</span>\n                                  <button \n                                    onClick={() => toggleRole(roleId)}\n                                    className=\"focus:outline-none\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </button>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Verfgbare Rollen */}\n                  <div>\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('roleAssignment.availableRoles')}</h4>\n                    {roles.filter(role => !selectedRoles.includes(role.id)).length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('roleAssignment.noRolesAvailable')}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {roles\n                          .filter(role => !selectedRoles.includes(role.id))\n                          .map(role => (\n                            <div \n                              key={role.id} \n                              className=\"border border-gray-300 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50\"\n                              onClick={() => toggleRole(role.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{role.name}</h4>\n                                  <p className=\"text-sm text-gray-600\">{role.description}</p>\n                                </div>\n                                <div className=\"flex items-center text-gray-500 hover:text-blue-600\">\n                                  <span className=\"mr-2 text-sm\">{t('roleAssignment.add')}</span>\n                                  <PlusIcon className=\"h-5 w-5\" />\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Branches Tab */}\n          {activeUserTab === 'branches' && (\n              <div className=\"p-6\">\n              {/* Branch-Zuweisung - nur anzeigen, wenn Branches geladen wurden */}\n              {loadingBranches ? (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('branchAssignment.title') || 'Niederlassungszuweisung'}</h3>\n                  <p className=\"dark:text-gray-300\">{t('branchAssignment.loading') || 'Lade Niederlassungen...'}</p>\n                </div>\n              ) : branches.length > 0 && (\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('branchAssignment.title') || 'Niederlassungszuweisung'}</h3>\n                  \n                  {/* berprfung auf unbekannte Branches */}\n                  {selectedBranches.some(branchId => !branches.some(branch => branch.id === branchId)) && (\n                    <div className=\"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4\">\n                      <p className=\"font-bold\">{t('branchAssignment.unknownBranchesWarning') || 'Unbekannte Niederlassungen zugewiesen'}</p>\n                      <p>{t('branchAssignment.unknownBranchesMessage', { ids: selectedBranches.filter(branchId => !branches.some(branch => branch.id === branchId)).join(', ') }) || `Die folgenden Niederlassungs-IDs sind zugewiesen, aber nicht verfgbar: ${selectedBranches.filter(branchId => !branches.some(branch => branch.id === branchId)).join(', ')}`}</p>\n                      <p className=\"mt-2 text-sm\">{t('branchAssignment.availableBranchIds', { ids: branches.map(b => b.id).join(', ') }) || `Verfgbare Niederlassungs-IDs: ${branches.map(b => b.id).join(', ')}`}</p>\n                    </div>\n                  )}\n                  \n                  {/* Aktuell zugewiesene Branches */}\n                  <div className=\"mb-4\">\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('branchAssignment.currentBranches') || 'Aktuell zugewiesene Niederlassungen'}</h4>\n                    {selectedBranches.length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('branchAssignment.noBranchesAssigned') || 'Keine Niederlassungen zugewiesen'}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {/* Bekannte zugewiesene Branches */}\n                        {branches\n                          .filter(branch => selectedBranches.includes(branch.id))\n                          .map(branch => (\n                            <div \n                              key={branch.id} \n                              className=\"border border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 rounded-lg p-4 cursor-pointer\"\n                              onClick={() => toggleBranch(branch.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium dark:text-white\">\n                                    {branch.name}\n                                  </h4>\n                                </div>\n                                <div className=\"flex items-center text-blue-600 dark:text-blue-400\">\n                                  <span className=\"mr-2 text-sm\">{t('branchAssignment.remove') || 'Entfernen'}</span>\n                                  <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                  </svg>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                        \n                        {/* Unbekannte zugewiesene Branches */}\n                        {selectedBranches\n                          .filter(branchId => !branches.some(branch => branch.id === branchId))\n                          .map(branchId => (\n                            <div \n                              key={`unknown-${branchId}`} \n                              className=\"border border-orange-500 bg-orange-50 rounded-lg p-4\"\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{t('branchAssignment.unknownBranch', { id: branchId }) || `Unbekannte Niederlassung (ID: ${branchId})`}</h4>\n                                  <p className=\"text-sm text-orange-600\">{t('branchAssignment.unknownBranchDescription') || 'Diese Niederlassung existiert nicht mehr oder ist nicht verfgbar.'}</p>\n                                </div>\n                                <div className=\"flex items-center text-orange-600\">\n                                  <span className=\"mr-2 text-sm\">{t('branchAssignment.remove') || 'Entfernen'}</span>\n                                  <button \n                                    onClick={() => toggleBranch(branchId)}\n                                    className=\"focus:outline-none\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </button>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Verfgbare Branches */}\n                  <div>\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('branchAssignment.availableBranches') || 'Verfgbare Niederlassungen'}</h4>\n                    {branches.filter(branch => !selectedBranches.includes(branch.id)).length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('branchAssignment.noBranchesAvailable') || 'Keine weiteren Niederlassungen verfgbar'}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {branches\n                          .filter(branch => !selectedBranches.includes(branch.id))\n                          .map(branch => (\n                            <div \n                              key={branch.id} \n                              className=\"border border-gray-300 dark:border-gray-600 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20\"\n                              onClick={() => toggleBranch(branch.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium dark:text-white\">{branch.name}</h4>\n                                </div>\n                                <div className=\"flex items-center text-gray-500 hover:text-blue-600 dark:hover:text-blue-400\">\n                                  <span className=\"mr-2 text-sm\">{t('branchAssignment.add') || 'Hinzufgen'}</span>\n                                  <PlusIcon className=\"h-5 w-5\" />\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n              {!loadingBranches && branches.length === 0 && (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('branchAssignment.title') || 'Niederlassungszuweisung'}</h3>\n                  <p className=\"text-gray-500 dark:text-gray-400\">{t('branchAssignment.noBranchesFound') || 'Keine Niederlassungen gefunden'}</p>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Lebenszyklus Tab */}\n          {activeUserTab === 'lifecycle' && selectedUser && (\n              <div className=\"p-6\">\n            <LifecycleView \n              key={`lifecycle-${selectedUser.id}-${lifecycleRefreshKey}`}\n              userId={selectedUser.id} \n              userName={`${selectedUser.firstName} ${selectedUser.lastName}`}\n            />\n              </div>\n          )}\n          </div>\n        </div>\n      )}\n\n      {/* Sidepane/Modal fr Benutzererstellung */}\n      {isCreateModalOpen && (\n        <>\n          {/* Fr Mobile (unter 640px) - klassisches Modal */}\n          {isMobile ? (\n            <Dialog open={isCreateModalOpen} onClose={() => setIsCreateModalOpen(false)} className=\"relative z-50\">\n              <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n              \n              <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                  {/* Header */}\n                  <div className=\"px-6 py-4 border-b dark:border-gray-700\">\n                    <div className=\"flex items-center justify-between\">\n                      <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                        {t('organisation.createUser.title')}\n                      </Dialog.Title>\n                      <button\n                        onClick={() => setIsCreateModalOpen(false)}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                      >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                      </button>\n                    </div>\n                  </div>\n                  \n                  {/* Form */}\n                  <form onSubmit={handleCreateUser} className=\"p-6\">\n                    <div className=\"space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.email')} *\n                        </label>\n                        <input\n                          type=\"email\"\n                          name=\"email\"\n                          value={newUserFormData.email}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.password')} *\n                        </label>\n                        <input\n                          type=\"password\"\n                          name=\"password\"\n                          value={newUserFormData.password}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.firstName')} *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"firstName\"\n                          value={newUserFormData.firstName}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.lastName')} *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"lastName\"\n                          value={newUserFormData.lastName}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                    </div>\n                    \n                    {/* Footer */}\n                    <div className=\"mt-6 flex justify-end gap-3\">\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          onClick={() => setIsCreateModalOpen(false)}\n                          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                        >\n                          <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('common.cancel')}\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          type=\"submit\"\n                          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                        >\n                          <CheckIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('organisation.createUser.create')}\n                        </div>\n                      </div>\n                    </div>\n                  </form>\n                </Dialog.Panel>\n              </div>\n            </Dialog>\n          ) : (\n            // Fr Desktop (ab 640px) - Sidepane\n            // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n            <>\n              {/* Backdrop - nur wenn offen und <= 1070px */}\n              {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n              {isCreateModalOpen && !isLargeScreen && (\n                <div \n                  className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                  aria-hidden=\"true\" \n                  style={{\n                    opacity: isCreateModalOpen ? 1 : 0,\n                    transition: 'opacity 300ms ease-out'\n                  }}\n                />\n              )}\n              \n              {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n              <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isCreateModalOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                  transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                  pointerEvents: isCreateModalOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isCreateModalOpen}\n                role=\"dialog\"\n                aria-modal={isCreateModalOpen}\n              >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                  <h2 className=\"text-lg font-semibold dark:text-white\">\n                    {t('organisation.createUser.title')}\n                  </h2>\n                  <button\n                    onClick={() => setIsCreateModalOpen(false)}\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                <div className=\"flex flex-col flex-1 min-h-0\">\n                  <form onSubmit={handleCreateUser} className=\"flex flex-col flex-1 min-h-0\">\n                    <div className=\"p-4 overflow-y-auto flex-1 min-h-0 space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.email')} *\n                        </label>\n                      <input\n                        type=\"email\"\n                        name=\"email\"\n                        value={newUserFormData.email}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.password')} *\n                      </label>\n                      <input\n                        type=\"password\"\n                        name=\"password\"\n                        value={newUserFormData.password}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.firstName')} *\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"firstName\"\n                        value={newUserFormData.firstName}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.lastName')} *\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"lastName\"\n                        value={newUserFormData.lastName}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                      </div>\n                    </div>\n                    \n                    {/* Footer */}\n                    <div className=\"flex justify-end gap-3 border-t dark:border-gray-700 pt-4 px-4 flex-shrink-0\">\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          onClick={() => setIsCreateModalOpen(false)}\n                          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                        >\n                          <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('common.cancel')}\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          type=\"submit\"\n                          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                        >\n                          <CheckIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('organisation.createUser.create')}\n                        </div>\n                      </div>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default UserManagementTab; ","import React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { roleApi, branchApi } from '../api/apiClient.ts';\nimport { Role, AccessLevel } from '../types/interfaces.ts';\nimport { PencilIcon, TrashIcon, PlusIcon, FunnelIcon, XMarkIcon, CheckIcon, ArrowPathIcon, DocumentDuplicateIcon, ChevronDownIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { useFilterContext } from '../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { ErrorCategory } from '../services/ErrorHandler.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport { logger } from '../utils/logger.ts';\n\ninterface RoleManagementTabProps {\n  onRolesChange?: () => void;\n  onError?: (error: string) => void;\n  readOnly?: boolean;\n}\n\n// Definiere Seiten, die immer sichtbar sein sollen (ohne Berechtigungsprfung)\nconst alwaysVisiblePages = ['dashboard', 'worktracker', 'cerebro', 'settings', 'profile'];\n\n// ALLE SEITEN IM SYSTEM (synchron mit Backend)\nconst defaultPages = [\n  'dashboard',\n  'worktracker',\n  'consultations',\n  'team_worktime_control', // = workcenter\n  'payroll', // = lohnabrechnung\n  'organization_management', // = organisation (Hauptseite)\n  'cerebro',\n  'settings',\n  'profile',\n  'tour_management', // NEU: Touren-Verwaltung\n  'password_manager', // NEU: Passwort-Manager\n  'price_analysis' // NEU: Preisanalyse\n];\n\n// ALLE TABELLEN IM SYSTEM (synchron mit Backend)\nconst defaultTables = [\n  'requests',           // auf dashboard\n  'tasks',             // auf worktracker\n  'reservations',      // auf worktracker (in To Do's Box)\n  'users',             // auf organization_management\n  'roles',             // auf organization_management\n  'organization',      // auf organization_management\n  'organization_join_requests', // auf organization_management\n  'organization_users',  // auf organization_management\n  'team_worktime',     // auf team_worktime_control\n  'worktime',          // auf worktracker\n  'clients',           // auf consultations\n  'consultation_invoices', // auf consultations\n  'branches',          // auf settings/system\n  'notifications',     // allgemein\n  'settings',          // auf settings\n  'monthly_reports',    // auf consultations/reports\n  'tours',             // NEU: auf tour_management\n  'tour_bookings',     // NEU: auf tour_management\n  'ota_listings',      // NEU: auf price_analysis\n  'price_analyses',    // NEU: auf price_analysis\n  'price_recommendations', // NEU: auf price_analysis\n  'pricing_rules',     // NEU: auf price_analysis\n  'rate_shopping_jobs' // NEU: auf price_analysis\n];\n\n// ALLE BUTTONS IM SYSTEM (synchron mit Backend)\nconst defaultButtons = [\n  // Database Management Buttons (Settings/System)\n  'database_reset_table',\n  'database_logs',\n  \n  // Invoice Functions Buttons\n  'invoice_create',\n  'invoice_download', \n  'invoice_mark_paid',\n  'invoice_settings',\n  \n  // Todo/Task Buttons (Worktracker)\n  'todo_create',\n  'todo_edit',\n  'todo_delete',\n  'task_create',\n  'task_edit', \n  'task_delete',\n  \n  // User Management Buttons\n  'user_create',\n  'user_edit',\n  'user_delete',\n  'role_assign',\n  'role_create',\n  'role_edit',\n  'role_delete',\n  \n  // Organization Management Buttons\n  'organization_create',\n  'organization_edit',\n  'organization_delete',\n  \n  // Worktime Buttons\n  'worktime_start',\n  'worktime_stop', \n  'worktime_edit',\n  'worktime_delete',\n  \n  // General Cerebro Button\n  'cerebro',\n  \n  // Consultation Buttons\n  'consultation_start',\n  'consultation_stop',\n  'consultation_edit',\n  \n  // Client Management Buttons\n  'client_create',\n  'client_edit',\n  'client_delete',\n  \n  // Settings Buttons\n  'settings_system',\n  'settings_notifications',\n  'settings_profile',\n  \n  // Payroll Buttons\n  'payroll_generate',\n  'payroll_export',\n  'payroll_edit',\n  \n  // Tour Management Buttons\n  'tour_create',\n  'tour_edit',\n  'tour_delete',\n  'tour_view',\n  'tour_booking_create',\n  'tour_booking_edit',\n  'tour_booking_cancel',\n  'tour_provider_create',\n  'tour_provider_edit',\n  'tour_provider_delete',\n  \n  // Password Manager Buttons\n  'password_entry_create',\n  'password_entry_edit',\n  'password_entry_delete',\n  \n  // Price Analysis Buttons\n  'price_analysis_create_rule',\n  'price_analysis_edit_rule',\n  'price_analysis_delete_rule',\n  'price_analysis_apply_recommendation',\n  'price_analysis_reject_recommendation',\n  'price_analysis_run_rate_shopping'\n];\n\n// Definiert die Zuordnung von Tabellen zu ihren bergeordneten Seiten\nconst tableToPageMapping = {\n  'requests': 'dashboard',\n  'tasks': 'worktracker',\n  'reservations': 'worktracker',\n  'users': 'organization_management',\n  'roles': 'organization_management',\n  'organization': 'organization_management',\n  'organization_join_requests': 'organization_management',\n  'organization_users': 'organization_management',\n  'team_worktime': 'team_worktime_control',\n  'worktime': 'worktracker',\n  'clients': 'consultations',\n  'consultation_invoices': 'consultations',\n  'branches': 'settings',\n  'notifications': 'general',\n  'settings': 'settings',\n  'monthly_reports': 'consultations',\n  'tours': 'tour_management',\n  'tour_bookings': 'tour_management',\n  'ota_listings': 'price_analysis',\n  'price_analyses': 'price_analysis',\n  'price_recommendations': 'price_analysis',\n  'pricing_rules': 'price_analysis',\n  'rate_shopping_jobs': 'price_analysis'\n};\n\n// Definiert die Zuordnung von Buttons zu ihren bergeordneten Seiten/Bereichen\nconst buttonToPageMapping = {\n  'database_reset_table': 'settings',\n  'database_logs': 'settings',\n  'invoice_create': 'consultations',\n  'invoice_download': 'consultations',\n  'invoice_mark_paid': 'consultations',\n  'invoice_settings': 'consultations',\n  'todo_create': 'worktracker',\n  'todo_edit': 'worktracker',\n  'todo_delete': 'worktracker',\n  'task_create': 'worktracker',\n  'task_edit': 'worktracker',\n  'task_delete': 'worktracker',\n  'user_create': 'organization_management',\n  'user_edit': 'organization_management',\n  'user_delete': 'organization_management',\n  'role_assign': 'organization_management',\n  'role_create': 'organization_management',\n  'role_edit': 'organization_management',\n  'role_delete': 'organization_management',\n  'organization_create': 'organization_management',\n  'organization_edit': 'organization_management',\n  'organization_delete': 'organization_management',\n  'worktime_start': 'worktracker',\n  'worktime_stop': 'worktracker',\n  'worktime_edit': 'worktracker',\n  'worktime_delete': 'worktracker',\n  'cerebro': 'cerebro',\n  'consultation_start': 'consultations',\n  'consultation_stop': 'consultations',\n  'consultation_edit': 'consultations',\n  'client_create': 'consultations',\n  'client_edit': 'consultations',\n  'client_delete': 'consultations',\n  'settings_system': 'settings',\n  'settings_notifications': 'settings',\n  'settings_profile': 'settings',\n  'payroll_generate': 'payroll',\n  'payroll_export': 'payroll',\n  'payroll_edit': 'payroll',\n  'tour_create': 'tour_management',\n  'tour_edit': 'tour_management',\n  'tour_delete': 'tour_management',\n  'tour_view': 'tour_management',\n  'tour_booking_create': 'tour_management',\n  'tour_booking_edit': 'tour_management',\n  'tour_booking_cancel': 'tour_management',\n  'tour_provider_create': 'tour_management',\n  'tour_provider_edit': 'tour_management',\n  'tour_provider_delete': 'tour_management',\n  'password_entry_create': 'password_manager',\n  'password_entry_edit': 'password_manager',\n  'password_entry_delete': 'password_manager',\n  'price_analysis_create_rule': 'price_analysis',\n  'price_analysis_edit_rule': 'price_analysis',\n  'price_analysis_delete_rule': 'price_analysis',\n  'price_analysis_apply_recommendation': 'price_analysis',\n  'price_analysis_reject_recommendation': 'price_analysis',\n  'price_analysis_run_rate_shopping': 'price_analysis'\n};\n\n// Definiert die Zuordnung von Buttons zu ihren zugehrigen Tabellen\nconst buttonToTableMapping: Record<string, string | null> = {\n  // Worktime Buttons  worktime Tabelle\n  'worktime_start': 'worktime',\n  'worktime_stop': 'worktime',\n  'worktime_edit': 'worktime',\n  'worktime_delete': 'worktime',\n  // Task/Todo Buttons  tasks Tabelle\n  'task_create': 'tasks',\n  'task_edit': 'tasks',\n  'task_delete': 'tasks',\n  'todo_create': 'tasks',\n  'todo_edit': 'tasks',\n  'todo_delete': 'tasks',\n  // Client Buttons  clients Tabelle\n  'client_create': 'clients',\n  'client_edit': 'clients',\n  'client_delete': 'clients',\n  'consultation_start': 'clients',\n  'consultation_stop': 'clients',\n  'consultation_edit': 'clients',\n  // Invoice Buttons  consultation_invoices Tabelle\n  'invoice_create': 'consultation_invoices',\n  'invoice_download': 'consultation_invoices',\n  'invoice_mark_paid': 'consultation_invoices',\n  'invoice_settings': 'consultation_invoices',\n  // User Management Buttons  users/roles Tabellen\n  'user_create': 'users',\n  'user_edit': 'users',\n  'user_delete': 'users',\n  'role_assign': 'roles',\n  'role_create': 'roles',\n  'role_edit': 'roles',\n  'role_delete': 'roles',\n  // Organization Management Buttons  organization Tabelle\n  'organization_create': 'organization',\n  'organization_edit': 'organization',\n  'organization_delete': 'organization',\n  // Settings Buttons  settings Tabelle\n  'settings_system': 'settings',\n  'settings_notifications': 'settings',\n  'settings_profile': 'settings',\n  // Tour Management Buttons  tours/tour_bookings Tabellen\n  'tour_create': 'tours',\n  'tour_edit': 'tours',\n  'tour_delete': 'tours',\n  'tour_view': 'tours',\n  'tour_booking_create': 'tour_bookings',\n  'tour_booking_edit': 'tour_bookings',\n  'tour_booking_cancel': 'tour_bookings',\n  'tour_provider_create': null, // Keine direkte Tabelle\n  'tour_provider_edit': null,\n  'tour_provider_delete': null,\n  // Password Manager Buttons  keine direkte Tabelle (entry-level permissions)\n  'password_entry_create': null,\n  'password_entry_edit': null,\n  'password_entry_delete': null,\n  // Price Analysis Buttons  entsprechende Tabellen\n  'price_analysis_create_rule': 'pricing_rules',\n  'price_analysis_edit_rule': 'pricing_rules',\n  'price_analysis_delete_rule': 'pricing_rules',\n  'price_analysis_apply_recommendation': 'price_recommendations',\n  'price_analysis_reject_recommendation': 'price_recommendations',\n  'price_analysis_run_rate_shopping': 'rate_shopping_jobs',\n  // Buttons ohne direkte Tabelle-Zuordnung\n  'database_reset_table': null,\n  'database_logs': null,\n  'cerebro': null,\n  'payroll_generate': null,\n  'payroll_export': null,\n  'payroll_edit': null\n};\n\n// Display-Name-Mapping fr Seiten (DB-Interne Bezeichnung  Frontend-Bezeichnung)\n// Wird dynamisch aus bersetzungen geladen\n\n// Display-Name-Mapping fr Tabellen (DB-Interne Bezeichnung  Frontend-Bezeichnung)\n// Wird dynamisch aus bersetzungen geladen\n\n// Display-Name-Mapping fr Buttons wird dynamisch in der Komponente geladen\n\n// TableID fr gespeicherte Filter\nconst ROLES_TABLE_ID = 'roles-table';\n\n// Standardrollen-IDs (fr Rollen ohne Organisation)\nconst STANDARD_ROLE_IDS = [1, 2, 999]; // Admin (1), User (2), Hamburger (999)\n\n// Standardrollen-Namen (drfen nicht bearbeitet/gelscht werden, egal von welcher Organisation)\nconst STANDARD_ROLE_NAMES = ['Admin', 'User', 'Hamburger'];\n\n// Helper-Funktion zur Prfung ob es sich um eine Standardrolle handelt\nconst isStandardRole = (roleId: number, roleName?: string): boolean => {\n  // Prfe zuerst auf Standard-IDs (fr Rollen ohne Organisation)\n  if (STANDARD_ROLE_IDS.includes(roleId)) {\n    return true;\n  }\n  // Prfe auf Standard-Namen (fr Rollen in Organisationen)\n  if (roleName && STANDARD_ROLE_NAMES.includes(roleName)) {\n    return true;\n  }\n  return false;\n};\n\ninterface RoleFormData {\n  name: string;\n  description: string;\n  permissions: {\n    entity: string;\n    entityType: string;\n    accessLevel: AccessLevel;\n  }[];\n}\n\n\n// RoleCard-Komponente fr mobile Ansicht\nconst RoleCard: React.FC<{\n  role: Role;\n  onEdit: (role: Role) => void;\n  onDelete: (roleId: number) => void;\n  onCopy: (role: Role) => void;\n  canEdit: boolean;\n  canDelete: boolean;\n  canCopy: boolean;\n}> = ({ role, onEdit, onDelete, onCopy, canEdit, canDelete, canCopy }) => {\n  const { t } = useTranslation();\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4 mb-4\">\n      {/* Header mit Rollenname und Aktionen */}\n      <div className=\"flex justify-between items-start mb-2\">\n        <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{role.name}</h3>\n        \n        <div className=\"flex space-x-2\">\n          {canCopy && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => onCopy(role)}\n                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n              >\n                <DocumentDuplicateIcon className=\"h-5 w-5\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('roles.actions.copy')}\n              </div>\n            </div>\n          )}\n          \n          {canEdit && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => onEdit(role)}\n                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n              >\n                <PencilIcon className=\"h-5 w-5\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('roles.actions.edit')}\n              </div>\n            </div>\n          )}\n          \n          {canDelete && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => onDelete(role.id)}\n                className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n              >\n                <TrashIcon className=\"h-5 w-5\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('roles.actions.delete')}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n      \n      {/* Beschreibung */}\n      <p className=\"text-sm text-gray-600 dark:text-gray-400\">{role.description || t('roles.noDescription')}</p>\n      \n      {/* Branch-Zuweisungen */}\n      <div className=\"mt-2\">\n        <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n          {role.allBranches ? (\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300\">\n              {t('roles.form.allBranches') || 'Alle Branches'}\n            </span>\n          ) : role.branches && role.branches.length > 0 ? (\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300\">\n              {role.branches.length} {t('roles.form.specificBranches') || 'Branches'}\n            </span>\n          ) : (\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400\">\n              {t('roles.form.noBranches') || 'Keine Branches'}\n            </span>\n          )}\n        </span>\n      </div>\n      \n      {/* Berechtigungen - kompakt */}\n      <div className=\"mt-2\">\n        <h4 className=\"text-sm font-medium text-gray-900 dark:text-white mb-1\">{t('roles.permissions')}:</h4>\n        <div className=\"flex flex-wrap gap-1\">\n          {role.permissions\n            .filter(perm => perm.accessLevel !== 'none') // Nur relevante Berechtigungen anzeigen\n            .slice(0, 8) // Begrenze die Anzahl der angezeigten Berechtigungen\n            .map(permission => (\n              <span \n                key={`${permission.entity}-${permission.entityType}`}\n                className=\"text-xs bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 px-2 py-1 rounded\"\n              >\n                {permission.entity}: {permission.accessLevel}\n              </span>\n            ))}\n          {role.permissions.filter(perm => perm.accessLevel !== 'none').length > 8 && (\n            <span className=\"text-xs bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-300 px-2 py-1 rounded\">\n                +{role.permissions.filter(perm => perm.accessLevel !== 'none').length - 8} {t('common.showMore')}\n            </span>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst RoleManagementTab: React.FC<RoleManagementTabProps> = ({ onRolesChange, onError, readOnly = false }) => {\n  const { t } = useTranslation();\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [editingRole, setEditingRole] = useState<Role | null>(null);\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loading, setLoading] = useState(true);\n  \n  // Display-Name-Mapping fr Seiten (dynamisch aus bersetzungen)\n  const pageDisplayNames = useMemo(() => ({\n    'dashboard': t('roles.pages.dashboard'),\n    'worktracker': t('roles.pages.worktracker'),\n    'consultations': t('roles.pages.consultations'),\n    'team_worktime_control': t('roles.pages.team_worktime_control'),\n    'payroll': t('roles.pages.payroll'),\n    'organization_management': t('roles.pages.organization_management'), // Organisation-Seite (Hauptseite)\n    'cerebro': t('roles.pages.cerebro'),\n    'settings': t('roles.pages.settings'),\n    'profile': t('roles.pages.profile'),\n    'tour_management': t('roles.pages.tour_management', 'Touren-Verwaltung'),\n    'password_manager': t('roles.pages.password_manager', 'Passwort-Manager')\n  }), [t]);\n\n  // Display-Name-Mapping fr Tabellen (dynamisch aus bersetzungen)\n  const tableDisplayNames = useMemo(() => ({\n    'tasks': t('roles.tables.tasks'),\n    'reservations': t('roles.tables.reservations'),\n    'worktime': t('roles.tables.worktime'),\n    'users': t('roles.tables.users'),\n    'roles': t('roles.tables.roles'),\n    'organization': t('roles.tables.organization'),\n    'organization_join_requests': t('roles.tables.organization_join_requests'),\n    'organization_users': t('roles.tables.organization_users'),\n    'clients': t('roles.tables.clients'),\n    'consultation_invoices': t('roles.tables.consultation_invoices'),\n    'requests': t('roles.tables.requests'),\n    'team_worktime': t('roles.tables.team_worktime'),\n    'settings': t('roles.tables.settings'),\n    'notifications': t('roles.tables.notifications'),\n    'branches': t('roles.tables.branches'),\n    'monthly_reports': t('roles.tables.monthly_reports'),\n    'tours': t('roles.tables.tours', 'Touren'),\n    'tour_bookings': t('roles.tables.tour_bookings', 'Tour-Buchungen')\n  }), [t]);\n\n  // Display-Name-Mapping fr Buttons (dynamisch aus bersetzungen)\n  const buttonDisplayNames = useMemo(() => ({\n    'worktime_start': t('roles.buttons.worktime_start'),\n    'worktime_stop': t('roles.buttons.worktime_stop'),\n    'worktime_edit': t('roles.buttons.worktime_edit'),\n    'worktime_delete': t('roles.buttons.worktime_delete'),\n    'task_create': t('roles.buttons.task_create'),\n    'task_edit': t('roles.buttons.task_edit'),\n    'task_delete': t('roles.buttons.task_delete'),\n    'todo_create': t('roles.buttons.todo_create'),\n    'todo_edit': t('roles.buttons.todo_edit'),\n    'todo_delete': t('roles.buttons.todo_delete'),\n    'client_create': t('roles.buttons.client_create'),\n    'client_edit': t('roles.buttons.client_edit'),\n    'client_delete': t('roles.buttons.client_delete'),\n    'consultation_start': t('roles.buttons.consultation_start'),\n    'consultation_stop': t('roles.buttons.consultation_stop'),\n    'consultation_edit': t('roles.buttons.consultation_edit'),\n    'invoice_create': t('roles.buttons.invoice_create'),\n    'invoice_download': t('roles.buttons.invoice_download'),\n    'invoice_mark_paid': t('roles.buttons.invoice_mark_paid'),\n    'invoice_settings': t('roles.buttons.invoice_settings'),\n    'user_create': t('roles.buttons.user_create'),\n    'user_edit': t('roles.buttons.user_edit'),\n    'user_delete': t('roles.buttons.user_delete'),\n    'role_assign': t('roles.buttons.role_assign'),\n    'role_create': t('roles.buttons.role_create'),\n    'role_edit': t('roles.buttons.role_edit'),\n    'role_delete': t('roles.buttons.role_delete'),\n    'organization_create': t('roles.buttons.organization_create'),\n    'organization_edit': t('roles.buttons.organization_edit'),\n    'organization_delete': t('roles.buttons.organization_delete'),\n    'settings_system': t('roles.buttons.settings_system'),\n    'settings_notifications': t('roles.buttons.settings_notifications'),\n    'settings_profile': t('roles.buttons.settings_profile'),\n    'database_reset_table': t('roles.buttons.database_reset_table'),\n    'database_logs': t('roles.buttons.database_logs'),\n    'payroll_generate': t('roles.buttons.payroll_generate'),\n    'payroll_export': t('roles.buttons.payroll_export'),\n    'payroll_edit': t('roles.buttons.payroll_edit'),\n    'cerebro': t('roles.buttons.cerebro')\n  }), [t]);\n  const [formData, setFormData] = useState<RoleFormData>({\n    name: '',\n    description: '',\n    permissions: [\n      // Seiten-Berechtigungen\n      ...defaultPages.map(page => ({\n        entity: page,\n        entityType: 'page',\n        accessLevel: 'none' as AccessLevel\n      })),\n      // Tabellen-Berechtigungen\n      ...defaultTables.map(table => ({\n        entity: table,\n        entityType: 'table',\n        accessLevel: 'none' as AccessLevel\n      })),\n      // Button-Berechtigungen\n      ...defaultButtons.map(button => ({\n        entity: button,\n        entityType: 'button',\n        accessLevel: 'none' as AccessLevel\n      }))\n    ]\n  });\n  const [error, setError] = useState<string | null>(null);\n  const { hasPermission } = usePermissions();\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n  \n  // States fr Branch-Zuweisungen\n  const [allBranches, setAllBranches] = useState<boolean>(true);\n  const [selectedBranchIds, setSelectedBranchIds] = useState<number[]>([]);\n  const [branches, setBranches] = useState<Array<{ id: number; name: string }>>([]);\n  const [loadingBranches, setLoadingBranches] = useState(false);\n  \n  // Neue State-Variablen fr erweiterte Filterbedingungen\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  // Responsiveness Hook (640px wie Standard)\n  const [isMobile, setIsMobile] = useState<boolean>(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  \n  // Fehlerbehandlung mit Fallback - useRef fr stabile onError-Referenz\n  const onErrorRef = useRef(onError);\n  useEffect(() => {\n    onErrorRef.current = onError;\n  }, [onError]);\n\n  const errorContext = useError();\n  const handleError = useCallback((err: any, context?: Record<string, any>) => {\n    if (errorContext?.handleError) {\n      errorContext.handleError(err, context);\n    } else {\n      console.error('Fehler:', err, context);\n      if (onErrorRef.current) {\n        onErrorRef.current(err?.message || 'Ein Fehler ist aufgetreten');\n      }\n    }\n  }, [errorContext]);\n\n  const handleValidationError = useCallback((message: string, fieldErrors?: Record<string, string>) => {\n    if (errorContext?.handleValidationError) {\n      errorContext.handleValidationError(message, fieldErrors);\n    } else {\n      console.error('Validierungsfehler:', message, fieldErrors);\n      if (onErrorRef.current) {\n        onErrorRef.current(message);\n      }\n    }\n  }, [errorContext]);\n  \n  // Neue State-Variablen fr die Berechtigungen\n  const [isAddPermissionModalOpen, setIsAddPermissionModalOpen] = useState(false);\n  const [selectedPermission, setSelectedPermission] = useState<string | null>(null);\n  const [displayLimit, setDisplayLimit] = useState<number>(10);\n  \n  // berwache Bildschirmgre\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isModalOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isModalOpen, openSidepane, closeSidepane]);\n\n  // Funktion zum Laden der Branches\n  const fetchBranches = useCallback(async () => {\n    setLoadingBranches(true);\n    try {\n      const response = await branchApi.getAll();\n      setBranches(response.data);\n    } catch (error) {\n      console.error('Fehler beim Laden der Branches:', error);\n    } finally {\n      setLoadingBranches(false);\n    }\n  }, []);\n\n  // Aktualisiere die fetchRoles-Funktion, um den neuen ErrorHandler zu nutzen\n  const fetchRoles = useCallback(async () => {\n    setLoading(true);\n    logger.log('DEBUGAUSGABE: Hole Rollen vom Server...');\n    \n    try {\n      const response = await roleApi.getAll();\n      logger.log('DEBUGAUSGABE: Rollen erfolgreich geholt:', response.data);\n      setRoles(response.data);\n      setError(null);\n    } catch (error) {\n      console.error('DEBUGAUSGABE: Fehler beim Abrufen der Rollen:', error);\n      // Nutze den neuen ErrorHandler\n      handleError(error, { \n        component: 'RoleManagementTab', \n        action: 'fetchRoles' \n      });\n      // Rufe auch den bergebenen onError auf, falls vorhanden\n      if (onError) {\n        onError('Fehler beim Laden der Rollen');\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [handleError]);\n\n  //  ENTFERNT: Direkt Rollen laden - wird jetzt durch Standard-Pattern gemacht (nach Default-Filter-Anwendung)\n\n  // Branches beim ffnen des Modals laden\n  useEffect(() => {\n    if (isModalOpen) {\n      fetchBranches();\n    }\n  }, [isModalOpen, fetchBranches]);\n\n  // Speichern einer Rolle\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n\n    // Validierung: Wenn allBranches = false, mssen Branches ausgewhlt sein\n    if (!allBranches && selectedBranchIds.length === 0) {\n      handleError(t('roles.form.branchSelectionRequired') || 'Bitte whlen Sie mindestens eine Branch aus oder aktivieren Sie \"Fr alle Branches gltig\"', {\n        component: 'RoleManagementTab'\n      });\n      return;\n    }\n    \n    if (!formData.name) {\n      handleValidationError('Rollenname darf nicht leer sein', { name: 'Rollenname ist erforderlich' });\n      return;\n    }\n    \n    if (editingRole) {\n      // Stelle sicher, dass die immer sichtbaren Seiten auch tatschlich auf 'both' gesetzt sind\n      const updatedPermissions = formData.permissions.map(permission => {\n        if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n          return { ...permission, accessLevel: 'both' };\n        }\n        return permission;\n      });\n      \n      // Filtere nur die relevanten Berechtigungen (nicht 'none')\n      const filteredPermissions = updatedPermissions\n        .filter(permission => permission.accessLevel !== 'none')\n        .map(permission => ({\n          entity: permission.entity,\n          entityType: permission.entityType,\n          accessLevel: permission.accessLevel\n        }));\n      \n      if (!editingRole.id || isNaN(editingRole.id)) {\n        console.warn('DEBUGAUSGABE: Ungltige Rollen-ID erkannt, Bearbeitung abgebrochen');\n        handleError('Ungltige Rollen-ID, Bearbeitung abgebrochen', { \n          component: 'RoleManagementTab',\n          roleId: editingRole.id\n        });\n        return;\n      }\n      \n      // berprfen, ob es sich um eine geschtzte Rolle handelt\n      if (isStandardRole(editingRole.id, editingRole.name)) {\n        console.warn(`DEBUGAUSGABE: Versuch, geschtzte Rolle mit ID ${editingRole.id} zu bearbeiten`);\n        handleError({\n          message: 'Geschtzte Systemrollen knnen nicht bearbeitet werden',\n          name: 'PermissionError'\n        }, {\n          component: 'RoleManagementTab',\n          roleId: editingRole.id,\n          category: ErrorCategory.PERMISSION\n        });\n        setIsModalOpen(false);\n        return;\n      }\n      \n      // berprfen, ob die Rolle noch in der aktuellen Liste existiert\n      const roleExists = roles.some(r => r.id === editingRole.id);\n      if (!roleExists) {\n        console.error(`DEBUGAUSGABE: Rolle mit ID ${editingRole.id} existiert nicht in der aktuellen Liste`);\n        handleError(`Rolle mit ID ${editingRole.id} existiert nicht mehr. Bitte aktualisieren Sie die Seite.`, {\n          component: 'RoleManagementTab',\n          roleId: editingRole.id\n        });\n        setIsModalOpen(false);\n        // Rollen neu laden, um die Anzeige zu aktualisieren\n        await fetchRoles();\n        return;\n      }\n      \n      logger.log(`DEBUGAUSGABE: Bearbeite Rolle mit ID ${editingRole.id}`);\n      \n      try {\n        logger.log('DEBUGAUSGABE: Sende Aktualisierung an API:', {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        });\n        \n        const dataToSend = {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions,\n          allBranches: allBranches,\n          branchIds: allBranches ? [] : selectedBranchIds\n        };\n        \n        logger.log('DEBUGAUSGABE: Vor dem API-Aufruf roleApi.update');\n        const response = await roleApi.update(editingRole.id, dataToSend);\n        logger.log('DEBUGAUSGABE: Nach dem API-Aufruf roleApi.update');\n        logger.log('DEBUGAUSGABE: API-Antwort bei Rollenaktualisierung:', response);\n        await fetchRoles();\n      } catch (updateError) {\n        console.error('DEBUGAUSGABE: Fehler bei Rollenaktualisierung:', updateError);\n        if (updateError.response) {\n          // Spezifischere Fehlerbehandlung\n          if (updateError.response.data.meta && updateError.response.data.meta.cause === \"Record to update not found.\") {\n            handleError('Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.', {\n              component: 'RoleManagementTab',\n              roleId: editingRole.id\n            });\n            setIsModalOpen(false);\n            // Rollenliste aktualisieren, um Frontend zu synchronisieren\n            await fetchRoles();\n          } else {\n            handleError(updateError.response.data.message || 'Fehler beim Aktualisieren der Rolle', {\n              component: 'RoleManagementTab',\n              roleId: editingRole.id\n            });\n          }\n        } else {\n          handleError('Fehler beim Aktualisieren der Rolle', {\n            component: 'RoleManagementTab',\n            roleId: editingRole.id\n          });\n        }\n        return;\n      }\n    } else {\n      // Erstellen einer neuen Rolle\n      try {\n        // Stelle sicher, dass die immer sichtbaren Seiten auch tatschlich auf 'both' gesetzt sind\n        const updatedPermissions = formData.permissions.map(permission => {\n          if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n            return { ...permission, accessLevel: 'both' };\n          }\n          return permission;\n        });\n        \n        // Filtere nur die relevanten Berechtigungen (nicht 'none')\n        const filteredPermissions = updatedPermissions\n          .filter(permission => permission.accessLevel !== 'none')\n          .map(permission => ({\n            entity: permission.entity,\n            entityType: permission.entityType,\n            accessLevel: permission.accessLevel\n          }));\n        \n        logger.log('DEBUGAUSGABE: Sende Daten an API fr neue Rolle:', {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        });\n        \n        const dataToSend = {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions,\n          allBranches: allBranches,\n          branchIds: allBranches ? [] : selectedBranchIds\n        };\n        \n        logger.log('DEBUGAUSGABE: Vor dem API-Aufruf roleApi.create');\n        const response = await roleApi.create(dataToSend);\n        logger.log('DEBUGAUSGABE: Nach dem API-Aufruf roleApi.create');\n        logger.log('DEBUGAUSGABE: API-Antwort beim Erstellen der Rolle:', response);\n        await fetchRoles();\n      } catch (createError) {\n        console.error('DEBUGAUSGABE: Fehler bei API-Anfrage zum Erstellen der Rolle:', createError);\n        if (createError.response) {\n          handleError(createError.response.data.message || 'Fehler beim Erstellen der Rolle', {\n            component: 'RoleManagementTab'\n          });\n        } else {\n          handleError('Fehler beim Erstellen der Rolle', {\n            component: 'RoleManagementTab'\n          });\n        }\n        return;\n      }\n    }\n    \n    if (onRolesChange) onRolesChange();\n    \n    setIsModalOpen(false);\n    resetForm();\n  };\n\n  // Lschen einer Rolle\n  const handleDelete = async (roleId: number) => {\n    if (!roleId || isNaN(roleId)) {\n      console.warn('Ungltige Rollen-ID erkannt, Lschvorgang abgebrochen');\n      handleError('Ungltige Rollen-ID, Lschvorgang abgebrochen', {\n        component: 'RoleManagementTab',\n        roleId: roleId\n      });\n      return;\n    }\n    \n    // Finde die Rolle in der Liste, um den Namen zu prfen\n    const role = roles.find(r => r.id === roleId);\n    \n    // berprfen, ob es sich um eine geschtzte Rolle handelt\n    if (role && isStandardRole(roleId, role.name)) {\n      console.warn(`Versuch, geschtzte Rolle mit ID ${roleId} (${role.name}) zu lschen`);\n      handleError('Geschtzte Systemrollen knnen nicht gelscht werden', {\n        component: 'RoleManagementTab',\n        roleId: roleId\n      });\n      return;\n    }\n    \n    if (!window.confirm('Mchten Sie diese Rolle wirklich lschen?')) return;\n    \n    try {\n      logger.log(`Starte Lschvorgang fr Rolle mit ID ${roleId}`);\n      \n      // berprfen, ob die Rolle in der aktuellen Liste existiert\n      const roleExists = roles.some(r => r.id === roleId);\n      if (!roleExists) {\n        console.error(`Rolle mit ID ${roleId} existiert nicht in der aktuellen Liste`);\n        handleError(`Rolle mit ID ${roleId} existiert nicht mehr. Bitte aktualisieren Sie die Seite.`, {\n          component: 'RoleManagementTab',\n          roleId: roleId\n        });\n        // Rollen neu laden, um die Anzeige zu aktualisieren\n        await fetchRoles();\n        return;\n      }\n      \n      // Bei Mock-Daten lokales Lschen (wird nicht verwendet)\n      if (false) {\n        logger.log('Lsche Mock-Rolle');\n        const updatedRoles = roles.filter(role => role.id !== roleId);\n        setRoles(updatedRoles);\n      } else {\n        logger.log('Sende Lschanfrage an API');\n        \n        try {\n          const response = await roleApi.delete(roleId);\n          logger.log('API-Antwort beim Lschen der Rolle:', response);\n          \n          // Nach erfolgreichem Lschen die Rollenliste aktualisieren\n          await fetchRoles();\n          logger.log('Rollenliste nach Lschen aktualisiert');\n        } catch (deleteError) {\n          console.error('API-Fehler beim Lschen der Rolle:', deleteError);\n          \n          if (deleteError.response) {\n            console.error('API-Fehlerdaten:', deleteError.response.data);\n            \n            // Spezifischere Fehlerbehandlung\n            if (deleteError.response.data.meta && deleteError.response.data.meta.cause === \"Record to delete does not exist.\") {\n              handleError('Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.', {\n                component: 'RoleManagementTab',\n                roleId: roleId\n              });\n              // Rollenliste aktualisieren, um Frontend zu synchronisieren\n              await fetchRoles();\n            } else {\n              handleError(deleteError.response.data.message || t('roleManagement.deleteError'), {\n                component: 'RoleManagementTab',\n                roleId: roleId\n              });\n            }\n          } else {\n            handleError(t('roleManagement.networkError'), {\n              component: 'RoleManagementTab',\n              roleId: roleId\n            });\n          }\n          return;\n        }\n      }\n      \n      logger.log('Rolle erfolgreich gelscht');\n      if (onRolesChange) onRolesChange();\n    } catch (err) {\n      console.error(t('roleManagement.unhandledError'), err);\n      handleError(err);\n      \n      // Bei einem unbehandelten Fehler trotzdem versuchen, die Rollenliste zu aktualisieren\n      try {\n        await fetchRoles();\n      } catch (refreshError) {\n        console.error('Fehler beim Aktualisieren der Rollenliste nach fehlgeschlagenem Lschvorgang:', refreshError);\n      }\n    }\n  };\n\n  // Kopieren einer Rolle (fr Standardrollen)\n  const handleCopyRole = async (role: Role) => {\n    try {\n      if (!role || !role.id) {\n        handleError('Ungltige Rolle zum Kopieren', {\n          component: 'RoleManagementTab'\n        });\n        return;\n      }\n\n      // Kopie der Rolle erstellen mit angepasstem Namen\n      const copiedRoleData = {\n        name: `${role.name}-Kopie`,\n        description: role.description || '',\n        permissions: role.permissions\n          .filter(permission => permission.accessLevel !== 'none')\n          .map(permission => ({\n            entity: permission.entity,\n            entityType: permission.entityType,\n            accessLevel: permission.accessLevel\n          }))\n      };\n\n      logger.log('DEBUGAUSGABE: Kopiere Rolle:', role.name, 'mit Daten:', copiedRoleData);\n\n      // Rolle erstellen\n      const response = await roleApi.create(copiedRoleData);\n      logger.log('DEBUGAUSGABE: Rolle erfolgreich kopiert:', response.data);\n\n      // Optimistisches Update: Neue Rolle zur Liste hinzufgen\n      setRoles(prevRoles => [response.data, ...prevRoles]);\n      \n      // Bearbeitungsmodal fr die kopierte Rolle ffnen\n      prepareRoleForEditing(response.data);\n      \n      if (onRolesChange) onRolesChange();\n    } catch (err) {\n      console.error('DEBUGAUSGABE: Fehler beim Kopieren der Rolle:', err);\n      handleError(err, {\n        component: 'RoleManagementTab',\n        roleId: role.id\n      });\n    }\n  };\n\n  // Rolle zum Bearbeiten vorbereiten\n  const prepareRoleForEditing = async (role: Role) => {\n    // Verhindere das Bearbeiten von geschtzten Rollen\n    if (isStandardRole(role.id, role.name)) {\n      handleError('Geschtzte Systemrollen knnen nicht bearbeitet werden', {\n        component: 'RoleManagementTab',\n        roleId: role.id\n      });\n      return;\n    }\n    \n    // Alle mglichen Berechtigungen erstellen (Seiten, Tabellen und Buttons)\n    const allPermissions = [\n      ...defaultPages.map(page => ({\n        entity: page,\n        entityType: 'page',\n        // Fr die immer sichtbaren Seiten 'both' als Standard setzen\n        accessLevel: alwaysVisiblePages.includes(page) ? 'both' as AccessLevel : 'none' as AccessLevel\n      })),\n      ...defaultTables.map(table => ({\n        entity: table,\n        entityType: 'table',\n        accessLevel: 'none' as AccessLevel\n      })),\n      ...defaultButtons.map(button => ({\n        entity: button,\n        entityType: 'button',\n        accessLevel: 'none' as AccessLevel\n      }))\n    ];\n\n    // Vorhandene Berechtigungen bernehmen\n    role.permissions.forEach(permission => {\n      const existingPermIndex = allPermissions.findIndex(\n        p => p.entity === permission.entity && p.entityType === permission.entityType\n      );\n      \n      if (existingPermIndex !== -1) {\n        // Stelle sicher, dass alwaysVisiblePages immer 'both' als AccessLevel haben\n        if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n          allPermissions[existingPermIndex].accessLevel = 'both';\n        } else {\n          allPermissions[existingPermIndex].accessLevel = permission.accessLevel;\n        }\n      }\n    });\n\n    setFormData({\n      name: role.name,\n      description: role.description || '',\n      permissions: allPermissions\n    });\n    \n    // Lade Branch-Zuweisungen der Rolle\n    if (role.id) {\n      try {\n        const branchResponse = await roleApi.getRoleBranches(role.id);\n        const branchData = branchResponse.data;\n        setAllBranches(branchData.allBranches || false);\n        setSelectedBranchIds(branchData.branches?.map((b: any) => b.id) || []);\n      } catch (error) {\n        console.error('Fehler beim Laden der Branch-Zuweisungen:', error);\n        setAllBranches(true);\n        setSelectedBranchIds([]);\n      }\n    }\n    \n    setEditingRole(role);\n    setIsModalOpen(true);\n  };\n\n  // Formular fr neue Rolle zurcksetzen\n  const resetForm = () => {\n    setEditingRole(null);\n    setAllBranches(true);\n    setSelectedBranchIds([]);\n    setFormData({\n      name: '',\n      description: '',\n      permissions: [\n        // Seiten-Berechtigungen\n        ...defaultPages.map(page => ({\n          entity: page,\n          entityType: 'page',\n          // Fr die immer sichtbaren Seiten 'both' als Standard setzen\n          accessLevel: alwaysVisiblePages.includes(page) ? 'both' as AccessLevel : 'none' as AccessLevel\n        })),\n        // Tabellen-Berechtigungen\n        ...defaultTables.map(table => ({\n          entity: table,\n          entityType: 'table',\n          accessLevel: 'none' as AccessLevel\n        })),\n        // Button-Berechtigungen\n        ...defaultButtons.map(button => ({\n          entity: button,\n          entityType: 'button',\n          accessLevel: 'none' as AccessLevel\n        }))\n      ]\n    });\n  };\n\n  // Setzt alle Seitenberechtigungen (auer die immer sichtbaren) auf den gleichen Wert\n  const setAllPagePermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'page' && !alwaysVisiblePages.includes(p.entity))\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Setzt alle Tabellen-Berechtigungen auf den gleichen Wert\n  const setAllTablePermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'table')\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Setzt alle Button-Berechtigungen auf den gleichen Wert\n  const setAllButtonPermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'button')\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Funktion zum Zhlen der aktiven Filter\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  // Filtern und sortieren der Rollen\n  const filteredAndSortedRoles = useMemo(() => {\n    return roles\n      .filter(role => {\n        // Globale Suche\n        if (searchTerm) {\n          const searchLower = searchTerm.toLowerCase();\n          \n          //  OPTIMIERUNG: Frhes Beenden bei Match\n          if (role.name.toLowerCase().includes(searchLower)) return true;\n          if (role.description && role.description.toLowerCase().includes(searchLower)) return true;\n          \n          return false; // Kein Match gefunden\n        }\n        \n        // Prfe erweiterte Filterbedingungen, wenn vorhanden\n        if (filterConditions.length > 0) {\n          // Implementiere die logische Verknpfung der Bedingungen (UND/ODER)\n          let result = filterConditions.length > 0;\n          \n          for (let i = 0; i < filterConditions.length; i++) {\n            const condition = filterConditions[i];\n            let conditionMet = false;\n            \n            switch (condition.column) {\n              case 'name':\n                //  OPTIMIERUNG: toLowerCase() nur einmal pro Wert\n                const roleNameLower = role.name.toLowerCase();\n                const nameConditionValueLower = (condition.value as string || '').toLowerCase();\n                if (condition.operator === 'equals') {\n                  conditionMet = roleNameLower === nameConditionValueLower;\n                } else if (condition.operator === 'contains') {\n                  conditionMet = roleNameLower.includes(nameConditionValueLower);\n                } else if (condition.operator === 'startsWith') {\n                  conditionMet = roleNameLower.startsWith(nameConditionValueLower);\n                }\n                break;\n\n              case 'description':\n                if (!role.description) {\n                  conditionMet = false;\n                  break;\n                }\n\n                //  OPTIMIERUNG: toLowerCase() nur einmal pro Wert\n                const roleDescLower = role.description.toLowerCase();\n                const descConditionValueLower = (condition.value as string || '').toLowerCase();\n                if (condition.operator === 'equals') {\n                  conditionMet = roleDescLower === descConditionValueLower;\n                } else if (condition.operator === 'contains') {\n                  conditionMet = roleDescLower.includes(descConditionValueLower);\n                } else if (condition.operator === 'startsWith') {\n                  conditionMet = roleDescLower.startsWith(descConditionValueLower);\n                }\n                break;\n              \n              case 'permissions':\n                // Vereinfachter Filter fr Berechtigungen - zhle die Anzahl der Berechtigungen mit dem angegebenen Level\n                const accessLevel = condition.value as AccessLevel;\n                const count = role.permissions.filter(p => p.accessLevel === accessLevel).length;\n                \n                if (condition.operator === 'greaterThan') {\n                  conditionMet = count > 0;\n                } else if (condition.operator === 'equals') {\n                  conditionMet = count > 0;\n                }\n                break;\n            }\n            \n            // Verknpfe das Ergebnis dieser Bedingung mit dem Gesamtergebnis\n            if (i === 0) {\n              result = conditionMet;\n            } else {\n              const operator = filterLogicalOperators[i - 1];\n              result = operator === 'AND' ? (result && conditionMet) : (result || conditionMet);\n            }\n          }\n          \n          if (!result) return false;\n        }\n        \n        return true;\n      })\n      .sort((a, b) => {\n        //  OPTIMIERUNG: toLowerCase() fr konsistente Sortierung\n        return a.name.toLowerCase().localeCompare(b.name.toLowerCase());\n      });\n  }, [roles, searchTerm, filterConditions, filterLogicalOperators]);\n\n  // Mobile Ansicht renderRoles-Funktion\n  const renderRoles = () => {\n    if (roles.length === 0) {\n      return (\n        <div className=\"p-4 bg-gray-50 rounded text-center\">\n          <p>Keine Rollen gefunden. Erstellen Sie eine neue Rolle mit dem Button oben.</p>\n        </div>\n      );\n    }\n    \n    if (isMobile) {\n      // Mobile Ansicht mit Karten\n      return (\n        <>\n          <div className=\"space-y-4\">\n            {filteredAndSortedRoles.slice(0, displayLimit).map((role) => (\n              <RoleCard \n                key={role.id} \n                role={role} \n                onEdit={prepareRoleForEditing}\n                onDelete={handleDelete}\n                onCopy={handleCopyRole}\n                canEdit={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canDelete={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canCopy={!readOnly && hasPermission('roles', 'write', 'table') && isStandardRole(role.id, role.name)}\n              />\n            ))}\n          </div>\n          \n          {/* \"Mehr anzeigen\" Button - Mobil */}\n          {filteredAndSortedRoles.length > displayLimit && (\n            <div className=\"mt-4 flex justify-center\">\n              <div className=\"relative group\">\n                <button\n                  className=\"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                  onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                >\n                  <ChevronDownIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {`Mehr anzeigen (${filteredAndSortedRoles.length - displayLimit} verbleibend)`}\n                </div>\n              </div>\n            </div>\n          )}\n        </>\n      );\n    } else {\n      // Card-Ansicht fr grere Bildschirme\n      return (\n        <>\n          <div className=\"space-y-4\">\n            {filteredAndSortedRoles.slice(0, displayLimit).map((role) => (\n              <RoleCard \n                key={role.id} \n                role={role} \n                onEdit={prepareRoleForEditing}\n                onDelete={handleDelete}\n                onCopy={handleCopyRole}\n                canEdit={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canDelete={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canCopy={!readOnly && hasPermission('roles', 'write', 'table') && isStandardRole(role.id, role.name)}\n              />\n            ))}\n          </div>\n          \n          {/* \"Mehr anzeigen\" Button - Desktop */}\n          {filteredAndSortedRoles.length > displayLimit && (\n            <div className=\"mt-4 flex justify-center\">\n              <div className=\"relative group\">\n                <button\n                  className=\"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                  onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                >\n                  <ChevronDownIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {`Mehr anzeigen (${filteredAndSortedRoles.length - displayLimit} verbleibend)`}\n                </div>\n              </div>\n            </div>\n          )}\n        </>\n      );\n    }\n  };\n\n  // Standard-Filter erstellen und speichern\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(ROLES_TABLE_ID)\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        const alleFilterExists = existingFilters.some(filter => filter.name === 'Alle');\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: ROLES_TABLE_ID,\n            name: 'Alle',\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\n            alleFilter\n          );\n          logger.log('Alle-Filter fr Rollen erstellt');\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []);\n\n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  // Funktion zum Anwenden von Filterbedingungen\n  const applyFilterConditions = useCallback((conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  }, []);\n  \n  // Funktion zum Zurcksetzen der Filter\n  const resetFilterConditions = useCallback(() => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  }, []);\n  \n  // Filter Change Handler (Controlled Mode) - VOR useEffect definiert\n  const handleFilterChange = useCallback(async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  }, [applyFilterConditions]);\n  \n  useEffect(() => {\n    const initialize = async () => {\n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(ROLES_TABLE_ID);\n      \n      // 2. Default-Filter anwenden (IMMER vorhanden!)\n      const defaultFilter = filters.find(f => f.name === 'Alle');\n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        }\n      \n      // 3. Rollen laden (immer, auch mit Default-Filter)\n      await fetchRoles();\n    };\n    \n    initialize();\n  }, [loadFilters, handleFilterChange, fetchRoles]);\n\n  return (\n    <div>\n      {/* Spaltenanzeige und Suche */}\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          {/* Linke Seite: \"Neue Rolle erstellen\"-Button */}\n          <div className=\"flex items-center\">\n            {!readOnly && hasPermission('roles', 'write', 'table') && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsModalOpen(true)}\n                  className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                  style={{ width: '30.19px', height: '30.19px' }}\n                  aria-label={t('roles.createRole')}\n                >\n                  <PlusIcon className=\"h-4 w-4\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('roles.createRole')}\n                </div>\n              </div>\n            )}\n          </div>\n          \n          {/* Mitte: Titel - Kein Titel in der Mitte notwendig bei dieser Komponente, da der Tab-Header bereits den Titel zeigt */}\n          <div></div>\n          \n          {/* Rechte Seite: Suchfeld, Filter-Button, Spalten-Konfiguration */}\n          <div className=\"flex items-center gap-1.5\">\n            <input\n              type=\"text\"\n              placeholder=\"Suchen...\"\n              className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n            <div className=\"relative group ml-1\">\n              <button\n                className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100'}`}\n                onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n              >\n                <FunnelIcon className=\"w-5 h-5\" />\n                {getActiveFilterCount() > 0 && (\n                  <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                    {getActiveFilterCount()}\n                  </span>\n                )}\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                Filter\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Filter-Modal */}\n        {isFilterModalOpen && (\n          <FilterPane\n            columns={[\n              { id: 'name', label: 'Name' },\n              { id: 'description', label: 'Beschreibung' },\n              { id: 'permissions', label: 'Berechtigungen' }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={ROLES_TABLE_ID}\n          />\n        )}\n        \n        {/* Gespeicherte Filter als Tags anzeigen */}\n        <SavedFilterTags\n          tableId={ROLES_TABLE_ID}\n          onSelectFilter={applyFilterConditions}\n          onReset={resetFilterConditions}\n          activeFilterName={activeFilterName}\n          selectedFilterId={selectedFilterId}\n          onFilterChange={handleFilterChange}\n          defaultFilterName=\"Alle\"\n        />\n\n        {loading ? (\n          <div className=\"flex justify-center items-center py-8\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n          </div>\n        ) : (\n          renderRoles()\n        )}\n      </div>\n\n      {/* Modal/Sidepane fr Rollenerstellung/Bearbeitung */}\n      {isModalOpen && (\n        <>\n          {/* Mobile (unter 640px) - Modal */}\n          {isMobile ? (\n            <Dialog open={isModalOpen} onClose={() => setIsModalOpen(false)} className=\"relative z-50\">\n              <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n              \n              <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden\">\n                  {/* Header */}\n                  <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <div className=\"flex items-center justify-between\">\n                      <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                        {editingRole ? t('roles.editRole') : t('roles.createRole')}\n                      </Dialog.Title>\n                      <button\n                        onClick={() => setIsModalOpen(false)}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                      >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                      </button>\n                    </div>\n                  </div>\n                  \n                  {/* Form */}\n                  <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\n                    {/* Content - scrollbarer Bereich */}\n                    <div className=\"flex-1 overflow-y-auto min-h-0\">\n                      <div className=\"p-6 space-y-5\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Name</label>\n                  <input\n                    type=\"text\"\n                    value={formData.name}\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    required\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Beschreibung</label>\n                  <input\n                    type=\"text\"\n                    value={formData.description}\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n                  </div>\n                  \n                  {/* Branch-Zuweisungen */}\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      {t('roles.form.branchAssignment') || 'Branch-Zuweisung'}\n                    </label>\n                    <div className=\"space-y-3\">\n                      <label className=\"flex items-center\">\n                        <input\n                          type=\"checkbox\"\n                          checked={allBranches}\n                          onChange={(e) => {\n                            setAllBranches(e.target.checked);\n                            if (e.target.checked) {\n                              setSelectedBranchIds([]);\n                            }\n                          }}\n                          className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                        />\n                        <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                          {t('roles.form.allBranches') || 'Fr alle Branches gltig'}\n                        </span>\n                      </label>\n                      \n                      {!allBranches && (\n                        <div className=\"ml-6\">\n                          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                            {t('roles.form.specificBranches') || 'Spezifische Branches:'}\n                          </label>\n                          {loadingBranches ? (\n                            <div className=\"text-sm text-gray-500\">Lade Branches...</div>\n                          ) : branches.length === 0 ? (\n                            <div className=\"text-sm text-gray-500\">Keine Branches verfgbar</div>\n                          ) : (\n                            <div className=\"space-y-2 max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2\">\n                              {branches.map((branch) => (\n                                <label key={branch.id} className=\"flex items-center\">\n                                  <input\n                                    type=\"checkbox\"\n                                    checked={selectedBranchIds.includes(branch.id)}\n                                    onChange={(e) => {\n                                      if (e.target.checked) {\n                                        setSelectedBranchIds([...selectedBranchIds, branch.id]);\n                                      } else {\n                                        setSelectedBranchIds(selectedBranchIds.filter(id => id !== branch.id));\n                                      }\n                                    }}\n                                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                                  />\n                                  <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                                    {branch.name}\n                                  </span>\n                                </label>\n                              ))}\n                            </div>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  \n                  <div className=\"mt-2\">\n                    <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.detailedPermissions')}</label>\n                        {/* Bulk Actions - kompakt integriert */}\n                        <div className=\"flex flex-wrap items-center gap-1.5\">\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllPagePermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800\"\n                            >\n                              {t('roles.form.pagesChecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.activateAllPages')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllPagePermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              {t('roles.form.pagesUnchecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.deactivateAllPages')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllTablePermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800\"\n                            >\n                              {t('roles.form.tablesChecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.activateAllTables')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllTablePermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              {t('roles.form.tablesUnchecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.deactivateAllTables')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllButtonPermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800\"\n                            >\n                              {t('roles.form.buttonsChecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.activateAllButtons')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllButtonPermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              {t('roles.form.buttonsUnchecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.deactivateAllButtons')}\n                            </div>\n                          </div>\n                        </div>\n                    </div>\n                    \n                    <div className=\"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600\">\n                    {formData.permissions\n                      .filter(permission => \n                        permission.entityType === 'page'\n                      )\n                      .map((permission, index) => {\n                        const permIndex = formData.permissions.indexOf(permission);\n                        const isActive = permission.accessLevel === 'both';\n                        return (\n                          <div key={`permission-page-${permission.entity}-${index}`}>\n                            <div className=\"flex items-center justify-between\">\n                              <span className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">{pageDisplayNames[permission.entity] || permission.entity}</span>\n                              <label className={`inline-flex items-center ${alwaysVisiblePages.includes(permission.entity) ? 'cursor-not-allowed opacity-80' : 'cursor-pointer'}`}>\n                                <input\n                                  type=\"checkbox\"\n                                  className=\"sr-only peer\"\n                                  checked={isActive}\n                                  disabled={alwaysVisiblePages.includes(permission.entity)}\n                                  onChange={() => {\n                                    const newPermissions = [...formData.permissions];\n                                    newPermissions[permIndex] = {\n                                      ...permission,\n                                      accessLevel: isActive ? 'none' : 'both'\n                                    };\n                                    setFormData({ ...formData, permissions: newPermissions });\n                                  }}\n                                />\n                                <div className={`relative w-11 h-6 ${alwaysVisiblePages.includes(permission.entity) ? 'bg-blue-600 dark:bg-blue-700' : 'bg-gray-200 dark:bg-gray-700'} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700`}>\n                                  {alwaysVisiblePages.includes(permission.entity) && (\n                                    <span className=\"absolute inset-0 flex items-center justify-center text-xs text-white font-medium\">\n                                      Fix\n                                    </span>\n                                  )}\n                                </div>\n                              </label>\n                            </div>\n                            \n                            {/* Tabellen-Berechtigungen mit zugehrigen Buttons gruppiert */}\n                            {formData.permissions\n                              .filter(tablePerm => \n                                tablePerm.entityType === 'table' && \n                                tableToPageMapping[tablePerm.entity] === permission.entity\n                              )\n                              .sort((a, b) => {\n                                const aName = tableDisplayNames[a.entity] || a.entity;\n                                const bName = tableDisplayNames[b.entity] || b.entity;\n                                // Sortierung: users, roles, organization zuerst (in dieser Reihenfolge)\n                                const priorityOrder = ['users', 'roles', 'organization'];\n                                const aIndex = priorityOrder.indexOf(a.entity);\n                                const bIndex = priorityOrder.indexOf(b.entity);\n                                if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                if (aIndex !== -1) return -1;\n                                if (bIndex !== -1) return 1;\n                                return aName.localeCompare(bName);\n                              })\n                              .map((tablePerm, tableIndex) => {\n                                const tablePermIndex = formData.permissions.indexOf(tablePerm);\n                                const isTableActive = tablePerm.accessLevel === 'both';\n                                const tableEntity = tablePerm.entity;\n                                const tableDisplayName = tableDisplayNames[tableEntity] || tableEntity;\n                                \n                                // Finde alle Buttons, die zu dieser Tabelle gehren\n                                // Filtere Duplikate: task_* und todo_* sind dasselbe, nur task_* behalten\n                                const relatedButtons = formData.permissions\n                                  .filter(buttonPerm => \n                                    buttonPerm.entityType === 'button' && \n                                    buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                    buttonToTableMapping[buttonPerm.entity] === tableEntity &&\n                                    // Entferne todo_* Buttons wenn task_* existiert (sind dasselbe)\n                                    !(tableEntity === 'tasks' && buttonPerm.entity.startsWith('todo_'))\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = buttonDisplayNames[a.entity] || a.entity;\n                                    const bName = buttonDisplayNames[b.entity] || b.entity;\n                                    // Logische Reihenfolge: Start, Stop, Erstellen, Bearbeiten, Lschen, dann alphabetisch\n                                    const order = [\n                                      t('roleManagement.buttonOrder.start'),\n                                      t('roleManagement.buttonOrder.stop'),\n                                      t('roleManagement.buttonOrder.create'),\n                                      t('roleManagement.buttonOrder.edit'),\n                                      t('roleManagement.buttonOrder.delete')\n                                    ];\n                                    const aIndex = order.indexOf(aName);\n                                    const bIndex = order.indexOf(bName);\n                                    if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                    if (aIndex !== -1) return -1;\n                                    if (bIndex !== -1) return 1;\n                                    return aName.localeCompare(bName);\n                                  });\n                                \n                                return (\n                                  <div key={`table-permission-${tableEntity}-${tableIndex}`} className=\"mt-3\">\n                                    {/* Tabelle selbst */}\n                                    <div className=\"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600\">\n                                      <span className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\"> {tableDisplayName}</span>\n                                      <label className=\"inline-flex items-center cursor-pointer\">\n                                        <input\n                                          type=\"checkbox\"\n                                          className=\"sr-only peer\"\n                                          checked={isTableActive}\n                                          onChange={() => {\n                                            const newPermissions = [...formData.permissions];\n                                            newPermissions[tablePermIndex] = {\n                                              ...tablePerm,\n                                              accessLevel: isTableActive ? 'none' : 'both'\n                                            };\n                                            setFormData({ ...formData, permissions: newPermissions });\n                                          }}\n                                        />\n                                        <div className=\"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                        </div>\n                                      </label>\n                                    </div>\n                                    \n                                    {/* Zu dieser Tabelle gehrige Buttons */}\n                                    {relatedButtons.map((buttonPerm, buttonIndex) => {\n                                      const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                      const isButtonActive = buttonPerm.accessLevel === 'both';\n                                      const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                      return (\n                                        <div key={`button-permission-${buttonPerm.entity}-${buttonIndex}`} \n                                          className=\"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600\">\n                                          <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                          <label className=\"inline-flex items-center cursor-pointer\">\n                                            <input\n                                              type=\"checkbox\"\n                                              className=\"sr-only peer\"\n                                              checked={isButtonActive}\n                                              onChange={() => {\n                                                const newPermissions = [...formData.permissions];\n                                                newPermissions[buttonPermIndex] = {\n                                                  ...buttonPerm,\n                                                  accessLevel: isButtonActive ? 'none' : 'both'\n                                                };\n                                                setFormData({ ...formData, permissions: newPermissions });\n                                              }}\n                                            />\n                                            <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                            </div>\n                                          </label>\n                                        </div>\n                                      );\n                                    })}\n                                  </div>\n                                );\n                              })\n                            }\n                              \n                              {/* Button-Berechtigungen ohne Tabelle-Zuordnung (am Ende) */}\n                              {formData.permissions\n                                .filter(buttonPerm => \n                                  buttonPerm.entityType === 'button' && \n                                  buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                  !buttonToTableMapping[buttonPerm.entity]\n                                )\n                                .sort((a, b) => {\n                                  const aName = buttonDisplayNames[a.entity] || a.entity;\n                                  const bName = buttonDisplayNames[b.entity] || b.entity;\n                                  return aName.localeCompare(bName);\n                                })\n                                .map((buttonPerm, buttonIndex) => {\n                                  const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                  const isButtonActive = buttonPerm.accessLevel === 'both';\n                                  const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                  return (\n                                    <div key={`button-permission-${buttonPerm.entity}-${buttonIndex}`} \n                                      className=\"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600\">\n                                      <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                      <label className=\"inline-flex items-center cursor-pointer\">\n                                        <input\n                                          type=\"checkbox\"\n                                          className=\"sr-only peer\"\n                                          checked={isButtonActive}\n                                          onChange={() => {\n                                            const newPermissions = [...formData.permissions];\n                                            newPermissions[buttonPermIndex] = {\n                                              ...buttonPerm,\n                                              accessLevel: isButtonActive ? 'none' : 'both'\n                                            };\n                                            setFormData({ ...formData, permissions: newPermissions });\n                                          }}\n                                        />\n                                        <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                        </div>\n                                      </label>\n                          </div>\n                        );\n                      })\n                    }\n                            </div>\n                          );\n                        })\n                      }\n                    </div>\n                  </div>\n                    </div>\n                  </div>\n                  \n                  {/* Footer */}\n                  <div className=\"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-end gap-2 border-t dark:border-gray-600 flex-shrink-0\">\n                    <div className=\"relative group\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setIsModalOpen(false)}\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                      >\n                        <XMarkIcon className=\"h-5 w-5\" />\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        Abbrechen\n                      </div>\n                    </div>\n                    <div className=\"relative group\">\n                      <button\n                        type=\"submit\"\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                      >\n                        <CheckIcon className=\"h-5 w-5\" />\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {editingRole ? 'Aktualisieren' : 'Erstellen'}\n                      </div>\n                    </div>\n                  </div>\n                </form>\n              </Dialog.Panel>\n            </div>\n          </Dialog>\n          ) : (\n            /* Desktop (ab 640px) - Sidepane */\n            /* WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition */\n            <>\n              {/* Backdrop - nur wenn offen und <= 1070px */}\n              {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n              {isModalOpen && !isLargeScreen && (\n                <div \n                  className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                  aria-hidden=\"true\" \n                  style={{\n                    opacity: isModalOpen ? 1 : 0,\n                    transition: 'opacity 300ms ease-out'\n                  }}\n                />\n              )}\n              \n              {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n              <div \n                className={`fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isModalOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                  transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                  pointerEvents: isModalOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isModalOpen}\n                role=\"dialog\"\n                aria-modal={isModalOpen}\n              >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                  <h2 className=\"text-lg font-semibold dark:text-white\">\n                    {editingRole ? 'Rolle bearbeiten' : 'Neue Rolle erstellen'}\n                  </h2>\n                  <button\n                    onClick={() => setIsModalOpen(false)}\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                  <form onSubmit={handleSubmit} className=\"space-y-5\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.name')}</label>\n                        <input\n                          type=\"text\"\n                          value={formData.name}\n                          onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                          className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.description')}</label>\n                        <input\n                          type=\"text\"\n                          value={formData.description}\n                          onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                          className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                        />\n                      </div>\n                    </div>\n                    \n                    <div className=\"mt-2\">\n                      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Detaillierte Berechtigungen</label>\n                        {/* Bulk Actions */}\n                        <div className=\"flex flex-wrap items-center gap-1.5\">\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllPagePermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800\"\n                            >\n                              Seiten \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Seiten aktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllPagePermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              Seiten \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Seiten deaktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllTablePermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800\"\n                            >\n                              Tabellen \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Tabellen aktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllTablePermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              Tabellen \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Tabellen deaktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllButtonPermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800\"\n                            >\n                              Buttons \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Buttons aktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllButtonPermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              Buttons \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Buttons deaktivieren\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                      \n                      <div className=\"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600 max-h-[60vh]\">\n                        {formData.permissions\n                          .filter(permission => \n                            permission.entityType === 'page'\n                          )\n                          .map((permission, index) => {\n                            const permIndex = formData.permissions.indexOf(permission);\n                            const isActive = permission.accessLevel === 'both';\n                            return (\n                              <div key={`permission-page-desktop-${permission.entity}-${index}`}>\n                                <div className=\"flex items-center justify-between\">\n                                  <span className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">{pageDisplayNames[permission.entity] || permission.entity}</span>\n                                  <label className={`inline-flex items-center ${alwaysVisiblePages.includes(permission.entity) ? 'cursor-not-allowed opacity-80' : 'cursor-pointer'}`}>\n                                    <input\n                                      type=\"checkbox\"\n                                      className=\"sr-only peer\"\n                                      checked={isActive}\n                                      disabled={alwaysVisiblePages.includes(permission.entity)}\n                                      onChange={() => {\n                                        const newPermissions = [...formData.permissions];\n                                        newPermissions[permIndex] = {\n                                          ...permission,\n                                          accessLevel: isActive ? 'none' : 'both'\n                                        };\n                                        setFormData({ ...formData, permissions: newPermissions });\n                                      }}\n                                    />\n                                    <div className={`relative w-11 h-6 ${alwaysVisiblePages.includes(permission.entity) ? 'bg-blue-600 dark:bg-blue-700' : 'bg-gray-200 dark:bg-gray-700'} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700`}>\n                                      {alwaysVisiblePages.includes(permission.entity) && (\n                                        <span className=\"absolute inset-0 flex items-center justify-center text-xs text-white font-medium\">\n                                          Fix\n                                        </span>\n                                      )}\n                                    </div>\n                                  </label>\n                                </div>\n                                \n                                {/* Tabellen-Berechtigungen mit zugehrigen Buttons gruppiert */}\n                                {formData.permissions\n                                  .filter(tablePerm => \n                                    tablePerm.entityType === 'table' && \n                                    tableToPageMapping[tablePerm.entity] === permission.entity\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = tableDisplayNames[a.entity] || a.entity;\n                                    const bName = tableDisplayNames[b.entity] || b.entity;\n                                    return aName.localeCompare(bName);\n                                  })\n                                  .map((tablePerm, tableIndex) => {\n                                    const tablePermIndex = formData.permissions.indexOf(tablePerm);\n                                    const isTableActive = tablePerm.accessLevel === 'both';\n                                    const tableEntity = tablePerm.entity;\n                                    const tableDisplayName = tableDisplayNames[tableEntity] || tableEntity;\n                                    \n                                    // Finde alle Buttons, die zu dieser Tabelle gehren\n                                    const relatedButtons = formData.permissions\n                                      .filter(buttonPerm => \n                                        buttonPerm.entityType === 'button' && \n                                        buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                        buttonToTableMapping[buttonPerm.entity] === tableEntity &&\n                                        !(tableEntity === 'tasks' && buttonPerm.entity.startsWith('todo_'))\n                                      )\n                                      .sort((a, b) => {\n                                        const aName = buttonDisplayNames[a.entity] || a.entity;\n                                        const bName = buttonDisplayNames[b.entity] || b.entity;\n                                        const order = [\n                                      t('roleManagement.buttonOrder.start'),\n                                      t('roleManagement.buttonOrder.stop'),\n                                      t('roleManagement.buttonOrder.create'),\n                                      t('roleManagement.buttonOrder.edit'),\n                                      t('roleManagement.buttonOrder.delete')\n                                    ];\n                                        const aIndex = order.indexOf(aName);\n                                        const bIndex = order.indexOf(bName);\n                                        if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                        if (aIndex !== -1) return -1;\n                                        if (bIndex !== -1) return 1;\n                                        return aName.localeCompare(bName);\n                                      });\n                                    \n                                    return (\n                                      <div key={`table-permission-desktop-${tableEntity}-${tableIndex}`} className=\"mt-3\">\n                                        {/* Tabelle selbst */}\n                                        <div className=\"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600\">\n                                          <span className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\"> {tableDisplayName}</span>\n                                          <label className=\"inline-flex items-center cursor-pointer\">\n                                            <input\n                                              type=\"checkbox\"\n                                              className=\"sr-only peer\"\n                                              checked={isTableActive}\n                                              onChange={() => {\n                                                const newPermissions = [...formData.permissions];\n                                                newPermissions[tablePermIndex] = {\n                                                  ...tablePerm,\n                                                  accessLevel: isTableActive ? 'none' : 'both'\n                                                };\n                                                setFormData({ ...formData, permissions: newPermissions });\n                                              }}\n                                            />\n                                            <div className=\"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                            </div>\n                                          </label>\n                                        </div>\n                                        \n                                        {/* Zu dieser Tabelle gehrige Buttons */}\n                                        {relatedButtons.map((buttonPerm, buttonIndex) => {\n                                          const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                          const isButtonActive = buttonPerm.accessLevel === 'both';\n                                          const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                          return (\n                                            <div key={`button-permission-desktop-${buttonPerm.entity}-${buttonIndex}`} \n                                              className=\"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600\">\n                                              <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                              <label className=\"inline-flex items-center cursor-pointer\">\n                                                <input\n                                                  type=\"checkbox\"\n                                                  className=\"sr-only peer\"\n                                                  checked={isButtonActive}\n                                                  onChange={() => {\n                                                    const newPermissions = [...formData.permissions];\n                                                    newPermissions[buttonPermIndex] = {\n                                                      ...buttonPerm,\n                                                      accessLevel: isButtonActive ? 'none' : 'both'\n                                                    };\n                                                    setFormData({ ...formData, permissions: newPermissions });\n                                                  }}\n                                                />\n                                                <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                                </div>\n                                              </label>\n                                            </div>\n                                          );\n                                        })}\n                                      </div>\n                                    );\n                                  })\n                                }\n                                  \n                                {/* Button-Berechtigungen ohne Tabelle-Zuordnung (am Ende) */}\n                                {formData.permissions\n                                  .filter(buttonPerm => \n                                    buttonPerm.entityType === 'button' && \n                                    buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                    !buttonToTableMapping[buttonPerm.entity]\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = buttonDisplayNames[a.entity] || a.entity;\n                                    const bName = buttonDisplayNames[b.entity] || b.entity;\n                                    return aName.localeCompare(bName);\n                                  })\n                                  .map((buttonPerm, buttonIndex) => {\n                                    const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                    const isButtonActive = buttonPerm.accessLevel === 'both';\n                                    const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                    return (\n                                      <div key={`button-permission-desktop-${buttonPerm.entity}-${buttonIndex}`} \n                                        className=\"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600\">\n                                        <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                        <label className=\"inline-flex items-center cursor-pointer\">\n                                          <input\n                                            type=\"checkbox\"\n                                            className=\"sr-only peer\"\n                                            checked={isButtonActive}\n                                            onChange={() => {\n                                              const newPermissions = [...formData.permissions];\n                                              newPermissions[buttonPermIndex] = {\n                                                ...buttonPerm,\n                                                accessLevel: isButtonActive ? 'none' : 'both'\n                                              };\n                                              setFormData({ ...formData, permissions: newPermissions });\n                                            }}\n                                          />\n                                          <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                          </div>\n                                        </label>\n                                      </div>\n                                    );\n                                  })\n                                }\n                              </div>\n                            );\n                          })\n                        }\n                      </div>\n                    </div>\n\n                    {/* Buttons */}\n                    <div className=\"flex justify-end pt-4 gap-2\">\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          onClick={() => setIsModalOpen(false)}\n                          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                        >\n                          <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          Abbrechen\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          type=\"submit\"\n                          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                        >\n                          <CheckIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {editingRole ? 'Aktualisieren' : 'Erstellen'}\n                        </div>\n                      </div>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default RoleManagementTab; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PencilIcon, CheckIcon, XMarkIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\n\ninterface RoomDescription {\n  text?: string;\n  imageUrl?: string;\n  videoUrl?: string;\n}\n\ninterface RoomDescriptionsSectionProps {\n  branchId: number;\n}\n\nconst RoomDescriptionsSection: React.FC<RoomDescriptionsSectionProps> = ({ branchId }) => {\n  const { t } = useTranslation();\n  const [roomDescriptions, setRoomDescriptions] = useState<Record<number, RoomDescription>>({});\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [editingCategoryId, setEditingCategoryId] = useState<number | null>(null);\n  const [editForm, setEditForm] = useState<RoomDescription>({ text: '', imageUrl: '', videoUrl: '' });\n  const [rooms, setRooms] = useState<Array<{ categoryId: number; roomName: string; roomType: 'compartida' | 'privada' }>>([]);\n  const [loadingRooms, setLoadingRooms] = useState(false);\n\n  // Lade Zimmer-Beschreibungen\n  const loadRoomDescriptions = async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.ROOM_DESCRIPTIONS(branchId));\n      setRoomDescriptions(response.data || {});\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Zimmer-Beschreibungen:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Lade Zimmer-Liste aus Reservierungen\n  const loadRooms = async () => {\n    try {\n      setLoadingRooms(true);\n      // Lade Reservierungen mit categoryId\n      const response = await axiosInstance.get(API_ENDPOINTS.RESERVATION.BASE, {\n        params: {\n          branchId: branchId,\n          limit: 1000 // Lade viele Reservierungen, um alle Zimmer zu finden\n        }\n      });\n      \n      // Extrahiere eindeutige categoryIds\n      const categoryMap = new Map<number, { roomName: string; roomType: 'compartida' | 'privada' }>();\n      \n      // Backend gibt data.data zurck (nicht data.reservations)\n      const reservations = response.data.data || [];\n      \n      reservations.forEach((reservation: any) => {\n        if (reservation.categoryId && reservation.roomNumber) {\n          // Bestimme roomType basierend auf roomNumber (Dorms enthalten \"(\")\n          const isDorm = reservation.roomNumber.includes('(');\n          const roomType = isDorm ? 'compartida' : 'privada';\n          \n          // Extrahiere Zimmername (fr Dorms: vor \"(\")\n          const roomName = isDorm \n            ? reservation.roomNumber.split('(')[0].trim()\n            : reservation.roomNumber;\n          \n          if (!categoryMap.has(reservation.categoryId)) {\n            categoryMap.set(reservation.categoryId, { roomName, roomType });\n          }\n        }\n      });\n      \n      // Konvertiere Map zu Array\n      const roomsArray = Array.from(categoryMap.entries()).map(([categoryId, data]) => ({\n        categoryId,\n        ...data\n      }));\n      \n      setRooms(roomsArray.sort((a, b) => a.roomName.localeCompare(b.roomName)));\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Zimmer:', error);\n    } finally {\n      setLoadingRooms(false);\n    }\n  };\n\n  useEffect(() => {\n    if (branchId) {\n      loadRoomDescriptions();\n      loadRooms();\n    }\n  }, [branchId]);\n\n  // Starte Bearbeitung\n  const handleEdit = (categoryId: number) => {\n    const description = roomDescriptions[categoryId] || { text: '', imageUrl: '', videoUrl: '' };\n    setEditForm(description);\n    setEditingCategoryId(categoryId);\n  };\n\n  // Speichere Beschreibung\n  const handleSave = async () => {\n    if (editingCategoryId === null) return;\n    \n    try {\n      setSaving(true);\n      const updatedDescriptions = {\n        ...roomDescriptions,\n        [editingCategoryId]: editForm\n      };\n      \n      await axiosInstance.put(\n        API_ENDPOINTS.BRANCHES.ROOM_DESCRIPTIONS(branchId),\n        { roomDescriptions: updatedDescriptions }\n      );\n      \n      // Lade Daten neu vom Backend, um sicherzustellen, dass sie korrekt gespeichert wurden\n      await loadRoomDescriptions();\n      \n      setEditingCategoryId(null);\n      setEditForm({ text: '', imageUrl: '', videoUrl: '' });\n    } catch (error: any) {\n      console.error('Fehler beim Speichern der Zimmer-Beschreibung:', error);\n      alert(t('branches.roomDescriptions.saveError', { defaultValue: 'Fehler beim Speichern der Beschreibung' }));\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  // Abbrechen\n  const handleCancel = () => {\n    setEditingCategoryId(null);\n    setEditForm({ text: '', imageUrl: '', videoUrl: '' });\n  };\n\n  if (loading || loadingRooms) {\n    return (\n      <div className=\"mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n          {t('common.loading', { defaultValue: 'Lade...' })}\n        </p>\n      </div>\n    );\n  }\n\n  if (rooms.length === 0) {\n    return (\n      <div className=\"mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n          {t('branches.roomDescriptions.noRooms', { \n            defaultValue: 'Keine Zimmer gefunden. Importieren Sie zuerst Reservierungen aus LobbyPMS.' \n          })}\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"mt-6 border-t border-gray-200 dark:border-gray-700 pt-6\">\n      <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n        {t('branches.roomDescriptions.title', { defaultValue: 'Zimmer-Beschreibungen' })}\n      </h5>\n      <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-4\">\n        {t('branches.roomDescriptions.description', { \n          defaultValue: 'Beschreibungen, wie man zu den Zimmern kommt. Diese werden in den Check-in-Nachrichten verwendet.' \n        })}\n      </p>\n      \n      <div className=\"space-y-4\">\n        {rooms.map((room) => {\n          const isEditing = editingCategoryId === room.categoryId;\n          const description = roomDescriptions[room.categoryId] || null;\n          \n          return (\n            <div\n              key={room.categoryId}\n              className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-white dark:bg-gray-800\"\n            >\n              <div className=\"flex items-start justify-between mb-2\">\n                <div>\n                  <h6 className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                    {room.roomName}\n                  </h6>\n                  <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                    {room.roomType === 'compartida' \n                      ? t('branches.roomDescriptions.dorm', { defaultValue: 'Dorm' })\n                      : t('branches.roomDescriptions.private', { defaultValue: 'Privatzimmer' })}\n                    {'  '}\n                    {t('branches.roomDescriptions.categoryId', { defaultValue: 'Category ID' })}: {room.categoryId}\n                  </span>\n                </div>\n                {!isEditing && (\n                  <button\n                    onClick={() => handleEdit(room.categoryId)}\n                    className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                    title={t('common.edit', { defaultValue: 'Bearbeiten' })}\n                  >\n                    <PencilIcon className=\"h-4 w-4\" />\n                  </button>\n                )}\n              </div>\n              \n              {isEditing ? (\n                <div className=\"space-y-3 mt-3\">\n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('branches.roomDescriptions.text', { defaultValue: 'Text' })}\n                    </label>\n                    <textarea\n                      value={editForm.text || ''}\n                      onChange={(e) => setEditForm({ ...editForm, text: e.target.value })}\n                      rows={3}\n                      placeholder={t('branches.roomDescriptions.textPlaceholder', { \n                        defaultValue: 'Beschreibung, wie man zum Zimmer kommt...' \n                      })}\n                      className=\"w-full text-sm rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white px-3 py-2\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('branches.roomDescriptions.imageUrl', { defaultValue: 'Bild-URL' })}\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={editForm.imageUrl || ''}\n                      onChange={(e) => setEditForm({ ...editForm, imageUrl: e.target.value })}\n                      placeholder=\"https://example.com/image.jpg\"\n                      className=\"w-full text-sm rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white px-3 py-2\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('branches.roomDescriptions.videoUrl', { defaultValue: 'Video-URL' })}\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={editForm.videoUrl || ''}\n                      onChange={(e) => setEditForm({ ...editForm, videoUrl: e.target.value })}\n                      placeholder=\"https://example.com/video.mp4\"\n                      className=\"w-full text-sm rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white px-3 py-2\"\n                    />\n                  </div>\n                  \n                  <div className=\"flex justify-end space-x-2\">\n                    <button\n                      onClick={handleCancel}\n                      disabled={saving}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50\"\n                      title={t('common.cancel', { defaultValue: 'Abbrechen' })}\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      onClick={handleSave}\n                      disabled={saving}\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 dark:bg-blue-500 dark:hover:bg-blue-600\"\n                      title={saving ? t('common.saving', { defaultValue: 'Speichere...' }) : t('common.save', { defaultValue: 'Speichern' })}\n                    >\n                      <CheckIcon className=\"h-5 w-5\" />\n                    </button>\n                  </div>\n                </div>\n              ) : (\n                <div className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\n                  {description ? (\n                    <div className=\"space-y-1\">\n                      {description.text && (\n                        <p>{description.text}</p>\n                      )}\n                      {description.imageUrl && (\n                        <p>\n                          <span className=\"font-medium\">{t('branches.roomDescriptions.image', { defaultValue: 'Bild' })}:</span>{' '}\n                          <a href={description.imageUrl} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 dark:text-blue-400 hover:underline\">\n                            {description.imageUrl}\n                          </a>\n                        </p>\n                      )}\n                      {description.videoUrl && (\n                        <p>\n                          <span className=\"font-medium\">{t('branches.roomDescriptions.video', { defaultValue: 'Video' })}:</span>{' '}\n                          <a href={description.videoUrl} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 dark:text-blue-400 hover:underline\">\n                            {description.videoUrl}\n                          </a>\n                        </p>\n                      )}\n                    </div>\n                  ) : (\n                    <p className=\"text-gray-400 dark:text-gray-500 italic\">\n                      {t('branches.roomDescriptions.noDescription', { defaultValue: 'Keine Beschreibung vorhanden' })}\n                    </p>\n                  )}\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default RoomDescriptionsSection;\n\n","import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { PencilIcon, TrashIcon, PlusIcon, XMarkIcon, CheckIcon, FunnelIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { useFilterContext } from '../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport RoomDescriptionsSection from './branches/RoomDescriptionsSection.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { logger } from '../utils/logger.ts';\n\ninterface Branch {\n    id: number;\n    name: string;\n    whatsappSettings?: any;\n    lobbyPmsSettings?: any;\n    boldPaymentSettings?: any;\n    doorSystemSettings?: any;\n    emailSettings?: any;\n}\n\ninterface BranchManagementTabProps {\n}\n\n// BranchCard-Komponente fr mobile und Desktop-Ansicht\nconst BranchCard: React.FC<{\n    branch: Branch;\n    onEdit: (branch: Branch) => void;\n    onDelete: (branchId: number) => void;\n    canEdit: boolean;\n    canDelete: boolean;\n}> = ({ branch, onEdit, onDelete, canEdit, canDelete }) => {\n    const { t } = useTranslation();\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4\">\n            {/* Header mit Branchname und Aktionen */}\n            <div className=\"flex justify-between items-start mb-2\">\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{branch.name}</h3>\n                \n                <div className=\"flex space-x-2\">\n                    {canEdit && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onEdit(branch)}\n                                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                            >\n                                <PencilIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.edit', { defaultValue: 'Bearbeiten' })}\n                            </div>\n                        </div>\n                    )}\n                    \n                    {canDelete && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onDelete(branch.id)}\n                                className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n                            >\n                                <TrashIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.delete', { defaultValue: 'Lschen' })}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\n// TableID fr gespeicherte Filter\nconst BRANCHES_TABLE_ID = 'branches-table';\n\nconst BranchManagementTab: React.FC<BranchManagementTabProps> = () => {\n    const { t } = useTranslation();\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [editingBranch, setEditingBranch] = useState<Branch | null>(null);\n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [formData, setFormData] = useState({ \n        name: '',\n        address: '',\n        city: '',\n        country: '',\n        whatsappSettings: {\n            provider: 'whatsapp-business-api' as 'twilio' | 'whatsapp-business-api',\n            apiKey: '',\n            apiSecret: '',\n            phoneNumberId: '',\n            ai: {\n                enabled: false,\n                model: 'gpt-4o',\n                systemPrompt: '',\n                rules: [] as string[],\n                sources: [] as string[],\n                temperature: 0.7,\n                maxTokens: 500\n            }\n        },\n        lobbyPmsSettings: {\n            apiUrl: '',\n            apiKey: '',\n            propertyId: '',\n            syncEnabled: true,\n            autoCreateTasks: false,\n            lateCheckInThreshold: '22:00',\n            notificationChannels: ['email'] as string[],\n            autoSendInvitation: false\n        },\n        boldPaymentSettings: {\n            apiKey: '',\n            merchantId: '',\n            environment: 'sandbox' as 'sandbox' | 'production'\n        },\n        doorSystemSettings: {\n            clientId: '',\n            clientSecret: '',\n            username: '',\n            password: '',\n            apiUrl: 'https://euopen.ttlock.com',\n            lockIds: [] as string[],\n            appName: 'TTLock'\n        },\n        emailSettings: {\n            smtpHost: '',\n            smtpPort: 587,\n            smtpUser: '',\n            smtpPass: '',\n            smtpFromEmail: '',\n            smtpFromName: '',\n            imap: {\n                enabled: false,\n                host: '',\n                port: 993,\n                secure: true,\n                user: '',\n                password: '',\n                folder: 'INBOX',\n                processedFolder: ''\n            }\n        },\n        messageTemplates: {\n            checkInInvitation: {\n                en: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                es: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                de: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                }\n            },\n            checkInConfirmation: {\n                en: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                es: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                de: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                }\n            }\n        },\n        autoSendReservationInvitation: false\n    });\n    const [activeSettingsTab, setActiveSettingsTab] = useState<'whatsapp' | 'lobbypms' | 'boldpayment' | 'doorsystem' | 'email' | 'messages'>('whatsapp');\n    const [showSecrets, setShowSecrets] = useState<Record<string, boolean>>({});\n    const [selectedTemplateType, setSelectedTemplateType] = useState<'checkInInvitation' | 'checkInConfirmation'>('checkInInvitation');\n    const [selectedLanguage, setSelectedLanguage] = useState<'en' | 'es' | 'de'>('en');\n    const [searchTerm, setSearchTerm] = useState('');\n    const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n    const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n    const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [activeFilterName, setActiveFilterName] = useState<string>('');\n    const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n    const [displayLimit, setDisplayLimit] = useState(10);\n    const { hasPermission } = usePermissions();\n    const { openSidepane, closeSidepane } = useSidepane();\n    const { handleError: handleErrorContext } = useError();\n\n    // Berechtigungen prfen\n    const canCreate = hasPermission('branches', 'write', 'table');\n    const canEdit = hasPermission('branches', 'write', 'table');\n    const canDelete = hasPermission('branches', 'write', 'table');\n\n    // Branches laden\n    const fetchBranches = useCallback(async () => {\n        setLoading(true);\n        try {\n            const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n            setBranches(response.data);\n        } catch (error: any) {\n            console.error('Fehler beim Laden der Niederlassungen:', error);\n            handleErrorContext(error);\n        } finally {\n            setLoading(false);\n        }\n    }, [handleErrorContext]);\n\n    useEffect(() => {\n        fetchBranches();\n    }, [fetchBranches]);\n\n    // Sidepane ffnen/schlieen basierend auf Modal-Status\n    useEffect(() => {\n        if (isModalOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isModalOpen, openSidepane, closeSidepane]);\n\n    // Formular zurcksetzen\n    const resetForm = () => {\n        setFormData({ \n            name: '',\n            address: '',\n            city: '',\n            country: '',\n            whatsappSettings: {\n                provider: 'whatsapp-business-api' as 'twilio' | 'whatsapp-business-api',\n                apiKey: '',\n                apiSecret: '',\n                phoneNumberId: '',\n                ai: {\n                    enabled: false,\n                    model: 'gpt-4o',\n                    systemPrompt: '',\n                    rules: [] as string[],\n                    sources: [] as string[],\n                    temperature: 0.7,\n                    maxTokens: 500\n                }\n            },\n            lobbyPmsSettings: {\n                apiUrl: '',\n                apiKey: '',\n                propertyId: '',\n                syncEnabled: true,\n                autoCreateTasks: false,\n                lateCheckInThreshold: '22:00',\n                notificationChannels: ['email'] as string[],\n                autoSendInvitation: false\n            },\n            boldPaymentSettings: {\n                apiKey: '',\n                merchantId: '',\n                environment: 'sandbox' as 'sandbox' | 'production'\n            },\n            doorSystemSettings: {\n                clientId: '',\n                clientSecret: '',\n                username: '',\n                password: '',\n                apiUrl: 'https://euopen.ttlock.com',\n                lockIds: [] as string[],\n                appName: 'TTLock'\n            },\n            sireSettings: {\n                enabled: false,\n                autoRegisterOnCheckIn: false,\n                apiUrl: '',\n                apiKey: '',\n                apiSecret: '',\n                propertyCode: ''\n            },\n            emailSettings: {\n                smtpHost: '',\n                smtpPort: 587,\n                smtpUser: '',\n                smtpPass: '',\n                smtpFromEmail: '',\n                smtpFromName: '',\n                imap: {\n                    enabled: false,\n                    host: '',\n                    port: 993,\n                    secure: true,\n                    user: '',\n                    password: '',\n                    folder: 'INBOX',\n                    processedFolder: ''\n                }\n            },\n            messageTemplates: {\n                checkInInvitation: {\n                    en: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    es: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    de: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    }\n                },\n                checkInConfirmation: {\n                    en: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    es: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    de: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    }\n                }\n            },\n            autoSendReservationInvitation: false\n        });\n        setActiveSettingsTab('whatsapp');\n        setEditingBranch(null);\n    };\n\n    // Modal ffnen fr neue Branch\n    const handleCreate = () => {\n        resetForm();\n        setIsModalOpen(true);\n    };\n\n    // Modal ffnen fr Bearbeitung\n    const handleEdit = async (branch: Branch) => {\n        setEditingBranch(branch);\n        const existingWhatsapp = branch.whatsappSettings || {};\n        const existingLobbyPms = branch.lobbyPmsSettings || {};\n        // Bold Payment Settings: Prfe ob es ein String ist (JSON) oder bereits ein Objekt\n        let existingBoldPayment: any = branch.boldPaymentSettings;\n        if (!existingBoldPayment) {\n            existingBoldPayment = {};\n        } else if (typeof existingBoldPayment === 'string') {\n            try {\n                existingBoldPayment = JSON.parse(existingBoldPayment);\n            } catch (e) {\n                console.error('Fehler beim Parsen von boldPaymentSettings:', e);\n                existingBoldPayment = {};\n            }\n        }\n        // Stelle sicher, dass verschlsselte Werte (mit ':') auch angezeigt werden\n        // Wenn Entschlsselung fehlgeschlagen ist, bleiben die verschlsselten Strings erhalten\n        const existingDoorSystem = branch.doorSystemSettings || {};\n        const existingEmail = branch.emailSettings || {};\n        const existingMessageTemplates = (branch as any).messageTemplates || {};\n        const existingAutoSend = (branch as any).autoSendReservationInvitation || false;\n        \n        setFormData({ \n            name: branch.name,\n            address: (branch as any).address || '',\n            city: (branch as any).city || '',\n            country: (branch as any).country || '',\n            whatsappSettings: {\n                provider: existingWhatsapp.provider || 'whatsapp-business-api',\n                apiKey: existingWhatsapp.apiKey || '',\n                apiSecret: existingWhatsapp.apiSecret || '',\n                phoneNumberId: existingWhatsapp.phoneNumberId || '',\n                ai: existingWhatsapp.ai || {\n                    enabled: false,\n                    model: 'gpt-4o',\n                    systemPrompt: '',\n                    rules: [],\n                    sources: [],\n                    temperature: 0.7,\n                    maxTokens: 500\n                }\n            },\n            lobbyPmsSettings: {\n                apiUrl: existingLobbyPms.apiUrl || '',\n                apiKey: existingLobbyPms.apiKey || '',\n                propertyId: existingLobbyPms.propertyId || '',\n                syncEnabled: existingLobbyPms.syncEnabled !== undefined ? existingLobbyPms.syncEnabled : true,\n                autoCreateTasks: existingLobbyPms.autoCreateTasks || false,\n                lateCheckInThreshold: existingLobbyPms.lateCheckInThreshold || '22:00',\n                notificationChannels: existingLobbyPms.notificationChannels || ['email'],\n                autoSendInvitation: existingLobbyPms.autoSendInvitation || false\n            },\n            boldPaymentSettings: {\n                // Wenn Entschlsselung fehlgeschlagen ist, sind die Werte verschlsselt (Format: \"iv:authTag:encrypted\")\n                // Diese sollten NICHT im Frontend angezeigt werden (Sicherheit)\n                // ABER: Wir speichern einen Flag, dass verschlsselte Werte vorhanden sind\n                // Die verschlsselten Werte bleiben in der DB, damit Payment-Links weiter funktionieren\n                apiKey: (existingBoldPayment.apiKey && !existingBoldPayment.apiKey.includes(':')) \n                    ? existingBoldPayment.apiKey \n                    : '',\n                merchantId: (existingBoldPayment.merchantId && !existingBoldPayment.merchantId.includes(':')) \n                    ? existingBoldPayment.merchantId \n                    : '',\n                environment: existingBoldPayment.environment || 'sandbox',\n                // Flag: Gibt an, ob verschlsselte Werte vorhanden sind (aber nicht entschlsselbar)\n                _hasEncryptedValues: (existingBoldPayment.apiKey && existingBoldPayment.apiKey.includes(':')) ||\n                                     (existingBoldPayment.merchantId && existingBoldPayment.merchantId.includes(':'))\n            },\n            doorSystemSettings: {\n                clientId: existingDoorSystem.clientId || '',\n                clientSecret: existingDoorSystem.clientSecret || '',\n                username: existingDoorSystem.username || '',\n                password: existingDoorSystem.password || '',\n                apiUrl: existingDoorSystem.apiUrl || 'https://euopen.ttlock.com',\n                lockIds: existingDoorSystem.lockIds || [],\n                appName: existingDoorSystem.appName || 'TTLock'\n            },\n            emailSettings: {\n                smtpHost: existingEmail.smtpHost || '',\n                smtpPort: existingEmail.smtpPort || 587,\n                smtpUser: existingEmail.smtpUser || '',\n                smtpPass: existingEmail.smtpPass || '',\n                smtpFromEmail: existingEmail.smtpFromEmail || '',\n                smtpFromName: existingEmail.smtpFromName || '',\n                imap: existingEmail.imap || {\n                    enabled: false,\n                    host: '',\n                    port: 993,\n                    secure: true,\n                    user: '',\n                    password: '',\n                    folder: 'INBOX',\n                    processedFolder: ''\n                }\n            },\n            messageTemplates: existingMessageTemplates || {\n                checkInInvitation: {\n                    en: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    es: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    de: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' }\n                },\n                checkInConfirmation: {\n                    en: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    es: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    de: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' }\n                }\n            },\n            autoSendReservationInvitation: existingAutoSend\n        });\n        setIsModalOpen(true);\n    };\n\n    // Modal schlieen\n    const handleCloseModal = () => {\n        setIsModalOpen(false);\n        resetForm();\n    };\n\n    // Formular absenden\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        \n        if (!formData.name.trim()) {\n            handleErrorContext({ message: t('branches.nameRequired') });\n            return;\n        }\n\n        try {\n            if (editingBranch) {\n                // Branch aktualisieren\n                await axiosInstance.put(API_ENDPOINTS.BRANCHES.UPDATE(editingBranch.id), {\n                    name: formData.name.trim(),\n                    address: formData.address.trim() || null,\n                    city: formData.city.trim() || null,\n                    country: formData.country.trim() || null,\n                    whatsappSettings: formData.whatsappSettings,\n                    lobbyPmsSettings: formData.lobbyPmsSettings,\n                    boldPaymentSettings: {\n                        apiKey: formData.boldPaymentSettings.apiKey,\n                        merchantId: formData.boldPaymentSettings.merchantId,\n                        environment: formData.boldPaymentSettings.environment\n                    },\n                    doorSystemSettings: formData.doorSystemSettings,\n                    emailSettings: formData.emailSettings,\n                    messageTemplates: formData.messageTemplates,\n                    autoSendReservationInvitation: formData.autoSendReservationInvitation\n                });\n            } else {\n                // Neue Branch erstellen\n                await axiosInstance.post(API_ENDPOINTS.BRANCHES.CREATE, {\n                    name: formData.name.trim()\n                });\n            }\n            \n            await fetchBranches();\n            handleCloseModal();\n        } catch (error: any) {\n            console.error('Fehler beim Speichern der Niederlassung:', error);\n            handleErrorContext(error);\n        }\n    };\n\n    // Branch lschen\n    const handleDelete = async (branchId: number) => {\n        if (!window.confirm(t('branches.deleteConfirm', { defaultValue: 'Mchten Sie diese Niederlassung wirklich lschen?' }))) {\n            return;\n        }\n\n        try {\n            await axiosInstance.delete(API_ENDPOINTS.BRANCHES.DELETE(branchId));\n            await fetchBranches();\n        } catch (error: any) {\n            console.error('Fehler beim Lschen der Niederlassung:', error);\n            handleErrorContext(error);\n        }\n    };\n\n    // Funktion zum Zhlen der aktiven Filter\n    const getActiveFilterCount = () => {\n        return filterConditions.length;\n    };\n\n    // Filtern und sortieren der Branches\n    const filteredAndSortedBranches = useMemo(() => {\n        return branches\n            .filter(branch => {\n                // Globale Suche\n                if (searchTerm) {\n                    const searchLower = searchTerm.toLowerCase();\n                    const matchesSearch = branch.name.toLowerCase().includes(searchLower);\n                    \n                    if (!matchesSearch) return false;\n                }\n                \n                // Prfe erweiterte Filterbedingungen, wenn vorhanden\n                if (filterConditions.length > 0) {\n                    let result = filterConditions.length > 0;\n                    \n                    for (let i = 0; i < filterConditions.length; i++) {\n                        const condition = filterConditions[i];\n                        let conditionMet = false;\n                        \n                        switch (condition.column) {\n                            case 'name':\n                                //  OPTIMIERUNG: toLowerCase() nur einmal pro Wert\n                                const branchNameLower = branch.name.toLowerCase();\n                                const conditionValueLower = (condition.value as string || '').toLowerCase();\n                                if (condition.operator === 'equals') {\n                                    conditionMet = branchNameLower === conditionValueLower;\n                                } else if (condition.operator === 'contains') {\n                                    conditionMet = branchNameLower.includes(conditionValueLower);\n                                } else if (condition.operator === 'startsWith') {\n                                    conditionMet = branchNameLower.startsWith(conditionValueLower);\n                                }\n                                break;\n                        }\n                        \n                        // Verknpfe das Ergebnis dieser Bedingung mit dem Gesamtergebnis\n                        if (i === 0) {\n                            result = conditionMet;\n                        } else {\n                            const operator = filterLogicalOperators[i - 1];\n                            result = operator === 'AND' ? (result && conditionMet) : (result || conditionMet);\n                        }\n                    }\n                    \n                    if (!result) return false;\n                }\n                \n                return true;\n            })\n            .sort((a, b) => {\n                //  OPTIMIERUNG: toLowerCase() fr konsistente Sortierung\n                return a.name.toLowerCase().localeCompare(b.name.toLowerCase());\n            });\n    }, [branches, searchTerm, filterConditions, filterLogicalOperators]);\n\n    // Funktion zum Anwenden von Filterbedingungen\n    const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setFilterConditions(conditions);\n        setFilterLogicalOperators(operators);\n    };\n    \n    // Funktion zum Zurcksetzen der Filter\n    const resetFilterConditions = () => {\n        setFilterConditions([]);\n        setFilterLogicalOperators([]);\n        setActiveFilterName('');\n        setSelectedFilterId(null);\n    };\n    \n    // Filter Change Handler (Controlled Mode)\n    const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setActiveFilterName(name);\n        setSelectedFilterId(id);\n        applyFilterConditions(conditions, operators);\n    };\n    \n    //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n    const filterContext = useFilterContext();\n    const { loadFilters } = filterContext;\n    \n    useEffect(() => {\n        const initialize = async () => {\n            // 1. Filter laden (wartet auf State-Update)\n            const filters = await loadFilters(BRANCHES_TABLE_ID);\n            \n            // 2. Default-Filter anwenden (IMMER vorhanden!)\n            const defaultFilter = filters.find(f => f.name === 'Alle');\n            if (defaultFilter) {\n                await handleFilterChange(\n                    defaultFilter.name,\n                    defaultFilter.id,\n                    defaultFilter.conditions,\n                    defaultFilter.operators\n                );\n                return; // Filter wird angewendet\n            }\n            \n            // 3. Fallback: Kein Filter (sollte nie passieren)\n            // BranchManagementTab filtert client-seitig, daher keine Daten-Lade-Funktion ntig\n        };\n        \n        initialize();\n    }, [loadFilters, handleFilterChange]);\n\n    // Standard-Filter erstellen und speichern\n    useEffect(() => {\n        const createStandardFilters = async () => {\n            try {\n                const token = localStorage.getItem('token');\n                \n                if (!token) {\n                    console.error(t('common.notAuthenticated'));\n                    return;\n                }\n\n                // Prfen, ob die Standard-Filter bereits existieren\n                const existingFiltersResponse = await axiosInstance.get(\n                    API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(BRANCHES_TABLE_ID)\n                );\n\n                const existingFilters = existingFiltersResponse.data || [];\n                const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\n\n                // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n                if (!alleFilterExists) {\n                    const alleFilter = {\n                        tableId: BRANCHES_TABLE_ID,\n                        name: 'Alle',\n                        conditions: [],\n                        operators: []\n                    };\n\n                    await axiosInstance.post(\n                        API_ENDPOINTS.SAVED_FILTERS.BASE,\n                        alleFilter\n                    );\n                    if (process.env.NODE_ENV === 'development') {\n                    logger.log(t('branches.filterCreated'));\n                    }\n                }\n            } catch (error) {\n                console.error(t('branches.createStandardFiltersError'), error);\n            }\n        };\n\n        createStandardFilters();\n    }, []);\n\n\n    // Branches rendern\n    const renderBranches = () => {\n        if (filteredAndSortedBranches.length === 0) {\n            return (\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded text-center\">\n                    <p className=\"text-gray-600 dark:text-gray-400\">\n                        {t('branches.noBranches', { defaultValue: 'Keine Niederlassungen gefunden. Erstellen Sie eine neue Niederlassung mit dem Button oben.' })}\n                    </p>\n                </div>\n            );\n        }\n        \n        // Card-Ansicht\n        return (\n            <>\n                <div className=\"space-y-4\">\n                    {filteredAndSortedBranches.slice(0, displayLimit).map((branch) => (\n                        <BranchCard \n                            key={branch.id} \n                            branch={branch} \n                            onEdit={handleEdit}\n                            onDelete={handleDelete}\n                            canEdit={canEdit}\n                            canDelete={canDelete}\n                        />\n                    ))}\n                </div>\n                \n                {/* \"Mehr anzeigen\" Button */}\n                {filteredAndSortedBranches.length > displayLimit && (\n                    <div className=\"mt-4 flex justify-center\">\n                        <button\n                            className=\"px-4 py-2 text-sm font-medium text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                            onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                        >\n                            {t('common.showMore', { defaultValue: 'Mehr anzeigen' })} ({filteredAndSortedBranches.length - displayLimit} {t('common.remaining', { defaultValue: 'verbleibend' })})\n                        </button>\n                    </div>\n                )}\n            </>\n        );\n    };\n\n    // Mobile-Erkennung\n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    \n    useEffect(() => {\n        const handleResize = () => {\n            setIsMobile(window.innerWidth < 640);\n        };\n        window.addEventListener('resize', handleResize);\n        return () => window.removeEventListener('resize', handleResize);\n    }, []);\n\n    return (\n        <div>\n            {/* Spaltenanzeige und Suche */}\n            <div className=\"space-y-4\">\n                <div className=\"flex items-center justify-between mb-4\">\n                    {/* Linke Seite: \"Neue Niederlassung erstellen\"-Button */}\n                    <div className=\"flex items-center\">\n                        {canCreate && (\n                            <div className=\"relative group\">\n                                <button\n                                    onClick={handleCreate}\n                                    className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                                    style={{ width: '30.19px', height: '30.19px' }}\n                                    aria-label={t('branches.create', { defaultValue: 'Neue Niederlassung' })}\n                                >\n                                    <PlusIcon className=\"h-4 w-4\" />\n                                </button>\n                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                    {t('branches.create', { defaultValue: 'Neue Niederlassung' })}\n                                </div>\n                            </div>\n                        )}\n                    </div>\n                    \n                    {/* Mitte: Titel - Kein Titel in der Mitte notwendig bei dieser Komponente, da der Tab-Header bereits den Titel zeigt */}\n                    <div></div>\n                    \n                    {/* Rechte Seite: Suchfeld, Filter-Button */}\n                    <div className=\"flex items-center gap-1.5\">\n                        <input\n                            type=\"text\"\n                            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n                            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                        />\n                        <div className=\"relative group ml-1\">\n                            <button\n                                className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100'} relative`}\n                                onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                            >\n                                <FunnelIcon className=\"w-5 h-5\" />\n                                {getActiveFilterCount() > 0 && (\n                                    <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                        {getActiveFilterCount()}\n                                    </span>\n                                )}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.filter', { defaultValue: 'Filter' })}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Filter-Modal */}\n                {isFilterModalOpen && (\n                    <FilterPane\n                        columns={[\n                            { id: 'name', label: t('branches.name', { defaultValue: 'Name' }) }\n                        ]}\n                        onApply={applyFilterConditions}\n                        onReset={resetFilterConditions}\n                        savedConditions={filterConditions}\n                        savedOperators={filterLogicalOperators}\n                        tableId={BRANCHES_TABLE_ID}\n                    />\n                )}\n                \n                {/* Gespeicherte Filter als Tags anzeigen */}\n                <SavedFilterTags\n                    tableId={BRANCHES_TABLE_ID}\n                    onSelectFilter={applyFilterConditions}\n                    onReset={resetFilterConditions}\n                    activeFilterName={activeFilterName}\n                    selectedFilterId={selectedFilterId}\n                    onFilterChange={handleFilterChange}\n                    defaultFilterName=\"Alle\"\n                />\n\n                {loading ? (\n                    <div className=\"flex justify-center items-center py-8\">\n                        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n                    </div>\n                ) : (\n                    renderBranches()\n                )}\n            </div>\n\n            {/* Modal/Sidepane fr Branch-Erstellung/Bearbeitung */}\n            {isModalOpen && (\n                <>\n                    {/* Mobile (unter 640px) - Modal */}\n                    {isMobile ? (\n                        <Dialog open={isModalOpen} onClose={handleCloseModal} className=\"relative z-50\">\n                            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                            \n                            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                                <Dialog.Panel className=\"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                                    {/* Header */}\n                                    <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                                        <div className=\"flex items-center justify-between\">\n                                            <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                                                {editingBranch \n                                                    ? t('branches.edit', { defaultValue: 'Niederlassung bearbeiten' })\n                                                    : t('branches.create', { defaultValue: 'Neue Niederlassung' })\n                                                }\n                                            </Dialog.Title>\n                                            <button\n                                                onClick={handleCloseModal}\n                                                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                            >\n                                                <XMarkIcon className=\"h-6 w-6\" />\n                                            </button>\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Form */}\n                                    <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.name', { defaultValue: 'Name' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.name}\n                                                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                required\n                                                autoFocus\n                                            />\n                                        </div>\n\n                                        {/* Adress-Felder */}\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.address', { defaultValue: 'Adresse' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.address}\n                                                onChange={(e) => setFormData({ ...formData, address: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.addressPlaceholder', { defaultValue: 'Strae und Hausnummer' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.city', { defaultValue: 'Stadt' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.city}\n                                                onChange={(e) => setFormData({ ...formData, city: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.cityPlaceholder', { defaultValue: 'z.B. Medelln' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.country', { defaultValue: 'Land' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.country}\n                                                onChange={(e) => setFormData({ ...formData, country: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.countryPlaceholder', { defaultValue: 'z.B. Kolumbien' })}\n                                            />\n                                        </div>\n\n                                        {/* Settings Tabs - nur beim Bearbeiten */}\n                                        {editingBranch && (\n                                            <>\n                                                {/* Tab Navigation */}\n                                                <div className=\"border-b border-gray-200 dark:border-gray-700 mb-4\">\n                                                    <nav className=\"-mb-px flex space-x-2 overflow-x-auto\">\n                                                        {['whatsapp', 'lobbypms', 'boldpayment', 'doorsystem', 'email', 'messages'].map((tab) => (\n                                                            <button\n                                                                key={tab}\n                                                                type=\"button\"\n                                                                onClick={() => setActiveSettingsTab(tab as any)}\n                                                                className={`py-2 px-2 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ${\n                                                                    activeSettingsTab === tab\n                                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                                }`}\n                                                            >\n                                                                {tab === 'whatsapp' ? 'WhatsApp' : tab === 'lobbypms' ? 'LobbyPMS' : tab === 'boldpayment' ? 'Bold Payment' : tab === 'doorsystem' ? 'TTLock' : tab === 'email' ? 'Email' : t('branches.messagesTab', { defaultValue: 'Nachrichten' })}\n                                                            </button>\n                                                        ))}\n                                                    </nav>\n                                                </div>\n\n                                                {/* Tab Content */}\n                                                <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n                                                    {/* WhatsApp Settings Tab */}\n                                                    {activeSettingsTab === 'whatsapp' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                WhatsApp Settings\n                                                            </h4>\n                                                \n                                                <div className=\"space-y-4\">\n                                                    <div>\n                                                        <label htmlFor=\"whatsappProvider\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            Provider\n                                                        </label>\n                                                        <select\n                                                            id=\"whatsappProvider\"\n                                                            value={formData.whatsappSettings.provider}\n                                                            onChange={(e) => setFormData({\n                                                                ...formData,\n                                                                whatsappSettings: {\n                                                                    ...formData.whatsappSettings,\n                                                                    provider: e.target.value as 'twilio' | 'whatsapp-business-api'\n                                                                }\n                                                            })}\n                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                        >\n                                                            <option value=\"twilio\">Twilio</option>\n                                                            <option value=\"whatsapp-business-api\">WhatsApp Business API</option>\n                                                        </select>\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiKey\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Key / Access Token\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiKey'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiKey\"\n                                                                value={formData.whatsappSettings.apiKey}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiKey: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Key / Access Token\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiKey: !prev.whatsappApiKey }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiKey'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappPhoneNumberId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            Phone Number ID\n                                                        </label>\n                                                        <input\n                                                            type=\"text\"\n                                                            id=\"whatsappPhoneNumberId\"\n                                                            value={formData.whatsappSettings.phoneNumberId}\n                                                            onChange={(e) => setFormData({\n                                                                ...formData,\n                                                                whatsappSettings: {\n                                                                    ...formData.whatsappSettings,\n                                                                    phoneNumberId: e.target.value\n                                                                }\n                                                            })}\n                                                            placeholder=\"Phone Number ID\"\n                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                        />\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiSecret\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Secret\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiSecret'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiSecret\"\n                                                                value={formData.whatsappSettings.apiSecret}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiSecret: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Secret\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiSecret: !prev.whatsappApiSecret }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiSecret'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    {/* AI Configuration */}\n                                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                        <div className=\"flex items-center justify-between mb-4\">\n                                                            <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                KI-Konfiguration (AI)\n                                                            </h5>\n                                                            <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                <input\n                                                                    type=\"checkbox\"\n                                                                    checked={formData.whatsappSettings.ai.enabled}\n                                                                    onChange={(e) => setFormData({\n                                                                        ...formData,\n                                                                        whatsappSettings: {\n                                                                            ...formData.whatsappSettings,\n                                                                            ai: {\n                                                                                ...formData.whatsappSettings.ai,\n                                                                                enabled: e.target.checked\n                                                                            }\n                                                                        }\n                                                                    })}\n                                                                    className=\"sr-only peer\"\n                                                                />\n                                                                <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                    {formData.whatsappSettings.ai.enabled ? 'Aktiviert' : 'Deaktiviert'}\n                                                                </span>\n                                                            </label>\n                                                        </div>\n\n                                                        {formData.whatsappSettings.ai.enabled && (\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label htmlFor=\"aiModel\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Modell\n                                                                    </label>\n                                                                    <select\n                                                                        id=\"aiModel\"\n                                                                        value={formData.whatsappSettings.ai.model}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    model: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"gpt-4o\">GPT-4o</option>\n                                                                        <option value=\"gpt-4\">GPT-4</option>\n                                                                        <option value=\"gpt-3.5-turbo\">GPT-3.5 Turbo</option>\n                                                                    </select>\n                                                                </div>\n\n                                                                <div>\n                                                                    <label htmlFor=\"aiSystemPrompt\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        System Prompt\n                                                                    </label>\n                                                                    <textarea\n                                                                        id=\"aiSystemPrompt\"\n                                                                        value={formData.whatsappSettings.ai.systemPrompt}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    systemPrompt: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={4}\n                                                                        placeholder=\"Du bist ein hilfreicher Assistent fr...\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Regeln (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.rules.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    rules: e.target.value.split('\\n').filter(r => r.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={3}\n                                                                        placeholder=\"Antworte immer auf Spanisch&#10;Sei freundlich und professionell\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Quellen/URLs (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.sources.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    sources: e.target.value.split('\\n').filter(s => s.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={2}\n                                                                        placeholder=\"https://wiki.example.com/manila-procedures&#10;https://wiki.example.com/faq\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div className=\"grid grid-cols-2 gap-4\">\n                                                                    <div>\n                                                                        <label htmlFor=\"aiTemperature\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Temperature ({formData.whatsappSettings.ai.temperature})\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"range\"\n                                                                            id=\"aiTemperature\"\n                                                                            min=\"0\"\n                                                                            max=\"2\"\n                                                                            step=\"0.1\"\n                                                                            value={formData.whatsappSettings.ai.temperature}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        temperature: parseFloat(e.target.value)\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full\"\n                                                                        />\n                                                                    </div>\n\n                                                                    <div>\n                                                                        <label htmlFor=\"aiMaxTokens\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Max Tokens\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"number\"\n                                                                            id=\"aiMaxTokens\"\n                                                                            min=\"100\"\n                                                                            max=\"4000\"\n                                                                            step=\"100\"\n                                                                            value={formData.whatsappSettings.ai.maxTokens}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        maxTokens: parseInt(e.target.value) || 500\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        />\n                                                                    </div>\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                                    {/* LobbyPMS Settings Tab */}\n                                                    {activeSettingsTab === 'lobbypms' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                LobbyPMS Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API URL\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.apiUrl}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiUrl: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"https://api.lobbypms.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['lobbyPmsApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.lobbyPmsSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiKey: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Property ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.propertyId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, propertyId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Property ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                            \n                                                            {/* Zimmer-Beschreibungen Sektion */}\n                                                            {editingBranch && (\n                                                                <RoomDescriptionsSection branchId={editingBranch.id} />\n                                                            )}\n                                                        </div>\n                                                    )}\n\n                                                    {/* Bold Payment Settings Tab */}\n                                                    {activeSettingsTab === 'boldpayment' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Bold Payment Settings\n                                                            </h4>\n                                                            {formData.boldPaymentSettings._hasEncryptedValues && (\n                                                                <div className=\"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md\">\n                                                                    <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n                                                                        <strong>Hinweis:</strong> Es sind verschlsselte Werte vorhanden, die mit einem alten Schlssel verschlsselt wurden und nicht mehr entschlsselt werden knnen. \n                                                                        Die Payment-Links funktionieren weiterhin. Um die Werte zu ndern, geben Sie sie neu ein.\n                                                                    </p>\n                                                                </div>\n                                                            )}\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, apiKey: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Merchant ID\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentMerchantId'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.merchantId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, merchantId: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"Merchant ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Environment\n                                                                    </label>\n                                                                    <select\n                                                                        value={formData.boldPaymentSettings.environment}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, environment: e.target.value as 'sandbox' | 'production' }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"sandbox\">Sandbox</option>\n                                                                        <option value=\"production\">Production</option>\n                                                                    </select>\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* TTLock Settings Tab */}\n                                                    {activeSettingsTab === 'doorsystem' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                TTLock Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.clientId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client Secret\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemClientSecret'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.clientSecret}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientSecret: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client Secret\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Username\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.username}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, username: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Username\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Password\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemPassword'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.password}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, password: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Password\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* Email Settings Tab */}\n                                                    {activeSettingsTab === 'email' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Email Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Host\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpHost}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpHost: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"smtp.example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Port\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"number\"\n                                                                        value={formData.emailSettings.smtpPort}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpPort: parseInt(e.target.value) || 587 }\n                                                                        })}\n                                                                        placeholder=\"587\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP User\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpUser}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpUser: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"user@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Password\n                                                                    </label>\n                                                                    <div className=\"relative\">\n                                                                        <input\n                                                                            type={showSecrets['emailSmtpPass'] ? 'text' : 'password'}\n                                                                            value={formData.emailSettings.smtpPass}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                emailSettings: { ...formData.emailSettings, smtpPass: e.target.value }\n                                                                            })}\n                                                                            placeholder=\"Password\"\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                        />\n                                                                        <button\n                                                                            type=\"button\"\n                                                                            onClick={() => setShowSecrets({ ...showSecrets, emailSmtpPass: !showSecrets['emailSmtpPass'] })}\n                                                                            className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                        >\n                                                                            {showSecrets['emailSmtpPass'] ? (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                </svg>\n                                                                            ) : (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                </svg>\n                                                                            )}\n                                                                        </button>\n                                                                    </div>\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Email\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"email\"\n                                                                        value={formData.emailSettings.smtpFromEmail}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromEmail: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"noreply@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Name\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpFromName}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromName: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Branch Name\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                {/* IMAP Settings Section */}\n                                                                <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                                    <div className=\"flex items-center justify-between mb-4\">\n                                                                        <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                            IMAP Settings (Email Reading)\n                                                                        </h5>\n                                                                        <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                            <input\n                                                                                type=\"checkbox\"\n                                                                                checked={formData.emailSettings.imap.enabled}\n                                                                                onChange={(e) => setFormData({\n                                                                                    ...formData,\n                                                                                    emailSettings: {\n                                                                                        ...formData.emailSettings,\n                                                                                        imap: {\n                                                                                            ...formData.emailSettings.imap,\n                                                                                            enabled: e.target.checked\n                                                                                        }\n                                                                                    }\n                                                                                })}\n                                                                                className=\"sr-only peer\"\n                                                                            />\n                                                                            <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                            <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                {formData.emailSettings.imap.enabled ? 'Enabled' : 'Disabled'}\n                                                                            </span>\n                                                                        </label>\n                                                                    </div>\n\n                                                                    {formData.emailSettings.imap.enabled && (\n                                                                        <div className=\"space-y-4\">\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Host\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.host}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, host: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"imap.example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Port\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"number\"\n                                                                                    value={formData.emailSettings.imap.port}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, port: parseInt(e.target.value) || 993 }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"993\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                                    <input\n                                                                                        type=\"checkbox\"\n                                                                                        checked={formData.emailSettings.imap.secure}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, secure: e.target.checked }\n                                                                                            }\n                                                                                        })}\n                                                                                        className=\"sr-only peer\"\n                                                                                    />\n                                                                                    <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                                    <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                        Secure (SSL/TLS)\n                                                                                    </span>\n                                                                                </label>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP User\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.user}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, user: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"user@example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Password\n                                                                                </label>\n                                                                                <div className=\"relative\">\n                                                                                    <input\n                                                                                        type={showSecrets['emailImapPass'] ? 'text' : 'password'}\n                                                                                        value={formData.emailSettings.imap.password}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, password: e.target.value }\n                                                                                            }\n                                                                                        })}\n                                                                                        placeholder=\"Password\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                                    />\n                                                                                    <button\n                                                                                        type=\"button\"\n                                                                                        onClick={() => setShowSecrets({ ...showSecrets, emailImapPass: !showSecrets['emailImapPass'] })}\n                                                                                        className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        {showSecrets['emailImapPass'] ? (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                            </svg>\n                                                                                        ) : (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                            </svg>\n                                                                                        )}\n                                                                                    </button>\n                                                                                </div>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Folder\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.folder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, folder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"INBOX\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    Processed Folder (optional)\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.processedFolder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, processedFolder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"Processed\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                        </div>\n                                                                    )}\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n                                                </div>\n                                            </>\n                                        )}\n\n                                        {/* Buttons */}\n                                        <div className=\"flex justify-end pt-4 gap-2\">\n                                            <div className=\"relative group\">\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={handleCloseModal}\n                                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                                                >\n                                                    <XMarkIcon className=\"h-5 w-5\" />\n                                                </button>\n                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                    {t('common.cancel', { defaultValue: 'Abbrechen' })}\n                                                </div>\n                                            </div>\n                                            <div className=\"relative group\">\n                                                <button\n                                                    type=\"submit\"\n                                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                                                >\n                                                    <CheckIcon className=\"h-5 w-5\" />\n                                                </button>\n                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                    {editingBranch ? t('common.update', { defaultValue: 'Aktualisieren' }) : t('common.create', { defaultValue: 'Erstellen' })}\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </form>\n                                </Dialog.Panel>\n                            </div>\n                        </Dialog>\n                    ) : (\n                        // Desktop - Sidepane (dynamische Breite basierend auf Tab-Anzahl)\n                        <div className=\"fixed inset-y-0 right-0 w-full sm:min-w-[500px] sm:max-w-[600px] bg-white dark:bg-gray-800 shadow-xl z-50 flex flex-col\">\n                            {/* Header */}\n                            <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                                <div className=\"flex items-center justify-between\">\n                                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                                        {editingBranch \n                                            ? t('branches.edit', { defaultValue: 'Niederlassung bearbeiten' })\n                                            : t('branches.create', { defaultValue: 'Neue Niederlassung' })\n                                        }\n                                    </h2>\n                                    <button\n                                        onClick={handleCloseModal}\n                                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                    >\n                                        <XMarkIcon className=\"h-6 w-6\" />\n                                    </button>\n                                </div>\n                            </div>\n                            \n                            {/* Form */}\n                            <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\n                                <div className=\"flex-1 overflow-y-auto min-h-0\">\n                                    <div className=\"p-6 space-y-4\">\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.name', { defaultValue: 'Name' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.name}\n                                                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                required\n                                                autoFocus\n                                            />\n                                        </div>\n\n                                        {/* Adress-Felder */}\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.address', { defaultValue: 'Adresse' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.address}\n                                                onChange={(e) => setFormData({ ...formData, address: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.addressPlaceholder', { defaultValue: 'Strae und Hausnummer' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.city', { defaultValue: 'Stadt' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.city}\n                                                onChange={(e) => setFormData({ ...formData, city: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.cityPlaceholder', { defaultValue: 'z.B. Medelln' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.country', { defaultValue: 'Land' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.country}\n                                                onChange={(e) => setFormData({ ...formData, country: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.countryPlaceholder', { defaultValue: 'z.B. Kolumbien' })}\n                                            />\n                                        </div>\n\n                                        {/* Settings Tabs - nur beim Bearbeiten */}\n                                        {editingBranch && (\n                                            <>\n                                                {/* Tab Navigation */}\n                                                <div className=\"border-b border-gray-200 dark:border-gray-700 mb-4\">\n                                                    <nav className=\"-mb-px flex space-x-2 overflow-x-auto\">\n                                                        {['whatsapp', 'lobbypms', 'boldpayment', 'doorsystem', 'email', 'messages'].map((tab) => (\n                                                            <button\n                                                                key={tab}\n                                                                type=\"button\"\n                                                                onClick={() => setActiveSettingsTab(tab as any)}\n                                                                className={`py-2 px-2 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ${\n                                                                    activeSettingsTab === tab\n                                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                                }`}\n                                                            >\n                                                                {tab === 'whatsapp' ? 'WhatsApp' : tab === 'lobbypms' ? 'LobbyPMS' : tab === 'boldpayment' ? 'Bold Payment' : tab === 'doorsystem' ? 'TTLock' : tab === 'email' ? 'Email' : t('branches.messagesTab', { defaultValue: 'Nachrichten' })}\n                                                            </button>\n                                                        ))}\n                                                    </nav>\n                                                </div>\n\n                                                {/* Tab Content */}\n                                                <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n                                                    {/* WhatsApp Settings Tab */}\n                                                    {activeSettingsTab === 'whatsapp' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                WhatsApp Settings\n                                                            </h4>\n                                                            \n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label htmlFor=\"whatsappProviderDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Provider\n                                                                    </label>\n                                                                    <select\n                                                                        id=\"whatsappProviderDesktop\"\n                                                                        value={formData.whatsappSettings.provider}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                provider: e.target.value as 'twilio' | 'whatsapp-business-api'\n                                                                            }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"twilio\">Twilio</option>\n                                                                        <option value=\"whatsapp-business-api\">WhatsApp Business API</option>\n                                                                    </select>\n                                                                </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiKey\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Key / Access Token\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiKey'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiKey\"\n                                                                value={formData.whatsappSettings.apiKey}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiKey: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Key / Access Token\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiKey: !prev.whatsappApiKey }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiKey'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappPhoneNumberId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            Phone Number ID\n                                                        </label>\n                                                        <input\n                                                            type=\"text\"\n                                                            id=\"whatsappPhoneNumberId\"\n                                                            value={formData.whatsappSettings.phoneNumberId}\n                                                            onChange={(e) => setFormData({\n                                                                ...formData,\n                                                                whatsappSettings: {\n                                                                    ...formData.whatsappSettings,\n                                                                    phoneNumberId: e.target.value\n                                                                }\n                                                            })}\n                                                            placeholder=\"Phone Number ID\"\n                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                        />\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiSecretDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Secret\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiSecret'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiSecretDesktop\"\n                                                                value={formData.whatsappSettings.apiSecret}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiSecret: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Secret\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiSecret: !prev.whatsappApiSecret }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiSecret'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    {/* AI Configuration */}\n                                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                        <div className=\"flex items-center justify-between mb-4\">\n                                                            <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                KI-Konfiguration (AI)\n                                                            </h5>\n                                                            <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                <input\n                                                                    type=\"checkbox\"\n                                                                    checked={formData.whatsappSettings.ai.enabled}\n                                                                    onChange={(e) => setFormData({\n                                                                        ...formData,\n                                                                        whatsappSettings: {\n                                                                            ...formData.whatsappSettings,\n                                                                            ai: {\n                                                                                ...formData.whatsappSettings.ai,\n                                                                                enabled: e.target.checked\n                                                                            }\n                                                                        }\n                                                                    })}\n                                                                    className=\"sr-only peer\"\n                                                                />\n                                                                <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                    {formData.whatsappSettings.ai.enabled ? 'Aktiviert' : 'Deaktiviert'}\n                                                                </span>\n                                                            </label>\n                                                        </div>\n\n                                                        {formData.whatsappSettings.ai.enabled && (\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label htmlFor=\"aiModelDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Modell\n                                                                    </label>\n                                                                    <select\n                                                                        id=\"aiModelDesktop\"\n                                                                        value={formData.whatsappSettings.ai.model}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    model: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"gpt-4o\">GPT-4o</option>\n                                                                        <option value=\"gpt-4\">GPT-4</option>\n                                                                        <option value=\"gpt-3.5-turbo\">GPT-3.5 Turbo</option>\n                                                                    </select>\n                                                                </div>\n\n                                                                <div>\n                                                                    <label htmlFor=\"aiSystemPromptDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        System Prompt\n                                                                    </label>\n                                                                    <textarea\n                                                                        id=\"aiSystemPromptDesktop\"\n                                                                        value={formData.whatsappSettings.ai.systemPrompt}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    systemPrompt: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={4}\n                                                                        placeholder=\"Du bist ein hilfreicher Assistent fr...\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Regeln (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.rules.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    rules: e.target.value.split('\\n').filter(r => r.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={3}\n                                                                        placeholder=\"Antworte immer auf Spanisch&#10;Sei freundlich und professionell\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Quellen/URLs (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.sources.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    sources: e.target.value.split('\\n').filter(s => s.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={2}\n                                                                        placeholder=\"https://wiki.example.com/manila-procedures&#10;https://wiki.example.com/faq\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div className=\"grid grid-cols-2 gap-4\">\n                                                                    <div>\n                                                                        <label htmlFor=\"aiTemperatureDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Temperature ({formData.whatsappSettings.ai.temperature})\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"range\"\n                                                                            id=\"aiTemperatureDesktop\"\n                                                                            min=\"0\"\n                                                                            max=\"2\"\n                                                                            step=\"0.1\"\n                                                                            value={formData.whatsappSettings.ai.temperature}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        temperature: parseFloat(e.target.value)\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full\"\n                                                                        />\n                                                                    </div>\n\n                                                                    <div>\n                                                                        <label htmlFor=\"aiMaxTokensDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Max Tokens\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"number\"\n                                                                            id=\"aiMaxTokensDesktop\"\n                                                                            min=\"100\"\n                                                                            max=\"4000\"\n                                                                            step=\"100\"\n                                                                            value={formData.whatsappSettings.ai.maxTokens}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        maxTokens: parseInt(e.target.value) || 500\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        />\n                                                                    </div>\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                                    {/* LobbyPMS Settings Tab */}\n                                                    {activeSettingsTab === 'lobbypms' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                LobbyPMS Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API URL\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.apiUrl}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiUrl: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"https://api.lobbypms.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['lobbyPmsApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.lobbyPmsSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiKey: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Property ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.propertyId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, propertyId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Property ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                            \n                                                            {/* Zimmer-Beschreibungen Sektion */}\n                                                            {editingBranch && (\n                                                                <RoomDescriptionsSection branchId={editingBranch.id} />\n                                                            )}\n                                                        </div>\n                                                    )}\n\n                                                    {/* Bold Payment Settings Tab */}\n                                                    {activeSettingsTab === 'boldpayment' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Bold Payment Settings\n                                                            </h4>\n                                                            {formData.boldPaymentSettings._hasEncryptedValues && (\n                                                                <div className=\"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md\">\n                                                                    <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n                                                                        <strong>Hinweis:</strong> Es sind verschlsselte Werte vorhanden, die mit einem alten Schlssel verschlsselt wurden und nicht mehr entschlsselt werden knnen. \n                                                                        Die Payment-Links funktionieren weiterhin. Um die Werte zu ndern, geben Sie sie neu ein.\n                                                                    </p>\n                                                                </div>\n                                                            )}\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, apiKey: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Merchant ID\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentMerchantId'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.merchantId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, merchantId: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"Merchant ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Environment\n                                                                    </label>\n                                                                    <select\n                                                                        value={formData.boldPaymentSettings.environment}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, environment: e.target.value as 'sandbox' | 'production' }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"sandbox\">Sandbox</option>\n                                                                        <option value=\"production\">Production</option>\n                                                                    </select>\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* TTLock Settings Tab */}\n                                                    {activeSettingsTab === 'doorsystem' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                TTLock Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.clientId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client Secret\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemClientSecret'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.clientSecret}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientSecret: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client Secret\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Username\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.username}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, username: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Username\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Password\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemPassword'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.password}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, password: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Password\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* Email Settings Tab */}\n                                                    {activeSettingsTab === 'email' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Email Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Host\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpHost}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpHost: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"smtp.example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Port\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"number\"\n                                                                        value={formData.emailSettings.smtpPort}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpPort: parseInt(e.target.value) || 587 }\n                                                                        })}\n                                                                        placeholder=\"587\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP User\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpUser}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpUser: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"user@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Password\n                                                                    </label>\n                                                                    <div className=\"relative\">\n                                                                        <input\n                                                                            type={showSecrets['emailSmtpPass'] ? 'text' : 'password'}\n                                                                            value={formData.emailSettings.smtpPass}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                emailSettings: { ...formData.emailSettings, smtpPass: e.target.value }\n                                                                            })}\n                                                                            placeholder=\"Password\"\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                        />\n                                                                        <button\n                                                                            type=\"button\"\n                                                                            onClick={() => setShowSecrets({ ...showSecrets, emailSmtpPass: !showSecrets['emailSmtpPass'] })}\n                                                                            className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                        >\n                                                                            {showSecrets['emailSmtpPass'] ? (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                </svg>\n                                                                            ) : (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                </svg>\n                                                                            )}\n                                                                        </button>\n                                                                    </div>\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Email\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"email\"\n                                                                        value={formData.emailSettings.smtpFromEmail}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromEmail: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"noreply@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Name\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpFromName}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromName: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Branch Name\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                {/* IMAP Settings Section */}\n                                                                <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                                    <div className=\"flex items-center justify-between mb-4\">\n                                                                        <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                            IMAP Settings (Email Reading)\n                                                                        </h5>\n                                                                        <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                            <input\n                                                                                type=\"checkbox\"\n                                                                                checked={formData.emailSettings.imap.enabled}\n                                                                                onChange={(e) => setFormData({\n                                                                                    ...formData,\n                                                                                    emailSettings: {\n                                                                                        ...formData.emailSettings,\n                                                                                        imap: {\n                                                                                            ...formData.emailSettings.imap,\n                                                                                            enabled: e.target.checked\n                                                                                        }\n                                                                                    }\n                                                                                })}\n                                                                                className=\"sr-only peer\"\n                                                                            />\n                                                                            <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                            <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                {formData.emailSettings.imap.enabled ? 'Enabled' : 'Disabled'}\n                                                                            </span>\n                                                                        </label>\n                                                                    </div>\n\n                                                                    {formData.emailSettings.imap.enabled && (\n                                                                        <div className=\"space-y-4\">\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Host\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.host}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, host: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"imap.example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Port\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"number\"\n                                                                                    value={formData.emailSettings.imap.port}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, port: parseInt(e.target.value) || 993 }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"993\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                                    <input\n                                                                                        type=\"checkbox\"\n                                                                                        checked={formData.emailSettings.imap.secure}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, secure: e.target.checked }\n                                                                                            }\n                                                                                        })}\n                                                                                        className=\"sr-only peer\"\n                                                                                    />\n                                                                                    <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                                    <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                        Secure (SSL/TLS)\n                                                                                    </span>\n                                                                                </label>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP User\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.user}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, user: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"user@example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Password\n                                                                                </label>\n                                                                                <div className=\"relative\">\n                                                                                    <input\n                                                                                        type={showSecrets['emailImapPass'] ? 'text' : 'password'}\n                                                                                        value={formData.emailSettings.imap.password}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, password: e.target.value }\n                                                                                            }\n                                                                                        })}\n                                                                                        placeholder=\"Password\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                                    />\n                                                                                    <button\n                                                                                        type=\"button\"\n                                                                                        onClick={() => setShowSecrets({ ...showSecrets, emailImapPass: !showSecrets['emailImapPass'] })}\n                                                                                        className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        {showSecrets['emailImapPass'] ? (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                            </svg>\n                                                                                        ) : (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                            </svg>\n                                                                                        )}\n                                                                                    </button>\n                                                                                </div>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Folder\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.folder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, folder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"INBOX\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    Processed Folder (optional)\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.processedFolder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, processedFolder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"Processed\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                        </div>\n                                                                    )}\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* Messages Tab */}\n                                                    {activeSettingsTab === 'messages' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                {t('branches.messagesTab', { defaultValue: 'Nachrichten' })}\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                {/* Automatisches Versenden */}\n                                                                <div className=\"border-b border-gray-200 dark:border-gray-700 pb-4\">\n                                                                    <div className=\"flex items-center justify-between\">\n                                                                        <div>\n                                                                            <label className=\"block text-sm font-medium text-gray-900 dark:text-white mb-1\">\n                                                                                {t('branches.autoSendInvitation', { defaultValue: 'Automatisches Versenden aktivieren' })}\n                                                                            </label>\n                                                                            <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                                                                {t('branches.autoSendInvitationDescription', { defaultValue: 'Sendet Check-in-Einladungen automatisch 1 Tag vor Check-in-Date um 08:00 Uhr' })}\n                                                                            </p>\n                                                                        </div>\n                                                                        <input\n                                                                            type=\"checkbox\"\n                                                                            checked={formData.autoSendReservationInvitation}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                autoSendReservationInvitation: e.target.checked\n                                                                            })}\n                                                                            className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                                                                        />\n                                                                    </div>\n                                                                </div>\n\n                                                                {/* Mitteilungsvorlagen */}\n                                                                <div>\n                                                                    <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\n                                                                        {t('branches.messageTemplates', { defaultValue: 'Mitteilungsvorlagen' })}\n                                                                    </h5>\n                                                                    \n                                                                    <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-4\">\n                                                                        {t('branches.messageTemplatesDescription', { defaultValue: 'Konfiguriere die Vorlagen fr Check-in-Einladungen und Check-in-Besttigungen' })}\n                                                                    </p>\n\n                                                                    {/* Template Type Selector */}\n                                                                    <div className=\"mb-4\">\n                                                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                                                            {t('branches.messageType', { defaultValue: 'Mitteilungstyp' })}\n                                                                        </label>\n                                                                        <select\n                                                                            value={selectedTemplateType}\n                                                                            onChange={(e) => setSelectedTemplateType(e.target.value as 'checkInInvitation' | 'checkInConfirmation')}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        >\n                                                                            <option value=\"checkInInvitation\">\n                                                                                {t('branches.messageType.checkInInvitation', { defaultValue: 'Check-in-Einladung' })}\n                                                                            </option>\n                                                                            <option value=\"checkInConfirmation\">\n                                                                                {t('branches.messageType.checkInConfirmation', { defaultValue: 'Check-in-Besttigung' })}\n                                                                            </option>\n                                                                        </select>\n                                                                    </div>\n\n                                                                    {/* Language Selector */}\n                                                                    <div className=\"mb-4\">\n                                                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                                                            {t('branches.language', { defaultValue: 'Sprache' })}\n                                                                        </label>\n                                                                        <select\n                                                                            value={selectedLanguage}\n                                                                            onChange={(e) => setSelectedLanguage(e.target.value as 'en' | 'es' | 'de')}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        >\n                                                                            <option value=\"en\">{t('branches.language.en', { defaultValue: 'Englisch' })}</option>\n                                                                            <option value=\"es\">{t('branches.language.es', { defaultValue: 'Spanisch' })}</option>\n                                                                            <option value=\"de\">{t('branches.language.de', { defaultValue: 'Deutsch' })}</option>\n                                                                        </select>\n                                                                    </div>\n\n                                                                    {/* Template Fields */}\n                                                                    {(() => {\n                                                                        const currentTemplate = formData.messageTemplates?.[selectedTemplateType]?.[selectedLanguage] || {\n                                                                            whatsappTemplateName: '',\n                                                                            whatsappTemplateParams: [] as string[],\n                                                                            emailSubject: '',\n                                                                            emailContent: ''\n                                                                        };\n                                                                        \n                                                                        return (\n                                                                            <div className=\"space-y-4\">\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.whatsappTemplateName', { defaultValue: 'WhatsApp Template Name' })}\n                                                                                    </label>\n                                                                                    <input\n                                                                                        type=\"text\"\n                                                                                        value={currentTemplate.whatsappTemplateName || ''}\n                                                                                        onChange={(e) => {\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            whatsappTemplateName: e.target.value\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"reservation_checkin_invitation_en\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                </div>\n\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.whatsappTemplateParams', { defaultValue: 'WhatsApp Template Parameter' })}\n                                                                                    </label>\n                                                                                    <input\n                                                                                        type=\"text\"\n                                                                                        value={Array.isArray(currentTemplate.whatsappTemplateParams) ? currentTemplate.whatsappTemplateParams.join(', ') : (currentTemplate.whatsappTemplateParams || '')}\n                                                                                        onChange={(e) => {\n                                                                                            const params = e.target.value.split(',').map(p => p.trim()).filter(p => p);\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            whatsappTemplateParams: params\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"{{1}}, {{2}}, {{3}}\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                                                                                        {t('branches.whatsappTemplateParamsHint', { defaultValue: 'Komma-separiert, z.B. {{1}}, {{2}}, {{3}}' })}\n                                                                                    </p>\n                                                                                </div>\n\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.emailSubject', { defaultValue: 'Email Betreff' })}\n                                                                                    </label>\n                                                                                    <input\n                                                                                        type=\"text\"\n                                                                                        value={currentTemplate.emailSubject || ''}\n                                                                                        onChange={(e) => {\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            emailSubject: e.target.value\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"Welcome to La Familia Hostel - Online Check-in\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                </div>\n\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.emailContent', { defaultValue: 'Email Inhalt' })}\n                                                                                    </label>\n                                                                                    <textarea\n                                                                                        rows={10}\n                                                                                        value={currentTemplate.emailContent || ''}\n                                                                                        onChange={(e) => {\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            emailContent: e.target.value\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"Hello {{guestName}}, ...\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                                                                                        {t('branches.templateVariables', { defaultValue: 'Verfgbare Variablen' })}: \n                                                                                        <span className=\"font-mono\">\n                                                                                            {selectedTemplateType === 'checkInInvitation' \n                                                                                                ? t('branches.templateVariables.checkInInvitation', { defaultValue: '{{guestName}}, {{checkInLink}}, {{paymentLink}}' })\n                                                                                                : t('branches.templateVariables.checkInConfirmation', { defaultValue: '{{guestName}}, {{roomDisplay}}, {{doorPin}}, {{doorAppName}}' })\n                                                                                            }\n                                                                                        </span>\n                                                                                    </p>\n                                                                                </div>\n                                                                            </div>\n                                                                        );\n                                                                    })()}\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n                                                </div>\n                                            </>\n                                        )}\n                                    </div>\n                                </div>\n\n                                {/* Buttons */}\n                                <div className=\"flex justify-end pt-4 gap-2 px-6 pb-6 border-t dark:border-gray-700\">\n                                    <div className=\"relative group\">\n                                        <button\n                                            type=\"button\"\n                                            onClick={handleCloseModal}\n                                            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                                        >\n                                            <XMarkIcon className=\"h-5 w-5\" />\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {t('common.cancel', { defaultValue: 'Abbrechen' })}\n                                        </div>\n                                    </div>\n                                    <div className=\"relative group\">\n                                        <button\n                                            type=\"submit\"\n                                            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                                        >\n                                            <CheckIcon className=\"h-5 w-5\" />\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {editingBranch ? t('common.update', { defaultValue: 'Aktualisieren' }) : t('common.create', { defaultValue: 'Erstellen' })}\n                                        </div>\n                                    </div>\n                                </div>\n                            </form>\n                        </div>\n                    )}\n                </>\n            )}\n        </div>\n    );\n};\n\nexport default BranchManagementTab;\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface CreateTourProviderModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onProviderCreated: (newProvider: TourProvider) => void;\n}\n\nconst CreateTourProviderModal = ({ isOpen, onClose, onProviderCreated }: CreateTourProviderModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [name, setName] = useState('');\n    const [phone, setPhone] = useState('');\n    const [email, setEmail] = useState('');\n    const [contactPerson, setContactPerson] = useState('');\n    const [notes, setNotes] = useState('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const branchesRes = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Reset form when modal opens/closes\n    useEffect(() => {\n        if (!isOpen) {\n            setName('');\n            setPhone('');\n            setEmail('');\n            setContactPerson('');\n            setNotes('');\n            setBranchId('');\n            setError(null);\n        }\n    }, [isOpen]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierung\n        if (!name.trim()) {\n            setError(t('tours.providers.validation.nameRequired', { defaultValue: 'Name ist erforderlich' }));\n            return;\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.post(API_ENDPOINTS.TOUR_PROVIDERS.BASE, {\n                name: name.trim(),\n                phone: phone.trim() || null,\n                email: email.trim() || null,\n                contactPerson: contactPerson.trim() || null,\n                notes: notes.trim() || null,\n                branchId: branchId ? Number(branchId) : null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tours.providers.created', { defaultValue: 'Tour-Provider erfolgreich erstellt' }),\n                    'success'\n                );\n                onProviderCreated(response.data.data);\n                handleClose();\n            } else {\n                throw new Error(response.data?.message || t('tours.providers.createError', { defaultValue: 'Fehler beim Erstellen des Providers' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error creating provider:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        setName('');\n        setPhone('');\n        setEmail('');\n        setContactPerson('');\n        setNotes('');\n        setBranchId('');\n        setError(null);\n        onClose();\n    };\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.providers.create', { defaultValue: 'Neuer Tour-Provider' })}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.providers.create', { defaultValue: 'Neuer Tour-Provider' })}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default CreateTourProviderModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface EditTourProviderModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    provider: TourProvider | null;\n    onProviderUpdated: (updatedProvider: TourProvider) => void;\n}\n\nconst EditTourProviderModal = ({ isOpen, onClose, provider, onProviderUpdated }: EditTourProviderModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [name, setName] = useState('');\n    const [phone, setPhone] = useState('');\n    const [email, setEmail] = useState('');\n    const [contactPerson, setContactPerson] = useState('');\n    const [notes, setNotes] = useState('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches und setze Form-Daten\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const branchesRes = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Setze Form-Daten wenn Provider geladen wird\n    useEffect(() => {\n        if (provider) {\n            setName(provider.name || '');\n            setPhone(provider.phone || '');\n            setEmail(provider.email || '');\n            setContactPerson(provider.contactPerson || '');\n            setNotes(provider.notes || '');\n            setBranchId(provider.branchId || '');\n        } else {\n            setName('');\n            setPhone('');\n            setEmail('');\n            setContactPerson('');\n            setNotes('');\n            setBranchId('');\n        }\n        setError(null);\n    }, [provider, isOpen]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!provider) return;\n        setError(null);\n\n        // Validierung\n        if (!name.trim()) {\n            setError(t('tours.providers.validation.nameRequired', { defaultValue: 'Name ist erforderlich' }));\n            return;\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.put(API_ENDPOINTS.TOUR_PROVIDERS.BY_ID(provider.id), {\n                name: name.trim(),\n                phone: phone.trim() || null,\n                email: email.trim() || null,\n                contactPerson: contactPerson.trim() || null,\n                notes: notes.trim() || null,\n                branchId: branchId ? Number(branchId) : null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tours.providers.updated', { defaultValue: 'Tour-Provider erfolgreich aktualisiert' }),\n                    'success'\n                );\n                onProviderUpdated(response.data.data);\n                handleClose();\n            } else {\n                throw new Error(response.data?.message || t('tours.providers.updateError', { defaultValue: 'Fehler beim Aktualisieren des Providers' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error updating provider:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        onClose();\n    };\n\n    if (!provider) return null;\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.providers.edit', { defaultValue: 'Tour-Provider bearbeiten' })}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.providers.edit', { defaultValue: 'Tour-Provider bearbeiten' })}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default EditTourProviderModal;\n\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PencilIcon, TrashIcon, PlusIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport { TourProvider } from '../../types/tour.ts';\nimport CreateTourProviderModal from './CreateTourProviderModal.tsx';\nimport EditTourProviderModal from './EditTourProviderModal.tsx';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useError } from '../../contexts/ErrorContext.tsx';\n\ninterface TourProvidersTabProps {\n}\n\n// ProviderCard-Komponente fr mobile und Desktop-Ansicht\nconst ProviderCard: React.FC<{\n    provider: TourProvider;\n    onEdit: (provider: TourProvider) => void;\n    onDelete: (providerId: number) => void;\n    canEdit: boolean;\n    canDelete: boolean;\n}> = ({ provider, onEdit, onDelete, canEdit, canDelete }) => {\n    const { t } = useTranslation();\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4\">\n            {/* Header mit Provider-Name und Aktionen */}\n            <div className=\"flex justify-between items-start mb-2\">\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{provider.name}</h3>\n                \n                <div className=\"flex space-x-2\">\n                    {canEdit && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onEdit(provider)}\n                                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                                title={t('common.edit', { defaultValue: 'Bearbeiten' })}\n                            >\n                                <PencilIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.edit', { defaultValue: 'Bearbeiten' })}\n                            </div>\n                        </div>\n                    )}\n                    \n                    {canDelete && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onDelete(provider.id)}\n                                className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n                                title={t('common.delete', { defaultValue: 'Lschen' })}\n                            >\n                                <TrashIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.delete', { defaultValue: 'Lschen' })}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Details */}\n            <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                {provider.contactPerson && (\n                    <p>\n                        <span className=\"font-medium\">{t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}:</span>{' '}\n                        {provider.contactPerson}\n                    </p>\n                )}\n                {provider.phone && (\n                    <p>\n                        <span className=\"font-medium\">{t('tours.providers.phone', { defaultValue: 'Telefon' })}:</span>{' '}\n                        {provider.phone}\n                    </p>\n                )}\n                {provider.email && (\n                    <p>\n                        <span className=\"font-medium\">{t('tours.providers.email', { defaultValue: 'E-Mail' })}:</span>{' '}\n                        {provider.email}\n                    </p>\n                )}\n                {provider.notes && (\n                    <p className=\"mt-2 text-xs\">\n                        <span className=\"font-medium\">{t('tours.providers.notes', { defaultValue: 'Notizen' })}:</span>{' '}\n                        {provider.notes}\n                    </p>\n                )}\n            </div>\n        </div>\n    );\n};\n\nconst TourProvidersTab: React.FC<TourProvidersTabProps> = () => {\n    const { t } = useTranslation();\n    const { showMessage } = useMessage();\n    \n    // Fehlerbehandlung mit Fallback\n    const errorContext = useError();\n    const handleErrorContext = errorContext?.handleError || ((err: unknown, context?: Record<string, unknown>) => {\n        console.error('Error:', err, context);\n        const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                             (err as { message?: string })?.message || \n                             t('errors.unknownError', { defaultValue: 'Ein Fehler ist aufgetreten' });\n        showMessage(errorMessage, 'error');\n    });\n    const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n    const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n    const [editingProvider, setEditingProvider] = useState<TourProvider | null>(null);\n    const [providers, setProviders] = useState<TourProvider[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [searchTerm, setSearchTerm] = useState('');\n    const { hasPermission } = usePermissions();\n\n    // Berechtigungen prfen\n    const canCreate = hasPermission('tour_providers', 'write', 'table');\n    const canEdit = hasPermission('tour_providers', 'write', 'table');\n    const canDelete = hasPermission('tour_providers', 'write', 'table');\n\n    // Providers laden\n    const fetchProviders = useCallback(async () => {\n        setLoading(true);\n        try {\n            const response = await axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS.BASE);\n            const data = response.data?.data || response.data || [];\n            setProviders(Array.isArray(data) ? data : []);\n        } catch (error: unknown) {\n            console.error('Error loading tour providers:', error);\n            handleErrorContext(error);\n            const errorMessage = error.response?.data?.message || t('tours.providers.loadError', { defaultValue: 'Fehler beim Laden der Provider' });\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    }, [handleErrorContext]);\n\n    useEffect(() => {\n        fetchProviders();\n    }, [fetchProviders]);\n\n    // Gefilterte Provider\n    const filteredProviders = providers.filter(provider => {\n        if (!searchTerm) return true;\n        const search = searchTerm.toLowerCase();\n        return (\n            provider.name.toLowerCase().includes(search) ||\n            provider.contactPerson?.toLowerCase().includes(search) ||\n            provider.phone?.toLowerCase().includes(search) ||\n            provider.email?.toLowerCase().includes(search) ||\n            provider.notes?.toLowerCase().includes(search)\n        );\n    });\n\n    // Handler fr Create\n    const handleCreate = () => {\n        setIsCreateModalOpen(true);\n    };\n\n    // Handler fr Edit\n    const handleEdit = (provider: TourProvider) => {\n        setEditingProvider(provider);\n        setIsEditModalOpen(true);\n    };\n\n    // Handler fr Delete\n    const handleDelete = async (providerId: number) => {\n        if (!window.confirm(t('tours.providers.deleteConfirm', { defaultValue: 'Mchten Sie diesen Provider wirklich lschen?' }))) {\n            return;\n        }\n\n        try {\n            await axiosInstance.delete(API_ENDPOINTS.TOUR_PROVIDERS.BY_ID(providerId));\n            showMessage(\n                t('tours.providers.deleted', { defaultValue: 'Tour-Provider erfolgreich gelscht' }),\n                'success'\n            );\n            fetchProviders();\n        } catch (error: any) {\n            console.error('Error deleting provider:', error);\n            handleErrorContext(error);\n            const errorMessage = error.response?.data?.message || t('errors.unknownError');\n            showMessage(errorMessage, 'error');\n        }\n    };\n\n    // Handler fr Provider erstellt\n    const handleProviderCreated = (newProvider: TourProvider) => {\n        fetchProviders();\n    };\n\n    // Handler fr Provider aktualisiert\n    const handleProviderUpdated = (updatedProvider: TourProvider) => {\n        fetchProviders();\n    };\n\n    if (loading) {\n        return (\n            <div className=\"flex justify-center items-center py-12\">\n                <div className=\"text-gray-500 dark:text-gray-400\">{t('common.loading', { defaultValue: 'Lade...' })}</div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"space-y-4\">\n            {/* Header mit Suche und Create-Button */}\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n                <div className=\"flex-1 w-full sm:max-w-md\">\n                    <input\n                        type=\"text\"\n                        placeholder={t('tours.providers.search', { defaultValue: 'Provider suchen...' })}\n                        value={searchTerm}\n                        onChange={(e) => setSearchTerm(e.target.value)}\n                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                </div>\n                {canCreate && (\n                    <div className=\"relative group\">\n                        <button \n                            onClick={handleCreate}\n                            className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                            style={{ width: '30.19px', height: '30.19px' }}\n                            aria-label={t('tours.providers.create', { defaultValue: 'Neuer Provider' })}\n                        >\n                            <PlusIcon className=\"h-4 w-4\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {t('tours.providers.create', { defaultValue: 'Neuer Provider' })}\n                        </div>\n                    </div>\n                )}\n            </div>\n\n            {/* Provider-Liste */}\n            {filteredProviders.length === 0 ? (\n                <div className=\"text-center py-12 text-gray-500 dark:text-gray-400\">\n                    {searchTerm\n                        ? t('tours.providers.noResults', { defaultValue: 'Keine Provider gefunden' })\n                        : t('tours.providers.empty', { defaultValue: 'Keine Tour-Provider vorhanden' })}\n                </div>\n            ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                    {filteredProviders.map(provider => (\n                        <ProviderCard\n                            key={provider.id}\n                            provider={provider}\n                            onEdit={handleEdit}\n                            onDelete={handleDelete}\n                            canEdit={canEdit}\n                            canDelete={canDelete}\n                        />\n                    ))}\n                </div>\n            )}\n\n            {/* Modals */}\n            <CreateTourProviderModal\n                isOpen={isCreateModalOpen}\n                onClose={() => setIsCreateModalOpen(false)}\n                onProviderCreated={handleProviderCreated}\n            />\n            <EditTourProviderModal\n                isOpen={isEditModalOpen}\n                onClose={() => {\n                    setIsEditModalOpen(false);\n                    setEditingProvider(null);\n                }}\n                provider={editingProvider}\n                onProviderUpdated={handleProviderUpdated}\n            />\n        </div>\n    );\n};\n\nexport default TourProvidersTab;\n\n","export enum TourType {\r\n  OWN = 'own',\r\n  EXTERNAL = 'external'\r\n}\r\n\r\nexport enum TourBookingStatus {\r\n  CONFIRMED = 'confirmed',\r\n  CANCELLED = 'cancelled',\r\n  COMPLETED = 'completed',\r\n  NO_SHOW = 'no_show'\r\n}\r\n\r\nexport enum MessageDirection {\r\n  OUTGOING = 'outgoing',\r\n  INCOMING = 'incoming'\r\n}\r\n\r\nexport enum MessageStatus {\r\n  SENT = 'sent',\r\n  DELIVERED = 'delivered',\r\n  READ = 'read',\r\n  FAILED = 'failed'\r\n}\r\n\r\nexport interface Tour {\r\n  id: number;\r\n  title: string;\r\n  description?: string | null;\r\n  type: TourType;\r\n  isActive: boolean;\r\n  duration?: number | null;\r\n  maxParticipants?: number | null;\r\n  minParticipants?: number | null;\r\n  price?: number | string | null;\r\n  currency?: string | null;\r\n  location?: string | null;\r\n  meetingPoint?: string | null;\r\n  includes?: string | null;\r\n  excludes?: string | null;\r\n  requirements?: string | null;\r\n  totalCommission?: number | string | null;\r\n  totalCommissionPercent?: number | string | null;\r\n  sellerCommissionPercent?: number | string | null;\r\n  sellerCommissionFixed?: number | string | null;\r\n  externalProviderId?: number | null;\r\n  externalProvider?: TourProvider | null;\r\n  externalBookingUrl?: string | null;\r\n  imageUrl?: string | null;\r\n  galleryUrls?: string[] | null;\r\n  availableFrom?: string | null;\r\n  availableTo?: string | null;\r\n  recurringSchedule?: any | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  branch?: { id: number; name: string } | null;\r\n  createdById?: number | null;\r\n  createdBy?: { id: number; firstName: string; lastName: string } | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourProvider {\r\n  id: number;\r\n  name: string;\r\n  phone?: string | null;\r\n  email?: string | null;\r\n  contactPerson?: string | null;\r\n  notes?: string | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourBooking {\r\n  id: number;\r\n  tourId: number;\r\n  tour?: Tour | null;\r\n  bookingDate: string;\r\n  tourDate: string;\r\n  numberOfParticipants: number;\r\n  totalPrice: number | string;\r\n  currency: string;\r\n  customerName: string;\r\n  customerEmail?: string | null;\r\n  customerPhone?: string | null;\r\n  customerNotes?: string | null;\r\n  paymentStatus: 'pending' | 'paid' | 'partially_paid' | 'refunded';\r\n  amountPaid?: number | string | null;\r\n  amountPending?: number | string | null;\r\n  paymentLink?: string | null;\r\n  paymentDeadline?: string | null;\r\n  autoCancelEnabled?: boolean;\r\n  reservedUntil?: string | null;\r\n  bookedById?: number | null;\r\n  bookedBy?: { id: number; firstName: string; lastName: string } | null;\r\n  commissionAmount?: number | string | null;\r\n  commissionCalculatedAt?: string | null;\r\n  status: TourBookingStatus;\r\n  cancelledBy?: string | null;\r\n  cancelledAt?: string | null;\r\n  cancelledReason?: string | null;\r\n  isExternal: boolean;\r\n  externalBookingId?: string | null;\r\n  externalStatus?: string | null;\r\n  externalMessage?: string | null;\r\n  alternativeTours?: number[] | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  branch?: { id: number; name: string } | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourReservation {\r\n  id: number;\r\n  tourId: number;\r\n  tour?: Tour | null;\r\n  bookingId: number;\r\n  booking?: TourBooking | null;\r\n  reservationId: number;\r\n  reservation?: any | null;\r\n  tourPrice: number | string;\r\n  accommodationPrice: number | string;\r\n  currency: string;\r\n  tourPricePaid?: number | string | null;\r\n  tourPricePending?: number | string | null;\r\n  accommodationPaid?: number | string | null;\r\n  accommodationPending?: number | string | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourWhatsAppMessage {\r\n  id: number;\r\n  bookingId: number;\r\n  booking?: TourBooking | null;\r\n  direction: MessageDirection;\r\n  message: string;\r\n  phoneNumber: string;\r\n  sentAt: string;\r\n  status: MessageStatus;\r\n  errorMessage?: string | null;\r\n  processed: boolean;\r\n  processedAt?: string | null;\r\n  action?: string | null;\r\n  extractedData?: any | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourType, TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface CreateTourModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTourCreated: (newTour: Tour) => void;\n}\n\nconst CreateTourModal = ({ isOpen, onClose, onTourCreated }: CreateTourModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [title, setTitle] = useState('');\n    const [description, setDescription] = useState('');\n    const [type, setType] = useState<TourType>(TourType.OWN);\n    const [isActive, setIsActive] = useState(true);\n    const [duration, setDuration] = useState<number | ''>('');\n    const [maxParticipants, setMaxParticipants] = useState<number | ''>('');\n    const [minParticipants, setMinParticipants] = useState<number | ''>('');\n    const [price, setPrice] = useState<number | ''>('');\n    const [currency, setCurrency] = useState('COP');\n    const [location, setLocation] = useState('');\n    const [meetingPoint, setMeetingPoint] = useState('');\n    const [includes, setIncludes] = useState('');\n    const [excludes, setExcludes] = useState('');\n    const [requirements, setRequirements] = useState('');\n    const [totalCommission, setTotalCommission] = useState<number | ''>('');\n    const [totalCommissionPercent, setTotalCommissionPercent] = useState<number | ''>('');\n    const [sellerCommissionPercent, setSellerCommissionPercent] = useState<number | ''>('');\n    const [sellerCommissionFixed, setSellerCommissionFixed] = useState<number | ''>('');\n    const [externalProviderId, setExternalProviderId] = useState<number | ''>('');\n    const [externalBookingUrl, setExternalBookingUrl] = useState('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    const [imageFile, setImageFile] = useState<File | null>(null);\n    const [imagePreview, setImagePreview] = useState<string | null>(null);\n    const [galleryFiles, setGalleryFiles] = useState<File[]>([]);\n    const [galleryPreviews, setGalleryPreviews] = useState<string[]>([]);\n    const [uploadingImage, setUploadingImage] = useState(false);\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [tourProviders, setTourProviders] = useState<TourProvider[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches und TourProviders\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const [branchesRes, providersRes] = await Promise.all([\n                    axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE),\n                    axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS?.BASE || '/api/tour-providers')\n                ]);\n                \n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n                setTourProviders(providersRes.data?.data || providersRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Reset form when modal opens/closes\n    useEffect(() => {\n        if (!isOpen) {\n            setTitle('');\n            setDescription('');\n            setType(TourType.OWN);\n            setIsActive(true);\n            setDuration('');\n            setMaxParticipants('');\n            setMinParticipants('');\n            setPrice('');\n            setCurrency('COP');\n            setLocation('');\n            setMeetingPoint('');\n            setIncludes('');\n            setExcludes('');\n            setRequirements('');\n            setTotalCommission('');\n            setTotalCommissionPercent('');\n            setSellerCommissionPercent('');\n            setSellerCommissionFixed('');\n            setExternalProviderId('');\n            setExternalBookingUrl('');\n            setBranchId('');\n            setImageFile(null);\n            setImagePreview(null);\n            setGalleryFiles([]);\n            setGalleryPreviews([]);\n            setError(null);\n        }\n    }, [isOpen]);\n    \n    // Bild-Vorschau erstellen\n    const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (file) {\n            setImageFile(file);\n            const reader = new FileReader();\n            reader.onloadend = () => {\n                setImagePreview(reader.result as string);\n            };\n            reader.readAsDataURL(file);\n        }\n    };\n    \n    const handleGalleryChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const files = Array.from(e.target.files || []);\n        if (files.length > 0) {\n            setGalleryFiles(prev => [...prev, ...files]);\n            files.forEach(file => {\n                const reader = new FileReader();\n                reader.onloadend = () => {\n                    setGalleryPreviews(prev => [...prev, reader.result as string]);\n                };\n                reader.readAsDataURL(file);\n            });\n        }\n    };\n    \n    const removeGalleryImage = (index: number) => {\n        setGalleryFiles(prev => prev.filter((_, i) => i !== index));\n        setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierungen\n        if (!title.trim() || title.trim().length < 3) {\n            setError(t('tours.validation.titleMinLength', { defaultValue: 'Titel muss mindestens 3 Zeichen lang sein' }));\n            return;\n        }\n\n        const maxPart = maxParticipants ? Number(maxParticipants) : null;\n        const minPart = minParticipants ? Number(minParticipants) : null;\n        if (maxPart !== null && minPart !== null && maxPart < minPart) {\n            setError(t('tours.validation.maxParticipantsMin', { defaultValue: 'Maximale Teilnehmeranzahl muss >= minimale Teilnehmeranzahl sein' }));\n            return;\n        }\n\n        if (type === TourType.EXTERNAL && !externalProviderId) {\n            setError(t('tours.validation.externalProviderRequired', { defaultValue: 'Externer Anbieter ist bei externen Touren erforderlich' }));\n            return;\n        }\n\n        // availableFrom <= availableTo Validierung (falls beide gesetzt) - wird im Backend validiert\n\n        // Preise >= 0\n        if (price !== '' && Number(price) < 0) {\n            setError(t('tours.validation.priceNonNegative', { defaultValue: 'Preis muss >= 0 sein' }));\n            return;\n        }\n\n        if (totalCommission !== '' && Number(totalCommission) < 0) {\n            setError(t('tours.validation.commissionNonNegative', { defaultValue: 'Kommission muss >= 0 sein' }));\n            return;\n        }\n\n        setLoading(true);\n\n        try {\n            const tourData: {\n                title: string;\n                description: string | null;\n                type: TourType;\n                isActive: boolean;\n                duration: number | null;\n                maxParticipants: number | null;\n                minParticipants: number | null;\n                price: number | null;\n                currency: string;\n                location: string | null;\n                meetingPoint: string | null;\n                includes: string | null;\n                excludes: string | null;\n                requirements: string | null;\n                totalCommission: number | null;\n                totalCommissionPercent: number | null;\n                sellerCommissionPercent: number | null;\n                sellerCommissionFixed: number | null;\n                externalProviderId: number | null;\n                externalBookingUrl: string | null;\n                branchId: number | null;\n            } = {\n                title,\n                description: description || null,\n                type,\n                isActive,\n                duration: duration ? Number(duration) : null,\n                maxParticipants: maxParticipants ? Number(maxParticipants) : null,\n                minParticipants: minParticipants ? Number(minParticipants) : null,\n                price: price ? Number(price) : null,\n                currency: currency || 'COP',\n                location: location || null,\n                meetingPoint: meetingPoint || null,\n                includes: includes || null,\n                excludes: excludes || null,\n                requirements: requirements || null,\n                totalCommission: totalCommission ? Number(totalCommission) : null,\n                totalCommissionPercent: totalCommissionPercent ? Number(totalCommissionPercent) : null,\n                sellerCommissionPercent: sellerCommissionPercent ? Number(sellerCommissionPercent) : null,\n                sellerCommissionFixed: sellerCommissionFixed ? Number(sellerCommissionFixed) : null,\n                externalProviderId: externalProviderId ? Number(externalProviderId) : null,\n                externalBookingUrl: externalBookingUrl || null,\n                branchId: branchId ? Number(branchId) : null\n            };\n\n            const response = await axiosInstance.post(API_ENDPOINTS.TOURS.BASE, tourData);\n            \n            if (response.data.success) {\n                const createdTour = response.data.data;\n                \n                // Hauptbild hochladen (falls vorhanden)\n                if (imageFile && createdTour.id) {\n                    try {\n                        setUploadingImage(true);\n                        const formData = new FormData();\n                        formData.append('image', imageFile);\n                        await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_IMAGE(createdTour.id), formData, {\n                            headers: { 'Content-Type': 'multipart/form-data' }\n                        });\n                    } catch (imgErr: unknown) {\n                        console.error('Error uploading main image:', imgErr);\n                        showMessage(t('tours.imageUploadError', 'Tour erstellt, aber Fehler beim Hochladen des Bildes'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                // Galerie-Bilder hochladen (falls vorhanden)\n                if (galleryFiles.length > 0 && createdTour.id) {\n                    try {\n                        setUploadingImage(true);\n                        for (const file of galleryFiles) {\n                            const formData = new FormData();\n                            formData.append('image', file);\n                            await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_GALLERY(createdTour.id), formData, {\n                                headers: { 'Content-Type': 'multipart/form-data' }\n                            });\n                        }\n                    } catch (galleryErr: unknown) {\n                        console.error('Error uploading gallery images:', galleryErr);\n                        showMessage(t('tours.galleryUploadError', 'Tour erstellt, aber Fehler beim Hochladen der Galerie-Bilder'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                showMessage(t('tours.createSuccess', 'Tour erfolgreich erstellt'), 'success');\n                // Lade Tour neu, um Bilder zu erhalten\n                const updatedResponse = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(createdTour.id));\n                onTourCreated(updatedResponse.data.data);\n                handleClose();\n            } else {\n                setError(response.data.message || t('errors.saveError'));\n            }\n        } catch (err: unknown) {\n            console.error('Error creating tour:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.saveError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        setTitle('');\n        setDescription('');\n        setType(TourType.OWN);\n        setIsActive(true);\n        setDuration('');\n        setMaxParticipants('');\n        setMinParticipants('');\n        setPrice('');\n        setCurrency('COP');\n        setLocation('');\n        setMeetingPoint('');\n        setIncludes('');\n        setExcludes('');\n        setRequirements('');\n        setTotalCommission('');\n        setTotalCommissionPercent('');\n        setSellerCommissionPercent('');\n        setSellerCommissionFixed('');\n        setExternalProviderId('');\n        setExternalBookingUrl('');\n        setBranchId('');\n        setImageFile(null);\n        setImagePreview(null);\n        setGalleryFiles([]);\n        setGalleryPreviews([]);\n        setError(null);\n        onClose();\n    };\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\n                        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.create', 'Neue Tour erstellen')}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.create', 'Neue Tour erstellen')}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Bilder */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.images', 'Bilder')}\n                            </h3>\n                            \n                            {/* Hauptbild */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.mainImage', 'Hauptbild')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    onChange={handleImageChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {imagePreview && (\n                                    <div className=\"mt-2 relative inline-block\">\n                                        <img\n                                            src={imagePreview}\n                                            alt=\"Vorschau\"\n                                            className=\"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                        />\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* Galerie */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.gallery', 'Galerie')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    multiple\n                                    onChange={handleGalleryChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {galleryPreviews.length > 0 && (\n                                    <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                                        {galleryPreviews.map((preview, index) => (\n                                            <div key={index} className=\"relative\">\n                                                <img\n                                                    src={preview}\n                                                    alt={`Galerie ${index + 1}`}\n                                                    className=\"w-full h-24 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                                />\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={() => removeGalleryImage(index)}\n                                                    className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                    title={t('tours.deleteImage', 'Bild lschen')}\n                                                >\n                                                    <XMarkIcon className=\"h-4 w-4\" />\n                                                </button>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default CreateTourModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS, getTourImageUrl, getTourGalleryImageUrl } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourType, TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface EditTourModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTourUpdated: (updatedTour: Tour) => void;\n    tour: Tour | null;\n}\n\nconst EditTourModal = ({ isOpen, onClose, onTourUpdated, tour }: EditTourModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [title, setTitle] = useState(tour?.title || '');\n    const [description, setDescription] = useState(tour?.description || '');\n    const [type, setType] = useState<TourType>(tour?.type || TourType.OWN);\n    const [isActive, setIsActive] = useState(tour?.isActive ?? true);\n    const [duration, setDuration] = useState<number | ''>(tour?.duration || '');\n    const [maxParticipants, setMaxParticipants] = useState<number | ''>(tour?.maxParticipants || '');\n    const [minParticipants, setMinParticipants] = useState<number | ''>(tour?.minParticipants || '');\n    const [price, setPrice] = useState<number | ''>(tour?.price ? (typeof tour.price === 'string' ? parseFloat(tour.price) : tour.price) : '');\n    const [currency, setCurrency] = useState(tour?.currency || 'COP');\n    const [location, setLocation] = useState(tour?.location || '');\n    const [meetingPoint, setMeetingPoint] = useState(tour?.meetingPoint || '');\n    const [includes, setIncludes] = useState(tour?.includes || '');\n    const [excludes, setExcludes] = useState(tour?.excludes || '');\n    const [requirements, setRequirements] = useState(tour?.requirements || '');\n    const [totalCommission, setTotalCommission] = useState<number | ''>(tour?.totalCommission ? (typeof tour.totalCommission === 'string' ? parseFloat(tour.totalCommission) : tour.totalCommission) : '');\n    const [totalCommissionPercent, setTotalCommissionPercent] = useState<number | ''>(tour?.totalCommissionPercent ? (typeof tour.totalCommissionPercent === 'string' ? parseFloat(tour.totalCommissionPercent) : tour.totalCommissionPercent) : '');\n    const [sellerCommissionPercent, setSellerCommissionPercent] = useState<number | ''>(tour?.sellerCommissionPercent ? (typeof tour.sellerCommissionPercent === 'string' ? parseFloat(tour.sellerCommissionPercent) : tour.sellerCommissionPercent) : '');\n    const [sellerCommissionFixed, setSellerCommissionFixed] = useState<number | ''>(tour?.sellerCommissionFixed ? (typeof tour.sellerCommissionFixed === 'string' ? parseFloat(tour.sellerCommissionFixed) : tour.sellerCommissionFixed) : '');\n    const [externalProviderId, setExternalProviderId] = useState<number | ''>(tour?.externalProviderId || '');\n    const [externalBookingUrl, setExternalBookingUrl] = useState(tour?.externalBookingUrl || '');\n    const [branchId, setBranchId] = useState<number | ''>(tour?.branchId || '');\n    const [imageFile, setImageFile] = useState<File | null>(null);\n    const [imagePreview, setImagePreview] = useState<string | null>(tour?.imageUrl ? getTourImageUrl(tour.id) : null);\n    const [galleryFiles, setGalleryFiles] = useState<File[]>([]);\n    const [galleryPreviews, setGalleryPreviews] = useState<string[]>(tour?.galleryUrls?.map((url, index) => getTourGalleryImageUrl(tour.id, index)) || []);\n    const [uploadingImage, setUploadingImage] = useState(false);\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [tourProviders, setTourProviders] = useState<TourProvider[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches und TourProviders\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const [branchesRes, providersRes] = await Promise.all([\n                    axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE),\n                    axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS?.BASE || '/api/tour-providers')\n                ]);\n                \n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n                setTourProviders(providersRes.data?.data || providersRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Update form when tour changes\n    useEffect(() => {\n        if (tour) {\n            setTitle(tour.title || '');\n            setDescription(tour.description || '');\n            setType(tour.type || TourType.OWN);\n            setIsActive(tour.isActive ?? true);\n            setDuration(tour.duration || '');\n            setMaxParticipants(tour.maxParticipants || '');\n            setMinParticipants(tour.minParticipants || '');\n            setPrice(tour.price ? (typeof tour.price === 'string' ? parseFloat(tour.price) : tour.price) : '');\n            setCurrency(tour.currency || 'COP');\n            setLocation(tour.location || '');\n            setMeetingPoint(tour.meetingPoint || '');\n            setIncludes(tour.includes || '');\n            setExcludes(tour.excludes || '');\n            setRequirements(tour.requirements || '');\n            setTotalCommission(tour.totalCommission ? (typeof tour.totalCommission === 'string' ? parseFloat(tour.totalCommission) : tour.totalCommission) : '');\n            setTotalCommissionPercent(tour.totalCommissionPercent ? (typeof tour.totalCommissionPercent === 'string' ? parseFloat(tour.totalCommissionPercent) : tour.totalCommissionPercent) : '');\n            setSellerCommissionPercent(tour.sellerCommissionPercent ? (typeof tour.sellerCommissionPercent === 'string' ? parseFloat(tour.sellerCommissionPercent) : tour.sellerCommissionPercent) : '');\n            setSellerCommissionFixed(tour.sellerCommissionFixed ? (typeof tour.sellerCommissionFixed === 'string' ? parseFloat(tour.sellerCommissionFixed) : tour.sellerCommissionFixed) : '');\n            setExternalProviderId(tour.externalProviderId || '');\n            setExternalBookingUrl(tour.externalBookingUrl || '');\n            setBranchId(tour.branchId || '');\n            setImagePreview(tour.imageUrl ? getTourImageUrl(tour.id) : null);\n            setGalleryPreviews(tour.galleryUrls?.map((url, index) => getTourGalleryImageUrl(tour.id, index)) || []);\n        }\n    }, [tour]);\n    \n    // Bild-Vorschau erstellen\n    const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (file) {\n            setImageFile(file);\n            const reader = new FileReader();\n            reader.onloadend = () => {\n                setImagePreview(reader.result as string);\n            };\n            reader.readAsDataURL(file);\n        }\n    };\n    \n    const handleGalleryChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const files = Array.from(e.target.files || []);\n        if (files.length > 0) {\n            setGalleryFiles(prev => [...prev, ...files]);\n            files.forEach(file => {\n                const reader = new FileReader();\n                reader.onloadend = () => {\n                    setGalleryPreviews(prev => [...prev, reader.result as string]);\n                };\n                reader.readAsDataURL(file);\n            });\n        }\n    };\n    \n    const removeMainImage = async () => {\n        if (!tour?.imageUrl) return;\n        \n        try {\n            await axiosInstance.delete(API_ENDPOINTS.TOURS.DELETE_IMAGE(tour.id));\n            // Sofort lokale States aktualisieren (UI-Update)\n            setImagePreview(null);\n            setImageFile(null);\n            // Lade Tour neu fr Datenbank-Sync\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tour.id));\n            if (response.data.success) {\n                onTourUpdated(response.data.data);\n                showMessage(t('tours.imageDeleted', 'Hauptbild erfolgreich gelscht'), 'success');\n            }\n        } catch (err: unknown) {\n            console.error('Error deleting main image:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.deleteError');\n            showMessage(errorMessage, 'error');\n        }\n    };\n    \n    const removeGalleryImage = async (index: number) => {\n        if (!tour) return;\n        // Wenn es ein existierendes Bild ist (aus tour.galleryUrls), lsche es vom Server\n        const currentGallery = tour.galleryUrls || [];\n        if (index < currentGallery.length) {\n            try {\n                await axiosInstance.delete(API_ENDPOINTS.TOURS.DELETE_GALLERY_IMAGE(tour.id, index));\n                // Sofort lokale States aktualisieren (UI-Update)\n                setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\n                // Lade Tour neu fr Datenbank-Sync\n                const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tour.id));\n                if (response.data.success) {\n                    onTourUpdated(response.data.data);\n                    showMessage(t('tours.galleryImageDeleted', 'Galerie-Bild erfolgreich gelscht'), 'success');\n                }\n            } catch (err: unknown) {\n                console.error('Error deleting gallery image:', err);\n                const errorMessage = (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.deleteError');\n                showMessage(errorMessage, 'error');\n            }\n        } else {\n            // Wenn es ein neues Bild ist (noch nicht hochgeladen), entferne es nur aus dem State\n            const newIndex = index - currentGallery.length;\n            setGalleryFiles(prev => prev.filter((_, i) => i !== newIndex));\n            setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\n        }\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierungen\n        if (!title.trim() || title.trim().length < 3) {\n            setError(t('tours.validation.titleMinLength', { defaultValue: 'Titel muss mindestens 3 Zeichen lang sein' }));\n            return;\n        }\n\n        const maxPart = maxParticipants ? Number(maxParticipants) : null;\n        const minPart = minParticipants ? Number(minParticipants) : null;\n        if (maxPart !== null && minPart !== null && maxPart < minPart) {\n            setError(t('tours.validation.maxParticipantsMin', { defaultValue: 'Maximale Teilnehmeranzahl muss >= minimale Teilnehmeranzahl sein' }));\n            return;\n        }\n\n        if (type === TourType.EXTERNAL && !externalProviderId) {\n            setError(t('tours.validation.externalProviderRequired', { defaultValue: 'Externer Anbieter ist bei externen Touren erforderlich' }));\n            return;\n        }\n\n        // Preise >= 0\n        if (price !== '' && Number(price) < 0) {\n            setError(t('tours.validation.priceNonNegative', { defaultValue: 'Preis muss >= 0 sein' }));\n            return;\n        }\n\n        if (totalCommission !== '' && Number(totalCommission) < 0) {\n            setError(t('tours.validation.commissionNonNegative', { defaultValue: 'Kommission muss >= 0 sein' }));\n            return;\n        }\n\n        setLoading(true);\n\n        try {\n            const tourData: Partial<Tour> & {\n                imageFile?: File | null;\n                galleryFiles?: File[];\n            } = {\n                title,\n                description: description || null,\n                type,\n                isActive,\n                duration: duration ? Number(duration) : null,\n                maxParticipants: maxParticipants ? Number(maxParticipants) : null,\n                minParticipants: minParticipants ? Number(minParticipants) : null,\n                price: price ? Number(price) : null,\n                currency: currency || 'COP',\n                location: location || null,\n                meetingPoint: meetingPoint || null,\n                includes: includes || null,\n                excludes: excludes || null,\n                requirements: requirements || null,\n                totalCommission: totalCommission ? Number(totalCommission) : null,\n                totalCommissionPercent: totalCommissionPercent ? Number(totalCommissionPercent) : null,\n                sellerCommissionPercent: sellerCommissionPercent ? Number(sellerCommissionPercent) : null,\n                sellerCommissionFixed: sellerCommissionFixed ? Number(sellerCommissionFixed) : null,\n                externalProviderId: externalProviderId ? Number(externalProviderId) : null,\n                externalBookingUrl: externalBookingUrl || null,\n                branchId: branchId ? Number(branchId) : null\n            };\n\n            const response = await axiosInstance.put(API_ENDPOINTS.TOURS.BY_ID(tour.id), tourData);\n            \n            if (response.data.success) {\n                const updatedTour = response.data.data;\n                \n                // Hauptbild hochladen (falls gendert)\n                if (imageFile) {\n                    try {\n                        setUploadingImage(true);\n                        const formData = new FormData();\n                        formData.append('image', imageFile);\n                        await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_IMAGE(tourId), formData, {\n                            headers: { 'Content-Type': 'multipart/form-data' }\n                        });\n                    } catch (imgErr: unknown) {\n                        console.error('Error uploading main image:', imgErr);\n                        showMessage(t('tours.imageUploadError', 'Tour aktualisiert, aber Fehler beim Hochladen des Bildes'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                // Neue Galerie-Bilder hochladen (falls vorhanden)\n                if (galleryFiles.length > 0) {\n                    try {\n                        setUploadingImage(true);\n                        for (const file of galleryFiles) {\n                            const formData = new FormData();\n                            formData.append('image', file);\n                            await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_GALLERY(tourId), formData, {\n                                headers: { 'Content-Type': 'multipart/form-data' }\n                            });\n                        }\n                    } catch (galleryErr: unknown) {\n                        console.error('Error uploading gallery images:', galleryErr);\n                        showMessage(t('tours.galleryUploadError', 'Tour aktualisiert, aber Fehler beim Hochladen der Galerie-Bilder'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                showMessage(t('tours.updateSuccess', 'Tour erfolgreich aktualisiert'), 'success');\n                // Lade Tour neu, um aktualisierte Bilder zu erhalten\n                const updatedResponse = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tourId));\n                onTourUpdated(updatedResponse.data.data);\n                handleClose();\n            } else {\n                setError(response.data.message || t('errors.saveError'));\n            }\n        } catch (err: unknown) {\n            console.error('Error updating tour:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.saveError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        onClose();\n    };\n\n    if (!tour) return null;\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\n                        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.edit', 'Tour bearbeiten')}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Bild-Upload */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.images', 'Bilder')}\n                            </h3>\n                            \n                            {/* Hauptbild */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.mainImage', 'Hauptbild')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    onChange={handleImageChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {imagePreview && (\n                                    <div className=\"mt-2 relative inline-block\">\n                                        <img\n                                            src={imagePreview}\n                                            alt=\"Vorschau\"\n                                            className=\"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                        />\n                                        {tour?.imageUrl && (\n                                            <button\n                                                type=\"button\"\n                                                onClick={removeMainImage}\n                                                className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                title={t('tours.deleteImage', 'Hauptbild lschen')}\n                                            >\n                                                <XMarkIcon className=\"h-4 w-4\" />\n                                            </button>\n                                        )}\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* Galerie */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.gallery', 'Galerie')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    multiple\n                                    onChange={handleGalleryChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {galleryPreviews.length > 0 && (\n                                    <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                                        {galleryPreviews.map((preview, index) => (\n                                            <div key={index} className=\"relative\">\n                                                <img\n                                                    src={preview}\n                                                    alt={`Galerie ${index + 1}`}\n                                                    className=\"w-full h-32 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                                />\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={() => removeGalleryImage(index)}\n                                                    className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600\"\n                                                >\n                                                    <XMarkIcon className=\"h-4 w-4\" />\n                                                </button>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData || uploadingImage}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.edit', 'Tour bearbeiten')}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Bilder */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.images', 'Bilder')}\n                            </h3>\n                            \n                            {/* Hauptbild */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.mainImage', 'Hauptbild')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    onChange={handleImageChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {imagePreview && (\n                                    <div className=\"mt-2 relative inline-block\">\n                                        <img\n                                            src={imagePreview}\n                                            alt=\"Vorschau\"\n                                            className=\"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                        />\n                                        {tour?.imageUrl && (\n                                            <button\n                                                type=\"button\"\n                                                onClick={removeMainImage}\n                                                className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                title={t('tours.deleteImage', 'Hauptbild lschen')}\n                                            >\n                                                <XMarkIcon className=\"h-4 w-4\" />\n                                            </button>\n                                        )}\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* Galerie */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.gallery', 'Galerie')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    multiple\n                                    onChange={handleGalleryChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {galleryPreviews.length > 0 && (\n                                    <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                                        {galleryPreviews.map((preview, index) => (\n                                            <div key={index} className=\"relative\">\n                                                <img\n                                                    src={preview}\n                                                    alt={`Galerie ${index + 1}`}\n                                                    className=\"w-full h-24 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                                />\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={() => removeGalleryImage(index)}\n                                                    className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                    title={t('tours.deleteImage', 'Bild lschen')}\n                                                >\n                                                    <XMarkIcon className=\"h-4 w-4\" />\n                                                </button>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData || uploadingImage}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default EditTourModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, MapPinIcon, ClockIcon, UsersIcon, CurrencyDollarIcon, BuildingOfficeIcon, UserIcon, PlusIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { Tour, TourType, TourBooking } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport CreateTourBookingModal from './CreateTourBookingModal.tsx';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\n\ninterface TourDetailsModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    tourId: number;\n    onTourUpdated?: (updatedTour: Tour) => void;\n}\n\nconst TourDetailsModal = ({ isOpen, onClose, tourId, onTourUpdated }: TourDetailsModalProps) => {\n    const { t } = useTranslation();\n    const { showMessage } = useMessage();\n    const { hasPermission } = usePermissions();\n    const [tour, setTour] = useState<Tour | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n    const [isCreateBookingModalOpen, setIsCreateBookingModalOpen] = useState(false);\n\n    useEffect(() => {\n        if (isOpen && tourId) {\n            loadTour();\n        }\n    }, [isOpen, tourId]);\n\n    const loadTour = async () => {\n        try {\n            setLoading(true);\n            setError(null);\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tourId));\n            if (response.data.success) {\n                setTour(response.data.data);\n            } else {\n                setError(response.data.message || t('errors.loadError'));\n            }\n        } catch (err: unknown) {\n            console.error('Error loading tour:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.loadError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                            {t('tours.details', 'Tour-Details')}\n                        </Dialog.Title>\n                        <div className=\"flex items-center gap-3\">\n                            {hasPermission('tour_bookings', 'write', 'table') && tour && tour.isActive && (\n                                <div className=\"relative group\">\n                                    <button\n                                        onClick={() => setIsCreateBookingModalOpen(true)}\n                                        className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                        style={{ width: '30.19px', height: '30.19px' }}\n                                        aria-label={t('tourBookings.create', 'Buchung erstellen')}\n                                    >\n                                        <PlusIcon className=\"h-4 w-4\" />\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tourBookings.create', 'Buchung erstellen')}\n                                    </div>\n                                </div>\n                            )}\n                            <button\n                                onClick={onClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n                    </div>\n\n                    <div className=\"p-6\">\n                        {loading ? (\n                            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                                {t('common.loading')}\n                            </div>\n                        ) : error ? (\n                            <div className=\"text-center py-8 text-red-500 dark:text-red-400\">\n                                {error}\n                            </div>\n                        ) : !tour ? (\n                            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                                {t('tours.notFound', 'Tour nicht gefunden')}\n                            </div>\n                        ) : (\n                            <div className=\"space-y-6\">\n                                {/* Header */}\n                                <div>\n                                    <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\n                                        {tour.title || '-'}\n                                    </h2>\n                                    <div className=\"flex items-center gap-2\">\n                                        <span className={`px-3 py-1 text-sm rounded-full ${\n                                            tour.type === TourType.OWN\n                                                ? 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200'\n                                                : 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200'\n                                        }`}>\n                                            {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                        </span>\n                                        <span className={`px-3 py-1 text-sm rounded-full ${\n                                            tour.isActive\n                                                ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'\n                                                : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                        }`}>\n                                            {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                        </span>\n                                    </div>\n                                </div>\n\n                                {/* Beschreibung */}\n                                {tour.description && (\n                                    <div>\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\n                                            {t('tours.description')}\n                                        </h3>\n                                        <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                            {tour.description}\n                                        </p>\n                                    </div>\n                                )}\n\n                                {/* Tour-Details Grid */}\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                                    {/* Linke Spalte */}\n                                    <div className=\"space-y-4\">\n                                        {tour.duration && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <ClockIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.duration')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.duration} {t('common.hours', 'h')}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {(tour.minParticipants || tour.maxParticipants) && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <UsersIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.participants', 'Teilnehmer')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.minParticipants && tour.maxParticipants\n                                                            ? `${tour.minParticipants} - ${tour.maxParticipants}`\n                                                            : tour.minParticipants\n                                                            ? `${tour.minParticipants}+`\n                                                            : tour.maxParticipants\n                                                            ? `bis ${tour.maxParticipants}`\n                                                            : '-'}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.price && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <CurrencyDollarIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.price')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white font-semibold\">\n                                                        {Number(tour.price).toLocaleString()} {tour.currency || 'COP'}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.location && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <MapPinIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.location')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.location}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.meetingPoint && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <MapPinIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.meetingPoint')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.meetingPoint}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n                                    </div>\n\n                                    {/* Rechte Spalte */}\n                                    <div className=\"space-y-4\">\n                                        {tour.branch && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <BuildingOfficeIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.branch')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.branch.name}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.createdBy && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <UserIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.columns.createdBy')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.createdBy.firstName} {tour.createdBy.lastName}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.createdAt && (\n                                            <div>\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                    {t('common.createdAt', 'Erstellt am')}\n                                                </div>\n                                                <div className=\"text-gray-900 dark:text-white\">\n                                                    {format(new Date(tour.createdAt), 'dd.MM.yyyy HH:mm', { locale: de })}\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.externalProvider && (\n                                            <div>\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                    {t('tours.externalProvider')}\n                                                </div>\n                                                <div className=\"text-gray-900 dark:text-white\">\n                                                    {tour.externalProvider.name}\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.externalBookingUrl && (\n                                            <div>\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                    {t('tours.externalBookingUrl')}\n                                                </div>\n                                                <a\n                                                    href={tour.externalBookingUrl}\n                                                    target=\"_blank\"\n                                                    rel=\"noopener noreferrer\"\n                                                    className=\"text-blue-600 dark:text-blue-400 hover:underline\"\n                                                >\n                                                    {tour.externalBookingUrl}\n                                                </a>\n                                            </div>\n                                        )}\n                                    </div>\n                                </div>\n\n                                {/* Kommissionen */}\n                                {(tour.totalCommission || tour.totalCommissionPercent || tour.sellerCommissionPercent || tour.sellerCommissionFixed) && (\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                                            {t('tours.commissions')}\n                                        </h3>\n                                        <div className=\"grid grid-cols-2 gap-4\">\n                                            {tour.totalCommission && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.totalCommission')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.totalCommission).toLocaleString()} {tour.currency || 'COP'}\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.totalCommissionPercent && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.totalCommissionPercent')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.totalCommissionPercent)}%\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.sellerCommissionPercent && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.sellerCommissionPercent')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.sellerCommissionPercent)}%\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.sellerCommissionFixed && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.sellerCommissionFixed')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.sellerCommissionFixed).toLocaleString()} {tour.currency || 'COP'}\n                                                    </div>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n\n                                {/* Zustzliche Informationen */}\n                                {(tour.includes || tour.excludes || tour.requirements) && (\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                                            {t('tours.additionalInfo')}\n                                        </h3>\n                                        <div className=\"space-y-4\">\n                                            {tour.includes && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                                        {t('tours.includes')}\n                                                    </div>\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                                        {tour.includes}\n                                                    </p>\n                                                </div>\n                                            )}\n                                            {tour.excludes && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                                        {t('tours.excludes')}\n                                                    </div>\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                                        {tour.excludes}\n                                                    </p>\n                                                </div>\n                                            )}\n                                            {tour.requirements && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                                        {t('tours.requirements')}\n                                                    </div>\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                                        {tour.requirements}\n                                                    </p>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n\n                                {/* Verfgbarkeit */}\n                                {(tour.availableFrom || tour.availableTo) && (\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                                            {t('tours.availability', 'Verfgbarkeit')}\n                                        </h3>\n                                        <div className=\"grid grid-cols-2 gap-4\">\n                                            {tour.availableFrom && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.availableFrom', 'Verfgbar ab')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {format(new Date(tour.availableFrom), 'dd.MM.yyyy', { locale: de })}\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.availableTo && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.availableTo', 'Verfgbar bis')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {format(new Date(tour.availableTo), 'dd.MM.yyyy', { locale: de })}\n                                                    </div>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n                        )}\n                    </div>\n\n                    <div className=\"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700\">\n                        <button\n                            onClick={onClose}\n                            className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\n                        >\n                            {t('common.close', 'Schlieen')}\n                        </button>\n                    </div>\n                </Dialog.Panel>\n            </div>\n            \n            {/* Create Tour Booking Modal */}\n            {tour && (\n                <CreateTourBookingModal\n                    isOpen={isCreateBookingModalOpen}\n                    onClose={() => setIsCreateBookingModalOpen(false)}\n                    tour={tour}\n                    onBookingCreated={async (newBooking: TourBooking) => {\n                        showMessage(\n                            t('tourBookings.created', { defaultValue: 'Tour-Buchung erfolgreich erstellt' }),\n                            'success'\n                        );\n                        setIsCreateBookingModalOpen(false);\n                    }}\n                />\n            )}\n        </Dialog>\n    );\n};\n\nexport default TourDetailsModal;\n\n","import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ArrowDownTrayIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../../config/axios.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { Tour } from '../../types/tour.ts';\n\ninterface TourExportDialogProps {\n    isOpen: boolean;\n    onClose: () => void;\n    tourCount: number;\n}\n\nconst TourExportDialog = ({ isOpen, onClose, tourCount }: TourExportDialogProps) => {\n    const { t } = useTranslation();\n    const { showMessage } = useMessage();\n    \n    const [selectedFields, setSelectedFields] = useState<string[]>([\n        'id', 'title', 'description', 'type', 'price', 'currency', 'duration',\n        'maxParticipants', 'minParticipants', 'location', 'meetingPoint',\n        'imageUrl', 'galleryUrls', 'availableFrom', 'availableTo'\n    ]);\n    const [exporting, setExporting] = useState(false);\n    const [format, setFormat] = useState<'json' | 'csv'>('json');\n\n    const availableFields = [\n        { id: 'id', label: t('tours.columns.title', 'Titel') },\n        { id: 'title', label: t('tours.name', 'Titel') },\n        { id: 'description', label: t('tours.description', 'Beschreibung') },\n        { id: 'type', label: t('tours.type', 'Typ') },\n        { id: 'price', label: t('tours.price', 'Preis') },\n        { id: 'currency', label: t('tours.currency', 'Whrung') },\n        { id: 'duration', label: t('tours.duration', 'Dauer') },\n        { id: 'maxParticipants', label: t('tours.maxParticipants', 'Max. Teilnehmer') },\n        { id: 'minParticipants', label: t('tours.minParticipants', 'Min. Teilnehmer') },\n        { id: 'location', label: t('tours.location', 'Ort') },\n        { id: 'meetingPoint', label: t('tours.meetingPoint', 'Treffpunkt') },\n        { id: 'includes', label: t('tours.includes', 'Enthlt') },\n        { id: 'excludes', label: t('tours.excludes', 'Nicht enthalten') },\n        { id: 'requirements', label: t('tours.requirements', 'Anforderungen') },\n        { id: 'imageUrl', label: t('tours.mainImage', 'Hauptbild') },\n        { id: 'galleryUrls', label: t('tours.gallery', 'Galerie') },\n        { id: 'availableFrom', label: t('tours.availableFrom', 'Verfgbar ab') },\n        { id: 'availableTo', label: t('tours.availableTo', 'Verfgbar bis') },\n        { id: 'externalBookingUrl', label: t('tours.externalBookingUrl', 'Externe Buchungs-URL') },\n        { id: 'branch', label: t('tours.branch', 'Niederlassung') },\n        { id: 'externalProvider', label: t('tours.externalProvider', 'Externer Anbieter') }\n    ];\n\n    const toggleField = (fieldId: string) => {\n        setSelectedFields(prev =>\n            prev.includes(fieldId)\n                ? prev.filter(f => f !== fieldId)\n                : [...prev, fieldId]\n        );\n    };\n\n    const selectAll = () => {\n        setSelectedFields(availableFields.map(f => f.id));\n    };\n\n    const deselectAll = () => {\n        setSelectedFields([]);\n    };\n\n    const handleExport = async () => {\n        if (selectedFields.length === 0) {\n            showMessage(t('tours.export.noFieldsSelected', 'Bitte whlen Sie mindestens ein Feld aus'), 'error');\n            return;\n        }\n\n        setExporting(true);\n        try {\n            const fieldsParam = selectedFields.join(',');\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.EXPORT, {\n                params: { fields: fieldsParam }\n            });\n\n            const tours = response.data.tours || response.data;\n\n            if (format === 'json') {\n                // JSON-Export\n                const blob = new Blob([JSON.stringify(tours, null, 2)], { type: 'application/json' });\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = `tours-export-${new Date().toISOString().split('T')[0]}.json`;\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                window.URL.revokeObjectURL(url);\n            } else {\n                // CSV-Export\n                if (!Array.isArray(tours) || tours.length === 0) {\n                    showMessage(t('tours.export.noData', 'Keine Daten zum Exportieren'), 'warning');\n                    return;\n                }\n\n                // CSV-Header\n                const headers = selectedFields.map(fieldId => {\n                    const field = availableFields.find(f => f.id === fieldId);\n                    return field?.label || fieldId;\n                });\n\n                // CSV-Rows\n                const rows = tours.map((tour: Tour) => {\n                    return selectedFields.map(fieldId => {\n                        let value = tour[fieldId];\n                        if (value === null || value === undefined) return '';\n                        if (typeof value === 'object') {\n                            if (fieldId === 'branch') return value?.name || '';\n                            if (fieldId === 'externalProvider') return value?.name || '';\n                            if (fieldId === 'galleryUrls' && Array.isArray(value)) return value.join('; ');\n                            return JSON.stringify(value);\n                        }\n                        if (typeof value === 'boolean') return value ? 'Ja' : 'Nein';\n                        return String(value);\n                    });\n                });\n\n                // CSV-String erstellen\n                const csvContent = [\n                    headers.join(','),\n                    ...rows.map(row => row.map(cell => `\"${String(cell).replace(/\"/g, '\"\"')}\"`).join(','))\n                ].join('\\n');\n\n                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = `tours-export-${new Date().toISOString().split('T')[0]}.csv`;\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                window.URL.revokeObjectURL(url);\n            }\n\n            showMessage(t('tours.export.success', 'Export erfolgreich'), 'success');\n            onClose();\n        } catch (err: unknown) {\n            console.error('Error exporting:', err);\n            showMessage(err.response?.data?.message || t('tours.export.error', 'Fehler beim Exportieren'), 'error');\n        } finally {\n            setExporting(false);\n        }\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                            {t('tours.export.title', 'Touren exportieren')} ({tourCount})\n                        </Dialog.Title>\n                        <button\n                            onClick={onClose}\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                        >\n                            <XMarkIcon className=\"h-6 w-6\" />\n                        </button>\n                    </div>\n\n                    <div className=\"p-6 space-y-6\">\n                        {/* Format-Auswahl */}\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                {t('tours.export.format', 'Export-Format')}\n                            </label>\n                            <div className=\"flex gap-4\">\n                                <label className=\"flex items-center\">\n                                    <input\n                                        type=\"radio\"\n                                        value=\"json\"\n                                        checked={format === 'json'}\n                                        onChange={(e) => setFormat(e.target.value as 'json' | 'csv')}\n                                        className=\"mr-2\"\n                                    />\n                                    JSON\n                                </label>\n                                <label className=\"flex items-center\">\n                                    <input\n                                        type=\"radio\"\n                                        value=\"csv\"\n                                        checked={format === 'csv'}\n                                        onChange={(e) => setFormat(e.target.value as 'json' | 'csv')}\n                                        className=\"mr-2\"\n                                    />\n                                    CSV\n                                </label>\n                            </div>\n                        </div>\n\n                        {/* Feldauswahl */}\n                        <div>\n                            <div className=\"flex items-center justify-between mb-3\">\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                    {t('tours.export.selectFields', 'Felder auswhlen')}\n                                </label>\n                                <div className=\"flex gap-2\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={selectAll}\n                                        className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\"\n                                    >\n                                        {t('common.selectAll', 'Alle auswhlen')}\n                                    </button>\n                                    <span className=\"text-gray-400\">|</span>\n                                    <button\n                                        type=\"button\"\n                                        onClick={deselectAll}\n                                        className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\"\n                                    >\n                                        {t('common.deselectAll', 'Alle abwhlen')}\n                                    </button>\n                                </div>\n                            </div>\n                            <div className=\"border border-gray-300 dark:border-gray-600 rounded-md p-4 max-h-96 overflow-y-auto\">\n                                <div className=\"grid grid-cols-2 gap-2\">\n                                    {availableFields.map(field => (\n                                        <label key={field.id} className=\"flex items-center\">\n                                            <input\n                                                type=\"checkbox\"\n                                                checked={selectedFields.includes(field.id)}\n                                                onChange={() => toggleField(field.id)}\n                                                className=\"mr-2 rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                                            />\n                                            <span className=\"text-sm text-gray-700 dark:text-gray-300\">\n                                                {field.label}\n                                            </span>\n                                        </label>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"flex justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                            title={t('common.cancel', 'Abbrechen')}\n                        >\n                            <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <button\n                            type=\"button\"\n                            onClick={handleExport}\n                            disabled={exporting || selectedFields.length === 0}\n                            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                            title={exporting ? t('common.exporting', 'Exportiere...') : t('common.export', 'Exportieren')}\n                        >\n                            <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                        </button>\n                    </div>\n                </Dialog.Panel>\n            </div>\n        </Dialog>\n    );\n};\n\nexport default TourExportDialog;\n\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { \r\n  XMarkIcon, \r\n  ChevronLeftIcon, \r\n  ChevronRightIcon,\r\n  MagnifyingGlassPlusIcon,\r\n  MagnifyingGlassMinusIcon,\r\n  ArrowPathIcon\r\n} from '@heroicons/react/24/outline';\r\nimport { getTourImageUrl, getTourGalleryImageUrl } from '../../config/api.ts';\r\n\r\ninterface TourImageLightboxProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  tourId: number;\r\n  initialImageIndex?: number;\r\n  imageUrl?: string | null;\r\n  galleryUrls?: string[] | null;\r\n  tourTitle?: string;\r\n}\r\n\r\nconst TourImageLightbox: React.FC<TourImageLightboxProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  tourId,\r\n  initialImageIndex = 0,\r\n  imageUrl,\r\n  galleryUrls,\r\n  tourTitle\r\n}) => {\r\n  const { t } = useTranslation();\r\n  \r\n  // State\r\n  const [currentImageIndex, setCurrentImageIndex] = useState(initialImageIndex);\r\n  const [zoomLevel, setZoomLevel] = useState(1.0);\r\n  const [imageLoading, setImageLoading] = useState(true);\r\n  const [imageError, setImageError] = useState(false);\r\n\r\n  // Konstruiere Bild-Array: Hauptbild + Galerie\r\n  const images: string[] = [];\r\n  if (imageUrl) {\r\n    images.push(getTourImageUrl(tourId)); // Index 0\r\n  }\r\n  if (galleryUrls && galleryUrls.length > 0) {\r\n    galleryUrls.forEach((_, index) => {\r\n      images.push(getTourGalleryImageUrl(tourId, index)); // Index 1+\r\n    });\r\n  }\r\n\r\n  // Reset state wenn Lightbox geffnet wird\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setCurrentImageIndex(initialImageIndex);\r\n      setZoomLevel(1.0);\r\n      setImageLoading(true);\r\n      setImageError(false);\r\n    }\r\n  }, [isOpen, initialImageIndex]);\r\n\r\n  // Navigation\r\n  const handlePrevious = useCallback(() => {\r\n    if (currentImageIndex > 0) {\r\n      setCurrentImageIndex(currentImageIndex - 1);\r\n      setImageLoading(true);\r\n      setImageError(false);\r\n      setZoomLevel(1.0);\r\n    }\r\n  }, [currentImageIndex]);\r\n\r\n  const handleNext = useCallback(() => {\r\n    if (currentImageIndex < images.length - 1) {\r\n      setCurrentImageIndex(currentImageIndex + 1);\r\n      setImageLoading(true);\r\n      setImageError(false);\r\n      setZoomLevel(1.0);\r\n    }\r\n  }, [currentImageIndex, images.length]);\r\n\r\n  // Zoom\r\n  const handleZoomIn = useCallback(() => {\r\n    setZoomLevel(prev => {\r\n      if (prev >= 3.0) return 3.0;\r\n      if (prev < 1.5) return 1.5;\r\n      if (prev < 2.0) return 2.0;\r\n      if (prev < 2.5) return 2.5;\r\n      return 3.0;\r\n    });\r\n  }, []);\r\n\r\n  const handleZoomOut = useCallback(() => {\r\n    setZoomLevel(prev => {\r\n      if (prev <= 1.0) return 1.0;\r\n      if (prev > 2.5) return 2.5;\r\n      if (prev > 2.0) return 2.0;\r\n      if (prev > 1.5) return 1.5;\r\n      return 1.0;\r\n    });\r\n  }, []);\r\n\r\n  const handleZoomReset = useCallback(() => {\r\n    setZoomLevel(1.0);\r\n  }, []);\r\n\r\n  // Bild-Events\r\n  const handleImageLoad = () => {\r\n    setImageLoading(false);\r\n    setImageError(false);\r\n  };\r\n\r\n  const handleImageError = () => {\r\n    setImageLoading(false);\r\n    setImageError(true);\r\n  };\r\n\r\n  // Keyboard-Navigation\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        onClose();\r\n      } else if (e.key === 'ArrowLeft' && currentImageIndex > 0) {\r\n        handlePrevious();\r\n      } else if (e.key === 'ArrowRight' && currentImageIndex < images.length - 1) {\r\n        handleNext();\r\n      } else if ((e.key === '+' || e.key === '=') && !e.shiftKey) {\r\n        handleZoomIn();\r\n      } else if (e.key === '-' || (e.key === '_' && e.shiftKey)) {\r\n        handleZoomOut();\r\n      } else if (e.key === '0') {\r\n        handleZoomReset();\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, [isOpen, currentImageIndex, images.length, handlePrevious, handleNext, handleZoomIn, handleZoomOut, handleZoomReset, onClose]);\r\n\r\n  // Prfe ob Bilder vorhanden\r\n  if (images.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const currentImage = images[currentImageIndex];\r\n  const canGoPrevious = currentImageIndex > 0;\r\n  const canGoNext = currentImageIndex < images.length - 1;\r\n  const canZoomIn = zoomLevel < 3.0;\r\n  const canZoomOut = zoomLevel > 1.0;\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      {/* Overlay */}\r\n      <div className=\"fixed inset-0 bg-black/80\" aria-hidden=\"true\" />\r\n      \r\n      {/* Dialog Panel */}\r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"mx-auto max-w-7xl w-full h-full flex flex-col bg-black/90 rounded-lg shadow-xl overflow-hidden\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between p-4 border-b border-gray-700 flex-shrink-0\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <Dialog.Title className=\"text-lg font-semibold text-white\">\r\n                {tourTitle && `${tourTitle} - `}\r\n                {t('tours.imageLightbox.title', 'Bild {{current}} von {{total}}', {\r\n                  current: currentImageIndex + 1,\r\n                  total: images.length\r\n                })}\r\n              </Dialog.Title>\r\n              \r\n              {/* Zoom Controls */}\r\n              <div className=\"flex items-center gap-2\">\r\n                <button\r\n                  onClick={handleZoomOut}\r\n                  disabled={!canZoomOut}\r\n                  className=\"p-2 text-white hover:bg-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  aria-label={t('tours.imageLightbox.zoomOut', 'Verkleinern')}\r\n                  title={t('tours.imageLightbox.zoomOut', 'Verkleinern')}\r\n                >\r\n                  <MagnifyingGlassMinusIcon className=\"h-5 w-5\" />\r\n                </button>\r\n                <button\r\n                  onClick={handleZoomReset}\r\n                  className=\"p-2 text-white hover:bg-gray-700 rounded transition-colors\"\r\n                  aria-label={t('tours.imageLightbox.zoomReset', 'Zoom zurcksetzen')}\r\n                  title={t('tours.imageLightbox.zoomReset', 'Zoom zurcksetzen')}\r\n                >\r\n                  <ArrowPathIcon className=\"h-5 w-5\" />\r\n                </button>\r\n                <button\r\n                  onClick={handleZoomIn}\r\n                  disabled={!canZoomIn}\r\n                  className=\"p-2 text-white hover:bg-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  aria-label={t('tours.imageLightbox.zoomIn', 'Vergrern')}\r\n                  title={t('tours.imageLightbox.zoomIn', 'Vergrern')}\r\n                >\r\n                  <MagnifyingGlassPlusIcon className=\"h-5 w-5\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Close Button */}\r\n            <button\r\n              onClick={onClose}\r\n              className=\"p-2 text-white hover:bg-gray-700 rounded transition-colors\"\r\n              aria-label={t('tours.imageLightbox.close', 'Schlieen')}\r\n            >\r\n              <XMarkIcon className=\"h-6 w-6\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Content */}\r\n          <div className=\"flex-1 relative overflow-hidden flex items-center justify-center\">\r\n            {/* Previous Button */}\r\n            {images.length > 1 && (\r\n              <button\r\n                onClick={handlePrevious}\r\n                disabled={!canGoPrevious}\r\n                className=\"absolute left-4 z-10 p-3 bg-black/50 hover:bg-black/70 text-white rounded-full disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\r\n                aria-label={t('tours.imageLightbox.previous', 'Vorheriges Bild')}\r\n              >\r\n                <ChevronLeftIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            )}\r\n\r\n            {/* Image Container */}\r\n            <div className=\"flex-1 flex items-center justify-center h-full p-4\">\r\n              {imageLoading && !imageError && (\r\n                <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                  <div className=\"text-white\">\r\n                    <ArrowPathIcon className=\"h-8 w-8 animate-spin\" />\r\n                    <p className=\"mt-2 text-sm\">{t('tours.imageLightbox.loading', 'Bild wird geladen...')}</p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {imageError && (\r\n                <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                  <div className=\"text-white text-center\">\r\n                    <p className=\"text-lg\">{t('tours.imageLightbox.error', 'Bild konnte nicht geladen werden')}</p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {!imageError && (\r\n                <img\r\n                  src={currentImage}\r\n                  alt={`${tourTitle || 'Tour'} - Bild ${currentImageIndex + 1}`}\r\n                  className={`max-w-full max-h-full object-contain transition-transform duration-200 ${\r\n                    imageLoading ? 'opacity-0' : 'opacity-100'\r\n                  }`}\r\n                  style={{\r\n                    transform: `scale(${zoomLevel})`,\r\n                    cursor: zoomLevel > 1.0 ? 'move' : 'default'\r\n                  }}\r\n                  onLoad={handleImageLoad}\r\n                  onError={handleImageError}\r\n                />\r\n              )}\r\n            </div>\r\n\r\n            {/* Next Button */}\r\n            {images.length > 1 && (\r\n              <button\r\n                onClick={handleNext}\r\n                disabled={!canGoNext}\r\n                className=\"absolute right-4 z-10 p-3 bg-black/50 hover:bg-black/70 text-white rounded-full disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\r\n                aria-label={t('tours.imageLightbox.next', 'Nchstes Bild')}\r\n              >\r\n                <ChevronRightIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            )}\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default TourImageLightbox;\r\n\r\n","import React, { useState, useEffect, useMemo, useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PencilIcon, PlusIcon, ArrowsUpDownIcon, FunnelIcon, InformationCircleIcon, Squares2X2Icon, TableCellsIcon, ArrowDownTrayIcon, PhotoIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS, getTourImageUrl, getTourGalleryImageUrl } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\nimport CardGrid from '../shared/CardGrid.tsx';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport { useTableSettings } from '../../hooks/useTableSettings.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useError } from '../../contexts/ErrorContext.tsx';\nimport TableColumnConfig from '../TableColumnConfig.tsx';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport CreateTourModal from './CreateTourModal.tsx';\nimport EditTourModal from './EditTourModal.tsx';\nimport TourDetailsModal from './TourDetailsModal.tsx';\nimport TourExportDialog from './TourExportDialog.tsx';\nimport TourImageLightbox from './TourImageLightbox.tsx';\nimport { Tour, TourType } from '../../types/tour.ts';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport { applyFilters, evaluateUserRoleCondition } from '../../utils/filterLogic.ts';\n\ninterface ToursTabProps {\n}\n\ninterface TourSortConfig {\n    key: 'title' | 'type' | 'price' | 'location' | 'duration' | 'branch' | 'createdBy' | 'isActive';\n    direction: 'asc' | 'desc';\n}\n\nconst TOURS_TABLE_ID = 'worktracker-tours';\n\nconst defaultTourColumnOrder = ['title', 'type', 'price', 'location', 'duration', 'branch', 'isActive', 'actions'];\n\n//  ENTFERNT: defaultTourCardSortDirections\n// Hauptsortierung wird jetzt aus Settings geladen (pro Benutzer gespeichert)\n\nconst tourCardToTableMapping: Record<string, string> = {\n    'title': 'title',\n    'type': 'type',\n    'price': 'price',\n    'location': 'location',\n    'duration': 'duration',\n    'branch': 'branch',\n    'createdBy': 'createdBy',\n    'isActive': 'isActive'\n};\n\nconst getTourCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n    const cardMetadata: string[] = [];\n    columnOrder.forEach(tableCol => {\n        const cardMeta = tourCardToTableMapping[tableCol] || [];\n        if (cardMeta && typeof cardMeta === 'string') {\n            cardMetadata.push(cardMeta);\n        }\n    });\n    return cardMetadata;\n};\n\nconst getTourHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n    const hiddenCardMetadata = new Set<string>();\n    hiddenTableColumns.forEach(tableCol => {\n        const cardMeta = tourCardToTableMapping[tableCol];\n        if (cardMeta) {\n            hiddenCardMetadata.add(cardMeta);\n        }\n    });\n    return hiddenCardMetadata;\n};\n\nconst ToursTab: React.FC<ToursTabProps> = () => {\n    const { t } = useTranslation();\n    const { hasPermission, loading: permissionsLoading } = usePermissions();\n    const { showMessage } = useMessage();\n    \n    // Fehlerbehandlung mit Fallback\n    const errorContext = useError();\n    const handleErrorContext = errorContext?.handleError || ((err: unknown, context?: Record<string, unknown>) => {\n        console.error('Error:', err, context);\n        const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                             (err as { message?: string })?.message || \n                             'Ein Fehler ist aufgetreten';\n        showMessage(errorMessage, 'error');\n    });\n    \n    // Tour-States\n    const [tours, setTours] = useState<Tour[]>([]);\n    const [toursLoading, setToursLoading] = useState(false);\n    const [toursError, setToursError] = useState<string | null>(null);\n    const [tourSearchTerm, setTourSearchTerm] = useState('');\n    const [tourFilterConditions, setTourFilterConditions] = useState<FilterCondition[]>([]);\n    const [tourFilterLogicalOperators, setTourFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [tourActiveFilterName, setTourActiveFilterName] = useState<string>(t('tours.filters.current', 'Aktuell'));\n    const [tourSelectedFilterId, setTourSelectedFilterId] = useState<number | null>(null);\n    \n    //  PERFORMANCE: Ref-Pattern fr tourFilterLogicalOperators (verhindert Re-Creation von loadTours)\n    const tourFilterLogicalOperatorsRef = useRef(tourFilterLogicalOperators);\n    \n    useEffect(() => {\n        tourFilterLogicalOperatorsRef.current = tourFilterLogicalOperators;\n    }, [tourFilterLogicalOperators]);\n    const [isCreateTourModalOpen, setIsCreateTourModalOpen] = useState(false);\n    const [isEditTourModalOpen, setIsEditTourModalOpen] = useState(false);\n    const [isTourDetailsModalOpen, setIsTourDetailsModalOpen] = useState(false);\n    const [isTourExportDialogOpen, setIsTourExportDialogOpen] = useState(false);\n    const [lightboxOpen, setLightboxOpen] = useState(false);\n    const [selectedTourForLightbox, setSelectedTourForLightbox] = useState<Tour | null>(null);\n    const [initialImageIndex, setInitialImageIndex] = useState(0);\n    const [selectedTour, setSelectedTour] = useState<Tour | null>(null);\n    const [selectedTourId, setSelectedTourId] = useState<number | null>(null);\n    const [displayLimit, setDisplayLimit] = useState<number>(10);\n    const [draggedColumn, setDraggedColumn] = useState<string | null>(null);\n    const [dragOverColumn, setDragOverColumn] = useState<string | null>(null);\n    const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n    \n    // Bildgenerierung States\n    const [generatingImages, setGeneratingImages] = useState<Record<number, boolean>>({});\n    const [imageGenerationJobs, setImageGenerationJobs] = useState<Record<number, string | null>>({});\n    const pollingIntervalsRef = useRef<Record<number, NodeJS.Timeout>>({});\n    const pollCountRef = useRef<Record<number, number>>({});\n    \n    // Tabellen-Einstellungen\n    const {\n        settings,\n        isLoading: isLoadingSettings,\n        updateColumnOrder,\n        updateHiddenColumns,\n        toggleColumnVisibility,\n        isColumnVisible,\n        updateViewMode,\n        updateSortConfig\n    } = useTableSettings(TOURS_TABLE_ID, {\n        defaultColumnOrder: defaultTourColumnOrder,\n        defaultHiddenColumns: [],\n        defaultViewMode: 'cards'\n    });\n    \n    // Hauptsortierung aus Settings laden (fr Table & Cards synchron)\n    const tourTableSortConfig: TourSortConfig = settings?.sortConfig || { key: 'title', direction: 'asc' };\n    \n    // Hauptsortierung Handler (fr Table & Cards synchron)\n    const handleMainSortChange = (key: string, direction: 'asc' | 'desc') => {\n        updateSortConfig({ key: key as TourSortConfig['key'], direction });\n    };\n    \n    // Tours-Spalten\n    const availableTourColumns = useMemo(() => [\n        { id: 'title', label: t('tours.columns.title', 'Titel'), shortLabel: t('tours.columns.title', 'Titel').substring(0, 4) },\n        { id: 'type', label: t('tours.columns.type', 'Typ'), shortLabel: t('tours.columns.type', 'Typ').substring(0, 3) },\n        { id: 'price', label: t('tours.columns.price', 'Preis'), shortLabel: t('tours.columns.price', 'Preis').substring(0, 3) },\n        { id: 'location', label: t('tours.columns.location', 'Ort'), shortLabel: t('tours.columns.location', 'Ort').substring(0, 3) },\n        { id: 'duration', label: t('tours.columns.duration', 'Dauer'), shortLabel: t('tours.columns.duration', 'Dauer').substring(0, 3) },\n        { id: 'branch', label: t('tours.columns.branch', 'Niederlassung'), shortLabel: t('tours.columns.branch', 'Niederlassung').substring(0, 5) },\n        { id: 'createdBy', label: t('tours.columns.createdBy', 'Erstellt von'), shortLabel: t('tours.columns.createdBy', 'Erstellt von').substring(0, 5) },\n        { id: 'isActive', label: t('tours.columns.status', 'Status'), shortLabel: t('tours.columns.status', 'Status').substring(0, 3) },\n        { id: 'actions', label: t('tours.columns.actions', 'Aktionen'), shortLabel: t('common.actions').substring(0, 3) },\n    ], [t]);\n    \n    const tourFilterOnlyColumns = useMemo(() => [\n        { id: 'description', label: t('tours.columns.description', 'Beschreibung'), shortLabel: t('tours.columns.description', 'Beschreibung').substring(0, 3) },\n        { id: 'maxParticipants', label: t('tours.columns.maxParticipants', 'Max. Teilnehmer'), shortLabel: t('tours.columns.maxParticipants', 'Max. Teilnehmer').substring(0, 3) },\n        { id: 'minParticipants', label: t('tours.columns.minParticipants', 'Min. Teilnehmer'), shortLabel: t('tours.columns.minParticipants', 'Min. Teilnehmer').substring(0, 3) },\n    ], [t]);\n    \n    //  ENTFERNT: tourCardSortDirections und handleTourCardSortDirectionChange\n    // Hauptsortierung wird jetzt aus Settings geladen (pro Benutzer gespeichert)\n    \n    const viewMode = settings?.viewMode || 'cards';\n    \n    // Card-Metadaten-Reihenfolge aus columnOrder ableiten\n    const cardMetadataOrder = useMemo(() => {\n        return getTourCardMetadataFromColumnOrder(settings?.columnOrder || defaultTourColumnOrder);\n    }, [settings?.columnOrder]);\n    \n    // Versteckte Card-Metadaten aus hiddenColumns ableiten\n    const hiddenCardMetadata = useMemo(() => {\n        return getTourHiddenCardMetadata(settings?.hiddenColumns || []);\n    }, [settings?.hiddenColumns]);\n    \n    // Sichtbare Card-Metadaten\n    const visibleCardMetadata = useMemo(() => {\n        return new Set(cardMetadataOrder.filter(meta => !hiddenCardMetadata.has(meta)));\n    }, [cardMetadataOrder, hiddenCardMetadata]);\n    \n    // Funktion zum Laden der Tours\n    //  PERFORMANCE: Ref-Pattern verwendet (tourFilterLogicalOperatorsRef) statt State als Dependency\n    const loadTours = useCallback(async (filterId?: number, filterConditions?: any[], background = false) => {\n        try {\n            if (!background) {\n                setToursLoading(true);\n                setToursError(null);\n            }\n            \n            const params: Record<string, unknown> = {};\n            if (filterId) {\n                params.filterId = filterId;\n            } else if (filterConditions && filterConditions.length > 0) {\n                params.filterConditions = JSON.stringify({\n                    conditions: filterConditions,\n                    operators: tourFilterLogicalOperatorsRef.current  //  Ref verwenden statt State\n                });\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BASE, { params });\n            if (response.data.success) {\n                const rawData = response.data.data || [];\n                const toursData = Array.isArray(rawData) \n                    ? rawData.filter((tour: Tour | null) => \n                        tour != null && \n                        typeof tour === 'object' && \n                        tour.title != null && \n                        typeof tour.title === 'string'\n                    )\n                    : [];\n                if (!background) {\n                    setTours(toursData);\n                }\n            } else {\n                const errorMessage = response.data.message || t('errors.loadError');\n                if (!background) {\n                    setToursError(errorMessage);\n                    showMessage(errorMessage, 'error');\n                }\n            }\n        } catch (err: any) {\n            console.error('Fehler beim Laden der Touren:', err);\n            const errorMessage = err.response?.data?.message || t('errors.loadError');\n            if (!background) {\n                setToursError(errorMessage);\n                showMessage(errorMessage, 'error');\n            }\n        } finally {\n            if (!background) {\n                setToursLoading(false);\n            }\n        }\n    }, [t, showMessage]);  //  tourFilterLogicalOperators entfernt (Ref verwendet)\n    \n    // Handler fr Bildgenerierung\n    const handleGenerateImages = useCallback(async (tourId: number) => {\n        try {\n            setGeneratingImages(prev => ({ ...prev, [tourId]: true }));\n            \n            const response = await axiosInstance.post(API_ENDPOINTS.TOURS.GENERATE_IMAGES(tourId));\n            \n            if (response.data.success) {\n                if (response.data.mode === 'synchronous') {\n                    // Synchroner Modus: Fertig\n                    showMessage(\n                        t('tours.imagesGenerated', { defaultValue: 'Bilder erfolgreich generiert' }),\n                        'success'\n                    );\n                    setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                    await loadTours();\n                } else {\n                    // Asynchroner Modus: Polling starten\n                    const jobId = response.data.jobId;\n                    setImageGenerationJobs(prev => ({ ...prev, [tourId]: jobId }));\n                    showMessage(\n                        t('tours.imageGenerationStarted', { defaultValue: 'Bildgenerierung gestartet' }),\n                        'info'\n                    );\n                }\n            } else {\n                throw new Error(response.data.message || t('tours.imageGenerationFailed', { defaultValue: 'Fehler beim Starten der Bildgenerierung' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error starting image generation:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('tours.imageGenerationFailed', { defaultValue: 'Fehler bei Bildgenerierung' });\n            showMessage(errorMessage, 'error');\n            setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n        }\n    }, [t, showMessage, loadTours]);\n    \n    // Polling fr Bildgenerierungs-Status\n    useEffect(() => {\n        // Starte Polling nur fr neue Jobs (die noch kein Intervall haben)\n        Object.entries(imageGenerationJobs).forEach(([tourIdStr, jobId]) => {\n            if (!jobId) return;\n            \n            const tourId = parseInt(tourIdStr, 10);\n            \n            // berspringe, wenn bereits ein Polling luft\n            if (pollingIntervalsRef.current[tourId]) {\n                return;\n            }\n            \n            // Initialisiere Poll-Count fr diesen Job\n            if (!pollCountRef.current[tourId]) {\n                pollCountRef.current[tourId] = 0;\n            }\n            \n            const maxPolls = 30; // Max. 60 Sekunden (30 * 2 Sekunden)\n            \n            // Polling-Intervall starten\n            pollingIntervalsRef.current[tourId] = setInterval(async () => {\n                try {\n                    pollCountRef.current[tourId] = (pollCountRef.current[tourId] || 0) + 1;\n                    \n                    // Timeout nach 60 Sekunden\n                    if (pollCountRef.current[tourId] > maxPolls) {\n                        clearInterval(pollingIntervalsRef.current[tourId]);\n                        delete pollingIntervalsRef.current[tourId];\n                        delete pollCountRef.current[tourId];\n                        setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                        setImageGenerationJobs(prev => {\n                            const newJobs = { ...prev };\n                            delete newJobs[tourId];\n                            return newJobs;\n                        });\n                        showMessage(\n                            t('tours.imageGenerationTimeout', { defaultValue: 'Bildgenerierung hat zu lange gedauert' }),\n                            'warning'\n                        );\n                        return;\n                    }\n                    \n                    const response = await axiosInstance.get(\n                        API_ENDPOINTS.TOURS.GENERATE_IMAGES_STATUS(tourId),\n                        { params: { jobId } }\n                    );\n                    \n                    if (response.data.success) {\n                        const status = response.data.status;\n                        const progress = response.data.progress || 0;\n                        \n                        if (status === 'completed') {\n                            // Erfolg: Polling stoppen\n                            clearInterval(pollingIntervalsRef.current[tourId]);\n                            delete pollingIntervalsRef.current[tourId];\n                            delete pollCountRef.current[tourId];\n                            setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                            setImageGenerationJobs(prev => {\n                                const newJobs = { ...prev };\n                                delete newJobs[tourId];\n                                return newJobs;\n                            });\n                            showMessage(\n                                t('tours.imagesGenerated', { defaultValue: 'Bilder erfolgreich generiert' }),\n                                'success'\n                            );\n                            await loadTours();\n                        } else if (status === 'failed') {\n                            // Fehler: Polling stoppen\n                            clearInterval(pollingIntervalsRef.current[tourId]);\n                            delete pollingIntervalsRef.current[tourId];\n                            delete pollCountRef.current[tourId];\n                            setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                            setImageGenerationJobs(prev => {\n                                const newJobs = { ...prev };\n                                delete newJobs[tourId];\n                                return newJobs;\n                            });\n                            showMessage(\n                                t('tours.imageGenerationFailed', { defaultValue: 'Fehler bei Bildgenerierung' }),\n                                'error'\n                            );\n                        }\n                        // 'waiting' oder 'active': Weiter pollen\n                    }\n                } catch (err: unknown) {\n                    console.error('Error during polling:', err);\n                    // Fehler beim Polling: Wenn Job nicht gefunden, stoppe Polling\n                    if ((err as { response?: { status?: number } })?.response?.status === 404) {\n                        clearInterval(pollingIntervalsRef.current[tourId]);\n                        delete pollingIntervalsRef.current[tourId];\n                        delete pollCountRef.current[tourId];\n                        setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                        setImageGenerationJobs(prev => {\n                            const newJobs = { ...prev };\n                            delete newJobs[tourId];\n                            return newJobs;\n                        });\n                        showMessage(\n                            t('tours.imageGenerationFailed', { defaultValue: 'Fehler bei Bildgenerierung' }),\n                            'error'\n                        );\n                    }\n                    // Sonst: Weiter versuchen (nicht stoppen)\n                }\n            }, 2000); // Alle 2 Sekunden\n        });\n        \n        //  MEMORY LEAK PREVENTION: Cleanup-Funktion\n        return () => {\n            Object.values(pollingIntervalsRef.current).forEach(interval => clearInterval(interval));\n        };\n    }, [imageGenerationJobs, t, showMessage, loadTours]);\n    \n    //  MEMORY: Cleanup - Alle groen Arrays beim Unmount lschen\n    useEffect(() => {\n        return () => {\n            setTours([]);\n            setTourFilterConditions([]);\n        };\n    }, []); // Nur beim Unmount ausfhren\n    \n    //  ENTFERNT: Lade Tours beim Mount - wird jetzt durch Standard-Pattern gemacht\n    \n    // Tour-Filter-Funktionen\n    //  PERFORMANCE: Mit useCallback stabilisiert (verhindert Endlosschleife in useEffect)\n    const applyTourFilterConditions = useCallback((conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setTourFilterConditions(conditions);\n        setTourFilterLogicalOperators(operators);\n        loadTours(undefined, conditions, false);\n    }, [loadTours]);\n    \n    //  PERFORMANCE: Mit useCallback stabilisiert\n    const resetTourFilterConditions = useCallback(() => {\n        setTourFilterConditions([]);\n        setTourFilterLogicalOperators([]);\n        setTourActiveFilterName(t('tours.filters.current', 'Aktuell'));\n        setTourSelectedFilterId(null);\n        loadTours();\n    }, [loadTours, t]);\n    \n    //  PERFORMANCE: Mit useCallback stabilisiert (verhindert Endlosschleife in useEffect)\n    //  STANDARD: Wie in Requests.tsx - State setzen BEVOR Daten geladen werden\n    const handleTourFilterChange = useCallback(async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setTourSelectedFilterId(id);\n        setTourActiveFilterName(name);\n        if (id) {\n            //  STANDARD: State setzen BEVOR Daten geladen werden (wie in Requests.tsx:706-708)\n            setTourFilterConditions(conditions);\n            setTourFilterLogicalOperators(operators);\n            await loadTours(id);\n        } else {\n            await applyTourFilterConditions(conditions, operators);\n        }\n    }, [loadTours, applyTourFilterConditions]);\n    \n    //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n    const filterContext = useFilterContext();\n    const { loadFilters } = filterContext;\n    \n    //  PERFORMANCE: Ref verhindert mehrfache Anwendung des Default-Filters (Endlosschleife)\n    const initialLoadAttemptedRef = useRef(false);\n    \n    //  STANDARD: Filter-Laden und Default-Filter-Anwendung mit leeren Dependencies (wie in Requests.tsx)\n    useEffect(() => {\n        //  STANDARD: Warte bis Berechtigungen geladen sind\n        if (permissionsLoading) {\n            return;\n        }\n        \n        //  PERFORMANCE: Verhindere mehrfache Ausfhrung\n        if (initialLoadAttemptedRef.current) {\n            return;\n        }\n        \n        const initialize = async () => {\n            //  PERFORMANCE: Markiere als versucht, BEVOR async Operation startet\n            initialLoadAttemptedRef.current = true;\n            \n            try {\n                //  STANDARD: Prfe Berechtigung direkt (nicht in Dependencies!)\n                if (!hasPermission('tours', 'read', 'table')) {\n                    return;\n                }\n                \n                // 1. Filter laden (wartet auf State-Update)\n                const filters = await loadFilters(TOURS_TABLE_ID);\n                \n                // 2. Default-Filter anwenden (IMMER vorhanden!)\n                const defaultFilter = filters.find(f => f.name === 'Aktuell');\n                if (defaultFilter) {\n                    await handleTourFilterChange(\n                        defaultFilter.name,\n                        defaultFilter.id,\n                        defaultFilter.conditions,\n                        defaultFilter.operators\n                    );\n                    return; // Daten werden durch handleTourFilterChange geladen\n                }\n                \n                // 3. Fallback: Daten ohne Filter laden (sollte nie passieren)\n                await loadTours();\n            } catch (error) {\n                //  PERFORMANCE: Bei Fehler Ref zurcksetzen, damit Retry mglich ist\n                initialLoadAttemptedRef.current = false;\n                if (process.env.NODE_ENV === 'development') {\n                    console.error('[ToursTab] Error during initialization:', error);\n                }\n            }\n        };\n        \n        initialize();\n    }, [permissionsLoading]); //  STANDARD: permissionsLoading als Dependency (wird erneut ausgefhrt wenn Berechtigungen geladen sind)\n    \n    const handleTourSort = (key: TourSortConfig['key']) => {\n        // Table-Header-Sortierung: Aktualisiert Hauptsortierung direkt (synchron fr Table & Cards)\n        const newDirection = tourTableSortConfig.key === key && tourTableSortConfig.direction === 'asc' ? 'desc' : 'asc';\n        updateSortConfig({ key, direction: newDirection });\n    };\n    \n    // Drag & Drop Handler\n    const handleDragStart = (columnId: string) => {\n        setDraggedColumn(columnId);\n    };\n    \n    const handleDragOver = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n        if (draggedColumn && draggedColumn !== columnId) {\n            setDragOverColumn(columnId);\n        }\n    };\n    \n    const handleDrop = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n            if (draggedColumn && draggedColumn !== columnId) {\n                const columnOrder = settings?.columnOrder || defaultTourColumnOrder;\n                const dragIndex = columnOrder.indexOf(draggedColumn);\n                const hoverIndex = columnOrder.indexOf(columnId);\n\n                if (dragIndex > -1 && hoverIndex > -1) {\n                    const newColumnOrder = [...columnOrder];\n                const draggedColumn_ = newColumnOrder[dragIndex];\n                newColumnOrder.splice(dragIndex, 1);\n                newColumnOrder.splice(hoverIndex, 0, draggedColumn_);\n                updateColumnOrder(newColumnOrder);\n            }\n        }\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n    \n    const handleDragEnd = () => {\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n    \n    // Filtern und sortieren der Spalten gem den Benutzereinstellungen\n    const completeColumnOrder = useMemo(() => {\n        const currentOrder = settings?.columnOrder || [];\n        const validOrder = currentOrder.filter(id => id != null && typeof id === 'string');\n        const missingColumns = defaultTourColumnOrder.filter(id => !validOrder.includes(id));\n        return [...validOrder, ...missingColumns];\n    }, [settings?.columnOrder]);\n    \n    const visibleColumnIds = completeColumnOrder.filter(id => id != null && typeof id === 'string' && isColumnVisible(id));\n    \n    const getActiveFilterCount = () => {\n        return tourFilterConditions.length;\n    };\n    \n    // Filter- und Sortierlogik fr Tours\n    const filteredAndSortedTours = useMemo(() => {\n        // Sicherstellen, dass tours ein Array ist\n        if (!Array.isArray(tours)) {\n            return [];\n        }\n        \n        const validTours = tours.filter(tour => tour != null && tour.title != null && typeof tour.title === 'string');\n        \n        let filtered = validTours.filter(tour => {\n            // Such-Filter\n            if (tourSearchTerm) {\n                const searchLower = tourSearchTerm.toLowerCase();\n                \n                //  OPTIMIERUNG: Frhes Beenden bei Match\n                if (tour.title && tour.title.toLowerCase().includes(searchLower)) return true;\n                if (tour.location && tour.location.toLowerCase().includes(searchLower)) return true;\n                if (tour.description && tour.description.toLowerCase().includes(searchLower)) return true;\n                \n                return false; // Kein Match gefunden\n            }\n            \n            return true;\n        });\n\n        // Erweiterte Filterbedingungen anwenden\n        if (tourFilterConditions.length > 0) {\n            const columnEvaluators: Record<string, (tour: Tour, cond: FilterCondition) => boolean | null> = {\n                'title': (tour: Tour, cond: FilterCondition) => {\n                    if (!tour || !tour.title) return false;\n                    const value = (cond.value as string || '').toLowerCase();\n                    const title = (tour.title || '').toLowerCase();\n                    if (cond.operator === 'equals') return tour.title === cond.value;\n                    if (cond.operator === 'contains') return title.includes(value);\n                    if (cond.operator === 'startsWith') return title.startsWith(value);\n                    if (cond.operator === 'endsWith') return title.endsWith(value);\n                    return null;\n                },\n                'type': (tour: Tour, cond: FilterCondition) => {\n                    if (!tour || !tour.type) return false;\n                    if (cond.operator === 'equals') return tour.type === cond.value;\n                    if (cond.operator === 'notEquals') return tour.type !== cond.value;\n                    return null;\n                },\n                'isActive': (tour: Tour, cond: FilterCondition) => {\n                    const value = cond.value === 'true' || cond.value === true || cond.value === '1';\n                    if (cond.operator === 'equals') return tour.isActive === value;\n                    if (cond.operator === 'notEquals') return tour.isActive !== value;\n                    return null;\n                },\n                'price': (tour: Tour, cond: FilterCondition) => {\n                    const price = typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                    const compareValue = typeof cond.value === 'string' ? parseFloat(cond.value) : (cond.value || 0);\n                    if (isNaN(price) || isNaN(compareValue)) return false;\n                    if (cond.operator === 'equals') return Math.abs(price - compareValue) < 0.01;\n                    if (cond.operator === 'greaterThan') return price > compareValue;\n                    if (cond.operator === 'lessThan') return price < compareValue;\n                    return null;\n                },\n                'location': (tour: Tour, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const location = (tour.location || '').toLowerCase();\n                    if (cond.operator === 'equals') return tour.location === cond.value;\n                    if (cond.operator === 'contains') return location.includes(value);\n                    if (cond.operator === 'startsWith') return location.startsWith(value);\n                    if (cond.operator === 'endsWith') return location.endsWith(value);\n                    return null;\n                },\n                'branch': (tour: Tour, cond: FilterCondition) => {\n                    const branchName = (tour.branch?.name || '').toLowerCase();\n                    const value = (cond.value as string || '').toLowerCase();\n                    if (cond.operator === 'equals') return branchName === value;\n                    if (cond.operator === 'contains') return branchName.includes(value);\n                    return null;\n                },\n                'createdBy': (tour: Tour, cond: FilterCondition) => {\n                    const createdByName = tour.createdBy\n                        ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}`\n                        : '';\n                    return evaluateUserRoleCondition(\n                        tour.createdById || null,\n                        null,\n                        cond,\n                        createdByName\n                    );\n                }\n            };\n\n            const getFieldValue = (tour: Tour | null, columnId: string): string | number | boolean | null => {\n                if (!tour) return '';\n                switch (columnId) {\n                    case 'title': return tour.title || '';\n                    case 'type': return tour.type || '';\n                    case 'price': return typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                    case 'location': return tour.location || '';\n                    case 'duration': return tour.duration || 0;\n                    case 'branch': return tour.branch?.name || '';\n                    case 'createdBy': return tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}` : '';\n                    case 'isActive': return tour.isActive;\n                    default: return '';\n                }\n            };\n\n            filtered = applyFilters(\n                filtered,\n                tourFilterConditions,\n                tourFilterLogicalOperators,\n                getFieldValue,\n                columnEvaluators\n            );\n        }\n        \n        // Hilfsfunktion zum Extrahieren von Werten fr Sortierung\n        const getTourSortValue = (tour: Tour | null, columnId: string): string | number | boolean | null => {\n            if (!tour) return '';\n            switch (columnId) {\n                case 'title':\n                    return (tour.title || '').toLowerCase();\n                case 'type':\n                    return (tour.type || '').toLowerCase();\n                case 'price':\n                    return typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                case 'location':\n                    return (tour.location || '').toLowerCase();\n                case 'duration':\n                    return tour.duration || 0;\n                case 'branch':\n                    return (tour.branch?.name || '').toLowerCase();\n                case 'createdBy':\n                    return tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}`.toLowerCase() : '';\n                case 'isActive':\n                    return tour.isActive ? 1 : 0;\n                default:\n                    return '';\n            }\n        };\n        \n        // Sortierung basierend auf Prioritten\n        const sorted = filtered.sort((a, b) => {\n            // Null-Check fr a und b\n            if (!a || !b) {\n                if (!a && !b) return 0;\n                if (!a) return 1;\n                if (!b) return -1;\n            }\n            \n            // 2. Prioritt: Table-Header-Sortierung (temporre berschreibung, auch wenn Filter aktiv)\n            if (viewMode === 'table' && tourTableSortConfig.key) {\n                const valueA = getTourSortValue(a, tourTableSortConfig.key);\n                const valueB = getTourSortValue(b, tourTableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    //  OPTIMIERUNG: Vermeide String() Konvertierung wenn bereits String\n                    const strA = typeof valueA === 'string' ? valueA : String(valueA);\n                    const strB = typeof valueB === 'string' ? valueB : String(valueB);\n                    comparison = strA.localeCompare(strB);\n                }\n                \n                if (comparison !== 0) {\n                    return tourTableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 3. Hauptsortierung (tourTableSortConfig) - fr Table & Cards synchron\n            // (wird bereits oben in Prioritt 2 behandelt)\n            \n            // 4. Fallback: Titel (alphabetisch)\n            //  OPTIMIERUNG: toLowerCase() bereits in getTourSortValue, aber hier fr Fallback\n            const titleA = (a?.title || '').toLowerCase();\n            const titleB = (b?.title || '').toLowerCase();\n            return titleA.localeCompare(titleB);\n        });\n        \n        return sorted;\n    }, [tours, tourSearchTerm, tourFilterConditions, tourFilterLogicalOperators, viewMode, tourTableSortConfig]);\n\n    return (\n        <div className=\"space-y-4\">\n            {/* Header mit Suche, View-Toggle, Filter, Export, Create */}\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n                {/* Linke Seite: Suche */}\n                <div className=\"flex-1 w-full sm:max-w-md\">\n                    <input\n                        type=\"text\"\n                        placeholder={t('common.search') + '...'}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                        value={tourSearchTerm}\n                        onChange={(e) => setTourSearchTerm(e.target.value)}\n                    />\n                </div>\n                \n                {/* Rechte Seite: View-Toggle, Filter, Export, Create */}\n                <div className=\"flex items-center gap-1.5\">\n                    {/* View-Mode Toggle */}\n                    <div className=\"relative group\">\n                        <button\n                            className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n                                viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n                            }`}\n                            onClick={() => updateViewMode(viewMode === 'table' ? 'cards' : 'table')}\n                        >\n                            {viewMode === 'table' ? (\n                                <Squares2X2Icon className=\"h-5 w-5\" />\n                            ) : (\n                                <TableCellsIcon className=\"h-5 w-5\" />\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n                        </div>\n                    </div>\n                    \n                    {/* Filter-Button */}\n                    <div className=\"relative group ml-1\">\n                        <button\n                            className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n                            onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                        >\n                            <FunnelIcon className=\"h-5 w-5\" />\n                            {getActiveFilterCount() > 0 && (\n                                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                    {getActiveFilterCount()}\n                                </span>\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {t('common.filter')}\n                        </div>\n                    </div>\n                    \n                    {/* Export-Button */}\n                    {hasPermission('tour_edit', 'write', 'button') && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => setIsTourExportDialogOpen(true)}\n                                className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700\"\n                            >\n                                <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('tours.export', 'Exportieren')}\n                            </div>\n                        </div>\n                    )}\n                    \n                    {/* Spalten-Konfiguration */}\n                    <div className=\"ml-1\">\n                        <TableColumnConfig\n                            columns={viewMode === 'cards'\n                                ? [\n                                    { id: 'title', label: t('tours.columns.title', 'Titel') },\n                                    { id: 'type', label: t('tours.columns.type', 'Typ') },\n                                    { id: 'price', label: t('tours.columns.price', 'Preis') },\n                                    { id: 'location', label: t('tours.columns.location', 'Ort') },\n                                    { id: 'duration', label: t('tours.columns.duration', 'Dauer') },\n                                    { id: 'branch', label: t('tours.columns.branch', 'Niederlassung') },\n                                    { id: 'createdBy', label: t('tours.columns.createdBy', 'Erstellt von') },\n                                    { id: 'isActive', label: t('tours.columns.status', 'Status') }\n                                ]\n                                : availableTourColumns}\n                            visibleColumns={viewMode === 'cards'\n                                ? Array.from(visibleCardMetadata)\n                                : visibleColumnIds}\n                            columnOrder={viewMode === 'cards'\n                                ? cardMetadataOrder\n                                : settings.columnOrder}\n                            onToggleColumnVisibility={(columnId) => {\n                                if (viewMode === 'cards') {\n                                    const tableColumn = tourCardToTableMapping[columnId];\n                                    if (tableColumn) {\n                                        toggleColumnVisibility(tableColumn);\n                                    }\n                                } else {\n                                    toggleColumnVisibility(columnId);\n                                }\n                            }}\n                            onColumnOrderChange={(newOrder) => {\n                                if (viewMode === 'cards') {\n                                    const newTableOrder = newOrder.map(cardMeta => tourCardToTableMapping[cardMeta] || cardMeta).filter(Boolean);\n                                    updateColumnOrder(newTableOrder);\n                                } else {\n                                    updateColumnOrder(newOrder);\n                                }\n                            }}\n                            modalTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                            mainSortConfig={tourTableSortConfig}\n                            onMainSortChange={handleMainSortChange}\n                            showMainSort={true}\n                        />\n                    </div>\n                    \n                    {/* Create-Button */}\n                    {hasPermission('tour_create', 'write', 'button') && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => setIsCreateTourModalOpen(true)}\n                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                style={{ width: '30.19px', height: '30.19px' }}\n                                aria-label={t('tours.create', 'Neue Tour erstellen')}\n                            >\n                                <PlusIcon className=\"h-4 w-4\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('tours.create', 'Neue Tour erstellen')}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Filter-Pane */}\n            {isFilterModalOpen && (\n                <div className=\"px-3 sm:px-4 md:px-6\">\n                    <FilterPane\n                        columns={[...availableTourColumns, ...tourFilterOnlyColumns]}\n                        onApply={applyTourFilterConditions}\n                        onReset={resetTourFilterConditions}\n                        savedConditions={tourFilterConditions}\n                        savedOperators={tourFilterLogicalOperators}\n                        tableId={TOURS_TABLE_ID}\n                    />\n                </div>\n            )}\n\n            {/* Gespeicherte Filter als Tags */}\n            <SavedFilterTags\n                tableId={TOURS_TABLE_ID}\n                onSelectFilter={applyTourFilterConditions}\n                onReset={resetTourFilterConditions}\n                activeFilterName={tourActiveFilterName}\n                selectedFilterId={tourSelectedFilterId}\n                onFilterChange={handleTourFilterChange}\n                defaultFilterName=\"Aktuell\" //  FIX: Hardcodiert (konsistent mit DB)\n            />\n\n            {/* Table View */}\n            {viewMode === 'table' && (\n                <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                        <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                            <tr>\n                                {visibleColumnIds.map(columnId => {\n                                    const column = availableTourColumns.find(col => col.id === columnId);\n                                    if (!column) return null;\n                                    \n                                    return (\n                                        <th\n                                            key={columnId}\n                                            scope=\"col\"\n                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                            draggable={true}\n                                            onDragStart={() => handleDragStart(columnId)}\n                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                            onDrop={(e) => handleDrop(e, columnId)}\n                                            onDragEnd={handleDragEnd}\n                                        >\n                                            <div className=\"flex items-center\">\n                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                {columnId !== 'actions' && (\n                                                    <button \n                                                        onClick={() => handleTourSort(columnId as TourSortConfig['key'])}\n                                                        className=\"ml-1 focus:outline-none\"\n                                                    >\n                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                    </button>\n                                                )}\n                                            </div>\n                                        </th>\n                                    );\n                                })}\n                            </tr>\n                        </thead>\n                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                            {toursLoading ? (\n                                <tr>\n                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-gray-500 dark:text-gray-400\">\n                                        {t('common.loading')}\n                                    </td>\n                                </tr>\n                            ) : toursError ? (\n                                <tr>\n                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-red-500 dark:text-red-400\">\n                                        {toursError}\n                                    </td>\n                                </tr>\n                            ) : filteredAndSortedTours.length === 0 ? (\n                                <tr>\n                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-gray-500 dark:text-gray-400\">\n                                        {t('tours.noTours')}\n                                    </td>\n                                </tr>\n                            ) : (\n                                <>\n                                    {filteredAndSortedTours.slice(0, displayLimit).filter(tour => tour != null && tour.title != null).map(tour => (\n                                        <tr \n                                            key={tour.id} \n                                            className=\"hover:bg-gray-50 dark:hover:bg-gray-700\"\n                                        >\n                                            {visibleColumnIds.map(columnId => {\n                                                switch (columnId) {\n                                                    case 'title':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words\">\n                                                                    {tour?.title || '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'type':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'price':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.price ? `${Number(tour.price).toLocaleString()} ${tour.currency || 'COP'}` : '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'location':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.location || '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'duration':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.duration ? `${tour.duration} ${t('common.hours', 'h')}` : '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'branch':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.branch?.name || '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'createdBy':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}` : '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'isActive':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                {hasPermission('tour_edit', 'write', 'button') ? (\n                                                                    <button\n                                                                        onClick={async (e) => {\n                                                                            e.stopPropagation();\n                                                                            try {\n                                                                                await axiosInstance.put(API_ENDPOINTS.TOURS.TOGGLE_ACTIVE(tour.id));\n                                                                                showMessage(\n                                                                                    tour.isActive \n                                                                                        ? t('tours.deactivated', { defaultValue: 'Tour deaktiviert' })\n                                                                                        : t('tours.activated', { defaultValue: 'Tour aktiviert' }),\n                                                                                    'success'\n                                                                                );\n                                                                                await loadTours();\n                                                                            } catch (err: any) {\n                                                                                console.error('Fehler beim Toggle der Tour:', err);\n                                                                                showMessage(\n                                                                                    err.response?.data?.message || t('errors.unknownError'),\n                                                                                    'error'\n                                                                                );\n                                                                            }\n                                                                        }}\n                                                                        className={`px-2 py-1 text-xs rounded transition-colors ${\n                                                                            tour.isActive \n                                                                                ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 hover:bg-green-200 dark:hover:bg-green-800' \n                                                                                : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700'\n                                                                        }`}\n                                                                    >\n                                                                        {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                                                    </button>\n                                                                ) : (\n                                                                    <span className={`px-2 py-1 text-xs rounded ${\n                                                                        tour.isActive \n                                                                            ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' \n                                                                            : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                                                    }`}>\n                                                                        {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                                                    </span>\n                                                                )}\n                                                            </td>\n                                                        );\n                                                    case 'actions':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"flex space-x-2 action-buttons\">\n                                                                    <div className=\"relative group\">\n                                                                        <button\n                                                                            onClick={(e) => {\n                                                                                e.stopPropagation();\n                                                                                setSelectedTourId(tour.id);\n                                                                                setIsTourDetailsModalOpen(true);\n                                                                            }}\n                                                                            className=\"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                            title={t('common.viewDetails', { defaultValue: 'Details anzeigen' })}\n                                                                        >\n                                                                            <InformationCircleIcon className=\"h-4 w-4\" />\n                                                                        </button>\n                                                                        <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                            {t('common.viewDetails', 'Details anzeigen')}\n                                                                        </div>\n                                                                    </div>\n                                                                    {hasPermission('tour_edit', 'write', 'button') && (\n                                                                        <>\n                                                                            <div className=\"relative group\">\n                                                                                <button\n                                                                                    onClick={(e) => {\n                                                                                        e.stopPropagation();\n                                                                                        handleGenerateImages(tour.id);\n                                                                                    }}\n                                                                                    disabled={generatingImages[tour.id] || false}\n                                                                                    className={`p-1.5 transition-colors ${\n                                                                                        generatingImages[tour.id]\n                                                                                            ? 'text-gray-400 cursor-not-allowed'\n                                                                                            : 'text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300'\n                                                                                    }`}\n                                                                                    title={generatingImages[tour.id]\n                                                                                        ? t('tours.generatingImages', { defaultValue: 'Bilder werden generiert...' })\n                                                                                        : t('tours.generateImages', { defaultValue: 'Bilder generieren' })}\n                                                                                >\n                                                                                    <PhotoIcon className=\"h-4 w-4\" />\n                                                                                </button>\n                                                                                <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                    {generatingImages[tour.id]\n                                                                                        ? t('tours.generatingImages', { defaultValue: 'Bilder werden generiert...' })\n                                                                                        : t('tours.generateImages', { defaultValue: 'Bilder generieren' })}\n                                                                                </div>\n                                                                            </div>\n                                                                            <button\n                                                                                onClick={(e) => {\n                                                                                    e.stopPropagation();\n                                                                                    setSelectedTour(tour);\n                                                                                    setIsEditTourModalOpen(true);\n                                                                                }}\n                                                                                className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                title={t('tours.edit', { defaultValue: 'Bearbeiten' })}\n                                                                            >\n                                                                                <PencilIcon className=\"h-4 w-4\" />\n                                                                            </button>\n                                                                        </>\n                                                                    )}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    default:\n                                                        return null;\n                                                }\n                                            })}\n                                        </tr>\n                                    ))}\n                                </>\n                            )}\n                        </tbody>\n                    </table>\n                </div>\n            )}\n\n            {/* Card View */}\n            {viewMode === 'cards' && (\n                <CardGrid>\n                    {toursLoading ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                            {t('common.loading')}\n                        </div>\n                    ) : toursError ? (\n                        <div className=\"text-center py-8 text-red-500 dark:text-red-400\">\n                            {toursError}\n                        </div>\n                    ) : filteredAndSortedTours.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                            {t('tours.noTours')}\n                        </div>\n                    ) : (\n                        filteredAndSortedTours.slice(0, displayLimit).filter(tour => tour != null && tour.title != null).map((tour) => (\n                            <div\n                                key={tour.id}\n                                className=\"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 p-4 hover:shadow-md transition-shadow\"\n                            >\n                                {/* Bild-Anzeige */}\n                                {tour.imageUrl && (\n                                    <img \n                                        src={getTourImageUrl(tour.id)}\n                                        alt={tour.title || 'Tour Bild'}\n                                        className=\"w-full h-48 object-cover rounded-lg mb-2 cursor-pointer hover:opacity-90 transition-opacity\"\n                                        loading=\"lazy\"\n                                        onClick={() => {\n                                            setSelectedTourForLightbox(tour);\n                                            setInitialImageIndex(0);\n                                            setLightboxOpen(true);\n                                        }}\n                                    />\n                                )}\n                                \n                                {/* Galerie-Thumbnails */}\n                                {tour.galleryUrls && tour.galleryUrls.length > 0 && (\n                                    <div className=\"flex gap-2 mb-2 overflow-x-auto\">\n                                        {tour.galleryUrls.map((_, index) => (\n                                            <img\n                                                key={index}\n                                                src={getTourGalleryImageUrl(tour.id, index)}\n                                                alt={`${tour.title} - Galerie ${index + 1}`}\n                                                className=\"w-20 h-20 object-cover rounded cursor-pointer hover:opacity-90 transition-opacity flex-shrink-0\"\n                                                onClick={() => {\n                                                    setSelectedTourForLightbox(tour);\n                                                    setInitialImageIndex(index + 1); // +1 weil Index 0 = Hauptbild\n                                                    setLightboxOpen(true);\n                                                }}\n                                            />\n                                        ))}\n                                    </div>\n                                )}\n                                \n                                <div className=\"flex items-start justify-between mb-2\">\n                                    <h4 className=\"text-lg font-semibold dark:text-white\">{tour?.title || '-'}</h4>\n                                    {hasPermission('tour_edit', 'write', 'button') ? (\n                                        <button\n                                            onClick={async () => {\n                                                try {\n                                                    await axiosInstance.put(API_ENDPOINTS.TOURS.TOGGLE_ACTIVE(tour.id));\n                                                    showMessage(\n                                                        tour.isActive \n                                                            ? t('tours.deactivated', { defaultValue: 'Tour deaktiviert' })\n                                                            : t('tours.activated', { defaultValue: 'Tour aktiviert' }),\n                                                        'success'\n                                                    );\n                                                    await loadTours();\n                                                } catch (err: unknown) {\n                                                    console.error('Error toggling tour:', err);\n                                                    showMessage(\n                                                        (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.unknownError'),\n                                                        'error'\n                                                    );\n                                                }\n                                            }}\n                                            className={`px-2 py-1 text-xs rounded transition-colors ${\n                                                tour.isActive \n                                                    ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 hover:bg-green-200 dark:hover:bg-green-800' \n                                                    : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700'\n                                            }`}\n                                        >\n                                            {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                        </button>\n                                    ) : (\n                                        <span className={`px-2 py-1 text-xs rounded ${\n                                            tour.isActive \n                                                ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' \n                                                : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                        }`}>\n                                            {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                        </span>\n                                    )}\n                                </div>\n                                \n                                {tour.description && (\n                                    <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-2 line-clamp-2\">\n                                        {tour.description}\n                                    </p>\n                                )}\n\n                                <div className=\"flex items-center justify-between mt-4\">\n                                    <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                        <span className=\"font-medium\">{t('tours.type')}:</span>{' '}\n                                        {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                    </div>\n                                    {tour.price && (\n                                        <div className=\"text-sm font-semibold dark:text-white\">\n                                            {Number(tour.price).toLocaleString()} {tour.currency || 'COP'}\n                                        </div>\n                                    )}\n                                </div>\n                                \n                                {hasPermission('tour_edit', 'write', 'button') && (\n                                    <div className=\"mt-4 flex justify-end gap-2\">\n                                        {/* Bildgenerierungs-Button */}\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={() => handleGenerateImages(tour.id)}\n                                                disabled={generatingImages[tour.id] || false}\n                                                className={`p-1.5 rounded transition-colors ${\n                                                    generatingImages[tour.id]\n                                                        ? 'bg-gray-200 dark:bg-gray-600 text-gray-400 cursor-not-allowed'\n                                                        : 'text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/30'\n                                                }`}\n                                            >\n                                                <PhotoIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {generatingImages[tour.id]\n                                                    ? t('tours.generatingImages', { defaultValue: 'Bilder werden generiert...' })\n                                                    : t('tours.generateImages', { defaultValue: 'Bilder generieren' })}\n                                            </div>\n                                        </div>\n                                        <button\n                                            onClick={() => {\n                                                setSelectedTour(tour);\n                                                setIsEditTourModalOpen(true);\n                                            }}\n                                            className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                            title={t('tours.edit', { defaultValue: 'Bearbeiten' })}\n                                        >\n                                            <PencilIcon className=\"h-4 w-4\" />\n                                        </button>\n                                    </div>\n                                )}\n                            </div>\n                        ))\n                    )}\n                </CardGrid>\n            )}\n\n            {/* \"Mehr anzeigen\" Button */}\n            {filteredAndSortedTours.length > displayLimit && (\n                <div className=\"mt-4 flex justify-center\">\n                    <button\n                        className=\"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600\"\n                        onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                    >\n                        {t('common.showMore')} ({filteredAndSortedTours.length - displayLimit} {t('common.remaining')})\n                    </button>\n                </div>\n            )}\n\n            {/* Modals */}\n            <CreateTourModal\n                isOpen={isCreateTourModalOpen}\n                onClose={() => setIsCreateTourModalOpen(false)}\n                onTourCreated={async () => {\n                    await loadTours();\n                }}\n            />\n            \n            {selectedTour && (\n                <EditTourModal\n                    isOpen={isEditTourModalOpen}\n                    onClose={() => {\n                        setIsEditTourModalOpen(false);\n                        setSelectedTour(null);\n                    }}\n                    onTourUpdated={async (updatedTour) => {\n                        await loadTours();\n                        // Modal wird nur beim Speichern geschlossen, nicht beim Lschen von Bildern\n                        // setSelectedTour wird hier nicht auf null gesetzt, damit das Modal offen bleibt\n                    }}\n                    tour={selectedTour}\n                />\n            )}\n            \n            {selectedTourId && (\n                <TourDetailsModal\n                    isOpen={isTourDetailsModalOpen}\n                    onClose={() => {\n                        setIsTourDetailsModalOpen(false);\n                        setSelectedTourId(null);\n                    }}\n                    tourId={selectedTourId}\n                    onTourUpdated={async () => {\n                        await loadTours();\n                    }}\n                />\n            )}\n            \n            <TourExportDialog\n                isOpen={isTourExportDialogOpen}\n                onClose={() => setIsTourExportDialogOpen(false)}\n                tourCount={filteredAndSortedTours.length}\n            />\n            \n            {selectedTourForLightbox && (\n                <TourImageLightbox\n                    isOpen={lightboxOpen}\n                    onClose={() => {\n                        setLightboxOpen(false);\n                        setSelectedTourForLightbox(null);\n                    }}\n                    tourId={selectedTourForLightbox.id}\n                    initialImageIndex={initialImageIndex}\n                    imageUrl={selectedTourForLightbox.imageUrl}\n                    galleryUrls={selectedTourForLightbox.galleryUrls}\n                    tourTitle={selectedTourForLightbox.title}\n                />\n            )}\n        </div>\n    );\n};\n\nexport default ToursTab;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { CreateOrganizationRequest } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\nimport { useAuth } from '../../hooks/useAuth.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nconst CreateOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<CreateOrganizationRequest>({\n    name: '',\n    displayName: '',\n    domain: ''\n  });\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  const { fetchCurrentUser } = useAuth();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.name.trim()) {\n      newErrors.name = t('organization.create.nameRequired');\n    }\n    \n    if (!formData.displayName.trim()) {\n      newErrors.displayName = t('organization.create.displayNameRequired');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      await organizationService.createOrganization(formData);\n      setErrors({});\n      showMessage(t('organization.create.createSuccess'), 'success');\n      \n      // WICHTIG: User und Berechtigungen neu laden nach Erstellen der Organisation\n      // Der User wurde der Admin-Rolle zugeordnet und hat jetzt neue Berechtigungen\n      await fetchCurrentUser();\n      \n      // Formular zurcksetzen\n      setFormData({\n        name: '',\n        displayName: '',\n        domain: ''\n      });\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.create.createError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    setFormData({\n      name: '',\n      displayName: '',\n      domain: ''\n    });\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.create.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label \n                    htmlFor=\"name\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.name')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"name\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.name \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.name && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"displayName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.displayName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"displayName\"\n                    name=\"displayName\"\n                    value={formData.displayName}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.displayName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.displayName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"domain\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.domain')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"domain\"\n                    name=\"domain\"\n                    value={formData.domain}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.create.creating') : t('organization.create.createButton')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.create.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label \n                htmlFor=\"name\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.name')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.name \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.name && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"displayName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.displayName')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"displayName\"\n                name=\"displayName\"\n                value={formData.displayName}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.displayName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.displayName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"domain\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.domain')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"domain\"\n                name=\"domain\"\n                value={formData.domain}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? t('organization.create.creating') : t('organization.create.createButton')}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default CreateOrganizationModal; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { CreateJoinRequestRequest, Organization } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nconst JoinOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<CreateJoinRequestRequest>({\n    organizationName: '',\n    message: ''\n  });\n  const [loading, setLoading] = useState<boolean>(false);\n  const [searching, setSearching] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [organizations, setOrganizations] = useState<Organization[]>([]);\n  const [showDropdown, setShowDropdown] = useState<boolean>(false);\n  const [selectedOrganization, setSelectedOrganization] = useState<Organization | null>(null);\n  const searchTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  const { showMessage } = useMessage();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  // Click outside handler fr Dropdown\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setShowDropdown(false);\n      }\n    };\n\n    if (showDropdown) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showDropdown]);\n\n  const searchOrganizations = async (searchTerm: string) => {\n    if (searchTerm.length < 2) {\n      setOrganizations([]);\n      setShowDropdown(false);\n      return;\n    }\n\n    try {\n      setSearching(true);\n      const results = await organizationService.searchOrganizations(searchTerm);\n      setOrganizations(results);\n      setShowDropdown(true);\n    } catch (err: any) {\n      console.error('Fehler bei der Organisationen-Suche:', err);\n      setOrganizations([]);\n    } finally {\n      setSearching(false);\n    }\n  };\n\n  const handleOrganizationInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setFormData(prev => ({ ...prev, organizationName: value }));\n    setSelectedOrganization(null);\n    \n    // Fehler lschen\n    if (errors.organizationName) {\n      setErrors(prev => ({ ...prev, organizationName: '' }));\n    }\n\n    // Debounce fr Suche\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current);\n    }\n\n    searchTimeoutRef.current = setTimeout(() => {\n      searchOrganizations(value);\n    }, 300);\n  };\n\n  const handleSelectOrganization = (org: Organization) => {\n    setSelectedOrganization(org);\n    setFormData(prev => ({ ...prev, organizationName: org.name }));\n    setShowDropdown(false);\n    setOrganizations([]);\n  };\n\n  const handleMessageChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setFormData(prev => ({ ...prev, message: e.target.value }));\n    if (errors.message) {\n      setErrors(prev => ({ ...prev, message: '' }));\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.organizationName.trim()) {\n      newErrors.organizationName = t('organization.join.nameRequired');\n    } else if (!selectedOrganization) {\n      newErrors.organizationName = t('organization.join.selectFromList');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      await organizationService.createJoinRequest(formData);\n      setErrors({});\n      showMessage(t('organization.join.sendSuccess'), 'success');\n      // Formular zurcksetzen\n      setFormData({\n        organizationName: '',\n        message: ''\n      });\n      setSelectedOrganization(null);\n      setOrganizations([]);\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.join.sendError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    setFormData({\n      organizationName: '',\n      message: ''\n    });\n    setSelectedOrganization(null);\n    setOrganizations([]);\n    setErrors({});\n    setShowDropdown(false);\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current);\n    }\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.join.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div className=\"relative\" ref={dropdownRef}>\n                  <label \n                    htmlFor=\"organizationName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.join.search')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"organizationName\"\n                    name=\"organizationName\"\n                    value={formData.organizationName}\n                    onChange={handleOrganizationInputChange}\n                    placeholder={t('organization.join.searchPlaceholder')}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.organizationName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.organizationName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.organizationName}</p>\n                  )}\n                  \n                  {/* Autocomplete Dropdown */}\n                  {showDropdown && (organizations.length > 0 || searching) && (\n                    <div className=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto\">\n                      {searching ? (\n                        <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                          {t('organization.join.searching')}\n                        </div>\n                      ) : organizations.length > 0 ? (\n                        organizations.map(org => (\n                          <button\n                            key={org.id}\n                            type=\"button\"\n                            onClick={() => handleSelectOrganization(org)}\n                            className=\"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none\"\n                          >\n                            <div className=\"font-medium text-gray-900 dark:text-white\">\n                              {org.displayName || org.name}\n                            </div>\n                            {org.displayName && (\n                              <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                {org.name}\n                              </div>\n                            )}\n                          </button>\n                        ))\n                      ) : (\n                        <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                          {t('organization.join.noOrganizations')}\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"message\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.join.message')}\n                  </label>\n                  <textarea\n                    id=\"message\"\n                    name=\"message\"\n                    value={formData.message || ''}\n                    onChange={handleMessageChange}\n                    rows={3}\n                    placeholder={t('organization.join.messagePlaceholder')}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.join.sending') : t('organization.join.send')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.join.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"relative\" ref={dropdownRef}>\n              <label \n                htmlFor=\"organizationName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.join.search')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"organizationName\"\n                name=\"organizationName\"\n                value={formData.organizationName}\n                onChange={handleOrganizationInputChange}\n                placeholder={t('organization.join.searchPlaceholder')}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.organizationName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.organizationName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.organizationName}</p>\n              )}\n              \n              {/* Autocomplete Dropdown */}\n              {showDropdown && (organizations.length > 0 || searching) && (\n                <div className=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto\">\n                  {searching ? (\n                    <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                      {t('organization.join.searching')}\n                    </div>\n                  ) : organizations.length > 0 ? (\n                    organizations.map(org => (\n                      <button\n                        key={org.id}\n                        type=\"button\"\n                        onClick={() => handleSelectOrganization(org)}\n                        className=\"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none\"\n                      >\n                        <div className=\"font-medium text-gray-900 dark:text-white\">\n                          {org.displayName || org.name}\n                        </div>\n                        {org.displayName && (\n                          <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                            {org.name}\n                          </div>\n                        )}\n                      </button>\n                    ))\n                  ) : (\n                    <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                      {t('organization.join.noOrganizations')}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"message\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.join.message')}\n              </label>\n              <textarea\n                id=\"message\"\n                name=\"message\"\n                value={formData.message || ''}\n                onChange={handleMessageChange}\n                rows={3}\n                placeholder={t('organization.join.messagePlaceholder')}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? t('organization.join.sending') : t('organization.join.send')}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default JoinOrganizationModal; ","import React, { useState, useEffect, Suspense } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { UpdateOrganizationRequest, Organization } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\nimport { useLanguage } from '../../hooks/useLanguage.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\n//  PERFORMANCE: Lazy Loading fr Tab-Komponenten\nconst RoleConfigurationTab = React.lazy(() => import('./RoleConfigurationTab.tsx'));\nconst DocumentConfigurationTab = React.lazy(() => import('./DocumentConfigurationTab.tsx'));\nconst SMTPConfigurationTab = React.lazy(() => import('./SMTPConfigurationTab.tsx'));\nconst ApiConfigurationTab = React.lazy(() => import('./ApiConfigurationTab.tsx'));\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n  organization: Organization | null;\n}\n\nconst EditOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess, organization }) => {\n  const { t } = useTranslation();\n  const { fetchCurrentUser } = useAuth();\n  const [formData, setFormData] = useState<UpdateOrganizationRequest>({\n    displayName: '',\n    domain: '',\n    logo: '',\n    country: null,\n    nit: null,\n    settings: {}\n  });\n  //  PERFORMANCE: Organization mit Settings fr Tab-Komponenten\n  const [organizationWithSettings, setOrganizationWithSettings] = useState<Organization | null>(null);\n  const [selectedCountry, setSelectedCountry] = useState<string>('');\n  const [nit, setNit] = useState<string>('');\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  const { organizationLanguage, setOrganizationLanguage } = useLanguage();\n  const [selectedOrgLanguage, setSelectedOrgLanguage] = useState<string>('');\n  const [savingOrgLanguage, setSavingOrgLanguage] = useState<boolean>(false);\n  const [activeTab, setActiveTab] = useState<'general' | 'roles' | 'documents' | 'smtp' | 'api'>('general');\n  const [logoFile, setLogoFile] = useState<File | null>(null);\n  const [logoPreview, setLogoPreview] = useState<string | null>(null);\n\n  // Lnder-Liste\n  const COUNTRIES = [\n    { code: 'CO', name: t('countries.CO') },\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'DE', name: t('countries.DE') },\n    { code: 'AT', name: t('countries.AT') }\n  ];\n\n  // Lade Organisations-Daten wenn Modal geffnet wird\n  useEffect(() => {\n    if (isOpen && organization) {\n      //  PERFORMANCE: Settings laden wenn Modal geffnet wird und Settings fehlen\n      const loadSettingsIfNeeded = async () => {\n        let orgWithSettings = organization;\n        \n        // Settings laden wenn fehlen\n        if (!organization.settings) {\n          try {\n            orgWithSettings = await organizationService.getCurrentOrganization(undefined, true);\n          } catch (error) {\n            console.error('Fehler beim Laden der Settings:', error);\n          }\n        }\n        \n        //  PERFORMANCE: Organization mit Settings fr Tab-Komponenten speichern\n        setOrganizationWithSettings(orgWithSettings);\n        \n        const orgSettings = orgWithSettings.settings || {};\n        setFormData({\n          displayName: orgWithSettings.displayName || '',\n          domain: orgWithSettings.domain || '',\n          logo: orgWithSettings.logo || '',\n          country: orgWithSettings.country || null,\n          nit: orgWithSettings.nit || null,\n          settings: orgSettings\n        });\n        \n        // Setze Land direkt aus organization (statt aus settings)\n        setSelectedCountry(orgWithSettings.country || '');\n        setNit(orgWithSettings.nit || '');\n        \n        // Setze Logo-Preview wenn Logo vorhanden\n        if (orgWithSettings.logo) {\n          setLogoPreview(orgWithSettings.logo);\n        } else {\n          setLogoPreview(null);\n        }\n        setLogoFile(null);\n        \n        // Lade Organisation-Sprache\n        const loadOrgLanguage = async () => {\n          try {\n            const langResponse = await organizationService.getOrganizationLanguage();\n            setSelectedOrgLanguage(langResponse.language || '');\n          } catch (langError) {\n            console.error(t('organization.loadLanguageError'), langError);\n            setSelectedOrgLanguage('');\n          }\n        };\n        \n        loadOrgLanguage();\n      };\n      \n      loadSettingsIfNeeded();\n    } else if (!isOpen) {\n      //  PERFORMANCE: State zurcksetzen beim Schlieen\n      setOrganizationWithSettings(null);\n    }\n  }, [isOpen, organization, t]);\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    if (name === 'country') {\n      setSelectedCountry(value);\n      setFormData(prev => ({\n        ...prev,\n        country: value || null\n      }));\n      // Wenn Country nicht \"CO\" ist, NIT zurcksetzen\n      if (value !== 'CO') {\n        setNit('');\n        setFormData(prev => ({\n          ...prev,\n          nit: null\n        }));\n      }\n    } else if (name === 'nit') {\n      setNit(value);\n      setFormData(prev => ({\n        ...prev,\n        nit: value || null\n      }));\n    } else {\n      setFormData(prev => ({ ...prev, [name]: value }));\n    }\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleLogoFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Prfe Dateityp\n    if (!file.type.match('image/(png|jpeg|jpg)')) {\n      showMessage(t('organization.logoInvalidType') || 'Nur PNG und JPEG Dateien sind erlaubt', 'error');\n      return;\n    }\n\n    // Prfe Dateigre (max 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      showMessage(t('organization.logoTooLarge') || 'Logo darf maximal 5MB gro sein', 'error');\n      return;\n    }\n\n    setLogoFile(file);\n\n    // Erstelle Preview\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      const base64String = reader.result as string;\n      setLogoPreview(base64String);\n      setFormData(prev => ({ ...prev, logo: base64String }));\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    try {\n      setLoading(true);\n      setErrors({});\n      await organizationService.updateOrganization(formData);\n      showMessage(t('organization.updateSuccess'), 'success');\n      \n      // User-Daten neu laden, damit das Logo im Header aktualisiert wird\n      try {\n        await fetchCurrentUser();\n      } catch (error) {\n        console.error('Fehler beim Neuladen der User-Daten:', error);\n      }\n      \n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.updateError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    if (organization) {\n      const orgSettings = organization.settings || {};\n      setFormData({\n        displayName: organization.displayName || '',\n        domain: organization.domain || '',\n        logo: organization.logo || '',\n        country: organization.country || null,\n        nit: organization.nit || null,\n        settings: orgSettings\n      });\n      setSelectedCountry(organization.country || '');\n      setNit(organization.nit || '');\n    }\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.edit.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label \n                    htmlFor=\"displayName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.displayName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"displayName\"\n                    name=\"displayName\"\n                    value={formData.displayName || ''}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.displayName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.displayName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"domain\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.domain')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"domain\"\n                    name=\"domain\"\n                    value={formData.domain || ''}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"logo-mobile\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.logo') || 'Logo'}\n                  </label>\n                  <input\n                    type=\"file\"\n                    id=\"logo-mobile\"\n                    name=\"logo\"\n                    accept=\"image/png,image/jpeg,image/jpg\"\n                    onChange={handleLogoFileChange}\n                    className=\"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400\n                      file:mr-4 file:py-2 file:px-4\n                      file:rounded-md file:border-0\n                      file:text-sm file:font-semibold\n                      file:bg-blue-50 file:text-blue-700\n                      hover:file:bg-blue-100\n                      dark:file:bg-blue-900 dark:file:text-blue-300\n                      dark:hover:file:bg-blue-800\"\n                  />\n                  {logoPreview && (\n                    <div className=\"mt-2\">\n                      <img \n                        src={logoPreview} \n                        alt=\"Logo Preview\" \n                        className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                      />\n                    </div>\n                  )}\n                  {formData.logo && !logoPreview && (\n                    <div className=\"mt-2\">\n                      <img \n                        src={formData.logo} \n                        alt=\"Current Logo\" \n                        className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                      />\n                    </div>\n                  )}\n                </div>\n\n                {/* Land */}\n                <div className=\"border-t pt-4\">\n                  <label \n                    htmlFor=\"country\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.country')}\n                  </label>\n                  <select\n                    id=\"country\"\n                    name=\"country\"\n                    value={selectedCountry}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  >\n                    <option value=\"\">{t('organization.selectCountry')}</option>\n                    {COUNTRIES.map((country) => (\n                      <option key={country.code} value={country.code}>\n                        {country.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                {/* Organisation-Sprache */}\n                <div className=\"border-t pt-4\">\n                  <label \n                    htmlFor=\"organizationLanguage\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.language')}\n                  </label>\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\n                    {t('organization.languageDescription')}\n                  </p>\n                  <select\n                    id=\"organizationLanguage\"\n                    value={selectedOrgLanguage || organizationLanguage || ''}\n                    onChange={async (e) => {\n                      const newLanguage = e.target.value;\n                      setSelectedOrgLanguage(newLanguage);\n                      if (newLanguage && newLanguage !== organizationLanguage) {\n                        setSavingOrgLanguage(true);\n                        try {\n                          await setOrganizationLanguage(newLanguage);\n                          showMessage(t('common.save'), 'success');\n                        } catch (error) {\n                          console.error(t('organization.saveLanguageError'), error);\n                          showMessage(t('worktime.messages.orgLanguageError'), 'error');\n                        } finally {\n                          setSavingOrgLanguage(false);\n                        }\n                      }\n                    }}\n                    disabled={savingOrgLanguage || loading}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed\"\n                  >\n                    <option value=\"\">{t('settings.useOrganizationLanguage')} ({t('worktime.language.fallback')}: {t('worktime.language.german')})</option>\n                    <option value=\"de\">{t('worktime.language.german')}</option>\n                    <option value=\"es\">{t('worktime.language.spanish')}</option>\n                    <option value=\"en\">{t('worktime.language.english')}</option>\n                  </select>\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.saving') : t('common.save')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.edit.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        {/* Tabs Navigation */}\n        <div className=\"border-b border-gray-200 dark:border-gray-700\">\n          <nav className=\"-mb-px flex space-x-4 px-4\" aria-label=\"Tabs\">\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('general')}\n              className={`${\n                activeTab === 'general'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.general')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('roles')}\n              className={`${\n                activeTab === 'roles'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.roles')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('documents')}\n              className={`${\n                activeTab === 'documents'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.documents')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('smtp')}\n              className={`${\n                activeTab === 'smtp'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.smtp')}\n            </button>\n            {selectedCountry === 'CO' && (\n              <button\n                type=\"button\"\n                onClick={() => setActiveTab('api')}\n                className={`${\n                  activeTab === 'api'\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n              >\n                {t('organization.tabs.api')}\n              </button>\n            )}\n          </nav>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          {activeTab === 'general' && (\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label \n                htmlFor=\"displayName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.displayName')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"displayName\"\n                name=\"displayName\"\n                value={formData.displayName || ''}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.displayName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.displayName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"domain\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.domain')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"domain\"\n                name=\"domain\"\n                value={formData.domain || ''}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"logo\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.logo') || 'Logo'}\n              </label>\n              <input\n                type=\"file\"\n                id=\"logo\"\n                name=\"logo\"\n                accept=\"image/png,image/jpeg,image/jpg\"\n                onChange={handleLogoFileChange}\n                className=\"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400\n                  file:mr-4 file:py-2 file:px-4\n                  file:rounded-md file:border-0\n                  file:text-sm file:font-semibold\n                  file:bg-blue-50 file:text-blue-700\n                  hover:file:bg-blue-100\n                  dark:file:bg-blue-900 dark:file:text-blue-300\n                  dark:hover:file:bg-blue-800\"\n              />\n              {logoPreview && (\n                <div className=\"mt-2\">\n                  <img \n                    src={logoPreview} \n                    alt=\"Logo Preview\" \n                    className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                  />\n                </div>\n              )}\n              {formData.logo && !logoPreview && (\n                <div className=\"mt-2\">\n                  <img \n                    src={formData.logo} \n                    alt=\"Current Logo\" \n                    className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                  />\n                </div>\n              )}\n            </div>\n\n            {/* Land */}\n            <div className=\"border-t pt-4\">\n              <label \n                htmlFor=\"country\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.country')}\n              </label>\n              <select\n                id=\"country\"\n                name=\"country\"\n                value={selectedCountry}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              >\n                <option value=\"\">{t('organization.selectCountry')}</option>\n                {COUNTRIES.map((country) => (\n                  <option key={country.code} value={country.code}>\n                    {country.name}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            {/* NIT (nur fr Kolumbien) */}\n            {selectedCountry === 'CO' && (\n              <div>\n                <label \n                  htmlFor=\"nit\" \n                  className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                >\n                  {t('organization.nit')}\n                </label>\n                <input\n                  type=\"text\"\n                  id=\"nit\"\n                  name=\"nit\"\n                  value={nit}\n                  onChange={handleChange}\n                  placeholder={t('organization.nitDescription')}\n                  className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('organization.nitDescription')}\n                </p>\n              </div>\n            )}\n\n            {/* Organisation-Sprache */}\n            <div className=\"border-t pt-4\">\n              <label \n                htmlFor=\"organizationLanguage\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.language')}\n              </label>\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\n                {t('organization.languageDescription')}\n              </p>\n              <select\n                id=\"organizationLanguage\"\n                value={selectedOrgLanguage || organizationLanguage || ''}\n                onChange={async (e) => {\n                  const newLanguage = e.target.value;\n                  setSelectedOrgLanguage(newLanguage);\n                  if (newLanguage && newLanguage !== organizationLanguage) {\n                    setSavingOrgLanguage(true);\n                    try {\n                      await setOrganizationLanguage(newLanguage);\n                      showMessage(t('common.save'), 'success');\n                    } catch (error) {\n                      console.error('Fehler beim Speichern der Organisation-Sprache:', error);\n                      showMessage(t('worktime.messages.orgLanguageError'), 'error');\n                    } finally {\n                      setSavingOrgLanguage(false);\n                    }\n                  }\n                }}\n                disabled={savingOrgLanguage || loading}\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed\"\n              >\n                <option value=\"\">{t('settings.useOrganizationLanguage')} ({t('worktime.language.fallback')}: {t('worktime.language.german')})</option>\n                <option value=\"de\">{t('worktime.language.german')}</option>\n                <option value=\"es\">{t('worktime.language.spanish')}</option>\n                <option value=\"en\">{t('worktime.language.english')}</option>\n              </select>\n            </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.saving') : t('common.save')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          )}\n\n          {activeTab === 'roles' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <RoleConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n\n          {activeTab === 'documents' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <DocumentConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n\n          {activeTab === 'smtp' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <SMTPConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n\n          {activeTab === 'api' && selectedCountry === 'CO' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <ApiConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default EditOrganizationModal;\n\n","import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { XMarkIcon, ArrowPathIcon, FunnelIcon, ArrowUturnLeftIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport axiosInstance from '../../config/axios.ts';\nimport { logger } from '../../utils/logger.ts';\n\n// Status-Badge Funktionen\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case 'pending':\n      return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';\n    case 'approved':\n      return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\n    case 'rejected':\n      return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\n    case 'withdrawn':\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n    default:\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n  }\n};\n\nconst getStatusText = (status: string, t: any) => {\n  switch (status) {\n    case 'pending':\n      return t('joinRequestsList.status.pending');\n    case 'approved':\n      return t('joinRequestsList.status.approved');\n    case 'rejected':\n      return t('joinRequestsList.status.rejected');\n    case 'withdrawn':\n      return t('joinRequestsList.status.withdrawn');\n    default:\n      return status;\n  }\n};\n\nconst MY_JOIN_REQUESTS_TABLE_ID = 'my-join-requests-table';\n\nconst MyJoinRequestsList: React.FC = () => {\n  const { t } = useTranslation();\n  const [joinRequests, setJoinRequests] = useState<OrganizationJoinRequest[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState<boolean>(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const { showMessage } = useMessage();\n  const mountedRef = useRef(true);\n  const [withdrawingId, setWithdrawingId] = useState<number | null>(null);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n\n  useEffect(() => {\n    return () => {\n      mountedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    logger.log('MyJoinRequestsList: useEffect called - component mounted');\n    \n    // WICHTIG: State beim Mount zurcksetzen, um Caching zwischen Usern zu vermeiden\n    logger.log('MyJoinRequestsList: Resetting state on mount to prevent data leaks');\n    setJoinRequests([]);\n    setError(null);\n    setLoading(true);\n    \n    let isMounted = true;\n    \n    const fetchMyJoinRequests = async () => {\n      if (!isMounted) {\n        logger.log('MyJoinRequestsList: Component unmounted, skipping fetch');\n        return;\n      }\n      \n      logger.log('MyJoinRequestsList: Starting fetch');\n      \n      // Timeout nach 10 Sekunden\n      const timeoutId = setTimeout(() => {\n        if (isMounted) {\n          console.error('Request timeout after 10 seconds');\n          setError('Anfrage dauert zu lange. Bitte Seite neu laden.');\n          setLoading(false);\n        }\n      }, 10000);\n      \n      try {\n        logger.log('MyJoinRequestsList: Setting loading to true');\n        setLoading(true);\n        setError(null);\n        \n        // Debug: Log die URL die aufgerufen wird\n        logger.log('MyJoinRequestsList: Fetching my join requests from:', API_ENDPOINTS.ORGANIZATIONS.MY_JOIN_REQUESTS);\n        \n        const requests = await organizationService.getMyJoinRequests();\n        \n        logger.log('MyJoinRequestsList: Received requests:', requests);\n        logger.log('MyJoinRequestsList: Requests type:', typeof requests);\n        logger.log('MyJoinRequestsList: Requests isArray:', Array.isArray(requests));\n        logger.log('MyJoinRequestsList: Requests length:', requests?.length || 0);\n        \n        // SICHERHEIT: Validiere, dass alle Anfragen wirklich Arrays sind\n        if (!Array.isArray(requests)) {\n          console.error(' MyJoinRequestsList: Response is not an array!', requests);\n          throw new Error('Ungltige Antwort vom Server');\n        }\n        \n        clearTimeout(timeoutId);\n        \n        // State immer setzen, auch wenn Component unmounted ist\n        // (React kann den State trotzdem setzen, wenn Component wieder gemountet wird)\n        if (isMounted) {\n          logger.log('MyJoinRequestsList: Setting joinRequests state');\n          setJoinRequests(requests);\n          logger.log('MyJoinRequestsList: State updated with', requests.length, 'requests');\n        } else {\n          logger.log('MyJoinRequestsList: Component was unmounted, but setting state anyway');\n          setJoinRequests(requests);\n        }\n      } catch (err: any) {\n        clearTimeout(timeoutId);\n        \n        if (!isMounted) {\n          logger.log('MyJoinRequestsList: Component unmounted during error, skipping error handling');\n          return;\n        }\n        \n        console.error('MyJoinRequestsList: Error fetching my join requests:', err);\n        console.error('MyJoinRequestsList: Error response:', err.response);\n        console.error('MyJoinRequestsList: Error status:', err.response?.status);\n        console.error('MyJoinRequestsList: Error data:', err.response?.data);\n        \n        const errorMessage = err.response?.data?.message || err.message || t('myJoinRequests.loadError');\n        setError(errorMessage);\n        setTimeout(() => {\n          showMessage(errorMessage, 'error');\n        }, 0);\n      } finally {\n        if (isMounted) {\n          logger.log('MyJoinRequestsList: Setting loading to false');\n          setLoading(false);\n        } else {\n          // Auch wenn unmounted, loading auf false setzen\n          logger.log('MyJoinRequestsList: Component unmounted, but setting loading to false anyway');\n          setLoading(false);\n        }\n      }\n    };\n\n    // IMMER neu laden beim Mount (auch beim Tab-Wechsel zurck)\n    fetchMyJoinRequests();\n    \n    return () => {\n      logger.log('MyJoinRequestsList: useEffect cleanup - component unmounting');\n      isMounted = false;\n      mountedRef.current = false;\n      // State beim Unmount zurcksetzen\n      setJoinRequests([]);\n      setError(null);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleWithdraw = async (requestId: number) => {\n    if (!window.confirm(t('myJoinRequests.confirmWithdraw'))) {\n      return;\n    }\n\n    try {\n      setWithdrawingId(requestId);\n      await organizationService.withdrawJoinRequest(requestId);\n      \n      // Update local state\n      setJoinRequests(prev => \n        prev.map(req => \n          req.id === requestId \n            ? { ...req, status: 'withdrawn' as const, processedAt: new Date().toISOString() }\n            : req\n        )\n      );\n      \n      showMessage(t('myJoinRequests.withdrawSuccess'), 'success');\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('myJoinRequests.withdrawError');\n      showMessage(errorMessage, 'error');\n    } finally {\n      setWithdrawingId(null);\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('de-DE', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  // Filter-Funktionen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n\n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  useEffect(() => {\n    const initialize = async () => {\n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(MY_JOIN_REQUESTS_TABLE_ID);\n      \n      // 2. Default-Filter anwenden (IMMER vorhanden!)\n      const defaultFilter = filters.find(f => f.name === 'Alle');\n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        return; // Filter wird angewendet\n      }\n      \n      // 3. Fallback: Kein Filter (sollte nie passieren)\n      // MyJoinRequestsList filtert client-seitig, daher keine Daten-Lade-Funktion ntig\n    };\n    \n    initialize();\n  }, [loadFilters, handleFilterChange]);\n\n  // Standard-Filter erstellen und speichern\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(MY_JOIN_REQUESTS_TABLE_ID)\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: MY_JOIN_REQUESTS_TABLE_ID,\n            name: 'Alle',\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\n            alleFilter\n          );\n          logger.log('Alle-Filter fr Meine Beitrittsanfragen erstellt');\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []);\n\n  // Gefilterte Join-Requests\n  const filteredJoinRequests = useMemo(() => {\n    let filtered = [...joinRequests];\n\n    // Suchfeld-Filter\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(request => {\n        const orgName = (request.organization.displayName || request.organization.name || '').toLowerCase();\n        const message = request.message?.toLowerCase() || '';\n        return orgName.includes(searchLower) || message.includes(searchLower);\n      });\n    }\n\n    // Filter-Bedingungen aus FilterPane\n    if (filterConditions.length > 0) {\n      filtered = filterConditions.reduce((acc, condition, index) => {\n        if (!condition.column || condition.value === null || condition.value === '') {\n          return acc;\n        }\n\n        const operator = condition.operator;\n        const value = condition.value;\n\n        return acc.filter(request => {\n          switch (condition.column) {\n            case 'organization':\n              const orgName = (request.organization.displayName || request.organization.name || '').toLowerCase();\n              const searchValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return orgName.includes(searchValue);\n              } else if (operator === 'equals') {\n                return orgName === searchValue;\n              } else if (operator === 'startsWith') {\n                return orgName.startsWith(searchValue);\n              }\n              return false;\n\n            case 'message':\n              const message = request.message?.toLowerCase() || '';\n              const msgValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return message.includes(msgValue);\n              } else if (operator === 'equals') {\n                return message === msgValue;\n              } else if (operator === 'startsWith') {\n                return message.startsWith(msgValue);\n              }\n              return false;\n\n            case 'status':\n              if (operator === 'equals') {\n                return request.status === value;\n              }\n              return false;\n\n            default:\n              return true;\n          }\n        });\n      }, filtered);\n    }\n\n    return filtered;\n  }, [joinRequests, searchTerm, filterConditions, filterLogicalOperators]);\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n      {/* Titelzeile mit Icon, Suchfeld, Filter-Button */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <h2 className=\"text-xl font-semibold dark:text-white\">\n          {t('myJoinRequests.title')}\n        </h2>\n        \n        <div className=\"flex items-center gap-1.5\">\n          {/* Suchfeld */}\n          <input\n            type=\"text\"\n            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n\n          {/* Filter-Button */}\n          <button\n            className={`p-2 rounded-md border ${getActiveFilterCount() > 0 ? 'border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n            onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n            title={t('common.filter')}\n          >\n            <FunnelIcon className=\"h-5 w-5\" />\n            {getActiveFilterCount() > 0 && (\n              <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                {getActiveFilterCount()}\n              </span>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Filter-Panel */}\n      {isFilterPanelOpen && (\n        <div className=\"mb-4\">\n          <FilterPane\n            columns={[\n              { id: 'organization', label: t('myJoinRequests.filter.organization', { defaultValue: 'Organisation' }) },\n              { id: 'message', label: t('joinRequestsList.filter.message') },\n              { id: 'status', label: t('joinRequestsList.status.title', { defaultValue: 'Status' }) }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={MY_JOIN_REQUESTS_TABLE_ID}\n          />\n        </div>\n      )}\n\n      {/* Gespeicherte Filter als Tags anzeigen */}\n      <SavedFilterTags\n        tableId={MY_JOIN_REQUESTS_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n        defaultFilterName=\"Alle\"\n      />\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded\">\n          {error}\n        </div>\n      )}\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('myJoinRequests.loading')}</span>\n        </div>\n      ) : joinRequests.length === 0 ? (\n        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n          {t('myJoinRequests.noRequests')}\n        </div>\n      ) : (\n        /* Cards fr Join-Requests */\n        <div className=\"space-y-4\">\n          {filteredJoinRequests.map(request => (\n            <div\n              key={request.id}\n              className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\"\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                        {request.organization.displayName || request.organization.name}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        {formatDate(request.createdAt)}\n                      </p>\n                    </div>\n                    <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(request.status)}`}>\n                      {getStatusText(request.status, t)}\n                    </span>\n                  </div>\n\n                  {request.message && (\n                    <div className=\"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.filter.message')}:</span> {request.message}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.response && (\n                    <div className=\"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700\">\n                      <p className=\"text-sm text-blue-700 dark:text-blue-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.response')}:</span> {request.response}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.processor && (\n                    <div className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\n                      {t('myJoinRequests.processedBy')}: {request.processor.firstName} {request.processor.lastName}\n                      {request.processedAt && ` - ${formatDate(request.processedAt)}`}\n                    </div>\n                  )}\n\n                  {request.status === 'pending' && (\n                    <div className=\"mt-4 flex items-center gap-2\">\n                      <button \n                        onClick={() => handleWithdraw(request.id)}\n                        disabled={withdrawingId === request.id}\n                        className=\"p-2 bg-red-600 hover:bg-red-700 text-white rounded-md dark:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n                        title={withdrawingId === request.id ? t('myJoinRequests.withdrawing') : t('myJoinRequests.withdraw')}\n                      >\n                        {withdrawingId === request.id ? (\n                          <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                        ) : (\n                          <ArrowUturnLeftIcon className=\"h-5 w-5\" />\n                        )}\n                      </button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default MyJoinRequestsList;\n\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { BuildingOfficeIcon, PlusIcon, UserPlusIcon, UserGroupIcon, ShieldCheckIcon, EnvelopeIcon, ChartBarIcon, PencilIcon } from '@heroicons/react/24/outline';\nimport { useTranslation } from 'react-i18next';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { Organization } from '../../types/organization.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useOrganization } from '../../contexts/OrganizationContext.tsx';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport CreateOrganizationModal from './CreateOrganizationModal.tsx';\nimport JoinOrganizationModal from './JoinOrganizationModal.tsx';\nimport EditOrganizationModal from './EditOrganizationModal.tsx';\nimport MyJoinRequestsList from './MyJoinRequestsList.tsx';\n\ninterface OrganizationStats {\n  currentUsers: number;\n  maxUsers: number;\n  availableSlots: number;\n  utilizationPercent: number;\n  _count: {\n    roles: number;\n    joinRequests: number;\n    invitations: number;\n  };\n}\n\nconst OrganizationSettings: React.FC = () => {\n  const [organization, setOrganization] = useState<Organization | null>(null);\n  const [stats, setStats] = useState<OrganizationStats | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [loadingStats, setLoadingStats] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState<boolean>(false);\n  const [isJoinModalOpen, setIsJoinModalOpen] = useState<boolean>(false);\n  const [isEditModalOpen, setIsEditModalOpen] = useState<boolean>(false);\n  const { canViewOrganization, canManageOrganization, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  const { t } = useTranslation();\n  const { refreshOrganization } = useOrganization();\n  const { fetchCurrentUser } = useAuth();\n\n  const fetchOrganization = useCallback(async (includeSettings = false) => {\n    try {\n      setLoading(true);\n      setError(null);\n      //  PERFORMANCE: Settings nur laden wenn wirklich bentigt (beim Bearbeiten)\n      const org = await organizationService.getCurrentOrganization(undefined, includeSettings);\n      setOrganization(org);\n      \n      // Statistiken laden\n      try {\n        setLoadingStats(true);\n        const statsData = await organizationService.getOrganizationStats();\n        setStats(statsData);\n      } catch (statsErr: any) {\n        console.error('Fehler beim Laden der Statistiken:', statsErr);\n        // Statistiken-Fehler nicht kritisch, keine Error-Message\n      } finally {\n        setLoadingStats(false);\n      }\n    } catch (err: any) {\n      // Prfe ob es ein 404-Fehler ist (keine Organisation gefunden)\n      if (err.response?.status === 404 && err.response?.data?.hasOrganization === false) {\n        // Benutzer hat keine Organisation - das ist OK, setze Error aber nicht kritisch\n        // Verwende IMMER die bersetzung, nicht die Backend-Nachricht\n        setError(t('organization.notFound'));\n        setOrganization(null);\n        // Zeige Info-Message statt Error\n        showMessage(t('organization.notFound'), 'info');\n      } else {\n        // Andere Fehler - kritisch\n        const errorMessage = err.response?.data?.message || t('organization.loadError');\n        setError(errorMessage);\n        showMessage(errorMessage, 'error');\n      }\n    } finally {\n      setLoading(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const hasInitialLoadRef = useRef(false);\n\n  useEffect(() => {\n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      return;\n    }\n\n    // Nur einmal beim initialen Load ausfhren\n    if (hasInitialLoadRef.current) {\n      return;\n    }\n\n    const hasPermission = canViewOrganization();\n    if (hasPermission) {\n    hasInitialLoadRef.current = true;\n    //  PERFORMANCE: Initial OHNE Settings laden (nur beim Bearbeiten)\n    fetchOrganization(false);\n    } else {\n      setError(t('organization.noPermission'));\n      setLoading(false);\n      hasInitialLoadRef.current = true;\n    }\n    \n    //  MEMORY: Cleanup - Settings aus State entfernen beim Unmount\n    return () => {\n      setOrganization(null);\n      setStats(null);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [permissionsLoading]);\n\n  const handleEditSuccess = () => {\n    //  PERFORMANCE: Nach Bearbeiten Settings laden (fr Anzeige)\n    fetchOrganization(true);\n    // Aktualisiere auch den OrganizationContext\n    refreshOrganization();\n  };\n\n  //  MEMORY: Settings beim Schlieen des Modals lschen\n  const handleEditModalClose = () => {\n    setIsEditModalOpen(false);\n    // Settings aus State entfernen (nur Settings, nicht die gesamte Organization)\n    if (organization?.settings) {\n      setOrganization({\n        ...organization,\n        settings: undefined\n      });\n    }\n  };\n\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('common.loadingPermissions')}</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canViewOrganization()) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n          <div className=\"p-4 text-red-600 dark:text-red-400\">\n          {t('organization.noPermission')}\n        </div>\n      </div>\n    );\n  }\n\n  const handleCreateSuccess = () => {\n    //  PERFORMANCE: Nach Erstellen OHNE Settings laden (nicht bentigt)\n    fetchOrganization(false);\n  };\n\n  const handleJoinSuccess = async () => {\n    // Nach Beitritt: Organisation neu laden (OHNE Settings, nicht bentigt)\n    fetchOrganization(false);\n    // WICHTIG: User-Rollen neu laden, damit neue Rolle sichtbar wird\n    // OnboardingContext erkennt dann automatisch die neue Rolle\n    await fetchCurrentUser();\n  };\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        {/* Titelzeile mit Action-Buttons */}\n        <div className=\"flex items-center mb-4 sm:mb-4\">\n          {/* Linke Seite: Action-Buttons */}\n          <div className=\"flex items-center gap-1.5\" data-onboarding=\"organization-buttons\">\n            {/* Button: Neue Organisation erstellen - immer sichtbar (nicht nur fr Admins) */}\n            <button\n              onClick={() => setIsCreateModalOpen(true)}\n              data-onboarding=\"create-organization-button\"\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('organization.createOrganization')}\n              aria-label={t('organization.createOrganization')}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n            </button>\n            \n            {/* Button: Organisation beitreten - immer sichtbar */}\n            <button\n              onClick={() => setIsJoinModalOpen(true)}\n              data-onboarding=\"join-organization-button\"\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('organization.joinOrganization')}\n              aria-label={t('organization.joinOrganization')}\n            >\n              <UserPlusIcon className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('common.loadingOrganization')}</span>\n        </div>\n      ) : (\n        <>\n          {/* Error/Info Display */}\n          {error && (\n            <div className={`mb-4 p-4 border rounded ${\n              !organization \n                ? 'bg-blue-50 dark:bg-blue-900/30 border-blue-400 dark:border-blue-700 text-blue-700 dark:text-blue-300'\n                : 'bg-red-100 dark:bg-red-900 border-red-400 dark:border-red-700 text-red-700 dark:text-red-300'\n            }`}>\n              <div className=\"flex items-start\">\n                <div className=\"flex-shrink-0\">\n                  {!organization ? (\n                    <UserGroupIcon className=\"h-5 w-5\" />\n                  ) : (\n                    <span className=\"text-red-600 dark:text-red-400\"></span>\n                  )}\n                </div>\n                <div className=\"ml-3 flex-1\">\n                  <p className=\"font-medium\">{error}</p>\n                  {!organization && (\n                    <p className=\"mt-2 text-sm\">{t('organization.createOrJoinHint')}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Card-Ansicht - nur anzeigen wenn Organisation existiert */}\n          {organization ? (\n            <>\n            {/* Card mit Organisations-Infos */}\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-4\">\n            <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white flex items-center\">\n                        <BuildingOfficeIcon className=\"h-5 w-5 mr-2\" />\n                        {organization.displayName || organization.name}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                        {organization.domain || t('organization.noDomain')}\n                      </p>\n            </div>\n                    {canManageOrganization() && (\n                      <button\n                        onClick={() => {\n                          //  PERFORMANCE: Modal ffnet sofort - Settings werden im Modal geladen wenn bentigt\n                          setIsEditModalOpen(true);\n                        }}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                        title={t('organization.edit.title')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                      </button>\n                    )}\n            </div>\n\n                  {/* Organisations-Infos */}\n                  <div className=\"space-y-3\">\n                    {organization.subscriptionPlan && (\n            <div>\n                        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">{t('organization.subscriptionPlan')}:</span>\n                        <span className=\"ml-2 text-sm text-gray-900 dark:text-white capitalize\">{organization.subscriptionPlan}</span>\n              </div>\n            )}\n              </div>\n\n                  {/* Statistiken direkt in der Card */}\n          {stats && (\n                    <>\n            <div className=\"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700\">\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">{t('organization.statistics')}</h3>\n              {loadingStats ? (\n                <div className=\"flex items-center justify-center py-4\">\n                  <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-2\"></div>\n                  <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('common.loadingStatistics')}</span>\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {/* Benutzer Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-blue-100 dark:bg-blue-900/30 rounded-lg p-3\">\n                        <UserGroupIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.users')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats.currentUsers} / {stats.maxUsers}\n                        </p>\n                            {stats.utilizationPercent !== undefined && (\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            {stats.utilizationPercent}% {t('organization.utilizationPercent')}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Rollen Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-purple-100 dark:bg-purple-900/30 rounded-lg p-3\">\n                        <ShieldCheckIcon className=\"h-6 w-6 text-purple-600 dark:text-purple-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.roles')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats._count.roles}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Beitrittsanfragen Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg p-3\">\n                        <EnvelopeIcon className=\"h-6 w-6 text-yellow-600 dark:text-yellow-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.joinRequests')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats._count.joinRequests}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Einladungen Card */}\n                  {stats._count.invitations !== undefined && (\n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 bg-green-100 dark:bg-green-900/30 rounded-lg p-3\">\n                          <EnvelopeIcon className=\"h-6 w-6 text-green-600 dark:text-green-400\" />\n                        </div>\n                        <div className=\"ml-4\">\n                          <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.invitations')}</p>\n                          <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                            {stats._count.invitations}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Auslastung Card */}\n                  {stats.utilizationPercent !== undefined && (\n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg p-3\">\n                          <ChartBarIcon className=\"h-6 w-6 text-indigo-600 dark:text-indigo-400\" />\n                        </div>\n                        <div className=\"ml-4\">\n                          <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.utilization')}</p>\n                          <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                            {stats.utilizationPercent}%\n                          </p>\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            {stats.availableSlots} {t('organization.availableSlots')}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n                    </>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            </>\n          ) : (\n            /* Keine Organisation - zeige Hinweis */\n            <div className=\"text-center py-8\">\n            <UserGroupIcon className=\"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500 mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\n              {t('organization.notFound')}\n            </h3>\n            <p className=\"text-gray-600 dark:text-gray-400\">\n              {t('organization.createOrJoinHint')}\n            </p>\n          </div>\n        )}\n        </>\n      )}\n      </div>\n\n      {/* Meine Beitrittsanfragen - immer anzeigen */}\n      <MyJoinRequestsList />\n\n      {/* Modals */}\n      <CreateOrganizationModal\n        isOpen={isCreateModalOpen}\n        onClose={() => setIsCreateModalOpen(false)}\n        onSuccess={handleCreateSuccess}\n      />\n\n      <JoinOrganizationModal\n        isOpen={isJoinModalOpen}\n        onClose={() => setIsJoinModalOpen(false)}\n        onSuccess={handleJoinSuccess}\n      />\n\n      <EditOrganizationModal\n        isOpen={isEditModalOpen}\n        onClose={handleEditModalClose}\n        onSuccess={handleEditSuccess}\n        organization={organization}\n      />\n    </>\n  );\n};\n\nexport default OrganizationSettings; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon, XCircleIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest, ProcessJoinRequestRequest } from '../../types/organization.ts';\nimport { roleApi } from '../../api/apiClient.ts';\nimport { Role } from '../../types/interfaces.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  joinRequest: OrganizationJoinRequest | null;\n  onSuccess: () => void;\n}\n\nconst ProcessJoinRequestModal: React.FC<Props> = ({ isOpen, onClose, joinRequest, onSuccess }) => {\n  const { t } = useTranslation();\n  const [action, setAction] = useState<'approve' | 'reject'>('approve');\n  const [roleId, setRoleId] = useState<number | null>(null);\n  const [response, setResponse] = useState<string>('');\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState<boolean>(false);\n  const [saving, setSaving] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  useEffect(() => {\n    if (isOpen && joinRequest) {\n      // Reset form when modal opens\n      setAction('approve');\n      setRoleId(null);\n      setResponse('');\n      setErrors({});\n      \n      // Load roles for the organization\n      if (joinRequest.organizationId) {\n        fetchRoles();\n      }\n    }\n  }, [isOpen, joinRequest]);\n\n  const fetchRoles = async () => {\n    try {\n      setLoadingRoles(true);\n      const response = await roleApi.getAll();\n      if (response.data && Array.isArray(response.data)) {\n        setRoles(response.data);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Rollen:', err);\n      showMessage(t('joinRequest.loadRolesError'), 'error');\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (action === 'approve' && !roleId) {\n      newErrors.roleId = t('joinRequest.selectRoleError');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    if (!joinRequest) {\n      return;\n    }\n    \n    try {\n      setSaving(true);\n      const data: ProcessJoinRequestRequest = {\n        action,\n        response: response.trim() || undefined,\n        roleId: action === 'approve' ? roleId || undefined : undefined\n      };\n      \n      await organizationService.processJoinRequest(joinRequest.id, data);\n      showMessage(\n        action === 'approve' ? t('joinRequest.approveSuccess') : t('joinRequest.rejectSuccess'),\n        'success'\n      );\n      \n      // Reset form\n      setAction('approve');\n      setRoleId(null);\n      setResponse('');\n      setErrors({});\n      \n      onClose();\n      onSuccess();\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('joinRequest.processError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleClose = () => {\n    setAction('approve');\n    setRoleId(null);\n    setResponse('');\n    setErrors({});\n    onClose();\n  };\n\n  if (!joinRequest) {\n    return null;\n  }\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('joinRequest.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                {/* Antragsteller Info */}\n                <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                  <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.applicant')}:</p>\n                  <p className=\"text-sm text-gray-900 dark:text-white\">\n                    {joinRequest.requester.firstName} {joinRequest.requester.lastName}\n                  </p>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.requester.email}</p>\n                  {joinRequest.message && (\n                    <div className=\"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.message')}:</p>\n                      <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.message}</p>\n                    </div>\n                  )}\n                </div>\n\n                {/* Aktion (Genehmigen/Ablehnen) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('joinRequest.actionRequired')}\n                  </label>\n                  <div className=\"flex gap-4 mt-2\">\n                    <label className=\"flex items-center\">\n                      <input\n                        type=\"radio\"\n                        value=\"approve\"\n                        checked={action === 'approve'}\n                        onChange={(e) => {\n                          setAction(e.target.value as 'approve' | 'reject');\n                          setErrors({});\n                        }}\n                        className=\"mr-2 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.approve')}</span>\n                    </label>\n                    <label className=\"flex items-center\">\n                      <input\n                        type=\"radio\"\n                        value=\"reject\"\n                        checked={action === 'reject'}\n                        onChange={(e) => {\n                          setAction(e.target.value as 'approve' | 'reject');\n                          setErrors({});\n                        }}\n                        className=\"mr-2 text-red-600 focus:ring-red-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.reject')}</span>\n                    </label>\n                  </div>\n                </div>\n\n                {/* Rollenauswahl (nur bei Genehmigung) */}\n                {action === 'approve' && (\n                  <div>\n                    <label \n                      htmlFor=\"roleId\" \n                      className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                    >\n                      {t('joinRequest.assignRole')}\n                    </label>\n                    {loadingRoles ? (\n                      <div className=\"flex items-center py-2\">\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n                        <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('joinRequest.loadingRoles')}</span>\n                      </div>\n                    ) : (\n                      <select\n                        id=\"roleId\"\n                        value={roleId || ''}\n                        onChange={(e) => {\n                          setRoleId(Number(e.target.value) || null);\n                          if (errors.roleId) {\n                            setErrors(prev => ({ ...prev, roleId: '' }));\n                          }\n                        }}\n                        className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                          errors.roleId \n                            ? 'border-red-300 dark:border-red-600' \n                            : 'border-gray-300 dark:border-gray-600'\n                        }`}\n                      >\n                        <option value=\"\">{t('joinRequest.selectRole')}</option>\n                        {roles.map(role => (\n                          <option key={role.id} value={role.id}>\n                            {role.name} {role.description ? `- ${role.description}` : ''}\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                    {errors.roleId && (\n                      <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.roleId}</p>\n                    )}\n                  </div>\n                )}\n\n                {/* Antwort-Message */}\n                <div>\n                  <label \n                    htmlFor=\"response\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('joinRequest.response')}\n                  </label>\n                  <textarea\n                    id=\"response\"\n                    value={response}\n                    onChange={(e) => setResponse(e.target.value)}\n                    rows={3}\n                    placeholder={t('joinRequest.addOptional', { type: action === 'approve' ? t('joinRequest.welcomeMessage') : t('joinRequest.rejectionReason') })}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={saving}\n                  className={`p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ${\n                    action === 'approve'\n                      ? 'bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500'\n                      : 'bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500'\n                  }`}\n                  title={saving ? (action === 'approve' ? t('joinRequest.approving') : t('joinRequest.rejecting')) : (action === 'approve' ? t('joinRequest.approve') : t('joinRequest.reject'))}\n                >\n                  {saving ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : action === 'approve' ? (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  ) : (\n                    <XCircleIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('joinRequest.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Antragsteller Info */}\n            <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n              <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.applicant')}:</p>\n              <p className=\"text-sm text-gray-900 dark:text-white\">\n                {joinRequest.requester.firstName} {joinRequest.requester.lastName}\n              </p>\n              <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.requester.email}</p>\n              {joinRequest.message && (\n                <div className=\"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600\">\n                  <p className=\"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.message')}:</p>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.message}</p>\n                </div>\n              )}\n            </div>\n\n            {/* Aktion (Genehmigen/Ablehnen) */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('joinRequest.actionRequired')}\n              </label>\n              <div className=\"flex gap-4 mt-2\">\n                <label className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    value=\"approve\"\n                    checked={action === 'approve'}\n                    onChange={(e) => {\n                      setAction(e.target.value as 'approve' | 'reject');\n                      setErrors({});\n                    }}\n                    className=\"mr-2 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.approve')}</span>\n                </label>\n                <label className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    value=\"reject\"\n                    checked={action === 'reject'}\n                    onChange={(e) => {\n                      setAction(e.target.value as 'approve' | 'reject');\n                      setErrors({});\n                    }}\n                    className=\"mr-2 text-red-600 focus:ring-red-500\"\n                  />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.reject')}</span>\n                </label>\n              </div>\n            </div>\n\n            {/* Rollenauswahl (nur bei Genehmigung) */}\n            {action === 'approve' && (\n              <div>\n                <label \n                  htmlFor=\"roleId\" \n                  className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                >\n                  {t('joinRequest.assignRole')}\n                </label>\n                {loadingRoles ? (\n                  <div className=\"flex items-center py-2\">\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n                    <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('joinRequest.loadingRoles')}</span>\n                  </div>\n                ) : (\n                  <select\n                    id=\"roleId\"\n                    value={roleId || ''}\n                    onChange={(e) => {\n                      setRoleId(Number(e.target.value) || null);\n                      if (errors.roleId) {\n                        setErrors(prev => ({ ...prev, roleId: '' }));\n                      }\n                    }}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.roleId \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  >\n                    <option value=\"\">{t('joinRequest.selectRole')}</option>\n                    {roles.map(role => (\n                      <option key={role.id} value={role.id}>\n                        {role.name} {role.description ? `- ${role.description}` : ''}\n                      </option>\n                    ))}\n                  </select>\n                )}\n                {errors.roleId && (\n                  <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.roleId}</p>\n                )}\n              </div>\n            )}\n\n            {/* Antwort-Message */}\n            <div>\n              <label \n                htmlFor=\"response\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('joinRequest.response')}\n              </label>\n              <textarea\n                id=\"response\"\n                value={response}\n                onChange={(e) => setResponse(e.target.value)}\n                rows={3}\n                placeholder={t('joinRequest.addOptional', { type: action === 'approve' ? t('joinRequest.welcomeMessage') : t('joinRequest.rejectionReason') })}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={saving}\n                className={`p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ${\n                  action === 'approve'\n                    ? 'bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500'\n                    : 'bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500'\n                }`}\n                title={saving ? (action === 'approve' ? 'Genehmige...' : 'Lehne ab...') : (action === 'approve' ? 'Genehmigen' : 'Ablehnen')}\n              >\n                {saving ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : action === 'approve' ? (\n                  <CheckIcon className=\"h-5 w-5\" />\n                ) : (\n                  <XCircleIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default ProcessJoinRequestModal;\n\n","import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { UserPlusIcon, FunnelIcon, PencilIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest } from '../../types/organization.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport ProcessJoinRequestModal from './ProcessJoinRequestModal.tsx';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\nimport { logger } from '../../utils/logger.ts';\n\n// Status-Badge Funktionen\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case 'pending':\n      return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';\n    case 'approved':\n      return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\n    case 'rejected':\n      return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\n    case 'withdrawn':\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n    default:\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n  }\n};\n\nconst getStatusText = (status: string, t: any) => {\n  switch (status) {\n    case 'pending':\n      return t('joinRequestsList.status.pending');\n    case 'approved':\n      return t('joinRequestsList.status.approved');\n    case 'rejected':\n      return t('joinRequestsList.status.rejected');\n    case 'withdrawn':\n      return t('joinRequestsList.status.withdrawn');\n    default:\n      return status;\n  }\n};\n\nconst JOIN_REQUESTS_TABLE_ID = 'join-requests-table';\n\nconst JoinRequestsList: React.FC = () => {\n  const { t } = useTranslation();\n  const [joinRequests, setJoinRequests] = useState<OrganizationJoinRequest[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState<boolean>(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [isProcessModalOpen, setIsProcessModalOpen] = useState<boolean>(false);\n  const [selectedRequest, setSelectedRequest] = useState<OrganizationJoinRequest | null>(null);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  const { canViewJoinRequests, canManageJoinRequests, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  const mountedRef = useRef(true);\n  const hasInitialLoadRef = useRef(false);\n\n  // Debug: Log permissionsLoading nderungen\n  useEffect(() => {\n    logger.log('[JoinRequestsList] permissionsLoading gendert:', permissionsLoading);\n  }, [permissionsLoading]);\n\n  // Reset beim Mount - wichtig fr Neuladen wenn Komponente neu gemountet wird\n  useEffect(() => {\n    logger.log('[JoinRequestsList] Component mounted, reset hasInitialLoadRef');\n    hasInitialLoadRef.current = false;\n    mountedRef.current = true;\n    \n    return () => {\n      logger.log('[JoinRequestsList] Component unmounting');\n      mountedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    logger.log('[JoinRequestsList] useEffect triggered', { \n      permissionsLoading, \n      hasInitialLoad: hasInitialLoadRef.current,\n      joinRequestsCount: joinRequests.length \n    });\n    \n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      logger.log('[JoinRequestsList] Warte auf Berechtigungen...');\n      return;\n    }\n\n    // Prfe Berechtigung direkt\n    const hasPermission = canViewJoinRequests();\n    logger.log('[JoinRequestsList] Berechtigung geprft:', hasPermission);\n    \n    if (!hasPermission) {\n      logger.log('[JoinRequestsList] Keine Berechtigung zum Anzeigen');\n      setError(t('joinRequestsList.noPermission'));\n      setLoading(false);\n      hasInitialLoadRef.current = true;\n      return;\n    }\n\n    // WICHTIG: Nur laden wenn noch nicht erfolgreich geladen wurde\n    // Das verhindert unntige Re-Fetches bei jedem permissionsLoading-Change\n    if (hasInitialLoadRef.current) {\n      logger.log('[JoinRequestsList] Bereits geladen, berspringe Fetch');\n      return;\n    }\n\n    logger.log('[JoinRequestsList] Starte Fetch der Join Requests...');\n    \n    const fetchJoinRequests = async () => {\n      if (!mountedRef.current) {\n        logger.log('[JoinRequestsList] Component unmounted, breche ab');\n        return;\n      }\n      \n      try {\n        logger.log('[JoinRequestsList] Setze loading auf true');\n        setLoading(true);\n        setError(null);\n        \n        logger.log('[JoinRequestsList] Rufe organizationService.getJoinRequests() auf...');\n        logger.log('[JoinRequestsList] API Endpoint:', API_ENDPOINTS.ORGANIZATIONS.JOIN_REQUESTS);\n        \n        const requests = await organizationService.getJoinRequests();\n        \n        logger.log('[JoinRequestsList] Antwort erhalten:', requests);\n        logger.log('[JoinRequestsList] Antwort Typ:', typeof requests);\n        logger.log('[JoinRequestsList] Ist Array:', Array.isArray(requests));\n        logger.log('[JoinRequestsList] Ist null/undefined:', requests === null || requests === undefined);\n        \n        if (!mountedRef.current) {\n          logger.log('[JoinRequestsList] Component whrend Request unmounted');\n          return;\n        }\n        \n        // Validiere, dass die Antwort vorhanden ist\n        if (requests === null || requests === undefined) {\n          console.error('[JoinRequestsList]  Antwort ist null oder undefined!');\n          throw new Error('Ungltige Antwort vom Server: Antwort ist null oder undefined');\n        }\n        \n        // Validiere, dass die Antwort ein Array ist\n        if (!Array.isArray(requests)) {\n          console.error('[JoinRequestsList]  Antwort ist kein Array!', requests);\n          throw new Error('Ungltige Antwort vom Server: Erwartetes Array, erhalten: ' + typeof requests);\n        }\n        \n        logger.log('[JoinRequestsList]  Setze', requests.length, 'Join Requests');\n        setJoinRequests(requests);\n        setError(null); // Fehler zurcksetzen bei Erfolg\n        hasInitialLoadRef.current = true; // Nur bei Erfolg setzen\n      } catch (err: any) {\n        console.error('[JoinRequestsList]  Fehler beim Laden:', err);\n        console.error('[JoinRequestsList] Fehler Details:', {\n          message: err.message,\n          response: err.response,\n          status: err.response?.status,\n          data: err.response?.data,\n          stack: err.stack\n        });\n        \n        if (!mountedRef.current) {\n          logger.log('[JoinRequestsList] Component whrend Error-Handling unmounted');\n          return;\n        }\n        \n        const errorMessage = err.response?.data?.message || err.message || t('joinRequestsList.loadError', { defaultValue: 'Fehler beim Laden der Beitrittsanfragen' });\n        logger.log('[JoinRequestsList] Zeige Fehlermeldung:', errorMessage);\n        setError(errorMessage);\n        // showMessage nur auerhalb useEffect verwenden, um Re-Renders zu vermeiden\n        // Verwende setTimeout, um es asynchron auszufhren\n        setTimeout(() => {\n          showMessage(errorMessage, 'error');\n        }, 0);\n        // Bei Fehler NICHT hasInitialLoadRef setzen, damit bei nchstem permissionsLoading-Change neu geladen wird\n      } finally {\n        if (mountedRef.current) {\n          logger.log('[JoinRequestsList] Setze loading auf false');\n          setLoading(false);\n        }\n      }\n    };\n\n    fetchJoinRequests();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [permissionsLoading]); // canViewJoinRequests ist eine Funktion, nicht als Dependency\n\n  const handleOpenProcessModal = (request: OrganizationJoinRequest) => {\n    if (!canManageJoinRequests()) {\n      const errorMessage = t('joinRequestsList.noPermissionEdit');\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n      return;\n    }\n    setSelectedRequest(request);\n    setIsProcessModalOpen(true);\n  };\n\n  const handleProcessSuccess = async () => {\n    // Neulade die Liste nach erfolgreicher Bearbeitung\n    // Reset das Flag, damit neu geladen werden kann\n    hasInitialLoadRef.current = false;\n    \n    try {\n      setLoading(true);\n      const requests = await organizationService.getJoinRequests();\n      setJoinRequests(requests);\n      setError(null);\n      hasInitialLoadRef.current = true;\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || 'Fehler beim Laden der Beitrittsanfragen';\n      setError(errorMessage);\n      hasInitialLoadRef.current = true;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Filter-Funktionen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n\n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n  \n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  useEffect(() => {\n    const initialize = async () => {\n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(JOIN_REQUESTS_TABLE_ID);\n      \n      // 2. Default-Filter anwenden (IMMER vorhanden!)\n      const defaultFilter = filters.find(f => f.name === 'Alle');\n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        return; // Filter wird angewendet\n      }\n      \n      // 3. Fallback: Kein Filter (sollte nie passieren)\n      // fetchJoinRequests wird bereits durch useEffect aufgerufen\n    };\n    \n    initialize();\n  }, [loadFilters, handleFilterChange]);\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  //  PERFORMANCE: Filter werden von SavedFilterTags geladen (FilterContext)\n  //  PERFORMANCE: Standard-Filter wird im Seed erstellt (nicht mehr im Frontend)\n  // Keine redundanten API-Calls mehr ntig\n\n  // Gefilterte Join-Requests\n  const filteredJoinRequests = useMemo(() => {\n    let filtered = [...joinRequests];\n\n    // Suchfeld-Filter\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(request => {\n        const requesterName = `${request.requester.firstName} ${request.requester.lastName}`.toLowerCase();\n        const requesterEmail = request.requester.email?.toLowerCase() || '';\n        const message = request.message?.toLowerCase() || '';\n        return requesterName.includes(searchLower) || requesterEmail.includes(searchLower) || message.includes(searchLower);\n      });\n    }\n\n    // Filter-Bedingungen aus FilterPane\n    if (filterConditions.length > 0) {\n      filtered = filterConditions.reduce((acc, condition, index) => {\n        if (!condition.column || condition.value === null || condition.value === '') {\n          return acc;\n        }\n\n        const operator = condition.operator;\n        const value = condition.value;\n\n        return acc.filter(request => {\n          switch (condition.column) {\n            case 'requester':\n              const requesterName = `${request.requester.firstName} ${request.requester.lastName}`.toLowerCase();\n              const requesterEmail = request.requester.email?.toLowerCase() || '';\n              const searchValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return requesterName.includes(searchValue) || requesterEmail.includes(searchValue);\n              } else if (operator === 'equals') {\n                return requesterName === searchValue || requesterEmail === searchValue;\n              } else if (operator === 'startsWith') {\n                return requesterName.startsWith(searchValue) || requesterEmail.startsWith(searchValue);\n    }\n              return false;\n\n            case 'message':\n              const message = request.message?.toLowerCase() || '';\n              const msgValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return message.includes(msgValue);\n              } else if (operator === 'equals') {\n                return message === msgValue;\n              } else if (operator === 'startsWith') {\n                return message.startsWith(msgValue);\n              }\n              return false;\n\n            case 'status':\n              if (operator === 'equals') {\n                return request.status === value;\n              }\n              return false;\n\n            default:\n              return true;\n          }\n        });\n      }, filtered);\n    }\n\n    return filtered;\n  }, [joinRequests, searchTerm, filterConditions, filterLogicalOperators]);\n\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('joinRequestsList.loadingPermissions')}</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canViewJoinRequests()) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n      <div className=\"p-4 text-red-600 dark:text-red-400\">\n        {t('joinRequestsList.noPermission')}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 sm:p-6 mb-6\">\n      {/* Titelzeile mit Icon, Suchfeld, Filter-Button */}\n      <div className=\"flex items-center justify-between mb-4 sm:mb-4\">\n        <h2 className=\"text-xl sm:text-xl font-semibold flex items-center dark:text-white\">\n          <UserPlusIcon className=\"h-6 w-6 sm:h-6 sm:w-6 mr-2 sm:mr-2\" />\n          {t('joinRequestsList.title')}\n        </h2>\n        \n        <div className=\"flex items-center gap-1.5\">\n          {/* Suchfeld */}\n          <input\n            type=\"text\"\n            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n\n          {/* Filter-Button */}\n          <button\n            className={`p-2 rounded-md border ${getActiveFilterCount() > 0 ? 'border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n            onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n            title={t('common.filter')}\n          >\n            <FunnelIcon className=\"h-5 w-5\" />\n            {getActiveFilterCount() > 0 && (\n              <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                {getActiveFilterCount()}\n              </span>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Filter-Panel */}\n      {isFilterPanelOpen && (\n        <div className=\"mb-4\">\n          <FilterPane\n            columns={[\n              { id: 'requester', label: t('joinRequestsList.filter.requester') },\n              { id: 'message', label: t('joinRequestsList.filter.message') },\n              { id: 'status', label: t('joinRequestsList.status.title', { defaultValue: 'Status' }) }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={JOIN_REQUESTS_TABLE_ID}\n          />\n        </div>\n      )}\n\n      {/* Gespeicherte Filter als Tags anzeigen */}\n      <SavedFilterTags\n        tableId={JOIN_REQUESTS_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n        defaultFilterName=\"Alle\"\n      />\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded\">\n          {error}\n        </div>\n      )}\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('joinRequestsList.loading')}</span>\n        </div>\n      ) : filteredJoinRequests.length === 0 ? (\n        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n          {joinRequests.length === 0 \n            ? t('joinRequestsList.noRequests')\n            : t('joinRequestsList.noMatching')}\n        </div>\n      ) : (\n        /* Cards fr Join-Requests */\n        <div className=\"space-y-4\">\n          {filteredJoinRequests.map(request => (\n            <div\n              key={request.id}\n              className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\"\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                        {request.requester.firstName} {request.requester.lastName}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        {request.requester.email}\n              </p>\n                    </div>\n                    <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(request.status)}`}>\n                      {getStatusText(request.status, t)}\n                    </span>\n                  </div>\n\n                  {request.message && (\n                    <div className=\"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.filter.message')}:</span> {request.message}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.response && (\n                    <div className=\"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700\">\n                      <p className=\"text-sm text-blue-700 dark:text-blue-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.response')}:</span> {request.response}\n                      </p>\n                    </div>\n                  )}\n\n              {request.status === 'pending' && canManageJoinRequests() && (\n                    <div className=\"mt-4 flex items-center gap-2\">\n                  <button \n                        onClick={() => handleOpenProcessModal(request)}\n                        className=\"p-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                        title={t('joinRequestsList.edit')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Process Join Request Modal */}\n      <ProcessJoinRequestModal\n        isOpen={isProcessModalOpen}\n        onClose={() => {\n          setIsProcessModalOpen(false);\n          setSelectedRequest(null);\n        }}\n        joinRequest={selectedRequest}\n        onSuccess={handleProcessSuccess}\n      />\n    </div>\n  );\n};\n\nexport default JoinRequestsList; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { UserGroupIcon, UserIcon, ShieldCheckIcon, MapPinIcon, TruckIcon, CalendarIcon } from '@heroicons/react/24/outline';\nimport UserManagementTab from '../components/UserManagementTab.tsx';\nimport RoleManagementTab from '../components/RoleManagementTab.tsx';\nimport BranchManagementTab from '../components/BranchManagementTab.tsx';\nimport TourProvidersTab from '../components/tours/TourProvidersTab.tsx';\nimport ToursTab from '../components/tours/ToursTab.tsx';\nimport useMessage from '../hooks/useMessage.ts';\nimport OrganizationSettings from '../components/organization/OrganizationSettings.tsx';\nimport JoinRequestsList from '../components/organization/JoinRequestsList.tsx';\n\nconst Organisation: React.FC = () => {\n  const { t } = useTranslation();\n  // Gemeinsame States\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const { showMessage } = useMessage();\n\n  const { \n    isAdmin, \n    hasPermission, \n    canViewOrganization,\n    loading: permissionsLoading\n  } = usePermissions();\n\n  // Berechtigungen prfen\n  const canViewOrganisation = hasPermission('organization_management', 'read', 'page');\n  const canViewUsers = hasPermission('users', 'read', 'table');\n  const canViewRoles = hasPermission('roles', 'read', 'table');\n  const canViewBranches = hasPermission('branches', 'read', 'table');\n  const canViewProviders = hasPermission('tour_providers', 'read', 'table');\n  const canViewOrg = canViewOrganization();\n\n  const [activeTabState, setActiveTabState] = useState<'users' | 'roles' | 'branches' | 'providers' | 'organization'>('users');\n  const [providersViewMode, setProvidersViewMode] = useState<'tours' | 'providers'>('tours');\n  const isInitialized = useRef(false);\n\n  // Tab beim ersten Laden basierend auf Berechtigungen setzen (nur wenn Berechtigungen geladen sind)\n  // Reihenfolge: users -> roles -> branches -> providers -> organization\n  useEffect(() => {\n    if (!permissionsLoading && !isInitialized.current) {\n      let defaultTab: 'users' | 'roles' | 'branches' | 'providers' | 'organization' = 'organization'; // Fallback\n      \n      if (canViewUsers) {\n        defaultTab = 'users';\n      } else if (canViewRoles) {\n        defaultTab = 'roles';\n      } else if (canViewBranches) {\n        defaultTab = 'branches';\n      } else if (canViewProviders) {\n        defaultTab = 'providers';\n      } else if (canViewOrg) {\n        defaultTab = 'organization';\n      }\n      \n      setActiveTabState(defaultTab);\n      isInitialized.current = true;\n    }\n  }, [permissionsLoading, canViewUsers, canViewRoles, canViewBranches, canViewProviders, canViewOrg]);\n\n  // Tab-Wechsel Handler - Fehler beim Wechsel zurcksetzen\n  const handleTabChange = (tab: 'users' | 'roles' | 'branches' | 'providers' | 'organization') => {\n    // Prfe Berechtigung fr den Tab\n    if (tab === 'users' && !canViewUsers) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'roles' && !canViewRoles) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'branches' && !canViewBranches) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'providers' && !canViewProviders) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'organization' && !canViewOrg) {\n      return; // Tab nicht aktivierbar\n    }\n    setActiveTabState(tab);\n    setError(null);\n  };\n\n  // Gemeinsame Fehlerbehandlung entfernt - ErrorContext wird jetzt verwendet\n\n  // Keine Berechtigung fr die Seite\n  if (!canViewOrganisation) {\n    return <div className=\"p-4 text-red-600 dark:text-red-400\">{t('organisation.noPermission')}</div>;\n  }\n\n  return (\n    <div className=\"min-h-screen dark:bg-gray-900\">\n      <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          {/* Header mit Icon */}\n          <div className=\"flex items-center mb-6\">\n            <UserGroupIcon className=\"h-6 w-6 mr-2 dark:text-white\" />\n            <h2 className=\"text-xl font-semibold dark:text-white\">{t('organisation.title')}</h2>\n          </div>\n\n          {/* Tabs fr Navigation */}\n          <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n            <nav className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden\">\n              {/* Users Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'users' && canViewUsers\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewUsers\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                onClick={() => canViewUsers && handleTabChange('users')}\n                disabled={!canViewUsers}\n              >\n                <UserIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                {t('organisation.tabs.users')}\n                {!canViewUsers && (\n                  <span className=\"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Roles Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'roles' && canViewRoles\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewRoles\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                onClick={() => canViewRoles && handleTabChange('roles')}\n                disabled={!canViewRoles}\n              >\n                <ShieldCheckIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                {t('organisation.tabs.roles')}\n                {!canViewRoles && (\n                  <span className=\"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Branches Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'branches' && canViewBranches\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewBranches\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                onClick={() => canViewBranches && handleTabChange('branches')}\n                disabled={!canViewBranches}\n              >\n                <MapPinIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                {t('organisation.tabs.branches', { defaultValue: 'Niederlassungen' })}\n                {!canViewBranches && (\n                  <span className=\"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Providers Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'providers' && canViewProviders\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewProviders\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                onClick={() => canViewProviders && handleTabChange('providers')}\n                disabled={!canViewProviders}\n              >\n                <TruckIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                {t('organisation.tabs.providers', { defaultValue: 'Proveedores' })}\n                {!canViewProviders && (\n                  <span className=\"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Organization Tab - sichtbar wenn berechtigt */}\n              {canViewOrg && (\n                <button\n                  className={`${\n                    activeTabState === 'organization'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                  } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center flex-shrink-0`}\n                  onClick={() => handleTabChange('organization')}\n                >\n                  <UserGroupIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                  {t('organisation.tabs.organization')}\n                </button>\n              )}\n            </nav>\n          </div>\n\n          {error && (\n            <div className=\"bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded mb-4\">\n              <p className=\"font-bold\">{t('organisation.error')}</p>\n              <p>{error}</p>\n            </div>\n          )}\n\n          {loading && <div className=\"p-4 dark:text-gray-300\">{t('organisation.loading')}</div>}\n\n          {/* Tab Inhalte */}\n          <div className=\"mt-6\">\n            {activeTabState === 'users' ? (\n              canViewUsers ? (\n                <UserManagementTab />\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.users')}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'roles' ? (\n              canViewRoles ? (\n                <RoleManagementTab />\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.roles')}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'branches' ? (\n              canViewBranches ? (\n                <BranchManagementTab />\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.branches', { defaultValue: 'Niederlassungs-Verwaltung ist eine PRO-Funktion' })}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'providers' ? (\n              canViewProviders ? (\n                <div className=\"space-y-4\">\n                  {/* Switch fr Tours/Providers */}\n                  <div className=\"flex gap-2 mb-4\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setProvidersViewMode('tours')}\n                      className={`p-2 rounded-md transition-colors ${\n                        providersViewMode === 'tours'\n                          ? 'bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400'\n                          : 'text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700'\n                      }`}\n                      title={t('tours.title', 'Touren')}\n                    >\n                      <CalendarIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={() => setProvidersViewMode('providers')}\n                      className={`p-2 rounded-md transition-colors ${\n                        providersViewMode === 'providers'\n                          ? 'bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400'\n                          : 'text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700'\n                      }`}\n                      title={t('organisation.tabs.providers', { defaultValue: 'Proveedores' })}\n                    >\n                      <TruckIcon className=\"h-5 w-5\" />\n                    </button>\n                  </div>\n                  \n                  {/* Bedingtes Rendering */}\n                  {providersViewMode === 'tours' ? (\n                    <ToursTab />\n                  ) : (\n                    <TourProvidersTab />\n                  )}\n                </div>\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.providers', { defaultValue: 'Tour-Provider-Verwaltung ist eine PRO-Funktion' })}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'organization' && canViewOrg ? (\n              <div className=\"space-y-6\">\n                <OrganizationSettings />\n                <JoinRequestsList />\n              </div>\n            ) : (\n              <div className=\"p-4 text-red-600 dark:text-red-400\">\n                {t('organisation.noPermissionForPage')}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Organisation;\n\n\n"],"names":["_ref","children","columns","mobile","tablet","desktop","largeDesktop","gap","className","gapClass","sm","md","lg","_jsx","concat","getLocalStorageKey","tableId","tableSettingsApi","async","axiosInstance","get","data","error","console","localStorageKey","storedSettings","localStorage","getItem","JSON","parse","localError","columnOrder","hiddenColumns","post","settings","setItem","stringify","useTableSettings","options","setSettings","useState","defaultColumnOrder","defaultHiddenColumns","isLoading","setIsLoading","setError","useEffect","isMounted","loadedSettings","logger","log","length","viewMode","defaultViewMode","needsSave","sortConfig","defaultSortConfig","catch","err","Error","loadSettings","updateColumnOrder","useCallback","updatedSettings","_objectSpread","newColumnOrder","updateHiddenColumns","prevSettings","newHiddenColumns","toggleColumnVisibility","includes","columnId","filter","id","updateViewMode","newViewMode","updateSortConfig","newSortConfig","isColumnVisible","evaluateCondition","fieldValue","condition","operator","value","undefined","strField","strValue","fieldValueStr","String","lowerField","toLowerCase","valueStr","lowerValue","startsWith","typeof","endsWith","fieldDate","Date","valueDate","isNaN","getTime","fieldNum","parseFloat","valueNum","applyFilters","items","conditions","operators","getFieldValue","columnEvaluators","item","result","i","conditionMet","column","customResult","evaluateDateCondition","dateValue","date","dateYear","getUTCFullYear","dateMonth","getUTCMonth","dateDay","getUTCDate","normalizedDate","weekStart","startOfWeek","weekStartsOn","setHours","weekEnd","endOfWeek","monthStart","startOfMonth","monthEnd","endOfMonth","yearStart","startOfYear","yearEnd","endOfYear","conditionDate","localToday","conditionDateRaw","conditionYear","conditionMonth","conditionDay","evaluateUserRoleCondition","userId","roleId","textValue","targetUserId","parseInt","replace","matches","targetRoleId","textValueLower","valueLower","isOpen","onClose","onBookingCreated","tour","preselectedTour","t","useTranslation","user","useAuth","showMessage","useMessage","tourId","setTourId","tourDate","setTourDate","numberOfParticipants","setNumberOfParticipants","customerName","setCustomerName","customerEmail","setCustomerEmail","customerPhone","setCustomerPhone","customerNotes","setCustomerNotes","tours","setTours","selectedTour","setSelectedTour","loading","setLoading","loadingData","setLoadingData","_response$data","response","API_ENDPOINTS","TOURS","BASE","params","isActive","toursData","Array","isArray","loadData","find","Number","_jsxs","Dialog","open","Panel","Title","defaultValue","onClick","XMarkIcon","onSubmit","e","preventDefault","trim","numPart","minParticipants","min","max","maxParticipants","_response$data2","_response$data3","TOUR_BOOKINGS","_response$data4","success","message","_response","_response$data5","errorMessage","onChange","target","required","disabled","title","map","type","rows","CheckIcon","DraggableColumnItem","label","index","isVisible","onToggleVisibility","sortDirection","onSortDirectionChange","showMainSort","isMainSort","stopPropagation","ArrowUpIcon","ArrowDownIcon","ArrowsUpDownIcon","EyeIcon","EyeSlashIcon","_ref2","visibleColumns","onToggleColumnVisibility","onMoveColumn","buttonTitle","modalTitle","mainSortConfig","onMainSortChange","externalIsOpen","onOpenChange","defaultButtonTitle","defaultModalTitle","internalIsOpen","setInternalIsOpen","menuRef","useRef","sortedColumns","sort","a","b","indexA","indexOf","indexB","handleClose","handleOpen","handleClickOutside","event","current","contains","document","addEventListener","removeEventListener","handleKeyDown","key","ref","xmlns","viewBox","fill","fillRule","d","clipRule","role","direction","showSortButton","onCertificateCreated","userName","currentUser","isHR","isAdmin","permissionsLoading","usePermissions","openSidepane","closeSidepane","useSidepane","isMobile","setIsMobile","window","innerWidth","isLargeScreen","setIsLargeScreen","activeTab","setActiveTab","userData","setUserData","issueDate","setIssueDate","toISOString","split","certificateType","setCertificateType","pdfFile","setPdfFile","pdfPreviewUrl","setPdfPreviewUrl","uploading","setUploading","availableTemplates","setAvailableTemplates","selectedTemplate","setSelectedTemplate","useTemplate","setUseTemplate","fileInputRef","handleResize","fetchUserData","fetchTemplates","documentTemplates","ORGANIZATION_LIFECYCLE","DOCUMENT_TEMPLATES","templates","employmentCertificate","push","version","path","userResponse","lifecycleResponse","Promise","all","USERS","BY_ID","LIFECYCLE","BY_USER","lifecycle","userDataObj","firstName","lastName","identificationNumber","contractStartDate","contractEndDate","contractType","salary","position","URL","revokeObjectURL","style","animation","DocumentTextIcon","_Fragment","UserIcon","CalendarIcon","toLocaleDateString","checked","template","accept","_event$target$files","file","files","size","url","createObjectURL","name","toFixed","_fileInputRef$current","click","src","height","validationError","validateForm","issueDateObj","pdfPath","templateUsed","templateVersion","now","certificateData","CERTIFICATES","_err$response","_err$response$data","ArrowPathIcon","onContractCreated","setContractType","startDate","setStartDate","endDate","setEndDate","setSalary","workingHours","setWorkingHours","setPosition","employmentContract","toString","placeholder","CurrencyDollarIcon","step","startDateObj","endDateObj","contractData","CONTRACTS","onCertificateUpdated","certificate","existingPdfUrl","setExistingPdfUrl","CERTIFICATE_DOWNLOAD","handleSubmit","updateData","put","CERTIFICATE","onContractUpdated","contract","CONTRACT_DOWNLOAD","CONTRACT","lifecycleId","onUpdate","isLegal","registrations","setRegistrations","arl","eps","pension","caja","editingType","setEditingType","formData","setFormData","status","registrationNumber","provider","registrationDate","notes","saving","setSaving","loadingRef","abortControllerRef","loadRegistrations","abort","abortController","AbortController","registrationPromises","signal","aborted","registration","SOCIAL_SECURITY","timeout","_error$response","_error$message","code","warn","results","newRegistrations","forEach","registrationType","number","registeredAt","completedAt","handleCancel","handleSave","resolve","setTimeout","_error$response2","_error$response2$data","getStatusIcon","CheckCircleIcon","ClockIcon","XCircleIcon","getStatusLabel","labelKey","getTypeLabel","isEditing","handleEdit","PencilIcon","onOffboardingStarted","exitDate","setExitDate","exitReason","setExitReason","validationErrors","setValidationErrors","today","errors","selectedDate","maxDate","setFullYear","getFullYear","Object","keys","STATUS","renderForm","ExclamationTriangleIcon","htmlFor","prev","ArrowRightIcon","opacity","transition","pointerEvents","onOffboardingCompleted","offboardingTasks","confirmText","setConfirmText","completedTasks","task","allTasksCompleted","requiredConfirmText","isCompleted","_lifecycleData$lifecy","lifecycleData","setLifecycleData","certificates","setCertificates","contracts","setContracts","setOffboardingTasks","isCertificateCreateModalOpen","setIsCertificateCreateModalOpen","isContractCreateModalOpen","setIsContractCreateModalOpen","editingCertificate","setEditingCertificate","editingContract","setEditingContract","downloadingCertId","setDownloadingCertId","downloadingContractId","setDownloadingContractId","isOffboardingStartModalOpen","setIsOffboardingStartModalOpen","isOffboardingCompleteModalOpen","setIsOffboardingCompleteModalOpen","isEditContractDatesModalOpen","setIsEditContractDatesModalOpen","editingContractStartDate","setEditingContractStartDate","editingContractEndDate","setEditingContractEndDate","fetchDataRef","isMountedRef","retryTimeoutRef","statusChangeTimeoutRef","fetchData","force","arguments","_certsResponse$data","_contractsResponse$da","_lifecycleResponse$da","_lifecycleResponse$da2","_lifecycleResponse$da3","_lifecycleResponse$da4","certsResponse","contractsResponse","tasksResponse","TASKS","allTasks","offboardingTaskTitles","filteredTasks","progress","percent","clearTimeout","handleEditContractDates","formatDate","dateString","year","month","day","socialSecurityRegistrations","BuildingOfficeIcon","clickable","config","onboarding","color","active","contract_change","offboarding","archived","getStatusBadge","onboardingStartedAt","onboardingCompletedAt","offboardingStartedAt","completed","total","width","totalTasks","Math","round","description","PlusIcon","cert","isLatest","generatedByUser","certId","responseType","blob","Blob","downloadUrl","link","createElement","href","download","body","appendChild","removeChild","handleDownloadCertificate","ArrowDownTrayIcon","toLocaleString","currency","contractId","handleDownloadContract","SocialSecurityEditor","CertificateCreationModal","ContractCreationModal","CertificateEditModal","ContractEditModal","OffboardingStartModal","OffboardingCompleteModal","CONTRACT_TYPES","UserManagementTab","handleError","handleErrorContext","useError","COUNTRIES","PAYROLL_COUNTRIES","LANGUAGES","users","setUsers","selectedUser","setSelectedUser","userFormData","setUserFormData","isEditingUser","setIsEditingUser","selectedRoles","setSelectedRoles","lifecycleRefreshKey","setLifecycleRefreshKey","isDebugMode","setIsDebugMode","roleWarning","setRoleWarning","roles","setRoles","loadingRoles","setLoadingRoles","branches","setBranches","loadingBranches","setLoadingBranches","selectedBranches","setSelectedBranches","activeUserTab","setActiveUserTab","userFilterTab","setUserFilterTab","isUploading","setIsUploading","documentListRef","isCreateModalOpen","setIsCreateModalOpen","newUserFormData","setNewUserFormData","email","password","allUsers","setAllUsers","fetchAllUsers","userApi","getAll","filterUsersByActiveStatus","sorted","aUsername","username","bUsername","aFirstName","bFirstName","localeCompare","fetchUserDetails","getById","birthday","roleIds","userRole","r","branchIds","branch","userBranch","branchId","fallbackRoles","permissions","roleApi","fetchRoles","branchApi","fetchBranches","handleUserInputChange","finalValue","toggleRole","isRoleSelected","newSelectedRoles","updateRoles","toggleBranch","isBranchSelected","newSelectedBranches","updateBranches","handleNewUserInputChange","handleCreateUser","match","create","newUser","prevUsers","_err$response5","_err$response5$data","UserCircleIcon","ShieldCheckIcon","MapPinIcon","_userFormData$usernam","_userFormData$email","dataToSend","bankDetails","gender","phoneNumber","language","hourlyRate","monthlySalary","payrollCountry","update","updatedData","_err$response2","_err$response4","_err$response3","_err$response3$data","errorMsg","handleDirectDocumentUpload","_documentListRef$curr","loadDocuments","_COUNTRIES$find","latestDoc","identificationDocuments","readOnly","country","c","documentType","passport","national_id","driving_license","residence_permit","work_permit","tax_id","social_security","documentNumber","expiryDate","issuingCountry","issuingAuthority","handleCancelEdit","currentUserId","currentActiveStatus","newActiveStatus","selectedUserActive","updatePayload","updatedAllUsers","IdentificationDocumentList","some","ids","join","isFixedRole","LifecycleView","alwaysVisiblePages","defaultPages","defaultTables","defaultButtons","tableToPageMapping","buttonToPageMapping","buttonToTableMapping","ROLES_TABLE_ID","STANDARD_ROLE_IDS","STANDARD_ROLE_NAMES","isStandardRole","roleName","RoleCard","onEdit","onDelete","onCopy","canEdit","canDelete","canCopy","DocumentDuplicateIcon","TrashIcon","allBranches","perm","accessLevel","slice","permission","entity","entityType","onRolesChange","onError","isModalOpen","setIsModalOpen","editingRole","setEditingRole","pageDisplayNames","useMemo","tableDisplayNames","buttonDisplayNames","page","table","button","hasPermission","searchTerm","setSearchTerm","isFilterModalOpen","setIsFilterModalOpen","setAllBranches","selectedBranchIds","setSelectedBranchIds","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","onErrorRef","errorContext","context","handleValidationError","fieldErrors","isAddPermissionModalOpen","setIsAddPermissionModalOpen","selectedPermission","setSelectedPermission","displayLimit","setDisplayLimit","component","action","filteredPermissions","category","ErrorCategory","PERMISSION","updateError","meta","cause","createError","resetForm","handleDelete","confirm","delete","deleteError","refreshError","handleCopyRole","copiedRoleData","prevRoles","prepareRoleForEditing","allPermissions","existingPermIndex","findIndex","p","_branchData$branches","branchData","getRoleBranches","setAllPagePermissions","newPermissions","permIndex","setAllTablePermissions","setAllButtonPermissions","getActiveFilterCount","filteredAndSortedRoles","searchLower","roleNameLower","nameConditionValueLower","roleDescLower","descConditionValueLower","count","existingFilters","SAVED_FILTERS","BY_TABLE","alleFilter","createStandardFilters","filterContext","useFilterContext","loadFilters","applyFilterConditions","resetFilterConditions","handleFilterChange","defaultFilter","f","initialize","FunnelIcon","FilterPane","onApply","onReset","savedConditions","savedOperators","SavedFilterTags","onSelectFilter","onFilterChange","defaultFilterName","prevLimit","ChevronDownIcon","tablePerm","aName","bName","priorityOrder","aIndex","bIndex","tableIndex","tablePermIndex","isTableActive","tableEntity","tableDisplayName","relatedButtons","buttonPerm","order","buttonIndex","buttonPermIndex","isButtonActive","buttonDisplayName","roomDescriptions","setRoomDescriptions","editingCategoryId","setEditingCategoryId","editForm","setEditForm","text","imageUrl","videoUrl","rooms","setRooms","loadingRooms","setLoadingRooms","loadRoomDescriptions","BRANCHES","ROOM_DESCRIPTIONS","RESERVATION","limit","categoryMap","Map","reservation","categoryId","roomNumber","isDorm","roomType","roomName","has","set","roomsArray","from","entries","loadRooms","updatedDescriptions","alert","room","rel","BranchCard","BRANCHES_TABLE_ID","BranchManagementTab","editingBranch","setEditingBranch","address","city","whatsappSettings","apiKey","apiSecret","phoneNumberId","ai","enabled","model","systemPrompt","rules","sources","temperature","maxTokens","lobbyPmsSettings","apiUrl","propertyId","syncEnabled","autoCreateTasks","lateCheckInThreshold","notificationChannels","autoSendInvitation","boldPaymentSettings","merchantId","environment","doorSystemSettings","clientId","clientSecret","lockIds","appName","emailSettings","smtpHost","smtpPort","smtpUser","smtpPass","smtpFromEmail","smtpFromName","imap","host","port","secure","folder","processedFolder","messageTemplates","checkInInvitation","en","whatsappTemplateName","whatsappTemplateParams","emailSubject","emailContent","es","de","checkInConfirmation","autoSendReservationInvitation","activeSettingsTab","setActiveSettingsTab","showSecrets","setShowSecrets","selectedTemplateType","setSelectedTemplateType","selectedLanguage","setSelectedLanguage","canCreate","sireSettings","autoRegisterOnCheckIn","propertyCode","existingWhatsapp","existingLobbyPms","existingBoldPayment","existingDoorSystem","existingEmail","existingMessageTemplates","existingAutoSend","_hasEncryptedValues","handleCloseModal","UPDATE","CREATE","DELETE","filteredAndSortedBranches","branchNameLower","conditionValueLower","handleCreate","autoFocus","tab","whatsappApiKey","stroke","strokeLinecap","strokeLinejoin","strokeWidth","whatsappApiSecret","s","RoomDescriptionsSection","emailSmtpPass","emailImapPass","_formData$messageTemp","_formData$messageTemp2","currentTemplate","_formData$messageTemp3","_formData$messageTemp4","_formData$messageTemp5","_formData$messageTemp6","onProviderCreated","setName","phone","setPhone","setEmail","contactPerson","setContactPerson","setNotes","setBranchId","_branchesRes$data","branchesRes","checkScreenSize","TOUR_PROVIDERS","onProviderUpdated","ProviderCard","TourProvidersTab","isEditModalOpen","setIsEditModalOpen","editingProvider","setEditingProvider","providers","setProviders","fetchProviders","_error$response$data","filteredProviders","_provider$contactPers","_provider$phone","_provider$email","_provider$notes","search","providerId","CreateTourProviderModal","newProvider","EditTourProviderModal","updatedProvider","TourType","onTourCreated","setTitle","setDescription","setType","OWN","setIsActive","duration","setDuration","setMaxParticipants","setMinParticipants","price","setPrice","setCurrency","location","setLocation","meetingPoint","setMeetingPoint","setIncludes","excludes","setExcludes","requirements","setRequirements","totalCommission","setTotalCommission","totalCommissionPercent","setTotalCommissionPercent","sellerCommissionPercent","setSellerCommissionPercent","sellerCommissionFixed","setSellerCommissionFixed","externalProviderId","setExternalProviderId","externalBookingUrl","setExternalBookingUrl","imageFile","setImageFile","imagePreview","setImagePreview","galleryFiles","setGalleryFiles","galleryPreviews","setGalleryPreviews","uploadingImage","setUploadingImage","tourProviders","setTourProviders","_API_ENDPOINTS$TOUR_P","_providersRes$data","providersRes","maxPart","minPart","EXTERNAL","tourData","createdTour","FormData","append","UPLOAD_IMAGE","headers","imgErr","UPLOAD_GALLERY","galleryErr","updatedResponse","_e$target$files","reader","FileReader","onloadend","readAsDataURL","alt","multiple","preview","_","removeGalleryImage","_tour$isActive","_tour$galleryUrls","onTourUpdated","getTourImageUrl","galleryUrls","getTourGalleryImageUrl","_tour$isActive2","_tour$galleryUrls2","handleImageChange","handleGalleryChange","removeMainImage","DELETE_IMAGE","currentGallery","DELETE_GALLERY_IMAGE","_response2","_response2$data","newIndex","_response3","_response3$data","setTour","isCreateBookingModalOpen","setIsCreateBookingModalOpen","loadTour","UsersIcon","createdBy","createdAt","format","locale","externalProvider","availableFrom","availableTo","CreateTourBookingModal","tourCount","selectedFields","setSelectedFields","exporting","setExporting","setFormat","availableFields","selectAll","deselectAll","field","toggleField","fieldId","fieldsParam","EXPORT","fields","csvContent","row","cell","initialImageIndex","tourTitle","currentImageIndex","setCurrentImageIndex","zoomLevel","setZoomLevel","imageLoading","setImageLoading","imageError","setImageError","images","handlePrevious","handleNext","handleZoomIn","handleZoomOut","handleZoomReset","shiftKey","currentImage","canGoPrevious","canGoNext","canZoomIn","canZoomOut","MagnifyingGlassMinusIcon","MagnifyingGlassPlusIcon","ChevronLeftIcon","transform","cursor","onLoad","handleImageLoad","handleImageError","ChevronRightIcon","TOURS_TABLE_ID","defaultTourColumnOrder","tourCardToTableMapping","ToursTab","toursLoading","setToursLoading","toursError","setToursError","tourSearchTerm","setTourSearchTerm","tourFilterConditions","setTourFilterConditions","tourFilterLogicalOperators","setTourFilterLogicalOperators","tourActiveFilterName","setTourActiveFilterName","tourSelectedFilterId","setTourSelectedFilterId","tourFilterLogicalOperatorsRef","isCreateTourModalOpen","setIsCreateTourModalOpen","isEditTourModalOpen","setIsEditTourModalOpen","isTourDetailsModalOpen","setIsTourDetailsModalOpen","isTourExportDialogOpen","setIsTourExportDialogOpen","lightboxOpen","setLightboxOpen","selectedTourForLightbox","setSelectedTourForLightbox","setInitialImageIndex","selectedTourId","setSelectedTourId","draggedColumn","setDraggedColumn","dragOverColumn","setDragOverColumn","generatingImages","setGeneratingImages","imageGenerationJobs","setImageGenerationJobs","pollingIntervalsRef","pollCountRef","isLoadingSettings","tourTableSortConfig","availableTourColumns","shortLabel","substring","tourFilterOnlyColumns","cardMetadataOrder","cardMetadata","tableCol","cardMeta","getTourCardMetadataFromColumnOrder","hiddenCardMetadata","hiddenTableColumns","Set","add","getTourHiddenCardMetadata","visibleCardMetadata","loadTours","filterId","background","rawData","handleGenerateImages","GENERATE_IMAGES","mode","jobId","tourIdStr","setInterval","clearInterval","newJobs","GENERATE_IMAGES_STATUS","values","interval","applyTourFilterConditions","resetTourFilterConditions","handleTourFilterChange","initialLoadAttemptedRef","handleDragEnd","visibleColumnIds","validOrder","missingColumns","filteredAndSortedTours","filtered","cond","compareValue","abs","_tour$branch","branchName","createdByName","createdById","_tour$branch2","getTourSortValue","_tour$branch3","valueA","valueB","comparison","strA","strB","titleA","titleB","Squares2X2Icon","TableCellsIcon","TableColumnConfig","tableColumn","onColumnOrderChange","newOrder","newTableOrder","Boolean","handleMainSortChange","col","scope","draggable","onDragStart","handleDragStart","onDragOver","handleDragOver","onDrop","handleDrop","dragIndex","hoverIndex","draggedColumn_","splice","onDragEnd","newDirection","handleTourSort","colSpan","_tour$branch4","TOGGLE_ACTIVE","_err$response2$data","InformationCircleIcon","PhotoIcon","CardGrid","_response4","_response4$data","CreateTourModal","EditTourModal","TourDetailsModal","TourExportDialog","TourImageLightbox","onSuccess","displayName","domain","setErrors","fetchCurrentUser","handleChange","newErrors","organizationService","createOrganization","submit","organizationName","searching","setSearching","organizations","setOrganizations","showDropdown","setShowDropdown","selectedOrganization","setSelectedOrganization","searchTimeoutRef","dropdownRef","handleOrganizationInputChange","searchOrganizations","handleSelectOrganization","org","handleMessageChange","createJoinRequest","RoleConfigurationTab","React","DocumentConfigurationTab","SMTPConfigurationTab","ApiConfigurationTab","organization","logo","nit","organizationWithSettings","setOrganizationWithSettings","selectedCountry","setSelectedCountry","setNit","organizationLanguage","setOrganizationLanguage","useLanguage","selectedOrgLanguage","setSelectedOrgLanguage","savingOrgLanguage","setSavingOrgLanguage","logoFile","setLogoFile","logoPreview","setLogoPreview","orgWithSettings","getCurrentOrganization","orgSettings","langResponse","getOrganizationLanguage","langError","loadOrgLanguage","loadSettingsIfNeeded","handleLogoFileChange","base64String","updateOrganization","newLanguage","Suspense","fallback","onSave","getStatusColor","getStatusText","MY_JOIN_REQUESTS_TABLE_ID","MyJoinRequestsList","joinRequests","setJoinRequests","isFilterPanelOpen","setIsFilterPanelOpen","mountedRef","withdrawingId","setWithdrawingId","timeoutId","ORGANIZATIONS","MY_JOIN_REQUESTS","requests","getMyJoinRequests","fetchMyJoinRequests","hour","minute","filteredJoinRequests","request","_request$message","orgName","reduce","acc","_request$message2","searchValue","msgValue","processor","processedAt","requestId","withdrawJoinRequest","req","_err$response4$data","handleWithdraw","ArrowUturnLeftIcon","OrganizationSettings","setOrganization","stats","setStats","loadingStats","setLoadingStats","isJoinModalOpen","setIsJoinModalOpen","canViewOrganization","canManageOrganization","refreshOrganization","useOrganization","fetchOrganization","includeSettings","statsData","getOrganizationStats","statsErr","hasOrganization","hasInitialLoadRef","UserPlusIcon","UserGroupIcon","subscriptionPlan","currentUsers","maxUsers","utilizationPercent","_count","EnvelopeIcon","invitations","ChartBarIcon","availableSlots","CreateOrganizationModal","handleCreateSuccess","JoinOrganizationModal","EditOrganizationModal","handleEditModalClose","handleEditSuccess","joinRequest","setAction","setRoleId","setResponse","organizationId","processJoinRequest","requester","JOIN_REQUESTS_TABLE_ID","JoinRequestsList","isProcessModalOpen","setIsProcessModalOpen","selectedRequest","setSelectedRequest","canViewJoinRequests","canManageJoinRequests","hasInitialLoad","joinRequestsCount","JOIN_REQUESTS","getJoinRequests","stack","fetchJoinRequests","_request$requester$em","requesterName","requesterEmail","_request$requester$em2","handleOpenProcessModal","ProcessJoinRequestModal","Organisation","canViewOrganisation","canViewUsers","canViewRoles","canViewBranches","canViewProviders","canViewOrg","activeTabState","setActiveTabState","providersViewMode","setProvidersViewMode","isInitialized","defaultTab","handleTabChange","TruckIcon","RoleManagementTab"],"sourceRoot":""}