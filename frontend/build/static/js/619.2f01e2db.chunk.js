"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[619],{2023:(e,t,r)=>{r.d(t,{F:()=>d});var a=r(9379),s=r(5043),l=r(1923);const n=e=>"table_settings_".concat(e),i=async e=>{try{return(await l.A.get("/table-settings/".concat(e))).data}catch(t){console.error("Fehler beim Abrufen der Tabelleneinstellungen vom Server:",t);try{const t=n(e),r=localStorage.getItem(t);if(r)return JSON.parse(r)}catch(r){console.error("Fehler beim Laden aus localStorage:",r)}return{tableId:e,columnOrder:[],hiddenColumns:[]}}},o=async e=>{try{await l.A.post("/table-settings",e);const t=n(e.tableId);localStorage.setItem(t,JSON.stringify(e))}catch(t){console.error("Fehler beim Speichern der Tabelleneinstellungen auf dem Server:",t);try{const t=n(e.tableId);localStorage.setItem(t,JSON.stringify(e))}catch(r){console.error("Fehler beim Speichern im localStorage:",r)}}},d=(e,t)=>{const[r,l]=(0,s.useState)({tableId:e,columnOrder:(null===t||void 0===t?void 0:t.defaultColumnOrder)||[],hiddenColumns:(null===t||void 0===t?void 0:t.defaultHiddenColumns)||[]}),[n,d]=(0,s.useState)(!0),[c,m]=(0,s.useState)(null);(0,s.useEffect)((()=>{let r=!0;return(async()=>{try{d(!0);const a=await i(e);if(!r)return;console.log("Geladene Tabelleneinstellungen vom Server:",a),0===a.columnOrder.length&&null!==t&&void 0!==t&&t.defaultColumnOrder&&(a.columnOrder=t.defaultColumnOrder),!a.viewMode&&null!==t&&void 0!==t&&t.defaultViewMode&&(a.viewMode=t.defaultViewMode),console.log("Finale Tabelleneinstellungen nach Initialisierung:",a),l(a),m(null)}catch(a){if(!r)return;m(a instanceof Error?a:new Error("Fehler beim Laden der Einstellungen")),console.error("Fehler beim Laden der Tabelleneinstellungen:",a)}finally{r&&d(!1)}})(),()=>{r=!1}}),[e]);const u=(0,s.useCallback)((async e=>{try{const t=(0,a.A)((0,a.A)({},r),{},{columnOrder:e});l(t),await o(t)}catch(t){m(t instanceof Error?t:new Error("Fehler beim Speichern der Spaltenreihenfolge")),console.error("Fehler beim Speichern der Spaltenreihenfolge:",t)}}),[r]),g=(0,s.useCallback)((async e=>{try{const t=(0,a.A)((0,a.A)({},r),{},{hiddenColumns:e});l(t),await o(t)}catch(t){m(t instanceof Error?t:new Error("Fehler beim Speichern der versteckten Spalten")),console.error("Fehler beim Speichern der versteckten Spalten:",t)}}),[r]),x=(0,s.useCallback)((async e=>{try{let t;t=r.hiddenColumns.includes(e)?r.hiddenColumns.filter((t=>t!==e)):[...r.hiddenColumns,e];const s=(0,a.A)((0,a.A)({},r),{},{hiddenColumns:t});l(s),await o(s)}catch(t){m(t instanceof Error?t:new Error("Fehler beim \xc4ndern der Spaltenansicht")),console.error("Fehler beim \xc4ndern der Spaltenansicht:",t)}}),[r]),b=(0,s.useCallback)((async e=>{try{const t=(0,a.A)((0,a.A)({},r),{},{viewMode:e});l(t),await o(t)}catch(t){m(t instanceof Error?t:new Error("Fehler beim Speichern des View-Modes")),console.error("Fehler beim Speichern des View-Modes:",t)}}),[r]);return{settings:r,isLoading:n,error:c,updateColumnOrder:u,updateHiddenColumns:g,toggleColumnVisibility:x,isColumnVisible:e=>!r.hiddenColumns.includes(e),updateViewMode:b}}},6400:(e,t,r)=>{r.d(t,{Ac:()=>n,J1:()=>l,W5:()=>s});const a=(e,t)=>{const{operator:r,value:a}=t;if(void 0===a)return console.error("evaluateCondition: value ist undefined",t),!1;if(null==e&&null==a)return"equals"===r;if(null==e||null==a)return"notEquals"===r;let s="",l="";try{const t=null==e?"":"string"===typeof e?e:String(e);if("string"!==typeof t)return!1;const r=t.toLowerCase();if(void 0===r||null===r||"string"!==typeof r)return!1;s=r;const n=null==a?"":"string"===typeof a?a:String(a);if("string"!==typeof n)return!1;const i=n.toLowerCase();if(void 0===i||null===i||"string"!==typeof i)return!1;l=i}catch(n){return!1}if("string"!==typeof s||"string"!==typeof l||void 0===s||void 0===l||null===s||null===l)return!1;switch(r){case"equals":return s===l;case"notEquals":return s!==l;case"contains":return s.includes(l);case"startsWith":return s.startsWith(l);case"endsWith":if(void 0===s||null===s)return console.error("endsWith: strField ist undefined/null",{strField:s,strValue:l,fieldValue:e,value:a,condition:t}),!1;if(void 0===l||null===l)return console.error("endsWith: strValue ist undefined/null",{strField:s,strValue:l,fieldValue:e,value:a,condition:t}),!1;if("string"!==typeof s)return console.error("endsWith: strField ist kein String",{strField:s,typeof:typeof s,strValue:l,fieldValue:e,value:a,condition:t}),!1;if("string"!==typeof l)return console.error("endsWith: strValue ist kein String",{strField:s,strValue:l,typeof:typeof l,fieldValue:e,value:a,condition:t}),!1;try{return s.endsWith(l)}catch(n){return console.error("endsWith: Fehler bei endsWith-Aufruf",n,{strField:s,strValue:l,fieldValue:e,value:a,condition:t}),!1}case"before":case"after":{const t=new Date(e),s=new Date(a);return!isNaN(t.getTime())&&!isNaN(s.getTime())&&("before"===r?t<s:t>s)}case"greaterThan":case"lessThan":{const t=parseFloat(String(e)),s=parseFloat(String(a));return!isNaN(t)&&!isNaN(s)&&("greaterThan"===r?t>s:t<s)}default:return!0}},s=(e,t,r,s,l)=>0===t.length?e:e.filter((e=>{let n=!0;for(let i=0;i<t.length;i++){const o=t[i];let d=!1;if(l&&l[o.column]){const t=l[o.column](e,o);if(null!==t)d=t;else{const t=s(e,o.column);d=a(t,o)}}else{const t=s(e,o.column);d=a(t,o)}if(0===i)n=d;else{n="AND"===(r[i-1]||"AND")?n&&d:n||d}}return n})),l=(e,t)=>{if(!e)return!1;const r=new Date(e);if(isNaN(r.getTime()))return!1;const a=r.getUTCFullYear(),s=r.getUTCMonth(),l=r.getUTCDate(),n=new Date(a,s,l);let i;if("__TODAY__"===t.value){const e=new Date;e.setHours(0,0,0,0),i=e}else{const e=new Date(t.value);if(isNaN(e.getTime()))return!1;const r=e.getUTCFullYear(),a=e.getUTCMonth(),s=e.getUTCDate();i=new Date(r,a,s)}switch(t.operator){case"equals":return n.getTime()===i.getTime();case"before":return n<i;case"after":return n>i;default:return!0}},n=(e,t,r,a)=>{const s=r.value||"";if(s.startsWith("user-")){const t=parseInt(s.replace("user-",""),10);if(isNaN(t))return!1;const a=e===t;return"notEquals"===r.operator?!a:a}if(s.startsWith("role-")){const e=parseInt(s.replace("role-",""),10);if(isNaN(e))return!1;const a=t===e;return"notEquals"===r.operator?!a:a}if(""===s)return!0;if(void 0!==a){const e=a.toLowerCase(),t=s.toLowerCase();if("equals"===r.operator)return e===t;if("notEquals"===r.operator)return e!==t;if("contains"===r.operator)return e.includes(t)}return!1}},7539:(e,t,r)=>{r.d(t,{A:()=>u});var a=r(5043),s=r(4117),l=r(1923),n=r(6443),i=r(7591),o=r(1801),d=r(2672),c=r(7855),m=r(579);const u=e=>{let{isOpen:t,onClose:r,onBookingCreated:u,tour:g}=e;const{t:x}=(0,s.Bd)(),{user:b}=(0,d.As)(),{showMessage:h}=(0,c.A)(),[p,y]=(0,a.useState)((null===g||void 0===g?void 0:g.id)||""),[f,v]=(0,a.useState)(""),[k,j]=(0,a.useState)(1),[w,N]=(0,a.useState)(""),[A,S]=(0,a.useState)(""),[C,P]=(0,a.useState)(""),[E,z]=(0,a.useState)(""),[L,D]=(0,a.useState)([]),[R,T]=(0,a.useState)(g||null),[F,I]=(0,a.useState)(null),[_,B]=(0,a.useState)(!1),[O,V]=(0,a.useState)(!0);(0,a.useEffect)((()=>{t&&(async()=>{try{var e;V(!0);const t=await l.A.get(o.Sn.TOURS.BASE,{params:{isActive:!0}}),r=(null===(e=t.data)||void 0===e?void 0:e.data)||t.data||[];D(Array.isArray(r)?r:[])}catch(t){console.error("Fehler beim Laden der Touren:",t),h(x("errors.loadError"),"error")}finally{V(!1)}})()}),[t,x,h]),(0,a.useEffect)((()=>{g&&(y(g.id),T(g))}),[g]),(0,a.useEffect)((()=>{if(p){const e=L.find((e=>e.id===Number(p)));T(e||null)}else T(null)}),[p,L]),(0,a.useEffect)((()=>{t||(g||y(""),v(""),j(1),N(""),S(""),P(""),z(""),I(null))}),[t,g]);return(0,m.jsxs)(n.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,m.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,m.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,m.jsxs)(n.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,m.jsx)(n.lG.Title,{className:"text-lg font-semibold text-gray-900 dark:text-white",children:x("tourBookings.create",{defaultValue:"Neue Tour-Buchung"})}),(0,m.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",children:(0,m.jsx)(i.A,{className:"h-6 w-6"})})]}),(0,m.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),I(null),!p)return void I(x("tourBookings.validation.tourRequired",{defaultValue:"Tour ist erforderlich"}));if(!f)return void I(x("tourBookings.validation.tourDateRequired",{defaultValue:"Tour-Datum ist erforderlich"}));if(new Date(f)<new Date)I(x("tours.validation.tourDateFuture",{defaultValue:"Tour-Datum muss in der Zukunft liegen"}));else if(!k||Number(k)<1)I(x("tourBookings.validation.numberOfParticipantsMin",{defaultValue:"Anzahl Teilnehmer muss >= 1 sein"}));else if(!w.trim()||w.trim().length<2)I(x("tourBookings.validation.customerNameMinLength",{defaultValue:"Kundenname muss mindestens 2 Zeichen lang sein"}));else if(C.trim()||A.trim()){if(R){const e=Number(k);if(R.minParticipants&&e<R.minParticipants)return void I(x("tours.validation.numberOfParticipantsRange",{defaultValue:"Anzahl der Teilnehmer muss zwischen {min} und {max} sein",min:R.minParticipants,max:R.maxParticipants||"\u221e"}));if(R.maxParticipants&&e>R.maxParticipants)return void I(x("tours.validation.numberOfParticipantsRange",{defaultValue:"Anzahl der Teilnehmer muss zwischen {min} und {max} sein",min:R.minParticipants||1,max:R.maxParticipants}))}B(!0);try{var t,a;const e=await l.A.post(o.Sn.TOUR_BOOKINGS.BASE,{tourId:Number(p),tourDate:f,numberOfParticipants:Number(k),customerName:w.trim(),customerEmail:A.trim()||null,customerPhone:C.trim()||null,customerNotes:E.trim()||null});var s;if(null===(t=e.data)||void 0===t||!t.success||null===(a=e.data)||void 0===a||!a.data)throw new Error((null===(s=e.data)||void 0===s?void 0:s.message)||"Fehler beim Erstellen der Buchung");h(x("tourBookings.created",{defaultValue:"Tour-Buchung erfolgreich erstellt"}),"success"),u(e.data.data),r()}catch(d){var n,i;console.error("Fehler beim Erstellen der Buchung:",d);const e=(null===(n=d.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.message)||d.message||x("errors.unknownError");I(e),h(e,"error")}finally{B(!1)}}else I(x("tourBookings.validation.contactRequired",{defaultValue:"Mindestens eine Kontaktinformation (Telefon oder E-Mail) ist erforderlich"}))},className:"p-4 space-y-4",children:[F&&(0,m.jsx)("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3",children:(0,m.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200",children:F})}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[x("tourBookings.tour",{defaultValue:"Tour"})," *"]}),(0,m.jsxs)("select",{value:p,onChange:e=>y(e.target.value?Number(e.target.value):""),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:_||O||!!g,children:[(0,m.jsx)("option",{value:"",children:x("common.select",{defaultValue:"Bitte w\xe4hlen"})}),L.filter((e=>e.isActive&&e.title)).map((e=>(0,m.jsx)("option",{value:e.id,children:e.title||"-"},e.id)))]}),R&&(0,m.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:R.minParticipants&&R.maxParticipants?x("tourBookings.participantsRange",{defaultValue:"Teilnehmer: {min} - {max}",min:R.minParticipants,max:R.maxParticipants}):R.minParticipants?x("tourBookings.participantsMin",{defaultValue:"Min. Teilnehmer: {min}",min:R.minParticipants}):R.maxParticipants?x("tourBookings.participantsMax",{defaultValue:"Max. Teilnehmer: {max}",max:R.maxParticipants}):null})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[x("tourBookings.tourDate",{defaultValue:"Tour-Datum"})," *"]}),(0,m.jsx)("input",{type:"datetime-local",value:f,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:_||O})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[x("tourBookings.numberOfParticipants",{defaultValue:"Anzahl Teilnehmer"})," *"]}),(0,m.jsx)("input",{type:"number",min:(null===R||void 0===R?void 0:R.minParticipants)||1,max:(null===R||void 0===R?void 0:R.maxParticipants)||void 0,value:k,onChange:e=>j(e.target.value?Number(e.target.value):""),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:_||O})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[x("tourBookings.customerName",{defaultValue:"Kundenname"})," *"]}),(0,m.jsx)("input",{type:"text",value:w,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:_||O})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x("tourBookings.customerPhone",{defaultValue:"Telefon"})}),(0,m.jsx)("input",{type:"tel",value:C,onChange:e=>P(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:_||O})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x("tourBookings.customerEmail",{defaultValue:"E-Mail"})}),(0,m.jsx)("input",{type:"email",value:A,onChange:e=>S(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:_||O})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x("tourBookings.customerNotes",{defaultValue:"Notizen"})}),(0,m.jsx)("textarea",{value:E,onChange:e=>z(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:_||O})]}),(0,m.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,m.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",children:x("common.cancel","Abbrechen")}),(0,m.jsx)("button",{type:"submit",disabled:_||O,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:_?x("common.saving","Speichere..."):x("common.save","Speichern")})]})]})]})})]})}},8897:(e,t,r)=>{r.d(t,{A:()=>x});var a=r(5043),s=r(4117),l=r(7030),n=r(9626),i=r(2311),o=r(9531),d=r(4832),c=r(1909),m=r(9422),u=r(579);const g=e=>{let{id:t,label:r,index:a,isVisible:c,isDragging:m,isOver:g,onDragStart:x,onDragOver:b,onDragEnd:h,onToggleVisibility:p,sortDirection:y,onSortDirectionChange:f,showSortDirection:v=!1,sortOrder:k}=e;const{t:j}=(0,s.Bd)();return(0,u.jsxs)("li",{draggable:!0,onDragStart:()=>x(a),onDragOver:e=>{e.preventDefault(),b(a)},onDragEnd:h,className:"flex items-center justify-between px-2.5 py-2 rounded-md transition-colors duration-150\n        ".concat(m?"opacity-50 bg-gray-100 dark:bg-gray-700":"","\n        ").concat(g?"border-t-2 border-blue-500 dark:border-blue-400":"","\n        ").concat(m||g?"":"hover:bg-gray-50 dark:hover:bg-gray-700"),children:[(0,u.jsxs)("div",{className:"flex items-center flex-1 min-w-0",children:[(0,u.jsx)(l.A,{className:"h-4 w-4 mr-2 text-gray-400 dark:text-gray-500 cursor-move flex-shrink-0"}),(0,u.jsxs)("span",{className:"text-sm dark:text-gray-300 flex items-center gap-2",children:[v&&void 0!==k&&c&&(0,u.jsx)("span",{className:"text-xs font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 px-1.5 py-0.5 rounded",children:k}),(0,u.jsx)("span",{children:r})]})]}),(0,u.jsxs)("div",{className:"flex items-center gap-1",children:[v&&c&&void 0!==y&&f&&(0,u.jsx)("button",{onClick:e=>{e.stopPropagation(),f(t,"asc"===y?"desc":"asc")},className:"inline-flex items-center justify-center p-1.5 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150",title:"".concat(j("tableColumn.sortDirection"),": ").concat(j("asc"===y?"tableColumn.ascending":"tableColumn.descending")," (").concat(j("tableColumn.clickToToggle"),")"),children:"asc"===y?(0,u.jsx)(n.A,{className:"h-4 w-4"}):(0,u.jsx)(i.A,{className:"h-4 w-4"})}),(0,u.jsx)("button",{onClick:()=>p(t),className:"inline-flex items-center justify-center p-1.5 rounded-full bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150",title:j(c?"tableColumn.hideColumn":"tableColumn.showColumn"),children:c?(0,u.jsx)(o.A,{className:"w-4 h-4 dark:text-gray-300"}):(0,u.jsx)(d.A,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"})})]})]})},x=e=>{let{columns:t,visibleColumns:r,columnOrder:l,onToggleColumnVisibility:n,onMoveColumn:i,onClose:o,buttonTitle:d,modalTitle:x,sortDirections:b={},onSortDirectionChange:h,showSortDirection:p=!1}=e;const{t:y}=(0,s.Bd)(),f=d||y("tableColumn.configure"),v=x||y("tableColumn.configure"),[k,j]=(0,a.useState)(!1),[w,N]=(0,a.useState)(null),[A,S]=(0,a.useState)(null),C=(0,a.useRef)(null),P=[...t].sort(((e,t)=>{const r=l.indexOf(e.id),a=l.indexOf(t.id);return-1===r?1:-1===a?-1:r-a})),E=e=>{N(e),S(e)},z=e=>{S(e)},L=()=>{null!==w&&null!==A&&w!==A&&i(w,A),N(null),S(null)},D=()=>{j(!1),o()};return(0,a.useEffect)((()=>{const e=e=>{C.current&&!C.current.contains(e.target)&&D()};return k&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[k]),(0,u.jsxs)("div",{className:"relative",ref:C,children:[(0,u.jsx)("button",{className:"inline-flex items-center justify-center p-2 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150",onClick:()=>j(!k),title:f,children:p?(0,u.jsx)(c.A,{className:"w-5 h-5"}):(0,u.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:(0,u.jsx)("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5A.75.75 0 012 10z",clipRule:"evenodd"})})}),k&&(0,u.jsxs)("div",{className:"absolute right-0 mt-2 w-64 bg-white dark:bg-gray-800 rounded-md shadow-lg z-50 border border-gray-300 dark:border-gray-600",onDragOver:e=>e.preventDefault(),children:[(0,u.jsxs)("div",{className:"px-3 py-2.5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[(0,u.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:v}),(0,u.jsx)("button",{onClick:D,className:"inline-flex items-center justify-center p-2 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150",title:y("common.close"),children:(0,u.jsx)(m.A,{className:"w-5 h-5"})})]}),(0,u.jsx)("ul",{className:"px-2 py-1 max-h-64 overflow-y-auto",children:P.map(((e,t)=>{const a=P.filter((e=>r.includes(e.id))).findIndex((t=>t.id===e.id))+1,s=r.includes(e.id);return(0,u.jsx)(g,{id:e.id,label:e.label,index:t,isVisible:s,isDragging:w===t,isOver:A===t&&w!==t,onDragStart:E,onDragOver:z,onDragEnd:L,onToggleVisibility:n,sortDirection:p&&s?b[e.id]||"asc":void 0,onSortDirectionChange:p?h:void 0,showSortDirection:p,sortOrder:p&&s?a:void 0},e.id)}))})]})]})}},9619:(e,t,r)=>{r.r(t),r.d(t,{default:()=>pt});var a=r(5043),s=r(4117),l=r(2760),n=r(7504),i=r(4129),o=r(8153),d=r(7459),c=r(5889),m=r(9379),u=r(6443),g=r(542),x=r(8662),b=r(6009),h=r(2704),p=r(6238),y=r(7591),f=r(9422),v=r(7855),k=r(6768),j=r(9743),w=r(1923),N=r(1801),A=r(6287),S=r(4538),C=r(2811),P=r(7012),E=r(7988),z=r(4791),L=r(1816),D=r(2672),R=r(5657),T=r(579);const F=e=>{let{isOpen:t,onClose:r,onCertificateCreated:n,userId:o,userName:d}=e;const{t:c}=(0,s.Bd)(),{user:m}=(0,D.As)(),{isHR:g,isAdmin:x,loading:b}=(0,l.S)(),{openSidepane:p,closeSidepane:k}=(0,R.N)(),{showMessage:j}=(0,v.A)(),[A,S]=(0,a.useState)(window.innerWidth<640),[C,P]=(0,a.useState)(window.innerWidth>1070),[z,F]=(0,a.useState)("data"),[I,_]=(0,a.useState)(!1),[B,O]=(0,a.useState)(null),[V,U]=(0,a.useState)(null),[M,q]=(0,a.useState)((new Date).toISOString().split("T")[0]),[G,W]=(0,a.useState)("employment"),[K,H]=(0,a.useState)(null),[J,Y]=(0,a.useState)(null),[Z,X]=(0,a.useState)(!1),[$,Q]=(0,a.useState)([]),[ee,te]=(0,a.useState)(null),[re,ae]=(0,a.useState)(!1),se=(0,a.useRef)(null);(0,a.useEffect)((()=>{b||g()||x()||(j("Nur HR oder Admin k\xf6nnen Arbeitszeugnisse erstellen","error"),r())}),[g,x,b,r,j]),(0,a.useEffect)((()=>{const e=()=>{S(window.innerWidth<640),P(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(t?(p(),ne(),le()):k(),()=>{k()})),[t,p,k]);const le=async()=>{try{const e=(await w.A.get(N.Sn.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES)).data.documentTemplates||{},t=[];e.employmentCertificate&&t.push({type:"employmentCertificate",version:e.employmentCertificate.version,path:e.employmentCertificate.path}),Q(t),t.length>0&&(te(t[0].type),ae(!0))}catch(e){console.error("Fehler beim Laden der Templates:",e)}},ne=async()=>{try{const[e,t]=await Promise.all([w.A.get(N.Sn.USERS.BY_ID(o)),w.A.get(N.Sn.LIFECYCLE.BY_USER(o))]),r=e.data,a=t.data.lifecycle,s={firstName:r.firstName||"",lastName:r.lastName||"",identificationNumber:r.identificationNumber||null,contractStartDate:(null===a||void 0===a?void 0:a.contractStartDate)||null,contractEndDate:(null===a||void 0===a?void 0:a.contractEndDate)||null,contractType:(null===a||void 0===a?void 0:a.contractType)||null,salary:r.salary||null,position:null};U(s),M&&M!==(new Date).toISOString().split("T")[0]||q((new Date).toISOString().split("T")[0])}catch(e){console.error("Fehler beim Laden der User-Daten:",e),O("Fehler beim Laden der Daten")}};(0,a.useEffect)((()=>()=>{J&&URL.revokeObjectURL(J)}),[J]);return g()||x()?(0,T.jsxs)(u.lG,{open:t,onClose:r,className:"relative z-50",children:[(!C||A)&&(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-start justify-end p-0 sm:p-0",children:(0,T.jsxs)(u.lG.Panel,{className:"\n            ".concat(A?"w-full h-full":"w-[600px]","\n            ").concat(A?"":"top-16","\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ").concat(A?"rounded-none":"rounded-l-lg","\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ").concat(A?"":"sidepane-panel-container","\n          "),style:{animation:A?"none":"slideIn 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94)"},children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,T.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,T.jsx)(h.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"}),(0,T.jsx)(u.lG.Title,{className:"text-xl font-semibold dark:text-white",children:"Arbeitszeugnis erstellen"})]}),(0,T.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,T.jsx)("div",{className:"mb-4",children:(0,T.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["F\xfcr: ",(0,T.jsx)("span",{className:"font-medium dark:text-white",children:d})]})}),(0,T.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:(0,T.jsxs)("nav",{className:"-mb-px flex space-x-4",children:[(0,T.jsx)("button",{type:"button",onClick:()=>F("data"),className:"".concat("data"===z?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:"Daten"}),(0,T.jsx)("button",{type:"button",onClick:()=>F("text"),className:"".concat("text"===z?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:"PDF hochladen"})]})}),B&&(0,T.jsx)("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4",children:(0,T.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:B})}),"data"===z&&(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4",children:[(0,T.jsx)("h3",{className:"text-sm font-semibold dark:text-white mb-3",children:"Automatisch erkannte Daten"}),(0,T.jsx)("div",{className:"space-y-2 text-sm",children:V&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,T.jsx)(i.A,{className:"h-4 w-4 text-gray-400"}),(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Name:"}),(0,T.jsxs)("span",{className:"dark:text-white",children:[V.firstName," ",V.lastName]})]}),V.identificationNumber&&(0,T.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,T.jsx)(h.A,{className:"h-4 w-4 text-gray-400"}),(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"C\xe9dula:"}),(0,T.jsx)("span",{className:"dark:text-white",children:V.identificationNumber})]}),V.contractStartDate&&(0,T.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,T.jsx)(E.A,{className:"h-4 w-4 text-gray-400"}),(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Eintrittsdatum:"}),(0,T.jsx)("span",{className:"dark:text-white",children:new Date(V.contractStartDate).toLocaleDateString("de-DE")})]}),V.contractEndDate&&(0,T.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,T.jsx)(E.A,{className:"h-4 w-4 text-gray-400"}),(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Austrittsdatum:"}),(0,T.jsx)("span",{className:"dark:text-white",children:new Date(V.contractEndDate).toLocaleDateString("de-DE")})]})]})})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Ausstellungsdatum ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsx)("input",{type:"date",value:M,onChange:e=>{const t=e.target.value;q(t),t&&new Date(t)>new Date?O("Ausstellungsdatum darf nicht in der Zukunft liegen"):O(null)},max:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(B&&M&&new Date(M)>new Date||B&&!M?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),required:!0,"aria-invalid":!(M&&!(M&&new Date(M)>new Date))||void 0,"aria-describedby":!M||M&&new Date(M)>new Date?"issueDate-error":void 0}),B&&(!M||M&&new Date(M)>new Date)&&(0,T.jsx)("p",{id:"issueDate-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:B}),!B&&(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Das Datum darf nicht in der Zukunft liegen"})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Zertifikat-Typ ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsxs)("select",{value:G,onChange:e=>W(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",required:!0,children:[(0,T.jsx)("option",{value:"employment",children:"Arbeitszeugnis"}),(0,T.jsx)("option",{value:"salary",children:"Gehaltsbescheinigung"}),(0,T.jsx)("option",{value:"work_experience",children:"Arbeitsbescheinigung"})]})]})]}),"text"===z&&(0,T.jsxs)("div",{className:"space-y-4",children:[$.length>0&&(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Template verwenden"}),(0,T.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,T.jsx)("input",{type:"checkbox",checked:re,onChange:e=>{ae(e.target.checked),e.target.checked&&K&&(H(null),J&&(URL.revokeObjectURL(J),Y(null)))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,T.jsx)("label",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Template f\xfcr automatische PDF-Generierung verwenden"})]}),re&&(0,T.jsx)("select",{value:ee||"",onChange:e=>te(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4",children:$.map((e=>(0,T.jsxs)("option",{value:e.type,children:["Arbeitszeugnis (Version ",e.version,")"]},e.type)))})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[re?"ODER PDF-Datei hochladen":"PDF-Datei hochladen"," ",!re&&(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center",children:[(0,T.jsx)("input",{ref:se,type:"file",accept:".pdf",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if("application/pdf"!==r.type)return void j("Nur PDF-Dateien sind erlaubt","error");if(r.size>10485760)return void j("Datei ist zu gro\xdf (max. 10MB)","error");H(r),ae(!1);const e=URL.createObjectURL(r);Y(e)}},className:"hidden"}),K?(0,T.jsxs)("div",{children:[(0,T.jsx)(h.A,{className:"mx-auto h-12 w-12 text-green-500 mb-4"}),(0,T.jsx)("p",{className:"text-sm font-medium dark:text-white",children:K.name}),(0,T.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[(K.size/1024/1024).toFixed(2)," MB"]}),(0,T.jsx)("button",{type:"button",onClick:()=>{H(null),J&&(URL.revokeObjectURL(J),Y(null)),se.current&&(se.current.value="")},className:"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",children:"Datei entfernen"})]}):(0,T.jsxs)("div",{children:[(0,T.jsx)(h.A,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,T.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=se.current)||void 0===e?void 0:e.click()},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:"PDF-Datei ausw\xe4hlen"}),(0,T.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"oder Datei hierher ziehen"}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-400 dark:text-gray-500",children:"Max. 10MB"})]})]})]}),J&&(0,T.jsxs)("div",{className:"mt-4",children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"PDF-Vorschau"}),(0,T.jsx)("div",{className:"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50",children:(0,T.jsx)("iframe",{src:"".concat(J,"#view=FitH"),className:"w-full rounded border dark:border-gray-600",style:{height:"400px"},title:"PDF-Vorschau"})})]})]})]}),(0,T.jsxs)("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,T.jsx)("button",{type:"button",onClick:r,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:"Abbrechen",children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"button",onClick:async e=>{e.preventDefault();const t=(()=>{if(!re&&!K)return"Bitte w\xe4hlen Sie ein Template oder laden Sie eine PDF-Datei hoch";if(!M)return"Bitte geben Sie ein Ausstellungsdatum an";const e=new Date(M);return isNaN(e.getTime())?"Ung\xfcltiges Ausstellungsdatum":e>new Date?"Ausstellungsdatum darf nicht in der Zukunft liegen":null})();if(t)return O(t),void j(t,"error");_(!0),O(null);try{let e,t=null,a=null;if(re&&ee&&!K){const e=$.find((e=>e.type===ee));e&&(t=e.type,a=e.version)}else{if(!K)return j("Bitte w\xe4hlen Sie ein Template oder laden Sie eine PDF-Datei hoch","error"),void _(!1);e="temp-".concat(Date.now(),"-").concat(K.name)}const s={certificateType:G,issueDate:new Date(M),pdfPath:e,templateUsed:t,templateVersion:a};await w.A.post(N.Sn.LIFECYCLE.CERTIFICATES(o),s),j("Arbeitszeugnis erfolgreich erstellt","success"),n(),r(),J&&(URL.revokeObjectURL(J),Y(null)),H(null),q((new Date).toISOString().split("T")[0]),se.current&&(se.current.value="")}catch(l){var a,s;console.error("Fehler beim Erstellen des Arbeitszeugnisses:",l),O((null===(a=l.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||"Fehler beim Erstellen des Arbeitszeugnisses"),j("Fehler beim Erstellen des Arbeitszeugnisses","error")}finally{_(!1)}},disabled:I||!K&&!re,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:I?"Wird erstellt...":"Erstellen",children:I?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})]})]})})]}):null};var I=r(2683);const _=e=>{let{isOpen:t,onClose:r,onContractCreated:n,userId:o,userName:d}=e;const{t:c}=(0,s.Bd)(),{user:m}=(0,D.As)(),{isHR:g,isAdmin:x,loading:b}=(0,l.S)(),{openSidepane:p,closeSidepane:k}=(0,R.N)(),{showMessage:j}=(0,v.A)(),[A,S]=(0,a.useState)(window.innerWidth<640),[C,P]=(0,a.useState)(window.innerWidth>1070),[E,z]=(0,a.useState)("data"),[F,_]=(0,a.useState)(!1),[B,O]=(0,a.useState)(null),[V,U]=(0,a.useState)(null),[M,q]=(0,a.useState)("employment"),[G,W]=(0,a.useState)((new Date).toISOString().split("T")[0]),[K,H]=(0,a.useState)(""),[J,Y]=(0,a.useState)(""),[Z,X]=(0,a.useState)(""),[$,Q]=(0,a.useState)(""),[ee,te]=(0,a.useState)(null),[re,ae]=(0,a.useState)(null),[se,le]=(0,a.useState)([]),[ne,ie]=(0,a.useState)(null),[oe,de]=(0,a.useState)(!1),ce=(0,a.useRef)(null);(0,a.useEffect)((()=>{b||g()||x()||(j("Nur HR oder Admin k\xf6nnen Arbeitsvertr\xe4ge erstellen","error"),r())}),[g,x,b,r,j]),(0,a.useEffect)((()=>{const e=()=>{S(window.innerWidth<640),P(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(t?(p(),ue(),me()):k(),()=>{k()})),[t,p,k]);const me=async()=>{try{const e=(await w.A.get(N.Sn.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES)).data.documentTemplates||{},t=[];e.employmentContract&&t.push({type:"employmentContract",version:e.employmentContract.version,path:e.employmentContract.path}),le(t),t.length>0&&(ie(t[0].type),de(!0))}catch(e){console.error("Fehler beim Laden der Templates:",e)}},ue=async()=>{try{const[e,t]=await Promise.all([w.A.get(N.Sn.USERS.BY_ID(o)),w.A.get(N.Sn.LIFECYCLE.BY_USER(o))]),r=e.data,a=t.data.lifecycle,s={firstName:r.firstName||"",lastName:r.lastName||"",identificationNumber:r.identificationNumber||null,contractStartDate:(null===a||void 0===a?void 0:a.contractStartDate)||null,contractEndDate:(null===a||void 0===a?void 0:a.contractEndDate)||null,contractType:(null===a||void 0===a?void 0:a.contractType)||null,salary:r.salary||null,position:null};U(s),s.contractStartDate&&W(new Date(s.contractStartDate).toISOString().split("T")[0]),s.contractEndDate&&H(new Date(s.contractEndDate).toISOString().split("T")[0]),s.salary&&Y(s.salary.toString()),s.contractType&&q(s.contractType)}catch(e){console.error("Fehler beim Laden der User-Daten:",e),O("Fehler beim Laden der Daten")}};(0,a.useEffect)((()=>()=>{re&&URL.revokeObjectURL(re)}),[re]);return g()||x()?(0,T.jsxs)(u.lG,{open:t,onClose:r,className:"relative z-50",children:[(!C||A)&&(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-start justify-end p-0 sm:p-0",children:(0,T.jsxs)(u.lG.Panel,{className:"\n            ".concat(A?"w-full h-full":"w-[600px]","\n            ").concat(A?"":"top-16","\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ").concat(A?"rounded-none":"rounded-l-lg","\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ").concat(A?"":"sidepane-panel-container","\n          "),children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,T.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,T.jsx)(h.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"}),(0,T.jsx)(u.lG.Title,{className:"text-xl font-semibold dark:text-white",children:"Arbeitsvertrag erstellen"})]}),(0,T.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,T.jsx)("div",{className:"mb-4",children:(0,T.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["F\xfcr: ",(0,T.jsx)("span",{className:"font-medium dark:text-white",children:d})]})}),(0,T.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:(0,T.jsxs)("nav",{className:"-mb-px flex space-x-4",children:[(0,T.jsx)("button",{type:"button",onClick:()=>z("data"),className:"".concat("data"===E?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:"Vertragsdaten"}),(0,T.jsx)("button",{type:"button",onClick:()=>z("text"),className:"".concat("text"===E?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:"PDF hochladen"})]})}),B&&(0,T.jsx)("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4",children:(0,T.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:B})}),"data"===E&&(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4",children:[(0,T.jsx)("h3",{className:"text-sm font-semibold dark:text-white mb-3",children:"Automatisch erkannte Daten"}),(0,T.jsx)("div",{className:"space-y-2 text-sm",children:V&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,T.jsx)(i.A,{className:"h-4 w-4 text-gray-400"}),(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Name:"}),(0,T.jsxs)("span",{className:"dark:text-white",children:[V.firstName," ",V.lastName]})]}),V.identificationNumber&&(0,T.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,T.jsx)(h.A,{className:"h-4 w-4 text-gray-400"}),(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"C\xe9dula:"}),(0,T.jsx)("span",{className:"dark:text-white",children:V.identificationNumber})]})]})})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Vertragstyp ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsxs)("select",{value:M,onChange:e=>q(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:"employment",children:"Arbeitsvertrag"}),(0,T.jsx)("option",{value:"amendment",children:"Vertrags\xe4nderung"}),(0,T.jsx)("option",{value:"extension",children:"Vertragsverl\xe4ngerung"})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Startdatum ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsx)("input",{type:"date",value:G,onChange:e=>{W(e.target.value),O(null)},className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(B&&!G?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),required:!0,"aria-invalid":!G,"aria-describedby":G?void 0:"startDate-error"}),B&&!G&&(0,T.jsx)("p",{id:"startDate-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:B})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Enddatum (optional)"}),(0,T.jsx)("input",{type:"date",value:K,onChange:e=>{H(e.target.value),e.target.value&&G&&new Date(e.target.value)<new Date(G)?O("Enddatum muss nach dem Startdatum liegen"):O(null)},min:G||void 0,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(B&&K&&G&&new Date(K)<new Date(G)?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),"aria-invalid":!!(K&&G&&new Date(K)<new Date(G))||void 0,"aria-describedby":K&&G&&new Date(K)<new Date(G)?"endDate-error":void 0}),B&&K&&G&&new Date(K)<new Date(G)&&(0,T.jsx)("p",{id:"endDate-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:B})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Position"}),(0,T.jsx)("input",{type:"text",value:$,onChange:e=>Q(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"z.B. Frontend-Entwickler"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gehalt (optional)"}),(0,T.jsxs)("div",{className:"relative",children:[(0,T.jsx)(I.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,T.jsx)("input",{type:"number",value:J,onChange:e=>{const t=e.target.value;Y(t),t&&parseFloat(t)<0?O("Gehalt darf nicht negativ sein"):O(null)},className:"w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(B&&J&&parseFloat(J)<0?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),placeholder:"0.00",step:"0.01",min:"0","aria-invalid":!!(J&&parseFloat(J)<0)||void 0,"aria-describedby":J&&parseFloat(J)<0?"salary-error":void 0})]}),B&&J&&parseFloat(J)<0&&(0,T.jsx)("p",{id:"salary-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:B})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Arbeitsstunden/Woche (optional)"}),(0,T.jsx)("input",{type:"number",value:Z,onChange:e=>{const t=e.target.value;X(t),t&&(parseFloat(t)<0||parseFloat(t)>168)?O("Arbeitsstunden m\xfcssen zwischen 0 und 168 liegen"):O(null)},className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(B&&Z&&(parseFloat(Z)<0||parseFloat(Z)>168)?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),placeholder:"40",step:"0.1",min:"0",max:"168","aria-invalid":!(!Z||!(parseFloat(Z)<0||parseFloat(Z)>168))||void 0,"aria-describedby":Z&&(parseFloat(Z)<0||parseFloat(Z)>168)?"workingHours-error":void 0}),B&&Z&&(parseFloat(Z)<0||parseFloat(Z)>168)&&(0,T.jsx)("p",{id:"workingHours-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:B}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Maximal 168 Stunden pro Woche (24h \xd7 7 Tage)"})]})]}),"text"===E&&(0,T.jsxs)("div",{className:"space-y-4",children:[se.length>0&&(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Template verwenden"}),(0,T.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,T.jsx)("input",{type:"checkbox",checked:oe,onChange:e=>{de(e.target.checked),e.target.checked&&ee&&(te(null),re&&(URL.revokeObjectURL(re),ae(null)))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,T.jsx)("label",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Template f\xfcr automatische PDF-Generierung verwenden"})]}),oe&&(0,T.jsx)("select",{value:ne||"",onChange:e=>ie(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4",children:se.map((e=>(0,T.jsxs)("option",{value:e.type,children:["Arbeitsvertrag (Version ",e.version,")"]},e.type)))})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[oe?"ODER PDF-Datei hochladen":"PDF-Datei hochladen"," ",!oe&&(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center",children:[(0,T.jsx)("input",{ref:ce,type:"file",accept:".pdf",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if("application/pdf"!==r.type)return void j("Nur PDF-Dateien sind erlaubt","error");if(r.size>10485760)return void j("Datei ist zu gro\xdf (max. 10MB)","error");te(r),de(!1);const e=URL.createObjectURL(r);ae(e)}},className:"hidden"}),ee?(0,T.jsxs)("div",{children:[(0,T.jsx)(h.A,{className:"mx-auto h-12 w-12 text-green-500 mb-4"}),(0,T.jsx)("p",{className:"text-sm font-medium dark:text-white",children:ee.name}),(0,T.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[(ee.size/1024/1024).toFixed(2)," MB"]}),(0,T.jsx)("button",{type:"button",onClick:()=>{te(null),re&&(URL.revokeObjectURL(re),ae(null)),ce.current&&(ce.current.value="")},className:"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",children:"Datei entfernen"})]}):(0,T.jsxs)("div",{children:[(0,T.jsx)(h.A,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,T.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=ce.current)||void 0===e?void 0:e.click()},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:"PDF-Datei ausw\xe4hlen"}),(0,T.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"oder Datei hierher ziehen"}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-400 dark:text-gray-500",children:"Max. 10MB"})]})]})]}),re&&(0,T.jsxs)("div",{className:"mt-4",children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"PDF-Vorschau"}),(0,T.jsx)("div",{className:"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50",children:(0,T.jsx)("iframe",{src:"".concat(re,"#view=FitH"),className:"w-full rounded border dark:border-gray-600",style:{height:"400px"},title:"PDF-Vorschau"})})]})]})]}),(0,T.jsxs)("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,T.jsx)("button",{type:"button",onClick:r,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:"Abbrechen",children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"button",onClick:async e=>{e.preventDefault();const t=(()=>{if(!oe&&!ee)return"Bitte w\xe4hlen Sie ein Template oder laden Sie eine PDF-Datei hoch";if(!G)return"Bitte geben Sie ein Startdatum an";const e=new Date(G);if(isNaN(e.getTime()))return"Ung\xfcltiges Startdatum";if(K){const t=new Date(K);if(isNaN(t.getTime()))return"Ung\xfcltiges Enddatum";if(t<e)return"Enddatum muss nach dem Startdatum liegen"}return J&&parseFloat(J)<0?"Gehalt darf nicht negativ sein":Z&&(parseFloat(Z)<0||parseFloat(Z)>168)?"Arbeitsstunden m\xfcssen zwischen 0 und 168 liegen":null})();if(t)return O(t),void j(t,"error");_(!0),O(null);try{let e,t=null,a=null;if(oe&&ne&&!ee){const e=se.find((e=>e.type===ne));e&&(t=e.type,a=e.version)}else{if(!ee)return j("Bitte w\xe4hlen Sie ein Template oder laden Sie eine PDF-Datei hoch","error"),void _(!1);e="temp-".concat(Date.now(),"-").concat(ee.name)}const s={contractType:M,startDate:new Date(G),endDate:K?new Date(K):null,salary:J?parseFloat(J):null,workingHours:Z?parseFloat(Z):null,position:$||null,pdfPath:e,templateUsed:t,templateVersion:a};await w.A.post(N.Sn.LIFECYCLE.CONTRACTS(o),s),j("Arbeitsvertrag erfolgreich erstellt","success"),n(),r(),re&&(URL.revokeObjectURL(re),ae(null)),te(null),W((new Date).toISOString().split("T")[0]),H(""),Y(""),X(""),Q(""),ce.current&&(ce.current.value="")}catch(l){var a,s;console.error("Fehler beim Erstellen des Arbeitsvertrags:",l),O((null===(a=l.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||"Fehler beim Erstellen des Arbeitsvertrags"),j("Fehler beim Erstellen des Arbeitsvertrags","error")}finally{_(!1)}},disabled:F||!ee&&!oe||!G,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:F?"Wird erstellt...":"Erstellen",children:F?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})]})]})})]}):null},B=e=>{let{isOpen:t,onClose:r,onCertificateUpdated:n,userId:i,certificate:o}=e;const{t:d}=(0,s.Bd)(),{isHR:c,isAdmin:m,loading:g}=(0,l.S)(),{openSidepane:x,closeSidepane:b}=(0,R.N)(),{showMessage:p}=(0,v.A)(),[k,j]=(0,a.useState)(window.innerWidth<640),[A,S]=(0,a.useState)(window.innerWidth>1070),[C,P]=(0,a.useState)(!1),[E,z]=(0,a.useState)(null),[D,F]=(0,a.useState)(o.issueDate?new Date(o.issueDate).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0]),[I,_]=(0,a.useState)(o.certificateType||"employment"),[B,O]=(0,a.useState)(null),[V,U]=(0,a.useState)(null),[M,q]=(0,a.useState)(null),G=(0,a.useRef)(null);(0,a.useEffect)((()=>{g||c()||m()||(p("Nur HR oder Admin k\xf6nnen Arbeitszeugnisse bearbeiten","error"),r())}),[c,m,g,r,p]),(0,a.useEffect)((()=>{const e=()=>{j(window.innerWidth<640),S(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(t?(x(),o.id&&q(N.Sn.LIFECYCLE.CERTIFICATE_DOWNLOAD(i,o.id))):b(),()=>{b()})),[t,x,b,o.id,i]),(0,a.useEffect)((()=>()=>{V&&URL.revokeObjectURL(V)}),[V]);const W=async e=>{e.preventDefault(),P(!0),z(null);try{const e={issueDate:new Date(D),certificateType:I};B&&(e.pdfPath="temp-".concat(Date.now(),"-").concat(B.name),e.templateVersion=o.templateVersion||"1.0"),await w.A.put(N.Sn.LIFECYCLE.CERTIFICATE(i,o.id),e),p("Arbeitszeugnis erfolgreich aktualisiert","success"),n(),r(),V&&(URL.revokeObjectURL(V),U(null)),O(null),G.current&&(G.current.value="")}catch(s){var t,a;console.error("Fehler beim Aktualisieren des Arbeitszeugnisses:",s),z((null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Fehler beim Aktualisieren des Arbeitszeugnisses"),p("Fehler beim Aktualisieren des Arbeitszeugnisses","error")}finally{P(!1)}};return c()||m()?(0,T.jsxs)(u.lG,{open:t,onClose:r,className:"relative z-50",children:[(!A||k)&&(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-start justify-end p-0 sm:p-0",children:(0,T.jsxs)(u.lG.Panel,{className:"\n            ".concat(k?"w-full h-full":"w-[600px]","\n            ").concat(k?"":"top-16","\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ").concat(k?"rounded-none":"rounded-l-lg","\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ").concat(k?"":"sidepane-panel-container","\n          "),children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,T.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,T.jsx)(h.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"}),(0,T.jsx)(u.lG.Title,{className:"text-xl font-semibold dark:text-white",children:"Arbeitszeugnis bearbeiten"})]}),(0,T.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[E&&(0,T.jsx)("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4",children:(0,T.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:E})}),(0,T.jsxs)("form",{onSubmit:W,className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ausstellungsdatum"}),(0,T.jsx)("input",{type:"date",value:D,onChange:e=>{const t=e.target.value;F(t),t&&new Date(t)>new Date?z("Ausstellungsdatum darf nicht in der Zukunft liegen"):z(null)},max:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(E&&D&&new Date(D)>new Date?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),"aria-invalid":!!(D&&new Date(D)>new Date)||void 0,"aria-describedby":D&&new Date(D)>new Date?"issueDate-error":void 0}),E&&D&&new Date(D)>new Date&&(0,T.jsx)("p",{id:"issueDate-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:E}),!E&&(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Das Datum darf nicht in der Zukunft liegen"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Zertifikat-Typ"}),(0,T.jsxs)("select",{value:I,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:"employment",children:"Arbeitszeugnis"}),(0,T.jsx)("option",{value:"salary",children:"Gehaltsbescheinigung"}),(0,T.jsx)("option",{value:"work_experience",children:"Arbeitsbescheinigung"})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"PDF-Datei aktualisieren (optional)"}),(0,T.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center",children:[(0,T.jsx)("input",{ref:G,type:"file",accept:".pdf",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if("application/pdf"!==r.type)return void p("Nur PDF-Dateien sind erlaubt","error");if(r.size>10485760)return void p("Datei ist zu gro\xdf (max. 10MB)","error");O(r);const e=URL.createObjectURL(r);U(e),q(null)}},className:"hidden"}),B?(0,T.jsxs)("div",{children:[(0,T.jsx)(h.A,{className:"mx-auto h-12 w-12 text-green-500 mb-4"}),(0,T.jsx)("p",{className:"text-sm font-medium dark:text-white",children:B.name}),(0,T.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[(B.size/1024/1024).toFixed(2)," MB"]}),(0,T.jsx)("button",{type:"button",onClick:()=>{O(null),V&&(URL.revokeObjectURL(V),U(null)),q(N.Sn.LIFECYCLE.CERTIFICATE_DOWNLOAD(i,o.id)),G.current&&(G.current.value="")},className:"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",children:"Datei entfernen"})]}):(0,T.jsxs)("div",{children:[(0,T.jsx)(h.A,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,T.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=G.current)||void 0===e?void 0:e.click()},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:"Neue PDF-Datei ausw\xe4hlen"}),(0,T.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"oder Datei hierher ziehen"}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-400 dark:text-gray-500",children:"Max. 10MB"})]})]}),(V||M)&&(0,T.jsxs)("div",{className:"mt-4",children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"PDF-Vorschau"}),(0,T.jsx)("div",{className:"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50",children:(0,T.jsx)("iframe",{src:"".concat(V||M).concat(V?"#view=FitH":"?preview=true#view=FitH"),className:"w-full rounded border dark:border-gray-600",style:{height:"400px"},title:"PDF-Vorschau"})})]})]}),(0,T.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4",children:(0,T.jsxs)("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:[(0,T.jsx)("strong",{children:"Hinweis:"})," Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt. Eine neue Version wird erstellt (isLatest = true)."]})})]})]}),(0,T.jsxs)("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,T.jsx)("button",{type:"button",onClick:r,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:"Abbrechen",children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"button",onClick:W,disabled:C,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:C?"Wird aktualisiert...":"Aktualisieren",children:C?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})]})]})})]}):null},O=e=>{let{isOpen:t,onClose:r,onContractUpdated:n,userId:i,contract:o}=e;const{t:d}=(0,s.Bd)(),{isHR:c,isAdmin:m,loading:g}=(0,l.S)(),{openSidepane:x,closeSidepane:b}=(0,R.N)(),{showMessage:p}=(0,v.A)(),[k,j]=(0,a.useState)(window.innerWidth<640),[A,S]=(0,a.useState)(window.innerWidth>1070),[C,P]=(0,a.useState)(!1),[E,z]=(0,a.useState)(null),[D,F]=(0,a.useState)(o.contractType||"employment"),[_,B]=(0,a.useState)(o.startDate?new Date(o.startDate).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0]),[O,V]=(0,a.useState)(o.endDate?new Date(o.endDate).toISOString().split("T")[0]:""),[U,M]=(0,a.useState)(o.salary?o.salary.toString():""),[q,G]=(0,a.useState)(o.workingHours?o.workingHours.toString():""),[W,K]=(0,a.useState)(o.position||""),[H,J]=(0,a.useState)(null),[Y,Z]=(0,a.useState)(null),[X,$]=(0,a.useState)(null),Q=(0,a.useRef)(null);(0,a.useEffect)((()=>{g||c()||m()||(p("Nur HR oder Admin k\xf6nnen Arbeitsvertr\xe4ge bearbeiten","error"),r())}),[c,m,g,r,p]),(0,a.useEffect)((()=>{const e=()=>{j(window.innerWidth<640),S(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(t?(x(),o.id&&$(N.Sn.LIFECYCLE.CONTRACT_DOWNLOAD(i,o.id))):b(),()=>{b()})),[t,x,b,o.id,i]),(0,a.useEffect)((()=>()=>{Y&&URL.revokeObjectURL(Y)}),[Y]);const ee=async e=>{if(e.preventDefault(),_){P(!0),z(null);try{const e={contractType:D,startDate:new Date(_),endDate:O?new Date(O):null,salary:U?parseFloat(U):null,workingHours:q?parseFloat(q):null,position:W||null};H&&(e.pdfPath="temp-".concat(Date.now(),"-").concat(H.name),e.templateVersion=o.templateVersion||"1.0"),await w.A.put(N.Sn.LIFECYCLE.CONTRACT(i,o.id),e),p("Arbeitsvertrag erfolgreich aktualisiert","success"),n(),r(),Y&&(URL.revokeObjectURL(Y),Z(null)),J(null),Q.current&&(Q.current.value="")}catch(s){var t,a;console.error("Fehler beim Aktualisieren des Arbeitsvertrags:",s),z((null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Fehler beim Aktualisieren des Arbeitsvertrags"),p("Fehler beim Aktualisieren des Arbeitsvertrags","error")}finally{P(!1)}}else p("Bitte geben Sie ein Startdatum an","error")};return c()||m()?(0,T.jsxs)(u.lG,{open:t,onClose:r,className:"relative z-50",children:[(!A||k)&&(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-start justify-end p-0 sm:p-0",children:(0,T.jsxs)(u.lG.Panel,{className:"\n            ".concat(k?"w-full h-full":"w-[600px]","\n            ").concat(k?"":"top-16","\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ").concat(k?"rounded-none":"rounded-l-lg","\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ").concat(k?"":"sidepane-panel-container","\n          "),children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,T.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,T.jsx)(h.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"}),(0,T.jsx)(u.lG.Title,{className:"text-xl font-semibold dark:text-white",children:"Arbeitsvertrag bearbeiten"})]}),(0,T.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[E&&(0,T.jsx)("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4",children:(0,T.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:E})}),(0,T.jsxs)("form",{onSubmit:ee,className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Vertragstyp ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsxs)("select",{value:D,onChange:e=>F(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:"employment",children:"Arbeitsvertrag"}),(0,T.jsx)("option",{value:"amendment",children:"Vertrags\xe4nderung"}),(0,T.jsx)("option",{value:"extension",children:"Vertragsverl\xe4ngerung"})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Startdatum ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsx)("input",{type:"date",value:_,onChange:e=>{const t=e.target.value;B(t),O&&t&&new Date(O)<new Date(t)?z("Enddatum muss nach dem Startdatum liegen"):z(null)},className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(E&&!_?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),required:!0,"aria-invalid":!_||void 0,"aria-describedby":_?void 0:"startDate-error"}),E&&!_&&(0,T.jsx)("p",{id:"startDate-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:E})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Enddatum (optional)"}),(0,T.jsx)("input",{type:"date",value:O,onChange:e=>{const t=e.target.value;V(t),t&&_&&new Date(t)<new Date(_)?z("Enddatum muss nach dem Startdatum liegen"):z(null)},min:_||void 0,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(E&&O&&_&&new Date(O)<new Date(_)?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),"aria-invalid":!!(O&&_&&new Date(O)<new Date(_))||void 0,"aria-describedby":O&&_&&new Date(O)<new Date(_)?"endDate-error":void 0}),E&&O&&_&&new Date(O)<new Date(_)&&(0,T.jsx)("p",{id:"endDate-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:E})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Position"}),(0,T.jsx)("input",{type:"text",value:W,onChange:e=>K(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"z.B. Frontend-Entwickler"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gehalt (optional)"}),(0,T.jsxs)("div",{className:"relative",children:[(0,T.jsx)(I.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,T.jsx)("input",{type:"number",value:U,onChange:e=>{const t=e.target.value;M(t),t&&parseFloat(t)<0?z("Gehalt darf nicht negativ sein"):z(null)},className:"w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(E&&U&&parseFloat(U)<0?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),placeholder:"0.00",step:"0.01",min:"0","aria-invalid":!!(U&&parseFloat(U)<0)||void 0,"aria-describedby":U&&parseFloat(U)<0?"salary-error":void 0})]}),E&&U&&parseFloat(U)<0&&(0,T.jsx)("p",{id:"salary-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:E})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Arbeitsstunden/Woche (optional)"}),(0,T.jsx)("input",{type:"number",value:q,onChange:e=>{const t=e.target.value;G(t),t&&(parseFloat(t)<0||parseFloat(t)>168)?z("Arbeitsstunden m\xfcssen zwischen 0 und 168 liegen"):z(null)},className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(E&&q&&(parseFloat(q)<0||parseFloat(q)>168)?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),placeholder:"40",step:"0.1",min:"0",max:"168","aria-invalid":!(!q||!(parseFloat(q)<0||parseFloat(q)>168))||void 0,"aria-describedby":q&&(parseFloat(q)<0||parseFloat(q)>168)?"workingHours-error":void 0}),E&&q&&(parseFloat(q)<0||parseFloat(q)>168)&&(0,T.jsx)("p",{id:"workingHours-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:E}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Maximal 168 Stunden pro Woche (24h \xd7 7 Tage)"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"PDF-Datei aktualisieren (optional)"}),(0,T.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center",children:[(0,T.jsx)("input",{ref:Q,type:"file",accept:".pdf",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if("application/pdf"!==r.type)return void p("Nur PDF-Dateien sind erlaubt","error");if(r.size>10485760)return void p("Datei ist zu gro\xdf (max. 10MB)","error");J(r);const e=URL.createObjectURL(r);Z(e),$(null)}},className:"hidden"}),H?(0,T.jsxs)("div",{children:[(0,T.jsx)(h.A,{className:"mx-auto h-12 w-12 text-green-500 mb-4"}),(0,T.jsx)("p",{className:"text-sm font-medium dark:text-white",children:H.name}),(0,T.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[(H.size/1024/1024).toFixed(2)," MB"]}),(0,T.jsx)("button",{type:"button",onClick:()=>{J(null),Y&&(URL.revokeObjectURL(Y),Z(null)),$(N.Sn.LIFECYCLE.CONTRACT_DOWNLOAD(i,o.id)),Q.current&&(Q.current.value="")},className:"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",children:"Datei entfernen"})]}):(0,T.jsxs)("div",{children:[(0,T.jsx)(h.A,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,T.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=Q.current)||void 0===e?void 0:e.click()},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:"Neue PDF-Datei ausw\xe4hlen"}),(0,T.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"oder Datei hierher ziehen"}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-400 dark:text-gray-500",children:"Max. 10MB"})]})]}),(Y||X)&&(0,T.jsxs)("div",{className:"mt-4",children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"PDF-Vorschau"}),(0,T.jsx)("div",{className:"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50",children:(0,T.jsx)("iframe",{src:"".concat(Y||X).concat(Y?"#view=FitH":"?preview=true#view=FitH"),className:"w-full rounded border dark:border-gray-600",style:{height:"400px"},title:"PDF-Vorschau"})})]})]}),(0,T.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4",children:(0,T.jsxs)("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:[(0,T.jsx)("strong",{children:"Hinweis:"})," Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt. Eine neue Version wird erstellt (isLatest = true)."]})})]})]}),(0,T.jsxs)("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,T.jsx)("button",{type:"button",onClick:r,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:"Abbrechen",children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"button",onClick:ee,disabled:C||!_,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:C?"Wird aktualisiert...":"Aktualisieren",children:C?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})]})]})})]}):null};var V=r(7098);const U=e=>{let{userId:t,lifecycleId:r,onUpdate:n}=e;const{t:i}=(0,s.Bd)(),{isLegal:o,isAdmin:d,loading:c}=(0,l.S)(),{showMessage:u}=(0,v.A)(),[g,x]=(0,a.useState)({arl:null,eps:null,pension:null,caja:null}),[b,p]=(0,a.useState)(!0),[f,k]=(0,a.useState)(null),[j,A]=(0,a.useState)({status:"pending",registrationNumber:"",provider:"",registrationDate:"",notes:""}),[E,z]=(0,a.useState)(!1),D=(0,a.useRef)(!1),R=(0,a.useRef)(null),F=(0,a.useCallback)((async()=>{R.current&&R.current.abort();const e=new AbortController;R.current=e,D.current=!0,p(!0);try{const r=["arl","eps","pension","caja"].map((async r=>{if(e.signal.aborted)return{type:r,registration:null};try{return{type:r,registration:(await w.A.get(N.Sn.LIFECYCLE.SOCIAL_SECURITY(t,r),{timeout:5e3,signal:e.signal})).data}}catch(l){var a,s;return"AbortError"===l.name||"CanceledError"===l.name||e.signal.aborted||404===(null===(a=l.response)||void 0===a?void 0:a.status)?{type:r,registration:null}:"ERR_NETWORK"===l.code||"ECONNABORTED"===l.code||null!==(s=l.message)&&void 0!==s&&s.includes("ERR_INSUFFICIENT_RESOURCES")?(console.warn("Network error loading ".concat(r,", treating as not found")),{type:r,registration:null}):(console.error("Error loading ".concat(r,":"),l),{type:r,registration:null})}})),a=await Promise.all(r);if(e.signal.aborted)return;const s={arl:null,eps:null,pension:null,caja:null};a.forEach((e=>{let{type:t,registration:r}=e;r&&(s[t]={id:r.id||0,registrationType:t,registrationNumber:r.number||r.registrationNumber||null,provider:r.provider||null,registrationDate:r.registeredAt||r.registrationDate||null,status:r.status||"pending",notes:r.notes||null,completedAt:r.completedAt||null})})),x(s)}catch(r){if("AbortError"===r.name||"CanceledError"===r.name||e.signal.aborted)return;console.error("Error loading registrations:",r),u(i("socialSecurity.loadError"),"error")}finally{p(!1),D.current=!1}}),[t,i,u]);(0,a.useEffect)((()=>{if(c)return;if((o()||d())&&t&&r){if(!D.current)return F(),()=>{R.current&&R.current.abort(),D.current=!1}}else p(!1)}),[t,r,c]);const I=()=>{k(null),A({status:"pending",registrationNumber:"",provider:"",registrationDate:"",notes:""})},_=async()=>{if(f)if(c)u(i("common.loading",{defaultValue:"Berechtigungen werden geladen..."}),"warning");else if(o()||d()){z(!0);try{await w.A.put(N.Sn.LIFECYCLE.SOCIAL_SECURITY(t,f),{status:j.status,number:j.registrationNumber||void 0,provider:j.provider||void 0,registrationDate:j.registrationDate?new Date(j.registrationDate).toISOString():void 0,notes:j.notes||void 0}),u("Sozialversicherung erfolgreich aktualisiert","success"),k(null),await new Promise((e=>setTimeout(e,200))),await F(),n&&"function"===typeof n&&n()}catch(a){var e,r;console.error("Error updating social security:",a),u((null===(e=a.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||i("socialSecurity.updateError"),"error")}finally{z(!1)}}else u(i("lifecycle.noPermission",{defaultValue:"Keine Berechtigung - nur Legal oder Admin"}),"error")},B=e=>{switch(e){case"registered":return(0,T.jsx)(S.A,{className:"h-5 w-5 text-green-500"});case"pending":return(0,T.jsx)(P.A,{className:"h-5 w-5 text-yellow-500"});case"failed":return(0,T.jsx)(V.A,{className:"h-5 w-5 text-red-500"});case"not_required":return(0,T.jsx)(S.A,{className:"h-5 w-5 text-gray-400"});case"deregistered":return(0,T.jsx)(V.A,{className:"h-5 w-5 text-gray-400"});default:return(0,T.jsx)(P.A,{className:"h-5 w-5 text-gray-400"})}},O=e=>{const t="lifecycle.socialSecurityStatus.".concat(e);return i(t)||e},U=e=>({arl:"ARL (Risiko-Arbeit)",eps:"EPS (Gesundheit)",pension:"Pension",caja:"Caja de Compensaci\xf3n"}[e]);if(c)return(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:(0,T.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,T.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});if(!o()&&!d())return null;if(b)return(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:(0,T.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,T.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});return(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,T.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,T.jsxs)("h3",{className:"text-lg font-semibold dark:text-white flex items-center",children:[(0,T.jsx)(h.A,{className:"h-5 w-5 mr-2"}),i("lifecycle.socialSecurity",{defaultValue:"Sozialversicherungen"})]})}),(0,T.jsx)("div",{className:"space-y-4",children:["arl","eps","pension","caja"].map((e=>{const t=g[e],r=f===e;return(0,T.jsx)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:r?(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("h4",{className:"font-medium dark:text-white uppercase mb-3",children:i("socialSecurity.editType",{type:U(e)})}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("socialSecurity.status")," ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsxs)("select",{value:j.status,onChange:e=>A((0,m.A)((0,m.A)({},j),{},{status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:"not_required",children:"Nicht erforderlich"}),(0,T.jsx)("option",{value:"pending",children:"Ausstehend"}),(0,T.jsx)("option",{value:"registered",children:"Registriert"}),(0,T.jsx)("option",{value:"failed",children:"Fehlgeschlagen"}),(0,T.jsx)("option",{value:"deregistered",children:"Abgemeldet"})]})]}),"registered"===j.status&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("socialSecurity.registrationNumber")}),(0,T.jsx)("input",{type:"text",value:j.registrationNumber,onChange:e=>A((0,m.A)((0,m.A)({},j),{},{registrationNumber:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"z.B. 123456789"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("socialSecurity.provider")}),(0,T.jsx)("input",{type:"text",value:j.provider,onChange:e=>A((0,m.A)((0,m.A)({},j),{},{provider:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"z.B. ARL Sura, EPS Sanitas"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("socialSecurity.registrationDate")}),(0,T.jsx)("input",{type:"date",value:j.registrationDate,onChange:e=>A((0,m.A)((0,m.A)({},j),{},{registrationDate:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("socialSecurity.notes")}),(0,T.jsx)("textarea",{value:j.notes,onChange:e=>A((0,m.A)((0,m.A)({},j),{},{notes:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",rows:3,placeholder:i("socialSecurity.additionalInfo")})]}),(0,T.jsxs)("div",{className:"flex items-center justify-end space-x-3",children:[(0,T.jsx)("button",{onClick:I,disabled:E,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",title:i("common.cancel"),children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{onClick:_,disabled:E,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:i(E?"common.saving":"common.save"),children:E?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(S.A,{className:"h-5 w-5"})})]})]}):(0,T.jsxs)("div",{className:"flex items-start justify-between",children:[(0,T.jsxs)("div",{className:"flex items-start space-x-3 flex-1",children:[B((null===t||void 0===t?void 0:t.status)||"pending"),(0,T.jsxs)("div",{className:"flex-1",children:[(0,T.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,T.jsx)("h4",{className:"font-medium dark:text-white uppercase",children:U(e)}),(0,T.jsx)("span",{className:"text-sm font-medium dark:text-white",children:O((null===t||void 0===t?void 0:t.status)||"pending")})]}),t&&(0,T.jsxs)("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[t.provider&&(0,T.jsxs)("div",{children:[(0,T.jsxs)("span",{className:"font-medium",children:[i("socialSecurity.provider"),":"]})," ",t.provider]}),t.registrationNumber&&(0,T.jsxs)("div",{children:[(0,T.jsxs)("span",{className:"font-medium",children:[i("socialSecurity.number"),":"]})," ",t.registrationNumber]}),t.registrationDate&&(0,T.jsxs)("div",{children:[(0,T.jsxs)("span",{className:"font-medium",children:[i("socialSecurity.registrationDate"),":"]})," ",new Date(t.registrationDate).toLocaleDateString("de-DE")]}),t.notes&&(0,T.jsxs)("div",{className:"mt-2",children:[(0,T.jsxs)("span",{className:"font-medium",children:[i("socialSecurity.notes"),":"]}),(0,T.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:t.notes})]}),t.completedAt&&(0,T.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:[i("socialSecurity.completedAt")," ",new Date(t.completedAt).toLocaleDateString("de-DE")]})]}),!t&&(0,T.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("socialSecurity.notRegistered")})]})]}),(0,T.jsx)("button",{onClick:()=>(e=>{const t=g[e];A(t?{status:t.status,registrationNumber:t.registrationNumber||"",provider:t.provider||"",registrationDate:t.registrationDate?new Date(t.registrationDate).toISOString().split("T")[0]:"",notes:t.notes||""}:{status:"pending",registrationNumber:"",provider:"",registrationDate:"",notes:""}),k(e)})(e),className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition ml-4",title:i("lifecycle.edit",{defaultValue:"Bearbeiten"}),children:(0,T.jsx)(C.A,{className:"h-5 w-5"})})]})},e)}))})]})};var M=r(9399);const q=e=>{let{isOpen:t,onClose:r,onOffboardingStarted:l,userId:n,userName:i}=e;const{t:o}=(0,s.Bd)(),{openSidepane:d,closeSidepane:c}=(0,R.N)(),{showMessage:g}=(0,v.A)(),[x,b]=(0,a.useState)(window.innerWidth<640),[h,p]=(0,a.useState)(window.innerWidth>1070),[f,k]=(0,a.useState)(!1),[j,S]=(0,a.useState)(null),[C,P]=(0,a.useState)(""),[z,D]=(0,a.useState)(""),[F,I]=(0,a.useState)({});(0,a.useEffect)((()=>{const e=()=>{b(window.innerWidth<640),p(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>{if(t){d();const e=(new Date).toISOString().split("T")[0];P(e),D(""),S(null),I({})}else c();return()=>{c()}}),[t,d,c]);const _=async e=>{if(e.preventDefault(),(()=>{const e={};if(C){const t=new Date(C);(new Date).setHours(0,0,0,0);const r=new Date;r.setFullYear(r.getFullYear()+1),t>r&&(e.exitDate=o("lifecycle.offboarding.exitDateTooFar",{defaultValue:"Austrittsdatum darf nicht mehr als 1 Jahr in der Zukunft liegen"}))}else e.exitDate=o("lifecycle.offboarding.exitDateRequired",{defaultValue:"Austrittsdatum ist erforderlich"});return z&&0!==z.trim().length?z.trim().length<10&&(e.exitReason=o("lifecycle.offboarding.exitReasonTooShort",{defaultValue:"Austrittsgrund muss mindestens 10 Zeichen lang sein"})):e.exitReason=o("lifecycle.offboarding.exitReasonRequired",{defaultValue:"Austrittsgrund ist erforderlich"}),I(e),0===Object.keys(e).length})()){k(!0),S(null);try{await w.A.put(N.Sn.LIFECYCLE.STATUS(n),{status:"offboarding",exitDate:C,exitReason:z.trim()}),g(o("lifecycle.offboarding.started",{defaultValue:"Offboarding erfolgreich gestartet"}),"success"),l(),r()}catch(s){var t,a;console.error("Fehler beim Starten des Offboarding:",s);const e=(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||o("lifecycle.offboarding.startError",{defaultValue:"Fehler beim Starten des Offboarding"});S(e),g(e,"error")}finally{k(!1)}}},B=()=>(0,T.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,T.jsx)("div",{className:"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4",children:(0,T.jsxs)("div",{className:"flex items-start",children:[(0,T.jsx)(M.A,{className:"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5 mr-3 flex-shrink-0"}),(0,T.jsxs)("div",{className:"text-sm text-orange-800 dark:text-orange-200",children:[(0,T.jsx)("p",{className:"font-medium mb-1",children:o("lifecycle.offboarding.warningTitle",{defaultValue:"Wichtiger Hinweis"})}),(0,T.jsx)("p",{children:o("lifecycle.offboarding.warningText",{defaultValue:"Durch das Starten des Offboarding-Prozesses werden automatisch Tasks erstellt. Dieser Vorgang kann nicht r\xfcckg\xe4ngig gemacht werden."})})]})]})}),(0,T.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[(0,T.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:o("lifecycle.offboarding.user",{defaultValue:"Mitarbeiter"})}),(0,T.jsx)("p",{className:"font-medium dark:text-white",children:i})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{htmlFor:"exitDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o("lifecycle.offboarding.exitDate",{defaultValue:"Austrittsdatum"})," *"]}),(0,T.jsxs)("div",{className:"relative",children:[(0,T.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,T.jsx)(E.A,{className:"h-5 w-5 text-gray-400"})}),(0,T.jsx)("input",{type:"date",id:"exitDate",value:C,onChange:e=>{P(e.target.value),F.exitDate&&I((e=>(0,m.A)((0,m.A)({},e),{},{exitDate:void 0})))},className:"block w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(F.exitDate?"border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500":"border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500"),required:!0})]}),F.exitDate&&(0,T.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:F.exitDate}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:o("lifecycle.offboarding.exitDateHint",{defaultValue:"Das Datum, an dem der Mitarbeiter die Organisation verl\xe4sst"})})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{htmlFor:"exitReason",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o("lifecycle.offboarding.exitReason",{defaultValue:"Austrittsgrund"})," *"]}),(0,T.jsx)("textarea",{id:"exitReason",value:z,onChange:e=>{D(e.target.value),F.exitReason&&I((e=>(0,m.A)((0,m.A)({},e),{},{exitReason:void 0})))},rows:4,className:"block w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(F.exitReason?"border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500":"border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500"),placeholder:o("lifecycle.offboarding.exitReasonPlaceholder",{defaultValue:"z.B. K\xfcndigung, Vertragsende, etc."}),required:!0}),F.exitReason&&(0,T.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:F.exitReason}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:o("lifecycle.offboarding.exitReasonHint",{defaultValue:"Mindestens 10 Zeichen. Beschreiben Sie den Grund f\xfcr den Austritt."})})]}),j&&(0,T.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3",children:(0,T.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200",children:j})}),(0,T.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,T.jsx)("button",{type:"button",onClick:r,disabled:f,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",title:o("common.cancel",{defaultValue:"Abbrechen"}),children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"submit",disabled:f,className:"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed",title:f?o("common.saving",{defaultValue:"Speichern..."}):o("lifecycle.offboarding.startButton",{defaultValue:"Offboarding starten"}),children:f?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(A.A,{className:"h-5 w-5"})})]})]});return t?x?(0,T.jsxs)(u.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,T.jsx)(u.lG.Title,{className:"text-lg font-semibold dark:text-white",children:o("lifecycle.offboarding.startTitle",{defaultValue:"Offboarding starten"})}),(0,T.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsx)("div",{className:"p-4",children:B()})]})})]}):(0,T.jsxs)(T.Fragment,{children:[t&&!h&&(0,T.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:r,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,T.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,T.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:o("lifecycle.offboarding.startTitle",{defaultValue:"Offboarding starten"})}),(0,T.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsx)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:B()})]})]}):null},G=e=>{let{isOpen:t,onClose:r,onOffboardingCompleted:l,userId:n,userName:i,offboardingTasks:o}=e;const{t:d}=(0,s.Bd)(),{openSidepane:c,closeSidepane:m}=(0,R.N)(),{showMessage:g}=(0,v.A)(),[x,b]=(0,a.useState)(window.innerWidth<640),[h,p]=(0,a.useState)(window.innerWidth>1070),[f,k]=(0,a.useState)(!1),[j,A]=(0,a.useState)(null),[C,P]=(0,a.useState)(""),E=o.filter((e=>"done"===e.status)),z=o.length>0&&E.length===o.length,D=i.trim().toLowerCase();(0,a.useEffect)((()=>{const e=()=>{b(window.innerWidth<640),p(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(t?(c(),P(""),A(null)):m(),()=>{m()})),[t,c,m]);const F=async e=>{if(e.preventDefault(),C.trim().toLowerCase()===D||(A(d("lifecycle.offboarding.complete.confirmTextMismatch",{defaultValue:"Best\xe4tigungstext stimmt nicht \xfcberein"})),0)){k(!0),A(null);try{await w.A.put(N.Sn.LIFECYCLE.STATUS(n),{status:"archived"}),g(d("lifecycle.offboarding.complete.success",{defaultValue:"Offboarding erfolgreich abgeschlossen"}),"success"),l(),r()}catch(s){var t,a;console.error("Fehler beim Abschlie\xdfen des Offboarding:",s);const e=(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||d("lifecycle.offboarding.complete.error",{defaultValue:"Fehler beim Abschlie\xdfen des Offboarding"});A(e),g(e,"error")}finally{k(!1)}}},I=()=>(0,T.jsxs)("form",{onSubmit:F,className:"space-y-4",children:[(0,T.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-md flex items-center space-x-3",children:[(0,T.jsx)(S.A,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}),(0,T.jsxs)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[d("lifecycle.offboarding.complete.user",{defaultValue:"Mitarbeiter"}),": ",i]})]}),o.length>0&&(0,T.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-md",children:[(0,T.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:d("lifecycle.offboarding.complete.tasksStatus",{defaultValue:"Status der Offboarding-Aufgaben"})}),(0,T.jsx)("div",{className:"space-y-2",children:o.map((e=>{const t="done"===e.status;return(0,T.jsxs)("div",{className:"flex items-center space-x-2 text-sm ".concat(t?"text-green-700 dark:text-green-300":"text-orange-700 dark:text-orange-300"),children:[t?(0,T.jsx)(S.A,{className:"h-4 w-4 flex-shrink-0"}):(0,T.jsx)(M.A,{className:"h-4 w-4 flex-shrink-0"}),(0,T.jsx)("span",{children:e.title}),(0,T.jsx)("span",{className:"ml-auto text-xs",children:"(".concat(t?d("common.done",{defaultValue:"Abgeschlossen"}):d("common.open",{defaultValue:"Offen"}),")")})]},e.id)}))})]}),!z&&o.length>0&&(0,T.jsx)("div",{className:"bg-orange-50 dark:bg-orange-900/20 border-l-4 border-orange-400 p-4",children:(0,T.jsxs)("div",{className:"flex",children:[(0,T.jsx)("div",{className:"flex-shrink-0",children:(0,T.jsx)(M.A,{className:"h-5 w-5 text-orange-400","aria-hidden":"true"})}),(0,T.jsxs)("div",{className:"ml-3",children:[(0,T.jsx)("h3",{className:"text-sm font-medium text-orange-800 dark:text-orange-300",children:d("lifecycle.offboarding.complete.warningTitle",{defaultValue:"Nicht alle Aufgaben abgeschlossen"})}),(0,T.jsx)("div",{className:"mt-2 text-sm text-orange-700 dark:text-orange-200",children:(0,T.jsx)("p",{children:d("lifecycle.offboarding.complete.warningText",{defaultValue:"Es sind noch nicht alle Offboarding-Aufgaben abgeschlossen. Sie k\xf6nnen das Offboarding trotzdem abschlie\xdfen, aber es wird empfohlen, alle Aufgaben zuerst zu erledigen."})})})]})]})}),z&&(0,T.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-400 p-4",children:(0,T.jsxs)("div",{className:"flex",children:[(0,T.jsx)("div",{className:"flex-shrink-0",children:(0,T.jsx)(S.A,{className:"h-5 w-5 text-green-400","aria-hidden":"true"})}),(0,T.jsxs)("div",{className:"ml-3",children:[(0,T.jsx)("h3",{className:"text-sm font-medium text-green-800 dark:text-green-300",children:d("lifecycle.offboarding.complete.allTasksCompleted",{defaultValue:"Alle Aufgaben abgeschlossen"})}),(0,T.jsx)("div",{className:"mt-2 text-sm text-green-700 dark:text-green-200",children:(0,T.jsx)("p",{children:d("lifecycle.offboarding.complete.allTasksCompletedText",{defaultValue:"Alle Offboarding-Aufgaben sind abgeschlossen. Sie k\xf6nnen das Offboarding jetzt abschlie\xdfen."})})})]})]})}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{htmlFor:"confirmText",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[d("lifecycle.offboarding.complete.confirmLabel",{userName:i})||'Best\xe4tigen Sie durch Eingabe des Namens: "'.concat(i,'"')," *"]}),(0,T.jsx)("input",{type:"text",id:"confirmText",value:C,onChange:e=>{P(e.target.value),A(null)},className:"w-full px-3 py-2 border ".concat(j&&j.includes("Best\xe4tigung")?"border-red-500":"border-gray-300"," dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"),placeholder:i,required:!0}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:d("lifecycle.offboarding.complete.confirmHint",{defaultValue:"Geben Sie den vollst\xe4ndigen Namen des Mitarbeiters ein, um das Offboarding abzuschlie\xdfen"})})]}),(0,T.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4",children:(0,T.jsxs)("div",{className:"flex",children:[(0,T.jsx)("div",{className:"flex-shrink-0",children:(0,T.jsx)(M.A,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),(0,T.jsxs)("div",{className:"ml-3",children:[(0,T.jsx)("h3",{className:"text-sm font-medium text-red-800 dark:text-red-300",children:d("lifecycle.offboarding.complete.finalWarningTitle",{defaultValue:"Wichtiger Hinweis"})}),(0,T.jsx)("div",{className:"mt-2 text-sm text-red-700 dark:text-red-200",children:(0,T.jsx)("p",{children:d("lifecycle.offboarding.complete.finalWarningText",{defaultValue:"Durch das Abschlie\xdfen des Offboarding wird der Mitarbeiter archiviert. Dieser Vorgang kann nicht r\xfcckg\xe4ngig gemacht werden."})})})]})]})}),(0,T.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,T.jsx)("button",{type:"button",onClick:r,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:f,title:d("common.cancel",{defaultValue:"Abbrechen"}),children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"submit",className:"p-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed",disabled:f||C.trim().toLowerCase()!==D,title:f?d("common.saving",{defaultValue:"Speichern..."}):d("lifecycle.offboarding.complete.button",{defaultValue:"Offboarding abschlie\xdfen"}),children:f?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(S.A,{className:"h-5 w-5"})})]})]});return t?x?(0,T.jsxs)(u.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,T.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700",children:(0,T.jsxs)("div",{className:"flex items-center justify-between",children:[(0,T.jsx)(u.lG.Title,{className:"text-lg font-semibold dark:text-white",children:d("lifecycle.offboarding.complete.title",{defaultValue:"Offboarding abschlie\xdfen"})}),(0,T.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]})}),(0,T.jsxs)("div",{className:"p-6",children:[j&&(0,T.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:j}),I()]})]})})]}):(0,T.jsxs)(T.Fragment,{children:[t&&!h&&(0,T.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:r,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,T.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,T.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:d("lifecycle.offboarding.complete.title",{defaultValue:"Offboarding abschlie\xdfen"})}),(0,T.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[j&&(0,T.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:j}),I()]})]})]}):null},W=e=>{var t;let{userId:r,userName:n}=e;const{t:o}=(0,s.Bd)(),{isHR:d,isAdmin:c}=(0,l.S)(),{showMessage:m}=(0,v.A)(),[u,g]=(0,a.useState)(null),[b,y]=(0,a.useState)([]),[f,k]=(0,a.useState)([]),[j,L]=(0,a.useState)([]),[D,R]=(0,a.useState)(!0),[I,V]=(0,a.useState)(null),[M,W]=(0,a.useState)(!1),[K,H]=(0,a.useState)(!1),[J,Y]=(0,a.useState)(null),[Z,X]=(0,a.useState)(null),[$,Q]=(0,a.useState)(null),[ee,te]=(0,a.useState)(null),[re,ae]=(0,a.useState)(!1),[se,le]=(0,a.useState)(!1),[ne,ie]=(0,a.useState)(!1),[oe,de]=(0,a.useState)(""),[ce,me]=(0,a.useState)(""),ue=(0,a.useRef)(!1),ge=(0,a.useCallback)((async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!ue.current||e)try{var t,a,s,l,n,i;ue.current=!0,R(!0);const[e,o,d,c]=await Promise.all([w.A.get(N.Sn.LIFECYCLE.BY_USER(r)),w.A.get(N.Sn.LIFECYCLE.CERTIFICATES(r)),w.A.get(N.Sn.LIFECYCLE.CONTRACTS(r)),w.A.get(N.Sn.TASKS.BY_USER(r)).catch((()=>({data:[]})))]);g(e.data),y((null===(t=o.data)||void 0===t?void 0:t.certificates)||[]),k((null===(a=d.data)||void 0===a?void 0:a.contracts)||[]);const m=c.data||[],u=["Crear certificado laboral","Realizar liquidaci\xf3n final","Desafiliar de seguridad social"],x=m.filter((e=>u.includes(e.title)));L(x),"onboarding"===(null===(s=e.data)||void 0===s||null===(l=s.lifecycle)||void 0===l?void 0:l.status)&&100===(null===(n=e.data)||void 0===n||null===(i=n.progress)||void 0===i?void 0:i.percent)&&setTimeout((()=>{ge()}),1e3),V(null)}catch(c){var o,d;console.error("Fehler beim Laden der Lebenszyklus-Daten:",c),V((null===(o=c.response)||void 0===o||null===(d=o.data)||void 0===d?void 0:d.message)||"Fehler beim Laden der Daten"),m("Fehler beim Laden der Daten","error")}finally{R(!1),ue.current=!1}else setTimeout((()=>{ue.current||ge(!0)}),500)}),[r]);(0,a.useEffect)((()=>{ue.current=!1,ge()}),[ge]);const xe=()=>{null!==u&&void 0!==u&&u.lifecycle&&(de(u.lifecycle.contractStartDate?new Date(u.lifecycle.contractStartDate).toISOString().split("T")[0]:""),me(u.lifecycle.contractEndDate?new Date(u.lifecycle.contractEndDate).toISOString().split("T")[0]:""),ie(!0))},be=e=>new Date(e).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric"});if(D)return(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:(0,T.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,T.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});if(I)return(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:(0,T.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4",children:(0,T.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:I})})});if(!u)return(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:(0,T.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:o("lifecycle.noData",{defaultValue:"Keine Lebenszyklus-Daten verf\xfcgbar"})})});(null===(t=u.lifecycle)||void 0===t?void 0:t.socialSecurityRegistrations)||u.socialSecurityRegistrations;const{lifecycle:he,progress:pe}=u;return(0,T.jsxs)("div",{className:"space-y-6",children:[(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,T.jsxs)("h3",{className:"text-lg font-semibold dark:text-white flex items-center",children:[(0,T.jsx)(p.A,{className:"h-5 w-5 mr-2"}),o("lifecycle.statusTitle")]}),(0,T.jsxs)("div",{className:"flex items-center space-x-3",children:[function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r={onboarding:{color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300",labelKey:"lifecycle.status.onboarding"},active:{color:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300",labelKey:"lifecycle.status.active"},contract_change:{color:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300",labelKey:"lifecycle.status.contract_change"},offboarding:{color:"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300",labelKey:"lifecycle.status.offboarding"},archived:{color:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",labelKey:"lifecycle.status.archived"}}[e]||{color:"bg-gray-100 text-gray-800",labelKey:e};return(0,T.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(r.color," ").concat(t?"cursor-pointer hover:opacity-80":""),children:o(r.labelKey)||e})}(he.status),(d()||c())&&"active"===he.status&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>ae(!0),className:"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500",children:(0,T.jsx)(A.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.offboarding.startButton",{defaultValue:"Offboarding starten"})})]}),(d()||c())&&"offboarding"===he.status&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>le(!0),className:"p-2 bg-red-600 dark:bg-red-700 text-white rounded-md hover:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:(0,T.jsx)(S.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.offboarding.complete.button",{defaultValue:"Offboarding abschlie\xdfen"})})]})]})]}),(0,T.jsxs)("div",{className:"space-y-2 text-sm",children:[he.onboardingStartedAt&&(0,T.jsxs)("div",{className:"flex justify-between",children:[(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.onboardingStarted")}),(0,T.jsx)("span",{className:"dark:text-white",children:new Date(he.onboardingStartedAt).toLocaleDateString("de-DE")})]}),he.onboardingCompletedAt&&(0,T.jsxs)("div",{className:"flex justify-between",children:[(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.onboardingCompleted")}),(0,T.jsx)("span",{className:"dark:text-white",children:new Date(he.onboardingCompletedAt).toLocaleDateString("de-DE")})]}),(0,T.jsxs)("div",{className:"flex justify-between items-center",children:[(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.contractStart")}),(0,T.jsxs)("div",{className:"flex items-center space-x-2",children:[he.contractStartDate?(0,T.jsx)("span",{className:"dark:text-white",children:new Date(he.contractStartDate).toLocaleDateString("de-DE")}):(0,T.jsx)("span",{className:"text-gray-400 italic text-sm",children:o("lifecycle.notSet",{defaultValue:"Nicht gesetzt"})}),(d()||c())&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>xe(),className:"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition",children:(0,T.jsx)(C.A,{className:"h-4 w-4"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.edit",{defaultValue:"Bearbeiten"})})]})]})]}),(0,T.jsxs)("div",{className:"flex justify-between items-center",children:[(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.contractEnd")}),(0,T.jsxs)("div",{className:"flex items-center space-x-2",children:[he.contractEndDate?(0,T.jsx)("span",{className:"dark:text-white",children:new Date(he.contractEndDate).toLocaleDateString("de-DE")}):(0,T.jsx)("span",{className:"text-gray-400 italic text-sm",children:o("lifecycle.notSet",{defaultValue:"Nicht gesetzt"})}),(d()||c())&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>xe(),className:"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition",children:(0,T.jsx)(C.A,{className:"h-4 w-4"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.edit",{defaultValue:"Bearbeiten"})})]})]})]}),he.offboardingStartedAt&&(0,T.jsxs)("div",{className:"flex justify-between",children:[(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.offboardingStarted")}),(0,T.jsx)("span",{className:"dark:text-white",children:new Date(he.offboardingStartedAt).toLocaleDateString("de-DE")})]}),he.exitDate&&(0,T.jsxs)("div",{className:"flex justify-between",children:[(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.exitDate")}),(0,T.jsx)("span",{className:"dark:text-white",children:new Date(he.exitDate).toLocaleDateString("de-DE")})]}),he.exitReason&&(0,T.jsxs)("div",{className:"flex justify-between",children:[(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.exitReason")}),(0,T.jsx)("span",{className:"dark:text-white",children:he.exitReason})]})]})]}),"onboarding"===he.status&&(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,T.jsx)("h3",{className:"text-lg font-semibold dark:text-white mb-4",children:o("lifecycle.progressTitle")}),(0,T.jsxs)("div",{className:"space-y-2",children:[(0,T.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.progressSteps",{completed:pe.completed,total:pe.total})}),(0,T.jsxs)("span",{className:"font-medium dark:text-white",children:[pe.percent,"%"]})]}),(0,T.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:(0,T.jsx)("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-300",style:{width:"".concat(pe.percent,"%")}})})]})]}),"offboarding"===he.status&&(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,T.jsx)("h3",{className:"text-lg font-semibold dark:text-white mb-4",children:o("lifecycle.offboarding.progressTitle",{defaultValue:"Offboarding-Fortschritt"})}),(0,T.jsxs)("div",{className:"space-y-4",children:[(()=>{const e=j.filter((e=>"done"===e.status)).length,t=j.length||3,r=t>0?Math.round(e/t*100):0;return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,T.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.offboarding.progressSteps",{completed:e,total:t})||"".concat(e," von ").concat(t," Schritten abgeschlossen")}),(0,T.jsxs)("span",{className:"font-medium dark:text-white",children:[r,"%"]})]}),(0,T.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:(0,T.jsx)("div",{className:"bg-orange-600 h-3 rounded-full transition-all duration-300",style:{width:"".concat(r,"%")}})})]})})(),j.length>0&&(0,T.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,T.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o("lifecycle.offboarding.tasksTitle",{defaultValue:"Offboarding-Aufgaben"})}),j.map((e=>{const t="done"===e.status;return(0,T.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border ".concat(t?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600"),children:[(0,T.jsxs)("div",{className:"flex items-center space-x-3 flex-1",children:[t?(0,T.jsx)(S.A,{className:"h-5 w-5 text-green-600 dark:text-green-400 flex-shrink-0"}):(0,T.jsx)(P.A,{className:"h-5 w-5 text-orange-600 dark:text-orange-400 flex-shrink-0"}),(0,T.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,T.jsx)("p",{className:"text-sm font-medium ".concat(t?"text-green-800 dark:text-green-200":"text-gray-800 dark:text-gray-200"),children:e.title}),e.description&&(0,T.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 truncate",children:e.description})]})]}),(0,T.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat(t?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200"),children:t?o("common.done",{defaultValue:"Abgeschlossen"}):o("common.open",{defaultValue:"Offen"})})]},e.id)}))]})]})]}),(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,T.jsxs)("h3",{className:"text-lg font-semibold dark:text-white flex items-center",children:[(0,T.jsx)(h.A,{className:"h-5 w-5 mr-2"}),o("lifecycle.certificates")]}),(d()||c())&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>W(!0),className:"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":o("lifecycle.createCertificate"),children:(0,T.jsx)(x.A,{className:"h-4 w-4"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.createCertificate")})]})]}),0===b.length?(0,T.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,T.jsx)(h.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,T.jsx)("p",{children:o("lifecycle.noCertificates")})]}):(0,T.jsx)("div",{className:"space-y-4",children:b.map((e=>(0,T.jsx)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition",children:(0,T.jsxs)("div",{className:"flex items-start justify-between",children:[(0,T.jsxs)("div",{className:"flex-1",children:[(0,T.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,T.jsxs)("h4",{className:"font-medium dark:text-white",children:[o("lifecycle.certificate"),"employment"!==e.certificateType&&" (".concat(e.certificateType,")")]}),e.isLatest&&(0,T.jsxs)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center",children:[(0,T.jsx)(S.A,{className:"h-3 w-3 mr-1"}),o("lifecycle.current")]})]}),(0,T.jsxs)("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[(0,T.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,T.jsx)(E.A,{className:"h-4 w-4"}),(0,T.jsxs)("span",{children:[o("lifecycle.issuedOn")," ",be(e.issueDate)]})]}),e.generatedByUser&&(0,T.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,T.jsx)(i.A,{className:"h-4 w-4"}),(0,T.jsxs)("span",{children:[o("lifecycle.createdBy")," ",e.generatedByUser.firstName," ",e.generatedByUser.lastName]})]})]})]}),(0,T.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(d()||c())&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>Y(e),className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition",children:(0,T.jsx)(C.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.edit")})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>(async e=>{Q(e);try{const t=await w.A.get(N.Sn.LIFECYCLE.CERTIFICATE_DOWNLOAD(r,e),{responseType:"blob"}),a=new Blob([t.data],{type:"application/pdf"}),s=window.URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download="arbeitszeugnis-".concat(e,".pdf"),document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(s),m("Arbeitszeugnis erfolgreich heruntergeladen","success")}catch(t){console.error("Fehler beim Herunterladen:",t),m("Fehler beim Herunterladen des Arbeitszeugnisses","error")}finally{Q(null)}})(e.id),disabled:$===e.id,className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed",children:$===e.id?(0,T.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}):(0,T.jsx)(z.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.download")})]})]})]})},e.id)))})]}),(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,T.jsxs)("div",{className:"flex items-center mb-4",children:[(d()||c())&&(0,T.jsxs)("div",{className:"relative group mr-3",children:[(0,T.jsx)("button",{onClick:()=>H(!0),className:"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":o("lifecycle.createContract"),children:(0,T.jsx)(x.A,{className:"h-4 w-4"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.createContract")})]}),(0,T.jsxs)("h3",{className:"text-lg font-semibold dark:text-white flex items-center",children:[(0,T.jsx)(h.A,{className:"h-5 w-5 mr-2"}),o("lifecycle.contracts")]})]}),0===f.length?(0,T.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,T.jsx)(h.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,T.jsx)("p",{children:o("lifecycle.noContracts")})]}):(0,T.jsx)("div",{className:"space-y-4",children:f.map((e=>(0,T.jsx)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition",children:(0,T.jsxs)("div",{className:"flex items-start justify-between",children:[(0,T.jsxs)("div",{className:"flex-1",children:[(0,T.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,T.jsxs)("h4",{className:"font-medium dark:text-white",children:[o("lifecycle.contract"),"employment"!==e.contractType&&" (".concat(e.contractType,")")]}),e.isLatest&&(0,T.jsxs)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center",children:[(0,T.jsx)(S.A,{className:"h-3 w-3 mr-1"}),o("lifecycle.current")]})]}),(0,T.jsxs)("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[(0,T.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,T.jsx)(E.A,{className:"h-4 w-4"}),(0,T.jsxs)("span",{children:[be(e.startDate),e.endDate&&" - ".concat(be(e.endDate))]})]}),e.position&&(0,T.jsxs)("div",{children:[o("lifecycle.position")," ",e.position]}),e.salary&&(0,T.jsxs)("div",{children:[o("lifecycle.salary")," ",e.salary.toLocaleString("de-DE",{style:"currency",currency:"EUR"})]}),e.workingHours&&(0,T.jsxs)("div",{children:[o("lifecycle.workingHours")," ",e.workingHours,"h/Woche"]}),e.generatedByUser&&(0,T.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,T.jsx)(i.A,{className:"h-4 w-4"}),(0,T.jsxs)("span",{children:[o("lifecycle.createdBy")," ",e.generatedByUser.firstName," ",e.generatedByUser.lastName]})]})]})]}),(0,T.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(d()||c())&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>X(e),className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition",children:(0,T.jsx)(C.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.edit")})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>(async e=>{te(e);try{const t=await w.A.get(N.Sn.LIFECYCLE.CONTRACT_DOWNLOAD(r,e),{responseType:"blob"}),a=new Blob([t.data],{type:"application/pdf"}),s=window.URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download="arbeitsvertrag-".concat(e,".pdf"),document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(s),m("Arbeitsvertrag erfolgreich heruntergeladen","success")}catch(t){console.error("Fehler beim Herunterladen:",t),m("Fehler beim Herunterladen des Arbeitsvertrags","error")}finally{te(null)}})(e.id),disabled:ee===e.id,className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed",children:ee===e.id?(0,T.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}):(0,T.jsx)(z.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.download")})]})]})]})},e.id)))})]}),(null===u||void 0===u?void 0:u.lifecycle)&&(0,T.jsx)(U,{userId:r,lifecycleId:u.lifecycle.id,onUpdate:()=>ge(!0)}),(0,T.jsx)(F,{isOpen:M,onClose:()=>W(!1),onCertificateCreated:()=>{ge(),W(!1)},userId:r,userName:n}),(0,T.jsx)(_,{isOpen:K,onClose:()=>H(!1),onContractCreated:()=>{ge(),H(!1)},userId:r,userName:n}),J&&(0,T.jsx)(B,{isOpen:!!J,onClose:()=>Y(null),onCertificateUpdated:()=>{ge(),Y(null)},userId:r,certificate:J}),Z&&(0,T.jsx)(O,{isOpen:!!Z,onClose:()=>X(null),onContractUpdated:()=>{ge(),X(null)},userId:r,contract:Z}),(0,T.jsx)(q,{isOpen:re,onClose:()=>ae(!1),onOffboardingStarted:()=>{ge(),ae(!1)},userId:r,userName:n}),(0,T.jsx)(G,{isOpen:se,onClose:()=>le(!1),onOffboardingCompleted:()=>{ge(),le(!1)},userId:r,userName:n,offboardingTasks:j}),ne&&(0,T.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md mx-4",children:[(0,T.jsx)("h2",{className:"text-xl font-semibold dark:text-white mb-4",children:o("lifecycle.editContractDates",{defaultValue:"Vertragsdaten bearbeiten"})}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o("lifecycle.contractStart",{defaultValue:"Vertragsbeginn"})," *"]}),(0,T.jsx)("input",{type:"date",value:oe,onChange:e=>de(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",required:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o("lifecycle.contractEnd",{defaultValue:"Vertragsende"})," (optional)"]}),(0,T.jsx)("input",{type:"date",value:ce,onChange:e=>me(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:o("lifecycle.contractEndHint",{defaultValue:"Nur bei befristeten Vertr\xe4gen ausf\xfcllen"})})]})]}),(0,T.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,T.jsx)("button",{onClick:()=>ie(!1),className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition",children:o("common.cancel",{defaultValue:"Abbrechen"})}),(0,T.jsx)("button",{onClick:async()=>{try{await w.A.put(N.Sn.LIFECYCLE.STATUS(r),{status:(null===u||void 0===u?void 0:u.lifecycle.status)||"active",contractStartDate:oe||null,contractEndDate:ce||null}),m("Vertragsdaten erfolgreich aktualisiert","success"),ie(!1),ge()}catch(e){console.error("Fehler beim Speichern der Vertragsdaten:",e),m("Fehler beim Speichern der Vertragsdaten","error")}},disabled:!oe,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:o("common.save",{defaultValue:"Speichern"})})]})]})})]})},K=[{code:"tiempo_completo",name:"Tiempo Completo (>21 Tage/Monat)"},{code:"tiempo_parcial_7",name:"Tiempo Parcial (\u22647 Tage/Monat)"},{code:"tiempo_parcial_14",name:"Tiempo Parcial (\u226414 Tage/Monat)"},{code:"tiempo_parcial_21",name:"Tiempo Parcial (\u226421 Tage/Monat)"},{code:"prestacion_de_servicios",name:"Prestaci\xf3n de Servicios"},{code:"externo",name:"Externo"}],H=e=>{let{onError:t}=e;const{t:r}=(0,s.Bd)(),n=[{code:"CO",name:r("countries.CO")},{code:"CH",name:r("countries.CH")},{code:"DE",name:r("countries.DE")},{code:"AT",name:r("countries.AT")}],i=[{code:"CH",name:r("countries.CH")},{code:"CO",name:r("countries.CO")}],c=[{code:"es",name:r("languages.es")},{code:"de",name:r("languages.de")},{code:"en",name:r("languages.en")}],[w,N]=(0,a.useState)([]),[A,S]=(0,a.useState)(null),[C,P]=(0,a.useState)({}),[E,z]=(0,a.useState)(!1),[L,D]=(0,a.useState)([]),[F,I]=(0,a.useState)(0),[_,B]=(0,a.useState)(!1),[O,V]=(0,a.useState)(null),{showMessage:U}=(0,v.A)(),{isAdmin:M}=(0,l.S)(),[q,G]=(0,a.useState)([]),[H,J]=(0,a.useState)(!1),[Y,Z]=(0,a.useState)([]),[X,$]=(0,a.useState)(!1),[Q,ee]=(0,a.useState)([]),[te,re]=(0,a.useState)("details"),[ae,se]=(0,a.useState)("active"),[le,ne]=(0,a.useState)(!1),[ie,oe]=(0,a.useState)(window.innerWidth<640),[de,ce]=(0,a.useState)(window.innerWidth>1070),{openSidepane:me,closeSidepane:ue}=(0,R.N)(),[ge,xe]=(0,a.useState)(!1),[be,he]=(0,a.useState)({email:"",password:"",firstName:"",lastName:""});(0,a.useEffect)((()=>{const e=()=>{oe(window.innerWidth<640),ce(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(le?me():ue(),()=>{ue()})),[le,me,ue]);const[pe,ye]=(0,a.useState)([]);(0,a.useEffect)((()=>{fe()}),[]);const fe=async()=>{try{const e=await g.i$.getAll();ye(e.data),ve("active",e.data)}catch(e){je(e)}},ve=function(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:pe).filter((t=>{const r=void 0===t.active||t.active;return"active"===e?r:!r})).sort(((e,t)=>{const r=(e.username||"").toLowerCase(),a=(t.username||"").toLowerCase(),s=(e.firstName||"").toLowerCase(),l=(t.firstName||"").toLowerCase();return r!==a?r.localeCompare(a):s.localeCompare(l)}));N(t)};(0,a.useEffect)((()=>{pe.length>0&&ve(ae,pe)}),[ae]);const ke=async e=>{try{if(!e||isNaN(e))return void S(null);console.log("Lade Benutzerdetails f\xfcr ID:",e);const t=await g.i$.getById(e),r=(0,m.A)((0,m.A)({},t.data),{},{active:void 0===t.data.active||t.data.active,birthday:t.data.birthday?new Date(t.data.birthday).toISOString().split("T")[0]:null});let a=[];t.data.roles&&Array.isArray(t.data.roles)?(console.log("Rollenstruktur (Typ):",typeof t.data.roles,"L\xe4nge:",t.data.roles.length),t.data.roles.length>0&&t.data.roles[0].role?(a=t.data.roles.map((e=>e.role.id)),console.log("Extrahierte Rollen-IDs aus verschachtelter Struktur:",a)):t.data.roles.length>0&&("number"===typeof t.data.roles[0]?a=t.data.roles:t.data.roles[0].roleId?a=t.data.roles.map((e=>e.roleId)):t.data.roles[0].id&&(a=t.data.roles.map((e=>e.id))))):console.warn("Rollen fehlen oder sind kein Array:",t.data.roles),0===a.length&&t.data.role&&(console.log("Versuche Rollen aus role-Eigenschaft zu extrahieren:",t.data.role),Array.isArray(t.data.role)?a=t.data.role.map((e=>e.id)):"object"===typeof t.data.role&&null!==t.data.role&&(a=[t.data.role.id])),console.log("Endg\xfcltige extrahierte Rollen-IDs:",a);let s=[];t.data.branches&&Array.isArray(t.data.branches)?(console.log("Branches-Struktur (Typ):",typeof t.data.branches,"L\xe4nge:",t.data.branches.length),t.data.branches.length>0&&t.data.branches[0].branch?(s=t.data.branches.map((e=>e.branch.id)),console.log("Extrahierte Branch-IDs aus verschachtelter Struktur:",s)):t.data.branches.length>0&&("number"===typeof t.data.branches[0]?s=t.data.branches:t.data.branches[0].branchId?s=t.data.branches.map((e=>e.branchId)):t.data.branches[0].id&&(s=t.data.branches.map((e=>e.id))))):console.warn("Branches fehlen oder sind kein Array:",t.data.branches),console.log("Endg\xfcltige extrahierte Branch-IDs:",s),S(r),P(r),D(a),ee(s),0===q.length&&await(async()=>{try{J(!0);const t=[{id:1,name:"admin",description:"Administrator mit allen Rechten",permissions:[]},{id:2,name:"user",description:"Standardbenutzer",permissions:[]},{id:999,name:"hamburger",description:"Hamburger-Rolle f\xfcr neue Benutzer",permissions:[]}];try{const e=await g.Zj.getAll();e.data&&Array.isArray(e.data)&&e.data.length>0?(G(e.data),console.log("".concat(e.data.length," Rollen erfolgreich geladen"))):(console.warn("Keine Rollen vom Server erhalten, verwende Fallback"),G(t))}catch(e){console.warn("Fehler beim Laden der Rollen, verwende Fallback:",e),G(t)}}finally{J(!1)}})(),0===Y.length&&await(async()=>{try{$(!0);try{const e=await g.H_.getAll();e.data&&Array.isArray(e.data)&&e.data.length>0?(Z(e.data),console.log("".concat(e.data.length," Branches erfolgreich geladen"))):(console.warn("Keine Branches vom Server erhalten"),Z([]))}catch(e){console.warn("Fehler beim Laden der Branches:",e),Z([])}}finally{$(!1)}})()}catch(t){console.error("Fehler beim Laden der Benutzerdetails:",t),je(t)}},je=e=>{var r,a;let s="Ein Fehler ist aufgetreten";null!==(r=e.response)&&void 0!==r&&null!==(a=r.data)&&void 0!==a&&a.message?s=e.response.data.message:e instanceof Error&&(s=e.message),!s.includes("Ung\xfcltige Rollen-ID")||A?t(s):console.warn("Fehler unterdr\xfcckt, da kein Benutzer ausgew\xe4hlt ist:",s)},we=e=>{const{name:t,value:r,type:a}=e.target;let s=r;"number"===a&&(s=""===r?null:Number(r)),P((0,m.A)((0,m.A)({},C),{},{[t]:s})),z(!0)},Ne=async e=>{if(e&&A)if(1===e&&1===A.id&&L.includes(e))U("Die Admin-Rolle kann vom Admin-Benutzer nicht entfernt werden","warning");else try{console.log("Toggle Rolle:",e,"f\xfcr Benutzer:",A.id),console.log("Aktuelle ausgew\xe4hlte Rollen:",L);const t=L.includes(e),r=t?L.filter((t=>t!==e)):[...L,e];console.log("Neue ausgew\xe4hlte Rollen:",r),D(r),console.log("Sende Rollenaktualisierung an API:",{userId:A.id,roleIds:r});const a=await g.i$.updateRoles(A.id,r);console.log("API-Antwort bei Rollenaktualisierung:",a.data),await ke(A.id),U(t?"Rolle erfolgreich entfernt":"Rolle erfolgreich zugewiesen","success")}catch(t){console.error("Fehler beim Aktualisieren der Rollen:",t),ke(A.id),je(t),U("Fehler beim Aktualisieren der Rollen","error")}},Ae=async e=>{if(e&&A)try{console.log("Toggle Branch:",e,"f\xfcr Benutzer:",A.id),console.log("Aktuelle ausgew\xe4hlte Branches:",Q);const t=Q.includes(e),r=t?Q.filter((t=>t!==e)):[...Q,e];console.log("Neue ausgew\xe4hlte Branches:",r),ee(r),console.log("Sende Branch-Aktualisierung an API:",{userId:A.id,branchIds:r});const a=await g.i$.updateBranches(A.id,r);console.log("API-Antwort bei Branch-Aktualisierung:",a.data),await ke(A.id),U(t?"Branch erfolgreich entfernt":"Branch erfolgreich zugewiesen","success")}catch(t){console.error("Fehler beim Aktualisieren der Branches:",t),ke(A.id),je(t),U("Fehler beim Aktualisieren der Branches","error")}};(0,a.useEffect)((()=>{A&&(P((0,m.A)((0,m.A)({},A),{},{birthday:A.birthday?new Date(A.birthday).toISOString().split("T")[0]:null})),z(!1))}),[A]);const Se=e=>{const{name:t,value:r}=e.target;he((0,m.A)((0,m.A)({},be),{},{[t]:r}))},Ce=async e=>{if(e.preventDefault(),be.email&&be.password&&be.firstName&&be.lastName)if(be.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/))try{const e=await g.i$.create(be);if(e.data){const t=(0,m.A)((0,m.A)({},e.data),{},{active:void 0===e.data.active||e.data.active});ye((e=>[t,...e])),"active"===ae&&t.active&&N((e=>[t,...e]))}U("Benutzer erfolgreich erstellt","success"),ne(!1),he({email:"",password:"",firstName:"",lastName:""})}catch(s){var r,a;await fe();const e=(null===(r=s.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||"Fehler beim Erstellen des Benutzers";U(e,"error"),t(e)}else U("Ung\xfcltiges E-Mail-Format","error");else U("Bitte f\xfcllen Sie alle Felder aus","error")};return(0,T.jsxs)("div",{className:"container mx-auto px-4 pb-6",children:[(0,T.jsx)("div",{className:"mb-6",children:(0,T.jsxs)("div",{className:"flex items-start gap-4",children:[(0,T.jsx)("div",{className:"flex items-center pt-8",children:M()&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>ne(!0),className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":r("users.create"),children:(0,T.jsx)(x.A,{className:"h-4 w-4"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("users.create")})]})}),(0,T.jsxs)("div",{className:"flex-1",children:[(0,T.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,T.jsx)("button",{type:"button",onClick:()=>se("active"),className:"px-3 py-1.5 rounded-full text-sm font-medium transition-colors ".concat("active"===ae?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"),children:r("users.active")}),(0,T.jsx)("button",{type:"button",onClick:()=>se("inactive"),className:"px-3 py-1.5 rounded-full text-sm font-medium transition-colors ".concat("inactive"===ae?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"),children:r("users.inactive")})]}),(0,T.jsxs)("select",{id:"userSelect",onChange:e=>{const t=parseInt(e.target.value,10);t&&!isNaN(t)?ke(t):(S(null),P({}),D([]))},className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",children:[(0,T.jsxs)("option",{value:"",children:["-- ",r("common.select")," --"]}),w.map((e=>(0,T.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName," (",e.username,")"]},e.id)))]})]})]})}),A&&(0,T.jsx)("div",{children:(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 mb-6",children:[(0,T.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,T.jsxs)("nav",{className:"flex -mb-px",children:[(0,T.jsxs)("button",{onClick:()=>re("details"),className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("details"===te?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[(0,T.jsx)(b.A,{className:"h-5 w-5 inline mr-2"}),r("users.title")]}),(0,T.jsxs)("button",{onClick:()=>re("documents"),className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("documents"===te?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[(0,T.jsx)(h.A,{className:"h-5 w-5 inline mr-2"}),r("profile.documents")]}),(0,T.jsxs)("button",{onClick:()=>re("roles"),className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("roles"===te?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[(0,T.jsx)(o.A,{className:"h-5 w-5 inline mr-2"}),r("roles.title")]}),(0,T.jsxs)("button",{onClick:()=>re("branches"),className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("branches"===te?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[(0,T.jsx)(d.A,{className:"h-5 w-5 inline mr-2"}),r("branches.title")||"Niederlassungen"]}),(0,T.jsxs)("button",{onClick:()=>re("lifecycle"),className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("lifecycle"===te?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[(0,T.jsx)(p.A,{className:"h-5 w-5 inline mr-2"}),r("lifecycle.tabTitle")]})]})}),"details"===te&&(0,T.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!A||!A.id)return t("Kein Benutzer ausgew\xe4hlt"),void U("Kein Benutzer ausgew\xe4hlt","error");try{var r,a;if(null===(r=C.username)||void 0===r||!r.trim())throw new Error("Benutzername ist erforderlich");if(null===(a=C.email)||void 0===a||!a.trim())throw new Error("E-Mail ist erforderlich");const e={username:C.username,email:C.email,bankDetails:C.bankDetails||null,gender:C.gender||null,phoneNumber:C.phoneNumber||null,language:C.language||null,hourlyRate:null===C.hourlyRate||void 0===C.hourlyRate||""===C.hourlyRate?null:"string"===typeof C.hourlyRate?C.hourlyRate:C.hourlyRate.toString(),monthlySalary:null===C.monthlySalary||void 0===C.monthlySalary||""===C.monthlySalary?null:"string"===typeof C.monthlySalary?parseFloat(C.monthlySalary):C.monthlySalary,payrollCountry:C.payrollCountry||null,contractType:C.contractType||null};console.log("Sende Daten zum Server:",e);const t=await g.i$.update(A.id,e);if(t.data){const e=(0,m.A)((0,m.A)({},t.data),{},{birthday:t.data.birthday?new Date(t.data.birthday).toISOString().split("T")[0]:null});S(e),P((0,m.A)((0,m.A)({},e),{},{birthday:e.birthday?new Date(e.birthday).toISOString().split("T")[0]:null})),ye((t=>t.map((t=>t.id===e.id?e:t)))),ve(ae,pe.map((t=>t.id===e.id?e:t))),U("Benutzerprofil erfolgreich aktualisiert","success"),z(!1)}}catch(o){var s,l;if(console.error("Fehler beim Speichern der Benutzerdaten:",o),await fe(),400===(null===(s=o.response)||void 0===s?void 0:s.status)){var n,i;const e="Validierungsfehler: ".concat((null===(n=o.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.message)||"Bitte \xfcberpr\xfcfe die eingegebenen Daten");t(e),U(e,"error")}else 404===(null===(l=o.response)||void 0===l?void 0:l.status)?(t("Benutzer wurde nicht gefunden"),U("Benutzer wurde nicht gefunden","error")):je(o)}},className:"p-6",children:[(0,T.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("users.form.username")}),(0,T.jsx)("input",{type:"text",name:"username",value:C.username||"",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("users.form.email")}),(0,T.jsx)("input",{type:"email",name:"email",value:C.email||"",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("profile.language")," ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsx)("select",{name:"language",value:C.language||"es",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",required:!0,children:c.map((e=>(0,T.jsx)("option",{value:e.code,children:e.name},e.code)))})]}),A&&(0,T.jsx)("div",{className:"sm:col-span-2",children:(0,T.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("h3",{className:"text-sm font-medium text-blue-900 dark:text-blue-200 mb-1",children:r("profile.identificationDocument")||"Identifikationsdokument"}),(0,T.jsx)("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:r("profile.uploadDocumentHint")||"Bitte laden Sie das Identifikationsdokument (C\xe9dula oder Pasaporte) hoch. Die Felder werden automatisch ausgef\xfcllt."})]}),!ge&&(0,T.jsxs)("button",{type:"button",onClick:()=>xe(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",children:[(0,T.jsx)(h.A,{className:"h-5 w-5 inline mr-2"}),r("profile.uploadDocument")||"Dokument hochladen"]})]}),ge&&(0,T.jsx)("div",{className:"mt-4",children:(0,T.jsx)(j.A,{userId:A.id,onDocumentSaved:async()=>{xe(!1),await ke(A.id),U("Dokument erfolgreich hochgeladen. Felder werden automatisch ausgef\xfcllt.","success")},onCancel:()=>xe(!1)})})]})}),A.identificationDocuments&&A.identificationDocuments.length>0&&(0,T.jsx)(T.Fragment,{children:(e=>{const t=A.identificationDocuments[0];return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("users.form.firstName")}),(0,T.jsx)("input",{type:"text",value:A.firstName||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("users.form.lastName")}),(0,T.jsx)("input",{type:"text",value:A.lastName||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.birthday")}),(0,T.jsx)("input",{type:"text",value:A.birthday?new Date(A.birthday).toISOString().split("T")[0]:"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.country")}),(0,T.jsx)("input",{type:"text",value:A.country?(null===(e=n.find((e=>e.code===A.country)))||void 0===e?void 0:e.name)||A.country:"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.gender")}),(0,T.jsxs)("select",{name:"gender",value:C.gender||"",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:"",children:r("profile.selectGender")}),(0,T.jsx)("option",{value:"male",children:r("profile.genderMale")}),(0,T.jsx)("option",{value:"female",children:r("profile.genderFemale")}),(0,T.jsx)("option",{value:"other",children:r("profile.genderOther")})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.identificationType")}),(0,T.jsx)("input",{type:"text",value:t.documentType?{passport:r("identificationDocuments.types.passport"),national_id:r("identificationDocuments.types.national_id"),driving_license:r("identificationDocuments.types.driving_license"),residence_permit:r("identificationDocuments.types.residence_permit"),work_permit:r("identificationDocuments.types.work_permit"),tax_id:r("identificationDocuments.types.tax_id"),social_security:r("identificationDocuments.types.social_security")}[t.documentType]||t.documentType:"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.identificationNumber")}),(0,T.jsx)("input",{type:"text",value:A.identificationNumber||t.documentNumber||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),t.issueDate&&(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.identificationIssueDate")||"Ausstellungsdatum"}),(0,T.jsx)("input",{type:"text",value:new Date(t.issueDate).toISOString().split("T")[0],disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),t.expiryDate&&(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.identificationExpiryDate")}),(0,T.jsx)("input",{type:"text",value:new Date(t.expiryDate).toISOString().split("T")[0],disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]})]})})()}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.phoneNumber")}),(0,T.jsx)("input",{type:"tel",name:"phoneNumber",value:C.phoneNumber||"",onChange:we,placeholder:"+573001234567",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"}),(0,T.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:r("profile.phoneNumberHint")})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.bankDetails")}),(0,T.jsx)("input",{type:"text",name:"bankDetails",value:C.bankDetails||"",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"})]})]}),(0,T.jsxs)("div",{className:"mt-4 border-t pt-4",children:[(0,T.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:r("users.form.payrollSettings")}),(0,T.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("users.form.payrollCountry")}),(0,T.jsx)("select",{name:"payrollCountry",value:C.payrollCountry||A.payrollCountry||"CH",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:i.map((e=>(0,T.jsx)("option",{value:e.code,children:e.name},e.code)))})]}),("CO"===C.payrollCountry||"CO"===A.payrollCountry&&!C.payrollCountry)&&(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("users.form.contractType")}),(0,T.jsxs)("select",{name:"contractType",value:C.contractType||"",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:"",children:"Bitte ausw\xe4hlen"}),K.map((e=>(0,T.jsx)("option",{value:e.code,children:e.name},e.code)))]})]})]}),(0,T.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("users.form.hourlyRate")," (","CH"===(C.payrollCountry||A.payrollCountry)?"CHF":"COP",")"]}),(0,T.jsx)("input",{type:"number",name:"hourlyRate",min:"0",step:"CH"===(C.payrollCountry||A.payrollCountry)?"0.05":"1",value:null===C.hourlyRate||void 0===C.hourlyRate?"":C.hourlyRate,onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"CH"===(C.payrollCountry||A.payrollCountry)?"z.B. 45.00":"z.B. 50000"})]}),("CO"===C.payrollCountry||"CO"===A.payrollCountry)&&"servicios_externos"!==C.contractType&&"servicios_externos"!==A.contractType&&(C.contractType||A.contractType)&&(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("users.form.monthlySalary")," (COP)"]}),(0,T.jsx)("input",{type:"number",name:"monthlySalary",min:"0",step:"1000",value:null===C.monthlySalary||void 0===C.monthlySalary?"":C.monthlySalary,onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"z.B. 3500000"})]})]})]}),E&&(0,T.jsxs)("div",{className:"mt-4 flex justify-end gap-3",children:[(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>{A&&P((0,m.A)((0,m.A)({},A),{},{birthday:A.birthday?new Date(A.birthday).toISOString().split("T")[0]:null})),z(!1)},className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.cancel")})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800",children:(0,T.jsx)(f.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.save")})]})]}),(0,T.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[void 0!==A.active&&(0,T.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(A.active?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300"),children:A.active?r("users.active"):r("users.inactive")}),M()&&(0,T.jsx)("button",{onClick:async()=>{if(!A||!A.id)return void U("Kein Benutzer ausgew\xe4hlt","error");const e=parseInt(localStorage.getItem("userId")||"0",10);if(A.id!==e)try{const e=void 0===A.active||A.active,t=!e;console.log("Toggle active:",{currentActiveStatus:e,newActiveStatus:t,selectedUser:A,selectedUserActive:A.active,userId:A.id});const r={active:t};console.log("Sending update payload:",r,"Type of active:",typeof t);const a=await g.i$.update(A.id,r);if(console.log("Update response:",a.data),a.data){const e=(0,m.A)((0,m.A)({},a.data),{},{active:void 0===a.data.active||a.data.active,birthday:a.data.birthday?new Date(a.data.birthday).toISOString().split("T")[0]:null});console.log("Updated user data:",e),S(e),P((0,m.A)((0,m.A)({},e),{},{birthday:e.birthday?new Date(e.birthday).toISOString().split("T")[0]:null}));const r=pe.map((t=>t.id===e.id?e:t));ye(r),ve(ae,r),U(t?"Benutzer erfolgreich aktiviert":"Benutzer erfolgreich deaktiviert","success")}}catch(t){console.error("Fehler beim Aktivieren/Deaktivieren des Benutzers:",t),je(t),await fe()}else U("Du kannst dich nicht selbst deaktivieren","warning")},className:"relative group flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat(A.active?"bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30":"bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900/20 dark:text-green-400 dark:hover:bg-green-900/30"),children:A.active?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(y.A,{className:"h-5 w-5"}),r("users.deactivate")]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(f.A,{className:"h-5 w-5"}),r("users.activate")]})})]})]}),"documents"===te&&(0,T.jsx)("div",{className:"p-6",children:(0,T.jsx)(k.A,{userId:A.id,isAdmin:!0})}),"roles"===te&&(0,T.jsx)("div",{className:"p-6",children:H?(0,T.jsxs)("div",{className:"mt-4 mb-4",children:[(0,T.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:r("roleAssignment.title")}),(0,T.jsx)("p",{className:"dark:text-gray-300",children:r("roleAssignment.loading")})]}):q.length>0&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:r("roleAssignment.title")}),L.some((e=>!q.some((t=>t.id===e))))&&(0,T.jsxs)("div",{className:"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4",children:[(0,T.jsx)("p",{className:"font-bold",children:r("roleAssignment.unknownRolesWarning")}),(0,T.jsx)("p",{children:r("roleAssignment.unknownRolesMessage",{ids:L.filter((e=>!q.some((t=>t.id===e)))).join(", ")})}),(0,T.jsx)("p",{className:"mt-2 text-sm",children:r("roleAssignment.availableRoleIds",{ids:q.map((e=>e.id)).join(", ")})})]}),(0,T.jsxs)("div",{className:"mb-4",children:[(0,T.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("roleAssignment.currentRoles")}),0===L.length?(0,T.jsx)("p",{className:"text-gray-500 dark:text-gray-400 italic",children:r("roleAssignment.noRolesAssigned")}):(0,T.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[q.filter((e=>L.includes(e.id))).map((e=>{const t=1===e.id&&A&&1===A.id;return(0,T.jsx)("div",{className:"border rounded-lg p-4 ".concat(t?"border-green-500 bg-green-50 dark:bg-green-900/20 dark:border-green-700 cursor-not-allowed":"border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 cursor-pointer"),onClick:()=>!t&&Ne(e.id),children:(0,T.jsxs)("div",{className:"flex justify-between items-center",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("h4",{className:"font-medium flex items-center dark:text-white",children:[e.name,t&&(0,T.jsx)("span",{className:"ml-2 text-xs bg-green-600 text-white px-2 py-0.5 rounded-full",children:r("roleAssignment.fixed")})]}),(0,T.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]}),(0,T.jsxs)("div",{className:"flex items-center ".concat(t?"text-gray-400 dark:text-gray-500":"text-blue-600 dark:text-blue-400"),children:[(0,T.jsx)("span",{className:"mr-2 text-sm",children:r(t?"roleAssignment.fixedAssigned":"roleAssignment.remove")}),(0,T.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,T.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})]})]})},e.id)})),L.filter((e=>!q.some((t=>t.id===e)))).map((e=>(0,T.jsx)("div",{className:"border border-orange-500 bg-orange-50 rounded-lg p-4",children:(0,T.jsxs)("div",{className:"flex justify-between items-center",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"font-medium",children:r("roleAssignment.unknownRole",{id:e})}),(0,T.jsx)("p",{className:"text-sm text-orange-600",children:r("roleAssignment.unknownRoleDescription")})]}),(0,T.jsxs)("div",{className:"flex items-center text-orange-600",children:[(0,T.jsx)("span",{className:"mr-2 text-sm",children:r("roleAssignment.remove")}),(0,T.jsx)("button",{onClick:()=>Ne(e),className:"focus:outline-none",children:(0,T.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,T.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})})]})]})},"unknown-".concat(e))))]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("roleAssignment.availableRoles")}),0===q.filter((e=>!L.includes(e.id))).length?(0,T.jsx)("p",{className:"text-gray-500 dark:text-gray-400 italic",children:r("roleAssignment.noRolesAvailable")}):(0,T.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:q.filter((e=>!L.includes(e.id))).map((e=>(0,T.jsx)("div",{className:"border border-gray-300 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50",onClick:()=>Ne(e.id),children:(0,T.jsxs)("div",{className:"flex justify-between items-center",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"font-medium",children:e.name}),(0,T.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),(0,T.jsxs)("div",{className:"flex items-center text-gray-500 hover:text-blue-600",children:[(0,T.jsx)("span",{className:"mr-2 text-sm",children:r("roleAssignment.add")}),(0,T.jsx)(x.A,{className:"h-5 w-5"})]})]})},e.id)))})]})]})}),"branches"===te&&(0,T.jsxs)("div",{className:"p-6",children:[X?(0,T.jsxs)("div",{className:"mt-4 mb-4",children:[(0,T.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:r("branchAssignment.title")||"Niederlassungszuweisung"}),(0,T.jsx)("p",{className:"dark:text-gray-300",children:r("branchAssignment.loading")||"Lade Niederlassungen..."})]}):Y.length>0&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:r("branchAssignment.title")||"Niederlassungszuweisung"}),Q.some((e=>!Y.some((t=>t.id===e))))&&(0,T.jsxs)("div",{className:"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4",children:[(0,T.jsx)("p",{className:"font-bold",children:r("branchAssignment.unknownBranchesWarning")||"Unbekannte Niederlassungen zugewiesen"}),(0,T.jsx)("p",{children:r("branchAssignment.unknownBranchesMessage",{ids:Q.filter((e=>!Y.some((t=>t.id===e)))).join(", ")})||"Die folgenden Niederlassungs-IDs sind zugewiesen, aber nicht verf\xfcgbar: ".concat(Q.filter((e=>!Y.some((t=>t.id===e)))).join(", "))}),(0,T.jsx)("p",{className:"mt-2 text-sm",children:r("branchAssignment.availableBranchIds",{ids:Y.map((e=>e.id)).join(", ")})||"Verf\xfcgbare Niederlassungs-IDs: ".concat(Y.map((e=>e.id)).join(", "))})]}),(0,T.jsxs)("div",{className:"mb-4",children:[(0,T.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("branchAssignment.currentBranches")||"Aktuell zugewiesene Niederlassungen"}),0===Q.length?(0,T.jsx)("p",{className:"text-gray-500 dark:text-gray-400 italic",children:r("branchAssignment.noBranchesAssigned")||"Keine Niederlassungen zugewiesen"}):(0,T.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Y.filter((e=>Q.includes(e.id))).map((e=>(0,T.jsx)("div",{className:"border border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 rounded-lg p-4 cursor-pointer",onClick:()=>Ae(e.id),children:(0,T.jsxs)("div",{className:"flex justify-between items-center",children:[(0,T.jsx)("div",{children:(0,T.jsx)("h4",{className:"font-medium dark:text-white",children:e.name})}),(0,T.jsxs)("div",{className:"flex items-center text-blue-600 dark:text-blue-400",children:[(0,T.jsx)("span",{className:"mr-2 text-sm",children:r("branchAssignment.remove")||"Entfernen"}),(0,T.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,T.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})]})]})},e.id))),Q.filter((e=>!Y.some((t=>t.id===e)))).map((e=>(0,T.jsx)("div",{className:"border border-orange-500 bg-orange-50 rounded-lg p-4",children:(0,T.jsxs)("div",{className:"flex justify-between items-center",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"font-medium",children:r("branchAssignment.unknownBranch",{id:e})||"Unbekannte Niederlassung (ID: ".concat(e,")")}),(0,T.jsx)("p",{className:"text-sm text-orange-600",children:r("branchAssignment.unknownBranchDescription")||"Diese Niederlassung existiert nicht mehr oder ist nicht verf\xfcgbar."})]}),(0,T.jsxs)("div",{className:"flex items-center text-orange-600",children:[(0,T.jsx)("span",{className:"mr-2 text-sm",children:r("branchAssignment.remove")||"Entfernen"}),(0,T.jsx)("button",{onClick:()=>Ae(e),className:"focus:outline-none",children:(0,T.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,T.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})})]})]})},"unknown-".concat(e))))]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("branchAssignment.availableBranches")||"Verf\xfcgbare Niederlassungen"}),0===Y.filter((e=>!Q.includes(e.id))).length?(0,T.jsx)("p",{className:"text-gray-500 dark:text-gray-400 italic",children:r("branchAssignment.noBranchesAvailable")||"Keine weiteren Niederlassungen verf\xfcgbar"}):(0,T.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Y.filter((e=>!Q.includes(e.id))).map((e=>(0,T.jsx)("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20",onClick:()=>Ae(e.id),children:(0,T.jsxs)("div",{className:"flex justify-between items-center",children:[(0,T.jsx)("div",{children:(0,T.jsx)("h4",{className:"font-medium dark:text-white",children:e.name})}),(0,T.jsxs)("div",{className:"flex items-center text-gray-500 hover:text-blue-600 dark:hover:text-blue-400",children:[(0,T.jsx)("span",{className:"mr-2 text-sm",children:r("branchAssignment.add")||"Hinzuf\xfcgen"}),(0,T.jsx)(x.A,{className:"h-5 w-5"})]})]})},e.id)))})]})]}),!X&&0===Y.length&&(0,T.jsxs)("div",{className:"mt-4 mb-4",children:[(0,T.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:r("branchAssignment.title")||"Niederlassungszuweisung"}),(0,T.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:r("branchAssignment.noBranchesFound")||"Keine Niederlassungen gefunden"})]})]}),"lifecycle"===te&&A&&(0,T.jsx)("div",{className:"p-6",children:(0,T.jsx)(W,{userId:A.id,userName:"".concat(A.firstName," ").concat(A.lastName)},"lifecycle-".concat(A.id,"-").concat(F))})]})}),le&&(0,T.jsx)(T.Fragment,{children:ie?(0,T.jsxs)(u.lG,{open:le,onClose:()=>ne(!1),className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,T.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700",children:(0,T.jsxs)("div",{className:"flex items-center justify-between",children:[(0,T.jsx)(u.lG.Title,{className:"text-lg font-semibold dark:text-white",children:r("organisation.createUser.title")}),(0,T.jsx)("button",{onClick:()=>ne(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]})}),(0,T.jsxs)("form",{onSubmit:Ce,className:"p-6",children:[(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.email")," *"]}),(0,T.jsx)("input",{type:"email",name:"email",value:be.email,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.password")," *"]}),(0,T.jsx)("input",{type:"password",name:"password",value:be.password,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.firstName")," *"]}),(0,T.jsx)("input",{type:"text",name:"firstName",value:be.firstName,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.lastName")," *"]}),(0,T.jsx)("input",{type:"text",name:"lastName",value:be.lastName,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]})]}),(0,T.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>ne(!1),className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.cancel")})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800",children:(0,T.jsx)(f.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("organisation.createUser.create")})]})]})]})]})})]}):(0,T.jsxs)(T.Fragment,{children:[le&&!de&&(0,T.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",style:{opacity:le?1:0,transition:"opacity 300ms ease-out"}}),(0,T.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(le?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:le?"auto":"none"},"aria-hidden":!le,role:"dialog","aria-modal":le,children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,T.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:r("organisation.createUser.title")}),(0,T.jsx)("button",{onClick:()=>ne(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsx)("div",{className:"flex flex-col flex-1 min-h-0",children:(0,T.jsxs)("form",{onSubmit:Ce,className:"flex flex-col flex-1 min-h-0",children:[(0,T.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0 space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.email")," *"]}),(0,T.jsx)("input",{type:"email",name:"email",value:be.email,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.password")," *"]}),(0,T.jsx)("input",{type:"password",name:"password",value:be.password,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.firstName")," *"]}),(0,T.jsx)("input",{type:"text",name:"firstName",value:be.firstName,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.lastName")," *"]}),(0,T.jsx)("input",{type:"text",name:"lastName",value:be.lastName,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]})]}),(0,T.jsxs)("div",{className:"flex justify-end gap-3 border-t dark:border-gray-700 pt-4 px-4 flex-shrink-0",children:[(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>ne(!1),className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.cancel")})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800",children:(0,T.jsx)(f.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("organisation.createUser.create")})]})]})]})})]})]})})]})};var J=r(3744),Y=r(9248),Z=r(2517),X=r(8010),$=r(4426),Q=r(7829),ee=r(6507),te=r(5365);const re=["dashboard","worktracker","cerebro","settings","profile"],ae=["dashboard","worktracker","consultations","team_worktime_control","payroll","organization_management","cerebro","settings","profile","tour_management","password_manager"],se=["requests","tasks","reservations","users","roles","organization","organization_join_requests","organization_users","team_worktime","worktime","clients","consultation_invoices","branches","notifications","settings","monthly_reports","tours","tour_bookings"],le=["database_reset_table","database_logs","invoice_create","invoice_download","invoice_mark_paid","invoice_settings","todo_create","todo_edit","todo_delete","task_create","task_edit","task_delete","user_create","user_edit","user_delete","role_assign","role_create","role_edit","role_delete","organization_create","organization_edit","organization_delete","worktime_start","worktime_stop","worktime_edit","worktime_delete","cerebro","consultation_start","consultation_stop","consultation_edit","client_create","client_edit","client_delete","settings_system","settings_notifications","settings_profile","payroll_generate","payroll_export","payroll_edit","tour_create","tour_edit","tour_delete","tour_view","tour_booking_create","tour_booking_edit","tour_booking_cancel","tour_provider_create","tour_provider_edit","tour_provider_delete","password_entry_create","password_entry_edit","password_entry_delete"],ne={requests:"dashboard",tasks:"worktracker",reservations:"worktracker",users:"organization_management",roles:"organization_management",organization:"organization_management",organization_join_requests:"organization_management",organization_users:"organization_management",team_worktime:"team_worktime_control",worktime:"worktracker",clients:"consultations",consultation_invoices:"consultations",branches:"settings",notifications:"general",settings:"settings",monthly_reports:"consultations",tours:"tour_management",tour_bookings:"tour_management"},ie={database_reset_table:"settings",database_logs:"settings",invoice_create:"consultations",invoice_download:"consultations",invoice_mark_paid:"consultations",invoice_settings:"consultations",todo_create:"worktracker",todo_edit:"worktracker",todo_delete:"worktracker",task_create:"worktracker",task_edit:"worktracker",task_delete:"worktracker",user_create:"organization_management",user_edit:"organization_management",user_delete:"organization_management",role_assign:"organization_management",role_create:"organization_management",role_edit:"organization_management",role_delete:"organization_management",organization_create:"organization_management",organization_edit:"organization_management",organization_delete:"organization_management",worktime_start:"worktracker",worktime_stop:"worktracker",worktime_edit:"worktracker",worktime_delete:"worktracker",cerebro:"cerebro",consultation_start:"consultations",consultation_stop:"consultations",consultation_edit:"consultations",client_create:"consultations",client_edit:"consultations",client_delete:"consultations",settings_system:"settings",settings_notifications:"settings",settings_profile:"settings",payroll_generate:"payroll",payroll_export:"payroll",payroll_edit:"payroll",tour_create:"tour_management",tour_edit:"tour_management",tour_delete:"tour_management",tour_view:"tour_management",tour_booking_create:"tour_management",tour_booking_edit:"tour_management",tour_booking_cancel:"tour_management",tour_provider_create:"tour_management",tour_provider_edit:"tour_management",tour_provider_delete:"tour_management",password_entry_create:"password_manager",password_entry_edit:"password_manager",password_entry_delete:"password_manager"},oe={worktime_start:"worktime",worktime_stop:"worktime",worktime_edit:"worktime",worktime_delete:"worktime",task_create:"tasks",task_edit:"tasks",task_delete:"tasks",todo_create:"tasks",todo_edit:"tasks",todo_delete:"tasks",client_create:"clients",client_edit:"clients",client_delete:"clients",consultation_start:"clients",consultation_stop:"clients",consultation_edit:"clients",invoice_create:"consultation_invoices",invoice_download:"consultation_invoices",invoice_mark_paid:"consultation_invoices",invoice_settings:"consultation_invoices",user_create:"users",user_edit:"users",user_delete:"users",role_assign:"roles",role_create:"roles",role_edit:"roles",role_delete:"roles",organization_create:"organization",organization_edit:"organization",organization_delete:"organization",settings_system:"settings",settings_notifications:"settings",settings_profile:"settings",tour_create:"tours",tour_edit:"tours",tour_delete:"tours",tour_view:"tours",tour_booking_create:"tour_bookings",tour_booking_edit:"tour_bookings",tour_booking_cancel:"tour_bookings",tour_provider_create:null,tour_provider_edit:null,tour_provider_delete:null,password_entry_create:null,password_entry_edit:null,password_entry_delete:null,database_reset_table:null,database_logs:null,cerebro:null,payroll_generate:null,payroll_export:null,payroll_edit:null},de="roles-table",ce=[1,2,999],me=["Admin","User","Hamburger"],ue=(e,t)=>!!ce.includes(e)||!(!t||!me.includes(t)),ge=e=>{let{role:t,onEdit:r,onDelete:a,onCopy:l,canEdit:n,canDelete:i,canCopy:o}=e;const{t:d}=(0,s.Bd)();return(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4 mb-4",children:[(0,T.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t.name}),(0,T.jsxs)("div",{className:"flex space-x-2",children:[o&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>l(t),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1",children:(0,T.jsx)(J.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:d("roles.actions.copy")})]}),n&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>r(t),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1",children:(0,T.jsx)(C.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:d("roles.actions.edit")})]}),i&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>a(t.id),className:"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1",children:(0,T.jsx)(Y.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:d("roles.actions.delete")})]})]})]}),(0,T.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.description||d("roles.noDescription")}),(0,T.jsx)("div",{className:"mt-2",children:(0,T.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.allBranches?(0,T.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300",children:d("roles.form.allBranches")||"Alle Branches"}):t.branches&&t.branches.length>0?(0,T.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300",children:[t.branches.length," ",d("roles.form.specificBranches")||"Branches"]}):(0,T.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400",children:d("roles.form.noBranches")||"Keine Branches"})})}),(0,T.jsxs)("div",{className:"mt-2",children:[(0,T.jsxs)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:[d("roles.permissions"),":"]}),(0,T.jsxs)("div",{className:"flex flex-wrap gap-1",children:[t.permissions.filter((e=>"none"!==e.accessLevel)).slice(0,8).map((e=>(0,T.jsxs)("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 px-2 py-1 rounded",children:[e.entity,": ",e.accessLevel]},"".concat(e.entity,"-").concat(e.entityType)))),t.permissions.filter((e=>"none"!==e.accessLevel)).length>8&&(0,T.jsxs)("span",{className:"text-xs bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-300 px-2 py-1 rounded",children:["+",t.permissions.filter((e=>"none"!==e.accessLevel)).length-8," ",d("common.showMore")]})]})]})]})},xe=e=>{let{onRolesChange:t,onError:r,readOnly:n=!1}=e;const{t:i}=(0,s.Bd)(),[o,d]=(0,a.useState)(!1),[c,b]=(0,a.useState)(null),[h,p]=(0,a.useState)([]),[v,k]=(0,a.useState)(!0),j=(0,a.useMemo)((()=>({dashboard:i("roles.pages.dashboard"),worktracker:i("roles.pages.worktracker"),consultations:i("roles.pages.consultations"),team_worktime_control:i("roles.pages.team_worktime_control"),payroll:i("roles.pages.payroll"),organization_management:i("roles.pages.organization_management"),cerebro:i("roles.pages.cerebro"),settings:i("roles.pages.settings"),profile:i("roles.pages.profile"),tour_management:i("roles.pages.tour_management","Touren-Verwaltung"),password_manager:i("roles.pages.password_manager","Passwort-Manager")})),[i]),A=(0,a.useMemo)((()=>({tasks:i("roles.tables.tasks"),reservations:i("roles.tables.reservations"),worktime:i("roles.tables.worktime"),users:i("roles.tables.users"),roles:i("roles.tables.roles"),organization:i("roles.tables.organization"),organization_join_requests:i("roles.tables.organization_join_requests"),organization_users:i("roles.tables.organization_users"),clients:i("roles.tables.clients"),consultation_invoices:i("roles.tables.consultation_invoices"),requests:i("roles.tables.requests"),team_worktime:i("roles.tables.team_worktime"),settings:i("roles.tables.settings"),notifications:i("roles.tables.notifications"),branches:i("roles.tables.branches"),monthly_reports:i("roles.tables.monthly_reports"),tours:i("roles.tables.tours","Touren"),tour_bookings:i("roles.tables.tour_bookings","Tour-Buchungen")})),[i]),S=(0,a.useMemo)((()=>({worktime_start:i("roles.buttons.worktime_start"),worktime_stop:i("roles.buttons.worktime_stop"),worktime_edit:i("roles.buttons.worktime_edit"),worktime_delete:i("roles.buttons.worktime_delete"),task_create:i("roles.buttons.task_create"),task_edit:i("roles.buttons.task_edit"),task_delete:i("roles.buttons.task_delete"),todo_create:i("roles.buttons.todo_create"),todo_edit:i("roles.buttons.todo_edit"),todo_delete:i("roles.buttons.todo_delete"),client_create:i("roles.buttons.client_create"),client_edit:i("roles.buttons.client_edit"),client_delete:i("roles.buttons.client_delete"),consultation_start:i("roles.buttons.consultation_start"),consultation_stop:i("roles.buttons.consultation_stop"),consultation_edit:i("roles.buttons.consultation_edit"),invoice_create:i("roles.buttons.invoice_create"),invoice_download:i("roles.buttons.invoice_download"),invoice_mark_paid:i("roles.buttons.invoice_mark_paid"),invoice_settings:i("roles.buttons.invoice_settings"),user_create:i("roles.buttons.user_create"),user_edit:i("roles.buttons.user_edit"),user_delete:i("roles.buttons.user_delete"),role_assign:i("roles.buttons.role_assign"),role_create:i("roles.buttons.role_create"),role_edit:i("roles.buttons.role_edit"),role_delete:i("roles.buttons.role_delete"),organization_create:i("roles.buttons.organization_create"),organization_edit:i("roles.buttons.organization_edit"),organization_delete:i("roles.buttons.organization_delete"),settings_system:i("roles.buttons.settings_system"),settings_notifications:i("roles.buttons.settings_notifications"),settings_profile:i("roles.buttons.settings_profile"),database_reset_table:i("roles.buttons.database_reset_table"),database_logs:i("roles.buttons.database_logs"),payroll_generate:i("roles.buttons.payroll_generate"),payroll_export:i("roles.buttons.payroll_export"),payroll_edit:i("roles.buttons.payroll_edit"),cerebro:i("roles.buttons.cerebro")})),[i]),[C,P]=(0,a.useState)({name:"",description:"",permissions:[...ae.map((e=>({entity:e,entityType:"page",accessLevel:"none"}))),...se.map((e=>({entity:e,entityType:"table",accessLevel:"none"}))),...le.map((e=>({entity:e,entityType:"button",accessLevel:"none"})))]}),[E,z]=(0,a.useState)(null),{hasPermission:L}=(0,l.S)(),[D,F]=(0,a.useState)(""),[I,_]=(0,a.useState)(!1),[B,O]=(0,a.useState)(!0),[V,U]=(0,a.useState)([]),[M,q]=(0,a.useState)([]),[G,W]=(0,a.useState)(!1),[K,H]=(0,a.useState)([]),[J,Y]=(0,a.useState)([]),[ce,me]=(0,a.useState)("Alle"),[xe,be]=(0,a.useState)(null),[he,pe]=(0,a.useState)(window.innerWidth<640),[ye,fe]=(0,a.useState)(window.innerWidth>1070),{openSidepane:ve,closeSidepane:ke}=(0,R.N)(),{handleError:je,handleValidationError:we}=(0,ee.qz)(),[Ne,Ae]=(0,a.useState)(!1),[Se,Ce]=(0,a.useState)(null),[Pe,Ee]=(0,a.useState)(10);(0,a.useEffect)((()=>{const e=()=>{pe(window.innerWidth<640),fe(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(o?ve():ke(),()=>{ke()})),[o,ve,ke]);const ze=(0,a.useCallback)((async()=>{W(!0);try{const e=await g.H_.getAll();q(e.data)}catch(E){console.error("Fehler beim Laden der Branches:",E)}finally{W(!1)}}),[]),Le=(0,a.useCallback)((async()=>{k(!0),console.log("DEBUGAUSGABE: Hole Rollen vom Server...");try{const e=await g.Zj.getAll();console.log("DEBUGAUSGABE: Rollen erfolgreich geholt:",e.data),p(e.data),z(null)}catch(E){console.error("DEBUGAUSGABE: Fehler beim Abrufen der Rollen:",E),je(E,{component:"RoleManagementTab",action:"fetchRoles"}),r&&r("Fehler beim Laden der Rollen")}finally{k(!1)}}),[je,r]);(0,a.useEffect)((()=>{Le()}),[Le]),(0,a.useEffect)((()=>{o&&ze()}),[o,ze]);const De=async e=>{if(e.preventDefault(),z(null),B||0!==V.length)if(C.name){if(c){const e=C.permissions.map((e=>"page"===e.entityType&&re.includes(e.entity)?(0,m.A)((0,m.A)({},e),{},{accessLevel:"both"}):e)).filter((e=>"none"!==e.accessLevel)).map((e=>({entity:e.entity,entityType:e.entityType,accessLevel:e.accessLevel})));if(!c.id||isNaN(c.id))return console.warn("DEBUGAUSGABE: Ung\xfcltige Rollen-ID erkannt, Bearbeitung abgebrochen"),void je("Ung\xfcltige Rollen-ID, Bearbeitung abgebrochen",{component:"RoleManagementTab",roleId:c.id});if(ue(c.id,c.name))return console.warn("DEBUGAUSGABE: Versuch, gesch\xfctzte Rolle mit ID ".concat(c.id," zu bearbeiten")),je({message:"Gesch\xfctzte Systemrollen k\xf6nnen nicht bearbeitet werden",name:"PermissionError"},{component:"RoleManagementTab",roleId:c.id,category:te.h.PERMISSION}),void d(!1);if(!h.some((e=>e.id===c.id)))return console.error("DEBUGAUSGABE: Rolle mit ID ".concat(c.id," existiert nicht in der aktuellen Liste")),je("Rolle mit ID ".concat(c.id," existiert nicht mehr. Bitte aktualisieren Sie die Seite."),{component:"RoleManagementTab",roleId:c.id}),d(!1),void await Le();console.log("DEBUGAUSGABE: Bearbeite Rolle mit ID ".concat(c.id));try{console.log("DEBUGAUSGABE: Sende Aktualisierung an API:",{name:C.name,description:C.description,permissions:e});const t={name:C.name,description:C.description,permissions:e,allBranches:B,branchIds:B?[]:V};console.log("DEBUGAUSGABE: Vor dem API-Aufruf roleApi.update");const r=await g.Zj.update(c.id,t);console.log("DEBUGAUSGABE: Nach dem API-Aufruf roleApi.update"),console.log("DEBUGAUSGABE: API-Antwort bei Rollenaktualisierung:",r),await Le()}catch(r){return console.error("DEBUGAUSGABE: Fehler bei Rollenaktualisierung:",r),void(r.response?r.response.data.meta&&"Record to update not found."===r.response.data.meta.cause?(je("Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.",{component:"RoleManagementTab",roleId:c.id}),d(!1),await Le()):je(r.response.data.message||"Fehler beim Aktualisieren der Rolle",{component:"RoleManagementTab",roleId:c.id}):je("Fehler beim Aktualisieren der Rolle",{component:"RoleManagementTab",roleId:c.id}))}}else try{const e=C.permissions.map((e=>"page"===e.entityType&&re.includes(e.entity)?(0,m.A)((0,m.A)({},e),{},{accessLevel:"both"}):e)).filter((e=>"none"!==e.accessLevel)).map((e=>({entity:e.entity,entityType:e.entityType,accessLevel:e.accessLevel})));console.log("DEBUGAUSGABE: Sende Daten an API f\xfcr neue Rolle:",{name:C.name,description:C.description,permissions:e});const t={name:C.name,description:C.description,permissions:e,allBranches:B,branchIds:B?[]:V};console.log("DEBUGAUSGABE: Vor dem API-Aufruf roleApi.create");const r=await g.Zj.create(t);console.log("DEBUGAUSGABE: Nach dem API-Aufruf roleApi.create"),console.log("DEBUGAUSGABE: API-Antwort beim Erstellen der Rolle:",r),await Le()}catch(a){return console.error("DEBUGAUSGABE: Fehler bei API-Anfrage zum Erstellen der Rolle:",a),void(a.response?je(a.response.data.message||"Fehler beim Erstellen der Rolle",{component:"RoleManagementTab"}):je("Fehler beim Erstellen der Rolle",{component:"RoleManagementTab"}))}t&&t(),d(!1),Ie()}else we("Rollenname darf nicht leer sein",{name:"Rollenname ist erforderlich"});else je(i("roles.form.branchSelectionRequired")||'Bitte w\xe4hlen Sie mindestens eine Branch aus oder aktivieren Sie "F\xfcr alle Branches g\xfcltig"',{component:"RoleManagementTab"})},Re=async e=>{if(!e||isNaN(e))return console.warn("Ung\xfcltige Rollen-ID erkannt, L\xf6schvorgang abgebrochen"),void je("Ung\xfcltige Rollen-ID, L\xf6schvorgang abgebrochen",{component:"RoleManagementTab",roleId:e});const r=h.find((t=>t.id===e));if(r&&ue(e,r.name))return console.warn("Versuch, gesch\xfctzte Rolle mit ID ".concat(e," (").concat(r.name,") zu l\xf6schen")),void je("Gesch\xfctzte Systemrollen k\xf6nnen nicht gel\xf6scht werden",{component:"RoleManagementTab",roleId:e});if(window.confirm("M\xf6chten Sie diese Rolle wirklich l\xf6schen?"))try{console.log("Starte L\xf6schvorgang f\xfcr Rolle mit ID ".concat(e));if(!h.some((t=>t.id===e)))return console.error("Rolle mit ID ".concat(e," existiert nicht in der aktuellen Liste")),je("Rolle mit ID ".concat(e," existiert nicht mehr. Bitte aktualisieren Sie die Seite."),{component:"RoleManagementTab",roleId:e}),void await Le();console.log("Sende L\xf6schanfrage an API");try{const t=await g.Zj.delete(e);console.log("API-Antwort beim L\xf6schen der Rolle:",t),await Le(),console.log("Rollenliste nach L\xf6schen aktualisiert")}catch(a){return console.error("API-Fehler beim L\xf6schen der Rolle:",a),void(a.response?(console.error("API-Fehlerdaten:",a.response.data),a.response.data.meta&&"Record to delete does not exist."===a.response.data.meta.cause?(je("Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.",{component:"RoleManagementTab",roleId:e}),await Le()):je(a.response.data.message||i("roleManagement.deleteError"),{component:"RoleManagementTab",roleId:e})):je(i("roleManagement.networkError"),{component:"RoleManagementTab",roleId:e}))}console.log("Rolle erfolgreich gel\xf6scht"),t&&t()}catch(s){console.error(i("roleManagement.unhandledError"),s),je(s);try{await Le()}catch(l){console.error("Fehler beim Aktualisieren der Rollenliste nach fehlgeschlagenem L\xf6schvorgang:",l)}}},Te=async e=>{try{if(!e||!e.id)return void je("Ung\xfcltige Rolle zum Kopieren",{component:"RoleManagementTab"});const r={name:"".concat(e.name,"-Kopie"),description:e.description||"",permissions:e.permissions.filter((e=>"none"!==e.accessLevel)).map((e=>({entity:e.entity,entityType:e.entityType,accessLevel:e.accessLevel})))};console.log("DEBUGAUSGABE: Kopiere Rolle:",e.name,"mit Daten:",r);const a=await g.Zj.create(r);console.log("DEBUGAUSGABE: Rolle erfolgreich kopiert:",a.data),p((e=>[a.data,...e])),Fe(a.data),t&&t()}catch(r){console.error("DEBUGAUSGABE: Fehler beim Kopieren der Rolle:",r),je(r,{component:"RoleManagementTab",roleId:e.id})}},Fe=async e=>{if(ue(e.id,e.name))return void je("Gesch\xfctzte Systemrollen k\xf6nnen nicht bearbeitet werden",{component:"RoleManagementTab",roleId:e.id});const t=[...ae.map((e=>({entity:e,entityType:"page",accessLevel:re.includes(e)?"both":"none"}))),...se.map((e=>({entity:e,entityType:"table",accessLevel:"none"}))),...le.map((e=>({entity:e,entityType:"button",accessLevel:"none"})))];if(e.permissions.forEach((e=>{const r=t.findIndex((t=>t.entity===e.entity&&t.entityType===e.entityType));-1!==r&&("page"===e.entityType&&re.includes(e.entity)?t[r].accessLevel="both":t[r].accessLevel=e.accessLevel)})),P({name:e.name,description:e.description||"",permissions:t}),e.id)try{var r;const t=(await g.Zj.getRoleBranches(e.id)).data;O(t.allBranches||!1),U((null===(r=t.branches)||void 0===r?void 0:r.map((e=>e.id)))||[])}catch(E){console.error("Fehler beim Laden der Branch-Zuweisungen:",E),O(!0),U([])}b(e),d(!0)},Ie=()=>{b(null),O(!0),U([]),P({name:"",description:"",permissions:[...ae.map((e=>({entity:e,entityType:"page",accessLevel:re.includes(e)?"both":"none"}))),...se.map((e=>({entity:e,entityType:"table",accessLevel:"none"}))),...le.map((e=>({entity:e,entityType:"button",accessLevel:"none"})))]})},_e=e=>{const t=[...C.permissions];C.permissions.filter((e=>"page"===e.entityType&&!re.includes(e.entity))).forEach((r=>{const a=C.permissions.indexOf(r);t[a]=(0,m.A)((0,m.A)({},r),{},{accessLevel:e})})),P((0,m.A)((0,m.A)({},C),{},{permissions:t}))},Be=e=>{const t=[...C.permissions];C.permissions.filter((e=>"table"===e.entityType)).forEach((r=>{const a=C.permissions.indexOf(r);t[a]=(0,m.A)((0,m.A)({},r),{},{accessLevel:e})})),P((0,m.A)((0,m.A)({},C),{},{permissions:t}))},Oe=e=>{const t=[...C.permissions];C.permissions.filter((e=>"button"===e.entityType)).forEach((r=>{const a=C.permissions.indexOf(r);t[a]=(0,m.A)((0,m.A)({},r),{},{accessLevel:e})})),P((0,m.A)((0,m.A)({},C),{},{permissions:t}))},Ve=()=>K.length,Ue=(0,a.useMemo)((()=>h.filter((e=>{if(D){const t=D.toLowerCase();if(!(e.name.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)))return!1}if(K.length>0){let t=K.length>0;for(let r=0;r<K.length;r++){const a=K[r];let s=!1;switch(a.column){case"name":"equals"===a.operator?s=e.name.toLowerCase()===(a.value||"").toLowerCase():"contains"===a.operator?s=e.name.toLowerCase().includes((a.value||"").toLowerCase()):"startsWith"===a.operator&&(s=e.name.toLowerCase().startsWith((a.value||"").toLowerCase()));break;case"description":if(!e.description){s=!1;break}"equals"===a.operator?s=e.description.toLowerCase()===(a.value||"").toLowerCase():"contains"===a.operator?s=e.description.toLowerCase().includes((a.value||"").toLowerCase()):"startsWith"===a.operator&&(s=e.description.toLowerCase().startsWith((a.value||"").toLowerCase()));break;case"permissions":const t=a.value,r=e.permissions.filter((e=>e.accessLevel===t)).length;("greaterThan"===a.operator||"equals"===a.operator)&&(s=r>0)}if(0===r)t=s;else{t="AND"===J[r-1]?t&&s:t||s}}if(!t)return!1}return!0})).sort(((e,t)=>e.name.localeCompare(t.name)))),[h,D,K,J]);(0,a.useEffect)((()=>{(async()=>{try{if(!localStorage.getItem("token"))return void console.error("Nicht authentifiziert");const e=(await w.A.get(N.Sn.SAVED_FILTERS.BY_TABLE(de))).data||[];if(!e.some((e=>"Alle"===e.name))){const e={tableId:de,name:"Alle",conditions:[],operators:[]};await w.A.post(N.Sn.SAVED_FILTERS.BASE,e),console.log("Alle-Filter f\xfcr Rollen erstellt")}}catch(E){console.error("Fehler beim Erstellen der Standard-Filter:",E)}})()}),[]),(0,a.useEffect)((()=>{(async()=>{try{const e=await w.A.get(N.Sn.SAVED_FILTERS.BY_TABLE(de)),t=e.data.find((e=>"Alle"===e.name));t&&(me("Alle"),be(t.id),Me(t.conditions,t.operators))}catch(E){console.error("Fehler beim Setzen des initialen Filters:",E)}})()}),[]);const Me=(e,t)=>{H(e),Y(t)},qe=()=>{H([]),Y([]),me(""),be(null)};return(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,T.jsx)("div",{className:"flex items-center",children:!n&&L("roles","write","table")&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>d(!0),className:"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":i("roles.createRole"),children:(0,T.jsx)(x.A,{className:"h-4 w-4"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.createRole")})]})}),(0,T.jsx)("div",{}),(0,T.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,T.jsx)("input",{type:"text",placeholder:"Suchen...",className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:D,onChange:e=>F(e.target.value)}),(0,T.jsxs)("div",{className:"relative group ml-1",children:[(0,T.jsxs)("button",{className:"p-2 rounded-md ".concat(Ve()>0?"bg-blue-50 text-blue-600":"hover:bg-gray-100"),onClick:()=>_(!I),children:[(0,T.jsx)(X.A,{className:"w-5 h-5"}),Ve()>0&&(0,T.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center",children:Ve()})]}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Filter"})]})]})]}),I&&(0,T.jsx)($.A,{columns:[{id:"name",label:"Name"},{id:"description",label:"Beschreibung"},{id:"permissions",label:"Berechtigungen"}],onApply:Me,onReset:qe,savedConditions:K,savedOperators:J,tableId:de}),(0,T.jsx)(Q.A,{tableId:de,onSelectFilter:Me,onReset:qe,activeFilterName:ce,selectedFilterId:xe,onFilterChange:(e,t,r,a)=>{me(e),be(t),Me(r,a)},defaultFilterName:"Alle"}),v?(0,T.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,T.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):0===h.length?(0,T.jsx)("div",{className:"p-4 bg-gray-50 rounded text-center",children:(0,T.jsx)("p",{children:"Keine Rollen gefunden. Erstellen Sie eine neue Rolle mit dem Button oben."})}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{className:"space-y-4",children:Ue.slice(0,Pe).map((e=>(0,T.jsx)(ge,{role:e,onEdit:Fe,onDelete:Re,onCopy:Te,canEdit:!n&&L("roles","write","table")&&!ue(e.id,e.name),canDelete:!n&&L("roles","write","table")&&!ue(e.id,e.name),canCopy:!n&&L("roles","write","table")&&ue(e.id,e.name)},e.id)))}),Ue.length>Pe&&(0,T.jsx)("div",{className:"mt-4 flex justify-center",children:(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{className:"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700",onClick:()=>Ee((e=>e+10)),children:(0,T.jsx)(Z.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Mehr anzeigen (".concat(Ue.length-Pe," verbleibend)")})]})})]})]}),o&&(0,T.jsx)(T.Fragment,{children:he?(0,T.jsxs)(u.lG,{open:o,onClose:()=>d(!1),className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden",children:[(0,T.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0",children:(0,T.jsxs)("div",{className:"flex items-center justify-between",children:[(0,T.jsx)(u.lG.Title,{className:"text-lg font-semibold dark:text-white",children:i(c?"roles.editRole":"roles.createRole")}),(0,T.jsx)("button",{onClick:()=>d(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]})}),(0,T.jsxs)("form",{onSubmit:De,className:"flex flex-col flex-1 min-h-0",children:[(0,T.jsx)("div",{className:"flex-1 overflow-y-auto min-h-0",children:(0,T.jsxs)("div",{className:"p-6 space-y-5",children:[(0,T.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Name"}),(0,T.jsx)("input",{type:"text",value:C.name,onChange:e=>P((0,m.A)((0,m.A)({},C),{},{name:e.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Beschreibung"}),(0,T.jsx)("input",{type:"text",value:C.description,onChange:e=>P((0,m.A)((0,m.A)({},C),{},{description:e.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white"})]})]}),(0,T.jsxs)("div",{className:"mt-4",children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("roles.form.branchAssignment")||"Branch-Zuweisung"}),(0,T.jsxs)("div",{className:"space-y-3",children:[(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"checkbox",checked:B,onChange:e=>{O(e.target.checked),e.target.checked&&U([])},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,T.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:i("roles.form.allBranches")||"F\xfcr alle Branches g\xfcltig"})]}),!B&&(0,T.jsxs)("div",{className:"ml-6",children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("roles.form.specificBranches")||"Spezifische Branches:"}),G?(0,T.jsx)("div",{className:"text-sm text-gray-500",children:"Lade Branches..."}):0===M.length?(0,T.jsx)("div",{className:"text-sm text-gray-500",children:"Keine Branches verf\xfcgbar"}):(0,T.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2",children:M.map((e=>(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"checkbox",checked:V.includes(e.id),onChange:t=>{t.target.checked?U([...V,e.id]):U(V.filter((t=>t!==e.id)))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,T.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:e.name})]},e.id)))})]})]})]}),(0,T.jsxs)("div",{className:"mt-2",children:[(0,T.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2",children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("roles.form.detailedPermissions")}),(0,T.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>_e("both"),className:"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800",children:i("roles.form.pagesChecked")}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.form.activateAllPages")})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>_e("none"),className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600",children:i("roles.form.pagesUnchecked")}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.form.deactivateAllPages")})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>Be("both"),className:"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800",children:i("roles.form.tablesChecked")}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.form.activateAllTables")})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>Be("none"),className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600",children:i("roles.form.tablesUnchecked")}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.form.deactivateAllTables")})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>Oe("both"),className:"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800",children:i("roles.form.buttonsChecked")}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.form.activateAllButtons")})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>Oe("none"),className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600",children:i("roles.form.buttonsUnchecked")}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.form.deactivateAllButtons")})]})]})]}),(0,T.jsx)("div",{className:"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600",children:C.permissions.filter((e=>"page"===e.entityType)).map(((e,t)=>{const r=C.permissions.indexOf(e),a="both"===e.accessLevel;return(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{className:"flex items-center justify-between",children:[(0,T.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:j[e.entity]||e.entity}),(0,T.jsxs)("label",{className:"inline-flex items-center ".concat(re.includes(e.entity)?"cursor-not-allowed opacity-80":"cursor-pointer"),children:[(0,T.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:a,disabled:re.includes(e.entity),onChange:()=>{const t=[...C.permissions];t[r]=(0,m.A)((0,m.A)({},e),{},{accessLevel:a?"none":"both"}),P((0,m.A)((0,m.A)({},C),{},{permissions:t}))}}),(0,T.jsx)("div",{className:"relative w-11 h-6 ".concat(re.includes(e.entity)?"bg-blue-600 dark:bg-blue-700":"bg-gray-200 dark:bg-gray-700"," peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"),children:re.includes(e.entity)&&(0,T.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-xs text-white font-medium",children:"Fix"})})]})]}),C.permissions.filter((t=>"table"===t.entityType&&ne[t.entity]===e.entity)).sort(((e,t)=>{const r=A[e.entity]||e.entity,a=A[t.entity]||t.entity,s=["users","roles","organization"],l=s.indexOf(e.entity),n=s.indexOf(t.entity);return-1!==l&&-1!==n?l-n:-1!==l?-1:-1!==n?1:r.localeCompare(a)})).map(((t,r)=>{const a=C.permissions.indexOf(t),s="both"===t.accessLevel,l=t.entity,n=A[l]||l,o=C.permissions.filter((t=>"button"===t.entityType&&ie[t.entity]===e.entity&&oe[t.entity]===l&&!("tasks"===l&&t.entity.startsWith("todo_")))).sort(((e,t)=>{const r=S[e.entity]||e.entity,a=S[t.entity]||t.entity,s=[i("roleManagement.buttonOrder.start"),i("roleManagement.buttonOrder.stop"),i("roleManagement.buttonOrder.create"),i("roleManagement.buttonOrder.edit"),i("roleManagement.buttonOrder.delete")],l=s.indexOf(r),n=s.indexOf(a);return-1!==l&&-1!==n?l-n:-1!==l?-1:-1!==n?1:r.localeCompare(a)}));return(0,T.jsxs)("div",{className:"mt-3",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600",children:[(0,T.jsxs)("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:["\u2514 ",n]}),(0,T.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,T.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:s,onChange:()=>{const e=[...C.permissions];e[a]=(0,m.A)((0,m.A)({},t),{},{accessLevel:s?"none":"both"}),P((0,m.A)((0,m.A)({},C),{},{permissions:e}))}}),(0,T.jsx)("div",{className:"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"})]})]}),o.map(((e,t)=>{const r=C.permissions.indexOf(e),a="both"===e.accessLevel,s=S[e.entity]||e.entity;return(0,T.jsxs)("div",{className:"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600",children:[(0,T.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["\u2514 ",s]}),(0,T.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,T.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:a,onChange:()=>{const t=[...C.permissions];t[r]=(0,m.A)((0,m.A)({},e),{},{accessLevel:a?"none":"both"}),P((0,m.A)((0,m.A)({},C),{},{permissions:t}))}}),(0,T.jsx)("div",{className:"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"})]})]},"button-permission-".concat(e.entity,"-").concat(t))}))]},"table-permission-".concat(l,"-").concat(r))})),C.permissions.filter((t=>"button"===t.entityType&&ie[t.entity]===e.entity&&!oe[t.entity])).sort(((e,t)=>{const r=S[e.entity]||e.entity,a=S[t.entity]||t.entity;return r.localeCompare(a)})).map(((e,t)=>{const r=C.permissions.indexOf(e),a="both"===e.accessLevel,s=S[e.entity]||e.entity;return(0,T.jsxs)("div",{className:"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600",children:[(0,T.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["\u2514 ",s]}),(0,T.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,T.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:a,onChange:()=>{const t=[...C.permissions];t[r]=(0,m.A)((0,m.A)({},e),{},{accessLevel:a?"none":"both"}),P((0,m.A)((0,m.A)({},C),{},{permissions:t}))}}),(0,T.jsx)("div",{className:"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"})]})]},"button-permission-".concat(e.entity,"-").concat(t))}))]},"permission-page-".concat(e.entity,"-").concat(t))}))})]})]})}),(0,T.jsxs)("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-end gap-2 border-t dark:border-gray-600 flex-shrink-0",children:[(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>d(!1),className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Abbrechen"})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800",children:(0,T.jsx)(f.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:c?"Aktualisieren":"Erstellen"})]})]})]})]})})]}):(0,T.jsxs)(T.Fragment,{children:[o&&!ye&&(0,T.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",style:{opacity:o?1:0,transition:"opacity 300ms ease-out"}}),(0,T.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(o?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:o?"auto":"none"},"aria-hidden":!o,role:"dialog","aria-modal":o,children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,T.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:c?"Rolle bearbeiten":"Neue Rolle erstellen"}),(0,T.jsx)("button",{onClick:()=>d(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsx)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:(0,T.jsxs)("form",{onSubmit:De,className:"space-y-5",children:[(0,T.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("roles.form.name")}),(0,T.jsx)("input",{type:"text",value:C.name,onChange:e=>P((0,m.A)((0,m.A)({},C),{},{name:e.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("roles.form.description")}),(0,T.jsx)("input",{type:"text",value:C.description,onChange:e=>P((0,m.A)((0,m.A)({},C),{},{description:e.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white"})]})]}),(0,T.jsxs)("div",{className:"mt-2",children:[(0,T.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2",children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Detaillierte Berechtigungen"}),(0,T.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>_e("both"),className:"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800",children:"Seiten \u2713"}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Alle Seiten aktivieren"})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>_e("none"),className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600",children:"Seiten \u2717"}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Alle Seiten deaktivieren"})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>Be("both"),className:"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800",children:"Tabellen \u2713"}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Alle Tabellen aktivieren"})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>Be("none"),className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600",children:"Tabellen \u2717"}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Alle Tabellen deaktivieren"})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>Oe("both"),className:"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800",children:"Buttons \u2713"}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Alle Buttons aktivieren"})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>Oe("none"),className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600",children:"Buttons \u2717"}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Alle Buttons deaktivieren"})]})]})]}),(0,T.jsx)("div",{className:"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600 max-h-[60vh]",children:C.permissions.filter((e=>"page"===e.entityType)).map(((e,t)=>{const r=C.permissions.indexOf(e),a="both"===e.accessLevel;return(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{className:"flex items-center justify-between",children:[(0,T.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:j[e.entity]||e.entity}),(0,T.jsxs)("label",{className:"inline-flex items-center ".concat(re.includes(e.entity)?"cursor-not-allowed opacity-80":"cursor-pointer"),children:[(0,T.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:a,disabled:re.includes(e.entity),onChange:()=>{const t=[...C.permissions];t[r]=(0,m.A)((0,m.A)({},e),{},{accessLevel:a?"none":"both"}),P((0,m.A)((0,m.A)({},C),{},{permissions:t}))}}),(0,T.jsx)("div",{className:"relative w-11 h-6 ".concat(re.includes(e.entity)?"bg-blue-600 dark:bg-blue-700":"bg-gray-200 dark:bg-gray-700"," peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"),children:re.includes(e.entity)&&(0,T.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-xs text-white font-medium",children:"Fix"})})]})]}),C.permissions.filter((t=>"table"===t.entityType&&ne[t.entity]===e.entity)).sort(((e,t)=>{const r=A[e.entity]||e.entity,a=A[t.entity]||t.entity;return r.localeCompare(a)})).map(((t,r)=>{const a=C.permissions.indexOf(t),s="both"===t.accessLevel,l=t.entity,n=A[l]||l,o=C.permissions.filter((t=>"button"===t.entityType&&ie[t.entity]===e.entity&&oe[t.entity]===l&&!("tasks"===l&&t.entity.startsWith("todo_")))).sort(((e,t)=>{const r=S[e.entity]||e.entity,a=S[t.entity]||t.entity,s=[i("roleManagement.buttonOrder.start"),i("roleManagement.buttonOrder.stop"),i("roleManagement.buttonOrder.create"),i("roleManagement.buttonOrder.edit"),i("roleManagement.buttonOrder.delete")],l=s.indexOf(r),n=s.indexOf(a);return-1!==l&&-1!==n?l-n:-1!==l?-1:-1!==n?1:r.localeCompare(a)}));return(0,T.jsxs)("div",{className:"mt-3",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600",children:[(0,T.jsxs)("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:["\u2514 ",n]}),(0,T.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,T.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:s,onChange:()=>{const e=[...C.permissions];e[a]=(0,m.A)((0,m.A)({},t),{},{accessLevel:s?"none":"both"}),P((0,m.A)((0,m.A)({},C),{},{permissions:e}))}}),(0,T.jsx)("div",{className:"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"})]})]}),o.map(((e,t)=>{const r=C.permissions.indexOf(e),a="both"===e.accessLevel,s=S[e.entity]||e.entity;return(0,T.jsxs)("div",{className:"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600",children:[(0,T.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["\u2514 ",s]}),(0,T.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,T.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:a,onChange:()=>{const t=[...C.permissions];t[r]=(0,m.A)((0,m.A)({},e),{},{accessLevel:a?"none":"both"}),P((0,m.A)((0,m.A)({},C),{},{permissions:t}))}}),(0,T.jsx)("div",{className:"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"})]})]},"button-permission-desktop-".concat(e.entity,"-").concat(t))}))]},"table-permission-desktop-".concat(l,"-").concat(r))})),C.permissions.filter((t=>"button"===t.entityType&&ie[t.entity]===e.entity&&!oe[t.entity])).sort(((e,t)=>{const r=S[e.entity]||e.entity,a=S[t.entity]||t.entity;return r.localeCompare(a)})).map(((e,t)=>{const r=C.permissions.indexOf(e),a="both"===e.accessLevel,s=S[e.entity]||e.entity;return(0,T.jsxs)("div",{className:"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600",children:[(0,T.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["\u2514 ",s]}),(0,T.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,T.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:a,onChange:()=>{const t=[...C.permissions];t[r]=(0,m.A)((0,m.A)({},e),{},{accessLevel:a?"none":"both"}),P((0,m.A)((0,m.A)({},C),{},{permissions:t}))}}),(0,T.jsx)("div",{className:"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"})]})]},"button-permission-desktop-".concat(e.entity,"-").concat(t))}))]},"permission-page-desktop-".concat(e.entity,"-").concat(t))}))})]}),(0,T.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:()=>d(!1),className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Abbrechen"})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors",children:(0,T.jsx)(f.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:c?"Aktualisieren":"Erstellen"})]})]})]})})]})]})})]})},be=e=>{let{branch:t,onEdit:r,onDelete:a,canEdit:l,canDelete:n}=e;const{t:i}=(0,s.Bd)();return(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4",children:(0,T.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t.name}),(0,T.jsxs)("div",{className:"flex space-x-2",children:[l&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>r(t),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1",children:(0,T.jsx)(C.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("common.edit",{defaultValue:"Bearbeiten"})})]}),n&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>a(t.id),className:"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1",children:(0,T.jsx)(Y.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("common.delete",{defaultValue:"L\xf6schen"})})]})]})]})})},he="branches-table",pe=e=>{let{onError:t}=e;const{t:r}=(0,s.Bd)(),[n,i]=(0,a.useState)(!1),[o,d]=(0,a.useState)(null),[c,g]=(0,a.useState)([]),[b,h]=(0,a.useState)(!0),[p,v]=(0,a.useState)({name:"",whatsappSettings:{provider:"whatsapp-business-api",apiKey:"",apiSecret:"",phoneNumberId:"",ai:{enabled:!1,model:"gpt-4o",systemPrompt:"",rules:[],sources:[],temperature:.7,maxTokens:500}},lobbyPmsSettings:{apiUrl:"",apiKey:"",propertyId:"",autoCreateTasks:!1,lateCheckInThreshold:"22:00",notificationChannels:["email"],autoSendInvitation:!1},boldPaymentSettings:{apiKey:"",merchantId:"",environment:"sandbox"},doorSystemSettings:{clientId:"",clientSecret:"",username:"",password:"",apiUrl:"https://euopen.ttlock.com",lockIds:[],appName:"TTLock"},emailSettings:{smtpHost:"",smtpPort:587,smtpUser:"",smtpPass:"",smtpFromEmail:"",smtpFromName:"",imap:{enabled:!1,host:"",port:993,secure:!0,user:"",password:"",folder:"INBOX",processedFolder:""}}}),[k,j]=(0,a.useState)("whatsapp"),[A,S]=(0,a.useState)({}),[C,P]=(0,a.useState)(""),[E,z]=(0,a.useState)(!1),[L,D]=(0,a.useState)([]),[F,I]=(0,a.useState)([]),[_,B]=(0,a.useState)(""),[O,V]=(0,a.useState)(null),[U,M]=(0,a.useState)(10),{hasPermission:q}=(0,l.S)(),{openSidepane:G,closeSidepane:W}=(0,R.N)(),K=q("branches","write","table"),H=q("branches","write","table"),J=q("branches","write","table"),Y=(0,a.useCallback)((async()=>{h(!0);try{const e=await w.A.get(N.Sn.BRANCHES.BASE);g(e.data)}catch(s){var e,a;console.error("Fehler beim Laden der Niederlassungen:",s);const l=(null===(e=s.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||r("branches.loadError");t(l)}finally{h(!1)}}),[t]);(0,a.useEffect)((()=>{Y()}),[Y]),(0,a.useEffect)((()=>(n?G():W(),()=>{W()})),[n,G,W]);const Z=()=>{v({name:"",whatsappSettings:{provider:"whatsapp-business-api",apiKey:"",apiSecret:"",phoneNumberId:"",ai:{enabled:!1,model:"gpt-4o",systemPrompt:"",rules:[],sources:[],temperature:.7,maxTokens:500}},lobbyPmsSettings:{apiUrl:"",apiKey:"",propertyId:"",autoCreateTasks:!1,lateCheckInThreshold:"22:00",notificationChannels:["email"],autoSendInvitation:!1},boldPaymentSettings:{apiKey:"",merchantId:"",environment:"sandbox"},doorSystemSettings:{clientId:"",clientSecret:"",username:"",password:"",apiUrl:"https://euopen.ttlock.com",lockIds:[],appName:"TTLock"},sireSettings:{enabled:!1,autoRegisterOnCheckIn:!1,apiUrl:"",apiKey:"",apiSecret:"",propertyCode:""},emailSettings:{smtpHost:"",smtpPort:587,smtpUser:"",smtpPass:"",smtpFromEmail:"",smtpFromName:"",imap:{enabled:!1,host:"",port:993,secure:!0,user:"",password:"",folder:"INBOX",processedFolder:""}}}),j("whatsapp"),d(null)},ee=async e=>{d(e);const t=e.whatsappSettings||{},r=e.lobbyPmsSettings||{},a=e.boldPaymentSettings||{},s=e.doorSystemSettings||{},l=e.emailSettings||{};v({name:e.name,whatsappSettings:{provider:t.provider||"whatsapp-business-api",apiKey:t.apiKey||"",apiSecret:t.apiSecret||"",phoneNumberId:t.phoneNumberId||"",ai:t.ai||{enabled:!1,model:"gpt-4o",systemPrompt:"",rules:[],sources:[],temperature:.7,maxTokens:500}},lobbyPmsSettings:{apiUrl:r.apiUrl||"",apiKey:r.apiKey||"",propertyId:r.propertyId||"",autoCreateTasks:r.autoCreateTasks||!1,lateCheckInThreshold:r.lateCheckInThreshold||"22:00",notificationChannels:r.notificationChannels||["email"],autoSendInvitation:r.autoSendInvitation||!1},boldPaymentSettings:{apiKey:a.apiKey||"",merchantId:a.merchantId||"",environment:a.environment||"sandbox"},doorSystemSettings:{clientId:s.clientId||"",clientSecret:s.clientSecret||"",username:s.username||"",password:s.password||"",apiUrl:s.apiUrl||"https://euopen.ttlock.com",lockIds:s.lockIds||[],appName:s.appName||"TTLock"},emailSettings:{smtpHost:l.smtpHost||"",smtpPort:l.smtpPort||587,smtpUser:l.smtpUser||"",smtpPass:l.smtpPass||"",smtpFromEmail:l.smtpFromEmail||"",smtpFromName:l.smtpFromName||"",imap:l.imap||{enabled:!1,host:"",port:993,secure:!0,user:"",password:"",folder:"INBOX",processedFolder:""}}}),i(!0)},te=()=>{i(!1),Z()},re=async e=>{if(e.preventDefault(),p.name.trim())try{o?await w.A.put(N.Sn.BRANCHES.UPDATE(o.id),{name:p.name.trim(),whatsappSettings:p.whatsappSettings,lobbyPmsSettings:p.lobbyPmsSettings,boldPaymentSettings:p.boldPaymentSettings,doorSystemSettings:p.doorSystemSettings,emailSettings:p.emailSettings}):await w.A.post(N.Sn.BRANCHES.CREATE,{name:p.name.trim()}),await Y(),te()}catch(l){var a,s;console.error("Fehler beim Speichern der Niederlassung:",l);const e=(null===(a=l.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||r("branches.saveError");t(e)}else t(r("branches.nameRequired"))},ae=async e=>{if(window.confirm(r("branches.deleteConfirm",{defaultValue:"M\xf6chten Sie diese Niederlassung wirklich l\xf6schen?"})))try{await w.A.delete(N.Sn.BRANCHES.DELETE(e)),await Y()}catch(l){var a,s;console.error("Fehler beim L\xf6schen der Niederlassung:",l);const e=(null===(a=l.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||r("branches.deleteError");t(e)}},se=()=>L.length,le=(0,a.useMemo)((()=>c.filter((e=>{if(C){const t=C.toLowerCase();if(!e.name.toLowerCase().includes(t))return!1}if(L.length>0){let t=L.length>0;for(let r=0;r<L.length;r++){const a=L[r];let s=!1;if("name"===a.column)"equals"===a.operator?s=e.name.toLowerCase()===(a.value||"").toLowerCase():"contains"===a.operator?s=e.name.toLowerCase().includes((a.value||"").toLowerCase()):"startsWith"===a.operator&&(s=e.name.toLowerCase().startsWith((a.value||"").toLowerCase()));if(0===r)t=s;else{t="AND"===F[r-1]?t&&s:t||s}}if(!t)return!1}return!0})).sort(((e,t)=>e.name.localeCompare(t.name)))),[c,C,L,F]),ne=(e,t)=>{D(e),I(t)},ie=()=>{D([]),I([]),B(""),V(null)};(0,a.useEffect)((()=>{(async()=>{try{if(!localStorage.getItem("token"))return void console.error(r("common.notAuthenticated"));const e=(await w.A.get(N.Sn.SAVED_FILTERS.BY_TABLE(he))).data||[];if(!e.some((e=>"Alle"===e.name))){const e={tableId:he,name:"Alle",conditions:[],operators:[]};await w.A.post(N.Sn.SAVED_FILTERS.BASE,e),console.log(r("branches.filterCreated"))}}catch(e){console.error(r("branches.createStandardFiltersError"),e)}})()}),[]),(0,a.useEffect)((()=>{(async()=>{try{const e=await w.A.get(N.Sn.SAVED_FILTERS.BY_TABLE(he)),t=e.data.find((e=>"Alle"===e.name));t&&(B("Alle"),V(t.id),ne(t.conditions,t.operators))}catch(e){console.error(r("branches.setInitialFilterError"),e)}})()}),[]);const[oe,de]=(0,a.useState)(window.innerWidth<640);return(0,a.useEffect)((()=>{const e=()=>{de(window.innerWidth<640)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,T.jsx)("div",{className:"flex items-center",children:K&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>{Z(),i(!0)},className:"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":r("branches.create",{defaultValue:"Neue Niederlassung"}),children:(0,T.jsx)(x.A,{className:"h-4 w-4"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("branches.create",{defaultValue:"Neue Niederlassung"})})]})}),(0,T.jsx)("div",{}),(0,T.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,T.jsx)("input",{type:"text",placeholder:r("common.search",{defaultValue:"Suchen..."}),className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:C,onChange:e=>P(e.target.value)}),(0,T.jsxs)("div",{className:"relative group ml-1",children:[(0,T.jsxs)("button",{className:"p-2 rounded-md ".concat(se()>0?"bg-blue-50 text-blue-600":"hover:bg-gray-100"," relative"),onClick:()=>z(!E),children:[(0,T.jsx)(X.A,{className:"w-5 h-5"}),se()>0&&(0,T.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center",children:se()})]}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.filter",{defaultValue:"Filter"})})]})]})]}),E&&(0,T.jsx)($.A,{columns:[{id:"name",label:r("branches.name",{defaultValue:"Name"})}],onApply:ne,onReset:ie,savedConditions:L,savedOperators:F,tableId:he}),(0,T.jsx)(Q.A,{tableId:he,onSelectFilter:ne,onReset:ie,activeFilterName:_,selectedFilterId:O,onFilterChange:(e,t,r,a)=>{B(e),V(t),ne(r,a)},defaultFilterName:"Alle"}),b?(0,T.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,T.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):0===le.length?(0,T.jsx)("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded text-center",children:(0,T.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:r("branches.noBranches",{defaultValue:"Keine Niederlassungen gefunden. Erstellen Sie eine neue Niederlassung mit dem Button oben."})})}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{className:"space-y-4",children:le.slice(0,U).map((e=>(0,T.jsx)(be,{branch:e,onEdit:ee,onDelete:ae,canEdit:H,canDelete:J},e.id)))}),le.length>U&&(0,T.jsx)("div",{className:"mt-4 flex justify-center",children:(0,T.jsxs)("button",{className:"px-4 py-2 text-sm font-medium text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700",onClick:()=>M((e=>e+10)),children:[r("common.showMore",{defaultValue:"Mehr anzeigen"})," (",le.length-U," ",r("common.remaining",{defaultValue:"verbleibend"}),")"]})})]})]}),n&&(0,T.jsx)(T.Fragment,{children:oe?(0,T.jsxs)(u.lG,{open:n,onClose:te,className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,T.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0",children:(0,T.jsxs)("div",{className:"flex items-center justify-between",children:[(0,T.jsx)(u.lG.Title,{className:"text-lg font-semibold dark:text-white",children:o?r("branches.edit",{defaultValue:"Niederlassung bearbeiten"}):r("branches.create",{defaultValue:"Neue Niederlassung"})}),(0,T.jsx)("button",{onClick:te,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]})}),(0,T.jsxs)("form",{onSubmit:re,className:"p-6 space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("branches.name",{defaultValue:"Name"})}),(0,T.jsx)("input",{type:"text",value:p.name,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{name:e.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",required:!0,autoFocus:!0})]}),o&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-4",children:(0,T.jsx)("nav",{className:"-mb-px flex space-x-2 overflow-x-auto",children:["whatsapp","lobbypms","boldpayment","doorsystem","email"].map((e=>(0,T.jsx)("button",{type:"button",onClick:()=>j(e),className:"py-2 px-2 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ".concat(k===e?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:"whatsapp"===e?"WhatsApp":"lobbypms"===e?"LobbyPMS":"boldpayment"===e?"Bold Payment":"doorsystem"===e?"TTLock":"Email"},e)))})}),(0,T.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:["whatsapp"===k&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"WhatsApp Settings"}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"whatsappProvider",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Provider"}),(0,T.jsxs)("select",{id:"whatsappProvider",value:p.whatsappSettings.provider,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{provider:e.target.value})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,T.jsx)("option",{value:"twilio",children:"Twilio"}),(0,T.jsx)("option",{value:"whatsapp-business-api",children:"WhatsApp Business API"})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"whatsappApiKey",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key / Access Token"}),(0,T.jsxs)("div",{className:"relative",children:[(0,T.jsx)("input",{type:A.whatsappApiKey?"text":"password",id:"whatsappApiKey",value:p.whatsappSettings.apiKey,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{apiKey:e.target.value})})),placeholder:"API Key / Access Token",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,T.jsx)("button",{type:"button",onClick:()=>S((e=>(0,m.A)((0,m.A)({},e),{},{whatsappApiKey:!e.whatsappApiKey}))),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:A.whatsappApiKey?(0,T.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,T.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"whatsappPhoneNumberId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone Number ID"}),(0,T.jsx)("input",{type:"text",id:"whatsappPhoneNumberId",value:p.whatsappSettings.phoneNumberId,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{phoneNumberId:e.target.value})})),placeholder:"Phone Number ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,T.jsx)("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"KI-Konfiguration (AI)"}),(0,T.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,T.jsx)("input",{type:"checkbox",checked:p.whatsappSettings.ai.enabled,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{enabled:e.target.checked})})})),className:"sr-only peer"}),(0,T.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,T.jsx)("span",{className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:p.whatsappSettings.ai.enabled?"Aktiviert":"Deaktiviert"})]})]}),p.whatsappSettings.ai.enabled&&(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"aiModel",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Modell"}),(0,T.jsxs)("select",{id:"aiModel",value:p.whatsappSettings.ai.model,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{model:e.target.value})})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,T.jsx)("option",{value:"gpt-4o",children:"GPT-4o"}),(0,T.jsx)("option",{value:"gpt-4",children:"GPT-4"}),(0,T.jsx)("option",{value:"gpt-3.5-turbo",children:"GPT-3.5 Turbo"})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"aiSystemPrompt",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"System Prompt"}),(0,T.jsx)("textarea",{id:"aiSystemPrompt",value:p.whatsappSettings.ai.systemPrompt,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{systemPrompt:e.target.value})})})),rows:4,placeholder:"Du bist ein hilfreicher Assistent f\xfcr...",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Regeln (eine pro Zeile)"}),(0,T.jsx)("textarea",{value:p.whatsappSettings.ai.rules.join("\n"),onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{rules:e.target.value.split("\n").filter((e=>e.trim()))})})})),rows:3,placeholder:"Antworte immer auf Spanisch\nSei freundlich und professionell",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Quellen/URLs (eine pro Zeile)"}),(0,T.jsx)("textarea",{value:p.whatsappSettings.ai.sources.join("\n"),onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{sources:e.target.value.split("\n").filter((e=>e.trim()))})})})),rows:2,placeholder:"https://wiki.example.com/manila-procedures\nhttps://wiki.example.com/faq",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{htmlFor:"aiTemperature",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Temperature (",p.whatsappSettings.ai.temperature,")"]}),(0,T.jsx)("input",{type:"range",id:"aiTemperature",min:"0",max:"2",step:"0.1",value:p.whatsappSettings.ai.temperature,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{temperature:parseFloat(e.target.value)})})})),className:"mt-1 block w-full"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"aiMaxTokens",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Max Tokens"}),(0,T.jsx)("input",{type:"number",id:"aiMaxTokens",min:"100",max:"4000",step:"100",value:p.whatsappSettings.ai.maxTokens,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{maxTokens:parseInt(e.target.value)||500})})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]})]})]})]}),"lobbypms"===k&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"LobbyPMS Settings"}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API URL"}),(0,T.jsx)("input",{type:"text",value:p.lobbyPmsSettings.apiUrl,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{lobbyPmsSettings:(0,m.A)((0,m.A)({},p.lobbyPmsSettings),{},{apiUrl:e.target.value})})),placeholder:"https://api.lobbypms.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key"}),(0,T.jsx)("input",{type:A.lobbyPmsApiKey?"text":"password",value:p.lobbyPmsSettings.apiKey,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{lobbyPmsSettings:(0,m.A)((0,m.A)({},p.lobbyPmsSettings),{},{apiKey:e.target.value})})),placeholder:"API Key",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Property ID"}),(0,T.jsx)("input",{type:"text",value:p.lobbyPmsSettings.propertyId,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{lobbyPmsSettings:(0,m.A)((0,m.A)({},p.lobbyPmsSettings),{},{propertyId:e.target.value})})),placeholder:"Property ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]}),"boldpayment"===k&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"Bold Payment Settings"}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key"}),(0,T.jsx)("input",{type:A.boldPaymentApiKey?"text":"password",value:p.boldPaymentSettings.apiKey,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{boldPaymentSettings:(0,m.A)((0,m.A)({},p.boldPaymentSettings),{},{apiKey:e.target.value})})),placeholder:"API Key",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Merchant ID"}),(0,T.jsx)("input",{type:A.boldPaymentMerchantId?"text":"password",value:p.boldPaymentSettings.merchantId,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{boldPaymentSettings:(0,m.A)((0,m.A)({},p.boldPaymentSettings),{},{merchantId:e.target.value})})),placeholder:"Merchant ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Environment"}),(0,T.jsxs)("select",{value:p.boldPaymentSettings.environment,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{boldPaymentSettings:(0,m.A)((0,m.A)({},p.boldPaymentSettings),{},{environment:e.target.value})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,T.jsx)("option",{value:"sandbox",children:"Sandbox"}),(0,T.jsx)("option",{value:"production",children:"Production"})]})]})]})]}),"doorsystem"===k&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"TTLock Settings"}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Client ID"}),(0,T.jsx)("input",{type:"text",value:p.doorSystemSettings.clientId,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{doorSystemSettings:(0,m.A)((0,m.A)({},p.doorSystemSettings),{},{clientId:e.target.value})})),placeholder:"Client ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Client Secret"}),(0,T.jsx)("input",{type:A.doorSystemClientSecret?"text":"password",value:p.doorSystemSettings.clientSecret,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{doorSystemSettings:(0,m.A)((0,m.A)({},p.doorSystemSettings),{},{clientSecret:e.target.value})})),placeholder:"Client Secret",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Username"}),(0,T.jsx)("input",{type:"text",value:p.doorSystemSettings.username,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{doorSystemSettings:(0,m.A)((0,m.A)({},p.doorSystemSettings),{},{username:e.target.value})})),placeholder:"Username",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Password"}),(0,T.jsx)("input",{type:A.doorSystemPassword?"text":"password",value:p.doorSystemSettings.password,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{doorSystemSettings:(0,m.A)((0,m.A)({},p.doorSystemSettings),{},{password:e.target.value})})),placeholder:"Password",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]}),"email"===k&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"Email Settings"}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP Host"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.smtpHost,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{smtpHost:e.target.value})})),placeholder:"smtp.example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP Port"}),(0,T.jsx)("input",{type:"number",value:p.emailSettings.smtpPort,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{smtpPort:parseInt(e.target.value)||587})})),placeholder:"587",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP User"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.smtpUser,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{smtpUser:e.target.value})})),placeholder:"user@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP Password"}),(0,T.jsxs)("div",{className:"relative",children:[(0,T.jsx)("input",{type:A.emailSmtpPass?"text":"password",value:p.emailSettings.smtpPass,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{smtpPass:e.target.value})})),placeholder:"Password",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,T.jsx)("button",{type:"button",onClick:()=>S((0,m.A)((0,m.A)({},A),{},{emailSmtpPass:!A.emailSmtpPass})),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:A.emailSmtpPass?(0,T.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,T.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP From Email"}),(0,T.jsx)("input",{type:"email",value:p.emailSettings.smtpFromEmail,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{smtpFromEmail:e.target.value})})),placeholder:"noreply@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP From Name"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.smtpFromName,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{smtpFromName:e.target.value})})),placeholder:"Branch Name",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,T.jsx)("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"IMAP Settings (Email Reading)"}),(0,T.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,T.jsx)("input",{type:"checkbox",checked:p.emailSettings.imap.enabled,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{enabled:e.target.checked})})})),className:"sr-only peer"}),(0,T.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,T.jsx)("span",{className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:p.emailSettings.imap.enabled?"Enabled":"Disabled"})]})]}),p.emailSettings.imap.enabled&&(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Host"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.imap.host,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{host:e.target.value})})})),placeholder:"imap.example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Port"}),(0,T.jsx)("input",{type:"number",value:p.emailSettings.imap.port,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{port:parseInt(e.target.value)||993})})})),placeholder:"993",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsx)("div",{children:(0,T.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,T.jsx)("input",{type:"checkbox",checked:p.emailSettings.imap.secure,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{secure:e.target.checked})})})),className:"sr-only peer"}),(0,T.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,T.jsx)("span",{className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:"Secure (SSL/TLS)"})]})}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP User"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.imap.user,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{user:e.target.value})})})),placeholder:"user@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Password"}),(0,T.jsxs)("div",{className:"relative",children:[(0,T.jsx)("input",{type:A.emailImapPass?"text":"password",value:p.emailSettings.imap.password,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{password:e.target.value})})})),placeholder:"Password",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,T.jsx)("button",{type:"button",onClick:()=>S((0,m.A)((0,m.A)({},A),{},{emailImapPass:!A.emailImapPass})),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:A.emailImapPass?(0,T.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,T.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Folder"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.imap.folder,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{folder:e.target.value})})})),placeholder:"INBOX",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Processed Folder (optional)"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.imap.processedFolder,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{processedFolder:e.target.value})})})),placeholder:"Processed",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]})]})]})]})]}),(0,T.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:te,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.cancel",{defaultValue:"Abbrechen"})})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors",children:(0,T.jsx)(f.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o?r("common.update",{defaultValue:"Aktualisieren"}):r("common.create",{defaultValue:"Erstellen"})})]})]})]})]})})]}):(0,T.jsxs)("div",{className:"fixed inset-y-0 right-0 w-full sm:min-w-[500px] sm:max-w-[600px] bg-white dark:bg-gray-800 shadow-xl z-50 flex flex-col",children:[(0,T.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0",children:(0,T.jsxs)("div",{className:"flex items-center justify-between",children:[(0,T.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:o?r("branches.edit",{defaultValue:"Niederlassung bearbeiten"}):r("branches.create",{defaultValue:"Neue Niederlassung"})}),(0,T.jsx)("button",{onClick:te,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]})}),(0,T.jsxs)("form",{onSubmit:re,className:"flex flex-col flex-1 min-h-0",children:[(0,T.jsx)("div",{className:"flex-1 overflow-y-auto min-h-0",children:(0,T.jsxs)("div",{className:"p-6 space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("branches.name",{defaultValue:"Name"})}),(0,T.jsx)("input",{type:"text",value:p.name,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{name:e.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",required:!0,autoFocus:!0})]}),o&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-4",children:(0,T.jsx)("nav",{className:"-mb-px flex space-x-2 overflow-x-auto",children:["whatsapp","lobbypms","boldpayment","doorsystem","email"].map((e=>(0,T.jsx)("button",{type:"button",onClick:()=>j(e),className:"py-2 px-2 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ".concat(k===e?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:"whatsapp"===e?"WhatsApp":"lobbypms"===e?"LobbyPMS":"boldpayment"===e?"Bold Payment":"doorsystem"===e?"TTLock":"Email"},e)))})}),(0,T.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:["whatsapp"===k&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"WhatsApp Settings"}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"whatsappProviderDesktop",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Provider"}),(0,T.jsxs)("select",{id:"whatsappProviderDesktop",value:p.whatsappSettings.provider,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{provider:e.target.value})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,T.jsx)("option",{value:"twilio",children:"Twilio"}),(0,T.jsx)("option",{value:"whatsapp-business-api",children:"WhatsApp Business API"})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"whatsappApiKey",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key / Access Token"}),(0,T.jsxs)("div",{className:"relative",children:[(0,T.jsx)("input",{type:A.whatsappApiKey?"text":"password",id:"whatsappApiKey",value:p.whatsappSettings.apiKey,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{apiKey:e.target.value})})),placeholder:"API Key / Access Token",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,T.jsx)("button",{type:"button",onClick:()=>S((e=>(0,m.A)((0,m.A)({},e),{},{whatsappApiKey:!e.whatsappApiKey}))),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:A.whatsappApiKey?(0,T.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,T.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"whatsappPhoneNumberId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone Number ID"}),(0,T.jsx)("input",{type:"text",id:"whatsappPhoneNumberId",value:p.whatsappSettings.phoneNumberId,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{phoneNumberId:e.target.value})})),placeholder:"Phone Number ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,T.jsx)("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"KI-Konfiguration (AI)"}),(0,T.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,T.jsx)("input",{type:"checkbox",checked:p.whatsappSettings.ai.enabled,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{enabled:e.target.checked})})})),className:"sr-only peer"}),(0,T.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,T.jsx)("span",{className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:p.whatsappSettings.ai.enabled?"Aktiviert":"Deaktiviert"})]})]}),p.whatsappSettings.ai.enabled&&(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"aiModelDesktop",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Modell"}),(0,T.jsxs)("select",{id:"aiModelDesktop",value:p.whatsappSettings.ai.model,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{model:e.target.value})})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,T.jsx)("option",{value:"gpt-4o",children:"GPT-4o"}),(0,T.jsx)("option",{value:"gpt-4",children:"GPT-4"}),(0,T.jsx)("option",{value:"gpt-3.5-turbo",children:"GPT-3.5 Turbo"})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"aiSystemPromptDesktop",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"System Prompt"}),(0,T.jsx)("textarea",{id:"aiSystemPromptDesktop",value:p.whatsappSettings.ai.systemPrompt,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{systemPrompt:e.target.value})})})),rows:4,placeholder:"Du bist ein hilfreicher Assistent f\xfcr...",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Regeln (eine pro Zeile)"}),(0,T.jsx)("textarea",{value:p.whatsappSettings.ai.rules.join("\n"),onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{rules:e.target.value.split("\n").filter((e=>e.trim()))})})})),rows:3,placeholder:"Antworte immer auf Spanisch\nSei freundlich und professionell",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Quellen/URLs (eine pro Zeile)"}),(0,T.jsx)("textarea",{value:p.whatsappSettings.ai.sources.join("\n"),onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{sources:e.target.value.split("\n").filter((e=>e.trim()))})})})),rows:2,placeholder:"https://wiki.example.com/manila-procedures\nhttps://wiki.example.com/faq",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{htmlFor:"aiTemperatureDesktop",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Temperature (",p.whatsappSettings.ai.temperature,")"]}),(0,T.jsx)("input",{type:"range",id:"aiTemperatureDesktop",min:"0",max:"2",step:"0.1",value:p.whatsappSettings.ai.temperature,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{temperature:parseFloat(e.target.value)})})})),className:"mt-1 block w-full"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"aiMaxTokensDesktop",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Max Tokens"}),(0,T.jsx)("input",{type:"number",id:"aiMaxTokensDesktop",min:"100",max:"4000",step:"100",value:p.whatsappSettings.ai.maxTokens,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{whatsappSettings:(0,m.A)((0,m.A)({},p.whatsappSettings),{},{ai:(0,m.A)((0,m.A)({},p.whatsappSettings.ai),{},{maxTokens:parseInt(e.target.value)||500})})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]})]})]})]}),"lobbypms"===k&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"LobbyPMS Settings"}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API URL"}),(0,T.jsx)("input",{type:"text",value:p.lobbyPmsSettings.apiUrl,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{lobbyPmsSettings:(0,m.A)((0,m.A)({},p.lobbyPmsSettings),{},{apiUrl:e.target.value})})),placeholder:"https://api.lobbypms.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key"}),(0,T.jsx)("input",{type:A.lobbyPmsApiKey?"text":"password",value:p.lobbyPmsSettings.apiKey,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{lobbyPmsSettings:(0,m.A)((0,m.A)({},p.lobbyPmsSettings),{},{apiKey:e.target.value})})),placeholder:"API Key",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Property ID"}),(0,T.jsx)("input",{type:"text",value:p.lobbyPmsSettings.propertyId,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{lobbyPmsSettings:(0,m.A)((0,m.A)({},p.lobbyPmsSettings),{},{propertyId:e.target.value})})),placeholder:"Property ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]}),"boldpayment"===k&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"Bold Payment Settings"}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key"}),(0,T.jsx)("input",{type:A.boldPaymentApiKey?"text":"password",value:p.boldPaymentSettings.apiKey,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{boldPaymentSettings:(0,m.A)((0,m.A)({},p.boldPaymentSettings),{},{apiKey:e.target.value})})),placeholder:"API Key",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Merchant ID"}),(0,T.jsx)("input",{type:A.boldPaymentMerchantId?"text":"password",value:p.boldPaymentSettings.merchantId,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{boldPaymentSettings:(0,m.A)((0,m.A)({},p.boldPaymentSettings),{},{merchantId:e.target.value})})),placeholder:"Merchant ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Environment"}),(0,T.jsxs)("select",{value:p.boldPaymentSettings.environment,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{boldPaymentSettings:(0,m.A)((0,m.A)({},p.boldPaymentSettings),{},{environment:e.target.value})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,T.jsx)("option",{value:"sandbox",children:"Sandbox"}),(0,T.jsx)("option",{value:"production",children:"Production"})]})]})]})]}),"doorsystem"===k&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"TTLock Settings"}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Client ID"}),(0,T.jsx)("input",{type:"text",value:p.doorSystemSettings.clientId,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{doorSystemSettings:(0,m.A)((0,m.A)({},p.doorSystemSettings),{},{clientId:e.target.value})})),placeholder:"Client ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Client Secret"}),(0,T.jsx)("input",{type:A.doorSystemClientSecret?"text":"password",value:p.doorSystemSettings.clientSecret,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{doorSystemSettings:(0,m.A)((0,m.A)({},p.doorSystemSettings),{},{clientSecret:e.target.value})})),placeholder:"Client Secret",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Username"}),(0,T.jsx)("input",{type:"text",value:p.doorSystemSettings.username,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{doorSystemSettings:(0,m.A)((0,m.A)({},p.doorSystemSettings),{},{username:e.target.value})})),placeholder:"Username",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Password"}),(0,T.jsx)("input",{type:A.doorSystemPassword?"text":"password",value:p.doorSystemSettings.password,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{doorSystemSettings:(0,m.A)((0,m.A)({},p.doorSystemSettings),{},{password:e.target.value})})),placeholder:"Password",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]}),"email"===k&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"Email Settings"}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP Host"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.smtpHost,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{smtpHost:e.target.value})})),placeholder:"smtp.example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP Port"}),(0,T.jsx)("input",{type:"number",value:p.emailSettings.smtpPort,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{smtpPort:parseInt(e.target.value)||587})})),placeholder:"587",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP User"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.smtpUser,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{smtpUser:e.target.value})})),placeholder:"user@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP Password"}),(0,T.jsxs)("div",{className:"relative",children:[(0,T.jsx)("input",{type:A.emailSmtpPass?"text":"password",value:p.emailSettings.smtpPass,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{smtpPass:e.target.value})})),placeholder:"Password",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,T.jsx)("button",{type:"button",onClick:()=>S((0,m.A)((0,m.A)({},A),{},{emailSmtpPass:!A.emailSmtpPass})),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:A.emailSmtpPass?(0,T.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,T.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP From Email"}),(0,T.jsx)("input",{type:"email",value:p.emailSettings.smtpFromEmail,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{smtpFromEmail:e.target.value})})),placeholder:"noreply@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP From Name"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.smtpFromName,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{smtpFromName:e.target.value})})),placeholder:"Branch Name",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,T.jsx)("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"IMAP Settings (Email Reading)"}),(0,T.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,T.jsx)("input",{type:"checkbox",checked:p.emailSettings.imap.enabled,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{enabled:e.target.checked})})})),className:"sr-only peer"}),(0,T.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,T.jsx)("span",{className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:p.emailSettings.imap.enabled?"Enabled":"Disabled"})]})]}),p.emailSettings.imap.enabled&&(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Host"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.imap.host,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{host:e.target.value})})})),placeholder:"imap.example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Port"}),(0,T.jsx)("input",{type:"number",value:p.emailSettings.imap.port,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{port:parseInt(e.target.value)||993})})})),placeholder:"993",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsx)("div",{children:(0,T.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,T.jsx)("input",{type:"checkbox",checked:p.emailSettings.imap.secure,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{secure:e.target.checked})})})),className:"sr-only peer"}),(0,T.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,T.jsx)("span",{className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:"Secure (SSL/TLS)"})]})}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP User"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.imap.user,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{user:e.target.value})})})),placeholder:"user@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Password"}),(0,T.jsxs)("div",{className:"relative",children:[(0,T.jsx)("input",{type:A.emailImapPass?"text":"password",value:p.emailSettings.imap.password,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{password:e.target.value})})})),placeholder:"Password",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,T.jsx)("button",{type:"button",onClick:()=>S((0,m.A)((0,m.A)({},A),{},{emailImapPass:!A.emailImapPass})),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:A.emailImapPass?(0,T.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,T.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Folder"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.imap.folder,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{folder:e.target.value})})})),placeholder:"INBOX",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Processed Folder (optional)"}),(0,T.jsx)("input",{type:"text",value:p.emailSettings.imap.processedFolder,onChange:e=>v((0,m.A)((0,m.A)({},p),{},{emailSettings:(0,m.A)((0,m.A)({},p.emailSettings),{},{imap:(0,m.A)((0,m.A)({},p.emailSettings.imap),{},{processedFolder:e.target.value})})})),placeholder:"Processed",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]})]})]})]})]})]})}),(0,T.jsxs)("div",{className:"flex justify-end pt-4 gap-2 px-6 pb-6 border-t dark:border-gray-700",children:[(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"button",onClick:te,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.cancel",{defaultValue:"Abbrechen"})})]}),(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors",children:(0,T.jsx)(f.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o?r("common.update",{defaultValue:"Aktualisieren"}):r("common.create",{defaultValue:"Erstellen"})})]})]})]})]})})]})},ye=e=>{let{isOpen:t,onClose:r,onProviderCreated:l}=e;const{t:n}=(0,s.Bd)(),{user:i}=(0,D.As)(),{showMessage:o}=(0,v.A)(),[d,c]=(0,a.useState)(""),[m,g]=(0,a.useState)(""),[x,b]=(0,a.useState)(""),[h,p]=(0,a.useState)(""),[f,k]=(0,a.useState)(""),[j,A]=(0,a.useState)(""),[S,C]=(0,a.useState)([]),[P,E]=(0,a.useState)(null),[z,L]=(0,a.useState)(!1),[R,F]=(0,a.useState)(!0);(0,a.useEffect)((()=>{t&&(async()=>{try{var e;F(!0);const t=await w.A.get(N.Sn.BRANCHES.BASE);C((null===(e=t.data)||void 0===e?void 0:e.data)||t.data||[])}catch(t){console.error("Fehler beim Laden der Daten:",t),o(n("errors.loadError"),"error")}finally{F(!1)}})()}),[t,n,o]),(0,a.useEffect)((()=>{t||(c(""),g(""),b(""),p(""),k(""),A(""),E(null))}),[t]);return(0,T.jsxs)(u.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,T.jsx)(u.lG.Title,{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n("tours.providers.create",{defaultValue:"Neuer Tour-Provider"})}),(0,T.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),E(null),d.trim()){L(!0);try{var t,a;const e=await w.A.post(N.Sn.TOUR_PROVIDERS.BASE,{name:d.trim(),phone:m.trim()||null,email:x.trim()||null,contactPerson:h.trim()||null,notes:f.trim()||null,branchId:j?Number(j):null});var s;if(null===(t=e.data)||void 0===t||!t.success||null===(a=e.data)||void 0===a||!a.data)throw new Error((null===(s=e.data)||void 0===s?void 0:s.message)||"Fehler beim Erstellen des Providers");o(n("tours.providers.created",{defaultValue:"Tour-Provider erfolgreich erstellt"}),"success"),l(e.data.data),r()}catch(u){var i,c;console.error("Fehler beim Erstellen des Providers:",u);const e=(null===(i=u.response)||void 0===i||null===(c=i.data)||void 0===c?void 0:c.message)||u.message||n("errors.unknownError");E(e),o(e,"error")}finally{L(!1)}}else E(n("tours.providers.validation.nameRequired",{defaultValue:"Name ist erforderlich"}))},className:"p-4 space-y-4",children:[P&&(0,T.jsx)("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3",children:(0,T.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200",children:P})}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[n("tours.providers.name",{defaultValue:"Name"})," *"]}),(0,T.jsx)("input",{type:"text",value:d,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:z||R})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.providers.contactPerson",{defaultValue:"Ansprechpartner"})}),(0,T.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:z||R})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.providers.phone",{defaultValue:"Telefon"})}),(0,T.jsx)("input",{type:"tel",value:m,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:z||R})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.providers.email",{defaultValue:"E-Mail"})}),(0,T.jsx)("input",{type:"email",value:x,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:z||R})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.providers.branch",{defaultValue:"Niederlassung"})}),(0,T.jsxs)("select",{value:j,onChange:e=>A(e.target.value?Number(e.target.value):""),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:z||R,children:[(0,T.jsx)("option",{value:"",children:n("common.all",{defaultValue:"Alle"})}),S.map((e=>(0,T.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.providers.notes",{defaultValue:"Notizen"})}),(0,T.jsx)("textarea",{value:f,onChange:e=>k(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:z||R})]}),(0,T.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,T.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",children:n("common.cancel","Abbrechen")}),(0,T.jsx)("button",{type:"submit",disabled:z||R,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:z?n("common.saving","Speichere..."):n("common.save","Speichern")})]})]})]})})]})},fe=e=>{let{isOpen:t,onClose:r,provider:l,onProviderUpdated:n}=e;const{t:i}=(0,s.Bd)(),{user:o}=(0,D.As)(),{showMessage:d}=(0,v.A)(),[c,m]=(0,a.useState)(""),[g,x]=(0,a.useState)(""),[b,h]=(0,a.useState)(""),[p,f]=(0,a.useState)(""),[k,j]=(0,a.useState)(""),[A,S]=(0,a.useState)(""),[C,P]=(0,a.useState)([]),[E,z]=(0,a.useState)(null),[L,R]=(0,a.useState)(!1),[F,I]=(0,a.useState)(!0);(0,a.useEffect)((()=>{t&&(async()=>{try{var e;I(!0);const t=await w.A.get(N.Sn.BRANCHES.BASE);P((null===(e=t.data)||void 0===e?void 0:e.data)||t.data||[])}catch(t){console.error("Fehler beim Laden der Daten:",t),d(i("errors.loadError"),"error")}finally{I(!1)}})()}),[t,i,d]),(0,a.useEffect)((()=>{l?(m(l.name||""),x(l.phone||""),h(l.email||""),f(l.contactPerson||""),j(l.notes||""),S(l.branchId||"")):(m(""),x(""),h(""),f(""),j(""),S("")),z(null)}),[l,t]);return l?(0,T.jsxs)(u.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,T.jsx)(u.lG.Title,{className:"text-lg font-semibold text-gray-900 dark:text-white",children:i("tours.providers.edit",{defaultValue:"Tour-Provider bearbeiten"})}),(0,T.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),l)if(z(null),c.trim()){R(!0);try{var t,a;const e=await w.A.put(N.Sn.TOUR_PROVIDERS.BY_ID(l.id),{name:c.trim(),phone:g.trim()||null,email:b.trim()||null,contactPerson:p.trim()||null,notes:k.trim()||null,branchId:A?Number(A):null});var s;if(null===(t=e.data)||void 0===t||!t.success||null===(a=e.data)||void 0===a||!a.data)throw new Error((null===(s=e.data)||void 0===s?void 0:s.message)||"Fehler beim Aktualisieren des Providers");d(i("tours.providers.updated",{defaultValue:"Tour-Provider erfolgreich aktualisiert"}),"success"),n(e.data.data),r()}catch(u){var o,m;console.error("Fehler beim Aktualisieren des Providers:",u);const e=(null===(o=u.response)||void 0===o||null===(m=o.data)||void 0===m?void 0:m.message)||u.message||i("errors.unknownError");z(e),d(e,"error")}finally{R(!1)}}else z(i("tours.providers.validation.nameRequired",{defaultValue:"Name ist erforderlich"}))},className:"p-4 space-y-4",children:[E&&(0,T.jsx)("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3",children:(0,T.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200",children:E})}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("tours.providers.name",{defaultValue:"Name"})," *"]}),(0,T.jsx)("input",{type:"text",value:c,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:L||F})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("tours.providers.contactPerson",{defaultValue:"Ansprechpartner"})}),(0,T.jsx)("input",{type:"text",value:p,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:L||F})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("tours.providers.phone",{defaultValue:"Telefon"})}),(0,T.jsx)("input",{type:"tel",value:g,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:L||F})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("tours.providers.email",{defaultValue:"E-Mail"})}),(0,T.jsx)("input",{type:"email",value:b,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:L||F})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("tours.providers.branch",{defaultValue:"Niederlassung"})}),(0,T.jsxs)("select",{value:A,onChange:e=>S(e.target.value?Number(e.target.value):""),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:L||F,children:[(0,T.jsx)("option",{value:"",children:i("common.all",{defaultValue:"Alle"})}),C.map((e=>(0,T.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("tours.providers.notes",{defaultValue:"Notizen"})}),(0,T.jsx)("textarea",{value:k,onChange:e=>j(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:L||F})]}),(0,T.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,T.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",children:i("common.cancel","Abbrechen")}),(0,T.jsx)("button",{type:"submit",disabled:L||F,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:L?i("common.saving","Speichere..."):i("common.save","Speichern")})]})]})]})})]}):null},ve=e=>{let{provider:t,onEdit:r,onDelete:a,canEdit:l,canDelete:n}=e;const{t:i}=(0,s.Bd)();return(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4",children:[(0,T.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t.name}),(0,T.jsxs)("div",{className:"flex space-x-2",children:[l&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>r(t),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1",children:(0,T.jsx)(C.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("common.edit",{defaultValue:"Bearbeiten"})})]}),n&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>a(t.id),className:"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1",children:(0,T.jsx)(Y.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("common.delete",{defaultValue:"L\xf6schen"})})]})]})]}),(0,T.jsxs)("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[t.contactPerson&&(0,T.jsxs)("p",{children:[(0,T.jsxs)("span",{className:"font-medium",children:[i("tours.providers.contactPerson",{defaultValue:"Ansprechpartner"}),":"]})," ",t.contactPerson]}),t.phone&&(0,T.jsxs)("p",{children:[(0,T.jsxs)("span",{className:"font-medium",children:[i("tours.providers.phone",{defaultValue:"Telefon"}),":"]})," ",t.phone]}),t.email&&(0,T.jsxs)("p",{children:[(0,T.jsxs)("span",{className:"font-medium",children:[i("tours.providers.email",{defaultValue:"E-Mail"}),":"]})," ",t.email]}),t.notes&&(0,T.jsxs)("p",{className:"mt-2 text-xs",children:[(0,T.jsxs)("span",{className:"font-medium",children:[i("tours.providers.notes",{defaultValue:"Notizen"}),":"]})," ",t.notes]})]})]})},ke=e=>{let{onError:t}=e;const{t:r}=(0,s.Bd)(),{showMessage:n}=(0,v.A)(),[i,o]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!1),[m,u]=(0,a.useState)(null),[g,b]=(0,a.useState)([]),[h,p]=(0,a.useState)(!0),[y,f]=(0,a.useState)(""),{hasPermission:k}=(0,l.S)(),j=k("tour_providers","write","table"),A=k("tour_providers","write","table"),S=k("tour_providers","write","table"),C=(0,a.useCallback)((async()=>{p(!0);try{var e;const t=await w.A.get(N.Sn.TOUR_PROVIDERS.BASE),r=(null===(e=t.data)||void 0===e?void 0:e.data)||t.data||[];b(Array.isArray(r)?r:[])}catch(l){var a,s;console.error("Fehler beim Laden der Tour-Provider:",l);const e=(null===(a=l.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||r("tours.providers.loadError",{defaultValue:"Fehler beim Laden der Provider"});t(e),n(e,"error")}finally{p(!1)}}),[t,r,n]);(0,a.useEffect)((()=>{C()}),[C]);const P=g.filter((e=>{var t,r,a,s;if(!y)return!0;const l=y.toLowerCase();return e.name.toLowerCase().includes(l)||(null===(t=e.contactPerson)||void 0===t?void 0:t.toLowerCase().includes(l))||(null===(r=e.phone)||void 0===r?void 0:r.toLowerCase().includes(l))||(null===(a=e.email)||void 0===a?void 0:a.toLowerCase().includes(l))||(null===(s=e.notes)||void 0===s?void 0:s.toLowerCase().includes(l))})),E=e=>{u(e),c(!0)},z=async e=>{if(window.confirm(r("tours.providers.deleteConfirm",{defaultValue:"M\xf6chten Sie diesen Provider wirklich l\xf6schen?"})))try{await w.A.delete(N.Sn.TOUR_PROVIDERS.BY_ID(e)),n(r("tours.providers.deleted",{defaultValue:"Tour-Provider erfolgreich gel\xf6scht"}),"success"),C()}catch(l){var a,s;console.error("Fehler beim L\xf6schen des Providers:",l);const e=(null===(a=l.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||r("errors.unknownError");t(e),n(e,"error")}};return h?(0,T.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,T.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:r("common.loading",{defaultValue:"Lade..."})})}):(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,T.jsx)("div",{className:"flex-1 w-full sm:max-w-md",children:(0,T.jsx)("input",{type:"text",placeholder:r("tours.providers.search",{defaultValue:"Provider suchen..."}),value:y,onChange:e=>f(e.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),j&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>{o(!0)},className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":r("tours.providers.create",{defaultValue:"Neuer Provider"}),children:(0,T.jsx)(x.A,{className:"h-4 w-4"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("tours.providers.create",{defaultValue:"Neuer Provider"})})]})]}),0===P.length?(0,T.jsx)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:y?r("tours.providers.noResults",{defaultValue:"Keine Provider gefunden"}):r("tours.providers.empty",{defaultValue:"Keine Tour-Provider vorhanden"})}):(0,T.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map((e=>(0,T.jsx)(ve,{provider:e,onEdit:E,onDelete:z,canEdit:A,canDelete:S},e.id)))}),(0,T.jsx)(ye,{isOpen:i,onClose:()=>o(!1),onProviderCreated:e=>{C()}}),(0,T.jsx)(fe,{isOpen:d,onClose:()=>{c(!1),u(null)},provider:m,onProviderUpdated:e=>{C()}})]})};var je=r(4850),we=r(1663),Ne=r(1909),Ae=r(1252),Se=r(2023),Ce=r(8897);let Pe=function(e){return e.OWN="own",e.EXTERNAL="external",e}({});const Ee=e=>{let{isOpen:t,onClose:r,onTourCreated:l}=e;const{t:n}=(0,s.Bd)(),{user:i}=(0,D.As)(),{showMessage:o}=(0,v.A)(),[d,c]=(0,a.useState)(""),[m,g]=(0,a.useState)(""),[x,b]=(0,a.useState)(Pe.OWN),[h,p]=(0,a.useState)(!0),[f,k]=(0,a.useState)(""),[j,A]=(0,a.useState)(""),[S,C]=(0,a.useState)(""),[P,E]=(0,a.useState)(""),[z,L]=(0,a.useState)("COP"),[R,F]=(0,a.useState)(""),[I,_]=(0,a.useState)(""),[B,O]=(0,a.useState)(""),[V,U]=(0,a.useState)(""),[M,q]=(0,a.useState)(""),[G,W]=(0,a.useState)(""),[K,H]=(0,a.useState)(""),[J,Y]=(0,a.useState)(""),[Z,X]=(0,a.useState)(""),[$,Q]=(0,a.useState)(""),[ee,te]=(0,a.useState)(""),[re,ae]=(0,a.useState)(""),[se,le]=(0,a.useState)(null),[ne,ie]=(0,a.useState)(null),[oe,de]=(0,a.useState)([]),[ce,me]=(0,a.useState)([]),[ue,ge]=(0,a.useState)(!1),[xe,be]=(0,a.useState)([]),[he,pe]=(0,a.useState)([]),[ye,fe]=(0,a.useState)(null),[ve,ke]=(0,a.useState)(!1),[je,we]=(0,a.useState)(!0);(0,a.useEffect)((()=>{t&&(async()=>{try{var e,t,r;we(!0);const[a,s]=await Promise.all([w.A.get(N.Sn.BRANCHES.BASE),w.A.get((null===(e=N.Sn.TOUR_PROVIDERS)||void 0===e?void 0:e.BASE)||"/api/tour-providers")]);be((null===(t=a.data)||void 0===t?void 0:t.data)||a.data||[]),pe((null===(r=s.data)||void 0===r?void 0:r.data)||s.data||[])}catch(a){console.error("Fehler beim Laden der Daten:",a),o(n("errors.loadError"),"error")}finally{we(!1)}})()}),[t,n,o]),(0,a.useEffect)((()=>{t||(c(""),g(""),b(Pe.OWN),p(!0),k(""),A(""),C(""),E(""),L("COP"),F(""),_(""),O(""),U(""),q(""),W(""),H(""),Y(""),X(""),Q(""),te(""),ae(""),le(null),ie(null),de([]),me([]),fe(null))}),[t]);return t?(0,T.jsxs)(u.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,T.jsx)(u.lG.Title,{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n("tours.create","Neue Tour erstellen")}),(0,T.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),fe(null),!d.trim()||d.trim().length<3)return void fe(n("tours.validation.titleMinLength",{defaultValue:"Titel muss mindestens 3 Zeichen lang sein"}));const t=j?Number(j):null,a=S?Number(S):null;if(null!==t&&null!==a&&t<a)fe(n("tours.validation.maxParticipantsMin",{defaultValue:"Maximale Teilnehmeranzahl muss >= minimale Teilnehmeranzahl sein"}));else if(x!==Pe.EXTERNAL||$)if(""!==P&&Number(P)<0)fe(n("tours.validation.priceNonNegative",{defaultValue:"Preis muss >= 0 sein"}));else if(""!==G&&Number(G)<0)fe(n("tours.validation.commissionNonNegative",{defaultValue:"Kommission muss >= 0 sein"}));else{ke(!0);try{const e={title:d,description:m||null,type:x,isActive:h,duration:f?Number(f):null,maxParticipants:j?Number(j):null,minParticipants:S?Number(S):null,price:P?Number(P):null,currency:z||"COP",location:R||null,meetingPoint:I||null,includes:B||null,excludes:V||null,requirements:M||null,totalCommission:G?Number(G):null,totalCommissionPercent:K?Number(K):null,sellerCommissionPercent:J?Number(J):null,sellerCommissionFixed:Z?Number(Z):null,externalProviderId:$?Number($):null,externalBookingUrl:ee||null,branchId:re?Number(re):null},t=await w.A.post(N.Sn.TOURS.BASE,e);if(t.data.success){const e=t.data.data;if(se&&e.id)try{ge(!0);const t=new FormData;t.append("image",se),await w.A.post(N.Sn.TOURS.UPLOAD_IMAGE(e.id),t,{headers:{"Content-Type":"multipart/form-data"}})}catch(c){console.error("Fehler beim Hochladen des Hauptbildes:",c),o(n("tours.imageUploadError","Tour erstellt, aber Fehler beim Hochladen des Bildes"),"warning")}finally{ge(!1)}if(oe.length>0&&e.id)try{ge(!0);for(const t of oe){const r=new FormData;r.append("image",t),await w.A.post(N.Sn.TOURS.UPLOAD_GALLERY(e.id),r,{headers:{"Content-Type":"multipart/form-data"}})}}catch(u){console.error("Fehler beim Hochladen der Galerie-Bilder:",u),o(n("tours.galleryUploadError","Tour erstellt, aber Fehler beim Hochladen der Galerie-Bilder"),"warning")}finally{ge(!1)}o(n("tours.createSuccess","Tour erfolgreich erstellt"),"success");const a=await w.A.get(N.Sn.TOURS.BY_ID(e.id));l(a.data.data),r()}else fe(t.data.message||n("errors.saveError"))}catch(g){var s,i;console.error("Fehler beim Erstellen der Tour:",g);const e=(null===(s=g.response)||void 0===s||null===(i=s.data)||void 0===i?void 0:i.message)||n("errors.saveError");fe(e),o(e,"error")}finally{ke(!1)}}else fe(n("tours.validation.externalProviderRequired",{defaultValue:"Externer Anbieter ist bei externen Touren erforderlich"}))},className:"p-6 space-y-6",children:[ye&&(0,T.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded",children:ye}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:n("tours.basicInfo","Grundinformationen")}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[n("tours.name","Titel")," *"]}),(0,T.jsx)("input",{type:"text",value:d,onChange:e=>c(e.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.description","Beschreibung")}),(0,T.jsx)("textarea",{value:m,onChange:e=>g(e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[n("tours.type","Typ")," *"]}),(0,T.jsxs)("select",{value:x,onChange:e=>b(e.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:Pe.OWN,children:n("tours.typeOwn","Eigene Tour")}),(0,T.jsx)("option",{value:Pe.EXTERNAL,children:n("tours.typeExternal","Externe Tour")})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.status","Status")}),(0,T.jsxs)("select",{value:h?"true":"false",onChange:e=>p("true"===e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:"true",children:n("tours.statusActive","Aktiv")}),(0,T.jsx)("option",{value:"false",children:n("tours.statusInactive","Inaktiv")})]})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.branch","Niederlassung")}),(0,T.jsxs)("select",{value:re,onChange:e=>ae(e.target.value?Number(e.target.value):""),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:"",children:n("common.all","Alle")}),xe.map((e=>(0,T.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:n("tours.details","Tour-Details")}),(0,T.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.duration","Dauer (Stunden)")}),(0,T.jsx)("input",{type:"number",value:f,onChange:e=>k(e.target.value?Number(e.target.value):""),min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.minParticipants","Min. Teilnehmer")}),(0,T.jsx)("input",{type:"number",value:S,onChange:e=>C(e.target.value?Number(e.target.value):""),min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.maxParticipants","Max. Teilnehmer")}),(0,T.jsx)("input",{type:"number",value:j,onChange:e=>A(e.target.value?Number(e.target.value):""),min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),(0,T.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.price","Preis")}),(0,T.jsx)("input",{type:"number",value:P,onChange:e=>E(e.target.value?Number(e.target.value):""),min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.currency","W\xe4hrung")}),(0,T.jsx)("input",{type:"text",value:z,onChange:e=>L(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.location","Ort")}),(0,T.jsx)("input",{type:"text",value:R,onChange:e=>F(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.meetingPoint","Treffpunkt")}),(0,T.jsx)("input",{type:"text",value:I,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),x===Pe.EXTERNAL&&(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:n("tours.externalInfo","Externe Tour-Informationen")}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.externalProvider","Externer Anbieter")}),(0,T.jsxs)("select",{value:$,onChange:e=>Q(e.target.value?Number(e.target.value):""),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:"",children:n("common.select","Ausw\xe4hlen")}),he.map((e=>(0,T.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.externalBookingUrl","Externe Buchungs-URL")}),(0,T.jsx)("input",{type:"url",value:ee,onChange:e=>te(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:n("tours.commissions","Kommissionen")}),(0,T.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.totalCommission","Gesamtkommission")}),(0,T.jsx)("input",{type:"number",value:G,onChange:e=>W(e.target.value?Number(e.target.value):""),min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.totalCommissionPercent","Gesamtkommission (%)")}),(0,T.jsx)("input",{type:"number",value:K,onChange:e=>H(e.target.value?Number(e.target.value):""),min:"0",max:"100",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.sellerCommissionPercent","Verk\xe4ufer-Kommission (%)")}),(0,T.jsx)("input",{type:"number",value:J,onChange:e=>Y(e.target.value?Number(e.target.value):""),min:"0",max:"100",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.sellerCommissionFixed","Verk\xe4ufer-Kommission (Fix)")}),(0,T.jsx)("input",{type:"number",value:Z,onChange:e=>X(e.target.value?Number(e.target.value):""),min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]})]})]}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:n("tours.additionalInfo","Zus\xe4tzliche Informationen")}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.includes","Enth\xe4lt")}),(0,T.jsx)("textarea",{value:B,onChange:e=>O(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.excludes","Nicht enthalten")}),(0,T.jsx)("textarea",{value:V,onChange:e=>U(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("tours.requirements","Anforderungen")}),(0,T.jsx)("textarea",{value:M,onChange:e=>q(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),(0,T.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,T.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",children:n("common.cancel","Abbrechen")}),(0,T.jsx)("button",{type:"submit",disabled:ve||je,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:ve?n("common.saving","Speichere..."):n("common.save","Speichern")})]})]})]})})]}):null},ze=e=>{var t,r;let{isOpen:l,onClose:n,onTourUpdated:i,tour:o}=e;const{t:d}=(0,s.Bd)(),{user:c}=(0,D.As)(),{showMessage:m}=(0,v.A)(),[g,x]=(0,a.useState)((null===o||void 0===o?void 0:o.title)||""),[b,h]=(0,a.useState)((null===o||void 0===o?void 0:o.description)||""),[p,f]=(0,a.useState)((null===o||void 0===o?void 0:o.type)||Pe.OWN),[k,j]=(0,a.useState)(null===(t=null===o||void 0===o?void 0:o.isActive)||void 0===t||t),[A,S]=(0,a.useState)((null===o||void 0===o?void 0:o.duration)||""),[C,P]=(0,a.useState)((null===o||void 0===o?void 0:o.maxParticipants)||""),[E,z]=(0,a.useState)((null===o||void 0===o?void 0:o.minParticipants)||""),[L,R]=(0,a.useState)(null!==o&&void 0!==o&&o.price?"string"===typeof o.price?parseFloat(o.price):o.price:""),[F,I]=(0,a.useState)((null===o||void 0===o?void 0:o.currency)||"COP"),[_,B]=(0,a.useState)((null===o||void 0===o?void 0:o.location)||""),[O,V]=(0,a.useState)((null===o||void 0===o?void 0:o.meetingPoint)||""),[U,M]=(0,a.useState)((null===o||void 0===o?void 0:o.includes)||""),[q,G]=(0,a.useState)((null===o||void 0===o?void 0:o.excludes)||""),[W,K]=(0,a.useState)((null===o||void 0===o?void 0:o.requirements)||""),[H,J]=(0,a.useState)(null!==o&&void 0!==o&&o.totalCommission?"string"===typeof o.totalCommission?parseFloat(o.totalCommission):o.totalCommission:""),[Y,Z]=(0,a.useState)(null!==o&&void 0!==o&&o.totalCommissionPercent?"string"===typeof o.totalCommissionPercent?parseFloat(o.totalCommissionPercent):o.totalCommissionPercent:""),[X,$]=(0,a.useState)(null!==o&&void 0!==o&&o.sellerCommissionPercent?"string"===typeof o.sellerCommissionPercent?parseFloat(o.sellerCommissionPercent):o.sellerCommissionPercent:""),[Q,ee]=(0,a.useState)(null!==o&&void 0!==o&&o.sellerCommissionFixed?"string"===typeof o.sellerCommissionFixed?parseFloat(o.sellerCommissionFixed):o.sellerCommissionFixed:""),[te,re]=(0,a.useState)((null===o||void 0===o?void 0:o.externalProviderId)||""),[ae,se]=(0,a.useState)((null===o||void 0===o?void 0:o.externalBookingUrl)||""),[le,ne]=(0,a.useState)((null===o||void 0===o?void 0:o.branchId)||""),[ie,oe]=(0,a.useState)(null),[de,ce]=(0,a.useState)(null!==o&&void 0!==o&&o.imageUrl?"".concat(API_BASE_URL||"").concat(o.imageUrl):null),[me,ue]=(0,a.useState)([]),[ge,xe]=(0,a.useState)((null===o||void 0===o||null===(r=o.galleryUrls)||void 0===r?void 0:r.map((e=>"".concat(API_BASE_URL||"").concat(e))))||[]),[be,he]=(0,a.useState)(!1),[pe,ye]=(0,a.useState)([]),[fe,ve]=(0,a.useState)([]),[ke,je]=(0,a.useState)(null),[we,Ne]=(0,a.useState)(!1),[Ae,Se]=(0,a.useState)(!0);(0,a.useEffect)((()=>{l&&(async()=>{try{var e,t,r;Se(!0);const[a,s]=await Promise.all([w.A.get(N.Sn.BRANCHES.BASE),w.A.get((null===(e=N.Sn.TOUR_PROVIDERS)||void 0===e?void 0:e.BASE)||"/api/tour-providers")]);ye((null===(t=a.data)||void 0===t?void 0:t.data)||a.data||[]),ve((null===(r=s.data)||void 0===r?void 0:r.data)||s.data||[])}catch(a){console.error("Fehler beim Laden der Daten:",a),m(d("errors.loadError"),"error")}finally{Se(!1)}})()}),[l,d,m]),(0,a.useEffect)((()=>{var e,t;o&&(x(o.title||""),h(o.description||""),f(o.type||Pe.OWN),j(null===(e=o.isActive)||void 0===e||e),S(o.duration||""),P(o.maxParticipants||""),z(o.minParticipants||""),R(o.price?"string"===typeof o.price?parseFloat(o.price):o.price:""),I(o.currency||"COP"),B(o.location||""),V(o.meetingPoint||""),M(o.includes||""),G(o.excludes||""),K(o.requirements||""),J(o.totalCommission?"string"===typeof o.totalCommission?parseFloat(o.totalCommission):o.totalCommission:""),Z(o.totalCommissionPercent?"string"===typeof o.totalCommissionPercent?parseFloat(o.totalCommissionPercent):o.totalCommissionPercent:""),$(o.sellerCommissionPercent?"string"===typeof o.sellerCommissionPercent?parseFloat(o.sellerCommissionPercent):o.sellerCommissionPercent:""),ee(o.sellerCommissionFixed?"string"===typeof o.sellerCommissionFixed?parseFloat(o.sellerCommissionFixed):o.sellerCommissionFixed:""),re(o.externalProviderId||""),se(o.externalBookingUrl||""),ne(o.branchId||""),ce(o.imageUrl?"".concat(API_BASE_URL||"").concat(o.imageUrl):null),xe((null===(t=o.galleryUrls)||void 0===t?void 0:t.map((e=>"".concat(API_BASE_URL||"").concat(e))))||[]))}),[o]);return l&&o?(0,T.jsxs)(u.lG,{open:l,onClose:n,className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,T.jsx)(u.lG.Title,{className:"text-xl font-semibold text-gray-900 dark:text-white",children:d("tours.edit","Tour bearbeiten")}),(0,T.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),je(null),!g.trim()||g.trim().length<3)return void je(d("tours.validation.titleMinLength",{defaultValue:"Titel muss mindestens 3 Zeichen lang sein"}));const t=C?Number(C):null,r=E?Number(E):null;if(null!==t&&null!==r&&t<r)je(d("tours.validation.maxParticipantsMin",{defaultValue:"Maximale Teilnehmeranzahl muss >= minimale Teilnehmeranzahl sein"}));else if(p!==Pe.EXTERNAL||te)if(""!==L&&Number(L)<0)je(d("tours.validation.priceNonNegative",{defaultValue:"Preis muss >= 0 sein"}));else if(""!==H&&Number(H)<0)je(d("tours.validation.commissionNonNegative",{defaultValue:"Kommission muss >= 0 sein"}));else{Ne(!0);try{const e={title:g,description:b||null,type:p,isActive:k,duration:A?Number(A):null,maxParticipants:C?Number(C):null,minParticipants:E?Number(E):null,price:L?Number(L):null,currency:F||"COP",location:_||null,meetingPoint:O||null,includes:U||null,excludes:q||null,requirements:W||null,totalCommission:H?Number(H):null,totalCommissionPercent:Y?Number(Y):null,sellerCommissionPercent:X?Number(X):null,sellerCommissionFixed:Q?Number(Q):null,externalProviderId:te?Number(te):null,externalBookingUrl:ae||null,branchId:le?Number(le):null},t=await w.A.put(N.Sn.TOURS.BY_ID(o.id),e);if(t.data.success){t.data.data;if(ie)try{he(!0);const e=new FormData;e.append("image",ie),await w.A.post(N.Sn.TOURS.UPLOAD_IMAGE(o.id),e,{headers:{"Content-Type":"multipart/form-data"}})}catch(l){console.error("Fehler beim Hochladen des Hauptbildes:",l),m(d("tours.imageUploadError","Tour aktualisiert, aber Fehler beim Hochladen des Bildes"),"warning")}finally{he(!1)}if(me.length>0)try{he(!0);for(const e of me){const t=new FormData;t.append("image",e),await w.A.post(N.Sn.TOURS.UPLOAD_GALLERY(o.id),t,{headers:{"Content-Type":"multipart/form-data"}})}}catch(c){console.error("Fehler beim Hochladen der Galerie-Bilder:",c),m(d("tours.galleryUploadError","Tour aktualisiert, aber Fehler beim Hochladen der Galerie-Bilder"),"warning")}finally{he(!1)}m(d("tours.updateSuccess","Tour erfolgreich aktualisiert"),"success");const e=await w.A.get(N.Sn.TOURS.BY_ID(o.id));i(e.data.data),n()}else je(t.data.message||d("errors.saveError"))}catch(u){var a,s;console.error("Fehler beim Aktualisieren der Tour:",u);const e=(null===(a=u.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||d("errors.saveError");je(e),m(e,"error")}finally{Ne(!1)}}else je(d("tours.validation.externalProviderRequired",{defaultValue:"Externer Anbieter ist bei externen Touren erforderlich"}))},className:"p-6 space-y-6",children:[ke&&(0,T.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded",children:ke}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:d("tours.basicInfo","Grundinformationen")}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[d("tours.name","Titel")," *"]}),(0,T.jsx)("input",{type:"text",value:g,onChange:e=>x(e.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.description","Beschreibung")}),(0,T.jsx)("textarea",{value:b,onChange:e=>h(e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[d("tours.type","Typ")," *"]}),(0,T.jsxs)("select",{value:p,onChange:e=>f(e.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:Pe.OWN,children:d("tours.typeOwn","Eigene Tour")}),(0,T.jsx)("option",{value:Pe.EXTERNAL,children:d("tours.typeExternal","Externe Tour")})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.status","Status")}),(0,T.jsxs)("select",{value:k?"true":"false",onChange:e=>j("true"===e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:"true",children:d("tours.statusActive","Aktiv")}),(0,T.jsx)("option",{value:"false",children:d("tours.statusInactive","Inaktiv")})]})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.branch","Niederlassung")}),(0,T.jsxs)("select",{value:le,onChange:e=>ne(e.target.value?Number(e.target.value):""),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:"",children:d("common.all","Alle")}),pe.map((e=>(0,T.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:d("tours.details","Tour-Details")}),(0,T.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.duration","Dauer (Stunden)")}),(0,T.jsx)("input",{type:"number",value:A,onChange:e=>S(e.target.value?Number(e.target.value):""),min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.minParticipants","Min. Teilnehmer")}),(0,T.jsx)("input",{type:"number",value:E,onChange:e=>z(e.target.value?Number(e.target.value):""),min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.maxParticipants","Max. Teilnehmer")}),(0,T.jsx)("input",{type:"number",value:C,onChange:e=>P(e.target.value?Number(e.target.value):""),min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),(0,T.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.price","Preis")}),(0,T.jsx)("input",{type:"number",value:L,onChange:e=>R(e.target.value?Number(e.target.value):""),min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.currency","W\xe4hrung")}),(0,T.jsx)("input",{type:"text",value:F,onChange:e=>I(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.location","Ort")}),(0,T.jsx)("input",{type:"text",value:_,onChange:e=>B(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.meetingPoint","Treffpunkt")}),(0,T.jsx)("input",{type:"text",value:O,onChange:e=>V(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),p===Pe.EXTERNAL&&(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:d("tours.externalInfo","Externe Tour-Informationen")}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.externalProvider","Externer Anbieter")}),(0,T.jsxs)("select",{value:te,onChange:e=>re(e.target.value?Number(e.target.value):""),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:"",children:d("common.select","Ausw\xe4hlen")}),fe.map((e=>(0,T.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.externalBookingUrl","Externe Buchungs-URL")}),(0,T.jsx)("input",{type:"url",value:ae,onChange:e=>se(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:d("tours.commissions","Kommissionen")}),(0,T.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.totalCommission","Gesamtkommission")}),(0,T.jsx)("input",{type:"number",value:H,onChange:e=>J(e.target.value?Number(e.target.value):""),min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.totalCommissionPercent","Gesamtkommission (%)")}),(0,T.jsx)("input",{type:"number",value:Y,onChange:e=>Z(e.target.value?Number(e.target.value):""),min:"0",max:"100",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.sellerCommissionPercent","Verk\xe4ufer-Kommission (%)")}),(0,T.jsx)("input",{type:"number",value:X,onChange:e=>$(e.target.value?Number(e.target.value):""),min:"0",max:"100",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.sellerCommissionFixed","Verk\xe4ufer-Kommission (Fix)")}),(0,T.jsx)("input",{type:"number",value:Q,onChange:e=>ee(e.target.value?Number(e.target.value):""),min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]})]})]}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:d("tours.additionalInfo","Zus\xe4tzliche Informationen")}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.includes","Enth\xe4lt")}),(0,T.jsx)("textarea",{value:U,onChange:e=>M(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.excludes","Nicht enthalten")}),(0,T.jsx)("textarea",{value:q,onChange:e=>G(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.requirements","Anforderungen")}),(0,T.jsx)("textarea",{value:W,onChange:e=>K(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:d("tours.images","Bilder")}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.mainImage","Hauptbild")}),(0,T.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){oe(r);const e=new FileReader;e.onloadend=()=>{ce(e.result)},e.readAsDataURL(r)}},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),de&&(0,T.jsx)("div",{className:"mt-2",children:(0,T.jsx)("img",{src:de,alt:"Vorschau",className:"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600"})})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("tours.gallery","Galerie")}),(0,T.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>{const t=Array.from(e.target.files||[]);t.length>0&&(ue((e=>[...e,...t])),t.forEach((e=>{const t=new FileReader;t.onloadend=()=>{xe((e=>[...e,t.result]))},t.readAsDataURL(e)})))},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),ge.length>0&&(0,T.jsx)("div",{className:"mt-2 grid grid-cols-3 gap-2",children:ge.map(((e,t)=>(0,T.jsxs)("div",{className:"relative",children:[(0,T.jsx)("img",{src:e,alt:"Galerie ".concat(t+1),className:"w-full h-32 object-cover rounded-md border border-gray-300 dark:border-gray-600"}),(0,T.jsx)("button",{type:"button",onClick:()=>(async e=>{const t=o.galleryUrls||[];if(e<t.length)try{await w.A.delete(N.Sn.TOURS.DELETE_GALLERY_IMAGE(o.id,e));const t=await w.A.get(N.Sn.TOURS.BY_ID(o.id));t.data.success&&i(t.data.data)}catch(s){var r,a;console.error("Fehler beim L\xf6schen des Galerie-Bildes:",s),m((null===(r=s.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||d("errors.deleteError"),"error")}else{const r=e-t.length;ue((e=>e.filter(((e,t)=>t!==r)))),xe((t=>t.filter(((t,r)=>r!==e))))}})(t),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:(0,T.jsx)(y.A,{className:"h-4 w-4"})})]},t)))})]})]}),(0,T.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,T.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",children:d("common.cancel","Abbrechen")}),(0,T.jsx)("button",{type:"submit",disabled:we||Ae||be,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:we?d("common.saving","Speichere..."):d("common.save","Speichern")})]})]})]})})]}):null};var Le=r(5590),De=r(9837),Re=r(887),Te=r(7539);const Fe=e=>{let{isOpen:t,onClose:r,tourId:n,onTourUpdated:o}=e;const{t:c}=(0,s.Bd)(),{showMessage:m}=(0,v.A)(),{hasPermission:g}=(0,l.S)(),[b,h]=(0,a.useState)(null),[f,k]=(0,a.useState)(!1),[j,A]=(0,a.useState)(null),[S,C]=(0,a.useState)(!1);(0,a.useEffect)((()=>{t&&n&&E()}),[t,n]);const E=async()=>{try{k(!0),A(null);const e=await w.A.get(N.Sn.TOURS.BY_ID(n));e.data.success?h(e.data.data):A(e.data.message||c("errors.loadError"))}catch(r){var e,t;console.error("Fehler beim Laden der Tour:",r);const a=(null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||c("errors.loadError");A(a),m(a,"error")}finally{k(!1)}};return t?(0,T.jsxs)(u.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,T.jsx)(u.lG.Title,{className:"text-xl font-semibold text-gray-900 dark:text-white",children:c("tours.details","Tour-Details")}),(0,T.jsxs)("div",{className:"flex items-center gap-3",children:[g("tour_bookings","write","table")&&b&&b.isActive&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>C(!0),className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":c("tourBookings.create","Buchung erstellen"),children:(0,T.jsx)(x.A,{className:"h-4 w-4"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:c("tourBookings.create","Buchung erstellen")})]}),(0,T.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]})]}),(0,T.jsx)("div",{className:"p-6",children:f?(0,T.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:c("common.loading")}):j?(0,T.jsx)("div",{className:"text-center py-8 text-red-500 dark:text-red-400",children:j}):b?(0,T.jsxs)("div",{className:"space-y-6",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:b.title||"-"}),(0,T.jsxs)("div",{className:"flex items-center gap-2",children:[(0,T.jsx)("span",{className:"px-3 py-1 text-sm rounded-full ".concat(b.type===Pe.OWN?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"),children:b.type===Pe.OWN?c("tours.typeOwn"):c("tours.typeExternal")}),(0,T.jsx)("span",{className:"px-3 py-1 text-sm rounded-full ".concat(b.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"),children:b.isActive?c("tours.statusActive"):c("tours.statusInactive")})]})]}),b.description&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:c("tours.description")}),(0,T.jsx)("p",{className:"text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:b.description})]}),(0,T.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,T.jsxs)("div",{className:"space-y-4",children:[b.duration&&(0,T.jsxs)("div",{className:"flex items-start gap-3",children:[(0,T.jsx)(P.A,{className:"h-5 w-5 text-gray-400 mt-0.5"}),(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.duration")}),(0,T.jsxs)("div",{className:"text-gray-900 dark:text-white",children:[b.duration," ",c("common.hours","h")]})]})]}),(b.minParticipants||b.maxParticipants)&&(0,T.jsxs)("div",{className:"flex items-start gap-3",children:[(0,T.jsx)(Le.A,{className:"h-5 w-5 text-gray-400 mt-0.5"}),(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.participants","Teilnehmer")}),(0,T.jsx)("div",{className:"text-gray-900 dark:text-white",children:b.minParticipants&&b.maxParticipants?"".concat(b.minParticipants," - ").concat(b.maxParticipants):b.minParticipants?"".concat(b.minParticipants,"+"):b.maxParticipants?"bis ".concat(b.maxParticipants):"-"})]})]}),b.price&&(0,T.jsxs)("div",{className:"flex items-start gap-3",children:[(0,T.jsx)(I.A,{className:"h-5 w-5 text-gray-400 mt-0.5"}),(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.price")}),(0,T.jsxs)("div",{className:"text-gray-900 dark:text-white font-semibold",children:[Number(b.price).toLocaleString()," ",b.currency||"COP"]})]})]}),b.location&&(0,T.jsxs)("div",{className:"flex items-start gap-3",children:[(0,T.jsx)(d.A,{className:"h-5 w-5 text-gray-400 mt-0.5"}),(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.location")}),(0,T.jsx)("div",{className:"text-gray-900 dark:text-white",children:b.location})]})]}),b.meetingPoint&&(0,T.jsxs)("div",{className:"flex items-start gap-3",children:[(0,T.jsx)(d.A,{className:"h-5 w-5 text-gray-400 mt-0.5"}),(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.meetingPoint")}),(0,T.jsx)("div",{className:"text-gray-900 dark:text-white",children:b.meetingPoint})]})]})]}),(0,T.jsxs)("div",{className:"space-y-4",children:[b.branch&&(0,T.jsxs)("div",{className:"flex items-start gap-3",children:[(0,T.jsx)(p.A,{className:"h-5 w-5 text-gray-400 mt-0.5"}),(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.branch")}),(0,T.jsx)("div",{className:"text-gray-900 dark:text-white",children:b.branch.name})]})]}),b.createdBy&&(0,T.jsxs)("div",{className:"flex items-start gap-3",children:[(0,T.jsx)(i.A,{className:"h-5 w-5 text-gray-400 mt-0.5"}),(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.columns.createdBy")}),(0,T.jsxs)("div",{className:"text-gray-900 dark:text-white",children:[b.createdBy.firstName," ",b.createdBy.lastName]})]})]}),b.createdAt&&(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("common.createdAt","Erstellt am")}),(0,T.jsx)("div",{className:"text-gray-900 dark:text-white",children:(0,De.GP)(new Date(b.createdAt),"dd.MM.yyyy HH:mm",{locale:Re.de})})]}),b.externalProvider&&(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.externalProvider")}),(0,T.jsx)("div",{className:"text-gray-900 dark:text-white",children:b.externalProvider.name})]}),b.externalBookingUrl&&(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.externalBookingUrl")}),(0,T.jsx)("a",{href:b.externalBookingUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:b.externalBookingUrl})]})]})]}),(b.totalCommission||b.totalCommissionPercent||b.sellerCommissionPercent||b.sellerCommissionFixed)&&(0,T.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[(0,T.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:c("tours.commissions")}),(0,T.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[b.totalCommission&&(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.totalCommission")}),(0,T.jsxs)("div",{className:"text-gray-900 dark:text-white",children:[Number(b.totalCommission).toLocaleString()," ",b.currency||"COP"]})]}),b.totalCommissionPercent&&(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.totalCommissionPercent")}),(0,T.jsxs)("div",{className:"text-gray-900 dark:text-white",children:[Number(b.totalCommissionPercent),"%"]})]}),b.sellerCommissionPercent&&(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.sellerCommissionPercent")}),(0,T.jsxs)("div",{className:"text-gray-900 dark:text-white",children:[Number(b.sellerCommissionPercent),"%"]})]}),b.sellerCommissionFixed&&(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.sellerCommissionFixed")}),(0,T.jsxs)("div",{className:"text-gray-900 dark:text-white",children:[Number(b.sellerCommissionFixed).toLocaleString()," ",b.currency||"COP"]})]})]})]}),(b.includes||b.excludes||b.requirements)&&(0,T.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[(0,T.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:c("tours.additionalInfo")}),(0,T.jsxs)("div",{className:"space-y-4",children:[b.includes&&(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:c("tours.includes")}),(0,T.jsx)("p",{className:"text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:b.includes})]}),b.excludes&&(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:c("tours.excludes")}),(0,T.jsx)("p",{className:"text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:b.excludes})]}),b.requirements&&(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:c("tours.requirements")}),(0,T.jsx)("p",{className:"text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:b.requirements})]})]})]}),(b.availableFrom||b.availableTo)&&(0,T.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[(0,T.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:c("tours.availability","Verf\xfcgbarkeit")}),(0,T.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[b.availableFrom&&(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.availableFrom","Verf\xfcgbar ab")}),(0,T.jsx)("div",{className:"text-gray-900 dark:text-white",children:(0,De.GP)(new Date(b.availableFrom),"dd.MM.yyyy",{locale:Re.de})})]}),b.availableTo&&(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("tours.availableTo","Verf\xfcgbar bis")}),(0,T.jsx)("div",{className:"text-gray-900 dark:text-white",children:(0,De.GP)(new Date(b.availableTo),"dd.MM.yyyy",{locale:Re.de})})]})]})]})]}):(0,T.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:c("tours.notFound","Tour nicht gefunden")})}),(0,T.jsx)("div",{className:"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700",children:(0,T.jsx)("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",children:c("common.close","Schlie\xdfen")})})]})}),b&&(0,T.jsx)(Te.A,{isOpen:S,onClose:()=>C(!1),tour:b,onBookingCreated:async e=>{m(c("tourBookings.created",{defaultValue:"Tour-Buchung erfolgreich erstellt"}),"success"),C(!1)}})]}):null},Ie=e=>{let{isOpen:t,onClose:r,tourCount:l}=e;const{t:n}=(0,s.Bd)(),{showMessage:i}=(0,v.A)(),[o,d]=(0,a.useState)(["id","title","description","type","price","currency","duration","maxParticipants","minParticipants","location","meetingPoint","imageUrl","galleryUrls","availableFrom","availableTo"]),[c,m]=(0,a.useState)(!1),[g,x]=(0,a.useState)("json"),b=[{id:"id",label:n("tours.columns.title","Titel")},{id:"title",label:n("tours.name","Titel")},{id:"description",label:n("tours.description","Beschreibung")},{id:"type",label:n("tours.type","Typ")},{id:"price",label:n("tours.price","Preis")},{id:"currency",label:n("tours.currency","W\xe4hrung")},{id:"duration",label:n("tours.duration","Dauer")},{id:"maxParticipants",label:n("tours.maxParticipants","Max. Teilnehmer")},{id:"minParticipants",label:n("tours.minParticipants","Min. Teilnehmer")},{id:"location",label:n("tours.location","Ort")},{id:"meetingPoint",label:n("tours.meetingPoint","Treffpunkt")},{id:"includes",label:n("tours.includes","Enth\xe4lt")},{id:"excludes",label:n("tours.excludes","Nicht enthalten")},{id:"requirements",label:n("tours.requirements","Anforderungen")},{id:"imageUrl",label:n("tours.mainImage","Hauptbild")},{id:"galleryUrls",label:n("tours.gallery","Galerie")},{id:"availableFrom",label:n("tours.availableFrom","Verf\xfcgbar ab")},{id:"availableTo",label:n("tours.availableTo","Verf\xfcgbar bis")},{id:"externalBookingUrl",label:n("tours.externalBookingUrl","Externe Buchungs-URL")},{id:"branch",label:n("tours.branch","Niederlassung")},{id:"externalProvider",label:n("tours.externalProvider","Externer Anbieter")}];return t?(0,T.jsxs)(u.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,T.jsxs)(u.lG.Title,{className:"text-xl font-semibold text-gray-900 dark:text-white",children:[n("tours.export.title","Touren exportieren")," (",l,")"]}),(0,T.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("div",{className:"p-6 space-y-6",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:n("tours.export.format","Export-Format")}),(0,T.jsxs)("div",{className:"flex gap-4",children:[(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"radio",value:"json",checked:"json"===g,onChange:e=>x(e.target.value),className:"mr-2"}),"JSON"]}),(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"radio",value:"csv",checked:"csv"===g,onChange:e=>x(e.target.value),className:"mr-2"}),"CSV"]})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:n("tours.export.selectFields","Felder ausw\xe4hlen")}),(0,T.jsxs)("div",{className:"flex gap-2",children:[(0,T.jsx)("button",{type:"button",onClick:()=>{d(b.map((e=>e.id)))},className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:n("common.selectAll","Alle ausw\xe4hlen")}),(0,T.jsx)("span",{className:"text-gray-400",children:"|"}),(0,T.jsx)("button",{type:"button",onClick:()=>{d([])},className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:n("common.deselectAll","Alle abw\xe4hlen")})]})]}),(0,T.jsx)("div",{className:"border border-gray-300 dark:border-gray-600 rounded-md p-4 max-h-96 overflow-y-auto",children:(0,T.jsx)("div",{className:"grid grid-cols-2 gap-2",children:b.map((e=>(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"checkbox",checked:o.includes(e.id),onChange:()=>{return t=e.id,void d((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t]));var t},className:"mr-2 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,T.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.label})]},e.id)))})})]})]}),(0,T.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700",children:[(0,T.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",children:n("common.cancel","Abbrechen")}),(0,T.jsxs)("button",{type:"button",onClick:async()=>{if(0!==o.length){m(!0);try{const e=o.join(","),t=await w.A.get(N.Sn.TOURS.EXPORT,{params:{fields:e}}),a=t.data.tours||t.data;if("json"===g){const e=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="tours-export-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(t)}else{if(!Array.isArray(a)||0===a.length)return void i(n("tours.export.noData","Keine Daten zum Exportieren"),"warning");const e=o.map((e=>{const t=b.find((t=>t.id===e));return(null===t||void 0===t?void 0:t.label)||e})),t=a.map((e=>o.map((t=>{let r=e[t];return null===r||void 0===r?"":"object"===typeof r?"branch"===t||"externalProvider"===t?(null===r||void 0===r?void 0:r.name)||"":"galleryUrls"===t&&Array.isArray(r)?r.join("; "):JSON.stringify(r):"boolean"===typeof r?r?"Ja":"Nein":String(r)})))),r=[e.join(","),...t.map((e=>e.map((e=>'"'.concat(String(e).replace(/"/g,'""'),'"'))).join(",")))].join("\n"),s=new Blob([r],{type:"text/csv;charset=utf-8;"}),l=window.URL.createObjectURL(s),d=document.createElement("a");d.href=l,d.download="tours-export-".concat((new Date).toISOString().split("T")[0],".csv"),document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(l)}i(n("tours.export.success","Export erfolgreich"),"success"),r()}catch(a){var e,t;console.error("Fehler beim Exportieren:",a),i((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||n("tours.export.error","Fehler beim Exportieren"),"error")}finally{m(!1)}}else i(n("tours.export.noFieldsSelected","Bitte w\xe4hlen Sie mindestens ein Feld aus"),"error")},disabled:c||0===o.length,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,T.jsx)(z.A,{className:"h-4 w-4"}),c?n("common.exporting","Exportiere..."):n("common.export","Exportieren")]})]})]})})]}):null};var _e=r(6400);const Be="worktracker-tours",Oe=["title","type","price","location","duration","branch","isActive","actions"],Ve={title:"asc",type:"asc",price:"asc",location:"asc",duration:"asc",branch:"asc",createdBy:"asc",isActive:"asc"},Ue={title:"title",type:"type",price:"price",location:"location",duration:"duration",branch:"branch",createdBy:"createdBy",isActive:"isActive"},Me=e=>{let{onError:t}=e;const{t:r}=(0,s.Bd)(),{hasPermission:n}=(0,l.S)(),{showMessage:i}=(0,v.A)(),[o,d]=(0,a.useState)([]),[c,u]=(0,a.useState)(!1),[g,b]=(0,a.useState)(null),[h,p]=(0,a.useState)(""),[y,f]=(0,a.useState)([]),[k,j]=(0,a.useState)([]),[A,S]=(0,a.useState)([]),[P,E]=(0,a.useState)(r("tours.filters.current","Aktuell")),[L,D]=(0,a.useState)(null),[R,F]=(0,a.useState)(!1),[I,_]=(0,a.useState)(!1),[B,O]=(0,a.useState)(!1),[V,U]=(0,a.useState)(!1),[M,q]=(0,a.useState)(null),[G,W]=(0,a.useState)(null),[K,H]=(0,a.useState)(10),[J,Y]=(0,a.useState)(null),[Z,ee]=(0,a.useState)(null),[te,re]=(0,a.useState)(!1),{settings:ae,isLoading:se,updateColumnOrder:le,updateHiddenColumns:ne,toggleColumnVisibility:ie,isColumnVisible:oe,updateViewMode:de}=(0,Se.F)(Be,{defaultColumnOrder:Oe,defaultHiddenColumns:[],defaultViewMode:"cards"}),ce=(0,a.useMemo)((()=>[{id:"title",label:r("tours.columns.title","Titel"),shortLabel:r("tours.columns.title","Titel").substring(0,4)},{id:"type",label:r("tours.columns.type","Typ"),shortLabel:r("tours.columns.type","Typ").substring(0,3)},{id:"price",label:r("tours.columns.price","Preis"),shortLabel:r("tours.columns.price","Preis").substring(0,3)},{id:"location",label:r("tours.columns.location","Ort"),shortLabel:r("tours.columns.location","Ort").substring(0,3)},{id:"duration",label:r("tours.columns.duration","Dauer"),shortLabel:r("tours.columns.duration","Dauer").substring(0,3)},{id:"branch",label:r("tours.columns.branch","Niederlassung"),shortLabel:r("tours.columns.branch","Niederlassung").substring(0,5)},{id:"createdBy",label:r("tours.columns.createdBy","Erstellt von"),shortLabel:r("tours.columns.createdBy","Erstellt von").substring(0,5)},{id:"isActive",label:r("tours.columns.status","Status"),shortLabel:r("tours.columns.status","Status").substring(0,3)},{id:"actions",label:r("tours.columns.actions","Aktionen"),shortLabel:r("common.actions").substring(0,3)}]),[r]),me=(0,a.useMemo)((()=>[{id:"description",label:r("tours.columns.description","Beschreibung"),shortLabel:r("tours.columns.description","Beschreibung").substring(0,3)},{id:"maxParticipants",label:r("tours.columns.maxParticipants","Max. Teilnehmer"),shortLabel:r("tours.columns.maxParticipants","Max. Teilnehmer").substring(0,3)},{id:"minParticipants",label:r("tours.columns.minParticipants","Min. Teilnehmer"),shortLabel:r("tours.columns.minParticipants","Min. Teilnehmer").substring(0,3)}]),[r]),[ue,ge]=(0,a.useState)({key:"title",direction:"asc"}),[xe,be]=(0,a.useState)((()=>Ve)),he=(null===ae||void 0===ae?void 0:ae.viewMode)||"cards",pe=(0,a.useMemo)((()=>(e=>{const t=[];return e.forEach((e=>{const r=Ue[e]||[];r&&"string"===typeof r&&t.push(r)})),t})((null===ae||void 0===ae?void 0:ae.columnOrder)||Oe)),[null===ae||void 0===ae?void 0:ae.columnOrder]),ye=(0,a.useMemo)((()=>(e=>{const t=new Set;return e.forEach((e=>{const r=Ue[e];r&&t.add(r)})),t})((null===ae||void 0===ae?void 0:ae.hiddenColumns)||[])),[null===ae||void 0===ae?void 0:ae.hiddenColumns]),fe=(0,a.useMemo)((()=>new Set(pe.filter((e=>!ye.has(e))))),[pe,ye]),ve=(0,a.useCallback)((async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{a||(u(!0),b(null));const s={};e?s.filterId=e:t&&t.length>0&&(s.filterConditions=JSON.stringify({conditions:t,operators:k}));const l=await w.A.get(N.Sn.TOURS.BASE,{params:s});if(l.data.success){const e=l.data.data||[],t=Array.isArray(e)?e.filter((e=>null!=e&&"object"===typeof e&&null!=e.title&&"string"===typeof e.title)):[];a||d(t)}else{const e=l.data.message||r("errors.loadError");a||(b(e),i(e,"error"))}}catch(n){var s,l;console.error("Fehler beim Laden der Touren:",n);const e=(null===(s=n.response)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.message)||r("errors.loadError");a||(b(e),i(e,"error"))}finally{a||u(!1)}}),[k,r,i]);(0,a.useEffect)((()=>()=>{d([]),f([])}),[]),(0,a.useEffect)((()=>{n("tours","read","table")&&ve()}),[ve,n]);const ke=(e,t,r)=>{f(e),j(t),S(r),ve(void 0,e,!1)},Le=()=>{f([]),j([]),S([]),E(r("tours.filters.current","Aktuell")),D(null),ve()},De=()=>{Y(null),ee(null)},Re=(0,a.useMemo)((()=>{const e=((null===ae||void 0===ae?void 0:ae.columnOrder)||[]).filter((e=>null!=e&&"string"===typeof e)),t=Oe.filter((t=>!e.includes(t)));return[...e,...t]}),[null===ae||void 0===ae?void 0:ae.columnOrder]).filter((e=>null!=e&&"string"===typeof e&&oe(e))),Te=()=>y.length,Me=(0,a.useMemo)((()=>{if(!Array.isArray(o))return[];let e=o.filter((e=>null!=e&&null!=e.title&&"string"===typeof e.title)).filter((e=>{if(h){const t=h.toLowerCase();if(!(e.title&&e.title.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)||e.location&&e.location.toLowerCase().includes(t)))return!1}return!0}));if(y.length>0){const t={title:(e,t)=>{if(!e||!e.title)return!1;const r=(t.value||"").toLowerCase(),a=(e.title||"").toLowerCase();return"equals"===t.operator?e.title===t.value:"contains"===t.operator?a.includes(r):"startsWith"===t.operator?a.startsWith(r):"endsWith"===t.operator?a.endsWith(r):null},type:(e,t)=>!(!e||!e.type)&&("equals"===t.operator?e.type===t.value:"notEquals"===t.operator?e.type!==t.value:null),isActive:(e,t)=>{const r="true"===t.value||!0===t.value||"1"===t.value;return"equals"===t.operator?e.isActive===r:"notEquals"===t.operator?e.isActive!==r:null},price:(e,t)=>{const r="string"===typeof e.price?parseFloat(e.price):e.price||0,a="string"===typeof t.value?parseFloat(t.value):t.value||0;return!isNaN(r)&&!isNaN(a)&&("equals"===t.operator?Math.abs(r-a)<.01:"greaterThan"===t.operator?r>a:"lessThan"===t.operator?r<a:null)},location:(e,t)=>{const r=(t.value||"").toLowerCase(),a=(e.location||"").toLowerCase();return"equals"===t.operator?e.location===t.value:"contains"===t.operator?a.includes(r):"startsWith"===t.operator?a.startsWith(r):"endsWith"===t.operator?a.endsWith(r):null},branch:(e,t)=>{var r;const a=((null===(r=e.branch)||void 0===r?void 0:r.name)||"").toLowerCase(),s=(t.value||"").toLowerCase();return"equals"===t.operator?a===s:"contains"===t.operator?a.includes(s):null},createdBy:(e,t)=>{const r=e.createdBy?"".concat(e.createdBy.firstName," ").concat(e.createdBy.lastName):"";return(0,_e.Ac)(e.createdById||null,null,t,r)}},r=(e,t)=>{var r;if(!e)return"";switch(t){case"title":return e.title||"";case"type":return e.type||"";case"price":return"string"===typeof e.price?parseFloat(e.price):e.price||0;case"location":return e.location||"";case"duration":return e.duration||0;case"branch":return(null===(r=e.branch)||void 0===r?void 0:r.name)||"";case"createdBy":return e.createdBy?"".concat(e.createdBy.firstName," ").concat(e.createdBy.lastName):"";case"isActive":return e.isActive;default:return""}};e=(0,_e.W5)(e,y,k,r,t)}const t=(e,t)=>{var r;if(!e)return"";switch(t){case"title":return(e.title||"").toLowerCase();case"type":return(e.type||"").toLowerCase();case"price":return"string"===typeof e.price?parseFloat(e.price):e.price||0;case"location":return(e.location||"").toLowerCase();case"duration":return e.duration||0;case"branch":return((null===(r=e.branch)||void 0===r?void 0:r.name)||"").toLowerCase();case"createdBy":return e.createdBy?"".concat(e.createdBy.firstName," ").concat(e.createdBy.lastName).toLowerCase():"";case"isActive":return e.isActive?1:0;default:return""}};return e.sort(((e,r)=>{if(!e||!r){if(!e&&!r)return 0;if(!e)return 1;if(!r)return-1}if(A.length>0){for(const a of A.sort(((e,t)=>e.priority-t.priority))){const s=t(e,a.column),l=t(r,a.column);let n=0;if(n="number"===typeof s&&"number"===typeof l?s-l:String(s).localeCompare(String(l)),"desc"===a.direction&&(n=-n),0!==n)return n}return 0}if("table"===he&&ue.key){const a=t(e,ue.key),s=t(r,ue.key);let l=0;if(l="number"===typeof a&&"number"===typeof s?a-s:String(a).localeCompare(String(s)),0!==l)return"asc"===ue.direction?l:-l}if("cards"===he&&0===y.length){const a=["title","type","price","location","duration","branch","createdBy","isActive"];for(const s of a){const a=xe[s]||"asc",l=t(e,s),n=t(r,s);let i=0;if(i="number"===typeof l&&"number"===typeof n?l-n:String(l).localeCompare(String(n)),"desc"===a&&(i=-i),0!==i)return i}return 0}const a=((null===e||void 0===e?void 0:e.title)||"").toLowerCase(),s=((null===r||void 0===r?void 0:r.title)||"").toLowerCase();return a.localeCompare(s)}))}),[o,h,y,k,A,he,ue,xe]);return(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,T.jsx)("div",{className:"flex-1 w-full sm:max-w-md",children:(0,T.jsx)("input",{type:"text",placeholder:r("common.search")+"...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:h,onChange:e=>p(e.target.value)})}),(0,T.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("cards"===he?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""),onClick:()=>de("table"===he?"cards":"table"),children:"table"===he?(0,T.jsx)(je.A,{className:"h-5 w-5"}):(0,T.jsx)(we.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("table"===he?"common.viewAsCards":"common.viewAsTable")})]}),(0,T.jsxs)("div",{className:"relative group ml-1",children:[(0,T.jsxs)("button",{className:"p-2 rounded-md ".concat(Te()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"," relative"),onClick:()=>re(!te),children:[(0,T.jsx)(X.A,{className:"h-5 w-5"}),Te()>0&&(0,T.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center",children:Te()})]}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.filter")})]}),n("tour_edit","write","button")&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>U(!0),className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,T.jsx)(z.A,{className:"h-5 w-5"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("tours.export","Exportieren")})]}),(0,T.jsx)("div",{className:"ml-1",children:(0,T.jsx)(Ce.A,{columns:"cards"===he?[{id:"title",label:r("tours.columns.title","Titel")},{id:"type",label:r("tours.columns.type","Typ")},{id:"price",label:r("tours.columns.price","Preis")},{id:"location",label:r("tours.columns.location","Ort")},{id:"duration",label:r("tours.columns.duration","Dauer")},{id:"branch",label:r("tours.columns.branch","Niederlassung")},{id:"createdBy",label:r("tours.columns.createdBy","Erstellt von")},{id:"isActive",label:r("tours.columns.status","Status")}]:ce,visibleColumns:"cards"===he?Array.from(fe):Re,columnOrder:"cards"===he?pe:ae.columnOrder,onToggleColumnVisibility:e=>{if("cards"===he){const t=Ue[e];t&&ie(t)}else ie(e)},onColumnOrderChange:e=>{if("cards"===he){const t=e.map((e=>Ue[e]||e)).filter(Boolean);le(t)}else le(e)},modalTitle:r("cards"===he?"tableColumn.sortAndDisplay":"tableColumn.configure"),sortDirections:"cards"===he?xe:void 0,onSortDirectionChange:"cards"===he?(e,t)=>{be((r=>(0,m.A)((0,m.A)({},r),{},{[e]:t})))}:void 0,showSortDirection:"cards"===he,onClose:()=>{}})}),n("tour_create","write","button")&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:()=>F(!0),className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":r("tours.create","Neue Tour erstellen"),children:(0,T.jsx)(x.A,{className:"h-4 w-4"})}),(0,T.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("tours.create","Neue Tour erstellen")})]})]})]}),te&&(0,T.jsx)("div",{className:"px-3 sm:px-4 md:px-6",children:(0,T.jsx)($.A,{columns:[...ce,...me],onApply:ke,onReset:Le,savedConditions:y,savedOperators:k,savedSortDirections:A,onSortDirectionsChange:S,tableId:Be})}),(0,T.jsx)(Q.A,{tableId:Be,onSelectFilter:ke,onReset:Le,activeFilterName:P,selectedFilterId:L,onFilterChange:(e,t)=>{D(e),E(t),e?ve(e):Le()},defaultFilterName:r("tours.filters.current","Aktuell")}),"table"===he&&(0,T.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,T.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,T.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,T.jsx)("tr",{children:Re.map((e=>{const t=ce.find((t=>t.id===e));return t?(0,T.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider ".concat(e===Z?"bg-blue-100 dark:bg-blue-800":""),draggable:!0,onDragStart:()=>(e=>{Y(e)})(e),onDragOver:t=>((e,t)=>{e.preventDefault(),J&&J!==t&&ee(t)})(t,e),onDrop:t=>((e,t)=>{if(e.preventDefault(),J&&J!==t){const e=(null===ae||void 0===ae?void 0:ae.columnOrder)||Oe,r=e.indexOf(J),a=e.indexOf(t);if(r>-1&&a>-1){const t=[...e],s=t[r];t.splice(r,1),t.splice(a,0,s),le(t)}}Y(null),ee(null)})(t,e),onDragEnd:De,children:(0,T.jsxs)("div",{className:"flex items-center",children:[window.innerWidth<=640?t.shortLabel:t.label,"actions"!==e&&(0,T.jsx)("button",{onClick:()=>{return t=e,void("table"===he&&ge((e=>({key:t,direction:e.key===t&&"asc"===e.direction?"desc":"asc"}))));var t},className:"ml-1 focus:outline-none",children:(0,T.jsx)(Ne.A,{className:"h-4 w-4 text-gray-400 dark:text-gray-500"})})]})},e):null}))})}),(0,T.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:c?(0,T.jsx)("tr",{children:(0,T.jsx)("td",{colSpan:Re.length,className:"px-3 sm:px-4 md:px-6 py-8 text-center text-gray-500 dark:text-gray-400",children:r("common.loading")})}):g?(0,T.jsx)("tr",{children:(0,T.jsx)("td",{colSpan:Re.length,className:"px-3 sm:px-4 md:px-6 py-8 text-center text-red-500 dark:text-red-400",children:g})}):0===Me.length?(0,T.jsx)("tr",{children:(0,T.jsx)("td",{colSpan:Re.length,className:"px-3 sm:px-4 md:px-6 py-8 text-center text-gray-500 dark:text-gray-400",children:r("tours.noTours")})}):(0,T.jsx)(T.Fragment,{children:Me.slice(0,K).filter((e=>null!=e&&null!=e.title)).map((e=>(0,T.jsx)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:Re.map((t=>{var a;switch(t){case"title":return(0,T.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4",children:(0,T.jsx)("div",{className:"text-sm text-gray-900 dark:text-gray-200 break-words",children:(null===e||void 0===e?void 0:e.title)||"-"})},t);case"type":return(0,T.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,T.jsx)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:e.type===Pe.OWN?r("tours.typeOwn"):r("tours.typeExternal")})},t);case"price":return(0,T.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,T.jsx)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:e.price?"".concat(Number(e.price).toLocaleString()," ").concat(e.currency||"COP"):"-"})},t);case"location":return(0,T.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,T.jsx)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:e.location||"-"})},t);case"duration":return(0,T.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,T.jsx)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:e.duration?"".concat(e.duration," ").concat(r("common.hours","h")):"-"})},t);case"branch":return(0,T.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,T.jsx)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:(null===(a=e.branch)||void 0===a?void 0:a.name)||"-"})},t);case"createdBy":return(0,T.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,T.jsx)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:e.createdBy?"".concat(e.createdBy.firstName," ").concat(e.createdBy.lastName):"-"})},t);case"isActive":return(0,T.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:n("tour_edit","write","button")?(0,T.jsx)("button",{onClick:async t=>{t.stopPropagation();try{await w.A.put(N.Sn.TOURS.TOGGLE_ACTIVE(e.id)),i(e.isActive?r("tours.deactivated",{defaultValue:"Tour deaktiviert"}):r("tours.activated",{defaultValue:"Tour aktiviert"}),"success"),await ve()}catch(l){var a,s;console.error("Fehler beim Toggle der Tour:",l),i((null===(a=l.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||r("errors.unknownError"),"error")}},className:"px-2 py-1 text-xs rounded transition-colors ".concat(e.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 hover:bg-green-200 dark:hover:bg-green-800":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700"),children:e.isActive?r("tours.statusActive"):r("tours.statusInactive")}):(0,T.jsx)("span",{className:"px-2 py-1 text-xs rounded ".concat(e.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"),children:e.isActive?r("tours.statusActive"):r("tours.statusInactive")})},t);case"actions":return(0,T.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,T.jsxs)("div",{className:"flex space-x-2 action-buttons",children:[(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:t=>{t.stopPropagation(),W(e.id),O(!0)},className:"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(Ae.A,{className:"h-4 w-4"})}),(0,T.jsx)("div",{className:"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.viewDetails","Details anzeigen")})]}),n("tour_edit","write","button")&&(0,T.jsxs)("div",{className:"relative group",children:[(0,T.jsx)("button",{onClick:t=>{t.stopPropagation(),q(e),_(!0)},className:"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:(0,T.jsx)(C.A,{className:"h-4 w-4"})}),(0,T.jsx)("div",{className:"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("tours.edit","Bearbeiten")})]})]})},t);default:return null}}))},e.id)))})})]})}),"cards"===he&&(0,T.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c?(0,T.jsx)("div",{className:"col-span-full text-center py-8 text-gray-500 dark:text-gray-400",children:r("common.loading")}):g?(0,T.jsx)("div",{className:"col-span-full text-center py-8 text-red-500 dark:text-red-400",children:g}):0===Me.length?(0,T.jsx)("div",{className:"col-span-full text-center py-8 text-gray-500 dark:text-gray-400",children:r("tours.noTours")}):Me.slice(0,K).filter((e=>null!=e&&null!=e.title)).map((e=>(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 p-4 hover:shadow-md transition-shadow",children:[(0,T.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,T.jsx)("h4",{className:"text-lg font-semibold dark:text-white",children:(null===e||void 0===e?void 0:e.title)||"-"}),n("tour_edit","write","button")?(0,T.jsx)("button",{onClick:async()=>{try{await w.A.put(N.Sn.TOURS.TOGGLE_ACTIVE(e.id)),i(e.isActive?r("tours.deactivated",{defaultValue:"Tour deaktiviert"}):r("tours.activated",{defaultValue:"Tour aktiviert"}),"success"),await ve()}catch(s){var t,a;console.error("Fehler beim Toggle der Tour:",s),i((null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r("errors.unknownError"),"error")}},className:"px-2 py-1 text-xs rounded transition-colors ".concat(e.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 hover:bg-green-200 dark:hover:bg-green-800":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700"),children:e.isActive?r("tours.statusActive"):r("tours.statusInactive")}):(0,T.jsx)("span",{className:"px-2 py-1 text-xs rounded ".concat(e.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"),children:e.isActive?r("tours.statusActive"):r("tours.statusInactive")})]}),e.description&&(0,T.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2 line-clamp-2",children:e.description}),(0,T.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,T.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[(0,T.jsxs)("span",{className:"font-medium",children:[r("tours.type"),":"]})," ",e.type===Pe.OWN?r("tours.typeOwn"):r("tours.typeExternal")]}),e.price&&(0,T.jsxs)("div",{className:"text-sm font-semibold dark:text-white",children:[Number(e.price).toLocaleString()," ",e.currency||"COP"]})]}),n("tour_edit","write","button")&&(0,T.jsx)("div",{className:"mt-4 flex justify-end",children:(0,T.jsx)("button",{onClick:()=>{q(e),_(!0)},className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 text-sm",children:r("tours.edit","Bearbeiten")})})]},e.id)))}),Me.length>K&&(0,T.jsx)("div",{className:"mt-4 flex justify-center",children:(0,T.jsxs)("button",{className:"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600",onClick:()=>H((e=>e+10)),children:[r("common.showMore")," (",Me.length-K," ",r("common.remaining"),")"]})}),(0,T.jsx)(Ee,{isOpen:R,onClose:()=>F(!1),onTourCreated:async()=>{await ve()}}),M&&(0,T.jsx)(ze,{isOpen:I,onClose:()=>{_(!1),q(null)},onTourUpdated:async()=>{await ve(),_(!1),q(null)},tour:M}),G&&(0,T.jsx)(Fe,{isOpen:B,onClose:()=>{O(!1),W(null)},tourId:G,onTourUpdated:async()=>{await ve()}}),(0,T.jsx)(Ie,{isOpen:V,onClose:()=>U(!1),tourCount:Me.length})]})};var qe=r(7629),Ge=r(8682),We=r(3315),Ke=r(8673),He=r(2395);const Je=e=>{let{isOpen:t,onClose:r,onSuccess:l}=e;const{t:n}=(0,s.Bd)(),[i,o]=(0,a.useState)({name:"",displayName:"",domain:""}),[d,c]=(0,a.useState)(!1),[g,x]=(0,a.useState)({}),[b,h]=(0,a.useState)(window.innerWidth<640),[p,k]=(0,a.useState)(window.innerWidth>1070),{openSidepane:j,closeSidepane:w}=(0,R.N)(),{showMessage:N}=(0,v.A)(),{fetchCurrentUser:A}=(0,D.As)();(0,a.useEffect)((()=>{const e=()=>{h(window.innerWidth<640),k(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,a.useEffect)((()=>(t?j():w(),()=>{w()})),[t,j,w]);const S=e=>{const{name:t,value:r}=e.target;o((e=>(0,m.A)((0,m.A)({},e),{},{[t]:r}))),g[t]&&x((e=>(0,m.A)((0,m.A)({},e),{},{[t]:""})))},C=async e=>{if(e.preventDefault(),(()=>{const e={};return i.name.trim()||(e.name=n("organization.create.nameRequired")),i.displayName.trim()||(e.displayName=n("organization.create.displayNameRequired")),x(e),0===Object.keys(e).length})())try{c(!0),await Ke.h.createOrganization(i),x({}),N(n("organization.create.createSuccess"),"success"),await A(),o({name:"",displayName:"",domain:""}),r(),l&&l()}catch(s){var t,a;const e=(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||n("organization.create.createError");N(e,"error"),x({submit:e})}finally{c(!1)}else N(n("joinRequest.fillRequired"),"error")},P=()=>{o({name:"",displayName:"",domain:""}),x({}),r()};return b?(0,T.jsxs)(u.lG,{open:t,onClose:P,className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,T.jsx)(u.lG.Title,{className:"text-lg font-semibold dark:text-white",children:n("organization.create.title")}),(0,T.jsx)("button",{onClick:P,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("form",{onSubmit:C,className:"p-4",children:[g.submit&&(0,T.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:g.submit}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.create.name")}),(0,T.jsx)("input",{type:"text",id:"name",name:"name",value:i.name,onChange:S,className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(g.name?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),g.name&&(0,T.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:g.name})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.create.displayName")}),(0,T.jsx)("input",{type:"text",id:"displayName",name:"displayName",value:i.displayName,onChange:S,className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(g.displayName?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),g.displayName&&(0,T.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:g.displayName})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"domain",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.create.domain")}),(0,T.jsx)("input",{type:"text",id:"domain",name:"domain",value:i.domain,onChange:S,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]}),(0,T.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,T.jsx)("button",{type:"button",onClick:P,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:n("joinRequest.cancel"),children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"submit",disabled:d,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:n(d?"organization.create.creating":"organization.create.createButton"),children:d?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})]})]})]})})]}):(0,T.jsxs)(T.Fragment,{children:[t&&!p&&(0,T.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:P,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,T.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,T.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:n("organization.create.title")}),(0,T.jsx)("button",{onClick:P,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[g.submit&&(0,T.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:g.submit}),(0,T.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.create.name")}),(0,T.jsx)("input",{type:"text",id:"name",name:"name",value:i.name,onChange:S,className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(g.name?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),g.name&&(0,T.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:g.name})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.create.displayName")}),(0,T.jsx)("input",{type:"text",id:"displayName",name:"displayName",value:i.displayName,onChange:S,className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(g.displayName?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),g.displayName&&(0,T.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:g.displayName})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"domain",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.create.domain")}),(0,T.jsx)("input",{type:"text",id:"domain",name:"domain",value:i.domain,onChange:S,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,T.jsx)("button",{type:"button",onClick:P,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:n("common.cancel"),children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"submit",disabled:d,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:n(d?"organization.create.creating":"organization.create.createButton"),children:d?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})]})]})]})]})]})},Ye=e=>{let{isOpen:t,onClose:r,onSuccess:l}=e;const{t:n}=(0,s.Bd)(),[i,o]=(0,a.useState)({organizationName:"",message:""}),[d,c]=(0,a.useState)(!1),[g,x]=(0,a.useState)(!1),[b,h]=(0,a.useState)({}),[p,k]=(0,a.useState)(window.innerWidth<640),[j,w]=(0,a.useState)(window.innerWidth>1070),{openSidepane:N,closeSidepane:A}=(0,R.N)(),[S,C]=(0,a.useState)([]),[P,E]=(0,a.useState)(!1),[z,D]=(0,a.useState)(null),F=(0,a.useRef)(null),I=(0,a.useRef)(null),{showMessage:_}=(0,v.A)();(0,a.useEffect)((()=>{const e=()=>{k(window.innerWidth<640),w(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,a.useEffect)((()=>(t?N():A(),()=>{A()})),[t,N,A]),(0,a.useEffect)((()=>{const e=e=>{I.current&&!I.current.contains(e.target)&&E(!1)};return P&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[P]);const B=e=>{const t=e.target.value;o((e=>(0,m.A)((0,m.A)({},e),{},{organizationName:t}))),D(null),b.organizationName&&h((e=>(0,m.A)((0,m.A)({},e),{},{organizationName:""}))),F.current&&clearTimeout(F.current),F.current=setTimeout((()=>{(async e=>{if(e.length<2)return C([]),void E(!1);try{x(!0);const t=await Ke.h.searchOrganizations(e);C(t),E(!0)}catch(t){console.error("Fehler bei der Organisationen-Suche:",t),C([])}finally{x(!1)}})(t)}),300)},O=e=>{D(e),o((t=>(0,m.A)((0,m.A)({},t),{},{organizationName:e.name}))),E(!1),C([])},V=e=>{o((t=>(0,m.A)((0,m.A)({},t),{},{message:e.target.value}))),b.message&&h((e=>(0,m.A)((0,m.A)({},e),{},{message:""})))},U=async e=>{if(e.preventDefault(),(()=>{const e={};return i.organizationName.trim()?z||(e.organizationName=n("organization.join.selectFromList")):e.organizationName=n("organization.join.nameRequired"),h(e),0===Object.keys(e).length})())try{c(!0),await Ke.h.createJoinRequest(i),h({}),_(n("organization.join.sendSuccess"),"success"),o({organizationName:"",message:""}),D(null),C([]),r(),l&&l()}catch(s){var t,a;const e=(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||n("organization.join.sendError");_(e,"error"),h({submit:e})}finally{c(!1)}else _(n("joinRequest.fillRequired"),"error")},M=()=>{o({organizationName:"",message:""}),D(null),C([]),h({}),E(!1),F.current&&clearTimeout(F.current),r()};return p?(0,T.jsxs)(u.lG,{open:t,onClose:M,className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,T.jsx)(u.lG.Title,{className:"text-lg font-semibold dark:text-white",children:n("organization.join.title")}),(0,T.jsx)("button",{onClick:M,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("form",{onSubmit:U,className:"p-4",children:[b.submit&&(0,T.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:b.submit}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{className:"relative",ref:I,children:[(0,T.jsx)("label",{htmlFor:"organizationName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.join.search")}),(0,T.jsx)("input",{type:"text",id:"organizationName",name:"organizationName",value:i.organizationName,onChange:B,placeholder:n("organization.join.searchPlaceholder"),className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(b.organizationName?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),b.organizationName&&(0,T.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:b.organizationName}),P&&(S.length>0||g)&&(0,T.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto",children:g?(0,T.jsx)("div",{className:"p-3 text-center text-gray-500 dark:text-gray-400",children:n("organization.join.searching")}):S.length>0?S.map((e=>(0,T.jsxs)("button",{type:"button",onClick:()=>O(e),className:"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none",children:[(0,T.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.displayName||e.name}),e.displayName&&(0,T.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.name})]},e.id))):(0,T.jsx)("div",{className:"p-3 text-center text-gray-500 dark:text-gray-400",children:n("organization.join.noOrganizations")})})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.join.message")}),(0,T.jsx)("textarea",{id:"message",name:"message",value:i.message||"",onChange:V,rows:3,placeholder:n("organization.join.messagePlaceholder"),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]}),(0,T.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,T.jsx)("button",{type:"button",onClick:M,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:n("joinRequest.cancel"),children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"submit",disabled:d,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:n(d?"organization.join.sending":"organization.join.send"),children:d?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})]})]})]})})]}):(0,T.jsxs)(T.Fragment,{children:[t&&!j&&(0,T.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:M,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,T.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,T.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:n("organization.join.title")}),(0,T.jsx)("button",{onClick:M,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[b.submit&&(0,T.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:b.submit}),(0,T.jsxs)("form",{onSubmit:U,className:"space-y-4",children:[(0,T.jsxs)("div",{className:"relative",ref:I,children:[(0,T.jsx)("label",{htmlFor:"organizationName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.join.search")}),(0,T.jsx)("input",{type:"text",id:"organizationName",name:"organizationName",value:i.organizationName,onChange:B,placeholder:n("organization.join.searchPlaceholder"),className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(b.organizationName?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),b.organizationName&&(0,T.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:b.organizationName}),P&&(S.length>0||g)&&(0,T.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto",children:g?(0,T.jsx)("div",{className:"p-3 text-center text-gray-500 dark:text-gray-400",children:n("organization.join.searching")}):S.length>0?S.map((e=>(0,T.jsxs)("button",{type:"button",onClick:()=>O(e),className:"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none",children:[(0,T.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.displayName||e.name}),e.displayName&&(0,T.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.name})]},e.id))):(0,T.jsx)("div",{className:"p-3 text-center text-gray-500 dark:text-gray-400",children:n("organization.join.noOrganizations")})})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.join.message")}),(0,T.jsx)("textarea",{id:"message",name:"message",value:i.message||"",onChange:V,rows:3,placeholder:n("organization.join.messagePlaceholder"),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,T.jsx)("button",{type:"button",onClick:M,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:n("common.cancel"),children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"submit",disabled:d,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:n(d?"organization.join.sending":"organization.join.send"),children:d?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})]})]})]})]})]})};var Ze=r(5648);const Xe=e=>{let{organization:t,onSave:r}=e;const{t:l}=(0,s.Bd)(),{showMessage:n}=(0,v.A)(),[i,o]=(0,a.useState)([]),[d,c]=(0,a.useState)({}),[u,x]=(0,a.useState)(!1),[b,h]=(0,a.useState)(!1),[p,y]=(0,a.useState)(!1);(0,a.useEffect)((()=>{t&&(k(),j())}),[t]);const k=async()=>{y(!0);try{const e=await g.Zj.getAll();e.data&&Array.isArray(e.data)&&o(e.data)}catch(e){console.error("Fehler beim Laden der Rollen:",e),n(l("lifecycle.loadRolesError",{defaultValue:"Fehler beim Laden der Rollen"}),"error")}finally{y(!1)}},j=async()=>{x(!0);try{const e=await w.A.get(N.Sn.ORGANIZATION_LIFECYCLE.LIFECYCLE_ROLES);c(e.data.lifecycleRoles||{})}catch(a){var e,t,r;if(console.error("Fehler beim Laden der Lebenszyklus-Rollen:",a),404!==(null===(e=a.response)||void 0===e?void 0:e.status))n((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||l("lifecycle.loadLifecycleRolesError",{defaultValue:"Fehler beim Laden der Konfiguration"}),"error")}finally{x(!1)}};return u&&!d?(0,T.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,T.jsx)(L.A,{className:"h-6 w-6 animate-spin text-gray-400"})}):(0,T.jsx)("div",{className:"space-y-6",children:(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,T.jsx)("h3",{className:"text-lg font-semibold dark:text-white",children:l("organization.lifecycleRoles.title",{defaultValue:"Lebenszyklus-Rollen"})}),(0,T.jsx)("button",{onClick:()=>{const e=i.find((e=>e.name.toLowerCase().includes("admin")||e.name.toLowerCase().includes("administrator"))),t=i.find((e=>e.name.toLowerCase().includes("hr")||e.name.toLowerCase().includes("human"))),r=i.find((e=>"derecho"===e.name.toLowerCase()||e.name.toLowerCase().includes("legal")));c((0,m.A)((0,m.A)({},d),{},{adminRoleId:(null===e||void 0===e?void 0:e.id)||null,hrRoleId:(null===t||void 0===t?void 0:t.id)||null,legalRoleId:(null===r||void 0===r?void 0:r.id)||null})),n(l("lifecycle.standardRolesAssigned",{defaultValue:"Standard-Rollen zugewiesen"}),"success")},className:"px-3 py-1.5 text-sm font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",children:l("lifecycle.assignStandardRoles",{defaultValue:"Standard-Rollen zuweisen"})})]}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.lifecycleRoles.admin",{defaultValue:"Admin-Rolle"})}),(0,T.jsxs)("select",{value:d.adminRoleId||"",onChange:e=>{const t=e.target.value;c((0,m.A)((0,m.A)({},d),{},{adminRoleId:t&&""!==t&&!isNaN(parseInt(t,10))?parseInt(t,10):null}))},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:p,children:[(0,T.jsx)("option",{value:"",children:l("common.pleaseSelect")}),i.map((e=>(0,T.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.lifecycleRoles.hr",{defaultValue:"HR-Rolle"})}),(0,T.jsxs)("select",{value:d.hrRoleId||"",onChange:e=>{const t=e.target.value;c((0,m.A)((0,m.A)({},d),{},{hrRoleId:t&&""!==t&&!isNaN(parseInt(t,10))?parseInt(t,10):null}))},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:p,children:[(0,T.jsx)("option",{value:"",children:l("common.pleaseSelect")}),i.map((e=>(0,T.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.lifecycleRoles.legal",{defaultValue:"Legal-Rolle"})}),(0,T.jsxs)("select",{value:d.legalRoleId||"",onChange:e=>{const t=e.target.value;c((0,m.A)((0,m.A)({},d),{},{legalRoleId:t&&""!==t&&!isNaN(parseInt(t,10))?parseInt(t,10):null}))},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:p,children:[(0,T.jsx)("option",{value:"",children:l("common.pleaseSelect")}),i.map((e=>(0,T.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]}),(0,T.jsx)("div",{className:"mt-6 flex justify-end",children:(0,T.jsx)("button",{onClick:async()=>{h(!0);try{const e=e=>null===e||void 0===e||0===e?null:Number(e);await w.A.put(N.Sn.ORGANIZATION_LIFECYCLE.LIFECYCLE_ROLES,{adminRoleId:e(d.adminRoleId),hrRoleId:e(d.hrRoleId),legalRoleId:e(d.legalRoleId),employeeRoleIds:(d.employeeRoleIds||[]).map(e).filter((e=>null!==e))}),n(l("lifecycle.rolesSaved",{defaultValue:"Rollen-Konfiguration erfolgreich gespeichert"}),"success"),r&&r()}catch(a){var e,t;console.error("Fehler beim Speichern:",a),n((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||l("lifecycle.saveError",{defaultValue:"Fehler beim Speichern"}),"error")}finally{h(!1)}},disabled:b||p,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:b?l("common.saving",{defaultValue:"Speichere..."}):l("common.save",{defaultValue:"Speichern"}),children:b?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})})]})})},$e=e=>{let{organization:t,onUpload:r}=e;const{t:l}=(0,s.Bd)(),{showMessage:n}=(0,v.A)(),[i,o]=(0,a.useState)([]),[d,c]=(0,a.useState)(!1),[m,u]=(0,a.useState)(!1),[g,x]=(0,a.useState)("certificate"),[b,h]=(0,a.useState)(""),[p,y]=(0,a.useState)(""),[f,k]=(0,a.useState)("400"),[j,A]=(0,a.useState)("100"),[S,C]=(0,a.useState)("1"),P=a.useRef(null);(0,a.useEffect)((()=>{t&&E()}),[t]);const E=async()=>{c(!0);try{const e=(await w.A.get(N.Sn.ORGANIZATION_LIFECYCLE.DOCUMENT_SIGNATURES)).data.documentSignatures||{},t=[];e.employmentCertificate&&t.push({type:"certificate",signerName:e.employmentCertificate.signerName,signerPosition:e.employmentCertificate.signerPosition,path:e.employmentCertificate.path,position:e.employmentCertificate.position}),e.employmentContract&&t.push({type:"contract",signerName:e.employmentContract.signerName,signerPosition:e.employmentContract.signerPosition,path:e.employmentContract.path,position:e.employmentContract.position}),o(t)}catch(a){var e,t,r;if(console.error("Fehler beim Laden der Signaturen:",a),404!==(null===(e=a.response)||void 0===e?void 0:e.status))n((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||l("lifecycle.loadSignaturesError",{defaultValue:"Fehler beim Laden der Signaturen"}),"error");o([])}finally{c(!1)}};return d?(0,T.jsx)("div",{className:"flex items-center justify-center py-4",children:(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin text-gray-400"})}):(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-4",children:(0,T.jsxs)("div",{className:"space-y-3",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:l("lifecycle.signatureType",{defaultValue:"Signatur-Typ"})}),(0,T.jsxs)("select",{value:g,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,T.jsx)("option",{value:"certificate",children:l("lifecycle.certificate",{defaultValue:"Arbeitszeugnis"})}),(0,T.jsx)("option",{value:"contract",children:l("lifecycle.contract",{defaultValue:"Arbeitsvertrag"})})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l("lifecycle.signerName",{defaultValue:"Name des Unterzeichners"})," ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsx)("input",{type:"text",value:b,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:l("lifecycle.signerNamePlaceholder",{defaultValue:"z.B. Stefan Bossart"})})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:l("lifecycle.signerPosition",{defaultValue:"Position"})}),(0,T.jsx)("input",{type:"text",value:p,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:l("lifecycle.signerPositionPlaceholder",{defaultValue:"z.B. Gesch\xe4ftsf\xfchrer"})})]}),(0,T.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-3",children:[(0,T.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:l("lifecycle.signaturePosition",{defaultValue:"Signatur-Position im PDF"})}),(0,T.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:l("lifecycle.positionX",{defaultValue:"X (horizontal)"})}),(0,T.jsx)("input",{type:"number",value:f,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",placeholder:"400",min:"0"}),(0,T.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:l("lifecycle.positionXHint",{defaultValue:"0 = links"})})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:l("lifecycle.positionY",{defaultValue:"Y (vertikal)"})}),(0,T.jsx)("input",{type:"number",value:j,onChange:e=>A(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",placeholder:"100",min:"0"}),(0,T.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:l("lifecycle.positionYHint",{defaultValue:"0 = unten"})})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:l("lifecycle.positionPage",{defaultValue:"Seite"})}),(0,T.jsx)("input",{type:"number",value:S,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",placeholder:"1",min:"1"}),(0,T.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:l("lifecycle.positionPageHint",{defaultValue:"Seitennummer"})})]})]}),(0,T.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:l("lifecycle.signaturePositionHint",{defaultValue:"Koordinaten in PDF-Punkten (1 Punkt = 1/72 Zoll). A4: 595 x 842 Punkte. Standard: X=400, Y=100, Seite=1"})})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l("lifecycle.signatureFile",{defaultValue:"Signatur-Datei"})," ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center",children:[(0,T.jsx)("input",{ref:P,type:"file",accept:"image/jpeg,image/png,image/gif,application/pdf",onChange:async e=>{var t;const a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;if(["image/jpeg","image/png","image/gif","application/pdf"].includes(a.type))if(b.trim()){u(!0);try{const e=new FormData;e.append("file",a),e.append("type","certificate"===g?"employmentCertificate":"employmentContract"),e.append("signerName",b),p&&e.append("signerPosition",p),e.append("positionX",f||"400"),e.append("positionY",j||"100"),e.append("page",S||"1");const t=await w.A.post(N.Sn.ORGANIZATION_LIFECYCLE.UPLOAD_SIGNATURE,e,{headers:{"Content-Type":"multipart/form-data"}});n(t.data.message||l("lifecycle.signatureUploaded",{defaultValue:"Signatur erfolgreich hochgeladen"}),"success"),h(""),y(""),k("400"),A("100"),C("1"),E(),r()}catch(o){var s,i;console.error("Fehler beim Hochladen:",o),n((null===(s=o.response)||void 0===s||null===(i=s.data)||void 0===i?void 0:i.message)||l("lifecycle.uploadError",{defaultValue:"Fehler beim Hochladen"}),"error")}finally{u(!1),P.current&&(P.current.value="")}}else n(l("lifecycle.signerNameRequired",{defaultValue:"Name des Unterzeichners ist erforderlich"}),"error");else n(l("lifecycle.onlyImageOrPdfAllowed",{defaultValue:"Nur Bilder (JPEG, PNG, GIF) oder PDF-Dateien sind erlaubt"}),"error")},className:"hidden"}),(0,T.jsx)("button",{onClick:()=>{var e;return null===(e=P.current)||void 0===e?void 0:e.click()},disabled:m||!b.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:m?(0,T.jsxs)("span",{className:"flex items-center space-x-2",children:[(0,T.jsx)(L.A,{className:"h-4 w-4 animate-spin"}),(0,T.jsx)("span",{children:l("common.uploading",{defaultValue:"Lade hoch..."})})]}):l("lifecycle.selectSignatureFile",{defaultValue:"Datei ausw\xe4hlen"})}),(0,T.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:l("lifecycle.signatureFileHint",{defaultValue:"JPEG, PNG, GIF oder PDF (max. 5MB)"})})]})]})]})}),i.length>0&&(0,T.jsxs)("div",{className:"space-y-2",children:[(0,T.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:l("lifecycle.uploadedSignatures",{defaultValue:"Hochgeladene Signaturen"})}),i.map((e=>(0,T.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"font-medium dark:text-white",children:"certificate"===e.type?l("lifecycle.certificate",{defaultValue:"Arbeitszeugnis"}):l("lifecycle.contract",{defaultValue:"Arbeitsvertrag"})}),(0,T.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.signerName,e.signerPosition&&" - ".concat(e.signerPosition)]}),e.position&&(0,T.jsxs)("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:[l("lifecycle.position",{defaultValue:"Position"}),": X=",e.position.x,", Y=",e.position.y,", ",l("lifecycle.page",{defaultValue:"Seite"})," ",e.position.page]})]}),(0,T.jsx)("button",{onClick:()=>(async e=>{if(window.confirm(l("lifecycle.deleteSignatureConfirm",{defaultValue:"Signatur wirklich l\xf6schen?"})))try{const t=(await w.A.get(N.Sn.ORGANIZATIONS.CURRENT)).data.settings||{};if(t.documentSignatures){const r="certificate"===e?"employmentCertificate":"employmentContract";delete t.documentSignatures[r],await w.A.put(N.Sn.ORGANIZATIONS.CURRENT,{settings:t})}n(l("lifecycle.signatureDeleted",{defaultValue:"Signatur erfolgreich gel\xf6scht"}),"success"),E()}catch(a){var t,r;console.error("Fehler beim L\xf6schen:",a),n((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||l("lifecycle.deleteError",{defaultValue:"Fehler beim L\xf6schen"}),"error")}})(e.type),className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900 rounded-md",title:l("common.delete",{defaultValue:"L\xf6schen"}),children:(0,T.jsx)(Y.A,{className:"h-5 w-5"})})]},e.type)))]})]})},Qe=e=>{let{organization:t,onSave:r}=e;const{t:l}=(0,s.Bd)(),{showMessage:n}=(0,v.A)(),[i,o]=(0,a.useState)("certificate"),[d,c]=(0,a.useState)({}),[u,g]=(0,a.useState)(!1),[x,b]=(0,a.useState)(!1),h=["userName","organizationName","currentDate","identificationNumber","startDate","endDate"],p=["userName","organizationName","currentDate","identificationNumber","startDate","endDate","position","salary","workingHours"];(0,a.useEffect)((()=>{t&&y()}),[t,i]);const y=async()=>{try{var e;const r=null===t||void 0===t?void 0:t.settings,a=null===r||void 0===r||null===(e=r.documentTemplates)||void 0===e?void 0:e["certificate"===i?"employmentCertificate":"employmentContract"],s=(null===a||void 0===a?void 0:a.fields)||{},l=50,n=20;let o=841.89-l-30;const d={},m="certificate"===i?h:p,u={userName:{x:l,y:o,fontSize:14},organizationName:{x:l,y:o-n,fontSize:12},currentDate:{x:l,y:o-2*n,fontSize:12},identificationNumber:{x:l,y:o-3*n,fontSize:12},startDate:{x:l,y:o-4*n,fontSize:12},endDate:{x:l,y:o-5*n,fontSize:12}};"contract"===i&&(u.position={x:l,y:o-6*n,fontSize:12},u.salary={x:l,y:o-7*n,fontSize:12},u.workingHours={x:l,y:o-8*n,fontSize:12}),m.forEach((e=>{d[e]=s[e]||u[e]||{x:l,y:o,fontSize:"userName"===e?14:12}})),c(d)}catch(r){console.error("Fehler beim Laden der Felder:",r)}},k=(e,t,r)=>{c((a=>(0,m.A)((0,m.A)({},a),{},{[e]:(0,m.A)((0,m.A)({},a[e]),{},{[t]:"fontSize"===t?parseFloat(r)||12:parseFloat(r)||0})})))},j="certificate"===i?h:p,A={userName:l("lifecycle.fieldUserName",{defaultValue:"Benutzername"}),organizationName:l("lifecycle.fieldOrganizationName",{defaultValue:"Organisationsname"}),currentDate:l("lifecycle.fieldCurrentDate",{defaultValue:"Aktuelles Datum"}),identificationNumber:l("lifecycle.fieldIdentificationNumber",{defaultValue:"Ausweisnummer"}),startDate:l("lifecycle.fieldStartDate",{defaultValue:"Startdatum"}),endDate:l("lifecycle.fieldEndDate",{defaultValue:"Enddatum"}),position:l("lifecycle.fieldPosition",{defaultValue:"Position"}),salary:l("lifecycle.fieldSalary",{defaultValue:"Gehalt"}),workingHours:l("lifecycle.fieldWorkingHours",{defaultValue:"Arbeitsstunden"})};return(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,T.jsx)("h3",{className:"text-lg font-semibold dark:text-white",children:l("organization.fieldPositions",{defaultValue:"Feld-Positionen konfigurieren"})}),(0,T.jsx)("div",{className:"flex items-center space-x-2",children:(0,T.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",children:[(0,T.jsx)("option",{value:"certificate",children:l("lifecycle.certificate",{defaultValue:"Certificado Laboral"})}),(0,T.jsx)("option",{value:"contract",children:l("lifecycle.contract",{defaultValue:"Contrato de Trabajo"})})]})})]}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:[(0,T.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium mb-1",children:l("lifecycle.fieldPositionsInfo",{defaultValue:"Konfigurieren Sie die Positionen der Felder im Template-PDF."})}),(0,T.jsx)("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:l("lifecycle.fieldPositionsHint",{defaultValue:"Koordinaten in PDF-Punkten. A4: 595 x 842 Punkte. Y=0 ist unten, Y=842 ist oben. X=0 ist links, X=595 ist rechts."})})]}),(0,T.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:j.map((e=>{var t,r,a;return(0,T.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-3",children:[(0,T.jsx)("div",{className:"font-medium text-sm dark:text-white mb-2",children:A[e]||e}),(0,T.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"X"}),(0,T.jsx)("input",{type:"number",value:(null===(t=d[e])||void 0===t?void 0:t.x)||0,onChange:t=>k(e,"x",t.target.value),className:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",min:"0"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Y"}),(0,T.jsx)("input",{type:"number",value:(null===(r=d[e])||void 0===r?void 0:r.y)||0,onChange:t=>k(e,"y",t.target.value),className:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",min:"0"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:l("lifecycle.fontSize",{defaultValue:"Schriftgr\xf6\xdfe"})}),(0,T.jsx)("input",{type:"number",value:(null===(a=d[e])||void 0===a?void 0:a.fontSize)||12,onChange:t=>k(e,"fontSize",t.target.value),className:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",min:"8",max:"72"})]})]})]},e)}))}),(0,T.jsxs)("div",{className:"flex items-center justify-end space-x-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[(0,T.jsx)("button",{onClick:async()=>{if(window.confirm(l("lifecycle.resetFieldPositionsConfirm",{defaultValue:"Positionen auf Standardwerte zur\xfccksetzen?"}))){const e=50,t=20;let r=841.89-e-30;const a={userName:{x:e,y:r,fontSize:14},organizationName:{x:e,y:r-t,fontSize:12},currentDate:{x:e,y:r-2*t,fontSize:12},identificationNumber:{x:e,y:r-3*t,fontSize:12},startDate:{x:e,y:r-4*t,fontSize:12},endDate:{x:e,y:r-5*t,fontSize:12}};"contract"===i&&(a.position={x:e,y:r-6*t,fontSize:12},a.salary={x:e,y:r-7*t,fontSize:12},a.workingHours={x:e,y:r-8*t,fontSize:12});const s={};("certificate"===i?h:p).forEach((t=>{s[t]=a[t]||{x:e,y:r,fontSize:"userName"===t?14:12}})),c(s)}},className:"p-2 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 dark:text-white",title:l("common.reset",{defaultValue:"Zur\xfccksetzen"}),children:(0,T.jsx)(L.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{onClick:async()=>{b(!0);try{const e=(await w.A.get(N.Sn.ORGANIZATIONS.CURRENT)).data.settings||{};e.documentTemplates||(e.documentTemplates={});const t="certificate"===i?"employmentCertificate":"employmentContract";e.documentTemplates[t]||(e.documentTemplates[t]={}),e.documentTemplates[t].fields=d,await Ke.h.updateOrganization({settings:e}),n(l("lifecycle.fieldPositionsSaved",{defaultValue:"Feld-Positionen erfolgreich gespeichert"}),"success"),r&&r()}catch(a){var e,t;console.error("Fehler beim Speichern:",a),n((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||l("lifecycle.saveError",{defaultValue:"Fehler beim Speichern"}),"error")}finally{b(!1)}},disabled:x,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-700 dark:hover:bg-blue-800",title:x?l("common.saving",{defaultValue:"Speichern..."}):l("common.save",{defaultValue:"Speichern"}),children:x?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})]})]})]})},et=e=>{let{organization:t,onSave:r}=e;const{t:l}=(0,s.Bd)(),{showMessage:n}=(0,v.A)(),[i,o]=(0,a.useState)([]),[d,c]=(0,a.useState)(!1),[m,u]=(0,a.useState)(!1),[g,b]=(0,a.useState)(!1),[p,y]=(0,a.useState)("certificate"),f=a.useRef(null);(0,a.useEffect)((()=>{t&&k()}),[t]);const k=async()=>{c(!0);try{const e=(await w.A.get(N.Sn.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES)).data.documentTemplates||{},t=[];e.employmentCertificate&&t.push({name:"Arbeitszeugnis",type:"certificate",filePath:e.employmentCertificate.path,version:e.employmentCertificate.version}),e.employmentContract&&t.push({name:"Arbeitsvertrag",type:"contract",filePath:e.employmentContract.path,version:e.employmentContract.version}),o(t)}catch(a){var e,t,r;if(console.error("Fehler beim Laden der Templates:",a),404!==(null===(e=a.response)||void 0===e?void 0:e.status))n((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||l("lifecycle.loadTemplatesError",{defaultValue:"Fehler beim Laden der Templates"}),"error");o([])}finally{c(!1)}};return d?(0,T.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,T.jsx)(L.A,{className:"h-6 w-6 animate-spin text-gray-400"})}):(0,T.jsxs)("div",{className:"space-y-6",children:[(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,T.jsxs)("h3",{className:"text-lg font-semibold flex items-center dark:text-white",children:[(0,T.jsx)(h.A,{className:"h-5 w-5 mr-2"}),l("organization.documentTemplates",{defaultValue:"Dokumenten-Templates"})]}),(0,T.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,T.jsxs)("select",{value:p,onChange:e=>y(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",children:[(0,T.jsx)("option",{value:"certificate",children:"Arbeitszeugnis"}),(0,T.jsx)("option",{value:"contract",children:"Arbeitsvertrag"})]}),(0,T.jsx)("button",{onClick:()=>{var e;return null===(e=f.current)||void 0===e?void 0:e.click()},disabled:g,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:g?l("common.uploading",{defaultValue:"Lade hoch..."}):l("lifecycle.uploadTemplate",{defaultValue:"Template hochladen"}),children:g?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(x.A,{className:"h-5 w-5"})})]}),(0,T.jsx)("input",{ref:f,type:"file",accept:".pdf",onChange:async e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r)if("application/pdf"===r.type){b(!0);try{const e=new FormData;e.append("file",r),e.append("type","certificate"===p?"employmentCertificate":"employmentContract");const t=await w.A.post(N.Sn.ORGANIZATION_LIFECYCLE.UPLOAD_TEMPLATE,e,{headers:{"Content-Type":"multipart/form-data"}});n(t.data.message||l("lifecycle.templateUploaded",{defaultValue:"Template erfolgreich hochgeladen"}),"success"),k()}catch(i){var a,s;console.error("Fehler beim Hochladen:",i),n((null===(a=i.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||l("lifecycle.uploadError",{defaultValue:"Fehler beim Hochladen"}),"error")}finally{b(!1),f.current&&(f.current.value="")}}else n(l("lifecycle.onlyPdfAllowed",{defaultValue:"Nur PDF-Dateien sind erlaubt"}),"error")},className:"hidden"})]}),0===i.length?(0,T.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,T.jsx)(h.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,T.jsx)("p",{children:l("lifecycle.noTemplates",{defaultValue:"Keine Templates vorhanden"})}),(0,T.jsx)("p",{className:"text-sm mt-2",children:l("lifecycle.uploadFirstTemplate",{defaultValue:"Laden Sie Ihr erstes Template hoch"})})]}):(0,T.jsx)("div",{className:"space-y-2",children:i.map((e=>(0,T.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:"font-medium dark:text-white",children:e.name}),(0,T.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["certificate"===e.type?l("lifecycle.certificate",{defaultValue:"Arbeitszeugnis"}):l("lifecycle.contract",{defaultValue:"Arbeitsvertrag"}),e.version&&" - Version ".concat(e.version)]}),e.filePath&&(0,T.jsx)("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:e.filePath})]}),(0,T.jsx)("button",{onClick:()=>(async e=>{if(window.confirm(l("lifecycle.deleteTemplateConfirm",{defaultValue:"Template wirklich l\xf6schen?"})))try{const t=(await w.A.get(N.Sn.ORGANIZATIONS.CURRENT)).data.settings||{};if(t.documentTemplates){const r="certificate"===e?"employmentCertificate":"employmentContract";delete t.documentTemplates[r],await w.A.put(N.Sn.ORGANIZATIONS.CURRENT,{settings:t})}n(l("lifecycle.templateDeleted",{defaultValue:"Template erfolgreich gel\xf6scht"}),"success"),k()}catch(a){var t,r;console.error("Fehler beim L\xf6schen:",a),n((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||l("lifecycle.deleteError",{defaultValue:"Fehler beim L\xf6schen"}),"error")}})(e.type),className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900 rounded-md",title:l("common.delete",{defaultValue:"L\xf6schen"}),children:(0,T.jsx)(Y.A,{className:"h-5 w-5"})})]},e.type)))})]}),(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,T.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,T.jsxs)("h3",{className:"text-lg font-semibold flex items-center dark:text-white",children:[(0,T.jsx)(h.A,{className:"h-5 w-5 mr-2"}),l("organization.documentSignatures",{defaultValue:"Dokumenten-Signaturen"})]})}),(0,T.jsx)($e,{organization:t,onUpload:k})]}),(0,T.jsx)(Qe,{organization:t,onSave:r})]})},tt=e=>{let{organization:t,onSave:r}=e;const{t:l}=(0,s.Bd)(),{showMessage:n}=(0,v.A)(),[i,o]=(0,a.useState)(!1),[d,c]=(0,a.useState)({smtpHost:"",smtpPort:"587",smtpUser:"",smtpPass:"",smtpFromEmail:"",smtpFromName:""}),[u,g]=(0,a.useState)(!1);(0,a.useEffect)((()=>{if(null!==t&&void 0!==t&&t.settings){var e;const r=t.settings;c({smtpHost:r.smtpHost||"",smtpPort:(null===(e=r.smtpPort)||void 0===e?void 0:e.toString())||"587",smtpUser:r.smtpUser||"",smtpPass:r.smtpPass||"",smtpFromEmail:r.smtpFromEmail||(null!==t&&void 0!==t&&t.domain?"noreply@".concat(t.domain):""),smtpFromName:r.smtpFromName||(null===t||void 0===t?void 0:t.displayName)||""})}}),[t]);const x=e=>{const{name:t,value:r}=e.target;c((e=>(0,m.A)((0,m.A)({},e),{},{[t]:r})))};return(0,T.jsxs)("div",{className:"space-y-6",children:[(0,T.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,T.jsx)(Ge.A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),(0,T.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:l("organization.smtp.title")})]}),(0,T.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:l("organization.smtp.description")}),(0,T.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),d.smtpHost&&d.smtpUser&&d.smtpPass)try{o(!0);const e=(0,m.A)((0,m.A)({},(null===t||void 0===t?void 0:t.settings)||{}),{},{smtpHost:d.smtpHost,smtpPort:parseInt(d.smtpPort)||587,smtpUser:d.smtpUser,smtpPass:d.smtpPass,smtpFromEmail:d.smtpFromEmail,smtpFromName:d.smtpFromName});await Ke.h.updateOrganization({settings:e}),n(l("organization.smtp.saveSuccess"),"success"),r&&r()}catch(i){var a,s;const e=(null===(a=i.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||l("organization.smtp.saveError");n(e,"error")}finally{o(!1)}else n(l("organization.smtp.requiredFields"),"error")},className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{htmlFor:"smtpHost",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[l("organization.smtp.host")," ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsx)("input",{type:"text",id:"smtpHost",name:"smtpHost",value:d.smtpHost,onChange:x,placeholder:"smtp.example.com",required:!0,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:l("organization.smtp.hostHint")})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{htmlFor:"smtpPort",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[l("organization.smtp.port")," ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsx)("input",{type:"number",id:"smtpPort",name:"smtpPort",value:d.smtpPort,onChange:x,placeholder:"587",required:!0,min:"1",max:"65535",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:l("organization.smtp.portHint")})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{htmlFor:"smtpUser",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[l("organization.smtp.user")," ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsx)("input",{type:"text",id:"smtpUser",name:"smtpUser",value:d.smtpUser,onChange:x,placeholder:"noreply@example.com",required:!0,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:l("organization.smtp.userHint")})]}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{htmlFor:"smtpPass",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[l("organization.smtp.password")," ",(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsxs)("div",{className:"relative",children:[(0,T.jsx)("input",{type:u?"text":"password",id:"smtpPass",name:"smtpPass",value:d.smtpPass,onChange:x,placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",required:!0,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,T.jsx)("button",{type:"button",onClick:()=>g(!u),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:u?(0,T.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,T.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:l("organization.smtp.passwordHint")})]}),(0,T.jsxs)("div",{className:"border-t pt-4",children:[(0,T.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:l("organization.smtp.fromSettings")}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"smtpFromEmail",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.smtp.fromEmail")}),(0,T.jsx)("input",{type:"email",id:"smtpFromEmail",name:"smtpFromEmail",value:d.smtpFromEmail,onChange:x,placeholder:"noreply@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:l("organization.smtp.fromEmailHint")})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"smtpFromName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.smtp.fromName")}),(0,T.jsx)("input",{type:"text",id:"smtpFromName",name:"smtpFromName",value:d.smtpFromName,onChange:x,placeholder:(null===t||void 0===t?void 0:t.displayName)||"Intranet",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:l("organization.smtp.fromNameHint")})]})]})]}),(0,T.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md p-4",children:[(0,T.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:(0,T.jsx)("strong",{children:l("organization.smtp.infoTitle")})}),(0,T.jsxs)("ul",{className:"mt-2 text-sm text-blue-700 dark:text-blue-300 list-disc list-inside space-y-1",children:[(0,T.jsx)("li",{children:l("organization.smtp.info1")}),(0,T.jsx)("li",{children:l("organization.smtp.info2")}),(0,T.jsx)("li",{children:l("organization.smtp.info3")})]})]}),(0,T.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,T.jsx)("button",{type:"button",onClick:()=>{c({smtpHost:"",smtpPort:"587",smtpUser:"",smtpPass:"",smtpFromEmail:null!==t&&void 0!==t&&t.domain?"noreply@".concat(t.domain):"",smtpFromName:(null===t||void 0===t?void 0:t.displayName)||""})},className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",title:l("organization.smtp.clear"),children:(0,T.jsx)(L.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"submit",disabled:i,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:l(i?"organization.saving":"common.save"),children:i?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})]})]})]})};var rt=r(6693);const at={lobbyPms:["app.lobbypms.com"],ttlock:["open.ttlock.com","euopen.ttlock.com","api.sciener.com"],sire:["api.sire.gov.co"],boldPayment:["api.bold.co","sandbox.bold.co"]},st=(e,t)=>{if(!e||"string"!==typeof e)return!1;try{const r=new URL(e);return at[t].some((e=>r.hostname===e||!!r.hostname.endsWith(".".concat(e))))}catch(r){return!1}},lt=e=>{let{organization:t,onSave:r}=e;const{t:n}=(0,s.Bd)(),{showMessage:i}=(0,v.A)(),{canManageOrganization:o,loading:d}=(0,l.S)(),[c,u]=(0,a.useState)(!1),[g,x]=(0,a.useState)({lobbyPmsApiKey:"",lobbyPmsPropertyId:"",lobbyPmsSyncEnabled:!1,lobbyPmsAutoCreateTasks:!1,lobbyPmsAutoSendReservationInvitation:!0,lobbyPmsLateCheckInThreshold:"22:00",ttlockClientId:"",ttlockClientSecret:"",ttlockApiUrl:"https://open.ttlock.com",ttlockUsername:"",ttlockPassword:"",ttlockPasscodeType:"auto",sireApiUrl:"",sireApiKey:"",sireApiSecret:"",sireEnabled:!1,sireAutoRegisterOnCheckIn:!1,sirePropertyCode:"",boldPaymentApiKey:"",boldPaymentMerchantId:"",boldPaymentEnvironment:"sandbox",whatsappProvider:"twilio",whatsappApiKey:"",whatsappApiSecret:"",whatsappPhoneNumberId:""}),[b,h]=(0,a.useState)({});(0,a.useEffect)((()=>{if(null!==t&&void 0!==t&&t.settings){const e=t.settings,r=e.lobbyPms||{},a=e.doorSystem||{},s=e.sire||{},l=e.boldPayment||{},n=e.whatsapp||{};x({lobbyPmsApiKey:r.apiKey||"",lobbyPmsPropertyId:r.propertyId||"",lobbyPmsSyncEnabled:r.syncEnabled||!1,lobbyPmsAutoCreateTasks:r.autoCreateTasks||!1,lobbyPmsAutoSendReservationInvitation:!1!==r.autoSendReservationInvitation,lobbyPmsLateCheckInThreshold:r.lateCheckInThreshold||"22:00",ttlockClientId:a.clientId||"",ttlockClientSecret:a.clientSecret||"",ttlockApiUrl:a.apiUrl||"https://open.ttlock.com",ttlockUsername:a.username||"",ttlockPassword:"",ttlockPasscodeType:a.passcodeType||"auto",sireApiUrl:s.apiUrl||"",sireApiKey:s.apiKey||"",sireApiSecret:s.apiSecret||"",sireEnabled:s.enabled||!1,sireAutoRegisterOnCheckIn:s.autoRegisterOnCheckIn||!1,sirePropertyCode:s.propertyCode||"",boldPaymentApiKey:l.apiKey||"",boldPaymentMerchantId:l.merchantId||"",boldPaymentEnvironment:l.environment||"sandbox",whatsappProvider:n.provider||"twilio",whatsappApiKey:n.apiKey||"",whatsappApiSecret:n.apiSecret||"",whatsappPhoneNumberId:n.phoneNumberId||""})}}),[t]);const p=e=>{const{name:t,value:r,type:a}=e.target,s=e.target.checked;x((e=>(0,m.A)((0,m.A)({},e),{},{[t]:"checkbox"===a?s:r})))},y=e=>{let{name:t,value:r,onChange:a,placeholder:s,label:l,required:n=!1}=e;const i=b[t]||!1;return(0,T.jsxs)("div",{children:[(0,T.jsxs)("label",{htmlFor:t,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[l," ",n&&(0,T.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,T.jsxs)("div",{className:"relative",children:[(0,T.jsx)("input",{type:i?"text":"password",id:t,name:t,value:r,onChange:a,placeholder:s||"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",required:n,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,T.jsx)("button",{type:"button",onClick:()=>{return e=t,void h((t=>(0,m.A)((0,m.A)({},t),{},{[e]:!t[e]})));var e},className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:i?(0,T.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,T.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,T.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]})};return d?(0,T.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,T.jsx)(L.A,{className:"h-6 w-6 animate-spin text-gray-400"}),(0,T.jsx)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:n("common.loadingPermissions")})]}):o()?(0,T.jsxs)("div",{className:"space-y-6",children:[(0,T.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,T.jsx)(rt.A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),(0,T.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n("organization.api.title")})]}),(0,T.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:n("organization.api.description")}),(0,T.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!g.lobbyPmsSyncEnabled||g.lobbyPmsApiKey)if(!g.ttlockApiUrl||st(g.ttlockApiUrl,"ttlock"))if(!g.sireApiUrl||st(g.sireApiUrl,"sire"))if(!g.lobbyPmsLateCheckInThreshold||/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(g.lobbyPmsLateCheckInThreshold))try{u(!0);const e=(null===t||void 0===t?void 0:t.settings)||{},a=(0,m.A)((0,m.A)({},e),{},{lobbyPms:(0,m.A)((0,m.A)({},e.lobbyPms),{},{apiUrl:"https://api.lobbypms.com",apiKey:g.lobbyPmsApiKey||void 0,propertyId:g.lobbyPmsPropertyId||void 0,syncEnabled:g.lobbyPmsSyncEnabled,autoCreateTasks:g.lobbyPmsAutoCreateTasks,autoSendReservationInvitation:g.lobbyPmsAutoSendReservationInvitation,lateCheckInThreshold:g.lobbyPmsLateCheckInThreshold||void 0}),doorSystem:(0,m.A)((0,m.A)({},e.doorSystem),{},{provider:"ttlock",apiUrl:g.ttlockApiUrl||void 0,clientId:g.ttlockClientId||void 0,clientSecret:g.ttlockClientSecret||void 0,username:g.ttlockUsername||void 0,password:g.ttlockPassword||void 0,passcodeType:g.ttlockPasscodeType||"auto"}),sire:(0,m.A)((0,m.A)({},e.sire),{},{apiUrl:g.sireApiUrl||void 0,apiKey:g.sireApiKey||void 0,apiSecret:g.sireApiSecret||void 0,enabled:g.sireEnabled,autoRegisterOnCheckIn:g.sireAutoRegisterOnCheckIn,propertyCode:g.sirePropertyCode||void 0}),boldPayment:(0,m.A)((0,m.A)({},e.boldPayment),{},{apiKey:g.boldPaymentApiKey||void 0,merchantId:g.boldPaymentMerchantId||void 0,environment:g.boldPaymentEnvironment}),whatsapp:(0,m.A)((0,m.A)({},e.whatsapp),{},{provider:g.whatsappProvider,apiKey:g.whatsappApiKey||void 0,apiSecret:g.whatsappApiSecret||void 0,phoneNumberId:g.whatsappPhoneNumberId||void 0})});await Ke.h.updateOrganization({settings:a}),i(n("organization.api.saveSuccess"),"success"),r&&r()}catch(s){var a;console.error("Error saving API settings:",s);let e=n("organization.api.saveError");if(null!==(a=s.response)&&void 0!==a&&a.data){const t=s.response.data;if(t.message&&(e=t.message),t.errors&&Array.isArray(t.errors)){const r=t.errors.map((e=>{var t;return"".concat((null===(t=e.path)||void 0===t?void 0:t.join("."))||"",": ").concat(e.message||"")})).filter((e=>e)).join(", ");r&&(e+=" (".concat(r,")")),t.errors.length>0&&"string"===typeof t.errors[0]&&(e=t.errors.join(", "))}}else s.message&&(e=s.message);i(e,"error")}finally{u(!1)}else i(n("organization.api.validation.invalidTimeFormat"),"error");else i(n("organization.api.validation.invalidUrl"),"error");else i(n("organization.api.validation.invalidUrl"),"error");else i(n("organization.api.validation.apiKeyRequired"),"error")},className:"space-y-6",children:[(0,T.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:n("organization.api.lobbyPms.title")}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)(y,{name:"lobbyPmsApiKey",value:g.lobbyPmsApiKey,onChange:p,label:n("organization.api.lobbyPms.apiKey"),placeholder:"API Token"}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"lobbyPmsPropertyId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.api.lobbyPms.propertyId")}),(0,T.jsx)("input",{type:"text",id:"lobbyPmsPropertyId",name:"lobbyPmsPropertyId",value:g.lobbyPmsPropertyId,onChange:p,placeholder:"Property ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{className:"space-y-2",children:[(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"checkbox",name:"lobbyPmsSyncEnabled",checked:g.lobbyPmsSyncEnabled,onChange:p,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,T.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:n("organization.api.lobbyPms.syncEnabled")})]}),(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"checkbox",name:"lobbyPmsAutoCreateTasks",checked:g.lobbyPmsAutoCreateTasks,onChange:p,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,T.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:n("organization.api.lobbyPms.autoCreateTasks")})]}),(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"checkbox",name:"lobbyPmsAutoSendReservationInvitation",checked:g.lobbyPmsAutoSendReservationInvitation,onChange:p,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,T.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:n("organization.api.lobbyPms.autoSendReservationInvitation","Automatisch Einladung bei Reservation-Erstellung senden")})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"lobbyPmsLateCheckInThreshold",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.api.lobbyPms.lateCheckInThreshold")}),(0,T.jsx)("input",{type:"time",id:"lobbyPmsLateCheckInThreshold",name:"lobbyPmsLateCheckInThreshold",value:g.lobbyPmsLateCheckInThreshold,onChange:p,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]}),(0,T.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:n("organization.api.ttlock.title")}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"ttlockApiUrl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.api.ttlock.apiUrl")}),(0,T.jsx)("input",{type:"text",id:"ttlockApiUrl",name:"ttlockApiUrl",value:g.ttlockApiUrl,onChange:p,placeholder:"https://open.ttlock.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"ttlockClientId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.api.ttlock.clientId")}),(0,T.jsx)("input",{type:"text",id:"ttlockClientId",name:"ttlockClientId",value:g.ttlockClientId,onChange:p,placeholder:"Client ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsx)(y,{name:"ttlockClientSecret",value:g.ttlockClientSecret,onChange:p,label:n("organization.api.ttlock.clientSecret"),placeholder:"Client Secret"}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"ttlockUsername",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.api.ttlock.username")}),(0,T.jsx)("input",{type:"text",id:"ttlockUsername",name:"ttlockUsername",value:g.ttlockUsername,onChange:p,placeholder:"TTLock App Username (z.B. +573024498991)",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:n("organization.api.ttlock.usernameHint")})]}),(0,T.jsx)(y,{name:"ttlockPassword",value:g.ttlockPassword,onChange:p,label:n("organization.api.ttlock.password"),placeholder:"TTLock App Password"}),(0,T.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 -mt-2",children:n("organization.api.ttlock.passwordHint")}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"ttlockPasscodeType",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.api.ttlock.passcodeType")}),(0,T.jsxs)("select",{id:"ttlockPasscodeType",name:"ttlockPasscodeType",value:g.ttlockPasscodeType,onChange:p,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,T.jsx)("option",{value:"auto",children:n("organization.api.ttlock.passcodeTypeAuto")}),(0,T.jsx)("option",{value:"custom",children:n("organization.api.ttlock.passcodeTypeCustom")})]}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:n("organization.api.ttlock.passcodeTypeHint")})]})]})]}),(0,T.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:n("organization.api.sire.title")}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"sireApiUrl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.api.sire.apiUrl")}),(0,T.jsx)("input",{type:"text",id:"sireApiUrl",name:"sireApiUrl",value:g.sireApiUrl,onChange:p,placeholder:"https://api.sire.gov.co",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsx)(y,{name:"sireApiKey",value:g.sireApiKey,onChange:p,label:n("organization.api.sire.apiKey"),placeholder:"API Key"}),(0,T.jsx)(y,{name:"sireApiSecret",value:g.sireApiSecret,onChange:p,label:n("organization.api.sire.apiSecret"),placeholder:"API Secret"}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"sirePropertyCode",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.api.sire.propertyCode")}),(0,T.jsx)("input",{type:"text",id:"sirePropertyCode",name:"sirePropertyCode",value:g.sirePropertyCode,onChange:p,placeholder:"Property Code",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{className:"space-y-2",children:[(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"checkbox",name:"sireEnabled",checked:g.sireEnabled,onChange:p,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,T.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:n("organization.api.sire.enabled")})]}),(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"checkbox",name:"sireAutoRegisterOnCheckIn",checked:g.sireAutoRegisterOnCheckIn,onChange:p,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,T.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:n("organization.api.sire.autoRegisterOnCheckIn")})]})]})]})]}),(0,T.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:n("organization.api.boldPayment.title")}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)(y,{name:"boldPaymentApiKey",value:g.boldPaymentApiKey,onChange:p,label:n("organization.api.boldPayment.apiKey"),placeholder:"API Key"}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"boldPaymentMerchantId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.api.boldPayment.merchantId")}),(0,T.jsx)("input",{type:"text",id:"boldPaymentMerchantId",name:"boldPaymentMerchantId",value:g.boldPaymentMerchantId,onChange:p,placeholder:"Merchant ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"boldPaymentEnvironment",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.api.boldPayment.environment")}),(0,T.jsxs)("select",{id:"boldPaymentEnvironment",name:"boldPaymentEnvironment",value:g.boldPaymentEnvironment,onChange:p,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,T.jsx)("option",{value:"sandbox",children:n("organization.api.boldPayment.sandbox")}),(0,T.jsx)("option",{value:"production",children:n("organization.api.boldPayment.production")})]})]})]})]}),(0,T.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,T.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:n("organization.api.whatsapp.title")}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"whatsappProvider",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.api.whatsapp.provider")}),(0,T.jsxs)("select",{id:"whatsappProvider",name:"whatsappProvider",value:g.whatsappProvider,onChange:p,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,T.jsx)("option",{value:"twilio",children:n("organization.api.whatsapp.providerTwilio")}),(0,T.jsx)("option",{value:"whatsapp-business-api",children:n("organization.api.whatsapp.providerBusinessApi")})]})]}),(0,T.jsx)(y,{name:"whatsappApiKey",value:g.whatsappApiKey,onChange:p,label:n("organization.api.whatsapp.apiKey"),placeholder:"API Key / Access Token"}),(0,T.jsx)(y,{name:"whatsappApiSecret",value:g.whatsappApiSecret,onChange:p,label:n("organization.api.whatsapp.apiSecret"),placeholder:"API Secret (optional)"}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"whatsappPhoneNumberId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.api.whatsapp.phoneNumberId")}),(0,T.jsx)("input",{type:"text",id:"whatsappPhoneNumberId",name:"whatsappPhoneNumberId",value:g.whatsappPhoneNumberId,onChange:p,placeholder:"Phone Number ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]}),(0,T.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,T.jsx)("button",{type:"button",onClick:()=>{x({lobbyPmsApiKey:"",lobbyPmsPropertyId:"",lobbyPmsSyncEnabled:!1,lobbyPmsAutoCreateTasks:!1,lobbyPmsAutoSendReservationInvitation:!0,lobbyPmsLateCheckInThreshold:"22:00",ttlockClientId:"",ttlockClientSecret:"",ttlockApiUrl:"https://open.ttlock.com",ttlockUsername:"",ttlockPassword:"",ttlockPasscodeType:"auto",sireApiUrl:"",sireApiKey:"",sireApiSecret:"",sireEnabled:!1,sireAutoRegisterOnCheckIn:!1,sirePropertyCode:"",boldPaymentApiKey:"",boldPaymentMerchantId:"",boldPaymentEnvironment:"sandbox",whatsappProvider:"twilio",whatsappApiKey:"",whatsappApiSecret:"",whatsappPhoneNumberId:""})},className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",title:n("organization.api.clear"),children:(0,T.jsx)(L.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"submit",disabled:c,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:n(c?"organization.saving":"common.save"),children:c?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})]})]})]}):(0,T.jsx)("div",{className:"text-center py-8",children:(0,T.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:n("organization.api.noPermission")})})},nt=e=>{let{isOpen:t,onClose:r,onSuccess:l,organization:n}=e;const{t:i}=(0,s.Bd)(),{fetchCurrentUser:o}=(0,D.As)(),[d,c]=(0,a.useState)({displayName:"",domain:"",logo:"",country:null,nit:null,settings:{}}),[g,x]=(0,a.useState)(""),[b,h]=(0,a.useState)(""),[p,k]=(0,a.useState)(!1),[j,w]=(0,a.useState)({}),[N,A]=(0,a.useState)(window.innerWidth<640),[S,C]=(0,a.useState)(window.innerWidth>1070),{openSidepane:P,closeSidepane:E}=(0,R.N)(),{showMessage:z}=(0,v.A)(),{organizationLanguage:F,setOrganizationLanguage:I}=(0,Ze.o)(),[_,B]=(0,a.useState)(""),[O,V]=(0,a.useState)(!1),[U,M]=(0,a.useState)("general"),[q,G]=(0,a.useState)(null),[W,K]=(0,a.useState)(null),H=[{code:"CO",name:i("countries.CO")},{code:"CH",name:i("countries.CH")},{code:"DE",name:i("countries.DE")},{code:"AT",name:i("countries.AT")}];(0,a.useEffect)((()=>{if(t&&n){const e=n.settings||{};c({displayName:n.displayName||"",domain:n.domain||"",logo:n.logo||"",country:n.country||null,nit:n.nit||null,settings:e}),x(n.country||""),h(n.nit||""),n.logo?K(n.logo):K(null),G(null);(async()=>{try{const e=await Ke.h.getOrganizationLanguage();B(e.language||"")}catch(e){console.error(i("organization.loadLanguageError"),e),B("")}})()}}),[t,n,i]),(0,a.useEffect)((()=>{const e=()=>{A(window.innerWidth<640),C(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,a.useEffect)((()=>(t?P():E(),()=>{E()})),[t,P,E]);const J=e=>{const{name:t,value:r}=e.target;"country"===t?(x(r),c((e=>(0,m.A)((0,m.A)({},e),{},{country:r||null}))),"CO"!==r&&(h(""),c((e=>(0,m.A)((0,m.A)({},e),{},{nit:null}))))):"nit"===t?(h(r),c((e=>(0,m.A)((0,m.A)({},e),{},{nit:r||null})))):c((e=>(0,m.A)((0,m.A)({},e),{},{[t]:r}))),j[t]&&w((e=>(0,m.A)((0,m.A)({},e),{},{[t]:""})))},Y=e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!r)return;if(!r.type.match("image/(png|jpeg|jpg)"))return void z(i("organization.logoInvalidType")||"Nur PNG und JPEG Dateien sind erlaubt","error");if(r.size>5242880)return void z(i("organization.logoTooLarge")||"Logo darf maximal 5MB gro\xdf sein","error");G(r);const a=new FileReader;a.onloadend=()=>{const e=a.result;K(e),c((t=>(0,m.A)((0,m.A)({},t),{},{logo:e})))},a.readAsDataURL(r)},Z=async e=>{e.preventDefault();try{k(!0),w({}),await Ke.h.updateOrganization(d),z(i("organization.updateSuccess"),"success");try{await o()}catch(s){console.error("Fehler beim Neuladen der User-Daten:",s)}r(),l&&l()}catch(n){var t,a;const e=(null===(t=n.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||i("organization.updateError");z(e,"error"),w({submit:e})}finally{k(!1)}},X=()=>{if(n){const e=n.settings||{};c({displayName:n.displayName||"",domain:n.domain||"",logo:n.logo||"",country:n.country||null,nit:n.nit||null,settings:e}),x(n.country||""),h(n.nit||"")}w({}),r()};return N?(0,T.jsxs)(u.lG,{open:t,onClose:X,className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,T.jsx)(u.lG.Title,{className:"text-lg font-semibold dark:text-white",children:i("organization.edit.title")}),(0,T.jsx)("button",{onClick:X,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("form",{onSubmit:Z,className:"p-4",children:[j.submit&&(0,T.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:j.submit}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.displayName")}),(0,T.jsx)("input",{type:"text",id:"displayName",name:"displayName",value:d.displayName||"",onChange:J,className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(j.displayName?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),j.displayName&&(0,T.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:j.displayName})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"domain",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.domain")}),(0,T.jsx)("input",{type:"text",id:"domain",name:"domain",value:d.domain||"",onChange:J,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"logo-mobile",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.logo")||"Logo"}),(0,T.jsx)("input",{type:"file",id:"logo-mobile",name:"logo",accept:"image/png,image/jpeg,image/jpg",onChange:Y,className:"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 dark:file:bg-blue-900 dark:file:text-blue-300 dark:hover:file:bg-blue-800"}),W&&(0,T.jsx)("div",{className:"mt-2",children:(0,T.jsx)("img",{src:W,alt:"Logo Preview",className:"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded"})}),d.logo&&!W&&(0,T.jsx)("div",{className:"mt-2",children:(0,T.jsx)("img",{src:d.logo,alt:"Current Logo",className:"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded"})})]}),(0,T.jsxs)("div",{className:"border-t pt-4",children:[(0,T.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.country")}),(0,T.jsxs)("select",{id:"country",name:"country",value:g,onChange:J,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,T.jsx)("option",{value:"",children:i("organization.selectCountry")}),H.map((e=>(0,T.jsx)("option",{value:e.code,children:e.name},e.code)))]})]}),(0,T.jsxs)("div",{className:"border-t pt-4",children:[(0,T.jsx)("label",{htmlFor:"organizationLanguage",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.language")}),(0,T.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:i("organization.languageDescription")}),(0,T.jsxs)("select",{id:"organizationLanguage",value:_||F||"",onChange:async e=>{const t=e.target.value;if(B(t),t&&t!==F){V(!0);try{await I(t),z(i("common.save"),"success")}catch(r){console.error(i("organization.saveLanguageError"),r),z(i("worktime.messages.orgLanguageError"),"error")}finally{V(!1)}}},disabled:O||p,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed",children:[(0,T.jsxs)("option",{value:"",children:[i("settings.useOrganizationLanguage")," (",i("worktime.language.fallback"),": ",i("worktime.language.german"),")"]}),(0,T.jsx)("option",{value:"de",children:i("worktime.language.german")}),(0,T.jsx)("option",{value:"es",children:i("worktime.language.spanish")}),(0,T.jsx)("option",{value:"en",children:i("worktime.language.english")})]})]})]}),(0,T.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,T.jsx)("button",{type:"button",onClick:X,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:i("common.cancel"),children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"submit",disabled:p,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:i(p?"organization.saving":"common.save"),children:p?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})]})]})]})})]}):(0,T.jsxs)(T.Fragment,{children:[t&&!S&&(0,T.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:X,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,T.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,T.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:i("organization.edit.title")}),(0,T.jsx)("button",{onClick:X,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,T.jsxs)("nav",{className:"-mb-px flex space-x-4 px-4","aria-label":"Tabs",children:[(0,T.jsx)("button",{type:"button",onClick:()=>M("general"),className:"".concat("general"===U?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:i("organization.tabs.general")}),(0,T.jsx)("button",{type:"button",onClick:()=>M("roles"),className:"".concat("roles"===U?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:i("organization.tabs.roles")}),(0,T.jsx)("button",{type:"button",onClick:()=>M("documents"),className:"".concat("documents"===U?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:i("organization.tabs.documents")}),(0,T.jsx)("button",{type:"button",onClick:()=>M("smtp"),className:"".concat("smtp"===U?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:i("organization.tabs.smtp")}),"CO"===g&&(0,T.jsx)("button",{type:"button",onClick:()=>M("api"),className:"".concat("api"===U?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:i("organization.tabs.api")})]})}),(0,T.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[j.submit&&(0,T.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:j.submit}),"general"===U&&(0,T.jsxs)("form",{onSubmit:Z,className:"space-y-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.displayName")}),(0,T.jsx)("input",{type:"text",id:"displayName",name:"displayName",value:d.displayName||"",onChange:J,className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(j.displayName?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),j.displayName&&(0,T.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:j.displayName})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"domain",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.domain")}),(0,T.jsx)("input",{type:"text",id:"domain",name:"domain",value:d.domain||"",onChange:J,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"logo",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.logo")||"Logo"}),(0,T.jsx)("input",{type:"file",id:"logo",name:"logo",accept:"image/png,image/jpeg,image/jpg",onChange:Y,className:"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 dark:file:bg-blue-900 dark:file:text-blue-300 dark:hover:file:bg-blue-800"}),W&&(0,T.jsx)("div",{className:"mt-2",children:(0,T.jsx)("img",{src:W,alt:"Logo Preview",className:"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded"})}),d.logo&&!W&&(0,T.jsx)("div",{className:"mt-2",children:(0,T.jsx)("img",{src:d.logo,alt:"Current Logo",className:"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded"})})]}),(0,T.jsxs)("div",{className:"border-t pt-4",children:[(0,T.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.country")}),(0,T.jsxs)("select",{id:"country",name:"country",value:g,onChange:J,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,T.jsx)("option",{value:"",children:i("organization.selectCountry")}),H.map((e=>(0,T.jsx)("option",{value:e.code,children:e.name},e.code)))]})]}),"CO"===g&&(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"nit",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.nit")}),(0,T.jsx)("input",{type:"text",id:"nit",name:"nit",value:b,onChange:J,placeholder:i("organization.nitDescription"),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,T.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:i("organization.nitDescription")})]}),(0,T.jsxs)("div",{className:"border-t pt-4",children:[(0,T.jsx)("label",{htmlFor:"organizationLanguage",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.language")}),(0,T.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:i("organization.languageDescription")}),(0,T.jsxs)("select",{id:"organizationLanguage",value:_||F||"",onChange:async e=>{const t=e.target.value;if(B(t),t&&t!==F){V(!0);try{await I(t),z(i("common.save"),"success")}catch(r){console.error("Fehler beim Speichern der Organisation-Sprache:",r),z(i("worktime.messages.orgLanguageError"),"error")}finally{V(!1)}}},disabled:O||p,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed",children:[(0,T.jsxs)("option",{value:"",children:[i("settings.useOrganizationLanguage")," (",i("worktime.language.fallback"),": ",i("worktime.language.german"),")"]}),(0,T.jsx)("option",{value:"de",children:i("worktime.language.german")}),(0,T.jsx)("option",{value:"es",children:i("worktime.language.spanish")}),(0,T.jsx)("option",{value:"en",children:i("worktime.language.english")})]})]}),(0,T.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,T.jsx)("button",{type:"button",onClick:X,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:i("common.cancel"),children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"submit",disabled:p,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:i(p?"organization.saving":"common.save"),children:p?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,T.jsx)(f.A,{className:"h-5 w-5"})})]})]}),"roles"===U&&(0,T.jsx)(Xe,{organization:n,onSave:()=>{l&&l()}}),"documents"===U&&(0,T.jsx)(et,{organization:n,onSave:()=>{l&&l()}}),"smtp"===U&&(0,T.jsx)(tt,{organization:n,onSave:()=>{l&&l()}}),"api"===U&&"CO"===g&&(0,T.jsx)(lt,{organization:n,onSave:()=>{l&&l()}})]})]})]})},it=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"approved":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case"rejected":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},ot=(e,t)=>{switch(e){case"pending":return t("joinRequestsList.status.pending");case"approved":return t("joinRequestsList.status.approved");case"rejected":return t("joinRequestsList.status.rejected");case"withdrawn":return t("joinRequestsList.status.withdrawn");default:return e}},dt="my-join-requests-table",ct=()=>{const{t:e}=(0,s.Bd)(),[t,r]=(0,a.useState)([]),[l,n]=(0,a.useState)(!0),[i,o]=(0,a.useState)(null),[d,c]=(0,a.useState)(!1),[u,g]=(0,a.useState)([]),[x,b]=(0,a.useState)([]),[h,p]=(0,a.useState)(""),{showMessage:f}=(0,v.A)(),k=(0,a.useRef)(!0),[j,A]=(0,a.useState)(null),[S,C]=(0,a.useState)("Alle"),[P,E]=(0,a.useState)(null);(0,a.useEffect)((()=>()=>{k.current=!1}),[]),(0,a.useEffect)((()=>{console.log("MyJoinRequestsList: useEffect called - component mounted"),console.log("MyJoinRequestsList: Resetting state on mount to prevent data leaks"),r([]),o(null),n(!0);let t=!0;return(async()=>{if(!t)return void console.log("MyJoinRequestsList: Component unmounted, skipping fetch");console.log("MyJoinRequestsList: Starting fetch");const a=setTimeout((()=>{t&&(console.error("Request timeout after 10 seconds"),o("Anfrage dauert zu lange. Bitte Seite neu laden."),n(!1))}),1e4);try{console.log("MyJoinRequestsList: Setting loading to true"),n(!0),o(null),console.log("MyJoinRequestsList: Fetching my join requests from:",N.Sn.ORGANIZATIONS.MY_JOIN_REQUESTS);const e=await Ke.h.getMyJoinRequests();if(console.log("MyJoinRequestsList: Received requests:",e),console.log("MyJoinRequestsList: Requests type:",typeof e),console.log("MyJoinRequestsList: Requests isArray:",Array.isArray(e)),console.log("MyJoinRequestsList: Requests length:",(null===e||void 0===e?void 0:e.length)||0),!Array.isArray(e))throw console.error("\u274c MyJoinRequestsList: Response is not an array!",e),new Error("Ung\xfcltige Antwort vom Server");clearTimeout(a),t?(console.log("MyJoinRequestsList: Setting joinRequests state"),r(e),console.log("MyJoinRequestsList: State updated with",e.length,"requests")):(console.log("MyJoinRequestsList: Component was unmounted, but setting state anyway"),r(e))}catch(c){var s,l,i,d;if(clearTimeout(a),!t)return void console.log("MyJoinRequestsList: Component unmounted during error, skipping error handling");console.error("MyJoinRequestsList: Error fetching my join requests:",c),console.error("MyJoinRequestsList: Error response:",c.response),console.error("MyJoinRequestsList: Error status:",null===(s=c.response)||void 0===s?void 0:s.status),console.error("MyJoinRequestsList: Error data:",null===(l=c.response)||void 0===l?void 0:l.data);const r=(null===(i=c.response)||void 0===i||null===(d=i.data)||void 0===d?void 0:d.message)||c.message||e("myJoinRequests.loadError");o(r),setTimeout((()=>{f(r,"error")}),0)}finally{t?(console.log("MyJoinRequestsList: Setting loading to false"),n(!1)):(console.log("MyJoinRequestsList: Component unmounted, but setting loading to false anyway"),n(!1))}})(),()=>{console.log("MyJoinRequestsList: useEffect cleanup - component unmounting"),t=!1,k.current=!1,r([]),o(null)}}),[]);const z=e=>new Date(e).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),D=(e,t)=>{g(e),b(t)},R=()=>{g([]),b([]),C(""),E(null)},F=()=>u.length;(0,a.useEffect)((()=>{(async()=>{try{const e=await w.A.get(N.Sn.SAVED_FILTERS.BY_TABLE(dt)),t=e.data.find((e=>"Alle"===e.name));t&&(C("Alle"),E(t.id),D(t.conditions,t.operators))}catch(i){console.error("Fehler beim Setzen des initialen Filters:",i)}})()}),[]),(0,a.useEffect)((()=>{(async()=>{try{if(!localStorage.getItem("token"))return void console.error("Nicht authentifiziert");const e=(await w.A.get(N.Sn.SAVED_FILTERS.BY_TABLE(dt))).data||[];if(!e.some((e=>"Alle"===e.name))){const e={tableId:dt,name:"Alle",conditions:[],operators:[]};await w.A.post(N.Sn.SAVED_FILTERS.BASE,e),console.log("Alle-Filter f\xfcr Meine Beitrittsanfragen erstellt")}}catch(i){console.error("Fehler beim Erstellen der Standard-Filter:",i)}})()}),[]);const I=(0,a.useMemo)((()=>{let e=[...t];if(h){const t=h.toLowerCase();e=e.filter((e=>{var r;const a=(e.organization.displayName||e.organization.name||"").toLowerCase(),s=(null===(r=e.message)||void 0===r?void 0:r.toLowerCase())||"";return a.includes(t)||s.includes(t)}))}return u.length>0&&(e=u.reduce(((e,t,r)=>{if(!t.column||null===t.value||""===t.value)return e;const a=t.operator,s=t.value;return e.filter((e=>{var r;switch(t.column){case"organization":const t=(e.organization.displayName||e.organization.name||"").toLowerCase(),l=String(s).toLowerCase();return"contains"===a?t.includes(l):"equals"===a?t===l:"startsWith"===a&&t.startsWith(l);case"message":const n=(null===(r=e.message)||void 0===r?void 0:r.toLowerCase())||"",i=String(s).toLowerCase();return"contains"===a?n.includes(i):"equals"===a?n===i:"startsWith"===a&&n.startsWith(i);case"status":return"equals"===a&&e.status===s;default:return!0}}))}),e)),e}),[t,h,u,x]);return(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,T.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:e("myJoinRequests.title")}),(0,T.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,T.jsx)("input",{type:"text",placeholder:e("common.search",{defaultValue:"Suchen..."}),className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:h,onChange:e=>p(e.target.value)}),(0,T.jsxs)("button",{className:"p-2 rounded-md border ".concat(F()>0?"border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700"," relative"),onClick:()=>c(!d),title:e("common.filter"),children:[(0,T.jsx)(X.A,{className:"h-5 w-5"}),F()>0&&(0,T.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center",children:F()})]})]})]}),d&&(0,T.jsx)("div",{className:"mb-4",children:(0,T.jsx)($.A,{columns:[{id:"organization",label:e("myJoinRequests.filter.organization",{defaultValue:"Organisation"})},{id:"message",label:e("joinRequestsList.filter.message")},{id:"status",label:e("joinRequestsList.status.title",{defaultValue:"Status"})}],onApply:D,onReset:R,savedConditions:u,savedOperators:x,tableId:dt})}),(0,T.jsx)(Q.A,{tableId:dt,onSelectFilter:D,onReset:R,activeFilterName:S,selectedFilterId:P,onFilterChange:(e,t,r,a)=>{C(e),E(t),D(r,a)},defaultFilterName:"Alle"}),i&&(0,T.jsx)("div",{className:"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded",children:i}),l?(0,T.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,T.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,T.jsx)("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:e("myJoinRequests.loading")})]}):0===t.length?(0,T.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:e("myJoinRequests.noRequests")}):(0,T.jsx)("div",{className:"space-y-4",children:I.map((t=>(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,T.jsx)("div",{className:"flex items-start justify-between",children:(0,T.jsxs)("div",{className:"flex-1",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.organization.displayName||t.organization.name}),(0,T.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:z(t.createdAt)})]}),(0,T.jsx)("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(it(t.status)),children:ot(t.status,e)})]}),t.message&&(0,T.jsx)("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:(0,T.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[(0,T.jsxs)("span",{className:"font-medium",children:[e("joinRequestsList.filter.message"),":"]})," ",t.message]})}),t.response&&(0,T.jsx)("div",{className:"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700",children:(0,T.jsxs)("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[(0,T.jsxs)("span",{className:"font-medium",children:[e("joinRequestsList.response"),":"]})," ",t.response]})}),t.processor&&(0,T.jsxs)("div",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:[e("myJoinRequests.processedBy"),": ",t.processor.firstName," ",t.processor.lastName,t.processedAt&&" - ".concat(z(t.processedAt))]}),"pending"===t.status&&(0,T.jsx)("div",{className:"mt-4 flex items-center gap-2",children:(0,T.jsx)("button",{onClick:()=>(async t=>{if(window.confirm(e("myJoinRequests.confirmWithdraw")))try{A(t),await Ke.h.withdrawJoinRequest(t),r((e=>e.map((e=>e.id===t?(0,m.A)((0,m.A)({},e),{},{status:"withdrawn",processedAt:(new Date).toISOString()}):e)))),f(e("myJoinRequests.withdrawSuccess"),"success")}catch(l){var a,s;const t=(null===(a=l.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||e("myJoinRequests.withdrawError");f(t,"error")}finally{A(null)}})(t.id),disabled:j===t.id,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-md dark:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:j===t.id?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(L.A,{className:"h-4 w-4 mr-1 animate-spin"}),e("myJoinRequests.withdrawing")]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(y.A,{className:"h-4 w-4 mr-1"}),e("myJoinRequests.withdraw")]})})})]})})},t.id)))})]})},mt=()=>{const[e,t]=(0,a.useState)(null),[r,i]=(0,a.useState)(null),[d,c]=(0,a.useState)(!0),[u,g]=(0,a.useState)(!1),[b,h]=(0,a.useState)(null),[y,f]=(0,a.useState)(!1),[k,j]=(0,a.useState)(!1),[w,N]=(0,a.useState)(!1),{canViewOrganization:A,canManageOrganization:S,loading:P}=(0,l.S)(),{showMessage:E}=(0,v.A)(),{t:z}=(0,s.Bd)(),{refreshOrganization:L}=(0,He.Z)(),{fetchCurrentUser:R}=(0,D.As)(),F=(0,a.useCallback)((async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{c(!0),h(null);const r=await Ke.h.getCurrentOrganization(void 0,e);t(r);try{g(!0);const e=await Ke.h.getOrganizationStats();i(e)}catch(o){console.error("Fehler beim Laden der Statistiken:",o)}finally{g(!1)}}catch(d){var r,a,s;if(404===(null===(r=d.response)||void 0===r?void 0:r.status)&&!1===(null===(a=d.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.hasOrganization))h(z("organization.notFound")),t(null),E(z("organization.notFound"),"info");else{var l,n;const e=(null===(l=d.response)||void 0===l||null===(n=l.data)||void 0===n?void 0:n.message)||z("organization.loadError");h(e),E(e,"error")}}finally{c(!1)}}),[]),I=(0,a.useRef)(!1);(0,a.useEffect)((()=>{if(P)return;if(I.current)return;return A()?(I.current=!0,F(!1)):(h(z("organization.noPermission")),c(!1),I.current=!0),()=>{t(null),i(null)}}),[P]);if(P)return(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6",children:(0,T.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,T.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,T.jsx)("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:z("common.loadingPermissions")})]})});if(!A())return(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6",children:(0,T.jsx)("div",{className:"p-4 text-red-600 dark:text-red-400",children:z("organization.noPermission")})});return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("div",{className:"flex items-center mb-4 sm:mb-4",children:(0,T.jsxs)("div",{className:"flex items-center","data-onboarding":"organization-buttons",children:[(0,T.jsx)("button",{onClick:()=>f(!0),"data-onboarding":"create-organization-button",className:"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},title:z("organization.createOrganization"),"aria-label":z("organization.createOrganization"),children:(0,T.jsx)(x.A,{className:"h-4 w-4"})}),(0,T.jsx)("button",{onClick:()=>j(!0),"data-onboarding":"join-organization-button",className:"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center ml-2",style:{width:"30.19px",height:"30.19px"},title:z("organization.joinOrganization"),"aria-label":z("organization.joinOrganization"),children:(0,T.jsx)(qe.A,{className:"h-4 w-4"})})]})}),d?(0,T.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,T.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,T.jsx)("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:z("common.loadingOrganization")})]}):(0,T.jsxs)(T.Fragment,{children:[b&&(0,T.jsx)("div",{className:"mb-4 p-4 border rounded ".concat(e?"bg-red-100 dark:bg-red-900 border-red-400 dark:border-red-700 text-red-700 dark:text-red-300":"bg-blue-50 dark:bg-blue-900/30 border-blue-400 dark:border-blue-700 text-blue-700 dark:text-blue-300"),children:(0,T.jsxs)("div",{className:"flex items-start",children:[(0,T.jsx)("div",{className:"flex-shrink-0",children:e?(0,T.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"\u26a0\ufe0f"}):(0,T.jsx)(n.A,{className:"h-5 w-5"})}),(0,T.jsxs)("div",{className:"ml-3 flex-1",children:[(0,T.jsx)("p",{className:"font-medium",children:b}),!e&&(0,T.jsx)("p",{className:"mt-2 text-sm",children:z("organization.createOrJoinHint")})]})]})}),e?(0,T.jsx)(T.Fragment,{children:(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,T.jsx)("div",{className:"flex items-start justify-between",children:(0,T.jsxs)("div",{className:"flex-1",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center",children:[(0,T.jsx)(p.A,{className:"h-5 w-5 mr-2"}),e.displayName||e.name]}),(0,T.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.domain||z("organization.noDomain")})]}),S()&&(0,T.jsx)("button",{onClick:async()=>{null!==e&&void 0!==e&&e.settings||await F(!0),N(!0)},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1",title:z("organization.edit.title"),children:(0,T.jsx)(C.A,{className:"h-5 w-5"})})]}),(0,T.jsx)("div",{className:"space-y-3",children:e.subscriptionPlan&&(0,T.jsxs)("div",{children:[(0,T.jsxs)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[z("organization.subscriptionPlan"),":"]}),(0,T.jsx)("span",{className:"ml-2 text-sm text-gray-900 dark:text-white capitalize",children:e.subscriptionPlan})]})}),r&&(0,T.jsx)(T.Fragment,{children:(0,T.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,T.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:z("organization.statistics")}),u?(0,T.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,T.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-2"}),(0,T.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:z("common.loadingStatistics")})]}):(0,T.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,T.jsxs)("div",{className:"flex items-center",children:[(0,T.jsx)("div",{className:"flex-shrink-0 bg-blue-100 dark:bg-blue-900/30 rounded-lg p-3",children:(0,T.jsx)(n.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),(0,T.jsxs)("div",{className:"ml-4",children:[(0,T.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:z("organization.users")}),(0,T.jsxs)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:[r.currentUsers," / ",r.maxUsers]}),void 0!==r.utilizationPercent&&(0,T.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[r.utilizationPercent,"% ",z("organization.utilizationPercent")]})]})]})}),(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,T.jsxs)("div",{className:"flex items-center",children:[(0,T.jsx)("div",{className:"flex-shrink-0 bg-purple-100 dark:bg-purple-900/30 rounded-lg p-3",children:(0,T.jsx)(o.A,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})}),(0,T.jsxs)("div",{className:"ml-4",children:[(0,T.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:z("organization.roles")}),(0,T.jsx)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:r._count.roles})]})]})}),(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,T.jsxs)("div",{className:"flex items-center",children:[(0,T.jsx)("div",{className:"flex-shrink-0 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg p-3",children:(0,T.jsx)(Ge.A,{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400"})}),(0,T.jsxs)("div",{className:"ml-4",children:[(0,T.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:z("organization.joinRequests")}),(0,T.jsx)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:r._count.joinRequests})]})]})}),void 0!==r._count.invitations&&(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,T.jsxs)("div",{className:"flex items-center",children:[(0,T.jsx)("div",{className:"flex-shrink-0 bg-green-100 dark:bg-green-900/30 rounded-lg p-3",children:(0,T.jsx)(Ge.A,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),(0,T.jsxs)("div",{className:"ml-4",children:[(0,T.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:z("organization.invitations")}),(0,T.jsx)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:r._count.invitations})]})]})}),void 0!==r.utilizationPercent&&(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,T.jsxs)("div",{className:"flex items-center",children:[(0,T.jsx)("div",{className:"flex-shrink-0 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg p-3",children:(0,T.jsx)(We.A,{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400"})}),(0,T.jsxs)("div",{className:"ml-4",children:[(0,T.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:z("organization.utilization")}),(0,T.jsxs)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:[r.utilizationPercent,"%"]}),(0,T.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[r.availableSlots," ",z("organization.availableSlots")]})]})]})})]})]})})]})})})}):(0,T.jsxs)("div",{className:"text-center py-8",children:[(0,T.jsx)(n.A,{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500 mb-4"}),(0,T.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:z("organization.notFound")}),(0,T.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:z("organization.createOrJoinHint")})]})]})]}),(0,T.jsx)(ct,{}),(0,T.jsx)(Je,{isOpen:y,onClose:()=>f(!1),onSuccess:()=>{F(!1)}}),(0,T.jsx)(Ye,{isOpen:k,onClose:()=>j(!1),onSuccess:async()=>{F(!1),await R()}}),(0,T.jsx)(nt,{isOpen:w,onClose:()=>{N(!1),null!==e&&void 0!==e&&e.settings&&t((0,m.A)((0,m.A)({},e),{},{settings:void 0}))},onSuccess:()=>{F(!0),L()},organization:e})]})},ut=e=>{let{isOpen:t,onClose:r,joinRequest:l,onSuccess:n}=e;const{t:i}=(0,s.Bd)(),[o,d]=(0,a.useState)("approve"),[c,x]=(0,a.useState)(null),[b,h]=(0,a.useState)(""),[p,k]=(0,a.useState)([]),[j,w]=(0,a.useState)(!1),[N,A]=(0,a.useState)(!1),[S,C]=(0,a.useState)({}),[P,E]=(0,a.useState)(window.innerWidth<640),[z,D]=(0,a.useState)(window.innerWidth>1070),{openSidepane:F,closeSidepane:I}=(0,R.N)(),{showMessage:_}=(0,v.A)();(0,a.useEffect)((()=>{const e=()=>{E(window.innerWidth<640),D(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,a.useEffect)((()=>(t?F():I(),()=>{I()})),[t,F,I]),(0,a.useEffect)((()=>{t&&l&&(d("approve"),x(null),h(""),C({}),l.organizationId&&B())}),[t,l]);const B=async()=>{try{w(!0);const e=await g.Zj.getAll();e.data&&Array.isArray(e.data)&&k(e.data)}catch(e){console.error("Fehler beim Laden der Rollen:",e),_(i("joinRequest.loadRolesError"),"error")}finally{w(!1)}},O=async e=>{if(e.preventDefault(),(()=>{const e={};return"approve"!==o||c||(e.roleId=i("joinRequest.selectRoleError")),C(e),0===Object.keys(e).length})()){if(l)try{A(!0);const e={action:o,response:b.trim()||void 0,roleId:"approve"===o&&c||void 0};await Ke.h.processJoinRequest(l.id,e),_(i("approve"===o?"joinRequest.approveSuccess":"joinRequest.rejectSuccess"),"success"),d("approve"),x(null),h(""),C({}),r(),n()}catch(s){var t,a;const e=(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||i("joinRequest.processError");_(e,"error"),C({submit:e})}finally{A(!1)}}else _(i("joinRequest.fillRequired"),"error")},U=()=>{d("approve"),x(null),h(""),C({}),r()};return l?P?(0,T.jsxs)(u.lG,{open:t,onClose:U,className:"relative z-50",children:[(0,T.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,T.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,T.jsxs)(u.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,T.jsx)(u.lG.Title,{className:"text-lg font-semibold dark:text-white",children:i("joinRequest.title")}),(0,T.jsx)("button",{onClick:U,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("form",{onSubmit:O,className:"p-4",children:[S.submit&&(0,T.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:S.submit}),(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:[(0,T.jsxs)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("joinRequest.applicant"),":"]}),(0,T.jsxs)("p",{className:"text-sm text-gray-900 dark:text-white",children:[l.requester.firstName," ",l.requester.lastName]}),(0,T.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.requester.email}),l.message&&(0,T.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[(0,T.jsxs)("p",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("joinRequest.message"),":"]}),(0,T.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.message})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("joinRequest.actionRequired")}),(0,T.jsxs)("div",{className:"flex gap-4 mt-2",children:[(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"radio",value:"approve",checked:"approve"===o,onChange:e=>{d(e.target.value),C({})},className:"mr-2 text-blue-600 focus:ring-blue-500"}),(0,T.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:i("joinRequest.approve")})]}),(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"radio",value:"reject",checked:"reject"===o,onChange:e=>{d(e.target.value),C({})},className:"mr-2 text-red-600 focus:ring-red-500"}),(0,T.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:i("joinRequest.reject")})]})]})]}),"approve"===o&&(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"roleId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("joinRequest.assignRole")}),j?(0,T.jsxs)("div",{className:"flex items-center py-2",children:[(0,T.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),(0,T.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("joinRequest.loadingRoles")})]}):(0,T.jsxs)("select",{id:"roleId",value:c||"",onChange:e=>{x(Number(e.target.value)||null),S.roleId&&C((e=>(0,m.A)((0,m.A)({},e),{},{roleId:""})))},className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(S.roleId?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"),children:[(0,T.jsx)("option",{value:"",children:i("joinRequest.selectRole")}),p.map((e=>(0,T.jsxs)("option",{value:e.id,children:[e.name," ",e.description?"- ".concat(e.description):""]},e.id)))]}),S.roleId&&(0,T.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:S.roleId})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"response",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("joinRequest.response")}),(0,T.jsx)("textarea",{id:"response",value:b,onChange:e=>h(e.target.value),rows:3,placeholder:i("joinRequest.addOptional",{type:i("approve"===o?"joinRequest.welcomeMessage":"joinRequest.rejectionReason")}),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]}),(0,T.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,T.jsx)("button",{type:"button",onClick:U,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",title:i("joinRequest.cancel"),children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"submit",disabled:N,className:"p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ".concat("approve"===o?"bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500":"bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500"),title:i(N?"approve"===o?"joinRequest.approving":"joinRequest.rejecting":"approve"===o?"joinRequest.approve":"joinRequest.reject"),children:N?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):"approve"===o?(0,T.jsx)(f.A,{className:"h-5 w-5"}):(0,T.jsx)(V.A,{className:"h-5 w-5"})})]})]})]})})]}):(0,T.jsxs)(T.Fragment,{children:[t&&!z&&(0,T.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:U,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,T.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,T.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,T.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:i("joinRequest.title")}),(0,T.jsx)("button",{onClick:U,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,T.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,T.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[S.submit&&(0,T.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:S.submit}),(0,T.jsxs)("form",{onSubmit:O,className:"space-y-4",children:[(0,T.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:[(0,T.jsxs)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("joinRequest.applicant"),":"]}),(0,T.jsxs)("p",{className:"text-sm text-gray-900 dark:text-white",children:[l.requester.firstName," ",l.requester.lastName]}),(0,T.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.requester.email}),l.message&&(0,T.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[(0,T.jsxs)("p",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("joinRequest.message"),":"]}),(0,T.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.message})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("joinRequest.actionRequired")}),(0,T.jsxs)("div",{className:"flex gap-4 mt-2",children:[(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"radio",value:"approve",checked:"approve"===o,onChange:e=>{d(e.target.value),C({})},className:"mr-2 text-blue-600 focus:ring-blue-500"}),(0,T.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:i("joinRequest.approve")})]}),(0,T.jsxs)("label",{className:"flex items-center",children:[(0,T.jsx)("input",{type:"radio",value:"reject",checked:"reject"===o,onChange:e=>{d(e.target.value),C({})},className:"mr-2 text-red-600 focus:ring-red-500"}),(0,T.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:i("joinRequest.reject")})]})]})]}),"approve"===o&&(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"roleId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("joinRequest.assignRole")}),j?(0,T.jsxs)("div",{className:"flex items-center py-2",children:[(0,T.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),(0,T.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("joinRequest.loadingRoles")})]}):(0,T.jsxs)("select",{id:"roleId",value:c||"",onChange:e=>{x(Number(e.target.value)||null),S.roleId&&C((e=>(0,m.A)((0,m.A)({},e),{},{roleId:""})))},className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(S.roleId?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"),children:[(0,T.jsx)("option",{value:"",children:i("joinRequest.selectRole")}),p.map((e=>(0,T.jsxs)("option",{value:e.id,children:[e.name," ",e.description?"- ".concat(e.description):""]},e.id)))]}),S.roleId&&(0,T.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:S.roleId})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{htmlFor:"response",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("joinRequest.response")}),(0,T.jsx)("textarea",{id:"response",value:b,onChange:e=>h(e.target.value),rows:3,placeholder:i("joinRequest.addOptional",{type:i("approve"===o?"joinRequest.welcomeMessage":"joinRequest.rejectionReason")}),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,T.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,T.jsx)("button",{type:"button",onClick:U,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:i("common.cancel"),children:(0,T.jsx)(y.A,{className:"h-5 w-5"})}),(0,T.jsx)("button",{type:"submit",disabled:N,className:"p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ".concat("approve"===o?"bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500":"bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500"),title:N?"approve"===o?"Genehmige...":"Lehne ab...":"approve"===o?"Genehmigen":"Ablehnen",children:N?(0,T.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):"approve"===o?(0,T.jsx)(f.A,{className:"h-5 w-5"}):(0,T.jsx)(V.A,{className:"h-5 w-5"})})]})]})]})]})]}):null},gt=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"approved":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case"rejected":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},xt=(e,t)=>{switch(e){case"pending":return t("joinRequestsList.status.pending");case"approved":return t("joinRequestsList.status.approved");case"rejected":return t("joinRequestsList.status.rejected");case"withdrawn":return t("joinRequestsList.status.withdrawn");default:return e}},bt="join-requests-table",ht=()=>{const{t:e}=(0,s.Bd)(),[t,r]=(0,a.useState)([]),[n,i]=(0,a.useState)(!0),[o,d]=(0,a.useState)(null),[c,m]=(0,a.useState)(!1),[u,g]=(0,a.useState)([]),[x,b]=(0,a.useState)([]),[h,p]=(0,a.useState)(""),[y,f]=(0,a.useState)(!1),[k,j]=(0,a.useState)(null),[A,S]=(0,a.useState)("Alle"),[P,E]=(0,a.useState)(null),{canViewJoinRequests:z,canManageJoinRequests:L,loading:D}=(0,l.S)(),{showMessage:R}=(0,v.A)(),F=(0,a.useRef)(!0),I=(0,a.useRef)(!1);(0,a.useEffect)((()=>{console.log("[JoinRequestsList] permissionsLoading ge\xe4ndert:",D)}),[D]),(0,a.useEffect)((()=>(console.log("[JoinRequestsList] Component mounted, reset hasInitialLoadRef"),I.current=!1,F.current=!0,()=>{console.log("[JoinRequestsList] Component unmounting"),F.current=!1})),[]),(0,a.useEffect)((()=>{if(console.log("[JoinRequestsList] useEffect triggered",{permissionsLoading:D,hasInitialLoad:I.current,joinRequestsCount:t.length}),D)return void console.log("[JoinRequestsList] Warte auf Berechtigungen...");const a=z();if(console.log("[JoinRequestsList] Berechtigung gepr\xfcft:",a),!a)return console.log("[JoinRequestsList] Keine Berechtigung zum Anzeigen"),d(e("joinRequestsList.noPermission")),i(!1),void(I.current=!0);if(I.current)return void console.log("[JoinRequestsList] Bereits geladen, \xfcberspringe Fetch");console.log("[JoinRequestsList] Starte Fetch der Join Requests...");(async()=>{if(F.current)try{console.log("[JoinRequestsList] Setze loading auf true"),i(!0),d(null),console.log("[JoinRequestsList] Rufe organizationService.getJoinRequests() auf..."),console.log("[JoinRequestsList] API Endpoint:",N.Sn.ORGANIZATIONS.JOIN_REQUESTS);const e=await Ke.h.getJoinRequests();if(console.log("[JoinRequestsList] Antwort erhalten:",e),console.log("[JoinRequestsList] Antwort Typ:",typeof e),console.log("[JoinRequestsList] Ist Array:",Array.isArray(e)),console.log("[JoinRequestsList] Ist null/undefined:",null===e||void 0===e),!F.current)return void console.log("[JoinRequestsList] Component w\xe4hrend Request unmounted");if(null===e||void 0===e)throw console.error("[JoinRequestsList] \u274c Antwort ist null oder undefined!"),new Error("Ung\xfcltige Antwort vom Server: Antwort ist null oder undefined");if(!Array.isArray(e))throw console.error("[JoinRequestsList] \u274c Antwort ist kein Array!",e),new Error("Ung\xfcltige Antwort vom Server: Erwartetes Array, erhalten: "+typeof e);console.log("[JoinRequestsList] \u2705 Setze",e.length,"Join Requests"),r(e),d(null),I.current=!0}catch(n){var t,a,s,l;if(console.error("[JoinRequestsList] \u274c Fehler beim Laden:",n),console.error("[JoinRequestsList] Fehler Details:",{message:n.message,response:n.response,status:null===(t=n.response)||void 0===t?void 0:t.status,data:null===(a=n.response)||void 0===a?void 0:a.data,stack:n.stack}),!F.current)return void console.log("[JoinRequestsList] Component w\xe4hrend Error-Handling unmounted");const r=(null===(s=n.response)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.message)||n.message||e("joinRequestsList.loadError",{defaultValue:"Fehler beim Laden der Beitrittsanfragen"});console.log("[JoinRequestsList] Zeige Fehlermeldung:",r),d(r),setTimeout((()=>{R(r,"error")}),0)}finally{F.current&&(console.log("[JoinRequestsList] Setze loading auf false"),i(!1))}else console.log("[JoinRequestsList] Component unmounted, breche ab")})()}),[D]);const _=(e,t)=>{g(e),b(t)},B=()=>{g([]),b([]),S(""),E(null)},O=()=>u.length;(0,a.useEffect)((()=>{(async()=>{try{const e=await w.A.get(N.Sn.SAVED_FILTERS.BY_TABLE(bt)),t=e.data.find((e=>"Alle"===e.name));t&&(S("Alle"),E(t.id),_(t.conditions,t.operators))}catch(o){console.error("Fehler beim Setzen des initialen Filters:",o)}})()}),[]),(0,a.useEffect)((()=>{(async()=>{try{if(!localStorage.getItem("token"))return void console.error("Nicht authentifiziert");const e=(await w.A.get(N.Sn.SAVED_FILTERS.BY_TABLE(bt))).data||[];if(!e.some((e=>"Alle"===e.name))){const e={tableId:bt,name:"Alle",conditions:[],operators:[]};await w.A.post(N.Sn.SAVED_FILTERS.BASE,e),console.log("Alle-Filter f\xfcr Join Requests erstellt")}}catch(o){console.error("Fehler beim Erstellen der Standard-Filter:",o)}})()}),[]);const V=(0,a.useMemo)((()=>{let e=[...t];if(h){const t=h.toLowerCase();e=e.filter((e=>{var r,a;const s="".concat(e.requester.firstName," ").concat(e.requester.lastName).toLowerCase(),l=(null===(r=e.requester.email)||void 0===r?void 0:r.toLowerCase())||"",n=(null===(a=e.message)||void 0===a?void 0:a.toLowerCase())||"";return s.includes(t)||l.includes(t)||n.includes(t)}))}return u.length>0&&(e=u.reduce(((e,t,r)=>{if(!t.column||null===t.value||""===t.value)return e;const a=t.operator,s=t.value;return e.filter((e=>{var r,l;switch(t.column){case"requester":const t="".concat(e.requester.firstName," ").concat(e.requester.lastName).toLowerCase(),n=(null===(r=e.requester.email)||void 0===r?void 0:r.toLowerCase())||"",i=String(s).toLowerCase();return"contains"===a?t.includes(i)||n.includes(i):"equals"===a?t===i||n===i:"startsWith"===a&&(t.startsWith(i)||n.startsWith(i));case"message":const o=(null===(l=e.message)||void 0===l?void 0:l.toLowerCase())||"",d=String(s).toLowerCase();return"contains"===a?o.includes(d):"equals"===a?o===d:"startsWith"===a&&o.startsWith(d);case"status":return"equals"===a&&e.status===s;default:return!0}}))}),e)),e}),[t,h,u,x]);return D?(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6",children:(0,T.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,T.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,T.jsx)("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:e("joinRequestsList.loadingPermissions")})]})}):z()?(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 sm:p-6 mb-6",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-4 sm:mb-4",children:[(0,T.jsxs)("h2",{className:"text-xl sm:text-xl font-semibold flex items-center dark:text-white",children:[(0,T.jsx)(qe.A,{className:"h-6 w-6 sm:h-6 sm:w-6 mr-2 sm:mr-2"}),e("joinRequestsList.title")]}),(0,T.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,T.jsx)("input",{type:"text",placeholder:e("common.search",{defaultValue:"Suchen..."}),className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:h,onChange:e=>p(e.target.value)}),(0,T.jsxs)("button",{className:"p-2 rounded-md border ".concat(O()>0?"border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700"," relative"),onClick:()=>m(!c),title:e("common.filter"),children:[(0,T.jsx)(X.A,{className:"h-5 w-5"}),O()>0&&(0,T.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center",children:O()})]})]})]}),c&&(0,T.jsx)("div",{className:"mb-4",children:(0,T.jsx)($.A,{columns:[{id:"requester",label:e("joinRequestsList.filter.requester")},{id:"message",label:e("joinRequestsList.filter.message")},{id:"status",label:e("joinRequestsList.status.title",{defaultValue:"Status"})}],onApply:_,onReset:B,savedConditions:u,savedOperators:x,tableId:bt})}),(0,T.jsx)(Q.A,{tableId:bt,onSelectFilter:_,onReset:B,activeFilterName:A,selectedFilterId:P,onFilterChange:(e,t,r,a)=>{S(e),E(t),_(r,a)},defaultFilterName:"Alle"}),o&&(0,T.jsx)("div",{className:"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded",children:o}),n?(0,T.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,T.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,T.jsx)("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:e("joinRequestsList.loading")})]}):0===V.length?(0,T.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:0===t.length?e("joinRequestsList.noRequests"):e("joinRequestsList.noMatching")}):(0,T.jsx)("div",{className:"space-y-4",children:V.map((t=>(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,T.jsx)("div",{className:"flex items-start justify-between",children:(0,T.jsxs)("div",{className:"flex-1",children:[(0,T.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[t.requester.firstName," ",t.requester.lastName]}),(0,T.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.requester.email})]}),(0,T.jsx)("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(gt(t.status)),children:xt(t.status,e)})]}),t.message&&(0,T.jsx)("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:(0,T.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[(0,T.jsxs)("span",{className:"font-medium",children:[e("joinRequestsList.filter.message"),":"]})," ",t.message]})}),t.response&&(0,T.jsx)("div",{className:"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700",children:(0,T.jsxs)("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[(0,T.jsxs)("span",{className:"font-medium",children:[e("joinRequestsList.response"),":"]})," ",t.response]})}),"pending"===t.status&&L()&&(0,T.jsx)("div",{className:"mt-4 flex items-center gap-2",children:(0,T.jsxs)("button",{onClick:()=>(t=>{if(!L()){const t=e("joinRequestsList.noPermissionEdit");return d(t),void R(t,"error")}j(t),f(!0)})(t),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-md dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center",children:[(0,T.jsx)(C.A,{className:"h-4 w-4 mr-1"}),e("joinRequestsList.edit")]})})]})})},t.id)))}),(0,T.jsx)(ut,{isOpen:y,onClose:()=>{f(!1),j(null)},joinRequest:k,onSuccess:async()=>{I.current=!1;try{i(!0);const e=await Ke.h.getJoinRequests();r(e),d(null),I.current=!0}catch(a){var e,t;const r=(null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Fehler beim Laden der Beitrittsanfragen";d(r),I.current=!0}finally{i(!1)}}})]}):(0,T.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6",children:(0,T.jsx)("div",{className:"p-4 text-red-600 dark:text-red-400",children:e("joinRequestsList.noPermission")})})},pt=()=>{const{t:e}=(0,s.Bd)(),[t,r]=(0,a.useState)(!1),[m,u]=(0,a.useState)(null),{showMessage:g}=(0,v.A)(),{isAdmin:x,hasPermission:b,canViewOrganization:h,loading:p}=(0,l.S)(),y=b("organization_management","read","page"),f=b("users","read","table"),k=b("roles","read","table"),j=b("branches","read","table"),w=b("tour_providers","read","table"),N=h(),[A,S]=(0,a.useState)("users"),[C,P]=(0,a.useState)("tours"),E=(0,a.useRef)(!1);(0,a.useEffect)((()=>{if(!p&&!E.current){let e="organization";f?e="users":k?e="roles":j?e="branches":w?e="providers":N&&(e="organization"),S(e),E.current=!0}}),[p,f,k,j,w,N]);const z=e=>{("users"!==e||f)&&("roles"!==e||k)&&("branches"!==e||j)&&("providers"!==e||w)&&("organization"!==e||N)&&(S(e),u(null))},L=t=>{var r,a;let s=e("errors.unknownError");null!==(r=t.response)&&void 0!==r&&null!==(a=r.data)&&void 0!==a&&a.message?s=t.response.data.message:t instanceof Error&&(s=t.message),u(s),g(s,"error")};return y?(0,T.jsx)("div",{className:"min-h-screen dark:bg-gray-900",children:(0,T.jsx)("div",{className:"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6",children:(0,T.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,T.jsxs)("div",{className:"flex items-center mb-6",children:[(0,T.jsx)(n.A,{className:"h-6 w-6 mr-2 dark:text-white"}),(0,T.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:e("organisation.title")})]}),(0,T.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:(0,T.jsxs)("nav",{className:"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden",children:[(0,T.jsxs)("button",{className:"".concat("users"===A&&f?"border-blue-500 text-blue-600 dark:text-blue-400":f?"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600":"border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60"," whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0"),onClick:()=>f&&z("users"),disabled:!f,children:[(0,T.jsx)(i.A,{className:"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2"}),e("organisation.tabs.users"),!f&&(0,T.jsx)("span",{className:"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded",children:"PRO"})]}),(0,T.jsxs)("button",{className:"".concat("roles"===A&&k?"border-blue-500 text-blue-600 dark:text-blue-400":k?"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600":"border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60"," whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0"),onClick:()=>k&&z("roles"),disabled:!k,children:[(0,T.jsx)(o.A,{className:"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2"}),e("organisation.tabs.roles"),!k&&(0,T.jsx)("span",{className:"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded",children:"PRO"})]}),(0,T.jsxs)("button",{className:"".concat("branches"===A&&j?"border-blue-500 text-blue-600 dark:text-blue-400":j?"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600":"border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60"," whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0"),onClick:()=>j&&z("branches"),disabled:!j,children:[(0,T.jsx)(d.A,{className:"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2"}),e("organisation.tabs.branches",{defaultValue:"Niederlassungen"}),!j&&(0,T.jsx)("span",{className:"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded",children:"PRO"})]}),(0,T.jsxs)("button",{className:"".concat("providers"===A&&w?"border-blue-500 text-blue-600 dark:text-blue-400":w?"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600":"border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60"," whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0"),onClick:()=>w&&z("providers"),disabled:!w,children:[(0,T.jsx)(c.A,{className:"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2"}),e("organisation.tabs.providers",{defaultValue:"Proveedores"}),!w&&(0,T.jsx)("span",{className:"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded",children:"PRO"})]}),N&&(0,T.jsxs)("button",{className:"".concat("organization"===A?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"," whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center flex-shrink-0"),onClick:()=>z("organization"),children:[(0,T.jsx)(n.A,{className:"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2"}),e("organisation.tabs.organization")]})]})}),m&&(0,T.jsxs)("div",{className:"bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded mb-4",children:[(0,T.jsx)("p",{className:"font-bold",children:e("organisation.error")}),(0,T.jsx)("p",{children:m})]}),t&&(0,T.jsx)("div",{className:"p-4 dark:text-gray-300",children:e("organisation.loading")}),(0,T.jsx)("div",{className:"mt-6",children:"users"===A?f?(0,T.jsx)(H,{onError:L}):(0,T.jsx)("div",{className:"p-8 text-center",children:(0,T.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6",children:[(0,T.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4",children:"PRO"}),(0,T.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mt-4",children:e("organisation.proFeature.users")})]})}):"roles"===A?k?(0,T.jsx)(xe,{onError:L}):(0,T.jsx)("div",{className:"p-8 text-center",children:(0,T.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6",children:[(0,T.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4",children:"PRO"}),(0,T.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mt-4",children:e("organisation.proFeature.roles")})]})}):"branches"===A?j?(0,T.jsx)(pe,{onError:L}):(0,T.jsx)("div",{className:"p-8 text-center",children:(0,T.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6",children:[(0,T.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4",children:"PRO"}),(0,T.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mt-4",children:e("organisation.proFeature.branches",{defaultValue:"Niederlassungs-Verwaltung ist eine PRO-Funktion"})})]})}):"providers"===A?w?(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,T.jsx)("button",{type:"button",onClick:()=>P("tours"),className:"px-3 py-1.5 rounded-full text-sm font-medium transition-colors ".concat("tours"===C?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"),children:e("tours.title","Touren")}),(0,T.jsx)("button",{type:"button",onClick:()=>P("providers"),className:"px-3 py-1.5 rounded-full text-sm font-medium transition-colors ".concat("providers"===C?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"),children:e("organisation.tabs.providers",{defaultValue:"Proveedores"})})]}),"tours"===C?(0,T.jsx)(Me,{onError:L}):(0,T.jsx)(ke,{onError:L})]}):(0,T.jsx)("div",{className:"p-8 text-center",children:(0,T.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6",children:[(0,T.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4",children:"PRO"}),(0,T.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mt-4",children:e("organisation.proFeature.providers",{defaultValue:"Tour-Provider-Verwaltung ist eine PRO-Funktion"})})]})}):"organization"===A&&N?(0,T.jsxs)("div",{className:"space-y-6",children:[(0,T.jsx)(mt,{}),(0,T.jsx)(ht,{})]}):(0,T.jsx)("div",{className:"p-4 text-red-600 dark:text-red-400",children:e("organisation.noPermissionForPage")})})]})})}):(0,T.jsx)("div",{className:"p-4 text-red-600 dark:text-red-400",children:e("organisation.noPermission")})}}}]);
//# sourceMappingURL=619.2f01e2db.chunk.js.map