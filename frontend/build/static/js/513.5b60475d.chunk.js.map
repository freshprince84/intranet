{"version":3,"file":"static/js/513.5b60475d.chunk.js","mappings":"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","sources":["utils/dateUtils.ts","utils/filterLogic.ts","api/clientApi.ts","components/EditClientModal.tsx","components/ClientSelectModal.tsx","components/CreateClientModal.tsx","api/consultationApi.ts","components/ConsultationTracker.tsx","components/LinkTaskModal.tsx","components/InvoiceSuccessModal.tsx","components/CreateInvoiceModal.tsx","components/ConsultationList.tsx","pages/Consultations.tsx"],"sourcesContent":["import { format, parseISO, differenceInMinutes, parse, getWeek, getYear, addDays, startOfWeek } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport { logger } from './logger.ts';\n\n/**\n * Utility-Funktionen fr die Datums- und Zeitverarbeitung im Frontend.\n * Diese Funktionen sorgen fr eine konsistente Handhabung von Datum und Zeit\n * in allen Komponenten.\n */\n\n/**\n * Formatiert ein Datum fr die Anzeige im deutschen Format.\n * @param dateString Das zu formatierende Datum im Format YYYY-MM-DD\n * @returns Formatiertes Datum im Format DD.MM.YYYY oder '-' bei Fehler\n */\nexport const formatDate = (dateString: string): string => {\n    if (!dateString) return '-';\n    \n    try {\n        // Wir erstellen ein neues Date-Objekt und setzen die Uhrzeit auf 12:00 Mittag\n        // um Probleme mit Zeitzonen zu vermeiden\n        const dateParts = dateString.split('-');\n        if (dateParts.length !== 3) return '-';\n        \n        const year = parseInt(dateParts[0]);\n        const month = parseInt(dateParts[1]) - 1; // Monate sind 0-basiert in JavaScript\n        const day = parseInt(dateParts[2]);\n        \n        const date = new Date(year, month, day, 12, 0, 0);\n        \n        return date.toLocaleDateString('de-DE', {\n            day: '2-digit',\n            month: '2-digit',\n            year: 'numeric'\n        });\n    } catch (error) {\n        console.error('Fehler beim Formatieren des Datums:', error);\n        return '-';\n    }\n};\n\n/**\n * Formatiert eine Zeit fr die Anzeige basierend auf UTC.\n * @param dateString Das zu formatierende Datum im ISO-Format\n * @returns Formatierte Zeit im Format HH:MM oder '-' bei Fehler\n */\nexport const formatTime = (dateString: string): string => {\n    if (!dateString) return '-';\n    \n    try {\n        // Direkt aus dem ISO-String die Uhrzeit extrahieren ohne Umrechnung\n        const date = parseISO(dateString);\n        \n        // Verwende UTC-Stunden und -Minuten, um die DB-Zeit direkt zu zeigen\n        const hours = date.getUTCHours().toString().padStart(2, '0');\n        const minutes = date.getUTCMinutes().toString().padStart(2, '0');\n        \n        return `${hours}:${minutes}`;\n    } catch (error) {\n        console.error(`Fehler beim Formatieren der Zeit fr ${dateString}:`, error);\n        return '-';\n    }\n};\n\n/**\n * Berechnet die Dauer zwischen zwei Zeitpunkten und formatiert sie als \"Nh Nm\".\n * @param startTime Startzeit im ISO-Format\n * @param endTime Endzeit im ISO-Format\n * @returns Formatierte Dauer als \"Nh Nm\" oder '-' bei Fehler\n */\nexport const calculateDuration = (startTime: string, endTime: string | null): string => {\n    if (!startTime || !endTime) return '-';\n    \n    try {\n        // Entferne das 'Z' am Ende der ISO-Strings, um Zeitzonenumrechnungen zu verhindern\n        const startISOString = startTime.endsWith('Z') \n            ? startTime.substring(0, startTime.length - 1)\n            : startTime;\n        \n        const endISOString = endTime.endsWith('Z') \n            ? endTime.substring(0, endTime.length - 1)\n            : endTime;\n        \n        const start = new Date(startISOString);\n        const end = new Date(endISOString);\n        \n        const durationMs = end.getTime() - start.getTime();\n        const durationMinutes = Math.floor(durationMs / (1000 * 60));\n        \n        const hours = Math.floor(durationMinutes / 60);\n        const minutes = durationMinutes % 60;\n        \n        return `${hours}h ${minutes}m`;\n    } catch (error) {\n        console.error('Fehler bei der Dauerberechnung:', error);\n        return '-';\n    }\n};\n\n/**\n * Konvertiert ein Wochenformat (YYYY-Www) in ein Datum (YYYY-MM-DD) fr den Montag dieser Woche.\n * @param weekString Wochenformat im Format YYYY-Www\n * @returns Datum des Montags der Woche im Format YYYY-MM-DD\n */\nexport const convertWeekToDate = (weekString: string): string => {\n    try {\n        // Format: YYYY-Www\n        const year = parseInt(weekString.substring(0, 4));\n        const week = parseInt(weekString.substring(6));\n        \n        // Alternative Methode zur Berechnung des Montags fr eine Kalenderwoche\n        // Statt parse mit yyyy und ww (was einen Fehler verursacht) verwenden wir\n        // einen direkten Algorithmus zur Berechnung\n        \n        // 1. Beginne mit dem ersten Tag des Jahres\n        const firstDayOfYear = new Date(Date.UTC(year, 0, 1, 12, 0, 0));\n        \n        // 2. Finde den ersten Donnerstag des Jahres (fr ISO-Wochen)\n        // Verschiebe den Tag, bis wir am ersten Donnerstag sind\n        const dayOfWeek = firstDayOfYear.getUTCDay(); // 0 = Sonntag, 4 = Donnerstag\n        const daysToThursday = dayOfWeek <= 4 ? 4 - dayOfWeek : 11 - dayOfWeek; // Falls Sonntag ist 7\n        const firstThursday = new Date(Date.UTC(year, 0, 1 + daysToThursday, 12, 0, 0));\n        \n        // 3. Der erste Donnerstag ist immer in der ersten Woche\n        // Jetzt berechnen wir den Donnerstag der gewnschten Woche\n        const targetThursday = new Date(Date.UTC(\n            firstThursday.getUTCFullYear(),\n            firstThursday.getUTCMonth(),\n            firstThursday.getUTCDate() + (7 * (week - 1)),\n            12, 0, 0\n        ));\n        \n        // 4. Berechne den Montag dieser Woche (3 Tage vor dem Donnerstag)\n        const monday = new Date(Date.UTC(\n            targetThursday.getUTCFullYear(),\n            targetThursday.getUTCMonth(),\n            targetThursday.getUTCDate() - 3,\n            12, 0, 0\n        ));\n        \n        // Formatiere das Datum als YYYY-MM-DD\n        const formattedDate = format(monday, 'yyyy-MM-dd');\n        \n        // Protokolliere das berechnete Datum fr Debug-Zwecke\n        logger.log(`Konvertierte Woche ${weekString} zu Datum: ${formattedDate} (Wochentag: ${format(monday, 'EEEE', { locale: de })})`);\n        \n        // Zustzliche Sicherheitsberprfung: Stelle sicher, dass es ein Montag ist\n        if (format(monday, 'EEEE', { locale: de }) !== 'Montag') {\n            console.warn(`Berechnetes Datum ist kein Montag! Korrigiere...`);\n            // Finde den nchsten Montag\n            const correctedMonday = startOfWeek(monday, { weekStartsOn: 1 });\n            return format(correctedMonday, 'yyyy-MM-dd');\n        }\n        \n        return formattedDate;\n    } catch (error) {\n        console.error('Fehler beim Konvertieren des Wochendatums:', error);\n        // Im Fehlerfall den letzten Montag als Fallback verwenden\n        const fallbackMonday = startOfWeek(new Date(), { weekStartsOn: 1 });\n        return format(fallbackMonday, 'yyyy-MM-dd');\n    }\n};\n\n/**\n * Prft, ob ein Worktime-Eintrag fr den ausgewhlten Tag relevant ist.\n * @param worktime Der Worktime-Eintrag\n * @param selectedDate Ausgewhltes Datum im Format YYYY-MM-DD\n * @returns true, wenn der Eintrag fr den ausgewhlten Tag relevant ist\n */\nexport const isWorktimeRelevantForSelectedDate = (worktime: any, selectedDate: string): boolean => {\n    try {\n        if (!worktime || !worktime.startTime) return false;\n        \n        // Extrahiere nur den Datumsteil (YYYY-MM-DD) aus dem startTime ISO-String\n        const dateOnly = worktime.startTime.split('T')[0];\n        \n        // Vergleiche mit selectedDate\n        return dateOnly === selectedDate;\n    } catch (error) {\n        console.error(\"Fehler beim Prfen der Relevanz eines Worktime-Eintrags:\", error);\n        return false;\n    }\n};\n\n/**\n * Berechnet die Wochentage von Montag bis Sonntag basierend auf einem Startdatum.\n * @param weekStartDate Montag der Woche im Format YYYY-MM-DD\n * @returns Array von Objekten mit date und day Eigenschaften\n */\nexport const getWeekDays = (weekStartDate: string): Array<{ date: string; day: string }> => {\n    if (!weekStartDate) return [];\n    \n    // Beginne mit dem angegebenen Datum als Montag\n    const weekStart = new Date(weekStartDate);\n    \n    // Berechne alle 7 Tage der Woche\n    const weekDays: Array<{ date: string; day: string }> = [];\n    for (let i = 0; i < 7; i++) {\n        const day = addDays(weekStart, i);\n        const dayInfo = {\n            date: format(day, 'yyyy-MM-dd'),\n            day: format(day, 'EEEE', { locale: de })\n        };\n        weekDays.push(dayInfo);\n    }\n    \n    return weekDays;\n};\n\n/**\n * Formatiert ein ISO-DateTime fr die Anzeige im deutschen Format mit Uhrzeit.\n * Diese Funktion wird speziell fr Cerebro-Artikel verwendet.\n * @param dateTimeString Das zu formatierende Datum im ISO-Format (z.B. 2023-06-15T14:30:00Z)\n * @returns Formatiertes Datum und Uhrzeit im Format DD.MM.YYYY HH:MM\n */\nexport const formatDateTimeForCerebro = (dateTimeString: string): string => {\n    if (!dateTimeString) return '-';\n    \n    try {\n        const date = new Date(dateTimeString);\n        \n        // Datum und Uhrzeit im deutschen Format\n        return date.toLocaleDateString('de-DE', {\n            day: '2-digit',\n            month: '2-digit',\n            year: 'numeric',\n            hour: '2-digit',\n            minute: '2-digit'\n        });\n    } catch (error) {\n        console.error('Fehler beim Formatieren des Datums und der Zeit:', error);\n        return '-';\n    }\n};\n\n/**\n * Berechnet die Quinzena (15-Tage-Periode) fr ein gegebenes Datum.\n * Quinzenas sind monatsbasiert:\n * - Erste Quinzena: 1.-15. des Monats\n * - Zweite Quinzena: 16. bis letzter Tag des Monats\n * @param date Datum im Format YYYY-MM-DD\n * @returns Quinzena-String im Format YYYY-MM-Qq (z.B. \"2025-01-Q1\" fr erste Quinzena Januar)\n */\nexport const getQuinzenaFromDate = (date: string): string => {\n    try {\n        const dateObj = new Date(date + 'T12:00:00');\n        const year = dateObj.getFullYear();\n        const month = dateObj.getMonth() + 1; // 1-12\n        const day = dateObj.getDate();\n        \n        // Erste Quinzena: 1.-15., Zweite Quinzena: 16.-Monatsende\n        const quinzena = day <= 15 ? 1 : 2;\n        \n        return `${year}-${String(month).padStart(2, '0')}-Q${quinzena}`;\n    } catch (error) {\n        console.error('Fehler beim Berechnen der Quinzena:', error);\n        const today = new Date();\n        const year = today.getFullYear();\n        const month = today.getMonth() + 1;\n        return `${year}-${String(month).padStart(2, '0')}-Q1`;\n    }\n};\n\n/**\n * Konvertiert eine Quinzena (YYYY-MM-Qq) in das Startdatum (erster Tag der Quinzena).\n * @param quinzenaString Quinzena im Format YYYY-MM-Qq (z.B. \"2025-01-Q1\")\n * @returns Datum des ersten Tages der Quinzena im Format YYYY-MM-DD\n */\nexport const convertQuinzenaToDate = (quinzenaString: string): string => {\n    try {\n        // Format: YYYY-MM-Qq oder YYYY-Qqq (fr Rckwrtskompatibilitt)\n        let year: number, month: number, quinzena: number;\n        \n        if (quinzenaString.includes('-Q')) {\n            // Format: YYYY-MM-Qq oder YYYY-Qqq\n            const parts = quinzenaString.split('-Q');\n            const datePart = parts[0];\n            quinzena = parseInt(parts[1]);\n            \n            if (datePart.includes('-')) {\n                // Format: YYYY-MM-Qq\n                const dateParts = datePart.split('-');\n                year = parseInt(dateParts[0]);\n                month = parseInt(dateParts[1]);\n            } else {\n                // Format: YYYY-Qqq (Rckwrtskompatibilitt - berechne Monat basierend auf Quinzena)\n                year = parseInt(datePart);\n                // Fr alte Format: Q1 = Jan, Q2 = Feb, etc. (vereinfacht)\n                month = Math.ceil(quinzena / 2);\n            }\n        } else {\n            throw new Error('Ungltiges Quinzena-Format');\n        }\n        \n        // Erste Quinzena beginnt am 1., zweite am 16.\n        const startDay = quinzena === 1 ? 1 : 16;\n        \n        const quinzenaStart = new Date(Date.UTC(year, month - 1, startDay, 12, 0, 0));\n        return format(quinzenaStart, 'yyyy-MM-dd');\n    } catch (error) {\n        console.error('Fehler beim Konvertieren der Quinzena:', error);\n        const fallback = startOfWeek(new Date(), { weekStartsOn: 1 });\n        return format(fallback, 'yyyy-MM-dd');\n    }\n};\n\n/**\n * Berechnet alle Tage einer Quinzena basierend auf einem Startdatum.\n * Erste Quinzena: 15 Tage (1.-15.), Zweite Quinzena: variabel (16.-Monatsende)\n * @param quinzenaStartDate Erster Tag der Quinzena im Format YYYY-MM-DD\n * @returns Array von Objekten mit date und day Eigenschaften\n */\nexport const getQuinzenaDays = (quinzenaStartDate: string): Array<{ date: string; day: string }> => {\n    if (!quinzenaStartDate) return [];\n    \n    const start = new Date(quinzenaStartDate);\n    const year = start.getFullYear();\n    const month = start.getMonth(); // 0-11\n    const day = start.getDate();\n    \n    // Bestimme Anzahl der Tage in der Quinzena\n    let daysCount: number;\n    if (day === 1) {\n        // Erste Quinzena: immer 15 Tage\n        daysCount = 15;\n    } else {\n        // Zweite Quinzena: 16. bis Monatsende\n        // Berechne letzter Tag des Monats\n        const lastDayOfMonth = new Date(year, month + 1, 0).getDate();\n        daysCount = lastDayOfMonth - 15; // 16. bis Monatsende\n    }\n    \n    const quinzenaDays: Array<{ date: string; day: string }> = [];\n    \n    for (let i = 0; i < daysCount; i++) {\n        const currentDay = addDays(start, i);\n        const dayInfo = {\n            date: format(currentDay, 'yyyy-MM-dd'),\n            day: format(currentDay, 'EEEE', { locale: de })\n        };\n        quinzenaDays.push(dayInfo);\n    }\n    \n    return quinzenaDays;\n};\n\n/**\n * Berechnet die aktuelle Quinzena im Format YYYY-MM-Qq.\n * @returns Quinzena-String im Format YYYY-MM-Qq (z.B. \"2025-01-Q1\")\n */\nexport const getCurrentQuinzena = (): string => {\n    const today = new Date();\n    return getQuinzenaFromDate(format(today, 'yyyy-MM-dd'));\n};\n\n/**\n * Hilfsfunktionen fr die Datumsbehandlung im Frontend\n */\n\n/**\n * Erstellt ein Date-Objekt ohne Zeitzonenverschiebung\n * @param dateString Ein ISO-Zeitstring\n * @returns Date-Objekt mit korrigiertem Zeitzonenversatz\n */\nexport const createLocalDate = (dateString: string): Date => {\n  const date = new Date(dateString);\n  // Korrigiere den Zeitzonenversatz\n  return new Date(date.getTime() + date.getTimezoneOffset() * 60000);\n};\n\n/* CLAUDE-ANCHOR: TIMEZONE-CONVERSION-001 - Zentrale Timezone-sichere Konvertierung fr datetime-local Inputs */\n/**\n * KRITISCH: Konvertiert datetime-local Input-Werte korrekt fr die API.\n * \n * PROBLEM: datetime-local gibt lokale Zeit zurck (z.B. \"2024-01-15T14:01\")\n * Wenn wir einfach \":00.000\" anhngen, wird es als UTC interpretiert  5h Unterschied!\n * \n * LSUNG: Explizit als lokale Zeit interpretieren und korrekt formatieren.\n * \n * @param datetimeLocalValue Wert aus datetime-local Input (Format: \"YYYY-MM-DDTHH:mm\")\n * @returns ISO-String der als lokale Zeit interpretiert wird (ohne 'Z' Suffix)\n * \n * @example\n * Input: \"2024-01-15T14:01\" (User gibt 14:01 ein)\n * Output: \"2024-01-15T14:01:00.000\" (wird als lokale Zeit gespeichert)\n * Nicht: \"2024-01-15T14:01:00.000Z\" (wrde als UTC interpretiert)\n */\nexport const convertDatetimeLocalToApi = (datetimeLocalValue: string): string => {\n    if (!datetimeLocalValue) {\n        throw new Error('Datetime-local Wert ist erforderlich');\n    }\n    \n    try {\n        // datetime-local Format: \"YYYY-MM-DDTHH:mm\"\n        // Wir fgen nur Sekunden und Millisekunden hinzu, KEIN 'Z' Suffix\n        const apiFormat = `${datetimeLocalValue}:00.000`;\n        \n        // Zustzliche Validierung: Prfe ob das Format gltig ist\n        if (!/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}$/.test(apiFormat)) {\n            throw new Error(`Ungltiges Datumsformat: ${apiFormat}`);\n        }\n        \n        return apiFormat;\n    } catch (error) {\n        console.error('Fehler bei der Datetime-Local Konvertierung:', error);\n        throw new Error(`Konvertierung von datetime-local fehlgeschlagen: ${datetimeLocalValue}`);\n    }\n};\n\n/**\n * KRITISCH: Konvertiert API-Zeitstempel zurck zu datetime-local Format.\n * \n * Wird verwendet beim Bearbeiten von Zeiten - konvertiert DB-Zeit zurck zu Input-Format.\n * Behandelt sowohl UTC-Timestamps (mit 'Z') als auch lokale Timestamps (ohne 'Z').\n * \n * @param apiTimestamp Zeitstempel aus der API (ISO-String)\n * @returns Formatiert fr datetime-local Input (Format: \"YYYY-MM-DDTHH:mm\")\n * \n * @example\n * Input: \"2024-01-15T14:01:00.000Z\" (UTC aus DB)\n * Output: \"2024-01-15T14:01\" (fr datetime-local Input)\n */\nexport const convertApiToDatetimeLocal = (apiTimestamp: string): string => {\n    if (!apiTimestamp) {\n        throw new Error('API-Timestamp ist erforderlich');\n    }\n    \n    try {\n        // Entferne das 'Z' am Ende des Strings, damit JS den Zeitstempel nicht als UTC interpretiert\n        // Dies ist wichtig fr konsistente Zeitbehandlung\n        const localISOString = apiTimestamp.endsWith('Z')\n            ? apiTimestamp.substring(0, apiTimestamp.length - 1)\n            : apiTimestamp;\n        \n        const date = new Date(localISOString);\n        \n        // Validierung: Prfe ob das Datum gltig ist\n        if (isNaN(date.getTime())) {\n            throw new Error(`Ungltiger Zeitstempel: ${apiTimestamp}`);\n        }\n        \n        // Formatiere fr datetime-local Input: \"YYYY-MM-DDTHH:mm\"\n        const formattedDate = format(date, 'yyyy-MM-dd');\n        const formattedTime = format(date, 'HH:mm');\n        \n        return `${formattedDate}T${formattedTime}`;\n    } catch (error) {\n        console.error('Fehler bei der API-zu-Datetime-Local Konvertierung:', error);\n        throw new Error(`Konvertierung von API-Timestamp fehlgeschlagen: ${apiTimestamp}`);\n    }\n};\n\n/**\n * Formatiert die Gesamtdauer einer Liste von Beratungen in Stunden und Minuten.\n * Bercksichtigt nur abgeschlossene Beratungen (mit endTime).\n * \n * @param consultations Array von Consultation-Objekten\n * @returns Formatierte Gesamtdauer als \"Xh Ym\" oder \"0h 0m\" bei leerer Liste\n * \n * @example\n * // Bei Beratungen mit Gesamtdauer von 125 Minuten\n * formatTotalDuration(consultations) // \"2h 5m\"\n */\nexport const formatTotalDuration = (consultations: Array<{ startTime: string; endTime: string | null }>): string => {\n    try {\n        // Berechne die Gesamtdauer in Minuten\n        const totalMinutes = consultations.reduce((total, consultation) => {\n            // Nur abgeschlossene Beratungen bercksichtigen\n            if (!consultation.endTime) return total;\n            \n            // Berechne Dauer dieser Beratung in Minuten\n            const startTime = consultation.startTime.endsWith('Z') \n                ? consultation.startTime.substring(0, consultation.startTime.length - 1)\n                : consultation.startTime;\n            \n            const endTime = consultation.endTime.endsWith('Z') \n                ? consultation.endTime.substring(0, consultation.endTime.length - 1)\n                : consultation.endTime;\n            \n            const start = new Date(startTime);\n            const end = new Date(endTime);\n            \n            const durationMs = end.getTime() - start.getTime();\n            const durationMinutes = Math.floor(durationMs / (1000 * 60));\n            \n            return total + durationMinutes;\n        }, 0);\n        \n        // Konvertiere zu Stunden und Minuten\n        const hours = Math.floor(totalMinutes / 60);\n        const minutes = totalMinutes % 60;\n        \n        return `${hours}h ${minutes}m`;\n    } catch (error) {\n        console.error('Fehler bei der Formatierung der Gesamtdauer:', error);\n        return '0h 0m';\n    }\n};\n\n/**\n * Prft, ob eine Beratung bereits abgerechnet wurde.\n * \n * @param consultation Consultation-Objekt\n * @returns true wenn abgerechnet, false wenn nicht\n */\nexport const isConsultationInvoiced = (consultation: { invoiceItems?: Array<{ invoice: { status: string } }> }): boolean => {\n    return !!(consultation.invoiceItems && consultation.invoiceItems.length > 0);\n};\n\n/**\n * Holt die Rechnungsinformationen einer Beratung.\n * \n * @param consultation Consultation-Objekt\n * @returns Rechnungsinfo oder null wenn nicht abgerechnet\n */\nexport const getConsultationInvoiceInfo = (consultation: { invoiceItems?: Array<{ invoice: { id: number; invoiceNumber: string; status: string; issueDate: string; total: number } }> }) => {\n    if (!consultation.invoiceItems || consultation.invoiceItems.length === 0) {\n        return null;\n    }\n    \n    // Nimm die erste (und normalerweise einzige) Rechnung\n    const firstItem = consultation.invoiceItems[0];\n    return firstItem.invoice;\n};\n\n/**\n * Erstellt einen benutzerfreundlichen Text fr den Rechnungsstatus.\n * \n * @param status Rechnungsstatus\n * @returns Deutscher Status-Text\n */\nexport const getInvoiceStatusText = (status: 'DRAFT' | 'SENT' | 'PAID' | 'OVERDUE' | 'CANCELLED'): string => {\n    const statusMap = {\n        'DRAFT': 'Entwurf',\n        'SENT': 'Gesendet',\n        'PAID': 'Bezahlt',\n        'OVERDUE': 'berfllig',\n        'CANCELLED': 'Storniert'\n    };\n    return statusMap[status] || status;\n};\n\n/**\n * Gibt die Farbe fr einen Rechnungsstatus zurck.\n * \n * @param status Rechnungsstatus\n * @returns CSS-Klassen fr die Statusfarbe\n */\nexport const getInvoiceStatusColor = (status: 'DRAFT' | 'SENT' | 'PAID' | 'OVERDUE' | 'CANCELLED'): string => {\n    const colorMap = {\n        'DRAFT': 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300',\n        'SENT': 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300',\n        'PAID': 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300',\n        'OVERDUE': 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300',\n        'CANCELLED': 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300'\n    };\n    return colorMap[status] || 'bg-gray-100 text-gray-800';\n}; ","/**\r\n * Zentrale Filter-Logik zur Eliminierung von Code-Duplikation\r\n * \r\n * Diese Datei konsolidiert die Filter-Logik, die zuvor in mehreren Komponenten\r\n * dupliziert war (Requests.tsx, Worktracker.tsx, InvoiceManagementTab.tsx, etc.)\r\n * \r\n * WICHTIG: Die Logik ist exakt identisch mit der vorherigen Implementierung.\r\n * Nur die Code-Duplikation wurde entfernt, keine Funktionalittsnderung!\r\n */\r\n\r\nimport { startOfWeek, endOfWeek, startOfMonth, endOfMonth, startOfYear, endOfYear } from 'date-fns';\r\n\r\nexport interface FilterCondition {\r\n  column: string;\r\n  operator: string;\r\n  value: string | number | Date | null;\r\n}\r\n\r\n/**\r\n * Evaluates a single filter condition against a field value\r\n * @param fieldValue - The value to test against\r\n * @param condition - The filter condition to apply\r\n * @returns true if condition is met, false otherwise\r\n */\r\nexport const evaluateCondition = (\r\n  fieldValue: any,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  const { operator, value } = condition;\r\n  \r\n  // Sicherstellen, dass value definiert ist\r\n  if (value === undefined) {\r\n    console.error('evaluateCondition: value ist undefined', condition);\r\n    return false;\r\n  }\r\n  \r\n  // Handle null/undefined values\r\n  if (fieldValue == null && value == null) {\r\n    return operator === 'equals';\r\n  }\r\n  if (fieldValue == null || value == null) {\r\n    if (operator === 'notEquals') return true;\r\n    return false;\r\n  }\r\n\r\n  // String operations\r\n  // Sicherstellen, dass fieldValue und value Strings sind, bevor toLowerCase() aufgerufen wird\r\n  let strField: string = '';\r\n  let strValue: string = '';\r\n  \r\n  try {\r\n    // Konvertiere fieldValue zu String, auch wenn es ein Objekt ist\r\n    const fieldValueStr = fieldValue == null ? '' : (typeof fieldValue === 'string' ? fieldValue : String(fieldValue));\r\n    if (typeof fieldValueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerField = fieldValueStr.toLowerCase();\r\n    if (lowerField === undefined || lowerField === null || typeof lowerField !== 'string') {\r\n      return false;\r\n    }\r\n    strField = lowerField;\r\n    \r\n    // Konvertiere value zu String, auch wenn es ein Objekt ist\r\n    const valueStr = value == null ? '' : (typeof value === 'string' ? value : String(value));\r\n    if (typeof valueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerValue = valueStr.toLowerCase();\r\n    if (lowerValue === undefined || lowerValue === null || typeof lowerValue !== 'string') {\r\n      return false;\r\n    }\r\n    strValue = lowerValue;\r\n  } catch (error) {\r\n    // Falls toLowerCase() fehlschlgt, gebe false zurck\r\n    return false;\r\n  }\r\n\r\n  // Sicherstellen, dass strField und strValue Strings sind und nicht undefined\r\n  if (typeof strField !== 'string' || typeof strValue !== 'string' || strField === undefined || strValue === undefined || strField === null || strValue === null) {\r\n    return false;\r\n  }\r\n\r\n  switch (operator) {\r\n    case 'equals':\r\n      return strField === strValue;\r\n    case 'notEquals':\r\n      return strField !== strValue;\r\n    case 'contains':\r\n      return strField.includes(strValue);\r\n    case 'startsWith':\r\n      return strField.startsWith(strValue);\r\n    case 'endsWith':\r\n      // Explizite Prfung, dass strField und strValue Strings sind, bevor endsWith aufgerufen wird\r\n      if (strField === undefined || strField === null) {\r\n        console.error('endsWith: strField ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (strValue === undefined || strValue === null) {\r\n        console.error('endsWith: strValue ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strField !== 'string') {\r\n        console.error('endsWith: strField ist kein String', { strField, typeof: typeof strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strValue !== 'string') {\r\n        console.error('endsWith: strValue ist kein String', { strField, strValue, typeof: typeof strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      try {\r\n        return strField.endsWith(strValue);\r\n      } catch (error) {\r\n        console.error('endsWith: Fehler bei endsWith-Aufruf', error, { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n    case 'before':\r\n    case 'after': {\r\n      // Date operations\r\n      const fieldDate = new Date(fieldValue);\r\n      const valueDate = new Date(value as string);\r\n      if (isNaN(fieldDate.getTime()) || isNaN(valueDate.getTime())) {\r\n        return false;\r\n      }\r\n      return operator === 'before' \r\n        ? fieldDate < valueDate \r\n        : fieldDate > valueDate;\r\n    }\r\n    case 'greaterThan':\r\n    case 'lessThan': {\r\n      // Numeric operations\r\n      const fieldNum = parseFloat(String(fieldValue));\r\n      const valueNum = parseFloat(String(value));\r\n      if (isNaN(fieldNum) || isNaN(valueNum)) {\r\n        return false;\r\n      }\r\n      return operator === 'greaterThan'\r\n        ? fieldNum > valueNum\r\n        : fieldNum < valueNum;\r\n    }\r\n    default:\r\n      return true;\r\n  }\r\n};\r\n\r\n/**\r\n * Type for getting field values from items\r\n */\r\nexport type GetFieldValue<T> = (item: T, columnId: string) => any;\r\n\r\n/**\r\n * Type for column-specific evaluation handlers\r\n * Returns true if condition is met, false otherwise\r\n */\r\nexport type ColumnEvaluator<T> = (item: T, condition: FilterCondition) => boolean | null;\r\n\r\n/**\r\n * Applies filter conditions to an array of items\r\n * \r\n * @param items - Array of items to filter\r\n * @param conditions - Array of filter conditions\r\n * @param operators - Array of logical operators ('AND' | 'OR') between conditions\r\n * @param getFieldValue - Function to extract field values from items\r\n * @param columnEvaluators - Optional map of column-specific evaluators for custom logic\r\n * @returns Filtered array of items\r\n * \r\n * @example\r\n * // Standard usage with getFieldValue\r\n * const filtered = applyFilters(items, conditions, operators, (item, col) => item[col]);\r\n * \r\n * // With custom column evaluators\r\n * const filtered = applyFilters(\r\n *   items,\r\n *   conditions,\r\n *   operators,\r\n *   (item, col) => item[col],\r\n *   {\r\n *     'responsible': (item, condition) => {\r\n *       // Custom logic for responsible column\r\n *       return evaluateUserRoleCondition(item.responsible?.id, item.role?.id, condition);\r\n *     }\r\n *   }\r\n * );\r\n */\r\nexport const applyFilters = <T>(\r\n  items: T[],\r\n  conditions: FilterCondition[],\r\n  operators: ('AND' | 'OR')[],\r\n  getFieldValue: GetFieldValue<T>,\r\n  columnEvaluators?: Record<string, ColumnEvaluator<T>>\r\n): T[] => {\r\n  if (conditions.length === 0) {\r\n    return items;\r\n  }\r\n\r\n  return items.filter(item => {\r\n    let result = true;\r\n\r\n    for (let i = 0; i < conditions.length; i++) {\r\n      const condition = conditions[i];\r\n      let conditionMet = false;\r\n\r\n      // Check if there's a custom evaluator for this column\r\n      if (columnEvaluators && columnEvaluators[condition.column]) {\r\n        const customResult = columnEvaluators[condition.column](item, condition);\r\n        if (customResult !== null) {\r\n          conditionMet = customResult;\r\n        } else {\r\n          // Fallback to standard evaluation if custom evaluator returns null\r\n          const fieldValue = getFieldValue(item, condition.column);\r\n          conditionMet = evaluateCondition(fieldValue, condition);\r\n        }\r\n      } else {\r\n        // Standard evaluation\r\n        const fieldValue = getFieldValue(item, condition.column);\r\n        conditionMet = evaluateCondition(fieldValue, condition);\r\n      }\r\n\r\n      // Apply logical operators\r\n      if (i === 0) {\r\n        result = conditionMet;\r\n      } else {\r\n        const operator = operators[i - 1] || 'AND';\r\n        result = operator === 'AND' \r\n          ? (result && conditionMet) \r\n          : (result || conditionMet);\r\n      }\r\n    }\r\n\r\n    return result;\r\n  });\r\n};\r\n\r\n/**\r\n * Helper function to evaluate date conditions with proper date comparison\r\n * Supports __TODAY__ as a dynamic date value\r\n * \r\n * WICHTIG: Extrahiert nur den Datumsteil (Jahr, Monat, Tag) ohne Zeitzone,\r\n * um Zeitzone-Konvertierungsprobleme zu vermeiden (verhindert Tag-Versatz)\r\n */\r\nexport const evaluateDateCondition = (\r\n  dateValue: Date | string | null | undefined,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  if (!dateValue) {\r\n    return false;\r\n  }\r\n\r\n  const date = new Date(dateValue);\r\n  if (isNaN(date.getTime())) {\r\n    return false;\r\n  }\r\n\r\n  // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n  // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n  const dateYear = date.getUTCFullYear();\r\n  const dateMonth = date.getUTCMonth();\r\n  const dateDay = date.getUTCDate();\r\n  // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n  const normalizedDate = new Date(dateYear, dateMonth, dateDay);\r\n\r\n  //  PHASE 5: Handle Zeitraum-Platzhalter (__THIS_WEEK__, __THIS_MONTH__, __THIS_YEAR__)\r\n  // Diese funktionieren analog zu __TODAY__, aber fr Zeitrume\r\n  try {\r\n    if (condition.value === '__THIS_WEEK__') {\r\n      if (condition.operator === 'equals') {\r\n        const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekStart.setHours(0, 0, 0, 0);\r\n        const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= weekStart && normalizedDate <= weekEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Woche als einzelnes Datum\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < weekEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > weekStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_MONTH__') {\r\n      if (condition.operator === 'equals') {\r\n        const monthStart = startOfMonth(new Date());\r\n        monthStart.setHours(0, 0, 0, 0);\r\n        const monthEnd = endOfMonth(new Date());\r\n        monthEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= monthStart && normalizedDate <= monthEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Monat als einzelnes Datum\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < monthEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > monthStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_YEAR__') {\r\n      if (condition.operator === 'equals') {\r\n        const yearStart = startOfYear(new Date());\r\n        yearStart.setHours(0, 0, 0, 0);\r\n        const yearEnd = endOfYear(new Date());\r\n        yearEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= yearStart && normalizedDate <= yearEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Jahr als einzelnes Datum\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < yearEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > yearStart;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    // Handle __TODAY__, __WEEK_START__, __WEEK_END__, __MONTH_START__, __MONTH_END__, __YEAR_START__, __YEAR_END__ dynamic dates\r\n    let conditionDate: Date;\r\n    if (condition.value === '__TODAY__') {\r\n      // Get today's date in local timezone (set to midnight)\r\n      const localToday = new Date();\r\n      localToday.setHours(0, 0, 0, 0);\r\n      conditionDate = localToday;\r\n    } else if (condition.value === '__WEEK_START__') {\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      conditionDate = weekStart;\r\n    } else if (condition.value === '__WEEK_END__') {\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = weekEnd;\r\n    } else if (condition.value === '__MONTH_START__') {\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      conditionDate = monthStart;\r\n    } else if (condition.value === '__MONTH_END__') {\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = monthEnd;\r\n    } else if (condition.value === '__YEAR_START__') {\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      conditionDate = yearStart;\r\n    } else if (condition.value === '__YEAR_END__') {\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = yearEnd;\r\n    } else {\r\n      const conditionDateRaw = new Date(condition.value as string);\r\n      if (isNaN(conditionDateRaw.getTime())) {\r\n        return false;\r\n      }\r\n      // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n      // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n      const conditionYear = conditionDateRaw.getUTCFullYear();\r\n      const conditionMonth = conditionDateRaw.getUTCMonth();\r\n      const conditionDay = conditionDateRaw.getUTCDate();\r\n      // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n      conditionDate = new Date(conditionYear, conditionMonth, conditionDay);\r\n    }\r\n\r\n    switch (condition.operator) {\r\n      case 'equals':\r\n        return normalizedDate.getTime() === conditionDate.getTime();\r\n      case 'before':\r\n        return normalizedDate < conditionDate;\r\n      case 'after':\r\n        return normalizedDate > conditionDate;\r\n      default:\r\n        return true;\r\n    }\r\n  } catch (error) {\r\n    //  PHASE 5: Error Handling fr ungltige Platzhalter-Werte\r\n    console.error(`[evaluateDateCondition] Error with placeholder ${condition.value}:`, error);\r\n    return false; // Fallback: Filter schliet Datensatz aus\r\n  }\r\n};\r\n\r\n/**\r\n * Helper function to evaluate user/role conditions with user-{id} or role-{id} format\r\n * Supports both user-{id} and role-{id} formats, plus text fallback for legacy support\r\n */\r\nexport const evaluateUserRoleCondition = (\r\n  userId: number | null | undefined,\r\n  roleId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  textValue?: string  // Optional: text representation for fallback (e.g. \"John Doe\")\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = userId === targetUserId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = roleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  if (textValue !== undefined) {\r\n    const textValueLower = textValue.toLowerCase();\r\n    const valueLower = value.toLowerCase();\r\n    if (condition.operator === 'equals') {\r\n      return textValueLower === valueLower;\r\n    } else if (condition.operator === 'notEquals') {\r\n      return textValueLower !== valueLower;\r\n    } else if (condition.operator === 'contains') {\r\n      return textValueLower.includes(valueLower);\r\n    }\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n/**\r\n * Helper function for combined responsible/qualityControl filter (specific to Tasks)\r\n */\r\nexport const evaluateResponsibleAndQualityControl = (\r\n  responsibleId: number | null | undefined,\r\n  responsibleRoleId: number | null | undefined,\r\n  qualityControlId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  responsibleText?: string,\r\n  qualityControlText?: string\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format - matches either responsible OR qualityControl\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = (responsibleId === targetUserId) || (qualityControlId === targetUserId);\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format - only matches with responsible role\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = responsibleRoleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  const valueLower = value.toLowerCase();\r\n  if (condition.operator === 'equals') {\r\n    return (responsibleText?.toLowerCase() === valueLower) || (qualityControlText?.toLowerCase() === valueLower);\r\n  } else if (condition.operator === 'notEquals') {\r\n    return (responsibleText?.toLowerCase() !== valueLower) && (qualityControlText?.toLowerCase() !== valueLower);\r\n  } else if (condition.operator === 'contains') {\r\n    return (responsibleText?.toLowerCase()?.includes(valueLower) ?? false) || (qualityControlText?.toLowerCase()?.includes(valueLower) ?? false);\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n","import axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\n\r\n/**\r\n * API-Funktionen fr die Client-Verwaltung\r\n */\r\n\r\nexport interface CreateClientData {\r\n  name: string;\r\n  company?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  address?: string;\r\n  notes?: string;\r\n}\r\n\r\nexport interface UpdateClientData {\r\n  name?: string;\r\n  company?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  address?: string;\r\n  notes?: string;\r\n  isActive?: boolean;\r\n}\r\n\r\n/**\r\n * Holt alle Clients\r\n * @returns Liste aller Clients\r\n */\r\nexport const getClients = async () => {\r\n  try {\r\n    const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.BASE);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden der Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Holt einen einzelnen Client mit seinen Beratungen\r\n * @param clientId ID des Clients\r\n * @returns Client mit seinen letzten Beratungen\r\n */\r\nexport const getClientById = async (clientId: number) => {\r\n  try {\r\n    const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.BY_ID(clientId));\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Erstellt einen neuen Client\r\n * @param data Client-Daten\r\n * @returns Der erstellte Client\r\n */\r\nexport const createClient = async (data: CreateClientData) => {\r\n  try {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.CLIENTS.BASE, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Erstellen des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Aktualisiert einen bestehenden Client\r\n * @param clientId ID des Clients\r\n * @param data Update-Daten\r\n * @returns Der aktualisierte Client\r\n */\r\nexport const updateClient = async (clientId: number, data: UpdateClientData) => {\r\n  try {\r\n    const response = await axiosInstance.put(API_ENDPOINTS.CLIENTS.BY_ID(clientId), data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Aktualisieren des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Lscht einen Client\r\n * @param clientId ID des Clients\r\n * @returns Status der Lschoperation\r\n */\r\nexport const deleteClient = async (clientId: number) => {\r\n  try {\r\n    const response = await axiosInstance.delete(API_ENDPOINTS.CLIENTS.BY_ID(clientId));\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Lschen des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Holt die zuletzt beratenen Clients\r\n * @returns Liste der zuletzt beratenen Clients\r\n */\r\nexport const getRecentClients = async () => {\r\n  try {\r\n    const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.RECENT);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden der zuletzt beratenen Clients:', error);\r\n    throw error;\r\n  }\r\n}; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, TrashIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { Client } from '../types/client.ts';\nimport useMessage from '../hooks/useMessage.ts';\nimport * as clientApi from '../api/clientApi.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface EditClientModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onClientUpdated?: (client: Client) => void;\n  onClientDeleted?: (clientId: number) => void;\n  client: Client | null;\n}\n\nconst EditClientModal: React.FC<EditClientModalProps> = ({\n  isOpen,\n  onClose,\n  onClientUpdated,\n  onClientDeleted,\n  client\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [formData, setFormData] = useState({\n    name: '',\n    company: '',\n    email: '',\n    phone: '',\n    address: '',\n    notes: '',\n    isActive: true\n  });\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [loading, setLoading] = useState(false);\n  const [confirmDelete, setConfirmDelete] = useState(false);\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n\n  // Lade Client-Daten wenn Modal geffnet wird\n  useEffect(() => {\n    if (isOpen && client) {\n      setFormData({\n        name: client.name || '',\n        company: client.company || '',\n        email: client.email || '',\n        phone: client.phone || '',\n        address: client.address || '',\n        notes: client.notes || '',\n        isActive: client.isActive !== undefined ? client.isActive : true\n      });\n      setConfirmDelete(false);\n      setErrors({});\n    }\n  }, [isOpen, client]);\n\n  // berprfung der Bildschirmgre\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.name.trim()) {\n      newErrors.name = 'Name ist erforderlich';\n    }\n    \n    if (formData.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\n      newErrors.email = 'Ungltige E-Mail-Adresse';\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) return;\n    \n    if (!client) return;\n    \n    try {\n      setLoading(true);\n      const updated = await clientApi.updateClient(client.id, {\n        name: formData.name,\n        company: formData.company || undefined,\n        email: formData.email || undefined,\n        phone: formData.phone || undefined,\n        address: formData.address || undefined,\n        notes: formData.notes || undefined,\n        isActive: formData.isActive\n      });\n      \n      showMessage(t('client.updateSuccess', { defaultValue: 'Client erfolgreich aktualisiert' }), 'success');\n      onClientUpdated?.(updated);\n    } catch (error: any) {\n      showMessage(error.response?.data?.message || t('client.updateError', { defaultValue: 'Fehler beim Aktualisieren des Clients' }), 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDelete = async () => {\n    if (!confirmDelete) {\n      setConfirmDelete(true);\n      return;\n    }\n    \n    if (!client) return;\n    \n    try {\n      setLoading(true);\n      await clientApi.deleteClient(client.id);\n      \n      showMessage(t('client.deleteSuccess', { defaultValue: 'Client erfolgreich gelscht' }), 'success');\n      onClientDeleted?.(client.id);\n      onClose();\n    } catch (error: any) {\n      const errorMessage = error.response?.data?.message || t('client.deleteError', { defaultValue: 'Fehler beim Lschen des Clients' });\n      const errorDetails = error.response?.data?.details;\n      const errorSuggestion = error.response?.data?.suggestion;\n      \n      // Zeige detaillierte Fehlermeldung bei Verknpfungen\n      if (error.response?.status === 409 && errorDetails) {\n        const details = Object.entries(errorDetails)\n          .filter(([_, count]) => (count as number) > 0)\n          .map(([key, count]) => {\n            const translationKey = key === 'workTimes' ? 'client.workTimes' : \n                                  key === 'consultationInvoices' ? 'client.consultationInvoices' : \n                                  'client.monthlyReports';\n            return `${count as number} ${t(translationKey, { defaultValue: key === 'workTimes' ? 'Zeiteintrge' : key === 'consultationInvoices' ? 'Rechnungen' : 'Monatsberichte' })}`;\n          })\n          .join(', ');\n        \n        showMessage(`${errorMessage}. ${t('client.links', { defaultValue: 'Verknpfungen' })}: ${details}. ${errorSuggestion || ''}`, 'error');\n      } else {\n        showMessage(errorMessage, 'error');\n      }\n      \n      setConfirmDelete(false);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value, type } = e.target;\n    const checked = (e.target as HTMLInputElement).checked;\n    \n    setFormData(prev => ({\n      ...prev,\n      [name]: type === 'checkbox' ? checked : value\n    }));\n    \n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleClose = () => {\n    setConfirmDelete(false);\n    setErrors({});\n    onClose();\n  };\n\n  if (!client) return null;\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                Client bearbeiten\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              <div className=\"space-y-4\">\n                {/* Name */}\n                <div>\n                  <label htmlFor=\"name_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Name *\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"name_mobile\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.name \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.name && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n                  )}\n                </div>\n\n                {/* Firma */}\n                <div>\n                  <label htmlFor=\"company_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Firma\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"company_mobile\"\n                    name=\"company\"\n                    value={formData.company}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* E-Mail */}\n                <div>\n                  <label htmlFor=\"email_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    E-Mail\n                  </label>\n                  <input\n                    type=\"email\"\n                    id=\"email_mobile\"\n                    name=\"email\"\n                    value={formData.email}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.email \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.email && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n                  )}\n                </div>\n\n                {/* Telefon */}\n                <div>\n                  <label htmlFor=\"phone_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Telefon\n                  </label>\n                  <input\n                    type=\"tel\"\n                    id=\"phone_mobile\"\n                    name=\"phone\"\n                    value={formData.phone}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Adresse */}\n                <div>\n                  <label htmlFor=\"address_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Adresse\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"address_mobile\"\n                    name=\"address\"\n                    value={formData.address}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Notizen */}\n                <div>\n                  <label htmlFor=\"notes_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Notizen\n                  </label>\n                  <textarea\n                    id=\"notes_mobile\"\n                    name=\"notes\"\n                    rows={3}\n                    value={formData.notes}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Aktiv-Status */}\n                <div className=\"flex items-center\">\n                  <input\n                    type=\"checkbox\"\n                    id=\"isActive_mobile\"\n                    name=\"isActive\"\n                    checked={formData.isActive}\n                    onChange={handleChange}\n                    className=\"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:text-gray-300\"\n                  />\n                  <label htmlFor=\"isActive_mobile\" className=\"ml-2 block text-sm text-gray-700 dark:text-gray-300\">\n                    Aktiv\n                  </label>\n                </div>\n              </div>\n\n              {/* Buttons */}\n              <div className=\"mt-6 flex items-center justify-between\">\n                <button\n                  type=\"button\"\n                  onClick={handleDelete}\n                  disabled={loading}\n                  className={`inline-flex items-center px-4 py-2 border ${\n                    confirmDelete\n                      ? 'border-red-300 text-red-700 bg-red-50 dark:border-red-600 dark:text-red-400 dark:bg-red-900/20'\n                      : 'border-red-300 text-red-700 bg-white hover:bg-red-50 dark:border-red-600 dark:text-red-400 dark:bg-gray-700 dark:hover:bg-gray-600'\n                  } text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed`}\n                >\n                  <TrashIcon className=\"h-5 w-5 mr-2\" />\n                  {confirmDelete ? 'Wirklich lschen?' : 'Lschen'}\n                </button>\n\n                <div className=\"flex space-x-3\">\n                  <button\n                    type=\"button\"\n                    onClick={handleClose}\n                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                    title={t('common.cancel')}\n                  >\n                    <XMarkIcon className=\"h-5 w-5\" />\n                  </button>\n                  <button\n                    type=\"submit\"\n                    disabled={loading}\n                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                    title={loading ? 'Speichere...' : 'Speichern'}\n                  >\n                    {loading ? (\n                      <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                    ) : (\n                      <CheckIcon className=\"h-5 w-5\" />\n                    )}\n                  </button>\n                </div>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            Client bearbeiten\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {Object.keys(errors).length > 0 && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {Object.values(errors).map((error, idx) => (\n                <p key={idx}>{error}</p>\n              ))}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Name */}\n            <div>\n              <label htmlFor=\"name\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Name *\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.name \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.name && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n              )}\n            </div>\n\n            {/* Firma */}\n            <div>\n              <label htmlFor=\"company\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Firma\n              </label>\n              <input\n                type=\"text\"\n                id=\"company\"\n                name=\"company\"\n                value={formData.company}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* E-Mail */}\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                E-Mail\n              </label>\n              <input\n                type=\"email\"\n                id=\"email\"\n                name=\"email\"\n                value={formData.email}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.email \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.email && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n              )}\n            </div>\n\n            {/* Telefon */}\n            <div>\n              <label htmlFor=\"phone\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Telefon\n              </label>\n              <input\n                type=\"tel\"\n                id=\"phone\"\n                name=\"phone\"\n                value={formData.phone}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Adresse */}\n            <div>\n              <label htmlFor=\"address\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Adresse\n              </label>\n              <input\n                type=\"text\"\n                id=\"address\"\n                name=\"address\"\n                value={formData.address}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Notizen */}\n            <div>\n              <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Notizen\n              </label>\n              <textarea\n                id=\"notes\"\n                name=\"notes\"\n                rows={3}\n                value={formData.notes}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Aktiv-Status */}\n            <div className=\"flex items-center\">\n              <input\n                type=\"checkbox\"\n                id=\"isActive\"\n                name=\"isActive\"\n                checked={formData.isActive}\n                onChange={handleChange}\n                className=\"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:text-gray-300\"\n              />\n              <label htmlFor=\"isActive\" className=\"ml-2 block text-sm text-gray-700 dark:text-gray-300\">\n                Aktiv\n              </label>\n            </div>\n\n            {/* Buttons */}\n            <div className=\"flex items-center justify-between pt-4\">\n              <button\n                type=\"button\"\n                onClick={handleDelete}\n                disabled={loading}\n                className={`p-2 rounded-md ${\n                  confirmDelete\n                    ? 'bg-red-600 text-white dark:bg-red-700 dark:text-white hover:bg-red-700 dark:hover:bg-red-600'\n                    : 'text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300'\n                } disabled:opacity-50 disabled:cursor-not-allowed`}\n                title={confirmDelete ? 'Lschen besttigen' : 'Client lschen'}\n              >\n                {confirmDelete ? (\n                  <CheckIcon className=\"h-5 w-5\" />\n                ) : (\n                  <TrashIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n\n              <div className=\"flex gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                  title={loading ? 'Speichere...' : 'Speichern'}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default EditClientModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { Dialog } from '@headlessui/react';\nimport { useTranslation } from 'react-i18next';\nimport { MagnifyingGlassIcon, XMarkIcon, PlusIcon, PencilIcon, TrashIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { Client } from '../types/client.ts';\nimport { toast } from 'react-toastify';\nimport * as clientApi from '../api/clientApi.ts';\nimport EditClientModal from './EditClientModal.tsx';\n\ninterface ClientSelectModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSelect: (client: Client) => void;\n  onCreateNew: () => void;\n}\n\nconst ClientSelectModal: React.FC<ClientSelectModalProps> = ({\n  isOpen,\n  onClose,\n  onSelect,\n  onCreateNew\n}) => {\n  const { t } = useTranslation();\n  const [clients, setClients] = useState<Client[]>([]);\n  const [filteredClients, setFilteredClients] = useState<Client[]>([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [editingClient, setEditingClient] = useState<Client | null>(null);\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n\n  useEffect(() => {\n    if (isOpen) {\n      loadClients();\n    }\n  }, [isOpen]);\n\n  useEffect(() => {\n    if (searchTerm) {\n      const filtered = clients.filter(client => \n        client.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        (client.company && client.company.toLowerCase().includes(searchTerm.toLowerCase())) ||\n        (client.email && client.email.toLowerCase().includes(searchTerm.toLowerCase()))\n      );\n      setFilteredClients(filtered);\n    } else {\n      setFilteredClients(clients);\n    }\n  }, [searchTerm, clients]);\n\n  const loadClients = async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.BASE);\n      setClients(response.data);\n      setFilteredClients(response.data);\n    } catch (error) {\n      // Stille Behandlung - Fehler wird im UI durch leere Liste sichtbar\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleEdit = (client: Client, e: React.MouseEvent) => {\n    e.stopPropagation();\n    setEditingClient(client);\n    setIsEditModalOpen(true);\n  };\n\n  const handleDelete = async (client: Client, e: React.MouseEvent) => {\n    e.stopPropagation();\n    \n    if (!window.confirm(t('client.deleteConfirm', { name: client.name }))) {\n      return;\n    }\n\n    try {\n      await clientApi.deleteClient(client.id);\n      toast.success(t('client.deleteSuccess'));\n      loadClients(); // Liste neu laden\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || t('client.deleteError'));\n    }\n  };\n\n  const handleClientUpdated = (updatedClient: Client) => {\n    // Aktualisiere lokale Liste\n    const index = clients.findIndex(c => c.id === updatedClient.id);\n    if (index !== -1) {\n      const newClients = [...clients];\n      newClients[index] = updatedClient;\n      setClients(newClients);\n      setFilteredClients(newClients);\n    }\n    setIsEditModalOpen(false);\n    setEditingClient(null);\n  };\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      \n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n        <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n          <div className=\"p-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                Client auswhlen\n              </Dialog.Title>\n              <button\n                onClick={onClose}\n                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            {/* Suchfeld */}\n            <div className=\"relative mb-4\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <MagnifyingGlassIcon className=\"h-5 w-5 text-gray-400\" />\n              </div>\n              <input\n                type=\"text\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\n                placeholder=\"Client suchen...\"\n                autoFocus\n              />\n            </div>\n\n            {/* Client-Liste */}\n            <div className=\"max-h-96 overflow-y-auto\">\n              {loading ? (\n                <div className=\"text-center py-4 text-gray-500 dark:text-gray-400\">\n                  Lade Clients...\n                </div>\n              ) : filteredClients.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <p className=\"text-gray-500 dark:text-gray-400 mb-4\">\n                    {searchTerm ? 'Keine Clients gefunden' : 'Noch keine Clients vorhanden'}\n                  </p>\n                  <button\n                    onClick={onCreateNew}\n                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-500 dark:hover:bg-blue-600\"\n                    title=\"Neuen Client anlegen\"\n                  >\n                    <PlusIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              ) : (\n                <ul className=\"divide-y divide-gray-200 dark:divide-gray-700\">\n                  {filteredClients.map((client) => (\n                    <li key={client.id}>\n                      <div className=\"flex items-center\">\n                        <button\n                          onClick={() => onSelect(client)}\n                          className=\"flex-1 px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 text-left transition-colors\"\n                        >\n                          <div>\n                            <p className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                              {client.name}\n                            </p>\n                            {client.company && (\n                              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                {client.company}\n                              </p>\n                            )}\n                            {client.email && (\n                              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                {client.email}\n                              </p>\n                            )}\n                          </div>\n                        </button>\n                        <div className=\"flex items-center space-x-2 px-2\">\n                          <button\n                            onClick={(e) => handleEdit(client, e)}\n                            className=\"p-2 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors\"\n                            title=\"Client bearbeiten\"\n                          >\n                            <PencilIcon className=\"h-5 w-5\" />\n                          </button>\n                          <button\n                            onClick={(e) => handleDelete(client, e)}\n                            className=\"p-2 text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors\"\n                            title={t('client.deleteTitle')}\n                          >\n                            <TrashIcon className=\"h-5 w-5\" />\n                          </button>\n                        </div>\n                      </div>\n                    </li>\n                  ))}\n                </ul>\n              )}\n            </div>\n\n            {/* Footer mit \"Neuer Client\" Button */}\n            {filteredClients.length > 0 && (\n              <div className=\"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                <button\n                  onClick={onCreateNew}\n                  className=\"w-full flex items-center justify-center p-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                  title=\"Neuen Client anlegen\"\n                >\n                  <PlusIcon className=\"h-5 w-5\" />\n                </button>\n              </div>\n            )}\n          </div>\n        </Dialog.Panel>\n      </div>\n\n      {/* Edit Modal */}\n      {editingClient && (\n        <EditClientModal\n          isOpen={isEditModalOpen}\n          onClose={() => {\n            setIsEditModalOpen(false);\n            setEditingClient(null);\n          }}\n          onClientUpdated={handleClientUpdated}\n          onClientDeleted={(clientId) => {\n            // Ldt Liste neu nach Lschung\n            loadClients();\n            setIsEditModalOpen(false);\n            setEditingClient(null);\n          }}\n          client={editingClient}\n        />\n      )}\n    </Dialog>\n  );\n};\n\nexport default ClientSelectModal; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { Client } from '../types/client.ts';\nimport useMessage from '../hooks/useMessage.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface CreateClientModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSave: (client: Client) => void;\n}\n\nconst CreateClientModal: React.FC<CreateClientModalProps> = ({\n  isOpen,\n  onClose,\n  onSave\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [formData, setFormData] = useState({\n    name: '',\n    company: '',\n    email: '',\n    phone: '',\n    address: '',\n    notes: ''\n  });\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [loading, setLoading] = useState(false);\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.name.trim()) {\n      newErrors.name = 'Name ist erforderlich';\n    }\n    \n    if (formData.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\n      newErrors.email = 'Ungltige E-Mail-Adresse';\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) return;\n    \n    try {\n      setLoading(true);\n      const response = await axiosInstance.post(API_ENDPOINTS.CLIENTS.BASE, {\n        ...formData,\n        company: formData.company || null,\n        email: formData.email || null,\n        phone: formData.phone || null,\n        address: formData.address || null,\n        notes: formData.notes || null\n      });\n      \n      showMessage(t('client.createSuccess', { defaultValue: 'Client erfolgreich angelegt' }), 'success');\n      onSave(response.data);\n      \n      // Form zurcksetzen\n      setFormData({\n        name: '',\n        company: '',\n        email: '',\n        phone: '',\n        address: '',\n        notes: ''\n      });\n    } catch (error: any) {\n      showMessage(error.response?.data?.message || t('client.createError', { defaultValue: 'Fehler beim Anlegen des Clients' }), 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // berprfung der Bildschirmgre\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    // Initial prfen\n    checkScreenSize();\n    \n    // Event-Listener fr Grennderungen\n    window.addEventListener('resize', checkScreenSize);\n    \n    // Cleanup\n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleClose = () => {\n    // Form zurcksetzen\n    setFormData({\n      name: '',\n      company: '',\n      email: '',\n      phone: '',\n      address: '',\n      notes: ''\n    });\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                Neuen Client anlegen\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              <div className=\"space-y-4\">\n                {/* Name */}\n                <div>\n                  <label htmlFor=\"name_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Name *\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"name_mobile\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.name \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.name && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n                  )}\n                </div>\n\n                {/* Firma */}\n                <div>\n                  <label htmlFor=\"company_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Firma\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"company_mobile\"\n                    name=\"company\"\n                    value={formData.company}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* E-Mail */}\n                <div>\n                  <label htmlFor=\"email_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    E-Mail\n                  </label>\n                  <input\n                    type=\"email\"\n                    id=\"email_mobile\"\n                    name=\"email\"\n                    value={formData.email}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.email \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.email && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n                  )}\n                </div>\n\n                {/* Telefon */}\n                <div>\n                  <label htmlFor=\"phone_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Telefon\n                  </label>\n                  <input\n                    type=\"tel\"\n                    id=\"phone_mobile\"\n                    name=\"phone\"\n                    value={formData.phone}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Adresse */}\n                <div>\n                  <label htmlFor=\"address_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Adresse\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"address_mobile\"\n                    name=\"address\"\n                    value={formData.address}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Notizen */}\n                <div>\n                  <label htmlFor=\"notes_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Notizen\n                  </label>\n                  <textarea\n                    id=\"notes_mobile\"\n                    name=\"notes\"\n                    rows={3}\n                    value={formData.notes}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n              </div>\n\n              {/* Buttons */}\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? 'Speichere...' : 'Speichern'}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            Neuen Client anlegen\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {Object.keys(errors).length > 0 && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {Object.values(errors).map((error, idx) => (\n                <p key={idx}>{error}</p>\n              ))}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Name */}\n            <div>\n              <label htmlFor=\"name\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Name *\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.name \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.name && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n              )}\n            </div>\n\n            {/* Firma */}\n            <div>\n              <label htmlFor=\"company\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Firma\n              </label>\n              <input\n                type=\"text\"\n                id=\"company\"\n                name=\"company\"\n                value={formData.company}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* E-Mail */}\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                E-Mail\n              </label>\n              <input\n                type=\"email\"\n                id=\"email\"\n                name=\"email\"\n                value={formData.email}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.email \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.email && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n              )}\n            </div>\n\n            {/* Telefon */}\n            <div>\n              <label htmlFor=\"phone\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Telefon\n              </label>\n              <input\n                type=\"tel\"\n                id=\"phone\"\n                name=\"phone\"\n                value={formData.phone}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Adresse */}\n            <div>\n              <label htmlFor=\"address\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Adresse\n              </label>\n              <input\n                type=\"text\"\n                id=\"address\"\n                name=\"address\"\n                value={formData.address}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Notizen */}\n            <div>\n              <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Notizen\n              </label>\n              <textarea\n                id=\"notes\"\n                name=\"notes\"\n                rows={3}\n                value={formData.notes}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Buttons */}\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? 'Speichere...' : 'Speichern'}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default CreateClientModal; ","import axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\n\r\n/**\r\n * API-Funktionen fr das Consultation-Modul\r\n */\r\n\r\nexport interface StartConsultationData {\r\n  branchId: number;\r\n  clientId: number;\r\n  notes?: string;\r\n  startTime?: string;\r\n}\r\n\r\nexport interface StopConsultationData {\r\n  endTime?: string;\r\n  notes?: string;\r\n}\r\n\r\nexport interface UpdateNotesData {\r\n  notes: string;\r\n}\r\n\r\nexport interface LinkTaskData {\r\n  taskId: number;\r\n}\r\n\r\nexport interface CreateTaskData {\r\n  title: string;\r\n  description: string;\r\n  dueDate?: string;\r\n  branchId: number;\r\n  qualityControlId?: number;\r\n}\r\n\r\nexport interface UpdateTimeData {\r\n  startTime?: string;\r\n  endTime?: string;\r\n}\r\n\r\n/**\r\n * Startet eine neue Beratung\r\n * @param data Beratungsdaten (branchId, clientId, notes, startTime)\r\n * @returns Die erstellte Beratung\r\n */\r\nexport const startConsultation = async (data: StartConsultationData) => {\r\n  try {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.CONSULTATIONS.START, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Starten der Beratung:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Stoppt eine laufende Beratung\r\n * @param data Stopp-Daten (endTime, notes)\r\n * @returns Die aktualisierte Beratung\r\n */\r\nexport const stopConsultation = async (data: StopConsultationData) => {\r\n  try {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.CONSULTATIONS.STOP, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Stoppen der Beratung:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Holt alle Beratungen des aktuellen Benutzers\r\n * @param clientId Optionale Client-ID zum Filtern\r\n * @param from Optionales Start-Datum\r\n * @param to Optionales End-Datum\r\n * @returns Liste der Beratungen\r\n */\r\nexport const getConsultations = async (clientId?: number, from?: string, to?: string) => {\r\n  try {\r\n    const params = new URLSearchParams();\r\n    if (clientId) params.append('clientId', clientId.toString());\r\n    if (from) params.append('from', from);\r\n    if (to) params.append('to', to);\r\n    \r\n    const url = params.toString() \r\n      ? `${API_ENDPOINTS.CONSULTATIONS.BASE}?${params}`\r\n      : API_ENDPOINTS.CONSULTATIONS.BASE;\r\n      \r\n    const response = await axiosInstance.get(url);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden der Beratungen:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Aktualisiert die Notizen einer Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Notizen-Daten\r\n * @returns Die aktualisierte Beratung\r\n */\r\nexport const updateConsultationNotes = async (consultationId: number, data: UpdateNotesData) => {\r\n  try {\r\n    const response = await axiosInstance.patch(\r\n      API_ENDPOINTS.CONSULTATIONS.UPDATE_NOTES(consultationId), \r\n      data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Aktualisieren der Notizen:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Verknpft einen Task mit einer Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Task-Verknpfungsdaten\r\n * @returns Status der Verknpfung\r\n */\r\nexport const linkTaskToConsultation = async (consultationId: number, data: LinkTaskData) => {\r\n  try {\r\n    const response = await axiosInstance.post(\r\n      API_ENDPOINTS.CONSULTATIONS.LINK_TASK(consultationId), \r\n      data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Verknpfen des Tasks:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Erstellt einen neuen Task fr eine Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Task-Erstellungsdaten\r\n * @returns Der erstellte Task\r\n */\r\nexport const createTaskForConsultation = async (consultationId: number, data: CreateTaskData) => {\r\n  try {\r\n    const response = await axiosInstance.post(\r\n      API_ENDPOINTS.CONSULTATIONS.CREATE_TASK(consultationId), \r\n      data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Erstellen des Tasks:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Lscht eine Beratung\r\n * @param consultationId ID der Beratung\r\n * @returns Status der Lschoperation\r\n */\r\nexport const deleteConsultation = async (consultationId: number) => {\r\n  try {\r\n    const response = await axiosInstance.delete(API_ENDPOINTS.CONSULTATIONS.BY_ID(consultationId));\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Lschen der Beratung:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Aktualisiert die Start- oder Endzeit einer Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Zeit-Update-Daten (startTime oder endTime)\r\n * @returns Die aktualisierte Beratung\r\n */\r\nexport const updateConsultationTime = async (consultationId: number, data: UpdateTimeData) => {\r\n  try {\r\n    /* KONSISTENTE API-BEHANDLUNG:\r\n     * Diese Funktion kapselt die Zeit-Update-Logik und macht sie testbar und wartbar.\r\n     * Verwendet den WorkTime-Endpoint, da Consultations erweiterte WorkTime-Eintrge sind.\r\n     */\r\n    const response = await axiosInstance.put(`${API_ENDPOINTS.WORKTIME.BASE}/${consultationId}`, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Aktualisieren der Zeit:', error);\r\n    throw error;\r\n  }\r\n}; ","import React, { useState, useEffect, useRef, useLayoutEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PlayIcon, StopIcon, PlusIcon, ClockIcon, UserGroupIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { formatTime, calculateDuration } from '../utils/dateUtils.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { logger } from '../utils/logger.ts';\nimport { useBranch } from '../contexts/BranchContext.tsx';\nimport { useResizeObserver } from '../hooks/useResizeObserver.ts';\nimport { toast } from 'react-toastify';\nimport ClientSelectModal from './ClientSelectModal.tsx';\nimport CreateClientModal from './CreateClientModal.tsx';\nimport { Client, Consultation } from '../types/client.ts';\nimport * as consultationApi from '../api/consultationApi.ts';\nimport * as clientApi from '../api/clientApi.ts';\n\n// Union-Type fr Client und Placeholder\ntype ClientOrPlaceholder = Client | {\n  id: string;\n  name: string;\n  isPlaceholder: boolean;\n  status?: 'past' | 'planned';\n  lastConsultationDate?: string;\n};\n\n// Type Guard fr Placeholder\nconst isPlaceholder = (client: ClientOrPlaceholder): client is { id: string; name: string; isPlaceholder: boolean; status?: 'past' | 'planned'; lastConsultationDate?: string; } => {\n  return 'isPlaceholder' in client && client.isPlaceholder === true;\n};\n\ninterface ConsultationTrackerProps {\n  onConsultationChange: () => void;\n  onConsultationStarted?: (clientName: string) => void;\n}\n\nconst ConsultationTracker: React.FC<ConsultationTrackerProps> = ({ onConsultationChange, onConsultationStarted }) => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const { selectedBranch } = useBranch();\n  const [activeConsultation, setActiveConsultation] = useState<Consultation | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [isStarting, setIsStarting] = useState(false);\n  const [isClientSelectModalOpen, setIsClientSelectModalOpen] = useState(false);\n  const [isCreateClientModalOpen, setIsCreateClientModalOpen] = useState(false);\n  const [selectedClient, setSelectedClient] = useState<Client | null>(null);\n  const [recentClients, setRecentClients] = useState<Client[]>([]);\n  const [notes, setNotes] = useState('');\n  const [lastStartedClientId, setLastStartedClientId] = useState<number | null>(null);\n  \n  // Responsive Tag-Display States (optimiert)\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [visibleTagCount, setVisibleTagCount] = useState(3); // Fallback fr SSR\n  const [containerWidth, setContainerWidth] = useState(0);\n\n  // Manuelle Erfassung States\n  const [isManualEntry, setIsManualEntry] = useState(false);\n  const [manualStartTime, setManualStartTime] = useState('');\n  const [manualEndTime, setManualEndTime] = useState('');\n\n  useEffect(() => {\n    checkActiveConsultation();\n    loadRecentClients();\n  }, []);\n\n  const checkActiveConsultation = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.WORKTIME.ACTIVE);\n      if (response.data && response.data.clientId) {\n        setActiveConsultation(response.data);\n        setNotes(response.data.notes || '');\n      }\n    } catch (error) {\n      // Stille Behandlung - normale Situation wenn keine aktive Beratung luft\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadRecentClients = async () => {\n    try {\n      logger.log('=== FRONTEND: loadRecentClients() called ===');\n      const clients = await clientApi.getRecentClients();\n      logger.log('=== FRONTEND: received clients:', clients);\n      setRecentClients(clients || []);\n    } catch (error) {\n      console.error('=== FRONTEND: loadRecentClients() ERROR ===', error);\n      // Stille Behandlung - normale Situation wenn noch keine Clients beraten wurden\n    }\n  };\n\n  const handleStartConsultation = async (clientId: number, notes?: string) => {\n    if (!selectedBranch) {\n      toast.error(t('consultations.selectBranch'));\n      return;\n    }\n\n    try {\n      setIsStarting(true);\n      \n      // Zeitzone-korrigierte aktuelle Zeit (gleiche Logik wie bei stopConsultation)\n      const correctedStartTime = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000);\n      \n      const consultation = await consultationApi.startConsultation({\n        branchId: selectedBranch,\n        clientId,\n        notes: notes || '',\n        startTime: correctedStartTime.toISOString()\n      });\n\n      setActiveConsultation(consultation);\n      setNotes(notes || '');\n      setSelectedClient(null);\n      setIsClientSelectModalOpen(false);\n      \n      // Speichere den zuletzt gestarteten Client fr Tag-Priorisierung\n      setLastStartedClientId(clientId);\n      \n      // Sende Event fr SavedFilterTags Aktualisierung\n      window.dispatchEvent(new CustomEvent('consultationChanged'));\n      \n      // Entfernt: Frontend LRU-Logic - Backend sortiert bereits korrekt nach startTime DESC\n      // Lade Recent Clients neu vom Server (Backend liefert bereits richtige Sortierung)\n      loadRecentClients();\n      \n      // Callback fr Parent-Komponente - bergebe die neue Consultation\n      onConsultationChange?.(consultation);\n      \n      // Callback fr Filter-Wechsel (wenn Client-Name verfgbar)\n      if (onConsultationStarted && consultation.client?.name) {\n        onConsultationStarted(consultation.client.name);\n      }\n      \n      toast.success(t('consultations.started'));\n    } catch (error) {\n      console.error('Fehler beim Starten der Beratung:', error);\n      toast.error(t('consultations.startError'));\n    } finally {\n      setIsStarting(false);\n    }\n  };\n\n  const stopConsultation = async () => {\n    try {\n      const correctedEndTime = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000);\n      \n      const stoppedConsultation = await consultationApi.stopConsultation({\n        endTime: correctedEndTime.toISOString(),\n        notes: notes || undefined\n      });\n      setActiveConsultation(null);\n      setNotes('');\n      toast.success(t('consultations.stopped'));\n      // Recent Clients nach dem Stoppen aktualisieren\n      loadRecentClients();\n      // Beratungsliste aktualisieren - bergebe die aktualisierte Consultation\n      onConsultationChange?.(stoppedConsultation);\n      // Sende Event fr SavedFilterTags Aktualisierung\n      logger.log(' ConsultationTracker: Sending consultationChanged event (stop)');\n      window.dispatchEvent(new CustomEvent('consultationChanged'));\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || t('consultations.stopError'));\n    }\n  };\n\n  const handleClientSelect = (client: Client) => {\n    setSelectedClient(client);\n    setIsClientSelectModalOpen(false);\n    if (!isManualEntry) {\n      handleStartConsultation(client.id, notes);\n    }\n  };\n\n  const handleCreateClient = () => {\n    setIsClientSelectModalOpen(false);\n    setIsCreateClientModalOpen(true);\n  };\n\n  const handleClientCreated = (client: Client) => {\n    setIsCreateClientModalOpen(false);\n    setSelectedClient(client);\n    // Entfernt: Automatischer Beratungsstart nach Client-Erstellung\n    // Client wird nur gespeichert, Beratung muss manuell gestartet werden\n    \n    // Recent Clients neu laden um den neuen Client anzuzeigen\n    loadRecentClients();\n    \n    // Success-Toast fr Client-Erstellung (wird bereits im Modal angezeigt)\n    // toast.success(`Client \"${client.name}\" wurde angelegt`);\n  };\n\n  /* CLAUDE-ANCHOR: CONSULTATION-MANUAL-SAVE-001 - Timezone-sichere manuelle Beratungserfassung */\n  const handleManualSave = async () => {\n    if (!selectedClient) {\n      toast.error('Bitte whlen Sie einen Client aus');\n      return;\n    }\n    if (!manualStartTime || !manualEndTime) {\n      toast.error('Bitte geben Sie Start- und Endzeit an');\n      return;\n    }\n    if (!selectedBranch) {\n      toast.error(t('consultations.selectBranch'));\n      return;\n    }\n\n    try {\n      setIsStarting(true);\n      \n      /* KRITISCHE TIMEZONE-BEHANDLUNG:\n       * Problem: Inkonsistenz zwischen normaler und manueller Beratung!\n       * \n       * NORMAL WORKING ():\n       * const correctedTime = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000);\n       * \n       * MANUAL BROKEN ():\n       * convertDatetimeLocalToApi() fhrt zu 5h Versatz\n       * \n       * LSUNG: Gleiche getTimezoneOffset-Logik fr beide verwenden!\n       * \n       * datetime-local Input: \"2024-01-15T14:01\"\n       *  new Date(\"2024-01-15T14:01\") erstellt lokales Date-Objekt\n       *  getTimezoneOffset() korrigiert zur gleichen Zeit wie bei normaler Beratung\n       *  KONSISTENTE Zeitbehandlung!\n       */\n      \n      //  KORRIGIERT: Verwende gleiche Logik wie bei normalem Start/Stop\n      const manualStart = new Date(manualStartTime);\n      const correctedStartTime = new Date(manualStart.getTime() - manualStart.getTimezoneOffset() * 60000);\n      \n      const manualEnd = new Date(manualEndTime);\n      const correctedEndTime = new Date(manualEnd.getTime() - manualEnd.getTimezoneOffset() * 60000);\n      \n      // Starte die Beratung mit der korrigierten Startzeit\n      const consultation = await consultationApi.startConsultation({\n        branchId: selectedBranch,\n        clientId: selectedClient.id,\n        notes: notes || '',\n        startTime: correctedStartTime.toISOString()  //  Konsistent mit normaler Beratung\n      });\n      \n      // Beende sie sofort mit der korrigierten Endzeit\n      const stoppedConsultation = await consultationApi.stopConsultation({\n        endTime: correctedEndTime.toISOString(),      //  Konsistent mit normaler Beratung\n        notes: notes || ''\n      });\n      \n      // Reset der Eingaben\n      setIsManualEntry(false);\n      setManualStartTime('');\n      setManualEndTime('');\n      setNotes('');\n      setSelectedClient(null);\n      \n      // Speichere den zuletzt gestarteten Client fr Tag-Priorisierung\n      setLastStartedClientId(selectedClient.id);\n      \n      // Sende Event fr SavedFilterTags Aktualisierung\n      logger.log(' ConsultationTracker: Sending consultationChanged event (start)');\n      window.dispatchEvent(new CustomEvent('consultationChanged'));\n      \n      // Lade Recent Clients neu\n      loadRecentClients();\n      \n      // Callback fr Parent-Komponente - bergebe die beendete Consultation\n      onConsultationChange?.(stoppedConsultation);\n      \n      // Callback fr Filter-Wechsel\n      if (onConsultationStarted && selectedClient.name) {\n        onConsultationStarted(selectedClient.name);\n      }\n      \n      toast.success(t('consultations.manualSaveSuccess'));\n    } catch (error) {\n      console.error('Fehler beim Erfassen der Beratung:', error);\n      toast.error(t('consultations.manualSaveError'));\n    } finally {\n      setIsStarting(false);\n    }\n  };\n\n  const updateNotes = async () => {\n    if (!activeConsultation) return;\n    \n    try {\n      await consultationApi.updateConsultationNotes(activeConsultation.id, { notes });\n    } catch (error) {\n      // Stille Behandlung - Auto-Save sollte nicht strend sein\n    }\n  };\n\n  // Auto-save Notizen alle 30 Sekunden\n  useEffect(() => {\n    if (!activeConsultation || !notes) return;\n    \n    const timeout = setTimeout(() => {\n      updateNotes();\n    }, 30000);\n    \n    return () => clearTimeout(timeout);\n  }, [notes, activeConsultation]);\n\n  // Recent Clients aktualisieren wenn Fenster wieder fokussiert wird\n  useEffect(() => {\n    const handleFocus = () => {\n      loadRecentClients();\n    };\n\n    window.addEventListener('focus', handleFocus);\n    \n    return () => {\n      window.removeEventListener('focus', handleFocus);\n    };\n  }, []);\n\n  // Optimierte Tag-Breiten-Berechnung mit useMemo\n  const averageTagWidth = useMemo(() => {\n    if (recentClients.length === 0) return 85; // Reduzierter Fallback\n    \n    return recentClients.reduce((sum, client) => {\n      // Przisere Schtzung: ~6px pro Zeichen + 24px Padding\n      return sum + (client.name.length * 6 + 24);\n    }, 0) / recentClients.length;\n  }, [recentClients]);\n\n  // Optimierte Sichtbarkeits-Berechnung mit useCallback (vereinfacht ohne Dropdown)\n  const calculateVisibleTags = useCallback(() => {\n    if (!containerRef.current || recentClients.length === 0) return;\n\n    const container = containerRef.current;\n    const currentWidth = container.clientWidth;\n    \n    // Nur neu berechnen wenn sich die Breite signifikant gendert hat (>= 40px)\n    if (Math.abs(currentWidth - containerWidth) < 40) return;\n    \n    setContainerWidth(currentWidth);\n    \n    // Moderate responsive Abstnde fr bessere Tag-Anzeige\n    const isMobile = currentWidth < 768; // md breakpoint\n    const PLUS_BUTTON_WIDTH = 32; // Reduziert von 42\n    const GAPS_AND_MARGINS = isMobile ? 8 : 20; // Mobile: 8px, Desktop: 20px (weniger extrem)\n    const BUFFER = 12; // Reduziert von 16\n    \n    const availableWidth = currentWidth - PLUS_BUTTON_WIDTH - GAPS_AND_MARGINS - BUFFER;\n    \n    // Berechne maximal mgliche Tags (einfach soviele wie reinpassen)\n    const maxPossibleTags = Math.max(1, Math.floor(availableWidth / averageTagWidth));\n    \n    // Zeige soviele Tags wie reinpassen, maximal aber die verfgbaren\n    setVisibleTagCount(Math.min(maxPossibleTags, recentClients.length));\n  }, [recentClients, averageTagWidth, containerWidth]);\n\n  //  PHASE 3: Verwende Custom Hook fr ResizeObserver (Memory-Leak Prevention)\n  useResizeObserver(\n    containerRef,\n    calculateVisibleTags,\n    {\n      debounceMs: 150, // 150ms Debounce fr smooth responsive behavior\n    }\n  );\n\n  // Initial calculation nach Client-nderungen\n  useLayoutEffect(() => {\n    calculateVisibleTags();\n  }, [calculateVisibleTags]);\n\n  // Optimistische Tag-Anzeige fr bessere UX\n  const showOptimisticTags = recentClients.length === 0 && loading;\n  const optimisticTags = useMemo(() => {\n    if (!showOptimisticTags) return [];\n    return Array(3).fill(null).map((_, i) => ({\n      id: `placeholder-${i}`,\n      name: '', // Placeholder\n      isPlaceholder: true,\n      status: undefined,\n      lastConsultationDate: undefined\n    }));\n  }, [showOptimisticTags]);\n\n  const displayTags = showOptimisticTags ? optimisticTags : recentClients;\n  const currentVisibleCount = showOptimisticTags ? optimisticTags.length : visibleTagCount;\n\n  // Sortiere displayTags: Zuletzt gestarteter Client zuerst\n  const sortedDisplayTags = useMemo(() => {\n    if (showOptimisticTags || !lastStartedClientId) {\n      return displayTags;\n    }\n    \n    // Finde den zuletzt gestarteten Client\n    const lastStartedClient = displayTags.find(client => client.id === lastStartedClientId);\n    if (!lastStartedClient) {\n      return displayTags;\n    }\n    \n    // Setze den zuletzt gestarteten Client an die erste Position\n    const otherClients = displayTags.filter(client => client.id !== lastStartedClientId);\n    return [lastStartedClient, ...otherClients];\n  }, [displayTags, lastStartedClientId, showOptimisticTags]);\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-4\"></div>\n          <div className=\"h-12 bg-gray-200 dark:bg-gray-700 rounded mb-2\"></div>\n          <div className=\"h-12 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white flex items-center pl-2 sm:pl-0\">\n            <UserGroupIcon className=\"h-6 w-6 mr-2 sm:h-6 sm:w-6 sm:mr-2\" />\n            {t('consultations.trackerTitle')}\n          </h2>\n          {activeConsultation && (\n            <div className=\"flex items-center text-green-600 dark:text-green-400\">\n              <ClockIcon className=\"h-5 w-5 mr-2 animate-pulse\" />\n              <span className=\"font-medium\">\n                {calculateDuration(activeConsultation.startTime, null)} - {activeConsultation.client?.name}\n              </span>\n            </div>\n          )}\n        </div>\n\n        {/* Aktive Beratung oder Start-Buttons */}\n        {activeConsultation ? (\n          <div className=\"space-y-4\">\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">{t('consultations.activeWith')}</p>\n              <p className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                {activeConsultation.client?.name}\n              </p>\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                {t('consultations.startedAt')}: {formatTime(activeConsultation.startTime)}\n              </p>\n            </div>\n\n            {/* Notizen-Bereich */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                {t('consultations.notesForConsultation')}\n              </label>\n              <textarea\n                value={notes}\n                onChange={(e) => setNotes(e.target.value)}\n                onBlur={updateNotes}\n                className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                rows={3}\n                placeholder={t('consultations.notesPlaceholder')}\n              />\n            </div>\n\n            <button\n              onClick={stopConsultation}\n              className=\"w-full flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n            >\n              <StopIcon className=\"h-5 w-5 mr-2\" />\n              {t('consultations.stop')}\n            </button>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {/* Zuletzt beratene Clients als Tags mit vereinfachtem responsive Layout (ohne Dropdown) */}\n            {(sortedDisplayTags.length > 0) && !isManualEntry && (\n              <div>\n                <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  {sortedDisplayTags.some(c => !isPlaceholder(c) && c.status === 'planned') ? \n                    t('consultations.recentAndPlanned') : \n                    t('consultations.recent')\n                  }\n                </p>\n                <div ref={containerRef} className=\"flex items-center gap-0.5 md:gap-6\">\n                  {/* Neuer Client Button - links positioniert mit extremen responsiven Abstnden */}\n                  <button\n                    onClick={() => setIsCreateClientModalOpen(true)}\n                    disabled={showOptimisticTags}\n                    className={`bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center flex-shrink-0 ${showOptimisticTags ? 'opacity-50 cursor-not-allowed' : ''}`}\n                    style={{ width: '30.19px', height: '30.19px' }}\n                    title={t('consultations.createClient')}\n                    aria-label={t('consultations.createClient')}\n                  >\n                    <PlusIcon className=\"h-4 w-4\" />\n                  </button>\n                  \n                  {/* Soviele Client-Tags wie reinpassen (ohne Dropdown) */}\n                  <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                    {sortedDisplayTags.slice(0, currentVisibleCount).map((client, index) => {\n                      const isPast = !isPlaceholder(client) && client.status === 'past';\n                      const isPlanned = !isPlaceholder(client) && client.status === 'planned';\n                      \n                      return (\n                        <button\n                          key={client.id}\n                          onClick={() => !isPlaceholder(client) && handleStartConsultation(Number(client.id), notes)}\n                          disabled={isPlaceholder(client)}\n                          className={`inline-flex items-center px-3 py-2 rounded-full text-sm font-medium flex-shrink-0 transition-colors ${\n                            isPlaceholder(client) \n                              ? 'bg-gray-200 dark:bg-gray-600 text-gray-400 dark:text-gray-500 animate-pulse cursor-default'\n                              : isPlanned\n                                ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 hover:bg-blue-200 dark:hover:bg-blue-900/50 cursor-pointer border border-blue-200 dark:border-blue-700'\n                                : 'bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600 cursor-pointer'\n                          }`}\n                          title={\n                            isPlaceholder(client) \n                              ? t('common.loading')\n                              : isPlanned\n                                ? t('consultations.plannedWith', { \n                                    clientName: client.name, \n                                    date: client.lastConsultationDate ? new Date(client.lastConsultationDate).toLocaleDateString('de-DE', { day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit' }) : ''\n                                  })\n                                : t('consultations.startWith', { \n                                    clientName: client.name,\n                                    date: client.lastConsultationDate ? new Date(client.lastConsultationDate).toLocaleDateString('de-DE') : ''\n                                  })\n                          }\n                        >\n                          {isPlanned && !isPlaceholder(client) && (\n                            <svg className=\"h-3 w-3 mr-1.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                              <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\" clipRule=\"evenodd\"/>\n                            </svg>\n                          )}\n                          <span className=\"truncate max-w-[120px]\">\n                            {isPlaceholder(client) ? (\n                              <span className=\"inline-block w-16 h-4 bg-gray-300 dark:bg-gray-500 rounded animate-pulse\"></span>\n                            ) : (\n                              client.name\n                            )}\n                          </span>\n                        </button>\n                      );\n                    })}\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Start-Buttons */}\n            <div className=\"flex gap-6\">\n              <button\n                onClick={() => setIsClientSelectModalOpen(true)}\n                className=\"w-2/3 flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                title={t('consultations.start')}\n              >\n                <PlayIcon className=\"h-5 w-5\" />\n              </button>\n\n              <button\n                onClick={() => {\n                  setIsManualEntry(!isManualEntry);\n                  setSelectedClient(null);\n                  setManualStartTime('');\n                  setManualEndTime('');\n                  setNotes('');\n                }}\n                className={`w-1/3 flex items-center justify-center px-4 py-3 border text-base font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${\n                  isManualEntry\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20'\n                    : 'border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600'\n                }`}\n                title={t('consultations.plan')}\n              >\n                <ClockIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n\n            {/* Manuelle Erfassung / Planen */}\n            {isManualEntry && (\n              <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 space-y-3\">\n                <h3 className=\"text-sm font-medium text-gray-900 dark:text-white mb-3\">\n                  {t('consultations.planConsultation')}\n                </h3>\n                \n                {/* Client-Auswahl */}\n                <div>\n                  <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('consultations.columns.client')}\n                  </label>\n                  {selectedClient ? (\n                    <div className=\"flex items-center justify-between bg-white dark:bg-gray-800 rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2\">\n                      <span className=\"text-sm text-gray-900 dark:text-white\">{selectedClient.name}</span>\n                      <button\n                        onClick={() => setIsClientSelectModalOpen(true)}\n                        className=\"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                      >\n                        {t('consultations.change')}\n                      </button>\n                    </div>\n                  ) : (\n                    <button\n                      onClick={() => setIsClientSelectModalOpen(true)}\n                      className=\"w-full text-left bg-white dark:bg-gray-800 rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 text-sm text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700\"\n                    >\n                      {t('consultations.selectClientPlaceholder')}\n                    </button>\n                  )}\n                </div>\n\n                {/* Zeit-Inputs */}\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('consultations.columns.startTime')}\n                    </label>\n                    <input\n                      type=\"datetime-local\"\n                      value={manualStartTime}\n                      onChange={(e) => setManualStartTime(e.target.value)}\n                      className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('consultations.columns.endTime')}\n                    </label>\n                    <input\n                      type=\"datetime-local\"\n                      value={manualEndTime}\n                      onChange={(e) => setManualEndTime(e.target.value)}\n                      className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    />\n                  </div>\n                </div>\n\n                {/* Notizen */}\n                <div>\n                  <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('consultations.columns.notes')}\n                  </label>\n                  <textarea\n                    value={notes}\n                    onChange={(e) => setNotes(e.target.value)}\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    rows={2}\n                    placeholder={t('consultations.optionalNotes')}\n                  />\n                </div>\n\n                {/* Speichern-Button */}\n                <div className=\"flex justify-end\">\n                  <button\n                    onClick={handleManualSave}\n                    disabled={!selectedClient || !manualStartTime || !manualEndTime}\n                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    title={t('consultations.saveConsultation')}\n                  >\n                    <CheckIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Modals */}\n      <ClientSelectModal\n        isOpen={isClientSelectModalOpen}\n        onClose={() => setIsClientSelectModalOpen(false)}\n        onSelect={handleClientSelect}\n        onCreateNew={handleCreateClient}\n      />\n\n      <CreateClientModal\n        isOpen={isCreateClientModalOpen}\n        onClose={() => setIsCreateClientModalOpen(false)}\n        onSave={handleClientCreated}\n      />\n    </>\n  );\n};\n\nexport default ConsultationTracker; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, MagnifyingGlassIcon, CheckIcon, LinkIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { toast } from 'react-toastify';\n\ninterface Task {\n  id: number;\n  title: string;\n  status: string;\n  responsible?: {\n    firstName: string;\n    lastName: string;\n  };\n}\n\ninterface LinkTaskModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  consultationId: number;\n  onTaskLinked: () => void;\n}\n\nconst LinkTaskModal: React.FC<LinkTaskModalProps> = ({\n  isOpen,\n  onClose,\n  consultationId,\n  onTaskLinked\n}) => {\n  const { t } = useTranslation();\n  const [tasks, setTasks] = useState<Task[]>([]);\n  const [filteredTasks, setFilteredTasks] = useState<Task[]>([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [selectedTaskId, setSelectedTaskId] = useState<number | null>(null);\n\n  useEffect(() => {\n    if (isOpen) {\n      loadTasks();\n    }\n  }, [isOpen]);\n\n  useEffect(() => {\n    if (searchTerm) {\n      const filtered = tasks.filter(task => \n        task.title.toLowerCase().includes(searchTerm.toLowerCase())\n      );\n      setFilteredTasks(filtered);\n    } else {\n      setFilteredTasks(tasks);\n    }\n  }, [searchTerm, tasks]);\n\n  const loadTasks = async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.TASKS.BASE);\n      // Filtere nur offene und in Bearbeitung befindliche Tasks\n      const activeTasks = response.data.filter((task: Task) => \n        task.status === 'open' || task.status === 'in_progress'\n      );\n      setTasks(activeTasks);\n      setFilteredTasks(activeTasks);\n    } catch (error) {\n      toast.error(t('consultations.linkTask.loadError'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleLinkTask = async () => {\n    if (!selectedTaskId) {\n      toast.error(t('consultations.linkTask.selectTask'));\n      return;\n    }\n\n    try {\n      await axiosInstance.post(\n        API_ENDPOINTS.CONSULTATIONS.LINK_TASK(consultationId),\n        { taskId: selectedTaskId }\n      );\n      \n      toast.success(t('consultations.linkTask.success'));\n      onTaskLinked();\n      onClose();\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || t('consultations.linkTask.error'));\n    }\n  };\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      \n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n        <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n          <div className=\"p-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                {t('consultations.linkTask.title')}\n              </Dialog.Title>\n              <button\n                onClick={onClose}\n                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            {/* Suchfeld */}\n            <div className=\"relative mb-4\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <MagnifyingGlassIcon className=\"h-5 w-5 text-gray-400\" />\n              </div>\n              <input\n                type=\"text\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\n                placeholder={t('consultations.linkTask.searchPlaceholder')}\n                autoFocus\n              />\n            </div>\n\n            {/* Task-Liste */}\n            <div className=\"max-h-96 overflow-y-auto\">\n              {loading ? (\n                <div className=\"text-center py-4 text-gray-500 dark:text-gray-400\">\n                  {t('common.loading')}\n                </div>\n              ) : filteredTasks.length === 0 ? (\n                <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                  {t('consultations.linkTask.noTasksFound')}\n                </div>\n              ) : (\n                <div className=\"space-y-2\">\n                  {filteredTasks.map((task) => (\n                    <label\n                      key={task.id}\n                      className=\"flex items-center p-3 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer\"\n                    >\n                      <input\n                        type=\"radio\"\n                        name=\"task\"\n                        value={task.id}\n                        checked={selectedTaskId === task.id}\n                        onChange={() => setSelectedTaskId(task.id)}\n                        className=\"mr-3\"\n                      />\n                      <div className=\"flex-1\">\n                        <p className=\"font-medium text-gray-900 dark:text-white\">\n                          {task.title}\n                        </p>\n                        {task.responsible && (\n                          <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                            {t('tasks.columns.responsible')}: {task.responsible.firstName} {task.responsible.lastName}\n                          </p>\n                        )}\n                      </div>\n                      <span className={`px-2 py-1 text-xs rounded-full ${\n                        task.status === 'open' \n                          ? 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'\n                          : 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300'\n                      }`}>\n                        {task.status === 'open' ? t('tasks.status.open') : t('tasks.status.in_progress')}\n                      </span>\n                    </label>\n                  ))}\n                </div>\n              )}\n            </div>\n\n            {/* Buttons */}\n            <div className=\"mt-6 flex items-center justify-end space-x-3\">\n              <button\n                type=\"button\"\n                onClick={onClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                onClick={handleLinkTask}\n                disabled={!selectedTaskId}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={t('consultations.linkTask.link')}\n              >\n                <LinkIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default LinkTaskModal; ","import React, { useState } from 'react';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { \r\n  CheckCircleIcon, \r\n  XMarkIcon, \r\n  DocumentArrowDownIcon,\r\n  EyeIcon \r\n} from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { useTranslation } from 'react-i18next';\r\nimport useMessage from '../hooks/useMessage.ts';\r\n\r\ninterface InvoiceSuccessModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  invoiceId: number;\r\n  invoiceNumber: string;\r\n  totalAmount: string;\r\n  clientName: string;\r\n}\r\n\r\nconst InvoiceSuccessModal: React.FC<InvoiceSuccessModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  invoiceId,\r\n  invoiceNumber,\r\n  totalAmount,\r\n  clientName\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { showMessage } = useMessage();\r\n  const [downloadingPdf, setDownloadingPdf] = useState(false);\r\n\r\n  const handleDownloadPdf = async () => {\r\n    try {\r\n      setDownloadingPdf(true);\r\n      \r\n      const response = await axiosInstance.get(\r\n        API_ENDPOINTS.CONSULTATION_INVOICES.GENERATE_PDF(invoiceId),\r\n        { \r\n          responseType: 'blob',\r\n          headers: {\r\n            'Accept': 'application/pdf'\r\n          }\r\n        }\r\n      );\r\n      \r\n      // Erstelle Blob und Download-Link\r\n      const blob = new Blob([response.data], { type: 'application/pdf' });\r\n      const url = window.URL.createObjectURL(blob);\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      link.download = `Rechnung_${invoiceNumber}.pdf`;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n      window.URL.revokeObjectURL(url);\r\n      \r\n      showMessage(t('invoice.downloadSuccess', { defaultValue: 'PDF erfolgreich heruntergeladen' }), 'success');\r\n    } catch (error: any) {\r\n      console.error('Fehler beim Download der PDF:', error);\r\n      showMessage(error.response?.data?.message || t('invoice.downloadError', { defaultValue: 'Fehler beim Download der PDF' }), 'error');\r\n    } finally {\r\n      setDownloadingPdf(false);\r\n    }\r\n  };\r\n\r\n  const handleViewInvoiceManagement = () => {\r\n    // TODO: Navigation zur Rechnungsverwaltung (wird in Phase 5 implementiert)\r\n    showMessage(t('invoice.invoiceManagementPhase5', { defaultValue: 'Rechnungsverwaltung wird in Phase 5 implementiert' }), 'info');\r\n    onClose();\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n      \r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n          <div className=\"p-6\">\r\n            {/* Header mit Success Icon */}\r\n            <div className=\"flex items-center justify-between mb-6\">\r\n              <div className=\"flex items-center\">\r\n                <CheckCircleIcon className=\"h-8 w-8 text-green-500 mr-3\" />\r\n                <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                  Rechnung erstellt\r\n                </Dialog.Title>\r\n              </div>\r\n              <button\r\n                onClick={onClose}\r\n                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n              >\r\n                <XMarkIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Success Inhalt */}\r\n            <div className=\"space-y-4\">\r\n              <div className=\"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4\">\r\n                <h3 className=\"font-medium text-green-800 dark:text-green-200 mb-2\">\r\n                  Rechnung erfolgreich erstellt\r\n                </h3>\r\n                <div className=\"text-sm text-green-700 dark:text-green-300 space-y-1\">\r\n                  <p><strong>Rechnungsnummer:</strong> {invoiceNumber}</p>\r\n                  <p><strong>Kunde:</strong> {clientName}</p>\r\n                  <p><strong>Betrag:</strong> CHF {totalAmount}</p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Hinweise */}\r\n              <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\r\n                <h4 className=\"font-medium text-blue-800 dark:text-blue-200 mb-2\">\r\n                  Nchste Schritte\r\n                </h4>\r\n                <ul className=\"text-sm text-blue-700 dark:text-blue-300 space-y-1\">\r\n                  <li> PDF herunterladen und an Kunde senden</li>\r\n                  <li> Beratungen sind nun als abgerechnet markiert</li>\r\n                  <li> Rechnung in der Rechnungsverwaltung verwalten</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Aktionen */}\r\n            <div className=\"mt-6 flex flex-col space-y-3\">\r\n              <button\r\n                onClick={handleDownloadPdf}\r\n                disabled={downloadingPdf}\r\n                className=\"w-full flex items-center justify-center p-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                title={downloadingPdf ? 'PDF wird generiert...' : 'PDF herunterladen'}\r\n              >\r\n                {downloadingPdf ? (\r\n                  <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"></div>\r\n                ) : (\r\n                  <DocumentArrowDownIcon className=\"h-5 w-5\" />\r\n                )}\r\n              </button>\r\n\r\n              <button\r\n                onClick={handleViewInvoiceManagement}\r\n                className=\"w-full flex items-center justify-center p-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n                title=\"Zur Rechnungsverwaltung\"\r\n              >\r\n                <EyeIcon className=\"h-5 w-5\" />\r\n              </button>\r\n\r\n              <button\r\n                onClick={onClose}\r\n                className=\"w-full p-2 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\r\n                title=\"Schlieen\"\r\n              >\r\n                <XMarkIcon className=\"h-5 w-5\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default InvoiceSuccessModal; ","import React, { useState, useEffect, useCallback } from 'react';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon, DocumentTextIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport useMessage from '../hooks/useMessage.ts';\nimport { Consultation } from '../types/client.ts';\nimport { calculateDuration, formatTime } from '../utils/dateUtils.ts';\nimport { format } from 'date-fns';\nimport InvoiceSuccessModal from './InvoiceSuccessModal.tsx';\n\ninterface CreateInvoiceModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  consultations: Consultation[];\n  onInvoiceCreated: (invoiceId: number) => void;\n}\n\ninterface InvoiceSettings {\n  companyName: string;\n  companyAddress: string;\n  companyZip: string;\n  companyCity: string;\n  companyCountry: string;\n  companyPhone?: string;\n  companyEmail?: string;\n  vatNumber?: string;\n  iban: string;\n  defaultHourlyRate: number;\n  defaultVatRate?: number;\n  invoicePrefix: string;\n  nextInvoiceNumber: number;\n}\n\ninterface CreatedInvoice {\n  id: number;\n  invoiceNumber: string;\n  total: number;\n  clientName: string;\n}\n\nconst CreateInvoiceModal: React.FC<CreateInvoiceModalProps> = ({\n  isOpen,\n  onClose,\n  consultations,\n  onInvoiceCreated\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const { hasPermission } = usePermissions();\n  const [loading, setLoading] = useState(false);\n  const [settings, setSettings] = useState<InvoiceSettings | null>(null);\n  const [createdInvoice, setCreatedInvoice] = useState<CreatedInvoice | null>(null);\n  const [showSuccessModal, setShowSuccessModal] = useState(false);\n  const [formData, setFormData] = useState({\n    issueDate: format(new Date(), 'yyyy-MM-dd'),\n    dueDate: format(new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), 'yyyy-MM-dd'),\n    hourlyRate: 0,\n    vatRate: 0,\n    notes: ''\n  });\n\n  // Berechtigungsprfung\n  const canCreateInvoices = hasPermission('invoice_create', 'write', 'button');\n  \n  // loadInvoiceSettings Funktion MUSS vor useEffect definiert werden\n  const loadInvoiceSettings = useCallback(async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.INVOICE_SETTINGS.BASE);\n      const settingsData = response.data;\n      \n      setSettings(settingsData);\n      setFormData(prev => ({\n        ...prev,\n        hourlyRate: settingsData.defaultHourlyRate || 0,\n        vatRate: settingsData.defaultVatRate || 0\n      }));\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Rechnungseinstellungen:', error);\n      if (error.response?.status === 404) {\n        showMessage(t('invoice.settingsNotConfigured', { defaultValue: 'Bitte konfigurieren Sie zuerst Ihre Rechnungseinstellungen' }), 'error');\n      } else {\n        showMessage(t('invoice.loadSettingsError', { defaultValue: 'Fehler beim Laden der Rechnungseinstellungen' }), 'error');\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n  \n  // useEffect MUSS vor allen frhen Returns stehen!\n  useEffect(() => {\n    if (isOpen) {\n      loadInvoiceSettings();\n    }\n  }, [isOpen, loadInvoiceSettings]);\n\n  // Berechtigungsprfung - NACH useEffect\n  if (!canCreateInvoices) {\n    return (\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6\">\n            <div className=\"text-center\">\n              <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\n                Keine Berechtigung\n              </h3>\n              <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n                Sie haben keine Berechtigung, Rechnungen zu erstellen.\n              </p>\n              <button\n                onClick={onClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title=\"Schlieen\"\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!settings) {\n      showMessage(t('invoice.settingsNotLoaded', { defaultValue: 'Rechnungseinstellungen konnten nicht geladen werden' }), 'error');\n      return;\n    }\n\n    if (consultations.length === 0) {\n      showMessage(t('invoice.noConsultations', { defaultValue: 'Keine Beratungen zum Abrechnen vorhanden' }), 'error');\n      return;\n    }\n\n    // Validiere, dass alle Consultations den gleichen Client haben\n    const uniqueClientIds = [...new Set(consultations.map(c => c.clientId))];\n    if (uniqueClientIds.length > 1) {\n      showMessage(t('invoice.differentClients', { defaultValue: 'Alle Beratungen mssen den gleichen Kunden haben' }), 'error');\n      return;\n    }\n\n    const clientId = uniqueClientIds[0];\n    if (!clientId) {\n      showMessage(t('invoice.noValidClient', { defaultValue: 'Kein gltiger Kunde in den Beratungen gefunden' }), 'error');\n      return;\n    }\n\n    try {\n      setLoading(true);\n\n      const response = await axiosInstance.post(\n        API_ENDPOINTS.CONSULTATION_INVOICES.CREATE_FROM_CONSULTATIONS,\n        {\n          consultationIds: consultations.map(c => c.id),\n          clientId: clientId,\n          issueDate: formData.issueDate,\n          dueDate: formData.dueDate,\n          hourlyRate: formData.hourlyRate,\n          vatRate: formData.vatRate || 0,\n          notes: formData.notes\n        }\n      );\n      \n      const invoice = response.data;\n      const clientName = consultations[0]?.client?.name || 'Unbekannt';\n      \n      setCreatedInvoice({\n        id: invoice.id,\n        invoiceNumber: invoice.invoiceNumber,\n        total: invoice.total,\n        clientName: clientName\n      });\n      \n      setShowSuccessModal(true);\n      onInvoiceCreated(invoice.id);\n      \n    } catch (error: any) {\n      showMessage(error.response?.data?.message || t('invoice.createError', { defaultValue: 'Fehler beim Erstellen der Rechnung' }), 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n  };\n\n  const handleCloseAll = () => {\n    setShowSuccessModal(false);\n    setCreatedInvoice(null);\n    onClose();\n  };\n\n  // Berechnungen fr die Kostenbersicht\n  const totalHours = consultations.reduce((sum, consultation) => {\n    if (consultation.endTime) {\n      const duration = calculateDuration(consultation.startTime, consultation.endTime);\n      const hours = parseFloat(duration.replace('h', '').replace(',', '.'));\n      return sum + hours;\n    }\n    return sum;\n  }, 0);\n\n  const estimatedTotal = totalHours * formData.hourlyRate;\n  const vatAmount = formData.vatRate > 0 ? (estimatedTotal * formData.vatRate / 100) : 0;\n  const totalWithVat = estimatedTotal + vatAmount;\n\n  if (!isOpen) return null;\n\n  return (\n    <>\n      <Dialog open={isOpen && !showSuccessModal} onClose={onClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <form onSubmit={handleSubmit} className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                  Rechnung erstellen\n                </Dialog.Title>\n                <button\n                  type=\"button\"\n                  onClick={onClose}\n                  className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                >\n                  <XMarkIcon className=\"h-6 w-6\" />\n                </button>\n              </div>\n\n              {/* Beratungen bersicht */}\n              <div className=\"mb-6 bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4\">\n                <h3 className=\"font-medium text-gray-900 dark:text-white mb-3\">\n                  Zu verrechnende Beratungen\n                </h3>\n                <div className=\"space-y-2 max-h-40 overflow-y-auto\">\n                  {consultations.map((consultation) => (\n                    <div key={consultation.id} className=\"flex justify-between items-center text-sm\">\n                      <div>\n                        <span className=\"text-gray-900 dark:text-white\">\n                          {consultation.client?.name} - {formatTime(consultation.startTime)}\n                        </span>\n                      </div>\n                      <span className=\"text-gray-600 dark:text-gray-400\">\n                        {calculateDuration(consultation.startTime, consultation.endTime)}\n                      </span>\n                    </div>\n                  ))}\n                </div>\n                <div className=\"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600 flex justify-between text-sm font-medium\">\n                  <span>Gesamtdauer:</span>\n                  <span>{totalHours.toFixed(2)}h</span>\n                </div>\n              </div>\n\n              {/* Rechnungsdetails */}\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Rechnungsdatum\n                  </label>\n                  <input\n                    type=\"date\"\n                    name=\"issueDate\"\n                    value={formData.issueDate}\n                    onChange={handleChange}\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Flligkeitsdatum\n                  </label>\n                  <input\n                    type=\"date\"\n                    name=\"dueDate\"\n                    value={formData.dueDate}\n                    onChange={handleChange}\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Stundensatz (CHF)\n                  </label>\n                  <input\n                    type=\"number\"\n                    name=\"hourlyRate\"\n                    value={formData.hourlyRate}\n                    onChange={handleChange}\n                    step=\"0.01\"\n                    min=\"0\"\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    MwSt.-Satz (%)\n                  </label>\n                  <input\n                    type=\"number\"\n                    name=\"vatRate\"\n                    value={formData.vatRate}\n                    onChange={handleChange}\n                    step=\"0.1\"\n                    min=\"0\"\n                    max=\"100\"\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n              </div>\n\n              {/* Notizen */}\n              <div className=\"mb-6\">\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Zustzliche Notizen\n                </label>\n                <textarea\n                  name=\"notes\"\n                  value={formData.notes}\n                  onChange={handleChange}\n                  rows={3}\n                  className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  placeholder=\"Optionale Notizen zur Rechnung...\"\n                />\n              </div>\n\n              {/* Kostenbersicht */}\n              <div className=\"mb-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n                <h3 className=\"font-medium text-blue-800 dark:text-blue-200 mb-3\">\n                  Kostenbersicht\n                </h3>\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span>Beratungszeit ({totalHours.toFixed(2)}h  CHF {formData.hourlyRate}):</span>\n                    <span>CHF {estimatedTotal.toFixed(2)}</span>\n                  </div>\n                  {formData.vatRate > 0 && (\n                    <div className=\"flex justify-between\">\n                      <span>MwSt. ({formData.vatRate}%):</span>\n                      <span>CHF {vatAmount.toFixed(2)}</span>\n                    </div>\n                  )}\n                  <div className=\"border-t border-blue-200 dark:border-blue-700 pt-2 flex justify-between font-medium\">\n                    <span>Gesamtbetrag:</span>\n                    <span>CHF {totalWithVat.toFixed(2)}</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Buttons */}\n              <div className=\"flex items-center justify-end space-x-3\">\n                <button\n                  type=\"button\"\n                  onClick={onClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading || !settings || totalHours === 0}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? 'Erstelle Rechnung...' : 'Rechnung erstellen'}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <DocumentTextIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n\n      {/* Success Modal */}\n      {showSuccessModal && createdInvoice && (\n        <InvoiceSuccessModal\n          isOpen={showSuccessModal}\n          onClose={handleCloseAll}\n          invoiceId={createdInvoice.id}\n          invoiceNumber={createdInvoice.invoiceNumber}\n          totalAmount={Number(createdInvoice.total).toFixed(2)}\n          clientName={createdInvoice.clientName}\n        />\n      )}\n    </>\n  );\n};\n\nexport default CreateInvoiceModal; ","import React, { useState, useEffect, useMemo, useImperativeHandle, forwardRef, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { \n  ClockIcon, \n  FunnelIcon,\n  XMarkIcon,\n  LinkIcon,\n  TrashIcon,\n  DocumentTextIcon,\n  ChartBarIcon,\n  CheckIcon\n} from '@heroicons/react/24/outline';\nimport { useNavigate } from 'react-router-dom';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { \n  formatTime, \n  calculateDuration, \n  formatTotalDuration, \n  isConsultationInvoiced, \n  getConsultationInvoiceInfo,\n  getInvoiceStatusText,\n  getInvoiceStatusColor \n} from '../utils/dateUtils.ts';\nimport { Consultation, Client } from '../types/client.ts';\nimport { logger } from '../utils/logger.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { toast } from 'react-toastify';\nimport LinkTaskModal from './LinkTaskModal.tsx';\nimport FilterPane from './FilterPane.tsx';\nimport SavedFilterTags from './SavedFilterTags.tsx';\nimport { FilterCondition } from './FilterRow.tsx';\nimport { applyFilters, evaluateDateCondition } from '../utils/filterLogic.ts';\nimport * as consultationApi from '../api/consultationApi.ts';\nimport * as clientApi from '../api/clientApi.ts';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport CreateInvoiceModal from './CreateInvoiceModal.tsx';\n\n// TableID fr gespeicherte Filter\nconst CONSULTATIONS_TABLE_ID = 'consultations-table';\n\ninterface ConsultationListProps {\n  onConsultationChange?: () => void;\n}\n\n// Ref-Interface fr imperatives Handle\nexport interface ConsultationListRef {\n  refresh: () => void;\n  addConsultation?: (consultation: Consultation) => void;\n  updateConsultation?: (consultation: Consultation) => void;\n  removeConsultation?: (consultationId: number) => void;\n  activateClientFilter?: (clientName: string) => void;\n}\n\nconst ConsultationList = forwardRef<ConsultationListRef, ConsultationListProps>(({ onConsultationChange }, ref) => {\n  const { t } = useTranslation();\n  const { hasPermission } = usePermissions();\n  const navigate = useNavigate();\n  const [consultations, setConsultations] = useState<Consultation[]>([]);\n  const [recentClients, setRecentClients] = useState<Client[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [editingNotesId, setEditingNotesId] = useState<number | null>(null);\n  const [editingNotes, setEditingNotes] = useState('');\n  const [editingTimeId, setEditingTimeId] = useState<number | null>(null);\n  const [editingTimeType, setEditingTimeType] = useState<'startTime' | 'endTime' | null>(null);\n  const [editingTimeValue, setEditingTimeValue] = useState('');\n  const [linkTaskModalOpen, setLinkTaskModalOpen] = useState(false);\n  const [selectedConsultationId, setSelectedConsultationId] = useState<number | null>(null);\n\n  // Filter State Management\n  const [activeFilterName, setActiveFilterName] = useState<string>(t('consultations.filters.today'));\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n\n  // Invoice Creation State\n  const [showCreateInvoiceModal, setShowCreateInvoiceModal] = useState(false);\n\n  const loadConsultations = async () => {\n    try {\n      setLoading(true);\n      const consultations = await consultationApi.getConsultations();\n      setConsultations(consultations || []);\n      setError(null);\n    } catch (error) {\n      console.error('Fehler beim Laden der Beratungen:', error);\n      setError(t('consultations.loadError'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadRecentClients = async () => {\n    try {\n      const clients = await clientApi.getRecentClients();\n      setRecentClients(clients || []);\n    } catch (error) {\n      // Stille Behandlung - normale Situation wenn noch keine Clients beraten wurden\n    }\n  };\n\n  // Imperatives Handle fr Ref-basierte Refresh-Funktion\n  useImperativeHandle(ref, () => ({\n    refresh: loadConsultations,\n    addConsultation: (consultation: Consultation) => {\n      // Optimistisches Update: Fge Consultation zur Liste hinzu\n      setConsultations(prev => [consultation, ...prev]);\n    },\n    updateConsultation: (consultation: Consultation) => {\n      // Optimistisches Update: Aktualisiere Consultation in der Liste\n      setConsultations(prev => \n        prev.map(c => c.id === consultation.id ? consultation : c)\n      );\n    },\n    removeConsultation: (consultationId: number) => {\n      // Optimistisches Update: Entferne Consultation aus der Liste\n      setConsultations(prev => prev.filter(c => c.id !== consultationId));\n    },\n    activateClientFilter: createAndActivateClientFilter\n  }));\n\n  // Initial load\n  useEffect(() => {\n    loadConsultations();\n    loadRecentClients();\n  }, []);\n\n  // Initialer Default-Filter\n  useEffect(() => {\n    const setInitialFilter = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const filters = response.data;\n        \n        const heuteFilter = filters.find((filter: any) => filter.name === 'Heute');\n        if (heuteFilter) {\n          setActiveFilterName(t('consultations.filters.today'));\n          setSelectedFilterId(heuteFilter.id);\n          applyFilterConditions(heuteFilter.conditions, heuteFilter.operators);\n        }\n      } catch (error) {\n        console.error('Fehler beim Setzen des initialen Filters:', error);\n      }\n    };\n\n    setInitialFilter();\n  }, []);\n\n  // Filter Change Handler\n  const handleFilterChange = (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  // Client-Filter erstellen und aktivieren\n  const createAndActivateClientFilter = async (clientName: string) => {\n    try {\n      // Prfe ob Client-Filter bereits existiert\n      const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n      const existingFilters = response.data;\n      \n      let clientFilter = existingFilters.find((filter: any) => filter.name === clientName);\n      \n      if (!clientFilter) {\n        // Erstelle neuen Client-Filter\n        const newFilter = {\n          tableId: CONSULTATIONS_TABLE_ID,\n          name: clientName,\n          conditions: [\n            { column: 'client', operator: 'equals', value: clientName }\n          ],\n          operators: []\n        };\n        \n        const createResponse = await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, newFilter);\n        clientFilter = createResponse.data;\n        \n        // Refresh die Filter-Liste\n        if ((window as any).refreshSavedFilters) {\n          (window as any).refreshSavedFilters();\n        }\n      }\n      \n      // Aktiviere den Client-Filter\n      if (clientFilter) {\n        setActiveFilterName(clientName);\n        setSelectedFilterId(clientFilter.id);\n        applyFilterConditions(clientFilter.conditions, clientFilter.operators);\n      }\n    } catch (error) {\n      console.error('Fehler beim Erstellen/Aktivieren des Client-Filters:', error);\n    }\n  };\n\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        if (!token) return;\n\n        // Prfe, ob Standard-Filter bereits existieren\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const existingFilters = response.data;\n\n        // Lsche veralteten \"Alle\" Filter falls vorhanden\n        const alleFilter = existingFilters.find((filter: any) => filter.name === 'Alle');\n        if (alleFilter) {\n          try {\n            await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(alleFilter.id));\n            logger.log('Veralteter \"Alle\" Filter gelscht');\n          } catch (error) {\n            console.error('Fehler beim Lschen des \"Alle\" Filters:', error);\n          }\n        }\n\n        // Lsche veralteten \"Diese Woche\" Filter falls vorhanden\n        const dieseWocheFilter = existingFilters.find((filter: any) => filter.name === 'Diese Woche');\n        if (dieseWocheFilter) {\n          try {\n            await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(dieseWocheFilter.id));\n            logger.log('Veralteter \"Diese Woche\" Filter gelscht');\n          } catch (error) {\n            console.error('Fehler beim Lschen des \"Diese Woche\" Filters:', error);\n          }\n        }\n\n        const archivFilterExists = existingFilters.some((filter: any) => filter.name === 'Archiv');\n        const heuteFilterExists = existingFilters.some((filter: any) => filter.name === 'Heute');\n        const wocheFilterExists = existingFilters.some((filter: any) => filter.name === 'Woche');\n        const nichtAbgerechnetFilterExists = existingFilters.some((filter: any) => filter.name === 'Nicht abgerechnet');\n\n        // Erstelle \"Archiv\"-Filter (zeigt nur vergangene Beratungen - strikt vor heute)\n        if (!archivFilterExists) {\n          const today = new Date().toISOString().split('T')[0];\n          const archivFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: 'Archiv',\n            conditions: [\n              { column: 'startTime', operator: 'before', value: today }\n            ],\n            operators: []\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, archivFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Archiv-Filters:', error);\n          }\n        }\n\n        // Erstelle \"Heute\"-Filter\n        if (!heuteFilterExists) {\n          const heuteFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: t('consultations.filters.today'),\n            conditions: [\n              { column: 'startTime', operator: 'equals', value: '__TODAY__' }\n            ],\n            operators: []\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, heuteFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Heute-Filters:', error);\n          }\n        }\n\n        // Erstelle \"Woche\"-Filter (von heute bis heute + 7 Tage)\n        if (!wocheFilterExists) {\n          const wocheFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: t('consultations.filters.week'),\n            conditions: [\n              { column: 'startTime', operator: 'after', value: '__TODAY__' },\n              { column: 'startTime', operator: 'before', value: '__WEEK_FROM_TODAY__' }\n            ],\n            operators: ['AND']\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, wocheFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Woche-Filters:', error);\n          }\n        }\n\n        // Erstelle \"Nicht abgerechnet\"-Filter\n        if (!nichtAbgerechnetFilterExists) {\n          const nichtAbgerechnetFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: t('consultations.filters.unbilled'),\n            conditions: [\n              { column: 'invoiceStatus', operator: 'equals', value: 'nicht abgerechnet' }\n            ],\n            operators: []\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, nichtAbgerechnetFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Nicht abgerechnet-Filters:', error);\n          }\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []); // Nur einmal beim ersten Laden\n\n  // Aktualisiere bestehende Filter die alte statische Datumswerte haben\n  useEffect(() => {\n    const updateExistingFilters = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const existingFilters = response.data;\n\n        // Finde \"Heute\" Filter mit statischem Datum\n        const heuteFilter = existingFilters.find((filter: any) => filter.name === 'Heute');\n        if (heuteFilter && heuteFilter.conditions.length > 0) {\n          const condition = heuteFilter.conditions[0];\n          // Prfe ob es ein statisches Datum ist (Format: YYYY-MM-DD) anstatt unseres Markers\n          if (condition.value && condition.value !== '__TODAY__' && /^\\d{4}-\\d{2}-\\d{2}$/.test(condition.value)) {\n            logger.log('Aktualisiere Heute-Filter mit dynamischem Marker...');\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, {\n              tableId: CONSULTATIONS_TABLE_ID,\n              name: t('consultations.filters.today'),\n              conditions: [\n                { column: 'startTime', operator: 'equals', value: '__TODAY__' }\n              ],\n              operators: []\n            });\n          }\n        }\n\n        // Finde \"Woche\" Filter mit statischen Datums\n        const wocheFilter = existingFilters.find((filter: any) => filter.name === 'Woche');\n        if (wocheFilter && wocheFilter.conditions.length >= 2) {\n          const firstCondition = wocheFilter.conditions[0];\n          const secondCondition = wocheFilter.conditions[1];\n          \n          // Prfe ob es statische Datumsangaben sind\n          const hasStaticDates = (\n            firstCondition.value !== '__TODAY__' && /^\\d{4}-\\d{2}-\\d{2}$/.test(firstCondition.value)\n          ) || (\n            secondCondition.value !== '__WEEK_FROM_TODAY__' && /^\\d{4}-\\d{2}-\\d{2}$/.test(secondCondition.value)\n          );\n\n          if (hasStaticDates) {\n            logger.log('Aktualisiere Woche-Filter mit dynamischen Markern...');\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, {\n              tableId: CONSULTATIONS_TABLE_ID,\n              name: t('consultations.filters.week'),\n              conditions: [\n                { column: 'startTime', operator: 'after', value: '__TODAY__' },\n                { column: 'startTime', operator: 'before', value: '__WEEK_FROM_TODAY__' }\n              ],\n              operators: ['AND']\n            });\n          }\n        }\n      } catch (error) {\n        console.error('Fehler beim Aktualisieren bestehender Filter:', error);\n      }\n    };\n\n    // Nach kurzer Verzgerung ausfhren, damit die Standard-Filter-Erstellung abgeschlossen ist\n    const timeoutId = setTimeout(() => {\n      updateExistingFilters();\n    }, 1000);\n\n    return () => clearTimeout(timeoutId);\n  }, []); // Nur einmal beim ersten Laden\n\n  // Separater Effect fr Client-Filter-Management\n  useEffect(() => {\n    const updateClientFilters = async () => {\n      if (recentClients.length === 0) return; // Warte bis Recent Clients geladen sind\n      \n      try {\n        const token = localStorage.getItem('token');\n        if (!token) return;\n\n        // Hole aktuelle Filter\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const existingFilters = response.data;\n\n        // Finde alle bestehenden Client-Filter (alle Filter auer den Standard-Filtern)\n        const existingClientFilters = existingFilters.filter((filter: any) => \n          ![t('consultations.filters.archive'), t('consultations.filters.today'), t('consultations.filters.week')].includes(filter.name)\n        );\n        \n        // Aktuelle Recent Client Namen\n        const currentRecentClientNames = recentClients.map(client => client.name);\n        \n        // Lsche veraltete Client-Filter (die nicht mehr in Recent Clients sind)\n        for (const existingFilter of existingClientFilters) {\n          if (!currentRecentClientNames.includes(existingFilter.name)) {\n            try {\n              await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(existingFilter.id));\n              logger.log(`Veralteter Client-Filter gelscht: ${existingFilter.name}`);\n            } catch (error) {\n              console.error(`Fehler beim Lschen des veralteten Client-Filters ${existingFilter.name}:`, error);\n            }\n          }\n        }\n        \n        // Erstelle neue Client-Filter fr aktuelle Recent Clients\n        for (const client of recentClients) {\n          const clientFilterName = client.name;\n          const clientFilterExists = existingFilters.some((filter: any) => filter.name === clientFilterName);\n          \n          if (!clientFilterExists) {\n            const clientFilter = {\n              tableId: CONSULTATIONS_TABLE_ID,\n              name: clientFilterName,\n              conditions: [\n                { column: 'client', operator: 'equals', value: client.name }\n              ],\n              operators: []\n            };\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, clientFilter);\n            logger.log(`Neuer Client-Filter erstellt: ${clientFilterName}`);\n          }\n        }\n      } catch (error) {\n        console.error('Fehler beim Aktualisieren der Client-Filter:', error);\n      }\n    };\n\n    // Debounce um Race Conditions zu vermeiden\n    const timeoutId = setTimeout(() => {\n      updateClientFilters();\n    }, 500);\n\n    return () => clearTimeout(timeoutId);\n  }, [recentClients]);\n\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n  };\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  const updateNotes = async (consultationId: number, notes: string) => {\n    try {\n      await consultationApi.updateConsultationNotes(consultationId, { notes });\n      setConsultations(prev => \n        prev.map(consultation => \n          consultation.id === consultationId \n            ? { ...consultation, notes }\n            : consultation\n        )\n      );\n      toast.success(t('consultations.notesUpdated'));\n    } catch (error) {\n      console.error('Fehler beim Aktualisieren der Notizen:', error);\n      toast.error(t('consultations.notesUpdateError'));\n    }\n  };\n\n  const handleNotesEdit = (consultation: Consultation) => {\n    setEditingNotesId(consultation.id);\n    setEditingNotes(consultation.notes || '');\n  };\n\n  const handleNotesSave = (consultationId: number) => {\n    updateNotes(consultationId, editingNotes);\n    setEditingNotesId(null);\n  };\n\n  const handleNotesCancel = () => {\n    setEditingNotesId(null);\n    setEditingNotes('');\n  };\n\n  const handleTimeEdit = (consultation: Consultation, timeType: 'startTime' | 'endTime') => {\n    setEditingTimeId(consultation.id);\n    setEditingTimeType(timeType);\n    const currentTime = timeType === 'startTime' ? consultation.startTime : consultation.endTime;\n    if (currentTime) {\n      /* TIMEZONE-PROBLEM BEHOBEN:\n       * \n       * PROBLEM: Doppelte Timezone-Konvertierung!\n       * - DB-Zeit: \"2025-05-31T11:35:33.542Z\" (UTC)\n       * - new Date() konvertiert automatisch: 11:35 UTC  06:35 lokale Zeit\n       * - getTimezoneOffset-Addition: 06:35 + 5h = 11:35 lokale Zeit\n       * - Aber datetime-local zeigt: 16:35 (FALSCH!)\n       * \n       * LSUNG: UTC-Zeit direkt verwenden ohne zustzliche Konvertierung\n       * - DB-Zeit \"11:35 UTC\" soll im Input als \"11:35\" angezeigt werden\n       * - Keine getTimezoneOffset-Addition ntig!\n       */\n      \n      //  KORREKT: Direkte UTC-Zeit-Nutzung ohne doppelte Konvertierung\n      const dbTime = new Date(currentTime);\n      \n      // Verwende die UTC-Komponenten direkt fr datetime-local Input\n      const year = dbTime.getUTCFullYear();\n      const month = String(dbTime.getUTCMonth() + 1).padStart(2, '0');\n      const day = String(dbTime.getUTCDate()).padStart(2, '0');\n      const hours = String(dbTime.getUTCHours()).padStart(2, '0');\n      const minutes = String(dbTime.getUTCMinutes()).padStart(2, '0');\n      \n      const inputValue = `${year}-${month}-${day}T${hours}:${minutes}`;\n      \n      logger.log(' DEBUG handleTimeEdit (KORRIGIERT):');\n      logger.log('- DB Zeit (UTC):', currentTime);\n      logger.log('- Extrahierte UTC-Komponenten:', `${hours}:${minutes}`);\n      logger.log('- inputValue fr datetime-local:', inputValue);\n      \n      setEditingTimeValue(inputValue);\n    }\n  };\n\n  /* CLAUDE-ANCHOR: CONSULTATION-TIME-SAVE-001 - Timezone-sichere Zeitspeicherung */\n  const handleTimeSave = async (consultationId: number) => {\n    if (!editingTimeType || !editingTimeValue) return;\n    \n    try {\n      /* KONSISTENTE API-ARCHITEKTUR:\n       * Verwende die zentralisierte consultationApi.updateConsultationTime Funktion\n       * anstatt direkter axiosInstance Calls fr bessere Wartbarkeit und Testbarkeit\n       */\n      \n      //  KORREKT: Datetime-local Input direkt als UTC verwenden\n      const timeString = `${editingTimeValue}:00.000Z`;  // \"2025-05-31T11:35:00.000Z\"\n      \n      logger.log(' DEBUG handleTimeSave (REFACTORED):');\n      logger.log('- editingTimeValue (Input):', editingTimeValue);\n      logger.log('- timeString fr API (UTC):', timeString);\n      logger.log('- editingTimeType:', editingTimeType);\n      \n      //  REFACTORED: Verwende zentralisierte API-Funktion\n      const response = await consultationApi.updateConsultationTime(consultationId, {\n        [editingTimeType]: timeString\n      });\n      \n      setConsultations(prev => \n        prev.map(consultation => \n          consultation.id === consultationId \n            ? { ...consultation, [editingTimeType]: timeString }\n            : consultation\n        )\n      );\n      \n      toast.success(t('consultations.timeUpdated'));\n      setEditingTimeId(null);\n      setEditingTimeType(null);\n      setEditingTimeValue('');\n    } catch (error: any) {\n      console.error('Fehler beim Aktualisieren der Zeit:', error);\n      toast.error(`${t('consultations.timeUpdateError')}: ${error.response?.data?.message || error.message}`);\n    }\n  };\n\n  const handleTimeCancel = () => {\n    setEditingTimeId(null);\n    setEditingTimeType(null);\n    setEditingTimeValue('');\n  };\n\n  const handleLinkTask = (consultationId: number) => {\n    setSelectedConsultationId(consultationId);\n    setLinkTaskModalOpen(true);\n  };\n\n  const handleTaskLinked = (consultationId: number) => {\n    // Nach Task-Link: Lade nur die betroffene Consultation neu\n    // Fr jetzt: Reload der betroffenen Consultation (spter knnte optimiert werden)\n    loadConsultations();\n    onConsultationChange?.();\n  };\n\n  // Prfung ob Rechnung erstellt werden kann\n  const canCreateInvoice = () => {\n    // Prfe zuerst die Berechtigung\n    const canCreate = hasPermission('invoice_create', 'write', 'button');\n    if (!canCreate) return false;\n    \n    const hasConsultations = filteredConsultations.length > 0;\n    if (!hasConsultations) return false;\n    \n    // Filter mssen aktiv sein (auer Standard-Filter)\n    const hasActiveFilters = filterConditions.length > 0 || searchTerm.trim() !== '';\n    if (!hasActiveFilters) return false;\n    \n    // Alle Beratungen mssen abgeschlossen sein (endTime vorhanden)\n    const allCompleted = filteredConsultations.every(c => c.endTime);\n    if (!allCompleted) return false;\n    \n    // Keine bereits abgerechneten Beratungen\n    const hasInvoicedConsultations = filteredConsultations.some(c => isConsultationInvoiced(c));\n    if (hasInvoicedConsultations) return false;\n    \n    return true;\n  };\n\n  const handleCreateInvoice = () => {\n    setShowCreateInvoiceModal(true);\n  };\n\n  const handleDeleteConsultation = async (consultationId: number) => {\n    // Besttigungsdialog\n    if (!window.confirm(t('consultations.confirmDelete'))) {\n      return;\n    }\n\n    try {\n      await consultationApi.deleteConsultation(consultationId);\n      \n      // Entferne die Beratung aus der lokalen Liste\n      setConsultations(prev => prev.filter(consultation => consultation.id !== consultationId));\n      \n      toast.success(t('consultations.deleteSuccess'));\n      \n      // Informiere die bergeordnete Komponente ber die nderung\n      onConsultationChange?.();\n    } catch (error: any) {\n      console.error('Fehler beim Lschen der Beratung:', error);\n      const errorMessage = error.response?.data?.message || t('consultations.deleteError');\n      toast.error(errorMessage);\n    }\n  };\n\n  const applyFiltersAndSearch = useCallback((consultations: Consultation[]) => {\n    let filtered = consultations;\n\n    // Suchterm-Filter\n    if (searchTerm) {\n      const search = searchTerm.toLowerCase();\n      filtered = filtered.filter(consultation => {\n        //  OPTIMIERUNG: Frhes Beenden bei Match\n        if (consultation.client?.name?.toLowerCase().includes(search)) return true;\n        if (consultation.branch?.name?.toLowerCase().includes(search)) return true;\n        if (consultation.notes?.toLowerCase().includes(search)) return true;\n        return false; // Kein Match gefunden\n      });\n    }\n\n    // Erweiterte Filter mit zentraler Filter-Logik\n    if (filterConditions.length > 0) {\n      // Column-Evaluatoren fr Consultations\n      const columnEvaluators: any = {\n        'client': (consultation: Consultation, cond: FilterCondition) => {\n          const clientName = consultation.client?.name?.toLowerCase() || '';\n          const value = (cond.value as string || '').toLowerCase();\n          if (cond.operator === 'contains') return clientName.includes(value);\n          if (cond.operator === 'equals') return clientName === value;\n          if (cond.operator === 'startsWith') return clientName.startsWith(value);\n          if (cond.operator === 'endsWith') return clientName.endsWith(value);\n          return null;\n        },\n        'branch': (consultation: Consultation, cond: FilterCondition) => {\n          const branchName = consultation.branch?.name?.toLowerCase() || '';\n          const value = (cond.value as string || '').toLowerCase();\n          if (cond.operator === 'contains') return branchName.includes(value);\n          if (cond.operator === 'equals') return branchName === value;\n          if (cond.operator === 'startsWith') return branchName.startsWith(value);\n          if (cond.operator === 'endsWith') return branchName.endsWith(value);\n          return null;\n        },\n        'notes': (consultation: Consultation, cond: FilterCondition) => {\n          const notes = consultation.notes?.toLowerCase() || '';\n          const value = (cond.value as string || '').toLowerCase();\n          if (cond.operator === 'contains') return notes.includes(value);\n          if (cond.operator === 'equals') return notes === value;\n          if (cond.operator === 'startsWith') return notes.startsWith(value);\n          if (cond.operator === 'endsWith') return notes.endsWith(value);\n          return null;\n        },\n        'startTime': (consultation: Consultation, cond: FilterCondition) => {\n          return evaluateDateCondition(consultation.startTime, cond);\n        },\n        'duration': (consultation: Consultation, cond: FilterCondition) => {\n          const duration = calculateDurationInMinutes(consultation.startTime, consultation.endTime);\n          const filterValue = Number(cond.value) * 60; // Convert hours to minutes\n          if (cond.operator === 'greater_than') return duration > filterValue;\n          if (cond.operator === 'less_than') return duration < filterValue;\n          if (cond.operator === 'equals') return Math.abs(duration - filterValue) < 30; // 30-minute tolerance\n          return null;\n        },\n        'invoiceStatus': (consultation: Consultation, cond: FilterCondition) => {\n          const isInvoiced = isConsultationInvoiced(consultation);\n          const isInMonthlyReport = isConsultationInMonthlyReport(consultation);\n          const filterValueLower = String(cond.value).toLowerCase();\n          \n          if (filterValueLower === 'abgerechnet' || filterValueLower === 'invoiced' || filterValueLower === 'ja') {\n            return isInvoiced || isInMonthlyReport;\n          } else if (filterValueLower === 'nicht abgerechnet' || filterValueLower === 'not invoiced' || filterValueLower === 'nein') {\n            return !isInvoiced && !isInMonthlyReport;\n          } else if (filterValueLower === 'einzelrechnung' || filterValueLower === 'invoice') {\n            return isInvoiced;\n          } else if (filterValueLower === 'monatsbericht' || filterValueLower === 'monthly report') {\n            return isInMonthlyReport;\n          } else {\n            // Exact status match wenn ein spezifischer Status eingegeben wurde\n            if (isInvoiced) {\n              const invoiceInfo = getConsultationInvoiceInfo(consultation);\n              const statusText = invoiceInfo ? getInvoiceStatusText(invoiceInfo.status as any).toLowerCase() : '';\n              return statusText.includes(filterValueLower);\n            } else if (isInMonthlyReport) {\n              const monthlyReportInfo = getConsultationMonthlyReportInfo(consultation);\n              if (monthlyReportInfo) {\n                const statusText = monthlyReportInfo.status === 'GENERATED' ? 'erstellt' : \n                                 monthlyReportInfo.status === 'SENT' ? 'gesendet' : 'archiviert';\n                return statusText.includes(filterValueLower);\n              } else {\n                return false;\n              }\n            } else {\n              return false;\n            }\n          }\n        }\n      };\n\n      const getFieldValue = (consultation: Consultation, columnId: string): any => {\n        switch (columnId) {\n          case 'client': return consultation.client?.name || '';\n          case 'branch': return consultation.branch?.name || '';\n          case 'notes': return consultation.notes || '';\n          case 'startTime': return consultation.startTime;\n          case 'duration': return calculateDurationInMinutes(consultation.startTime, consultation.endTime);\n          case 'invoiceStatus': {\n            const isInvoiced = isConsultationInvoiced(consultation);\n            const isInMonthlyReport = isConsultationInMonthlyReport(consultation);\n            if (isInvoiced) return 'invoiced';\n            if (isInMonthlyReport) return 'monthly_report';\n            return 'not_invoiced';\n          }\n          default: return (consultation as any)[columnId];\n        }\n      };\n\n      filtered = applyFilters(\n        filtered,\n        filterConditions,\n        filterLogicalOperators,\n        getFieldValue,\n        columnEvaluators\n      );\n    }\n\n    return filtered;\n  }, [consultations, searchTerm, filterConditions, filterLogicalOperators]);\n\n  const calculateDurationInMinutes = (startTime: string, endTime: string | null): number => {\n    if (!endTime) return 0;\n    const start = new Date(startTime);\n    const end = new Date(endTime);\n    return (end.getTime() - start.getTime()) / (1000 * 60);\n  };\n\n  // Timeline-Markierungen generieren\n  const generateTimelineMarkers = (consultations: Consultation[]) => {\n    const markers: Array<{\n      id: string;\n      type: 'day' | 'midday';\n      date: string;\n      label: string;\n      position: number; // Index position in der gefilterten Liste\n    }> = [];\n\n    consultations.forEach((consultation, index) => {\n      const currentDate = new Date(consultation.startTime);\n      const currentDay = format(currentDate, 'yyyy-MM-dd', { locale: de });\n      const currentHour = currentDate.getUTCHours(); // UTC verwenden statt getHours()\n      \n      // Prfe vorherige Beratung fr Tagesbergang\n      if (index > 0) {\n        const prevDate = new Date(consultations[index - 1].startTime);\n        const prevDay = format(prevDate, 'yyyy-MM-dd', { locale: de });\n        \n        if (currentDay !== prevDay) {\n          markers.push({\n            id: `day-${currentDay}`,\n            type: 'day',\n            date: currentDay,\n            label: format(currentDate, 'EEE, dd.MM.', { locale: de }),\n            position: index\n          });\n        }\n      } else if (index === 0) {\n        // Erste Beratung bekommt immer eine Tagesmarkierung\n        markers.push({\n          id: `day-${currentDay}`,\n          type: 'day', \n          date: currentDay,\n          label: format(currentDate, 'EEE, dd.MM.', { locale: de }),\n          position: index\n        });\n      }\n\n      // Prfe fr Mittag-Markierung (12:00 bergang) - jetzt mit UTC\n      if (index > 0) {\n        const prevDate = new Date(consultations[index - 1].startTime);\n        const prevHour = prevDate.getUTCHours(); // UTC verwenden statt getHours()\n        const prevDay = format(prevDate, 'yyyy-MM-dd', { locale: de });\n        \n        // Mittag-Markierung nur wenn am gleichen Tag und bergang ber 12:00 UTC\n        if (currentDay === prevDay && prevHour < 12 && currentHour >= 12) {\n          markers.push({\n            id: `midday-${currentDay}`,\n            type: 'midday',\n            date: currentDay,\n            label: t('consultations.midday'),\n            position: index\n          });\n        }\n      }\n    });\n\n    return markers;\n  };\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const filteredConsultations = useMemo(() => {\n    return applyFiltersAndSearch(consultations).sort((a, b) => {\n      return new Date(a.startTime).getTime() - new Date(b.startTime).getTime();\n    });\n  }, [consultations, filterConditions, filterLogicalOperators]);\n\n  // Total-Dauer aller sichtbaren Beratungen berechnen\n  const totalDuration = useMemo(() => {\n    return formatTotalDuration(filteredConsultations);\n  }, [filteredConsultations]);\n\n  // Timeline-Markierungen berechnen\n  const timelineMarkers = useMemo(() => {\n    return generateTimelineMarkers(filteredConsultations);\n  }, [filteredConsultations]);\n\n  // Helper function to check if consultation is billed in monthly report\n  const isConsultationInMonthlyReport = (consultation: Consultation): boolean => {\n    return consultation.monthlyReportId !== null && consultation.monthlyReportId !== undefined;\n  };\n\n  // Helper function to get monthly report info\n  const getConsultationMonthlyReportInfo = (consultation: Consultation) => {\n    return consultation.monthlyReport;\n  };\n\n  // Helper function to get the billing status\n  const getConsultationBillingStatus = (consultation: Consultation) => {\n    const isInvoiced = isConsultationInvoiced(consultation);\n    const isInMonthlyReport = isConsultationInMonthlyReport(consultation);\n    \n    if (isInvoiced) {\n      const invoiceInfo = getConsultationInvoiceInfo(consultation);\n      return {\n        type: 'invoice' as const,\n        status: t('consultations.invoice'),\n        info: invoiceInfo\n      };\n    } else if (isInMonthlyReport) {\n      const monthlyReportInfo = getConsultationMonthlyReportInfo(consultation);\n      return {\n        type: 'monthly' as const,\n        status: t('consultations.monthlyReport'),\n        info: monthlyReportInfo\n      };\n    }\n    \n    return null;\n  };\n\n  // Navigation functions\n  const navigateToMonthlyReports = (reportId?: number) => {\n    const url = reportId \n      ? `/payroll?tab=monthly-reports&reportId=${reportId}`\n      : '/payroll?tab=monthly-reports';\n    navigate(url);\n  };\n\n  const navigateToInvoices = (invoiceId?: number) => {\n    const url = invoiceId \n      ? `/payroll?tab=invoices&invoiceId=${invoiceId}`\n      : '/payroll?tab=invoices';\n    navigate(url);\n  };\n\n  const navigateToTask = (taskId: number) => {\n    navigate(`/worktracker?editTask=${taskId}`);\n  };\n\n  if (loading) return <div className=\"p-4\">{t('common.loading')}</div>;\n  if (error) return <div className=\"p-4 text-red-600\">{error}</div>;\n\n  return (\n    <>\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        {/* Header */}\n        <div className=\"flex items-center mb-6 justify-between px-2 sm:px-0\">\n          <div className=\"flex items-center\">\n            <ClockIcon className=\"h-6 w-6 mr-2 dark:text-white\" />\n            <div>\n              <h2 className=\"text-xl font-semibold dark:text-white\">{t('consultations.listTitle')}</h2>\n              {/* Total-Anzeige */}\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-0.5\">\n                {t('consultations.count', { count: filteredConsultations.length })} - {t('consultations.total')}: {totalDuration}\n              </p>\n            </div>\n          </div>\n          \n          <div className=\"flex items-center gap-1.5\">\n            <input\n              type=\"text\"\n              placeholder={t('common.searchPlaceholder')}\n              className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n            \n            <div className=\"relative group ml-1\">\n              <button\n                className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n                onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n              >\n                <FunnelIcon className=\"h-5 w-5\" />\n                {getActiveFilterCount() > 0 && (\n                  <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                    {getActiveFilterCount()}\n                  </span>\n                )}\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('consultations.advancedFilters')}\n              </div>\n            </div>\n\n            {/* Rechnung erstellen Button */}\n            {canCreateInvoice() && (\n              <div className=\"relative group ml-2\">\n                <button\n                  onClick={handleCreateInvoice}\n                  className=\"p-2 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors\"\n                >\n                  <DocumentTextIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('consultations.createInvoiceFromFiltered')}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Filter-Pane */}\n        {isFilterPanelOpen && (\n          <div className=\"px-2 sm:px-0\">\n            <FilterPane\n              columns={[\n                { id: 'client', label: t('consultations.columns.client') },\n                { id: 'branch', label: t('consultations.columns.branch') },\n                { id: 'notes', label: t('consultations.columns.notes') },\n                { id: 'startTime', label: t('consultations.columns.date') },\n                { id: 'duration', label: t('consultations.columns.durationHours') },\n                { id: 'invoiceStatus', label: t('consultations.columns.invoiceStatus') }\n              ]}\n              onApply={applyFilterConditions}\n              onReset={resetFilterConditions}\n              savedConditions={filterConditions}\n              savedOperators={filterLogicalOperators}\n              tableId={CONSULTATIONS_TABLE_ID}\n            />\n          </div>\n        )}\n        \n        {/* Gespeicherte Filter als Tags anzeigen */}\n        <div className=\"px-2 sm:px-0\">\n          <SavedFilterTags\n            tableId={CONSULTATIONS_TABLE_ID}\n            onSelectFilter={applyFilterConditions}\n            onReset={resetFilterConditions}\n            activeFilterName={activeFilterName}\n            selectedFilterId={selectedFilterId}\n            onFilterChange={handleFilterChange}\n          />\n        </div>\n\n        {/* Timeline + Cards Layout */}\n        <div className=\"space-y-0.5 sm:space-y-1\">\n          {filteredConsultations.length === 0 ? (\n            <div className=\"text-center py-12 px-2 sm:px-0\">\n              <ClockIcon className=\"h-12 w-12 text-gray-400 dark:text-gray-500 mx-auto mb-4\" />\n              <div>\n                <p className=\"font-medium text-gray-900 dark:text-white\">{t('consultations.noConsultationsFound')}</p>\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                  {searchTerm || filterConditions.length > 0\n                    ? t('consultations.tryOtherFilters')\n                    : t('consultations.noConsultationsYet')}\n                </p>\n              </div>\n            </div>\n          ) : (\n            filteredConsultations.map((consultation, index) => {\n              const dayMarker = timelineMarkers.find(m => m.type === 'day' && m.position === index);\n              const middayMarker = timelineMarkers.find(m => m.type === 'midday' && m.position === index);\n              \n              return (\n                <div key={consultation.id} className=\"relative\">\n                  {/* Tagesmarkierung ber der Card */}\n                  {dayMarker && (\n                    <div className=\"flex items-center mb-3 px-2 sm:px-0\">\n                      <div className=\"flex items-center\">\n                        <div className=\"w-3 h-3 rounded-full bg-blue-500 dark:bg-blue-400 border-2 border-white dark:border-gray-800\"></div>\n                        <div className=\"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300\">\n                          {dayMarker.label}\n                        </div>\n                      </div>\n                      <div className=\"flex-1 ml-4 h-px bg-gray-200 dark:bg-gray-600\"></div>\n                    </div>\n                  )}\n                  \n                  {/* Mittag-Markierung */}\n                  {middayMarker && (\n                    <div className=\"flex items-center mb-3 px-2 sm:px-0\">\n                      <div className=\"flex items-center\">\n                        <div className=\"w-1.5 h-1.5 rounded-full bg-gray-400 dark:bg-gray-500\"></div>\n                        <div className=\"ml-3 text-xs text-gray-500 dark:text-gray-400\">\n                          {middayMarker.label}\n                        </div>\n                      </div>\n                      <div className=\"flex-1 ml-4 h-px bg-gray-300 dark:bg-gray-600\"></div>\n                    </div>\n                  )}\n\n                  {/* Card ohne Timeline-Punkt */}\n                  <div className=\"bg-white dark:bg-gray-800 shadow rounded-lg md:border md:border-gray-200 md:dark:border-gray-700 hover:shadow-md transition-shadow\">\n                    {/* Card Content - 1/3 left, 2/3 right auf allen Bildschirmgren */}\n                    <div className=\"p-4\">\n                      <div className=\"grid grid-cols-3 gap-4\">\n                        {/* Left: Compact Info - 1/3 auf allen Bildschirmgren */}\n                        <div className=\"col-span-1 space-y-3\">\n                          {/* Client Header */}\n                          <div className=\"flex items-center space-x-2\">\n                            <div className=\"min-w-0 flex-1\">\n                              <h3 className=\"font-medium text-gray-900 dark:text-white text-sm truncate\">\n                                {consultation.client?.name}\n                              </h3>\n                              {consultation.client?.company && (\n                                <p className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">\n                                  {consultation.client.company}\n                                </p>\n                              )}\n                            </div>\n                          </div>\n\n                          {/* Billing Status Indicator */}\n                          {(() => {\n                            const billingStatus = getConsultationBillingStatus(consultation);\n                            \n                            if (billingStatus) {\n                              if (billingStatus.type === 'invoice') {\n                                // Individual invoice\n                                return (\n                                  <div className=\"flex items-center space-x-2\">\n                                    <div className=\"flex items-center space-x-1\">\n                                      <DocumentTextIcon className=\"h-4 w-4 text-green-600 dark:text-green-400\" />\n                                      <button \n                                        onClick={() => navigateToInvoices(billingStatus.info?.id)}\n                                        className=\"text-xs text-green-700 dark:text-green-400 font-medium hover:underline cursor-pointer\"\n                                      >\n                                        {t('consultations.invoice')}\n                                      </button>\n                                    </div>\n                                    {billingStatus.info && 'invoiceNumber' in billingStatus.info && (\n                                      <div className=\"flex items-center space-x-1\">\n                                        <div className=\"relative group\">\n                                          <button\n                                            onClick={() => navigateToInvoices(billingStatus.info?.id)}\n                                            className={`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium hover:opacity-80 cursor-pointer ${getInvoiceStatusColor(billingStatus.info.status as any)}`}\n                                          >\n                                            {getInvoiceStatusText(billingStatus.info.status as any)}\n                                          </button>\n                                          <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {`Rechnung ${billingStatus.info.invoiceNumber} vom ${format(new Date(billingStatus.info.issueDate), 'dd.MM.yyyy', { locale: de })}`}\n                                          </div>\n                                        </div>\n                                      </div>\n                                    )}\n                                  </div>\n                                );\n                              } else if (billingStatus.type === 'monthly') {\n                                // Monthly report\n                                return (\n                                  <div className=\"flex items-center space-x-2\">\n                                    <div className=\"flex items-center space-x-1\">\n                                      <ChartBarIcon className=\"h-4 w-4 text-green-600 dark:text-green-400\" />\n                                      <button \n                                        onClick={() => navigateToMonthlyReports(billingStatus.info?.id)}\n                                        className=\"text-xs text-green-700 dark:text-green-400 font-medium hover:underline cursor-pointer\"\n                                      >\n                                        {t('consultations.monthlyReport')}\n                                      </button>\n                                    </div>\n                                    {billingStatus.info && 'reportNumber' in billingStatus.info && (\n                                      <div className=\"flex items-center space-x-1\">\n                                        <div className=\"relative group\">\n                                          <button \n                                            onClick={() => navigateToMonthlyReports(billingStatus.info?.id)}\n                                            className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300 hover:opacity-80 cursor-pointer\"\n                                          >\n                                            {billingStatus.info.status === 'GENERATED' ? t('analytics.monthlyReports.status.generated') : \n                                             billingStatus.info.status === 'SENT' ? t('analytics.monthlyReports.status.sent') : t('analytics.monthlyReports.status.archived')}\n                                          </button>\n                                          <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {`Monatsbericht ${billingStatus.info.reportNumber}`}\n                                          </div>\n                                        </div>\n                                      </div>\n                                    )}\n                                  </div>\n                                );\n                              }\n                            }\n                            \n                            return null;\n                          })()}\n\n                          {/* Time Range - Single compact field */}\n                          <div>\n                            <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">{t('consultations.columns.time')}</p>\n                            <div className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                              {editingTimeId === consultation.id && editingTimeType === 'startTime' ? (\n                                <div className=\"flex items-center space-x-1\">\n                                  <input\n                                    type=\"datetime-local\"\n                                    value={editingTimeValue}\n                                    onChange={(e) => setEditingTimeValue(e.target.value)}\n                                    className=\"text-xs rounded border-gray-300 dark:border-gray-600 dark:bg-gray-700 w-full\"\n                                  />\n                                  <div className=\"relative group\">\n                                    <button\n                                      onClick={() => handleTimeSave(consultation.id)}\n                                      className=\"p-0.5 text-green-600 hover:text-green-700\"\n                                    >\n                                      <svg className=\"h-3 w-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                                      </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                      {t('common.save')}\n                                    </div>\n                                  </div>\n                                  <div className=\"relative group\">\n                                    <button\n                                      onClick={handleTimeCancel}\n                                      className=\"p-0.5 text-red-600 hover:text-red-700\"\n                                    >\n                                      <XMarkIcon className=\"h-3 w-3\" />\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                      {t('common.cancel')}\n                                    </div>\n                                  </div>\n                                </div>\n                              ) : editingTimeId === consultation.id && editingTimeType === 'endTime' ? (\n                                <div className=\"flex items-center space-x-1\">\n                                  <input\n                                    type=\"datetime-local\"\n                                    value={editingTimeValue}\n                                    onChange={(e) => setEditingTimeValue(e.target.value)}\n                                    className=\"text-xs rounded border-gray-300 dark:border-gray-600 dark:bg-gray-700 w-full\"\n                                  />\n                                  <div className=\"relative group\">\n                                    <button\n                                      onClick={() => handleTimeSave(consultation.id)}\n                                      className=\"p-0.5 text-green-600 hover:text-green-700\"\n                                    >\n                                      <svg className=\"h-3 w-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                                      </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                      {t('common.save')}\n                                    </div>\n                                  </div>\n                                  <div className=\"relative group\">\n                                    <button\n                                      onClick={handleTimeCancel}\n                                      className=\"p-0.5 text-red-600 hover:text-red-700\"\n                                    >\n                                      <XMarkIcon className=\"h-3 w-3\" />\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                      {t('common.cancel')}\n                                    </div>\n                                  </div>\n                                </div>\n                              ) : (\n                                <div className=\"flex items-center space-x-1\">\n                                  <button\n                                    onClick={() => handleTimeEdit(consultation, 'startTime')}\n                                    className=\"text-blue-600 hover:text-blue-700 dark:text-blue-400 hover:underline\"\n                                  >\n                                    {formatTime(consultation.startTime)}\n                                  </button>\n                                  <span className=\"text-gray-400\">-</span>\n                                  {consultation.endTime ? (\n                                    <button\n                                      onClick={() => handleTimeEdit(consultation, 'endTime')}\n                                      className=\"text-blue-600 hover:text-blue-700 dark:text-blue-400 hover:underline\"\n                                    >\n                                      {formatTime(consultation.endTime)}\n                                    </button>\n                                  ) : (\n                                    <div className=\"flex items-center\">\n                                      <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full mr-1 animate-pulse\"></div>\n                                      <span className=\"text-green-600 dark:text-green-400 text-xs\">{t('consultations.active')}</span>\n                                    </div>\n                                  )}\n                                </div>\n                              )}\n                            </div>\n                          </div>\n\n                          {/* Duration */}\n                          <div>\n                            <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">{t('consultations.columns.duration')}</p>\n                            <p className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                              {calculateDuration(consultation.startTime, consultation.endTime)}\n                            </p>\n                          </div>\n\n                          {/* Tasks - Compact */}\n                          {consultation.taskLinks && consultation.taskLinks.length > 0 && (\n                            <div>\n                              <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                {t('consultations.tasks', { count: consultation.taskLinks.length })}\n                              </p>\n                              <div className=\"space-y-1\">\n                                {consultation.taskLinks.slice(0, 2).map((taskLink) => (\n                                  <button\n                                    key={taskLink.id}\n                                    onClick={() => navigateToTask(taskLink.task.id)}\n                                    className=\"flex items-center text-xs text-blue-700 dark:text-blue-300 bg-blue-50 dark:bg-blue-900/20 rounded px-2 py-1 hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors cursor-pointer w-full text-left\"\n                                  >\n                                    <LinkIcon className=\"h-3 w-3 mr-1 flex-shrink-0\" />\n                                    <span className=\"truncate\">{taskLink.task.title}</span>\n                                  </button>\n                                ))}\n                                {consultation.taskLinks.length > 2 && (\n                                  <button\n                                    onClick={() => {\n                                      // Navigate to first task if more than 2 tasks\n                                      if (consultation.taskLinks && consultation.taskLinks.length > 0) {\n                                        navigateToTask(consultation.taskLinks[0].task.id);\n                                      }\n                                    }}\n                                    className=\"text-xs text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 cursor-pointer\"\n                                  >\n                                    {t('consultations.moreTasks', { count: consultation.taskLinks.length - 2 })}\n                                  </button>\n                                )}\n                              </div>\n                            </div>\n                          )}\n                        </div>\n\n                        {/* Right: Notes - 2/3 auf allen Bildschirmgren */}\n                        <div className=\"col-span-2 relative\">\n                          {/* Action Icons in der rechten oberen Ecke */}\n                          <div className=\"absolute top-0 right-0 flex items-center space-x-1 z-10\">\n                            {hasPermission('consultations', 'write') && (\n                              <div className=\"relative group\">\n                                <button\n                                  onClick={() => handleLinkTask(consultation.id)}\n                                  className=\"p-1 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 rounded\"\n                                >\n                                  <LinkIcon className=\"h-4 w-4\" />\n                                </button>\n                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                  {t('consultations.linkTask')}\n                                </div>\n                              </div>\n                            )}\n                            {hasPermission('consultations', 'write') && consultation.endTime && (\n                              <div className=\"relative group\">\n                                <button\n                                  onClick={() => handleDeleteConsultation(consultation.id)}\n                                  className=\"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400 rounded\"\n                                >\n                                  <TrashIcon className=\"h-4 w-4\" />\n                                </button>\n                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                  {t('consultations.delete')}\n                                </div>\n                              </div>\n                            )}\n                          </div>\n                          \n                          <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2\">{t('consultations.columns.notes')}</p>\n                          {editingNotesId === consultation.id ? (\n                            <div className=\"space-y-2\">\n                              <textarea\n                                value={editingNotes}\n                                onChange={(e) => setEditingNotes(e.target.value)}\n                                className=\"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm resize-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n                                rows={3}\n                                placeholder={t('consultations.notesPlaceholder')}\n                              />\n                              <div className=\"flex justify-end space-x-2\">\n                                <div className=\"relative group\">\n                                  <button\n                                    onClick={handleNotesCancel}\n                                    className=\"p-1.5 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                  >\n                                    <XMarkIcon className=\"h-4 w-4\" />\n                                  </button>\n                                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                    {t('common.cancel')}\n                                  </div>\n                                </div>\n                                <div className=\"relative group\">\n                                  <button\n                                    onClick={() => handleNotesSave(consultation.id)}\n                                    className=\"p-1.5 bg-blue-600 text-white hover:bg-blue-700 rounded-md\"\n                                  >\n                                    <CheckIcon className=\"h-4 w-4\" />\n                                  </button>\n                                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                    {t('common.save')}\n                                  </div>\n                                </div>\n                              </div>\n                            </div>\n                          ) : (\n                            <div \n                              className=\"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded p-2 min-h-[60px] border border-dashed border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 transition-colors\"\n                              onClick={() => handleNotesEdit(consultation)}\n                            >\n                              {consultation.notes ? (\n                                <p className=\"text-sm text-gray-900 dark:text-white whitespace-pre-wrap leading-relaxed\">\n                                  {consultation.notes}\n                                </p>\n                              ) : (\n                                <div className=\"flex items-center justify-center h-full text-center\">\n                                  <span className=\"text-xs text-gray-400 dark:text-gray-500\">\n                                    {t('consultations.addNotes')}\n                                  </span>\n                                </div>\n                              )}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              );\n            })\n          )}\n        </div>\n      </div>\n\n      {/* Link Task Modal */}\n      {linkTaskModalOpen && selectedConsultationId && (\n        <LinkTaskModal\n          isOpen={linkTaskModalOpen}\n          onClose={() => {\n            setLinkTaskModalOpen(false);\n            setSelectedConsultationId(null);\n          }}\n          consultationId={selectedConsultationId}\n          onTaskLinked={handleTaskLinked}\n        />\n      )}\n\n      {/* Create Invoice Modal */}\n      {showCreateInvoiceModal && (\n        <CreateInvoiceModal\n          isOpen={showCreateInvoiceModal}\n          onClose={() => setShowCreateInvoiceModal(false)}\n          consultations={filteredConsultations}\n          onInvoiceCreated={(invoiceId) => {\n            setShowCreateInvoiceModal(false);\n            // Nach Rechnungserstellung: Markiere betroffene Consultations als abgerechnet\n            // Fr jetzt: Reload der Liste (spter knnte optimiert werden)\n            loadConsultations();\n            toast.success(t('consultations.invoiceCreated'));\n          }}\n        />\n      )}\n    </>\n  );\n});\n\nexport default ConsultationList; ","import React, { useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport ConsultationTracker from '../components/ConsultationTracker.tsx';\nimport ConsultationList, { ConsultationListRef } from '../components/ConsultationList.tsx';\n\nconst Consultations: React.FC = () => {\n  const { t } = useTranslation();\n  const { hasPermission } = usePermissions();\n  const consultationListRef = useRef<ConsultationListRef>(null);\n\n  // Callback-Funktion fr das Neuladen der Beratungsliste (normale Aktionen)\n  const handleConsultationChange = useCallback((consultation?: any) => {\n    if (consultation && consultation.id) {\n      // Wenn eine Consultation bergeben wurde, verwenden wir den imperativen Handle\n      // um die Consultation zur Liste hinzuzufgen oder zu aktualisieren\n      // Prfe: Wenn endTime vorhanden, ist es ein Update (Stop), sonst ein Add (Start)\n      if (consultation.endTime) {\n        // Consultation wurde beendet - Update\n        consultationListRef.current?.updateConsultation?.(consultation);\n      } else {\n        // Consultation wurde gestartet - Add\n        consultationListRef.current?.addConsultation?.(consultation);\n      }\n    } else {\n      // Fallback: Vollstndiges Reload wenn keine Consultation bergeben\n      consultationListRef.current?.refresh();\n    }\n  }, []);\n\n  // Callback-Funktion fr das Starten einer Beratung (Filter wechseln)\n  const handleConsultationStarted = useCallback((clientName: string) => {\n    // Triggert ein Neuladen der Beratungsliste UND wechselt zum Client-Filter\n    consultationListRef.current?.refresh();\n    consultationListRef.current?.activateClientFilter?.(clientName);\n  }, []);\n\n  // Prfe Berechtigungen\n  if (!hasPermission('consultations', 'read')) {\n    return (\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-4\">\n          <div className=\"flex\">\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800 dark:text-red-200\">\n                {t('consultations.noPermission')}\n              </h3>\n              <div className=\"mt-2 text-sm text-red-700 dark:text-red-300\">\n                <p>{t('consultations.noPermissionMessage')}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen dark:bg-gray-900\">\n      <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\n        <div className=\"space-y-6\">\n        {/* Consultation Tracker */}\n        <ConsultationTracker \n          onConsultationChange={handleConsultationChange}\n          onConsultationStarted={handleConsultationStarted}\n        />\n\n        {/* Consultation List */}\n        <ConsultationList \n          ref={consultationListRef}\n          onConsultationChange={handleConsultationChange}\n        />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Consultations; "],"names":["formatDate","dateString","dateParts","split","length","year","parseInt","month","day","Date","toLocaleDateString","error","console","formatTime","date","parseISO","hours","getUTCHours","toString","padStart","minutes","getUTCMinutes","concat","calculateDuration","startTime","endTime","startISOString","endsWith","substring","endISOString","start","durationMs","getTime","durationMinutes","Math","floor","convertWeekToDate","weekString","week","dayOfWeek","UTC","getUTCDay","daysToThursday","firstThursday","targetThursday","getUTCFullYear","getUTCMonth","getUTCDate","monday","formattedDate","format","logger","log","locale","de","warn","correctedMonday","startOfWeek","weekStartsOn","fallbackMonday","isWorktimeRelevantForSelectedDate","worktime","selectedDate","getWeekDays","weekStartDate","weekStart","weekDays","i","addDays","dayInfo","push","formatDateTimeForCerebro","dateTimeString","hour","minute","convertQuinzenaToDate","quinzenaString","quinzena","includes","Error","parts","datePart","ceil","startDay","quinzenaStart","fallback","getQuinzenaDays","quinzenaStartDate","getFullYear","getMonth","daysCount","getDate","quinzenaDays","currentDay","getCurrentQuinzena","today","dateObj","String","getQuinzenaFromDate","createLocalDate","getTimezoneOffset","formatTotalDuration","consultations","totalMinutes","reduce","total","consultation","isConsultationInvoiced","invoiceItems","getConsultationInvoiceInfo","invoice","getInvoiceStatusText","status","getInvoiceStatusColor","evaluateCondition","fieldValue","condition","operator","value","undefined","strField","strValue","fieldValueStr","lowerField","toLowerCase","valueStr","lowerValue","startsWith","typeof","fieldDate","valueDate","isNaN","fieldNum","parseFloat","valueNum","applyFilters","items","conditions","operators","getFieldValue","columnEvaluators","filter","item","result","conditionMet","column","customResult","evaluateDateCondition","dateValue","dateYear","dateMonth","dateDay","normalizedDate","setHours","weekEnd","endOfWeek","monthStart","startOfMonth","monthEnd","endOfMonth","yearStart","startOfYear","yearEnd","endOfYear","conditionDate","localToday","conditionDateRaw","conditionYear","conditionMonth","conditionDay","evaluateUserRoleCondition","userId","roleId","textValue","targetUserId","replace","matches","targetRoleId","textValueLower","valueLower","deleteClient","async","axiosInstance","delete","API_ENDPOINTS","CLIENTS","BY_ID","clientId","data","getRecentClients","get","RECENT","_ref","isOpen","onClose","onClientUpdated","onClientDeleted","client","t","useTranslation","showMessage","useMessage","openSidepane","closeSidepane","useSidepane","isLargeScreen","setIsLargeScreen","useState","window","innerWidth","formData","setFormData","name","company","email","phone","address","notes","isActive","errors","setErrors","loading","setLoading","confirmDelete","setConfirmDelete","isMobile","setIsMobile","useEffect","checkScreenSize","addEventListener","removeEventListener","handleSubmit","e","preventDefault","validateForm","newErrors","trim","test","Object","keys","updated","put","clientApi","id","defaultValue","_error$response","_error$response$data","response","message","handleDelete","_error$response2","_error$response2$data","_error$response3","_error$response3$data","_error$response4","_error$response4$data","_error$response5","errorMessage","errorDetails","details","errorSuggestion","suggestion","entries","_ref2","_","count","map","_ref3","key","translationKey","join","handleChange","type","target","checked","prev","_objectSpread","handleClose","_jsxs","Dialog","open","className","children","_jsx","Panel","Title","onClick","XMarkIcon","onSubmit","htmlFor","onChange","rows","disabled","TrashIcon","title","ArrowPathIcon","CheckIcon","_Fragment","style","opacity","transition","pointerEvents","role","values","idx","onSelect","onCreateNew","clients","setClients","filteredClients","setFilteredClients","searchTerm","setSearchTerm","editingClient","setEditingClient","isEditModalOpen","setIsEditModalOpen","loadClients","filtered","BASE","MagnifyingGlassIcon","placeholder","autoFocus","PlusIcon","handleEdit","stopPropagation","PencilIcon","confirm","toast","success","EditClientModal","updatedClient","index","findIndex","c","newClients","onSave","post","startConsultation","CONSULTATIONS","START","stopConsultation","STOP","updateConsultationNotes","consultationId","patch","UPDATE_NOTES","isPlaceholder","_activeConsultation$c","_activeConsultation$c2","onConsultationChange","onConsultationStarted","user","useAuth","selectedBranch","useBranch","activeConsultation","setActiveConsultation","isStarting","setIsStarting","isClientSelectModalOpen","setIsClientSelectModalOpen","isCreateClientModalOpen","setIsCreateClientModalOpen","selectedClient","setSelectedClient","recentClients","setRecentClients","setNotes","lastStartedClientId","setLastStartedClientId","containerRef","useRef","visibleTagCount","setVisibleTagCount","containerWidth","setContainerWidth","isManualEntry","setIsManualEntry","manualStartTime","setManualStartTime","manualEndTime","setManualEndTime","checkActiveConsultation","loadRecentClients","WORKTIME","ACTIVE","handleStartConsultation","_consultation$client","correctedStartTime","consultationApi","branchId","toISOString","dispatchEvent","CustomEvent","updateNotes","timeout","setTimeout","clearTimeout","handleFocus","averageTagWidth","useMemo","sum","calculateVisibleTags","useCallback","current","currentWidth","clientWidth","abs","availableWidth","maxPossibleTags","max","min","useResizeObserver","debounceMs","useLayoutEffect","showOptimisticTags","optimisticTags","Array","fill","lastConsultationDate","displayTags","currentVisibleCount","sortedDisplayTags","lastStartedClient","find","UserGroupIcon","ClockIcon","onBlur","correctedEndTime","stoppedConsultation","StopIcon","some","ref","width","height","slice","isPlanned","Number","clientName","viewBox","fillRule","d","clipRule","PlayIcon","manualStart","manualEnd","ClientSelectModal","handleCreateClient","CreateClientModal","onTaskLinked","tasks","setTasks","filteredTasks","setFilteredTasks","selectedTaskId","setSelectedTaskId","loadTasks","task","activeTasks","TASKS","responsible","firstName","lastName","LINK_TASK","taskId","LinkIcon","invoiceId","invoiceNumber","totalAmount","downloadingPdf","setDownloadingPdf","CheckCircleIcon","CONSULTATION_INVOICES","GENERATE_PDF","responseType","headers","blob","Blob","url","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","DocumentArrowDownIcon","handleViewInvoiceManagement","EyeIcon","onInvoiceCreated","hasPermission","usePermissions","settings","setSettings","createdInvoice","setCreatedInvoice","showSuccessModal","setShowSuccessModal","issueDate","dueDate","now","hourlyRate","vatRate","canCreateInvoices","loadInvoiceSettings","settingsData","INVOICE_SETTINGS","defaultHourlyRate","defaultVatRate","totalHours","duration","estimatedTotal","vatAmount","totalWithVat","uniqueClientIds","Set","_consultations$","_consultations$$clien","CREATE_FROM_CONSULTATIONS","consultationIds","toFixed","step","DocumentTextIcon","InvoiceSuccessModal","handleCloseAll","CONSULTATIONS_TABLE_ID","forwardRef","navigate","useNavigate","setConsultations","setError","isFilterPanelOpen","setIsFilterPanelOpen","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","editingNotesId","setEditingNotesId","editingNotes","setEditingNotes","editingTimeId","setEditingTimeId","editingTimeType","setEditingTimeType","editingTimeValue","setEditingTimeValue","linkTaskModalOpen","setLinkTaskModalOpen","selectedConsultationId","setSelectedConsultationId","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","showCreateInvoiceModal","setShowCreateInvoiceModal","loadConsultations","from","to","params","URLSearchParams","append","useImperativeHandle","refresh","addConsultation","updateConsultation","removeConsultation","activateClientFilter","createAndActivateClientFilter","SAVED_FILTERS","BY_TABLE","heuteFilter","applyFilterConditions","setInitialFilter","clientFilter","newFilter","tableId","refreshSavedFilters","localStorage","getItem","existingFilters","alleFilter","dieseWocheFilter","archivFilterExists","heuteFilterExists","wocheFilterExists","nichtAbgerechnetFilterExists","archivFilter","wocheFilter","nichtAbgerechnetFilter","createStandardFilters","timeoutId","firstCondition","secondCondition","updateExistingFilters","existingClientFilters","currentRecentClientNames","existingFilter","clientFilterName","updateClientFilters","resetFilterConditions","getActiveFilterCount","handleNotesSave","handleNotesCancel","handleTimeEdit","timeType","currentTime","dbTime","inputValue","handleTimeSave","timeString","handleTimeCancel","handleDeleteConsultation","applyFiltersAndSearch","search","_consultation$client$","_consultation$branch","_consultation$branch$","_consultation$notes","branch","cond","_consultation$client2","_consultation$client3","_consultation$branch2","_consultation$branch3","branchName","_consultation$notes2","calculateDurationInMinutes","filterValue","invoiceStatus","isInvoiced","isInMonthlyReport","isConsultationInMonthlyReport","filterValueLower","invoiceInfo","monthlyReportInfo","getConsultationMonthlyReportInfo","columnId","_consultation$client4","_consultation$branch4","filteredConsultations","sort","a","b","totalDuration","timelineMarkers","markers","forEach","currentDate","currentHour","prevDate","label","position","prevHour","generateTimelineMarkers","monthlyReportId","monthlyReport","navigateToMonthlyReports","reportId","navigateToInvoices","navigateToTask","FunnelIcon","canCreateInvoice","every","handleCreateInvoice","FilterPane","columns","onApply","onReset","savedConditions","savedOperators","SavedFilterTags","onSelectFilter","onFilterChange","handleFilterChange","_consultation$client5","_consultation$client6","dayMarker","m","middayMarker","billingStatus","info","getConsultationBillingStatus","_billingStatus$info","_billingStatus$info2","ChartBarIcon","_billingStatus$info3","_billingStatus$info4","reportNumber","stroke","strokeLinecap","strokeLinejoin","strokeWidth","taskLinks","taskLink","handleLinkTask","handleNotesEdit","LinkTaskModal","CreateInvoiceModal","Consultations","consultationListRef","handleConsultationChange","_consultationListRef$","_consultationListRef$2","_consultationListRef$3","_consultationListRef$4","_consultationListRef$5","call","handleConsultationStarted","_consultationListRef$6","_consultationListRef$7","_consultationListRef$8","ConsultationTracker","ConsultationList"],"sourceRoot":""}