"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[645],{1663:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(45),r=a(5043);const l=["title","titleId"];function d(e,t){let{title:a,titleId:d}=e,i=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},i),a?r.createElement("title",{id:d},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0 1 12 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m17.25-3.75h-7.5c-.621 0-1.125.504-1.125 1.125m8.625-1.125c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M12 10.875v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125M13.125 12h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125M20.625 12c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5M12 14.625v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 14.625c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m0 1.5v-1.5m0 0c0-.621.504-1.125 1.125-1.125m0 0h7.5"}))}const i=r.forwardRef(d)},1909:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(45),r=a(5043);const l=["title","titleId"];function d(e,t){let{title:a,titleId:d}=e,i=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},i),a?r.createElement("title",{id:d},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7.5 7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5"}))}const i=r.forwardRef(d)},2302:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(45),r=a(5043);const l=["title","titleId"];function d(e,t){let{title:a,titleId:d}=e,i=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},i),a?r.createElement("title",{id:d},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"}))}const i=r.forwardRef(d)},2704:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(45),r=a(5043);const l=["title","titleId"];function d(e,t){let{title:a,titleId:d}=e,i=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},i),a?r.createElement("title",{id:d},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const i=r.forwardRef(d)},3315:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(45),r=a(5043);const l=["title","titleId"];function d(e,t){let{title:a,titleId:d}=e,i=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},i),a?r.createElement("title",{id:d},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const i=r.forwardRef(d)},4129:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(45),r=a(5043);const l=["title","titleId"];function d(e,t){let{title:a,titleId:d}=e,i=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},i),a?r.createElement("title",{id:d},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const i=r.forwardRef(d)},4832:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(45),r=a(5043);const l=["title","titleId"];function d(e,t){let{title:a,titleId:d}=e,i=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},i),a?r.createElement("title",{id:d},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const i=r.forwardRef(d)},4850:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(45),r=a(5043);const l=["title","titleId"];function d(e,t){let{title:a,titleId:d}=e,i=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},i),a?r.createElement("title",{id:d},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"}))}const i=r.forwardRef(d)},5835:(e,t,a)=>{a.r(t),a.d(t,{default:()=>de});var s=a(5043),r=a(4117),l=a(5590),d=a(1923),i=a(1801),n=a(9837),o=a(9379),c=a(6981);function m(e,t,a){return(0,c.f)(e,-t,a)}var x=a(4399),u=a(887),g=a(1909),h=a(4850),p=a(1663),y=a(8010),b=a(2302),k=a(2811),f=a(4129),v=a(7012),j=a(6238),N=a(6018),w=a(6443),T=a(7591),A=a(1816),C=a(9422),S=a(579);const W=e=>{let{isOpen:t,onClose:a,onConfirm:l,userName:d}=e;const{t:i}=(0,r.Bd)(),o=new Date,c=(0,n.GP)(o,"yyyy-MM-dd"),m=(0,n.GP)(o,"HH:mm:ss"),[x,u]=(0,s.useState)(c),[g,h]=(0,s.useState)(m),[p,y]=(0,s.useState)(!1);return(0,S.jsx)(N.e,{appear:!0,show:t,as:s.Fragment,children:(0,S.jsxs)(w.lG,{as:"div",className:"relative z-10",onClose:a,children:[(0,S.jsx)(N.e.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,S.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,S.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,S.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,S.jsx)(N.e.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,S.jsxs)(w.lG.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-6 text-left align-middle shadow-xl transition-all",children:[(0,S.jsxs)("div",{className:"flex justify-between items-start",children:[(0,S.jsx)(w.lG.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white",children:i("teamWorktime.modal.stopTracking.title")}),(0,S.jsxs)("button",{type:"button",className:"bg-white dark:bg-gray-800 rounded-md text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:a,children:[(0,S.jsx)("span",{className:"sr-only",children:i("common.close")}),(0,S.jsx)(T.A,{className:"h-6 w-6","aria-hidden":"true"})]})]}),(0,S.jsx)("div",{className:"mt-2",children:(0,S.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("teamWorktime.modal.stopTracking.description",{userName:d})})}),(0,S.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("teamWorktime.modal.stopTracking.date")}),(0,S.jsx)("input",{type:"date",id:"date",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",value:x,onChange:e=>u(e.target.value)})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{htmlFor:"time",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("teamWorktime.modal.stopTracking.time")}),(0,S.jsx)("input",{type:"time",id:"time",step:"1",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",value:g,onChange:e=>h(e.target.value)})]})]}),(0,S.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,S.jsx)("button",{type:"button",className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",onClick:a,disabled:p,title:i("common.cancel"),children:(0,S.jsx)(T.A,{className:"h-5 w-5"})}),(0,S.jsx)("button",{type:"button",className:"p-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:async()=>{try{y(!0);const e="".concat(x,"T").concat(g);await l(e)}catch(e){console.error("Fehler beim Stoppen der Zeiterfassung:",e)}finally{y(!1)}},disabled:p,title:i(p?"teamWorktime.modal.stopTracking.stopping":"teamWorktime.modal.stopTracking.stop"),children:p?(0,S.jsx)(A.A,{className:"h-5 w-5 animate-spin"}):(0,S.jsx)(C.A,{className:"h-5 w-5"})})]})]})})})})]})})};var E=a(9248);const D=e=>{let{isOpen:t,onClose:a,onSave:l,userName:d,entries:i,selectedDate:n}=e;const{t:c}=(0,r.Bd)(),[m,x]=(0,s.useState)([]),[u,g]=(0,s.useState)(!1),[h,p]=(0,s.useState)(null);(0,s.useEffect)((()=>{if(i&&i.length>0){const e=i.map((e=>{const t=e.startTime.split("T")[0],a=e.startTime.split("T")[1].substring(0,8),s=e.endTime?e.endTime.split("T")[1].substring(0,8):null;return(0,o.A)((0,o.A)({},e),{},{date:t,startTimeTime:a,endTimeTime:s,isDeleted:!1,isModified:!1})}));x(e)}else x([])}),[i]);const y=e=>{const t=e.filter((e=>!e.isDeleted));for(let a=0;a<t.length;a++){const e=t[a],s=e.startTimeTime,r=e.endTimeTime;if(r&&s>=r)return p("Eintrag ".concat(a+1,": Die Endzeit muss nach der Startzeit liegen.")),!1;for(let l=a+1;l<t.length;l++){const e=t[l],d=e.startTimeTime,i=e.endTimeTime;if(r&&i&&s<i&&r>d||r&&!i&&r>d||i&&!r&&i>s)return p("Es gibt eine \xdcberlappung zwischen Eintrag ".concat(a+1," und Eintrag ").concat(l+1,".")),!1}}return p(null),!0};return(0,S.jsx)(N.e,{appear:!0,show:t,as:s.Fragment,children:(0,S.jsxs)(w.lG,{as:"div",className:"relative z-10",onClose:a,children:[(0,S.jsx)(N.e.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,S.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,S.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,S.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,S.jsx)(N.e.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,S.jsxs)(w.lG.Panel,{className:"w-full max-w-xl transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-6 text-left align-middle shadow-xl transition-all",children:[(0,S.jsxs)("div",{className:"flex justify-between items-start",children:[(0,S.jsx)(w.lG.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white",children:c("teamWorktime.modal.editWorktimes.title")}),(0,S.jsxs)("button",{type:"button",className:"bg-white dark:bg-gray-800 rounded-md text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:a,children:[(0,S.jsx)("span",{className:"sr-only",children:c("common.close")}),(0,S.jsx)(T.A,{className:"h-6 w-6","aria-hidden":"true"})]})]}),(0,S.jsx)("div",{className:"mt-2",children:(0,S.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:c("teamWorktime.modal.editWorktimes.description",{userName:d,date:n.split("-").reverse().join(".")})})}),h&&(0,S.jsx)("div",{className:"mt-2 p-2 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded",children:h}),(0,S.jsx)("div",{className:"mt-4",children:(0,S.jsx)("div",{className:"overflow-hidden border dark:border-gray-700 rounded-lg",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:c("teamWorktime.modal.editWorktimes.columns.number")}),(0,S.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:c("teamWorktime.modal.editWorktimes.columns.startTime")}),(0,S.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:c("teamWorktime.modal.editWorktimes.columns.endTime")}),(0,S.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:c("common.actions")})]})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:0===m.length?(0,S.jsx)("tr",{children:(0,S.jsx)("td",{colSpan:4,className:"px-4 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:c("teamWorktime.modal.editWorktimes.noEntries")})}):m.map(((e,t)=>(0,S.jsxs)("tr",{className:e.isDeleted?"bg-red-50 dark:bg-red-900":"",children:[(0,S.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:t+1}),(0,S.jsx)("td",{className:"px-4 py-2 whitespace-nowrap",children:(0,S.jsx)("input",{type:"time",step:"1",className:"rounded-md border ".concat(e.isDeleted?"border-red-300 bg-red-50 dark:border-red-700 dark:bg-red-900":"border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"," shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"),value:e.startTimeTime.substring(0,5),onChange:e=>((e,t)=>{const a=[...m];a[e].startTimeTime!==t&&(a[e].startTimeTime=t,a[e].isModified=!0,x(a),y(a))})(t,e.target.value+":00"),disabled:e.isDeleted})}),(0,S.jsx)("td",{className:"px-4 py-2 whitespace-nowrap",children:(0,S.jsx)("input",{type:"time",step:"1",className:"rounded-md border ".concat(e.isDeleted?"border-red-300 bg-red-50 dark:border-red-700 dark:bg-red-900":"border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"," shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"),value:e.endTimeTime?e.endTimeTime.substring(0,5):"",onChange:e=>{const a=e.target.value?e.target.value+":00":null;((e,t)=>{const a=[...m];a[e].endTimeTime!==t&&(a[e].endTimeTime=t,a[e].isModified=!0,x(a),y(a))})(t,a)},disabled:e.isDeleted})}),(0,S.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-right text-sm font-medium",children:(0,S.jsx)("button",{type:"button",onClick:()=>(e=>{const t=[...m];t[e].isDeleted=!t[e].isDeleted,t[e].isModified=!0,x(t)})(t),className:"p-1 rounded ".concat(e.isDeleted?"text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300":"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300"),title:e.isDeleted?c("teamWorktime.modal.editWorktimes.restore"):c("teamWorktime.modal.editWorktimes.markForDelete"),children:(0,S.jsx)(E.A,{className:"h-5 w-5"})})})]},e.id)))})]})})}),(0,S.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,S.jsx)("button",{type:"button",className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",onClick:a,disabled:u,title:c("common.cancel"),children:(0,S.jsx)(T.A,{className:"h-5 w-5"})}),(0,S.jsx)("button",{type:"button",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",onClick:async()=>{if(y(m))try{g(!0);const e=m.filter((e=>e.isModified||e.isDeleted)).map((e=>{const t="".concat(e.date,"T").concat(e.startTimeTime),a=e.endTimeTime?"".concat(e.date,"T").concat(e.endTimeTime):null;return(0,o.A)((0,o.A)({},e),{},{startTime:t,endTime:a})}));e.length>0&&await l(e),a()}catch(h){console.error("Fehler beim Speichern der Zeiterfassungen:",h),p(c("teamWorktime.modal.editWorktimes.saveError"))}finally{g(!1)}},disabled:u||Boolean(h),title:c(u?"common.saving":"common.save"),children:u?(0,S.jsx)(A.A,{className:"h-5 w-5 animate-spin"}):(0,S.jsx)(C.A,{className:"h-5 w-5"})})]})]})})})})]})})};var q=a(4426),M=a(7829),I=a(2023),L=a(2760),F=a(1713);var H=a(8897),O=a(957),R=a(637);const _=["name","startTime","duration","pauseTime","branch","actions"],P={name:"asc",startTime:"asc",duration:"asc",pauseTime:"asc",branch:"asc"},B={name:["name"],startTime:["startTime"],duration:["duration"],pauseTime:["pauseTime"],branch:["branch"],actions:[]},V={name:"name",startTime:"startTime",duration:"duration",pauseTime:"pauseTime",branch:"branch"},G="workcenter-table",z=e=>{let{activeUsers:t,allWorktimes:a,loading:l,selectedDate:N,onDateChange:w,onStopWorktime:T,onRefresh:A,showTodos:C=!1,showRequests:E=!1}=e;const{t:z}=(0,r.Bd)(),Z=(0,s.useMemo)((()=>[{id:"name",label:z("teamWorktime.columns.name")},{id:"startTime",label:z("teamWorktime.columns.startTime")},{id:"duration",label:z("teamWorktime.columns.duration")},{id:"pauseTime",label:z("teamWorktime.columns.pauseTime")},{id:"branch",label:z("teamWorktime.columns.branch")},{id:"actions",label:z("teamWorktime.columns.actions")}]),[z]),[K,Y]=(0,s.useState)(!1),[U,Q]=(0,s.useState)(!1),[J,X]=(0,s.useState)(null),[$,ee]=(0,s.useState)(""),[te,ae]=(0,s.useState)({key:"startTime",direction:"asc"}),[se,re]=(0,s.useState)(!1),[le,de]=(0,s.useState)(null),[ie,ne]=(0,s.useState)(!1),[oe,ce]=(0,s.useState)(10),[me,xe]=(0,s.useState)([]),[ue,ge]=(0,s.useState)([]),[he,pe]=(0,s.useState)(z("teamWorktime.filters.active")),[ye,be]=(0,s.useState)(null),[ke,fe]=(0,s.useState)({}),[ve,je]=(0,s.useState)({}),[Ne,we]=(0,s.useState)(new Set),[Te,Ae]=(0,s.useState)(!1),[Ce,Se]=(0,s.useState)(!1),{hasPermission:We}=(0,L.S)();(0,s.useEffect)((()=>{(async()=>{if(C&&N)try{Ae(!0);const e=await d.A.get(i.Sn.TEAM_WORKTIME.ANALYTICS.TODOS_BY_USER,{params:{date:N}}),t={};e.data.forEach((e=>{t[e.userId]=e.todos})),fe(t)}catch(e){console.error("Fehler beim Laden der To-Dos:",e)}finally{Ae(!1)}})()}),[C,N]),(0,s.useEffect)((()=>{(async()=>{if(E&&N)try{Se(!0);const e=await d.A.get(i.Sn.TEAM_WORKTIME.ANALYTICS.REQUESTS_BY_USER,{params:{date:N}}),t={};e.data.forEach((e=>{t[e.userId]=e.requests})),je(t)}catch(e){console.error("Fehler beim Laden der Requests:",e)}finally{Se(!1)}})()}),[E,N]);const Ee=e=>{we((t=>{const a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a}))},{settings:De,updateColumnOrder:qe,updateHiddenColumns:Me,isColumnVisible:Ie,updateViewMode:Le}=(0,I.F)("team_worktime_active",{defaultColumnOrder:_,defaultHiddenColumns:[],defaultViewMode:"cards"}),Fe=De.columnOrder,He=De.hiddenColumns,Oe=De.viewMode||"cards",[Re,_e]=(0,s.useState)((()=>P)),Pe=(0,s.useMemo)((()=>(e=>{const t=[];return e.forEach((e=>{const a=B[e];a&&a.length>0&&t.push(...a)})),t})(De.columnOrder||_)),[De.columnOrder]),Be=(0,s.useMemo)((()=>(e=>{const t=new Set;return e.forEach((e=>{(B[e]||[]).forEach((e=>t.add(e)))})),t})(De.hiddenColumns||[])),[De.hiddenColumns]),Ve=(0,s.useMemo)((()=>new Set(Pe.filter((e=>!Be.has(e))))),[Pe,Be]);(0,s.useEffect)((()=>{document.querySelectorAll(".dashboard-workcenter-wrapper").forEach((e=>{"cards"===Oe?e.classList.add("cards-mode"):e.classList.remove("cards-mode")}))}),[Oe]);const Ge=e=>{X(e),Y(!0)},ze=()=>{Y(!1),X(null)},Ze=e=>{X(e),Q(!0)},Ke=()=>{Q(!1),X(null)},Ye=e=>{de(e)},Ue=(0,s.useCallback)((e=>{e.preventDefault()}),[]),Qe=(0,s.useCallback)(((e,t)=>{if(e.preventDefault(),!le||le===t)return;const a=[...Fe],s=a.indexOf(le),r=a.indexOf(t);a.splice(s,1),a.splice(r,0,le),qe(a)}),[le,Fe,qe]),Je=()=>{de(null)},Xe=()=>me.length,$e=(0,s.useMemo)((()=>{const e=[...a];t.filter((e=>e.startTime.split("T")[0]===N)).forEach((t=>{e.find((e=>e.id===t.id))||e.push(t)}));const s=e.reduce(((e,t)=>{const a=t.user.id;e[a]||(e[a]={user:t.user,branch:t.branch,entries:[],startTime:(0,F.IF)(t.startTime),endTime:t.endTime?(0,F.IF)(t.endTime):null,totalDuration:0,activeEntries:[],hasActiveWorktime:!1});const s=e[a];s.entries.push(t);const r=(0,F.IF)(t.startTime);if(r<s.startTime&&(s.startTime=r),t.endTime){const e=(0,F.IF)(t.endTime);(!s.endTime||e>s.endTime)&&(s.endTime=e)}else s.hasActiveWorktime=!0,s.activeEntries.push(t);if(t.endTime){const e=(0,F.IF)(t.endTime).getTime()-(0,F.IF)(t.startTime).getTime();s.totalDuration+=e}return e}),{});let r=Object.values(s).filter((e=>{const t="".concat(e.user.firstName," ").concat(e.user.lastName).toLowerCase(),a=e.user.username.toLowerCase(),s=e.branch.name.toLowerCase(),r=$.toLowerCase();if($&&!(t.includes(r)||a.includes(r)||s.includes(r)))return!1;if(me.length>0){let a=me.length>0;for(let r=0;r<me.length;r++){const l=me[r];let d=!1;switch(l.column){case"name":"equals"===l.operator?d=t===(l.value||"").toLowerCase():"contains"===l.operator?d=t.includes((l.value||"").toLowerCase()):"startsWith"===l.operator&&(d=t.startsWith((l.value||"").toLowerCase()));break;case"branch":"equals"===l.operator?d=s===(l.value||"").toLowerCase():"contains"===l.operator?d=s.includes((l.value||"").toLowerCase()):"startsWith"===l.operator&&(d=s.startsWith((l.value||"").toLowerCase()));break;case"hasActiveWorktime":if("equals"===l.operator){const t="true"===l.value;d=e.hasActiveWorktime===t}break;case"duration":if("greaterThan"===l.operator){const t=60*parseInt(l.value||"0")*60*1e3;d=e.totalDuration>t}else if("lessThan"===l.operator){const t=60*parseInt(l.value||"0")*60*1e3;d=e.totalDuration<t}else if("equals"===l.operator){const t=60*parseInt(l.value||"0")*60*1e3,a=18e5;d=Math.abs(e.totalDuration-t)<=a}}if(0===r)a=d;else{a="AND"===ue[r-1]?a&&d:a||d}}if(!a)return!1}return!0}));if("cards"===Oe){const e=Pe.filter((e=>Ve.has(e)));r.sort(((t,a)=>{for(const s of e){const e=Re[s]||"asc";let r,l;switch(s){case"name":r="".concat(t.user.firstName," ").concat(t.user.lastName).toLowerCase(),l="".concat(a.user.firstName," ").concat(a.user.lastName).toLowerCase();break;case"startTime":r=t.startTime.getTime(),l=a.startTime.getTime();break;case"duration":r=t.totalDuration,l=a.totalDuration;break;case"pauseTime":r=t.endTime?t.endTime.getTime()-t.startTime.getTime()-t.totalDuration:0,l=a.endTime?a.endTime.getTime()-a.startTime.getTime()-a.totalDuration:0;break;case"branch":r=t.branch.name.toLowerCase(),l=a.branch.name.toLowerCase();break;default:continue}let d=0;if(d="number"===typeof r&&"number"===typeof l?r-l:String(r).localeCompare(String(l)),"desc"===e&&(d=-d),0!==d)return d}return 0}))}else te.key&&r.sort(((e,t)=>{let a,s;return"name"===te.key?(a="".concat(e.user.firstName," ").concat(e.user.lastName),s="".concat(t.user.firstName," ").concat(t.user.lastName)):"startTime"===te.key?(a=e.startTime.getTime(),s=t.startTime.getTime()):"duration"===te.key?(a=e.totalDuration,s=t.totalDuration):"branch"===te.key?(a=e.branch.name,s=t.branch.name):(a=e[te.key],s=t[te.key]),a<s?"asc"===te.direction?-1:1:a>s?"asc"===te.direction?1:-1:0}));return r}),[a,t,$,te,N,me,ue,Oe,Pe,Ve,Re]),et=(e,t)=>{const a=(null===te||void 0===te?void 0:te.key)===e;return(0,S.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer group relative",onClick:()=>{return t=e,void ae((e=>({key:t,direction:e.key===t&&"asc"===e.direction?"desc":"asc"})));var t},draggable:!0,onDragStart:()=>Ye(e),onDragOver:Ue,onDrop:t=>Qe(t,e),onDragEnd:Je,children:(0,S.jsxs)("div",{className:"flex items-center ".concat(le===e?"opacity-50":""),children:[(0,S.jsx)(g.A,{className:"h-3 w-3 mr-1 text-gray-400 dark:text-gray-500"}),t," ",a&&("asc"===te.direction?"\u2191":"\u2193")]})},e)};s.useEffect((()=>{(async()=>{try{const e=localStorage.getItem("token");if(!e)return void console.error("Nicht authentifiziert");const t=(await d.A.get("".concat(i.Sn.SAVED_FILTERS.BY_TABLE(G)),{headers:{Authorization:"Bearer ".concat(e)}})).data||[],a=t.some((e=>"Aktive"===e.name||e.name===z("teamWorktime.filters.active")||"Active"===e.name||"Activo"===e.name)),s=t.some((e=>"Alle"===e.name||e.name===z("teamWorktime.filters.all")||"All"===e.name||"Todos"===e.name));if(!a){const t={tableId:G,name:z("teamWorktime.filters.active"),conditions:[{column:"hasActiveWorktime",operator:"equals",value:"true"}],operators:[]};await d.A.post("".concat(i.Sn.SAVED_FILTERS.BASE),t,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),console.log("Aktive-Filter f\xfcr Workcenter erstellt")}if(!s){const t={tableId:G,name:z("teamWorktime.filters.all"),conditions:[],operators:[]};await d.A.post("".concat(i.Sn.SAVED_FILTERS.BASE),t,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),console.log("Alle-Filter f\xfcr Workcenter erstellt")}}catch(e){console.error("Fehler beim Erstellen der Standard-Filter:",e)}})()}),[z]),s.useEffect((()=>{(async()=>{try{const e=await d.A.get(i.Sn.SAVED_FILTERS.BY_TABLE(G)),t=e.data.find((e=>e.name===z("teamWorktime.filters.active")||"Aktive"===e.name||"Active"===e.name||"Activo"===e.name));t&&(pe(z("teamWorktime.filters.active")),be(t.id),tt(t.conditions,t.operators))}catch(e){console.error("Fehler beim Setzen des initialen Filters:",e)}})()}),[z]);const tt=(e,t)=>{xe(e),ge(t)},at=()=>{xe([]),ge([]),pe(""),be(null)},st=(0,s.useMemo)((()=>{const e=new Date;e.setHours(0,0,0,0);const[t,a,s]=N.split("-").map(Number),r=new Date(t,a-1,s);return r.setHours(0,0,0,0),r.getTime()<e.getTime()}),[N]);return(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6",children:[(0,S.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,S.jsx)("button",{type:"button",onClick:()=>{const[e,t,a]=N.split("-").map(Number),s=m(new Date(e,t-1,a),1);w((0,n.GP)(s,"yyyy-MM-dd"))},className:"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",title:z("common.previousDay"),children:(0,S.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,S.jsx)("div",{className:"relative w-[180px]",children:(0,S.jsx)("input",{type:"date",id:"date-select",className:"block w-full pl-3 pr-8 py-2 text-base border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:N,onChange:e=>w(e.target.value)})}),st&&(0,S.jsx)("button",{type:"button",onClick:()=>{const[e,t,a]=N.split("-").map(Number),s=new Date(e,t-1,a),r=(0,c.f)(s,1);w((0,n.GP)(r,"yyyy-MM-dd"))},className:"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",title:z("common.nextDay"),children:(0,S.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)("input",{type:"text",className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",placeholder:z("common.searchPlaceholder"),value:$,onChange:e=>ee(e.target.value)}),(0,S.jsx)("button",{type:"button",className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ml-1 ".concat("cards"===Oe?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""),onClick:()=>Le("table"===Oe?"cards":"table"),title:z("table"===Oe?"common.viewAsCards":"common.viewAsTable"),children:"table"===Oe?(0,S.jsx)(h.A,{className:"h-5 w-5"}):(0,S.jsx)(p.A,{className:"h-5 w-5"})}),(0,S.jsxs)("button",{type:"button",className:"p-2 rounded-md ".concat(Xe()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"," ml-1 relative"),onClick:()=>re(!se),title:z("common.showFilter"),children:[(0,S.jsx)(y.A,{className:"h-5 w-5"}),Xe()>0&&(0,S.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10",style:{position:"absolute",top:"-0.25rem",right:"-0.25rem"},children:Xe()})]}),(0,S.jsx)("div",{className:"ml-1",children:(0,S.jsx)(H.A,{columns:"cards"===Oe?[{id:"name",label:z("teamWorktime.columns.name")},{id:"startTime",label:z("teamWorktime.columns.startTime")},{id:"duration",label:z("teamWorktime.columns.duration")},{id:"pauseTime",label:z("teamWorktime.columns.pauseTime")},{id:"branch",label:z("teamWorktime.columns.branch")}]:Z,visibleColumns:"cards"===Oe?Array.from(Ve):Fe.filter((e=>!He.includes(e))),columnOrder:"cards"===Oe?Pe:Fe,onToggleColumnVisibility:e=>{if("cards"===Oe){const t=V[e];if(t){const e=He.includes(t)?He.filter((e=>e!==t)):[...He,t];Me(e)}}else{const t=He.includes(e)?He.filter((t=>t!==e)):[...He,e];Me(t)}},onMoveColumn:(e,t)=>{if("cards"===Oe){const a=[...Pe],s=a[e];a.splice(e,1),a.splice(t,0,s);const r=[],l=new Set;a.forEach((e=>{const t=V[e];t&&!l.has(t)&&(l.add(t),r.push(t))})),Z.forEach((e=>{r.includes(e.id)||"actions"===e.id||r.push(e.id)})),qe(r)}else{const a=[...Fe],s=a[e];a.splice(e,1),a.splice(t,0,s),qe(a)}},sortDirections:"cards"===Oe?Re:void 0,onSortDirectionChange:"cards"===Oe?(e,t)=>{_e((a=>(0,o.A)((0,o.A)({},a),{},{[e]:t})))}:void 0,showSortDirection:"cards"===Oe,buttonTitle:z("cards"===Oe?"teamWorktime.sortAndDisplay":"teamWorktime.configureColumns"),modalTitle:z("cards"===Oe?"teamWorktime.sortAndDisplay":"teamWorktime.configureColumns"),onClose:()=>{}})})]})]}),se&&(0,S.jsx)("div",{className:"cards"===Oe?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,S.jsx)(q.A,{columns:[{id:"name",label:z("teamWorktime.columns.name")},{id:"branch",label:z("teamWorktime.columns.branch")},{id:"hasActiveWorktime",label:z("worktime.active")},{id:"duration",label:z("teamWorktime.columns.duration")}],onApply:tt,onReset:at,savedConditions:me,savedOperators:ue,tableId:G})}),(0,S.jsx)("div",{className:"cards"===Oe?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,S.jsx)(M.A,{tableId:G,onSelectFilter:tt,onReset:at,activeFilterName:he,selectedFilterId:ye,onFilterChange:(e,t,a,s)=>{pe(e),be(t),tt(a,s)},defaultFilterName:z("teamWorktime.filters.active")})}),"table"===Oe?(0,S.jsx)("div",{className:"dashboard-workcenter-wrapper border-0 rounded-lg overflow-hidden -mx-3 sm:-mx-4 md:-mx-6",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,S.jsx)("tr",{children:Fe.filter((e=>!He.includes(e))).map((e=>{const t=Z.find((t=>t.id===e));return t?"actions"===e?(0,S.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",draggable:!0,onDragStart:()=>Ye(e),onDragOver:Ue,onDrop:t=>Qe(t,e),onDragEnd:Je,children:t.label},e):et(e,t.label):null}))})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:0===$e.length?(0,S.jsx)("tr",{children:(0,S.jsx)("td",{colSpan:Fe.filter((e=>!He.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"Keine Zeiterfassungen gefunden"})}):$e.slice(0,oe).map((e=>{const t=e.endTime?e.endTime.getTime()-e.startTime.getTime()-e.totalDuration:0,a=ke[e.user.id]||null,r=ve[e.user.id]||null,l=Ne.has(e.user.id),d=C&&a&&a.total>0||E&&r&&r.total>0;return(0,S.jsxs)(s.Fragment,{children:[(0,S.jsx)("tr",{children:Fe.filter((e=>!He.includes(e))).map((a=>"name"===a?(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("div",{className:"flex items-center",children:(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[e.user.firstName," ",e.user.lastName]}),(0,S.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.user.username})]})})},a):"startTime"===a?(0,S.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,S.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:(0,n.GP)(e.startTime,"dd.MM.yyyy")}),(0,S.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:(0,n.GP)(e.startTime,"HH:mm:ss")})]},a):"duration"===a?(0,S.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:(0,x.m)(new Date(Date.now()-e.totalDuration),{locale:u.de,addSuffix:!1})})},a):"pauseTime"===a?(0,S.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:t>0?(0,x.m)(new Date(Date.now()-t),{locale:u.de,addSuffix:!1}):"-"})},a):"branch"===a?(0,S.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name},a):"actions"===a?(0,S.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,S.jsxs)("div",{className:"flex flex-row space-x-2 justify-end items-center",children:[e.hasActiveWorktime&&(0,S.jsx)("button",{onClick:()=>Ge(e),className:"p-1 bg-red-600 text-white rounded hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600",title:z("teamWorktime.actions.stopTracking"),children:(0,S.jsx)(b.A,{className:"h-5 w-5 text-white fill-white"})}),We("team_worktime_control","both","page")&&We("team_worktime","both","table")&&(0,S.jsx)("button",{onClick:()=>Ze(e),className:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 edit-button",title:z("teamWorktime.actions.editWorktimes"),children:(0,S.jsx)(k.A,{className:"h-5 w-5"})})]})},a):null))}),(C||E)&&d&&(0,S.jsx)("tr",{className:"bg-gray-50 dark:bg-gray-800/50",children:(0,S.jsx)("td",{colSpan:Fe.filter((e=>!He.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-3",children:(0,S.jsxs)("div",{className:"ml-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4",children:[C&&a&&a.total>0&&(0,S.jsxs)("div",{className:"mb-3",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,S.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["To-Dos (",N,"): ",a.completed," erledigt | ",a.open," offen | ",a.inProgress," in Bearbeitung"]}),(0,S.jsx)("button",{onClick:()=>Ee(e.user.id),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:l?"Weniger anzeigen \u25b2":"Details anzeigen \u25bc"})]}),l&&a.details&&a.details.length>0&&(0,S.jsx)("div",{className:"mt-2 space-y-1",children:a.details.map((e=>(0,S.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,S.jsx)("span",{className:"done"===e.status?"text-green-600 dark:text-green-400":"text-gray-400",children:"done"===e.status?"\u2713":"\u25cb"}),(0,S.jsx)("span",{className:"font-medium",children:e.title}),(0,S.jsxs)("span",{className:"text-gray-400",children:["(",e.status,")"]}),(0,S.jsxs)("span",{className:"text-gray-400",children:["- ",(0,n.GP)(new Date(e.updatedAt),"HH:mm")]})]},e.id)))})]}),E&&r&&r.total>0&&(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,S.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Requests (",N,"): ",r.approved," genehmigt | ",r.pending," offen"]}),!C&&(0,S.jsx)("button",{onClick:()=>Ee(e.user.id),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:l?"Weniger anzeigen \u25b2":"Details anzeigen \u25bc"})]}),l&&r.details&&r.details.length>0&&(0,S.jsx)("div",{className:"mt-2 space-y-1",children:r.details.map((e=>(0,S.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,S.jsx)("span",{className:"approved"===e.status?"text-green-600 dark:text-green-400":"text-gray-400",children:"approved"===e.status?"\u2713":"\u25cb"}),(0,S.jsx)("span",{className:"font-medium",children:e.title}),(0,S.jsxs)("span",{className:"text-gray-400",children:["(",e.status,")"]}),(0,S.jsxs)("span",{className:"text-gray-400",children:["- ",(0,n.GP)(new Date(e.createdAt),"HH:mm")]})]},e.id)))})]})]})})})]},e.user.id)}))})]})}):(0,S.jsx)("div",{className:"dashboard-workcenter-wrapper -mx-3 sm:-mx-4 md:-mx-6",children:0===$e.length?(0,S.jsx)("div",{className:"text-center py-8 text-sm text-gray-500 dark:text-gray-400",children:"Keine Zeiterfassungen gefunden"}):(0,S.jsx)(R.A,{gap:"md",children:$e.slice(0,oe).map((e=>{const t=e.endTime?e.endTime.getTime()-e.startTime.getTime()-e.totalDuration:0,a=ke[e.user.id]||null,s=ve[e.user.id]||null,r=Ne.has(e.user.id),l=C&&a&&a.total>0||E&&s&&s.total>0,d=[],i=[],o=[];Ve.has("name")&&i.push({label:"Name",value:"".concat(e.user.firstName," ").concat(e.user.lastName," (").concat(e.user.username,")"),icon:(0,S.jsx)(f.A,{className:"h-4 w-4"})}),Ve.has("startTime")&&i.push({label:"Startzeit",value:"".concat((0,n.GP)(e.startTime,"dd.MM.yyyy")," ").concat((0,n.GP)(e.startTime,"HH:mm:ss")),icon:(0,S.jsx)(v.A,{className:"h-4 w-4"})}),Ve.has("duration")&&o.push({label:"Arbeitszeit",value:(0,x.m)(new Date(Date.now()-e.totalDuration),{locale:u.de,addSuffix:!1}),icon:(0,S.jsx)(v.A,{className:"h-4 w-4"})}),Ve.has("pauseTime")&&o.push({label:"Pausen",value:t>0?(0,x.m)(new Date(Date.now()-t),{locale:u.de,addSuffix:!1}):"-",icon:(0,S.jsx)(v.A,{className:"h-4 w-4"})}),Ve.has("branch")&&d.push({label:"Niederlassung",value:e.branch.name,icon:(0,S.jsx)(j.A,{className:"h-4 w-4"})});const c=(0,S.jsxs)("div",{className:"flex flex-row space-x-2 justify-end items-center",children:[e.hasActiveWorktime&&(0,S.jsx)("button",{onClick:()=>Ge(e),className:"p-1 bg-red-600 text-white rounded hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600",title:z("teamWorktime.actions.stopTracking"),children:(0,S.jsx)(b.A,{className:"h-5 w-5 text-white fill-white"})}),We("team_worktime_control","both","page")&&We("team_worktime","both","table")&&(0,S.jsx)("button",{onClick:()=>Ze(e),className:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300",title:z("teamWorktime.actions.editWorktimes"),children:(0,S.jsx)(k.A,{className:"h-5 w-5"})})]}),m=l?(0,S.jsxs)("div",{children:[C&&a&&a.total>0&&(0,S.jsxs)("div",{className:"mb-3",children:[(0,S.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["To-Dos (",N,"): ",a.completed," erledigt | ",a.open," offen | ",a.inProgress," in Bearbeitung"]}),a.details&&a.details.length>0&&(0,S.jsx)("div",{className:"mt-2 space-y-1",children:a.details.map((e=>(0,S.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,S.jsx)("span",{className:"done"===e.status?"text-green-600 dark:text-green-400":"text-gray-400",children:"done"===e.status?"\u2713":"\u25cb"}),(0,S.jsx)("span",{className:"font-medium",children:e.title}),(0,S.jsxs)("span",{className:"text-gray-400",children:["(",e.status,")"]}),(0,S.jsxs)("span",{className:"text-gray-400",children:["- ",(0,n.GP)(new Date(e.updatedAt),"HH:mm")]})]},e.id)))})]}),E&&s&&s.total>0&&(0,S.jsxs)("div",{children:[(0,S.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Requests (",N,"): ",s.approved," genehmigt | ",s.pending," offen"]}),s.details&&s.details.length>0&&(0,S.jsx)("div",{className:"mt-2 space-y-1",children:s.details.map((e=>(0,S.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,S.jsx)("span",{className:"approved"===e.status?"text-green-600 dark:text-green-400":"text-gray-400",children:"approved"===e.status?"\u2713":"\u25cb"}),(0,S.jsx)("span",{className:"font-medium",children:e.title}),(0,S.jsxs)("span",{className:"text-gray-400",children:["(",e.status,")"]}),(0,S.jsxs)("span",{className:"text-gray-400",children:["- ",(0,n.GP)(new Date(e.createdAt),"HH:mm")]})]},e.id)))})]})]}):null;return(0,S.jsxs)(O.A,{title:"".concat(e.user.firstName," ").concat(e.user.lastName),metadata:d,actions:c,expandable:m?{isExpanded:r,content:m,onToggle:()=>Ee(e.user.id)}:void 0,children:[i.length>0&&(0,S.jsx)("div",{className:"flex flex-wrap items-center gap-3 sm:gap-4 mb-3 sm:mb-4",children:i.map(((e,t)=>(0,S.jsxs)("div",{className:"flex items-center gap-1 sm:gap-1.5 text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl 2xl:text-2xl text-gray-600 dark:text-gray-400",children:[e.icon&&(0,S.jsx)("span",{className:"flex-shrink-0",children:e.icon}),(0,S.jsxs)("span",{className:"font-medium mr-1 whitespace-nowrap",children:[e.label,":"]}),(0,S.jsx)("span",{className:e.className||"text-gray-900 dark:text-white",children:(e.value,e.value)})]},t)))}),o.length>0&&(0,S.jsx)("div",{className:"flex flex-col gap-2 mb-3 sm:mb-4",children:o.map(((e,t)=>(0,S.jsxs)("div",{className:"flex items-center gap-1 sm:gap-1.5 text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl 2xl:text-2xl text-gray-600 dark:text-gray-400",children:[e.icon&&(0,S.jsx)("span",{className:"flex-shrink-0",children:e.icon}),(0,S.jsxs)("span",{className:"font-medium mr-1 whitespace-nowrap",children:[e.label,":"]}),(0,S.jsx)("span",{className:e.className||"text-gray-900 dark:text-white",children:(e.value,e.value)})]},t)))})]},e.user.id)}))})}),$e.length>oe&&(0,S.jsx)("div",{className:"mt-4 flex justify-center",children:(0,S.jsxs)("button",{className:"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-blue-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600",onClick:()=>ce((e=>e+10)),children:["Mehr anzeigen (",$e.length-oe," verbleibend)"]})}),K&&J&&(0,S.jsx)(W,{isOpen:K,onClose:ze,onConfirm:async e=>{if(!J)return;const t=J.activeEntries.length>0?J.activeEntries.reduce(((e,t)=>{const a=(0,F.IF)(e.startTime);return(0,F.IF)(t.startTime)>a?t:e}),J.activeEntries[0]):null;t?await T(t.user.id,e):await T(J.user.id,e),ze()},userName:"".concat(J.user.firstName," ").concat(J.user.lastName)}),U&&J&&(0,S.jsx)(D,{isOpen:U,onClose:Ke,onSave:async e=>{try{await(async e=>{try{const t=e.filter((e=>!e.isDeleted)),a=e.filter((e=>e.isDeleted)).map((e=>e.id)),s=t.map((e=>d.A.put("/worktime/".concat(e.id),{startTime:e.startTime,endTime:e.endTime}))),r=a.map((e=>d.A.delete("/worktime/".concat(e))));return await Promise.all([...s,...r]),{success:!0}}catch(t){throw console.error("Fehler beim Aktualisieren der Zeiterfassungen:",t),t}})(e),A(),alert(z("teamWorktime.messages.saveSuccess")),Ke()}catch(t){console.error("Fehler beim Aktualisieren der Zeiterfassungen:",t);let e=z("teamWorktime.messages.unknownError");t.response?401===t.response.status?e=z("teamWorktime.messages.unauthorized"):403===t.response.status?e=z("teamWorktime.messages.forbidden"):404===t.response.status?e=z("teamWorktime.messages.notFound"):500===t.response.status?e=z("teamWorktime.messages.serverError"):t.response.data&&t.response.data.message&&(e=t.response.data.message):e=t.request?z("teamWorktime.messages.noResponse"):t.message||z("teamWorktime.messages.error"),alert(z("teamWorktime.messages.saveError")+" "+e)}},userName:"".concat(J.user.firstName," ").concat(J.user.lastName),entries:J.entries,selectedDate:N})]})};var Z=a(1369),K=a(45);const Y=["title","titleId"];function U(e,t){let{title:a,titleId:r}=e,l=(0,K.A)(e,Y);return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),a?s.createElement("title",{id:r},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const Q=s.forwardRef(U);var J=a(2517),X=a(3315);const $="todo-analytics-table",ee=["time","title","status","responsible","qualityControl","branch"],te=e=>{let{selectedDate:t}=e;const{t:a}=(0,r.Bd)(),[l,o]=(0,s.useState)([]),[c,m]=(0,s.useState)(!1),[x,u]=(0,s.useState)(null),[g,b]=(0,s.useState)(""),[k,N]=(0,s.useState)([]),[w,T]=(0,s.useState)([]),[C,W]=(0,s.useState)(""),[E,D]=(0,s.useState)(null),[L,F]=(0,s.useState)(!1),{settings:H,isLoading:_,updateColumnOrder:P,updateHiddenColumns:B,toggleColumnVisibility:V,isColumnVisible:G,updateViewMode:z}=(0,I.F)($,{defaultColumnOrder:ee,defaultViewMode:"table"}),K=(null===H||void 0===H?void 0:H.columnOrder)||ee,Y=(null===H||void 0===H?void 0:H.hiddenColumns)||[],U=K.filter((e=>!Y.includes(e))),te=(null===H||void 0===H?void 0:H.viewMode)||"table",[ae,se]=(0,s.useState)(te);(0,s.useEffect)((()=>{null!==H&&void 0!==H&&H.viewMode&&H.viewMode!==ae&&se(H.viewMode)}),[null===H||void 0===H?void 0:H.viewMode]);const[re,le]=(0,s.useState)(new Set),de=e=>{le((t=>{const a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a}))},[ie,ne]=(0,s.useState)(null),[oe,ce]=(0,s.useState)(!1),[me,xe]=(0,s.useState)(!1),[ue,ge]=(0,s.useState)(null),[he,pe]=(0,s.useState)(!1),[ye,be]=(0,s.useState)(!1),[ke,fe]=(0,s.useState)(new Set),ve=(0,s.useMemo)((()=>[{id:"time",label:a("analytics.todo.columns.time")},{id:"title",label:a("analytics.todo.columns.title")},{id:"status",label:a("analytics.todo.columns.status")},{id:"responsible",label:a("analytics.todo.columns.responsible")},{id:"qualityControl",label:a("analytics.todo.columns.qualityControl")},{id:"branch",label:a("analytics.todo.columns.branch")}]),[a]);(0,s.useEffect)((()=>{t&&(async()=>{try{m(!0),u(null);const e={date:t};k.forEach((t=>{"branch"===t.column&&t.value&&(e.branchId=t.value),"responsible"===t.column&&t.value&&(e.userId=t.value),"status"===t.column&&t.value}));const a=await d.A.get(i.Sn.TEAM_WORKTIME.ANALYTICS.TODOS_CHRONOLOGICAL,{params:e});o(a.data||[])}catch(x){console.error("Fehler beim Laden der To-Dos:",x),u(a("analytics.todo.loadError"))}finally{m(!1)}})()}),[t,k]),(0,s.useEffect)((()=>{(async()=>{if(t&&me)try{ce(!0);const e=await d.A.get(i.Sn.TEAM_WORKTIME.ANALYTICS.TODOS_FREQUENCY,{params:{date:t}});ne(e.data)}catch(x){console.error("Fehler beim Laden der H\xe4ufigkeitsanalyse:",x)}finally{ce(!1)}})()}),[t,me]),(0,s.useEffect)((()=>{(async()=>{if(t&&ye)try{pe(!0);const e=await d.A.get(i.Sn.TEAM_WORKTIME.ANALYTICS.TODOS_SHIFTS,{params:{date:t}});ge(e.data)}catch(x){console.error("Fehler beim Laden der Schicht-Analyse:",x)}finally{pe(!1)}})()}),[t,ye]);const je=(0,s.useCallback)(((e,t)=>{N(e),T(t),F(!1)}),[]),Ne=(0,s.useCallback)((()=>{N([]),T([]),W(""),D(null)}),[]),we=(0,s.useCallback)(((e,t,a,s)=>{W(e),D(t),je(a,s)}),[je]),Te=(0,s.useCallback)((()=>k.filter((e=>""!==e.column&&null!==e.value)).length),[k]),Ae=e=>{switch(e){case"done":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"in_progress":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400";case"quality_control":return"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400";case"open":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"improval":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},Ce=e=>({done:"Erledigt",in_progress:"In Bearbeitung",quality_control:"Qualit\xe4tskontrolle",open:"Offen",improval:"Nachbesserung"}[e]||e),Se=(0,s.useMemo)((()=>{let e=[...l];if(g){const t=g.toLowerCase();e=e.filter((e=>e.title.toLowerCase().includes(t)||e.branch.name.toLowerCase().includes(t)||e.responsible&&"".concat(e.responsible.firstName," ").concat(e.responsible.lastName).toLowerCase().includes(t)))}return k.forEach(((t,a)=>{if(""===t.column||null===t.value)return;const s=t.operator||"equals",r=t.value;e=e.filter((e=>{switch(t.column){case"status":return"equals"!==s||e.status===r;case"title":return"contains"!==s||e.title.toLowerCase().includes(String(r).toLowerCase());default:return!0}}))})),e}),[l,g,k]),We=(0,s.useMemo)((()=>({total:Se.length,done:Se.filter((e=>"done"===e.status)).length,inProgress:Se.filter((e=>"in_progress"===e.status)).length,open:Se.filter((e=>"open"===e.status)).length,qualityControl:Se.filter((e=>"quality_control"===e.status)).length,improval:Se.filter((e=>"improval"===e.status)).length})),[Se]);return x?(0,S.jsx)("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded",children:x}):(0,S.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 todo-analytics-wrapper",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6",children:[(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)(Z.A,{className:"h-6 w-6 mr-2 dark:text-white"}),(0,S.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:a("analytics.todo.title")})]}),(0,S.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,S.jsx)("input",{type:"text",placeholder:a("common.searchPlaceholder"),className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:g,onChange:e=>b(e.target.value)}),(0,S.jsx)("button",{className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("cards"===ae?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""),onClick:()=>{const e="table"===ae?"cards":"table";se(e),z&&z(e)},title:a("table"===ae?"common.viewAsCards":"common.viewAsTable"),children:"table"===ae?(0,S.jsx)(h.A,{className:"h-5 w-5"}):(0,S.jsx)(p.A,{className:"h-5 w-5"})}),(0,S.jsxs)("button",{className:"p-2 rounded-md ".concat(Te()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"," ml-1 relative"),onClick:()=>F(!L),title:a("common.filter"),style:{position:"relative"},children:[(0,S.jsx)(y.A,{className:"h-5 w-5"}),Te()>0&&(0,S.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10",children:Te()})]})]})]}),L&&(0,S.jsx)("div",{className:"cards"===ae?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,S.jsx)(q.A,{columns:ve,onApply:je,onReset:Ne,savedConditions:k,savedOperators:w,tableId:$})}),(0,S.jsx)("div",{className:"cards"===ae?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,S.jsx)(M.A,{tableId:$,onSelectFilter:je,onReset:Ne,activeFilterName:C,selectedFilterId:E,onFilterChange:we,defaultFilterName:a("teamWorktime.filters.all")})}),(0,S.jsxs)("div",{className:"mb-4 flex items-center gap-2",children:[(0,S.jsxs)("button",{onClick:()=>xe(!me),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,S.jsx)(A.A,{className:"h-4 w-4 transition-transform ".concat(me?"rotate-180":"")}),a("analytics.todo.frequencyAnalysis")," ",a(me?"common.collapse":"common.expand")]}),(0,S.jsxs)("button",{onClick:()=>be(!ye),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,S.jsx)(v.A,{className:"h-4 w-4 transition-transform ".concat(ye?"rotate-180":"")}),a("analytics.todo.shiftAnalysis")," ",a(ye?"common.collapse":"common.expand")]})]}),me&&(0,S.jsxs)("div",{className:"mb-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,S.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,S.jsx)(A.A,{className:"h-5 w-5"}),a("analytics.todo.frequencyAnalysis")]}),oe?(0,S.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,S.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:a("analytics.todo.loadingAnalysis")})}):ie?(0,S.jsxs)("div",{className:"space-y-6",children:[(0,S.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,S.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:[(0,S.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:a("analytics.todo.frequency.totalTodos")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:ie.summary.totalTasks})]}),(0,S.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800",children:[(0,S.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:a("analytics.todo.frequency.completed")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:ie.summary.completedTasks})]}),(0,S.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800",children:[(0,S.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:a("analytics.todo.frequency.neverCompleted")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:ie.summary.neverCompletedTasks})]}),(0,S.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-800",children:[(0,S.jsx)("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:a("analytics.todo.frequency.completionRate")}),(0,S.jsxs)("div",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300",children:[ie.summary.completionRate,"%"]})]})]}),ie.userStats&&ie.userStats.length>0&&(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.frequency.completionsPerUser")}),(0,S.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.user")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.completed")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.lastCompletion")})]})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:ie.userStats.slice(0,10).map((e=>(0,S.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.user?"".concat(e.user.firstName," ").concat(e.user.lastName):a("analytics.todo.unknown")}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.completedCount}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.lastCompletedAt?(0,n.GP)(new Date(e.lastCompletedAt),"HH:mm"):"-"})]},e.userId)))})]})})]}),ie.taskStats&&ie.taskStats.length>0&&(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.frequency.frequentCompleted")}),(0,S.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.title")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.status")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.branch")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.completed")})]})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:ie.taskStats.slice(0,20).map((e=>(0,S.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800 ".concat(e.neverCompleted?"bg-red-50 dark:bg-red-900/10":""),children:[(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:e.title}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(Ae(e.currentStatus)),children:Ce(e.currentStatus)})}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name}),(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.completedCount,"x ",e.neverCompleted&&(0,S.jsx)("span",{className:"text-red-600 dark:text-red-400",children:a("analytics.todo.never")})]})]},e.taskId)))})]})})]}),ie.statusAverages&&Object.keys(ie.statusAverages).length>0&&(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.frequency.averageTimePerStatus")}),(0,S.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:Object.entries(ie.statusAverages).map((e=>{let[t,a]=e;return(0,S.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[(0,S.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:Ce(t)}),(0,S.jsxs)("div",{className:"text-xl font-bold text-gray-900 dark:text-white",children:[a.averageHours.toFixed(1),"h"]}),(0,S.jsxs)("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:[a.taskCount," To-Do(s)"]})]},t)}))})]}),ie.summary&&(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.frequency.statusDistribution")}),(0,S.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:(0,S.jsxs)("div",{className:"relative",style:{height:"200px"},children:[(0,S.jsxs)("div",{className:"absolute right-0 h-full flex flex-col justify-between text-xs text-gray-500 dark:text-gray-400 pr-1",children:[(0,S.jsx)("span",{children:ie.summary.totalTasks}),(0,S.jsx)("span",{children:Math.round(.75*ie.summary.totalTasks)}),(0,S.jsx)("span",{children:Math.round(.5*ie.summary.totalTasks)}),(0,S.jsx)("span",{children:Math.round(.25*ie.summary.totalTasks)}),(0,S.jsx)("span",{children:"0"})]}),(0,S.jsxs)("div",{className:"absolute inset-0 flex flex-col justify-between pointer-events-none pr-8",children:[(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})]}),(0,S.jsxs)("div",{className:"absolute inset-0 flex items-end justify-around gap-2 pr-8 pb-1",children:[(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsx)("div",{className:"w-full bg-green-500 dark:bg-green-600 rounded-t",style:{height:"".concat(ie.summary.completedTasks>0?ie.summary.completedTasks/ie.summary.totalTasks*100:0,"%"),minHeight:ie.summary.completedTasks>0?"4px":"0px"},title:"".concat(a("analytics.todo.frequency.completed"),": ").concat(ie.summary.completedTasks)}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium",children:a("analytics.todo.frequency.completed")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:ie.summary.completedTasks})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsx)("div",{className:"w-full bg-yellow-500 dark:bg-yellow-600 rounded-t",style:{height:"".concat(ie.summary.totalTasks-ie.summary.completedTasks-ie.summary.neverCompletedTasks>0?(ie.summary.totalTasks-ie.summary.completedTasks-ie.summary.neverCompletedTasks)/ie.summary.totalTasks*100:0,"%"),minHeight:ie.summary.totalTasks-ie.summary.completedTasks-ie.summary.neverCompletedTasks>0?"4px":"0px"},title:"".concat(a("tasks.status.open"),": ").concat(ie.summary.totalTasks-ie.summary.completedTasks-ie.summary.neverCompletedTasks)}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium",children:a("tasks.status.open")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:ie.summary.totalTasks-ie.summary.completedTasks-ie.summary.neverCompletedTasks})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsx)("div",{className:"w-full bg-red-500 dark:bg-red-600 rounded-t",style:{height:"".concat(ie.summary.neverCompletedTasks>0?ie.summary.neverCompletedTasks/ie.summary.totalTasks*100:0,"%"),minHeight:ie.summary.neverCompletedTasks>0?"4px":"0px"},title:"".concat(a("analytics.todo.frequency.neverCompleted"),": ").concat(ie.summary.neverCompletedTasks)}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium",children:a("analytics.todo.frequency.neverCompleted")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:ie.summary.neverCompletedTasks})]})]})]})})]})]}):(0,S.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:a("analytics.todo.noData")})]}),ye&&(0,S.jsxs)("div",{className:"mb-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,S.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,S.jsx)(v.A,{className:"h-5 w-5"}),a("analytics.todo.shift.shiftBased")]}),he?(0,S.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,S.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:a("analytics.todo.loadingAnalysis")})}):ue?(0,S.jsxs)("div",{className:"space-y-6",children:[(0,S.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,S.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:[(0,S.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:a("analytics.todo.shift.totalShifts")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:ue.summary.totalShifts})]}),(0,S.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800",children:[(0,S.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:a("analytics.todo.shift.todosInShifts")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:ue.summary.totalTasksInShifts})]}),(0,S.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-800",children:[(0,S.jsx)("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:a("analytics.todo.shift.totalHours")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300",children:ue.summary.totalDurationHours||"0.00"})]}),(0,S.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800",children:[(0,S.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:a("analytics.todo.shift.averageDuration")}),(0,S.jsxs)("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:[ue.summary.averageDurationHours||"-","h"]})]}),(0,S.jsxs)("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-4 border border-indigo-200 dark:border-indigo-800",children:[(0,S.jsx)("div",{className:"text-sm text-indigo-600 dark:text-indigo-400",children:a("analytics.todo.shift.averageTodosPerShift")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-indigo-700 dark:text-indigo-300",children:ue.summary.totalShifts>0?(ue.summary.totalTasksInShifts/ue.summary.totalShifts).toFixed(1):"0"})]})]}),ue.shifts&&ue.shifts.length>0&&(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.shift.shiftsWithTodos")}),(0,S.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.user")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.branch")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.shift.time")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.shift.duration")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.title")})]})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:ue.shifts.map((e=>{const t=ke.has(e.workTimeId);return(0,S.jsxs)(s.Fragment,{children:[(0,S.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:[e.user.firstName," ",e.user.lastName]}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name}),(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[(0,n.GP)(new Date(e.startTime),"HH:mm"),e.endTime&&" - ".concat((0,n.GP)(new Date(e.endTime),"HH:mm"))]}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.durationHours?"".concat(e.durationHours,"h"):a("worktime.running")}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(0,S.jsxs)("div",{className:"flex items-center gap-2",children:[(0,S.jsx)("span",{children:e.linkedTasksCount}),e.linkedTasksCount>0&&(0,S.jsx)("button",{onClick:()=>{return t=e.workTimeId,void fe((e=>{const a=new Set(e);return a.has(t)?a.delete(t):a.add(t),a}));var t},className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",title:a("analytics.todo.shift.showTodos"),children:t?(0,S.jsx)(Q,{className:"h-4 w-4"}):(0,S.jsx)(J.A,{className:"h-4 w-4"})})]})})]}),t&&e.linkedTasksCount>0&&(0,S.jsx)("tr",{className:"bg-gray-50 dark:bg-gray-800/50",children:(0,S.jsx)("td",{colSpan:5,className:"px-3 sm:px-4 md:px-6 py-4",children:(0,S.jsxs)("div",{className:"ml-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4",children:[(0,S.jsx)("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:a("analytics.todo.shift.linkedTasks")}),(0,S.jsx)("div",{className:"space-y-2",children:e.linkedTasks.map((e=>(0,S.jsxs)("div",{className:"flex items-center gap-3 text-xs text-gray-600 dark:text-gray-400",children:[(0,S.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(Ae(e.status)),children:Ce(e.status)}),(0,S.jsx)("span",{className:"font-medium",children:e.title}),e.responsible&&(0,S.jsxs)("span",{className:"text-gray-400",children:["(",e.responsible.firstName," ",e.responsible.lastName,")"]})]},e.id)))})]})})})]},e.workTimeId)}))})]})})]}),ue.tasksWithShifts&&ue.tasksWithShifts.length>0&&(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.shift.tasksWithShiftDistribution")}),(0,S.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.title")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.status")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.shift.totalShifts")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.shift.totalTime")})]})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:ue.tasksWithShifts.slice(0,30).map((e=>(0,S.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:e.task.title}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(Ae(e.task.status)),children:Ce(e.task.status)})}),(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.shiftCount,"x"]}),(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.totalDurationHours,"h"]})]},e.task.id)))})]})})]})]}):(0,S.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:a("analytics.todo.noShiftData")})]}),(0,S.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6",children:[(0,S.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[(0,S.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("analytics.todo.stats.total")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:We.total})]}),(0,S.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800",children:[(0,S.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:a("analytics.todo.frequency.completed")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:We.done})]}),(0,S.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:[(0,S.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:a("analytics.todo.stats.inProgress")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:We.inProgress})]}),(0,S.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-800",children:[(0,S.jsx)("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:a("analytics.todo.stats.qualityControl")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300",children:We.qualityControl})]}),(0,S.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800",children:[(0,S.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:a("tasks.status.open")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:We.open})]}),(0,S.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4 border border-red-200 dark:border-red-800",children:[(0,S.jsx)("div",{className:"text-sm text-red-600 dark:text-red-400",children:a("tasks.status.improval")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-red-700 dark:text-red-300",children:We.improval})]})]}),Se.length>0&&(0,S.jsxs)("div",{className:"mb-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,S.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,S.jsx)(X.A,{className:"h-5 w-5"}),a("analytics.todo.statusDistribution")]}),(0,S.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:(0,S.jsxs)("div",{className:"relative",style:{height:"200px"},children:[(0,S.jsxs)("div",{className:"absolute right-0 h-full flex flex-col justify-between text-xs text-gray-500 dark:text-gray-400 pr-1",children:[(0,S.jsx)("span",{children:We.total}),(0,S.jsx)("span",{children:Math.round(.75*We.total)}),(0,S.jsx)("span",{children:Math.round(.5*We.total)}),(0,S.jsx)("span",{children:Math.round(.25*We.total)}),(0,S.jsx)("span",{children:"0"})]}),(0,S.jsxs)("div",{className:"absolute inset-0 flex flex-col justify-between pointer-events-none pr-8",children:[(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})]}),(0,S.jsxs)("div",{className:"absolute inset-0 flex items-end justify-around gap-1 sm:gap-2 pr-8 pb-1",children:[(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsx)("div",{className:"w-full bg-green-500 dark:bg-green-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(We.total>0?We.done/We.total*100:0,"%"),minHeight:We.done>0?"4px":"0px"},title:"".concat(a("analytics.todo.frequency.completed"),": ").concat(We.done)}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("analytics.todo.frequency.completed")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:We.done})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsx)("div",{className:"w-full bg-blue-500 dark:bg-blue-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(We.total>0?We.inProgress/We.total*100:0,"%"),minHeight:We.inProgress>0?"4px":"0px"},title:"".concat(a("analytics.todo.stats.inProgress"),": ").concat(We.inProgress)}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("analytics.todo.stats.inProgress")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:We.inProgress})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsx)("div",{className:"w-full bg-purple-500 dark:bg-purple-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(We.total>0?We.qualityControl/We.total*100:0,"%"),minHeight:We.qualityControl>0?"4px":"0px"},title:"".concat(a("analytics.todo.stats.qualityControl"),": ").concat(We.qualityControl)}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("analytics.todo.columns.qualityControl")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:We.qualityControl})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsx)("div",{className:"w-full bg-yellow-500 dark:bg-yellow-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(We.total>0?We.open/We.total*100:0,"%"),minHeight:We.open>0?"4px":"0px"},title:"".concat(a("tasks.status.open"),": ").concat(We.open)}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("tasks.status.open")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:We.open})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsx)("div",{className:"w-full bg-red-500 dark:bg-red-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(We.total>0?We.improval/We.total*100:0,"%"),minHeight:We.improval>0?"4px":"0px"},title:"".concat(a("tasks.status.improval"),": ").concat(We.improval)}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("tasks.status.improval")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:We.improval})]})]})]})})]}),c?(0,S.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,S.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:a("common.loading")})}):"table"===ae?(0,S.jsx)("div",{className:"overflow-x-auto",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,S.jsx)("tr",{children:K.filter((e=>U.includes(e))).map((e=>{const t=ve.find((t=>t.id===e));return t?(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:t.label},e):null}))})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:0===Se.length?(0,S.jsx)("tr",{children:(0,S.jsx)("td",{colSpan:K.filter((e=>U.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"Keine To-Dos f\xfcr dieses Datum gefunden"})}):Se.map((e=>{const t=re.has(e.id),a=e.statusHistory&&e.statusHistory.length>0;return(0,S.jsxs)(s.Fragment,{children:[(0,S.jsx)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:K.filter((e=>U.includes(e))).map((s=>{switch(s){case"time":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(0,n.GP)(new Date(e.updatedAt),"HH:mm")},s);case"title":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:(0,S.jsxs)("div",{className:"flex items-center gap-2",children:[a&&(0,S.jsx)("button",{onClick:()=>de(e.id),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",title:"Status-Historie anzeigen",children:t?(0,S.jsx)(Q,{className:"h-4 w-4"}):(0,S.jsx)(J.A,{className:"h-4 w-4"})}),(0,S.jsx)("span",{children:e.title})]})},s);case"status":return(0,S.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(Ae(e.status)),children:Ce(e.status)})},s);case"responsible":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.responsible?"".concat(e.responsible.firstName," ").concat(e.responsible.lastName):"-"},s);case"qualityControl":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.qualityControl?"".concat(e.qualityControl.firstName," ").concat(e.qualityControl.lastName):"-"},s);case"branch":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name},s);default:return null}}))}),t&&a&&(0,S.jsx)("tr",{className:"bg-gray-50 dark:bg-gray-800/50",children:(0,S.jsx)("td",{colSpan:K.filter((e=>U.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-4",children:(0,S.jsxs)("div",{className:"ml-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4",children:[(0,S.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[(0,S.jsx)(A.A,{className:"h-4 w-4"}),"Status-Wechsel"]}),(0,S.jsx)("div",{className:"space-y-2",children:e.statusHistory.map(((e,t)=>(0,S.jsxs)("div",{className:"flex items-center gap-3 text-xs text-gray-600 dark:text-gray-400",children:[(0,S.jsx)("span",{className:"font-medium",children:(0,n.GP)(new Date(e.changedAt),"HH:mm:ss")}),(0,S.jsx)("span",{className:"text-gray-400",children:"\u2192"}),(0,S.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(Ae(e.oldStatus||"open")),children:Ce(e.oldStatus||"open")}),(0,S.jsx)("span",{className:"text-gray-400",children:"\u2192"}),(0,S.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(Ae(e.newStatus)),children:Ce(e.newStatus)}),(0,S.jsx)("span",{className:"text-gray-400",children:"von"}),(0,S.jsxs)("span",{className:"font-medium",children:[e.user.firstName," ",e.user.lastName]})]},e.id)))})]})})})]},e.id)}))})]})}):(0,S.jsx)("div",{className:"-mx-3 sm:-mx-4 md:-mx-6",children:0===Se.length?(0,S.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400",children:[(0,S.jsx)(Z.A,{className:"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500"}),(0,S.jsx)("div",{className:"text-sm",children:"Keine To-Dos gefunden"})]}):(0,S.jsx)(R.A,{children:Se.map((e=>{const t=[];U.includes("branch")&&t.push({icon:(0,S.jsx)(j.A,{className:"h-4 w-4"}),label:"Niederlassung",value:e.branch.name,section:"left"}),U.includes("responsible")&&t.push({icon:(0,S.jsx)(f.A,{className:"h-4 w-4"}),label:"Verantwortlich",value:e.responsible?"".concat(e.responsible.firstName," ").concat(e.responsible.lastName):"-",section:"main"}),U.includes("qualityControl")&&t.push({icon:(0,S.jsx)(f.A,{className:"h-4 w-4"}),label:"Qualit\xe4tskontrolle",value:e.qualityControl?"".concat(e.qualityControl.firstName," ").concat(e.qualityControl.lastName):"-",section:"main"}),U.includes("time")&&t.push({icon:(0,S.jsx)(v.A,{className:"h-4 w-4"}),label:"Zeit",value:(0,n.GP)(new Date(e.updatedAt),"HH:mm"),section:"right"});const a=e.statusHistory&&e.statusHistory.length>0,s=re.has(e.id),r=a?(0,S.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,S.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2",children:[(0,S.jsx)(A.A,{className:"h-4 w-4"}),"Status-Wechsel"]}),(0,S.jsx)("div",{className:"space-y-2",children:e.statusHistory.map((e=>(0,S.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[(0,S.jsx)("span",{className:"font-medium",children:(0,n.GP)(new Date(e.changedAt),"HH:mm:ss")}),(0,S.jsx)("span",{className:"text-gray-400",children:"\u2192"}),(0,S.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(Ae(e.oldStatus||"open")),children:Ce(e.oldStatus||"open")}),(0,S.jsx)("span",{className:"text-gray-400",children:"\u2192"}),(0,S.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(Ae(e.newStatus)),children:Ce(e.newStatus)}),(0,S.jsx)("span",{className:"text-gray-400",children:"von"}),(0,S.jsxs)("span",{className:"font-medium",children:[e.user.firstName," ",e.user.lastName]})]},e.id)))})]}):null;return(0,S.jsx)(O.A,{title:e.title,status:{label:Ce(e.status),color:Ae(e.status)},metadata:t,expandable:r?{isExpanded:s,content:r,onToggle:()=>de(e.id)}:void 0},e.id)}))})})]})};var ae=a(2704);const se="request-analytics-table",re=["time","title","status","requester","responsible","branch"],le=e=>{let{selectedDate:t}=e;const{t:a}=(0,r.Bd)(),[l,o]=(0,s.useState)([]),[c,m]=(0,s.useState)(!1),[x,u]=(0,s.useState)(null),[g,b]=(0,s.useState)(""),[k,N]=(0,s.useState)([]),[w,T]=(0,s.useState)([]),[A,C]=(0,s.useState)(""),[W,E]=(0,s.useState)(null),[D,L]=(0,s.useState)(!1),{settings:F,isLoading:H,updateColumnOrder:_,updateHiddenColumns:P,toggleColumnVisibility:B,isColumnVisible:V,updateViewMode:G}=(0,I.F)(se,{defaultColumnOrder:re,defaultViewMode:"table"}),z=(null===F||void 0===F?void 0:F.columnOrder)||re,Z=(null===F||void 0===F?void 0:F.hiddenColumns)||[],K=z.filter((e=>!Z.includes(e))),Y=(null===F||void 0===F?void 0:F.viewMode)||"table",[U,Q]=(0,s.useState)(Y);(0,s.useEffect)((()=>{null!==F&&void 0!==F&&F.viewMode&&F.viewMode!==U&&Q(F.viewMode)}),[null===F||void 0===F?void 0:F.viewMode]);const J=(0,s.useMemo)((()=>[{id:"time",label:a("analytics.request.columns.time")},{id:"title",label:a("analytics.request.columns.title")},{id:"status",label:a("analytics.request.columns.status")},{id:"requester",label:a("analytics.request.columns.requester")},{id:"responsible",label:a("analytics.request.columns.responsible")},{id:"branch",label:a("analytics.request.columns.branch")}]),[a]);(0,s.useEffect)((()=>{t&&(async()=>{try{m(!0),u(null);const e={date:t};k.forEach((t=>{"branch"===t.column&&t.value&&(e.branchId=t.value),"requester"===t.column&&t.value&&(e.userId=t.value),"status"===t.column&&t.value}));const a=await d.A.get(i.Sn.TEAM_WORKTIME.ANALYTICS.REQUESTS_CHRONOLOGICAL,{params:e});o(a.data||[])}catch(x){console.error("Fehler beim Laden der Requests:",x),u(a("analytics.request.loadError"))}finally{m(!1)}})()}),[t,k]);const X=(0,s.useCallback)(((e,t)=>{N(e),T(t),L(!1)}),[]),$=(0,s.useCallback)((()=>{N([]),T([]),C(""),E(null)}),[]),ee=(0,s.useCallback)(((e,t,a,s)=>{C(e),E(t),X(a,s)}),[X]),te=(0,s.useCallback)((()=>k.filter((e=>""!==e.column&&null!==e.value)).length),[k]),le=e=>{switch(e){case"approved":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"approval":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"denied":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";case"to_improve":return"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},de=e=>({approved:a("analytics.request.status.approved"),approval:a("analytics.request.status.approval"),denied:a("analytics.request.status.denied"),to_improve:a("analytics.request.status.to_improve")}[e]||e),ie=(0,s.useMemo)((()=>{let e=[...l];if(g){const t=g.toLowerCase();e=e.filter((e=>e.title.toLowerCase().includes(t)||e.branch.name.toLowerCase().includes(t)||"".concat(e.requester.firstName," ").concat(e.requester.lastName).toLowerCase().includes(t)||"".concat(e.responsible.firstName," ").concat(e.responsible.lastName).toLowerCase().includes(t)))}return k.forEach((t=>{if(""===t.column||null===t.value)return;const a=t.operator||"equals",s=t.value;e=e.filter((e=>{switch(t.column){case"status":return"equals"!==a||e.status===s;case"title":return"contains"!==a||e.title.toLowerCase().includes(String(s).toLowerCase());default:return!0}}))})),e}),[l,g,k]),ne=(0,s.useMemo)((()=>({total:ie.length,approved:ie.filter((e=>"approved"===e.status)).length,pending:ie.filter((e=>"approval"===e.status)).length,denied:ie.filter((e=>"denied"===e.status)).length,toImprove:ie.filter((e=>"to_improve"===e.status)).length})),[ie]);return x?(0,S.jsx)("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded",children:x}):(0,S.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 request-analytics-wrapper",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6",children:[(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)(ae.A,{className:"h-6 w-6 mr-2 dark:text-white"}),(0,S.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:a("analytics.request.title")})]}),(0,S.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,S.jsx)("input",{type:"text",placeholder:a("common.searchPlaceholder"),className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:g,onChange:e=>b(e.target.value)}),(0,S.jsx)("button",{className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("cards"===U?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""),onClick:()=>{const e="table"===U?"cards":"table";Q(e),G&&G(e)},title:a("table"===U?"common.viewAsCards":"common.viewAsTable"),children:"table"===U?(0,S.jsx)(h.A,{className:"h-5 w-5"}):(0,S.jsx)(p.A,{className:"h-5 w-5"})}),(0,S.jsxs)("button",{className:"p-2 rounded-md ".concat(te()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"," ml-1 relative"),onClick:()=>L(!D),title:a("common.filter"),style:{position:"relative"},children:[(0,S.jsx)(y.A,{className:"h-5 w-5"}),te()>0&&(0,S.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10",children:te()})]})]})]}),D&&(0,S.jsx)("div",{className:"cards"===U?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,S.jsx)(q.A,{columns:J,onApply:X,onReset:$,savedConditions:k,savedOperators:w,tableId:se})}),(0,S.jsx)("div",{className:"cards"===U?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,S.jsx)(M.A,{tableId:se,onSelectFilter:X,onReset:$,activeFilterName:A,selectedFilterId:W,onFilterChange:ee,defaultFilterName:a("teamWorktime.filters.all")})}),(0,S.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[(0,S.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[(0,S.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("analytics.request.stats.total")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:ne.total})]}),(0,S.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800",children:[(0,S.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:a("analytics.request.status.approved")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:ne.approved})]}),(0,S.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800",children:[(0,S.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:a("analytics.request.status.approval")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:ne.pending})]}),(0,S.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4 border border-red-200 dark:border-red-800",children:[(0,S.jsx)("div",{className:"text-sm text-red-600 dark:text-red-400",children:a("analytics.request.status.denied")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-red-700 dark:text-red-300",children:ne.denied})]}),(0,S.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-4 border border-orange-200 dark:border-orange-800",children:[(0,S.jsx)("div",{className:"text-sm text-orange-600 dark:text-orange-400",children:a("analytics.request.status.to_improve")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-orange-700 dark:text-orange-300",children:ne.toImprove})]})]}),c?(0,S.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,S.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:a("analytics.request.loading")})}):"table"===U?(0,S.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,S.jsx)("tr",{children:z.filter((e=>K.includes(e))).map((e=>{const t=J.find((t=>t.id===e));return t?(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:t.label},e):null}))})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:0===ie.length?(0,S.jsx)("tr",{children:(0,S.jsx)("td",{colSpan:z.filter((e=>K.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:a("analytics.request.noRequestsForDate")})}):ie.map((e=>(0,S.jsx)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:z.filter((e=>K.includes(e))).map((t=>{switch(t){case"time":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(0,n.GP)(new Date(e.createdAt),"HH:mm")},t);case"title":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:e.title},t);case"status":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(le(e.status)),children:de(e.status)})},t);case"requester":return(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.requester.firstName," ",e.requester.lastName]},t);case"responsible":return(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.responsible.firstName," ",e.responsible.lastName]},t);case"branch":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name},t);default:return null}}))},e.id)))})]})}):(0,S.jsx)("div",{className:"-mx-3 sm:-mx-4 md:-mx-6",children:0===ie.length?(0,S.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400",children:[(0,S.jsx)(ae.A,{className:"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500"}),(0,S.jsx)("div",{className:"text-sm",children:a("analytics.request.noRequests")})]}):(0,S.jsx)(R.A,{children:ie.map((e=>{const t=[];return K.includes("branch")&&t.push({icon:(0,S.jsx)(j.A,{className:"h-4 w-4"}),label:a("analytics.request.metadata.branch"),value:e.branch.name,section:"left"}),K.includes("requester")&&t.push({icon:(0,S.jsx)(f.A,{className:"h-4 w-4"}),label:a("analytics.request.metadata.requester"),value:"".concat(e.requester.firstName," ").concat(e.requester.lastName),section:"main"}),K.includes("responsible")&&t.push({icon:(0,S.jsx)(f.A,{className:"h-4 w-4"}),label:a("analytics.request.metadata.responsible"),value:"".concat(e.responsible.firstName," ").concat(e.responsible.lastName),section:"main"}),K.includes("time")&&t.push({icon:(0,S.jsx)(v.A,{className:"h-4 w-4"}),label:a("analytics.request.metadata.time"),value:(0,n.GP)(new Date(e.createdAt),"HH:mm"),section:"right"}),(0,S.jsx)(O.A,{title:e.title,status:{label:de(e.status),color:le(e.status)},metadata:t},e.id)}))})})]})},de=()=>{const{t:e}=(0,r.Bd)(),{hasPermission:t}=(0,L.S)(),a=t("team_worktime_control","read","page"),o=t("team_worktime","read","table"),c=a&&o,[m,x]=(0,s.useState)([]),[u,g]=(0,s.useState)([]),[h,p]=(0,s.useState)((0,n.GP)(new Date,"yyyy-MM-dd")),[y,b]=(0,s.useState)("worktimes"),[k,f]=(0,s.useState)(!1),[v,j]=(0,s.useState)(null),N=(0,s.useCallback)((async()=>{try{f(!0),j(null);const e=await d.A.get(i.Sn.TEAM_WORKTIME.ACTIVE);x(e.data)}catch(v){var t,a,s;console.error("Fehler beim Laden der aktiven Benutzer:",v);let d=e("teamWorktime.messages.loadActiveUsersError");if(v.response){var r;const t=v.response.status,a=null===(r=v.response.data)||void 0===r?void 0:r.message;403===t?d=a||e("teamWorktime.permissions.insufficientShort"):401===t?d=e("teamWorktime.messages.unauthorized",{defaultValue:"Nicht autorisiert"}):500===t?d=e("teamWorktime.messages.serverError",{defaultValue:"Serverfehler"}):a&&(d=a)}else v.message&&(d=v.message);j(d),console.error("Fehlerdetails:",{status:null===(t=v.response)||void 0===t?void 0:t.status,statusText:null===(a=v.response)||void 0===a?void 0:a.statusText,data:null===(s=v.response)||void 0===s?void 0:s.data,message:v.message})}finally{f(!1)}}),[e]),w=(0,s.useCallback)((async()=>{try{f(!0),j(null);const e=await d.A.get("".concat(i.Sn.TEAM_WORKTIME.USER_DAY,"?date=").concat(h));g(e.data)}catch(v){console.error("Fehler beim Laden der Zeiterfassungen:",v),j(e("teamWorktime.messages.loadWorktimesError"))}finally{f(!1)}}),[h,e]);return(0,s.useEffect)((()=>{if(!c)return void j(e("teamWorktime.permissions.insufficientDetails"));N(),w();const t=setInterval(N,3e4);return()=>clearInterval(t)}),[N,w,c]),(0,s.useEffect)((()=>{w()}),[h,w]),(0,S.jsx)("div",{className:"min-h-screen dark:bg-gray-900",children:(0,S.jsx)("div",{className:"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6",children:(0,S.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,S.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,S.jsxs)("div",{className:"flex items-center pl-2 sm:pl-0",children:[(0,S.jsx)(l.A,{className:"h-6 w-6 text-gray-900 dark:text-white mr-2"}),(0,S.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:e("teamWorktime.title")})]})}),!c&&(0,S.jsxs)("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4",children:[(0,S.jsx)("p",{className:"font-medium mb-2",children:e("teamWorktime.permissions.insufficient")}),(0,S.jsxs)("ul",{className:"list-disc list-inside text-sm space-y-1",children:[!a&&(0,S.jsx)("li",{children:e("teamWorktime.permissions.missingPage")}),!o&&(0,S.jsx)("li",{children:e("teamWorktime.permissions.missingTable")})]}),(0,S.jsx)("p",{className:"text-sm mt-2",children:e("teamWorktime.permissions.contactAdmin")})]}),v&&(0,S.jsx)("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4",children:v}),(0,S.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:(0,S.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,S.jsx)("button",{onClick:()=>b("worktimes"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("worktimes"===y?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("teamWorktime.tabs.worktimes")}),(0,S.jsx)("button",{onClick:()=>b("todos"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("todos"===y?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("teamWorktime.tabs.todos")}),(0,S.jsx)("button",{onClick:()=>b("requests"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("requests"===y?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("teamWorktime.tabs.requests")})]})}),"worktimes"===y&&(0,S.jsx)(z,{activeUsers:m,allWorktimes:u,loading:k,selectedDate:h,onDateChange:p,onStopWorktime:async(t,a)=>{try{f(!0),j(null),await d.A.post(i.Sn.TEAM_WORKTIME.STOP_USER,{userId:t,endTime:new Date((new Date).getTime()-6e4*(new Date).getTimezoneOffset())}),N()}catch(v){console.error("Fehler beim Stoppen der Benutzer-Zeiterfassung:",v),j(e("teamWorktime.messages.stopWorktimeError"))}finally{f(!1)}},onRefresh:N,showTodos:!0,showRequests:!0}),"todos"===y&&(0,S.jsx)(te,{selectedDate:h}),"requests"===y&&(0,S.jsx)(le,{selectedDate:h})]})})})}},6238:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(45),r=a(5043);const l=["title","titleId"];function d(e,t){let{title:a,titleId:d}=e,i=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},i),a?r.createElement("title",{id:d},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"}))}const i=r.forwardRef(d)},7012:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(45),r=a(5043);const l=["title","titleId"];function d(e,t){let{title:a,titleId:d}=e,i=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},i),a?r.createElement("title",{id:d},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const i=r.forwardRef(d)},7030:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(45),r=a(5043);const l=["title","titleId"];function d(e,t){let{title:a,titleId:d}=e,i=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},i),a?r.createElement("title",{id:d},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 9h16.5m-16.5 6.75h16.5"}))}const i=r.forwardRef(d)}}]);
//# sourceMappingURL=645.e95260b9.chunk.js.map