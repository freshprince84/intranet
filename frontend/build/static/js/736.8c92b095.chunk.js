"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[736],{542:(e,t,r)=>{r.d(t,{Ay:()=>c,Zj:()=>o,i$:()=>i});var a=r(1923),n=r(1801);console.log("DEBUGAUSGABE API-Client: API_URL ist:",n.H$);const s=a.A;s.interceptors.request.use((e=>{var t;const r="".concat(e.baseURL).concat(e.url);console.log("DEBUGAUSGABE API-Client: Vollst\xe4ndige Request URL:",r),console.log("DEBUGAUSGABE API-Client: Request-Methode:",null===(t=e.method)||void 0===t?void 0:t.toUpperCase()),console.log("DEBUGAUSGABE API-Client: Request-Headers:",e.headers),console.log("DEBUGAUSGABE API-Client: Request-Daten:",e.data);const a=localStorage.getItem("token");return console.log("DEBUGAUSGABE API-Client: Token vorhanden:",!!a),e}),(e=>(console.error("DEBUGAUSGABE API-Client: Fehler im Request Interceptor:",e),Promise.reject(e)))),s.interceptors.response.use((e=>(console.log("DEBUGAUSGABE API-Client: Response erhalten:",e.status,e.config.url),e)),(e=>(console.error("DEBUGAUSGABE API-Client: Fehler im Response Interceptor:",e.message),e.response?(console.error("DEBUGAUSGABE API-Client: Response Status:",e.response.status),console.error("DEBUGAUSGABE API-Client: Response Daten:",e.response.data)):console.error("DEBUGAUSGABE API-Client: Keine Response erhalten"),Promise.reject(e))));const i={getAll:()=>s.get("/users"),getById:e=>s.get("/users/".concat(e)),create:e=>{console.log("DEBUGAUSGABE API-Client: userApi.create wird aufgerufen mit Daten:",e);try{return s.post("/users",e).then((e=>(console.log("DEBUGAUSGABE API-Client: userApi.create Antwort:",e),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: userApi.create Fehler:",e.response||e),e}))}catch(t){throw console.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in userApi.create:",t),t}},update:(e,t)=>s.put("/users/".concat(e),t),updateRoles:(e,t)=>s.put("/users/".concat(e,"/roles"),{roleIds:t})},o={getAll:()=>(console.log("DEBUGAUSGABE API-Client: roleApi.getAll wird aufgerufen"),s.get("/roles").then((e=>(console.log("DEBUGAUSGABE API-Client: roleApi.getAll erfolgreich:",e.data.length,"Rollen geladen"),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: roleApi.getAll Fehler:",e.message),e}))),getById:e=>(console.log("DEBUGAUSGABE API-Client: roleApi.getById(".concat(e,") wird aufgerufen")),s.get("/roles/".concat(e))),create:e=>{console.log("DEBUGAUSGABE API-Client: roleApi.create wird aufgerufen mit Daten:",e);try{return s.post("/roles",e).then((e=>(console.log("DEBUGAUSGABE API-Client: roleApi.create Antwort:",e),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: roleApi.create Fehler:",e.response||e),e}))}catch(t){throw console.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in roleApi.create:",t),t}},update:(e,t)=>{console.log("DEBUGAUSGABE API-Client: roleApi.update f\xfcr ID ".concat(e," wird aufgerufen mit Daten:"),t);try{return s.put("/roles/".concat(e),t).then((e=>(console.log("DEBUGAUSGABE API-Client: roleApi.update Antwort:",e),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: roleApi.update Fehler:",e.response||e),e}))}catch(r){throw console.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in roleApi.update:",r),r}},delete:e=>(console.log("DEBUGAUSGABE API-Client: roleApi.delete(".concat(e,") wird aufgerufen")),s.delete("/roles/".concat(e)))},c=s},4736:(e,t,r)=>{r.d(t,{A:()=>k});var a=r(5043),n=r(4117),s=r(9379),i=r(542),o=r(1801);const c=async(e,t)=>{try{return(await i.Ay.post(o.Sn.IDENTIFICATION_DOCUMENTS.BY_USER(e),t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){throw console.error("Fehler beim Hinzuf\xfcgen des Dokuments:",r),r}},d=async(e,t)=>{try{return(await i.Ay.put(o.Sn.IDENTIFICATION_DOCUMENTS.BY_ID(e),t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){throw console.error("Fehler beim Aktualisieren des Dokuments:",r),r}};var l=r(7855);const u=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<768;var m=r(7591),g=r(2965),x=r(1816),p=r(9422),h=r(579);const y=e=>{let{onCapture:t,onCancel:r}=e;const{t:s}=(0,n.Bd)(),[i,o]=(0,a.useState)(null),[c,d]=(0,a.useState)(null),[l,y]=(0,a.useState)(null),b=(0,a.useRef)(null),f=(0,a.useRef)(null),D=async()=>{try{y(null);const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});o(e),b.current&&(b.current.srcObject=e)}catch(l){console.error("Fehler beim Zugriff auf die Kamera:",l),y(s("camera.accessError"))}},k=()=>{i&&(i.getTracks().forEach((e=>e.stop())),o(null))};return(0,a.useEffect)((()=>(u()&&D(),()=>{k()})),[]),u()?(0,h.jsxs)("div",{className:"camera-capture p-2 dark:bg-gray-800",children:[(0,h.jsx)("canvas",{ref:f,className:"hidden"}),l&&(0,h.jsxs)("div",{className:"error bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4",children:[(0,h.jsx)("p",{children:l}),(0,h.jsx)("button",{className:"mt-2 p-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:r,title:s("camera.back"),children:(0,h.jsx)(m.A,{className:"h-5 w-5"})})]}),l||c?!l&&c?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"preview-container mb-4 rounded overflow-hidden border border-gray-300 dark:border-gray-700",children:(0,h.jsx)("img",{src:c,alt:"Aufgenommenes Dokument",className:"w-full h-auto"})}),(0,h.jsxs)("div",{className:"flex justify-between",children:[(0,h.jsx)("button",{className:"p-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:()=>{d(null),D()},title:"Neu aufnehmen",children:(0,h.jsx)(x.A,{className:"h-5 w-5"})}),(0,h.jsx)("button",{className:"p-2 bg-green-500 dark:bg-green-600 text-white rounded-md hover:bg-green-600 dark:hover:bg-green-700",onClick:()=>{c&&t(c)},title:"Verwenden",children:(0,h.jsx)(p.A,{className:"h-5 w-5"})})]})]}):null:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"video-container mb-4 rounded overflow-hidden border border-gray-300 dark:border-gray-700",children:(0,h.jsx)("video",{ref:b,autoPlay:!0,playsInline:!0,className:"w-full h-auto"})}),(0,h.jsxs)("div",{className:"flex justify-between",children:[(0,h.jsx)("button",{className:"p-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:r,title:"Abbrechen",children:(0,h.jsx)(m.A,{className:"h-5 w-5"})}),(0,h.jsx)("button",{className:"p-2 bg-blue-500 dark:bg-blue-600 text-white rounded-md hover:bg-blue-600 dark:hover:bg-blue-700",onClick:()=>{if(b.current&&f.current){const e=f.current,t=b.current;e.width=t.videoWidth,e.height=t.videoHeight;const r=e.getContext("2d");if(r){r.drawImage(t,0,0);const a=e.toDataURL("image/jpeg",.9);d(a),k()}}},title:"Foto aufnehmen",children:(0,h.jsx)(g.A,{className:"h-5 w-5"})})]})]})]}):(0,h.jsxs)("div",{className:"p-4 text-center dark:bg-gray-800 dark:text-white",children:[(0,h.jsx)("p",{className:"mb-4",children:s("camera.onlyMobile")}),(0,h.jsx)("button",{className:"p-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:r,title:s("camera.back"),children:(0,h.jsx)(m.A,{className:"h-5 w-5"})})]})};var b=r(2704);const f=e=>{let{userId:t,document:r,onDocumentSaved:f,onCancel:D}=e;const{t:k}=(0,n.Bd)(),[A,w]=(0,a.useState)((null===r||void 0===r?void 0:r.documentType)||""),[v,N]=(0,a.useState)((null===r||void 0===r?void 0:r.documentNumber)||""),[j,E]=(0,a.useState)(null!==r&&void 0!==r&&r.issueDate?r.issueDate.substring(0,10):""),[I,C]=(0,a.useState)(null!==r&&void 0!==r&&r.expiryDate?r.expiryDate.substring(0,10):""),[S,U]=(0,a.useState)((null===r||void 0===r?void 0:r.issuingCountry)||""),[B,G]=(0,a.useState)((null===r||void 0===r?void 0:r.issuingAuthority)||""),[F,P]=(0,a.useState)(null),[T,_]=(0,a.useState)(null),[R,O]=(0,a.useState)(!1),[M,q]=(0,a.useState)(!1),[L,V]=(0,a.useState)(!1),[K,Y]=(0,a.useState)(null),{showMessage:z}=(0,l.A)(),H=[{value:"passport",label:k("identificationDocuments.types.passport")},{value:"national_id",label:k("identificationDocuments.types.national_id")},{value:"driving_license",label:k("identificationDocuments.types.driving_license")},{value:"residence_permit",label:k("identificationDocuments.types.residence_permit")},{value:"work_permit",label:k("identificationDocuments.types.work_permit")},{value:"tax_id",label:k("identificationDocuments.types.tax_id")},{value:"social_security",label:k("identificationDocuments.types.social_security")}],W=e=>{_(e),O(!1),P(null)},$=()=>{O(!1)};return R?(0,h.jsx)(y,{onCapture:W,onCancel:$}):(0,h.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),A&&v&&S){q(!0);try{if(r){if(F){const e=new FormData;v&&e.append("documentNumber",v),j&&e.append("issueDate",j),I&&e.append("expiryDate",I),S&&e.append("issuingCountry",S),B&&e.append("issuingAuthority",B),e.append("documentFile",F),await d(r.id,e)}else if(T)await(async(e,t,r)=>{try{return(await i.Ay.put(o.Sn.IDENTIFICATION_DOCUMENTS.BY_ID(e),(0,s.A)((0,s.A)({},r),{},{imageData:t}))).data}catch(a){throw console.error("Fehler beim Aktualisieren des Dokuments mit Kamera:",a),a}})(r.id,T,{documentNumber:v,issuingCountry:S,issueDate:j,expiryDate:I,issuingAuthority:B});else{const e=new FormData;v&&e.append("documentNumber",v),j&&e.append("issueDate",j),I&&e.append("expiryDate",I),S&&e.append("issuingCountry",S),B&&e.append("issuingAuthority",B),await d(r.id,e)}z(k("identificationDocuments.form.updateSuccess"),"success")}else{if(F){const e=new FormData;e.append("documentType",A),e.append("documentNumber",v),e.append("issuingCountry",S),j&&e.append("issueDate",j),I&&e.append("expiryDate",I),B&&e.append("issuingAuthority",B),e.append("documentFile",F),await c(t,e)}else if(T)await(async(e,t,r)=>{try{return(await i.Ay.post(o.Sn.IDENTIFICATION_DOCUMENTS.BY_USER(e),(0,s.A)((0,s.A)({},r),{},{imageData:t}))).data}catch(a){throw console.error("Fehler beim Hinzuf\xfcgen des Dokuments mit Kamera:",a),a}})(t,T,{documentType:A,documentNumber:v,issuingCountry:S,issueDate:j,expiryDate:I,issuingAuthority:B});else{const e=new FormData;e.append("documentType",A),e.append("documentNumber",v),e.append("issuingCountry",S),j&&e.append("issueDate",j),I&&e.append("expiryDate",I),B&&e.append("issuingAuthority",B),await c(t,e)}z(k("identificationDocuments.form.createSuccess"),"success")}f()}catch(l){var a,n;z(k("identificationDocuments.form.error",{error:(null===(a=l.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.error)||k("common.error")}),"error")}finally{q(!1)}}else z(k("identificationDocuments.form.fillRequiredFields"),"error")},className:"space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsxs)("label",{htmlFor:"documentType",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[k("identificationDocuments.form.documentType")," ",(0,h.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"*"})]}),(0,h.jsxs)("select",{id:"documentType",value:A,onChange:e=>w(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white",required:!0,children:[(0,h.jsx)("option",{value:"",children:k("identificationDocuments.form.selectDocumentType")}),H.map((e=>(0,h.jsx)("option",{value:e.value,children:e.label},e.value)))]})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)("label",{htmlFor:"documentNumber",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[k("identificationDocuments.form.documentNumber")," ",(0,h.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"*"})]}),(0,h.jsx)("input",{type:"text",id:"documentNumber",value:v,onChange:e=>N(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white",required:!0})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)("label",{htmlFor:"issuingCountry",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[k("identificationDocuments.form.issuingCountry")," ",(0,h.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"*"})]}),(0,h.jsx)("input",{type:"text",id:"issuingCountry",value:S,onChange:e=>U(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white",required:!0})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"issuingAuthority",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:k("identificationDocuments.form.issuingAuthority")}),(0,h.jsx)("input",{type:"text",id:"issuingAuthority",value:B,onChange:e=>G(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"issueDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:k("identificationDocuments.form.issueDate")}),(0,h.jsx)("input",{type:"date",id:"issueDate",value:j,onChange:e=>E(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"expiryDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:k("identificationDocuments.form.expiryDate")}),(0,h.jsx)("input",{type:"date",id:"expiryDate",value:I,onChange:e=>C(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:k("identificationDocuments.form.documentImage")}),(0,h.jsxs)("div",{className:"mt-1 flex items-center space-x-2",children:[(0,h.jsxs)("label",{className:"flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 cursor-pointer",children:[(0,h.jsx)(b.A,{className:"h-5 w-5 mr-2 text-gray-500 dark:text-gray-400"}),k("identificationDocuments.form.uploadFile"),(0,h.jsx)("input",{type:"file",className:"sr-only",onChange:e=>{e.target.files&&e.target.files.length>0&&(P(e.target.files[0]),_(null))},accept:"image/*"})]}),u()&&(0,h.jsxs)("button",{type:"button",onClick:()=>O(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",children:[(0,h.jsx)(g.A,{className:"h-5 w-5 mr-2 text-gray-500 dark:text-gray-400"}),k("identificationDocuments.form.takePhoto")]}),(0,h.jsx)("button",{type:"button",onClick:async()=>{try{if(V(!0),Y(null),!F&&!T)throw new Error(k("identificationDocuments.form.noDocumentUploaded"));let e=null;if(F?e=await new Promise(((e,t)=>{const r=new FileReader;r.onload=()=>e(r.result),r.onerror=t,r.readAsDataURL(F)})):T&&(e=T),!e)throw new Error(k("identificationDocuments.form.noImageData"));const t=await(async e=>{try{console.log("Starte KI-basierte Dokumentenerkennung..."),e.startsWith("data:image")||(e=e.startsWith("/9j/")?"data:image/jpeg;base64,"+e:e.startsWith("iVBOR")?"data:image/png;base64,"+e:"data:image/jpeg;base64,"+e);const t=localStorage.getItem("token");if(!t)throw new Error("Nicht authentifiziert. Bitte melden Sie sich an.");const r="".concat(o.H$,"/document-recognition");console.log("Verwende API-Endpunkt:",r);const a=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},credentials:"include",mode:"cors",body:JSON.stringify({image:e,documentType:"id_card"})});if(!a.ok){const e=await a.text();throw new Error("API-Anfrage fehlgeschlagen: ".concat(a.status," ").concat(e))}const n=await a.json();return console.log("KI-Ergebnis:",n),n}catch(t){return console.error("Fehler bei der KI-basierten Dokumentenerkennung:",t),{}}})(e);console.log("Erkannte Daten:",t),t.documentType&&w(t.documentType),t.documentNumber&&N(t.documentNumber),t.issueDate&&E(t.issueDate),t.expiryDate&&C(t.expiryDate),t.issuingCountry&&U(t.issuingCountry),t.issuingAuthority&&G(t.issuingAuthority),z(k("identificationDocuments.form.recognitionSuccess"),"success")}catch(e){console.error("Fehler bei der automatischen Erkennung:",e),Y(e.message),z(k("identificationDocuments.form.recognitionError",{error:e.message}),"error")}finally{V(!1)}},disabled:L||!F&&!T,className:"inline-flex items-center px-4 py-2 border rounded-md shadow-sm text-sm font-medium ".concat(L||!F&&!T?"bg-gray-100 dark:bg-gray-800 text-gray-400 dark:text-gray-500 border-gray-300 dark:border-gray-700 cursor-not-allowed":"border-blue-300 dark:border-blue-700 text-blue-700 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 hover:bg-blue-100 dark:hover:bg-blue-900/50"),children:L?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(x.A,{className:"h-5 w-5 mr-2 animate-spin"}),k("identificationDocuments.form.recognitionRunning")]}):k("identificationDocuments.form.autoRecognize")})]}),F&&(0,h.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:k("identificationDocuments.form.selectedFile",{name:F.name})}),T&&(0,h.jsxs)("div",{className:"mt-2",children:[(0,h.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:k("identificationDocuments.form.capturedImage")}),(0,h.jsx)("img",{src:T,alt:k("identificationDocuments.form.capturedDocument"),className:"max-h-40 border dark:border-gray-700 rounded"})]}),K&&(0,h.jsx)("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:k("identificationDocuments.form.recognitionErrorLabel",{error:K})})]}),(0,h.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,h.jsx)("button",{type:"button",onClick:D,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:k("common.cancel"),children:(0,h.jsx)(m.A,{className:"h-5 w-5"})}),(0,h.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",disabled:M,title:k(M?"common.saving":r?"identificationDocuments.form.update":"common.save"),children:M?(0,h.jsx)(x.A,{className:"h-5 w-5 animate-spin"}):(0,h.jsx)(p.A,{className:"h-5 w-5"})})]})]})};var D=r(2672);const k=e=>{let{userId:t,isAdmin:r=!1}=e;const{t:s}=(0,n.Bd)(),[c,d]=(0,a.useState)([]),[u,m]=(0,a.useState)(!0),[g,x]=(0,a.useState)(null),[p,y]=(0,a.useState)(!1),[b,k]=(0,a.useState)(null),[A,w]=(0,a.useState)(null),{showMessage:v}=(0,l.A)(),{user:N}=(0,D.As)(),j=async()=>{m(!0);try{const e=await(async e=>{try{return(await i.Ay.get(o.Sn.IDENTIFICATION_DOCUMENTS.BY_USER(e))).data}catch(g){throw console.error("Fehler beim Abrufen der Identifikationsdokumente:",g),g}})(t);d(e),x(null)}catch(e){x(e.message||s("identificationDocuments.loadError")),v(s("identificationDocuments.loadError"),"error")}finally{m(!1)}};(0,a.useEffect)((()=>{j()}),[t]);const E=async e=>{if(window.confirm(s("identificationDocuments.deleteConfirm")))try{await(async e=>{try{await i.Ay.delete(o.Sn.IDENTIFICATION_DOCUMENTS.BY_ID(e))}catch(g){throw console.error("Fehler beim L\xf6schen des Dokuments:",g),g}})(e),v(s("identificationDocuments.deleteSuccess"),"success"),j()}catch(t){v("".concat(s("identificationDocuments.deleteError"),": ").concat(t.message||"Unbekannter Fehler"),"error")}},I=async e=>{if(N)try{await(async(e,t)=>{try{await i.Ay.post(o.Sn.IDENTIFICATION_DOCUMENTS.VERIFY(e),{adminId:t})}catch(g){throw console.error("Fehler bei der Verifizierung des Dokuments:",g),g}})(e,N.id),v(s("identificationDocuments.verifySuccess"),"success"),j()}catch(t){v("".concat(s("identificationDocuments.verifyError"),": ").concat(t.message||"Unbekannter Fehler"),"error")}else v(s("identificationDocuments.notAuthenticated"),"error")},C=async e=>{w(e);try{const t=(e=>"".concat(window.location.origin,"/api").concat(o.Sn.IDENTIFICATION_DOCUMENTS.DOWNLOAD(e)))(e);window.open(t,"_blank")}catch(t){v("".concat(s("identificationDocuments.downloadError"),": ").concat(t.message||"Unbekannter Fehler"),"error")}finally{w(null)}},S=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("de-DE")}catch(t){return e}};return p?(0,h.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[(0,h.jsx)("h3",{className:"text-lg font-medium mb-4",children:s("identificationDocuments.addDocument")}),(0,h.jsx)(f,{userId:t,onDocumentSaved:()=>{y(!1),j()},onCancel:()=>y(!1)})]}):b?(0,h.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[(0,h.jsx)("h3",{className:"text-lg font-medium mb-4",children:s("identificationDocuments.editDocument")}),(0,h.jsx)(f,{userId:t,document:b,onDocumentSaved:()=>{k(null),j()},onCancel:()=>k(null)})]}):(0,h.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,h.jsx)("h3",{className:"text-lg font-medium",children:s("identificationDocuments.title")}),(0,h.jsx)("button",{onClick:()=>y(!0),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700",children:s("identificationDocuments.newDocument")})]}),u?(0,h.jsx)("div",{className:"flex justify-center items-center p-4",children:(0,h.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-white"})}):g?(0,h.jsx)("div",{className:"text-red-600 p-4",children:g}):0===c.length?(0,h.jsx)("div",{className:"text-gray-500 dark:text-gray-400 p-4",children:s("identificationDocuments.noDocuments")}):(0,h.jsx)("div",{className:"overflow-x-auto",children:(0,h.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,h.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:s("identificationDocuments.columns.type")}),(0,h.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:s("identificationDocuments.columns.number")}),(0,h.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:s("identificationDocuments.columns.country")}),(0,h.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:s("identificationDocuments.columns.validFrom")}),(0,h.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:s("identificationDocuments.columns.validTo")}),(0,h.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:s("identificationDocuments.columns.status")}),(0,h.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:s("identificationDocuments.columns.actions")})]})}),(0,h.jsx)("tbody",{className:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700",children:c.map((e=>{return(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:(t=e.documentType,{passport:s("identificationDocuments.types.passport"),national_id:s("identificationDocuments.types.national_id"),driving_license:s("identificationDocuments.types.driving_license"),residence_permit:s("identificationDocuments.types.residence_permit"),work_permit:s("identificationDocuments.types.work_permit"),tax_id:s("identificationDocuments.types.tax_id"),social_security:s("identificationDocuments.types.social_security")}[t]||t)}),(0,h.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:e.documentNumber}),(0,h.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:e.issuingCountry}),(0,h.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:S(e.issueDate)}),(0,h.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:S(e.expiryDate)}),(0,h.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:e.isVerified?(0,h.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-700 dark:text-green-100",children:s("identificationDocuments.status.verified")}):(0,h.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-700 dark:text-yellow-100",children:s("identificationDocuments.status.pending")})}),(0,h.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-medium",children:(0,h.jsxs)("div",{className:"flex space-x-2",children:[(0,h.jsx)("button",{onClick:()=>C(e.id),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",disabled:A===e.id,children:A===e.id?s("identificationDocuments.actions.downloading"):s("identificationDocuments.actions.view")}),(0,h.jsx)("button",{onClick:()=>k(e),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",children:s("identificationDocuments.actions.edit")}),(0,h.jsx)("button",{onClick:()=>E(e.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:s("identificationDocuments.actions.delete")}),r&&!e.isVerified&&(0,h.jsx)("button",{onClick:()=>I(e.id),className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",children:s("identificationDocuments.actions.verify")})]})})]},e.id);var t}))})]})})]})}}}]);
//# sourceMappingURL=736.8c92b095.chunk.js.map