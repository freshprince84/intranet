"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[692],{4426:(e,r,t)=>{t.d(r,{A:()=>j});var a=t(9379),o=t(5043),l=t(4117),n=t(6582),s=t(7591),i=t(1816),d=t(9422),c=t(3332),u=t(2517),g=t(9626),p=t(2311),h=t(9248),m=t(9938),x=t(1923),f=t(1801),y=t(579);const b=e=>{let{condition:r,onChange:t,onDelete:n,onAdd:s,columns:i,isFirst:d,isLast:b,sortDirection:v,sortPriority:w,onSortDirectionChange:k,onPriorityChange:j,canMoveUp:A=!1,canMoveDown:S=!1}=e;const{t:N}=(0,l.Bd)(),[E,C]=(0,o.useState)([]),[F,D]=(0,o.useState)([]),[T,I]=(0,o.useState)([]),[R,_]=(0,o.useState)([]),[L,q]=(0,o.useState)(!1),[P,B]=(0,o.useState)(!1),[O,z]=(0,o.useState)(!1);(0,o.useEffect)((()=>{C(((e,r)=>{const t=[{value:"equals",label:r("filter.operators.equals")},{value:"contains",label:r("filter.operators.contains")},{value:"startsWith",label:r("filter.operators.startsWith")},{value:"endsWith",label:r("filter.operators.endsWith")}],a=[{value:"equals",label:r("filter.operators.isExactly")},{value:"after",label:r("filter.operators.after")},{value:"before",label:r("filter.operators.before")},{value:"between",label:r("filter.operators.between")}],o=[{value:"equals",label:r("filter.operators.isEqual")},{value:"greaterThan",label:r("filter.operators.greaterThan")},{value:"lessThan",label:r("filter.operators.lessThan")}],l=[{value:"equals",label:r("filter.operators.equals")},{value:"notEquals",label:r("filter.operators.notEquals")}];return"dueDate"===e||"startTime"===e||"checkInDate"===e||"checkOutDate"===e||"arrivalTime"===e?a:"duration"===e||"amount"===e?o:"status"===e||"paymentStatus"===e||"responsible"===e||"qualityControl"===e||"responsibleAndQualityControl"===e?l:t})(r.column,N))}),[r.column,N]),(0,o.useEffect)((()=>{(async()=>{if(localStorage.getItem("token")){if("requestedBy"===r.column||"responsible"===r.column||"qualityControl"===r.column||"responsibleAndQualityControl"===r.column){q(!0);try{const e=await x.A.get("/users/dropdown");D(e.data)}catch(e){console.error("Fehler beim Laden der Benutzer:",e)}finally{q(!1)}i.some((e=>"requestedBy"===e.id||"createTodo"===e.id));const t=i.some((e=>"responsible"===e.id||"qualityControl"===e.id));if(("responsible"===r.column||"responsibleAndQualityControl"===r.column)&&t){B(!0);try{const e=await x.A.get("/roles");I(e.data)}catch(e){console.error("Fehler beim Laden der Rollen:",e)}finally{B(!1)}}}if("branch"===r.column){z(!0);try{const e=await x.A.get(f.Sn.BRANCHES.BASE);_(e.data)}catch(e){console.error("Fehler beim Laden der Branches:",e)}finally{z(!1)}}}})()}),[r.column]);return(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("div",{className:"w-[180px] flex-shrink-0",children:(0,y.jsxs)("select",{className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-xs bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full",value:r.column,onChange:e=>{var o;return t((0,a.A)((0,a.A)({},r),{},{column:e.target.value,operator:(null===(o=E[0])||void 0===o?void 0:o.value)||"equals",value:null}))},children:[(0,y.jsx)("option",{value:"",children:N("filter.row.selectColumn")}),i.map((e=>(0,y.jsx)("option",{value:e.id,children:e.label},e.id)))]})}),(0,y.jsx)("div",{className:"w-[140px] flex-shrink-0",children:(0,y.jsx)("select",{className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-xs bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full",value:r.operator,onChange:e=>t((0,a.A)((0,a.A)({},r),{},{operator:e.target.value})),children:E.map((e=>(0,y.jsx)("option",{value:e.value,children:e.label},e.value)))})}),(0,y.jsx)("div",{className:"flex-1 min-w-0",children:((e,r,t,a)=>{if("status"===e){const e=i.some((e=>"requestedBy"===e.id||"createTodo"===e.id)),r=i.some((e=>"responsible"===e.id||"qualityControl"===e.id)),o=i.some((e=>"client"===e.id))&&!i.some((e=>"responsible"===e.id));return e?(0,y.jsxs)("select",{className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:t||"",onChange:e=>a(e.target.value),children:[(0,y.jsx)("option",{value:"",children:N("filter.row.pleaseSelect")}),(0,y.jsx)("option",{value:"approval",children:N("filter.row.status.approval")}),(0,y.jsx)("option",{value:"approved",children:N("filter.row.status.approved")}),(0,y.jsx)("option",{value:"to_improve",children:N("filter.row.status.to_improve")}),(0,y.jsx)("option",{value:"denied",children:N("filter.row.status.denied")})]}):r?(0,y.jsxs)("select",{className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:t||"",onChange:e=>a(e.target.value),children:[(0,y.jsx)("option",{value:"",children:N("filter.row.pleaseSelect")}),(0,y.jsx)("option",{value:"open",children:N("filter.row.status.open")}),(0,y.jsx)("option",{value:"in_progress",children:N("filter.row.status.in_progress")}),(0,y.jsx)("option",{value:"improval",children:N("filter.row.status.improval")}),(0,y.jsx)("option",{value:"quality_control",children:N("filter.row.status.quality_control")}),(0,y.jsx)("option",{value:"done",children:N("filter.row.status.done")})]}):o?(0,y.jsxs)("select",{className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:t||"",onChange:e=>a(e.target.value),children:[(0,y.jsx)("option",{value:"",children:N("filter.row.pleaseSelect")}),(0,y.jsx)("option",{value:"DRAFT",children:N("filter.row.status.draft")}),(0,y.jsx)("option",{value:"SENT",children:N("filter.row.status.sent")}),(0,y.jsx)("option",{value:"PAID",children:N("filter.row.status.paid")}),(0,y.jsx)("option",{value:"OVERDUE",children:N("filter.row.status.overdue")}),(0,y.jsx)("option",{value:"CANCELLED",children:N("filter.row.status.cancelled")})]}):(0,y.jsxs)("select",{className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:t||"",onChange:e=>a(e.target.value),children:[(0,y.jsx)("option",{value:"",children:N("filter.row.pleaseSelect")}),(0,y.jsx)("option",{value:"open",children:N("filter.row.status.open")}),(0,y.jsx)("option",{value:"in_progress",children:N("filter.row.status.in_progress")}),(0,y.jsx)("option",{value:"done",children:N("filter.row.status.done")})]})}if("requestedBy"===e||"responsible"===e||"responsibleAndQualityControl"===e){i.some((e=>"requestedBy"===e.id||"createTodo"===e.id));const r=i.some((e=>"responsible"===e.id||"qualityControl"===e.id)),o=("responsible"===e||"responsibleAndQualityControl"===e)&&r;return(0,y.jsxs)("select",{className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:t||"",onChange:e=>a(e.target.value),disabled:L||o&&P,children:[(0,y.jsx)("option",{value:"",children:N("filter.row.pleaseSelect")}),F.length>0&&(0,y.jsx)("optgroup",{label:N("filter.row.groups.users"),children:F.map((e=>(0,y.jsxs)("option",{value:"user-".concat(e.id),children:[e.firstName," ",e.lastName]},"user-".concat(e.id))))}),o&&T.length>0&&(0,y.jsx)("optgroup",{label:N("filter.row.groups.roles"),children:T.map((e=>(0,y.jsx)("option",{value:"role-".concat(e.id),children:e.name},"role-".concat(e.id))))}),(L||o&&P)&&(0,y.jsx)("option",{value:"",disabled:!0,children:N("filter.row.loadingData")})]})}if("qualityControl"===e)return(0,y.jsxs)("select",{className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:t||"",onChange:e=>a(e.target.value),disabled:L,children:[(0,y.jsx)("option",{value:"",children:N("filter.row.pleaseSelect")}),F.length>0&&(0,y.jsx)("optgroup",{label:N("filter.row.groups.users"),children:F.map((e=>(0,y.jsxs)("option",{value:"user-".concat(e.id),children:[e.firstName," ",e.lastName]},"user-".concat(e.id))))}),L&&(0,y.jsx)("option",{value:"",disabled:!0,children:N("filter.row.loadingUsers")})]});if("type"===e){if(i.some((e=>"requestedBy"===e.id||"createTodo"===e.id)))return(0,y.jsxs)("select",{className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:t||"",onChange:e=>a(e.target.value),children:[(0,y.jsx)("option",{value:"",children:N("filter.row.pleaseSelect")}),(0,y.jsx)("option",{value:"vacation",children:N("requests.types.vacation")}),(0,y.jsx)("option",{value:"improvement_suggestion",children:N("requests.types.improvement_suggestion")}),(0,y.jsx)("option",{value:"sick_leave",children:N("requests.types.sick_leave")}),(0,y.jsx)("option",{value:"employment_certificate",children:N("requests.types.employment_certificate")}),(0,y.jsx)("option",{value:"other",children:N("requests.types.other")})]})}if("branch"===e)return(0,y.jsxs)("select",{className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:t||"",onChange:e=>a(e.target.value),disabled:O,children:[(0,y.jsx)("option",{value:"",children:N("filter.row.pleaseSelect")}),R.length>0&&R.map((e=>(0,y.jsx)("option",{value:e.name,children:e.name},e.id))),O&&(0,y.jsx)("option",{value:"",disabled:!0,children:N("filter.row.loadingData")})]});if("dueDate"===e||"startTime"===e||"checkInDate"===e||"checkOutDate"===e||"arrivalTime"===e){const e="__TODAY__"===t;return(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("select",{className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-xs bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full",value:e?"variable":"date",onChange:e=>{"variable"===e.target.value?a("__TODAY__"):a("")},children:[(0,y.jsx)("option",{value:"date",children:N("filter.row.selectDate")}),(0,y.jsx)("option",{value:"variable",children:N("filter.row.currentDay")})]}),!e&&(0,y.jsx)("input",{type:"date",className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-xs w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:t||"",onChange:e=>a(e.target.value)}),e&&(0,y.jsxs)("div",{className:"px-2 py-1 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md text-blue-700 dark:text-blue-300 text-xs",children:["\ud83d\udcc5 ",N("filter.row.dynamicDay")]})]})}return(0,y.jsx)("input",{type:"text",className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-xs bg-white dark:bg-gray-800 text-gray-900 dark:text-white w-full",value:t||"",onChange:e=>a(e.target.value),placeholder:N("filter.row.enterValue")})})(r.column,r.operator,r.value,(e=>t((0,a.A)((0,a.A)({},r),{},{value:e}))))}),(0,y.jsx)("div",{className:"w-[60px] flex-shrink-0 flex items-center justify-center",children:""!==r.column&&k&&(0,y.jsxs)("div",{className:"flex items-center gap-1",children:[void 0!==w&&w>0&&(0,y.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[A&&j&&(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),j(w-1)},className:"p-0.5 text-gray-400 dark:text-gray-500 hover:text-blue-600 dark:hover:text-blue-500 rounded transition-colors",children:(0,y.jsx)(c.A,{className:"h-3 w-3"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:N("filter.row.moveUp")})]}),(0,y.jsx)("span",{className:"text-xs font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 px-1.5 py-0.5 rounded min-w-[1.5rem] text-center",children:w}),S&&j&&(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),j(w+1)},className:"p-0.5 text-gray-400 dark:text-gray-500 hover:text-blue-600 dark:hover:text-blue-500 rounded transition-colors",children:(0,y.jsx)(u.A,{className:"h-3 w-3"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:N("filter.row.moveDown")})]})]}),(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation();k("asc"===(v||"asc")?"desc":"asc")},className:"p-1.5 text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-500 rounded-md transition-colors border border-gray-300 dark:border-gray-600 hover:border-blue-500 dark:hover:border-blue-400",children:"asc"===(v||"asc")?(0,y.jsx)(g.A,{className:"h-4 w-4"}):(0,y.jsx)(p.A,{className:"h-4 w-4"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:N("asc"===(v||"asc")?"filter.row.sortAscending":"filter.row.sortDescending")})]})]})}),(0,y.jsxs)("div",{className:"w-[60px] flex-shrink-0 flex gap-1 justify-end",children:[(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{type:"button",onClick:n,className:"p-1 text-gray-500 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-500 rounded-md transition-colors disabled:opacity-30 disabled:cursor-not-allowed",disabled:d&&!b,children:(0,y.jsx)(h.A,{className:"h-4 w-4"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:N("filter.row.removeCondition")})]}),b?(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{type:"button",onClick:s,className:"p-1 text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-500 rounded-md transition-colors",children:(0,y.jsx)(m.A,{className:"h-4 w-4"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:N("filter.row.addCondition")})]}):(0,y.jsx)("div",{className:"w-[28px] flex-shrink-0"})]})]})};var v=t(8662);const w=e=>{let{operator:r,onChange:t}=e;const{t:a}=(0,l.Bd)(),[n,s]=(0,o.useState)(!1),i=(0,o.useRef)(null);(0,o.useEffect)((()=>{const e=e=>{i.current&&!i.current.contains(e.target)&&s(!1)};return n&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[n]);const d=e=>{t(e),s(!1)};return(0,y.jsxs)("div",{className:"flex items-center justify-start my-4 relative pl-[180px]",ref:i,children:[(0,y.jsx)("button",{type:"button",onClick:()=>s(!n),className:"px-0.5 py-0.5 border border-gray-300 dark:border-gray-600 rounded-md text-xs font-medium bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-center flex items-center justify-center gap-1",style:{width:"42px",minWidth:"42px",maxWidth:"42px",overflow:"hidden"},children:"AND"===r?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(v.A,{className:"h-3 w-3 flex-shrink-0"}),(0,y.jsx)("span",{className:"truncate",children:a("filter.logicalOperators.and")})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("span",{className:"text-xs",children:"\u2228"}),(0,y.jsx)("span",{className:"truncate",children:a("filter.logicalOperators.or")})]})}),n&&(0,y.jsxs)("div",{className:"absolute top-full left-0 mt-1 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-50 min-w-[42px]",children:[(0,y.jsxs)("button",{type:"button",onClick:()=>d("AND"),className:"w-full px-2 py-1 text-xs text-left hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-1.5 ".concat("AND"===r?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-300"),children:[(0,y.jsx)(v.A,{className:"h-3 w-3 flex-shrink-0"}),(0,y.jsx)("span",{children:a("filter.logicalOperators.and")})]}),(0,y.jsxs)("button",{type:"button",onClick:()=>d("OR"),className:"w-full px-2 py-1 text-xs text-left hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-1.5 ".concat("OR"===r?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-300"),children:[(0,y.jsx)("span",{className:"text-xs",children:"\u2228"}),(0,y.jsx)("span",{children:a("filter.logicalOperators.or")})]})]})]})};var k=t(7855);const j=e=>{let{columns:r,onApply:t,onReset:c,savedConditions:u,savedOperators:g,savedSortDirections:p,onSortDirectionsChange:h,tableId:m}=e;const{t:v}=(0,l.Bd)(),{showMessage:j}=(0,k.A)(),[A,S]=(0,o.useState)(u&&u.length>0?u:[{column:"",operator:"equals",value:null}]),[N,E]=(0,o.useState)(g&&g.length>0?g:[]),[C,F]=(0,o.useState)((()=>p?Array.isArray(p)?p:(console.warn("sortDirections ist kein Array:",p),[]):[])),[D,T]=(0,o.useState)(!1),[I,R]=(0,o.useState)(""),[_,L]=(0,o.useState)([]);(0,o.useEffect)((()=>{(async()=>{try{if(!localStorage.getItem("token"))return;const e=await x.A.get(f.Sn.SAVED_FILTERS.BY_TABLE(m));L(e.data.map((e=>({id:e.id,name:e.name}))))}catch(e){console.error(v("filter.loadError"),e)}})()}),[m]);const q=(0,o.useRef)(u),P=(0,o.useRef)(g),B=(0,o.useRef)(p);(0,o.useEffect)((()=>{const e=JSON.stringify(q.current)!==JSON.stringify(u),r=JSON.stringify(P.current)!==JSON.stringify(g),t=JSON.stringify(B.current)!==JSON.stringify(p);if(e&&u&&(u.length>0?S(u):0===u.length&&S([{column:"",operator:"equals",value:null}]),q.current=u),r&&void 0!==g&&(E(g),P.current=g),t&&void 0!==p){const e=Array.isArray(p)?p:[];F(e),B.current=e}}),[u,g,p]);const O=e=>e.sort(((e,r)=>e.priority-r.priority)).map(((e,r)=>(0,a.A)((0,a.A)({},e),{},{priority:r+1}))),z=e=>{if(Array.isArray(C))return C.find((r=>r.conditionIndex===e));console.warn("sortDirections ist kein Array in getSortDirectionForIndex:",C)},V=()=>{S([...A,{column:"",operator:"equals",value:null}]),A.length>0&&E([...N,"AND"])};return(0,y.jsxs)("div",{className:"mt-4 p-4 bg-white dark:bg-gray-800 rounded-lg",children:[(0,y.jsx)("h3",{className:"text-base font-medium text-gray-700 dark:text-gray-200 mb-3",children:v("filter.title")}),(0,y.jsx)("div",{className:"space-y-2",children:A.map(((e,t)=>(0,y.jsxs)(o.Fragment,{children:[(0,y.jsx)(b,{condition:e,onChange:e=>((e,r)=>{const t=[...A],a=t[e];if(t[e]=r,S(t),a.column!==r.column){let t=[...Array.isArray(C)?C:[]];if(a.column){const r=t.findIndex((r=>r.conditionIndex===e));r>=0&&t.splice(r,1)}if(r.column&&""!==r.column&&!t.find((r=>r.conditionIndex===e))){const a=t.length>0?Math.max(...t.map((e=>e.priority))):0;t.push({column:r.column,direction:"asc",priority:a+1,conditionIndex:e})}t=O(t),F(t),h&&h(t)}})(t,e),onDelete:()=>(e=>{const r=[...A];if(r.splice(e,1),S(r),e>0){const r=[...N];r.splice(e-1,1),E(r)}let t=(Array.isArray(C)?C:[]).filter((r=>r.conditionIndex!==e)).map((r=>r.conditionIndex>e?(0,a.A)((0,a.A)({},r),{},{conditionIndex:r.conditionIndex-1}):r));t=O(t),F(t),h&&h(t)})(t),onAdd:V,columns:r,isFirst:0===t,isLast:t===A.length-1,sortDirection:(()=>{const e=z(t);return e?e.direction:void 0})(),sortPriority:(()=>{const e=z(t);return e?e.priority:void 0})(),onSortDirectionChange:e.column&&""!==e.column?e=>{((e,r)=>{const t=A[e];if(t&&t.column){let o=[...Array.isArray(C)?C:[]];const l=o.findIndex((r=>r.conditionIndex===e));if(l>=0)o[l]=(0,a.A)((0,a.A)({},o[l]),{},{direction:r});else{const a=o.length>0?Math.max(...o.map((e=>e.priority))):0;o.push({column:t.column,direction:r,priority:a+1,conditionIndex:e}),o=O(o)}F(o),h&&h(o)}})(t,e)}:void 0,onPriorityChange:(()=>{if(z(t))return e=>((e,r)=>{const t=A[e];if(t&&t.column){let t=[...Array.isArray(C)?C:[]];const a=t.findIndex((r=>r.conditionIndex===e));if(a>=0){const e=t[a].priority,o=t.findIndex((e=>e.priority===r));o>=0&&(t[o].priority=e),t[a].priority=r,t=O(t),F(t),h&&h(t)}}})(t,e)})(),canMoveUp:(()=>{const e=z(t);return!!(e&&e.priority>1)})(),canMoveDown:(()=>{const e=z(t);if(e){const r=Array.isArray(C)?C:[],t=r.length>0?Math.max(...r.map((e=>e.priority))):0;return e.priority<t}return!1})()}),t<A.length-1&&(0,y.jsx)(w,{operator:N[t]||"AND",onChange:e=>((e,r)=>{const t=[...N];t[e]=r,E(t)})(t,e)})]},t)))}),D?(0,y.jsxs)("div",{className:"mt-4 flex gap-2 items-center",children:[(0,y.jsx)("input",{type:"text",className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white flex-grow",placeholder:v("filter.filterName"),value:I,onChange:e=>R(e.target.value)}),(0,y.jsx)("button",{onClick:async()=>{if(!I.trim())return void j(v("filter.noName"),"error");if("Archiv"===I||"Aktuell"===I)return void j(v("filter.reservedNames"),"error");if(_.some((e=>("Archiv"===e.name||"Aktuell"===e.name)&&e.name===I)))return void j(v("filter.cannotOverwriteStandard"),"error");const e=A.filter((e=>""!==e.column));if(0!==e.length)try{if(!localStorage.getItem("token"))return void j(v("filter.notAuthenticated"),"error");await x.A.post(f.Sn.SAVED_FILTERS.BASE,{tableId:m,name:I,conditions:e,operators:N,sortDirections:C});j(v("filter.saveSuccess"),"success"),T(!1),R(""),window.refreshSavedFilters&&window.refreshSavedFilters()}catch(r){console.error("Fehler beim Speichern des Filters:",r),j(v("filter.saveError"),"error")}else j(v("filter.noConditions"),"error")},className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors",title:v("filter.saveFilter"),children:(0,y.jsx)(n.A,{className:"h-5 w-5"})}),(0,y.jsx)("button",{onClick:()=>T(!1),className:"p-2 bg-white text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700 transition-colors",title:v("filter.cancel"),children:(0,y.jsx)(s.A,{className:"h-5 w-5"})})]}):(0,y.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,y.jsx)("button",{onClick:()=>{S([{column:"",operator:"equals",value:null}]),E([]),F([]),h&&h([]),c()},className:"p-2 bg-white text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700 transition-colors",title:v("filter.reset"),children:(0,y.jsx)(i.A,{className:"h-5 w-5"})}),(0,y.jsx)("button",{onClick:()=>T(!0),className:"p-2 bg-white text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700 transition-colors",title:v("filter.save"),children:(0,y.jsx)(n.A,{className:"h-5 w-5"})}),(0,y.jsx)("button",{onClick:()=>{const e=A.filter((e=>""!==e.column));t(e,N)},className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors",title:v("filter.apply"),children:(0,y.jsx)(d.A,{className:"h-5 w-5"})})]})]})}},7829:(e,r,t)=>{t.d(r,{A:()=>h});var a=t(5043),o=t(4117),l=t(2517),n=t(9422),s=t(7591),i=t(2811),d=t(9248),c=t(1923),u=t(1801),g=t(7855),p=t(579);const h=e=>{let{tableId:r,onSelectFilter:t,onReset:h,activeFilterName:m,selectedFilterId:x,onFilterChange:f,defaultFilterName:y="Heute"}=e;const{t:b}=(0,o.Bd)(),{showMessage:v}=(0,g.A)(),w=e=>"Archiv"===e||"tasks.filters.archive"===e||"requests.filters.archiv"===e?b("worktracker-todos"===r?"tasks.filters.archive":"requests.filters.archiv"):"Aktuell"===e||"tasks.filters.current"===e||"requests.filters.aktuell"===e?b("worktracker-todos"===r?"tasks.filters.current":"requests.filters.aktuell"):"Heute"===e||"Hoy"===e?b("common.today","Heute"):"Woche"===e?b("common.week","Woche"):"Aktive"===e?b("common.active","Aktive"):"Alle"===e?b("common.all","Alle"):e,[k,j]=(0,a.useState)([]),[A,S]=(0,a.useState)([]),[N,E]=(0,a.useState)(!0),[C,F]=(0,a.useState)(null),[D,T]=(0,a.useState)([]),I=(0,a.useRef)(!1),R=(0,a.useRef)(null),_=(0,a.useRef)(new Map),[L,q]=(0,a.useState)(4),[P,B]=(0,a.useState)(0),[O,z]=(0,a.useState)(new Map),[V,G]=(0,a.useState)(!0),M=(0,a.useRef)(null),[U,W]=(0,a.useState)(!1),[H,Y]=(0,a.useState)(null),[J,Q]=(0,a.useState)(null),[K,X]=(0,a.useState)(null),[Z,$]=(0,a.useState)(new Set),[ee,re]=(0,a.useState)(null),[te,ae]=(0,a.useState)(""),oe=(0,a.useCallback)((async()=>{try{const[e,t]=await Promise.all([c.A.get(u.Sn.SAVED_FILTERS.BY_TABLE(r)),c.A.get(u.Sn.SAVED_FILTERS.GROUPS.BY_TABLE(r))]),a=Array.isArray(e.data)?e.data.filter((e=>null!=e)):[],o=Array.isArray(t.data)?t.data.filter((e=>null!=e)):[];j(a),S(o)}catch(C){console.error("Fehler beim Neuladen der Filter:",C)}}),[r]),le=(0,a.useCallback)((async e=>{try{const t=await c.A.get(u.Sn.SAVED_FILTERS.BY_TABLE(r)),a=t.data.filter((r=>e.includes(r.name)));if(a.length>5){const e=a.sort(((e,r)=>new Date(e.createdAt).getTime()-new Date(r.createdAt).getTime())).slice(0,a.length-5);for(const r of e)await c.A.delete(u.Sn.SAVED_FILTERS.BY_ID(r.id));await oe()}}catch(C){console.error("Fehler beim Bereinigen der Client-Filter:",C)}}),[r,oe]),ne=(0,a.useCallback)((async()=>{if("consultations-table"===r)try{console.log("\ud83d\udd04 SavedFilterTags: Loading recent clients...");const e=(await c.A.get(u.Sn.CLIENTS.RECENT)).data.map((e=>e.name));console.log("\ud83d\udccb SavedFilterTags: Recent client names:",e),T(e),await le(e)}catch(C){console.error("\u274c SavedFilterTags: Error loading recent clients:",C)}}),[r,le]);(0,a.useEffect)((()=>{const e=()=>{console.log("\ud83d\udd14 SavedFilterTags: Received consultationChanged event"),ne()};return window.addEventListener("consultationChanged",e),()=>{window.removeEventListener("consultationChanged",e)}}),[ne]),(0,a.useEffect)((()=>{ne()}),[ne]),(0,a.useEffect)((()=>{I.current=!1;(async()=>{try{E(!0);if(!localStorage.getItem("token"))return void F("Nicht authentifiziert");const[e,a]=await Promise.all([c.A.get(u.Sn.SAVED_FILTERS.BY_TABLE(r)),c.A.get(u.Sn.SAVED_FILTERS.GROUPS.BY_TABLE(r))]),o=Array.isArray(e.data)?e.data.filter((e=>null!=e)):[],l=Array.isArray(a.data)?a.data.filter((e=>null!=e)):[];if(j(o),S(l),y&&!m&&!x&&!I.current){const e=o.find((e=>!(!e||!e.name)&&(e.name===y||("Aktuell"===y&&("tasks.filters.current"===e.name||"requests.filters.aktuell"===e.name)||"Hoy"===y&&("Heute"===e.name||"common.today"===e.name)))));if(e){I.current=!0;const r=Array.isArray(e.sortDirections)?e.sortDirections:[];f?f(e.name,e.id,e.conditions,e.operators,r):t(e.conditions,e.operators,r)}else 0;!e&&y&&f&&f("",null,[],[],void 0)}}catch(e){console.error("Fehler beim Laden der gespeicherten Filter:",e),F("Fehler beim Laden der gespeicherten Filter")}finally{E(!1)}})()}),[r]),(0,a.useEffect)((()=>()=>{j([]),S([])}),[]),(0,a.useEffect)((()=>(window.refreshSavedFilters=oe,()=>{delete window.refreshSavedFilters})),[oe]),(0,a.useEffect)((()=>{const e=e=>{U&&!e.target.closest(".relative")&&W(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[U]);const se=e=>{var r,a,o;console.log("\ud83d\udd04 SavedFilterTags: handleSelectFilter called",{filterName:e.name,filterId:e.id,conditionsCount:(null===(r=e.conditions)||void 0===r?void 0:r.length)||0,operatorsCount:(null===(a=e.operators)||void 0===a?void 0:a.length)||0,sortDirectionsCount:(null===(o=e.sortDirections)||void 0===o?void 0:o.length)||0,hasOnFilterChange:!!f});const l=Array.isArray(e.sortDirections)?e.sortDirections:[];f?(console.log("\ud83d\udccb SavedFilterTags: Calling onFilterChange (controlled)"),f(e.name,e.id,e.conditions,e.operators,l)):(console.log("\ud83d\udccb SavedFilterTags: Calling onSelectFilter (uncontrolled)"),t(e.conditions,e.operators,l))},ie=async(e,r)=>{e.stopPropagation();const t=k.find((e=>e.id===r));if(t&&de(t.name))v(b("filter.cannotDeleteStandard",{defaultValue:"Standard-Filter k\xf6nnen nicht gel\xf6scht werden"}),"error");else try{if(!localStorage.getItem("token"))return void F("Nicht authentifiziert");await c.A.delete(u.Sn.SAVED_FILTERS.BY_ID(r)),j(k.filter((e=>e.id!==r))),(x===r||!f&&r)&&(f?f("",null,[],[],[]):h()),v(b("filter.deleteSuccess",{defaultValue:"Filter erfolgreich gel\xf6scht"}),"success")}catch(a){console.error("Fehler beim L\xf6schen des Filters:",a),v(b("filter.deleteError",{defaultValue:"Fehler beim L\xf6schen des Filters"}),"error")}},de=e=>{if(["Archiv","Aktuell","Aktive","Alle","Heute","Woche","Hoy","tasks.filters.archive","tasks.filters.current","requests.filters.archiv","requests.filters.aktuell"].includes(e))return!0;if("consultations-table"===r){if("Archiv"===e||"Heute"===e||"Woche"===e)return!0;if(D.includes(e))return!0}return!1},ce=(0,a.useMemo)((()=>{const e=k.filter((e=>null!=e&&!e.groupId));if("consultations-table"===r){console.log("\ud83d\udd27 SavedFilterTags: Sorting filters..."),console.log("\ud83d\udccb SavedFilterTags: recentClientNames:",D),console.log("\ud83d\uddc2\ufe0f SavedFilterTags: savedFilters:",e.map((e=>e.name)));const r=e.find((e=>null!=e&&"Heute"===e.name)),t=e.find((e=>null!=e&&"Woche"===e.name)),a=e.find((e=>null!=e&&"Archiv"===e.name)),o=D.map((r=>e.find((e=>null!=e&&e.name===r)))).filter((e=>null!=e));console.log("\u2705 SavedFilterTags: sortedRecentClientFilters:",o.map((e=>e.name)));const l=e.filter((e=>null!=e&&!["Heute","Woche","Archiv"].includes(e.name)&&!D.includes(e.name)));console.log("\ud83d\udd27 SavedFilterTags: customFilters:",l.map((e=>e.name)));const n=[];return r&&n.push(r),t&&n.push(t),n.push(...o),n.push(...l),a&&n.push(a),console.log("\ud83c\udfaf SavedFilterTags: Final filter order:",n.map((e=>e.name))),n}if("requests-table"===r||"worktracker-todos"===r){const r=e.find((e=>null!=e&&"Aktuell"===e.name)),t=e.find((e=>null!=e&&"Archiv"===e.name)),a=e.filter((e=>null!=e&&"Aktuell"!==e.name&&"Archiv"!==e.name)),o=[];return r&&o.push(r),o.push(...a),t&&o.push(t),o}return e}),[k,D,r]),ue=0===k.length&&N,ge=(0,a.useMemo)((()=>ue?Array(3).fill(null).map(((e,t)=>({id:"placeholder-".concat(t),name:0===t?"Heute":1===t?"Woche":"\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588",isPlaceholder:!0,tableId:r,conditions:[],operators:[]}))):[]),[ue,r]),pe=ue?ge:ce.filter((e=>null!=e)),he=ue?ge.length:V?ce.length:L,me=(0,a.useMemo)((()=>{if(0===ce.length)return 75;if(O.size>0){const e=Array.from(O.values());return e.reduce(((e,r)=>e+r),0)/e.length}return ce.filter((e=>null!=e)).reduce(((e,r)=>{const t=de(r.name)?0:18;return e+(4.5*r.name.length+24+t)}),0)/ce.filter((e=>null!=e)).length}),[ce,O]),xe=(0,a.useCallback)((()=>{if(!R.current||0===ce.length)return;if(V)return;const e=R.current.clientWidth;if(Math.abs(e-P)<10&&P>0)return;B(e);const r=e-4;let t=0,a=0;if(ce.forEach((e=>{const r=O.get(e.id);r&&(t+=r+6,a++)})),a===ce.length&&t>0){const e=t-6;if(e<=r)return void q(ce.length);const a=r-60-6;if(e<=a)return void q(ce.length);let o=0,l=0;for(const r of ce){const e=O.get(r.id)||me;if(!(o+e+6<=a))break;o+=e+6,l++}return void q(Math.max(1,l))}if(Math.max(1,Math.floor(r/(me+6)))>=ce.length)q(ce.length);else{const e=r-60-6,t=Math.max(1,Math.floor(e/(me+6)));t>=ce.length?q(ce.length):q(Math.max(1,t))}}),[ce,me,P,V,O]),fe=(0,a.useCallback)((()=>{M.current&&clearTimeout(M.current),M.current=setTimeout((()=>{xe()}),100)}),[xe]);(0,a.useEffect)((()=>{if(!R.current)return;const e=new ResizeObserver(fe);return e.observe(R.current),window.addEventListener("resize",fe),()=>{e.disconnect(),window.removeEventListener("resize",fe),M.current&&clearTimeout(M.current)}}),[fe]),(0,a.useLayoutEffect)((()=>{if(0===ce.length)return;const e=new Map;let r=!1;const t=V?ce.length:Math.min(L+5,ce.length);if(ce.slice(0,t).forEach((t=>{const a=_.current.get(t.id);if(a){const o=a.offsetWidth;o>0&&(e.set(t.id,o),r=!0)}})),r){const r=V;setTimeout((()=>{z(e),r&&(G(!1),setTimeout((()=>{R.current&&xe()}),0))}),0)}}),[ce,L,V,xe]),(0,a.useLayoutEffect)((()=>{V||xe()}),[xe,V]),(0,a.useEffect)((()=>{ce.length>0&&(G(!0),z(new Map))}),[ce.length]);const ye=(0,a.useMemo)((()=>[...A].sort(((e,r)=>e.order-r.order))),[A]),be=(e,r,t)=>{e.preventDefault(),e.dataTransfer.dropEffect="move","filter"===t?Q(r):X(r)},ve=()=>{Y(null),Q(null),X(null)},we=async(e,t,a)=>{if(e.preventDefault(),H)if("filter"!==a||H!==t)try{if("group"===a)await c.A.post(u.Sn.SAVED_FILTERS.GROUPS.ADD_FILTER(H,t)),v(b("filter.addToGroupSuccess",{defaultValue:"Filter zur Gruppe hinzugef\xfcgt"}),"success");else{const e=k.find((e=>e.id===t));if(!e)return void ve();if(e.groupId)await c.A.post(u.Sn.SAVED_FILTERS.GROUPS.ADD_FILTER(H,e.groupId)),v(b("filter.addToGroupSuccess",{defaultValue:"Filter zur Gruppe hinzugef\xfcgt"}),"success");else{const t="Gruppe ".concat(A.length+1),a=(await c.A.post(u.Sn.SAVED_FILTERS.GROUPS.CREATE,{tableId:r,name:t})).data;await Promise.all([c.A.post(u.Sn.SAVED_FILTERS.GROUPS.ADD_FILTER(H,a.id)),c.A.post(u.Sn.SAVED_FILTERS.GROUPS.ADD_FILTER(e.id,a.id))]),v(b("filter.createGroupSuccess",{defaultValue:"Gruppe erstellt"}),"success")}}await oe()}catch(o){console.error("Fehler beim Gruppieren der Filter:",o),v(b("filter.groupError",{defaultValue:"Fehler beim Gruppieren der Filter"}),"error")}finally{ve()}else ve()},ke=e=>{$((r=>{const t=new Set(r);return t.has(e)?t.delete(e):t.add(e),t}))},je=()=>{re(null),ae("")},Ae=async e=>{if(te.trim())try{await c.A.put(u.Sn.SAVED_FILTERS.GROUPS.UPDATE(e),{name:te.trim()}),v(b("filter.renameGroupSuccess",{defaultValue:"Gruppe umbenannt"}),"success"),await oe(),re(null),ae("")}catch(a){var r,t;console.error("Fehler beim Umbenennen der Gruppe:",a);const e=(null===(r=a.response)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.message)||"Fehler beim Umbenennen der Gruppe";v(e,"error")}else v(b("filter.groupNameRequired",{defaultValue:"Gruppenname darf nicht leer sein"}),"error")},Se=()=>f?x:null;return N?(0,p.jsx)("div",{className:"flex justify-center items-center py-2",children:b("common.loadingFilters")}):C?(0,p.jsx)("div",{className:"text-red-500 py-2",children:C}):0===k.length&&0===A.length?null:(0,p.jsx)("div",{ref:R,className:"flex items-center gap-1.5 sm:gap-2 mb-3 mt-1 overflow-x-auto overflow-y-hidden",children:(0,p.jsxs)("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-1 min-w-0 flex-nowrap",children:[ye.map((e=>{const r=e.filters.find((e=>Se()===e.id)),t="Roles"===(a=e.name)||"Rollen"===a?b("filter.row.groups.roles","Rollen"):"Users"===a||"Benutzer"===a||"Usuarios"===a?b("filter.row.groups.users","Benutzer"):a;var a;const o=r?w(r.name):"".concat(t," (").concat(e.filters.length,")");return(0,p.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,p.jsxs)("div",{className:"relative group",children:[(0,p.jsxs)("button",{onClick:()=>ke(e.id),onDragOver:r=>be(r,e.id,"group"),onDrop:r=>we(r,e.id,"group"),className:"flex items-center px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-xs sm:text-sm font-medium bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300 border border-purple-300 dark:border-purple-700 hover:bg-purple-200 dark:hover:bg-purple-800 transition-colors ".concat(K===e.id?"ring-2 ring-purple-500":""," ").concat(r?"ring-2 ring-purple-500":""),children:[(0,p.jsx)("span",{className:"truncate max-w-[4rem] sm:max-w-[100px]",children:o}),(0,p.jsx)(l.A,{className:"h-3 w-3 sm:h-4 sm:w-4 ml-0.5 sm:ml-1 transition-transform ".concat(Z.has(e.id)?"rotate-180":"")})]}),(0,p.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r?o:"".concat(t," (").concat(e.filters.length,")")})]}),Z.has(e.id)&&(0,p.jsxs)("div",{className:"absolute top-full left-0 mt-1 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-50 min-w-[200px]",children:[e.filters.map((r=>(0,p.jsx)("div",{onClick:()=>{se(r),ke(e.id)},className:"flex items-center justify-between px-3 py-2 text-sm cursor-pointer transition-colors ".concat(Se()===r.id?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"," ").concat(de(r.name)?"font-bold":""),children:(0,p.jsx)("span",{className:"truncate flex-1",children:w(r.name)})},r.id))),(0,p.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 mt-1 pt-1",children:ee===e.id?(0,p.jsxs)("div",{className:"px-3 py-2",children:[(0,p.jsx)("input",{type:"text",value:te,onChange:e=>ae(e.target.value),onKeyDown:r=>{"Enter"===r.key?Ae(e.id):"Escape"===r.key&&je()},className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0,onClick:e=>e.stopPropagation()}),(0,p.jsxs)("div",{className:"flex gap-2 mt-2 justify-end",children:[(0,p.jsxs)("div",{className:"relative group",children:[(0,p.jsx)("button",{onClick:r=>{r.stopPropagation(),Ae(e.id)},className:"p-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:(0,p.jsx)(n.A,{className:"h-4 w-4"})}),(0,p.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Speichern"})]}),(0,p.jsxs)("div",{className:"relative group",children:[(0,p.jsx)("button",{onClick:e=>{e.stopPropagation(),je()},className:"p-2 rounded-md bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-400 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors",children:(0,p.jsx)(s.A,{className:"h-4 w-4"})}),(0,p.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Abbrechen"})]})]})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"relative group",children:[(0,p.jsx)("button",{onClick:r=>{r.stopPropagation(),(e=>{re(e.id),ae(e.name)})(e)},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 w-full text-left transition-colors",children:(0,p.jsx)(i.A,{className:"h-4 w-4"})}),(0,p.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Gruppe umbenennen"})]}),(0,p.jsxs)("div",{className:"relative group",children:[(0,p.jsx)("button",{onClick:r=>{r.stopPropagation(),(async e=>{try{await c.A.delete(u.Sn.SAVED_FILTERS.GROUPS.DELETE(e)),v(b("filter.ungroupSuccess",{defaultValue:"Gruppe aufgel\xf6st"}),"success"),await oe(),$((r=>{const t=new Set(r);return t.delete(e),t}))}catch(r){console.error("Fehler beim Aufl\xf6sen der Gruppe:",r),v(b("filter.ungroupError",{defaultValue:"Fehler beim Aufl\xf6sen der Gruppe"}),"error")}})(e.id)},className:"flex items-center gap-2 px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 w-full text-left transition-colors",children:(0,p.jsx)(d.A,{className:"h-4 w-4"})}),(0,p.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:b("filter.ungroup")})]})]})})]})]},e.id)})),pe.slice(0,he).map((e=>(0,p.jsxs)("div",{ref:r=>{r&&!e.isPlaceholder?_.current.set(e.id,r):r||_.current.delete(e.id)},draggable:!0,onDragStart:r=>((e,r)=>{e.dataTransfer.effectAllowed="move",Y(r)})(r,e.id),onDragOver:r=>be(r,e.id,"filter"),onDrop:r=>we(r,e.id,"filter"),onDragEnd:ve,onClick:()=>!e.isPlaceholder&&se(e),className:"relative group flex items-center px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-xs sm:text-sm font-medium cursor-pointer transition-colors flex-shrink-0 ".concat(e.isPlaceholder?"bg-gray-200 dark:bg-gray-600 text-gray-400 dark:text-gray-500 animate-pulse cursor-default":H===e.id?"opacity-50":J===e.id?"ring-2 ring-blue-500":Se()===e.id?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 border border-blue-300 dark:border-blue-700":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-200 dark:hover:bg-gray-600"," ").concat(!e.isPlaceholder&&de(e.name)?"font-bold":""),children:[(0,p.jsx)("span",{className:"truncate max-w-[4rem] sm:max-w-[100px]",children:e.isPlaceholder&&"\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588"===e.name?(0,p.jsx)("span",{className:"inline-block w-16 h-4 bg-gray-300 dark:bg-gray-500 rounded animate-pulse"}):w(e.name)}),!e.isPlaceholder&&!de(e.name)&&(0,p.jsx)("button",{onClick:r=>ie(r,e.id),className:"ml-1 sm:ml-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 focus:outline-none",children:(0,p.jsx)(s.A,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),(0,p.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e.isPlaceholder?b("common.loading"):w(e.name)})]},e.id))),!ue&&ce.length>L&&(0,p.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,p.jsxs)("div",{className:"relative group",children:[(0,p.jsxs)("button",{onClick:()=>W(!U),className:"inline-flex items-center px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-xs sm:text-sm font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors border border-gray-300 dark:border-gray-600",children:[(0,p.jsxs)("span",{children:["+",ce.length-L]}),(0,p.jsx)(l.A,{className:"h-3 w-3 sm:h-4 sm:w-4 ml-0.5 sm:ml-1 transition-transform ".concat(U?"rotate-180":"")})]}),(0,p.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Weitere Filter anzeigen"})]}),U&&(0,p.jsx)("div",{className:"absolute top-full left-0 mt-1 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-50 min-w-[200px] max-w-[300px]",children:ce.slice(L).map((e=>(0,p.jsxs)("div",{onClick:()=>{se(e),W(!1)},className:"flex items-center justify-between px-3 py-2 text-sm cursor-pointer transition-colors ".concat(Se()===e.id?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"," ").concat(de(e.name)?"font-bold":""),children:[(0,p.jsx)("span",{className:"truncate flex-1",children:w(e.name)}),!de(e.name)&&(0,p.jsx)("button",{onClick:r=>{r.stopPropagation(),ie(r,e.id),W(!1)},className:"ml-2 flex-shrink-0 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 focus:outline-none",children:(0,p.jsx)(s.A,{className:"h-4 w-4"})})]},e.id)))})]})]})})}}}]);
//# sourceMappingURL=692.97c662b8.chunk.js.map