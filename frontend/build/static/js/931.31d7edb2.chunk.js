"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[931],{7931:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Ge});var a=r(5043),s=r(4117),n=r(2760),l=r(7504),i=r(4129),o=r(8153),d=r(7459),c=r(9379),m=r(6443),u=r(542),g=r(8662),x=r(6009),b=r(2704),h=r(6238),p=r(7591),y=r(9422),f=r(7855),k=r(6768),v=r(9743),j=r(1923),w=r(1801),N=r(6287),A=r(4538),S=r(2811),C=r(7012),z=r(7988),R=r(4791),L=r(1816),P=r(2672),E=r(5657),D=r(579);const I=e=>{let{isOpen:t,onClose:r,onCertificateCreated:l,userId:o,userName:d}=e;const{t:c}=(0,s.Bd)(),{user:u}=(0,P.As)(),{isHR:g,isAdmin:x,loading:h}=(0,n.S)(),{openSidepane:k,closeSidepane:v}=(0,E.N)(),{showMessage:N}=(0,f.A)(),[A,S]=(0,a.useState)(window.innerWidth<640),[C,R]=(0,a.useState)(window.innerWidth>1070),[I,F]=(0,a.useState)("data"),[T,_]=(0,a.useState)(!1),[B,O]=(0,a.useState)(null),[U,M]=(0,a.useState)(null),[q,V]=(0,a.useState)((new Date).toISOString().split("T")[0]),[K,G]=(0,a.useState)("employment"),[W,H]=(0,a.useState)(null),[J,Y]=(0,a.useState)(null),[Z,X]=(0,a.useState)(!1),[$,Q]=(0,a.useState)([]),[ee,te]=(0,a.useState)(null),[re,ae]=(0,a.useState)(!1),se=(0,a.useRef)(null);(0,a.useEffect)((()=>{h||g()||x()||(N("Nur HR oder Admin k\xf6nnen Arbeitszeugnisse erstellen","error"),r())}),[g,x,h,r,N]),(0,a.useEffect)((()=>{const e=()=>{S(window.innerWidth<640),R(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(t?(k(),le(),ne()):v(),()=>{v()})),[t,k,v]);const ne=async()=>{try{const e=(await j.A.get(w.Sn.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES)).data.documentTemplates||{},t=[];e.employmentCertificate&&t.push({type:"employmentCertificate",version:e.employmentCertificate.version,path:e.employmentCertificate.path}),Q(t),t.length>0&&(te(t[0].type),ae(!0))}catch(e){console.error("Fehler beim Laden der Templates:",e)}},le=async()=>{try{const[e,t]=await Promise.all([j.A.get(w.Sn.USERS.BY_ID(o)),j.A.get(w.Sn.LIFECYCLE.BY_USER(o))]),r=e.data,a=t.data.lifecycle,s={firstName:r.firstName||"",lastName:r.lastName||"",identificationNumber:r.identificationNumber||null,contractStartDate:(null===a||void 0===a?void 0:a.contractStartDate)||null,contractEndDate:(null===a||void 0===a?void 0:a.contractEndDate)||null,contractType:(null===a||void 0===a?void 0:a.contractType)||null,salary:r.salary||null,position:null};M(s),q&&q!==(new Date).toISOString().split("T")[0]||V((new Date).toISOString().split("T")[0])}catch(e){console.error("Fehler beim Laden der User-Daten:",e),O("Fehler beim Laden der Daten")}};(0,a.useEffect)((()=>()=>{J&&URL.revokeObjectURL(J)}),[J]);return g()||x()?(0,D.jsxs)(m.lG,{open:t,onClose:r,className:"relative z-50",children:[(!C||A)&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-start justify-end p-0 sm:p-0",children:(0,D.jsxs)(m.lG.Panel,{className:"\n            ".concat(A?"w-full h-full":"w-[600px]","\n            ").concat(A?"":"top-16","\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ").concat(A?"rounded-none":"rounded-l-lg","\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n          "),style:{animation:A?"none":"slideIn 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94)"},children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,D.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,D.jsx)(b.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"}),(0,D.jsx)(m.lG.Title,{className:"text-xl font-semibold dark:text-white",children:"Arbeitszeugnis erstellen"})]}),(0,D.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,D.jsx)("div",{className:"mb-4",children:(0,D.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["F\xfcr: ",(0,D.jsx)("span",{className:"font-medium dark:text-white",children:d})]})}),(0,D.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:(0,D.jsxs)("nav",{className:"-mb-px flex space-x-4",children:[(0,D.jsx)("button",{type:"button",onClick:()=>F("data"),className:"".concat("data"===I?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:"Daten"}),(0,D.jsx)("button",{type:"button",onClick:()=>F("text"),className:"".concat("text"===I?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:"PDF hochladen"})]})}),B&&(0,D.jsx)("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4",children:(0,D.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:B})}),"data"===I&&(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4",children:[(0,D.jsx)("h3",{className:"text-sm font-semibold dark:text-white mb-3",children:"Automatisch erkannte Daten"}),(0,D.jsx)("div",{className:"space-y-2 text-sm",children:U&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,D.jsx)(i.A,{className:"h-4 w-4 text-gray-400"}),(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Name:"}),(0,D.jsxs)("span",{className:"dark:text-white",children:[U.firstName," ",U.lastName]})]}),U.identificationNumber&&(0,D.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,D.jsx)(b.A,{className:"h-4 w-4 text-gray-400"}),(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"C\xe9dula:"}),(0,D.jsx)("span",{className:"dark:text-white",children:U.identificationNumber})]}),U.contractStartDate&&(0,D.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,D.jsx)(z.A,{className:"h-4 w-4 text-gray-400"}),(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Eintrittsdatum:"}),(0,D.jsx)("span",{className:"dark:text-white",children:new Date(U.contractStartDate).toLocaleDateString("de-DE")})]}),U.contractEndDate&&(0,D.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,D.jsx)(z.A,{className:"h-4 w-4 text-gray-400"}),(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Austrittsdatum:"}),(0,D.jsx)("span",{className:"dark:text-white",children:new Date(U.contractEndDate).toLocaleDateString("de-DE")})]})]})})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Ausstellungsdatum ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsx)("input",{type:"date",value:q,onChange:e=>{const t=e.target.value;V(t),t&&new Date(t)>new Date?O("Ausstellungsdatum darf nicht in der Zukunft liegen"):O(null)},max:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(B&&q&&new Date(q)>new Date||B&&!q?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),required:!0,"aria-invalid":!(q&&!(q&&new Date(q)>new Date))||void 0,"aria-describedby":!q||q&&new Date(q)>new Date?"issueDate-error":void 0}),B&&(!q||q&&new Date(q)>new Date)&&(0,D.jsx)("p",{id:"issueDate-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:B}),!B&&(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Das Datum darf nicht in der Zukunft liegen"})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Zertifikat-Typ ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsxs)("select",{value:K,onChange:e=>G(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",required:!0,children:[(0,D.jsx)("option",{value:"employment",children:"Arbeitszeugnis"}),(0,D.jsx)("option",{value:"salary",children:"Gehaltsbescheinigung"}),(0,D.jsx)("option",{value:"work_experience",children:"Arbeitsbescheinigung"})]})]})]}),"text"===I&&(0,D.jsxs)("div",{className:"space-y-4",children:[$.length>0&&(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Template verwenden"}),(0,D.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,D.jsx)("input",{type:"checkbox",checked:re,onChange:e=>{ae(e.target.checked),e.target.checked&&W&&(H(null),J&&(URL.revokeObjectURL(J),Y(null)))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,D.jsx)("label",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Template f\xfcr automatische PDF-Generierung verwenden"})]}),re&&(0,D.jsx)("select",{value:ee||"",onChange:e=>te(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4",children:$.map((e=>(0,D.jsxs)("option",{value:e.type,children:["Arbeitszeugnis (Version ",e.version,")"]},e.type)))})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[re?"ODER PDF-Datei hochladen":"PDF-Datei hochladen"," ",!re&&(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center",children:[(0,D.jsx)("input",{ref:se,type:"file",accept:".pdf",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if("application/pdf"!==r.type)return void N("Nur PDF-Dateien sind erlaubt","error");if(r.size>10485760)return void N("Datei ist zu gro\xdf (max. 10MB)","error");H(r),ae(!1);const e=URL.createObjectURL(r);Y(e)}},className:"hidden"}),W?(0,D.jsxs)("div",{children:[(0,D.jsx)(b.A,{className:"mx-auto h-12 w-12 text-green-500 mb-4"}),(0,D.jsx)("p",{className:"text-sm font-medium dark:text-white",children:W.name}),(0,D.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[(W.size/1024/1024).toFixed(2)," MB"]}),(0,D.jsx)("button",{type:"button",onClick:()=>{H(null),J&&(URL.revokeObjectURL(J),Y(null)),se.current&&(se.current.value="")},className:"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",children:"Datei entfernen"})]}):(0,D.jsxs)("div",{children:[(0,D.jsx)(b.A,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,D.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=se.current)||void 0===e?void 0:e.click()},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:"PDF-Datei ausw\xe4hlen"}),(0,D.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"oder Datei hierher ziehen"}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-400 dark:text-gray-500",children:"Max. 10MB"})]})]})]}),J&&(0,D.jsxs)("div",{className:"mt-4",children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"PDF-Vorschau"}),(0,D.jsx)("div",{className:"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50",children:(0,D.jsx)("iframe",{src:"".concat(J,"#view=FitH"),className:"w-full rounded border dark:border-gray-600",style:{height:"400px"},title:"PDF-Vorschau"})})]})]})]}),(0,D.jsxs)("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("button",{type:"button",onClick:r,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:"Abbrechen",children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"button",onClick:async e=>{e.preventDefault();const t=(()=>{if(!re&&!W)return"Bitte w\xe4hlen Sie ein Template oder laden Sie eine PDF-Datei hoch";if(!q)return"Bitte geben Sie ein Ausstellungsdatum an";const e=new Date(q);return isNaN(e.getTime())?"Ung\xfcltiges Ausstellungsdatum":e>new Date?"Ausstellungsdatum darf nicht in der Zukunft liegen":null})();if(t)return O(t),void N(t,"error");_(!0),O(null);try{let e,t=null,a=null;if(re&&ee&&!W){const e=$.find((e=>e.type===ee));e&&(t=e.type,a=e.version)}else{if(!W)return N("Bitte w\xe4hlen Sie ein Template oder laden Sie eine PDF-Datei hoch","error"),void _(!1);e="temp-".concat(Date.now(),"-").concat(W.name)}const s={certificateType:K,issueDate:new Date(q),pdfPath:e,templateUsed:t,templateVersion:a};await j.A.post(w.Sn.LIFECYCLE.CERTIFICATES(o),s),N("Arbeitszeugnis erfolgreich erstellt","success"),l(),r(),J&&(URL.revokeObjectURL(J),Y(null)),H(null),V((new Date).toISOString().split("T")[0]),se.current&&(se.current.value="")}catch(n){var a,s;console.error("Fehler beim Erstellen des Arbeitszeugnisses:",n),O((null===(a=n.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||"Fehler beim Erstellen des Arbeitszeugnisses"),N("Fehler beim Erstellen des Arbeitszeugnisses","error")}finally{_(!1)}},disabled:T||!W&&!re,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:T?"Wird erstellt...":"Erstellen",children:T?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})]})]})})]}):null};var F=r(2683);const T=e=>{let{isOpen:t,onClose:r,onContractCreated:l,userId:o,userName:d}=e;const{t:c}=(0,s.Bd)(),{user:u}=(0,P.As)(),{isHR:g,isAdmin:x,loading:h}=(0,n.S)(),{openSidepane:k,closeSidepane:v}=(0,E.N)(),{showMessage:N}=(0,f.A)(),[A,S]=(0,a.useState)(window.innerWidth<640),[C,z]=(0,a.useState)(window.innerWidth>1070),[R,I]=(0,a.useState)("data"),[T,_]=(0,a.useState)(!1),[B,O]=(0,a.useState)(null),[U,M]=(0,a.useState)(null),[q,V]=(0,a.useState)("employment"),[K,G]=(0,a.useState)((new Date).toISOString().split("T")[0]),[W,H]=(0,a.useState)(""),[J,Y]=(0,a.useState)(""),[Z,X]=(0,a.useState)(""),[$,Q]=(0,a.useState)(""),[ee,te]=(0,a.useState)(null),[re,ae]=(0,a.useState)(null),[se,ne]=(0,a.useState)([]),[le,ie]=(0,a.useState)(null),[oe,de]=(0,a.useState)(!1),ce=(0,a.useRef)(null);(0,a.useEffect)((()=>{h||g()||x()||(N("Nur HR oder Admin k\xf6nnen Arbeitsvertr\xe4ge erstellen","error"),r())}),[g,x,h,r,N]),(0,a.useEffect)((()=>{const e=()=>{S(window.innerWidth<640),z(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(t?(k(),ue(),me()):v(),()=>{v()})),[t,k,v]);const me=async()=>{try{const e=(await j.A.get(w.Sn.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES)).data.documentTemplates||{},t=[];e.employmentContract&&t.push({type:"employmentContract",version:e.employmentContract.version,path:e.employmentContract.path}),ne(t),t.length>0&&(ie(t[0].type),de(!0))}catch(e){console.error("Fehler beim Laden der Templates:",e)}},ue=async()=>{try{const[e,t]=await Promise.all([j.A.get(w.Sn.USERS.BY_ID(o)),j.A.get(w.Sn.LIFECYCLE.BY_USER(o))]),r=e.data,a=t.data.lifecycle,s={firstName:r.firstName||"",lastName:r.lastName||"",identificationNumber:r.identificationNumber||null,contractStartDate:(null===a||void 0===a?void 0:a.contractStartDate)||null,contractEndDate:(null===a||void 0===a?void 0:a.contractEndDate)||null,contractType:(null===a||void 0===a?void 0:a.contractType)||null,salary:r.salary||null,position:null};M(s),s.contractStartDate&&G(new Date(s.contractStartDate).toISOString().split("T")[0]),s.contractEndDate&&H(new Date(s.contractEndDate).toISOString().split("T")[0]),s.salary&&Y(s.salary.toString()),s.contractType&&V(s.contractType)}catch(e){console.error("Fehler beim Laden der User-Daten:",e),O("Fehler beim Laden der Daten")}};(0,a.useEffect)((()=>()=>{re&&URL.revokeObjectURL(re)}),[re]);return g()||x()?(0,D.jsxs)(m.lG,{open:t,onClose:r,className:"relative z-50",children:[(!C||A)&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-start justify-end p-0 sm:p-0",children:(0,D.jsxs)(m.lG.Panel,{className:"\n            ".concat(A?"w-full h-full":"w-[600px]","\n            ").concat(A?"":"top-16","\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ").concat(A?"rounded-none":"rounded-l-lg","\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n          "),children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,D.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,D.jsx)(b.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"}),(0,D.jsx)(m.lG.Title,{className:"text-xl font-semibold dark:text-white",children:"Arbeitsvertrag erstellen"})]}),(0,D.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,D.jsx)("div",{className:"mb-4",children:(0,D.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["F\xfcr: ",(0,D.jsx)("span",{className:"font-medium dark:text-white",children:d})]})}),(0,D.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:(0,D.jsxs)("nav",{className:"-mb-px flex space-x-4",children:[(0,D.jsx)("button",{type:"button",onClick:()=>I("data"),className:"".concat("data"===R?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:"Vertragsdaten"}),(0,D.jsx)("button",{type:"button",onClick:()=>I("text"),className:"".concat("text"===R?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:"PDF hochladen"})]})}),B&&(0,D.jsx)("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4",children:(0,D.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:B})}),"data"===R&&(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4",children:[(0,D.jsx)("h3",{className:"text-sm font-semibold dark:text-white mb-3",children:"Automatisch erkannte Daten"}),(0,D.jsx)("div",{className:"space-y-2 text-sm",children:U&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,D.jsx)(i.A,{className:"h-4 w-4 text-gray-400"}),(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Name:"}),(0,D.jsxs)("span",{className:"dark:text-white",children:[U.firstName," ",U.lastName]})]}),U.identificationNumber&&(0,D.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,D.jsx)(b.A,{className:"h-4 w-4 text-gray-400"}),(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"C\xe9dula:"}),(0,D.jsx)("span",{className:"dark:text-white",children:U.identificationNumber})]})]})})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Vertragstyp ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsxs)("select",{value:q,onChange:e=>V(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,D.jsx)("option",{value:"employment",children:"Arbeitsvertrag"}),(0,D.jsx)("option",{value:"amendment",children:"Vertrags\xe4nderung"}),(0,D.jsx)("option",{value:"extension",children:"Vertragsverl\xe4ngerung"})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Startdatum ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsx)("input",{type:"date",value:K,onChange:e=>{G(e.target.value),O(null)},className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(B&&!K?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),required:!0,"aria-invalid":!K,"aria-describedby":K?void 0:"startDate-error"}),B&&!K&&(0,D.jsx)("p",{id:"startDate-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:B})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Enddatum (optional)"}),(0,D.jsx)("input",{type:"date",value:W,onChange:e=>{H(e.target.value),e.target.value&&K&&new Date(e.target.value)<new Date(K)?O("Enddatum muss nach dem Startdatum liegen"):O(null)},min:K||void 0,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(B&&W&&K&&new Date(W)<new Date(K)?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),"aria-invalid":!!(W&&K&&new Date(W)<new Date(K))||void 0,"aria-describedby":W&&K&&new Date(W)<new Date(K)?"endDate-error":void 0}),B&&W&&K&&new Date(W)<new Date(K)&&(0,D.jsx)("p",{id:"endDate-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:B})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Position"}),(0,D.jsx)("input",{type:"text",value:$,onChange:e=>Q(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"z.B. Frontend-Entwickler"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gehalt (optional)"}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)(F.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,D.jsx)("input",{type:"number",value:J,onChange:e=>{const t=e.target.value;Y(t),t&&parseFloat(t)<0?O("Gehalt darf nicht negativ sein"):O(null)},className:"w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(B&&J&&parseFloat(J)<0?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),placeholder:"0.00",step:"0.01",min:"0","aria-invalid":!!(J&&parseFloat(J)<0)||void 0,"aria-describedby":J&&parseFloat(J)<0?"salary-error":void 0})]}),B&&J&&parseFloat(J)<0&&(0,D.jsx)("p",{id:"salary-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:B})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Arbeitsstunden/Woche (optional)"}),(0,D.jsx)("input",{type:"number",value:Z,onChange:e=>{const t=e.target.value;X(t),t&&(parseFloat(t)<0||parseFloat(t)>168)?O("Arbeitsstunden m\xfcssen zwischen 0 und 168 liegen"):O(null)},className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(B&&Z&&(parseFloat(Z)<0||parseFloat(Z)>168)?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),placeholder:"40",step:"0.1",min:"0",max:"168","aria-invalid":!(!Z||!(parseFloat(Z)<0||parseFloat(Z)>168))||void 0,"aria-describedby":Z&&(parseFloat(Z)<0||parseFloat(Z)>168)?"workingHours-error":void 0}),B&&Z&&(parseFloat(Z)<0||parseFloat(Z)>168)&&(0,D.jsx)("p",{id:"workingHours-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:B}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Maximal 168 Stunden pro Woche (24h \xd7 7 Tage)"})]})]}),"text"===R&&(0,D.jsxs)("div",{className:"space-y-4",children:[se.length>0&&(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Template verwenden"}),(0,D.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,D.jsx)("input",{type:"checkbox",checked:oe,onChange:e=>{de(e.target.checked),e.target.checked&&ee&&(te(null),re&&(URL.revokeObjectURL(re),ae(null)))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,D.jsx)("label",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Template f\xfcr automatische PDF-Generierung verwenden"})]}),oe&&(0,D.jsx)("select",{value:le||"",onChange:e=>ie(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4",children:se.map((e=>(0,D.jsxs)("option",{value:e.type,children:["Arbeitsvertrag (Version ",e.version,")"]},e.type)))})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[oe?"ODER PDF-Datei hochladen":"PDF-Datei hochladen"," ",!oe&&(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center",children:[(0,D.jsx)("input",{ref:ce,type:"file",accept:".pdf",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if("application/pdf"!==r.type)return void N("Nur PDF-Dateien sind erlaubt","error");if(r.size>10485760)return void N("Datei ist zu gro\xdf (max. 10MB)","error");te(r),de(!1);const e=URL.createObjectURL(r);ae(e)}},className:"hidden"}),ee?(0,D.jsxs)("div",{children:[(0,D.jsx)(b.A,{className:"mx-auto h-12 w-12 text-green-500 mb-4"}),(0,D.jsx)("p",{className:"text-sm font-medium dark:text-white",children:ee.name}),(0,D.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[(ee.size/1024/1024).toFixed(2)," MB"]}),(0,D.jsx)("button",{type:"button",onClick:()=>{te(null),re&&(URL.revokeObjectURL(re),ae(null)),ce.current&&(ce.current.value="")},className:"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",children:"Datei entfernen"})]}):(0,D.jsxs)("div",{children:[(0,D.jsx)(b.A,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,D.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=ce.current)||void 0===e?void 0:e.click()},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:"PDF-Datei ausw\xe4hlen"}),(0,D.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"oder Datei hierher ziehen"}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-400 dark:text-gray-500",children:"Max. 10MB"})]})]})]}),re&&(0,D.jsxs)("div",{className:"mt-4",children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"PDF-Vorschau"}),(0,D.jsx)("div",{className:"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50",children:(0,D.jsx)("iframe",{src:"".concat(re,"#view=FitH"),className:"w-full rounded border dark:border-gray-600",style:{height:"400px"},title:"PDF-Vorschau"})})]})]})]}),(0,D.jsxs)("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("button",{type:"button",onClick:r,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:"Abbrechen",children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"button",onClick:async e=>{e.preventDefault();const t=(()=>{if(!oe&&!ee)return"Bitte w\xe4hlen Sie ein Template oder laden Sie eine PDF-Datei hoch";if(!K)return"Bitte geben Sie ein Startdatum an";const e=new Date(K);if(isNaN(e.getTime()))return"Ung\xfcltiges Startdatum";if(W){const t=new Date(W);if(isNaN(t.getTime()))return"Ung\xfcltiges Enddatum";if(t<e)return"Enddatum muss nach dem Startdatum liegen"}return J&&parseFloat(J)<0?"Gehalt darf nicht negativ sein":Z&&(parseFloat(Z)<0||parseFloat(Z)>168)?"Arbeitsstunden m\xfcssen zwischen 0 und 168 liegen":null})();if(t)return O(t),void N(t,"error");_(!0),O(null);try{let e,t=null,a=null;if(oe&&le&&!ee){const e=se.find((e=>e.type===le));e&&(t=e.type,a=e.version)}else{if(!ee)return N("Bitte w\xe4hlen Sie ein Template oder laden Sie eine PDF-Datei hoch","error"),void _(!1);e="temp-".concat(Date.now(),"-").concat(ee.name)}const s={contractType:q,startDate:new Date(K),endDate:W?new Date(W):null,salary:J?parseFloat(J):null,workingHours:Z?parseFloat(Z):null,position:$||null,pdfPath:e,templateUsed:t,templateVersion:a};await j.A.post(w.Sn.LIFECYCLE.CONTRACTS(o),s),N("Arbeitsvertrag erfolgreich erstellt","success"),l(),r(),re&&(URL.revokeObjectURL(re),ae(null)),te(null),G((new Date).toISOString().split("T")[0]),H(""),Y(""),X(""),Q(""),ce.current&&(ce.current.value="")}catch(n){var a,s;console.error("Fehler beim Erstellen des Arbeitsvertrags:",n),O((null===(a=n.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||"Fehler beim Erstellen des Arbeitsvertrags"),N("Fehler beim Erstellen des Arbeitsvertrags","error")}finally{_(!1)}},disabled:T||!ee&&!oe||!K,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:T?"Wird erstellt...":"Erstellen",children:T?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})]})]})})]}):null},_=e=>{let{isOpen:t,onClose:r,onCertificateUpdated:l,userId:i,certificate:o}=e;const{t:d}=(0,s.Bd)(),{isHR:c,isAdmin:u,loading:g}=(0,n.S)(),{openSidepane:x,closeSidepane:h}=(0,E.N)(),{showMessage:k}=(0,f.A)(),[v,N]=(0,a.useState)(window.innerWidth<640),[A,S]=(0,a.useState)(window.innerWidth>1070),[C,z]=(0,a.useState)(!1),[R,P]=(0,a.useState)(null),[I,F]=(0,a.useState)(o.issueDate?new Date(o.issueDate).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0]),[T,_]=(0,a.useState)(o.certificateType||"employment"),[B,O]=(0,a.useState)(null),[U,M]=(0,a.useState)(null),[q,V]=(0,a.useState)(null),K=(0,a.useRef)(null);(0,a.useEffect)((()=>{g||c()||u()||(k("Nur HR oder Admin k\xf6nnen Arbeitszeugnisse bearbeiten","error"),r())}),[c,u,g,r,k]),(0,a.useEffect)((()=>{const e=()=>{N(window.innerWidth<640),S(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(t?(x(),o.id&&V(w.Sn.LIFECYCLE.CERTIFICATE_DOWNLOAD(i,o.id))):h(),()=>{h()})),[t,x,h,o.id,i]),(0,a.useEffect)((()=>()=>{U&&URL.revokeObjectURL(U)}),[U]);const G=async e=>{e.preventDefault(),z(!0),P(null);try{const e={issueDate:new Date(I),certificateType:T};B&&(e.pdfPath="temp-".concat(Date.now(),"-").concat(B.name),e.templateVersion=o.templateVersion||"1.0"),await j.A.put(w.Sn.LIFECYCLE.CERTIFICATE(i,o.id),e),k("Arbeitszeugnis erfolgreich aktualisiert","success"),l(),r(),U&&(URL.revokeObjectURL(U),M(null)),O(null),K.current&&(K.current.value="")}catch(s){var t,a;console.error("Fehler beim Aktualisieren des Arbeitszeugnisses:",s),P((null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Fehler beim Aktualisieren des Arbeitszeugnisses"),k("Fehler beim Aktualisieren des Arbeitszeugnisses","error")}finally{z(!1)}};return c()||u()?(0,D.jsxs)(m.lG,{open:t,onClose:r,className:"relative z-50",children:[(!A||v)&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-start justify-end p-0 sm:p-0",children:(0,D.jsxs)(m.lG.Panel,{className:"\n            ".concat(v?"w-full h-full":"w-[600px]","\n            ").concat(v?"":"top-16","\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ").concat(v?"rounded-none":"rounded-l-lg","\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n          "),children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,D.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,D.jsx)(b.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"}),(0,D.jsx)(m.lG.Title,{className:"text-xl font-semibold dark:text-white",children:"Arbeitszeugnis bearbeiten"})]}),(0,D.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[R&&(0,D.jsx)("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4",children:(0,D.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:R})}),(0,D.jsxs)("form",{onSubmit:G,className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ausstellungsdatum"}),(0,D.jsx)("input",{type:"date",value:I,onChange:e=>{const t=e.target.value;F(t),t&&new Date(t)>new Date?P("Ausstellungsdatum darf nicht in der Zukunft liegen"):P(null)},max:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(R&&I&&new Date(I)>new Date?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),"aria-invalid":!!(I&&new Date(I)>new Date)||void 0,"aria-describedby":I&&new Date(I)>new Date?"issueDate-error":void 0}),R&&I&&new Date(I)>new Date&&(0,D.jsx)("p",{id:"issueDate-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:R}),!R&&(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Das Datum darf nicht in der Zukunft liegen"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Zertifikat-Typ"}),(0,D.jsxs)("select",{value:T,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,D.jsx)("option",{value:"employment",children:"Arbeitszeugnis"}),(0,D.jsx)("option",{value:"salary",children:"Gehaltsbescheinigung"}),(0,D.jsx)("option",{value:"work_experience",children:"Arbeitsbescheinigung"})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"PDF-Datei aktualisieren (optional)"}),(0,D.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center",children:[(0,D.jsx)("input",{ref:K,type:"file",accept:".pdf",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if("application/pdf"!==r.type)return void k("Nur PDF-Dateien sind erlaubt","error");if(r.size>10485760)return void k("Datei ist zu gro\xdf (max. 10MB)","error");O(r);const e=URL.createObjectURL(r);M(e),V(null)}},className:"hidden"}),B?(0,D.jsxs)("div",{children:[(0,D.jsx)(b.A,{className:"mx-auto h-12 w-12 text-green-500 mb-4"}),(0,D.jsx)("p",{className:"text-sm font-medium dark:text-white",children:B.name}),(0,D.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[(B.size/1024/1024).toFixed(2)," MB"]}),(0,D.jsx)("button",{type:"button",onClick:()=>{O(null),U&&(URL.revokeObjectURL(U),M(null)),V(w.Sn.LIFECYCLE.CERTIFICATE_DOWNLOAD(i,o.id)),K.current&&(K.current.value="")},className:"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",children:"Datei entfernen"})]}):(0,D.jsxs)("div",{children:[(0,D.jsx)(b.A,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,D.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=K.current)||void 0===e?void 0:e.click()},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:"Neue PDF-Datei ausw\xe4hlen"}),(0,D.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"oder Datei hierher ziehen"}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-400 dark:text-gray-500",children:"Max. 10MB"})]})]}),(U||q)&&(0,D.jsxs)("div",{className:"mt-4",children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"PDF-Vorschau"}),(0,D.jsx)("div",{className:"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50",children:(0,D.jsx)("iframe",{src:"".concat(U||q).concat(U?"#view=FitH":"?preview=true#view=FitH"),className:"w-full rounded border dark:border-gray-600",style:{height:"400px"},title:"PDF-Vorschau"})})]})]}),(0,D.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4",children:(0,D.jsxs)("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:[(0,D.jsx)("strong",{children:"Hinweis:"})," Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt. Eine neue Version wird erstellt (isLatest = true)."]})})]})]}),(0,D.jsxs)("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("button",{type:"button",onClick:r,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:"Abbrechen",children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"button",onClick:G,disabled:C,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:C?"Wird aktualisiert...":"Aktualisieren",children:C?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})]})]})})]}):null},B=e=>{let{isOpen:t,onClose:r,onContractUpdated:l,userId:i,contract:o}=e;const{t:d}=(0,s.Bd)(),{isHR:c,isAdmin:u,loading:g}=(0,n.S)(),{openSidepane:x,closeSidepane:h}=(0,E.N)(),{showMessage:k}=(0,f.A)(),[v,N]=(0,a.useState)(window.innerWidth<640),[A,S]=(0,a.useState)(window.innerWidth>1070),[C,z]=(0,a.useState)(!1),[R,P]=(0,a.useState)(null),[I,T]=(0,a.useState)(o.contractType||"employment"),[_,B]=(0,a.useState)(o.startDate?new Date(o.startDate).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0]),[O,U]=(0,a.useState)(o.endDate?new Date(o.endDate).toISOString().split("T")[0]:""),[M,q]=(0,a.useState)(o.salary?o.salary.toString():""),[V,K]=(0,a.useState)(o.workingHours?o.workingHours.toString():""),[G,W]=(0,a.useState)(o.position||""),[H,J]=(0,a.useState)(null),[Y,Z]=(0,a.useState)(null),[X,$]=(0,a.useState)(null),Q=(0,a.useRef)(null);(0,a.useEffect)((()=>{g||c()||u()||(k("Nur HR oder Admin k\xf6nnen Arbeitsvertr\xe4ge bearbeiten","error"),r())}),[c,u,g,r,k]),(0,a.useEffect)((()=>{const e=()=>{N(window.innerWidth<640),S(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(t?(x(),o.id&&$(w.Sn.LIFECYCLE.CONTRACT_DOWNLOAD(i,o.id))):h(),()=>{h()})),[t,x,h,o.id,i]),(0,a.useEffect)((()=>()=>{Y&&URL.revokeObjectURL(Y)}),[Y]);const ee=async e=>{if(e.preventDefault(),_){z(!0),P(null);try{const e={contractType:I,startDate:new Date(_),endDate:O?new Date(O):null,salary:M?parseFloat(M):null,workingHours:V?parseFloat(V):null,position:G||null};H&&(e.pdfPath="temp-".concat(Date.now(),"-").concat(H.name),e.templateVersion=o.templateVersion||"1.0"),await j.A.put(w.Sn.LIFECYCLE.CONTRACT(i,o.id),e),k("Arbeitsvertrag erfolgreich aktualisiert","success"),l(),r(),Y&&(URL.revokeObjectURL(Y),Z(null)),J(null),Q.current&&(Q.current.value="")}catch(s){var t,a;console.error("Fehler beim Aktualisieren des Arbeitsvertrags:",s),P((null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Fehler beim Aktualisieren des Arbeitsvertrags"),k("Fehler beim Aktualisieren des Arbeitsvertrags","error")}finally{z(!1)}}else k("Bitte geben Sie ein Startdatum an","error")};return c()||u()?(0,D.jsxs)(m.lG,{open:t,onClose:r,className:"relative z-50",children:[(!A||v)&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-start justify-end p-0 sm:p-0",children:(0,D.jsxs)(m.lG.Panel,{className:"\n            ".concat(v?"w-full h-full":"w-[600px]","\n            ").concat(v?"":"top-16","\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ").concat(v?"rounded-none":"rounded-l-lg","\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n          "),children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,D.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,D.jsx)(b.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"}),(0,D.jsx)(m.lG.Title,{className:"text-xl font-semibold dark:text-white",children:"Arbeitsvertrag bearbeiten"})]}),(0,D.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[R&&(0,D.jsx)("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4",children:(0,D.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:R})}),(0,D.jsxs)("form",{onSubmit:ee,className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Vertragstyp ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsxs)("select",{value:I,onChange:e=>T(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,D.jsx)("option",{value:"employment",children:"Arbeitsvertrag"}),(0,D.jsx)("option",{value:"amendment",children:"Vertrags\xe4nderung"}),(0,D.jsx)("option",{value:"extension",children:"Vertragsverl\xe4ngerung"})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Startdatum ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsx)("input",{type:"date",value:_,onChange:e=>{const t=e.target.value;B(t),O&&t&&new Date(O)<new Date(t)?P("Enddatum muss nach dem Startdatum liegen"):P(null)},className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(R&&!_?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),required:!0,"aria-invalid":!_||void 0,"aria-describedby":_?void 0:"startDate-error"}),R&&!_&&(0,D.jsx)("p",{id:"startDate-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:R})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Enddatum (optional)"}),(0,D.jsx)("input",{type:"date",value:O,onChange:e=>{const t=e.target.value;U(t),t&&_&&new Date(t)<new Date(_)?P("Enddatum muss nach dem Startdatum liegen"):P(null)},min:_||void 0,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(R&&O&&_&&new Date(O)<new Date(_)?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),"aria-invalid":!!(O&&_&&new Date(O)<new Date(_))||void 0,"aria-describedby":O&&_&&new Date(O)<new Date(_)?"endDate-error":void 0}),R&&O&&_&&new Date(O)<new Date(_)&&(0,D.jsx)("p",{id:"endDate-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:R})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Position"}),(0,D.jsx)("input",{type:"text",value:G,onChange:e=>W(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"z.B. Frontend-Entwickler"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Gehalt (optional)"}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)(F.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,D.jsx)("input",{type:"number",value:M,onChange:e=>{const t=e.target.value;q(t),t&&parseFloat(t)<0?P("Gehalt darf nicht negativ sein"):P(null)},className:"w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(R&&M&&parseFloat(M)<0?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),placeholder:"0.00",step:"0.01",min:"0","aria-invalid":!!(M&&parseFloat(M)<0)||void 0,"aria-describedby":M&&parseFloat(M)<0?"salary-error":void 0})]}),R&&M&&parseFloat(M)<0&&(0,D.jsx)("p",{id:"salary-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:R})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Arbeitsstunden/Woche (optional)"}),(0,D.jsx)("input",{type:"number",value:V,onChange:e=>{const t=e.target.value;K(t),t&&(parseFloat(t)<0||parseFloat(t)>168)?P("Arbeitsstunden m\xfcssen zwischen 0 und 168 liegen"):P(null)},className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(R&&V&&(parseFloat(V)<0||parseFloat(V)>168)?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"),placeholder:"40",step:"0.1",min:"0",max:"168","aria-invalid":!(!V||!(parseFloat(V)<0||parseFloat(V)>168))||void 0,"aria-describedby":V&&(parseFloat(V)<0||parseFloat(V)>168)?"workingHours-error":void 0}),R&&V&&(parseFloat(V)<0||parseFloat(V)>168)&&(0,D.jsx)("p",{id:"workingHours-error",className:"mt-1 text-xs text-red-600 dark:text-red-400",children:R}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Maximal 168 Stunden pro Woche (24h \xd7 7 Tage)"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"PDF-Datei aktualisieren (optional)"}),(0,D.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center",children:[(0,D.jsx)("input",{ref:Q,type:"file",accept:".pdf",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if("application/pdf"!==r.type)return void k("Nur PDF-Dateien sind erlaubt","error");if(r.size>10485760)return void k("Datei ist zu gro\xdf (max. 10MB)","error");J(r);const e=URL.createObjectURL(r);Z(e),$(null)}},className:"hidden"}),H?(0,D.jsxs)("div",{children:[(0,D.jsx)(b.A,{className:"mx-auto h-12 w-12 text-green-500 mb-4"}),(0,D.jsx)("p",{className:"text-sm font-medium dark:text-white",children:H.name}),(0,D.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[(H.size/1024/1024).toFixed(2)," MB"]}),(0,D.jsx)("button",{type:"button",onClick:()=>{J(null),Y&&(URL.revokeObjectURL(Y),Z(null)),$(w.Sn.LIFECYCLE.CONTRACT_DOWNLOAD(i,o.id)),Q.current&&(Q.current.value="")},className:"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",children:"Datei entfernen"})]}):(0,D.jsxs)("div",{children:[(0,D.jsx)(b.A,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,D.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=Q.current)||void 0===e?void 0:e.click()},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:"Neue PDF-Datei ausw\xe4hlen"}),(0,D.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"oder Datei hierher ziehen"}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-400 dark:text-gray-500",children:"Max. 10MB"})]})]}),(Y||X)&&(0,D.jsxs)("div",{className:"mt-4",children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"PDF-Vorschau"}),(0,D.jsx)("div",{className:"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50",children:(0,D.jsx)("iframe",{src:"".concat(Y||X).concat(Y?"#view=FitH":"?preview=true#view=FitH"),className:"w-full rounded border dark:border-gray-600",style:{height:"400px"},title:"PDF-Vorschau"})})]})]}),(0,D.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4",children:(0,D.jsxs)("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:[(0,D.jsx)("strong",{children:"Hinweis:"})," Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt. Eine neue Version wird erstellt (isLatest = true)."]})})]})]}),(0,D.jsxs)("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("button",{type:"button",onClick:r,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:"Abbrechen",children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"button",onClick:ee,disabled:C||!_,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:C?"Wird aktualisiert...":"Aktualisieren",children:C?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})]})]})})]}):null};var O=r(7098);const U=e=>{let{userId:t,lifecycleId:r,onUpdate:l}=e;const{t:i}=(0,s.Bd)(),{isLegal:o,isAdmin:d,loading:m}=(0,n.S)(),{showMessage:u}=(0,f.A)(),[g,x]=(0,a.useState)({arl:null,eps:null,pension:null,caja:null}),[h,y]=(0,a.useState)(!0),[k,v]=(0,a.useState)(null),[N,z]=(0,a.useState)({status:"pending",registrationNumber:"",provider:"",registrationDate:"",notes:""}),[R,P]=(0,a.useState)(!1),E=(0,a.useRef)(!1),I=(0,a.useRef)(null),F=(0,a.useCallback)((async()=>{I.current&&I.current.abort();const e=new AbortController;I.current=e,E.current=!0,y(!0);try{const r=["arl","eps","pension","caja"].map((async r=>{if(e.signal.aborted)return{type:r,registration:null};try{return{type:r,registration:(await j.A.get(w.Sn.LIFECYCLE.SOCIAL_SECURITY(t,r),{timeout:5e3,signal:e.signal})).data}}catch(n){var a,s;return"AbortError"===n.name||"CanceledError"===n.name||e.signal.aborted||404===(null===(a=n.response)||void 0===a?void 0:a.status)?{type:r,registration:null}:"ERR_NETWORK"===n.code||"ECONNABORTED"===n.code||null!==(s=n.message)&&void 0!==s&&s.includes("ERR_INSUFFICIENT_RESOURCES")?(console.warn("Network error loading ".concat(r,", treating as not found")),{type:r,registration:null}):(console.error("Error loading ".concat(r,":"),n),{type:r,registration:null})}})),a=await Promise.all(r);if(e.signal.aborted)return;const s={arl:null,eps:null,pension:null,caja:null};a.forEach((e=>{let{type:t,registration:r}=e;r&&(s[t]={id:r.id||0,registrationType:t,registrationNumber:r.number||r.registrationNumber||null,provider:r.provider||null,registrationDate:r.registeredAt||r.registrationDate||null,status:r.status||"pending",notes:r.notes||null,completedAt:r.completedAt||null})})),x(s)}catch(r){if("AbortError"===r.name||"CanceledError"===r.name||e.signal.aborted)return;console.error("Error loading registrations:",r),u(i("socialSecurity.loadError"),"error")}finally{y(!1),E.current=!1}}),[t,i,u]);(0,a.useEffect)((()=>{if(m)return;if((o()||d())&&t&&r){if(!E.current)return F(),()=>{I.current&&I.current.abort(),E.current=!1}}else y(!1)}),[t,r,m]);const T=()=>{v(null),z({status:"pending",registrationNumber:"",provider:"",registrationDate:"",notes:""})},_=async()=>{if(k)if(m)u(i("common.loading",{defaultValue:"Berechtigungen werden geladen..."}),"warning");else if(o()||d()){P(!0);try{await j.A.put(w.Sn.LIFECYCLE.SOCIAL_SECURITY(t,k),{status:N.status,number:N.registrationNumber||void 0,provider:N.provider||void 0,registrationDate:N.registrationDate?new Date(N.registrationDate).toISOString():void 0,notes:N.notes||void 0}),u("Sozialversicherung erfolgreich aktualisiert","success"),v(null),await new Promise((e=>setTimeout(e,200))),await F(),l&&"function"===typeof l&&l()}catch(a){var e,r;console.error("Error updating social security:",a),u((null===(e=a.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||i("socialSecurity.updateError"),"error")}finally{P(!1)}}else u(i("lifecycle.noPermission",{defaultValue:"Keine Berechtigung - nur Legal oder Admin"}),"error")},B=e=>{switch(e){case"registered":return(0,D.jsx)(A.A,{className:"h-5 w-5 text-green-500"});case"pending":return(0,D.jsx)(C.A,{className:"h-5 w-5 text-yellow-500"});case"failed":return(0,D.jsx)(O.A,{className:"h-5 w-5 text-red-500"});case"not_required":return(0,D.jsx)(A.A,{className:"h-5 w-5 text-gray-400"});case"deregistered":return(0,D.jsx)(O.A,{className:"h-5 w-5 text-gray-400"});default:return(0,D.jsx)(C.A,{className:"h-5 w-5 text-gray-400"})}},U=e=>{const t="lifecycle.socialSecurityStatus.".concat(e);return i(t)||e},M=e=>({arl:"ARL (Risiko-Arbeit)",eps:"EPS (Gesundheit)",pension:"Pension",caja:"Caja de Compensaci\xf3n"}[e]);if(m)return(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:(0,D.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,D.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});if(!o()&&!d())return null;if(h)return(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:(0,D.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,D.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});return(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,D.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,D.jsxs)("h3",{className:"text-lg font-semibold dark:text-white flex items-center",children:[(0,D.jsx)(b.A,{className:"h-5 w-5 mr-2"}),i("lifecycle.socialSecurity",{defaultValue:"Sozialversicherungen"})]})}),(0,D.jsx)("div",{className:"space-y-4",children:["arl","eps","pension","caja"].map((e=>{const t=g[e],r=k===e;return(0,D.jsx)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:r?(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsx)("h4",{className:"font-medium dark:text-white uppercase mb-3",children:i("socialSecurity.editType",{type:M(e)})}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("socialSecurity.status")," ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsxs)("select",{value:N.status,onChange:e=>z((0,c.A)((0,c.A)({},N),{},{status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,D.jsx)("option",{value:"not_required",children:"Nicht erforderlich"}),(0,D.jsx)("option",{value:"pending",children:"Ausstehend"}),(0,D.jsx)("option",{value:"registered",children:"Registriert"}),(0,D.jsx)("option",{value:"failed",children:"Fehlgeschlagen"}),(0,D.jsx)("option",{value:"deregistered",children:"Abgemeldet"})]})]}),"registered"===N.status&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("socialSecurity.registrationNumber")}),(0,D.jsx)("input",{type:"text",value:N.registrationNumber,onChange:e=>z((0,c.A)((0,c.A)({},N),{},{registrationNumber:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"z.B. 123456789"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("socialSecurity.provider")}),(0,D.jsx)("input",{type:"text",value:N.provider,onChange:e=>z((0,c.A)((0,c.A)({},N),{},{provider:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"z.B. ARL Sura, EPS Sanitas"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("socialSecurity.registrationDate")}),(0,D.jsx)("input",{type:"date",value:N.registrationDate,onChange:e=>z((0,c.A)((0,c.A)({},N),{},{registrationDate:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("socialSecurity.notes")}),(0,D.jsx)("textarea",{value:N.notes,onChange:e=>z((0,c.A)((0,c.A)({},N),{},{notes:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",rows:3,placeholder:i("socialSecurity.additionalInfo")})]}),(0,D.jsxs)("div",{className:"flex items-center justify-end space-x-3",children:[(0,D.jsx)("button",{onClick:T,disabled:R,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",title:i("common.cancel"),children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{onClick:_,disabled:R,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:i(R?"common.saving":"common.save"),children:R?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(A.A,{className:"h-5 w-5"})})]})]}):(0,D.jsxs)("div",{className:"flex items-start justify-between",children:[(0,D.jsxs)("div",{className:"flex items-start space-x-3 flex-1",children:[B((null===t||void 0===t?void 0:t.status)||"pending"),(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,D.jsx)("h4",{className:"font-medium dark:text-white uppercase",children:M(e)}),(0,D.jsx)("span",{className:"text-sm font-medium dark:text-white",children:U((null===t||void 0===t?void 0:t.status)||"pending")})]}),t&&(0,D.jsxs)("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[t.provider&&(0,D.jsxs)("div",{children:[(0,D.jsxs)("span",{className:"font-medium",children:[i("socialSecurity.provider"),":"]})," ",t.provider]}),t.registrationNumber&&(0,D.jsxs)("div",{children:[(0,D.jsxs)("span",{className:"font-medium",children:[i("socialSecurity.number"),":"]})," ",t.registrationNumber]}),t.registrationDate&&(0,D.jsxs)("div",{children:[(0,D.jsxs)("span",{className:"font-medium",children:[i("socialSecurity.registrationDate"),":"]})," ",new Date(t.registrationDate).toLocaleDateString("de-DE")]}),t.notes&&(0,D.jsxs)("div",{className:"mt-2",children:[(0,D.jsxs)("span",{className:"font-medium",children:[i("socialSecurity.notes"),":"]}),(0,D.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:t.notes})]}),t.completedAt&&(0,D.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:[i("socialSecurity.completedAt")," ",new Date(t.completedAt).toLocaleDateString("de-DE")]})]}),!t&&(0,D.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("socialSecurity.notRegistered")})]})]}),(0,D.jsx)("button",{onClick:()=>(e=>{const t=g[e];z(t?{status:t.status,registrationNumber:t.registrationNumber||"",provider:t.provider||"",registrationDate:t.registrationDate?new Date(t.registrationDate).toISOString().split("T")[0]:"",notes:t.notes||""}:{status:"pending",registrationNumber:"",provider:"",registrationDate:"",notes:""}),v(e)})(e),className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition ml-4",title:i("lifecycle.edit",{defaultValue:"Bearbeiten"}),children:(0,D.jsx)(S.A,{className:"h-5 w-5"})})]})},e)}))})]})};var M=r(9399);const q=e=>{let{isOpen:t,onClose:r,onOffboardingStarted:n,userId:l,userName:i}=e;const{t:o}=(0,s.Bd)(),{openSidepane:d,closeSidepane:u}=(0,E.N)(),{showMessage:g}=(0,f.A)(),[x,b]=(0,a.useState)(window.innerWidth<640),[h,y]=(0,a.useState)(window.innerWidth>1070),[k,v]=(0,a.useState)(!1),[A,S]=(0,a.useState)(null),[C,R]=(0,a.useState)(""),[P,I]=(0,a.useState)(""),[F,T]=(0,a.useState)({});(0,a.useEffect)((()=>{const e=()=>{b(window.innerWidth<640),y(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>{if(t){d();const e=(new Date).toISOString().split("T")[0];R(e),I(""),S(null),T({})}else u();return()=>{u()}}),[t,d,u]);const _=async e=>{if(e.preventDefault(),(()=>{const e={};if(C){const t=new Date(C);(new Date).setHours(0,0,0,0);const r=new Date;r.setFullYear(r.getFullYear()+1),t>r&&(e.exitDate=o("lifecycle.offboarding.exitDateTooFar",{defaultValue:"Austrittsdatum darf nicht mehr als 1 Jahr in der Zukunft liegen"}))}else e.exitDate=o("lifecycle.offboarding.exitDateRequired",{defaultValue:"Austrittsdatum ist erforderlich"});return P&&0!==P.trim().length?P.trim().length<10&&(e.exitReason=o("lifecycle.offboarding.exitReasonTooShort",{defaultValue:"Austrittsgrund muss mindestens 10 Zeichen lang sein"})):e.exitReason=o("lifecycle.offboarding.exitReasonRequired",{defaultValue:"Austrittsgrund ist erforderlich"}),T(e),0===Object.keys(e).length})()){v(!0),S(null);try{await j.A.put(w.Sn.LIFECYCLE.STATUS(l),{status:"offboarding",exitDate:C,exitReason:P.trim()}),g(o("lifecycle.offboarding.started",{defaultValue:"Offboarding erfolgreich gestartet"}),"success"),n(),r()}catch(s){var t,a;console.error("Fehler beim Starten des Offboarding:",s);const e=(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||o("lifecycle.offboarding.startError",{defaultValue:"Fehler beim Starten des Offboarding"});S(e),g(e,"error")}finally{v(!1)}}},B=()=>(0,D.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,D.jsx)("div",{className:"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4",children:(0,D.jsxs)("div",{className:"flex items-start",children:[(0,D.jsx)(M.A,{className:"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5 mr-3 flex-shrink-0"}),(0,D.jsxs)("div",{className:"text-sm text-orange-800 dark:text-orange-200",children:[(0,D.jsx)("p",{className:"font-medium mb-1",children:o("lifecycle.offboarding.warningTitle",{defaultValue:"Wichtiger Hinweis"})}),(0,D.jsx)("p",{children:o("lifecycle.offboarding.warningText",{defaultValue:"Durch das Starten des Offboarding-Prozesses werden automatisch Tasks erstellt. Dieser Vorgang kann nicht r\xfcckg\xe4ngig gemacht werden."})})]})]})}),(0,D.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[(0,D.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:o("lifecycle.offboarding.user",{defaultValue:"Mitarbeiter"})}),(0,D.jsx)("p",{className:"font-medium dark:text-white",children:i})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{htmlFor:"exitDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o("lifecycle.offboarding.exitDate",{defaultValue:"Austrittsdatum"})," *"]}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,D.jsx)(z.A,{className:"h-5 w-5 text-gray-400"})}),(0,D.jsx)("input",{type:"date",id:"exitDate",value:C,onChange:e=>{R(e.target.value),F.exitDate&&T((e=>(0,c.A)((0,c.A)({},e),{},{exitDate:void 0})))},className:"block w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(F.exitDate?"border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500":"border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500"),required:!0})]}),F.exitDate&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:F.exitDate}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:o("lifecycle.offboarding.exitDateHint",{defaultValue:"Das Datum, an dem der Mitarbeiter die Organisation verl\xe4sst"})})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{htmlFor:"exitReason",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o("lifecycle.offboarding.exitReason",{defaultValue:"Austrittsgrund"})," *"]}),(0,D.jsx)("textarea",{id:"exitReason",value:P,onChange:e=>{I(e.target.value),F.exitReason&&T((e=>(0,c.A)((0,c.A)({},e),{},{exitReason:void 0})))},rows:4,className:"block w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ".concat(F.exitReason?"border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500":"border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500"),placeholder:o("lifecycle.offboarding.exitReasonPlaceholder",{defaultValue:"z.B. K\xfcndigung, Vertragsende, etc."}),required:!0}),F.exitReason&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:F.exitReason}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:o("lifecycle.offboarding.exitReasonHint",{defaultValue:"Mindestens 10 Zeichen. Beschreiben Sie den Grund f\xfcr den Austritt."})})]}),A&&(0,D.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3",children:(0,D.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200",children:A})}),(0,D.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,D.jsx)("button",{type:"button",onClick:r,disabled:k,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",title:o("common.cancel",{defaultValue:"Abbrechen"}),children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"submit",disabled:k,className:"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed",title:k?o("common.saving",{defaultValue:"Speichern..."}):o("lifecycle.offboarding.startButton",{defaultValue:"Offboarding starten"}),children:k?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(N.A,{className:"h-5 w-5"})})]})]});return t?x?(0,D.jsxs)(m.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,D.jsxs)(m.lG.Panel,{className:"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,D.jsx)(m.lG.Title,{className:"text-lg font-semibold dark:text-white",children:o("lifecycle.offboarding.startTitle",{defaultValue:"Offboarding starten"})}),(0,D.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsx)("div",{className:"p-4",children:B()})]})})]}):(0,D.jsxs)(D.Fragment,{children:[t&&!h&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:r,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,D.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:o("lifecycle.offboarding.startTitle",{defaultValue:"Offboarding starten"})}),(0,D.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsx)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:B()})]})]}):null},V=e=>{let{isOpen:t,onClose:r,onOffboardingCompleted:n,userId:l,userName:i,offboardingTasks:o}=e;const{t:d}=(0,s.Bd)(),{openSidepane:c,closeSidepane:u}=(0,E.N)(),{showMessage:g}=(0,f.A)(),[x,b]=(0,a.useState)(window.innerWidth<640),[h,y]=(0,a.useState)(window.innerWidth>1070),[k,v]=(0,a.useState)(!1),[N,S]=(0,a.useState)(null),[C,z]=(0,a.useState)(""),R=o.filter((e=>"done"===e.status)),P=o.length>0&&R.length===o.length,I=i.trim().toLowerCase();(0,a.useEffect)((()=>{const e=()=>{b(window.innerWidth<640),y(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(t?(c(),z(""),S(null)):u(),()=>{u()})),[t,c,u]);const F=async e=>{if(e.preventDefault(),C.trim().toLowerCase()===I||(S(d("lifecycle.offboarding.complete.confirmTextMismatch",{defaultValue:"Best\xe4tigungstext stimmt nicht \xfcberein"})),0)){v(!0),S(null);try{await j.A.put(w.Sn.LIFECYCLE.STATUS(l),{status:"archived"}),g(d("lifecycle.offboarding.complete.success",{defaultValue:"Offboarding erfolgreich abgeschlossen"}),"success"),n(),r()}catch(s){var t,a;console.error("Fehler beim Abschlie\xdfen des Offboarding:",s);const e=(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||d("lifecycle.offboarding.complete.error",{defaultValue:"Fehler beim Abschlie\xdfen des Offboarding"});S(e),g(e,"error")}finally{v(!1)}}},T=()=>(0,D.jsxs)("form",{onSubmit:F,className:"space-y-4",children:[(0,D.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-md flex items-center space-x-3",children:[(0,D.jsx)(A.A,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}),(0,D.jsxs)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[d("lifecycle.offboarding.complete.user",{defaultValue:"Mitarbeiter"}),": ",i]})]}),o.length>0&&(0,D.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-md",children:[(0,D.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:d("lifecycle.offboarding.complete.tasksStatus",{defaultValue:"Status der Offboarding-Aufgaben"})}),(0,D.jsx)("div",{className:"space-y-2",children:o.map((e=>{const t="done"===e.status;return(0,D.jsxs)("div",{className:"flex items-center space-x-2 text-sm ".concat(t?"text-green-700 dark:text-green-300":"text-orange-700 dark:text-orange-300"),children:[t?(0,D.jsx)(A.A,{className:"h-4 w-4 flex-shrink-0"}):(0,D.jsx)(M.A,{className:"h-4 w-4 flex-shrink-0"}),(0,D.jsx)("span",{children:e.title}),(0,D.jsx)("span",{className:"ml-auto text-xs",children:"(".concat(t?d("common.done",{defaultValue:"Abgeschlossen"}):d("common.open",{defaultValue:"Offen"}),")")})]},e.id)}))})]}),!P&&o.length>0&&(0,D.jsx)("div",{className:"bg-orange-50 dark:bg-orange-900/20 border-l-4 border-orange-400 p-4",children:(0,D.jsxs)("div",{className:"flex",children:[(0,D.jsx)("div",{className:"flex-shrink-0",children:(0,D.jsx)(M.A,{className:"h-5 w-5 text-orange-400","aria-hidden":"true"})}),(0,D.jsxs)("div",{className:"ml-3",children:[(0,D.jsx)("h3",{className:"text-sm font-medium text-orange-800 dark:text-orange-300",children:d("lifecycle.offboarding.complete.warningTitle",{defaultValue:"Nicht alle Aufgaben abgeschlossen"})}),(0,D.jsx)("div",{className:"mt-2 text-sm text-orange-700 dark:text-orange-200",children:(0,D.jsx)("p",{children:d("lifecycle.offboarding.complete.warningText",{defaultValue:"Es sind noch nicht alle Offboarding-Aufgaben abgeschlossen. Sie k\xf6nnen das Offboarding trotzdem abschlie\xdfen, aber es wird empfohlen, alle Aufgaben zuerst zu erledigen."})})})]})]})}),P&&(0,D.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-400 p-4",children:(0,D.jsxs)("div",{className:"flex",children:[(0,D.jsx)("div",{className:"flex-shrink-0",children:(0,D.jsx)(A.A,{className:"h-5 w-5 text-green-400","aria-hidden":"true"})}),(0,D.jsxs)("div",{className:"ml-3",children:[(0,D.jsx)("h3",{className:"text-sm font-medium text-green-800 dark:text-green-300",children:d("lifecycle.offboarding.complete.allTasksCompleted",{defaultValue:"Alle Aufgaben abgeschlossen"})}),(0,D.jsx)("div",{className:"mt-2 text-sm text-green-700 dark:text-green-200",children:(0,D.jsx)("p",{children:d("lifecycle.offboarding.complete.allTasksCompletedText",{defaultValue:"Alle Offboarding-Aufgaben sind abgeschlossen. Sie k\xf6nnen das Offboarding jetzt abschlie\xdfen."})})})]})]})}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{htmlFor:"confirmText",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[d("lifecycle.offboarding.complete.confirmLabel",{userName:i})||'Best\xe4tigen Sie durch Eingabe des Namens: "'.concat(i,'"')," *"]}),(0,D.jsx)("input",{type:"text",id:"confirmText",value:C,onChange:e=>{z(e.target.value),S(null)},className:"w-full px-3 py-2 border ".concat(N&&N.includes("Best\xe4tigung")?"border-red-500":"border-gray-300"," dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"),placeholder:i,required:!0}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:d("lifecycle.offboarding.complete.confirmHint",{defaultValue:"Geben Sie den vollst\xe4ndigen Namen des Mitarbeiters ein, um das Offboarding abzuschlie\xdfen"})})]}),(0,D.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4",children:(0,D.jsxs)("div",{className:"flex",children:[(0,D.jsx)("div",{className:"flex-shrink-0",children:(0,D.jsx)(M.A,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),(0,D.jsxs)("div",{className:"ml-3",children:[(0,D.jsx)("h3",{className:"text-sm font-medium text-red-800 dark:text-red-300",children:d("lifecycle.offboarding.complete.finalWarningTitle",{defaultValue:"Wichtiger Hinweis"})}),(0,D.jsx)("div",{className:"mt-2 text-sm text-red-700 dark:text-red-200",children:(0,D.jsx)("p",{children:d("lifecycle.offboarding.complete.finalWarningText",{defaultValue:"Durch das Abschlie\xdfen des Offboarding wird der Mitarbeiter archiviert. Dieser Vorgang kann nicht r\xfcckg\xe4ngig gemacht werden."})})})]})]})}),(0,D.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,D.jsx)("button",{type:"button",onClick:r,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:k,title:d("common.cancel",{defaultValue:"Abbrechen"}),children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"submit",className:"p-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed",disabled:k||C.trim().toLowerCase()!==I,title:k?d("common.saving",{defaultValue:"Speichern..."}):d("lifecycle.offboarding.complete.button",{defaultValue:"Offboarding abschlie\xdfen"}),children:k?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(A.A,{className:"h-5 w-5"})})]})]});return t?x?(0,D.jsxs)(m.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,D.jsxs)(m.lG.Panel,{className:"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,D.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700",children:(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsx)(m.lG.Title,{className:"text-lg font-semibold dark:text-white",children:d("lifecycle.offboarding.complete.title",{defaultValue:"Offboarding abschlie\xdfen"})}),(0,D.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]})}),(0,D.jsxs)("div",{className:"p-6",children:[N&&(0,D.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:N}),T()]})]})})]}):(0,D.jsxs)(D.Fragment,{children:[t&&!h&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:r,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,D.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:d("lifecycle.offboarding.complete.title",{defaultValue:"Offboarding abschlie\xdfen"})}),(0,D.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[N&&(0,D.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:N}),T()]})]})]}):null},K=e=>{var t;let{userId:r,userName:l}=e;const{t:o}=(0,s.Bd)(),{isHR:d,isAdmin:c}=(0,n.S)(),{showMessage:m}=(0,f.A)(),[u,x]=(0,a.useState)(null),[p,y]=(0,a.useState)([]),[k,v]=(0,a.useState)([]),[L,P]=(0,a.useState)([]),[E,F]=(0,a.useState)(!0),[O,M]=(0,a.useState)(null),[K,G]=(0,a.useState)(!1),[W,H]=(0,a.useState)(!1),[J,Y]=(0,a.useState)(null),[Z,X]=(0,a.useState)(null),[$,Q]=(0,a.useState)(null),[ee,te]=(0,a.useState)(null),[re,ae]=(0,a.useState)(!1),[se,ne]=(0,a.useState)(!1),[le,ie]=(0,a.useState)(!1),[oe,de]=(0,a.useState)(""),[ce,me]=(0,a.useState)(""),ue=(0,a.useRef)(!1),ge=(0,a.useCallback)((async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!ue.current||e)try{var t,a,s,n,l,i;ue.current=!0,F(!0);const[e,o,d,c]=await Promise.all([j.A.get(w.Sn.LIFECYCLE.BY_USER(r)),j.A.get(w.Sn.LIFECYCLE.CERTIFICATES(r)),j.A.get(w.Sn.LIFECYCLE.CONTRACTS(r)),j.A.get(w.Sn.TASKS.BY_USER(r)).catch((()=>({data:[]})))]);x(e.data),y((null===(t=o.data)||void 0===t?void 0:t.certificates)||[]),v((null===(a=d.data)||void 0===a?void 0:a.contracts)||[]);const m=c.data||[],u=["Crear certificado laboral","Realizar liquidaci\xf3n final","Desafiliar de seguridad social"],g=m.filter((e=>u.includes(e.title)));P(g),"onboarding"===(null===(s=e.data)||void 0===s||null===(n=s.lifecycle)||void 0===n?void 0:n.status)&&100===(null===(l=e.data)||void 0===l||null===(i=l.progress)||void 0===i?void 0:i.percent)&&setTimeout((()=>{ge()}),1e3),M(null)}catch(c){var o,d;console.error("Fehler beim Laden der Lebenszyklus-Daten:",c),M((null===(o=c.response)||void 0===o||null===(d=o.data)||void 0===d?void 0:d.message)||"Fehler beim Laden der Daten"),m("Fehler beim Laden der Daten","error")}finally{F(!1),ue.current=!1}else setTimeout((()=>{ue.current||ge(!0)}),500)}),[r]);(0,a.useEffect)((()=>{ue.current=!1,ge()}),[ge]);const xe=()=>{null!==u&&void 0!==u&&u.lifecycle&&(de(u.lifecycle.contractStartDate?new Date(u.lifecycle.contractStartDate).toISOString().split("T")[0]:""),me(u.lifecycle.contractEndDate?new Date(u.lifecycle.contractEndDate).toISOString().split("T")[0]:""),ie(!0))},be=e=>new Date(e).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric"});if(E)return(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:(0,D.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,D.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});if(O)return(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:(0,D.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4",children:(0,D.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:O})})});if(!u)return(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:(0,D.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:o("lifecycle.noData",{defaultValue:"Keine Lebenszyklus-Daten verf\xfcgbar"})})});(null===(t=u.lifecycle)||void 0===t?void 0:t.socialSecurityRegistrations)||u.socialSecurityRegistrations;const{lifecycle:he,progress:pe}=u;return(0,D.jsxs)("div",{className:"space-y-6",children:[(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsxs)("h3",{className:"text-lg font-semibold dark:text-white flex items-center",children:[(0,D.jsx)(h.A,{className:"h-5 w-5 mr-2"}),o("lifecycle.statusTitle")]}),(0,D.jsxs)("div",{className:"flex items-center space-x-3",children:[function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r={onboarding:{color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300",labelKey:"lifecycle.status.onboarding"},active:{color:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300",labelKey:"lifecycle.status.active"},contract_change:{color:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300",labelKey:"lifecycle.status.contract_change"},offboarding:{color:"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300",labelKey:"lifecycle.status.offboarding"},archived:{color:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",labelKey:"lifecycle.status.archived"}}[e]||{color:"bg-gray-100 text-gray-800",labelKey:e};return(0,D.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(r.color," ").concat(t?"cursor-pointer hover:opacity-80":""),children:o(r.labelKey)||e})}(he.status),(d()||c())&&"active"===he.status&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>ae(!0),className:"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500",children:(0,D.jsx)(N.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.offboarding.startButton",{defaultValue:"Offboarding starten"})})]}),(d()||c())&&"offboarding"===he.status&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>ne(!0),className:"p-2 bg-red-600 dark:bg-red-700 text-white rounded-md hover:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:(0,D.jsx)(A.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.offboarding.complete.button",{defaultValue:"Offboarding abschlie\xdfen"})})]})]})]}),(0,D.jsxs)("div",{className:"space-y-2 text-sm",children:[he.onboardingStartedAt&&(0,D.jsxs)("div",{className:"flex justify-between",children:[(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.onboardingStarted")}),(0,D.jsx)("span",{className:"dark:text-white",children:new Date(he.onboardingStartedAt).toLocaleDateString("de-DE")})]}),he.onboardingCompletedAt&&(0,D.jsxs)("div",{className:"flex justify-between",children:[(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.onboardingCompleted")}),(0,D.jsx)("span",{className:"dark:text-white",children:new Date(he.onboardingCompletedAt).toLocaleDateString("de-DE")})]}),(0,D.jsxs)("div",{className:"flex justify-between items-center",children:[(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.contractStart")}),(0,D.jsxs)("div",{className:"flex items-center space-x-2",children:[he.contractStartDate?(0,D.jsx)("span",{className:"dark:text-white",children:new Date(he.contractStartDate).toLocaleDateString("de-DE")}):(0,D.jsx)("span",{className:"text-gray-400 italic text-sm",children:o("lifecycle.notSet",{defaultValue:"Nicht gesetzt"})}),(d()||c())&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>xe(),className:"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition",children:(0,D.jsx)(S.A,{className:"h-4 w-4"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.edit",{defaultValue:"Bearbeiten"})})]})]})]}),(0,D.jsxs)("div",{className:"flex justify-between items-center",children:[(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.contractEnd")}),(0,D.jsxs)("div",{className:"flex items-center space-x-2",children:[he.contractEndDate?(0,D.jsx)("span",{className:"dark:text-white",children:new Date(he.contractEndDate).toLocaleDateString("de-DE")}):(0,D.jsx)("span",{className:"text-gray-400 italic text-sm",children:o("lifecycle.notSet",{defaultValue:"Nicht gesetzt"})}),(d()||c())&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>xe(),className:"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition",children:(0,D.jsx)(S.A,{className:"h-4 w-4"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.edit",{defaultValue:"Bearbeiten"})})]})]})]}),he.offboardingStartedAt&&(0,D.jsxs)("div",{className:"flex justify-between",children:[(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.offboardingStarted")}),(0,D.jsx)("span",{className:"dark:text-white",children:new Date(he.offboardingStartedAt).toLocaleDateString("de-DE")})]}),he.exitDate&&(0,D.jsxs)("div",{className:"flex justify-between",children:[(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.exitDate")}),(0,D.jsx)("span",{className:"dark:text-white",children:new Date(he.exitDate).toLocaleDateString("de-DE")})]}),he.exitReason&&(0,D.jsxs)("div",{className:"flex justify-between",children:[(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.exitReason")}),(0,D.jsx)("span",{className:"dark:text-white",children:he.exitReason})]})]})]}),"onboarding"===he.status&&(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,D.jsx)("h3",{className:"text-lg font-semibold dark:text-white mb-4",children:o("lifecycle.progressTitle")}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.progressSteps",{completed:pe.completed,total:pe.total})}),(0,D.jsxs)("span",{className:"font-medium dark:text-white",children:[pe.percent,"%"]})]}),(0,D.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:(0,D.jsx)("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-300",style:{width:"".concat(pe.percent,"%")}})})]})]}),"offboarding"===he.status&&(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,D.jsx)("h3",{className:"text-lg font-semibold dark:text-white mb-4",children:o("lifecycle.offboarding.progressTitle",{defaultValue:"Offboarding-Fortschritt"})}),(0,D.jsxs)("div",{className:"space-y-4",children:[(()=>{const e=L.filter((e=>"done"===e.status)).length,t=L.length||3,r=t>0?Math.round(e/t*100):0;return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,D.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:o("lifecycle.offboarding.progressSteps",{completed:e,total:t})||"".concat(e," von ").concat(t," Schritten abgeschlossen")}),(0,D.jsxs)("span",{className:"font-medium dark:text-white",children:[r,"%"]})]}),(0,D.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:(0,D.jsx)("div",{className:"bg-orange-600 h-3 rounded-full transition-all duration-300",style:{width:"".concat(r,"%")}})})]})})(),L.length>0&&(0,D.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,D.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o("lifecycle.offboarding.tasksTitle",{defaultValue:"Offboarding-Aufgaben"})}),L.map((e=>{const t="done"===e.status;return(0,D.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border ".concat(t?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600"),children:[(0,D.jsxs)("div",{className:"flex items-center space-x-3 flex-1",children:[t?(0,D.jsx)(A.A,{className:"h-5 w-5 text-green-600 dark:text-green-400 flex-shrink-0"}):(0,D.jsx)(C.A,{className:"h-5 w-5 text-orange-600 dark:text-orange-400 flex-shrink-0"}),(0,D.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,D.jsx)("p",{className:"text-sm font-medium ".concat(t?"text-green-800 dark:text-green-200":"text-gray-800 dark:text-gray-200"),children:e.title}),e.description&&(0,D.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 truncate",children:e.description})]})]}),(0,D.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat(t?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200"),children:t?o("common.done",{defaultValue:"Abgeschlossen"}):o("common.open",{defaultValue:"Offen"})})]},e.id)}))]})]})]}),(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsxs)("h3",{className:"text-lg font-semibold dark:text-white flex items-center",children:[(0,D.jsx)(b.A,{className:"h-5 w-5 mr-2"}),o("lifecycle.certificates")]}),(d()||c())&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>G(!0),className:"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":o("lifecycle.createCertificate"),children:(0,D.jsx)(g.A,{className:"h-4 w-4"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.createCertificate")})]})]}),0===p.length?(0,D.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,D.jsx)(b.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,D.jsx)("p",{children:o("lifecycle.noCertificates")})]}):(0,D.jsx)("div",{className:"space-y-4",children:p.map((e=>(0,D.jsx)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition",children:(0,D.jsxs)("div",{className:"flex items-start justify-between",children:[(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,D.jsxs)("h4",{className:"font-medium dark:text-white",children:[o("lifecycle.certificate"),"employment"!==e.certificateType&&" (".concat(e.certificateType,")")]}),e.isLatest&&(0,D.jsxs)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center",children:[(0,D.jsx)(A.A,{className:"h-3 w-3 mr-1"}),o("lifecycle.current")]})]}),(0,D.jsxs)("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[(0,D.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,D.jsx)(z.A,{className:"h-4 w-4"}),(0,D.jsxs)("span",{children:[o("lifecycle.issuedOn")," ",be(e.issueDate)]})]}),e.generatedByUser&&(0,D.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,D.jsx)(i.A,{className:"h-4 w-4"}),(0,D.jsxs)("span",{children:[o("lifecycle.createdBy")," ",e.generatedByUser.firstName," ",e.generatedByUser.lastName]})]})]})]}),(0,D.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(d()||c())&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>Y(e),className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition",children:(0,D.jsx)(S.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.edit")})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>(async e=>{Q(e);try{const t=await j.A.get(w.Sn.LIFECYCLE.CERTIFICATE_DOWNLOAD(r,e),{responseType:"blob"}),a=new Blob([t.data],{type:"application/pdf"}),s=window.URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download="arbeitszeugnis-".concat(e,".pdf"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(s),m("Arbeitszeugnis erfolgreich heruntergeladen","success")}catch(t){console.error("Fehler beim Herunterladen:",t),m("Fehler beim Herunterladen des Arbeitszeugnisses","error")}finally{Q(null)}})(e.id),disabled:$===e.id,className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed",children:$===e.id?(0,D.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}):(0,D.jsx)(R.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.download")})]})]})]})},e.id)))})]}),(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,D.jsxs)("div",{className:"flex items-center mb-4",children:[(d()||c())&&(0,D.jsxs)("div",{className:"relative group mr-3",children:[(0,D.jsx)("button",{onClick:()=>H(!0),className:"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":o("lifecycle.createContract"),children:(0,D.jsx)(g.A,{className:"h-4 w-4"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.createContract")})]}),(0,D.jsxs)("h3",{className:"text-lg font-semibold dark:text-white flex items-center",children:[(0,D.jsx)(b.A,{className:"h-5 w-5 mr-2"}),o("lifecycle.contracts")]})]}),0===k.length?(0,D.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,D.jsx)(b.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,D.jsx)("p",{children:o("lifecycle.noContracts")})]}):(0,D.jsx)("div",{className:"space-y-4",children:k.map((e=>(0,D.jsx)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition",children:(0,D.jsxs)("div",{className:"flex items-start justify-between",children:[(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,D.jsxs)("h4",{className:"font-medium dark:text-white",children:[o("lifecycle.contract"),"employment"!==e.contractType&&" (".concat(e.contractType,")")]}),e.isLatest&&(0,D.jsxs)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center",children:[(0,D.jsx)(A.A,{className:"h-3 w-3 mr-1"}),o("lifecycle.current")]})]}),(0,D.jsxs)("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[(0,D.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,D.jsx)(z.A,{className:"h-4 w-4"}),(0,D.jsxs)("span",{children:[be(e.startDate),e.endDate&&" - ".concat(be(e.endDate))]})]}),e.position&&(0,D.jsxs)("div",{children:[o("lifecycle.position")," ",e.position]}),e.salary&&(0,D.jsxs)("div",{children:[o("lifecycle.salary")," ",e.salary.toLocaleString("de-DE",{style:"currency",currency:"EUR"})]}),e.workingHours&&(0,D.jsxs)("div",{children:[o("lifecycle.workingHours")," ",e.workingHours,"h/Woche"]}),e.generatedByUser&&(0,D.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,D.jsx)(i.A,{className:"h-4 w-4"}),(0,D.jsxs)("span",{children:[o("lifecycle.createdBy")," ",e.generatedByUser.firstName," ",e.generatedByUser.lastName]})]})]})]}),(0,D.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(d()||c())&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>X(e),className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition",children:(0,D.jsx)(S.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.edit")})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>(async e=>{te(e);try{const t=await j.A.get(w.Sn.LIFECYCLE.CONTRACT_DOWNLOAD(r,e),{responseType:"blob"}),a=new Blob([t.data],{type:"application/pdf"}),s=window.URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download="arbeitsvertrag-".concat(e,".pdf"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(s),m("Arbeitsvertrag erfolgreich heruntergeladen","success")}catch(t){console.error("Fehler beim Herunterladen:",t),m("Fehler beim Herunterladen des Arbeitsvertrags","error")}finally{te(null)}})(e.id),disabled:ee===e.id,className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed",children:ee===e.id?(0,D.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}):(0,D.jsx)(R.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o("lifecycle.download")})]})]})]})},e.id)))})]}),(null===u||void 0===u?void 0:u.lifecycle)&&(0,D.jsx)(U,{userId:r,lifecycleId:u.lifecycle.id,onUpdate:()=>ge(!0)}),(0,D.jsx)(I,{isOpen:K,onClose:()=>G(!1),onCertificateCreated:()=>{ge(),G(!1)},userId:r,userName:l}),(0,D.jsx)(T,{isOpen:W,onClose:()=>H(!1),onContractCreated:()=>{ge(),H(!1)},userId:r,userName:l}),J&&(0,D.jsx)(_,{isOpen:!!J,onClose:()=>Y(null),onCertificateUpdated:()=>{ge(),Y(null)},userId:r,certificate:J}),Z&&(0,D.jsx)(B,{isOpen:!!Z,onClose:()=>X(null),onContractUpdated:()=>{ge(),X(null)},userId:r,contract:Z}),(0,D.jsx)(q,{isOpen:re,onClose:()=>ae(!1),onOffboardingStarted:()=>{ge(),ae(!1)},userId:r,userName:l}),(0,D.jsx)(V,{isOpen:se,onClose:()=>ne(!1),onOffboardingCompleted:()=>{ge(),ne(!1)},userId:r,userName:l,offboardingTasks:L}),le&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md mx-4",children:[(0,D.jsx)("h2",{className:"text-xl font-semibold dark:text-white mb-4",children:o("lifecycle.editContractDates",{defaultValue:"Vertragsdaten bearbeiten"})}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o("lifecycle.contractStart",{defaultValue:"Vertragsbeginn"})," *"]}),(0,D.jsx)("input",{type:"date",value:oe,onChange:e=>de(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",required:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o("lifecycle.contractEnd",{defaultValue:"Vertragsende"})," (optional)"]}),(0,D.jsx)("input",{type:"date",value:ce,onChange:e=>me(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:o("lifecycle.contractEndHint",{defaultValue:"Nur bei befristeten Vertr\xe4gen ausf\xfcllen"})})]})]}),(0,D.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,D.jsx)("button",{onClick:()=>ie(!1),className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition",children:o("common.cancel",{defaultValue:"Abbrechen"})}),(0,D.jsx)("button",{onClick:async()=>{try{await j.A.put(w.Sn.LIFECYCLE.STATUS(r),{status:(null===u||void 0===u?void 0:u.lifecycle.status)||"active",contractStartDate:oe||null,contractEndDate:ce||null}),m("Vertragsdaten erfolgreich aktualisiert","success"),ie(!1),ge()}catch(e){console.error("Fehler beim Speichern der Vertragsdaten:",e),m("Fehler beim Speichern der Vertragsdaten","error")}},disabled:!oe,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:o("common.save",{defaultValue:"Speichern"})})]})]})})]})},G=[{code:"tiempo_completo",name:"Tiempo Completo (>21 Tage/Monat)"},{code:"tiempo_parcial_7",name:"Tiempo Parcial (\u22647 Tage/Monat)"},{code:"tiempo_parcial_14",name:"Tiempo Parcial (\u226414 Tage/Monat)"},{code:"tiempo_parcial_21",name:"Tiempo Parcial (\u226421 Tage/Monat)"},{code:"prestacion_de_servicios",name:"Prestaci\xf3n de Servicios"},{code:"externo",name:"Externo"}],W=e=>{let{onError:t}=e;const{t:r}=(0,s.Bd)(),l=[{code:"CO",name:r("countries.CO")},{code:"CH",name:r("countries.CH")},{code:"DE",name:r("countries.DE")},{code:"AT",name:r("countries.AT")}],i=[{code:"CH",name:r("countries.CH")},{code:"CO",name:r("countries.CO")}],j=[{code:"es",name:r("languages.es")},{code:"de",name:r("languages.de")},{code:"en",name:r("languages.en")}],[w,N]=(0,a.useState)([]),[A,S]=(0,a.useState)(null),[C,z]=(0,a.useState)({}),[R,L]=(0,a.useState)(!1),[P,I]=(0,a.useState)([]),[F,T]=(0,a.useState)(0),[_,B]=(0,a.useState)(!1),[O,U]=(0,a.useState)(null),{showMessage:M}=(0,f.A)(),{isAdmin:q}=(0,n.S)(),[V,W]=(0,a.useState)([]),[H,J]=(0,a.useState)(!1),[Y,Z]=(0,a.useState)([]),[X,$]=(0,a.useState)(!1),[Q,ee]=(0,a.useState)([]),[te,re]=(0,a.useState)("details"),[ae,se]=(0,a.useState)("active"),[ne,le]=(0,a.useState)(!1),[ie,oe]=(0,a.useState)(window.innerWidth<640),[de,ce]=(0,a.useState)(window.innerWidth>1070),{openSidepane:me,closeSidepane:ue}=(0,E.N)(),[ge,xe]=(0,a.useState)(!1),[be,he]=(0,a.useState)({email:"",password:"",firstName:"",lastName:""});(0,a.useEffect)((()=>{const e=()=>{oe(window.innerWidth<640),ce(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(ne?me():ue(),()=>{ue()})),[ne,me,ue]);const[pe,ye]=(0,a.useState)([]);(0,a.useEffect)((()=>{fe()}),[]);const fe=async()=>{try{const e=await u.i$.getAll();ye(e.data),ke("active",e.data)}catch(e){je(e)}},ke=function(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:pe).filter((t=>{const r=void 0===t.active||t.active;return"active"===e?r:!r})).sort(((e,t)=>{const r=(e.username||"").toLowerCase(),a=(t.username||"").toLowerCase(),s=(e.firstName||"").toLowerCase(),n=(t.firstName||"").toLowerCase();return r!==a?r.localeCompare(a):s.localeCompare(n)}));N(t)};(0,a.useEffect)((()=>{pe.length>0&&ke(ae,pe)}),[ae]);const ve=async e=>{try{if(!e||isNaN(e))return void S(null);console.log("Lade Benutzerdetails f\xfcr ID:",e);const t=await u.i$.getById(e),r=(0,c.A)((0,c.A)({},t.data),{},{active:void 0===t.data.active||t.data.active,birthday:t.data.birthday?new Date(t.data.birthday).toISOString().split("T")[0]:null});let a=[];t.data.roles&&Array.isArray(t.data.roles)?(console.log("Rollenstruktur (Typ):",typeof t.data.roles,"L\xe4nge:",t.data.roles.length),t.data.roles.length>0&&t.data.roles[0].role?(a=t.data.roles.map((e=>e.role.id)),console.log("Extrahierte Rollen-IDs aus verschachtelter Struktur:",a)):t.data.roles.length>0&&("number"===typeof t.data.roles[0]?a=t.data.roles:t.data.roles[0].roleId?a=t.data.roles.map((e=>e.roleId)):t.data.roles[0].id&&(a=t.data.roles.map((e=>e.id))))):console.warn("Rollen fehlen oder sind kein Array:",t.data.roles),0===a.length&&t.data.role&&(console.log("Versuche Rollen aus role-Eigenschaft zu extrahieren:",t.data.role),Array.isArray(t.data.role)?a=t.data.role.map((e=>e.id)):"object"===typeof t.data.role&&null!==t.data.role&&(a=[t.data.role.id])),console.log("Endg\xfcltige extrahierte Rollen-IDs:",a);let s=[];t.data.branches&&Array.isArray(t.data.branches)?(console.log("Branches-Struktur (Typ):",typeof t.data.branches,"L\xe4nge:",t.data.branches.length),t.data.branches.length>0&&t.data.branches[0].branch?(s=t.data.branches.map((e=>e.branch.id)),console.log("Extrahierte Branch-IDs aus verschachtelter Struktur:",s)):t.data.branches.length>0&&("number"===typeof t.data.branches[0]?s=t.data.branches:t.data.branches[0].branchId?s=t.data.branches.map((e=>e.branchId)):t.data.branches[0].id&&(s=t.data.branches.map((e=>e.id))))):console.warn("Branches fehlen oder sind kein Array:",t.data.branches),console.log("Endg\xfcltige extrahierte Branch-IDs:",s),S(r),z(r),I(a),ee(s),0===V.length&&await(async()=>{try{J(!0);const t=[{id:1,name:"admin",description:"Administrator mit allen Rechten",permissions:[]},{id:2,name:"user",description:"Standardbenutzer",permissions:[]},{id:999,name:"hamburger",description:"Hamburger-Rolle f\xfcr neue Benutzer",permissions:[]}];try{const e=await u.Zj.getAll();e.data&&Array.isArray(e.data)&&e.data.length>0?(W(e.data),console.log("".concat(e.data.length," Rollen erfolgreich geladen"))):(console.warn("Keine Rollen vom Server erhalten, verwende Fallback"),W(t))}catch(e){console.warn("Fehler beim Laden der Rollen, verwende Fallback:",e),W(t)}}finally{J(!1)}})(),0===Y.length&&await(async()=>{try{$(!0);try{const e=await u.H_.getAll();e.data&&Array.isArray(e.data)&&e.data.length>0?(Z(e.data),console.log("".concat(e.data.length," Branches erfolgreich geladen"))):(console.warn("Keine Branches vom Server erhalten"),Z([]))}catch(e){console.warn("Fehler beim Laden der Branches:",e),Z([])}}finally{$(!1)}})()}catch(t){console.error("Fehler beim Laden der Benutzerdetails:",t),je(t)}},je=e=>{var r,a;let s="Ein Fehler ist aufgetreten";null!==(r=e.response)&&void 0!==r&&null!==(a=r.data)&&void 0!==a&&a.message?s=e.response.data.message:e instanceof Error&&(s=e.message),!s.includes("Ung\xfcltige Rollen-ID")||A?t(s):console.warn("Fehler unterdr\xfcckt, da kein Benutzer ausgew\xe4hlt ist:",s)},we=e=>{const{name:t,value:r,type:a}=e.target;let s=r;"number"===a&&(s=""===r?null:Number(r)),z((0,c.A)((0,c.A)({},C),{},{[t]:s})),L(!0)},Ne=async e=>{if(e&&A)if(1===e&&1===A.id&&P.includes(e))M("Die Admin-Rolle kann vom Admin-Benutzer nicht entfernt werden","warning");else try{console.log("Toggle Rolle:",e,"f\xfcr Benutzer:",A.id),console.log("Aktuelle ausgew\xe4hlte Rollen:",P);const t=P.includes(e),r=t?P.filter((t=>t!==e)):[...P,e];console.log("Neue ausgew\xe4hlte Rollen:",r),I(r),console.log("Sende Rollenaktualisierung an API:",{userId:A.id,roleIds:r});const a=await u.i$.updateRoles(A.id,r);console.log("API-Antwort bei Rollenaktualisierung:",a.data),await ve(A.id),M(t?"Rolle erfolgreich entfernt":"Rolle erfolgreich zugewiesen","success")}catch(t){console.error("Fehler beim Aktualisieren der Rollen:",t),ve(A.id),je(t),M("Fehler beim Aktualisieren der Rollen","error")}},Ae=async e=>{if(e&&A)try{console.log("Toggle Branch:",e,"f\xfcr Benutzer:",A.id),console.log("Aktuelle ausgew\xe4hlte Branches:",Q);const t=Q.includes(e),r=t?Q.filter((t=>t!==e)):[...Q,e];console.log("Neue ausgew\xe4hlte Branches:",r),ee(r),console.log("Sende Branch-Aktualisierung an API:",{userId:A.id,branchIds:r});const a=await u.i$.updateBranches(A.id,r);console.log("API-Antwort bei Branch-Aktualisierung:",a.data),await ve(A.id),M(t?"Branch erfolgreich entfernt":"Branch erfolgreich zugewiesen","success")}catch(t){console.error("Fehler beim Aktualisieren der Branches:",t),ve(A.id),je(t),M("Fehler beim Aktualisieren der Branches","error")}};(0,a.useEffect)((()=>{A&&(z((0,c.A)((0,c.A)({},A),{},{birthday:A.birthday?new Date(A.birthday).toISOString().split("T")[0]:null})),L(!1))}),[A]);const Se=e=>{const{name:t,value:r}=e.target;he((0,c.A)((0,c.A)({},be),{},{[t]:r}))},Ce=async e=>{if(e.preventDefault(),be.email&&be.password&&be.firstName&&be.lastName)if(be.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/))try{const e=await u.i$.create(be);if(e.data){const t=(0,c.A)((0,c.A)({},e.data),{},{active:void 0===e.data.active||e.data.active});ye((e=>[t,...e])),"active"===ae&&t.active&&N((e=>[t,...e]))}M("Benutzer erfolgreich erstellt","success"),le(!1),he({email:"",password:"",firstName:"",lastName:""})}catch(s){var r,a;await fe();const e=(null===(r=s.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||"Fehler beim Erstellen des Benutzers";M(e,"error"),t(e)}else M("Ung\xfcltiges E-Mail-Format","error");else M("Bitte f\xfcllen Sie alle Felder aus","error")};return(0,D.jsxs)("div",{className:"container mx-auto px-4 pb-6",children:[(0,D.jsx)("div",{className:"mb-6",children:(0,D.jsxs)("div",{className:"flex items-start gap-4",children:[(0,D.jsx)("div",{className:"flex items-center pt-8",children:q()&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>le(!0),className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":r("users.create"),children:(0,D.jsx)(g.A,{className:"h-4 w-4"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("users.create")})]})}),(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,D.jsx)("button",{type:"button",onClick:()=>se("active"),className:"px-3 py-1.5 rounded-full text-sm font-medium transition-colors ".concat("active"===ae?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"),children:r("users.active")}),(0,D.jsx)("button",{type:"button",onClick:()=>se("inactive"),className:"px-3 py-1.5 rounded-full text-sm font-medium transition-colors ".concat("inactive"===ae?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"),children:r("users.inactive")})]}),(0,D.jsxs)("select",{id:"userSelect",onChange:e=>{const t=parseInt(e.target.value,10);t&&!isNaN(t)?ve(t):(S(null),z({}),I([]))},className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",children:[(0,D.jsxs)("option",{value:"",children:["-- ",r("common.select")," --"]}),w.map((e=>(0,D.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName," (",e.username,")"]},e.id)))]})]})]})}),A&&(0,D.jsx)("div",{children:(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 mb-6",children:[(0,D.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,D.jsxs)("nav",{className:"flex -mb-px",children:[(0,D.jsxs)("button",{onClick:()=>re("details"),className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("details"===te?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[(0,D.jsx)(x.A,{className:"h-5 w-5 inline mr-2"}),r("users.title")]}),(0,D.jsxs)("button",{onClick:()=>re("documents"),className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("documents"===te?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[(0,D.jsx)(b.A,{className:"h-5 w-5 inline mr-2"}),r("profile.documents")]}),(0,D.jsxs)("button",{onClick:()=>re("roles"),className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("roles"===te?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[(0,D.jsx)(o.A,{className:"h-5 w-5 inline mr-2"}),r("roles.title")]}),(0,D.jsxs)("button",{onClick:()=>re("branches"),className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("branches"===te?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[(0,D.jsx)(d.A,{className:"h-5 w-5 inline mr-2"}),r("branches.title")||"Niederlassungen"]}),(0,D.jsxs)("button",{onClick:()=>re("lifecycle"),className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("lifecycle"===te?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[(0,D.jsx)(h.A,{className:"h-5 w-5 inline mr-2"}),r("lifecycle.tabTitle")]})]})}),"details"===te&&(0,D.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!A||!A.id)return t("Kein Benutzer ausgew\xe4hlt"),void M("Kein Benutzer ausgew\xe4hlt","error");try{var r,a;if(null===(r=C.username)||void 0===r||!r.trim())throw new Error("Benutzername ist erforderlich");if(null===(a=C.email)||void 0===a||!a.trim())throw new Error("E-Mail ist erforderlich");const e={username:C.username,email:C.email,bankDetails:C.bankDetails||null,gender:C.gender||null,phoneNumber:C.phoneNumber||null,language:C.language||null,hourlyRate:null===C.hourlyRate||void 0===C.hourlyRate||""===C.hourlyRate?null:"string"===typeof C.hourlyRate?C.hourlyRate:C.hourlyRate.toString(),monthlySalary:null===C.monthlySalary||void 0===C.monthlySalary||""===C.monthlySalary?null:"string"===typeof C.monthlySalary?parseFloat(C.monthlySalary):C.monthlySalary,payrollCountry:C.payrollCountry||null,contractType:C.contractType||null};console.log("Sende Daten zum Server:",e);const t=await u.i$.update(A.id,e);if(t.data){const e=(0,c.A)((0,c.A)({},t.data),{},{birthday:t.data.birthday?new Date(t.data.birthday).toISOString().split("T")[0]:null});S(e),z((0,c.A)((0,c.A)({},e),{},{birthday:e.birthday?new Date(e.birthday).toISOString().split("T")[0]:null})),ye((t=>t.map((t=>t.id===e.id?e:t)))),ke(ae,pe.map((t=>t.id===e.id?e:t))),M("Benutzerprofil erfolgreich aktualisiert","success"),L(!1)}}catch(o){var s,n;if(console.error("Fehler beim Speichern der Benutzerdaten:",o),await fe(),400===(null===(s=o.response)||void 0===s?void 0:s.status)){var l,i;const e="Validierungsfehler: ".concat((null===(l=o.response)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.message)||"Bitte \xfcberpr\xfcfe die eingegebenen Daten");t(e),M(e,"error")}else 404===(null===(n=o.response)||void 0===n?void 0:n.status)?(t("Benutzer wurde nicht gefunden"),M("Benutzer wurde nicht gefunden","error")):je(o)}},className:"p-6",children:[(0,D.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("users.form.username")}),(0,D.jsx)("input",{type:"text",name:"username",value:C.username||"",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("users.form.email")}),(0,D.jsx)("input",{type:"email",name:"email",value:C.email||"",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("profile.language")," ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsx)("select",{name:"language",value:C.language||"es",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",required:!0,children:j.map((e=>(0,D.jsx)("option",{value:e.code,children:e.name},e.code)))})]}),A&&(0,D.jsx)("div",{className:"sm:col-span-2",children:(0,D.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("h3",{className:"text-sm font-medium text-blue-900 dark:text-blue-200 mb-1",children:r("profile.identificationDocument")||"Identifikationsdokument"}),(0,D.jsx)("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:r("profile.uploadDocumentHint")||"Bitte laden Sie das Identifikationsdokument (C\xe9dula oder Pasaporte) hoch. Die Felder werden automatisch ausgef\xfcllt."})]}),!ge&&(0,D.jsxs)("button",{type:"button",onClick:()=>xe(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",children:[(0,D.jsx)(b.A,{className:"h-5 w-5 inline mr-2"}),r("profile.uploadDocument")||"Dokument hochladen"]})]}),ge&&(0,D.jsx)("div",{className:"mt-4",children:(0,D.jsx)(v.A,{userId:A.id,onDocumentSaved:async()=>{xe(!1),await ve(A.id),M("Dokument erfolgreich hochgeladen. Felder werden automatisch ausgef\xfcllt.","success")},onCancel:()=>xe(!1)})})]})}),A.identificationDocuments&&A.identificationDocuments.length>0&&(0,D.jsx)(D.Fragment,{children:(e=>{const t=A.identificationDocuments[0];return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("users.form.firstName")}),(0,D.jsx)("input",{type:"text",value:A.firstName||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("users.form.lastName")}),(0,D.jsx)("input",{type:"text",value:A.lastName||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.birthday")}),(0,D.jsx)("input",{type:"text",value:A.birthday?new Date(A.birthday).toISOString().split("T")[0]:"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.country")}),(0,D.jsx)("input",{type:"text",value:A.country?(null===(e=l.find((e=>e.code===A.country)))||void 0===e?void 0:e.name)||A.country:"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.gender")}),(0,D.jsxs)("select",{name:"gender",value:C.gender||"",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,D.jsx)("option",{value:"",children:r("profile.selectGender")}),(0,D.jsx)("option",{value:"male",children:r("profile.genderMale")}),(0,D.jsx)("option",{value:"female",children:r("profile.genderFemale")}),(0,D.jsx)("option",{value:"other",children:r("profile.genderOther")})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.identificationType")}),(0,D.jsx)("input",{type:"text",value:t.documentType?{passport:r("identificationDocuments.types.passport"),national_id:r("identificationDocuments.types.national_id"),driving_license:r("identificationDocuments.types.driving_license"),residence_permit:r("identificationDocuments.types.residence_permit"),work_permit:r("identificationDocuments.types.work_permit"),tax_id:r("identificationDocuments.types.tax_id"),social_security:r("identificationDocuments.types.social_security")}[t.documentType]||t.documentType:"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.identificationNumber")}),(0,D.jsx)("input",{type:"text",value:A.identificationNumber||t.documentNumber||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),t.issueDate&&(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.identificationIssueDate")||"Ausstellungsdatum"}),(0,D.jsx)("input",{type:"text",value:new Date(t.issueDate).toISOString().split("T")[0],disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]}),t.expiryDate&&(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.identificationExpiryDate")}),(0,D.jsx)("input",{type:"text",value:new Date(t.expiryDate).toISOString().split("T")[0],disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800",readOnly:!0})]})]})})()}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.phoneNumber")}),(0,D.jsx)("input",{type:"tel",name:"phoneNumber",value:C.phoneNumber||"",onChange:we,placeholder:"+573001234567",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"}),(0,D.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:r("profile.phoneNumberHint")})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("profile.bankDetails")}),(0,D.jsx)("input",{type:"text",name:"bankDetails",value:C.bankDetails||"",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"})]})]}),(0,D.jsxs)("div",{className:"mt-4 border-t pt-4",children:[(0,D.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:r("users.form.payrollSettings")}),(0,D.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("users.form.payrollCountry")}),(0,D.jsx)("select",{name:"payrollCountry",value:C.payrollCountry||A.payrollCountry||"CH",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:i.map((e=>(0,D.jsx)("option",{value:e.code,children:e.name},e.code)))})]}),("CO"===C.payrollCountry||"CO"===A.payrollCountry&&!C.payrollCountry)&&(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("users.form.contractType")}),(0,D.jsxs)("select",{name:"contractType",value:C.contractType||"",onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,D.jsx)("option",{value:"",children:"Bitte ausw\xe4hlen"}),G.map((e=>(0,D.jsx)("option",{value:e.code,children:e.name},e.code)))]})]})]}),(0,D.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("users.form.hourlyRate")," (","CH"===(C.payrollCountry||A.payrollCountry)?"CHF":"COP",")"]}),(0,D.jsx)("input",{type:"number",name:"hourlyRate",min:"0",step:"CH"===(C.payrollCountry||A.payrollCountry)?"0.05":"1",value:null===C.hourlyRate||void 0===C.hourlyRate?"":C.hourlyRate,onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"CH"===(C.payrollCountry||A.payrollCountry)?"z.B. 45.00":"z.B. 50000"})]}),("CO"===C.payrollCountry||"CO"===A.payrollCountry)&&"servicios_externos"!==C.contractType&&"servicios_externos"!==A.contractType&&(C.contractType||A.contractType)&&(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("users.form.monthlySalary")," (COP)"]}),(0,D.jsx)("input",{type:"number",name:"monthlySalary",min:"0",step:"1000",value:null===C.monthlySalary||void 0===C.monthlySalary?"":C.monthlySalary,onChange:we,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"z.B. 3500000"})]})]})]}),R&&(0,D.jsxs)("div",{className:"mt-4 flex justify-end gap-3",children:[(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>{A&&z((0,c.A)((0,c.A)({},A),{},{birthday:A.birthday?new Date(A.birthday).toISOString().split("T")[0]:null})),L(!1)},className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.cancel")})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800",children:(0,D.jsx)(y.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.save")})]})]}),(0,D.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[void 0!==A.active&&(0,D.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(A.active?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300"),children:A.active?r("users.active"):r("users.inactive")}),q()&&(0,D.jsx)("button",{onClick:async()=>{if(!A||!A.id)return void M("Kein Benutzer ausgew\xe4hlt","error");const e=parseInt(localStorage.getItem("userId")||"0",10);if(A.id!==e)try{const e=void 0===A.active||A.active,t=!e;console.log("Toggle active:",{currentActiveStatus:e,newActiveStatus:t,selectedUser:A,selectedUserActive:A.active,userId:A.id});const r={active:t};console.log("Sending update payload:",r,"Type of active:",typeof t);const a=await u.i$.update(A.id,r);if(console.log("Update response:",a.data),a.data){const e=(0,c.A)((0,c.A)({},a.data),{},{active:void 0===a.data.active||a.data.active,birthday:a.data.birthday?new Date(a.data.birthday).toISOString().split("T")[0]:null});console.log("Updated user data:",e),S(e),z((0,c.A)((0,c.A)({},e),{},{birthday:e.birthday?new Date(e.birthday).toISOString().split("T")[0]:null})),ye((t=>t.map((t=>t.id===e.id?e:t)))),ke(ae,pe.map((t=>t.id===e.id?e:t))),await fe(),M(t?"Benutzer erfolgreich aktiviert":"Benutzer erfolgreich deaktiviert","success")}}catch(t){console.error("Fehler beim Aktivieren/Deaktivieren des Benutzers:",t),je(t),await fe()}else M("Du kannst dich nicht selbst deaktivieren","warning")},className:"relative group flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat(A.active?"bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30":"bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900/20 dark:text-green-400 dark:hover:bg-green-900/30"),children:A.active?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(p.A,{className:"h-5 w-5"}),r("users.deactivate")]}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(y.A,{className:"h-5 w-5"}),r("users.activate")]})})]})]}),"documents"===te&&(0,D.jsx)("div",{className:"p-6",children:(0,D.jsx)(k.A,{userId:A.id,isAdmin:!0})}),"roles"===te&&(0,D.jsx)("div",{className:"p-6",children:H?(0,D.jsxs)("div",{className:"mt-4 mb-4",children:[(0,D.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:r("roleAssignment.title")}),(0,D.jsx)("p",{className:"dark:text-gray-300",children:r("roleAssignment.loading")})]}):V.length>0&&(0,D.jsxs)("div",{children:[(0,D.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:r("roleAssignment.title")}),P.some((e=>!V.some((t=>t.id===e))))&&(0,D.jsxs)("div",{className:"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4",children:[(0,D.jsx)("p",{className:"font-bold",children:r("roleAssignment.unknownRolesWarning")}),(0,D.jsx)("p",{children:r("roleAssignment.unknownRolesMessage",{ids:P.filter((e=>!V.some((t=>t.id===e)))).join(", ")})}),(0,D.jsx)("p",{className:"mt-2 text-sm",children:r("roleAssignment.availableRoleIds",{ids:V.map((e=>e.id)).join(", ")})})]}),(0,D.jsxs)("div",{className:"mb-4",children:[(0,D.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("roleAssignment.currentRoles")}),0===P.length?(0,D.jsx)("p",{className:"text-gray-500 dark:text-gray-400 italic",children:r("roleAssignment.noRolesAssigned")}):(0,D.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[V.filter((e=>P.includes(e.id))).map((e=>{const t=1===e.id&&A&&1===A.id;return(0,D.jsx)("div",{className:"border rounded-lg p-4 ".concat(t?"border-green-500 bg-green-50 dark:bg-green-900/20 dark:border-green-700 cursor-not-allowed":"border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 cursor-pointer"),onClick:()=>!t&&Ne(e.id),children:(0,D.jsxs)("div",{className:"flex justify-between items-center",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("h4",{className:"font-medium flex items-center dark:text-white",children:[e.name,t&&(0,D.jsx)("span",{className:"ml-2 text-xs bg-green-600 text-white px-2 py-0.5 rounded-full",children:r("roleAssignment.fixed")})]}),(0,D.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]}),(0,D.jsxs)("div",{className:"flex items-center ".concat(t?"text-gray-400 dark:text-gray-500":"text-blue-600 dark:text-blue-400"),children:[(0,D.jsx)("span",{className:"mr-2 text-sm",children:r(t?"roleAssignment.fixedAssigned":"roleAssignment.remove")}),(0,D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,D.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})]})]})},e.id)})),P.filter((e=>!V.some((t=>t.id===e)))).map((e=>(0,D.jsx)("div",{className:"border border-orange-500 bg-orange-50 rounded-lg p-4",children:(0,D.jsxs)("div",{className:"flex justify-between items-center",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"font-medium",children:r("roleAssignment.unknownRole",{id:e})}),(0,D.jsx)("p",{className:"text-sm text-orange-600",children:r("roleAssignment.unknownRoleDescription")})]}),(0,D.jsxs)("div",{className:"flex items-center text-orange-600",children:[(0,D.jsx)("span",{className:"mr-2 text-sm",children:r("roleAssignment.remove")}),(0,D.jsx)("button",{onClick:()=>Ne(e),className:"focus:outline-none",children:(0,D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,D.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})})]})]})},"unknown-".concat(e))))]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("roleAssignment.availableRoles")}),0===V.filter((e=>!P.includes(e.id))).length?(0,D.jsx)("p",{className:"text-gray-500 dark:text-gray-400 italic",children:r("roleAssignment.noRolesAvailable")}):(0,D.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:V.filter((e=>!P.includes(e.id))).map((e=>(0,D.jsx)("div",{className:"border border-gray-300 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50",onClick:()=>Ne(e.id),children:(0,D.jsxs)("div",{className:"flex justify-between items-center",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"font-medium",children:e.name}),(0,D.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),(0,D.jsxs)("div",{className:"flex items-center text-gray-500 hover:text-blue-600",children:[(0,D.jsx)("span",{className:"mr-2 text-sm",children:r("roleAssignment.add")}),(0,D.jsx)(g.A,{className:"h-5 w-5"})]})]})},e.id)))})]})]})}),"branches"===te&&(0,D.jsxs)("div",{className:"p-6",children:[X?(0,D.jsxs)("div",{className:"mt-4 mb-4",children:[(0,D.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:r("branchAssignment.title")||"Niederlassungszuweisung"}),(0,D.jsx)("p",{className:"dark:text-gray-300",children:r("branchAssignment.loading")||"Lade Niederlassungen..."})]}):Y.length>0&&(0,D.jsxs)("div",{children:[(0,D.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:r("branchAssignment.title")||"Niederlassungszuweisung"}),Q.some((e=>!Y.some((t=>t.id===e))))&&(0,D.jsxs)("div",{className:"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4",children:[(0,D.jsx)("p",{className:"font-bold",children:r("branchAssignment.unknownBranchesWarning")||"Unbekannte Niederlassungen zugewiesen"}),(0,D.jsx)("p",{children:r("branchAssignment.unknownBranchesMessage",{ids:Q.filter((e=>!Y.some((t=>t.id===e)))).join(", ")})||"Die folgenden Niederlassungs-IDs sind zugewiesen, aber nicht verf\xfcgbar: ".concat(Q.filter((e=>!Y.some((t=>t.id===e)))).join(", "))}),(0,D.jsx)("p",{className:"mt-2 text-sm",children:r("branchAssignment.availableBranchIds",{ids:Y.map((e=>e.id)).join(", ")})||"Verf\xfcgbare Niederlassungs-IDs: ".concat(Y.map((e=>e.id)).join(", "))})]}),(0,D.jsxs)("div",{className:"mb-4",children:[(0,D.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("branchAssignment.currentBranches")||"Aktuell zugewiesene Niederlassungen"}),0===Q.length?(0,D.jsx)("p",{className:"text-gray-500 dark:text-gray-400 italic",children:r("branchAssignment.noBranchesAssigned")||"Keine Niederlassungen zugewiesen"}):(0,D.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Y.filter((e=>Q.includes(e.id))).map((e=>(0,D.jsx)("div",{className:"border border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 rounded-lg p-4 cursor-pointer",onClick:()=>Ae(e.id),children:(0,D.jsxs)("div",{className:"flex justify-between items-center",children:[(0,D.jsx)("div",{children:(0,D.jsx)("h4",{className:"font-medium dark:text-white",children:e.name})}),(0,D.jsxs)("div",{className:"flex items-center text-blue-600 dark:text-blue-400",children:[(0,D.jsx)("span",{className:"mr-2 text-sm",children:r("branchAssignment.remove")||"Entfernen"}),(0,D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,D.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})]})]})},e.id))),Q.filter((e=>!Y.some((t=>t.id===e)))).map((e=>(0,D.jsx)("div",{className:"border border-orange-500 bg-orange-50 rounded-lg p-4",children:(0,D.jsxs)("div",{className:"flex justify-between items-center",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"font-medium",children:r("branchAssignment.unknownBranch",{id:e})||"Unbekannte Niederlassung (ID: ".concat(e,")")}),(0,D.jsx)("p",{className:"text-sm text-orange-600",children:r("branchAssignment.unknownBranchDescription")||"Diese Niederlassung existiert nicht mehr oder ist nicht verf\xfcgbar."})]}),(0,D.jsxs)("div",{className:"flex items-center text-orange-600",children:[(0,D.jsx)("span",{className:"mr-2 text-sm",children:r("branchAssignment.remove")||"Entfernen"}),(0,D.jsx)("button",{onClick:()=>Ae(e),className:"focus:outline-none",children:(0,D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,D.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})})]})]})},"unknown-".concat(e))))]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("branchAssignment.availableBranches")||"Verf\xfcgbare Niederlassungen"}),0===Y.filter((e=>!Q.includes(e.id))).length?(0,D.jsx)("p",{className:"text-gray-500 dark:text-gray-400 italic",children:r("branchAssignment.noBranchesAvailable")||"Keine weiteren Niederlassungen verf\xfcgbar"}):(0,D.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Y.filter((e=>!Q.includes(e.id))).map((e=>(0,D.jsx)("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20",onClick:()=>Ae(e.id),children:(0,D.jsxs)("div",{className:"flex justify-between items-center",children:[(0,D.jsx)("div",{children:(0,D.jsx)("h4",{className:"font-medium dark:text-white",children:e.name})}),(0,D.jsxs)("div",{className:"flex items-center text-gray-500 hover:text-blue-600 dark:hover:text-blue-400",children:[(0,D.jsx)("span",{className:"mr-2 text-sm",children:r("branchAssignment.add")||"Hinzuf\xfcgen"}),(0,D.jsx)(g.A,{className:"h-5 w-5"})]})]})},e.id)))})]})]}),!X&&0===Y.length&&(0,D.jsxs)("div",{className:"mt-4 mb-4",children:[(0,D.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:r("branchAssignment.title")||"Niederlassungszuweisung"}),(0,D.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:r("branchAssignment.noBranchesFound")||"Keine Niederlassungen gefunden"})]})]}),"lifecycle"===te&&A&&(0,D.jsx)("div",{className:"p-6",children:(0,D.jsx)(K,{userId:A.id,userName:"".concat(A.firstName," ").concat(A.lastName)},"lifecycle-".concat(A.id,"-").concat(F))})]})}),ne&&(0,D.jsx)(D.Fragment,{children:ie?(0,D.jsxs)(m.lG,{open:ne,onClose:()=>le(!1),className:"relative z-50",children:[(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,D.jsxs)(m.lG.Panel,{className:"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,D.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700",children:(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsx)(m.lG.Title,{className:"text-lg font-semibold dark:text-white",children:r("organisation.createUser.title")}),(0,D.jsx)("button",{onClick:()=>le(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]})}),(0,D.jsxs)("form",{onSubmit:Ce,className:"p-6",children:[(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.email")," *"]}),(0,D.jsx)("input",{type:"email",name:"email",value:be.email,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.password")," *"]}),(0,D.jsx)("input",{type:"password",name:"password",value:be.password,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.firstName")," *"]}),(0,D.jsx)("input",{type:"text",name:"firstName",value:be.firstName,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.lastName")," *"]}),(0,D.jsx)("input",{type:"text",name:"lastName",value:be.lastName,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]})]}),(0,D.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>le(!1),className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.cancel")})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800",children:(0,D.jsx)(y.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("organisation.createUser.create")})]})]})]})]})})]}):(0,D.jsxs)(D.Fragment,{children:[ne&&!de&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",style:{opacity:ne?1:0,transition:"opacity 300ms ease-out"}}),(0,D.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(ne?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:ne?"auto":"none"},"aria-hidden":!ne,role:"dialog","aria-modal":ne,children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:r("organisation.createUser.title")}),(0,D.jsx)("button",{onClick:()=>le(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsx)("div",{className:"flex flex-col flex-1 min-h-0",children:(0,D.jsxs)("form",{onSubmit:Ce,className:"flex flex-col flex-1 min-h-0",children:[(0,D.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0 space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.email")," *"]}),(0,D.jsx)("input",{type:"email",name:"email",value:be.email,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.password")," *"]}),(0,D.jsx)("input",{type:"password",name:"password",value:be.password,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.firstName")," *"]}),(0,D.jsx)("input",{type:"text",name:"firstName",value:be.firstName,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("organisation.createUser.lastName")," *"]}),(0,D.jsx)("input",{type:"text",name:"lastName",value:be.lastName,onChange:Se,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white",required:!0})]})]}),(0,D.jsxs)("div",{className:"flex justify-end gap-3 border-t dark:border-gray-700 pt-4 px-4 flex-shrink-0",children:[(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>le(!1),className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.cancel")})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800",children:(0,D.jsx)(y.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("organisation.createUser.create")})]})]})]})})]})]})})]})};var H=r(3744),J=r(9248),Y=r(2517),Z=r(8010),X=r(4426),$=r(7829),Q=r(6507),ee=r(5365);const te=["dashboard","worktracker","cerebro","settings","profile"],re=["dashboard","worktracker","consultations","team_worktime_control","payroll","organization_management","cerebro","settings","profile"],ae=["requests","tasks","reservations","users","roles","organization","organization_join_requests","organization_users","team_worktime","worktime","clients","consultation_invoices","branches","notifications","settings","monthly_reports"],se=["database_reset_table","database_logs","invoice_create","invoice_download","invoice_mark_paid","invoice_settings","todo_create","todo_edit","todo_delete","task_create","task_edit","task_delete","user_create","user_edit","user_delete","role_assign","role_create","role_edit","role_delete","organization_create","organization_edit","organization_delete","worktime_start","worktime_stop","worktime_edit","worktime_delete","cerebro","consultation_start","consultation_stop","consultation_edit","client_create","client_edit","client_delete","settings_system","settings_notifications","settings_profile","payroll_generate","payroll_export","payroll_edit"],ne={requests:"dashboard",tasks:"worktracker",reservations:"worktracker",users:"organization_management",roles:"organization_management",organization:"organization_management",organization_join_requests:"organization_management",organization_users:"organization_management",team_worktime:"team_worktime_control",worktime:"worktracker",clients:"consultations",consultation_invoices:"consultations",branches:"settings",notifications:"general",settings:"settings",monthly_reports:"consultations"},le={database_reset_table:"settings",database_logs:"settings",invoice_create:"consultations",invoice_download:"consultations",invoice_mark_paid:"consultations",invoice_settings:"consultations",todo_create:"worktracker",todo_edit:"worktracker",todo_delete:"worktracker",task_create:"worktracker",task_edit:"worktracker",task_delete:"worktracker",user_create:"organization_management",user_edit:"organization_management",user_delete:"organization_management",role_assign:"organization_management",role_create:"organization_management",role_edit:"organization_management",role_delete:"organization_management",organization_create:"organization_management",organization_edit:"organization_management",organization_delete:"organization_management",worktime_start:"worktracker",worktime_stop:"worktracker",worktime_edit:"worktracker",worktime_delete:"worktracker",cerebro:"cerebro",consultation_start:"consultations",consultation_stop:"consultations",consultation_edit:"consultations",client_create:"consultations",client_edit:"consultations",client_delete:"consultations",settings_system:"settings",settings_notifications:"settings",settings_profile:"settings",payroll_generate:"payroll",payroll_export:"payroll",payroll_edit:"payroll"},ie={worktime_start:"worktime",worktime_stop:"worktime",worktime_edit:"worktime",worktime_delete:"worktime",task_create:"tasks",task_edit:"tasks",task_delete:"tasks",todo_create:"tasks",todo_edit:"tasks",todo_delete:"tasks",client_create:"clients",client_edit:"clients",client_delete:"clients",consultation_start:"clients",consultation_stop:"clients",consultation_edit:"clients",invoice_create:"consultation_invoices",invoice_download:"consultation_invoices",invoice_mark_paid:"consultation_invoices",invoice_settings:"consultation_invoices",user_create:"users",user_edit:"users",user_delete:"users",role_assign:"roles",role_create:"roles",role_edit:"roles",role_delete:"roles",organization_create:"organization",organization_edit:"organization",organization_delete:"organization",settings_system:"settings",settings_notifications:"settings",settings_profile:"settings",database_reset_table:null,database_logs:null,cerebro:null,payroll_generate:null,payroll_export:null,payroll_edit:null},oe="roles-table",de=[1,2,999],ce=["Admin","User","Hamburger"],me=(e,t)=>!!de.includes(e)||!(!t||!ce.includes(t)),ue=e=>{let{role:t,onEdit:r,onDelete:a,onCopy:n,canEdit:l,canDelete:i,canCopy:o}=e;const{t:d}=(0,s.Bd)();return(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4 mb-4",children:[(0,D.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,D.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t.name}),(0,D.jsxs)("div",{className:"flex space-x-2",children:[o&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>n(t),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1",children:(0,D.jsx)(H.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:d("roles.actions.copy")})]}),l&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>r(t),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1",children:(0,D.jsx)(S.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:d("roles.actions.edit")})]}),i&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>a(t.id),className:"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1",children:(0,D.jsx)(J.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:d("roles.actions.delete")})]})]})]}),(0,D.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.description||d("roles.noDescription")}),(0,D.jsx)("div",{className:"mt-2",children:(0,D.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.allBranches?(0,D.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300",children:d("roles.form.allBranches")||"Alle Branches"}):t.branches&&t.branches.length>0?(0,D.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300",children:[t.branches.length," ",d("roles.form.specificBranches")||"Branches"]}):(0,D.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400",children:d("roles.form.noBranches")||"Keine Branches"})})}),(0,D.jsxs)("div",{className:"mt-2",children:[(0,D.jsxs)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:[d("roles.permissions"),":"]}),(0,D.jsxs)("div",{className:"flex flex-wrap gap-1",children:[t.permissions.filter((e=>"none"!==e.accessLevel)).slice(0,8).map((e=>(0,D.jsxs)("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 px-2 py-1 rounded",children:[e.entity,": ",e.accessLevel]},"".concat(e.entity,"-").concat(e.entityType)))),t.permissions.filter((e=>"none"!==e.accessLevel)).length>8&&(0,D.jsxs)("span",{className:"text-xs bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-300 px-2 py-1 rounded",children:["+",t.permissions.filter((e=>"none"!==e.accessLevel)).length-8," ",d("common.showMore")]})]})]})]})},ge=e=>{let{onRolesChange:t,onError:r,readOnly:l=!1}=e;const{t:i}=(0,s.Bd)(),[o,d]=(0,a.useState)(!1),[x,b]=(0,a.useState)(null),[h,f]=(0,a.useState)([]),[k,v]=(0,a.useState)(!0),N=(0,a.useMemo)((()=>({dashboard:i("roles.pages.dashboard"),worktracker:i("roles.pages.worktracker"),consultations:i("roles.pages.consultations"),team_worktime_control:i("roles.pages.team_worktime_control"),payroll:i("roles.pages.payroll"),organization_management:i("roles.pages.organization_management"),cerebro:i("roles.pages.cerebro"),settings:i("roles.pages.settings"),profile:i("roles.pages.profile")})),[i]),A=(0,a.useMemo)((()=>({tasks:i("roles.tables.tasks"),reservations:i("roles.tables.reservations"),worktime:i("roles.tables.worktime"),users:i("roles.tables.users"),roles:i("roles.tables.roles"),organization:i("roles.tables.organization"),organization_join_requests:i("roles.tables.organization_join_requests"),organization_users:i("roles.tables.organization_users"),clients:i("roles.tables.clients"),consultation_invoices:i("roles.tables.consultation_invoices"),requests:i("roles.tables.requests"),team_worktime:i("roles.tables.team_worktime"),settings:i("roles.tables.settings"),notifications:i("roles.tables.notifications"),branches:i("roles.tables.branches"),monthly_reports:i("roles.tables.monthly_reports")})),[i]),S=(0,a.useMemo)((()=>({worktime_start:i("roles.buttons.worktime_start"),worktime_stop:i("roles.buttons.worktime_stop"),worktime_edit:i("roles.buttons.worktime_edit"),worktime_delete:i("roles.buttons.worktime_delete"),task_create:i("roles.buttons.task_create"),task_edit:i("roles.buttons.task_edit"),task_delete:i("roles.buttons.task_delete"),todo_create:i("roles.buttons.todo_create"),todo_edit:i("roles.buttons.todo_edit"),todo_delete:i("roles.buttons.todo_delete"),client_create:i("roles.buttons.client_create"),client_edit:i("roles.buttons.client_edit"),client_delete:i("roles.buttons.client_delete"),consultation_start:i("roles.buttons.consultation_start"),consultation_stop:i("roles.buttons.consultation_stop"),consultation_edit:i("roles.buttons.consultation_edit"),invoice_create:i("roles.buttons.invoice_create"),invoice_download:i("roles.buttons.invoice_download"),invoice_mark_paid:i("roles.buttons.invoice_mark_paid"),invoice_settings:i("roles.buttons.invoice_settings"),user_create:i("roles.buttons.user_create"),user_edit:i("roles.buttons.user_edit"),user_delete:i("roles.buttons.user_delete"),role_assign:i("roles.buttons.role_assign"),role_create:i("roles.buttons.role_create"),role_edit:i("roles.buttons.role_edit"),role_delete:i("roles.buttons.role_delete"),organization_create:i("roles.buttons.organization_create"),organization_edit:i("roles.buttons.organization_edit"),organization_delete:i("roles.buttons.organization_delete"),settings_system:i("roles.buttons.settings_system"),settings_notifications:i("roles.buttons.settings_notifications"),settings_profile:i("roles.buttons.settings_profile"),database_reset_table:i("roles.buttons.database_reset_table"),database_logs:i("roles.buttons.database_logs"),payroll_generate:i("roles.buttons.payroll_generate"),payroll_export:i("roles.buttons.payroll_export"),payroll_edit:i("roles.buttons.payroll_edit"),cerebro:i("roles.buttons.cerebro")})),[i]),[C,z]=(0,a.useState)({name:"",description:"",permissions:[...re.map((e=>({entity:e,entityType:"page",accessLevel:"none"}))),...ae.map((e=>({entity:e,entityType:"table",accessLevel:"none"}))),...se.map((e=>({entity:e,entityType:"button",accessLevel:"none"})))]}),[R,L]=(0,a.useState)(null),{hasPermission:P}=(0,n.S)(),[I,F]=(0,a.useState)(""),[T,_]=(0,a.useState)(!1),[B,O]=(0,a.useState)(!0),[U,M]=(0,a.useState)([]),[q,V]=(0,a.useState)([]),[K,G]=(0,a.useState)(!1),[W,H]=(0,a.useState)([]),[J,de]=(0,a.useState)([]),[ce,ge]=(0,a.useState)("Alle"),[xe,be]=(0,a.useState)(null),[he,pe]=(0,a.useState)(window.innerWidth<640),[ye,fe]=(0,a.useState)(window.innerWidth>1070),{openSidepane:ke,closeSidepane:ve}=(0,E.N)(),{handleError:je,handleValidationError:we}=(0,Q.qz)(),[Ne,Ae]=(0,a.useState)(!1),[Se,Ce]=(0,a.useState)(null),[ze,Re]=(0,a.useState)(10);(0,a.useEffect)((()=>{const e=()=>{pe(window.innerWidth<640),fe(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,a.useEffect)((()=>(o?ke():ve(),()=>{ve()})),[o,ke,ve]);const Le=(0,a.useCallback)((async()=>{G(!0);try{const e=await u.H_.getAll();V(e.data)}catch(R){console.error("Fehler beim Laden der Branches:",R)}finally{G(!1)}}),[]),Pe=(0,a.useCallback)((async()=>{v(!0),console.log("DEBUGAUSGABE: Hole Rollen vom Server...");try{const e=await u.Zj.getAll();console.log("DEBUGAUSGABE: Rollen erfolgreich geholt:",e.data),f(e.data),L(null)}catch(R){console.error("DEBUGAUSGABE: Fehler beim Abrufen der Rollen:",R),je(R,{component:"RoleManagementTab",action:"fetchRoles"}),r&&r("Fehler beim Laden der Rollen")}finally{v(!1)}}),[je,r]);(0,a.useEffect)((()=>{Pe()}),[Pe]),(0,a.useEffect)((()=>{o&&Le()}),[o,Le]);const Ee=async e=>{if(e.preventDefault(),L(null),B||0!==U.length)if(C.name){if(x){const e=C.permissions.map((e=>"page"===e.entityType&&te.includes(e.entity)?(0,c.A)((0,c.A)({},e),{},{accessLevel:"both"}):e)).filter((e=>"none"!==e.accessLevel)).map((e=>({entity:e.entity,entityType:e.entityType,accessLevel:e.accessLevel})));if(!x.id||isNaN(x.id))return console.warn("DEBUGAUSGABE: Ung\xfcltige Rollen-ID erkannt, Bearbeitung abgebrochen"),void je("Ung\xfcltige Rollen-ID, Bearbeitung abgebrochen",{component:"RoleManagementTab",roleId:x.id});if(me(x.id,x.name))return console.warn("DEBUGAUSGABE: Versuch, gesch\xfctzte Rolle mit ID ".concat(x.id," zu bearbeiten")),je({message:"Gesch\xfctzte Systemrollen k\xf6nnen nicht bearbeitet werden",name:"PermissionError"},{component:"RoleManagementTab",roleId:x.id,category:ee.h.PERMISSION}),void d(!1);if(!h.some((e=>e.id===x.id)))return console.error("DEBUGAUSGABE: Rolle mit ID ".concat(x.id," existiert nicht in der aktuellen Liste")),je("Rolle mit ID ".concat(x.id," existiert nicht mehr. Bitte aktualisieren Sie die Seite."),{component:"RoleManagementTab",roleId:x.id}),d(!1),void await Pe();console.log("DEBUGAUSGABE: Bearbeite Rolle mit ID ".concat(x.id));try{console.log("DEBUGAUSGABE: Sende Aktualisierung an API:",{name:C.name,description:C.description,permissions:e});const t={name:C.name,description:C.description,permissions:e,allBranches:B,branchIds:B?[]:U};console.log("DEBUGAUSGABE: Vor dem API-Aufruf roleApi.update");const r=await u.Zj.update(x.id,t);console.log("DEBUGAUSGABE: Nach dem API-Aufruf roleApi.update"),console.log("DEBUGAUSGABE: API-Antwort bei Rollenaktualisierung:",r),await Pe()}catch(r){return console.error("DEBUGAUSGABE: Fehler bei Rollenaktualisierung:",r),void(r.response?r.response.data.meta&&"Record to update not found."===r.response.data.meta.cause?(je("Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.",{component:"RoleManagementTab",roleId:x.id}),d(!1),await Pe()):je(r.response.data.message||"Fehler beim Aktualisieren der Rolle",{component:"RoleManagementTab",roleId:x.id}):je("Fehler beim Aktualisieren der Rolle",{component:"RoleManagementTab",roleId:x.id}))}}else try{const e=C.permissions.map((e=>"page"===e.entityType&&te.includes(e.entity)?(0,c.A)((0,c.A)({},e),{},{accessLevel:"both"}):e)).filter((e=>"none"!==e.accessLevel)).map((e=>({entity:e.entity,entityType:e.entityType,accessLevel:e.accessLevel})));console.log("DEBUGAUSGABE: Sende Daten an API f\xfcr neue Rolle:",{name:C.name,description:C.description,permissions:e});const t={name:C.name,description:C.description,permissions:e,allBranches:B,branchIds:B?[]:U};console.log("DEBUGAUSGABE: Vor dem API-Aufruf roleApi.create");const r=await u.Zj.create(t);console.log("DEBUGAUSGABE: Nach dem API-Aufruf roleApi.create"),console.log("DEBUGAUSGABE: API-Antwort beim Erstellen der Rolle:",r),await Pe()}catch(a){return console.error("DEBUGAUSGABE: Fehler bei API-Anfrage zum Erstellen der Rolle:",a),void(a.response?je(a.response.data.message||"Fehler beim Erstellen der Rolle",{component:"RoleManagementTab"}):je("Fehler beim Erstellen der Rolle",{component:"RoleManagementTab"}))}t&&t(),d(!1),Te()}else we("Rollenname darf nicht leer sein",{name:"Rollenname ist erforderlich"});else je(i("roles.form.branchSelectionRequired")||'Bitte w\xe4hlen Sie mindestens eine Branch aus oder aktivieren Sie "F\xfcr alle Branches g\xfcltig"',{component:"RoleManagementTab"})},De=async e=>{if(!e||isNaN(e))return console.warn("Ung\xfcltige Rollen-ID erkannt, L\xf6schvorgang abgebrochen"),void je("Ung\xfcltige Rollen-ID, L\xf6schvorgang abgebrochen",{component:"RoleManagementTab",roleId:e});const r=h.find((t=>t.id===e));if(r&&me(e,r.name))return console.warn("Versuch, gesch\xfctzte Rolle mit ID ".concat(e," (").concat(r.name,") zu l\xf6schen")),void je("Gesch\xfctzte Systemrollen k\xf6nnen nicht gel\xf6scht werden",{component:"RoleManagementTab",roleId:e});if(window.confirm("M\xf6chten Sie diese Rolle wirklich l\xf6schen?"))try{console.log("Starte L\xf6schvorgang f\xfcr Rolle mit ID ".concat(e));if(!h.some((t=>t.id===e)))return console.error("Rolle mit ID ".concat(e," existiert nicht in der aktuellen Liste")),je("Rolle mit ID ".concat(e," existiert nicht mehr. Bitte aktualisieren Sie die Seite."),{component:"RoleManagementTab",roleId:e}),void await Pe();console.log("Sende L\xf6schanfrage an API");try{const t=await u.Zj.delete(e);console.log("API-Antwort beim L\xf6schen der Rolle:",t),await Pe(),console.log("Rollenliste nach L\xf6schen aktualisiert")}catch(a){return console.error("API-Fehler beim L\xf6schen der Rolle:",a),void(a.response?(console.error("API-Fehlerdaten:",a.response.data),a.response.data.meta&&"Record to delete does not exist."===a.response.data.meta.cause?(je("Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.",{component:"RoleManagementTab",roleId:e}),await Pe()):je(a.response.data.message||i("roleManagement.deleteError"),{component:"RoleManagementTab",roleId:e})):je(i("roleManagement.networkError"),{component:"RoleManagementTab",roleId:e}))}console.log("Rolle erfolgreich gel\xf6scht"),t&&t()}catch(s){console.error(i("roleManagement.unhandledError"),s),je(s);try{await Pe()}catch(n){console.error("Fehler beim Aktualisieren der Rollenliste nach fehlgeschlagenem L\xf6schvorgang:",n)}}},Ie=async e=>{try{if(!e||!e.id)return void je("Ung\xfcltige Rolle zum Kopieren",{component:"RoleManagementTab"});const r={name:"".concat(e.name,"-Kopie"),description:e.description||"",permissions:e.permissions.filter((e=>"none"!==e.accessLevel)).map((e=>({entity:e.entity,entityType:e.entityType,accessLevel:e.accessLevel})))};console.log("DEBUGAUSGABE: Kopiere Rolle:",e.name,"mit Daten:",r);const a=await u.Zj.create(r);console.log("DEBUGAUSGABE: Rolle erfolgreich kopiert:",a.data),f((e=>[a.data,...e])),Fe(a.data),t&&t()}catch(r){console.error("DEBUGAUSGABE: Fehler beim Kopieren der Rolle:",r),je(r,{component:"RoleManagementTab",roleId:e.id})}},Fe=async e=>{if(me(e.id,e.name))return void je("Gesch\xfctzte Systemrollen k\xf6nnen nicht bearbeitet werden",{component:"RoleManagementTab",roleId:e.id});const t=[...re.map((e=>({entity:e,entityType:"page",accessLevel:te.includes(e)?"both":"none"}))),...ae.map((e=>({entity:e,entityType:"table",accessLevel:"none"}))),...se.map((e=>({entity:e,entityType:"button",accessLevel:"none"})))];if(e.permissions.forEach((e=>{const r=t.findIndex((t=>t.entity===e.entity&&t.entityType===e.entityType));-1!==r&&("page"===e.entityType&&te.includes(e.entity)?t[r].accessLevel="both":t[r].accessLevel=e.accessLevel)})),z({name:e.name,description:e.description||"",permissions:t}),e.id)try{var r;const t=(await u.Zj.getRoleBranches(e.id)).data;O(t.allBranches||!1),M((null===(r=t.branches)||void 0===r?void 0:r.map((e=>e.id)))||[])}catch(R){console.error("Fehler beim Laden der Branch-Zuweisungen:",R),O(!0),M([])}b(e),d(!0)},Te=()=>{b(null),O(!0),M([]),z({name:"",description:"",permissions:[...re.map((e=>({entity:e,entityType:"page",accessLevel:te.includes(e)?"both":"none"}))),...ae.map((e=>({entity:e,entityType:"table",accessLevel:"none"}))),...se.map((e=>({entity:e,entityType:"button",accessLevel:"none"})))]})},_e=e=>{const t=[...C.permissions];C.permissions.filter((e=>"page"===e.entityType&&!te.includes(e.entity))).forEach((r=>{const a=C.permissions.indexOf(r);t[a]=(0,c.A)((0,c.A)({},r),{},{accessLevel:e})})),z((0,c.A)((0,c.A)({},C),{},{permissions:t}))},Be=e=>{const t=[...C.permissions];C.permissions.filter((e=>"table"===e.entityType)).forEach((r=>{const a=C.permissions.indexOf(r);t[a]=(0,c.A)((0,c.A)({},r),{},{accessLevel:e})})),z((0,c.A)((0,c.A)({},C),{},{permissions:t}))},Oe=e=>{const t=[...C.permissions];C.permissions.filter((e=>"button"===e.entityType)).forEach((r=>{const a=C.permissions.indexOf(r);t[a]=(0,c.A)((0,c.A)({},r),{},{accessLevel:e})})),z((0,c.A)((0,c.A)({},C),{},{permissions:t}))},Ue=()=>W.length,Me=(0,a.useMemo)((()=>h.filter((e=>{if(I){const t=I.toLowerCase();if(!(e.name.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)))return!1}if(W.length>0){let t=W.length>0;for(let r=0;r<W.length;r++){const a=W[r];let s=!1;switch(a.column){case"name":"equals"===a.operator?s=e.name.toLowerCase()===(a.value||"").toLowerCase():"contains"===a.operator?s=e.name.toLowerCase().includes((a.value||"").toLowerCase()):"startsWith"===a.operator&&(s=e.name.toLowerCase().startsWith((a.value||"").toLowerCase()));break;case"description":if(!e.description){s=!1;break}"equals"===a.operator?s=e.description.toLowerCase()===(a.value||"").toLowerCase():"contains"===a.operator?s=e.description.toLowerCase().includes((a.value||"").toLowerCase()):"startsWith"===a.operator&&(s=e.description.toLowerCase().startsWith((a.value||"").toLowerCase()));break;case"permissions":const t=a.value,r=e.permissions.filter((e=>e.accessLevel===t)).length;("greaterThan"===a.operator||"equals"===a.operator)&&(s=r>0)}if(0===r)t=s;else{t="AND"===J[r-1]?t&&s:t||s}}if(!t)return!1}return!0})).sort(((e,t)=>e.name.localeCompare(t.name)))),[h,I,W,J]);(0,a.useEffect)((()=>{(async()=>{try{if(!localStorage.getItem("token"))return void console.error("Nicht authentifiziert");const e=(await j.A.get(w.Sn.SAVED_FILTERS.BY_TABLE(oe))).data||[];if(!e.some((e=>"Alle"===e.name))){const e={tableId:oe,name:"Alle",conditions:[],operators:[]};await j.A.post(w.Sn.SAVED_FILTERS.BASE,e),console.log("Alle-Filter f\xfcr Rollen erstellt")}}catch(R){console.error("Fehler beim Erstellen der Standard-Filter:",R)}})()}),[]),(0,a.useEffect)((()=>{(async()=>{try{const e=await j.A.get(w.Sn.SAVED_FILTERS.BY_TABLE(oe)),t=e.data.find((e=>"Alle"===e.name));t&&(ge("Alle"),be(t.id),qe(t.conditions,t.operators))}catch(R){console.error("Fehler beim Setzen des initialen Filters:",R)}})()}),[]);const qe=(e,t)=>{H(e),de(t)},Ve=()=>{H([]),de([]),ge(""),be(null)};return(0,D.jsxs)("div",{children:[(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsx)("div",{className:"flex items-center",children:!l&&P("roles","write","table")&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>d(!0),className:"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":i("roles.createRole"),children:(0,D.jsx)(g.A,{className:"h-4 w-4"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.createRole")})]})}),(0,D.jsx)("div",{}),(0,D.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,D.jsx)("input",{type:"text",placeholder:"Suchen...",className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:I,onChange:e=>F(e.target.value)}),(0,D.jsxs)("div",{className:"relative group ml-1",children:[(0,D.jsxs)("button",{className:"p-2 rounded-md ".concat(Ue()>0?"bg-blue-50 text-blue-600":"hover:bg-gray-100"),onClick:()=>_(!T),children:[(0,D.jsx)(Z.A,{className:"w-5 h-5"}),Ue()>0&&(0,D.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center",children:Ue()})]}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Filter"})]})]})]}),T&&(0,D.jsx)(X.A,{columns:[{id:"name",label:"Name"},{id:"description",label:"Beschreibung"},{id:"permissions",label:"Berechtigungen"}],onApply:qe,onReset:Ve,savedConditions:W,savedOperators:J,tableId:oe}),(0,D.jsx)($.A,{tableId:oe,onSelectFilter:qe,onReset:Ve,activeFilterName:ce,selectedFilterId:xe,onFilterChange:(e,t,r,a)=>{ge(e),be(t),qe(r,a)},defaultFilterName:"Alle"}),k?(0,D.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,D.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):0===h.length?(0,D.jsx)("div",{className:"p-4 bg-gray-50 rounded text-center",children:(0,D.jsx)("p",{children:"Keine Rollen gefunden. Erstellen Sie eine neue Rolle mit dem Button oben."})}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{className:"space-y-4",children:Me.slice(0,ze).map((e=>(0,D.jsx)(ue,{role:e,onEdit:Fe,onDelete:De,onCopy:Ie,canEdit:!l&&P("roles","write","table")&&!me(e.id,e.name),canDelete:!l&&P("roles","write","table")&&!me(e.id,e.name),canCopy:!l&&P("roles","write","table")&&me(e.id,e.name)},e.id)))}),Me.length>ze&&(0,D.jsx)("div",{className:"mt-4 flex justify-center",children:(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{className:"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700",onClick:()=>Re((e=>e+10)),children:(0,D.jsx)(Y.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Mehr anzeigen (".concat(Me.length-ze," verbleibend)")})]})})]})]}),o&&(0,D.jsx)(D.Fragment,{children:he?(0,D.jsxs)(m.lG,{open:o,onClose:()=>d(!1),className:"relative z-50",children:[(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,D.jsxs)(m.lG.Panel,{className:"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden",children:[(0,D.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0",children:(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsx)(m.lG.Title,{className:"text-lg font-semibold dark:text-white",children:i(x?"roles.editRole":"roles.createRole")}),(0,D.jsx)("button",{onClick:()=>d(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]})}),(0,D.jsxs)("form",{onSubmit:Ee,className:"flex flex-col flex-1 min-h-0",children:[(0,D.jsx)("div",{className:"flex-1 overflow-y-auto min-h-0",children:(0,D.jsxs)("div",{className:"p-6 space-y-5",children:[(0,D.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Name"}),(0,D.jsx)("input",{type:"text",value:C.name,onChange:e=>z((0,c.A)((0,c.A)({},C),{},{name:e.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Beschreibung"}),(0,D.jsx)("input",{type:"text",value:C.description,onChange:e=>z((0,c.A)((0,c.A)({},C),{},{description:e.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white"})]})]}),(0,D.jsxs)("div",{className:"mt-4",children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("roles.form.branchAssignment")||"Branch-Zuweisung"}),(0,D.jsxs)("div",{className:"space-y-3",children:[(0,D.jsxs)("label",{className:"flex items-center",children:[(0,D.jsx)("input",{type:"checkbox",checked:B,onChange:e=>{O(e.target.checked),e.target.checked&&M([])},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,D.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:i("roles.form.allBranches")||"F\xfcr alle Branches g\xfcltig"})]}),!B&&(0,D.jsxs)("div",{className:"ml-6",children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("roles.form.specificBranches")||"Spezifische Branches:"}),K?(0,D.jsx)("div",{className:"text-sm text-gray-500",children:"Lade Branches..."}):0===q.length?(0,D.jsx)("div",{className:"text-sm text-gray-500",children:"Keine Branches verf\xfcgbar"}):(0,D.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2",children:q.map((e=>(0,D.jsxs)("label",{className:"flex items-center",children:[(0,D.jsx)("input",{type:"checkbox",checked:U.includes(e.id),onChange:t=>{t.target.checked?M([...U,e.id]):M(U.filter((t=>t!==e.id)))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,D.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:e.name})]},e.id)))})]})]})]}),(0,D.jsxs)("div",{className:"mt-2",children:[(0,D.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2",children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("roles.form.detailedPermissions")}),(0,D.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>_e("both"),className:"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800",children:i("roles.form.pagesChecked")}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.form.activateAllPages")})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>_e("none"),className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600",children:i("roles.form.pagesUnchecked")}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.form.deactivateAllPages")})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>Be("both"),className:"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800",children:i("roles.form.tablesChecked")}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.form.activateAllTables")})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>Be("none"),className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600",children:i("roles.form.tablesUnchecked")}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.form.deactivateAllTables")})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>Oe("both"),className:"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800",children:i("roles.form.buttonsChecked")}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.form.activateAllButtons")})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>Oe("none"),className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600",children:i("roles.form.buttonsUnchecked")}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("roles.form.deactivateAllButtons")})]})]})]}),(0,D.jsx)("div",{className:"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600",children:C.permissions.filter((e=>"page"===e.entityType)).map(((e,t)=>{const r=C.permissions.indexOf(e),a="both"===e.accessLevel;return(0,D.jsxs)("div",{children:[(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:N[e.entity]||e.entity}),(0,D.jsxs)("label",{className:"inline-flex items-center ".concat(te.includes(e.entity)?"cursor-not-allowed opacity-80":"cursor-pointer"),children:[(0,D.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:a,disabled:te.includes(e.entity),onChange:()=>{const t=[...C.permissions];t[r]=(0,c.A)((0,c.A)({},e),{},{accessLevel:a?"none":"both"}),z((0,c.A)((0,c.A)({},C),{},{permissions:t}))}}),(0,D.jsx)("div",{className:"relative w-11 h-6 ".concat(te.includes(e.entity)?"bg-blue-600 dark:bg-blue-700":"bg-gray-200 dark:bg-gray-700"," peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"),children:te.includes(e.entity)&&(0,D.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-xs text-white font-medium",children:"Fix"})})]})]}),C.permissions.filter((t=>"table"===t.entityType&&ne[t.entity]===e.entity)).sort(((e,t)=>{const r=A[e.entity]||e.entity,a=A[t.entity]||t.entity,s=["users","roles","organization"],n=s.indexOf(e.entity),l=s.indexOf(t.entity);return-1!==n&&-1!==l?n-l:-1!==n?-1:-1!==l?1:r.localeCompare(a)})).map(((t,r)=>{const a=C.permissions.indexOf(t),s="both"===t.accessLevel,n=t.entity,l=A[n]||n,o=C.permissions.filter((t=>"button"===t.entityType&&le[t.entity]===e.entity&&ie[t.entity]===n&&!("tasks"===n&&t.entity.startsWith("todo_")))).sort(((e,t)=>{const r=S[e.entity]||e.entity,a=S[t.entity]||t.entity,s=[i("roleManagement.buttonOrder.start"),i("roleManagement.buttonOrder.stop"),i("roleManagement.buttonOrder.create"),i("roleManagement.buttonOrder.edit"),i("roleManagement.buttonOrder.delete")],n=s.indexOf(r),l=s.indexOf(a);return-1!==n&&-1!==l?n-l:-1!==n?-1:-1!==l?1:r.localeCompare(a)}));return(0,D.jsxs)("div",{className:"mt-3",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600",children:[(0,D.jsxs)("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:["\u2514 ",l]}),(0,D.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:s,onChange:()=>{const e=[...C.permissions];e[a]=(0,c.A)((0,c.A)({},t),{},{accessLevel:s?"none":"both"}),z((0,c.A)((0,c.A)({},C),{},{permissions:e}))}}),(0,D.jsx)("div",{className:"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"})]})]}),o.map(((e,t)=>{const r=C.permissions.indexOf(e),a="both"===e.accessLevel,s=S[e.entity]||e.entity;return(0,D.jsxs)("div",{className:"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600",children:[(0,D.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["\u2514 ",s]}),(0,D.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:a,onChange:()=>{const t=[...C.permissions];t[r]=(0,c.A)((0,c.A)({},e),{},{accessLevel:a?"none":"both"}),z((0,c.A)((0,c.A)({},C),{},{permissions:t}))}}),(0,D.jsx)("div",{className:"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"})]})]},"button-permission-".concat(e.entity,"-").concat(t))}))]},"table-permission-".concat(n,"-").concat(r))})),C.permissions.filter((t=>"button"===t.entityType&&le[t.entity]===e.entity&&!ie[t.entity])).sort(((e,t)=>{const r=S[e.entity]||e.entity,a=S[t.entity]||t.entity;return r.localeCompare(a)})).map(((e,t)=>{const r=C.permissions.indexOf(e),a="both"===e.accessLevel,s=S[e.entity]||e.entity;return(0,D.jsxs)("div",{className:"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600",children:[(0,D.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["\u2514 ",s]}),(0,D.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:a,onChange:()=>{const t=[...C.permissions];t[r]=(0,c.A)((0,c.A)({},e),{},{accessLevel:a?"none":"both"}),z((0,c.A)((0,c.A)({},C),{},{permissions:t}))}}),(0,D.jsx)("div",{className:"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"})]})]},"button-permission-".concat(e.entity,"-").concat(t))}))]},"permission-page-".concat(e.entity,"-").concat(t))}))})]})]})}),(0,D.jsxs)("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-end gap-2 border-t dark:border-gray-600 flex-shrink-0",children:[(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>d(!1),className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Abbrechen"})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800",children:(0,D.jsx)(y.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:x?"Aktualisieren":"Erstellen"})]})]})]})]})})]}):(0,D.jsxs)(D.Fragment,{children:[o&&!ye&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",style:{opacity:o?1:0,transition:"opacity 300ms ease-out"}}),(0,D.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(o?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:o?"auto":"none"},"aria-hidden":!o,role:"dialog","aria-modal":o,children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:x?"Rolle bearbeiten":"Neue Rolle erstellen"}),(0,D.jsx)("button",{onClick:()=>d(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsx)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:(0,D.jsxs)("form",{onSubmit:Ee,className:"space-y-5",children:[(0,D.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("roles.form.name")}),(0,D.jsx)("input",{type:"text",value:C.name,onChange:e=>z((0,c.A)((0,c.A)({},C),{},{name:e.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("roles.form.description")}),(0,D.jsx)("input",{type:"text",value:C.description,onChange:e=>z((0,c.A)((0,c.A)({},C),{},{description:e.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white"})]})]}),(0,D.jsxs)("div",{className:"mt-2",children:[(0,D.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2",children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Detaillierte Berechtigungen"}),(0,D.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>_e("both"),className:"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800",children:"Seiten \u2713"}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Alle Seiten aktivieren"})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>_e("none"),className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600",children:"Seiten \u2717"}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Alle Seiten deaktivieren"})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>Be("both"),className:"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800",children:"Tabellen \u2713"}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Alle Tabellen aktivieren"})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>Be("none"),className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600",children:"Tabellen \u2717"}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Alle Tabellen deaktivieren"})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>Oe("both"),className:"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800",children:"Buttons \u2713"}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Alle Buttons aktivieren"})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>Oe("none"),className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600",children:"Buttons \u2717"}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Alle Buttons deaktivieren"})]})]})]}),(0,D.jsx)("div",{className:"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600 max-h-[60vh]",children:C.permissions.filter((e=>"page"===e.entityType)).map(((e,t)=>{const r=C.permissions.indexOf(e),a="both"===e.accessLevel;return(0,D.jsxs)("div",{children:[(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:N[e.entity]||e.entity}),(0,D.jsxs)("label",{className:"inline-flex items-center ".concat(te.includes(e.entity)?"cursor-not-allowed opacity-80":"cursor-pointer"),children:[(0,D.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:a,disabled:te.includes(e.entity),onChange:()=>{const t=[...C.permissions];t[r]=(0,c.A)((0,c.A)({},e),{},{accessLevel:a?"none":"both"}),z((0,c.A)((0,c.A)({},C),{},{permissions:t}))}}),(0,D.jsx)("div",{className:"relative w-11 h-6 ".concat(te.includes(e.entity)?"bg-blue-600 dark:bg-blue-700":"bg-gray-200 dark:bg-gray-700"," peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"),children:te.includes(e.entity)&&(0,D.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-xs text-white font-medium",children:"Fix"})})]})]}),C.permissions.filter((t=>"table"===t.entityType&&ne[t.entity]===e.entity)).sort(((e,t)=>{const r=A[e.entity]||e.entity,a=A[t.entity]||t.entity;return r.localeCompare(a)})).map(((t,r)=>{const a=C.permissions.indexOf(t),s="both"===t.accessLevel,n=t.entity,l=A[n]||n,o=C.permissions.filter((t=>"button"===t.entityType&&le[t.entity]===e.entity&&ie[t.entity]===n&&!("tasks"===n&&t.entity.startsWith("todo_")))).sort(((e,t)=>{const r=S[e.entity]||e.entity,a=S[t.entity]||t.entity,s=[i("roleManagement.buttonOrder.start"),i("roleManagement.buttonOrder.stop"),i("roleManagement.buttonOrder.create"),i("roleManagement.buttonOrder.edit"),i("roleManagement.buttonOrder.delete")],n=s.indexOf(r),l=s.indexOf(a);return-1!==n&&-1!==l?n-l:-1!==n?-1:-1!==l?1:r.localeCompare(a)}));return(0,D.jsxs)("div",{className:"mt-3",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600",children:[(0,D.jsxs)("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:["\u2514 ",l]}),(0,D.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:s,onChange:()=>{const e=[...C.permissions];e[a]=(0,c.A)((0,c.A)({},t),{},{accessLevel:s?"none":"both"}),z((0,c.A)((0,c.A)({},C),{},{permissions:e}))}}),(0,D.jsx)("div",{className:"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"})]})]}),o.map(((e,t)=>{const r=C.permissions.indexOf(e),a="both"===e.accessLevel,s=S[e.entity]||e.entity;return(0,D.jsxs)("div",{className:"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600",children:[(0,D.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["\u2514 ",s]}),(0,D.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:a,onChange:()=>{const t=[...C.permissions];t[r]=(0,c.A)((0,c.A)({},e),{},{accessLevel:a?"none":"both"}),z((0,c.A)((0,c.A)({},C),{},{permissions:t}))}}),(0,D.jsx)("div",{className:"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"})]})]},"button-permission-desktop-".concat(e.entity,"-").concat(t))}))]},"table-permission-desktop-".concat(n,"-").concat(r))})),C.permissions.filter((t=>"button"===t.entityType&&le[t.entity]===e.entity&&!ie[t.entity])).sort(((e,t)=>{const r=S[e.entity]||e.entity,a=S[t.entity]||t.entity;return r.localeCompare(a)})).map(((e,t)=>{const r=C.permissions.indexOf(e),a="both"===e.accessLevel,s=S[e.entity]||e.entity;return(0,D.jsxs)("div",{className:"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600",children:[(0,D.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["\u2514 ",s]}),(0,D.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:a,onChange:()=>{const t=[...C.permissions];t[r]=(0,c.A)((0,c.A)({},e),{},{accessLevel:a?"none":"both"}),z((0,c.A)((0,c.A)({},C),{},{permissions:t}))}}),(0,D.jsx)("div",{className:"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700"})]})]},"button-permission-desktop-".concat(e.entity,"-").concat(t))}))]},"permission-page-desktop-".concat(e.entity,"-").concat(t))}))})]}),(0,D.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:()=>d(!1),className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Abbrechen"})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors",children:(0,D.jsx)(y.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:x?"Aktualisieren":"Erstellen"})]})]})]})})]})]})})]})},xe=e=>{let{branch:t,onEdit:r,onDelete:a,canEdit:n,canDelete:l}=e;const{t:i}=(0,s.Bd)();return(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4",children:(0,D.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,D.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:t.name}),(0,D.jsxs)("div",{className:"flex space-x-2",children:[n&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>r(t),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1",children:(0,D.jsx)(S.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("common.edit",{defaultValue:"Bearbeiten"})})]}),l&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>a(t.id),className:"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1",children:(0,D.jsx)(J.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("common.delete",{defaultValue:"L\xf6schen"})})]})]})]})})},be="branches-table",he=e=>{let{onError:t}=e;const{t:r}=(0,s.Bd)(),[l,i]=(0,a.useState)(!1),[o,d]=(0,a.useState)(null),[u,x]=(0,a.useState)([]),[b,h]=(0,a.useState)(!0),[f,k]=(0,a.useState)({name:"",whatsappSettings:{provider:"whatsapp-business-api",apiKey:"",apiSecret:"",phoneNumberId:"",ai:{enabled:!1,model:"gpt-4o",systemPrompt:"",rules:[],sources:[],temperature:.7,maxTokens:500}},lobbyPmsSettings:{apiUrl:"",apiKey:"",propertyId:"",autoCreateTasks:!1,lateCheckInThreshold:"22:00",notificationChannels:["email"],autoSendInvitation:!1},boldPaymentSettings:{apiKey:"",merchantId:"",environment:"sandbox"},doorSystemSettings:{clientId:"",clientSecret:"",username:"",password:"",apiUrl:"https://euopen.ttlock.com",lockIds:[],appName:"TTLock"},emailSettings:{smtpHost:"",smtpPort:587,smtpUser:"",smtpPass:"",smtpFromEmail:"",smtpFromName:"",imap:{enabled:!1,host:"",port:993,secure:!0,user:"",password:"",folder:"INBOX",processedFolder:""}}}),[v,N]=(0,a.useState)("whatsapp"),[A,S]=(0,a.useState)({}),[C,z]=(0,a.useState)(""),[R,L]=(0,a.useState)(!1),[P,I]=(0,a.useState)([]),[F,T]=(0,a.useState)([]),[_,B]=(0,a.useState)(""),[O,U]=(0,a.useState)(null),[M,q]=(0,a.useState)(10),{hasPermission:V}=(0,n.S)(),{openSidepane:K,closeSidepane:G}=(0,E.N)(),W=V("branches","write","table"),H=V("branches","write","table"),J=V("branches","write","table"),Y=(0,a.useCallback)((async()=>{h(!0);try{const e=await j.A.get(w.Sn.BRANCHES.BASE);x(e.data)}catch(s){var e,a;console.error("Fehler beim Laden der Niederlassungen:",s);const n=(null===(e=s.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||r("branches.loadError");t(n)}finally{h(!1)}}),[t]);(0,a.useEffect)((()=>{Y()}),[Y]),(0,a.useEffect)((()=>(l?K():G(),()=>{G()})),[l,K,G]);const Q=()=>{k({name:"",whatsappSettings:{provider:"whatsapp-business-api",apiKey:"",apiSecret:"",phoneNumberId:"",ai:{enabled:!1,model:"gpt-4o",systemPrompt:"",rules:[],sources:[],temperature:.7,maxTokens:500}},lobbyPmsSettings:{apiUrl:"",apiKey:"",propertyId:"",autoCreateTasks:!1,lateCheckInThreshold:"22:00",notificationChannels:["email"],autoSendInvitation:!1},boldPaymentSettings:{apiKey:"",merchantId:"",environment:"sandbox"},doorSystemSettings:{clientId:"",clientSecret:"",username:"",password:"",apiUrl:"https://euopen.ttlock.com",lockIds:[],appName:"TTLock"},sireSettings:{enabled:!1,autoRegisterOnCheckIn:!1,apiUrl:"",apiKey:"",apiSecret:"",propertyCode:""},emailSettings:{smtpHost:"",smtpPort:587,smtpUser:"",smtpPass:"",smtpFromEmail:"",smtpFromName:"",imap:{enabled:!1,host:"",port:993,secure:!0,user:"",password:"",folder:"INBOX",processedFolder:""}}}),N("whatsapp"),d(null)},ee=async e=>{d(e);const t=e.whatsappSettings||{},r=e.lobbyPmsSettings||{},a=e.boldPaymentSettings||{},s=e.doorSystemSettings||{},n=e.emailSettings||{};k({name:e.name,whatsappSettings:{provider:t.provider||"whatsapp-business-api",apiKey:t.apiKey||"",apiSecret:t.apiSecret||"",phoneNumberId:t.phoneNumberId||"",ai:t.ai||{enabled:!1,model:"gpt-4o",systemPrompt:"",rules:[],sources:[],temperature:.7,maxTokens:500}},lobbyPmsSettings:{apiUrl:r.apiUrl||"",apiKey:r.apiKey||"",propertyId:r.propertyId||"",autoCreateTasks:r.autoCreateTasks||!1,lateCheckInThreshold:r.lateCheckInThreshold||"22:00",notificationChannels:r.notificationChannels||["email"],autoSendInvitation:r.autoSendInvitation||!1},boldPaymentSettings:{apiKey:a.apiKey||"",merchantId:a.merchantId||"",environment:a.environment||"sandbox"},doorSystemSettings:{clientId:s.clientId||"",clientSecret:s.clientSecret||"",username:s.username||"",password:s.password||"",apiUrl:s.apiUrl||"https://euopen.ttlock.com",lockIds:s.lockIds||[],appName:s.appName||"TTLock"},emailSettings:{smtpHost:n.smtpHost||"",smtpPort:n.smtpPort||587,smtpUser:n.smtpUser||"",smtpPass:n.smtpPass||"",smtpFromEmail:n.smtpFromEmail||"",smtpFromName:n.smtpFromName||"",imap:n.imap||{enabled:!1,host:"",port:993,secure:!0,user:"",password:"",folder:"INBOX",processedFolder:""}}}),i(!0)},te=()=>{i(!1),Q()},re=async e=>{if(e.preventDefault(),f.name.trim())try{o?await j.A.put(w.Sn.BRANCHES.UPDATE(o.id),{name:f.name.trim(),whatsappSettings:f.whatsappSettings,lobbyPmsSettings:f.lobbyPmsSettings,boldPaymentSettings:f.boldPaymentSettings,doorSystemSettings:f.doorSystemSettings,emailSettings:f.emailSettings}):await j.A.post(w.Sn.BRANCHES.CREATE,{name:f.name.trim()}),await Y(),te()}catch(n){var a,s;console.error("Fehler beim Speichern der Niederlassung:",n);const e=(null===(a=n.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||r("branches.saveError");t(e)}else t(r("branches.nameRequired"))},ae=async e=>{if(window.confirm(r("branches.deleteConfirm",{defaultValue:"M\xf6chten Sie diese Niederlassung wirklich l\xf6schen?"})))try{await j.A.delete(w.Sn.BRANCHES.DELETE(e)),await Y()}catch(n){var a,s;console.error("Fehler beim L\xf6schen der Niederlassung:",n);const e=(null===(a=n.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||r("branches.deleteError");t(e)}},se=()=>P.length,ne=(0,a.useMemo)((()=>u.filter((e=>{if(C){const t=C.toLowerCase();if(!e.name.toLowerCase().includes(t))return!1}if(P.length>0){let t=P.length>0;for(let r=0;r<P.length;r++){const a=P[r];let s=!1;if("name"===a.column)"equals"===a.operator?s=e.name.toLowerCase()===(a.value||"").toLowerCase():"contains"===a.operator?s=e.name.toLowerCase().includes((a.value||"").toLowerCase()):"startsWith"===a.operator&&(s=e.name.toLowerCase().startsWith((a.value||"").toLowerCase()));if(0===r)t=s;else{t="AND"===F[r-1]?t&&s:t||s}}if(!t)return!1}return!0})).sort(((e,t)=>e.name.localeCompare(t.name)))),[u,C,P,F]),le=(e,t)=>{I(e),T(t)},ie=()=>{I([]),T([]),B(""),U(null)};(0,a.useEffect)((()=>{(async()=>{try{if(!localStorage.getItem("token"))return void console.error(r("common.notAuthenticated"));const e=(await j.A.get(w.Sn.SAVED_FILTERS.BY_TABLE(be))).data||[];if(!e.some((e=>"Alle"===e.name))){const e={tableId:be,name:"Alle",conditions:[],operators:[]};await j.A.post(w.Sn.SAVED_FILTERS.BASE,e),console.log(r("branches.filterCreated"))}}catch(e){console.error(r("branches.createStandardFiltersError"),e)}})()}),[]),(0,a.useEffect)((()=>{(async()=>{try{const e=await j.A.get(w.Sn.SAVED_FILTERS.BY_TABLE(be)),t=e.data.find((e=>"Alle"===e.name));t&&(B("Alle"),U(t.id),le(t.conditions,t.operators))}catch(e){console.error(r("branches.setInitialFilterError"),e)}})()}),[]);const[oe,de]=(0,a.useState)(window.innerWidth<640);return(0,a.useEffect)((()=>{const e=()=>{de(window.innerWidth<640)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,D.jsxs)("div",{children:[(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsx)("div",{className:"flex items-center",children:W&&(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{onClick:()=>{Q(),i(!0)},className:"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":r("branches.create",{defaultValue:"Neue Niederlassung"}),children:(0,D.jsx)(g.A,{className:"h-4 w-4"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("branches.create",{defaultValue:"Neue Niederlassung"})})]})}),(0,D.jsx)("div",{}),(0,D.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,D.jsx)("input",{type:"text",placeholder:r("common.search",{defaultValue:"Suchen..."}),className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:C,onChange:e=>z(e.target.value)}),(0,D.jsxs)("div",{className:"relative group ml-1",children:[(0,D.jsxs)("button",{className:"p-2 rounded-md ".concat(se()>0?"bg-blue-50 text-blue-600":"hover:bg-gray-100"," relative"),onClick:()=>L(!R),children:[(0,D.jsx)(Z.A,{className:"w-5 h-5"}),se()>0&&(0,D.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center",children:se()})]}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.filter",{defaultValue:"Filter"})})]})]})]}),R&&(0,D.jsx)(X.A,{columns:[{id:"name",label:r("branches.name",{defaultValue:"Name"})}],onApply:le,onReset:ie,savedConditions:P,savedOperators:F,tableId:be}),(0,D.jsx)($.A,{tableId:be,onSelectFilter:le,onReset:ie,activeFilterName:_,selectedFilterId:O,onFilterChange:(e,t,r,a)=>{B(e),U(t),le(r,a)},defaultFilterName:"Alle"}),b?(0,D.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,D.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):0===ne.length?(0,D.jsx)("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded text-center",children:(0,D.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:r("branches.noBranches",{defaultValue:"Keine Niederlassungen gefunden. Erstellen Sie eine neue Niederlassung mit dem Button oben."})})}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{className:"space-y-4",children:ne.slice(0,M).map((e=>(0,D.jsx)(xe,{branch:e,onEdit:ee,onDelete:ae,canEdit:H,canDelete:J},e.id)))}),ne.length>M&&(0,D.jsx)("div",{className:"mt-4 flex justify-center",children:(0,D.jsxs)("button",{className:"px-4 py-2 text-sm font-medium text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700",onClick:()=>q((e=>e+10)),children:[r("common.showMore",{defaultValue:"Mehr anzeigen"})," (",ne.length-M," ",r("common.remaining",{defaultValue:"verbleibend"}),")"]})})]})]}),l&&(0,D.jsx)(D.Fragment,{children:oe?(0,D.jsxs)(m.lG,{open:l,onClose:te,className:"relative z-50",children:[(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,D.jsxs)(m.lG.Panel,{className:"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,D.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0",children:(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsx)(m.lG.Title,{className:"text-lg font-semibold dark:text-white",children:o?r("branches.edit",{defaultValue:"Niederlassung bearbeiten"}):r("branches.create",{defaultValue:"Neue Niederlassung"})}),(0,D.jsx)("button",{onClick:te,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]})}),(0,D.jsxs)("form",{onSubmit:re,className:"p-6 space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("branches.name",{defaultValue:"Name"})}),(0,D.jsx)("input",{type:"text",value:f.name,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{name:e.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",required:!0,autoFocus:!0})]}),o&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-4",children:(0,D.jsx)("nav",{className:"-mb-px flex space-x-2 overflow-x-auto",children:["whatsapp","lobbypms","boldpayment","doorsystem","email"].map((e=>(0,D.jsx)("button",{type:"button",onClick:()=>N(e),className:"py-2 px-2 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ".concat(v===e?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:"whatsapp"===e?"WhatsApp":"lobbypms"===e?"LobbyPMS":"boldpayment"===e?"Bold Payment":"doorsystem"===e?"TTLock":"Email"},e)))})}),(0,D.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:["whatsapp"===v&&(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"WhatsApp Settings"}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"whatsappProvider",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Provider"}),(0,D.jsxs)("select",{id:"whatsappProvider",value:f.whatsappSettings.provider,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{provider:e.target.value})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,D.jsx)("option",{value:"twilio",children:"Twilio"}),(0,D.jsx)("option",{value:"whatsapp-business-api",children:"WhatsApp Business API"})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"whatsappApiKey",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key / Access Token"}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)("input",{type:A.whatsappApiKey?"text":"password",id:"whatsappApiKey",value:f.whatsappSettings.apiKey,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{apiKey:e.target.value})})),placeholder:"API Key / Access Token",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,D.jsx)("button",{type:"button",onClick:()=>S((e=>(0,c.A)((0,c.A)({},e),{},{whatsappApiKey:!e.whatsappApiKey}))),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:A.whatsappApiKey?(0,D.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,D.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"whatsappPhoneNumberId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone Number ID"}),(0,D.jsx)("input",{type:"text",id:"whatsappPhoneNumberId",value:f.whatsappSettings.phoneNumberId,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{phoneNumberId:e.target.value})})),placeholder:"Phone Number ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsx)("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"KI-Konfiguration (AI)"}),(0,D.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",checked:f.whatsappSettings.ai.enabled,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{enabled:e.target.checked})})})),className:"sr-only peer"}),(0,D.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,D.jsx)("span",{className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:f.whatsappSettings.ai.enabled?"Aktiviert":"Deaktiviert"})]})]}),f.whatsappSettings.ai.enabled&&(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"aiModel",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Modell"}),(0,D.jsxs)("select",{id:"aiModel",value:f.whatsappSettings.ai.model,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{model:e.target.value})})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,D.jsx)("option",{value:"gpt-4o",children:"GPT-4o"}),(0,D.jsx)("option",{value:"gpt-4",children:"GPT-4"}),(0,D.jsx)("option",{value:"gpt-3.5-turbo",children:"GPT-3.5 Turbo"})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"aiSystemPrompt",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"System Prompt"}),(0,D.jsx)("textarea",{id:"aiSystemPrompt",value:f.whatsappSettings.ai.systemPrompt,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{systemPrompt:e.target.value})})})),rows:4,placeholder:"Du bist ein hilfreicher Assistent f\xfcr...",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Regeln (eine pro Zeile)"}),(0,D.jsx)("textarea",{value:f.whatsappSettings.ai.rules.join("\n"),onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{rules:e.target.value.split("\n").filter((e=>e.trim()))})})})),rows:3,placeholder:"Antworte immer auf Spanisch\nSei freundlich und professionell",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Quellen/URLs (eine pro Zeile)"}),(0,D.jsx)("textarea",{value:f.whatsappSettings.ai.sources.join("\n"),onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{sources:e.target.value.split("\n").filter((e=>e.trim()))})})})),rows:2,placeholder:"https://wiki.example.com/manila-procedures\nhttps://wiki.example.com/faq",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{htmlFor:"aiTemperature",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Temperature (",f.whatsappSettings.ai.temperature,")"]}),(0,D.jsx)("input",{type:"range",id:"aiTemperature",min:"0",max:"2",step:"0.1",value:f.whatsappSettings.ai.temperature,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{temperature:parseFloat(e.target.value)})})})),className:"mt-1 block w-full"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"aiMaxTokens",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Max Tokens"}),(0,D.jsx)("input",{type:"number",id:"aiMaxTokens",min:"100",max:"4000",step:"100",value:f.whatsappSettings.ai.maxTokens,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{maxTokens:parseInt(e.target.value)||500})})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]})]})]})]}),"lobbypms"===v&&(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"LobbyPMS Settings"}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API URL"}),(0,D.jsx)("input",{type:"text",value:f.lobbyPmsSettings.apiUrl,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{lobbyPmsSettings:(0,c.A)((0,c.A)({},f.lobbyPmsSettings),{},{apiUrl:e.target.value})})),placeholder:"https://api.lobbypms.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key"}),(0,D.jsx)("input",{type:A.lobbyPmsApiKey?"text":"password",value:f.lobbyPmsSettings.apiKey,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{lobbyPmsSettings:(0,c.A)((0,c.A)({},f.lobbyPmsSettings),{},{apiKey:e.target.value})})),placeholder:"API Key",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Property ID"}),(0,D.jsx)("input",{type:"text",value:f.lobbyPmsSettings.propertyId,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{lobbyPmsSettings:(0,c.A)((0,c.A)({},f.lobbyPmsSettings),{},{propertyId:e.target.value})})),placeholder:"Property ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]}),"boldpayment"===v&&(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"Bold Payment Settings"}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key"}),(0,D.jsx)("input",{type:A.boldPaymentApiKey?"text":"password",value:f.boldPaymentSettings.apiKey,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{boldPaymentSettings:(0,c.A)((0,c.A)({},f.boldPaymentSettings),{},{apiKey:e.target.value})})),placeholder:"API Key",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Merchant ID"}),(0,D.jsx)("input",{type:A.boldPaymentMerchantId?"text":"password",value:f.boldPaymentSettings.merchantId,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{boldPaymentSettings:(0,c.A)((0,c.A)({},f.boldPaymentSettings),{},{merchantId:e.target.value})})),placeholder:"Merchant ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Environment"}),(0,D.jsxs)("select",{value:f.boldPaymentSettings.environment,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{boldPaymentSettings:(0,c.A)((0,c.A)({},f.boldPaymentSettings),{},{environment:e.target.value})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,D.jsx)("option",{value:"sandbox",children:"Sandbox"}),(0,D.jsx)("option",{value:"production",children:"Production"})]})]})]})]}),"doorsystem"===v&&(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"TTLock Settings"}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Client ID"}),(0,D.jsx)("input",{type:"text",value:f.doorSystemSettings.clientId,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{doorSystemSettings:(0,c.A)((0,c.A)({},f.doorSystemSettings),{},{clientId:e.target.value})})),placeholder:"Client ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Client Secret"}),(0,D.jsx)("input",{type:A.doorSystemClientSecret?"text":"password",value:f.doorSystemSettings.clientSecret,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{doorSystemSettings:(0,c.A)((0,c.A)({},f.doorSystemSettings),{},{clientSecret:e.target.value})})),placeholder:"Client Secret",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Username"}),(0,D.jsx)("input",{type:"text",value:f.doorSystemSettings.username,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{doorSystemSettings:(0,c.A)((0,c.A)({},f.doorSystemSettings),{},{username:e.target.value})})),placeholder:"Username",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Password"}),(0,D.jsx)("input",{type:A.doorSystemPassword?"text":"password",value:f.doorSystemSettings.password,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{doorSystemSettings:(0,c.A)((0,c.A)({},f.doorSystemSettings),{},{password:e.target.value})})),placeholder:"Password",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]}),"email"===v&&(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"Email Settings"}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP Host"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.smtpHost,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{smtpHost:e.target.value})})),placeholder:"smtp.example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP Port"}),(0,D.jsx)("input",{type:"number",value:f.emailSettings.smtpPort,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{smtpPort:parseInt(e.target.value)||587})})),placeholder:"587",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP User"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.smtpUser,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{smtpUser:e.target.value})})),placeholder:"user@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP Password"}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)("input",{type:A.emailSmtpPass?"text":"password",value:f.emailSettings.smtpPass,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{smtpPass:e.target.value})})),placeholder:"Password",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,D.jsx)("button",{type:"button",onClick:()=>S((0,c.A)((0,c.A)({},A),{},{emailSmtpPass:!A.emailSmtpPass})),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:A.emailSmtpPass?(0,D.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,D.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP From Email"}),(0,D.jsx)("input",{type:"email",value:f.emailSettings.smtpFromEmail,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{smtpFromEmail:e.target.value})})),placeholder:"noreply@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP From Name"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.smtpFromName,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{smtpFromName:e.target.value})})),placeholder:"Branch Name",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsx)("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"IMAP Settings (Email Reading)"}),(0,D.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",checked:f.emailSettings.imap.enabled,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{enabled:e.target.checked})})})),className:"sr-only peer"}),(0,D.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,D.jsx)("span",{className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:f.emailSettings.imap.enabled?"Enabled":"Disabled"})]})]}),f.emailSettings.imap.enabled&&(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Host"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.imap.host,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{host:e.target.value})})})),placeholder:"imap.example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Port"}),(0,D.jsx)("input",{type:"number",value:f.emailSettings.imap.port,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{port:parseInt(e.target.value)||993})})})),placeholder:"993",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsx)("div",{children:(0,D.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",checked:f.emailSettings.imap.secure,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{secure:e.target.checked})})})),className:"sr-only peer"}),(0,D.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,D.jsx)("span",{className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:"Secure (SSL/TLS)"})]})}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP User"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.imap.user,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{user:e.target.value})})})),placeholder:"user@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Password"}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)("input",{type:A.emailImapPass?"text":"password",value:f.emailSettings.imap.password,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{password:e.target.value})})})),placeholder:"Password",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,D.jsx)("button",{type:"button",onClick:()=>S((0,c.A)((0,c.A)({},A),{},{emailImapPass:!A.emailImapPass})),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:A.emailImapPass?(0,D.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,D.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Folder"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.imap.folder,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{folder:e.target.value})})})),placeholder:"INBOX",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Processed Folder (optional)"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.imap.processedFolder,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{processedFolder:e.target.value})})})),placeholder:"Processed",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]})]})]})]})]}),(0,D.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:te,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.cancel",{defaultValue:"Abbrechen"})})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors",children:(0,D.jsx)(y.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o?r("common.update",{defaultValue:"Aktualisieren"}):r("common.create",{defaultValue:"Erstellen"})})]})]})]})]})})]}):(0,D.jsxs)("div",{className:"fixed inset-y-0 right-0 w-full sm:min-w-[500px] sm:max-w-[600px] bg-white dark:bg-gray-800 shadow-xl z-50 flex flex-col",children:[(0,D.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0",children:(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:o?r("branches.edit",{defaultValue:"Niederlassung bearbeiten"}):r("branches.create",{defaultValue:"Neue Niederlassung"})}),(0,D.jsx)("button",{onClick:te,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]})}),(0,D.jsxs)("form",{onSubmit:re,className:"flex flex-col flex-1 min-h-0",children:[(0,D.jsx)("div",{className:"flex-1 overflow-y-auto min-h-0",children:(0,D.jsxs)("div",{className:"p-6 space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("branches.name",{defaultValue:"Name"})}),(0,D.jsx)("input",{type:"text",value:f.name,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{name:e.target.value})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",required:!0,autoFocus:!0})]}),o&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-4",children:(0,D.jsx)("nav",{className:"-mb-px flex space-x-2 overflow-x-auto",children:["whatsapp","lobbypms","boldpayment","doorsystem","email"].map((e=>(0,D.jsx)("button",{type:"button",onClick:()=>N(e),className:"py-2 px-2 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ".concat(v===e?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:"whatsapp"===e?"WhatsApp":"lobbypms"===e?"LobbyPMS":"boldpayment"===e?"Bold Payment":"doorsystem"===e?"TTLock":"Email"},e)))})}),(0,D.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:["whatsapp"===v&&(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"WhatsApp Settings"}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"whatsappProviderDesktop",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Provider"}),(0,D.jsxs)("select",{id:"whatsappProviderDesktop",value:f.whatsappSettings.provider,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{provider:e.target.value})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,D.jsx)("option",{value:"twilio",children:"Twilio"}),(0,D.jsx)("option",{value:"whatsapp-business-api",children:"WhatsApp Business API"})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"whatsappApiKey",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key / Access Token"}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)("input",{type:A.whatsappApiKey?"text":"password",id:"whatsappApiKey",value:f.whatsappSettings.apiKey,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{apiKey:e.target.value})})),placeholder:"API Key / Access Token",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,D.jsx)("button",{type:"button",onClick:()=>S((e=>(0,c.A)((0,c.A)({},e),{},{whatsappApiKey:!e.whatsappApiKey}))),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:A.whatsappApiKey?(0,D.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,D.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"whatsappPhoneNumberId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone Number ID"}),(0,D.jsx)("input",{type:"text",id:"whatsappPhoneNumberId",value:f.whatsappSettings.phoneNumberId,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{phoneNumberId:e.target.value})})),placeholder:"Phone Number ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsx)("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"KI-Konfiguration (AI)"}),(0,D.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",checked:f.whatsappSettings.ai.enabled,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{enabled:e.target.checked})})})),className:"sr-only peer"}),(0,D.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,D.jsx)("span",{className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:f.whatsappSettings.ai.enabled?"Aktiviert":"Deaktiviert"})]})]}),f.whatsappSettings.ai.enabled&&(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"aiModelDesktop",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Modell"}),(0,D.jsxs)("select",{id:"aiModelDesktop",value:f.whatsappSettings.ai.model,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{model:e.target.value})})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,D.jsx)("option",{value:"gpt-4o",children:"GPT-4o"}),(0,D.jsx)("option",{value:"gpt-4",children:"GPT-4"}),(0,D.jsx)("option",{value:"gpt-3.5-turbo",children:"GPT-3.5 Turbo"})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"aiSystemPromptDesktop",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"System Prompt"}),(0,D.jsx)("textarea",{id:"aiSystemPromptDesktop",value:f.whatsappSettings.ai.systemPrompt,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{systemPrompt:e.target.value})})})),rows:4,placeholder:"Du bist ein hilfreicher Assistent f\xfcr...",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Regeln (eine pro Zeile)"}),(0,D.jsx)("textarea",{value:f.whatsappSettings.ai.rules.join("\n"),onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{rules:e.target.value.split("\n").filter((e=>e.trim()))})})})),rows:3,placeholder:"Antworte immer auf Spanisch\nSei freundlich und professionell",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Quellen/URLs (eine pro Zeile)"}),(0,D.jsx)("textarea",{value:f.whatsappSettings.ai.sources.join("\n"),onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{sources:e.target.value.split("\n").filter((e=>e.trim()))})})})),rows:2,placeholder:"https://wiki.example.com/manila-procedures\nhttps://wiki.example.com/faq",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{htmlFor:"aiTemperatureDesktop",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Temperature (",f.whatsappSettings.ai.temperature,")"]}),(0,D.jsx)("input",{type:"range",id:"aiTemperatureDesktop",min:"0",max:"2",step:"0.1",value:f.whatsappSettings.ai.temperature,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{temperature:parseFloat(e.target.value)})})})),className:"mt-1 block w-full"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"aiMaxTokensDesktop",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Max Tokens"}),(0,D.jsx)("input",{type:"number",id:"aiMaxTokensDesktop",min:"100",max:"4000",step:"100",value:f.whatsappSettings.ai.maxTokens,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{whatsappSettings:(0,c.A)((0,c.A)({},f.whatsappSettings),{},{ai:(0,c.A)((0,c.A)({},f.whatsappSettings.ai),{},{maxTokens:parseInt(e.target.value)||500})})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]})]})]})]}),"lobbypms"===v&&(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"LobbyPMS Settings"}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API URL"}),(0,D.jsx)("input",{type:"text",value:f.lobbyPmsSettings.apiUrl,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{lobbyPmsSettings:(0,c.A)((0,c.A)({},f.lobbyPmsSettings),{},{apiUrl:e.target.value})})),placeholder:"https://api.lobbypms.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key"}),(0,D.jsx)("input",{type:A.lobbyPmsApiKey?"text":"password",value:f.lobbyPmsSettings.apiKey,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{lobbyPmsSettings:(0,c.A)((0,c.A)({},f.lobbyPmsSettings),{},{apiKey:e.target.value})})),placeholder:"API Key",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Property ID"}),(0,D.jsx)("input",{type:"text",value:f.lobbyPmsSettings.propertyId,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{lobbyPmsSettings:(0,c.A)((0,c.A)({},f.lobbyPmsSettings),{},{propertyId:e.target.value})})),placeholder:"Property ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]}),"boldpayment"===v&&(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"Bold Payment Settings"}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key"}),(0,D.jsx)("input",{type:A.boldPaymentApiKey?"text":"password",value:f.boldPaymentSettings.apiKey,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{boldPaymentSettings:(0,c.A)((0,c.A)({},f.boldPaymentSettings),{},{apiKey:e.target.value})})),placeholder:"API Key",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Merchant ID"}),(0,D.jsx)("input",{type:A.boldPaymentMerchantId?"text":"password",value:f.boldPaymentSettings.merchantId,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{boldPaymentSettings:(0,c.A)((0,c.A)({},f.boldPaymentSettings),{},{merchantId:e.target.value})})),placeholder:"Merchant ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Environment"}),(0,D.jsxs)("select",{value:f.boldPaymentSettings.environment,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{boldPaymentSettings:(0,c.A)((0,c.A)({},f.boldPaymentSettings),{},{environment:e.target.value})})),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,D.jsx)("option",{value:"sandbox",children:"Sandbox"}),(0,D.jsx)("option",{value:"production",children:"Production"})]})]})]})]}),"doorsystem"===v&&(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"TTLock Settings"}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Client ID"}),(0,D.jsx)("input",{type:"text",value:f.doorSystemSettings.clientId,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{doorSystemSettings:(0,c.A)((0,c.A)({},f.doorSystemSettings),{},{clientId:e.target.value})})),placeholder:"Client ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Client Secret"}),(0,D.jsx)("input",{type:A.doorSystemClientSecret?"text":"password",value:f.doorSystemSettings.clientSecret,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{doorSystemSettings:(0,c.A)((0,c.A)({},f.doorSystemSettings),{},{clientSecret:e.target.value})})),placeholder:"Client Secret",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Username"}),(0,D.jsx)("input",{type:"text",value:f.doorSystemSettings.username,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{doorSystemSettings:(0,c.A)((0,c.A)({},f.doorSystemSettings),{},{username:e.target.value})})),placeholder:"Username",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Password"}),(0,D.jsx)("input",{type:A.doorSystemPassword?"text":"password",value:f.doorSystemSettings.password,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{doorSystemSettings:(0,c.A)((0,c.A)({},f.doorSystemSettings),{},{password:e.target.value})})),placeholder:"Password",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]}),"email"===v&&(0,D.jsxs)("div",{children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:"Email Settings"}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP Host"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.smtpHost,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{smtpHost:e.target.value})})),placeholder:"smtp.example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP Port"}),(0,D.jsx)("input",{type:"number",value:f.emailSettings.smtpPort,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{smtpPort:parseInt(e.target.value)||587})})),placeholder:"587",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP User"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.smtpUser,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{smtpUser:e.target.value})})),placeholder:"user@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP Password"}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)("input",{type:A.emailSmtpPass?"text":"password",value:f.emailSettings.smtpPass,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{smtpPass:e.target.value})})),placeholder:"Password",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,D.jsx)("button",{type:"button",onClick:()=>S((0,c.A)((0,c.A)({},A),{},{emailSmtpPass:!A.emailSmtpPass})),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:A.emailSmtpPass?(0,D.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,D.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP From Email"}),(0,D.jsx)("input",{type:"email",value:f.emailSettings.smtpFromEmail,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{smtpFromEmail:e.target.value})})),placeholder:"noreply@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP From Name"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.smtpFromName,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{smtpFromName:e.target.value})})),placeholder:"Branch Name",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsx)("h5",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"IMAP Settings (Email Reading)"}),(0,D.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",checked:f.emailSettings.imap.enabled,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{enabled:e.target.checked})})})),className:"sr-only peer"}),(0,D.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,D.jsx)("span",{className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:f.emailSettings.imap.enabled?"Enabled":"Disabled"})]})]}),f.emailSettings.imap.enabled&&(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Host"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.imap.host,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{host:e.target.value})})})),placeholder:"imap.example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Port"}),(0,D.jsx)("input",{type:"number",value:f.emailSettings.imap.port,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{port:parseInt(e.target.value)||993})})})),placeholder:"993",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsx)("div",{children:(0,D.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,D.jsx)("input",{type:"checkbox",checked:f.emailSettings.imap.secure,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{secure:e.target.checked})})})),className:"sr-only peer"}),(0,D.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,D.jsx)("span",{className:"ml-3 text-sm text-gray-700 dark:text-gray-300",children:"Secure (SSL/TLS)"})]})}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP User"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.imap.user,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{user:e.target.value})})})),placeholder:"user@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Password"}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)("input",{type:A.emailImapPass?"text":"password",value:f.emailSettings.imap.password,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{password:e.target.value})})})),placeholder:"Password",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,D.jsx)("button",{type:"button",onClick:()=>S((0,c.A)((0,c.A)({},A),{},{emailImapPass:!A.emailImapPass})),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:A.emailImapPass?(0,D.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,D.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IMAP Folder"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.imap.folder,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{folder:e.target.value})})})),placeholder:"INBOX",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Processed Folder (optional)"}),(0,D.jsx)("input",{type:"text",value:f.emailSettings.imap.processedFolder,onChange:e=>k((0,c.A)((0,c.A)({},f),{},{emailSettings:(0,c.A)((0,c.A)({},f.emailSettings),{},{imap:(0,c.A)((0,c.A)({},f.emailSettings.imap),{},{processedFolder:e.target.value})})})),placeholder:"Processed",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]})]})]})]})]})]})}),(0,D.jsxs)("div",{className:"flex justify-end pt-4 gap-2 px-6 pb-6 border-t dark:border-gray-700",children:[(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"button",onClick:te,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:r("common.cancel",{defaultValue:"Abbrechen"})})]}),(0,D.jsxs)("div",{className:"relative group",children:[(0,D.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors",children:(0,D.jsx)(y.A,{className:"h-5 w-5"})}),(0,D.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:o?r("common.update",{defaultValue:"Aktualisieren"}):r("common.create",{defaultValue:"Erstellen"})})]})]})]})]})})]})};var pe=r(7629),ye=r(8682),fe=r(3315),ke=r(8673),ve=r(2395);const je=e=>{let{isOpen:t,onClose:r,onSuccess:n}=e;const{t:l}=(0,s.Bd)(),[i,o]=(0,a.useState)({name:"",displayName:"",domain:""}),[d,u]=(0,a.useState)(!1),[g,x]=(0,a.useState)({}),[b,h]=(0,a.useState)(window.innerWidth<640),[k,v]=(0,a.useState)(window.innerWidth>1070),{openSidepane:j,closeSidepane:w}=(0,E.N)(),{showMessage:N}=(0,f.A)(),{fetchCurrentUser:A}=(0,P.As)();(0,a.useEffect)((()=>{const e=()=>{h(window.innerWidth<640),v(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,a.useEffect)((()=>(t?j():w(),()=>{w()})),[t,j,w]);const S=e=>{const{name:t,value:r}=e.target;o((e=>(0,c.A)((0,c.A)({},e),{},{[t]:r}))),g[t]&&x((e=>(0,c.A)((0,c.A)({},e),{},{[t]:""})))},C=async e=>{if(e.preventDefault(),(()=>{const e={};return i.name.trim()||(e.name=l("organization.create.nameRequired")),i.displayName.trim()||(e.displayName=l("organization.create.displayNameRequired")),x(e),0===Object.keys(e).length})())try{u(!0),await ke.h.createOrganization(i),x({}),N(l("organization.create.createSuccess"),"success"),await A(),o({name:"",displayName:"",domain:""}),r(),n&&n()}catch(s){var t,a;const e=(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||l("organization.create.createError");N(e,"error"),x({submit:e})}finally{u(!1)}else N(l("joinRequest.fillRequired"),"error")},z=()=>{o({name:"",displayName:"",domain:""}),x({}),r()};return b?(0,D.jsxs)(m.lG,{open:t,onClose:z,className:"relative z-50",children:[(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,D.jsxs)(m.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,D.jsx)(m.lG.Title,{className:"text-lg font-semibold dark:text-white",children:l("organization.create.title")}),(0,D.jsx)("button",{onClick:z,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("form",{onSubmit:C,className:"p-4",children:[g.submit&&(0,D.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:g.submit}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.create.name")}),(0,D.jsx)("input",{type:"text",id:"name",name:"name",value:i.name,onChange:S,className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(g.name?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),g.name&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:g.name})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.create.displayName")}),(0,D.jsx)("input",{type:"text",id:"displayName",name:"displayName",value:i.displayName,onChange:S,className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(g.displayName?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),g.displayName&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:g.displayName})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"domain",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.create.domain")}),(0,D.jsx)("input",{type:"text",id:"domain",name:"domain",value:i.domain,onChange:S,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]}),(0,D.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,D.jsx)("button",{type:"button",onClick:z,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:l("joinRequest.cancel"),children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"submit",disabled:d,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:l(d?"organization.create.creating":"organization.create.createButton"),children:d?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})]})]})]})})]}):(0,D.jsxs)(D.Fragment,{children:[t&&!k&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:z,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,D.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:l("organization.create.title")}),(0,D.jsx)("button",{onClick:z,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[g.submit&&(0,D.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:g.submit}),(0,D.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.create.name")}),(0,D.jsx)("input",{type:"text",id:"name",name:"name",value:i.name,onChange:S,className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(g.name?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),g.name&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:g.name})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.create.displayName")}),(0,D.jsx)("input",{type:"text",id:"displayName",name:"displayName",value:i.displayName,onChange:S,className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(g.displayName?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),g.displayName&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:g.displayName})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"domain",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.create.domain")}),(0,D.jsx)("input",{type:"text",id:"domain",name:"domain",value:i.domain,onChange:S,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,D.jsx)("button",{type:"button",onClick:z,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:l("common.cancel"),children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"submit",disabled:d,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:l(d?"organization.create.creating":"organization.create.createButton"),children:d?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})]})]})]})]})]})},we=e=>{let{isOpen:t,onClose:r,onSuccess:n}=e;const{t:l}=(0,s.Bd)(),[i,o]=(0,a.useState)({organizationName:"",message:""}),[d,u]=(0,a.useState)(!1),[g,x]=(0,a.useState)(!1),[b,h]=(0,a.useState)({}),[k,v]=(0,a.useState)(window.innerWidth<640),[j,w]=(0,a.useState)(window.innerWidth>1070),{openSidepane:N,closeSidepane:A}=(0,E.N)(),[S,C]=(0,a.useState)([]),[z,R]=(0,a.useState)(!1),[P,I]=(0,a.useState)(null),F=(0,a.useRef)(null),T=(0,a.useRef)(null),{showMessage:_}=(0,f.A)();(0,a.useEffect)((()=>{const e=()=>{v(window.innerWidth<640),w(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,a.useEffect)((()=>(t?N():A(),()=>{A()})),[t,N,A]),(0,a.useEffect)((()=>{const e=e=>{T.current&&!T.current.contains(e.target)&&R(!1)};return z&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[z]);const B=e=>{const t=e.target.value;o((e=>(0,c.A)((0,c.A)({},e),{},{organizationName:t}))),I(null),b.organizationName&&h((e=>(0,c.A)((0,c.A)({},e),{},{organizationName:""}))),F.current&&clearTimeout(F.current),F.current=setTimeout((()=>{(async e=>{if(e.length<2)return C([]),void R(!1);try{x(!0);const t=await ke.h.searchOrganizations(e);C(t),R(!0)}catch(t){console.error("Fehler bei der Organisationen-Suche:",t),C([])}finally{x(!1)}})(t)}),300)},O=e=>{I(e),o((t=>(0,c.A)((0,c.A)({},t),{},{organizationName:e.name}))),R(!1),C([])},U=e=>{o((t=>(0,c.A)((0,c.A)({},t),{},{message:e.target.value}))),b.message&&h((e=>(0,c.A)((0,c.A)({},e),{},{message:""})))},M=async e=>{if(e.preventDefault(),(()=>{const e={};return i.organizationName.trim()?P||(e.organizationName=l("organization.join.selectFromList")):e.organizationName=l("organization.join.nameRequired"),h(e),0===Object.keys(e).length})())try{u(!0),await ke.h.createJoinRequest(i),h({}),_(l("organization.join.sendSuccess"),"success"),o({organizationName:"",message:""}),I(null),C([]),r(),n&&n()}catch(s){var t,a;const e=(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||l("organization.join.sendError");_(e,"error"),h({submit:e})}finally{u(!1)}else _(l("joinRequest.fillRequired"),"error")},q=()=>{o({organizationName:"",message:""}),I(null),C([]),h({}),R(!1),F.current&&clearTimeout(F.current),r()};return k?(0,D.jsxs)(m.lG,{open:t,onClose:q,className:"relative z-50",children:[(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,D.jsxs)(m.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,D.jsx)(m.lG.Title,{className:"text-lg font-semibold dark:text-white",children:l("organization.join.title")}),(0,D.jsx)("button",{onClick:q,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("form",{onSubmit:M,className:"p-4",children:[b.submit&&(0,D.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:b.submit}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{className:"relative",ref:T,children:[(0,D.jsx)("label",{htmlFor:"organizationName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.join.search")}),(0,D.jsx)("input",{type:"text",id:"organizationName",name:"organizationName",value:i.organizationName,onChange:B,placeholder:l("organization.join.searchPlaceholder"),className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(b.organizationName?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),b.organizationName&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:b.organizationName}),z&&(S.length>0||g)&&(0,D.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto",children:g?(0,D.jsx)("div",{className:"p-3 text-center text-gray-500 dark:text-gray-400",children:l("organization.join.searching")}):S.length>0?S.map((e=>(0,D.jsxs)("button",{type:"button",onClick:()=>O(e),className:"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none",children:[(0,D.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.displayName||e.name}),e.displayName&&(0,D.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.name})]},e.id))):(0,D.jsx)("div",{className:"p-3 text-center text-gray-500 dark:text-gray-400",children:l("organization.join.noOrganizations")})})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.join.message")}),(0,D.jsx)("textarea",{id:"message",name:"message",value:i.message||"",onChange:U,rows:3,placeholder:l("organization.join.messagePlaceholder"),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]}),(0,D.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,D.jsx)("button",{type:"button",onClick:q,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:l("joinRequest.cancel"),children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"submit",disabled:d,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:l(d?"organization.join.sending":"organization.join.send"),children:d?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})]})]})]})})]}):(0,D.jsxs)(D.Fragment,{children:[t&&!j&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:q,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,D.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:l("organization.join.title")}),(0,D.jsx)("button",{onClick:q,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[b.submit&&(0,D.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:b.submit}),(0,D.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,D.jsxs)("div",{className:"relative",ref:T,children:[(0,D.jsx)("label",{htmlFor:"organizationName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.join.search")}),(0,D.jsx)("input",{type:"text",id:"organizationName",name:"organizationName",value:i.organizationName,onChange:B,placeholder:l("organization.join.searchPlaceholder"),className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(b.organizationName?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),b.organizationName&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:b.organizationName}),z&&(S.length>0||g)&&(0,D.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto",children:g?(0,D.jsx)("div",{className:"p-3 text-center text-gray-500 dark:text-gray-400",children:l("organization.join.searching")}):S.length>0?S.map((e=>(0,D.jsxs)("button",{type:"button",onClick:()=>O(e),className:"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none",children:[(0,D.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.displayName||e.name}),e.displayName&&(0,D.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.name})]},e.id))):(0,D.jsx)("div",{className:"p-3 text-center text-gray-500 dark:text-gray-400",children:l("organization.join.noOrganizations")})})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.join.message")}),(0,D.jsx)("textarea",{id:"message",name:"message",value:i.message||"",onChange:U,rows:3,placeholder:l("organization.join.messagePlaceholder"),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,D.jsx)("button",{type:"button",onClick:q,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:l("common.cancel"),children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"submit",disabled:d,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:l(d?"organization.join.sending":"organization.join.send"),children:d?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})]})]})]})]})]})};var Ne=r(5648);const Ae=e=>{let{organization:t,onSave:r}=e;const{t:n}=(0,s.Bd)(),{showMessage:l}=(0,f.A)(),[i,o]=(0,a.useState)([]),[d,m]=(0,a.useState)({}),[g,x]=(0,a.useState)(!1),[b,h]=(0,a.useState)(!1),[p,k]=(0,a.useState)(!1);(0,a.useEffect)((()=>{t&&(v(),N())}),[t]);const v=async()=>{k(!0);try{const e=await u.Zj.getAll();e.data&&Array.isArray(e.data)&&o(e.data)}catch(e){console.error("Fehler beim Laden der Rollen:",e),l(n("lifecycle.loadRolesError",{defaultValue:"Fehler beim Laden der Rollen"}),"error")}finally{k(!1)}},N=async()=>{x(!0);try{const e=await j.A.get(w.Sn.ORGANIZATION_LIFECYCLE.LIFECYCLE_ROLES);m(e.data.lifecycleRoles||{})}catch(a){var e,t,r;if(console.error("Fehler beim Laden der Lebenszyklus-Rollen:",a),404!==(null===(e=a.response)||void 0===e?void 0:e.status))l((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||n("lifecycle.loadLifecycleRolesError",{defaultValue:"Fehler beim Laden der Konfiguration"}),"error")}finally{x(!1)}};return g&&!d?(0,D.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,D.jsx)(L.A,{className:"h-6 w-6 animate-spin text-gray-400"})}):(0,D.jsx)("div",{className:"space-y-6",children:(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsx)("h3",{className:"text-lg font-semibold dark:text-white",children:n("organization.lifecycleRoles.title",{defaultValue:"Lebenszyklus-Rollen"})}),(0,D.jsx)("button",{onClick:()=>{const e=i.find((e=>e.name.toLowerCase().includes("admin")||e.name.toLowerCase().includes("administrator"))),t=i.find((e=>e.name.toLowerCase().includes("hr")||e.name.toLowerCase().includes("human"))),r=i.find((e=>"derecho"===e.name.toLowerCase()||e.name.toLowerCase().includes("legal")));m((0,c.A)((0,c.A)({},d),{},{adminRoleId:(null===e||void 0===e?void 0:e.id)||null,hrRoleId:(null===t||void 0===t?void 0:t.id)||null,legalRoleId:(null===r||void 0===r?void 0:r.id)||null})),l(n("lifecycle.standardRolesAssigned",{defaultValue:"Standard-Rollen zugewiesen"}),"success")},className:"px-3 py-1.5 text-sm font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",children:n("lifecycle.assignStandardRoles",{defaultValue:"Standard-Rollen zuweisen"})})]}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.lifecycleRoles.admin",{defaultValue:"Admin-Rolle"})}),(0,D.jsxs)("select",{value:d.adminRoleId||"",onChange:e=>{const t=e.target.value;m((0,c.A)((0,c.A)({},d),{},{adminRoleId:t&&""!==t&&!isNaN(parseInt(t,10))?parseInt(t,10):null}))},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:p,children:[(0,D.jsx)("option",{value:"",children:n("common.pleaseSelect")}),i.map((e=>(0,D.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.lifecycleRoles.hr",{defaultValue:"HR-Rolle"})}),(0,D.jsxs)("select",{value:d.hrRoleId||"",onChange:e=>{const t=e.target.value;m((0,c.A)((0,c.A)({},d),{},{hrRoleId:t&&""!==t&&!isNaN(parseInt(t,10))?parseInt(t,10):null}))},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:p,children:[(0,D.jsx)("option",{value:"",children:n("common.pleaseSelect")}),i.map((e=>(0,D.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.lifecycleRoles.legal",{defaultValue:"Legal-Rolle"})}),(0,D.jsxs)("select",{value:d.legalRoleId||"",onChange:e=>{const t=e.target.value;m((0,c.A)((0,c.A)({},d),{},{legalRoleId:t&&""!==t&&!isNaN(parseInt(t,10))?parseInt(t,10):null}))},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:p,children:[(0,D.jsx)("option",{value:"",children:n("common.pleaseSelect")}),i.map((e=>(0,D.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]}),(0,D.jsx)("div",{className:"mt-6 flex justify-end",children:(0,D.jsx)("button",{onClick:async()=>{h(!0);try{const e=e=>null===e||void 0===e||0===e?null:Number(e);await j.A.put(w.Sn.ORGANIZATION_LIFECYCLE.LIFECYCLE_ROLES,{adminRoleId:e(d.adminRoleId),hrRoleId:e(d.hrRoleId),legalRoleId:e(d.legalRoleId),employeeRoleIds:(d.employeeRoleIds||[]).map(e).filter((e=>null!==e))}),l(n("lifecycle.rolesSaved",{defaultValue:"Rollen-Konfiguration erfolgreich gespeichert"}),"success"),r&&r()}catch(a){var e,t;console.error("Fehler beim Speichern:",a),l((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||n("lifecycle.saveError",{defaultValue:"Fehler beim Speichern"}),"error")}finally{h(!1)}},disabled:b||p,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:b?n("common.saving",{defaultValue:"Speichere..."}):n("common.save",{defaultValue:"Speichern"}),children:b?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})})]})})},Se=e=>{let{organization:t,onUpload:r}=e;const{t:n}=(0,s.Bd)(),{showMessage:l}=(0,f.A)(),[i,o]=(0,a.useState)([]),[d,c]=(0,a.useState)(!1),[m,u]=(0,a.useState)(!1),[g,x]=(0,a.useState)("certificate"),[b,h]=(0,a.useState)(""),[p,y]=(0,a.useState)(""),[k,v]=(0,a.useState)("400"),[N,A]=(0,a.useState)("100"),[S,C]=(0,a.useState)("1"),z=a.useRef(null);(0,a.useEffect)((()=>{t&&R()}),[t]);const R=async()=>{c(!0);try{const e=(await j.A.get(w.Sn.ORGANIZATION_LIFECYCLE.DOCUMENT_SIGNATURES)).data.documentSignatures||{},t=[];e.employmentCertificate&&t.push({type:"certificate",signerName:e.employmentCertificate.signerName,signerPosition:e.employmentCertificate.signerPosition,path:e.employmentCertificate.path,position:e.employmentCertificate.position}),e.employmentContract&&t.push({type:"contract",signerName:e.employmentContract.signerName,signerPosition:e.employmentContract.signerPosition,path:e.employmentContract.path,position:e.employmentContract.position}),o(t)}catch(a){var e,t,r;if(console.error("Fehler beim Laden der Signaturen:",a),404!==(null===(e=a.response)||void 0===e?void 0:e.status))l((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||n("lifecycle.loadSignaturesError",{defaultValue:"Fehler beim Laden der Signaturen"}),"error");o([])}finally{c(!1)}};return d?(0,D.jsx)("div",{className:"flex items-center justify-center py-4",children:(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin text-gray-400"})}):(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsx)("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-4",children:(0,D.jsxs)("div",{className:"space-y-3",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:n("lifecycle.signatureType",{defaultValue:"Signatur-Typ"})}),(0,D.jsxs)("select",{value:g,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",children:[(0,D.jsx)("option",{value:"certificate",children:n("lifecycle.certificate",{defaultValue:"Arbeitszeugnis"})}),(0,D.jsx)("option",{value:"contract",children:n("lifecycle.contract",{defaultValue:"Arbeitsvertrag"})})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n("lifecycle.signerName",{defaultValue:"Name des Unterzeichners"})," ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsx)("input",{type:"text",value:b,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:n("lifecycle.signerNamePlaceholder",{defaultValue:"z.B. Stefan Bossart"})})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:n("lifecycle.signerPosition",{defaultValue:"Position"})}),(0,D.jsx)("input",{type:"text",value:p,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:n("lifecycle.signerPositionPlaceholder",{defaultValue:"z.B. Gesch\xe4ftsf\xfchrer"})})]}),(0,D.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-3",children:[(0,D.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:n("lifecycle.signaturePosition",{defaultValue:"Signatur-Position im PDF"})}),(0,D.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:n("lifecycle.positionX",{defaultValue:"X (horizontal)"})}),(0,D.jsx)("input",{type:"number",value:k,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",placeholder:"400",min:"0"}),(0,D.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:n("lifecycle.positionXHint",{defaultValue:"0 = links"})})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:n("lifecycle.positionY",{defaultValue:"Y (vertikal)"})}),(0,D.jsx)("input",{type:"number",value:N,onChange:e=>A(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",placeholder:"100",min:"0"}),(0,D.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:n("lifecycle.positionYHint",{defaultValue:"0 = unten"})})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:n("lifecycle.positionPage",{defaultValue:"Seite"})}),(0,D.jsx)("input",{type:"number",value:S,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",placeholder:"1",min:"1"}),(0,D.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:n("lifecycle.positionPageHint",{defaultValue:"Seitennummer"})})]})]}),(0,D.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:n("lifecycle.signaturePositionHint",{defaultValue:"Koordinaten in PDF-Punkten (1 Punkt = 1/72 Zoll). A4: 595 x 842 Punkte. Standard: X=400, Y=100, Seite=1"})})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[n("lifecycle.signatureFile",{defaultValue:"Signatur-Datei"})," ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center",children:[(0,D.jsx)("input",{ref:z,type:"file",accept:"image/jpeg,image/png,image/gif,application/pdf",onChange:async e=>{var t;const a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;if(["image/jpeg","image/png","image/gif","application/pdf"].includes(a.type))if(b.trim()){u(!0);try{const e=new FormData;e.append("file",a),e.append("type","certificate"===g?"employmentCertificate":"employmentContract"),e.append("signerName",b),p&&e.append("signerPosition",p),e.append("positionX",k||"400"),e.append("positionY",N||"100"),e.append("page",S||"1");const t=await j.A.post(w.Sn.ORGANIZATION_LIFECYCLE.UPLOAD_SIGNATURE,e,{headers:{"Content-Type":"multipart/form-data"}});l(t.data.message||n("lifecycle.signatureUploaded",{defaultValue:"Signatur erfolgreich hochgeladen"}),"success"),h(""),y(""),v("400"),A("100"),C("1"),R(),r()}catch(o){var s,i;console.error("Fehler beim Hochladen:",o),l((null===(s=o.response)||void 0===s||null===(i=s.data)||void 0===i?void 0:i.message)||n("lifecycle.uploadError",{defaultValue:"Fehler beim Hochladen"}),"error")}finally{u(!1),z.current&&(z.current.value="")}}else l(n("lifecycle.signerNameRequired",{defaultValue:"Name des Unterzeichners ist erforderlich"}),"error");else l(n("lifecycle.onlyImageOrPdfAllowed",{defaultValue:"Nur Bilder (JPEG, PNG, GIF) oder PDF-Dateien sind erlaubt"}),"error")},className:"hidden"}),(0,D.jsx)("button",{onClick:()=>{var e;return null===(e=z.current)||void 0===e?void 0:e.click()},disabled:m||!b.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:m?(0,D.jsxs)("span",{className:"flex items-center space-x-2",children:[(0,D.jsx)(L.A,{className:"h-4 w-4 animate-spin"}),(0,D.jsx)("span",{children:n("common.uploading",{defaultValue:"Lade hoch..."})})]}):n("lifecycle.selectSignatureFile",{defaultValue:"Datei ausw\xe4hlen"})}),(0,D.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:n("lifecycle.signatureFileHint",{defaultValue:"JPEG, PNG, GIF oder PDF (max. 5MB)"})})]})]})]})}),i.length>0&&(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:n("lifecycle.uploadedSignatures",{defaultValue:"Hochgeladene Signaturen"})}),i.map((e=>(0,D.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("div",{className:"font-medium dark:text-white",children:"certificate"===e.type?n("lifecycle.certificate",{defaultValue:"Arbeitszeugnis"}):n("lifecycle.contract",{defaultValue:"Arbeitsvertrag"})}),(0,D.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.signerName,e.signerPosition&&" - ".concat(e.signerPosition)]}),e.position&&(0,D.jsxs)("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:[n("lifecycle.position",{defaultValue:"Position"}),": X=",e.position.x,", Y=",e.position.y,", ",n("lifecycle.page",{defaultValue:"Seite"})," ",e.position.page]})]}),(0,D.jsx)("button",{onClick:()=>(async e=>{if(window.confirm(n("lifecycle.deleteSignatureConfirm",{defaultValue:"Signatur wirklich l\xf6schen?"})))try{const t=(await j.A.get(w.Sn.ORGANIZATIONS.CURRENT)).data.settings||{};if(t.documentSignatures){const r="certificate"===e?"employmentCertificate":"employmentContract";delete t.documentSignatures[r],await j.A.put(w.Sn.ORGANIZATIONS.CURRENT,{settings:t})}l(n("lifecycle.signatureDeleted",{defaultValue:"Signatur erfolgreich gel\xf6scht"}),"success"),R()}catch(a){var t,r;console.error("Fehler beim L\xf6schen:",a),l((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||n("lifecycle.deleteError",{defaultValue:"Fehler beim L\xf6schen"}),"error")}})(e.type),className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900 rounded-md",title:n("common.delete",{defaultValue:"L\xf6schen"}),children:(0,D.jsx)(J.A,{className:"h-5 w-5"})})]},e.type)))]})]})},Ce=e=>{let{organization:t,onSave:r}=e;const{t:n}=(0,s.Bd)(),{showMessage:l}=(0,f.A)(),[i,o]=(0,a.useState)("certificate"),[d,m]=(0,a.useState)({}),[u,g]=(0,a.useState)(!1),[x,b]=(0,a.useState)(!1),h=["userName","organizationName","currentDate","identificationNumber","startDate","endDate"],p=["userName","organizationName","currentDate","identificationNumber","startDate","endDate","position","salary","workingHours"];(0,a.useEffect)((()=>{t&&k()}),[t,i]);const k=async()=>{try{var e;const r=null===t||void 0===t?void 0:t.settings,a=null===r||void 0===r||null===(e=r.documentTemplates)||void 0===e?void 0:e["certificate"===i?"employmentCertificate":"employmentContract"],s=(null===a||void 0===a?void 0:a.fields)||{},n=50,l=20;let o=841.89-n-30;const d={},c="certificate"===i?h:p,u={userName:{x:n,y:o,fontSize:14},organizationName:{x:n,y:o-l,fontSize:12},currentDate:{x:n,y:o-2*l,fontSize:12},identificationNumber:{x:n,y:o-3*l,fontSize:12},startDate:{x:n,y:o-4*l,fontSize:12},endDate:{x:n,y:o-5*l,fontSize:12}};"contract"===i&&(u.position={x:n,y:o-6*l,fontSize:12},u.salary={x:n,y:o-7*l,fontSize:12},u.workingHours={x:n,y:o-8*l,fontSize:12}),c.forEach((e=>{d[e]=s[e]||u[e]||{x:n,y:o,fontSize:"userName"===e?14:12}})),m(d)}catch(r){console.error("Fehler beim Laden der Felder:",r)}},v=(e,t,r)=>{m((a=>(0,c.A)((0,c.A)({},a),{},{[e]:(0,c.A)((0,c.A)({},a[e]),{},{[t]:"fontSize"===t?parseFloat(r)||12:parseFloat(r)||0})})))},N="certificate"===i?h:p,A={userName:n("lifecycle.fieldUserName",{defaultValue:"Benutzername"}),organizationName:n("lifecycle.fieldOrganizationName",{defaultValue:"Organisationsname"}),currentDate:n("lifecycle.fieldCurrentDate",{defaultValue:"Aktuelles Datum"}),identificationNumber:n("lifecycle.fieldIdentificationNumber",{defaultValue:"Ausweisnummer"}),startDate:n("lifecycle.fieldStartDate",{defaultValue:"Startdatum"}),endDate:n("lifecycle.fieldEndDate",{defaultValue:"Enddatum"}),position:n("lifecycle.fieldPosition",{defaultValue:"Position"}),salary:n("lifecycle.fieldSalary",{defaultValue:"Gehalt"}),workingHours:n("lifecycle.fieldWorkingHours",{defaultValue:"Arbeitsstunden"})};return(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsx)("h3",{className:"text-lg font-semibold dark:text-white",children:n("organization.fieldPositions",{defaultValue:"Feld-Positionen konfigurieren"})}),(0,D.jsx)("div",{className:"flex items-center space-x-2",children:(0,D.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",children:[(0,D.jsx)("option",{value:"certificate",children:n("lifecycle.certificate",{defaultValue:"Certificado Laboral"})}),(0,D.jsx)("option",{value:"contract",children:n("lifecycle.contract",{defaultValue:"Contrato de Trabajo"})})]})})]}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:[(0,D.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium mb-1",children:n("lifecycle.fieldPositionsInfo",{defaultValue:"Konfigurieren Sie die Positionen der Felder im Template-PDF."})}),(0,D.jsx)("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:n("lifecycle.fieldPositionsHint",{defaultValue:"Koordinaten in PDF-Punkten. A4: 595 x 842 Punkte. Y=0 ist unten, Y=842 ist oben. X=0 ist links, X=595 ist rechts."})})]}),(0,D.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:N.map((e=>{var t,r,a;return(0,D.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-3",children:[(0,D.jsx)("div",{className:"font-medium text-sm dark:text-white mb-2",children:A[e]||e}),(0,D.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"X"}),(0,D.jsx)("input",{type:"number",value:(null===(t=d[e])||void 0===t?void 0:t.x)||0,onChange:t=>v(e,"x",t.target.value),className:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",min:"0"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Y"}),(0,D.jsx)("input",{type:"number",value:(null===(r=d[e])||void 0===r?void 0:r.y)||0,onChange:t=>v(e,"y",t.target.value),className:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",min:"0"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:n("lifecycle.fontSize",{defaultValue:"Schriftgr\xf6\xdfe"})}),(0,D.jsx)("input",{type:"number",value:(null===(a=d[e])||void 0===a?void 0:a.fontSize)||12,onChange:t=>v(e,"fontSize",t.target.value),className:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",min:"8",max:"72"})]})]})]},e)}))}),(0,D.jsxs)("div",{className:"flex items-center justify-end space-x-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[(0,D.jsx)("button",{onClick:async()=>{if(window.confirm(n("lifecycle.resetFieldPositionsConfirm",{defaultValue:"Positionen auf Standardwerte zur\xfccksetzen?"}))){const e=50,t=20;let r=841.89-e-30;const a={userName:{x:e,y:r,fontSize:14},organizationName:{x:e,y:r-t,fontSize:12},currentDate:{x:e,y:r-2*t,fontSize:12},identificationNumber:{x:e,y:r-3*t,fontSize:12},startDate:{x:e,y:r-4*t,fontSize:12},endDate:{x:e,y:r-5*t,fontSize:12}};"contract"===i&&(a.position={x:e,y:r-6*t,fontSize:12},a.salary={x:e,y:r-7*t,fontSize:12},a.workingHours={x:e,y:r-8*t,fontSize:12});const s={};("certificate"===i?h:p).forEach((t=>{s[t]=a[t]||{x:e,y:r,fontSize:"userName"===t?14:12}})),m(s)}},className:"p-2 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 dark:text-white",title:n("common.reset",{defaultValue:"Zur\xfccksetzen"}),children:(0,D.jsx)(L.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{onClick:async()=>{b(!0);try{const e=(await j.A.get(w.Sn.ORGANIZATIONS.CURRENT)).data.settings||{};e.documentTemplates||(e.documentTemplates={});const t="certificate"===i?"employmentCertificate":"employmentContract";e.documentTemplates[t]||(e.documentTemplates[t]={}),e.documentTemplates[t].fields=d,await ke.h.updateOrganization({settings:e}),l(n("lifecycle.fieldPositionsSaved",{defaultValue:"Feld-Positionen erfolgreich gespeichert"}),"success"),r&&r()}catch(a){var e,t;console.error("Fehler beim Speichern:",a),l((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||n("lifecycle.saveError",{defaultValue:"Fehler beim Speichern"}),"error")}finally{b(!1)}},disabled:x,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-700 dark:hover:bg-blue-800",title:x?n("common.saving",{defaultValue:"Speichern..."}):n("common.save",{defaultValue:"Speichern"}),children:x?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})]})]})]})},ze=e=>{let{organization:t,onSave:r}=e;const{t:n}=(0,s.Bd)(),{showMessage:l}=(0,f.A)(),[i,o]=(0,a.useState)([]),[d,c]=(0,a.useState)(!1),[m,u]=(0,a.useState)(!1),[x,h]=(0,a.useState)(!1),[p,y]=(0,a.useState)("certificate"),k=a.useRef(null);(0,a.useEffect)((()=>{t&&v()}),[t]);const v=async()=>{c(!0);try{const e=(await j.A.get(w.Sn.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES)).data.documentTemplates||{},t=[];e.employmentCertificate&&t.push({name:"Arbeitszeugnis",type:"certificate",filePath:e.employmentCertificate.path,version:e.employmentCertificate.version}),e.employmentContract&&t.push({name:"Arbeitsvertrag",type:"contract",filePath:e.employmentContract.path,version:e.employmentContract.version}),o(t)}catch(a){var e,t,r;if(console.error("Fehler beim Laden der Templates:",a),404!==(null===(e=a.response)||void 0===e?void 0:e.status))l((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||n("lifecycle.loadTemplatesError",{defaultValue:"Fehler beim Laden der Templates"}),"error");o([])}finally{c(!1)}};return d?(0,D.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,D.jsx)(L.A,{className:"h-6 w-6 animate-spin text-gray-400"})}):(0,D.jsxs)("div",{className:"space-y-6",children:[(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsxs)("h3",{className:"text-lg font-semibold flex items-center dark:text-white",children:[(0,D.jsx)(b.A,{className:"h-5 w-5 mr-2"}),n("organization.documentTemplates",{defaultValue:"Dokumenten-Templates"})]}),(0,D.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,D.jsxs)("select",{value:p,onChange:e=>y(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm",children:[(0,D.jsx)("option",{value:"certificate",children:"Arbeitszeugnis"}),(0,D.jsx)("option",{value:"contract",children:"Arbeitsvertrag"})]}),(0,D.jsx)("button",{onClick:()=>{var e;return null===(e=k.current)||void 0===e?void 0:e.click()},disabled:x,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:x?n("common.uploading",{defaultValue:"Lade hoch..."}):n("lifecycle.uploadTemplate",{defaultValue:"Template hochladen"}),children:x?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(g.A,{className:"h-5 w-5"})})]}),(0,D.jsx)("input",{ref:k,type:"file",accept:".pdf",onChange:async e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r)if("application/pdf"===r.type){h(!0);try{const e=new FormData;e.append("file",r),e.append("type","certificate"===p?"employmentCertificate":"employmentContract");const t=await j.A.post(w.Sn.ORGANIZATION_LIFECYCLE.UPLOAD_TEMPLATE,e,{headers:{"Content-Type":"multipart/form-data"}});l(t.data.message||n("lifecycle.templateUploaded",{defaultValue:"Template erfolgreich hochgeladen"}),"success"),v()}catch(i){var a,s;console.error("Fehler beim Hochladen:",i),l((null===(a=i.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||n("lifecycle.uploadError",{defaultValue:"Fehler beim Hochladen"}),"error")}finally{h(!1),k.current&&(k.current.value="")}}else l(n("lifecycle.onlyPdfAllowed",{defaultValue:"Nur PDF-Dateien sind erlaubt"}),"error")},className:"hidden"})]}),0===i.length?(0,D.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,D.jsx)(b.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,D.jsx)("p",{children:n("lifecycle.noTemplates",{defaultValue:"Keine Templates vorhanden"})}),(0,D.jsx)("p",{className:"text-sm mt-2",children:n("lifecycle.uploadFirstTemplate",{defaultValue:"Laden Sie Ihr erstes Template hoch"})})]}):(0,D.jsx)("div",{className:"space-y-2",children:i.map((e=>(0,D.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("div",{className:"font-medium dark:text-white",children:e.name}),(0,D.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["certificate"===e.type?n("lifecycle.certificate",{defaultValue:"Arbeitszeugnis"}):n("lifecycle.contract",{defaultValue:"Arbeitsvertrag"}),e.version&&" - Version ".concat(e.version)]}),e.filePath&&(0,D.jsx)("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:e.filePath})]}),(0,D.jsx)("button",{onClick:()=>(async e=>{if(window.confirm(n("lifecycle.deleteTemplateConfirm",{defaultValue:"Template wirklich l\xf6schen?"})))try{const t=(await j.A.get(w.Sn.ORGANIZATIONS.CURRENT)).data.settings||{};if(t.documentTemplates){const r="certificate"===e?"employmentCertificate":"employmentContract";delete t.documentTemplates[r],await j.A.put(w.Sn.ORGANIZATIONS.CURRENT,{settings:t})}l(n("lifecycle.templateDeleted",{defaultValue:"Template erfolgreich gel\xf6scht"}),"success"),v()}catch(a){var t,r;console.error("Fehler beim L\xf6schen:",a),l((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||n("lifecycle.deleteError",{defaultValue:"Fehler beim L\xf6schen"}),"error")}})(e.type),className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900 rounded-md",title:n("common.delete",{defaultValue:"L\xf6schen"}),children:(0,D.jsx)(J.A,{className:"h-5 w-5"})})]},e.type)))})]}),(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,D.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,D.jsxs)("h3",{className:"text-lg font-semibold flex items-center dark:text-white",children:[(0,D.jsx)(b.A,{className:"h-5 w-5 mr-2"}),n("organization.documentSignatures",{defaultValue:"Dokumenten-Signaturen"})]})}),(0,D.jsx)(Se,{organization:t,onUpload:v})]}),(0,D.jsx)(Ce,{organization:t,onSave:r})]})},Re=e=>{let{organization:t,onSave:r}=e;const{t:n}=(0,s.Bd)(),{showMessage:l}=(0,f.A)(),[i,o]=(0,a.useState)(!1),[d,m]=(0,a.useState)({smtpHost:"",smtpPort:"587",smtpUser:"",smtpPass:"",smtpFromEmail:"",smtpFromName:""}),[u,g]=(0,a.useState)(!1);(0,a.useEffect)((()=>{if(null!==t&&void 0!==t&&t.settings){var e;const r=t.settings;m({smtpHost:r.smtpHost||"",smtpPort:(null===(e=r.smtpPort)||void 0===e?void 0:e.toString())||"587",smtpUser:r.smtpUser||"",smtpPass:r.smtpPass||"",smtpFromEmail:r.smtpFromEmail||(null!==t&&void 0!==t&&t.domain?"noreply@".concat(t.domain):""),smtpFromName:r.smtpFromName||(null===t||void 0===t?void 0:t.displayName)||""})}}),[t]);const x=e=>{const{name:t,value:r}=e.target;m((e=>(0,c.A)((0,c.A)({},e),{},{[t]:r})))};return(0,D.jsxs)("div",{className:"space-y-6",children:[(0,D.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,D.jsx)(ye.A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),(0,D.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n("organization.smtp.title")})]}),(0,D.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:n("organization.smtp.description")}),(0,D.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),d.smtpHost&&d.smtpUser&&d.smtpPass)try{o(!0);const e=(0,c.A)((0,c.A)({},(null===t||void 0===t?void 0:t.settings)||{}),{},{smtpHost:d.smtpHost,smtpPort:parseInt(d.smtpPort)||587,smtpUser:d.smtpUser,smtpPass:d.smtpPass,smtpFromEmail:d.smtpFromEmail,smtpFromName:d.smtpFromName});await ke.h.updateOrganization({settings:e}),l(n("organization.smtp.saveSuccess"),"success"),r&&r()}catch(i){var a,s;const e=(null===(a=i.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||n("organization.smtp.saveError");l(e,"error")}finally{o(!1)}else l(n("organization.smtp.requiredFields"),"error")},className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{htmlFor:"smtpHost",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[n("organization.smtp.host")," ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsx)("input",{type:"text",id:"smtpHost",name:"smtpHost",value:d.smtpHost,onChange:x,placeholder:"smtp.example.com",required:!0,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:n("organization.smtp.hostHint")})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{htmlFor:"smtpPort",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[n("organization.smtp.port")," ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsx)("input",{type:"number",id:"smtpPort",name:"smtpPort",value:d.smtpPort,onChange:x,placeholder:"587",required:!0,min:"1",max:"65535",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:n("organization.smtp.portHint")})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{htmlFor:"smtpUser",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[n("organization.smtp.user")," ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsx)("input",{type:"text",id:"smtpUser",name:"smtpUser",value:d.smtpUser,onChange:x,placeholder:"noreply@example.com",required:!0,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:n("organization.smtp.userHint")})]}),(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{htmlFor:"smtpPass",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[n("organization.smtp.password")," ",(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)("input",{type:u?"text":"password",id:"smtpPass",name:"smtpPass",value:d.smtpPass,onChange:x,placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",required:!0,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,D.jsx)("button",{type:"button",onClick:()=>g(!u),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:u?(0,D.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,D.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:n("organization.smtp.passwordHint")})]}),(0,D.jsxs)("div",{className:"border-t pt-4",children:[(0,D.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:n("organization.smtp.fromSettings")}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"smtpFromEmail",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.smtp.fromEmail")}),(0,D.jsx)("input",{type:"email",id:"smtpFromEmail",name:"smtpFromEmail",value:d.smtpFromEmail,onChange:x,placeholder:"noreply@example.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:n("organization.smtp.fromEmailHint")})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"smtpFromName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("organization.smtp.fromName")}),(0,D.jsx)("input",{type:"text",id:"smtpFromName",name:"smtpFromName",value:d.smtpFromName,onChange:x,placeholder:(null===t||void 0===t?void 0:t.displayName)||"Intranet",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:n("organization.smtp.fromNameHint")})]})]})]}),(0,D.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md p-4",children:[(0,D.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:(0,D.jsx)("strong",{children:n("organization.smtp.infoTitle")})}),(0,D.jsxs)("ul",{className:"mt-2 text-sm text-blue-700 dark:text-blue-300 list-disc list-inside space-y-1",children:[(0,D.jsx)("li",{children:n("organization.smtp.info1")}),(0,D.jsx)("li",{children:n("organization.smtp.info2")}),(0,D.jsx)("li",{children:n("organization.smtp.info3")})]})]}),(0,D.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,D.jsx)("button",{type:"button",onClick:()=>{m({smtpHost:"",smtpPort:"587",smtpUser:"",smtpPass:"",smtpFromEmail:null!==t&&void 0!==t&&t.domain?"noreply@".concat(t.domain):"",smtpFromName:(null===t||void 0===t?void 0:t.displayName)||""})},className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",title:n("organization.smtp.clear"),children:(0,D.jsx)(L.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"submit",disabled:i,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:n(i?"organization.saving":"common.save"),children:i?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})]})]})]})};var Le=r(6693);const Pe={lobbyPms:["app.lobbypms.com"],ttlock:["open.ttlock.com","euopen.ttlock.com","api.sciener.com"],sire:["api.sire.gov.co"],boldPayment:["api.bold.co","sandbox.bold.co"]},Ee=(e,t)=>{if(!e||"string"!==typeof e)return!1;try{const r=new URL(e);return Pe[t].some((e=>r.hostname===e||!!r.hostname.endsWith(".".concat(e))))}catch(r){return!1}},De=e=>{let{organization:t,onSave:r}=e;const{t:l}=(0,s.Bd)(),{showMessage:i}=(0,f.A)(),{canManageOrganization:o,loading:d}=(0,n.S)(),[m,u]=(0,a.useState)(!1),[g,x]=(0,a.useState)({lobbyPmsApiKey:"",lobbyPmsPropertyId:"",lobbyPmsSyncEnabled:!1,lobbyPmsAutoCreateTasks:!1,lobbyPmsAutoSendReservationInvitation:!0,lobbyPmsLateCheckInThreshold:"22:00",ttlockClientId:"",ttlockClientSecret:"",ttlockApiUrl:"https://open.ttlock.com",ttlockUsername:"",ttlockPassword:"",ttlockPasscodeType:"auto",sireApiUrl:"",sireApiKey:"",sireApiSecret:"",sireEnabled:!1,sireAutoRegisterOnCheckIn:!1,sirePropertyCode:"",boldPaymentApiKey:"",boldPaymentMerchantId:"",boldPaymentEnvironment:"sandbox",whatsappProvider:"twilio",whatsappApiKey:"",whatsappApiSecret:"",whatsappPhoneNumberId:""}),[b,h]=(0,a.useState)({});(0,a.useEffect)((()=>{if(null!==t&&void 0!==t&&t.settings){const e=t.settings,r=e.lobbyPms||{},a=e.doorSystem||{},s=e.sire||{},n=e.boldPayment||{},l=e.whatsapp||{};x({lobbyPmsApiKey:r.apiKey||"",lobbyPmsPropertyId:r.propertyId||"",lobbyPmsSyncEnabled:r.syncEnabled||!1,lobbyPmsAutoCreateTasks:r.autoCreateTasks||!1,lobbyPmsAutoSendReservationInvitation:!1!==r.autoSendReservationInvitation,lobbyPmsLateCheckInThreshold:r.lateCheckInThreshold||"22:00",ttlockClientId:a.clientId||"",ttlockClientSecret:a.clientSecret||"",ttlockApiUrl:a.apiUrl||"https://open.ttlock.com",ttlockUsername:a.username||"",ttlockPassword:"",ttlockPasscodeType:a.passcodeType||"auto",sireApiUrl:s.apiUrl||"",sireApiKey:s.apiKey||"",sireApiSecret:s.apiSecret||"",sireEnabled:s.enabled||!1,sireAutoRegisterOnCheckIn:s.autoRegisterOnCheckIn||!1,sirePropertyCode:s.propertyCode||"",boldPaymentApiKey:n.apiKey||"",boldPaymentMerchantId:n.merchantId||"",boldPaymentEnvironment:n.environment||"sandbox",whatsappProvider:l.provider||"twilio",whatsappApiKey:l.apiKey||"",whatsappApiSecret:l.apiSecret||"",whatsappPhoneNumberId:l.phoneNumberId||""})}}),[t]);const p=e=>{const{name:t,value:r,type:a}=e.target,s=e.target.checked;x((e=>(0,c.A)((0,c.A)({},e),{},{[t]:"checkbox"===a?s:r})))},k=e=>{let{name:t,value:r,onChange:a,placeholder:s,label:n,required:l=!1}=e;const i=b[t]||!1;return(0,D.jsxs)("div",{children:[(0,D.jsxs)("label",{htmlFor:t,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[n," ",l&&(0,D.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)("input",{type:i?"text":"password",id:t,name:t,value:r,onChange:a,placeholder:s||"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",required:l,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10"}),(0,D.jsx)("button",{type:"button",onClick:()=>{return e=t,void h((t=>(0,c.A)((0,c.A)({},t),{},{[e]:!t[e]})));var e},className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:i?(0,D.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12"})}):(0,D.jsxs)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]})};return d?(0,D.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,D.jsx)(L.A,{className:"h-6 w-6 animate-spin text-gray-400"}),(0,D.jsx)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:l("common.loadingPermissions")})]}):o()?(0,D.jsxs)("div",{className:"space-y-6",children:[(0,D.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,D.jsx)(Le.A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),(0,D.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:l("organization.api.title")})]}),(0,D.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:l("organization.api.description")}),(0,D.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!g.lobbyPmsSyncEnabled||g.lobbyPmsApiKey)if(!g.ttlockApiUrl||Ee(g.ttlockApiUrl,"ttlock"))if(!g.sireApiUrl||Ee(g.sireApiUrl,"sire"))if(!g.lobbyPmsLateCheckInThreshold||/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(g.lobbyPmsLateCheckInThreshold))try{u(!0);const e=(null===t||void 0===t?void 0:t.settings)||{},a=(0,c.A)((0,c.A)({},e),{},{lobbyPms:(0,c.A)((0,c.A)({},e.lobbyPms),{},{apiUrl:"https://app.lobbypms.com/api",apiKey:g.lobbyPmsApiKey||void 0,propertyId:g.lobbyPmsPropertyId||void 0,syncEnabled:g.lobbyPmsSyncEnabled,autoCreateTasks:g.lobbyPmsAutoCreateTasks,autoSendReservationInvitation:g.lobbyPmsAutoSendReservationInvitation,lateCheckInThreshold:g.lobbyPmsLateCheckInThreshold||void 0}),doorSystem:(0,c.A)((0,c.A)({},e.doorSystem),{},{provider:"ttlock",apiUrl:g.ttlockApiUrl||void 0,clientId:g.ttlockClientId||void 0,clientSecret:g.ttlockClientSecret||void 0,username:g.ttlockUsername||void 0,password:g.ttlockPassword||void 0,passcodeType:g.ttlockPasscodeType||"auto"}),sire:(0,c.A)((0,c.A)({},e.sire),{},{apiUrl:g.sireApiUrl||void 0,apiKey:g.sireApiKey||void 0,apiSecret:g.sireApiSecret||void 0,enabled:g.sireEnabled,autoRegisterOnCheckIn:g.sireAutoRegisterOnCheckIn,propertyCode:g.sirePropertyCode||void 0}),boldPayment:(0,c.A)((0,c.A)({},e.boldPayment),{},{apiKey:g.boldPaymentApiKey||void 0,merchantId:g.boldPaymentMerchantId||void 0,environment:g.boldPaymentEnvironment}),whatsapp:(0,c.A)((0,c.A)({},e.whatsapp),{},{provider:g.whatsappProvider,apiKey:g.whatsappApiKey||void 0,apiSecret:g.whatsappApiSecret||void 0,phoneNumberId:g.whatsappPhoneNumberId||void 0})});await ke.h.updateOrganization({settings:a}),i(l("organization.api.saveSuccess"),"success"),r&&r()}catch(s){var a;console.error("Error saving API settings:",s);let e=l("organization.api.saveError");if(null!==(a=s.response)&&void 0!==a&&a.data){const t=s.response.data;if(t.message&&(e=t.message),t.errors&&Array.isArray(t.errors)){const r=t.errors.map((e=>{var t;return"".concat((null===(t=e.path)||void 0===t?void 0:t.join("."))||"",": ").concat(e.message||"")})).filter((e=>e)).join(", ");r&&(e+=" (".concat(r,")")),t.errors.length>0&&"string"===typeof t.errors[0]&&(e=t.errors.join(", "))}}else s.message&&(e=s.message);i(e,"error")}finally{u(!1)}else i(l("organization.api.validation.invalidTimeFormat"),"error");else i(l("organization.api.validation.invalidUrl"),"error");else i(l("organization.api.validation.invalidUrl"),"error");else i(l("organization.api.validation.apiKeyRequired"),"error")},className:"space-y-6",children:[(0,D.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:l("organization.api.lobbyPms.title")}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsx)(k,{name:"lobbyPmsApiKey",value:g.lobbyPmsApiKey,onChange:p,label:l("organization.api.lobbyPms.apiKey"),placeholder:"API Token"}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"lobbyPmsPropertyId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.api.lobbyPms.propertyId")}),(0,D.jsx)("input",{type:"text",id:"lobbyPmsPropertyId",name:"lobbyPmsPropertyId",value:g.lobbyPmsPropertyId,onChange:p,placeholder:"Property ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)("label",{className:"flex items-center",children:[(0,D.jsx)("input",{type:"checkbox",name:"lobbyPmsSyncEnabled",checked:g.lobbyPmsSyncEnabled,onChange:p,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,D.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:l("organization.api.lobbyPms.syncEnabled")})]}),(0,D.jsxs)("label",{className:"flex items-center",children:[(0,D.jsx)("input",{type:"checkbox",name:"lobbyPmsAutoCreateTasks",checked:g.lobbyPmsAutoCreateTasks,onChange:p,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,D.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:l("organization.api.lobbyPms.autoCreateTasks")})]}),(0,D.jsxs)("label",{className:"flex items-center",children:[(0,D.jsx)("input",{type:"checkbox",name:"lobbyPmsAutoSendReservationInvitation",checked:g.lobbyPmsAutoSendReservationInvitation,onChange:p,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,D.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:l("organization.api.lobbyPms.autoSendReservationInvitation","Automatisch Einladung bei Reservation-Erstellung senden")})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"lobbyPmsLateCheckInThreshold",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.api.lobbyPms.lateCheckInThreshold")}),(0,D.jsx)("input",{type:"time",id:"lobbyPmsLateCheckInThreshold",name:"lobbyPmsLateCheckInThreshold",value:g.lobbyPmsLateCheckInThreshold,onChange:p,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]}),(0,D.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:l("organization.api.ttlock.title")}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"ttlockApiUrl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.api.ttlock.apiUrl")}),(0,D.jsx)("input",{type:"text",id:"ttlockApiUrl",name:"ttlockApiUrl",value:g.ttlockApiUrl,onChange:p,placeholder:"https://open.ttlock.com",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"ttlockClientId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.api.ttlock.clientId")}),(0,D.jsx)("input",{type:"text",id:"ttlockClientId",name:"ttlockClientId",value:g.ttlockClientId,onChange:p,placeholder:"Client ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsx)(k,{name:"ttlockClientSecret",value:g.ttlockClientSecret,onChange:p,label:l("organization.api.ttlock.clientSecret"),placeholder:"Client Secret"}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"ttlockUsername",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.api.ttlock.username")}),(0,D.jsx)("input",{type:"text",id:"ttlockUsername",name:"ttlockUsername",value:g.ttlockUsername,onChange:p,placeholder:"TTLock App Username (z.B. +573024498991)",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:l("organization.api.ttlock.usernameHint")})]}),(0,D.jsx)(k,{name:"ttlockPassword",value:g.ttlockPassword,onChange:p,label:l("organization.api.ttlock.password"),placeholder:"TTLock App Password"}),(0,D.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 -mt-2",children:l("organization.api.ttlock.passwordHint")}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"ttlockPasscodeType",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.api.ttlock.passcodeType")}),(0,D.jsxs)("select",{id:"ttlockPasscodeType",name:"ttlockPasscodeType",value:g.ttlockPasscodeType,onChange:p,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,D.jsx)("option",{value:"auto",children:l("organization.api.ttlock.passcodeTypeAuto")}),(0,D.jsx)("option",{value:"custom",children:l("organization.api.ttlock.passcodeTypeCustom")})]}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:l("organization.api.ttlock.passcodeTypeHint")})]})]})]}),(0,D.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:l("organization.api.sire.title")}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"sireApiUrl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.api.sire.apiUrl")}),(0,D.jsx)("input",{type:"text",id:"sireApiUrl",name:"sireApiUrl",value:g.sireApiUrl,onChange:p,placeholder:"https://api.sire.gov.co",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsx)(k,{name:"sireApiKey",value:g.sireApiKey,onChange:p,label:l("organization.api.sire.apiKey"),placeholder:"API Key"}),(0,D.jsx)(k,{name:"sireApiSecret",value:g.sireApiSecret,onChange:p,label:l("organization.api.sire.apiSecret"),placeholder:"API Secret"}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"sirePropertyCode",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.api.sire.propertyCode")}),(0,D.jsx)("input",{type:"text",id:"sirePropertyCode",name:"sirePropertyCode",value:g.sirePropertyCode,onChange:p,placeholder:"Property Code",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{className:"space-y-2",children:[(0,D.jsxs)("label",{className:"flex items-center",children:[(0,D.jsx)("input",{type:"checkbox",name:"sireEnabled",checked:g.sireEnabled,onChange:p,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,D.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:l("organization.api.sire.enabled")})]}),(0,D.jsxs)("label",{className:"flex items-center",children:[(0,D.jsx)("input",{type:"checkbox",name:"sireAutoRegisterOnCheckIn",checked:g.sireAutoRegisterOnCheckIn,onChange:p,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,D.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:l("organization.api.sire.autoRegisterOnCheckIn")})]})]})]})]}),(0,D.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:l("organization.api.boldPayment.title")}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsx)(k,{name:"boldPaymentApiKey",value:g.boldPaymentApiKey,onChange:p,label:l("organization.api.boldPayment.apiKey"),placeholder:"API Key"}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"boldPaymentMerchantId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.api.boldPayment.merchantId")}),(0,D.jsx)("input",{type:"text",id:"boldPaymentMerchantId",name:"boldPaymentMerchantId",value:g.boldPaymentMerchantId,onChange:p,placeholder:"Merchant ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"boldPaymentEnvironment",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.api.boldPayment.environment")}),(0,D.jsxs)("select",{id:"boldPaymentEnvironment",name:"boldPaymentEnvironment",value:g.boldPaymentEnvironment,onChange:p,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,D.jsx)("option",{value:"sandbox",children:l("organization.api.boldPayment.sandbox")}),(0,D.jsx)("option",{value:"production",children:l("organization.api.boldPayment.production")})]})]})]})]}),(0,D.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,D.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-4",children:l("organization.api.whatsapp.title")}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"whatsappProvider",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.api.whatsapp.provider")}),(0,D.jsxs)("select",{id:"whatsappProvider",name:"whatsappProvider",value:g.whatsappProvider,onChange:p,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,D.jsx)("option",{value:"twilio",children:l("organization.api.whatsapp.providerTwilio")}),(0,D.jsx)("option",{value:"whatsapp-business-api",children:l("organization.api.whatsapp.providerBusinessApi")})]})]}),(0,D.jsx)(k,{name:"whatsappApiKey",value:g.whatsappApiKey,onChange:p,label:l("organization.api.whatsapp.apiKey"),placeholder:"API Key / Access Token"}),(0,D.jsx)(k,{name:"whatsappApiSecret",value:g.whatsappApiSecret,onChange:p,label:l("organization.api.whatsapp.apiSecret"),placeholder:"API Secret (optional)"}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"whatsappPhoneNumberId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:l("organization.api.whatsapp.phoneNumberId")}),(0,D.jsx)("input",{type:"text",id:"whatsappPhoneNumberId",name:"whatsappPhoneNumberId",value:g.whatsappPhoneNumberId,onChange:p,placeholder:"Phone Number ID",className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]})]}),(0,D.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,D.jsx)("button",{type:"button",onClick:()=>{x({lobbyPmsApiKey:"",lobbyPmsPropertyId:"",lobbyPmsSyncEnabled:!1,lobbyPmsAutoCreateTasks:!1,lobbyPmsAutoSendReservationInvitation:!0,lobbyPmsLateCheckInThreshold:"22:00",ttlockClientId:"",ttlockClientSecret:"",ttlockApiUrl:"https://open.ttlock.com",ttlockUsername:"",ttlockPassword:"",ttlockPasscodeType:"auto",sireApiUrl:"",sireApiKey:"",sireApiSecret:"",sireEnabled:!1,sireAutoRegisterOnCheckIn:!1,sirePropertyCode:"",boldPaymentApiKey:"",boldPaymentMerchantId:"",boldPaymentEnvironment:"sandbox",whatsappProvider:"twilio",whatsappApiKey:"",whatsappApiSecret:"",whatsappPhoneNumberId:""})},className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",title:l("organization.api.clear"),children:(0,D.jsx)(L.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"submit",disabled:m,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:l(m?"organization.saving":"common.save"),children:m?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})]})]})]}):(0,D.jsx)("div",{className:"text-center py-8",children:(0,D.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:l("organization.api.noPermission")})})},Ie=e=>{let{isOpen:t,onClose:r,onSuccess:n,organization:l}=e;const{t:i}=(0,s.Bd)(),{fetchCurrentUser:o}=(0,P.As)(),[d,u]=(0,a.useState)({displayName:"",domain:"",logo:"",country:null,nit:null,settings:{}}),[g,x]=(0,a.useState)(""),[b,h]=(0,a.useState)(""),[k,v]=(0,a.useState)(!1),[j,w]=(0,a.useState)({}),[N,A]=(0,a.useState)(window.innerWidth<640),[S,C]=(0,a.useState)(window.innerWidth>1070),{openSidepane:z,closeSidepane:R}=(0,E.N)(),{showMessage:I}=(0,f.A)(),{organizationLanguage:F,setOrganizationLanguage:T}=(0,Ne.o)(),[_,B]=(0,a.useState)(""),[O,U]=(0,a.useState)(!1),[M,q]=(0,a.useState)("general"),[V,K]=(0,a.useState)(null),[G,W]=(0,a.useState)(null),H=[{code:"CO",name:i("countries.CO")},{code:"CH",name:i("countries.CH")},{code:"DE",name:i("countries.DE")},{code:"AT",name:i("countries.AT")}];(0,a.useEffect)((()=>{if(t&&l){const e=l.settings||{};u({displayName:l.displayName||"",domain:l.domain||"",logo:l.logo||"",country:l.country||null,nit:l.nit||null,settings:e}),x(l.country||""),h(l.nit||""),l.logo?W(l.logo):W(null),K(null);(async()=>{try{const e=await ke.h.getOrganizationLanguage();B(e.language||"")}catch(e){console.error(i("organization.loadLanguageError"),e),B("")}})()}}),[t,l,i]),(0,a.useEffect)((()=>{const e=()=>{A(window.innerWidth<640),C(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,a.useEffect)((()=>(t?z():R(),()=>{R()})),[t,z,R]);const J=e=>{const{name:t,value:r}=e.target;"country"===t?(x(r),u((e=>(0,c.A)((0,c.A)({},e),{},{country:r||null}))),"CO"!==r&&(h(""),u((e=>(0,c.A)((0,c.A)({},e),{},{nit:null}))))):"nit"===t?(h(r),u((e=>(0,c.A)((0,c.A)({},e),{},{nit:r||null})))):u((e=>(0,c.A)((0,c.A)({},e),{},{[t]:r}))),j[t]&&w((e=>(0,c.A)((0,c.A)({},e),{},{[t]:""})))},Y=e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!r)return;if(!r.type.match("image/(png|jpeg|jpg)"))return void I(i("organization.logoInvalidType")||"Nur PNG und JPEG Dateien sind erlaubt","error");if(r.size>5242880)return void I(i("organization.logoTooLarge")||"Logo darf maximal 5MB gro\xdf sein","error");K(r);const a=new FileReader;a.onloadend=()=>{const e=a.result;W(e),u((t=>(0,c.A)((0,c.A)({},t),{},{logo:e})))},a.readAsDataURL(r)},Z=async e=>{e.preventDefault();try{v(!0),w({}),await ke.h.updateOrganization(d),I(i("organization.updateSuccess"),"success");try{await o()}catch(s){console.error("Fehler beim Neuladen der User-Daten:",s)}r(),n&&n()}catch(l){var t,a;const e=(null===(t=l.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||i("organization.updateError");I(e,"error"),w({submit:e})}finally{v(!1)}},X=()=>{if(l){const e=l.settings||{};u({displayName:l.displayName||"",domain:l.domain||"",logo:l.logo||"",country:l.country||null,nit:l.nit||null,settings:e}),x(l.country||""),h(l.nit||"")}w({}),r()};return N?(0,D.jsxs)(m.lG,{open:t,onClose:X,className:"relative z-50",children:[(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,D.jsxs)(m.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,D.jsx)(m.lG.Title,{className:"text-lg font-semibold dark:text-white",children:i("organization.edit.title")}),(0,D.jsx)("button",{onClick:X,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("form",{onSubmit:Z,className:"p-4",children:[j.submit&&(0,D.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:j.submit}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.displayName")}),(0,D.jsx)("input",{type:"text",id:"displayName",name:"displayName",value:d.displayName||"",onChange:J,className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(j.displayName?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),j.displayName&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:j.displayName})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"domain",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.domain")}),(0,D.jsx)("input",{type:"text",id:"domain",name:"domain",value:d.domain||"",onChange:J,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"logo-mobile",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.logo")||"Logo"}),(0,D.jsx)("input",{type:"file",id:"logo-mobile",name:"logo",accept:"image/png,image/jpeg,image/jpg",onChange:Y,className:"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 dark:file:bg-blue-900 dark:file:text-blue-300 dark:hover:file:bg-blue-800"}),G&&(0,D.jsx)("div",{className:"mt-2",children:(0,D.jsx)("img",{src:G,alt:"Logo Preview",className:"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded"})}),d.logo&&!G&&(0,D.jsx)("div",{className:"mt-2",children:(0,D.jsx)("img",{src:d.logo,alt:"Current Logo",className:"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded"})})]}),(0,D.jsxs)("div",{className:"border-t pt-4",children:[(0,D.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.country")}),(0,D.jsxs)("select",{id:"country",name:"country",value:g,onChange:J,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,D.jsx)("option",{value:"",children:i("organization.selectCountry")}),H.map((e=>(0,D.jsx)("option",{value:e.code,children:e.name},e.code)))]})]}),(0,D.jsxs)("div",{className:"border-t pt-4",children:[(0,D.jsx)("label",{htmlFor:"organizationLanguage",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.language")}),(0,D.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:i("organization.languageDescription")}),(0,D.jsxs)("select",{id:"organizationLanguage",value:_||F||"",onChange:async e=>{const t=e.target.value;if(B(t),t&&t!==F){U(!0);try{await T(t),I(i("common.save"),"success")}catch(r){console.error(i("organization.saveLanguageError"),r),I(i("worktime.messages.orgLanguageError"),"error")}finally{U(!1)}}},disabled:O||k,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed",children:[(0,D.jsxs)("option",{value:"",children:[i("settings.useOrganizationLanguage")," (",i("worktime.language.fallback"),": ",i("worktime.language.german"),")"]}),(0,D.jsx)("option",{value:"de",children:i("worktime.language.german")}),(0,D.jsx)("option",{value:"es",children:i("worktime.language.spanish")}),(0,D.jsx)("option",{value:"en",children:i("worktime.language.english")})]})]})]}),(0,D.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,D.jsx)("button",{type:"button",onClick:X,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:i("common.cancel"),children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"submit",disabled:k,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:i(k?"organization.saving":"common.save"),children:k?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})]})]})]})})]}):(0,D.jsxs)(D.Fragment,{children:[t&&!S&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:X,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,D.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:i("organization.edit.title")}),(0,D.jsx)("button",{onClick:X,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,D.jsxs)("nav",{className:"-mb-px flex space-x-4 px-4","aria-label":"Tabs",children:[(0,D.jsx)("button",{type:"button",onClick:()=>q("general"),className:"".concat("general"===M?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:i("organization.tabs.general")}),(0,D.jsx)("button",{type:"button",onClick:()=>q("roles"),className:"".concat("roles"===M?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:i("organization.tabs.roles")}),(0,D.jsx)("button",{type:"button",onClick:()=>q("documents"),className:"".concat("documents"===M?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:i("organization.tabs.documents")}),(0,D.jsx)("button",{type:"button",onClick:()=>q("smtp"),className:"".concat("smtp"===M?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:i("organization.tabs.smtp")}),"CO"===g&&(0,D.jsx)("button",{type:"button",onClick:()=>q("api"),className:"".concat("api"===M?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:i("organization.tabs.api")})]})}),(0,D.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[j.submit&&(0,D.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:j.submit}),"general"===M&&(0,D.jsxs)("form",{onSubmit:Z,className:"space-y-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.displayName")}),(0,D.jsx)("input",{type:"text",id:"displayName",name:"displayName",value:d.displayName||"",onChange:J,className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(j.displayName?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600")}),j.displayName&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:j.displayName})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"domain",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.domain")}),(0,D.jsx)("input",{type:"text",id:"domain",name:"domain",value:d.domain||"",onChange:J,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"logo",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.logo")||"Logo"}),(0,D.jsx)("input",{type:"file",id:"logo",name:"logo",accept:"image/png,image/jpeg,image/jpg",onChange:Y,className:"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 dark:file:bg-blue-900 dark:file:text-blue-300 dark:hover:file:bg-blue-800"}),G&&(0,D.jsx)("div",{className:"mt-2",children:(0,D.jsx)("img",{src:G,alt:"Logo Preview",className:"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded"})}),d.logo&&!G&&(0,D.jsx)("div",{className:"mt-2",children:(0,D.jsx)("img",{src:d.logo,alt:"Current Logo",className:"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded"})})]}),(0,D.jsxs)("div",{className:"border-t pt-4",children:[(0,D.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.country")}),(0,D.jsxs)("select",{id:"country",name:"country",value:g,onChange:J,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2",children:[(0,D.jsx)("option",{value:"",children:i("organization.selectCountry")}),H.map((e=>(0,D.jsx)("option",{value:e.code,children:e.name},e.code)))]})]}),"CO"===g&&(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"nit",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.nit")}),(0,D.jsx)("input",{type:"text",id:"nit",name:"nit",value:b,onChange:J,placeholder:i("organization.nitDescription"),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"}),(0,D.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:i("organization.nitDescription")})]}),(0,D.jsxs)("div",{className:"border-t pt-4",children:[(0,D.jsx)("label",{htmlFor:"organizationLanguage",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("organization.language")}),(0,D.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:i("organization.languageDescription")}),(0,D.jsxs)("select",{id:"organizationLanguage",value:_||F||"",onChange:async e=>{const t=e.target.value;if(B(t),t&&t!==F){U(!0);try{await T(t),I(i("common.save"),"success")}catch(r){console.error("Fehler beim Speichern der Organisation-Sprache:",r),I(i("worktime.messages.orgLanguageError"),"error")}finally{U(!1)}}},disabled:O||k,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed",children:[(0,D.jsxs)("option",{value:"",children:[i("settings.useOrganizationLanguage")," (",i("worktime.language.fallback"),": ",i("worktime.language.german"),")"]}),(0,D.jsx)("option",{value:"de",children:i("worktime.language.german")}),(0,D.jsx)("option",{value:"es",children:i("worktime.language.spanish")}),(0,D.jsx)("option",{value:"en",children:i("worktime.language.english")})]})]}),(0,D.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,D.jsx)("button",{type:"button",onClick:X,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:i("common.cancel"),children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"submit",disabled:k,className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",title:i(k?"organization.saving":"common.save"),children:k?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):(0,D.jsx)(y.A,{className:"h-5 w-5"})})]})]}),"roles"===M&&(0,D.jsx)(Ae,{organization:l,onSave:()=>{n&&n()}}),"documents"===M&&(0,D.jsx)(ze,{organization:l,onSave:()=>{n&&n()}}),"smtp"===M&&(0,D.jsx)(Re,{organization:l,onSave:()=>{n&&n()}}),"api"===M&&"CO"===g&&(0,D.jsx)(De,{organization:l,onSave:()=>{n&&n()}})]})]})]})},Fe=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"approved":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case"rejected":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},Te=(e,t)=>{switch(e){case"pending":return t("joinRequestsList.status.pending");case"approved":return t("joinRequestsList.status.approved");case"rejected":return t("joinRequestsList.status.rejected");case"withdrawn":return t("joinRequestsList.status.withdrawn");default:return e}},_e="my-join-requests-table",Be=()=>{const{t:e}=(0,s.Bd)(),[t,r]=(0,a.useState)([]),[n,l]=(0,a.useState)(!0),[i,o]=(0,a.useState)(null),[d,m]=(0,a.useState)(!1),[u,g]=(0,a.useState)([]),[x,b]=(0,a.useState)([]),[h,y]=(0,a.useState)(""),{showMessage:k}=(0,f.A)(),v=(0,a.useRef)(!0),[N,A]=(0,a.useState)(null),[S,C]=(0,a.useState)("Alle"),[z,R]=(0,a.useState)(null);(0,a.useEffect)((()=>()=>{v.current=!1}),[]),(0,a.useEffect)((()=>{console.log("MyJoinRequestsList: useEffect called - component mounted"),console.log("MyJoinRequestsList: Resetting state on mount to prevent data leaks"),r([]),o(null),l(!0);let t=!0;return(async()=>{if(!t)return void console.log("MyJoinRequestsList: Component unmounted, skipping fetch");console.log("MyJoinRequestsList: Starting fetch");const a=setTimeout((()=>{t&&(console.error("Request timeout after 10 seconds"),o("Anfrage dauert zu lange. Bitte Seite neu laden."),l(!1))}),1e4);try{console.log("MyJoinRequestsList: Setting loading to true"),l(!0),o(null),console.log("MyJoinRequestsList: Fetching my join requests from:",w.Sn.ORGANIZATIONS.MY_JOIN_REQUESTS);const e=await ke.h.getMyJoinRequests();if(console.log("MyJoinRequestsList: Received requests:",e),console.log("MyJoinRequestsList: Requests type:",typeof e),console.log("MyJoinRequestsList: Requests isArray:",Array.isArray(e)),console.log("MyJoinRequestsList: Requests length:",(null===e||void 0===e?void 0:e.length)||0),!Array.isArray(e))throw console.error("\u274c MyJoinRequestsList: Response is not an array!",e),new Error("Ung\xfcltige Antwort vom Server");clearTimeout(a),t?(console.log("MyJoinRequestsList: Setting joinRequests state"),r(e),console.log("MyJoinRequestsList: State updated with",e.length,"requests")):(console.log("MyJoinRequestsList: Component was unmounted, but setting state anyway"),r(e))}catch(c){var s,n,i,d;if(clearTimeout(a),!t)return void console.log("MyJoinRequestsList: Component unmounted during error, skipping error handling");console.error("MyJoinRequestsList: Error fetching my join requests:",c),console.error("MyJoinRequestsList: Error response:",c.response),console.error("MyJoinRequestsList: Error status:",null===(s=c.response)||void 0===s?void 0:s.status),console.error("MyJoinRequestsList: Error data:",null===(n=c.response)||void 0===n?void 0:n.data);const r=(null===(i=c.response)||void 0===i||null===(d=i.data)||void 0===d?void 0:d.message)||c.message||e("myJoinRequests.loadError");o(r),setTimeout((()=>{k(r,"error")}),0)}finally{t?(console.log("MyJoinRequestsList: Setting loading to false"),l(!1)):(console.log("MyJoinRequestsList: Component unmounted, but setting loading to false anyway"),l(!1))}})(),()=>{console.log("MyJoinRequestsList: useEffect cleanup - component unmounting"),t=!1,v.current=!1,r([]),o(null)}}),[]);const P=e=>new Date(e).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),E=(e,t)=>{g(e),b(t)},I=()=>{g([]),b([]),C(""),R(null)},F=()=>u.length;(0,a.useEffect)((()=>{(async()=>{try{const e=await j.A.get(w.Sn.SAVED_FILTERS.BY_TABLE(_e)),t=e.data.find((e=>"Alle"===e.name));t&&(C("Alle"),R(t.id),E(t.conditions,t.operators))}catch(i){console.error("Fehler beim Setzen des initialen Filters:",i)}})()}),[]),(0,a.useEffect)((()=>{(async()=>{try{if(!localStorage.getItem("token"))return void console.error("Nicht authentifiziert");const e=(await j.A.get(w.Sn.SAVED_FILTERS.BY_TABLE(_e))).data||[];if(!e.some((e=>"Alle"===e.name))){const e={tableId:_e,name:"Alle",conditions:[],operators:[]};await j.A.post(w.Sn.SAVED_FILTERS.BASE,e),console.log("Alle-Filter f\xfcr Meine Beitrittsanfragen erstellt")}}catch(i){console.error("Fehler beim Erstellen der Standard-Filter:",i)}})()}),[]);const T=(0,a.useMemo)((()=>{let e=[...t];if(h){const t=h.toLowerCase();e=e.filter((e=>{var r;const a=(e.organization.displayName||e.organization.name||"").toLowerCase(),s=(null===(r=e.message)||void 0===r?void 0:r.toLowerCase())||"";return a.includes(t)||s.includes(t)}))}return u.length>0&&(e=u.reduce(((e,t,r)=>{if(!t.column||null===t.value||""===t.value)return e;const a=t.operator,s=t.value;return e.filter((e=>{var r;switch(t.column){case"organization":const t=(e.organization.displayName||e.organization.name||"").toLowerCase(),n=String(s).toLowerCase();return"contains"===a?t.includes(n):"equals"===a?t===n:"startsWith"===a&&t.startsWith(n);case"message":const l=(null===(r=e.message)||void 0===r?void 0:r.toLowerCase())||"",i=String(s).toLowerCase();return"contains"===a?l.includes(i):"equals"===a?l===i:"startsWith"===a&&l.startsWith(i);case"status":return"equals"===a&&e.status===s;default:return!0}}))}),e)),e}),[t,h,u,x]);return(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:e("myJoinRequests.title")}),(0,D.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,D.jsx)("input",{type:"text",placeholder:e("common.search",{defaultValue:"Suchen..."}),className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:h,onChange:e=>y(e.target.value)}),(0,D.jsxs)("button",{className:"p-2 rounded-md border ".concat(F()>0?"border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700"," relative"),onClick:()=>m(!d),title:e("common.filter"),children:[(0,D.jsx)(Z.A,{className:"h-5 w-5"}),F()>0&&(0,D.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center",children:F()})]})]})]}),d&&(0,D.jsx)("div",{className:"mb-4",children:(0,D.jsx)(X.A,{columns:[{id:"organization",label:e("myJoinRequests.filter.organization",{defaultValue:"Organisation"})},{id:"message",label:e("joinRequestsList.filter.message")},{id:"status",label:e("joinRequestsList.status.title",{defaultValue:"Status"})}],onApply:E,onReset:I,savedConditions:u,savedOperators:x,tableId:_e})}),(0,D.jsx)($.A,{tableId:_e,onSelectFilter:E,onReset:I,activeFilterName:S,selectedFilterId:z,onFilterChange:(e,t,r,a)=>{C(e),R(t),E(r,a)},defaultFilterName:"Alle"}),i&&(0,D.jsx)("div",{className:"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded",children:i}),n?(0,D.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,D.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,D.jsx)("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:e("myJoinRequests.loading")})]}):0===t.length?(0,D.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:e("myJoinRequests.noRequests")}):(0,D.jsx)("div",{className:"space-y-4",children:T.map((t=>(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,D.jsx)("div",{className:"flex items-start justify-between",children:(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.organization.displayName||t.organization.name}),(0,D.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:P(t.createdAt)})]}),(0,D.jsx)("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(Fe(t.status)),children:Te(t.status,e)})]}),t.message&&(0,D.jsx)("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:(0,D.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[(0,D.jsxs)("span",{className:"font-medium",children:[e("joinRequestsList.filter.message"),":"]})," ",t.message]})}),t.response&&(0,D.jsx)("div",{className:"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700",children:(0,D.jsxs)("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[(0,D.jsxs)("span",{className:"font-medium",children:[e("joinRequestsList.response"),":"]})," ",t.response]})}),t.processor&&(0,D.jsxs)("div",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:[e("myJoinRequests.processedBy"),": ",t.processor.firstName," ",t.processor.lastName,t.processedAt&&" - ".concat(P(t.processedAt))]}),"pending"===t.status&&(0,D.jsx)("div",{className:"mt-4 flex items-center gap-2",children:(0,D.jsx)("button",{onClick:()=>(async t=>{if(window.confirm(e("myJoinRequests.confirmWithdraw")))try{A(t),await ke.h.withdrawJoinRequest(t),r((e=>e.map((e=>e.id===t?(0,c.A)((0,c.A)({},e),{},{status:"withdrawn",processedAt:(new Date).toISOString()}):e)))),k(e("myJoinRequests.withdrawSuccess"),"success")}catch(n){var a,s;const t=(null===(a=n.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||e("myJoinRequests.withdrawError");k(t,"error")}finally{A(null)}})(t.id),disabled:N===t.id,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-md dark:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:N===t.id?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(L.A,{className:"h-4 w-4 mr-1 animate-spin"}),e("myJoinRequests.withdrawing")]}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(p.A,{className:"h-4 w-4 mr-1"}),e("myJoinRequests.withdraw")]})})})]})})},t.id)))})]})},Oe=()=>{const[e,t]=(0,a.useState)(null),[r,i]=(0,a.useState)(null),[d,c]=(0,a.useState)(!0),[m,u]=(0,a.useState)(!1),[x,b]=(0,a.useState)(null),[p,y]=(0,a.useState)(!1),[k,v]=(0,a.useState)(!1),[j,w]=(0,a.useState)(!1),{canViewOrganization:N,canManageOrganization:A,loading:C}=(0,n.S)(),{showMessage:z}=(0,f.A)(),{t:R}=(0,s.Bd)(),{refreshOrganization:L}=(0,ve.Z)(),{fetchCurrentUser:E}=(0,P.As)(),I=(0,a.useCallback)((async()=>{try{c(!0),b(null);const e=await ke.h.getCurrentOrganization(void 0,!0);t(e);try{u(!0);const e=await ke.h.getOrganizationStats();i(e)}catch(l){console.error("Fehler beim Laden der Statistiken:",l)}finally{u(!1)}}catch(o){var e,r,a;if(404===(null===(e=o.response)||void 0===e?void 0:e.status)&&!1===(null===(r=o.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.hasOrganization))b(R("organization.notFound")),t(null),z(R("organization.notFound"),"info");else{var s,n;const e=(null===(s=o.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.message)||R("organization.loadError");b(e),z(e,"error")}}finally{c(!1)}}),[]),F=(0,a.useRef)(!1);(0,a.useEffect)((()=>{if(C)return;if(F.current)return;N()?(F.current=!0,I()):(b(R("organization.noPermission")),c(!1),F.current=!0)}),[C]);if(C)return(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6",children:(0,D.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,D.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,D.jsx)("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:R("common.loadingPermissions")})]})});if(!N())return(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6",children:(0,D.jsx)("div",{className:"p-4 text-red-600 dark:text-red-400",children:R("organization.noPermission")})});return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsx)("div",{className:"flex items-center mb-4 sm:mb-4",children:(0,D.jsxs)("div",{className:"flex items-center","data-onboarding":"organization-buttons",children:[(0,D.jsx)("button",{onClick:()=>y(!0),"data-onboarding":"create-organization-button",className:"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},title:R("organization.createOrganization"),"aria-label":R("organization.createOrganization"),children:(0,D.jsx)(g.A,{className:"h-4 w-4"})}),(0,D.jsx)("button",{onClick:()=>v(!0),"data-onboarding":"join-organization-button",className:"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center ml-2",style:{width:"30.19px",height:"30.19px"},title:R("organization.joinOrganization"),"aria-label":R("organization.joinOrganization"),children:(0,D.jsx)(pe.A,{className:"h-4 w-4"})})]})}),d?(0,D.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,D.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,D.jsx)("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:R("common.loadingOrganization")})]}):(0,D.jsxs)(D.Fragment,{children:[x&&(0,D.jsx)("div",{className:"mb-4 p-4 border rounded ".concat(e?"bg-red-100 dark:bg-red-900 border-red-400 dark:border-red-700 text-red-700 dark:text-red-300":"bg-blue-50 dark:bg-blue-900/30 border-blue-400 dark:border-blue-700 text-blue-700 dark:text-blue-300"),children:(0,D.jsxs)("div",{className:"flex items-start",children:[(0,D.jsx)("div",{className:"flex-shrink-0",children:e?(0,D.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"\u26a0\ufe0f"}):(0,D.jsx)(l.A,{className:"h-5 w-5"})}),(0,D.jsxs)("div",{className:"ml-3 flex-1",children:[(0,D.jsx)("p",{className:"font-medium",children:x}),!e&&(0,D.jsx)("p",{className:"mt-2 text-sm",children:R("organization.createOrJoinHint")})]})]})}),e?(0,D.jsx)(D.Fragment,{children:(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,D.jsx)("div",{className:"flex items-start justify-between",children:(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center",children:[(0,D.jsx)(h.A,{className:"h-5 w-5 mr-2"}),e.displayName||e.name]}),(0,D.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.domain||R("organization.noDomain")})]}),A()&&(0,D.jsx)("button",{onClick:()=>w(!0),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1",title:R("organization.edit.title"),children:(0,D.jsx)(S.A,{className:"h-5 w-5"})})]}),(0,D.jsx)("div",{className:"space-y-3",children:e.subscriptionPlan&&(0,D.jsxs)("div",{children:[(0,D.jsxs)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[R("organization.subscriptionPlan"),":"]}),(0,D.jsx)("span",{className:"ml-2 text-sm text-gray-900 dark:text-white capitalize",children:e.subscriptionPlan})]})}),r&&(0,D.jsx)(D.Fragment,{children:(0,D.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,D.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:R("organization.statistics")}),m?(0,D.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,D.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-2"}),(0,D.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:R("common.loadingStatistics")})]}):(0,D.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,D.jsxs)("div",{className:"flex items-center",children:[(0,D.jsx)("div",{className:"flex-shrink-0 bg-blue-100 dark:bg-blue-900/30 rounded-lg p-3",children:(0,D.jsx)(l.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),(0,D.jsxs)("div",{className:"ml-4",children:[(0,D.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:R("organization.users")}),(0,D.jsxs)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:[r.currentUsers," / ",r.maxUsers]}),void 0!==r.utilizationPercent&&(0,D.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[r.utilizationPercent,"% ",R("organization.utilizationPercent")]})]})]})}),(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,D.jsxs)("div",{className:"flex items-center",children:[(0,D.jsx)("div",{className:"flex-shrink-0 bg-purple-100 dark:bg-purple-900/30 rounded-lg p-3",children:(0,D.jsx)(o.A,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})}),(0,D.jsxs)("div",{className:"ml-4",children:[(0,D.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:R("organization.roles")}),(0,D.jsx)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:r._count.roles})]})]})}),(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,D.jsxs)("div",{className:"flex items-center",children:[(0,D.jsx)("div",{className:"flex-shrink-0 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg p-3",children:(0,D.jsx)(ye.A,{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400"})}),(0,D.jsxs)("div",{className:"ml-4",children:[(0,D.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:R("organization.joinRequests")}),(0,D.jsx)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:r._count.joinRequests})]})]})}),void 0!==r._count.invitations&&(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,D.jsxs)("div",{className:"flex items-center",children:[(0,D.jsx)("div",{className:"flex-shrink-0 bg-green-100 dark:bg-green-900/30 rounded-lg p-3",children:(0,D.jsx)(ye.A,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),(0,D.jsxs)("div",{className:"ml-4",children:[(0,D.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:R("organization.invitations")}),(0,D.jsx)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:r._count.invitations})]})]})}),void 0!==r.utilizationPercent&&(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,D.jsxs)("div",{className:"flex items-center",children:[(0,D.jsx)("div",{className:"flex-shrink-0 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg p-3",children:(0,D.jsx)(fe.A,{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400"})}),(0,D.jsxs)("div",{className:"ml-4",children:[(0,D.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:R("organization.utilization")}),(0,D.jsxs)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:[r.utilizationPercent,"%"]}),(0,D.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[r.availableSlots," ",R("organization.availableSlots")]})]})]})})]})]})})]})})})}):(0,D.jsxs)("div",{className:"text-center py-8",children:[(0,D.jsx)(l.A,{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500 mb-4"}),(0,D.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:R("organization.notFound")}),(0,D.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:R("organization.createOrJoinHint")})]})]})]}),(0,D.jsx)(Be,{}),(0,D.jsx)(je,{isOpen:p,onClose:()=>y(!1),onSuccess:()=>{I()}}),(0,D.jsx)(we,{isOpen:k,onClose:()=>v(!1),onSuccess:async()=>{I(),await E()}}),(0,D.jsx)(Ie,{isOpen:j,onClose:()=>w(!1),onSuccess:()=>{I(),L()},organization:e})]})},Ue=e=>{let{isOpen:t,onClose:r,joinRequest:n,onSuccess:l}=e;const{t:i}=(0,s.Bd)(),[o,d]=(0,a.useState)("approve"),[g,x]=(0,a.useState)(null),[b,h]=(0,a.useState)(""),[k,v]=(0,a.useState)([]),[j,w]=(0,a.useState)(!1),[N,A]=(0,a.useState)(!1),[S,C]=(0,a.useState)({}),[z,R]=(0,a.useState)(window.innerWidth<640),[P,I]=(0,a.useState)(window.innerWidth>1070),{openSidepane:F,closeSidepane:T}=(0,E.N)(),{showMessage:_}=(0,f.A)();(0,a.useEffect)((()=>{const e=()=>{R(window.innerWidth<640),I(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,a.useEffect)((()=>(t?F():T(),()=>{T()})),[t,F,T]),(0,a.useEffect)((()=>{t&&n&&(d("approve"),x(null),h(""),C({}),n.organizationId&&B())}),[t,n]);const B=async()=>{try{w(!0);const e=await u.Zj.getAll();e.data&&Array.isArray(e.data)&&v(e.data)}catch(e){console.error("Fehler beim Laden der Rollen:",e),_(i("joinRequest.loadRolesError"),"error")}finally{w(!1)}},U=async e=>{if(e.preventDefault(),(()=>{const e={};return"approve"!==o||g||(e.roleId=i("joinRequest.selectRoleError")),C(e),0===Object.keys(e).length})()){if(n)try{A(!0);const e={action:o,response:b.trim()||void 0,roleId:"approve"===o&&g||void 0};await ke.h.processJoinRequest(n.id,e),_(i("approve"===o?"joinRequest.approveSuccess":"joinRequest.rejectSuccess"),"success"),d("approve"),x(null),h(""),C({}),r(),l()}catch(s){var t,a;const e=(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||i("joinRequest.processError");_(e,"error"),C({submit:e})}finally{A(!1)}}else _(i("joinRequest.fillRequired"),"error")},M=()=>{d("approve"),x(null),h(""),C({}),r()};return n?z?(0,D.jsxs)(m.lG,{open:t,onClose:M,className:"relative z-50",children:[(0,D.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,D.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,D.jsxs)(m.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,D.jsx)(m.lG.Title,{className:"text-lg font-semibold dark:text-white",children:i("joinRequest.title")}),(0,D.jsx)("button",{onClick:M,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("form",{onSubmit:U,className:"p-4",children:[S.submit&&(0,D.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:S.submit}),(0,D.jsxs)("div",{className:"space-y-4",children:[(0,D.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:[(0,D.jsxs)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("joinRequest.applicant"),":"]}),(0,D.jsxs)("p",{className:"text-sm text-gray-900 dark:text-white",children:[n.requester.firstName," ",n.requester.lastName]}),(0,D.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:n.requester.email}),n.message&&(0,D.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[(0,D.jsxs)("p",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("joinRequest.message"),":"]}),(0,D.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:n.message})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("joinRequest.actionRequired")}),(0,D.jsxs)("div",{className:"flex gap-4 mt-2",children:[(0,D.jsxs)("label",{className:"flex items-center",children:[(0,D.jsx)("input",{type:"radio",value:"approve",checked:"approve"===o,onChange:e=>{d(e.target.value),C({})},className:"mr-2 text-blue-600 focus:ring-blue-500"}),(0,D.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:i("joinRequest.approve")})]}),(0,D.jsxs)("label",{className:"flex items-center",children:[(0,D.jsx)("input",{type:"radio",value:"reject",checked:"reject"===o,onChange:e=>{d(e.target.value),C({})},className:"mr-2 text-red-600 focus:ring-red-500"}),(0,D.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:i("joinRequest.reject")})]})]})]}),"approve"===o&&(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"roleId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("joinRequest.assignRole")}),j?(0,D.jsxs)("div",{className:"flex items-center py-2",children:[(0,D.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),(0,D.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("joinRequest.loadingRoles")})]}):(0,D.jsxs)("select",{id:"roleId",value:g||"",onChange:e=>{x(Number(e.target.value)||null),S.roleId&&C((e=>(0,c.A)((0,c.A)({},e),{},{roleId:""})))},className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(S.roleId?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"),children:[(0,D.jsx)("option",{value:"",children:i("joinRequest.selectRole")}),k.map((e=>(0,D.jsxs)("option",{value:e.id,children:[e.name," ",e.description?"- ".concat(e.description):""]},e.id)))]}),S.roleId&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:S.roleId})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"response",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("joinRequest.response")}),(0,D.jsx)("textarea",{id:"response",value:b,onChange:e=>h(e.target.value),rows:3,placeholder:i("joinRequest.addOptional",{type:i("approve"===o?"joinRequest.welcomeMessage":"joinRequest.rejectionReason")}),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]})]}),(0,D.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,D.jsx)("button",{type:"button",onClick:M,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",title:i("joinRequest.cancel"),children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"submit",disabled:N,className:"p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ".concat("approve"===o?"bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500":"bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500"),title:i(N?"approve"===o?"joinRequest.approving":"joinRequest.rejecting":"approve"===o?"joinRequest.approve":"joinRequest.reject"),children:N?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):"approve"===o?(0,D.jsx)(y.A,{className:"h-5 w-5"}):(0,D.jsx)(O.A,{className:"h-5 w-5"})})]})]})]})})]}):(0,D.jsxs)(D.Fragment,{children:[t&&!P&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:M,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,D.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,D.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:i("joinRequest.title")}),(0,D.jsx)("button",{onClick:M,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,D.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,D.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[S.submit&&(0,D.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:S.submit}),(0,D.jsxs)("form",{onSubmit:U,className:"space-y-4",children:[(0,D.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:[(0,D.jsxs)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("joinRequest.applicant"),":"]}),(0,D.jsxs)("p",{className:"text-sm text-gray-900 dark:text-white",children:[n.requester.firstName," ",n.requester.lastName]}),(0,D.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:n.requester.email}),n.message&&(0,D.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[(0,D.jsxs)("p",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("joinRequest.message"),":"]}),(0,D.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:n.message})]})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("joinRequest.actionRequired")}),(0,D.jsxs)("div",{className:"flex gap-4 mt-2",children:[(0,D.jsxs)("label",{className:"flex items-center",children:[(0,D.jsx)("input",{type:"radio",value:"approve",checked:"approve"===o,onChange:e=>{d(e.target.value),C({})},className:"mr-2 text-blue-600 focus:ring-blue-500"}),(0,D.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:i("joinRequest.approve")})]}),(0,D.jsxs)("label",{className:"flex items-center",children:[(0,D.jsx)("input",{type:"radio",value:"reject",checked:"reject"===o,onChange:e=>{d(e.target.value),C({})},className:"mr-2 text-red-600 focus:ring-red-500"}),(0,D.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:i("joinRequest.reject")})]})]})]}),"approve"===o&&(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"roleId",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("joinRequest.assignRole")}),j?(0,D.jsxs)("div",{className:"flex items-center py-2",children:[(0,D.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),(0,D.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("joinRequest.loadingRoles")})]}):(0,D.jsxs)("select",{id:"roleId",value:g||"",onChange:e=>{x(Number(e.target.value)||null),S.roleId&&C((e=>(0,c.A)((0,c.A)({},e),{},{roleId:""})))},className:"mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ".concat(S.roleId?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"),children:[(0,D.jsx)("option",{value:"",children:i("joinRequest.selectRole")}),k.map((e=>(0,D.jsxs)("option",{value:e.id,children:[e.name," ",e.description?"- ".concat(e.description):""]},e.id)))]}),S.roleId&&(0,D.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:S.roleId})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"response",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("joinRequest.response")}),(0,D.jsx)("textarea",{id:"response",value:b,onChange:e=>h(e.target.value),rows:3,placeholder:i("joinRequest.addOptional",{type:i("approve"===o?"joinRequest.welcomeMessage":"joinRequest.rejectionReason")}),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2"})]}),(0,D.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,D.jsx)("button",{type:"button",onClick:M,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:i("common.cancel"),children:(0,D.jsx)(p.A,{className:"h-5 w-5"})}),(0,D.jsx)("button",{type:"submit",disabled:N,className:"p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ".concat("approve"===o?"bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500":"bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500"),title:N?"approve"===o?"Genehmige...":"Lehne ab...":"approve"===o?"Genehmigen":"Ablehnen",children:N?(0,D.jsx)(L.A,{className:"h-5 w-5 animate-spin"}):"approve"===o?(0,D.jsx)(y.A,{className:"h-5 w-5"}):(0,D.jsx)(O.A,{className:"h-5 w-5"})})]})]})]})]})]}):null},Me=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"approved":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case"rejected":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},qe=(e,t)=>{switch(e){case"pending":return t("joinRequestsList.status.pending");case"approved":return t("joinRequestsList.status.approved");case"rejected":return t("joinRequestsList.status.rejected");case"withdrawn":return t("joinRequestsList.status.withdrawn");default:return e}},Ve="join-requests-table",Ke=()=>{const{t:e}=(0,s.Bd)(),[t,r]=(0,a.useState)([]),[l,i]=(0,a.useState)(!0),[o,d]=(0,a.useState)(null),[c,m]=(0,a.useState)(!1),[u,g]=(0,a.useState)([]),[x,b]=(0,a.useState)([]),[h,p]=(0,a.useState)(""),[y,k]=(0,a.useState)(!1),[v,N]=(0,a.useState)(null),[A,C]=(0,a.useState)("Alle"),[z,R]=(0,a.useState)(null),{canViewJoinRequests:L,canManageJoinRequests:P,loading:E}=(0,n.S)(),{showMessage:I}=(0,f.A)(),F=(0,a.useRef)(!0),T=(0,a.useRef)(!1);(0,a.useEffect)((()=>{console.log("[JoinRequestsList] permissionsLoading ge\xe4ndert:",E)}),[E]),(0,a.useEffect)((()=>(console.log("[JoinRequestsList] Component mounted, reset hasInitialLoadRef"),T.current=!1,F.current=!0,()=>{console.log("[JoinRequestsList] Component unmounting"),F.current=!1})),[]),(0,a.useEffect)((()=>{if(console.log("[JoinRequestsList] useEffect triggered",{permissionsLoading:E,hasInitialLoad:T.current,joinRequestsCount:t.length}),E)return void console.log("[JoinRequestsList] Warte auf Berechtigungen...");const a=L();if(console.log("[JoinRequestsList] Berechtigung gepr\xfcft:",a),!a)return console.log("[JoinRequestsList] Keine Berechtigung zum Anzeigen"),d(e("joinRequestsList.noPermission")),i(!1),void(T.current=!0);if(T.current)return void console.log("[JoinRequestsList] Bereits geladen, \xfcberspringe Fetch");console.log("[JoinRequestsList] Starte Fetch der Join Requests...");(async()=>{if(F.current)try{console.log("[JoinRequestsList] Setze loading auf true"),i(!0),d(null),console.log("[JoinRequestsList] Rufe organizationService.getJoinRequests() auf..."),console.log("[JoinRequestsList] API Endpoint:",w.Sn.ORGANIZATIONS.JOIN_REQUESTS);const e=await ke.h.getJoinRequests();if(console.log("[JoinRequestsList] Antwort erhalten:",e),console.log("[JoinRequestsList] Antwort Typ:",typeof e),console.log("[JoinRequestsList] Ist Array:",Array.isArray(e)),console.log("[JoinRequestsList] Ist null/undefined:",null===e||void 0===e),!F.current)return void console.log("[JoinRequestsList] Component w\xe4hrend Request unmounted");if(null===e||void 0===e)throw console.error("[JoinRequestsList] \u274c Antwort ist null oder undefined!"),new Error("Ung\xfcltige Antwort vom Server: Antwort ist null oder undefined");if(!Array.isArray(e))throw console.error("[JoinRequestsList] \u274c Antwort ist kein Array!",e),new Error("Ung\xfcltige Antwort vom Server: Erwartetes Array, erhalten: "+typeof e);console.log("[JoinRequestsList] \u2705 Setze",e.length,"Join Requests"),r(e),d(null),T.current=!0}catch(l){var t,a,s,n;if(console.error("[JoinRequestsList] \u274c Fehler beim Laden:",l),console.error("[JoinRequestsList] Fehler Details:",{message:l.message,response:l.response,status:null===(t=l.response)||void 0===t?void 0:t.status,data:null===(a=l.response)||void 0===a?void 0:a.data,stack:l.stack}),!F.current)return void console.log("[JoinRequestsList] Component w\xe4hrend Error-Handling unmounted");const r=(null===(s=l.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.message)||l.message||e("joinRequestsList.loadError",{defaultValue:"Fehler beim Laden der Beitrittsanfragen"});console.log("[JoinRequestsList] Zeige Fehlermeldung:",r),d(r),setTimeout((()=>{I(r,"error")}),0)}finally{F.current&&(console.log("[JoinRequestsList] Setze loading auf false"),i(!1))}else console.log("[JoinRequestsList] Component unmounted, breche ab")})()}),[E]);const _=(e,t)=>{g(e),b(t)},B=()=>{g([]),b([]),C(""),R(null)},O=()=>u.length;(0,a.useEffect)((()=>{(async()=>{try{const e=await j.A.get(w.Sn.SAVED_FILTERS.BY_TABLE(Ve)),t=e.data.find((e=>"Alle"===e.name));t&&(C("Alle"),R(t.id),_(t.conditions,t.operators))}catch(o){console.error("Fehler beim Setzen des initialen Filters:",o)}})()}),[]),(0,a.useEffect)((()=>{(async()=>{try{if(!localStorage.getItem("token"))return void console.error("Nicht authentifiziert");const e=(await j.A.get(w.Sn.SAVED_FILTERS.BY_TABLE(Ve))).data||[];if(!e.some((e=>"Alle"===e.name))){const e={tableId:Ve,name:"Alle",conditions:[],operators:[]};await j.A.post(w.Sn.SAVED_FILTERS.BASE,e),console.log("Alle-Filter f\xfcr Join Requests erstellt")}}catch(o){console.error("Fehler beim Erstellen der Standard-Filter:",o)}})()}),[]);const U=(0,a.useMemo)((()=>{let e=[...t];if(h){const t=h.toLowerCase();e=e.filter((e=>{var r,a;const s="".concat(e.requester.firstName," ").concat(e.requester.lastName).toLowerCase(),n=(null===(r=e.requester.email)||void 0===r?void 0:r.toLowerCase())||"",l=(null===(a=e.message)||void 0===a?void 0:a.toLowerCase())||"";return s.includes(t)||n.includes(t)||l.includes(t)}))}return u.length>0&&(e=u.reduce(((e,t,r)=>{if(!t.column||null===t.value||""===t.value)return e;const a=t.operator,s=t.value;return e.filter((e=>{var r,n;switch(t.column){case"requester":const t="".concat(e.requester.firstName," ").concat(e.requester.lastName).toLowerCase(),l=(null===(r=e.requester.email)||void 0===r?void 0:r.toLowerCase())||"",i=String(s).toLowerCase();return"contains"===a?t.includes(i)||l.includes(i):"equals"===a?t===i||l===i:"startsWith"===a&&(t.startsWith(i)||l.startsWith(i));case"message":const o=(null===(n=e.message)||void 0===n?void 0:n.toLowerCase())||"",d=String(s).toLowerCase();return"contains"===a?o.includes(d):"equals"===a?o===d:"startsWith"===a&&o.startsWith(d);case"status":return"equals"===a&&e.status===s;default:return!0}}))}),e)),e}),[t,h,u,x]);return E?(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6",children:(0,D.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,D.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,D.jsx)("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:e("joinRequestsList.loadingPermissions")})]})}):L()?(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 sm:p-6 mb-6",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-4 sm:mb-4",children:[(0,D.jsxs)("h2",{className:"text-xl sm:text-xl font-semibold flex items-center dark:text-white",children:[(0,D.jsx)(pe.A,{className:"h-6 w-6 sm:h-6 sm:w-6 mr-2 sm:mr-2"}),e("joinRequestsList.title")]}),(0,D.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,D.jsx)("input",{type:"text",placeholder:e("common.search",{defaultValue:"Suchen..."}),className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:h,onChange:e=>p(e.target.value)}),(0,D.jsxs)("button",{className:"p-2 rounded-md border ".concat(O()>0?"border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700"," relative"),onClick:()=>m(!c),title:e("common.filter"),children:[(0,D.jsx)(Z.A,{className:"h-5 w-5"}),O()>0&&(0,D.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center",children:O()})]})]})]}),c&&(0,D.jsx)("div",{className:"mb-4",children:(0,D.jsx)(X.A,{columns:[{id:"requester",label:e("joinRequestsList.filter.requester")},{id:"message",label:e("joinRequestsList.filter.message")},{id:"status",label:e("joinRequestsList.status.title",{defaultValue:"Status"})}],onApply:_,onReset:B,savedConditions:u,savedOperators:x,tableId:Ve})}),(0,D.jsx)($.A,{tableId:Ve,onSelectFilter:_,onReset:B,activeFilterName:A,selectedFilterId:z,onFilterChange:(e,t,r,a)=>{C(e),R(t),_(r,a)},defaultFilterName:"Alle"}),o&&(0,D.jsx)("div",{className:"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded",children:o}),l?(0,D.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,D.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,D.jsx)("span",{className:"ml-3 text-gray-700 dark:text-gray-300",children:e("joinRequestsList.loading")})]}):0===U.length?(0,D.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:0===t.length?e("joinRequestsList.noRequests"):e("joinRequestsList.noMatching")}):(0,D.jsx)("div",{className:"space-y-4",children:U.map((t=>(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow",children:(0,D.jsx)("div",{className:"flex items-start justify-between",children:(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,D.jsxs)("div",{children:[(0,D.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[t.requester.firstName," ",t.requester.lastName]}),(0,D.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.requester.email})]}),(0,D.jsx)("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(Me(t.status)),children:qe(t.status,e)})]}),t.message&&(0,D.jsx)("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:(0,D.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[(0,D.jsxs)("span",{className:"font-medium",children:[e("joinRequestsList.filter.message"),":"]})," ",t.message]})}),t.response&&(0,D.jsx)("div",{className:"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700",children:(0,D.jsxs)("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[(0,D.jsxs)("span",{className:"font-medium",children:[e("joinRequestsList.response"),":"]})," ",t.response]})}),"pending"===t.status&&P()&&(0,D.jsx)("div",{className:"mt-4 flex items-center gap-2",children:(0,D.jsxs)("button",{onClick:()=>(t=>{if(!P()){const t=e("joinRequestsList.noPermissionEdit");return d(t),void I(t,"error")}N(t),k(!0)})(t),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-md dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center",children:[(0,D.jsx)(S.A,{className:"h-4 w-4 mr-1"}),e("joinRequestsList.edit")]})})]})})},t.id)))}),(0,D.jsx)(Ue,{isOpen:y,onClose:()=>{k(!1),N(null)},joinRequest:v,onSuccess:async()=>{T.current=!1;try{i(!0);const e=await ke.h.getJoinRequests();r(e),d(null),T.current=!0}catch(a){var e,t;const r=(null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Fehler beim Laden der Beitrittsanfragen";d(r),T.current=!0}finally{i(!1)}}})]}):(0,D.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6",children:(0,D.jsx)("div",{className:"p-4 text-red-600 dark:text-red-400",children:e("joinRequestsList.noPermission")})})},Ge=()=>{const{t:e}=(0,s.Bd)(),[t,r]=(0,a.useState)(!1),[c,m]=(0,a.useState)(null),{showMessage:u}=(0,f.A)(),{isAdmin:g,hasPermission:x,canViewOrganization:b,loading:h}=(0,n.S)(),p=x("organization_management","read","page"),y=x("users","read","table"),k=x("roles","read","table"),v=x("branches","read","table"),j=b(),[w,N]=(0,a.useState)("users"),A=(0,a.useRef)(!1);(0,a.useEffect)((()=>{if(!h&&!A.current){let e="organization";y?e="users":k?e="roles":v?e="branches":j&&(e="organization"),N(e),A.current=!0}}),[h,y,k,v,j]);const S=e=>{("users"!==e||y)&&("roles"!==e||k)&&("branches"!==e||v)&&("organization"!==e||j)&&(N(e),m(null))},C=t=>{var r,a;let s=e("errors.unknownError");null!==(r=t.response)&&void 0!==r&&null!==(a=r.data)&&void 0!==a&&a.message?s=t.response.data.message:t instanceof Error&&(s=t.message),m(s),u(s,"error")};return p?(0,D.jsx)("div",{className:"min-h-screen dark:bg-gray-900",children:(0,D.jsx)("div",{className:"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6",children:(0,D.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,D.jsxs)("div",{className:"flex items-center mb-6",children:[(0,D.jsx)(l.A,{className:"h-6 w-6 mr-2 dark:text-white"}),(0,D.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:e("organisation.title")})]}),(0,D.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:(0,D.jsxs)("nav",{className:"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden",children:[(0,D.jsxs)("button",{className:"".concat("users"===w&&y?"border-blue-500 text-blue-600 dark:text-blue-400":y?"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600":"border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60"," whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0"),onClick:()=>y&&S("users"),disabled:!y,children:[(0,D.jsx)(i.A,{className:"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2"}),e("organisation.tabs.users"),!y&&(0,D.jsx)("span",{className:"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded",children:"PRO"})]}),(0,D.jsxs)("button",{className:"".concat("roles"===w&&k?"border-blue-500 text-blue-600 dark:text-blue-400":k?"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600":"border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60"," whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0"),onClick:()=>k&&S("roles"),disabled:!k,children:[(0,D.jsx)(o.A,{className:"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2"}),e("organisation.tabs.roles"),!k&&(0,D.jsx)("span",{className:"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded",children:"PRO"})]}),(0,D.jsxs)("button",{className:"".concat("branches"===w&&v?"border-blue-500 text-blue-600 dark:text-blue-400":v?"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600":"border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60"," whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0"),onClick:()=>v&&S("branches"),disabled:!v,children:[(0,D.jsx)(d.A,{className:"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2"}),e("organisation.tabs.branches",{defaultValue:"Niederlassungen"}),!v&&(0,D.jsx)("span",{className:"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded",children:"PRO"})]}),j&&(0,D.jsxs)("button",{className:"".concat("organization"===w?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"," whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center flex-shrink-0"),onClick:()=>S("organization"),children:[(0,D.jsx)(l.A,{className:"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2"}),e("organisation.tabs.organization")]})]})}),c&&(0,D.jsxs)("div",{className:"bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded mb-4",children:[(0,D.jsx)("p",{className:"font-bold",children:e("organisation.error")}),(0,D.jsx)("p",{children:c})]}),t&&(0,D.jsx)("div",{className:"p-4 dark:text-gray-300",children:e("organisation.loading")}),(0,D.jsx)("div",{className:"mt-6",children:"users"===w?y?(0,D.jsx)(W,{onError:C}):(0,D.jsx)("div",{className:"p-8 text-center",children:(0,D.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6",children:[(0,D.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4",children:"PRO"}),(0,D.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mt-4",children:e("organisation.proFeature.users")})]})}):"roles"===w?k?(0,D.jsx)(ge,{onError:C}):(0,D.jsx)("div",{className:"p-8 text-center",children:(0,D.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6",children:[(0,D.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4",children:"PRO"}),(0,D.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mt-4",children:e("organisation.proFeature.roles")})]})}):"branches"===w?v?(0,D.jsx)(he,{onError:C}):(0,D.jsx)("div",{className:"p-8 text-center",children:(0,D.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6",children:[(0,D.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4",children:"PRO"}),(0,D.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mt-4",children:e("organisation.proFeature.branches",{defaultValue:"Niederlassungs-Verwaltung ist eine PRO-Funktion"})})]})}):"organization"===w&&j?(0,D.jsxs)("div",{className:"space-y-6",children:[(0,D.jsx)(Oe,{}),(0,D.jsx)(Ke,{})]}):(0,D.jsx)("div",{className:"p-4 text-red-600 dark:text-red-400",children:e("organisation.noPermissionForPage")})})]})})}):(0,D.jsx)("div",{className:"p-4 text-red-600 dark:text-red-400",children:e("organisation.noPermission")})}}}]);
//# sourceMappingURL=931.31d7edb2.chunk.js.map