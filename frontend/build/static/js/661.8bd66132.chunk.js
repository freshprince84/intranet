"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[661],{1052:(e,t,r)=>{r.d(t,{F2:()=>d,Rj:()=>s,go:()=>i});const a={request:{criticalHours:24},todo:{criticalHours:24}};const n={hourly:{criticalHours:2},daily:{criticalHours:6},standard:{criticalHours:24}};function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"request",r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,d=arguments.length>4?arguments[4]:void 0;if(!e)return"none";const s=new Date,l=new Date(e),o=(s.getTime()-l.getTime())/36e5;if(o<=0)return"none";let c;if(r)c=r;else if("todo"===t&&i){const e=function(e,t){const r=e.toLowerCase(),a=(t||"").toLowerCase();return r.includes("st\xfcndlich")||a.includes("st\xfcndlich")?"hourly":r.includes("t\xe4glich")||a.includes("t\xe4glich")?"daily":"standard"}(i,d);c=n[e]}else c=a[t];return o>=c.criticalHours?"critical":"expired"}function d(e){switch(e){case"expired":return{borderClass:"border-orange-500 dark:border-orange-600",bgClass:"bg-orange-50 dark:bg-orange-900/20",textClass:"text-orange-700 dark:text-orange-300",badgeClass:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300"};case"critical":return{borderClass:"border-red-500 dark:border-red-600",bgClass:"bg-red-50 dark:bg-red-900/20",textClass:"text-red-700 dark:text-red-700",badgeClass:"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300"};default:return{borderClass:"",bgClass:"",textClass:"",badgeClass:""}}}function s(e){let t=arguments.length>4?arguments[4]:void 0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F\xe4lligkeit",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e=>e.toLocaleDateString(),n=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const s=i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"request",void 0,arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0),l=d(s);return{icon:t,label:r,value:e?a(new Date(e)):"-",className:"none"!==s?n?l.badgeClass:l.textClass:void 0}}},1853:(e,t,r)=>{r.d(t,{Iw:()=>n,qY:()=>a});r(5043),r(579);const a=(e,t)=>{if("task"===t)switch(e){case"open":default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";case"in_progress":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300";case"improval":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"quality_control":return"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300";case"done":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300"}if("request"===t)switch(e){case"approval":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"approved":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"to_improve":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300";case"denied":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}if("invoice"===t)switch(e){case"DRAFT":default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";case"SENT":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300";case"PAID":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"OVERDUE":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";case"CANCELLED":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300"}return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"},n=(e,t,r)=>{if(r){if("task"===t){const t="tasks.status.".concat(e),a=r(t);if(a!==t)return a}if("request"===t){const t="requests.status.".concat(e),a=r(t);if(a!==t)return a}if("invoice"===t){const t="invoices.status.".concat(e.toLowerCase()),a=r(t);if(a!==t)return a}}if("task"===t)switch(e){case"open":return"Offen";case"in_progress":return"In Bearbeitung";case"improval":return"Nachbesserung";case"quality_control":return"Qualit\xe4tskontrolle";case"done":return"Erledigt";default:return e}if("request"===t)switch(e){case"approval":return"Offen";case"approved":return"Genehmigt";case"to_improve":return"Nachbesserung";case"denied":return"Abgelehnt";default:return e}if("invoice"===t)switch(e){case"DRAFT":return"Entwurf";case"SENT":return"Gesendet";case"PAID":return"Bezahlt";case"OVERDUE":return"\xdcberf\xe4llig";case"CANCELLED":return"Storniert";default:return e}return e.charAt(0).toUpperCase()+e.slice(1).replace(/_/g," ")}},8658:(e,t,r)=>{r.d(t,{G:()=>o});var a=r(5043),n=r(4117),i=r(1923),d=r(1801),s=r(1713),l=r(579);const o=e=>{var t;let{isOpen:r,onClose:o,selectedDate:c}=e;const{t:u}=(0,n.Bd)(),g=new Date,x="".concat(g.getFullYear(),"-").concat((g.getMonth()+1).toString().padStart(2,"0"),"-").concat(g.getDate().toString().padStart(2,"0")),[m,y]=(0,a.useState)([]),[p,h]=(0,a.useState)(c||x),[v,f]=(0,a.useState)(!0),[b,k]=(0,a.useState)("0h 0m"),[w,T]=(0,a.useState)(null),[j,N]=(0,a.useState)(null),I=()=>{if(!w)return!1;try{return w.startTime.split("T")[0]===p}catch(j){return console.error("Fehler beim Pr\xfcfen der Relevanz der aktiven Zeiterfassung:",j),!1}},C=(0,a.useCallback)((async()=>{try{N(null),f(!0);if(!localStorage.getItem("token"))return N(u("worktime.tracker.notAuthenticated")),void f(!1);const e=p,t=[...(await i.A.get("".concat(d.Sn.WORKTIME.BASE,"?date=").concat(e))).data].sort(((e,t)=>new Date(e.startTime).getTime()-new Date(t.startTime).getTime()));y(t);const r=await i.A.get(d.Sn.WORKTIME.ACTIVE);r.data&&Object.keys(r.data).length>0?T(r.data):T(null),f(!1)}catch(j){console.error("Fehler beim Laden der Zeiterfassungen:",j),N(u("worktime.list.loadError")),f(!1)}}),[p,u]);if((0,a.useEffect)((()=>{r&&C()}),[r,C]),(0,a.useEffect)((()=>{let e=0;if(m.filter((e=>(0,s.uT)(e,p))).forEach((t=>{if(t.endTime)try{const r=new Date(t.startTime),a=new Date(t.endTime).getTime()-r.getTime();if(a>0){const t=Math.floor(a/6e4);e+=t}}catch(j){console.error("Fehler bei der Berechnung:",j)}})),w&&I())try{const s=new Date(w.startTime),m=new Date;let y;if(w.timezone){var t,r,a,n,i,d,l,o,c,u,g,x;const e=new Intl.DateTimeFormat("en-US",{timeZone:w.timezone,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),p=e.formatToParts(s),h=Date.UTC(parseInt((null===(t=p.find((e=>"year"===e.type)))||void 0===t?void 0:t.value)||"0"),parseInt((null===(r=p.find((e=>"month"===e.type)))||void 0===r?void 0:r.value)||"0")-1,parseInt((null===(a=p.find((e=>"day"===e.type)))||void 0===a?void 0:a.value)||"0"),parseInt((null===(n=p.find((e=>"hour"===e.type)))||void 0===n?void 0:n.value)||"0"),parseInt((null===(i=p.find((e=>"minute"===e.type)))||void 0===i?void 0:i.value)||"0"),parseInt((null===(d=p.find((e=>"second"===e.type)))||void 0===d?void 0:d.value)||"0"),0),v=e.formatToParts(m);y=Date.UTC(parseInt((null===(l=v.find((e=>"year"===e.type)))||void 0===l?void 0:l.value)||"0"),parseInt((null===(o=v.find((e=>"month"===e.type)))||void 0===o?void 0:o.value)||"0")-1,parseInt((null===(c=v.find((e=>"day"===e.type)))||void 0===c?void 0:c.value)||"0"),parseInt((null===(u=v.find((e=>"hour"===e.type)))||void 0===u?void 0:u.value)||"0"),parseInt((null===(g=v.find((e=>"minute"===e.type)))||void 0===g?void 0:g.value)||"0"),parseInt((null===(x=v.find((e=>"second"===e.type)))||void 0===x?void 0:x.value)||"0"),0)-h}else y=m.getTime()-s.getTime();if(y>0){const t=Math.floor(y/6e4);e+=t}}catch(j){console.error("Fehler bei der Berechnung der aktiven Zeiterfassung:",j)}const y=Math.floor(e/60),h=e%60,v="".concat(y,"h ").concat(h,"m");k(v)}),[m,w,p]),!r)return null;const D=m.filter((e=>(0,s.uT)(e,p)));return(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 w-full max-w-4xl max-h-[90vh] flex flex-col",children:[(0,l.jsxs)("div",{className:"p-4 border-b dark:border-gray-700 flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:u("worktime.modal.title",{date:(0,s.Yq)(p)})}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("input",{type:"date",value:p,onChange:e=>{h(e.target.value)},className:"border dark:border-gray-600 rounded-md px-3 py-2 dark:bg-gray-700 dark:text-white"}),(0,l.jsx)("button",{onClick:o,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"\u2715"})]})]}),(0,l.jsx)("div",{className:"overflow-y-auto flex-grow",children:v?(0,l.jsx)("div",{className:"flex justify-center items-center h-32",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-gray-300"})}):0===m.filter((e=>(0,s.uT)(e,p)&&(null!==e.endTime||I()))).length?(0,l.jsx)("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:u("worktime.modal.noEntries")}):(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,l.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:u("worktime.list.columns.start")}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:u("worktime.list.columns.end")}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:u("worktime.list.columns.duration")}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:u("worktime.list.columns.branch")})]})}),(0,l.jsxs)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:[D.filter((e=>null!==e.endTime)).sort(((e,t)=>new Date(e.startTime).getTime()-new Date(t.startTime).getTime())).map((e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:(0,s.fU)(e.startTime)}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:e.endTime?(0,s.fU)(e.endTime):"-"}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:(0,s.P0)(e.startTime,e.endTime)}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:e.branch.name})]},e.id))),I()&&(0,l.jsxs)("tr",{className:"bg-green-50 dark:bg-green-900/30 hover:bg-green-100 dark:hover:bg-green-900/50",children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:(0,s.fU)(w.startTime)}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:(0,l.jsx)("span",{className:"italic",children:u("worktime.active")})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200 font-medium text-green-600 dark:text-green-400",children:(()=>{if(!w)return"-";const e=new Date(w.startTime),t=new Date;let r;if(w.timezone){var a,n,i,d,s,l,o,c,g,x,m,y;const u=new Intl.DateTimeFormat("en-US",{timeZone:w.timezone,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),p=u.formatToParts(e),h=Date.UTC(parseInt((null===(a=p.find((e=>"year"===e.type)))||void 0===a?void 0:a.value)||"0"),parseInt((null===(n=p.find((e=>"month"===e.type)))||void 0===n?void 0:n.value)||"0")-1,parseInt((null===(i=p.find((e=>"day"===e.type)))||void 0===i?void 0:i.value)||"0"),parseInt((null===(d=p.find((e=>"hour"===e.type)))||void 0===d?void 0:d.value)||"0"),parseInt((null===(s=p.find((e=>"minute"===e.type)))||void 0===s?void 0:s.value)||"0"),parseInt((null===(l=p.find((e=>"second"===e.type)))||void 0===l?void 0:l.value)||"0"),0),v=u.formatToParts(t);r=Date.UTC(parseInt((null===(o=v.find((e=>"year"===e.type)))||void 0===o?void 0:o.value)||"0"),parseInt((null===(c=v.find((e=>"month"===e.type)))||void 0===c?void 0:c.value)||"0")-1,parseInt((null===(g=v.find((e=>"day"===e.type)))||void 0===g?void 0:g.value)||"0"),parseInt((null===(x=v.find((e=>"hour"===e.type)))||void 0===x?void 0:x.value)||"0"),parseInt((null===(m=v.find((e=>"minute"===e.type)))||void 0===m?void 0:m.value)||"0"),parseInt((null===(y=v.find((e=>"second"===e.type)))||void 0===y?void 0:y.value)||"0"),0)-h}else r=t.getTime()-e.getTime();const p=Math.floor(r/6e4),h=Math.floor(p/60),v=p%60;return"".concat(h,"h ").concat(v,"m (").concat(u("worktime.modal.running"),")")})()}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:(null===(t=w.branch)||void 0===t?void 0:t.name)||u("common.unknown")})]})]}),(0,l.jsx)("tfoot",{className:"bg-gray-100 dark:bg-gray-700",children:(0,l.jsxs)("tr",{children:[(0,l.jsxs)("td",{colSpan:2,className:"px-6 py-3 text-right text-sm font-medium text-gray-700 dark:text-gray-300",children:[u("worktime.modal.totalDuration"),":"]}),(0,l.jsx)("td",{className:"px-6 py-3 text-left text-sm font-bold text-gray-900 dark:text-white",children:b}),(0,l.jsx)("td",{})]})})]})})]})})}}}]);
//# sourceMappingURL=661.8bd66132.chunk.js.map