{"version":3,"file":"static/js/935.f54a3057.chunk.js","mappings":"8IAIO,IAAKA,EAAiB,SAAjBA,GAAiB,OAAjBA,EAAiB,sBAAjBA,EAAiB,sCAAjBA,EAAiB,wBAAjBA,EAAiB,0BAAjBA,EAAiB,sBAAjBA,EAAiB,kBAAjBA,CAAiB,MASjBC,EAAa,SAAbA,GAAa,OAAbA,EAAa,kBAAbA,EAAa,YAAbA,EAAa,gCAAbA,EAAa,oBAAbA,CAAa,K,0DCRzB,MAAMC,EAAW,gBASJC,EAAqB,CAIhC,YAAMC,CAAOC,GACXC,QAAQC,IAAI,gCAAiCL,GAC7CI,QAAQC,IAAI,8BAA+BF,GAC3C,MAAMG,QAAiBC,EAAAA,EAAcC,KAAKR,EAAUG,GAEpD,OADAC,QAAQC,IAAI,iCAAkCC,GACvCA,EAASH,KAAKA,MAAQG,EAASH,IACxC,EAKA,aAAMM,CAAQC,GACZ,MAAMJ,QAAiBC,EAAAA,EAAcI,IAAI,GAADC,OAAIZ,EAAQ,KAAAY,OAAIF,IACxD,OAAOJ,EAASH,KAAKA,MAAQG,EAASH,IACxC,EAKA,wBAAMU,CAAmBH,EAAYI,GACnC,MAAMR,QAAiBC,EAAAA,EAAcQ,IAAI,GAADH,OAAIZ,EAAQ,KAAAY,OAAIF,EAAE,kBAAkB,CAC1EI,YAEF,OAAOR,EAASH,KAAKA,MAAQG,EAASH,IACxC,EAKA,wBAAMa,CAAmBN,GACvB,MAAMJ,QAAiBC,EAAAA,EAAcC,KAAKS,EAAAA,GAAcC,YAAYC,sBAAsBT,IAC1F,OAAOJ,EAASH,KAAKA,MAAQG,EAASH,IACxC,EAKA,oBAAMiB,CACJV,EACAW,GAQA,MAAMf,QAAiBC,EAAAA,EAAcC,KACnCS,EAAAA,GAAcC,YAAYI,gBAAgBZ,GAC1CW,GAAW,CAAC,GAEd,OAAOf,EAASH,KAAKA,MAAQG,EAASH,IACxC,EAKA,kBAAMoB,CACJb,EACAW,GAMA,MAAMf,QAAiBC,EAAAA,EAAcC,KACnCS,EAAAA,GAAcC,YAAYM,cAAcd,GACxCW,GAAW,CAAC,GAEd,OAAOf,EAASH,KAAKA,MAAQG,EAASH,IACxC,EAKA,yBAAMsB,CAAoBf,GAIxB,MAAMJ,QAAiBC,EAAAA,EAAcI,IACnCM,EAAAA,GAAcC,YAAYQ,kBAAkBhB,IAExCP,EAAOG,EAASH,KAAKA,MAAQG,EAASH,KAE5C,OAAIwB,MAAMC,QAAQzB,GACT,CACL0B,iBAAkB1B,EAClB2B,iBAAkB,IAGf3B,CACT,E,+HC5FF,MAgVA,EAhV+B4B,IAAgG,IAA/F,OAAEC,EAAM,QAAEC,EAAO,iBAAEC,EAAkBC,KAAMC,GAA8CL,EACrH,MAAM,EAAEM,IAAMC,EAAAA,EAAAA,OACR,KAAEC,IAASC,EAAAA,EAAAA,OACX,YAAEC,IAAgBC,EAAAA,EAAAA,MAEjBC,EAAQC,IAAaC,EAAAA,EAAAA,WAAqC,OAAfT,QAAe,IAAfA,OAAe,EAAfA,EAAiB1B,KAAM,KAClEoC,EAAUC,IAAeF,EAAAA,EAAAA,UAAS,KAClCG,EAAsBC,IAA2BJ,EAAAA,EAAAA,UAAsB,IACvEK,EAAcC,IAAmBN,EAAAA,EAAAA,UAAS,KAC1CO,EAAeC,IAAoBR,EAAAA,EAAAA,UAAS,KAC5CS,EAAeC,IAAoBV,EAAAA,EAAAA,UAAS,KAC5CW,EAAeC,IAAoBZ,EAAAA,EAAAA,UAAS,KAE5Ca,EAAOC,IAAYd,EAAAA,EAAAA,UAAiB,KACpCe,EAAcC,IAAmBhB,EAAAA,EAAAA,UAAsBT,GAAmB,OAC1E0B,EAAOC,IAAYlB,EAAAA,EAAAA,UAAwB,OAC3CmB,EAASC,IAAcpB,EAAAA,EAAAA,WAAS,IAChCqB,EAAaC,IAAkBtB,EAAAA,EAAAA,WAAS,IAG/CuB,EAAAA,EAAAA,YAAU,KAiBFpC,GAhBaqC,WACb,IAAK,IAADC,EACAH,GAAe,GACf,MAAM7D,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAcsD,MAAMC,KAAM,CAC/DC,OAAQ,CAAEC,UAAU,KAElBC,GAAyB,QAAbL,EAAAhE,EAASH,YAAI,IAAAmE,OAAA,EAAbA,EAAenE,OAAQG,EAASH,MAAQ,GAC1DwD,EAAShC,MAAMC,QAAQ+C,GAAaA,EAAY,GACpD,CAAE,MAAOC,GACLxE,QAAQ0D,MAAM,gCAAiCc,GAC/CnC,EAAYJ,EAAE,oBAAqB,QACvC,CAAC,QACG8B,GAAe,EACnB,GAIAU,EACJ,GACD,CAAC7C,EAAQK,EAAGI,KAGf2B,EAAAA,EAAAA,YAAU,KACFhC,IACAQ,EAAUR,EAAgB1B,IAC1BmD,EAAgBzB,GACpB,GACD,CAACA,KAGJgC,EAAAA,EAAAA,YAAU,KACN,GAAIzB,EAAQ,CACR,MAAMR,EAAOuB,EAAMoB,MAAKzC,GAAKA,EAAE3B,KAAOqE,OAAOpC,KAC7CkB,EAAgB1B,GAAQ,KAC5B,MACI0B,EAAgB,KACpB,GACD,CAAClB,EAAQe,KAGZU,EAAAA,EAAAA,YAAU,KACDpC,IACII,GACDQ,EAAU,IAEdG,EAAY,IACZE,EAAwB,GACxBE,EAAgB,IAChBE,EAAiB,IACjBE,EAAiB,IACjBE,EAAiB,IACjBM,EAAS,MACb,GACD,CAAC/B,EAAQI,IA2FZ,OACI4C,EAAAA,EAAAA,MAACC,EAAAA,GAAM,CAACC,KAAMlD,EAAQC,QAASA,EAASkD,UAAU,gBAAeC,SAAA,EAC7DC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4BAA4B,cAAY,UACvDE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,qDAAoDC,UAC/DJ,EAAAA,EAAAA,MAACC,EAAAA,GAAOK,MAAK,CAACH,UAAU,yEAAwEC,SAAA,EAC5FJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sFAAqFC,SAAA,EAChGC,EAAAA,EAAAA,KAACJ,EAAAA,GAAOM,MAAK,CAACJ,UAAU,sDAAqDC,SACxE/C,EAAE,sBAAuB,CAAEmD,aAAc,yBAE9CH,EAAAA,EAAAA,KAAA,UACII,QAASxD,EACTkD,UAAU,6DAA4DC,UAEtEC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,kBAI7BH,EAAAA,EAAAA,MAAA,QAAMW,SA1GDtB,UAKjB,GAJAuB,EAAEC,iBACF9B,EAAS,OAGJpB,EAED,YADAoB,EAAS1B,EAAE,uCAAwC,CAAEmD,aAAc,2BAIvE,IAAK1C,EAED,YADAiB,EAAS1B,EAAE,2CAA4C,CAAEmD,aAAc,iCAK3E,GADoB,IAAIM,KAAKhD,GACX,IAAIgD,KAClB/B,EAAS1B,EAAE,kCAAmC,CAAEmD,aAAc,gDAIlE,IAAKxC,GAAwB+B,OAAO/B,GAAwB,EACxDe,EAAS1B,EAAE,kDAAmD,CAAEmD,aAAc,2CAIlF,IAAKtC,EAAa6C,QAAU7C,EAAa6C,OAAOC,OAAS,EACrDjC,EAAS1B,EAAE,gDAAiD,CAAEmD,aAAc,yDAIhF,GAAKlC,EAAcyC,QAAW3C,EAAc2C,OAA5C,CAMA,GAAInC,EAAc,CACd,MAAMqC,EAAUlB,OAAO/B,GACvB,GAAIY,EAAasC,iBAAmBD,EAAUrC,EAAasC,gBAMvD,YALAnC,EAAS1B,EAAE,6CAA8C,CACrDmD,aAAc,2DACdW,IAAKvC,EAAasC,gBAClBE,IAAKxC,EAAayC,iBAAmB,YAI7C,GAAIzC,EAAayC,iBAAmBJ,EAAUrC,EAAayC,gBAMvD,YALAtC,EAAS1B,EAAE,6CAA8C,CACrDmD,aAAc,2DACdW,IAAKvC,EAAasC,iBAAmB,EACrCE,IAAKxC,EAAayC,kBAI9B,CAEApC,GAAW,GACX,IAAK,IAADqC,EAAAC,EACA,MAAMjG,QAAiBC,EAAAA,EAAcC,KAAKS,EAAAA,GAAcuF,cAAchC,KAAM,CACxE7B,OAAQoC,OAAOpC,GACfG,WACAE,qBAAsB+B,OAAO/B,GAC7BE,aAAcA,EAAa6C,OAC3B3C,cAAeA,EAAc2C,QAAU,KACvCzC,cAAeA,EAAcyC,QAAU,KACvCvC,cAAeA,EAAcuC,QAAU,OAUnC,IAADU,EAPP,GAAiB,QAAbH,EAAAhG,EAASH,YAAI,IAAAmG,IAAbA,EAAeI,SAAwB,QAAjBH,EAAIjG,EAASH,YAAI,IAAAoG,IAAbA,EAAepG,KAQzC,MAAM,IAAIwG,OAAmB,QAAbF,EAAAnG,EAASH,YAAI,IAAAsG,OAAA,EAAbA,EAAeG,UAAW,qCAP1CnE,EACIJ,EAAE,uBAAwB,CAAEmD,aAAc,sCAC1C,WAEJtD,EAAiB5B,EAASH,KAAKA,MAC/B8B,GAIR,CAAE,MAAO2C,GAAW,IAADiC,EAAAC,EACf1G,QAAQ0D,MAAM,qCAAsCc,GACpD,MAAMmC,GAA2B,QAAZF,EAAAjC,EAAItE,gBAAQ,IAAAuG,GAAM,QAANC,EAAZD,EAAc1G,YAAI,IAAA2G,OAAN,EAAZA,EAAoBF,UAAWhC,EAAIgC,SAAWvE,EAAE,uBACrE0B,EAASgD,GACTtE,EAAYsE,EAAc,QAC9B,CAAC,QACG9C,GAAW,EACf,CApDA,MAFIF,EAAS1B,EAAE,0CAA2C,CAAEmD,aAAc,8EAsD1E,EAoB0CL,UAAU,gBAAeC,SAAA,CAClDtB,IACGuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wFAAuFC,UAClGC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,yCAAwCC,SAAEtB,OAI/DkB,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,kEAAiEC,SAAA,CAC7E/C,EAAE,oBAAqB,CAAEmD,aAAc,SAAU,SAEtDR,EAAAA,EAAAA,MAAA,UACIgC,MAAOrE,EACPsE,SAAWrB,GAAMhD,EAAUgD,EAAEsB,OAAOF,MAAQjC,OAAOa,EAAEsB,OAAOF,OAAS,IACrE7B,UAAU,4LACVgC,UAAQ,EACRC,SAAUpD,GAAWE,KAAiB9B,EAAgBgD,SAAA,EAEtDC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,GAAE5B,SAAE/C,EAAE,gBAAiB,CAAEmD,aAAc,sBACpD9B,EAAM2D,QAAOhF,GAAKA,EAAEqC,UAAYrC,EAAEiF,QAAOC,KAAIpF,IAC1CkD,EAAAA,EAAAA,KAAA,UAAsB2B,MAAO7E,EAAKzB,GAAG0E,SAChCjD,EAAKmF,OAAS,KADNnF,EAAKzB,SAKzBkD,IACGyB,EAAAA,EAAAA,KAAA,KAAGF,UAAU,gDAA+CC,SACvDxB,EAAasC,iBAAmBtC,EAAayC,gBACxChE,EAAE,iCAAkC,CAClCmD,aAAc,4BACdW,IAAKvC,EAAasC,gBAClBE,IAAKxC,EAAayC,kBAEpBzC,EAAasC,gBACb7D,EAAE,+BAAgC,CAChCmD,aAAc,yBACdW,IAAKvC,EAAasC,kBAEpBtC,EAAayC,gBACbhE,EAAE,+BAAgC,CAChCmD,aAAc,yBACdY,IAAKxC,EAAayC,kBAEpB,WAKlBrB,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,kEAAiEC,SAAA,CAC7E/C,EAAE,wBAAyB,CAAEmD,aAAc,eAAgB,SAEhEH,EAAAA,EAAAA,KAAA,SACImC,KAAK,iBACLR,MAAOlE,EACPmE,SAAWrB,GAAM7C,EAAY6C,EAAEsB,OAAOF,OACtC7B,UAAU,4LACVgC,UAAQ,EACRC,SAAUpD,GAAWE,QAI7Bc,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,kEAAiEC,SAAA,CAC7E/C,EAAE,oCAAqC,CAAEmD,aAAc,sBAAuB,SAEnFH,EAAAA,EAAAA,KAAA,SACImC,KAAK,SACLrB,KAAiB,OAAZvC,QAAY,IAAZA,OAAY,EAAZA,EAAcsC,kBAAmB,EACtCE,KAAiB,OAAZxC,QAAY,IAAZA,OAAY,EAAZA,EAAcyC,uBAAmBoB,EACtCT,MAAOhE,EACPiE,SAAWrB,GAAM3C,EAAwB2C,EAAEsB,OAAOF,MAAQjC,OAAOa,EAAEsB,OAAOF,OAAS,IACnF7B,UAAU,4LACVgC,UAAQ,EACRC,SAAUpD,GAAWE,QAI7Bc,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,kEAAiEC,SAAA,CAC7E/C,EAAE,4BAA6B,CAAEmD,aAAc,eAAgB,SAEpEH,EAAAA,EAAAA,KAAA,SACImC,KAAK,OACLR,MAAO9D,EACP+D,SAAWrB,GAAMzC,EAAgByC,EAAEsB,OAAOF,OAC1C7B,UAAU,4LACVgC,UAAQ,EACRC,SAAUpD,GAAWE,QAI7Bc,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,kEAAiEC,SAC7E/C,EAAE,6BAA8B,CAAEmD,aAAc,eAErDH,EAAAA,EAAAA,KAAA,SACImC,KAAK,MACLR,MAAO1D,EACP2D,SAAWrB,GAAMrC,EAAiBqC,EAAEsB,OAAOF,OAC3C7B,UAAU,4LACViC,SAAUpD,GAAWE,QAI7Bc,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,kEAAiEC,SAC7E/C,EAAE,6BAA8B,CAAEmD,aAAc,cAErDH,EAAAA,EAAAA,KAAA,SACImC,KAAK,QACLR,MAAO5D,EACP6D,SAAWrB,GAAMvC,EAAiBuC,EAAEsB,OAAOF,OAC3C7B,UAAU,4LACViC,SAAUpD,GAAWE,QAI7Bc,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,kEAAiEC,SAC7E/C,EAAE,6BAA8B,CAAEmD,aAAc,eAErDH,EAAAA,EAAAA,KAAA,YACI2B,MAAOxD,EACPyD,SAAWrB,GAAMnC,EAAiBmC,EAAEsB,OAAOF,OAC3CU,KAAM,EACNvC,UAAU,4LACViC,SAAUpD,GAAWE,QAI7Bc,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gFAA+EC,SAAA,EAC1FC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASxD,EACTkD,UAAU,0LAAyLC,SAElM/C,EAAE,gBAAiB,gBAExBgD,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACLJ,SAAUpD,GAAWE,EACrBiB,UAAU,oIAAmIC,SAE5IpB,EAAU3B,EAAE,gBAAiB,gBAAkBA,EAAE,cAAe,4BAMhF,C,8MCvUjB,MA8RA,EA9RgFN,IAGzE,IAH0E,cAC/E4F,EAAa,WACbC,GACD7F,EACC,MAAM,EAAEM,EAAC,KAAEwF,IAASvF,EAAAA,EAAAA,OACbwF,EAAMC,IAAWlF,EAAAA,EAAAA,UAAuC,KACxDf,EAAkBkG,IAAuBnF,EAAAA,EAAAA,UAA4B,KACrEmB,EAASC,IAAcpB,EAAAA,EAAAA,WAAS,IAChCiB,EAAOC,IAAYlB,EAAAA,EAAAA,UAAwB,MAE5CoF,EAAYA,KAChB,OAAQJ,EAAKK,UACX,IAAK,KAAM,OAAOC,EAAAA,GAClB,IAAK,KAAM,OAAOC,EAAAA,GAClB,QAAS,OAAOC,EAAAA,EAClB,EAGIC,EAAkBC,IACtB,IACE,OAAOC,EAAAA,EAAAA,IAAO,IAAI1C,KAAKyC,GAAa,mBAAoB,CAAEE,OAAQR,KACpE,CAAE,MAAAS,GACA,OAAOH,CACT,GAGII,EAA4BnB,IAChC,OAAQA,GACN,IAAK,aACH,OAAOnF,EAAE,gDAAiD,aAC5D,IAAK,MACH,OAAOA,EAAE,yCAA0C,YACrD,IAAK,uBACH,OAAOA,EAAE,yDAA0D,2BACrE,QACE,OAAOmF,EACX,EAGIoB,EAAkBC,IACtB,OAAQA,GACN,IAAK,WACH,OAAOxD,EAAAA,EAAAA,KAACyD,EAAAA,EAAS,CAAC3D,UAAU,YAC9B,IAAK,QACH,OAAOE,EAAAA,EAAAA,KAAC0D,EAAAA,EAAY,CAAC5D,UAAU,YACjC,IAAK,OACH,OACEH,EAAAA,EAAAA,MAAA,OAAKG,UAAU,8BAA6BC,SAAA,EAC1CC,EAAAA,EAAAA,KAACyD,EAAAA,EAAS,CAAC3D,UAAU,aACrBE,EAAAA,EAAAA,KAAC0D,EAAAA,EAAY,CAAC5D,UAAU,eAG9B,QACE,OAAOE,EAAAA,EAAAA,KAAC2D,EAAAA,EAAiB,CAAC7D,UAAU,YACxC,EAGI8D,EAA2BzB,IAC/B,OAAQA,GACN,IAAK,MACH,OAAOnC,EAAAA,EAAAA,KAAC6D,EAAAA,EAAO,CAAC/D,UAAU,YAC5B,IAAK,aAIL,QACE,OAAOE,EAAAA,EAAAA,KAAC2D,EAAAA,EAAiB,CAAC7D,UAAU,YAHtC,IAAK,uBACH,OAAOE,EAAAA,EAAAA,KAAC8D,EAAAA,EAAe,CAAChE,UAAU,YAGtC,EAsBF,IAnBAf,EAAAA,EAAAA,YAAU,KACSC,WACf,IACEJ,GAAW,GACXF,EAAS,MACT,MAAM5D,QAAaF,EAAAA,EAAmBwB,oBAAoBkG,GAC1DI,EAAQ5H,EAAK0B,kBAAoB,IACjCmG,EAAoB7H,EAAK2B,kBAAoB,GAC/C,CAAE,MAAO8C,GAAW,IAADiC,EAAAC,EACjB1G,QAAQ0D,MAAM,2CAA4Cc,GAC1Db,GAAqB,QAAZ8C,EAAAjC,EAAItE,gBAAQ,IAAAuG,GAAM,QAANC,EAAZD,EAAc1G,YAAI,IAAA2G,OAAN,EAAZA,EAAoBF,UAAWvE,EAAE,0CAA2C,8BACvF,CAAC,QACC4B,GAAW,EACb,GAGFmF,EAAU,GACT,CAACzB,EAAetF,EAAGuF,IAElB5D,EACF,OACEqB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,uFAAsFC,UACnGJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,0BAAyBC,SAAA,EACtCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oDACfE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mDAMvB,GAAIrB,EACF,OACEuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,uFAAsFC,UACnGC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,yCAAwCC,SACpDtB,MAOT,MAAMuF,EAAc,IACfvB,EAAKP,KAAIlH,IAAG,CAAOmH,KAAM,eAAyBrH,KAAME,EAAKiJ,UAAWjJ,EAAIkJ,cAC5EzH,EAAiByF,KAAIiC,IAAG,CAAOhC,KAAM,WAAqBrH,KAAMqJ,EAAKF,UAAWE,EAAID,YACvFE,MAAK,CAACC,EAAGC,IAAM,IAAI7D,KAAK6D,EAAEL,WAAWM,UAAY,IAAI9D,KAAK4D,EAAEJ,WAAWM,YAEzE,OAA2B,IAAvBP,EAAYrD,QAEZhB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,uFAAsFC,SAAA,EACnGC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,2DAA0DC,SACrE/C,EAAE,sCAAuC,iCAE5CgD,EAAAA,EAAAA,KAAA,KAAGF,UAAU,2CAA0CC,SACpD/C,EAAE,uCAAwC,8BAOjD2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,uFAAsFC,SAAA,EACnGC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,2DAA0DC,SACrE/C,EAAE,sCAAuC,iCAG5CgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,YAAWC,SACvBiE,EAAY9B,KAAKsC,IAChB,GAAkB,iBAAdA,EAAKrC,KAAyB,CAChC,MAAMnH,EAAMwJ,EAAK1J,KACjB,OACE6E,EAAAA,EAAAA,MAAA,OAEEG,UAAS,yBAAAvE,OACPP,EAAIqG,QACA,0EACA,mEACHtB,SAAA,EAEHJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,wCAAuCC,SAAA,EACpDJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,8BAA6BC,SAAA,CACzC/E,EAAIqG,SACHrB,EAAAA,EAAAA,KAAC8D,EAAAA,EAAe,CAAChE,UAAU,gDAE3BE,EAAAA,EAAAA,KAACyE,EAAAA,EAAW,CAAC3E,UAAU,4CAEzBH,EAAAA,EAAAA,MAAA,OAAKG,UAAU,8BAA6BC,SAAA,CACzC6D,EAAwB5I,EAAI0J,mBAC7B1E,EAAAA,EAAAA,KAAA,QAAMF,UAAU,oDAAmDC,SAChEuD,EAAyBtI,EAAI0J,wBAGlC1E,EAAAA,EAAAA,KAAA,OAAKF,UAAU,+DAA8DC,SAC1EwD,EAAevI,EAAIwI,eAGxB7D,EAAAA,EAAAA,MAAA,OAAKG,UAAU,uEAAsEC,SAAA,EACnFC,EAAAA,EAAAA,KAAC2E,EAAAA,EAAS,CAAC7E,UAAU,aACrBE,EAAAA,EAAAA,KAAA,QAAAD,SAAOkD,EAAejI,EAAIkJ,gBAI7BlJ,EAAI4J,SACHjF,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gDAA+CC,SAAA,EAC5DJ,EAAAA,EAAAA,MAAA,QAAMG,UAAU,cAAaC,SAAA,CAAE/C,EAAE,uCAAwC,eAAe,OAAQ,IAAEhC,EAAI4J,UAIzG5J,EAAIuG,UACH5B,EAAAA,EAAAA,MAAA,OAAKG,UAAU,uIAAsIC,SAAA,EACnJJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,mBAAkBC,SAAA,CAAE/C,EAAE,wCAAyC,aAAa,QAC3FgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,kCAAiCC,SAAE/E,EAAIuG,cAIxDvG,EAAI6J,aAAe7J,EAAI8J,eACvBnF,EAAAA,EAAAA,MAAA,OAAKG,UAAU,4BAA2BC,SAAA,CACvC/E,EAAI6J,cACH7E,EAAAA,EAAAA,KAAA,KACE+E,KAAM/J,EAAI6J,YACVhD,OAAO,SACPmD,IAAI,sBACJlF,UAAU,2DAA0DC,SAEnE/C,EAAE,4CAA6C,kBAGnDhC,EAAI8J,cACH9E,EAAAA,EAAAA,KAAA,KACE+E,KAAM/J,EAAI8J,YACVjD,OAAO,SACPmD,IAAI,sBACJlF,UAAU,2DAA0DC,SAEnE/C,EAAE,4CAA6C,sBAMvDhC,EAAI0G,eACH/B,EAAAA,EAAAA,MAAA,OAAKG,UAAU,kIAAiIC,SAAA,EAC9IJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,mBAAkBC,SAAA,CAAE/C,EAAE,sCAAuC,UAAU,QACtFgD,EAAAA,EAAAA,KAAA,OAAAD,SAAM/E,EAAI0G,oBAEb,gBAAAnG,OAzEoBP,EAAIK,IA4E/B,CAAO,CACL,MAAM8I,EAAMK,EAAK1J,KACXmK,EAA+B,aAAlBd,EAAIe,UACjBC,EAA0B,WAAfhB,EAAIiB,OACrB,OACEzF,EAAAA,EAAAA,MAAA,OAEEG,UAAS,yBAAAvE,OACP0J,EACI,sEACAE,EACA,kEACA,uEACHpF,SAAA,EAEHJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,wCAAuCC,SAAA,EACpDJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,8BAA6BC,SAAA,CACzCkF,GACCjF,EAAAA,EAAAA,KAACqF,EAAAA,EAAa,CAACvF,UAAU,6CACvBqF,GACFnF,EAAAA,EAAAA,KAACyE,EAAAA,EAAW,CAAC3E,UAAU,4CAEvBE,EAAAA,EAAAA,KAACsF,EAAAA,EAAW,CAACxF,UAAU,8CAEzBE,EAAAA,EAAAA,KAACyD,EAAAA,EAAS,CAAC3D,UAAU,8CACrBE,EAAAA,EAAAA,KAAA,QAAMF,UAAU,oDAAmDC,SAChEkF,EACGjI,EAAE,kDAAmD,iCACrDA,EAAE,kDAAmD,mCAG1DmH,EAAIiB,SACHzF,EAAAA,EAAAA,MAAA,QAAMG,UAAU,2CAA0CC,SAAA,CAAC,IACvDoE,EAAIiB,OAAO,WAInBzF,EAAAA,EAAAA,MAAA,OAAKG,UAAU,uEAAsEC,SAAA,EACnFC,EAAAA,EAAAA,KAAC2E,EAAAA,EAAS,CAAC7E,UAAU,aACrBE,EAAAA,EAAAA,KAAA,QAAAD,SAAOkD,EAAekB,EAAID,iBAI9BvE,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gDAA+CC,SAAA,EAC5DJ,EAAAA,EAAAA,MAAA,QAAMG,UAAU,cAAaC,SAAA,CAAE/C,EAAE,uCAAwC,eAAe,OAAQ,IAAEmH,EAAIoB,eAGvGpB,EAAI5C,UACH5B,EAAAA,EAAAA,MAAA,OAAKG,UAAU,uIAAsIC,SAAA,EACnJJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,mBAAkBC,SAAA,CAAE/C,EAAE,wCAAyC,aAAa,QAC3FgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,kCAAiCC,SAAEoE,EAAI5C,aAIzD4C,EAAIzC,eACH/B,EAAAA,EAAAA,MAAA,OAAKG,UAAU,kIAAiIC,SAAA,EAC9IJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,mBAAkBC,SAAA,CAAE/C,EAAE,sCAAuC,UAAU,QACtFgD,EAAAA,EAAAA,KAAA,OAAAD,SAAMoE,EAAIzC,oBAEb,YAAAnG,OArDgB4I,EAAI9I,IAwD3B,SAGA,C,mcC3RV,MA4JA,EA5JsEqB,IAK/D,IALgE,kBACrE8I,EAAiB,kBACjBC,EAAoB,GAAE,iBACtBC,EAAgB,gBAChBC,GACDjJ,EACC,MAAOkJ,EAAUC,IAAerI,EAAAA,EAAAA,UAA2B,KACpDsI,EAAmBC,IAAwBvI,EAAAA,EAAAA,UAAwB,OACnEwI,EAAwBC,IAA6BzI,EAAAA,EAAAA,UAAgC,OACrFmB,EAASC,IAAcpB,EAAAA,EAAAA,WAAS,IAChCiB,EAAOC,IAAYlB,EAAAA,EAAAA,UAAwB,OAGlDuB,EAAAA,EAAAA,YAAU,KACiBC,WACvB,IACEJ,GAAW,GACXF,EAAS,MAET,MAGMwH,SAHiBhL,EAAAA,EAAcI,IAAIM,EAAAA,GAAcuK,QAAQC,SAASjH,OAGtCrE,KAAKkH,QACpCqE,IAA6BZ,EAAkBa,SAASD,EAAQhL,MAGnEwK,EAAYK,EACd,CAAE,MAAO3G,GAAM,IAADgH,EAAAC,EACZzL,QAAQ0D,MAAM,mCAAoCc,GAElD,MAAMkH,EAAalH,EACnBb,GAA4B,QAAnB6H,EAAAE,EAAWxL,gBAAQ,IAAAsL,GAAM,QAANC,EAAnBD,EAAqBzL,YAAI,IAAA0L,OAAN,EAAnBA,EAA2BjF,UAAWkF,EAAWlF,SAAW,0CACvE,CAAC,QACC3C,GAAW,EACb,GAGF8H,EAAkB,GACjB,CAACjB,IA6CJ,OACE9F,EAAAA,EAAAA,MAAA,OAAKG,UAAU,OAAMC,SAAA,EACnBC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,+CAA8CC,SAAC,mCAIhEJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sBAAqBC,SAAA,EAClCJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,0BAAyBC,SAAA,EACtCJ,EAAAA,EAAAA,MAAA,UACEG,UAAU,oNACV6B,MAAOmE,GAAqB,GAC5BlE,SAzCmBrB,IAC3B,MAAMoG,EAAYC,SAASrG,EAAEsB,OAAOF,MAAO,IAE3C,GAAKkF,MAAMF,GAWTZ,EAAqB,MACrBE,EAA0B,UAZL,CACrBF,EAAqBY,GAGGf,EAASnG,MAAK4G,GAAWA,EAAQhL,KAAOsL,KAnBxC3H,WAC1B,IACEJ,GAAW,GACX,MAAM3D,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAcuK,QAAQC,SAASU,MAAMH,IAC9EV,EAA0BhL,EAASH,KACrC,CAAE,MAAOyE,GACPxE,QAAQ0D,MAAM,0CAA2Cc,EAC3D,CAAC,QACCX,GAAW,EACb,GAcImI,CAAoBJ,EAExB,CAGA,EAyBsC5G,SAAA,EAE9BC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,GAAE5B,SAAC,+BAChB6F,EAAS1D,KAAKmE,IACbrG,EAAAA,EAAAA,KAAA,UAAyB2B,MAAO0E,EAAQhL,GAAG0E,SACxCsG,EAAQpE,OADEoE,EAAQhL,UAMzB2E,EAAAA,EAAAA,KAAA,UACEmC,KAAK,SACL/B,QAlCmB4G,KAC3B,GAA0B,OAAtBlB,EAA4B,CAC9B,MAAMmB,EAAkBrB,EAASnG,MAAK4G,GAAWA,EAAQhL,KAAOyK,IAC5DmB,IACFzB,EAAkByB,GAClBlB,EAAqB,MACrBE,EAA0B,MAE9B,GA2BQlE,SAAgC,OAAtB+D,EACVhG,UAAU,wLAAuLC,SAClM,qBAKFpB,IACCqB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wBAAuBC,SAAC,oBAKxCtB,IACCuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,uBAAsBC,SAClCtB,IAIJuH,IACCrG,EAAAA,EAAAA,MAAA,OAAKG,UAAU,wDAAuDC,SAAA,EACpEC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,2BAA0BC,SAAEiG,EAAuB/D,SACjEjC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4BAA2BC,SACvCiG,EAAuBkB,SACtBvH,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iDAAgDC,SAAA,CAC5DiG,EAAuBkB,QAAQC,UAAU,EAAG,KAC5CnB,EAAuBkB,QAAQvG,OAAS,KAAO,UAGlDX,EAAAA,EAAAA,KAAA,KAAGF,UAAU,+BAA8BC,SAAC,gCAGhDC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,OAAMC,UACnBC,EAAAA,EAAAA,KAAA,KACE+E,KAAI,qBAAAxJ,OAAuByK,EAAuBoB,MAClDvF,OAAO,SACPmD,IAAI,sBACJlF,UAAU,wCAAuCC,SAClD,gCAOL,E,cC9FV,MAwnBMsH,EAAoCC,IAoCnC,IApCoC,MACvC7I,EAAK,MACLwD,EAAK,SACLsF,EAAQ,YACRC,EAAW,eACXC,EAAc,aACdC,EAAY,gBACZC,EAAe,cACfC,EAAa,iBACbC,EAAgB,OAChBC,EAAM,UACNC,EAAS,iBACTC,EAAgB,oBAChBC,EAAmB,SACnBC,EAAQ,YACRC,EAAW,QACXC,EAAO,WACPC,EAAU,MACVC,EAAK,MACLC,EAAK,SACLC,EAAQ,QACR7J,EAAO,aACP8J,EAAY,YACZC,EAAW,iBACXhD,EAAgB,gBAChBiD,EAAe,gBACfhD,EAAe,UACfiD,GAAY,EAAK,qBACjBC,EAAuB,GAAE,aACzBC,EAAY,mBACZC,EAAkB,YAClBC,EAAW,aACXC,EAAY,YACZC,EAAW,WACXC,EAAU,eACVC,GACH9B,EACG,MAAM,EAAEtK,IAAMC,EAAAA,EAAAA,OACPoM,EAAWC,IAAgB9L,EAAAA,EAAAA,UAA6B,QAE/D,OACImC,EAAAA,EAAAA,MAAA,QAAMW,SAAUmI,EAAc3I,UAAU,YAAYyJ,YAAU,EAAAxJ,SAAA,CACzDtB,IACGuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mHAAkHC,UAC7HC,EAAAA,EAAAA,KAAA,KAAAD,SAAItB,OAKZuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,gDAA+CC,UAC1DJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,wBAAwB,aAAW,OAAMC,SAAA,EACpDC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACLrC,UAAS,GAAAvE,OACS,SAAd8N,EACM,mDACA,oJAAmJ,+DAE7JjJ,QAASA,IAAMkJ,EAAa,QAAQvJ,SACvC,WAGDC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACLrC,UAAS,GAAAvE,OACS,YAAd8N,EACM,mDACA,oJAAmJ,+DAE7JjJ,QAASA,IAAMkJ,EAAa,WAAWvJ,SAC1C,yBAOM,SAAdsJ,IACG1J,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,EACIJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAO8J,QAAQ,QAAQ3J,UAAU,6DAA4DC,SAAA,CACxF/C,EAAE,+BAA+B,SAEtCgD,EAAAA,EAAAA,KAAA,SACImC,KAAK,OACL9G,GAAG,QACHsG,MAAOM,EACPL,SAAWrB,GAAMgH,EAAShH,EAAEsB,OAAOF,OACnC7B,UAAU,gMACVgC,UAAQ,QAIhB9B,EAAAA,EAAAA,KAAA,OAAKF,UAAU,YAAWC,UACtBJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,uBAAuB3J,UAAU,6DAA4DC,SACvG/C,EAAE,wCAEP2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,WAAUC,SAAA,EACrBC,EAAAA,EAAAA,KAAA,YACI0J,IAAKV,EACL3N,GAAG,0BACHgH,KAAM,EACNvC,UAAU,+JACV6B,MAAO6F,EACP5F,SAAWrB,GAAMkH,EAAelH,EAAEsB,OAAOF,OACzCgI,QAAST,EACTU,OAAQT,EACRU,WAAYT,EACZU,YAAa9M,EAAE,mDAGnB2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,0CAAyCC,SAAA,EACpDC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASA,KAAA,IAAA2J,EAAA,OAAkB,OAAZd,QAAY,IAAZA,GAAqB,QAATc,EAAZd,EAAce,eAAO,IAAAD,OAAT,EAAZA,EAAuBE,OAAO,EAC7CnK,UAAU,mGAAkGC,UAE5GC,EAAAA,EAAAA,KAAA,OAAKkK,MAAM,6BAA6BpK,UAAU,UAAUqK,KAAK,OAAOC,QAAQ,YAAYC,OAAO,eAActK,UAC7GC,EAAAA,EAAAA,KAAA,QAAMsK,cAAc,QAAQC,eAAe,QAAQC,YAAa,EAAGC,EAAE,8HAG7EzK,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,0CAGXgD,EAAAA,EAAAA,KAAA,SACI0J,IAAKT,EACL9G,KAAK,OACLP,SAAUkH,EACVhJ,UAAU,WAEb8I,IACG5I,EAAAA,EAAAA,KAAA,OAAKF,UAAU,+GAA8GC,UACzHC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,2CAA0CC,SAAE/C,EAAE,0CAKzE6L,GAAwBA,EAAqBlI,OAAS,IACnDX,EAAAA,EAAAA,KAAA,OAAKF,UAAU,OAAMC,UACjBC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,uBAAsBC,SAC/B8I,EAAqB3G,KAAI,CAACwI,EAAYC,KACnChL,EAAAA,EAAAA,MAAA,MAAgBG,UAAU,4FAA2FC,SAAA,EACjHC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,uDAAsDC,SACjE2K,EAAWE,YAEhB5K,EAAAA,EAAAA,KAAA,OAAKF,UAAU,YAAWC,UACtBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sBAAqBC,SAAA,EAChCC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASA,IAAwB,OAAlB2I,QAAkB,IAAlBA,OAAkB,EAAlBA,EAAqB4B,GACpC7K,UAAU,kCAAiCC,UAE3CC,EAAAA,EAAAA,KAAA,OAAKkK,MAAM,6BAA6BpK,UAAU,UAAUqK,KAAK,OAAOC,QAAQ,YAAYC,OAAO,eAActK,UAC7GC,EAAAA,EAAAA,KAAA,QAAMsK,cAAc,QAAQC,eAAe,QAAQC,YAAa,EAAGC,EAAE,8BAG7EzK,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,uCAKd0N,EAAWG,SAASC,WAAW,WAAaJ,EAAWK,OACpD/K,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oNAAmNC,UAC9NC,EAAAA,EAAAA,KAAA,OACIgL,IAAKC,IAAIC,gBAAgBR,EAAWK,MACpCI,IAAKT,EAAWE,SAChB9K,UAAU,mDA1BjB6K,eAsCjChL,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWC,SAAA,EACtBJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,6DAA4DC,SAAA,CACxE/C,EAAE,wCAAwC,SAE/C2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,2BAA0BC,SAAA,EACvCC,EAAAA,EAAAA,KAAA,SACImC,KAAK,QACLrC,UAAU,iEACVsL,KAAK,eACLzJ,MAAM,OACN0J,QAA0B,SAAjB3D,EACT9F,SAAUA,KACN+F,EAAgB,QAChBI,EAAU,GAAG,KAGrB/H,EAAAA,EAAAA,KAAA,QAAMF,UAAU,0BAAyBC,SAAE/C,EAAE,oCAEjD2C,EAAAA,EAAAA,MAAA,SAAOG,UAAU,2BAA0BC,SAAA,EACvCC,EAAAA,EAAAA,KAAA,SACImC,KAAK,QACLrC,UAAU,iEACVsL,KAAK,eACLzJ,MAAM,OACN0J,QAA0B,SAAjB3D,EACT9F,SAAUA,KACN+F,EAAgB,QAChBE,EAAiB,GAAG,KAG5B7H,EAAAA,EAAAA,KAAA,QAAMF,UAAU,0BAAyBC,SAAE/C,EAAE,yCAKvC,SAAjB0K,GACG/H,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAO8J,QAAQ,cAAc3J,UAAU,6DAA4DC,SAAA,CAC9F/C,EAAE,yCAAyC,SAEhD2C,EAAAA,EAAAA,MAAA,UACItE,GAAG,cACHsG,MAAOiG,EACPhG,SAAWrB,GAAMsH,EAAiBtH,EAAEsB,OAAOF,MAAQjC,OAAOa,EAAEsB,OAAOF,OAAS,IAC5E7B,UAAU,gMACVgC,UAAQ,EAAA/B,SAAA,EAERC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,GAAE5B,SAAE/C,EAAE,wCACnBV,MAAMC,QAAQ+L,IAAUA,EAAMpG,KAAIhF,IAC/ByC,EAAAA,EAAAA,MAAA,UAAsBgC,MAAOzE,EAAK7B,GAAG0E,SAAA,CAChC7C,EAAKoO,UAAU,IAAEpO,EAAKqO,WADdrO,EAAK7B,aAO9BsE,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAO8J,QAAQ,OAAO3J,UAAU,6DAA4DC,SAAA,CACvF/C,EAAE,yCAAyC,SAEhD2C,EAAAA,EAAAA,MAAA,UACItE,GAAG,OACHsG,MAAOmG,EACPlG,SAAWrB,GAAMwH,EAAUxH,EAAEsB,OAAOF,MAAQjC,OAAOa,EAAEsB,OAAOF,OAAS,IACrE7B,UAAU,gMACVgC,UAAQ,EAAA/B,SAAA,EAERC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,GAAE5B,SAAE/C,EAAE,wCACnBV,MAAMC,QAAQgM,IAAUA,EAAMrG,KAAIsJ,IAC/BxL,EAAAA,EAAAA,KAAA,UAAsB2B,MAAO6J,EAAKnQ,GAAG0E,SAChCyL,EAAKJ,MADGI,EAAKnQ,aAQlCsE,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,iBAAiB3J,UAAU,6DAA4DC,SACjG/C,EAAE,2CAEP2C,EAAAA,EAAAA,MAAA,UACItE,GAAG,iBACHsG,MAAOqG,EACPpG,SAAWrB,GAAM0H,EAAoB1H,EAAEsB,OAAOF,MAAQjC,OAAOa,EAAEsB,OAAOF,OAAS,IAC/E7B,UAAU,gMAA+LC,SAAA,EAEzMC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,GAAE5B,SAAE/C,EAAE,4CACnBV,MAAMC,QAAQ+L,IAAUA,EAAMpG,KAAIhF,IAC/ByC,EAAAA,EAAAA,MAAA,UAAsBgC,MAAOzE,EAAK7B,GAAG0E,SAAA,CAChC7C,EAAKoO,UAAU,IAAEpO,EAAKqO,WADdrO,EAAK7B,aAO9BsE,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAO8J,QAAQ,SAAS3J,UAAU,6DAA4DC,SAAA,CACzF/C,EAAE,gCAAgC,SAEvC2C,EAAAA,EAAAA,MAAA,UACItE,GAAG,SACHsG,MAAOuG,EACPtG,SAAWrB,GAAM4H,EAAYzI,OAAOa,EAAEsB,OAAOF,QAC7C7B,UAAU,gMACVgC,UAAQ,EAAA/B,SAAA,EAERC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,GAAE5B,SAAE/C,EAAE,yBACnBV,MAAMC,QAAQiM,IAAaA,EAAStG,KAAIuJ,IACrCzL,EAAAA,EAAAA,KAAA,UAAwB2B,MAAO8J,EAAOpQ,GAAG0E,SACpC0L,EAAOL,MADCK,EAAOpQ,aAOhCsE,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,UAAU3J,UAAU,6DAA4DC,SAC1F/C,EAAE,oCAEPgD,EAAAA,EAAAA,KAAA,SACImC,KAAK,OACL9G,GAAG,UACHsG,MAAOyG,EACPxG,SAAWrB,GAAM8H,EAAW9H,EAAEsB,OAAOF,OACrC7B,UAAU,wMAOX,YAAduJ,IACG1J,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,OAAMC,SAAA,EACjBC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,uDAAsDC,SAAC,kCAEpE2F,EAAiB/E,OAAS,GACvBX,EAAAA,EAAAA,KAAA,MAAIF,UAAU,iBAAgBC,SACzB2F,EAAiBxD,KAAImE,IAClB1G,EAAAA,EAAAA,MAAA,MAAqBG,UAAU,4EAA2EC,SAAA,EACtGC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,qBAAoBC,SAAEsG,EAAQpE,SAC9CjC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASA,IAAMuF,EAAgBU,EAAQhL,IACvCyE,UAAU,kCAAiCC,SAE1C/C,EAAE,oCAPFqJ,EAAQhL,SAazB2E,EAAAA,EAAAA,KAAA,KAAGF,UAAU,gDAA+CC,SAAE/C,EAAE,gDAIxEgD,EAAAA,EAAAA,KAAC0L,EAAsB,CACnBlG,kBAAmBmD,EACnBlD,kBAAmBC,EAAiBxD,KAAImC,GAAKA,EAAEhJ,KAC/CqK,iBAAkBA,EAClBC,gBAAiBA,QAK7BhG,EAAAA,EAAAA,MAAA,OAAKG,UAAU,8BAA6BC,SAAA,EACxCJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASsI,EACT5I,UAAU,uJAAsJC,UAEhKC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,eAEzBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,sCAGX2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACLrC,UAAU,4OACViC,SAAUpD,EAAQoB,SAEjBpB,GACGqB,EAAAA,EAAAA,KAAC2L,EAAAA,EAAa,CAAC7L,UAAU,0BAEzBE,EAAAA,EAAAA,KAAC4L,EAAAA,EAAS,CAAC9L,UAAU,eAG7BE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACvL/C,EAAV2B,EAAY,iCAAsC,0CAI5D,EAIf,EAt/BwBjC,IAA+D,IAA9D,OAAEC,EAAM,QAAEC,EAAO,cAAEiP,GAAqCnP,EAC7E,MAAM,EAAEM,IAAMC,EAAAA,EAAAA,OACR,KAAEC,IAASC,EAAAA,EAAAA,OACX,aAAE2O,EAAY,cAAEC,IAAkBC,EAAAA,EAAAA,MACjCC,EAAeC,IAAoB1O,EAAAA,EAAAA,UAAS2O,OAAOC,WAAa,OAEhEnK,EAAOsF,IAAY/J,EAAAA,EAAAA,UAAS,KAC5BgK,EAAaC,IAAkBjK,EAAAA,EAAAA,UAAS,KACxCkK,EAAcC,IAAmBnK,EAAAA,EAAAA,UAA0B,SAC3DoK,EAAeC,IAAoBrK,EAAAA,EAAAA,UAAsB,KACzDsK,EAAQC,IAAavK,EAAAA,EAAAA,UAAsB,KAC3CwK,EAAkBC,IAAuBzK,EAAAA,EAAAA,UAAsB,KAC/D0K,EAAUC,IAAe3K,EAAAA,EAAAA,UAAsB,KAC/C4K,EAASC,IAAc7K,EAAAA,EAAAA,UAAS,KAChC8K,EAAO+D,IAAY7O,EAAAA,EAAAA,UAAiB,KACpC+K,EAAO+D,IAAY9O,EAAAA,EAAAA,UAAiB,KACpCgL,EAAU+D,IAAe/O,EAAAA,EAAAA,UAAmB,KAC5CiB,EAAOC,IAAYlB,EAAAA,EAAAA,UAAwB,OAC3CmB,EAASC,IAAcpB,EAAAA,EAAAA,WAAS,IAChCgP,EAAUC,IAAejP,EAAAA,EAAAA,UAAS2O,OAAOC,WAAa,MACtD1G,EAAkBgH,IAAuBlP,EAAAA,EAAAA,UAA2B,KACpE6L,EAAWC,IAAgB9L,EAAAA,EAAAA,UAA6B,SACxDqL,EAAsB8D,IAA2BnP,EAAAA,EAAAA,UAA2B,KAC5EoL,GAAWgE,KAAgBpP,EAAAA,EAAAA,WAAS,GACrCyL,IAAe4D,EAAAA,EAAAA,QAAyB,MACxC7D,IAAc6D,EAAAA,EAAAA,QAA4B,OAQhD9N,EAAAA,EAAAA,YAAU,KACFpC,IACAmQ,KACAC,KACAC,KAEI9P,GACA+K,EAAoB/K,EAAK7B,IAG7BgN,EAhBkB4E,MACtB,MAAMC,EAAO,IAAIzM,KAEjB,OADAyM,EAAKC,QAAQD,EAAKE,UAAY,GACvBF,EAAKG,cAAcC,MAAM,KAAK,EAAE,EAaxBL,IACf,GACD,CAACtQ,EAAQO,KAEZ6B,EAAAA,EAAAA,YAAU,KACFyJ,EAAS7H,OAAS,GAAkB,KAAbuH,IACC,IAApBM,EAAS7H,QAEF6H,EAAS7H,OAAS,IADzBwH,EAAYK,EAAS,GAAGnN,GAIhC,GACD,CAACmN,EAAUN,KAEdnJ,EAAAA,EAAAA,YAAU,KAEN,MAAMwO,EAAkBA,KACpBd,EAAYN,OAAOC,WAAa,KAChCF,EAAiBC,OAAOC,WAAa,KAAK,EAU9C,OANAmB,IAGApB,OAAOqB,iBAAiB,SAAUD,GAG3B,KACHpB,OAAOsB,oBAAoB,SAAUF,EAAgB,CACxD,GACF,KAGHxO,EAAAA,EAAAA,YAAU,KACFpC,EACAmP,IAEAC,IAGG,KACHA,GAAe,IAEpB,CAACpP,EAAQmP,EAAcC,IAE1B,MAAMe,GAAa9N,UACf,IACIN,EAAS,MAET,IADcgP,aAAaC,QAAQ,SAG/B,YADAjP,EAAS,yBAIb3D,QAAQC,IAAI,2CAEZ,MAAMC,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAcgS,MAAMC,UAE7D9S,QAAQC,IAAI,oBAAqBC,EAASH,KAAK6F,QAC/C0L,EAASpR,EAASH,MAAQ,GAC9B,CAAE,MAAOyE,GACLxE,QAAQ0D,MAAM,kCAAmCc,GAGjD,MAAMkH,EAAalH,EAGX,IAADgH,EAAAC,EAFP,GAAwB,gBAApBC,EAAWqH,KACXpP,EAAS1B,EAAE,iDAEX0B,EAAS,GAADnD,OAAIyB,EAAE,0CAAyC,MAAAzB,QAAwB,QAAnBgL,EAAAE,EAAWxL,gBAAQ,IAAAsL,GAAM,QAANC,EAAnBD,EAAqBzL,YAAI,IAAA0L,OAAN,EAAnBA,EAA2BjF,UAAWkF,EAAWlF,SAErH,GAGEwL,GAAa/N,UACf,IACIN,EAAS,MAET,IADcgP,aAAaC,QAAQ,SAG/B,YADAjP,EAAS,yBAIb,MAAMzD,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAcmS,MAAM5O,MAC7DmN,EAASrR,EAASH,MAAQ,GAC9B,CAAE,MAAOyE,GACLxE,QAAQ0D,MAAM,gCAAiCc,GAG/C,MAAMkH,EAAalH,EAGX,IAADyO,EAAAC,EAFP,GAAwB,gBAApBxH,EAAWqH,KACXpP,EAAS1B,EAAE,iDAEX0B,EAAS,GAADnD,OAAIyB,EAAE,0CAAyC,MAAAzB,QAAwB,QAAnByS,EAAAvH,EAAWxL,gBAAQ,IAAA+S,GAAM,QAANC,EAAnBD,EAAqBlT,YAAI,IAAAmT,OAAN,EAAnBA,EAA2B1M,UAAWkF,EAAWlF,SAErH,GAGEyL,GAAgBhO,UAClB,IACIN,EAAS,MAET,IADcgP,aAAaC,QAAQ,SAG/B,YADAjP,EAAS,yBAIb3D,QAAQC,IAAI,kDAEZ,MAAMC,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAcsS,SAAS/O,MAEhEpE,QAAQC,IAAI,2BAA4BC,EAASH,KAAK6F,QACtD4L,EAAYtR,EAASH,MAAQ,GACjC,CAAE,MAAOyE,GACLxE,QAAQ0D,MAAM,yCAA0Cc,GAGxD,MAAMkH,EAAalH,EAGX,IAAD4O,EAAAC,EAFP,GAAwB,gBAApB3H,EAAWqH,KACXpP,EAAS1B,EAAE,iDAEX0B,EAAS,GAADnD,OAAIyB,EAAE,6CAA4C,MAAAzB,QAAwB,QAAnB4S,EAAA1H,EAAWxL,gBAAQ,IAAAkT,GAAM,QAANC,EAAnBD,EAAqBrT,YAAI,IAAAsT,OAAN,EAAnBA,EAA2B7M,UAAWkF,EAAWlF,SAExH,GAGE2H,GAAclK,UAChB,MAAMqP,EAAQC,EAAMC,cAAcF,MAElC,IAAK,IAAIG,EAAI,EAAGA,EAAIH,EAAM1N,OAAQ6N,IAAK,CACnC,MAAMhK,EAAO6J,EAAMG,GAGnB,GAAmC,IAA/BhK,EAAKrC,KAAKsM,QAAQ,SAAgB,CAClCH,EAAM9N,iBAEN,MAAMuK,EAAOvG,EAAKkK,YAIlB,YAHI3D,SACM4D,GAA0B5D,GAGxC,CACJ,GAGE5B,GAAanK,UAIf,GAHAsP,EAAM9N,iBACN8N,EAAMM,kBAEFN,EAAMO,aAAaC,OAASR,EAAMO,aAAaC,MAAMnO,OAAS,EAAG,CACjE,MAAMoK,EAAOuD,EAAMO,aAAaC,MAAM,SAChCH,GAA0B5D,EACpC,GAGE3B,GAAkBkF,IACpBA,EAAM9N,iBACN8N,EAAMM,iBAAiB,EAGrBD,GAA4B3P,UAC9B4N,IAAa,GACblO,EAAS,MAET,IAEI,MAAMqQ,EAAgC,CAClCnE,SAAUG,EAAKK,KACfP,SAAUE,EAAK5I,KACf6M,SAAUjE,EAAKkE,KACflE,KAAMA,GAGV4B,GAAwBuC,GAAQ,IAAIA,EAAMH,KAI1C,IAAII,EAAa,GAWjB,GAPIA,EAHApE,EAAK5I,KAAK2I,WAAW,UAGX,OAAAvP,OAAUwP,EAAKK,KAAI,MAAA7P,OAAKyB,EAAE,2CAA0C,OAGpE,MAAAzB,OAASwP,EAAKK,KAAI,MAAA7P,OAAKyB,EAAE,2CAA0C,OAI7EgM,GAAYgB,QAAS,CACrB,MAAMoF,EAAYpG,GAAYgB,QAAQqF,eAChCC,EAAa9H,EAAYL,UAAU,EAAGiI,GACtCG,EAAY/H,EAAYL,UAAUiI,GAExC3H,EAAe6H,EAAaH,EAAaI,GAGzCC,YAAW,KACP,GAAIxG,GAAYgB,QAAS,CACrB,MAAMyF,EAASL,EAAYD,EAAWxO,OACtCqI,GAAYgB,QAAQqF,eAAiBI,EACrCzG,GAAYgB,QAAQ0F,aAAeD,EACnCzG,GAAYgB,QAAQ2F,OACxB,IACD,EACP,MACIlI,EAAeD,EAAc2H,EAErC,CAAE,MAAO5P,GAAM,IAADqQ,EAAAC,EACV9U,QAAQ0D,MAAM,qCAAsCc,GAEpD,MAAMkH,EAAalH,EACnBb,GAA4B,QAAnBkR,EAAAnJ,EAAWxL,gBAAQ,IAAA2U,GAAM,QAANC,EAAnBD,EAAqB9U,YAAI,IAAA+U,OAAN,EAAnBA,EAA2BtO,UAAWkF,EAAWlF,SAAW,0CACzE,CAAC,QACGqL,IAAa,EACjB,GAGEkD,GAAmB9Q,UACrB,MAAM8P,EAAQR,EAAMzM,OAAOiN,MAC3B,IAAKA,GAA0B,IAAjBA,EAAMnO,OAAc,OAElC,MAAMoK,EAAO+D,EAAM,SACbH,GAA0B5D,GAG5B9B,GAAae,UACbf,GAAae,QAAQrI,MAAQ,GACjC,EAGEoO,GAAmCpF,IAErC,MAAMqF,EAAqBnH,EAAqB8B,GAEhD,GAAIqF,IAEArD,EAAwB9D,EAAqB7G,QAAO,CAACiO,EAAGzB,IAAMA,IAAM7D,KAGhEqF,EAAmBpF,UAAU,CAE7B,MAAMsF,EAAkBF,EAAmBpF,SAASuF,QAAQ,sBAAuB,QAC7EC,EAAapT,EAAE,2CACfqT,EAAe,IAAIC,OAAO,OAAD/U,OAAQ2U,EAAe,UAAA3U,OAAS6U,EAAWD,QAAQ,sBAAuB,QAAO,OAAO,KACjHI,EAAc,IAAID,OAAO,MAAD/U,OAAO2U,EAAe,UAAA3U,OAAS6U,EAAWD,QAAQ,sBAAuB,QAAO,OAAO,KAG/GK,EAAiBhJ,EAClB2I,QAAQE,EAAc,IACtBF,QAAQI,EAAa,IAErBJ,QAAQ,UAAW,QAExB1I,EAAe+I,EACnB,CACJ,EAoCE/H,GAAezJ,UACjBuB,EAAEC,iBACF9B,EAAS,MACTE,GAAW,GAEX,IAEI,IAAKqD,IAAW2F,IAAkBE,IAAYI,EAG1C,OAFAxJ,EAAS1B,EAAE,+CACX4B,GAAW,GAIf,GAAIgJ,GAAiBE,EAGjB,OAFApJ,EAAS1B,EAAE,kDACX4B,GAAW,GAKf,IADc8O,aAAaC,QAAQ,SAI/B,OAFAjP,EAAS,8BACTE,GAAW,GAKf,MAAM6M,EAAS/L,OAAOwI,GAChBuI,EAAiBzI,EAAmBtI,OAAOsI,GAAoB,KAC/D0I,EAAc9I,EAAgBlI,OAAOkI,GAAiB,KACtD4D,EAAO1D,EAASpI,OAAOoI,GAAU,KAEvC,GAAKF,GAAiBf,MAAM6J,IACvB5I,GAAUjB,MAAM2E,IACjB3E,MAAM4E,IACLzD,GAAoBnB,MAAM4J,GAG3B,OAFA/R,EAAS1B,EAAE,4CACX4B,GAAW,GAKf,MAAM+R,EAAgB,CAClB1O,QACAuF,cACApC,OAAQ,OACR4C,iBAAkByI,EAClBvI,SAAUuD,EACVrD,WAIiB,SAAjBV,GAA2BE,EAC3B+I,EAAS/I,cAAgBA,EACD,SAAjBF,GAA2BI,IAClC6I,EAAS7I,OAASA,GAGtB,MAAM7M,QAAiBC,EAAAA,EAAcC,KAAKS,EAAAA,GAAcgV,MAAMzR,KAAMwR,GAE9DE,EAAY5V,EAASH,KAAKO,GAG5BqK,EAAiB/E,OAAS,SACpBmQ,QAAQC,IACVrL,EAAiBxD,KAAImE,GACjBnL,EAAAA,EAAcC,KAAKS,EAAAA,GAAcgV,MAAMI,cAAcH,EAAWxK,EAAQhL,aAnGzD2D,WAC/B,GAAoC,IAAhC6J,EAAqBlI,OAEzB,IACI/B,GAAW,GAGX,IAAK,MAAM8L,KAAc7B,EAAsB,CAC3C,IAAK6B,EAAWK,KAAM,SAEtB,MAAMkG,EAAW,IAAIC,SACrBD,EAASE,OAAO,OAAQzG,EAAWK,YAE7B7P,EAAAA,EAAcC,KAChBS,EAAAA,GAAcgV,MAAMQ,YAAYC,GAChCJ,EACA,CACIK,QAAS,CACL,eAAgB,wBAIhC,CAEAvW,QAAQC,IAAI,GAADO,OAAIsN,EAAqBlI,OAAM,wCAC9C,CAAE,MAAOpB,GACLxE,QAAQ0D,MAAM,wCAAsCc,EAExD,CAAC,QACGX,GAAW,EACf,GA2EU2S,CAA2BV,GAEjC9V,QAAQC,IAAI,6BAA8BC,EAASH,MAEnD+Q,EAAc5Q,EAASH,MACvB4N,IACJ,CAAE,MAAOnJ,GAAM,IAADiS,EAAAC,EACV1W,QAAQ0D,MAAM,mCAAoCc,GAGlD,MAAMkH,EAAalH,EACnBb,GAA4B,QAAnB8S,EAAA/K,EAAWxL,gBAAQ,IAAAuW,GAAM,QAANC,EAAnBD,EAAqB1W,YAAI,IAAA2W,OAAN,EAAnBA,EAA2BhT,QAASgI,EAAWlF,SAAWvE,EAAE,uCACzE,CAAC,QACG4B,GAAW,EACf,GAGE8J,GAAcA,KAChBnB,EAAS,IACTE,EAAe,IACfE,EAAgB,QAChBE,EAAiB,IACjBE,EAAU,IACVE,EAAoB,IACpBE,EAAY,IACZE,EAAW,IACX3J,EAAS,MACTgO,EAAoB,IACpBC,EAAwB,IACxB/P,GAAS,EAGP8U,GAAoBrL,IACtBqG,GAAoBwC,GAAQ,IAAIA,EAAM7I,IAAS,EAG7CsL,GAAuBhL,IACzB+F,GAAoBwC,GAAQA,EAAKlN,QAAOqC,GAAKA,EAAEhJ,KAAOsL,KAAW,EAIrE,OAAI6F,GAEI7M,EAAAA,EAAAA,MAACC,EAAAA,GAAM,CAACC,KAAMlD,EAAQC,QAAS8L,GAAa5I,UAAU,gBAAeC,SAAA,EACjEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4BAA4B,cAAY,UAEvDE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,qDAAoDC,UAC/DJ,EAAAA,EAAAA,MAACC,EAAAA,GAAOK,MAAK,CAACH,UAAU,yEAAwEC,SAAA,EAC5FJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sEAAqEC,SAAA,EAChFC,EAAAA,EAAAA,KAACJ,EAAAA,GAAOM,MAAK,CAACJ,UAAU,wCAAuCC,SAC1D/C,EAAE,6BAEPgD,EAAAA,EAAAA,KAAA,UACII,QAASsI,GACT5I,UAAU,gFAA+EC,UAEzFC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,kBAI7BE,EAAAA,EAAAA,KAACqH,EAAQ,CACL5I,MAAOA,EACPwD,MAAOA,EACPsF,SAAUA,EACVC,YAAaA,EACbC,eAAgBA,EAChBC,aAAcA,EACdC,gBAAiBA,EACjBC,cAAeA,EACfC,iBAAkBA,EAClBC,OAAQA,EACRC,UAAWA,EACXC,iBAAkBA,EAClBC,oBAAqBA,EACrBC,SAAUA,EACVC,YAAaA,EACbC,QAASA,EACTC,WAAYA,EACZC,MAAOA,EACPC,MAAOA,EACPC,SAAUA,EACV7J,QAASA,EACT8J,aAAcA,GACdC,YAAaA,GACbhD,iBAAkBA,EAClBiD,gBAAiB+I,GACjB/L,gBAAiBgM,GACjB/I,UAAWA,GACXC,qBAAsBA,EACtBC,aAAcgH,GACd/G,mBAAoBgH,GACpB/G,YAAaA,GACbC,aAAcA,GACdC,YAAaA,GACbC,WAAYA,GACZC,eAAgBA,cAWpCzJ,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,CAGKpD,IAAWsP,IACRjM,EAAAA,EAAAA,KAAA,OACIF,UAAU,uFACV,cAAY,OACZ8R,MAAO,CACHC,QAASlV,EAAS,EAAI,EACtBmV,WAAY,6BAMxBnS,EAAAA,EAAAA,MAAA,OACIG,UAAS,0JAAAvE,OAA4JoB,EAAS,gBAAkB,oBAChMiV,MAAO,CACHE,WAAY,uDACZC,cAAepV,EAAS,OAAS,QAErC,eAAcA,EACd6O,KAAK,SACL,aAAY7O,EAAOoD,SAAA,EAEnBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oFAAmFC,SAAA,EAC9FC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,wCAAuCC,SAChD/C,EAAE,6BAEPgD,EAAAA,EAAAA,KAAA,UACII,QAASsI,GACT5I,UAAU,gFAA+EC,UAEzFC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,kBAI7BE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,qCAAoCC,UAC/CC,EAAAA,EAAAA,KAACqH,EAAQ,CACL5I,MAAOA,EACPwD,MAAOA,EACPsF,SAAUA,EACVC,YAAaA,EACbC,eAAgBA,EAChBC,aAAcA,EACdC,gBAAiBA,EACjBC,cAAeA,EACfC,iBAAkBA,EAClBC,OAAQA,EACRC,UAAWA,EACXC,iBAAkBA,EAClBC,oBAAqBA,EACrBC,SAAUA,EACVC,YAAaA,EACbC,QAASA,EACTC,WAAYA,EACZC,MAAOA,EACPC,MAAOA,EACPC,SAAUA,EACV7J,QAASA,EACT8J,aAAcA,GACdC,YAAaA,GACbhD,iBAAkBA,EAClBiD,gBAAiB+I,GACjB/L,gBAAiBgM,GACjB/I,UAAWA,GACXC,qBAAsBA,EACtBC,aAAcgH,GACd/G,mBAAoBgH,GACpB/G,YAAaA,GACbC,aAAcA,GACdC,YAAaA,GACbC,WAAYA,GACZC,eAAgBA,YAI7B,E,wBC5oBX,MAgGA,EAhGgD1M,IAAe,IAADsV,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,IAAb,KAAEC,GAAM3V,EACvD,MAAM,EAAEM,IAAMC,EAAAA,EAAAA,OACR,YAAEG,IAAgBC,EAAAA,EAAAA,KAIlBiV,GAA4B,QAAVN,EAAAK,EAAKpQ,aAAK,IAAA+P,OAAA,EAAVA,EAAY1L,SAAS,UACX,QADiB2L,EAC3BI,EAAKpQ,aAAK,IAAAgQ,OAAA,EAAVA,EAAY3L,SAAS,UACX,QADiB4L,EAC3BG,EAAKpQ,aAAK,IAAAiQ,OAAA,EAAVA,EAAY5L,SAAS,cACX,QADqB6L,EAC/BE,EAAKpQ,aAAK,IAAAkQ,OAAA,EAAVA,EAAY7L,SAAS,WACL,QADY8L,EAC5BC,EAAK7K,mBAAW,IAAA4K,OAAA,EAAhBA,EAAkB9L,SAAS,cAGnD,IAAIiM,EAAyC,CAAC,EAE9C,GAAIF,EAAK7K,YACP,IAEE,MAAMgL,EAAYH,EAAK7K,YAAYiL,MAAM,eACrCD,IACFD,EAAoBG,KAAKC,MAAMH,EAAU,IAE7C,CAAE,MAAOjS,GAEO8R,EAAK7K,YAAY8F,MAAM,MAC/BsF,SAAQC,IACZ,MAAMJ,EAAQI,EAAKJ,MAAM,mBACzB,GAAIA,EAAO,CACT,MAAMK,EAAML,EAAM,GAAG/R,OACfiB,EAAQ8Q,EAAM,GAAG/R,OACvB6R,EAAkBO,GAAOnR,CAC3B,IAEJ,CAI4C,IAA1CoR,OAAOC,KAAKT,GAAmB5R,QAAgB2R,IACjDC,EAAoB,CAClBU,SAAUZ,EAAKpQ,MACfuF,YAAa6K,EAAK7K,aAAexK,EAAE,+BAgBvC,OAAKsV,GAA6D,IAA1CS,OAAOC,KAAKT,GAAmB5R,QAKrDhB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,4FAA2FC,SAAA,EACxGJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,yCAAwCC,SAAA,EACrDJ,EAAAA,EAAAA,MAAA,MAAIG,UAAU,0DAAyDC,SAAA,EACrEC,EAAAA,EAAAA,KAACkT,EAAAA,EAAqB,CAACpT,UAAU,iBAChC9C,EAAE,8BAA+B,CAAEmD,aAAc,qCAEpDH,EAAAA,EAAAA,KAAA,UACEI,QAxBepB,UACrB,IACE,MAAMmU,EAAaT,KAAKU,UAAUb,EAAmB,KAAM,SACrDc,UAAUC,UAAUC,UAAUJ,GACpC/V,EAAYJ,EAAE,uBAAwB,CAAEmD,aAAc,oCAAsC,UAC9F,CAAE,MAAO1B,GACP1D,QAAQ0D,MAAM,wBAAyBA,GACvCrB,EAAYJ,EAAE,sBAAuB,CAAEmD,aAAc,yBAA2B,QAClF,GAiBML,UAAU,2DAA0DC,SAEnE/C,EAAE,qBAAsB,CAAEmD,aAAc,yBAG7CH,EAAAA,EAAAA,KAAA,OAAKF,UAAU,YAAWC,SACvBgT,OAAOC,KAAKT,GAAmB5R,OAAS,EACvCoS,OAAOS,QAAQjB,GAAmBrQ,KAAIoF,IAAA,IAAEwL,EAAKnR,GAAM2F,EAAA,OACjD3H,EAAAA,EAAAA,MAAA,OAAeG,UAAU,2DAA0DC,SAAA,EACjFJ,EAAAA,EAAAA,MAAA,QAAMG,UAAU,iDAAgDC,SAAA,CAC7D/C,EAAE,aAADzB,OAAcuX,KAAUA,EAAI,QAEhC9S,EAAAA,EAAAA,KAAA,QAAMF,UAAU,sDAAqDC,SACjD,kBAAV4B,EAAqB+Q,KAAKU,UAAUzR,EAAO,KAAM,GAAK8R,OAAO9R,OAL/DmR,EAOJ,KAGR9S,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SACtD/C,EAAE,4BAA6B,CAAEmD,aAAc,4DA/BjD,IAmCD,ECqDV,EAhJ0DzD,IAAe,IAADsV,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,IAAb,KAAEC,GAAM3V,EACjE,MAAM,EAAEM,IAAMC,EAAAA,EAAAA,OACR,YAAEG,IAAgBC,EAAAA,EAAAA,MACjBqW,EAAeC,IAAoBnW,EAAAA,EAAAA,UAAiB,KACpDmB,EAASC,IAAcpB,EAAAA,EAAAA,WAAS,IAChCoW,EAAWC,IAAgBrW,EAAAA,EAAAA,WAAS,IACpCsW,EAAYC,IAAiBvW,EAAAA,EAAAA,WAAS,GAU7C,MAPkC,QAAVwU,EAAAK,EAAKpQ,aAAK,IAAA+P,OAAA,EAAVA,EAAY1L,SAAS,UACX,QADiB2L,EAC3BI,EAAKpQ,aAAK,IAAAgQ,OAAA,EAAVA,EAAY3L,SAAS,UACX,QADiB4L,EAC3BG,EAAKpQ,aAAK,IAAAiQ,OAAA,EAAVA,EAAY5L,SAAS,cACX,QADqB6L,EAC/BE,EAAKpQ,aAAK,IAAAkQ,OAAA,EAAVA,EAAY7L,SAAS,WACL,QADY8L,EAC5BC,EAAK7K,mBAAW,IAAA4K,OAAA,EAAhBA,EAAkB9L,SAAS,eAIjD,OAAO,KAgET,OACE3G,EAAAA,EAAAA,MAAA,OAAKG,UAAU,4FAA2FC,SAAA,EACxGJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,yCAAwCC,SAAA,EACrDJ,EAAAA,EAAAA,MAAA,MAAIG,UAAU,0DAAyDC,SAAA,EACrEC,EAAAA,EAAAA,KAAC0D,EAAAA,EAAY,CAAC5D,UAAU,iBACvB9C,EAAE,0BAA2B,CAAEmD,aAAc,sBAEhDH,EAAAA,EAAAA,KAAA,UACEI,QArEuBpB,UAC7B+U,GAAc,GACd,IAOE,MAAMC,EAAQ,8GAAAzY,OAEiD8W,EAAKpQ,MAAK,oHAOzE0R,EAAiBK,GACjB5W,EAAYJ,EAAE,8BAA+B,CAAEmD,aAAc,4BAA8B,UAC7F,CAAE,MAAO1B,GAAa,IAADwV,EAAAC,EACnBnZ,QAAQ0D,MAAM,4CAA6CA,GAC3DrB,GACgB,QAAd6W,EAAAxV,EAAMxD,gBAAQ,IAAAgZ,GAAM,QAANC,EAAdD,EAAgBnZ,YAAI,IAAAoZ,OAAN,EAAdA,EAAsB3S,UAAWvE,EAAE,oCAAqC,CAAEmD,aAAc,uCACxF,QAEJ,CAAC,QACC4T,GAAc,EAChB,GA0CMhS,SAAU+R,EACVhU,UAAU,0IAAyIC,SAElJ+T,GACCnU,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,EACEC,EAAAA,EAAAA,KAAC2L,EAAAA,EAAa,CAAC7L,UAAU,8BACxB9C,EAAE,oBAAqB,CAAEmD,aAAc,oBAG1CnD,EAAE,6BAA8B,CAAEmD,aAAc,4BAKrDuT,IACC/T,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWC,SAAA,EACxBC,EAAAA,EAAAA,KAAA,YACE2B,MAAO+R,EACP9R,SAAWrB,IACToT,EAAiBpT,EAAEsB,OAAOF,OAC1BkS,GAAa,EAAM,EAErB/T,UAAU,+JACVuC,KAAM,GACNyH,YAAa9M,EAAE,gCAAiC,CAAEmD,aAAc,4CAElEH,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mBAAkBC,UAC/BC,EAAAA,EAAAA,KAAA,UACEI,QAnEYpB,UACtB,GAAK0U,EAAchT,OAAnB,CAKA9B,GAAW,GACX,UAQQ,IAAIkS,SAAQqD,GAAW3E,WAAW2E,EAAS,OAEjDN,GAAa,GACbzW,EAAYJ,EAAE,sBAAuB,CAAEmD,aAAc,gCAAkC,UACzF,CAAE,MAAO1B,GAAa,IAAD2V,EAAAC,EACnBtZ,QAAQ0D,MAAM,mCAAoCA,GAClDrB,GACgB,QAAdgX,EAAA3V,EAAMxD,gBAAQ,IAAAmZ,GAAM,QAANC,EAAdD,EAAgBtZ,YAAI,IAAAuZ,OAAN,EAAdA,EAAsB9S,UAAWvE,EAAE,2BAA4B,CAAEmD,aAAc,oCAC/E,QAEJ,CAAC,QACCvB,GAAW,EACb,CAvBA,MAFExB,EAAYJ,EAAE,6BAA8B,CAAEmD,aAAc,6CAA+C,UAyB7G,EAyCU4B,SAAUpD,GAAWiV,EACrB9T,UAAU,4GACVmC,MAAOtD,EAAU3B,EAAE,iBAAkB,CAAEmD,aAAc,aAAgByT,EAAY5W,EAAE,sBAAuB,CAAEmD,aAAc,cAAiBnD,EAAE,sBAAuB,CAAEmD,aAAc,oBAAqBJ,SAExMpB,GACCqB,EAAAA,EAAAA,KAAC2L,EAAAA,EAAa,CAAC7L,UAAU,yBACvB8T,GACF5T,EAAAA,EAAAA,KAAC4L,EAAAA,EAAS,CAAC9L,UAAU,aAErBE,EAAAA,EAAAA,KAAC2D,EAAAA,EAAiB,CAAC7D,UAAU,oBAOrC4T,IACA1T,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4DAA2DC,SACvE/C,EAAE,uBAAwB,CAAEmD,aAAc,gFAG3C,EC2CV,EApLgFzD,IAGzE,IAADsV,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,IAH2E,KAC/EC,EAAI,WACJiC,GACD5X,EACC,MAAM,EAAEM,IAAMC,EAAAA,EAAAA,OACR,YAAEG,IAAgBC,EAAAA,EAAAA,MACjB4T,EAAUsD,IAAe/W,EAAAA,EAAAA,UAAS,CACvCgX,mBAAoB,GACpBC,SAAU,GACVC,iBAAkB,GAClBC,MAAO,MAEFhW,EAASC,IAAcpB,EAAAA,EAAAA,WAAS,GAmBvC,MAhBkC,QAAVwU,EAAAK,EAAKpQ,aAAK,IAAA+P,OAAA,EAAVA,EAAY1L,SAAS,UACX,QADiB2L,EAC3BI,EAAKpQ,aAAK,IAAAgQ,OAAA,EAAVA,EAAY3L,SAAS,UACX,QADiB4L,EAC3BG,EAAKpQ,aAAK,IAAAiQ,OAAA,EAAVA,EAAY5L,SAAS,cACX,QADqB6L,EAC/BE,EAAKpQ,aAAK,IAAAkQ,OAAA,EAAVA,EAAY7L,SAAS,WACL,QADY8L,EAC5BC,EAAK7K,mBAAW,IAAA4K,OAAA,EAAhBA,EAAkB9L,SAAS,eAajD,OAAO,KAGT,MAAMsO,EAbwBC,MAAsB,IAADC,EAAAC,EAAAC,EAAAC,EACjD,OAAc,QAAdH,EAAIzC,EAAKpQ,aAAK,IAAA6S,GAAVA,EAAYxO,SAAS,OAAe,MAC1B,QAAdyO,EAAI1C,EAAKpQ,aAAK,IAAA8S,GAAVA,EAAYzO,SAAS,OAAe,MAC1B,QAAd0O,EAAI3C,EAAKpQ,aAAK,IAAA+S,GAAVA,EAAY1O,SAAS,WAAmB,UAC9B,QAAd2O,EAAI5C,EAAKpQ,aAAK,IAAAgT,GAAVA,EAAY3O,SAAS,QAAgB,OAClC,IAAI,EAQcuO,GAsE3B,OACElV,EAAAA,EAAAA,MAAA,OAAKG,UAAU,4FAA2FC,SAAA,EACxGC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,6CAA4CC,SACvD/C,EAAE,iCAAkC,CAAEmD,aAAc,gCAEvDR,EAAAA,EAAAA,MAAA,QAAMW,SA3DWtB,UACnBuB,EAAEC,iBACF5B,GAAW,GAEX,IACE,MAAMsW,EAjBYC,MAEpB,GAAI9C,EAAK7K,YAAa,CACpB,MAAM4N,EAAc/C,EAAK7K,YAAYiL,MAAM,sBAC3C,GAAI2C,EACF,OAAOxO,SAASwO,EAAY,GAAI,GAEpC,CAEA,OAAO/C,EAAKzK,aAAa,EAQRuN,GACf,IAAKD,IAAWN,EAKd,YAJAxX,EACEJ,EAAE,wBAAyB,CAAEmD,aAAc,mDAC3C,eAMEjF,EAAAA,EAAcQ,IAClBE,EAAAA,GAAcyZ,UAAUC,gBAAgBJ,EAAQN,GAChD,CACExP,OAAQ,aACRoP,mBAAoBvD,EAASuD,mBAC7BC,SAAUxD,EAASwD,SACnBC,iBAAkBzD,EAASyD,iBAC3BC,MAAO1D,EAAS0D,MAChBY,aAAa,IAAI9U,MAAO4M,gBAI5BjQ,EACEJ,EAAE,kCAAmC,CAAEmD,aAAc,wCACrD,WAIFoU,EAAY,CACVC,mBAAoB,GACpBC,SAAU,GACVC,iBAAkB,GAClBC,MAAO,KAGLL,GACFA,GAEJ,CAAE,MAAO7V,GAAa,IAADwV,EAAAC,EACnBnZ,QAAQ0D,MAAM,4CAA0CA,GACxDrB,GACgB,QAAd6W,EAAAxV,EAAMxD,gBAAQ,IAAAgZ,GAAM,QAANC,EAAdD,EAAgBnZ,YAAI,IAAAoZ,OAAN,EAAdA,EAAsB3S,UAAWvE,EAAE,8BAA+B,CAAEmD,aAAc,6CAClF,QAEJ,CAAC,QACCvB,GAAW,EACb,GAQgCkB,UAAU,YAAWC,SAAA,EACjDJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,kEAAiEC,SAAA,CAC/E/C,EAAE,+BAAgC,CAAEmD,aAAc,yBAA0B,SAE/EH,EAAAA,EAAAA,KAAA,SACEmC,KAAK,OACLR,MAAOsP,EAASuD,mBAChB5S,SAAWrB,GAAMgU,GAAWiB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvE,GAAQ,IAAEuD,mBAAoBjU,EAAEsB,OAAOF,SACzE7B,UAAU,+JACVgC,UAAQ,EACRgI,YAAa9M,EAAE,0CAA2C,CAAEmD,aAAc,yBAG9ER,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,kEAAiEC,SAAA,CAC/E/C,EAAE,qBAAsB,CAAEmD,aAAc,aAAc,SAEzDH,EAAAA,EAAAA,KAAA,SACEmC,KAAK,OACLR,MAAOsP,EAASwD,SAChB7S,SAAWrB,GAAMgU,GAAWiB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvE,GAAQ,IAAEwD,SAAUlU,EAAEsB,OAAOF,SAC/D7B,UAAU,+JACVgC,UAAQ,EACRgI,YAAa9M,EAAE,gCAAiC,CAAEmD,aAAc,qCAGpER,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,kEAAiEC,SAAA,CAC/E/C,EAAE,6BAA8B,CAAEmD,aAAc,iBAAkB,SAErEH,EAAAA,EAAAA,KAAA,SACEmC,KAAK,OACLR,MAAOsP,EAASyD,iBAChB9S,SAAWrB,GAAMgU,GAAWiB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvE,GAAQ,IAAEyD,iBAAkBnU,EAAEsB,OAAOF,SACvE7B,UAAU,+JACVgC,UAAQ,QAGZnC,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,kEAAiEC,SAC/E/C,EAAE,kBAAmB,CAAEmD,aAAc,eAExCH,EAAAA,EAAAA,KAAA,YACE2B,MAAOsP,EAAS0D,MAChB/S,SAAWrB,GAAMgU,GAAWiB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvE,GAAQ,IAAE0D,MAAOpU,EAAEsB,OAAOF,SAC5D7B,UAAU,+JACVuC,KAAM,EACNyH,YAAa9M,EAAE,6BAA8B,CAAEmD,aAAc,0CAGjEH,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mBAAkBC,UAC/BC,EAAAA,EAAAA,KAAA,UACEmC,KAAK,SACLJ,SAAUpD,EACVmB,UAAU,4GACVmC,MAAOtD,EAAU3B,EAAE,gBAAiB,CAAEmD,aAAc,iBAAoBnD,EAAE,qBAAsB,CAAEmD,aAAc,mBAAiBJ,SAEhIpB,GACCqB,EAAAA,EAAAA,KAAC2L,EAAAA,EAAa,CAAC7L,UAAU,0BAEzBE,EAAAA,EAAAA,KAAC4L,EAAAA,EAAS,CAAC9L,UAAU,qBAKzB,ECshCV,EAroCoDpD,IAA+C,IAAD+Y,EAAAC,EAAA,IAA7C,OAAE/Y,EAAM,QAAEC,EAAO,cAAE+Y,EAAa,KAAEtD,GAAM3V,EACzF,MAAM,EAAEM,IAAMC,EAAAA,EAAAA,OACR,cAAE2Y,IAAkBC,EAAAA,EAAAA,MACpB,KAAE3Y,IAASC,EAAAA,EAAAA,OACX,aAAE2O,EAAY,cAAEC,IAAkBC,EAAAA,EAAAA,MACjCC,EAAeC,IAAoB1O,EAAAA,EAAAA,UAAS2O,OAAOC,WAAa,OAShEnK,EAAOsF,IAAY/J,EAAAA,EAAAA,UAAS6U,EAAKpQ,OAAS,KAC1CuF,EAAaC,IAAkBjK,EAAAA,EAAAA,WAPTsY,EAOsCzD,EAAK7K,aAAe,IAJ5EsO,EAAK3F,QAAQ,0BAA2B,IAAIzP,OAFjC,IADOoV,MAS7B,MAAMC,EAAsB1D,EAAK7K,aAAe,IACzCpC,EAAQ4Q,IAAaxY,EAAAA,EAAAA,UAAS6U,EAAKjN,QAAU,SAC7CsC,EAAcC,IAAmBnK,EAAAA,EAAAA,UAA0B6U,EAAKvK,OAAS,OAAS,SAClFF,EAAeC,IAAoBrK,EAAAA,EAAAA,UAAwB6U,EAAKzK,eAAiB,OACjFE,EAAQC,IAAavK,EAAAA,EAAAA,UAAwB6U,EAAKvK,QAAU,OAC5DE,EAAkBC,IAAuBzK,EAAAA,EAAAA,WAA2C,QAAnBiY,EAAApD,EAAK5B,sBAAc,IAAAgF,OAAA,EAAnBA,EAAqBpa,KAAM,OAC5F6M,EAAUC,IAAe3K,EAAAA,EAAAA,WAA4B,QAAXkY,EAAArD,EAAK5G,cAAM,IAAAiK,OAAA,EAAXA,EAAara,KAAM,IAC7D4a,EAAaC,IAAkB1Y,EAAAA,EAAAA,UAA2B6U,EAAK4D,aAAe,KAC9EpN,EAAsB8D,IAA2BnP,EAAAA,EAAAA,UAA2B,KAC5EoL,EAAWgE,KAAgBpP,EAAAA,EAAAA,WAAS,IAEpC2Y,GAAoBC,KAAyB5Y,EAAAA,EAAAA,UAAmB,IACjEyL,IAAe4D,EAAAA,EAAAA,QAAyB,MACxC7D,IAAc6D,EAAAA,EAAAA,QAA4B,OAczCzE,GAASC,KAAc7K,EAAAA,EAAAA,UAXV0F,KAChB,IAAKA,EAAY,OAAO,KAGxB,MAAMgK,EAAO,IAAIzM,KAAKyC,GACtB,OAAI2D,MAAMqG,EAAK3I,WAAmB,KAG3B2I,EAAKG,cAAcC,MAAM,KAAK,EAAE,EAGW+I,CAAWhE,EAAKjK,WAC/DE,GAAO+D,KAAY7O,EAAAA,EAAAA,UAAiB,KACpC+K,GAAO+D,KAAY9O,EAAAA,EAAAA,UAAiB,KACpCgL,GAAU+D,KAAe/O,EAAAA,EAAAA,UAAmB,KAC5CiB,GAAOC,KAAYlB,EAAAA,EAAAA,UAAwB,OAC3CmB,GAASC,KAAcpB,EAAAA,EAAAA,WAAS,IAChC8Y,GAAeC,KAAoB/Y,EAAAA,EAAAA,WAAS,IAC5CgP,GAAUC,KAAejP,EAAAA,EAAAA,UAAS2O,OAAOC,WAAa,MACtDoK,GAAgBC,KAAqBjZ,EAAAA,EAAAA,UAA2B,KAChE6L,GAAWC,KAAgB9L,EAAAA,EAAAA,UAA6B,QAEzDkZ,GAAgBd,EAAc,QAAS,OAAQ,UAGrD7W,EAAAA,EAAAA,YAAU,KACN,MAAM4X,EAAeA,KACjBlK,GAAYN,OAAOC,WAAa,KAChCF,EAAiBC,OAAOC,WAAa,KAAK,EAG9C,OADAD,OAAOqB,iBAAiB,SAAUmJ,GAC3B,IAAMxK,OAAOsB,oBAAoB,SAAUkJ,EAAa,GAChE,KAGH5X,EAAAA,EAAAA,YAAU,KACN,IAAKpC,GAAUwZ,GAAmBxV,OAAS,EAAG,CAE1B3B,WACZ,IAAK,MAAM4X,KAAgBT,GACvB,UACUjb,EAAAA,EAAc2b,OAAOjb,EAAAA,GAAcgV,MAAMkG,WAAWzE,EAAKhX,GAAIub,IACnE7b,QAAQC,IAAI,mBAADO,OAAoBqb,EAAY,mDAC/C,CAAE,MAAOrX,GACLxE,QAAQ0D,MAAM,8CAADlD,OAA4Cqb,EAAY,KAAKrX,EAC9E,CAEJ6W,GAAsB,GAAG,EAE7BW,EACJ,IACD,CAACpa,EAAQwZ,GAAoB9D,EAAKhX,MAGrC0D,EAAAA,EAAAA,YAAU,KACFpC,EACAmP,IAEAC,IAGG,KACHA,GAAe,IAEpB,CAACpP,EAAQmP,EAAcC,KAE1BhN,EAAAA,EAAAA,YAAU,KACFpC,IACAmQ,KACAC,KACAC,KACAgK,KACAC,KACJ,GACD,CAACta,EAAQ0V,EAAKhX,KAEjB,MAAMyR,GAAa9N,UACf,IACIN,GAAS,MAET,IADcgP,aAAaC,QAAQ,SAG/B,YADAjP,GAAS,yBAIb,MAAMzD,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAcgS,MAAMC,UAC7DxB,GAASpR,EAASH,MAAQ,GAC9B,CAAE,MAAOyE,GACLxE,QAAQ0D,MAAM,kCAAmCc,GAGjD,MAAMkH,EAAalH,EAGX,IAADgH,EAAAC,EAFP,GAAwB,gBAApBC,EAAWqH,KACXpP,GAAS1B,EAAE,+CAEX0B,GAAS,GAADnD,OAAIyB,EAAE,wCAAuC,MAAAzB,QAAwB,QAAnBgL,EAAAE,EAAWxL,gBAAQ,IAAAsL,GAAM,QAANC,EAAnBD,EAAqBzL,YAAI,IAAA0L,OAAN,EAAnBA,EAA2BjF,UAAWkF,EAAWlF,SAEnH,GAGEwL,GAAa/N,UACf,IACIN,GAAS,MAET,IADcgP,aAAaC,QAAQ,SAG/B,YADAjP,GAAS,yBAIb,MAAMzD,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAcmS,MAAM5O,MAC7DmN,GAASrR,EAASH,MAAQ,GAC9B,CAAE,MAAOyE,GACLxE,QAAQ0D,MAAM,gCAAiCc,GAG/C,MAAMkH,EAAalH,EAGX,IAADyO,EAAAC,EAFP,GAAwB,gBAApBxH,EAAWqH,KACXpP,GAAS1B,EAAE,+CAEX0B,GAAS,GAADnD,OAAIyB,EAAE,wCAAuC,MAAAzB,QAAwB,QAAnByS,EAAAvH,EAAWxL,gBAAQ,IAAA+S,GAAM,QAANC,EAAnBD,EAAqBlT,YAAI,IAAAmT,OAAN,EAAnBA,EAA2B1M,UAAWkF,EAAWlF,SAEnH,GAGEyL,GAAgBhO,UAClB,IACIN,GAAS,MAET,IADcgP,aAAaC,QAAQ,SAG/B,YADAjP,GAAS,yBAIb,MAAMzD,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAcsS,SAAS/O,MAChEoN,GAAYtR,EAASH,MAAQ,GACjC,CAAE,MAAOyE,GACLxE,QAAQ0D,MAAM,yCAA0Cc,GAGxD,MAAMkH,EAAalH,EAGX,IAAD4O,EAAAC,EAFP,GAAwB,gBAApB3H,EAAWqH,KACXpP,GAAS1B,EAAE,+CAEX0B,GAAS,GAADnD,OAAIyB,EAAE,2CAA0C,MAAAzB,QAAwB,QAAnB4S,EAAA1H,EAAWxL,gBAAQ,IAAAkT,GAAM,QAANC,EAAnBD,EAAqBrT,YAAI,IAAAsT,OAAN,EAAnBA,EAA2B7M,UAAWkF,EAAWlF,SAEtH,GAGEyV,GAAsBhY,UACxB,IACIN,GAAS,MACT,MAAMzD,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAcgV,MAAMsG,UAAU7E,EAAKhX,KAC5Eob,GAAkBxb,EAASH,MAAQ,GACvC,CAAE,MAAOyE,GAAM,IAADqQ,EAAAC,EACV9U,QAAQ0D,MAAM,gDAA8Cc,GAG5D,MAAMkH,EAAalH,EACnBb,IAA4B,QAAnBkR,EAAAnJ,EAAWxL,gBAAQ,IAAA2U,GAAM,QAANC,EAAnBD,EAAqB9U,YAAI,IAAA+U,OAAN,EAAnBA,EAA2BtO,UAAWkF,EAAWlF,SAAW,0CACzE,GAGE0V,GAAmBjY,UACrB,IACIN,GAAS,MACT,MAAMzD,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAcgV,MAAMQ,YAAYiB,EAAKhX,KAC9E6a,EAAejb,EAASH,MAAQ,GACpC,CAAE,MAAOyE,GAAM,IAADiS,EAAAC,EACV1W,QAAQ0D,MAAM,oCAAkCc,GAGhD,MAAMkH,EAAalH,EACnBb,IAA4B,QAAnB8S,EAAA/K,EAAWxL,gBAAQ,IAAAuW,GAAM,QAANC,EAAnBD,EAAqB1W,YAAI,IAAA2W,OAAN,EAAnBA,EAA2BlQ,UAAWkF,EAAWlF,SAAW,2CACrE2U,EAAe,GACnB,GAGEhN,GAAclK,UAChB,MAAMqP,EAAQC,EAAMC,cAAcF,MAElC,IAAK,IAAIG,EAAI,EAAGA,EAAIH,EAAM1N,OAAQ6N,IAAK,CACnC,MAAMhK,EAAO6J,EAAMG,GAGnB,GAAmC,IAA/BhK,EAAKrC,KAAKsM,QAAQ,SAAgB,CAClCH,EAAM9N,iBAEN,MAAMuK,EAAOvG,EAAKkK,YAIlB,YAHI3D,SACMoM,GAAwBpM,GAGtC,CACJ,GAGE5B,GAAanK,UAIf,GAHAsP,EAAM9N,iBACN8N,EAAMM,kBAEFN,EAAMO,aAAaC,OAASR,EAAMO,aAAaC,MAAMnO,OAAS,EAAG,CACjE,MAAMoK,EAAOuD,EAAMO,aAAaC,MAAM,SAChCqI,GAAwBpM,EAClC,GAGE3B,GAAkBkF,IACpBA,EAAM9N,iBACN8N,EAAMM,iBAAiB,EAGrBuI,GAA0BnY,UAC5B4N,IAAa,GACblO,GAAS,MAET,IACI,MAAMuS,EAAW,IAAIC,SACrBD,EAASE,OAAO,OAAQpG,GAExB,MAUMgE,SAViB7T,EAAAA,EAAcC,KACjCS,EAAAA,GAAcgV,MAAMQ,YAAYiB,EAAKhX,IACrC4V,EACA,CACIK,QAAS,CACL,eAAgB,0BAKGxW,KAO/B,GANAob,EAAe,IAAID,EAAalH,IAEhCqH,IAAsBlH,GAAQ,IAAIA,EAAMH,EAAc1T,OAIjD0T,EAAclE,SAASC,WAAW,UAAW,CAC9C,MAAMqE,EAAU,MAAA5T,OAASwT,EAAcnE,SAAQ,MAAArP,QAAK6b,EAAAA,EAAAA,IAAqB/E,EAAKhX,GAAI0T,EAAc1T,IAAG,OAGnG,GAAI2N,GAAYgB,QAAS,CACrB,MAAMoF,EAAYpG,GAAYgB,QAAQqF,eAChCC,EAAa9H,EAAYL,UAAU,EAAGiI,GACtCG,EAAY/H,EAAYL,UAAUiI,GAExC3H,EAAe6H,EAAaH,EAAaI,GAGzCC,YAAW,KACP,GAAIxG,GAAYgB,QAAS,CACrB,MAAMyF,EAASL,EAAYD,EAAWxO,OACtCqI,GAAYgB,QAAQqF,eAAiBI,EACrCzG,GAAYgB,QAAQ0F,aAAeD,EACnCzG,GAAYgB,QAAQ2F,OACxB,IACD,EACP,MACIlI,EAAeD,EAAc2H,EAErC,CACJ,CAAE,MAAO5P,GAAM,IAAD8X,EAAAC,EACVvc,QAAQ0D,MAAM,qCAAsCc,GAEpD,MAAMkH,EAAalH,EACnBb,IAA4B,QAAnB2Y,EAAA5Q,EAAWxL,gBAAQ,IAAAoc,GAAM,QAANC,EAAnBD,EAAqBvc,YAAI,IAAAwc,OAAN,EAAnBA,EAA2B/V,UAAWkF,EAAWlF,SAAW,0CACzE,CAAC,QACGqL,IAAa,EACjB,GAGEkD,GAAmB9Q,UACrB,MAAM8P,EAAQR,EAAMzM,OAAOiN,MAC3B,IAAKA,GAA0B,IAAjBA,EAAMnO,OAAc,OAElC,MAAMoK,EAAO+D,EAAM,SACbqI,GAAwBpM,GAG1B9B,GAAae,UACbf,GAAae,QAAQrI,MAAQ,GACjC,EAGE8G,GAAezJ,UACjBuB,EAAEC,iBACF9B,GAAS,MACTE,IAAW,GAEX,IAEI,IAAKqD,IAAUmD,IAAW8C,EAGtB,OAFAxJ,GAAS1B,EAAE,6CACX4B,IAAW,GAKf,GAAqB,SAAjB8I,IAA4BE,EAG5B,OAFAlJ,GAAS1B,EAAE,wCACX4B,IAAW,GAIf,GAAqB,SAAjB8I,IAA4BI,EAG5B,OAFApJ,GAAS1B,EAAE,wCACX4B,IAAW,GAMf,IAAI2Y,EAAmB/P,GAAe,GACtC,MAAMgQ,EAAmBvB,EAAYjU,QAAOyV,IAAG,IAAAC,EAAA,OAAgB,QAAZA,EAAAD,EAAI5M,gBAAQ,IAAA6M,OAAA,EAAZA,EAAc5M,WAAW,YAAa2M,EAAIpc,EAAE,IAGzFsc,EAAuB,0BACvBC,EAA2B,GACjC,IAAInF,EACJ,GAAIsD,EACA,KAAoE,QAA5DtD,EAAQkF,EAAqBE,KAAK9B,KACtC6B,EAAeE,KAAKrF,EAAM,IAKlC,IAAK,MAAM/H,KAAc8M,EAAkB,CACvC,MAAMO,GAAWX,EAAAA,EAAAA,IAAqB/E,EAAKhX,GAAIqP,EAAWrP,IACpD2c,EAAa,KAAAzc,OAAQmP,EAAWE,SAAQ,MAAArP,OAAKwc,EAAQ,KAGrD7H,EAAkBxF,EAAWE,SAASuF,QAAQ,sBAAuB,QACtD,IAAIG,OAAO,OAAD/U,OAAQ2U,EAAe,kBAAkB,KAEtD+H,KAAKV,KAEnBA,EAAmBA,EAAgB,GAAAhc,OAAMgc,EAAgB,MAAAhc,OAAKyc,GAAkBA,EAExF,CAGA,IAAK,MAAME,KAAiBN,EACnBL,EAAiBjR,SAAS4R,KAC3BX,EAAmBA,EAAgB,GAAAhc,OAAMgc,EAAgB,MAAAhc,OAAK2c,GAAkBA,GAKxF,MAAMvH,EAAgB,CAClB1O,QACAuF,YAAa+P,EACbnS,SACA4C,mBACAE,WACAE,YAIiB,SAAjBV,GACAiJ,EAAS/I,cAAgBA,EACzB+I,EAAS7I,OAAS,MACM,SAAjBJ,IACPiJ,EAAS7I,OAASA,EAClB6I,EAAS/I,cAAgB,MAG7B,MAAM3M,QAAiBC,EAAAA,EAAcQ,IAAI,GAADH,OAAIK,EAAAA,GAAcgV,MAAMzR,KAAI,KAAA5D,OAAI8W,EAAKhX,IAAMsV,GAEnF5V,QAAQC,IAAI,qBAAsBC,EAASH,MAG3C,MAAMqd,QAA4Bjd,EAAAA,EAAcI,IAAIM,EAAAA,GAAcgV,MAAM9J,MAAMuL,EAAKhX,KAI/E8c,EAAoBrd,KAAKmb,YACzBkC,EAAoBrd,KAAKmb,YAAckC,EAAoBrd,KAAKmb,YAAY/T,KAAKuV,IAAQ,CACrFpc,GAAIoc,EAAIpc,GACRuP,SAAU6M,EAAI7M,SACdC,SAAU4M,EAAI5M,SACdmE,SAAUyI,EAAIzI,SACdoJ,SAAUX,EAAIW,SACdC,WAAYZ,EAAIY,WAChBC,KAAKlB,EAAAA,EAAAA,IAAqB/E,EAAKhX,GAAIoc,EAAIpc,QAG3C8c,EAAoBrd,KAAKmb,YAAc,GAK3CG,GAAsB,IACtBT,EAAcwC,EAAoBrd,MAClC8B,GACJ,CAAE,MAAO2C,GAAM,IAADgZ,EAAAC,EACVzd,QAAQ0D,MAAM,uCAAwCc,GAGtD,MAAMkH,EAAalH,EACnBb,IAA4B,QAAnB6Z,EAAA9R,EAAWxL,gBAAQ,IAAAsd,GAAM,QAANC,EAAnBD,EAAqBzd,YAAI,IAAA0d,OAAN,EAAnBA,EAA2BjX,UAAWkF,EAAWlF,SAAW,0CACzE,CAAC,QACG3C,IAAW,EACf,GAGE6Z,GAAezZ,UACjB,GAAKsX,GAKL,IAEI,IADc5I,aAAaC,QAAQ,SAG/B,YADAjP,GAAS,+BAIPxD,EAAAA,EAAc2b,OAAOjb,EAAAA,GAAcgV,MAAM9J,MAAMuL,EAAKhX,KAG1Dsa,OAAcvT,GACdxF,GACJ,CAAE,MAAO2C,GAAM,IAADmZ,EAAAC,EACV5d,QAAQ0D,MAAM,gBAAiBc,GAG/B,MAAMkH,EAAalH,EACnBb,IAA4B,QAAnBga,EAAAjS,EAAWxL,gBAAQ,IAAAyd,GAAM,QAANC,EAAnBD,EAAqB5d,YAAI,IAAA6d,OAAN,EAAnBA,EAA2BpX,UAAWkF,EAAWlF,SAAW,0CACzE,MAtBIgV,IAAiB,EAsBrB,EAGE7E,GAAmB1S,UACrB,IACIN,GAAS,YAEHxD,EAAAA,EAAcC,KAChBS,EAAAA,GAAcgV,MAAMI,cAAcqB,EAAKhX,GAAIgL,EAAQhL,KAGvDob,IAAkBvH,GAAQ,IAAIA,EAAM7I,IACxC,CAAE,MAAO9G,GAAM,IAADqZ,EAAAC,EACV9d,QAAQ0D,MAAM,0CAAwCc,GAGtD,MAAMkH,EAAalH,EACnBb,IAA4B,QAAnBka,EAAAnS,EAAWxL,gBAAQ,IAAA2d,GAAM,QAANC,EAAnBD,EAAqB9d,YAAI,IAAA+d,OAAN,EAAnBA,EAA2BtX,UAAWkF,EAAWlF,SAAW,0CACzE,GAGEoQ,GAAsB3S,UACxB,IACIN,GAAS,YAEHxD,EAAAA,EAAc2b,OAChBjb,EAAAA,GAAcgV,MAAMkI,gBAAgBzG,EAAKhX,GAAIsL,IAGjD8P,IAAkBvH,GAAQA,EAAKlN,QAAOqC,GAAKA,EAAEhJ,KAAOsL,KACxD,CAAE,MAAOpH,GAAM,IAADwZ,EAAAC,EACVje,QAAQ0D,MAAM,mDAAiDc,GAG/D,MAAMkH,EAAalH,EACnBb,IAA4B,QAAnBqa,EAAAtS,EAAWxL,gBAAQ,IAAA8d,GAAM,QAANC,EAAnBD,EAAqBje,YAAI,IAAAke,OAAN,EAAnBA,EAA2BzX,UAAWkF,EAAWlF,SAAW,0CACzE,GAiGE0X,GAAaA,KAAA,IAAAjH,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OACfzS,EAAAA,EAAAA,MAAA,QAAMW,SAAUmI,GAAc3I,UAAU,YAAWC,SAAA,EAE/CC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,gDAA+CC,UAC1DJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,wBAAwB,aAAW,OAAMC,SAAA,EACpDC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACLrC,UAAS,GAAAvE,OACS,SAAd8N,GACM,mDACA,oJAAmJ,+DAE7JjJ,QAASA,IAAMkJ,GAAa,QAAQvJ,SAEnC/C,EAAE,+BAEPgD,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACLrC,UAAS,GAAAvE,OACS,YAAd8N,GACM,mDACA,oJAAmJ,+DAE7JjJ,QAASA,IAAMkJ,GAAa,WAAWvJ,SAEtC/C,EAAE,sCAMA,SAAdqM,KACG1J,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,EACIJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,QAAQ3J,UAAU,6DAA4DC,SACxF/C,EAAE,gCAEPgD,EAAAA,EAAAA,KAAA,SACImC,KAAK,OACL9G,GAAG,QACHsG,MAAOM,EACPL,SAAWrB,GAAMgH,EAAShH,EAAEsB,OAAOF,OACnC7B,UAAU,gMACVgC,UAAQ,QAIhBnC,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,mBAAmB3J,UAAU,6DAA4DC,SACnG/C,EAAE,sCAEP2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,WAAUC,SAAA,EACrBC,EAAAA,EAAAA,KAAA,YACI0J,IAAKV,GACL3N,GAAG,mBACHgH,KAAM,EACNvC,UAAU,yJACV6B,MAAO6F,EACP5F,SAAWrB,GAAMkH,EAAelH,EAAEsB,OAAOF,OACzCgI,QAAST,GACTU,OAAQT,GACRU,WAAYT,GACZU,YAAa9M,EAAE,iDAEnB2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,0CAAyCC,SAAA,EACpDC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASA,KAAA,IAAA2J,EAAA,OAA0B,QAA1BA,EAAMd,GAAae,eAAO,IAAAD,OAAA,EAApBA,EAAsBE,OAAO,EAC5CnK,UAAU,mGAAkGC,UAE5GC,EAAAA,EAAAA,KAAA,OAAKkK,MAAM,6BAA6BpK,UAAU,UAAUqK,KAAK,OAAOC,QAAQ,YAAYC,OAAO,eAActK,UAC7GC,EAAAA,EAAAA,KAAA,QAAMsK,cAAc,QAAQC,eAAe,QAAQC,YAAa,EAAGC,EAAE,8HAG7EzK,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,wCAGXgD,EAAAA,EAAAA,KAAA,SACI0J,IAAKT,GACL9G,KAAK,OACLP,SAAUkO,GACVhQ,UAAU,WAEb8I,IACG5I,EAAAA,EAAAA,KAAA,OAAKF,UAAU,+GAA8GC,UACzHC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,2CAA0CC,SAAE/C,EAAE,wCAIzEkc,KACAC,SAILxZ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,SAAS3J,UAAU,6DAA4DC,SACzF/C,EAAE,iCAEP2C,EAAAA,EAAAA,MAAA,UACItE,GAAG,SACHsG,MAAOyD,EACPxD,SAAWrB,GAAMyV,EAAUzV,EAAEsB,OAAOF,OACpC7B,UAAU,gMAA+LC,SAAA,EAEzMC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,OAAM5B,SAAE/C,EAAE,wBACxBgD,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,cAAa5B,SAAE/C,EAAE,+BAC/BgD,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,WAAU5B,SAAE/C,EAAE,4BAC5BgD,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,kBAAiB5B,SAAE/C,EAAE,mCACnCgD,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,OAAM5B,SAAE/C,EAAE,8BAIhC2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWC,SAAA,EACtBJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,6DAA4DC,SAAA,CACxE/C,EAAE,sCAAsC,SAE7C2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,2BAA0BC,SAAA,EACvCC,EAAAA,EAAAA,KAAA,SACImC,KAAK,QACLrC,UAAU,iEACVsL,KAAK,eACLzJ,MAAM,OACN0J,QAA0B,SAAjB3D,EACT9F,SAAUA,KACN+F,EAAgB,QAChBI,EAAU,KAAK,KAGvB/H,EAAAA,EAAAA,KAAA,QAAMF,UAAU,0BAAyBC,SAAE/C,EAAE,kCAEjD2C,EAAAA,EAAAA,MAAA,SAAOG,UAAU,2BAA0BC,SAAA,EACvCC,EAAAA,EAAAA,KAAA,SACImC,KAAK,QACLrC,UAAU,iEACVsL,KAAK,eACLzJ,MAAM,OACN0J,QAA0B,SAAjB3D,EACT9F,SAAUA,KACN+F,EAAgB,QAChBE,EAAiB,KAAK,KAG9B7H,EAAAA,EAAAA,KAAA,QAAMF,UAAU,0BAAyBC,SAAE/C,EAAE,uCAKvC,SAAjB0K,GACG/H,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAO8J,QAAQ,cAAc3J,UAAU,6DAA4DC,SAAA,CAC9F/C,EAAE,uCAAuC,SAE9C2C,EAAAA,EAAAA,MAAA,UACItE,GAAG,cACHsG,MAAyB,OAAlBiG,EAAyB,GAAKA,EACrChG,SAAWrB,GAAMsH,EAAiBtH,EAAEsB,OAAOF,MAAQjC,OAAOa,EAAEsB,OAAOF,OAAS,MAC5E7B,UAAU,gMACVgC,SAA2B,SAAjB4F,EAAwB3H,SAAA,EAElCC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,GAAE5B,SAAE/C,EAAE,sCACnBV,MAAMC,QAAQ+L,KAAUA,GAAMpG,KAAIhF,IAC/ByC,EAAAA,EAAAA,MAAA,UAAsBgC,MAAOzE,EAAK7B,GAAG0E,SAAA,CAChC7C,EAAKoO,UAAU,IAAEpO,EAAKqO,WADdrO,EAAK7B,aAO9BsE,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAO8J,QAAQ,OAAO3J,UAAU,6DAA4DC,SAAA,CACvF/C,EAAE,uCAAuC,SAE9C2C,EAAAA,EAAAA,MAAA,UACItE,GAAG,OACHsG,MAAkB,OAAXmG,EAAkB,GAAKA,EAC9BlG,SAAWrB,GAAMwH,EAAUxH,EAAEsB,OAAOF,MAAQjC,OAAOa,EAAEsB,OAAOF,OAAS,MACrE7B,UAAU,gMACVgC,SAA2B,SAAjB4F,EAAwB3H,SAAA,EAElCC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,GAAE5B,SAAE/C,EAAE,sCACnBV,MAAMC,QAAQgM,KAAUA,GAAMrG,KAAIsJ,IAC/BxL,EAAAA,EAAAA,KAAA,UAAsB2B,MAAO6J,EAAKnQ,GAAG0E,SAChCyL,EAAKJ,MADGI,EAAKnQ,aAQlCsE,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,iBAAiB3J,UAAU,6DAA4DC,SACjG/C,EAAE,yCAEP2C,EAAAA,EAAAA,MAAA,UACItE,GAAG,iBACHsG,MAA4B,OAArBqG,EAA4B,GAAKA,EACxCpG,SAAWrB,GAAM0H,EAAoB1H,EAAEsB,OAAOF,MAAQjC,OAAOa,EAAEsB,OAAOF,OAAS,MAC/E7B,UAAU,gMAA+LC,SAAA,EAEzMC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,GAAE5B,SAAE/C,EAAE,0CACnBV,MAAMC,QAAQ+L,KAAUA,GAAMpG,KAAIhF,IAC/ByC,EAAAA,EAAAA,MAAA,UAAsBgC,MAAOzE,EAAK7B,GAAG0E,SAAA,CAChC7C,EAAKoO,UAAU,IAAEpO,EAAKqO,WADdrO,EAAK7B,aAO9BsE,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,SAAS3J,UAAU,6DAA4DC,SACzF/C,EAAE,iCAEP2C,EAAAA,EAAAA,MAAA,UACItE,GAAG,SACHsG,MAAoB,IAAbuG,EAAiB,GAAKA,EAC7BtG,SAAWrB,GAAM4H,EAAY5H,EAAEsB,OAAOF,MAAQjC,OAAOa,EAAEsB,OAAOF,OAAS,GACvE7B,UAAU,gMACVgC,UAAQ,EAAA/B,SAAA,EAERC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,GAAE5B,SAAE/C,EAAE,yBACnBV,MAAMC,QAAQiM,KAAaA,GAAStG,KAAIuJ,IACrCzL,EAAAA,EAAAA,KAAA,UAAwB2B,MAAO8J,EAAOpQ,GAAG0E,SACpC0L,EAAOL,MADCK,EAAOpQ,aAOhCsE,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,UAAU3J,UAAU,6DAA4DC,SAC1F/C,EAAE,kCAEPgD,EAAAA,EAAAA,KAAA,SACImC,KAAK,OACL9G,GAAG,UACHsG,MAAOyG,IAAW,GAClBxG,SAAWrB,IAEFA,EAAEsB,OAAOF,MAIV0G,GAAW9H,EAAEsB,OAAOF,OAHpB0G,GAAW,KAIf,EAEJvI,UAAU,wMAOX,YAAduJ,KACG1J,EAAAA,EAAAA,MAAA,OAAAI,SAAA,CACKyW,GAAe7V,OAAS,IACrBhB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,OAAMC,SAAA,EACjBC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,4DAA2DC,SAAE/C,EAAE,gDAC7EgD,EAAAA,EAAAA,KAAA,MAAIF,UAAU,YAAWC,SACpByW,GAAetU,KAAImE,IAChB1G,EAAAA,EAAAA,MAAA,MAAqBG,UAAU,4EAA2EC,SAAA,EACtGC,EAAAA,EAAAA,KAAA,KACI+E,KAAI,qBAAAxJ,OAAuB8K,EAAQe,MACnCvF,OAAO,SACPmD,IAAI,sBACJlF,UAAU,4EAA2EC,SAEpFsG,EAAQpE,SAEbjC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASA,IAAMuR,GAAoBtL,EAAQhL,IAC3CyE,UAAU,4EAA2EC,SAEpF/C,EAAE,kCAdFqJ,EAAQhL,YAsBjC2E,EAAAA,EAAAA,KAAC0L,EAAsB,CACnBlG,kBAAmBkM,GACnBjM,kBAAmB+Q,GAAetU,KAAImC,GAAKA,EAAEhJ,KAC7CqK,iBAAkB8Q,GAClB7Q,gBAAiBgM,QAMd,SAAdtI,MAAmC,QAAV2I,EAAAK,EAAKpQ,aAAK,IAAA+P,OAAA,EAAVA,EAAY1L,SAAS,UACX,QADiB2L,EAC3BI,EAAKpQ,aAAK,IAAAgQ,OAAA,EAAVA,EAAY3L,SAAS,UACX,QADiB4L,EAC3BG,EAAKpQ,aAAK,IAAAiQ,OAAA,EAAVA,EAAY5L,SAAS,cACX,QADqB6L,EAC/BE,EAAKpQ,aAAK,IAAAkQ,OAAA,EAAVA,EAAY7L,SAAS,WACL,QADY8L,EAC5BC,EAAK7K,mBAAW,IAAA4K,OAAA,EAAhBA,EAAkB9L,SAAS,iBACjD3G,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,EACIC,EAAAA,EAAAA,KAACoZ,EAAW,CAAC/G,KAAMA,KACnBrS,EAAAA,EAAAA,KAACqZ,EAAgB,CAAChH,KAAMA,KACxBrS,EAAAA,EAAAA,KAACsZ,EAA2B,CACxBjH,KAAMA,EACNiC,WAAYA,KAGJ,QAOpB3U,EAAAA,EAAAA,MAAA,OAAKG,UAAU,4BAA2BC,SAAA,CACrC2W,KACG/W,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASqY,GACT3Y,UAAS,kBAAAvE,OACL+a,GACM,+FACA,6EACPvW,SAEFuW,IACGtW,EAAAA,EAAAA,KAAC4L,EAAAA,EAAS,CAAC9L,UAAU,aAErBE,EAAAA,EAAAA,KAACuZ,EAAAA,EAAS,CAACzZ,UAAU,eAG7BE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjL/C,EAAhBsZ,GAAkB,oCAAyC,oCAIxE3W,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYC,SAAA,EACvBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASxD,EACTkD,UAAU,uJAAsJC,UAEhKC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,eAEzBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,oCAGX2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACLrC,UAAU,4OACViC,SAAUpD,GAAQoB,SAEjBpB,IACGqB,EAAAA,EAAAA,KAAC2L,EAAAA,EAAa,CAAC7L,UAAU,0BAEzBE,EAAAA,EAAAA,KAAC4L,EAAAA,EAAS,CAAC9L,UAAU,eAG7BE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACvL/C,EAAV2B,GAAY,6BAAkC,yCAK5D,EAGLua,GAAoBA,IACK,IAAvBjD,EAAYtV,OAAqB,MAGjCX,EAAAA,EAAAA,KAAA,OAAKF,UAAU,OAAMC,UACjBC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,uBAAsBC,SAC/BkW,EAAY/T,KAAKwI,IACd/K,EAAAA,EAAAA,MAAA,MAAwBG,UAAU,4FAA2FC,SAAA,EACzHC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,uDAAsDC,SACjE2K,EAAWE,YAEhBjL,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWC,SAAA,EACtBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sBAAqBC,SAAA,EAChCC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASA,IArbZpB,WAC7B,IACI,MAAM/D,QAAiBC,EAAAA,EAAcI,IACjCM,EAAAA,GAAcgV,MAAMkG,WAAWzE,EAAKhX,GAAIqP,EAAWrP,IACnD,CAAEme,aAAc,SAIdlB,EAAMnM,OAAOlB,IAAIC,gBAAgB,IAAIuO,KAAK,CAACxe,EAASH,QACpD4e,EAAOC,SAASC,cAAc,KACpCF,EAAK3U,KAAOuT,EACZoB,EAAKG,aAAa,WAAYnP,EAAWE,UACzC+O,SAASG,KAAKC,YAAYL,GAC1BA,EAAKzP,QACLyP,EAAKM,QACT,CAAE,MAAOza,GAAM,IAAD0a,EAAAC,EACVnf,QAAQ0D,MAAM,yCAA0Cc,GAGxD,MAAMkH,EAAalH,EACnBb,IAA4B,QAAnBub,EAAAxT,EAAWxL,gBAAQ,IAAAgf,GAAM,QAANC,EAAnBD,EAAqBnf,YAAI,IAAAof,OAAN,EAAnBA,EAA2B3Y,UAAWkF,EAAWlF,SAAW,0CACzE,GAga+C4Y,CAAyBzP,GACxC5K,UAAU,gFAA+EC,UAEzFC,EAAAA,EAAAA,KAAA,OAAKkK,MAAM,6BAA6BpK,UAAU,UAAUqK,KAAK,OAAOC,QAAQ,YAAYC,OAAO,eAActK,UAC7GC,EAAAA,EAAAA,KAAA,QAAMsK,cAAc,QAAQC,eAAe,QAAQC,YAAa,EAAGC,EAAE,wEAG7EzK,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,sCAGX2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sBAAqBC,SAAA,EAChCC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASA,IA7edpB,WAC3B,IACIN,GAAS,MAGT,MAAMsR,EAAqBiG,EAAYxW,MAAK4E,GAAKA,EAAEhJ,KAAOub,IAE1D,GAAI5G,UACM9U,EAAAA,EAAc2b,OAAOjb,EAAAA,GAAcgV,MAAMkG,WAAWzE,EAAKhX,GAAIub,IAGnEV,EAAeD,EAAYjU,QAAO0I,GAAcA,EAAWrP,KAAOub,KAG9D5G,EAAmBpF,UAAU,CAE7B,MACMwP,GADgBhD,EAAAA,EAAAA,IAAqB/E,EAAKhX,GAAIub,GACTzG,QAAQ,sBAAuB,QAGpEE,EAAe,IAAIC,OAAO,kBAAD/U,OAAmB6e,EAAoB,OAAO,KACvE7J,EAAc,IAAID,OAAO,iBAAD/U,OAAkB6e,EAAoB,OAAO,KAGrE5J,EAAiBhJ,EAClB2I,QAAQE,EAAc,IACtBF,QAAQI,EAAa,IAErBJ,QAAQ,UAAW,QAExB1I,EAAe+I,EACnB,CAER,CAAE,MAAOjR,GAAM,IAAD8a,EAAAC,EACVvf,QAAQ0D,MAAM,sCAAoCc,GAGlD,MAAMkH,EAAalH,EACnBb,IAA4B,QAAnB2b,EAAA5T,EAAWxL,gBAAQ,IAAAof,GAAM,QAANC,EAAnBD,EAAqBvf,YAAI,IAAAwf,OAAN,EAAnBA,EAA2B/Y,UAAWkF,EAAWlF,SAAW,0CACzE,GAsc+CgZ,CAAuB7P,EAAWrP,IACjDyE,UAAU,4EAA2EC,UAErFC,EAAAA,EAAAA,KAAA,OAAKkK,MAAM,6BAA6BpK,UAAU,UAAUqK,KAAK,OAAOC,QAAQ,YAAYC,OAAO,eAActK,UAC7GC,EAAAA,EAAAA,KAAA,QAAMsK,cAAc,QAAQC,eAAe,QAAQC,YAAa,EAAGC,EAAE,8BAG7EzK,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,sCAKd0N,EAAWG,SAASC,WAAW,YAC5B9K,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oNAAmNC,UAC9NC,EAAAA,EAAAA,KAAA,OACIgL,KAAKoM,EAAAA,EAAAA,IAAqB/E,EAAKhX,GAAIqP,EAAWrP,IAC9C8P,IAAKT,EAAWE,SAChB9K,UAAU,mDAxCjB4K,EAAWrP,UAmDlC8d,GAA6BA,IACK,IAAhCtQ,EAAqBlI,OAAqB,MAG1CX,EAAAA,EAAAA,KAAA,OAAKF,UAAU,OAAMC,UACjBC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,uBAAsBC,SAC/B8I,EAAqB3G,KAAI,CAACwI,EAAYC,KAAK,IAAA6P,EAAA,OACxC7a,EAAAA,EAAAA,MAAA,MAA0BG,UAAU,4FAA2FC,SAAA,EAC3HC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,uDAAsDC,SACjE2K,EAAWE,YAEhB5K,EAAAA,EAAAA,KAAA,OAAKF,UAAU,YAAWC,UACtBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sBAAqBC,SAAA,EAChCC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASA,IAvdJuK,KAErC,MAAMqF,EAAqBnH,EAAqB8B,GAEhD,GAAIqF,IAEArD,EAAwB9D,EAAqB7G,QAAO,CAACiO,EAAGzB,IAAMA,IAAM7D,KAGhEqF,EAAmBpF,UAAU,CAE7B,MAAMsF,EAAkBF,EAAmBpF,SAASuF,QAAQ,sBAAuB,QAC7EC,EAAapT,EAAE,yCACfqT,EAAe,IAAIC,OAAO,OAAD/U,OAAQ2U,EAAe,UAAA3U,OAAS6U,EAAWD,QAAQ,sBAAuB,QAAO,OAAO,KACjHI,EAAc,IAAID,OAAO,MAAD/U,OAAO2U,EAAe,UAAA3U,OAAS6U,EAAWD,QAAQ,sBAAuB,QAAO,OAAO,KAG/GK,EAAiBhJ,EAClB2I,QAAQE,EAAc,IACtBF,QAAQI,EAAa,IAErBJ,QAAQ,UAAW,QAExB1I,EAAe+I,EACnB,CACJ,EA8b+CT,CAAgCpF,GAC/C7K,UAAU,4EAA2EC,UAErFC,EAAAA,EAAAA,KAAA,OAAKkK,MAAM,6BAA6BpK,UAAU,UAAUqK,KAAK,OAAOC,QAAQ,YAAYC,OAAO,eAActK,UAC7GC,EAAAA,EAAAA,KAAA,QAAMsK,cAAc,QAAQC,eAAe,QAAQC,YAAa,EAAGC,EAAE,8BAG7EzK,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,sCAKK,QAAnBwd,EAAA9P,EAAWG,gBAAQ,IAAA2P,OAAA,EAAnBA,EAAqB1P,WAAW,YAAaJ,EAAWK,OACrD/K,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oNAAmNC,UAC9NC,EAAAA,EAAAA,KAAA,OACIgL,IAAKC,IAAIC,gBAAgBR,EAAWK,MACpCI,IAAKT,EAAWE,SAChB9K,UAAU,mDAGrB,QAAAvE,OA7BYoP,GA8BZ,QAOzB,OAAKhO,EAGD6P,IAEI7M,EAAAA,EAAAA,MAACC,EAAAA,GAAM,CAACC,KAAMlD,EAAQC,QAASA,EAASkD,UAAU,gBAAeC,SAAA,EAC7DC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4BAA4B,cAAY,UAEvDE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,qDAAoDC,UAC/DJ,EAAAA,EAAAA,MAACC,EAAAA,GAAOK,MAAK,CAACH,UAAU,yEAAwEC,SAAA,EAC5FJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sEAAqEC,SAAA,EAChFC,EAAAA,EAAAA,KAACJ,EAAAA,GAAOM,MAAK,CAACJ,UAAU,wCAAuCC,SAC1D/C,EAAE,2BAEPgD,EAAAA,EAAAA,KAAA,UACII,QAASxD,EACTkD,UAAU,gFAA+EC,UAEzFC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,kBAI7BH,EAAAA,EAAAA,MAAA,OAAKG,UAAU,MAAKC,SAAA,CACftB,KACGuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,6EAA4EC,SACtFtB,KAIRwa,iBAWrBtZ,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,CAEKpD,IAAWsP,IACRjM,EAAAA,EAAAA,KAAA,OACIF,UAAU,uFACV,cAAY,OACZM,QAASxD,EACTgV,MAAO,CACHC,QAASlV,EAAS,EAAI,EACtBmV,WAAY,6BAMxBnS,EAAAA,EAAAA,MAAA,OACIG,UAAS,0JAAAvE,OAA4JoB,EAAS,gBAAkB,oBAChMiV,MAAO,CACHE,WAAY,uDACZC,cAAepV,EAAS,OAAS,QAErC,eAAcA,EACd6O,KAAK,SACL,aAAY7O,EAAOoD,SAAA,EAEnBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oFAAmFC,SAAA,EAC9FC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,wCAAuCC,SAC5C/C,EAAE,2BAEXgD,EAAAA,EAAAA,KAAA,UACII,QAASxD,EACTkD,UAAU,gFAA+EC,UAEzFC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,kBAI7BH,EAAAA,EAAAA,MAAA,OAAKG,UAAU,qCAAoCC,SAAA,CAC9CtB,KACGuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,6EAA4EC,SACtFtB,KAIRwa,cApFG,IAuFb,E,cCvsCX,MA2aA,GA3asEvc,IAI/D,IAJgE,OACrEC,EAAM,QACNC,EAAO,qBACP6d,GACD/d,EACC,MAAM,EAAEM,IAAMC,EAAAA,EAAAA,OACR,YAAEG,IAAgBC,EAAAA,EAAAA,MAClB,aAAEyO,EAAY,cAAEC,IAAkBC,EAAAA,EAAAA,MACjCQ,EAAUC,IAAejP,EAAAA,EAAAA,UAAS2O,OAAOC,WAAa,MACtDH,EAAeC,IAAoB1O,EAAAA,EAAAA,UAAS2O,OAAOC,WAAa,OAEhEsO,EAAWC,IAAgBnd,EAAAA,EAAAA,UAAS,KACpC/B,EAASmf,IAAcpd,EAAAA,EAAAA,UAAS,KAChCqd,EAAQC,IAAatd,EAAAA,EAAAA,UAAS,KAC9Bud,EAAUC,IAAexd,EAAAA,EAAAA,UAAS,QAClCyd,EAAaC,IAAkB1d,EAAAA,EAAAA,UAAmC,OAClEiB,EAAOC,IAAYlB,EAAAA,EAAAA,UAAwB,OAC3CmB,EAASC,IAAcpB,EAAAA,EAAAA,WAAS,GAejC2d,EAAuB5a,IAC3B,MAAMoB,EAAQpB,EAAEsB,OAAOF,MACvBiZ,EAAWjZ,GACXuZ,EAfyBvZ,IACpBA,GAAiC,IAAxBA,EAAMjB,OAAOC,OAIvBgB,EAAM2E,SAAS,MAAQ3E,EAAM2E,SAAS,KACjC,QAGF,QAPE,KAaM8U,CAAkBzZ,GAAO,EAGpC0Z,EAAsB9a,IAC1B,MAAMoB,EAAQpB,EAAEsB,OAAOF,OAET,KAAVA,GAAgB,cAAcsW,KAAKtW,KACrCmZ,EAAUnZ,EACZ,GAIF5C,EAAAA,EAAAA,YAAU,KACR,MAAM4X,EAAeA,KACnBlK,EAAYN,OAAOC,WAAa,KAChCF,EAAiBC,OAAOC,WAAa,KAAK,EAM5C,OAHAD,OAAOqB,iBAAiB,SAAUmJ,GAClCA,IAEO,KACLxK,OAAOsB,oBAAoB,SAAUkJ,EAAa,CACnD,GACA,KAGH5X,EAAAA,EAAAA,YAAU,KACJpC,IAAW6P,EACbV,IAEAC,IAGK,KACLA,GAAe,IAEhB,CAACpP,EAAQ6P,EAAUV,EAAcC,KAGpChN,EAAAA,EAAAA,YAAU,KACHpC,IACHge,EAAa,IACbC,EAAW,IACXE,EAAU,IACVE,EAAY,OACZE,EAAe,MACfxc,EAAS,MACX,GACC,CAAC/B,IAEJ,MAAM8L,EAAezJ,UAKnB,GAJAuB,EAAEC,iBACF9B,EAAS,MAGJgc,GAAyC,IAA5BA,EAAUha,OAAOC,OAKnC,GAAKlF,GAAqC,IAA1BA,EAAQiF,OAAOC,OAK/B,IAAKka,GAAUS,WAAWT,IAAW,EACnCnc,EAAS1B,EAAE,uDAAwD,6CAIrE,IACE4B,GAAW,GAEX,MAAM9D,EAA8B,CAClC4f,UAAWA,EAAUha,OACrBjF,QAASA,EAAQiF,OACjBma,OAAQS,WAAWT,GACnBE,SAAUA,GAGZhgB,QAAQC,IAAI,wCAAyCF,GACrDC,QAAQC,IAAI,yCAA0C,qBACtD,MAAMugB,QAAuB3gB,EAAAA,EAAmBC,OAAOC,GACvDC,QAAQC,IAAI,kDAAmDugB,GAE/Dne,EACEJ,EAAE,yCAA0C,qCAC5C,WAGFyd,EAAqBc,GACrB3e,GACF,CAAE,MAAO2C,GAAW,IAADiC,EAAAga,EAAAC,EAAAC,EACjB3gB,QAAQ0D,MAAM,mEAAoEc,GAClFxE,QAAQ0D,MAAM,2CAA4Cc,EAAItE,UAC9DF,QAAQ0D,MAAM,yCAAsD,QAAd+C,EAAEjC,EAAItE,gBAAQ,IAAAuG,OAAA,EAAZA,EAAc4D,QACtErK,QAAQ0D,MAAM,uCAAoD,QAAd+c,EAAEjc,EAAItE,gBAAQ,IAAAugB,OAAA,EAAZA,EAAc1gB,MACpE,MAAM4G,GAA2B,QAAZ+Z,EAAAlc,EAAItE,gBAAQ,IAAAwgB,GAAM,QAANC,EAAZD,EAAc3gB,YAAI,IAAA4gB,OAAN,EAAZA,EAAoBna,UAAWhC,EAAIgC,SACtDvE,EAAE,oDAAqD,0CACzD0B,EAASgD,GACTtE,EAAYsE,EAAc,QAC5B,CAAC,QACC9C,GAAW,EACb,MA1CEF,EAAS1B,EAAE,wDAAyD,6CALpE0B,EAAS1B,EAAE,0DAA2D,8BA+CxE,EAGI0L,EAAcA,KAClB9L,GAAS,EAIX,OAAI4P,GAEA7M,EAAAA,EAAAA,MAACC,EAAAA,GAAM,CAACC,KAAMlD,EAAQC,QAAS8L,EAAa5I,UAAU,gBAAeC,SAAA,EACnEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4BAA4B,cAAY,UACvDE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,qDAAoDC,UACjEC,EAAAA,EAAAA,KAACJ,EAAAA,GAAOK,MAAK,CAACH,UAAU,yEAAwEC,UAC9FJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,0DAAyDC,SAAA,EACtEJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,yCAAwCC,SAAA,EACrDC,EAAAA,EAAAA,KAACJ,EAAAA,GAAOM,MAAK,CAACJ,UAAU,oDAAmDC,SACxE/C,EAAE,uCAAwC,wBAE7CgD,EAAAA,EAAAA,KAAA,UACEI,QAASsI,EACT5I,UAAU,6DAA4DC,UAEtEC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,iBAI1BrB,IACCuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,uHAAsHC,SAClItB,KAILkB,EAAAA,EAAAA,MAAA,QAAMW,SAAUmI,EAAa1I,SAAA,EAE3BJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,OAAMC,SAAA,EACnBJ,EAAAA,EAAAA,MAAA,SAAO8J,QAAQ,YAAY3J,UAAU,kEAAiEC,SAAA,CACnG/C,EAAE,2CAA4C,aAAa,SAE9DgD,EAAAA,EAAAA,KAAA,SACEmC,KAAK,OACL9G,GAAG,YACHsG,MAAO+Y,EACP9Y,SAAWrB,GAAMoa,EAAapa,EAAEsB,OAAOF,OACvC7B,UAAU,0KACVgC,UAAQ,QAKZnC,EAAAA,EAAAA,MAAA,OAAKG,UAAU,OAAMC,SAAA,EACnBJ,EAAAA,EAAAA,MAAA,SAAO8J,QAAQ,UAAU3J,UAAU,kEAAiEC,SAAA,CACjG/C,EAAE,yCAA0C,4BAA4B,SAE3EgD,EAAAA,EAAAA,KAAA,SACEmC,KAAK,OACL9G,GAAG,UACHsG,MAAOlG,EACPmG,SAAUuZ,EACVrR,YAAa9M,EAAE,oDAAqD,6CACpE8C,UAAU,0KACVgC,UAAQ,IAETmZ,IACCjb,EAAAA,EAAAA,KAAA,KAAGF,UAAU,gDAA+CC,SACzC,UAAhBkb,EACGje,EAAE,+CAAgD,iBAClDA,EAAE,+CAAgD,+BAO5D2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,8BAA6BC,SAAA,EAC1CJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEJ,EAAAA,EAAAA,MAAA,SAAO8J,QAAQ,SAAS3J,UAAU,kEAAiEC,SAAA,CAChG/C,EAAE,wCAAyC,UAAU,SAExDgD,EAAAA,EAAAA,KAAA,SACEmC,KAAK,OACL9G,GAAG,SACHsG,MAAOkZ,EACPjZ,SAAUyZ,EACVvR,YAAY,OACZhK,UAAU,0KACVgC,UAAQ,QAGZnC,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,WAAW3J,UAAU,kEAAiEC,SAClG/C,EAAE,0CAA2C,iBAEhD2C,EAAAA,EAAAA,MAAA,UACEtE,GAAG,WACHsG,MAAOoZ,EACPnZ,SAAWrB,GAAMya,EAAYza,EAAEsB,OAAOF,OACtC7B,UAAU,0KAAyKC,SAAA,EAEnLC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,MAAK5B,SAAC,SACpBC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,MAAK5B,SAAC,SACpBC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,MAAK5B,SAAC,kBAK1BC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,gDAA+CC,SACzD/C,EAAE,sCAAuC,8HAI5C2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,6BAA4BC,SAAA,EACzCC,EAAAA,EAAAA,KAAA,UACEmC,KAAK,SACL/B,QAASxD,EACTkD,UAAU,kQAAiQC,SAE1Q/C,EAAE,gBAAiB,gBAEtBgD,EAAAA,EAAAA,KAAA,UACEmC,KAAK,SACLJ,SAAUpD,EACVmB,UAAU,4MAA2MC,SAEpNpB,EACG3B,EAAE,kBAAmB,oBACrBA,EAAE,gBAAiB,gCAerC2C,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,CAEGpD,IAAWsP,IACVjM,EAAAA,EAAAA,KAAA,OACEF,UAAU,uFACV,cAAY,OACZ8R,MAAO,CACLC,QAASlV,EAAS,EAAI,EACtBmV,WAAY,6BAMlBnS,EAAAA,EAAAA,MAAA,OACEG,UAAS,0JAAAvE,OAA4JoB,EAAS,gBAAkB,oBAChMiV,MAAO,CACLE,WAAY,uDACZC,cAAepV,EAAS,OAAS,QAEnC,eAAcA,EACd6O,KAAK,SACL,aAAY7O,EAAOoD,SAAA,EAEnBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oFAAmFC,SAAA,EAChGC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,wCAAuCC,SAClD/C,EAAE,uCAAwC,wBAE7CgD,EAAAA,EAAAA,KAAA,UACEI,QAASsI,EACT5I,UAAU,gFAA+EC,UAEzFC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,kBAIzBH,EAAAA,EAAAA,MAAA,OAAKG,UAAU,qCAAoCC,SAAA,CAChDtB,IACCuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,uHAAsHC,SAClItB,KAILkB,EAAAA,EAAAA,MAAA,QAAMW,SAAUmI,EAAa1I,SAAA,EAE3BJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,OAAMC,SAAA,EACnBJ,EAAAA,EAAAA,MAAA,SAAO8J,QAAQ,YAAY3J,UAAU,kEAAiEC,SAAA,CACnG/C,EAAE,2CAA4C,aAAa,SAE9DgD,EAAAA,EAAAA,KAAA,SACEmC,KAAK,OACL9G,GAAG,YACHsG,MAAO+Y,EACP9Y,SAAWrB,GAAMoa,EAAapa,EAAEsB,OAAOF,OACvC7B,UAAU,0KACVgC,UAAQ,QAKZnC,EAAAA,EAAAA,MAAA,OAAKG,UAAU,OAAMC,SAAA,EACnBJ,EAAAA,EAAAA,MAAA,SAAO8J,QAAQ,UAAU3J,UAAU,kEAAiEC,SAAA,CACjG/C,EAAE,yCAA0C,4BAA4B,SAE3EgD,EAAAA,EAAAA,KAAA,SACEmC,KAAK,OACL9G,GAAG,UACHsG,MAAOlG,EACPmG,SAAUuZ,EACVrR,YAAa9M,EAAE,oDAAqD,6CACpE8C,UAAU,0KACVgC,UAAQ,IAETmZ,IACCjb,EAAAA,EAAAA,KAAA,KAAGF,UAAU,gDAA+CC,SACzC,UAAhBkb,EACGje,EAAE,+CAAgD,iBAClDA,EAAE,+CAAgD,+BAO5D2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,8BAA6BC,SAAA,EAC1CJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEJ,EAAAA,EAAAA,MAAA,SAAO8J,QAAQ,SAAS3J,UAAU,kEAAiEC,SAAA,CAChG/C,EAAE,wCAAyC,UAAU,SAExDgD,EAAAA,EAAAA,KAAA,SACEmC,KAAK,OACL9G,GAAG,SACHsG,MAAOkZ,EACPjZ,SAAUyZ,EACVvR,YAAY,OACZhK,UAAU,0KACVgC,UAAQ,QAGZnC,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,WAAW3J,UAAU,kEAAiEC,SAClG/C,EAAE,0CAA2C,iBAEhD2C,EAAAA,EAAAA,MAAA,UACEtE,GAAG,WACHsG,MAAOoZ,EACPnZ,SAAWrB,GAAMya,EAAYza,EAAEsB,OAAOF,OACtC7B,UAAU,0KAAyKC,SAAA,EAEnLC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,MAAK5B,SAAC,SACpBC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,MAAK5B,SAAC,SACpBC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,MAAK5B,SAAC,kBAK1BC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,gDAA+CC,SACzD/C,EAAE,sCAAuC,8HAI5C2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,6BAA4BC,SAAA,EACzCC,EAAAA,EAAAA,KAAA,UACEmC,KAAK,SACL/B,QAASsI,EACT5I,UAAU,kQAAiQC,SAE1Q/C,EAAE,gBAAiB,gBAEtBgD,EAAAA,EAAAA,KAAA,UACEmC,KAAK,SACLJ,SAAUpD,EACVmB,UAAU,4MAA2MC,SAEpNpB,EACG3B,EAAE,kBAAmB,oBACrBA,EAAE,gBAAiB,6BAOhC,E,eCraP,MAySA,GAzS6BN,IAAgF,IAADif,EAAA,IAA9E,OAAEhf,EAAM,QAAEC,EAAO,QAAEgf,EAAO,iBAAEC,GAA6Cnf,EACnG,MAAM,EAAEM,IAAMC,EAAAA,EAAAA,OACR,KAAEC,IAASC,EAAAA,EAAAA,OACX,YAAEC,IAAgBC,EAAAA,EAAAA,MAEjBI,EAAUC,IAAeF,EAAAA,EAAAA,UAAS,KAClCG,EAAsBC,IAA2BJ,EAAAA,EAAAA,UAAsB,IACvEK,EAAcC,IAAmBN,EAAAA,EAAAA,UAAS,KAC1CO,EAAeC,IAAoBR,EAAAA,EAAAA,UAAS,KAC5CS,EAAeC,IAAoBV,EAAAA,EAAAA,UAAS,KAC5CW,EAAeC,IAAoBZ,EAAAA,EAAAA,UAAS,KAE5Ce,EAAcC,IAAmBhB,EAAAA,EAAAA,UAAsB,OACvDiB,EAAOC,IAAYlB,EAAAA,EAAAA,UAAwB,OAC3CmB,EAASC,IAAcpB,EAAAA,EAAAA,WAAS,IAChCqB,EAAaC,IAAkBtB,EAAAA,EAAAA,WAAS,IAG/CuB,EAAAA,EAAAA,YAAU,KAiBFpC,GAAUif,GAhBG5c,WACb,GAAW,OAAP4c,QAAO,IAAPA,GAAAA,EAASte,OACT,IAAK,IAAD2B,EACAH,GAAe,GACf,MAAM7D,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAcsD,MAAM4H,MAAM8U,EAAQte,SAC1D,QAAjB2B,EAAIhE,EAASH,YAAI,IAAAmE,GAAbA,EAAeoC,SACf7C,EAAgBvD,EAASH,KAAKA,KAEtC,CAAE,MAAOyE,GACLxE,QAAQ0D,MAAM,8BAA+Bc,EACjD,CAAC,QACGT,GAAe,EACnB,CACJ,EAIAgd,EACJ,GACD,CAACnf,EAAQif,KAGZ7c,EAAAA,EAAAA,YAAU,KACN,GAAI6c,EAAS,CAET,MAAMG,EAAc,IAAItb,KAAKmb,EAAQne,UAC/Bue,EAAOD,EAAYE,cACnBC,EAAQzI,OAAOsI,EAAYI,WAAa,GAAGC,SAAS,EAAG,KACvDC,EAAM5I,OAAOsI,EAAY3O,WAAWgP,SAAS,EAAG,KAChDE,EAAQ7I,OAAOsI,EAAYQ,YAAYH,SAAS,EAAG,KACnDI,EAAU/I,OAAOsI,EAAYU,cAAcL,SAAS,EAAG,KAC7D1e,EAAY,GAADnC,OAAIygB,EAAI,KAAAzgB,OAAI2gB,EAAK,KAAA3gB,OAAI8gB,EAAG,KAAA9gB,OAAI+gB,EAAK,KAAA/gB,OAAIihB,IAEhD5e,EAAwBge,EAAQje,sBAChCG,EAAgB8d,EAAQ/d,cAAgB,IACxCG,EAAiB4d,EAAQ7d,eAAiB,IAC1CG,EAAiB0d,EAAQ3d,eAAiB,IAC1CG,EAAiBwd,EAAQzd,eAAiB,GAC9C,MACIT,EAAY,IACZE,EAAwB,GACxBE,EAAgB,IAChBE,EAAiB,IACjBE,EAAiB,IACjBE,EAAiB,IAErBM,EAAS,KAAK,GACf,CAACkd,EAASjf,IAsFb,OAAKif,GAGDjc,EAAAA,EAAAA,MAACC,EAAAA,GAAM,CAACC,KAAMlD,EAAQC,QAASA,EAASkD,UAAU,gBAAeC,SAAA,EAC7DC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4BAA4B,cAAY,UACvDE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,qDAAoDC,UAC/DJ,EAAAA,EAAAA,MAACC,EAAAA,GAAOK,MAAK,CAACH,UAAU,yEAAwEC,SAAA,EAC5FJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sFAAqFC,SAAA,EAChGC,EAAAA,EAAAA,KAACJ,EAAAA,GAAOM,MAAK,CAACJ,UAAU,sDAAqDC,SACxE/C,EAAE,oBAAqB,CAAEmD,aAAc,+BAE5CH,EAAAA,EAAAA,KAAA,UACII,QAASxD,EACTkD,UAAU,6DAA4DC,UAEtEC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,kBAI7BH,EAAAA,EAAAA,MAAA,QAAMW,SAvGDtB,UAEjB,GADAuB,EAAEC,kBACGob,EAAS,OAId,GAHAld,EAAS,OAGJjB,EAED,YADAiB,EAAS1B,EAAE,2CAA4C,CAAEmD,aAAc,iCAK3E,GADoB,IAAIM,KAAKhD,GACX,IAAIgD,KAClB/B,EAAS1B,EAAE,kCAAmC,CAAEmD,aAAc,gDAIlE,IAAKxC,GAAwB+B,OAAO/B,GAAwB,EACxDe,EAAS1B,EAAE,kDAAmD,CAAEmD,aAAc,2CAIlF,IAAKtC,EAAa6C,QAAU7C,EAAa6C,OAAOC,OAAS,EACrDjC,EAAS1B,EAAE,gDAAiD,CAAEmD,aAAc,yDAIhF,GAAKlC,EAAcyC,QAAW3C,EAAc2C,OAA5C,CAMA,GAAInC,EAAc,CACd,MAAMqC,EAAUlB,OAAO/B,GACvB,GAAIY,EAAasC,iBAAmBD,EAAUrC,EAAasC,gBAMvD,YALAnC,EAAS1B,EAAE,6CAA8C,CACrDmD,aAAc,2DACdW,IAAKvC,EAAasC,gBAClBE,IAAKxC,EAAayC,iBAAmB,YAI7C,GAAIzC,EAAayC,iBAAmBJ,EAAUrC,EAAayC,gBAMvD,YALAtC,EAAS1B,EAAE,6CAA8C,CACrDmD,aAAc,2DACdW,IAAKvC,EAAasC,iBAAmB,EACrCE,IAAKxC,EAAayC,kBAI9B,CAEApC,GAAW,GACX,IAAK,IAADqC,EAAAC,EACA,MAAMjG,QAAiBC,EAAAA,EAAcQ,IAAIE,EAAAA,GAAcuF,cAAc2F,MAAM8U,EAAQvgB,IAAK,CACpFoC,WACAE,qBAAsB+B,OAAO/B,GAC7BE,aAAcA,EAAa6C,OAC3B3C,cAAeA,EAAc2C,QAAU,KACvCzC,cAAeA,EAAcyC,QAAU,KACvCvC,cAAeA,EAAcuC,QAAU,OAUnC,IAADU,EAPP,GAAiB,QAAbH,EAAAhG,EAASH,YAAI,IAAAmG,IAAbA,EAAeI,SAAwB,QAAjBH,EAAIjG,EAASH,YAAI,IAAAoG,IAAbA,EAAepG,KAQzC,MAAM,IAAIwG,OAAmB,QAAbF,EAAAnG,EAASH,YAAI,IAAAsG,OAAA,EAAbA,EAAeG,UAAW,yCAP1CnE,EACIJ,EAAE,uBAAwB,CAAEmD,aAAc,0CAC1C,WAEJ0b,EAAiB5gB,EAASH,KAAKA,MAC/B8B,GAIR,CAAE,MAAO2C,GAAW,IAADiC,EAAAC,EACf1G,QAAQ0D,MAAM,yCAA0Cc,GACxD,MAAMmC,GAA2B,QAAZF,EAAAjC,EAAItE,gBAAQ,IAAAuG,GAAM,QAANC,EAAZD,EAAc1G,YAAI,IAAA2G,OAAN,EAAZA,EAAoBF,UAAWhC,EAAIgC,SAAWvE,EAAE,uBACrE0B,EAASgD,GACTtE,EAAYsE,EAAc,QAC9B,CAAC,QACG9C,GAAW,EACf,CAnDA,MAFIF,EAAS1B,EAAE,0CAA2C,CAAEmD,aAAc,8EAqD1E,EAsB0CL,UAAU,gBAAeC,SAAA,CAClDtB,IACGuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wFAAuFC,UAClGC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,yCAAwCC,SAAEtB,OAK/DkB,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,kEAAiEC,SAC7E/C,EAAE,oBAAqB,CAAEmD,aAAc,YAE5CH,EAAAA,EAAAA,KAAA,SACImC,KAAK,OACLR,OAAmB,QAAZga,EAAAC,EAAQ9e,YAAI,IAAA6e,OAAA,EAAZA,EAAc1Z,QAAS,GAC9BnC,UAAU,2JACViC,UAAQ,QAIhBpC,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,kEAAiEC,SAAA,CAC7E/C,EAAE,wBAAyB,CAAEmD,aAAc,eAAgB,SAEhEH,EAAAA,EAAAA,KAAA,SACImC,KAAK,iBACLR,MAAOlE,EACPmE,SAAWrB,GAAM7C,EAAY6C,EAAEsB,OAAOF,OACtC7B,UAAU,4LACVgC,UAAQ,EACRC,SAAUpD,GAAWE,QAI7Bc,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,kEAAiEC,SAAA,CAC7E/C,EAAE,oCAAqC,CAAEmD,aAAc,sBAAuB,SAEnFH,EAAAA,EAAAA,KAAA,SACImC,KAAK,SACLrB,KAAiB,OAAZvC,QAAY,IAAZA,OAAY,EAAZA,EAAcsC,kBAAmB,EACtCE,KAAiB,OAAZxC,QAAY,IAAZA,OAAY,EAAZA,EAAcyC,uBAAmBoB,EACtCT,MAAOhE,EACPiE,SAAWrB,GAAM3C,EAAwB2C,EAAEsB,OAAOF,MAAQjC,OAAOa,EAAEsB,OAAOF,OAAS,IACnF7B,UAAU,4LACVgC,UAAQ,EACRC,SAAUpD,GAAWE,QAI7Bc,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,kEAAiEC,SAAA,CAC7E/C,EAAE,4BAA6B,CAAEmD,aAAc,eAAgB,SAEpEH,EAAAA,EAAAA,KAAA,SACImC,KAAK,OACLR,MAAO9D,EACP+D,SAAWrB,GAAMzC,EAAgByC,EAAEsB,OAAOF,OAC1C7B,UAAU,4LACVgC,UAAQ,EACRC,SAAUpD,GAAWE,QAI7Bc,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,kEAAiEC,SAC7E/C,EAAE,6BAA8B,CAAEmD,aAAc,eAErDH,EAAAA,EAAAA,KAAA,SACImC,KAAK,MACLR,MAAO1D,EACP2D,SAAWrB,GAAMrC,EAAiBqC,EAAEsB,OAAOF,OAC3C7B,UAAU,4LACViC,SAAUpD,GAAWE,QAI7Bc,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,kEAAiEC,SAC7E/C,EAAE,6BAA8B,CAAEmD,aAAc,cAErDH,EAAAA,EAAAA,KAAA,SACImC,KAAK,QACLR,MAAO5D,EACP6D,SAAWrB,GAAMvC,EAAiBuC,EAAEsB,OAAOF,OAC3C7B,UAAU,4LACViC,SAAUpD,GAAWE,QAI7Bc,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,kEAAiEC,SAC7E/C,EAAE,6BAA8B,CAAEmD,aAAc,eAErDH,EAAAA,EAAAA,KAAA,YACI2B,MAAOxD,EACPyD,SAAWrB,GAAMnC,EAAiBmC,EAAEsB,OAAOF,OAC3CU,KAAM,EACNvC,UAAU,4LACViC,SAAUpD,GAAWE,QAI7Bc,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gFAA+EC,SAAA,EAC1FC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASxD,EACTkD,UAAU,0LAAyLC,SAElM/C,EAAE,gBAAiB,gBAExBgD,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACLJ,SAAUpD,GAAWE,EACrBiB,UAAU,oIAAmIC,SAE5IpB,EAAU3B,EAAE,gBAAiB,gBAAkBA,EAAE,cAAe,6BAvIxE,IA6IR,EChCjB,GAtQiCN,IAA4E,IAA3E,OAAEC,EAAM,QAAEC,EAAO,QAAEgf,EAAO,SAAEc,GAAyChgB,EACnG,MAAM,EAAEM,IAAMC,EAAAA,EAAAA,OACR,YAAEG,IAAgBC,EAAAA,EAAAA,MAEjBsf,EAAcC,IAAmBpf,EAAAA,EAAAA,UAAgB,KACjDqf,EAAuBC,IAA4Btf,EAAAA,EAAAA,UAAsB,KACzEuf,EAAWC,IAAgBxf,EAAAA,EAAAA,UAAsB,KACjDyf,EAAoBC,IAAyB1f,EAAAA,EAAAA,UAAsB,KACnEmB,EAASC,IAAcpB,EAAAA,EAAAA,WAAS,IAChC2f,EAAqBC,IAA0B5f,EAAAA,EAAAA,WAAS,IACxD6f,EAAeC,IAAoB9f,EAAAA,EAAAA,UAA4B,KAEtEuB,EAAAA,EAAAA,YAAU,KACFpC,GAAUif,IACV2B,IACAC,IAEI5B,EAAQ6B,YACRT,EAA2C,kBAAvBpB,EAAQ6B,WAA0BnC,WAAWM,EAAQ6B,YAAc7B,EAAQ6B,YAEvG,GACD,CAAC9gB,EAAQif,IAEZ,MAAM2B,EAAmBve,UACrB,IACIoe,GAAuB,GACvB,MAAMniB,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAcC,YAAYsD,MACnE,GAAIlE,EAASH,KAAKuG,SAAW/E,MAAMC,QAAQtB,EAASH,MAAO,CACvD,MAAMA,EAAOG,EAASH,KAAKuG,QAAUpG,EAASH,KAAKA,KAAOG,EAASH,KACnE8hB,EAAgBtgB,MAAMC,QAAQzB,GAAQA,EAAO,GACjD,CACJ,CAAE,MAAOyE,GACLxE,QAAQ0D,MAAM,sCAAuCc,GACrDnC,EAAYJ,EAAE,oBAAqB,QACvC,CAAC,QACGogB,GAAuB,EAC3B,GAGEI,EAAoBxe,UACtB,GAAK4c,EACL,IACI,MAAM3gB,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAc8hB,kBAAkBC,WAAW/B,EAAQvgB,KACxFJ,EAASH,KAAKuG,SACdic,EAAiBriB,EAASH,KAAKA,MAAQ,GAE/C,CAAE,MAAOyE,GACLxE,QAAQ0D,MAAM,0CAAwCc,EAC1D,GAwDJ,IAAK5C,IAAWif,EAAS,OAAO,KAEhC,MAAMgC,EAAsBjB,EAAald,MAAKoe,GAAKA,EAAExiB,KAAOqE,OAAOmd,KAC7DiB,EAAuC,OAAnBF,QAAmB,IAAnBA,GAAAA,EAAqB/C,OAASnb,OAAOke,EAAoB/C,QAAU,EACvF4C,GAAc/d,OAAOqd,IAAc,IAAMrd,OAAOud,IAAuB,GACvEc,EAAUN,GAAcK,GAAqBL,EAAa,EAEhE,OACI9d,EAAAA,EAAAA,MAACC,EAAAA,GAAM,CAACC,KAAMlD,EAAQC,QAASA,EAASkD,UAAU,gBAAeC,SAAA,EAC7DC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4BAA4B,cAAY,UACvDE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,qDAAoDC,UAC/DJ,EAAAA,EAAAA,MAACC,EAAAA,GAAOK,MAAK,CAACH,UAAU,0EAAyEC,SAAA,EAC7FJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sFAAqFC,SAAA,EAChGJ,EAAAA,EAAAA,MAACC,EAAAA,GAAOM,MAAK,CAACJ,UAAU,8EAA6EC,SAAA,EACjGC,EAAAA,EAAAA,KAACge,EAAAA,EAAQ,CAACle,UAAU,YACnB9C,EAAE,8BAA+B,0CAEtCgD,EAAAA,EAAAA,KAAA,UACII,QAASxD,EACTkD,UAAU,6DAA4DC,UAEtEC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,kBAI7BH,EAAAA,EAAAA,MAAA,QAAMW,SA9EDtB,UAEjB,GADAuB,EAAEC,iBACGob,GAAYiB,GAA0BE,GAAcE,EAAzD,CAKAre,GAAW,GACX,IACI,MAAM3D,QAAiBC,EAAAA,EAAcC,KAAKS,EAAAA,GAAc8hB,kBAAkBve,KAAM,CAC5E7B,OAAQse,EAAQte,OAChB2gB,UAAWrC,EAAQvgB,GACnBiH,cAAeua,EACfE,UAAWrd,OAAOqd,GAClBE,mBAAoBvd,OAAOud,GAC3BlC,SAAUa,EAAQb,UAAY,QAG9B9f,EAASH,KAAKuG,SACdjE,EAAYJ,EAAE,gCAAiC,uCAAqC,WACpF0f,IACA9f,KAEAQ,EAAYnC,EAASH,KAAKyG,SAAWvE,EAAE,oBAAqB,QAEpE,CAAE,MAAOuC,GAAW,IAADiC,EAAAC,EACf1G,QAAQ0D,MAAM,4CAA0Cc,GACxDnC,GAAwB,QAAZoE,EAAAjC,EAAItE,gBAAQ,IAAAuG,GAAM,QAANC,EAAZD,EAAc1G,YAAI,IAAA2G,OAAN,EAAZA,EAAoBF,UAAWvE,EAAE,oBAAqB,QACtE,CAAC,QACG4B,GAAW,EACf,CAzBA,MAFIxB,EAAYJ,EAAE,sCAAuC,uCAAqC,QA2B9F,EAgD0C8C,UAAU,gBAAeC,SAAA,EACnDJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,kEAAiEC,SAAA,CAC7E/C,EAAE,oCAAqC,eAAe,SAE3D2C,EAAAA,EAAAA,MAAA,UACIgC,MAAOkb,EACPjb,SAAWrB,IACPuc,EAAyBvc,EAAEsB,OAAOF,MAAQjC,OAAOa,EAAEsB,OAAOF,OAAS,IACnE,MAAMuc,EAAMvB,EAAald,MAAKoe,GAAKA,EAAExiB,KAAOqE,OAAOa,EAAEsB,OAAOF,SAC5D,GAAO,OAAHuc,QAAG,IAAHA,GAAAA,EAAKrD,OAAQ,CACb,MAAMsD,EAAYze,OAAOwe,EAAIrD,QACvBuD,EAAmB1e,OAAOqd,IAAc,EAC9CG,EAAsBiB,EAAYC,EACtC,GAEJtc,UAAQ,EACRhC,UAAU,kLACViC,SAAUob,EAAoBpd,SAAA,EAE9BC,EAAAA,EAAAA,KAAA,UAAQ2B,MAAM,GAAE5B,SAAE/C,EAAE,gBAAiB,kBACpC2f,EAAaza,KAAImc,IACd1e,EAAAA,EAAAA,MAAA,UAA6BgC,MAAO0c,EAAYhjB,GAAG0E,SAAA,CAC9Cse,EAAY3D,UAAU,MAAI2D,EAAYC,YAAY,QAAMD,EAAYE,aAAa,KAAG7e,OAAO2e,EAAYxD,QAAU,GAAG2D,iBAAiB,IAAEH,EAAYtD,UAAY,MAAM,MAD7JsD,EAAYhjB,SAKhCuiB,IACGje,EAAAA,EAAAA,MAAA,KAAGG,UAAU,gDAA+CC,SAAA,CACvD/C,EAAE,0CAA2C,sBAAsB,KAAG8gB,EAAkBU,iBAAiB,IAAEZ,EAAoB7C,UAAY,aAKxJpb,EAAAA,EAAAA,MAAA,OAAKG,UAAU,yBAAwBC,SAAA,EACnCJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,kEAAiEC,SAAA,CAC7E/C,EAAE,kCAAmC,cAAc,SAExDgD,EAAAA,EAAAA,KAAA,SACImC,KAAK,SACLR,MAAOob,EACPnb,SAAWrB,GAAMyc,EAAazc,EAAEsB,OAAOF,MAAQjC,OAAOa,EAAEsB,OAAOF,OAAS,IACxEb,IAAI,IACJ2d,KAAK,OACL3c,UAAQ,EACRhC,UAAU,wLAIlBH,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,kEAAiEC,SAAA,CAC7E/C,EAAE,2CAA4C,gBAAgB,SAEnEgD,EAAAA,EAAAA,KAAA,SACImC,KAAK,SACLR,MAAOsb,EACPrb,SAAWrB,GAAM2c,EAAsB3c,EAAEsB,OAAOF,MAAQjC,OAAOa,EAAEsB,OAAOF,OAAS,IACjFb,IAAI,IACJ2d,KAAK,OACL3c,UAAQ,EACRhC,UAAU,0LAKrB8d,IACG5d,EAAAA,EAAAA,KAAA,OAAKF,UAAS,kBAAAvE,OAAoBwiB,EAAU,mCAAqC,gCAAiChe,UAC9GJ,EAAAA,EAAAA,MAAA,KAAGG,UAAS,WAAAvE,OAAawiB,EAAU,qCAAuC,kCAAmChe,SAAA,CACxG/C,EAAE,mCAAoC,eAAe,KAAGygB,EAAWe,iBAAiB,IAAE5C,EAAQb,UAAY,OACzGgD,GAAWN,EAAaK,IACtB9d,EAAAA,EAAAA,KAAA,QAAMF,UAAU,aAAYC,SACvB/C,EAAE,sCAAuC,8CAQ7DqgB,EAAc1c,OAAS,IACpBhB,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,4DAA2DC,SACpE/C,EAAE,sCAAuC,kCAE9CgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,YAAWC,SACrBsd,EAAcnb,KAAIwX,IAAI,IAAAgF,EAAA,OACnB/e,EAAAA,EAAAA,MAAA,OAAmBG,UAAU,+EAA8EC,SAAA,EACvGJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,sCAAqCC,UAC7B,QAAhB2e,EAAAhF,EAAK2E,mBAAW,IAAAK,OAAA,EAAhBA,EAAkBhE,YAAS,gBAAAnf,OAAoBme,EAAKpX,kBAEzD3C,EAAAA,EAAAA,MAAA,KAAGG,UAAU,2CAA0CC,SAAA,CAAC,SAC7CL,OAAOga,EAAKqD,WAAa,GAAGyB,iBAAiB,IAAE9E,EAAKqB,SAAS,cAC3Drb,OAAOga,EAAKuD,oBAAsB,GAAGuB,iBAAiB,IAAE9E,EAAKqB,gBAG9E/a,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASA,IAhJ5BpB,WACrB,GAAKmN,OAAOwS,QAAQ3hB,EAAE,sCAAuC,6DAI7D,IACI,MAAM/B,QAAiBC,EAAAA,EAAc2b,OAAOjb,EAAAA,GAAc8hB,kBAAkB5W,MAAM8X,IAC9E3jB,EAASH,KAAKuG,SACdjE,EAAYJ,EAAE,gCAAiC,8BAAyB,WACxEwgB,IACAd,KAEAtf,EAAYnC,EAASH,KAAKyG,SAAWvE,EAAE,sBAAuB,QAEtE,CAAE,MAAOuC,GAAW,IAADic,EAAAqD,EACf9jB,QAAQ0D,MAAM,6CAAwCc,GACtDnC,GAAwB,QAAZoe,EAAAjc,EAAItE,gBAAQ,IAAAugB,GAAM,QAANqD,EAAZrD,EAAc1gB,YAAI,IAAA+jB,OAAN,EAAZA,EAAoBtd,UAAWvE,EAAE,sBAAuB,QACxE,GA+HuD8hB,CAAiBpF,EAAKre,IACrCyE,UAAU,uGAAsGC,SAE/G/C,EAAE,gBAAiB,kBAflB0c,EAAKre,GAiBT,UAMtBsE,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gFAA+EC,SAAA,EAC1FC,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACL/B,QAASxD,EACTkD,UAAU,0LAAyLC,SAElM/C,EAAE,gBAAiB,gBAExBgD,EAAAA,EAAAA,KAAA,UACImC,KAAK,SACLJ,SAAUpD,IAAYof,IAAYlB,EAClC/c,UAAU,oIAAmIC,SAE5IpB,EAAU3B,EAAE,gBAAiB,uBAAyBA,EAAE,cAAe,4BAMvF,EC3QV,MAAM+hB,GAqHX,4BAAOC,CAAsBC,GAC3B,IAAKA,EACH,MAAO,KAIT,MAAMC,EAAaD,EAChBE,cACAze,OACAyP,QAAQ,OAAQ,KAGnB,GAAIiP,KAAKC,qBAAqBH,GAC5B,OAAOE,KAAKC,qBAAqBH,GAInC,IAAK,MAAOI,EAASzc,KAAakQ,OAAOS,QAAQ4L,KAAKC,sBACpD,GAAIH,EAAW5Y,SAASgZ,IAAYA,EAAQhZ,SAAS4Y,GACnD,OAAOrc,EAKX,MAAO,IACT,CAcA,gCAAO0c,CAA0BlB,GAI/B,GAAIA,EAAYmB,iBAAkB,CAEhC,OADiBJ,KAAKJ,sBAAsBX,EAAYmB,iBAE1D,CAGA,MAAO,IACT,EAvKWT,GASaM,qBAA+C,CAErE,SAAY,KACZ,SAAY,KACZ,OAAU,KACV,YAAU,KACV,UAAa,KACb,MAAS,KACT,YAAU,KACV,OAAU,KACV,MAAS,KACT,KAAQ,KACR,UAAQ,KACR,UAAa,KACb,QAAW,KACX,QAAW,KACX,SAAY,KACZ,QAAW,KACX,aAAc,KACd,OAAU,KACV,YAAU,KACV,UAAa,KACb,SAAY,KACZ,UAAa,KACb,cAAe,KACf,uBAAwB,KACxB,0BAAwB,KACxB,KAAQ,KACR,cAAe,KAGf,gBAAiB,KACjB,IAAO,KACP,iBAAkB,KAClB,GAAM,KACN,OAAU,KACV,UAAa,KACb,cAAe,KACf,eAAgB,KAChB,QAAW,KACX,UAAa,KACb,YAAe,KACf,UAAa,KAGb,QAAW,KACX,SAAY,KACZ,YAAe,KACf,YAAe,KACf,MAAS,KACT,QAAW,KACX,QAAW,KACX,gBAAc,KAGd,OAAU,KACV,QAAW,KACX,WAAc,KACd,QAAW,KACX,aAAW,KACX,QAAW,KACX,SAAY,KAGZ,MAAS,KACT,OAAU,KACV,QAAW,KAGX,OAAU,KACV,OAAU,KACV,UAAa,KACb,SAAY,KAGZ,YAAe,KACf,QAAW,KACX,YAAe,KACf,OAAU,KACV,QAAW,KACX,MAAS,KACT,OAAU,KACV,MAAS,KACT,SAAY,KACZ,MAAS,KACT,MAAS,KACT,WAAS,KACT,MAAS,KACT,MAAS,KACT,MAAS,KACT,OAAU,KACV,aAAW,KACX,YAAU,KACV,MAAS,KACT,OAAU,KACV,aAAW,KACX,YAAe,KACf,QAAW,MCjGf,MA2ZA,GA3ZsE3iB,IAK/D,IALgE,OACrEC,EAAM,QACNC,EAAO,YACPyhB,EAAW,UACXoB,GACD/iB,EACC,MAAM,EAAEM,IAAMC,EAAAA,EAAAA,OACR,YAAEG,IAAgBC,EAAAA,EAAAA,MAClB,aAAEyO,EAAY,cAAEC,IAAkBC,EAAAA,EAAAA,MACjCQ,EAAUC,IAAejP,EAAAA,EAAAA,UAAS2O,OAAOC,WAAa,MACtDH,EAAeC,IAAoB1O,EAAAA,EAAAA,UAAS2O,OAAOC,WAAa,OAGhEsT,EAAYC,IAAiBniB,EAAAA,EAAAA,UAAS6gB,EAAYqB,YAAc,KAChEE,EAAYC,IAAiBriB,EAAAA,EAAAA,UAAS6gB,EAAYuB,YAAc,KAChEE,EAAeC,IAAoBviB,EAAAA,EAAAA,UAAS,KAC5CmB,EAASC,IAAcpB,EAAAA,EAAAA,WAAS,IAChCiB,EAAOC,IAAYlB,EAAAA,EAAAA,UAAwB,OAC3CwiB,EAAgBC,IAAqBziB,EAAAA,EAAAA,UAAS,IAI/C0iB,EAA0BA,IAKT,OAJAnB,GAAuBQ,0BAA0B,CACpEC,iBAAkBnB,EAAYmB,mBAKxB,gkBAwBF,0oBAwBRzgB,EAAAA,EAAAA,YAAU,KACJpC,IAAWmjB,GACbC,EAAiBG,IACnB,GACC,CAACvjB,EAAQ0hB,KAGZtf,EAAAA,EAAAA,YAAU,KACR,GAAI+gB,EAAe,CAQjB,MAAMK,EAAepB,GAAuBQ,0BAA0B,CACpEC,iBAAkBnB,EAAYmB,mBAE1BY,EAAQ/B,EAAYuB,YAAc,GACxC,IAAI9a,EAAc,iCAClB,GAAIsb,EAAO,CAET,MAAMC,EAAShC,EAAYiC,oBAAsBjC,EAAYhjB,GAAGklB,WAC1DC,EAAU,mDACVphB,EAAS,IAAIqhB,gBACnBrhB,EAAO+R,OAAO,SAAUkP,GACxBjhB,EAAO+R,OAAO,QAASiP,GAEvBhhB,EAAO+R,OAAO,KAAuB,OAAjBgP,EAAwB,KAAO,MACnDrb,EAAW,GAAAvJ,OAAMilB,EAAO,KAAAjlB,OAAI6D,EAAOmhB,WACrC,CAGA,MAAM1b,EAAcwZ,EAAYxZ,aAAe,+BAE/C,IAAI6b,EAAUZ,EACX3P,QAAQ,qBAAsBkO,EAAY3D,WAC1CvK,QAAQ,uBAAwBrL,GAChCqL,QAAQ,uBAAwBtL,GACnCob,EAAkBS,EACpB,IACC,CAACZ,EAAezB,EAAY3D,UAAW2D,EAAYxZ,YAAawZ,EAAYhjB,GAAIgjB,EAAYuB,WAAYvB,EAAYmB,oBAGvHzgB,EAAAA,EAAAA,YAAU,KACR,MAAM4X,EAAeA,KACnBlK,EAAYN,OAAOC,WAAa,KAChCF,EAAiBC,OAAOC,WAAa,KAAK,EAM5C,OAHAD,OAAOqB,iBAAiB,SAAUmJ,GAClCA,IAEO,KACLxK,OAAOsB,oBAAoB,SAAUkJ,EAAa,CACnD,GACA,KAGH5X,EAAAA,EAAAA,YAAU,KACJpC,IAAW6P,EACbV,IAEAC,IAGK,KACLA,GAAe,IAEhB,CAACpP,EAAQ6P,EAAUV,EAAcC,KAGpChN,EAAAA,EAAAA,YAAU,KACHpC,IACHgjB,EAActB,EAAYqB,YAAc,IACxCG,EAAcxB,EAAYuB,YAAc,IACxCG,EAAiB,IACjBrhB,EAAS,MACTuhB,EAAkB,IACpB,GACC,CAACtjB,EAAQ0hB,IAEZ,MAAM3V,EAAcA,KAClBhK,EAAS,MACT9B,GAAS,EAGL6L,EAAezJ,UAKnB,GAJAuB,EAAEC,iBACF9B,EAAS,MAGJghB,GAAeE,EAKpB,IACEhhB,GAAW,SAELhE,EAAAA,EAAmBmB,eAAesiB,EAAYhjB,GAAI,CACtDqkB,WAAYA,QAActd,EAC1Bwd,WAAYA,QAAcxd,EAC1B0d,cAAeA,QAAiB1d,IAGlChF,EACEJ,EAAE,sCAAuC,mCACzC,WAEFyiB,IACA/W,GACF,CAAE,MAAOnJ,GAAW,IAADiC,EAAAC,EACjB1G,QAAQ0D,MAAM,uCAAwCc,GACtD,MAAMmC,GAA2B,QAAZF,EAAAjC,EAAItE,gBAAQ,IAAAuG,GAAM,QAANC,EAAZD,EAAc1G,YAAI,IAAA2G,OAAN,EAAZA,EAAoBF,UACvCvE,EAAE,oCAAqC,uCACzC0B,EAASgD,GACTtE,EAAYsE,EAAc,QAC5B,CAAC,QACC9C,GAAW,EACb,MA3BEF,EAAS1B,EAAE,wCAAyC,yEA2BtD,EAII2jB,EAActC,EAAYuC,cAGhC,OAAIpU,GAEAxM,EAAAA,EAAAA,KAAA,OACEF,UAAS,sCAAAvE,OAAwCoB,EAAS,GAAK,UAC/D,kBAAgB,cAChB6O,KAAK,SACL,aAAW,OAAMzL,UAEjBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oFAAmFC,SAAA,EAChGC,EAAAA,EAAAA,KAAA,OACEF,UAAU,6DACVM,QAASsI,KAGX/I,EAAAA,EAAAA,MAAA,OAAKG,UAAU,2IAA0IC,SAAA,EACvJJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sEAAqEC,SAAA,EAClFC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,wCAAuCC,SAClD/C,EAAE,oCAAqC,uBAE1CgD,EAAAA,EAAAA,KAAA,UACEI,QAASsI,EACT5I,UAAU,gFAA+EC,UAEzFC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,kBAIzBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,gDAA+CC,SAC3DkZ,eAUXtZ,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,CAEGpD,IAAWsP,IACVjM,EAAAA,EAAAA,KAAA,OACEF,UAAU,uFACV,cAAY,OACZ8R,MAAO,CACLC,QAASlV,EAAS,EAAI,EACtBmV,WAAY,6BAMlBnS,EAAAA,EAAAA,MAAA,OACEG,UAAS,0JAAAvE,OAA4JoB,EAAS,gBAAkB,oBAChMiV,MAAO,CACLE,WAAY,uDACZC,cAAepV,EAAS,OAAS,QAEnC,eAAcA,EACd6O,KAAK,SACL,aAAY7O,EAAOoD,SAAA,EAEnBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oFAAmFC,SAAA,EAChGC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,wCAAuCC,SAClD/C,EAAE,oCAAqC,uBAE1CgD,EAAAA,EAAAA,KAAA,UACEI,QAASsI,EACT5I,UAAU,gFAA+EC,UAEzFC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,kBAIzBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,qCAAoCC,SAChDkZ,YAMT,SAASA,IACP,OACEtZ,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,CACGtB,IACCuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,uHAAsHC,SAClItB,IAIJkiB,IACChhB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,yIAAwIC,SAAA,EACrJJ,EAAAA,EAAAA,MAAA,KAAGG,UAAU,UAASC,SAAA,CACnB/C,EAAE,0CAA2C,wBAAwB,KAAG,IAAIyD,KAAK4d,EAAYuC,eAAgBpC,qBAEhHxe,EAAAA,EAAAA,KAAA,KAAGF,UAAU,eAAcC,SACxB/C,EAAE,wCAAyC,oDAKlD2C,EAAAA,EAAAA,MAAA,QAAMW,SAAUmI,EAAc3I,UAAU,YAAWC,SAAA,EAEjDJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,2DAA0DC,SACrE/C,EAAE,0CAA2C,2BAGhD2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWC,SAAA,EAExBJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,aAAa3J,UAAU,kEAAiEC,SACpG/C,EAAE,qBAAsB,oBAE3BgD,EAAAA,EAAAA,KAAA,SACEmC,KAAK,MACL9G,GAAG,aACHsG,MAAO+d,EACP9d,SAAWrB,GAAMof,EAAcpf,EAAEsB,OAAOF,OACxCmI,YAAY,gBACZhK,UAAU,gLAKdH,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,aAAa3J,UAAU,kEAAiEC,SACpG/C,EAAE,qBAAsB,aAE3BgD,EAAAA,EAAAA,KAAA,SACEmC,KAAK,QACL9G,GAAG,aACHsG,MAAOie,EACPhe,SAAWrB,GAAMsf,EAActf,EAAEsB,OAAOF,OACxCmI,YAAY,oBACZhK,UAAU,sLAOlBH,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,2DAA0DC,SACrE/C,EAAE,sCAAuC,gBAG5C2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWC,SAAA,EAExBJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,gBAAgB3J,UAAU,kEAAiEC,SACvG/C,EAAE,2CAA4C,6BAEjDgD,EAAAA,EAAAA,KAAA,YACE3E,GAAG,gBACHsG,MAAOme,EACPle,SAAWrB,GAAMwf,EAAiBxf,EAAEsB,OAAOF,OAC3CU,KAAM,GACNvC,UAAU,4LACVgK,YAAaoW,OAEflgB,EAAAA,EAAAA,KAAA,KAAGF,UAAU,gDAA+CC,SACzD/C,EAAE,+CAAgD,iFAKtDgjB,IACCrgB,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,kEAAiEC,SAC/E/C,EAAE,sCAAuC,eAE5CgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,sJAAqJC,SACjKigB,cAQXrgB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gEAA+DC,SAAA,EAC5EC,EAAAA,EAAAA,KAAA,UACEmC,KAAK,SACL/B,QAASsI,EACT5I,UAAU,kQAAiQC,SAE1Q/C,EAAE,gBAAiB,gBAEtBgD,EAAAA,EAAAA,KAAA,UACEmC,KAAK,SACLJ,SAAUpD,IAAa+gB,IAAeE,EACtC9f,UAAU,4MAA2MC,SAEpNpB,EACG3B,EAAE,sCAAuC,oBACzCA,EAAE,mCAAoC,oBAOtD,GCpCF,GApXkEN,IAK3D,IAL4D,OACjEC,EAAM,QACNC,EAAO,YACPyhB,EAAW,UACXoB,GACD/iB,EACC,MAAM,EAAEM,IAAMC,EAAAA,EAAAA,OACR,YAAEG,IAAgBC,EAAAA,EAAAA,MAClB,aAAEyO,EAAY,cAAEC,IAAkBC,EAAAA,EAAAA,MACjCQ,EAAUC,IAAejP,EAAAA,EAAAA,UAAS2O,OAAOC,WAAa,MACtDH,EAAeC,IAAoB1O,EAAAA,EAAAA,UAAS2O,OAAOC,WAAa,OAGhEsT,EAAYC,IAAiBniB,EAAAA,EAAAA,UAAS6gB,EAAYqB,YAAc,KAChEE,EAAYC,IAAiBriB,EAAAA,EAAAA,UAAS6gB,EAAYuB,YAAc,KAChEE,EAAeC,IAAoBviB,EAAAA,EAAAA,UAAS,KAC5CmB,EAASC,IAAcpB,EAAAA,EAAAA,WAAS,IAChCiB,EAAOC,IAAYlB,EAAAA,EAAAA,UAAwB,OAC3CwiB,EAAgBC,IAAqBziB,EAAAA,EAAAA,UAAS,IAM/C0iB,EAA0BA,IAOT,OANAnB,GAAuBQ,0BAA0B,CACpEC,iBAAkBnB,EAAYmB,mBAOxB,wQAkBF,uTAkBRzgB,EAAAA,EAAAA,YAAU,KACJpC,IAAWmjB,GACbC,EAAiBG,IACnB,GACC,CAACvjB,EAAQ0hB,KAGZtf,EAAAA,EAAAA,YAAU,KACR,GAAI+gB,EAAe,CAEjB,MAAMe,EAAWxC,EAAYyC,SAAWzC,EAAY0C,iBAAmB,4BACjEC,EAAa3C,EAAY2C,YAAc,iBACvCC,EAAkB5C,EAAY4C,iBAAmB,uBACjDC,EAAc7C,EAAY6C,aAAe,SAI/C,IAAIR,EAAUZ,EACX3P,QAAQ,qBAAsBkO,EAAY3D,WAC1CvK,QAAQ,oBAAqB0Q,GAC7B1Q,QAAQ,sBAAuB6Q,GAC/B7Q,QAAQ,2BAA4B8Q,GACpC9Q,QAAQ,uBAAwB+Q,GACnCjB,EAAkBS,EACpB,IACC,CAACZ,EAAezB,EAAY3D,UAAW2D,EAAYyC,QAASzC,EAAY0C,gBAAiB1C,EAAY2C,WAAY3C,EAAY4C,gBAAiB5C,EAAY6C,YAAa7C,EAAYmB,oBAGtLzgB,EAAAA,EAAAA,YAAU,KACR,MAAM4X,EAAeA,KACnBlK,EAAYN,OAAOC,WAAa,KAChCF,EAAiBC,OAAOC,WAAa,KAAK,EAM5C,OAHAD,OAAOqB,iBAAiB,SAAUmJ,GAClCA,IAEO,KACLxK,OAAOsB,oBAAoB,SAAUkJ,EAAa,CACnD,GACA,KAGH5X,EAAAA,EAAAA,YAAU,KACJpC,IAAW6P,EACbV,IAEAC,IAGK,KACLA,GAAe,IAEhB,CAACpP,EAAQ6P,EAAUV,EAAcC,KAGpChN,EAAAA,EAAAA,YAAU,KACHpC,IACHgjB,EAActB,EAAYqB,YAAc,IACxCG,EAAcxB,EAAYuB,YAAc,IACxCG,EAAiB,IACjBrhB,EAAS,MACTuhB,EAAkB,IACpB,GACC,CAACtjB,EAAQ0hB,IAEZ,MAAM3V,EAAcA,KAClBhK,EAAS,MACT9B,GAAS,EAGL6L,EAAezJ,UAKnB,GAJAuB,EAAEC,iBACF9B,EAAS,MAGJghB,GAAeE,EAKpB,IACEhhB,GAAW,SAELhE,EAAAA,EAAmBsB,aAAamiB,EAAYhjB,GAAI,CACpDqkB,WAAYA,QAActd,EAC1Bwd,WAAYA,QAAcxd,EAC1B0d,cAAeA,QAAiB1d,IAGlChF,EACEJ,EAAE,oCAAqC,kCACvC,WAEFyiB,IACA/W,GACF,CAAE,MAAOnJ,GAAW,IAADiC,EAAAC,EACjB1G,QAAQ0D,MAAM,uCAAwCc,GACtD,MAAMmC,GAA2B,QAAZF,EAAAjC,EAAItE,gBAAQ,IAAAuG,GAAM,QAANC,EAAZD,EAAc1G,YAAI,IAAA2G,OAAN,EAAZA,EAAoBF,UACvCvE,EAAE,kCAAmC,uCACvC0B,EAASgD,GACTtE,EAAYsE,EAAc,QAC5B,CAAC,QACC9C,GAAW,EACb,MA3BEF,EAAS1B,EAAE,sCAAuC,yEA2BpD,EAIF,OAAIwP,GAEAxM,EAAAA,EAAAA,KAAA,OACEF,UAAS,sCAAAvE,OAAwCoB,EAAS,GAAK,UAC/D,kBAAgB,cAChB6O,KAAK,SACL,aAAW,OAAMzL,UAEjBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oFAAmFC,SAAA,EAChGC,EAAAA,EAAAA,KAAA,OACEF,UAAU,6DACVM,QAASsI,KAGX/I,EAAAA,EAAAA,MAAA,OAAKG,UAAU,2IAA0IC,SAAA,EACvJJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sEAAqEC,SAAA,EAClFC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,wCAAuCC,SAClD/C,EAAE,kCAAmC,sBAExCgD,EAAAA,EAAAA,KAAA,UACEI,QAASsI,EACT5I,UAAU,gFAA+EC,UAEzFC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,kBAIzBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,gDAA+CC,SAC3DkZ,eAUXtZ,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,CAEGpD,IAAWsP,IACVjM,EAAAA,EAAAA,KAAA,OACEF,UAAU,uFACV,cAAY,OACZ8R,MAAO,CACLC,QAASlV,EAAS,EAAI,EACtBmV,WAAY,6BAMlBnS,EAAAA,EAAAA,MAAA,OACEG,UAAS,0JAAAvE,OAA4JoB,EAAS,gBAAkB,oBAChMiV,MAAO,CACLE,WAAY,uDACZC,cAAepV,EAAS,OAAS,QAEnC,eAAcA,EACd6O,KAAK,SACL,aAAY7O,EAAOoD,SAAA,EAEnBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oFAAmFC,SAAA,EAChGC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,wCAAuCC,SAClD/C,EAAE,kCAAmC,sBAExCgD,EAAAA,EAAAA,KAAA,UACEI,QAASsI,EACT5I,UAAU,gFAA+EC,UAEzFC,EAAAA,EAAAA,KAACK,EAAAA,EAAS,CAACP,UAAU,kBAIzBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,qCAAoCC,SAChDkZ,YAMT,SAASA,IACP,OACEtZ,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,CACGtB,IACCuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,uHAAsHC,SAClItB,KAILkB,EAAAA,EAAAA,MAAA,QAAMW,SAAUmI,EAAc3I,UAAU,YAAWC,SAAA,EAEjDJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,2DAA0DC,SACrE/C,EAAE,wCAAyC,2BAG9C2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWC,SAAA,EAExBJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,aAAa3J,UAAU,kEAAiEC,SACpG/C,EAAE,qBAAsB,oBAE3BgD,EAAAA,EAAAA,KAAA,SACEmC,KAAK,MACL9G,GAAG,aACHsG,MAAO+d,EACP9d,SAAWrB,GAAMof,EAAcpf,EAAEsB,OAAOF,OACxCmI,YAAY,gBACZhK,UAAU,gLAKdH,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,aAAa3J,UAAU,kEAAiEC,SACpG/C,EAAE,qBAAsB,aAE3BgD,EAAAA,EAAAA,KAAA,SACEmC,KAAK,QACL9G,GAAG,aACHsG,MAAOie,EACPhe,SAAWrB,GAAMsf,EAActf,EAAEsB,OAAOF,OACxCmI,YAAY,oBACZhK,UAAU,sLAOlBH,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,2DAA0DC,SACrE/C,EAAE,oCAAqC,gBAG1C2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWC,SAAA,EAExBJ,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOyJ,QAAQ,gBAAgB3J,UAAU,kEAAiEC,SACvG/C,EAAE,yCAA0C,6BAE/CgD,EAAAA,EAAAA,KAAA,YACE3E,GAAG,gBACHsG,MAAOme,EACPle,SAAWrB,GAAMwf,EAAiBxf,EAAEsB,OAAOF,OAC3CU,KAAM,EACNvC,UAAU,4LACVgK,YAAaoW,OAEflgB,EAAAA,EAAAA,KAAA,KAAGF,UAAU,gDAA+CC,SACzD/C,EAAE,6CAA8C,kGAKpDgjB,IACCrgB,EAAAA,EAAAA,MAAA,OAAAI,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,kEAAiEC,SAC/E/C,EAAE,oCAAqC,eAE1CgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,sJAAqJC,SACjKigB,cAQXrgB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gEAA+DC,SAAA,EAC5EC,EAAAA,EAAAA,KAAA,UACEmC,KAAK,SACL/B,QAASsI,EACT5I,UAAU,kQAAiQC,SAE1Q/C,EAAE,gBAAiB,gBAEtBgD,EAAAA,EAAAA,KAAA,UACEmC,KAAK,SACLJ,SAAUpD,IAAa+gB,IAAeE,EACtC9f,UAAU,4MAA2MC,SAEpNpB,EACG3B,EAAE,oCAAqC,oBACvCA,EAAE,iCAAkC,oBAOpD,G,4FC1VF,MAieA,GAjekCmkB,KAE9B,MAAM,EAAEnkB,IAAMC,EAAAA,EAAAA,OACPmkB,EAAYC,IAAiB7jB,EAAAA,EAAAA,WAAS,IACtC8jB,EAAWC,IAAgB/jB,EAAAA,EAAAA,UAAsB,OACjDgkB,EAAaC,IAAkBjkB,EAAAA,EAAAA,UAAiB,aAChDkkB,EAAgBC,IAAqBnkB,EAAAA,EAAAA,UAA0B,OAC/DokB,EAAWC,IAAgBrkB,EAAAA,EAAAA,WAAS,IACpCskB,EAAmBC,IAAwBvkB,EAAAA,EAAAA,WAAS,IACpDwkB,EAAaC,IAAkBzkB,EAAAA,EAAAA,UAAwB,OACxD,KAAEN,IAASC,EAAAA,EAAAA,OACTikB,WAAYc,EAAe,qBAAEC,EAAoB,oBAAEC,IAAwBC,EAAAA,GAAAA,MAC7E,SAAE7Z,EAAQ,eAAE8Z,EAAc,kBAAEC,IAAsBC,EAAAA,GAAAA,MAClD,aAAEC,IAAiBC,EAAAA,GAAAA,KAGnBC,GAA0BC,EAAAA,EAAAA,UAAQ,OAC/BlB,IAAmBe,MAEc,OAAlCf,EAAemB,qBAA+CzgB,IAApBqgB,EAAapnB,KAEpDqmB,EAAemB,iBAAmBJ,EAAapnB,KACvD,CAACqmB,EAAgBe,KAGQK,EAAAA,EAAAA,cAAY9jB,UACpC,IACI6iB,GAAa,GACbI,EAAe,MAEflnB,QAAQC,IAAI,oCACZD,QAAQC,IAAI,oBAAyB,OAAJkC,QAAI,IAAJA,OAAI,EAAJA,EAAM7B,IAEvC,MAAM0nB,EAAQrV,aAAaC,QAAQ,SAGnC,GAFA5S,QAAQC,IAAI,mBAAoB+nB,EAAQ,KAAO,SAE1CA,EAID,OAHAhoB,QAAQ0D,MAAM,yCACdwjB,EAAejlB,EAAE,2CACjB6kB,GAAa,GAIjB,IAEI,MAAM5mB,QAAiBC,EAAAA,EAAcI,IAAIM,EAAAA,GAAconB,SAASC,QAEhEloB,QAAQC,IAAI,sBAAuBC,EAASmK,QAE5C,MAAMtK,EAAOG,EAASH,KAGtB,GAFAC,QAAQC,IAAI,8BAA+BF,GAEvCA,IAAwB,IAAhBA,EAAKooB,OAAiB,CAC9BnoB,QAAQC,IAAI,iCAAkCF,EAAKO,IAGnD,MAAM8nB,EAAiBroB,EAAKwmB,UAAU8B,SAAS,KACzCtoB,EAAKwmB,UAAUna,UAAU,EAAGrM,EAAKwmB,UAAU3gB,OAAS,GACpD7F,EAAKwmB,UAEL+B,EAAgB,IAAI5iB,KAAK0iB,GAIzBG,GADM,IAAI7iB,MACC8D,UAAY8e,EAAc9e,UACrCgf,EAAeC,KAAKC,MAAMH,EAAO,KACjChH,EAAQkH,KAAKC,MAAMF,EAAe,MAClC/G,EAAUgH,KAAKC,MAAOF,EAAe,KAAQ,IAC7CG,EAAUH,EAAe,GAG/B5B,EAAkB7mB,GAClBymB,EAAa8B,GACb5B,EAAe,GAADlmB,OACP+gB,EAAMiE,WAAWnE,SAAS,EAAG,KAAI,KAAA7gB,OAAIihB,EACnC+D,WAAWnE,SAAS,EAAG,KAAI,KAAA7gB,OAAImoB,EAAQnD,WAAWnE,SAAS,EAAG,OAEvEiF,GAAc,GAGViB,IAAmBxnB,EAAKoN,UACxBqa,EAAkBznB,EAAKoN,UAI3Bia,GAAqB,EACzB,MACIpnB,QAAQC,IAAI,wCAEZqmB,GAAc,GACdM,EAAkB,MAClBJ,EAAa,MACbE,EAAe,YAGfU,GAAqB,EAE7B,CAAE,MAAO1jB,GACL1D,QAAQ0D,MAAM,iDAAkDA,GAGhE,MAAMgI,EAAahI,EAGX,IAAD8H,EAAAC,EAFP,GAAwB,gBAApBC,EAAWqH,KACXmU,EAAejlB,EAAE,0CAEjBilB,EAAe,GAAD1mB,OAAIyB,EAAE,+BAA8B,MAAAzB,QAAwB,QAAnBgL,EAAAE,EAAWxL,gBAAQ,IAAAsL,GAAM,QAANC,EAAnBD,EAAqBzL,YAAI,IAAA0L,OAAN,EAAnBA,EAA2BjF,UAAWkF,EAAWlF,SAEhH,CACJ,CAAC,QACGsgB,GAAa,EACjB,IACD,CAAK,OAAJ3kB,QAAI,IAAJA,OAAI,EAAJA,EAAM7B,GAAI8mB,EAAsBG,EAAgBG,KAIpD1jB,EAAAA,EAAAA,YAAU,KACF7B,OAGwBkF,IAApB8f,IAEAb,EAAca,GACdL,GAAa,IAKjBA,GAAa,EACjB,GACD,CAAC3kB,EAAMglB,KAGVnjB,EAAAA,EAAAA,YAAU,KACN,IAAI4kB,EAqBJ,OAnBIvC,GAAcE,IACdqC,EAAaxX,OAAOyX,aAAY,KAC5B,MACMN,GADM,IAAI7iB,MACC8D,UAAY+c,EAAU/c,UAGjCgf,EAAeC,KAAKC,MAAMH,EAAO,KACjChH,EAAQkH,KAAKC,MAAMF,EAAe,MAClC/G,EAAUgH,KAAKC,MAAOF,EAAe,KAAQ,IAC7CG,EAAUH,EAAe,GAE/B9B,EAAe,GAADlmB,OACP+gB,EAAMiE,WAAWnE,SAAS,EAAG,KAAI,KAAA7gB,OAAIihB,EACnC+D,WACAnE,SAAS,EAAG,KAAI,KAAA7gB,OAAImoB,EAAQnD,WAAWnE,SAAS,EAAG,MAC3D,GACF,MAGA,KACCuH,GACAE,cAAcF,EAClB,CACH,GACF,CAACvC,EAAYE,IAEhB,MAQMwC,EAAsB9kB,UACxB,GAAKsjB,EAKL,IACI,MAAMS,EAAQrV,aAAaC,QAAQ,SACnC,IAAKoV,EAGD,OAFAhoB,QAAQ0D,MAAM,8CACdslB,MAAM/mB,EAAE,6CAKZ,MAiBMlC,SAjBiBI,EAAAA,EAAcC,KACjCS,EAAAA,GAAconB,SAASgB,MACvB,CACI9b,SAAUoa,EAIVhB,UAAW,IAAI7gB,MAAK,IAAIA,MAAO8D,UAA6C,KAAjC,IAAI9D,MAAOwjB,sBAE1D,CACI3S,QAAS,CACL,cAAgB,UAAD/V,OAAYwnB,GAC3B,eAAgB,uBAKNjoB,KAIhBqoB,EAAiBroB,EAAKwmB,UAAU8B,SAAS,KACzCtoB,EAAKwmB,UAAUna,UAAU,EAAGrM,EAAKwmB,UAAU3gB,OAAS,GACpD7F,EAAKwmB,UAEL+B,EAAgB,IAAI5iB,KAAK0iB,GAI/BxB,EAAkB7mB,GAClBymB,EAAa8B,GACb5B,EAAe,YACfJ,GAAc,GAGdc,GAAqB,EACzB,CAAE,MAAO1jB,GACL1D,QAAQ0D,MAAM,UAAWA,GAGzB,IAAIiD,EAAe1E,EAAE,+BACA,IAADkX,EAApB,GAAIzV,EAAMxD,SACNyG,GAAkC,QAAnBwS,EAAAzV,EAAMxD,SAASH,YAAI,IAAAoZ,OAAA,EAAnBA,EAAqB3S,UAAO,mBAAAhG,OAAuBkD,EAAMxD,SAASmK,OAAM,KAG3F2e,MAAMriB,EACV,MA3DIqiB,MAAM/mB,EAAE,iCA2DZ,EAGEknB,EAAqBllB,UACvB,IACI,MAAM+jB,EAAQrV,aAAaC,QAAQ,SACnC,IAAKoV,EAGD,OAFAhoB,QAAQ0D,MAAM,8CACdslB,MAAM/mB,EAAE,mDAKW9B,EAAAA,EAAcC,KACjCS,EAAAA,GAAconB,SAASmB,KACvB,CAEIC,QAAS,IAAI3jB,MAAK,IAAIA,MAAO8D,UAA6C,KAAjC,IAAI9D,MAAOwjB,sBAExD,CACI3S,QAAS,CACL,cAAgB,UAAD/V,OAAYwnB,GAC3B,eAAgB,sBAM5B1B,GAAc,GACdM,EAAkB,MAClBJ,EAAa,MACbE,EAAe,YAGfU,GAAqB,EACzB,CAAE,MAAO1jB,GACL1D,QAAQ0D,MAAM,UAAWA,GAGzB,IAAIiD,EAAe1E,EAAE,8BACA,IAADqnB,EAApB,GAAI5lB,EAAMxD,SACNyG,GAAkC,QAAnB2iB,EAAA5lB,EAAMxD,SAASH,YAAI,IAAAupB,OAAA,EAAnBA,EAAqB9iB,UAAO,mBAAAhG,OAAuBkD,EAAMxD,SAASmK,OAAM,KAG3F2e,MAAMriB,EACV,GAYE4iB,GAAa1B,EAAAA,EAAAA,UAAQ,KAAO,IAAD2B,EAC7B,OAAK7C,GACsD,QAApD6C,EAAA/b,EAAS/I,MAAK6E,GAAKA,EAAEjJ,KAAOqmB,EAAexZ,kBAAS,IAAAqc,OAAA,EAApDA,EAAsDnZ,OAAQpO,EAAE,4BAD3C,IACsE,GACnG,CAACwL,EAAUkZ,IA4Ed,OAAIE,GAEI5hB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4FAA2FC,UACtGC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wCAAuCC,UAClDC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2FAO3BH,EAAAA,EAAAA,MAAA,OAAKG,UAAU,+FAA8FC,SAAA,EACzGC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,yCAAwCC,UACnDJ,EAAAA,EAAAA,MAAA,MAAIG,UAAU,0DAAyDC,SAAA,EACnEC,EAAAA,EAAAA,KAAC2E,EAAAA,EAAS,CAAC7E,UAAU,iBACpB9C,EAAE,+BAIVglB,IACGriB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,8JAA6JC,SAAA,EACxKC,EAAAA,EAAAA,KAAA,QAAAD,SAAOiiB,IACNA,IAAgBhlB,EAAE,uCACf2C,EAAAA,EAAAA,MAAA,UACIS,QA5FApB,UACpB,GAAKmN,OAAOwS,QAAQ3hB,EAAE,sCAItB,IACI,MAAM+lB,EAAQrV,aAAaC,QAAQ,SACnC,IAAKoV,EAGD,OAFAhoB,QAAQ0D,MAAM,8CACdslB,MAAM/mB,EAAE,mDAKW9B,EAAAA,EAAcC,KACjCS,EAAAA,GAAconB,SAASmB,KACvB,CAEIC,QAAS,IAAI3jB,MAAK,IAAIA,MAAO8D,UAA6C,KAAjC,IAAI9D,MAAOwjB,qBACpDO,OAAO,GAEX,CACIlT,QAAS,CACL,cAAgB,UAAD/V,OAAYwnB,GAC3B,eAAgB,sBAK5B1B,GAAc,GACdE,EAAa,MACbE,EAAe,YACfE,EAAkB,MAClBM,EAAe,MACf8B,MAAM/mB,EAAE,sCAGRmlB,GAAqB,EACzB,CAAE,MAAO1jB,GAAQ,IAADwV,EACZlZ,QAAQ0D,MAAM,UAAWA,GACzBwjB,EAAe,wBAAD1mB,QAAuC,QAAd0Y,EAAAxV,EAAMxD,gBAAQ,IAAAgZ,OAAA,EAAdA,EAAgB7O,SAAU,mBACjE2e,MAAM/mB,EAAE,mCACZ,GAmDoB8C,UAAU,gIAA+HC,SAAA,CAExI/C,EAAE,yBAAyB,IAAEA,EAAE,eAAgB,mBAO/DokB,GAAcuB,IACXhjB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,+JAA8JC,SAAA,EACzKC,EAAAA,EAAAA,KAACykB,GAAAA,EAAuB,CAAC3kB,UAAU,uCACnCH,EAAAA,EAAAA,MAAA,OAAKG,UAAU,SAAQC,SAAA,EACnBC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,cAAaC,SAAE/C,EAAE,sDAAuD,mCACrFgD,EAAAA,EAAAA,KAAA,KAAGF,UAAU,eAAcC,SACtB/C,EAAE,wDAAyD,kKAO5E2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,uCAAsCC,SAAA,EACjDJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,6BAA4BC,SAAA,EACvCJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,mDAAkDC,SAAA,EAC/DC,EAAAA,EAAAA,KAAA,SACImC,KAAK,WACLrC,UAAU,eACVuL,QAAS+V,EACTxf,SAnQK5C,UACrBoiB,QACM8C,UAEAJ,GACV,EA+PoB/hB,UAAWugB,IAAmBlB,EAC9B,kBAAiBA,EAAa,gBAAkB,oBAEpDphB,EAAAA,EAAAA,KAAA,OAAKF,UAAS,wDAAAvE,OACR6lB,EACI,mEACA,+BAA8B,gtBAW5CphB,EAAAA,EAAAA,KAAA,QAAMF,UAAU,2BAA0BC,SACrCqhB,GACKphB,EAAAA,EAAAA,KAAA,QAAMF,UAAU,+CAA8CC,SAAE/C,EAAE,+BAClEgD,EAAAA,EAAAA,KAAA,QAAMF,UAAU,mCAAkCC,SAAE/C,EAAE,kCAMpEgD,EAAAA,EAAAA,KAAA,UACII,QA1KUskB,KACtB3C,GAAqB,EAAK,EA0KdjiB,UAAU,uNACVmC,MAAOjF,EAAE,8BAA8B+C,UAEvCC,EAAAA,EAAAA,KAAC2kB,GAAAA,EAAc,CAAC7kB,UAAU,kBAKlCE,EAAAA,EAAAA,KAAA,OAAKF,UAAS,+BAAAvE,OAAiC6lB,GAAcM,EAAiB,uDAAyD,kDAAmD3hB,SACrLqhB,GAAcM,GACX/hB,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,EACIJ,EAAAA,EAAAA,MAAA,KAAAI,SAAA,EAAGC,EAAAA,EAAAA,KAAA,UAAAD,SAAS/C,EAAE,qCAA4C,IAAEwkB,MAC5D7hB,EAAAA,EAAAA,MAAA,KAAAI,SAAA,EAAGC,EAAAA,EAAAA,KAAA,UAAAD,SAAS/C,EAAE,8BAAqC,IArH9CkG,KAEK,kBAAfA,GAA2BA,EAAWkgB,SAAS,OACtDlgB,EAAaA,EAAWiE,UAAU,EAAGjE,EAAWvC,OAAS,IAG7D,MAAMuM,EAAO,IAAIzM,KAAKyC,GAGhBmZ,EAAMnP,EAAKE,UAAUmT,WAAWnE,SAAS,EAAG,KAC5CF,GAAShP,EAAKiP,WAAa,GAAGoE,WAAWnE,SAAS,EAAG,KACrDJ,EAAO9O,EAAK+O,cAGZK,EAAQpP,EAAKqP,WAAWgE,WAAWnE,SAAS,EAAG,KAC/CI,EAAUtP,EAAKuP,aAAa8D,WAAWnE,SAAS,EAAG,KACnDsH,EAAUxW,EAAK0X,aAAarE,WAAWnE,SAAS,EAAG,KAGzD,MAAM,GAAN7gB,OAAU8gB,EAAG,KAAA9gB,OAAI2gB,EAAK,KAAA3gB,OAAIygB,EAAI,MAAAzgB,OAAK+gB,EAAK,KAAA/gB,OAAIihB,EAAO,KAAAjhB,OAAImoB,EAAO,EAkGOmB,CAAgBvD,GAAa7gB,KAAKqkB,WACvFnlB,EAAAA,EAAAA,MAAA,KAAAI,SAAA,EAAGJ,EAAAA,EAAAA,MAAA,UAAAI,SAAA,CAAS/C,EAAE,sCAAsC,OAAU,IAAEsnB,GAActnB,EAAE,mCAGpF2C,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,EACIC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,UACHC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,UACHC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,cAMd+hB,IACG9hB,EAAAA,EAAAA,KAAC+kB,GAAAA,EAAa,CAACpoB,OAAQmlB,EAAmBllB,QAjM3BooB,KACvBjD,GAAqB,EAAM,MAkMrB,E,+GCzad,MAAMkD,GAAqB,CAAC,QAAS,+BAAgC,SAAU,UAAW,SAAU,WAG9FC,GAAiB,oBAGjBC,GAAwB,2BAMxBC,GAA4D,CAChEnjB,MAAO,MACPmD,OAAQ,MACRsL,YAAa,MACbD,eAAgB,MAChBhF,OAAQ,MACRrD,QAAS,MACTZ,YAAa,OAIT6d,GAAuE,CAC3E3K,UAAW,MACXtV,OAAQ,MACRkgB,cAAe,MACfhH,YAAa,OACbC,aAAc,OACdyC,WAAY,MACZvV,OAAQ,MACRmU,WAAY,MACZF,WAAY,MACZ7E,OAAQ,OACR0K,YAAa,QAKTC,GAA+C,CACnD,MAAS,CAAC,SACV,OAAU,CAAC,UACX,6BAAgC,CAAC,cAAe,kBAChD,OAAU,CAAC,UACX,QAAW,CAAC,WACZ,QAAW,GACX,YAAe,CAAC,gBAIZC,GAA6C,CACjD,MAAS,QACT,OAAU,SACV,YAAe,+BACf,eAAkB,+BAClB,OAAU,SACV,QAAW,UACX,YAAe,eA8BXC,GAA0D,CAC9D,UAAa,CAAC,aACd,OAAU,CAAC,UACX,cAAiB,CAAC,iBAClB,YAAe,CAAC,eAChB,aAAgB,CAAC,gBACjB,WAAc,CAAC,cACf,OAAU,CAAC,UACX,WAAc,CAAC,cACf,WAAc,CAAC,cACf,OAAU,CAAC,UACX,YAAe,CAAC,eAChB,QAAW,IAIPC,GAAwD,CAC5D,UAAa,YACb,OAAU,SACV,cAAiB,gBACjB,YAAe,cACf,aAAgB,eAChB,WAAc,aACd,OAAU,SACV,WAAc,aACd,WAAc,aACd,OAAU,SACV,YAAe,eAulJjB,GA/gJ8BC,KAC1B,MAAM,EAAE5oB,IAAMC,EAAAA,EAAAA,OACR,KAAEC,IAASC,EAAAA,EAAAA,OACX,cAAEyY,EAAa,YAAEiQ,IAAgBhQ,EAAAA,EAAAA,KACjCiQ,GAAWC,EAAAA,EAAAA,MACXC,GAAWC,EAAAA,EAAAA,OACX,YAAE7oB,IAAgBC,EAAAA,EAAAA,KAGlB6oB,GAAmBtD,EAAAA,EAAAA,UAAQ,IAAM,CACnC,CAAEvnB,GAAI,QAAS8qB,MAAOnpB,EAAE,uBAAwBopB,WAAYppB,EAAE,wBAC9D,CAAE3B,GAAI,SAAU8qB,MAAOnpB,EAAE,wBAAyBopB,WAAYppB,EAAE,yBAChE,CAAE3B,GAAI,+BAAgC8qB,MAAOnpB,EAAE,8CAA+CopB,WAAYppB,EAAE,8CAA8CsQ,MAAM,KAAK,IACrK,CAAEjS,GAAI,SAAU8qB,MAAOnpB,EAAE,wBAAyBopB,WAAYppB,EAAE,wBAAwBmK,UAAU,EAAG,IACrG,CAAE9L,GAAI,UAAW8qB,MAAOnpB,EAAE,yBAA0BopB,WAAYppB,EAAE,yBAAyBmK,UAAU,EAAG,IACxG,CAAE9L,GAAI,UAAW8qB,MAAOnpB,EAAE,yBAA0BopB,WAAYppB,EAAE,kBAAkBmK,UAAU,EAAG,MAClG,CAACnK,IAGEqpB,GAAoBzD,EAAAA,EAAAA,UAAQ,IAAM,CACpC,CAAEvnB,GAAI,cAAe8qB,MAAOnpB,EAAE,6BAA8BopB,WAAYppB,EAAE,6BAA6BmK,UAAU,EAAG,IACpH,CAAE9L,GAAI,iBAAkB8qB,MAAOnpB,EAAE,gCAAiCopB,WAAYppB,EAAE,gCAAgCmK,UAAU,EAAG,MAC9H,CAACnK,IAGEspB,GAA8B1D,EAAAA,EAAAA,UAAQ,IAAM,CAC9C,CAAEvnB,GAAI,YAAa8qB,MAAOnpB,EAAE,iCAAkC,QAASopB,WAAYppB,EAAE,iCAAkC,QAAQmK,UAAU,EAAG,IAC5I,CAAE9L,GAAI,SAAU8qB,MAAOnpB,EAAE,8BAA+B,UAAWopB,WAAYppB,EAAE,8BAA+B,UAAUmK,UAAU,EAAG,IACvI,CAAE9L,GAAI,gBAAiB8qB,MAAOnpB,EAAE,qCAAsC,kBAAmBopB,WAAYppB,EAAE,qCAAsC,kBAAkBmK,UAAU,EAAG,IAC5K,CAAE9L,GAAI,cAAe8qB,MAAOnpB,EAAE,mCAAoC,YAAaopB,WAAYppB,EAAE,mCAAoC,YAAYmK,UAAU,EAAG,IAC1J,CAAE9L,GAAI,eAAgB8qB,MAAOnpB,EAAE,oCAAqC,aAAcopB,WAAYppB,EAAE,oCAAqC,aAAamK,UAAU,EAAG,IAC/J,CAAE9L,GAAI,aAAc8qB,MAAOnpB,EAAE,kCAAmC,UAAWopB,WAAYppB,EAAE,kCAAmC,UAAUmK,UAAU,EAAG,IACnJ,CAAE9L,GAAI,SAAU8qB,MAAOnpB,EAAE,8BAA+B,iBAAkBopB,WAAYppB,EAAE,8BAA+B,iBAAiBmK,UAAU,EAAG,IACrJ,CAAE9L,GAAI,aAAc8qB,MAAOnpB,EAAE,kCAAmC,UAAWopB,WAAYppB,EAAE,kCAAmC,UAAUmK,UAAU,EAAG,IACnJ,CAAE9L,GAAI,aAAc8qB,MAAOnpB,EAAE,kCAAmC,WAAYopB,WAAYppB,EAAE,kCAAmC,WAAWmK,UAAU,EAAG,IACrJ,CAAE9L,GAAI,SAAU8qB,MAAOnpB,EAAE,8BAA+B,UAAWopB,WAAYppB,EAAE,8BAA+B,UAAUmK,UAAU,EAAG,IACvI,CAAE9L,GAAI,cAAe8qB,MAAOnpB,EAAE,mCAAoC,gBAAiBopB,WAAYppB,EAAE,mCAAoC,gBAAgBmK,UAAU,EAAG,IAClK,CAAE9L,GAAI,UAAW8qB,MAAOnpB,EAAE,+BAAgC,YAAaopB,WAAYppB,EAAE,kBAAkBmK,UAAU,EAAG,MACrH,CAACnK,IAGEupB,GAA+B3D,EAAAA,EAAAA,UAAQ,IAAM,CAC/C,CAAEvnB,GAAI,yBAA0B8qB,MAAOnpB,EAAE,8CAA+C,mBAAoBopB,WAAYppB,EAAE,8CAA+C,mBAAmBmK,UAAU,EAAG,IACzM,CAAE9L,GAAI,UAAW8qB,MAAOnpB,EAAE,+BAAgC,cAAYopB,WAAYppB,EAAE,+BAAgC,cAAWmK,UAAU,EAAG,MAC7I,CAACnK,KASGqM,EAAWC,IAAgB9L,EAAAA,EAAAA,UAAoD,UAE/EgpB,EAAOC,KAAYjpB,EAAAA,EAAAA,UAAiB,KACpCkpB,GAAiBC,KAAsBnpB,EAAAA,EAAAA,UAAiB,IACxDopB,GAAcC,KAAmBrpB,EAAAA,EAAAA,WAAkB,IACnDspB,GAAkBC,KAAuBvpB,EAAAA,EAAAA,WAAkB,IAC3DmB,GAASC,KAAcpB,EAAAA,EAAAA,WAAS,IAChCiB,GAAOC,KAAYlB,EAAAA,EAAAA,UAAwB,OAC3CwpB,GAAsBC,KAA2BzpB,EAAAA,EAAAA,WAAkB,IAEnE0pB,GAAYC,MAData,EAAAA,EAAAA,SAAgB,IACZrP,EAAAA,EAAAA,UAAS,MACtC4pB,GAAcC,KAAmB7pB,EAAAA,EAAAA,UAAiC,QAGlEmf,GAAcC,KAAmBpf,EAAAA,EAAAA,UAAwB,KACzD8pB,GAAwBC,KAA6B/pB,EAAAA,EAAAA,UAAiB,IACtEgqB,GAAqBC,KAA0BjqB,EAAAA,EAAAA,WAAkB,IACjEkqB,GAAyBC,KAA8BnqB,EAAAA,EAAAA,WAAkB,IACzEoqB,GAAqBC,KAA0BrqB,EAAAA,EAAAA,WAAS,IACxDsqB,GAAmBC,KAAwBvqB,EAAAA,EAAAA,UAAwB,OACnEwqB,GAAiCC,KAAsCzqB,EAAAA,EAAAA,WAAkB,IAEzF0qB,GAAuBC,MADatb,EAAAA,EAAAA,SAAgB,IACDrP,EAAAA,EAAAA,UAAS,MAC5D4qB,GAAyBC,KAA8B7qB,EAAAA,EAAAA,UAAoC,QAC3F8qB,GAAgCC,KAAqC/qB,EAAAA,EAAAA,UAAgC,QAErGgrB,GAA8BC,KAAmCjrB,EAAAA,EAAAA,WAAS,IAC1EkrB,GAAqBC,KAA0BnrB,EAAAA,EAAAA,WAAS,IACxDorB,GAA6BC,KAAkCrrB,EAAAA,EAAAA,UAAwB,OACvFsrB,GAAkCC,KAAuCvrB,EAAAA,EAAAA,UAA6B,OACtGwrB,GAA8BC,KAAmCzrB,EAAAA,EAAAA,WAAS,IAC1E0rB,GAAgCC,KAAqC3rB,EAAAA,EAAAA,UAA6B,OAClG4rB,GAA4BC,KAAiC7rB,EAAAA,EAAAA,WAAS,IAGtE8rB,GAAcC,KAAmB/rB,EAAAA,EAAAA,UAAwB,KACzDgsB,GAAwBC,KAA6BjsB,EAAAA,EAAAA,UAAiB,IACtEksB,GAAqBC,KAA0BnsB,EAAAA,EAAAA,WAAkB,IACjEosB,GAAyBC,KAA8BrsB,EAAAA,EAAAA,WAAkB,IACzEssB,GAAqBC,KAA0BvsB,EAAAA,EAAAA,WAAS,IACxDwsB,GAAmBC,KAAwBzsB,EAAAA,EAAAA,UAAwB,OACnE0sB,GAAwBC,KAA6B3sB,EAAAA,EAAAA,UAAS,KAC9D4sB,GAAwBC,KAA6B7sB,EAAAA,EAAAA,UAA6B,OAClF8sB,GAAgCC,KAAqC/sB,EAAAA,EAAAA,WAAS,IAC9EgtB,GAA8BC,KAAmCjtB,EAAAA,EAAAA,WAAS,IAC1EktB,GAA4BC,KAAiCntB,EAAAA,EAAAA,WAAS,IACtEotB,GAAwBC,KAA6BrtB,EAAAA,EAAAA,UAA6B,OAGlFstB,GAA6BC,KAAkCvtB,EAAAA,EAAAA,UAA4B,KAC3FwtB,GAAmCC,KAAwCztB,EAAAA,EAAAA,UAA2B,KACtG0tB,GAAiCC,KAAsC3tB,EAAAA,EAAAA,UAAyG,KAChL4tB,GAA6BC,KAAkC7tB,EAAAA,EAAAA,UAAiB,KAChF8tB,GAA6BC,KAAkC/tB,EAAAA,EAAAA,UAAwB,OAGvFguB,GAAkBC,KAAuBjuB,EAAAA,EAAAA,UAA4B,KACrEkuB,GAAwBC,KAA6BnuB,EAAAA,EAAAA,UAA2B,KAChFouB,GAAsBC,KAA2BruB,EAAAA,EAAAA,UAAyG,KAG1JsuB,GAAkBC,KAAuBvuB,EAAAA,EAAAA,UAAiB,KAC1DwuB,GAAkBC,KAAuBzuB,EAAAA,EAAAA,UAAwB,OAEjE0uB,GAAmBC,KAAwB3uB,EAAAA,EAAAA,WAAS,IAEpD4uB,GAAiBC,KAAsB7uB,EAAAA,EAAAA,UAAqB,CAAEsV,IAAK,UAAW5N,UAAW,SAEzFonB,GAA4BC,KAAiC/uB,EAAAA,EAAAA,UAAgC,CAAEsV,IAAK,cAAe5N,UAAW,UAC9HsnB,GAAmBC,KAAwBjvB,EAAAA,EAAAA,WAAS,IACpDkvB,GAAiBC,KAAsBnvB,EAAAA,EAAAA,WAAS,IAChDovB,GAAcC,KAAmBrvB,EAAAA,EAAAA,UAAsB,OACvDsvB,GAAYC,KAAiBvvB,EAAAA,EAAAA,UAAsB,OAG1DuB,EAAAA,EAAAA,YAAU,IACC,KAEH0nB,GAAS,IAGT7J,GAAgB,IAGhB2M,GAAgB,IAGhBkC,GAAoB,IACpBV,GAA+B,GAAG,GAEvC,IAOH,MACIiC,SAAUC,GACVrL,UAAWsL,GACXC,kBAAmBC,GACnBC,oBAAqBC,GACrBC,uBAAwBC,GACxBC,gBAAiBC,GACjBC,eAAgBC,KAChBC,EAAAA,EAAAA,GAAiB,oBAAqB,CACtC5I,sBACA6I,qBAAsB,GACtBC,gBAAiB,UAIfC,GAAgC,CAAC,YAAa,SAAU,gBAAiB,cAAe,eAAgB,aAAc,SAAU,YAElIhB,SAAUiB,GACVrM,UAAWsM,GACXf,kBAAmBgB,GACnBd,oBAAqBe,GACrBb,uBAAwBc,GACxBZ,gBAAiBa,GACjBX,eAAgBY,KAChBV,EAAAA,EAAAA,GAAiB,2BAA4B,CAC7C5I,mBAAoB+I,GACpBF,qBAAsB,GACtBC,gBAAiB,UAIff,GAAyB,UAAd3jB,EAAwB4jB,GAAgBgB,GAEnDd,GAAkC,UAAd9jB,EAAwB+jB,GAAyBe,GAErEZ,GAAuC,UAAdlkB,EAAwBmkB,GAA8Ba,GAC/EZ,GAAgC,UAAdpkB,EAAwBqkB,GAAuBY,GACjEX,GAA+B,UAAdtkB,EAAwBukB,GAAsBW,IAE9DC,GAAeC,KAAoBjxB,EAAAA,EAAAA,UAAwB,OAC3DkxB,GAAgBC,KAAqBnxB,EAAAA,EAAAA,UAAwB,OAG7DoxB,GAAyBC,KAA8BrxB,EAAAA,EAAAA,UAAsB,IAAIsxB,KAGlFC,GAAW/B,GAAS+B,UAAY,SAItChwB,EAAAA,EAAAA,YAAU,KACW4a,SAASqV,iBAAiB,4BAClCpc,SAAQqc,IACI,UAAbF,GACAE,EAAQC,UAAUC,IAAI,cAEtBF,EAAQC,UAAUlV,OAAO,aAC7B,GACF,GACH,CAAC+U,KAIJ,MAAMK,IAAoBxM,EAAAA,EAAAA,UAAQ,IACZ,UAAdvZ,EAzU4BgmB,KACtC,MAAMC,EAAyB,GAW/B,OAVAD,EAAYzc,SAAQ2c,IAClB,MAAMC,EAAWhK,GAAmB+J,GAChCC,GAAYA,EAAS7uB,OAAS,GAChC2uB,EAAaxX,QAAQ0X,EACvB,IAGGF,EAAahpB,SAAS,gBACzBgpB,EAAaxX,KAAK,eAEbwX,CAAY,EA8TFG,CAA+BzC,GAASqC,aAAepK,IAlOvBoK,KACjD,MAAMC,EAAyB,GAO/B,OANAD,EAAYzc,SAAQ2c,IAClB,MAAMC,EAAW9J,GAA8B6J,GAC3CC,GAAYA,EAAS7uB,OAAS,GAChC2uB,EAAaxX,QAAQ0X,EACvB,IAEKF,CAAY,EA4NFI,CAA0C1C,GAASqC,aAAerB,KAE9E,CAAChB,GAASqC,YAAahmB,IAGpBsmB,IAAqB/M,EAAAA,EAAAA,UAAQ,IACb,UAAdvZ,EA5VmBumB,KAC7B,MAAMD,EAAqB,IAAIb,IAK/B,OAJAc,EAAmBhd,SAAQ2c,KACJ/J,GAAmB+J,IAAa,IACxC3c,SAAQ4c,GAAYG,EAAmBR,IAAIK,IAAU,IAE7DG,CAAkB,EAuVRE,CAAsB7C,GAAS8C,eAAiB,IArPzBF,KACxC,MAAMD,EAAqB,IAAIb,IAK/B,OAJAc,EAAmBhd,SAAQ2c,KACJ7J,GAA8B6J,IAAa,IACnD3c,SAAQ4c,GAAYG,EAAmBR,IAAIK,IAAU,IAE7DG,CAAkB,EAiPRI,CAAiC/C,GAAS8C,eAAiB,KAEvE,CAAC9C,GAAS8C,cAAezmB,IAGtB2mB,IAAsBpN,EAAAA,EAAAA,UAAQ,IACzB,IAAIkM,IAAIM,GAAkBptB,QAAOiuB,IAASN,GAAmBO,IAAID,OACzE,CAACb,GAAmBO,MAGhBQ,GAAwBC,KAA6B5yB,EAAAA,EAAAA,WAAyC,IAC1F4nB,KAILiL,GAAoCA,CAACC,EAAkBprB,KACzDkrB,IAA0BlhB,IAAIsG,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACvBtG,GAAI,IACP,CAACohB,GAAWprB,KACb,GAIAqrB,GAA+BC,KAAoChzB,EAAAA,EAAAA,WAAyC,IACxG6nB,KAILoL,GAA2CA,CAACH,EAAkBprB,KAChEsrB,IAAiCthB,IAAIsG,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAC9BtG,GAAI,IACP,CAACohB,GAAWprB,KACb,EAKDwrB,GAA6BpuB,IAC/BusB,IAA2B3f,IACvB,MAAMyhB,EAAS,IAAI7B,IAAI5f,GAMvB,OALIyhB,EAAOT,IAAI5tB,GACXquB,EAAO9Z,OAAOvU,GAEdquB,EAAOxB,IAAI7sB,GAERquB,CAAM,GACf,EAQAC,KAHe/jB,EAAAA,EAAAA,SAAO,IAGViW,EAAAA,EAAAA,cAAY9jB,eAC1B6xB,EACArF,GAIE,IAHFra,EAAM2f,UAAAnwB,OAAA,QAAAyB,IAAA0uB,UAAA,IAAAA,UAAA,GACNC,EAAKD,UAAAnwB,OAAA,QAAAyB,IAAA0uB,UAAA,GAAAA,UAAA,GAAG,GACRE,EAAMF,UAAAnwB,OAAA,QAAAyB,IAAA0uB,UAAA,GAAAA,UAAA,GAAG,EAET,IACS3f,EAGD4V,IAAoB,GAFpBnoB,IAAW,GAMf,MAAMQ,EAAc,CAChB2xB,MAAOA,EACPC,OAAQA,EACRC,mBAAoB,SAEpBJ,EACAzxB,EAAOyxB,SAAWA,EACXrF,GAAoBA,EAAiB7qB,OAAS,IACrDvB,EAAOosB,iBAAmB9Y,KAAKU,UAAU,CACrC8d,WAAY1F,EACZ2F,UAAWzF,MAInB,MACM0F,SADiBl2B,EAAAA,EAAcI,IAAIM,EAAAA,GAAcgV,MAAMzR,KAAM,CAAEC,YACvCtE,KAG9BC,QAAQC,IAAI,yCAA0C,CAClDq2B,SAAkC,kBAAjBD,EACjBE,aAAgClvB,KAAX,OAAZgvB,QAAY,IAAZA,OAAY,EAAZA,EAAct2B,MACvBy2B,YAAaj1B,MAAMC,QAAoB,OAAZ60B,QAAY,IAAZA,OAAY,EAAZA,EAAct2B,MACzC02B,oBAAqBl1B,MAAMC,QAAQ60B,GACnCpe,KAAMoe,EAAere,OAAOC,KAAKoe,GAAgB,GACjDK,SAAsB,OAAZL,QAAY,IAAZA,GAAAA,EAAct2B,YAAcs2B,EAAat2B,KAAO,cAK9D,IAAI42B,EAAoB,GACpBC,EAAa,EACbC,GAAU,EAEd,IAAIR,GAAwC,kBAAjBA,EA4BvB,MAJAr2B,QAAQ0D,MAAM,mEAA+D,CACzE2yB,eACAjvB,YAAaivB,IAEX,IAAI9vB,MAAM,sEAAD/F,cAA2E61B,EAAY,MA1BtG,GAAI90B,MAAMC,QAAQ60B,EAAat2B,MAC3B42B,EAAYN,EAAat2B,KACzB62B,EAAaP,EAAaO,YAAcD,EAAU/wB,OAClDixB,OAAmCxvB,IAAzBgvB,EAAaQ,QACjBR,EAAaQ,QACZZ,EAASU,EAAU/wB,OAASgxB,MAChC,KAAIr1B,MAAMC,QAAQ60B,GAYrB,MALAr2B,QAAQ0D,MAAM,uEAAmE,CAC7E2yB,eACAt2B,KAAMs2B,EAAat2B,KACnB22B,gBAAiBL,EAAat2B,OAE5B,IAAIwG,MAAM,0EAAD/F,cAA+E61B,EAAat2B,KAAI,MAV/G42B,EAAYN,EACZO,EAAaD,EAAU/wB,OACvBixB,GAAU,CASd,CAWJ,IAAKt1B,MAAMC,QAAQm1B,GAKf,MAJA32B,QAAQ0D,MAAM,+DAA2D,CACrEizB,YACAvvB,YAAauvB,IAEX,IAAIpwB,MAAM,kEAAD/F,cAAuEm2B,EAAS,MAKnG,MAAMG,EAAuBH,EACxB1vB,QAAQqQ,GAAuB,MAARA,IACvBnQ,KAAKmQ,IACF,MAAM4D,GAAe5D,EAAK4D,aAAe,IACpCjU,QAAQyV,GAAoB,MAAPA,IACrBvV,KAAKuV,IAAQ,CACVpc,GAAIoc,EAAIpc,GACRuP,SAAU6M,EAAI7M,SACdC,SAAU4M,EAAI5M,SACdmE,SAAUyI,EAAIzI,SACdoJ,SAAUX,EAAIW,SACdC,WAAYZ,EAAIY,WAChBC,KAAKlB,EAAAA,EAAAA,IAAqB/E,EAAKhX,GAAIoc,EAAIpc,QAG/C,OAAAma,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACOnD,GAAI,IACP4D,YAAaA,GAAW,IAMhCwQ,GAFAtV,EAESjC,GAAQ,IAAIA,KAAS2iB,GAGrBA,GAGblL,GAAmBgL,GACnB9K,GAAgB+K,GAChBlzB,GAAS,KACb,CAAE,MAAOD,IACL1D,QAAQ0D,MAAM,yCAA0CA,IACxD,MAAMgI,EAAahI,GACnB,IAAK0S,EAAQ,CAAC,IAAD5K,EAAAC,EAAAwH,EAAAC,EAAAE,EAAAC,EAET,MAAM1M,GAAkC,QAAnB6E,EAAAE,EAAWxL,gBAAQ,IAAAsL,GAAM,QAANC,EAAnBD,EAAqBzL,YAAI,IAAA0L,OAAN,EAAnBA,EAA2BjF,WACtB,QAD6ByM,EAChDvH,EAAWxL,gBAAQ,IAAA+S,GAAM,QAANC,EAAnBD,EAAqBlT,YAAI,IAAAmT,OAAN,EAAnBA,EAA2BxP,QAC3BgI,EAAWlF,SACXvE,EAAE,oCACTjC,QAAQ0D,MAAM,qCAAsC,CAChD8C,QAASG,EACT0D,OAA2B,QAArB+I,EAAE1H,EAAWxL,gBAAQ,IAAAkT,OAAA,EAAnBA,EAAqB/I,OAC7BtK,KAAyB,QAArBsT,EAAE3H,EAAWxL,gBAAQ,IAAAmT,OAAA,EAAnBA,EAAqBtT,OAE/B4D,GAASgD,EACb,CACJ,CAAC,QACQyP,EAGD4V,IAAoB,GAFpBnoB,IAAW,EAInB,CACJ,GAAG,CAAC8sB,GAAwB1uB,KAKtB80B,IAAwBhP,EAAAA,EAAAA,cAAY9jB,MAAOkyB,EAA+BC,EAA6BY,KAGzG,GAFAtG,GAAoByF,GACpBvF,GAA0BwF,QACH/uB,IAAnB2vB,EAA8B,CAE9B,MAAMC,EAAsB11B,MAAMC,QAAQw1B,GAAkBA,EAAiB,GAC7ElG,GAAwBmG,EAC5B,CAGA/F,GAAoB,MACpBF,GAAoB,IACpBM,GAAmB,CAAEvZ,IAAK,UAAW5N,UAAW,QAE5CgsB,EAAWvwB,OAAS,QACdiwB,QAAUxuB,EAAW8uB,GAAY,EAAO,GAAI,SAE5CN,QAAUxuB,OAAWA,GAAW,EAAO,GAAI,EACrD,GACD,CAACwuB,KAIErT,IAAmBuF,EAAAA,EAAAA,cAAY9jB,eACjC6xB,EACArF,GAIE,IAHFra,EAAM2f,UAAAnwB,OAAA,QAAAyB,IAAA0uB,UAAA,IAAAA,UAAA,GACNC,EAAKD,UAAAnwB,OAAA,QAAAyB,IAAA0uB,UAAA,GAAAA,UAAA,GAAG,GACRE,EAAMF,UAAAnwB,OAAA,QAAAyB,IAAA0uB,UAAA,GAAAA,UAAA,GAAG,EAET,IACS3f,EAGDwW,IAA2B,GAF/BE,IAAuB,GAIvBE,GAAqB,MAGrB,MAAM3oB,EAAc,CAChB2xB,MAAOA,EACPC,OAAQA,GAERH,EACAzxB,EAAOyxB,SAAWA,EACXrF,GAAoBA,EAAiB7qB,OAAS,IACrDvB,EAAOosB,iBAAmB9Y,KAAKU,UAAU,CACrC8d,WAAY1F,EACZ2F,UAAWnG,MAInB,MACMoG,SADiBl2B,EAAAA,EAAcI,IAAIM,EAAAA,GAAcC,YAAYsD,KAAM,CAAEC,YAC7CtE,KAI9B,IAAIm3B,EAAkC,GAClCN,EAAa,EACbC,GAAU,EAEVR,GAAwC,kBAAjBA,IAEnBA,EAAa/vB,SAAW/E,MAAMC,QAAQ60B,EAAat2B,OAM5CwB,MAAMC,QAAQ60B,EAAat2B,OALlCm3B,EAAmBb,EAAat2B,KAChC62B,EAAaP,EAAaO,YAAcM,EAAiBtxB,OACzDixB,OAAmCxvB,IAAzBgvB,EAAaQ,QACjBR,EAAaQ,QACZZ,EAASiB,EAAiBtxB,OAASgxB,GAQnCr1B,MAAMC,QAAQ60B,KAErBa,EAAmBb,EACnBO,EAAaM,EAAiBtxB,OAC9BixB,GAAU,IAMdhV,GAFAzL,EAEgBjC,GAAQ,IAAIA,KAAS+iB,GAGzBA,GAGhB1K,GAA0BoK,GAC1BlK,GAAuBmK,EAC3B,CAAE,MAAOryB,GAAW,IAADiC,EAAAC,EACXywB,EAGJ,MAAMxwB,GAA2B,QAAZF,EAAAjC,EAAItE,gBAAQ,IAAAuG,GAAM,QAANC,EAAZD,EAAc1G,YAAI,IAAA2G,OAAN,EAAZA,EAAoBF,UAAWvE,EAAE,yBAA0B,sCAC3EmU,IACL4W,GAAqBrmB,GACrBtE,EAAYsE,EAAc,SAE9B,CAAC,QACQyP,EAGDwW,IAA2B,GAF/BE,IAAuB,EAI3B,CACJ,GAAG,CAACmD,GAAmChuB,IAGjCm1B,IAAmCrP,EAAAA,EAAAA,cAAY9jB,MAAOkyB,EAA+BC,EAA6BY,KAGpH,GAFAhH,GAA+BmG,GAC/BjG,GAAqCkG,QACd/uB,IAAnB2vB,EAA8B,CAC9B,MAAMC,EAAsB11B,MAAMC,QAAQw1B,GAAkBA,EAAiB,GAC7E5G,GAAmC6G,EACvC,CAGAzG,GAA+B,MAC/BF,GAA+B,IAC/BkB,GAA8B,CAAEzZ,IAAK,cAAe5N,UAAW,SAE3DgsB,EAAWvwB,OAAS,QACd4c,QAAiBnb,EAAW8uB,GAAY,EAAO,GAAI,SAEnD3T,QAAiBnb,OAAWA,GAAW,EAAO,GAAI,EAC5D,GACD,CAACmb,KAGE6U,IAAqBtP,EAAAA,EAAAA,cAAY9jB,MAAOoM,EAAc/P,EAAmB61B,EAA+BC,EAA6BY,KACvI,GAAkB,UAAd1oB,EASA,GANA0iB,GAAoB3gB,GACpB6gB,GAAoB5wB,GACpBgxB,GAAmB,CAAEvZ,IAAK,UAAW5N,UAAW,QAI5C7J,EAAI,CAIJ,GAFAowB,GAAoByF,GACpBvF,GAA0BwF,QACH/uB,IAAnB2vB,EAA8B,CAC9B,MAAMC,EAAsB11B,MAAMC,QAAQw1B,GAAkBA,EAAiB,GAC7ElG,GAAwBmG,EAC5B,OACMpB,GAAUv1B,OAAI+G,GAAW,EAAO,GAAI,EAC9C,YAEU0vB,GAAsBZ,EAAYC,EAAWY,QAEpD,GAAkB,iBAAd1oB,EASP,GANAgiB,GAA+BjgB,GAC/BmgB,GAA+BlwB,GAC/BkxB,GAA8B,CAAEzZ,IAAK,cAAe5N,UAAW,SAI3D7J,EAAI,CAIJ,GAFA0vB,GAA+BmG,GAC/BjG,GAAqCkG,QACd/uB,IAAnB2vB,EAA8B,CAC9B,MAAMC,EAAsB11B,MAAMC,QAAQw1B,GAAkBA,EAAiB,GAC7E5G,GAAmC6G,EACvC,OACMzU,GAAiBliB,OAAI+G,GAAW,EAAO,GAAI,EACrD,YAEU+vB,GAAiCjB,EAAYC,EAAWY,EAEtE,GACD,CAAC1oB,EAAWyoB,GAAuBlB,GAAWrT,GAAkB4U,KAG7DE,IAAgCvP,EAAAA,EAAAA,cAAY9jB,MAAOoM,EAAc/P,EAAmB61B,EAA+BC,EAA6BY,KASlJ,GANA1G,GAA+BjgB,GAC/BmgB,GAA+BlwB,GAC/BkxB,GAA8B,CAAEzZ,IAAK,cAAe5N,UAAW,SAI3D7J,EAAI,CAIJ,GAFA0vB,GAA+BmG,GAC/BjG,GAAqCkG,QACd/uB,IAAnB2vB,EAA8B,CAC9B,MAAMC,EAAsB11B,MAAMC,QAAQw1B,GAAkBA,EAAiB,GAC7E5G,GAAmC6G,EACvC,OACMzU,GAAiBliB,OAAI+G,GAAW,EAAO,GAAI,EACrD,YAEU+vB,GAAiCjB,EAAYC,EAAWY,EAClE,GACD,CAACI,GAAkC5U,KA6BhC+U,IAAsBzlB,EAAAA,EAAAA,QAAO2e,KACnCzsB,EAAAA,EAAAA,YAAU,KACNuzB,GAAoBtoB,QAAUwhB,EAAgB,GAC/C,CAACA,KAGJ,MAAM+G,IAAmB1lB,EAAAA,EAAAA,QAAuB,MAC1C2lB,IAA0B3lB,EAAAA,EAAAA,QAAuB,MACjD4lB,IAA0B5lB,EAAAA,EAAAA,QAAuB,MAIjD6lB,GAAmB1zB,iBAInB,IAHFmS,EAAM2f,UAAAnwB,OAAA,QAAAyB,IAAA0uB,UAAA,IAAAA,UAAA,GACNC,EAAKD,UAAAnwB,OAAA,QAAAyB,IAAA0uB,UAAA,GAAAA,UAAA,GAAG,GACRE,EAAMF,UAAAnwB,OAAA,QAAAyB,IAAA0uB,UAAA,GAAAA,UAAA,GAAG,EAET,IACS3f,EAGD0Y,IAA2B,GAF3BE,IAAuB,GAI3BE,GAAqB,MAGrB,MAAM7qB,EAAc,CAChB2xB,MAAOA,EACPC,OAAQA,GAINI,SADiBl2B,EAAAA,EAAcI,IAAIM,EAAAA,GAAcuF,cAAchC,KAAM,CAAEC,YAC/CtE,KAI9B,IAAI63B,EAA8B,GAC9BhB,EAAa,EACbC,GAAU,EAEVR,GAAwC,kBAAjBA,IAEnBA,EAAa/vB,SAAW/E,MAAMC,QAAQ60B,EAAat2B,OAM5CwB,MAAMC,QAAQ60B,EAAat2B,OALlC63B,EAAevB,EAAat2B,KAC5B62B,EAAaP,EAAaO,YAAcgB,EAAahyB,OACrDixB,OAAmCxvB,IAAzBgvB,EAAaQ,QACjBR,EAAaQ,QACZZ,EAAS2B,EAAahyB,OAASgxB,GAQ/Br1B,MAAMC,QAAQ60B,KAErBuB,EAAevB,EACfO,EAAagB,EAAahyB,OAC1BixB,GAAU,IAMdrI,GAFApY,EAEgBjC,GAAQ,IAAIA,KAASyjB,GAGrBA,GAGpBlJ,GAA0BkI,GAC1BhI,GAAuBiI,EAC3B,CAAE,MAAOryB,GAAW,IAADic,EAAAqD,EACXqT,EAGJ,MAAMxwB,GAA2B,QAAZ8Z,EAAAjc,EAAItE,gBAAQ,IAAAugB,GAAM,QAANqD,EAAZrD,EAAc1gB,YAAI,IAAA+jB,OAAN,EAAZA,EAAoBtd,UAAWvE,EAAE,yBAA0B,wCAC3EmU,IACL8Y,GAAqBvoB,GACrBtE,EAAYsE,EAAc,SAE9B,CAAC,QACQyP,EAGD0Y,IAA2B,GAF/BE,IAAuB,EAI3B,CACJ,GAQAhrB,EAAAA,EAAAA,YAAU,KACY,iBAAdsK,GAAgCuM,EAAc,gBAAiB,OAAQ,UACvE8c,IAAiB,EAAO,GAAI,EAChC,GACD,CAACrpB,KAGJtK,EAAAA,EAAAA,YAAU,KACN,GAAIynB,EAAM7lB,OAAS,EAAG,CAClB,MACMiyB,EADc,IAAInS,gBAAgBqF,EAAS+M,QAClBv3B,IAAI,YAEnC,GAAIs3B,EAAY,CACZ,MAAMvhB,EAASzK,SAASgsB,EAAY,IACpC,IAAK/rB,MAAMwK,GAAS,CAChB,MAAMgB,EAAOmU,EAAM/mB,MAAKzC,GAAKA,EAAE3B,KAAOgW,IAClCgB,IACAwa,GAAgBxa,GAChBsa,IAAmB,GAE3B,CACJ,CACJ,IACD,CAACnG,EAAOV,EAAS+M,SAMpB,MAAMC,GAAqB9zB,MAAOqS,EAAgB0hB,KAC9C,IAEItM,IAASuM,GACcA,EAAUhxB,QAAOqQ,GAAgB,MAARA,IAC1BnQ,KAAImQ,GAClBA,EAAKhX,KAAOgW,GAAMmE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQnD,GAAI,IAAEjN,OAAQ2tB,IAAc1gB,YAIxDnX,EAAAA,EAAc+3B,MAAMr3B,EAAAA,GAAcgV,MAAM9J,MAAMuK,GAAS,CAAEjM,OAAQ2tB,IACvEG,GAAAA,GAAM7xB,QAAQrE,EAAE,iCACpB,CAAE,MAAOyB,IAEDyzB,EAGJtB,KACIsC,GAAAA,GAAMz0B,MAAMzB,EAAE,sCACtB,GAQEm2B,GAAwB9gB,IAC1B,OAAIA,EAAK3B,YACE2B,EAAK3B,YAAYrV,MAAW,OAAJ6B,QAAI,IAAJA,OAAI,EAAJA,EAAM7B,IAC9BgX,EAAK7G,OAED,OAAJtO,QAAI,IAAJA,GAAW,QAAPk2B,EAAJl2B,EAAMqL,aAAK,IAAA6qB,OAAP,EAAJA,EAAaC,MAAKC,IAAQ,IAAAC,EAAAC,EAAA,OAAiB,QAAbD,EAAAD,EAAS9nB,YAAI,IAAA+nB,OAAA,EAAbA,EAAel4B,OAAgB,QAAdm4B,EAAKnhB,EAAK7G,YAAI,IAAAgoB,OAAA,EAATA,EAAWn4B,GAAG,OAEtE,EAJgB,IAAD+3B,CAIV,EAGVK,GAA2BphB,IAAgB,IAADoD,EAC5C,OAA0B,QAAnBA,EAAApD,EAAK5B,sBAAc,IAAAgF,OAAA,EAAnBA,EAAqBpa,OAAW,OAAJ6B,QAAI,IAAJA,OAAI,EAAJA,EAAM7B,GAAE,EAGzCq4B,GAAc5gB,IAEC,UAAbic,IACA1C,IAAmBriB,IAAO,CACtB8I,MACA5N,UAAW8E,EAAQ8I,MAAQA,GAA6B,QAAtB9I,EAAQ9E,UAAsB,OAAS,SAEjF,EAGEyuB,GAAyB7gB,IAEV,UAAbic,IAAsC,iBAAd1lB,GACxBkjB,IAA8BviB,IAAO,CACjC8I,MACA5N,UAAW8E,EAAQ8I,MAAQA,GAA6B,QAAtB9I,EAAQ9E,UAAsB,OAAS,SAEjF,EAIE0uB,GAAuBvhB,IACzB,MAAMwhB,EAAyB,GAK/B,OAFuBje,EAAc,QAAS,QAAS,UAKnC,gBAAhBvD,EAAKjN,QAA4B+tB,GAAqB9gB,GACtDwhB,EAAQ/b,MACJnY,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UAEII,QAASA,IAAM0yB,GAAmBzgB,EAAKhX,GAAI,QAC3CyE,UAAU,6FAA4FC,UAEtGC,EAAAA,EAAAA,KAAC8zB,EAAAA,EAAa,CAACh0B,UAAU,aAJrB,SAMRE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,kCAIQ,oBAAhBqV,EAAKjN,QAAgC+tB,GAAqB9gB,GACjEwhB,EAAQ/b,MACJnY,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UAEII,QAASA,IAAM0yB,GAAmBzgB,EAAKhX,GAAI,eAC3CyE,UAAU,6FAA4FC,UAEtGC,EAAAA,EAAAA,KAAC8zB,EAAAA,EAAa,CAACh0B,UAAU,aAJrB,SAMRE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,wCAIQ,SAAhBqV,EAAKjN,QAAqBquB,GAAwBphB,IACzDwhB,EAAQ/b,MACJnY,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UAEII,QAASA,IAAM0yB,GAAmBzgB,EAAKhX,GAAI,mBAC3CyE,UAAU,2FAA0FC,UAEpGC,EAAAA,EAAAA,KAAC8zB,EAAAA,EAAa,CAACh0B,UAAU,aAJrB,SAMRE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,4CAOC,SAAhBqV,EAAKjN,QAAqB+tB,GAAqB9gB,GAC/CwhB,EAAQ/b,MACJnY,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UAEII,QAASA,IAAM0yB,GAAmBzgB,EAAKhX,GAAI,eAC3CyE,UAAU,iGAAgGC,UAE1GC,EAAAA,EAAAA,KAAC+zB,EAAAA,EAAc,CAACj0B,UAAU,aAJtB,YAMRE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,qCAIQ,gBAAhBqV,EAAKjN,QAA4B+tB,GAAqB9gB,GAC7DwhB,EAAQ/b,MACJnY,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UAEII,QAASA,IAAM0yB,GAAmBzgB,EAAKhX,GAAI,mBAC3CyE,UAAU,yGAAwGC,UAElHC,EAAAA,EAAAA,KAAC+zB,EAAAA,EAAc,CAACj0B,UAAU,aAJtB,YAMRE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,yCAIQ,oBAAhBqV,EAAKjN,QAAgCquB,GAAwBphB,IACpEwhB,EAAQ/b,MACJnY,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UAEII,QAASA,IAAM0yB,GAAmBzgB,EAAKhX,GAAI,QAC3CyE,UAAU,qGAAoGC,UAE9GC,EAAAA,EAAAA,KAAC+zB,EAAAA,EAAc,CAACj0B,UAAU,aAJtB,YAMRE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,gCAMZ62B,GAlGqBA,CAkGd,EAGZG,GAAuBA,IACP,UAAd3qB,EACOmiB,GAAiB7qB,OACH,iBAAd0I,EACAyhB,GAA4BnqB,OAEhC,EAGLszB,GAAwBA,KAC1BxI,GAAoB,IACpBE,GAA0B,IAC1BE,GAAwB,IACxBE,GAAoB,IACpBE,GAAoB,KAAK,EAGvBiI,GAAmCA,KACrCnJ,GAA+B,IAC/BE,GAAqC,IACrCE,GAAmC,IACnCE,GAA+B,IAC/BE,GAA+B,KAAK,EAIlC4I,GAAqB/uB,IACvB,OAAQA,GACJ,IAAK,OAAQ,OAAO,EACpB,IAAK,cAAe,OAAO,EAC3B,IAAK,WAAY,OAAO,EACxB,IAAK,kBAAmB,OAAO,EAC/B,IAAK,OAAQ,OAAO,EACpB,QAAS,OAAO,GACpB,EAIEgvB,GAA6BhvB,IAC/B,OAAQA,GACJ,KAAK3K,GAAAA,EAAkB45B,UACnB,MAAO,gEACX,KAAK55B,GAAAA,EAAkB65B,kBACnB,MAAO,wEACX,KAAK75B,GAAAA,EAAkB85B,WACnB,MAAO,oEACX,KAAK95B,GAAAA,EAAkB+5B,YACnB,MAAO,gEACX,KAAK/5B,GAAAA,EAAkBg6B,UACnB,MAAO,4DACX,KAAKh6B,GAAAA,EAAkBi6B,QACnB,MAAO,wEACX,QACI,MAAO,gEACf,EAGEC,GAAyBvvB,IAC3B,OAAQA,GACJ,KAAK1K,GAAAA,EAAck6B,KACf,MAAO,oEACX,KAAKl6B,GAAAA,EAAcm6B,eACf,MAAO,wEACX,KAAKn6B,GAAAA,EAAco6B,SACf,MAAO,wEACX,KAAKp6B,GAAAA,EAAcq6B,QACnB,QACI,MAAO,wEACf,EAGEC,IAAyBpS,EAAAA,EAAAA,UAAQ,KAanC,MACMqS,EATgBzO,EAQWxkB,QAAOqQ,GAAgB,MAARA,IAE3CrQ,QAAOqQ,IAEJ,GAAI6U,GAAY,CACZ,MAAMgO,EAAchO,GAAW/H,cAS/B,KAPI9M,EAAKpQ,MAAMkd,cAAc7Y,SAAS4uB,IACjC7iB,EAAK7K,aAAe6K,EAAK7K,YAAY2X,cAAc7Y,SAAS4uB,MAC5D7iB,EAAK3B,aAAc,GAAAnV,OAAG8W,EAAK3B,YAAYpF,UAAS,KAAA/P,OAAI8W,EAAK3B,YAAYnF,UAAW4T,cAAc7Y,SAAS4uB,MACvG7iB,EAAK7G,MAAO6G,EAAK7G,KAAKJ,KAAK+T,cAAc7Y,SAAS4uB,IAClD7iB,EAAK5B,gBAAkB,GAAAlV,OAAG8W,EAAK5B,eAAenF,UAAS,KAAA/P,OAAI8W,EAAK5B,eAAelF,UAAW4T,cAAc7Y,SAAS4uB,IAClH7iB,EAAK5G,OAAOL,KAAK+T,cAAc7Y,SAAS4uB,IAExB,OAAO,CAC/B,CAMA,OAAO,CAAI,IAQnB,MAAMC,EAAeA,CAAC9iB,EAAYie,KAC9B,OAAQA,GACJ,IAAK,QACD,OAAOje,EAAKpQ,MAAMkd,cACtB,IAAK,SACD,OAAOgV,GAAkB9hB,EAAKjN,QAClC,IAAK,cACL,IAAK,+BACD,OAAOiN,EAAK3B,YAAc,GAAAnV,OAAG8W,EAAK3B,YAAYpF,UAAS,KAAA/P,OAAI8W,EAAK3B,YAAYnF,UAAW4T,cAAiB9M,EAAK7G,KAAO,UAAAjQ,OAAU8W,EAAK7G,KAAKJ,MAAO+T,cAAgB,GACnK,IAAK,iBACD,OAAO9M,EAAK5B,eAAiB,GAAAlV,OAAG8W,EAAK5B,eAAenF,UAAS,KAAA/P,OAAI8W,EAAK5B,eAAelF,UAAW4T,cAAgB,GACpH,IAAK,SACD,OAAO9M,EAAK5G,OAAOL,KAAK+T,cAC5B,IAAK,UACD,OAAO9M,EAAKjK,QAAU,IAAI3H,KAAK4R,EAAKjK,SAAS7D,UAAY7E,OAAO01B,iBACpE,IAAK,cACD,OAAQ/iB,EAAK7K,aAAe,IAAI2X,cACpC,QACI,MAAO,GACf,EAiHJ,OA9Ge8V,EAAS7wB,MAAK,CAACC,EAAGC,KAE7B,GAAiB,UAAbyqB,IAAwB3C,GAAgBtZ,IAAK,CAC7C,MAAMuiB,EAASF,EAAa9wB,EAAG+nB,GAAgBtZ,KACzCwiB,EAASH,EAAa7wB,EAAG8nB,GAAgBtZ,KAE/C,IAAIyiB,EAAa,EAOjB,GALIA,EADkB,kBAAXF,GAAyC,kBAAXC,EACxBD,EAASC,EAET7hB,OAAO4hB,GAAQG,cAAc/hB,OAAO6hB,IAGlC,IAAfC,EACA,MAAqC,QAA9BnJ,GAAgBlnB,UAAsBqwB,GAAcA,CAEnE,CAGA,GAAI3J,GAAqBjrB,OAAS,IAA2B,OAArBqrB,IAA6BR,GAAiB7qB,OAAS,GAAI,CAE/F,MAAM80B,EAAmB,IAAI7J,IAAsBxnB,MAAK,CAACsxB,EAAKC,IAAQD,EAAIE,SAAWD,EAAIC,WAEzF,IAAK,MAAMC,KAAWJ,EAAkB,CACpC,MAAMJ,EAASF,EAAa9wB,EAAGwxB,EAAQC,QACjCR,EAASH,EAAa7wB,EAAGuxB,EAAQC,QAEvC,IAAIP,EAAa,EAWjB,GATIA,EADkB,kBAAXF,GAAyC,kBAAXC,EACxBD,EAASC,EAET7hB,OAAO4hB,GAAQG,cAAc/hB,OAAO6hB,IAG3B,SAAtBO,EAAQ3wB,YACRqwB,GAAcA,GAGC,IAAfA,EACA,OAAOA,CAEf,CACA,OAAO,CACX,CAGA,GAAiB,UAAbxG,IAA6C,OAArB/C,IAAyD,IAA5BR,GAAiB7qB,OAAc,CACpF,MAAMo1B,EAAkB3G,GAAkBptB,QAAOg0B,GAAShG,GAAoBE,IAAI8F,KAElF,IAAK,MAAM1F,KAAYyF,EAAiB,CACpC,MAAM7wB,EAAYirB,GAAuBG,IAAa,MAChD+E,EAASF,EAAa9wB,EAAGisB,GACzBgF,EAASH,EAAa7wB,EAAGgsB,GAE/B,IAAIiF,EAAa,EAWjB,GATIA,EADkB,kBAAXF,GAAyC,kBAAXC,EACxBD,EAASC,EAET7hB,OAAO4hB,GAAQG,cAAc/hB,OAAO6hB,IAGnC,SAAdpwB,IACAqwB,GAAcA,GAGC,IAAfA,EACA,OAAOA,CAEf,CACA,OAAO,CACX,CAGA,GAAiB,UAAbxG,IAA6C,OAArB/C,IAAyD,IAA5BR,GAAiB7qB,QAAgByrB,GAAgBtZ,IAAK,CAC3G,MAAMuiB,EAASF,EAAa9wB,EAAG+nB,GAAgBtZ,KACzCwiB,EAASH,EAAa7wB,EAAG8nB,GAAgBtZ,KAE/C,IAAIyiB,EAAa,EAOjB,GALIA,EADkB,kBAAXF,GAAyC,kBAAXC,EACxBD,EAASC,EAET7hB,OAAO4hB,GAAQG,cAAc/hB,OAAO6hB,IAGlC,IAAfC,EACA,MAAqC,QAA9BnJ,GAAgBlnB,UAAsBqwB,GAAcA,CAEnE,CAGA,MAAMU,EAAQ5xB,EAAE+D,QAAU,IAAI3H,KAAK4D,EAAE+D,SAAS7D,UAAY7E,OAAO01B,iBAC3Dc,EAAQ5xB,EAAE8D,QAAU,IAAI3H,KAAK6D,EAAE8D,SAAS7D,UAAY7E,OAAO01B,iBAEjE,GAAIa,IAAUC,EACV,OAAOD,EAAQC,EAGnB,MAAMC,EAAchC,GAAkB9vB,EAAEe,QAClCgxB,EAAcjC,GAAkB7vB,EAAEc,QAExC,OAAI+wB,IAAgBC,EACTD,EAAcC,EAGlB/xB,EAAEpC,MAAMuzB,cAAclxB,EAAErC,MAAM,GAM5B,GACd,CAACukB,EAAOwF,GAAkB9E,GAAYkF,GAAiB+H,GAAmBvI,GAAsBmD,GAAUK,GAAmBY,GAAqBG,KAG/IkG,IAAgCzT,EAAAA,EAAAA,UAAQ,KAI1C,MAAM0T,EAAoB3Z,GAAa3a,QAAOqc,GAA8B,MAAfA,IAE7D,IAAI4W,EAAWqB,EAAkBt0B,QAAOqc,IAEpC,GAAgC,QAA5B+J,IAAqC/J,EAAYjZ,SAAWgjB,GAC5D,OAAO,EAIX,GAAuC,QAAnCE,IAA4CjK,EAAYiH,gBAAkBgD,GAC1E,OAAO,EAIX,GAAIJ,GAAuB,CACvB,MAAMgN,EAAchN,GAAsB/I,cAQ1C,KANKd,EAAY3D,WAAa2D,EAAY3D,UAAUyE,cAAc7Y,SAAS4uB,IACtE7W,EAAYuB,YAAcvB,EAAYuB,WAAWT,cAAc7Y,SAAS4uB,IACxE7W,EAAYqB,YAAcrB,EAAYqB,WAAWP,cAAc7Y,SAAS4uB,IACxE7W,EAAY2C,YAAc3C,EAAY2C,WAAW7B,cAAc7Y,SAAS4uB,IACxE7W,EAAYiC,oBAAsBjC,EAAYiC,mBAAmBnB,cAAc7Y,SAAS4uB,IAEzE,OAAO,CAC/B,CAEA,OAAO,CAAI,IAuIf,MAAMqB,EAA0BA,CAAClY,EAA0BiS,KAA2B,IAADkG,EACjF,OAAQlG,GACJ,IAAK,YACD,OAAQjS,EAAY3D,WAAa,IAAIyE,cACzC,IAAK,SACD,OAAOd,EAAYjZ,OAAO+Z,cAC9B,IAAK,gBACD,OAAOd,EAAYiH,cAAcnG,cACrC,IAAK,cACD,OAAOd,EAAYC,YAAc,IAAI7d,KAAK4d,EAAYC,aAAa/Z,UAAY,EACnF,IAAK,eACD,OAAO8Z,EAAYE,aAAe,IAAI9d,KAAK4d,EAAYE,cAAcha,UAAY,EACrF,IAAK,aACD,OAAQ8Z,EAAY2C,YAAc,IAAI7B,cAC1C,IAAK,SACL,IAAK,cACD,QAA0B,QAAlBqX,EAAAnY,EAAY5S,cAAM,IAAA+qB,OAAA,EAAlBA,EAAoBprB,OAAQ,IAAI+T,cAC5C,IAAK,aACD,OAAQd,EAAYuB,YAAc,IAAIT,cAC1C,IAAK,aACD,OAAQd,EAAYqB,YAAc,IAAIP,cAC1C,IAAK,SACD,MAAqC,kBAAvBd,EAAYxD,OAAsBS,WAAW+C,EAAYxD,QAAWwD,EAAYxD,QAAU,EAC5G,IAAK,cACD,OAAOwD,EAAYkH,YAAc,IAAI9kB,KAAK4d,EAAYkH,aAAahhB,UAAY,EACnF,QACI,MAAO,GACf,EAoGJ,OAhGe0wB,EAAS7wB,MAAK,CAACC,EAAGC,KAE7B,GAAiB,UAAbyqB,IAAwBzC,GAA2BxZ,IAAK,CACxD,MAAMuiB,EAASkB,EAAwBlyB,EAAGioB,GAA2BxZ,KAC/DwiB,EAASiB,EAAwBjyB,EAAGgoB,GAA2BxZ,KAErE,IAAIyiB,EAAa,EAOjB,GALIA,EADkB,kBAAXF,GAAyC,kBAAXC,EACxBD,EAASC,EAET7hB,OAAO4hB,GAAQG,cAAc/hB,OAAO6hB,IAGlC,IAAfC,EACA,MAAgD,QAAzCjJ,GAA2BpnB,UAAsBqwB,GAAcA,CAE9E,CAGA,GAAIrK,GAAgCvqB,OAAS,IAAsC,OAAhC2qB,IAAwCR,GAA4BnqB,OAAS,GAAI,CAEhI,MAAM80B,EAAmB,IAAIvK,IAAiC9mB,MAAK,CAACsxB,EAAKC,IAAQD,EAAIE,SAAWD,EAAIC,WAEpG,IAAK,MAAMC,KAAWJ,EAAkB,CACpC,MAAMJ,EAASkB,EAAwBlyB,EAAGwxB,EAAQC,QAC5CR,EAASiB,EAAwBjyB,EAAGuxB,EAAQC,QAElD,IAAIP,EAAa,EAWjB,GATIA,EADkB,kBAAXF,GAAyC,kBAAXC,EACxBD,EAASC,EAET7hB,OAAO4hB,GAAQG,cAAc/hB,OAAO6hB,IAG3B,SAAtBO,EAAQ3wB,YACRqwB,GAAcA,GAGC,IAAfA,EACA,OAAOA,CAEf,CACA,OAAO,CACX,CAGA,GAAiB,UAAbxG,IAAwD,OAAhCzD,IAA+E,IAAvCR,GAA4BnqB,OAAc,CAC1G,MAAMo1B,EAAkB3G,GAAkBptB,QAAOg0B,GAAShG,GAAoBE,IAAI8F,KAElF,IAAK,MAAM1F,KAAYyF,EAAiB,CACpC,MAAM7wB,EAAYqrB,GAA8BD,IAAa,MACvD+E,EAASkB,EAAwBlyB,EAAGisB,GACpCgF,EAASiB,EAAwBjyB,EAAGgsB,GAE1C,IAAIiF,EAAa,EAWjB,GATIA,EADkB,kBAAXF,GAAyC,kBAAXC,EACxBD,EAASC,EAET7hB,OAAO4hB,GAAQG,cAAc/hB,OAAO6hB,IAGnC,SAAdpwB,IACAqwB,GAAcA,GAGC,IAAfA,EACA,OAAOA,CAEf,CACA,OAAO,CACX,CAGA,GAAiB,UAAbxG,IAAwD,OAAhCzD,IAA+E,IAAvCR,GAA4BnqB,QAAgB2rB,GAA2BxZ,IAAK,CAC5I,MAAMuiB,EAASkB,EAAwBlyB,EAAGioB,GAA2BxZ,KAC/DwiB,EAASiB,EAAwBjyB,EAAGgoB,GAA2BxZ,KAErE,IAAIyiB,EAAa,EAOjB,GALIA,EADkB,kBAAXF,GAAyC,kBAAXC,EACxBD,EAASC,EAET7hB,OAAO4hB,GAAQG,cAAc/hB,OAAO6hB,IAGlC,IAAfC,EACA,MAAgD,QAAzCjJ,GAA2BpnB,UAAsBqwB,GAAcA,CAE9E,CAGA,OAAO,IAAI90B,KAAK6D,EAAEga,aAAa/Z,UAAY,IAAI9D,KAAK4D,EAAEia,aAAa/Z,SAAS,GAMnE,GACd,CAACoY,GAAcyL,GAAyBE,GAAgCJ,GAAuBgD,GAAiC6D,GAAUK,GAAmBY,GAAqBO,GAA+BjE,MAGpNvtB,EAAAA,EAAAA,YAAU,KACN,GAAkB,UAAdsK,EAAuB,OAE3B,MAAMotB,EAAW,IAAIC,sBAChBljB,IAEG,GADmBA,EAAQ,GACZmjB,gBAAkB/P,KAAiBE,KAAqBnoB,GAAS,CAC5E,MAAMi4B,EAAapQ,EAAM7lB,OACzBiwB,GACI5E,SAAoB5pB,EACpBopB,GAAiB7qB,OAAS,EAAI6qB,QAAmBppB,GACjD,EACA,GACAw0B,EAER,IAEJ,CAAEC,UAAW,KAOjB,OAJItE,GAAiBvoB,SACjBysB,EAASK,QAAQvE,GAAiBvoB,SAG/B,KACCuoB,GAAiBvoB,SACjBysB,EAASM,UAAUxE,GAAiBvoB,QACxC,CACH,GACF,CAACX,EAAWud,GAAcE,GAAkBnoB,GAAS6nB,EAAM7lB,OAAQqrB,GAAkBR,GAAkBoF,MAG1G7xB,EAAAA,EAAAA,YAAU,KACN,GAAkB,iBAAdsK,EAA8B,OAElC,MAAMotB,EAAW,IAAIC,sBAChBljB,IAEG,GADmBA,EAAQ,GACZmjB,gBAAkBnP,KAAwBE,KAA4BE,GAAqB,CACtG,MAAMgP,EAAaja,GAAahc,OAChC4c,GACI+N,SAA+BlpB,EAC/B0oB,GAA4BnqB,OAAS,EAAImqB,QAA8B1oB,GACvE,EACA,GACAw0B,EAER,IAEJ,CAAEC,UAAW,KAOjB,OAJIrE,GAAwBxoB,SACxBysB,EAASK,QAAQtE,GAAwBxoB,SAGtC,KACCwoB,GAAwBxoB,SACxBysB,EAASM,UAAUvE,GAAwBxoB,QAC/C,CACH,GACF,CAACX,EAAWme,GAAqBE,GAAyBE,GAAqBjL,GAAahc,OAAQ2qB,GAA6BR,MAGpI/rB,EAAAA,EAAAA,YAAU,KACN,GAAkB,iBAAdsK,EAA8B,OAElC,MAAMotB,EAAW,IAAIC,sBAChBljB,IAEG,GADmBA,EAAQ,GACZmjB,gBAAkBjN,KAAwBE,KAA4BE,GAAqB,CACtG,MAAM8M,EAAatN,GAAa3oB,OAChC+xB,IACI,EACA,GACAkE,EAER,IAEJ,CAAEC,UAAW,KAOjB,OAJIpE,GAAwBzoB,SACxBysB,EAASK,QAAQrE,GAAwBzoB,SAGtC,KACCyoB,GAAwBzoB,SACxBysB,EAASM,UAAUtE,GAAwBzoB,QAC/C,CACH,GACF,CAACX,EAAWqgB,GAAqBE,GAAyBE,GAAqBR,GAAa3oB,SAG/F,MAAMq2B,GAAmBA,CAACC,EAAmBC,KAEzC,MAAMC,EAAiB,IAAInK,GAASqC,aAC9Bb,EAAgB2I,EAAeF,GAGrCE,EAAeC,OAAOH,EAAW,GACjCE,EAAeC,OAAOF,EAAY,EAAG1I,GAGrCrB,GAAkBgK,EAAe,EAI/BE,GAAmB/G,IACrB7B,GAAiB6B,EAAS,EAGxBlnB,GAAiBA,CAAC7I,EAAoB+vB,KACxC/vB,EAAEC,iBACEguB,IAAiBA,KAAkB8B,GACnC3B,GAAkB2B,EACtB,EAGEnnB,GAAaA,CAAC5I,EAAoB+vB,KAEpC,GADA/vB,EAAEC,iBACEguB,IAAiBA,KAAkB8B,EAAU,CAC7C,MAAM2G,EAAYjK,GAASqC,YAAY5gB,QAAQ+f,IACzC0I,EAAalK,GAASqC,YAAY5gB,QAAQ6hB,GAE5C2G,GAAa,GAAKC,GAAc,GAChCF,GAAiBC,EAAWC,EAEpC,CACAzI,GAAiB,MACjBE,GAAkB,KAAK,EAGrB2I,GAAgBA,KAClB7I,GAAiB,MACjBE,GAAkB,KAAK,EAerB4I,IAVsB3U,EAAAA,EAAAA,UAAQ,KAChC,MAEM4U,GAFexK,GAASqC,aAAe,IAEbrtB,QAAO3G,GAAY,MAANA,GAA4B,kBAAPA,IAG5Do8B,GAD6B,UAAdpuB,EAAwB4b,GAAqB+I,IAC9BhsB,QAAO3G,IAAOm8B,EAAWlxB,SAASjL,KACtE,MAAO,IAAIm8B,KAAeC,EAAe,GAC1C,CAACzK,GAASqC,YAAahmB,EAAW4b,GAAoB+I,KAEZhsB,QAAO3G,GAAY,MAANA,GAA4B,kBAAPA,GAAmBoyB,GAAgBpyB,KAG5Gq8B,GAAiB14B,UACnB,IAAK,IAAD24B,EAEA,MAAMC,EAAiB,CACnB31B,MAAM,GAAD1G,OAAK8W,EAAKpQ,MAAK,UACpBuF,YAAa6K,EAAK7K,YAClBpC,OAAQ,OACRwC,cAAeyK,EAAK3B,YAAc2B,EAAK3B,YAAYrV,GAAK,KACxDyM,OAAQuK,EAAK7G,KAAO6G,EAAK7G,KAAKnQ,GAAK,KACnC2M,kBAAqC,QAAnB2vB,EAAAtlB,EAAK5B,sBAAc,IAAAknB,OAAA,EAAnBA,EAAqBt8B,KAAM,KAC7C6M,SAAUmK,EAAK5G,OAAOpQ,GACtB+M,QAASiK,EAAKjK,SAIZnN,QAAiBC,EAAAA,EAAcC,KACjCS,EAAAA,GAAcgV,MAAMzR,KACpBy4B,GAIJnR,IAASuM,GAAa,CAAC/3B,EAASH,QAASk4B,KAGzCnG,GAAgB5xB,EAASH,MACzB6xB,IAAmB,EAEvB,CAAE,MAAOptB,GAAM,IAADqQ,EAAAC,EACNqiB,EAIJ,MAAMzrB,EAAalH,EACnBb,IAA4B,QAAnBkR,EAAAnJ,EAAWxL,gBAAQ,IAAA2U,GAAM,QAANC,EAAnBD,EAAqB9U,YAAI,IAAA+U,OAAN,EAAnBA,EAA2BtO,UAAWkF,EAAWlF,SAAW,0CACzE,GAGEs2B,GAAmB74B,UACrB,GAAImN,OAAOwS,QAAQ3hB,EAAE,wCAAyC,CACtDk1B,EAOJzL,IAASuM,GACYA,EAAUhxB,QAAOqQ,GAAgB,MAARA,GAAgBA,EAAKhX,KAAOgW,MAO1E,IACQ6gB,QAGEh3B,EAAAA,EAAc2b,OAAOjb,EAAAA,GAAcgV,MAAM9J,MAAMuK,IAKrD6hB,GAAAA,GAAM7xB,QAAQrE,EAAE,iCACpB,CAAE,MAAOyB,IAEDyzB,EAGJtB,KACAsC,GAAAA,GAAMz0B,MAAMzB,EAAE,sCAClB,CACJ,GAmBJ,OACI2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gCAA+BC,SAAA,EAC1CC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,sEAAqEC,UAEhFJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,cAAaC,SAAA,EAExBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,yBAAwBC,SAAA,EAEnCJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,wHAAuHC,SAAA,EAClIJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,yDAAwDC,SAAA,EAEnEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oBAAmBC,SAC7B6V,EAAc,QAAS,QAAS,WAC7BjW,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAASA,IAAMqsB,IAAqB,GACpC3sB,UAAU,+MACV8R,MAAO,CAAEkmB,MAAO,UAAWC,OAAQ,WACnC,aAAY/6B,EAAE,oBAAoB+C,UAElCC,EAAAA,EAAAA,KAACg4B,EAAAA,EAAQ,CAACl4B,UAAU,eAExBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,4BAOnBgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oBAAmBC,UAC9BJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,uEAAsEC,SAAA,EACjFJ,EAAAA,EAAAA,MAAA,UACIS,QAASA,IAAMkJ,EAAa,SAC5BxJ,UAAS,+FAAAvE,OACS,UAAd8N,EACM,mDACA,0HACPtJ,SAAA,EAEHC,EAAAA,EAAAA,KAAC8D,EAAAA,EAAe,CAAChE,UAAU,0BAC1B9C,EAAE,cAAe,cAErB4Y,EAAc,eAAgB,OAAQ,WACnCjW,EAAAA,EAAAA,MAAA,UACIS,QAASA,IAAMkJ,EAAa,gBAC5BxJ,UAAS,+FAAAvE,OACS,iBAAd8N,EACM,mDACA,0HACPtJ,SAAA,EAEHC,EAAAA,EAAAA,KAACi4B,EAAAA,EAAY,CAACn4B,UAAU,0BACvB9C,EAAE,qBAAsB,mBAGhC4Y,EAAc,gBAAiB,OAAQ,WACpCjW,EAAAA,EAAAA,MAAA,UACIS,QAASA,IAAMkJ,EAAa,gBAC5BxJ,UAAS,+FAAAvE,OACS,iBAAd8N,EACM,mDACA,0HACPtJ,SAAA,EAEHC,EAAAA,EAAAA,KAACk4B,EAAAA,EAAyB,CAACp4B,UAAU,0BACpC9C,EAAE,qBAAsB,2BAOzC2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,4BAA2BC,SAAA,EACtCC,EAAAA,EAAAA,KAAA,SACImC,KAAK,OACL2H,YAAa9M,EAAE,iBAAmB,MAClC8C,UAAU,yPACV6B,MAAqB,UAAd0H,EAAwB6d,GAAagB,GAC5CtmB,SAAWrB,IACW,UAAd8I,EACA8d,GAAc5mB,EAAEsB,OAAOF,OAEvBwmB,GAAyB5nB,EAAEsB,OAAOF,MACtC,IAKO,iBAAd0H,IACG1J,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAASpB,UACL,IACI2pB,IAAuB,SACjBztB,EAAAA,EAAcC,KAAKS,EAAAA,GAAcu8B,aAAaC,MACpDh7B,EAAYJ,EAAE,2BAA4B,2CAA4C,iBAChFugB,QAAiBnb,OAAWA,GAAW,EAAO,GAAI,EAC5D,CAAE,MAAO7C,GAAW,IAADkc,EAAAC,EACXwW,EAGJ90B,GACgB,QAAZqe,EAAAlc,EAAItE,gBAAQ,IAAAwgB,GAAM,QAANC,EAAZD,EAAc3gB,YAAI,IAAA4gB,OAAN,EAAZA,EAAoBna,UAAWvE,EAAE,yBAA0B,+BAC3D,QAER,CAAC,QACG2rB,IAAuB,EAC3B,GAEJ5mB,SAAU2mB,GACV5oB,UAAU,0GAAyGC,UAEnHC,EAAAA,EAAAA,KAAC2L,EAAAA,EAAa,CAAC7L,UAAS,WAAAvE,OAAamtB,GAAsB,eAAiB,SAEhF1oB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM2oB,GAAsB1rB,EAAE,uBAAwB,qBAAuBA,EAAE,oBAAqB,yBAM3G2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACIF,UAAS,2DAAAvE,OACQ,UAAbwzB,GAAuB,kEAAoE,IAE/F3uB,QAASA,IAAMutB,GAA4B,UAAboB,GAAuB,QAAU,SAAShvB,SAE1D,UAAbgvB,IACG/uB,EAAAA,EAAAA,KAACq4B,EAAAA,EAAc,CAACv4B,UAAU,aAE1BE,EAAAA,EAAAA,KAACs4B,EAAAA,EAAc,CAACx4B,UAAU,eAGlCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SAC1K/C,EAAV,UAAb+xB,GAAyB,qBAA0B,4BAK5DpvB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sBAAqBC,SAAA,EAChCJ,EAAAA,EAAAA,MAAA,UACIG,UAAS,kBAAAvE,OAAoBy4B,KAAyB,EAAI,kEAAoE,2CAA0C,aACxK5zB,QAASA,IAAM+rB,IAAsBD,IAAmBnsB,SAAA,EAExDC,EAAAA,EAAAA,KAACu4B,EAAAA,EAAU,CAACz4B,UAAU,YACrBk0B,KAAyB,IACtBh0B,EAAAA,EAAAA,KAAA,QAAMF,UAAU,gHAA+GC,SAC1Hi0B,WAIbh0B,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,uBAMXgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,OAAMC,UACjBC,EAAAA,EAAAA,KAACw4B,EAAAA,EAAiB,CACdC,QAAuB,UAAdpvB,EACW,UAAb0lB,GACG,CACE,CAAE1zB,GAAI,QAAS8qB,MAAOnpB,EAAE,wBACxB,CAAE3B,GAAI,SAAU8qB,MAAOnpB,EAAE,yBACzB,CAAE3B,GAAI,cAAe8qB,MAAOnpB,EAAE,8BAC9B,CAAE3B,GAAI,iBAAkB8qB,MAAOnpB,EAAE,iCACjC,CAAE3B,GAAI,SAAU8qB,MAAOnpB,EAAE,yBACzB,CAAE3B,GAAI,UAAW8qB,MAAOnpB,EAAE,0BAC1B,CAAE3B,GAAI,cAAe8qB,MAAOnpB,EAAE,+BAEhCkpB,EACU,iBAAd7c,EACc,UAAb0lB,GACG,CACE,CAAE1zB,GAAI,YAAa8qB,MAAOnpB,EAAE,iCAAkC,SAC9D,CAAE3B,GAAI,SAAU8qB,MAAOnpB,EAAE,8BAA+B,WACxD,CAAE3B,GAAI,gBAAiB8qB,MAAOnpB,EAAE,qCAAsC,mBACtE,CAAE3B,GAAI,cAAe8qB,MAAOnpB,EAAE,mCAAoC,aAClE,CAAE3B,GAAI,eAAgB8qB,MAAOnpB,EAAE,oCAAqC,cACpE,CAAE3B,GAAI,aAAc8qB,MAAOnpB,EAAE,kCAAmC,WAChE,CAAE3B,GAAI,aAAc8qB,MAAOnpB,EAAE,kCAAmC,WAChE,CAAE3B,GAAI,aAAc8qB,MAAOnpB,EAAE,kCAAmC,YAChE,CAAE3B,GAAI,SAAU8qB,MAAOnpB,EAAE,8BAA+B,WACxD,CAAE3B,GAAI,cAAe8qB,MAAOnpB,EAAE,mCAAoC,kBAEpEspB,EACJ,GACNoS,eAA6B,UAAb3J,GACVzyB,MAAMq8B,KAAK3I,IACXuH,GACNlI,YAA0B,UAAbN,GACPK,GACApC,GAASqC,YACfuJ,yBAA2BtI,IACvB,GAAiB,UAAbvB,GAAsB,CAEtB,MAAM8J,EAAcpT,GAAmB6K,GACvC,GAAIuI,EAEA,GAAoB,iCAAhBA,EAAgD,CAEhD,MAAMC,EAA6B,gBAAbxI,EAA6B,iBAAmB,cAClDX,GAAmBO,IAAI4I,GACnB9L,GAAS8C,cAAcxpB,SAASuyB,GAIpDtL,GAAuBsL,EAW/B,MAEItL,GAAuBsL,EAGnC,MACItL,GAAuB+C,EAC3B,EAEJyI,aAA2B,UAAbhK,GACR,CAACkI,EAAmBC,KAClB,MAAM8B,EAAe,IAAI5J,IACnB6J,EAAUD,EAAa/B,GAC7B+B,EAAa5B,OAAOH,EAAW,GAC/B+B,EAAa5B,OAAOF,EAAY,EAAG+B,GAGnC,MAAMC,EAA0B,GAC1BC,EAAmB,IAAIrK,IAE7BkK,EAAapmB,SAAQ4c,IACjB,MAAMD,EAAW9J,GAAmB+J,GAChCD,IAAa4J,EAAiBjJ,IAAIX,KAClC4J,EAAiBhK,IAAII,GACrB2J,EAAcphB,KAAKyX,GACvB,IAIJrJ,EAAiBtT,SAAQwmB,IAChBF,EAAc5yB,SAAS8yB,EAAI/9B,KAAkB,YAAX+9B,EAAI/9B,IACvC69B,EAAcphB,KAAKshB,EAAI/9B,GAC3B,IAGJ8xB,GAAkB+L,EAAc,EAElClC,GACNqC,YAAoCr8B,EAAV,UAAb+xB,GAAyB,6BAAkC,yBACxEuK,WAAmCt8B,EAAV,UAAb+xB,GAAyB,6BAAkC,yBACvEgD,eAA6B,UAAbhD,IAAsC,UAAd1lB,EAClC8mB,GACa,UAAbpB,IAAsC,iBAAd1lB,EACxBknB,QACAnuB,EACNm3B,sBAAoC,UAAbxK,IAAsC,UAAd1lB,EACzCgnB,GACa,UAAbtB,IAAsC,iBAAd1lB,EACxBonB,QACAruB,EACNo3B,kBAAgC,UAAbzK,KAAuC,UAAd1lB,GAAuC,iBAAdA,GACrEzM,QAASA,iBAOxBsvB,KACGlsB,EAAAA,EAAAA,KAAA,OAAKF,UAAwB,UAAbivB,GAAuB,+CAAiD,uBAAuBhvB,SAC5F,UAAdsJ,GACGrJ,EAAAA,EAAAA,KAACy5B,GAAAA,EAAU,CACPhB,QAAS,IAAIvS,KAAqBG,GAClCqT,QAAS5H,GACT6H,QAAS1F,GACT2F,gBAAiBpO,GACjBqO,eAAgBnO,GAChBoO,oBAAqBlO,GACrBmO,uBAAwBlO,GACxBmO,QAAS9U,MAGbllB,EAAAA,EAAAA,KAACy5B,GAAAA,EAAU,CACPhB,QAAS,IAAInS,KAAgCC,GAC7CmT,QAASvH,GACTwH,QAASzF,GACT0F,gBAAiB9O,GACjB+O,eAAgB7O,GAChB8O,oBAAqB5O,GACrB6O,uBAAwB5O,GACxB6O,QAAS7U,QAQrBnlB,EAAAA,EAAAA,KAAA,OAAKF,UAAwB,UAAbivB,GAAuB,+CAAiD,uBAAuBhvB,UAC3GC,EAAAA,EAAAA,KAACi6B,GAAAA,EAAe,CAChBD,QAAuB,UAAd3wB,EAAwB6b,GAAiBC,GAClD+U,eAA8B,UAAd7wB,EAAwByoB,GAAwBK,GAChEwH,QAAuB,UAAdtwB,EAAwB4qB,GAAwBC,GACzDpI,iBAAgC,UAAdziB,EAAwByiB,GAAmBV,GAC7DY,iBAAgC,UAAd3iB,EAAwB2iB,GAAmBV,GAC7D6O,eAA8B,UAAd9wB,EAAwB+oB,GAAqBC,GAC7D+H,kBAAiC,UAAd/wB,EAAwB,UAAY,UAMhD,UAAdA,GAAsC,UAAb0lB,IAEtB/uB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,0CAAyCC,UACpDJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,2DAA0DC,SAAA,EACvEC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,8BAA6BC,UAC1CC,EAAAA,EAAAA,KAAA,MAAAD,SACKw3B,GAAiBr1B,KAAKouB,IACnB,MAAMwF,EAAS5P,EAAiBzmB,MAAK25B,GAAOA,EAAI/9B,KAAOi1B,IACvD,OAAKwF,GAGD91B,EAAAA,EAAAA,KAAA,MAEIq6B,MAAM,MACNv6B,UAAS,qHAAAvE,OAAuH+0B,IAAa5B,GAAiB,+BAAiC,IAC/L4L,WAAW,EACXC,YAAaA,IAAMlD,GAAgB/G,GACnCzmB,WAAatJ,GAAM6I,GAAe7I,EAAG+vB,GACrC1mB,OAASrJ,GAAM4I,GAAW5I,EAAG+vB,GAC7BkK,UAAWlD,GAAcv3B,UAEzBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oBAAmBC,SAAA,CAC7BoM,OAAOC,YAAc,IAAM0pB,EAAO1P,WAAa0P,EAAO3P,MACzC,YAAbmK,IACGtwB,EAAAA,EAAAA,KAAA,UACII,QAASA,IAAMszB,GAAWpD,GAC1BxwB,UAAU,0BAAyBC,UAEnCC,EAAAA,EAAAA,KAACy6B,EAAAA,EAAgB,CAAC36B,UAAU,mDAhBnCwwB,GAJO,IAwBX,SAKrBtwB,EAAAA,EAAAA,KAAA,SAAOF,UAAU,0EAAyEC,SACrFpB,IACGqB,EAAAA,EAAAA,KAAA,MAAAD,UACIC,EAAAA,EAAAA,KAAA,MAAI06B,QAASnD,GAAiB52B,OAAQb,UAAU,wCAAuCC,UACnFC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,sBAAqBC,UAChCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4FAI3BrB,IACAuB,EAAAA,EAAAA,KAAA,MAAAD,UACIC,EAAAA,EAAAA,KAAA,MAAI06B,QAASnD,GAAiB52B,OAAQb,UAAU,uDAAsDC,SACjGtB,OAGyB,IAAlCu2B,GAAuBr0B,QACvBX,EAAAA,EAAAA,KAAA,MAAAD,UACIC,EAAAA,EAAAA,KAAA,MAAI06B,QAASnD,GAAiB52B,OAAQb,UAAU,yDAAwDC,UACpGJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,kDAAiDC,SAAA,EAChEC,EAAAA,EAAAA,KAACk4B,EAAAA,EAAyB,CAACp4B,UAAU,gDACrCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,UAASC,SAAE/C,EAAE,gCAKxCgD,EAAAA,EAAAA,KAAAwJ,EAAAA,SAAA,CAAAzJ,SACCi1B,GAAuB9yB,KAAImQ,IAC5B,MAAMsoB,GAAeC,EAAAA,GAAAA,IAAgBvoB,EAAKjK,QAAS,YAAQhG,EAAWiQ,EAAKpQ,MAAOoQ,EAAK7K,aACjFqzB,GAAeC,EAAAA,GAAAA,IAAsBH,GAE3C,OACI36B,EAAAA,EAAAA,KAAA,MAEIF,UAAS,2CAAAvE,OACY,SAAjBo/B,EAAuB,GAAAp/B,OAAMs/B,EAAaE,QAAO,KAAAx/B,OAAIs/B,EAAaG,YAAW,eAAgB,IAC9Fj7B,SAEFw3B,GAAiBr1B,KAAIouB,IACtB,OAAQA,GACJ,IAAK,QACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,4BAA2BC,UACpDJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,yEAAwEC,SAAA,CAClFsS,EAAKpQ,MACDoQ,EAAK7K,cACF7H,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sBAAqBC,SAAA,EAChCC,EAAAA,EAAAA,KAAA,UACIF,UAAU,gFAA+EC,UAEzFC,EAAAA,EAAAA,KAACi7B,EAAAA,EAAqB,CAACn7B,UAAU,eAErCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,4BAEPgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,+RAA8RC,UACzSC,EAAAA,EAAAA,KAACk7B,GAAAA,EAAe,CAACh0B,QAASmL,EAAK7K,YAAa2zB,kBAAkB,aAd7E7K,GAqBb,IAAK,SACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,QAAMF,UAAS,iEAAAvE,QAAmE6/B,EAAAA,GAAAA,IAAe/oB,EAAKjN,OAAQ,QAAO,kCAAiCrF,SACjJsS,EAAKjN,UAFLkrB,GAMjB,IAAK,+BACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gBAAeC,SAAA,EAC1BJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,2CAA0CC,SAAA,EACrDJ,EAAAA,EAAAA,MAAA,QAAMG,UAAU,4DAA2DC,SAAA,CAAE/C,EAAE,6BAA6B,QAC5G2C,EAAAA,EAAAA,MAAA,QAAMG,UAAU,4DAA2DC,SAAA,CAAE/C,EAAE,6BAA6BmK,UAAU,EAAG,GAAG,QAAQnH,EAAAA,EAAAA,KAAA,SACnIqS,EAAK3B,YAAW,GAAAnV,OAAM8W,EAAK3B,YAAYpF,UAAS,KAAA/P,OAAI8W,EAAK3B,YAAYnF,UAAa8G,EAAK7G,KAAO6G,EAAK7G,KAAKJ,KAAO,QAEpHzL,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gDAA+CC,SAAA,EAC1DC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,4DAA2DC,SAAE/C,EAAE,gCAC/E2C,EAAAA,EAAAA,MAAA,QAAMG,UAAU,4DAA2DC,SAAA,CAAE/C,EAAE,gCAAgCmK,UAAU,EAAG,GAAG,QAAQnH,EAAAA,EAAAA,KAAA,SACtIqS,EAAK5B,eAAc,GAAAlV,OAAM8W,EAAK5B,eAAenF,UAAS,KAAA/P,OAAI8W,EAAK5B,eAAelF,UAAa,WAV/F+kB,GAejB,IAAK,SACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SAAEsS,EAAK5G,OAAOL,QADlEklB,GAIjB,IAAK,UACD,MAAM+K,GAAsBT,EAAAA,GAAAA,IAAgBvoB,EAAKjK,QAAS,YAAQhG,EAAWiQ,EAAKpQ,MAAOoQ,EAAK7K,aACxF8zB,GAAsBR,EAAAA,GAAAA,IAAsBO,GAClD,OACIr7B,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEJ,EAAAA,EAAAA,MAAA,OAAKG,UAAS,WAAAvE,OAAqC,SAAxB8/B,EAAiCC,EAAoBC,UAAY,oCAAqCx7B,SAAA,CAC5HsS,EAAKjK,QAAU,IAAI3H,KAAK4R,EAAKjK,SAASozB,qBAAuB,IACrC,SAAxBH,IACGr7B,EAAAA,EAAAA,KAAA,QAAMF,UAAU,eAAcC,SAAC,eAJlCuwB,GASjB,IAAK,UACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gCAA+BC,SAAA,EAC1CC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,iBAAgBC,SAC1B6zB,GAAoBvhB,KAExBuD,EAAc,QAAS,QAAS,WAC7BjW,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAASA,KACLysB,GAAgBxa,GAChBsa,IAAmB,EAAK,EAE5B7sB,UAAU,sFAAqFC,UAE/FC,EAAAA,EAAAA,KAACy7B,EAAAA,EAAU,CAAC37B,UAAU,eAE1BE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,oBAId4Y,EAAc,QAAS,OAAQ,WAC5BjW,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAASA,IAAMs3B,GAAerlB,GAC9BvS,UAAU,0FAAyFC,UAEnGC,EAAAA,EAAAA,KAAC07B,EAAAA,EAAqB,CAAC57B,UAAU,eAErCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,2BAId4Y,EAAc,QAAS,SAAU,WAC9BjW,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAASA,IAAMy3B,GAAiBxlB,EAAKhX,IACrCyE,UAAU,kFAAiFC,UAE3FC,EAAAA,EAAAA,KAACuZ,EAAAA,EAAS,CAACzZ,UAAU,eAEzBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,0BA3CdszB,GAkDjB,QACI,OAAO,KACf,KAhICje,EAAKhX,GAkIL,aAQX,UAAdgO,GAEArJ,EAAAA,EAAAA,KAAA,OAAKF,UAAU,0BAAyBC,SAEnCpB,IAA4B,IAAjB6nB,EAAM7lB,QACdX,EAAAA,EAAAA,KAAC27B,GAAAA,EAAQ,CAAA57B,SACJzD,MAAM,GAAG6N,KAAK,MAAMjI,KAAI,CAAC+N,EAAGzB,KACzBxO,EAAAA,EAAAA,KAAA,OAA2BF,UAAU,sHAAqHC,UACtJJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWC,SAAA,EAEtBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,+BAA8BC,SAAA,EACzCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mDACfE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,gEAGnBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mDAEfH,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWC,SAAA,EACtBC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oDACfE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oDACfE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,0DAEjB,YAAAvE,OAfYiT,QAmB9B/P,IACAuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2DAA0DC,SACpEtB,KAE6B,IAAlCu2B,GAAuBr0B,QACvBhB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,mFAAkFC,SAAA,EAC7FC,EAAAA,EAAAA,KAACk4B,EAAAA,EAAyB,CAACp4B,UAAU,qDACrCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,UAASC,SAAC,+BAG7BC,EAAAA,EAAAA,KAAC27B,GAAAA,EAAQ,CAAA57B,SACJi1B,GAAuB9yB,KAAImQ,KACHuoB,EAAAA,GAAAA,IAAgBvoB,EAAKjK,QAAS,YAAQhG,EAAWiQ,EAAKpQ,MAAOoQ,EAAK7K,aAAvF,MAGMo0B,EAA2B,GAajC,GAVI5L,GAAoBE,IAAI,WACxB0L,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAAC87B,EAAAA,EAAkB,CAACh8B,UAAU,YACpCqmB,MAAOnpB,EAAE,wBACT2E,MAAO0Q,EAAK5G,OAAOL,KACnB2wB,QAAS,SAKb/L,GAAoBE,IAAI,eAAgB,CAExC,MAAM8L,EAAmB3pB,EAAK3B,YAAW,GAAAnV,OAAM8W,EAAK3B,YAAYpF,UAAS,KAAA/P,OAAI8W,EAAK3B,YAAYnF,UAAc8G,EAAK7G,KAAO6G,EAAK7G,KAAKJ,KAAO,IACnI6wB,EAAgBD,EAAiBr7B,OAAS,GAA0B,MAArBq7B,EAA2BA,EAAiB70B,UAAU,EAAG,GAAK60B,EACnHJ,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACk8B,EAAAA,EAAQ,CAACp8B,UAAU,YAC1BqmB,MAAOnpB,EAAE,6BACT2E,MAAOs6B,EACPF,QAAS,QAEjB,CACA,GAAI/L,GAAoBE,IAAI,kBAAmB,CAE3C,MAAMiM,EAAsB9pB,EAAK5B,eAAc,GAAAlV,OAAM8W,EAAK5B,eAAenF,UAAS,KAAA/P,OAAI8W,EAAK5B,eAAelF,UAAa,IACjH0wB,EAAgBE,EAAoBx7B,OAAS,GAA6B,MAAxBw7B,EAA8BA,EAAoBh1B,UAAU,EAAG,GAAKg1B,EAC5HP,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACk8B,EAAAA,EAAQ,CAACp8B,UAAU,YAC1BqmB,MAAOnpB,EAAE,gCACT2E,MAAOs6B,EACPF,QAAS,eAEjB,CAGA,GAAI/L,GAAoBE,IAAI,WAAY,CACpC,MAAMkM,GAAcC,EAAAA,GAAAA,IAChBhqB,EAAKjK,QACL,OACAiK,EAAKpQ,MACLoQ,EAAK7K,aACLxH,EAAAA,EAAAA,KAACi4B,EAAAA,EAAY,CAACn4B,UAAU,YACxB9C,EAAE,0BACDkQ,IAAS/J,EAAAA,GAAAA,IAAO+J,EAAM,aAAc,CAAE9J,OAAQN,GAAAA,OAC/C,GAEJ84B,EAAS9jB,MAAItC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EACR4mB,GAAW,IACdL,QAAS,iBAEjB,CAGI/L,GAAoBE,IAAI,gBAAkB7d,EAAK7K,aAC/Co0B,EAAS9jB,KAAK,CACVqO,MAAOnpB,EAAE,6BACT2E,MAAO,GACP26B,mBAAoBjqB,EAAK7K,YACzB+0B,mBAAoBlqB,EAAK4D,aAAe,GACxC8lB,QAAS,SAKjB,MAAMS,GACF78B,EAAAA,EAAAA,MAAA,OAAKG,UAAU,8BAA6BC,SAAA,EAExCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,iBAAgBC,SAC1B6zB,GAAoBvhB,KAExBuD,EAAc,QAAS,QAAS,WAC7B5V,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACFie,GAAgBxa,GAChBsa,IAAmB,EAAK,EAER7sB,UAAU,sFAAqFC,UAEnHC,EAAAA,EAAAA,KAACy7B,EAAAA,EAAU,CAAC37B,UAAU,cAG7B8V,EAAc,QAAS,OAAQ,WAC5BjW,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACF8oB,GAAerlB,EAAK,EAExBvS,UAAU,0FAAyFC,UAEnGC,EAAAA,EAAAA,KAAC07B,EAAAA,EAAqB,CAAC57B,UAAU,eAErCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,8BAOvB,OACIgD,EAAAA,EAAAA,KAACy8B,GAAAA,EAAQ,CAELx6B,OACEtC,EAAAA,EAAAA,MAAA,QAAAI,SAAA,EACEJ,EAAAA,EAAAA,MAAA,QAAMG,UAAU,2CAA0CC,SAAA,CAAEsS,EAAKhX,GAAG,OAAS,KAC7E2E,EAAAA,EAAAA,KAAA,QAAAD,SAAOsS,EAAKpQ,WAGhBmD,OAAQ,CACJ+gB,OAAOuW,EAAAA,GAAAA,IAAcrqB,EAAKjN,OAAQ,OAAQpI,GAC1C2/B,OAAOvB,EAAAA,GAAAA,IAAe/oB,EAAKjN,OAAQ,QACnCw3B,qBAAiBx6B,EACjBy6B,iBAAaz6B,GAEjBw5B,SAAUA,EACVkB,QAASN,GAdJnqB,EAAKhX,GAeZ,QAMtB,KAGW,iBAAdgO,GAA6C,UAAb0lB,KAC7B/uB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,0BAAyBC,SACnC6nB,IACG5nB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4BAA2BC,UACtCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wFAEnBgoB,IACA9nB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2DAA0DC,SACpE+nB,KAEoC,IAAzCuO,GAA8B11B,QAC9BhB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,mFAAkFC,SAAA,EAC7FC,EAAAA,EAAAA,KAACi4B,EAAAA,EAAY,CAACn4B,UAAU,qDACxBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,UAASC,SACnBmoB,IAAqD,QAA5BE,IAAwE,QAAnCE,GACzDtrB,EAAE,yBAA0B,+BAC5BA,EAAE,8BAA+B,sCAI/CgD,EAAAA,EAAAA,KAAC27B,GAAAA,EAAQ,CAAA57B,SACJs2B,GAA8Bn0B,KAAImc,IAAgB,IAAD0e,EAC9C,MAAM1mB,EAAcnT,IAChB,IAGI,MAAMgK,EAAO,IAAIzM,KAAKyC,GAEhB8Y,EAAO9O,EAAK8vB,iBACZ9gB,EAAQhP,EAAK+vB,cACb5gB,EAAMnP,EAAKgwB,aAEXC,EAAY,IAAI18B,KAAKub,EAAME,EAAOG,GACxC,OAAOlZ,EAAAA,GAAAA,IAAOg6B,EAAW,aAAc,CAAE/5B,OAAQN,GAAAA,IACrD,CAAE,MAAAO,GACE,OAAOH,CACX,GAIE04B,EAA2B,GAGjCA,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACi4B,EAAAA,EAAY,CAACn4B,UAAU,YAC9BqmB,MAAOnpB,EAAE,0BAA2B,sBACpC2E,MAAM,GAADpG,OAAK8a,EAAWgI,EAAYC,aAAY,OAAA/iB,OAAM8a,EAAWgI,EAAYE,eAC1Ewd,QAAS,SAIT1d,EAAY2C,YACZ4a,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACo9B,EAAAA,EAAQ,CAACt9B,UAAU,YAC1B6B,MAAO0c,EAAY2C,WACnB+a,QAAS,gBAKb1d,EAAYuB,YACZgc,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAAC0D,EAAAA,EAAY,CAAC5D,UAAU,YAC9B6B,MAAO0c,EAAYuB,WACnBmc,QAAS,SAGb1d,EAAYqB,YACZkc,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACyD,EAAAA,EAAS,CAAC3D,UAAU,YAC3B6B,MAAO0c,EAAYqB,WACnBqc,QAAS,SAKb1d,EAAY5S,QACZmwB,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAAC87B,EAAAA,EAAkB,CAACh8B,UAAU,YACpC6B,MAAO0c,EAAY5S,OAAOL,KAC1B2wB,QAAS,SAKb1d,EAAYxZ,aACZ+2B,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACge,EAAAA,EAAQ,CAACle,UAAU,YAC1B6B,OACI3B,EAAAA,EAAAA,KAAA,KACI+E,KAAMsZ,EAAYxZ,YAClBhD,OAAO,SACPmD,IAAI,sBACJ5E,QAAUG,GAAMA,EAAEqO,kBAClB9O,UAAU,0CAAyCC,SAElD/C,EAAE,2BAA4B,kBAGvC++B,QAAS,WAMjB,MAAM1b,EAAShC,EAAYiC,oBAAsBjC,EAAYhjB,GAAGklB,WAC1Dzb,EAAcuZ,EAAYuB,WAAU,2DAAArkB,OACuB8kB,EAAM,WAAA9kB,OAAU8hC,mBAAmBhf,EAAYuB,YAAW,UACrH,KA+CN,GA9CI9a,GACA82B,EAAS9jB,KAAK,CACd+jB,MAAM77B,EAAAA,EAAAA,KAACge,EAAAA,EAAQ,CAACle,UAAU,YAC1B6B,OACIhC,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,KACI+E,KAAMD,EACNjD,OAAO,SACPmD,IAAI,sBACJ5E,QAAUG,GAAMA,EAAEqO,kBAClB9O,UAAU,gCAA+BC,SAExC/C,EAAE,2BAA4B,oBAEnCgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,8NAA6NC,SACvO+E,OAIbi3B,QAAS,WAKbH,EAAS9jB,KAAK,CACVqO,MAAOnpB,EAAE,sBAAuB,UAChC2E,OACI3B,EAAAA,EAAAA,KAAA,QAAMF,UAAS,yCAAAvE,OAA2C64B,GAA0B/V,EAAYjZ,SAAUrF,SACrG/C,EAAE,uBAADzB,OAAwB8iB,EAAYjZ,QAAUiZ,EAAYjZ,UAGpE22B,QAAS,UAIbH,EAAS9jB,KAAK,CACVqO,MAAOnpB,EAAE,6BAA8B,kBACvC2E,OACI3B,EAAAA,EAAAA,KAAA,QAAMF,UAAS,yCAAAvE,OAA2Co5B,GAAsBtW,EAAYiH,gBAAiBvlB,SACxG/C,EAAE,8BAADzB,OAA+B8iB,EAAYiH,eAAiBjH,EAAYiH,iBAGlFyW,QAAS,UAIT1d,EAAYxD,OAAQ,CACpB,MAAMyiB,EAA4C,kBAAvBjf,EAAYxD,OACjCS,WAAW+C,EAAYxD,QAAQ0iB,QAAQ,GACT,kBAAvBlf,EAAYxD,OACnBwD,EAAYxD,OAAO0iB,QAAQ,GAC3B,OACN3B,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACw9B,EAAAA,EAAkB,CAAC19B,UAAU,YACpCqmB,MAAOnpB,EAAE,sBAAuB,UAChC2E,MAAM,GAADpG,OAAK+hC,EAAW,KAAA/hC,OAAI8iB,EAAYtD,UAAY,OACjDghB,QAAS,SAEjB,CAGA,GAAI1d,EAAYkH,YAAa,CACzB,MAAMtiB,EAAkBC,IACpB,IACI,OAAOC,EAAAA,GAAAA,IAAO,IAAI1C,KAAKyC,GAAa,mBAAoB,CAAEE,OAAQN,GAAAA,IACtE,CAAE,MAAA26B,GACE,OAAOv6B,CACX,GAEJ04B,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAAC2E,EAAAA,EAAS,CAAC7E,UAAU,YAC3BqmB,MAAOnpB,EAAE,2BAA4B,gBACrC2E,MAAOsB,EAAeob,EAAYkH,aAClCwW,QAAS,SAEjB,CAGI1d,EAAYyC,SACZ8a,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAAC6D,EAAAA,EAAO,CAAC/D,UAAU,YACzBqmB,MAAO9H,EAAY6C,aAAelkB,EAAE,uBAAwB,cAC5D2E,MAAO0c,EAAYyC,QACnBib,QAAS,UAKb1d,EAAYqf,wBACZ9B,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAAC8D,EAAAA,EAAe,CAAChE,UAAU,2BACjCqmB,MAAOnpB,EAAE,6BAA8B,mBACvC2E,MAAO3E,EAAE,yBAA0B,iBACnC++B,QAAS,UAKjB,MAAM4B,EAAqB/nB,EAAc,eAAgB,QAAS,SAE9DyI,EAAYhjB,MAAuC,QAArC0hC,EAAK1G,GAA8B,UAAE,IAAA0G,OAAA,EAAhCA,EAAkC1hC,KACrDN,QAAQC,IAAI,0CAAwC,CAChD2iC,qBACAr7B,cAAe+b,EAAYhjB,GAC3BuiC,OAAQ,eACRC,YAAa,QACbC,WAAY,QACZC,2BAA4BJ,IAGpC,MAAMnB,EAAgBmB,GAClBh+B,EAAAA,EAAAA,MAAA,OAAKG,UAAU,8BAA6BC,SAAA,EAExCJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACFma,GAAoC1K,GACpC4K,IAAgC,EAAK,EAEzCnpB,UAAU,sFAAqFC,UAE/FC,EAAAA,EAAAA,KAAC2D,EAAAA,EAAiB,CAAC7D,UAAU,eAEjCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,yLAAwLC,SAClM/C,EAAE,2CAKX2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACFua,GAAkC9K,GAClCgL,IAA8B,EAAK,EAEvCvpB,UAAU,8FAA6FC,UAEvGC,EAAAA,EAAAA,KAAC6D,EAAAA,EAAO,CAAC/D,UAAU,eAEvBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,yLAAwLC,SAClM/C,EAAE,2CAIf,KAGEghC,EAAapP,GAAwBsB,IAAI7R,EAAYhjB,IACrD4iC,GACFj+B,EAAAA,EAAAA,KAAA,OAAKF,UAAU,YAAWC,UACtBC,EAAAA,EAAAA,KAACk+B,GAAAA,EAA2B,CAAC57B,cAAe+b,EAAYhjB,OAIhE,OACI2E,EAAAA,EAAAA,KAACy8B,GAAAA,EAAQ,CAELx6B,MAAOoc,EAAY3D,UACnByjB,SAAU9f,EAAYiC,mBAAkB,OAAA/kB,OAAU8iB,EAAYiC,yBAAuBle,EACrFw5B,SAAUA,EACVkB,QAASN,EACT4B,WAAYH,EAAoB,CAC5BD,WAAYA,EACZ92B,QAAS+2B,EACTI,SAAUA,IAAM3N,GAA0BrS,EAAYhjB,UACtD+G,GATCic,EAAYhjB,GAUnB,QASX,iBAAdgO,GAAgCme,KAC7BxnB,EAAAA,EAAAA,KAAA,OAAK0J,IAAK8oB,GAAyB1yB,UAAU,2BAA0BC,SAClE2nB,KACG1nB,EAAAA,EAAAA,KAACs+B,EAAAA,EAAgB,CAACrvB,KAAM,OAMrB,iBAAd5F,GAA6C,UAAb0lB,KAC7B/uB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,0CAAyCC,UACpDJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,2DAA0DC,SAAA,EACvEC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,8BAA6BC,UAC1CC,EAAAA,EAAAA,KAAA,MAAAD,SACKw3B,GAAiBr1B,KAAKouB,IACnB,MAAMwF,EAASxP,EAA4B7mB,MAAK25B,GAAOA,EAAI/9B,KAAOi1B,IAClE,OAAKwF,GAGD91B,EAAAA,EAAAA,KAAA,MAEIq6B,MAAM,MACNv6B,UAAS,qHAAAvE,OAAuH+0B,IAAa5B,GAAiB,+BAAiC,IAC/L4L,WAAW,EACXC,YAAaA,IAAMlD,GAAgB/G,GACnCzmB,WAAatJ,GAAM6I,GAAe7I,EAAG+vB,GACrC1mB,OAASrJ,GAAM4I,GAAW5I,EAAG+vB,GAC7BkK,UAAWlD,GAAcv3B,UAEzBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oBAAmBC,SAAA,CAC7BoM,OAAOC,YAAc,IAAM0pB,EAAO1P,WAAa0P,EAAO3P,MACzC,YAAbmK,IACGtwB,EAAAA,EAAAA,KAAA,UACII,QAASA,IAAMuzB,GAAsBrD,GACrCxwB,UAAU,0BAAyBC,UAEnCC,EAAAA,EAAAA,KAACy6B,EAAAA,EAAgB,CAAC36B,UAAU,mDAhBnCwwB,GAJO,IAwBX,SAKrBtwB,EAAAA,EAAAA,KAAA,SAAOF,UAAU,0EAAyEC,SACrF6nB,IACG5nB,EAAAA,EAAAA,KAAA,MAAAD,UACIC,EAAAA,EAAAA,KAAA,MAAI06B,QAASnD,GAAiB52B,OAAQb,UAAU,wCAAuCC,UACnFC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,sBAAqBC,UAChCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4FAI3BgoB,IACA9nB,EAAAA,EAAAA,KAAA,MAAAD,UACIC,EAAAA,EAAAA,KAAA,MAAI06B,QAASnD,GAAiB52B,OAAQb,UAAU,uDAAsDC,SACjG+nB,OAGgC,IAAzCuO,GAA8B11B,QAC9BX,EAAAA,EAAAA,KAAA,MAAAD,UACIC,EAAAA,EAAAA,KAAA,MAAI06B,QAASnD,GAAiB52B,OAAQb,UAAU,yDAAwDC,UACpGJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,kDAAiDC,SAAA,EAC5DC,EAAAA,EAAAA,KAACi4B,EAAAA,EAAY,CAACn4B,UAAU,gDACxBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,UAASC,SACnBmoB,IAAqD,QAA5BE,IAAwE,QAAnCE,GACzDtrB,EAAE,yBAA0B,+BAC5BA,EAAE,8BAA+B,0CAMvDgD,EAAAA,EAAAA,KAAAwJ,EAAAA,SAAA,CAAAzJ,SACKs2B,GAA8Bn0B,KAAImc,IAC/B,MAAMhI,EAAcnT,IAChB,IACI,OAAOC,EAAAA,GAAAA,IAAO,IAAI1C,KAAKyC,GAAa,aAAc,CAAEE,OAAQN,GAAAA,IAChE,CAAE,MAAAy7B,GACE,OAAOr7B,CACX,GAGJ,OACIlD,EAAAA,EAAAA,KAAA,MAEIF,UAAU,yDACVM,QAASA,IAAM4lB,EAAS,iBAADzqB,OAAkB8iB,EAAYhjB,KAAM0E,SAE1Dw3B,GAAiBr1B,KAAIouB,IAAa,IAADkO,EAC9B,OAAQlO,GACJ,IAAK,YACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,4BAA2BC,UACpDJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,uDAAsDC,SAAA,CAChEse,EAAY3D,UACZ2D,EAAYiC,qBACT3gB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,2CAA0CC,SAAA,CAAC,OACjDse,EAAYiC,0BALxBgQ,GAWjB,IAAK,SACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,QAAMF,UAAS,iEAAAvE,OAAmE64B,GAA0B/V,EAAYjZ,SAAUrF,SAC7H/C,EAAE,uBAADzB,OAAwB8iB,EAAYjZ,QAAUiZ,EAAYjZ,WAF3DkrB,GAMjB,IAAK,gBACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,QAAMF,UAAS,iEAAAvE,OAAmEo5B,GAAsBtW,EAAYiH,gBAAiBvlB,SAChI/C,EAAE,8BAADzB,OAA+B8iB,EAAYiH,eAAiBjH,EAAYiH,kBAFzEgL,GAMjB,IAAK,cACL,IAAK,eACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SACpDsW,EAAwB,gBAAbia,EAA6BjS,EAAYC,YAAcD,EAAYE,iBAF9E+R,GAMjB,IAAK,aACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SACpDse,EAAY2C,YAAc,OAF1BsP,GAMjB,IAAK,SACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,UAClC,QAAlBy+B,EAAAngB,EAAY5S,cAAM,IAAA+yB,OAAA,EAAlBA,EAAoBpzB,OAAQ,OAF5BklB,GAMjB,IAAK,aACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SACpDse,EAAYuB,YAAc,OAF1B0Q,GAMjB,IAAK,aACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SACpDse,EAAYqB,YAAc,OAF1B4Q,GAMjB,IAAK,SACD,MAAMgN,EAA4C,kBAAvBjf,EAAYxD,OACjCS,WAAW+C,EAAYxD,QAAQ0iB,QAAQ,GACT,kBAAvBlf,EAAYxD,OACnBwD,EAAYxD,OAAO0iB,QAAQ,GAC3B,OACN,OACIv9B,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,2CAA0CC,SAAA,CACpDu9B,EAAY,IAAEjf,EAAYtD,UAAY,UAFtCuV,GAMjB,IAAK,cACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SACpDse,EAAYkH,aAAcpiB,EAAAA,GAAAA,IAAO,IAAI1C,KAAK4d,EAAYkH,aAAc,mBAAoB,CAAEniB,OAAQN,GAAAA,KAAQ,OAF1GwtB,GAMjB,IAAK,UACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,gCAA+BC,SACzC6V,EAAc,eAAgB,QAAS,WACpCjW,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,EAEIJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACFma,GAAoC1K,GACpC4K,IAAgC,EAAK,EAEzCnpB,UAAU,sFAAqFC,UAE/FC,EAAAA,EAAAA,KAAC2D,EAAAA,EAAiB,CAAC7D,UAAU,eAEjCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,yLAAwLC,SAClM/C,EAAE,2CAKX2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACFua,GAAkC9K,GAClCgL,IAA8B,EAAK,EAEvCvpB,UAAU,8FAA6FC,UAEvGC,EAAAA,EAAAA,KAAC6D,EAAAA,EAAO,CAAC/D,UAAU,eAEvBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,yLAAwLC,SAClM/C,EAAE,yCAKX2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACFoX,EAAS,iBAADzqB,OAAkB8iB,EAAYhjB,IAAK,EAE/CyE,UAAU,sFAAqFC,UAE/FC,EAAAA,EAAAA,KAACi7B,EAAAA,EAAqB,CAACn7B,UAAU,eAErCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,yLAAwLC,SAClM/C,EAAE,iCAlDlBszB,GA0DjB,QACI,OAAO,KACf,KA/JCjS,EAAYhjB,GAiKhB,aAWtB,UAAdgO,GAAyBud,KACtB5mB,EAAAA,EAAAA,KAAA,OAAK0J,IAAK6oB,GAAkBzyB,UAAU,2BAA0BC,SAC3D+mB,KACG9mB,EAAAA,EAAAA,KAACs+B,EAAAA,EAAgB,CAACrvB,KAAM,OAMrB,iBAAd5F,GAAgCqgB,KAC7B1pB,EAAAA,EAAAA,KAAA,OAAK0J,IAAK+oB,GAAyB3yB,UAAU,2BAA0BC,SAClE6pB,KACG5pB,EAAAA,EAAAA,KAACs+B,EAAAA,EAAgB,CAACrvB,KAAM,WAOxCjP,EAAAA,EAAAA,KAAA,OAAKF,UAAU,8HAA6HC,UACxIC,EAAAA,EAAAA,KAACmhB,GAAe,UAKxBxhB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,kBAAiBC,SAAA,EAE5BC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,OAAMC,UACjBC,EAAAA,EAAAA,KAACmhB,GAAe,OAIpBxhB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,wHAAuHC,SAAA,EAClIJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,8DAA6DC,SAAA,EAExEJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oBAAmBC,SAAA,CACf,UAAdsJ,GAAyBuM,EAAc,QAAS,QAAS,WACtDjW,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAASA,IAAMqsB,IAAqB,GACpC3sB,UAAU,+MACV8R,MAAO,CAAEkmB,MAAO,UAAWC,OAAQ,WACnC,aAAY/6B,EAAE,oBACd,kBAAgB,qBAAoB+C,UAEpCC,EAAAA,EAAAA,KAACg4B,EAAAA,EAAQ,CAACl4B,UAAU,eAExBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,yBAIA,iBAAdqM,GAAgCuM,EAAc,eAAgB,QAAS,WACpEjW,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAASA,IAAMqoB,IAAgC,GAC/C3oB,UAAU,+MACV8R,MAAO,CAAEkmB,MAAO,UAAWC,OAAQ,WACnC,aAAY/6B,EAAE,wCAAyC,qBAAqB+C,UAE5EC,EAAAA,EAAAA,KAACg4B,EAAAA,EAAQ,CAACl4B,UAAU,eAExBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,wCAAyC,8BAO5DgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oBAAmBC,UAC9BJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,uEAAsEC,SAAA,EACjFJ,EAAAA,EAAAA,MAAA,UACIS,QAASA,IAAMkJ,EAAa,SAC5BxJ,UAAS,+FAAAvE,OACS,UAAd8N,EACM,mDACA,0HACPtJ,SAAA,EAEHC,EAAAA,EAAAA,KAAC8D,EAAAA,EAAe,CAAChE,UAAU,0BAC1B9C,EAAE,cAAe,cAErB4Y,EAAc,eAAgB,OAAQ,WACnCjW,EAAAA,EAAAA,MAAA,UACIS,QAASA,IAAMkJ,EAAa,gBAC5BxJ,UAAS,+FAAAvE,OACS,iBAAd8N,EACM,mDACA,0HACPtJ,SAAA,EAEHC,EAAAA,EAAAA,KAACi4B,EAAAA,EAAY,CAACn4B,UAAU,0BACvB9C,EAAE,qBAAsB,mBAGhC4Y,EAAc,gBAAiB,OAAQ,WACpCjW,EAAAA,EAAAA,MAAA,UACIS,QAASA,IAAMkJ,EAAa,gBAC5BxJ,UAAS,+FAAAvE,OACS,iBAAd8N,EACM,mDACA,0HACPtJ,SAAA,EAEHC,EAAAA,EAAAA,KAACk4B,EAAAA,EAAyB,CAACp4B,UAAU,0BACpC9C,EAAE,qBAAsB,2BAOzC2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,4BAA2BC,SAAA,EACtCC,EAAAA,EAAAA,KAAA,SACImC,KAAK,OACL2H,YAAa9M,EAAE,iBAAmB,MAClC8C,UAAU,yPACV6B,MAAqB,UAAd0H,EAAwB6d,GAAagB,GAC5CtmB,SAAWrB,IACW,UAAd8I,EACA8d,GAAc5mB,EAAEsB,OAAOF,OAEvBwmB,GAAyB5nB,EAAEsB,OAAOF,MACtC,IAKO,iBAAd0H,IACG1J,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAASpB,UACL,IACI2pB,IAAuB,SACjBztB,EAAAA,EAAcC,KAAKS,EAAAA,GAAcu8B,aAAaC,MACpDh7B,EAAYJ,EAAE,2BAA4B,2CAA4C,iBAChFugB,QAAiBnb,OAAWA,GAAW,EAAO,GAAI,EAC5D,CAAE,MAAO7C,GAAW,IAADk/B,EAAAC,EACXxM,EAGJ90B,GACgB,QAAZqhC,EAAAl/B,EAAItE,gBAAQ,IAAAwjC,GAAM,QAANC,EAAZD,EAAc3jC,YAAI,IAAA4jC,OAAN,EAAZA,EAAoBn9B,UAAWvE,EAAE,yBAA0B,+BAC3D,QAER,CAAC,QACG2rB,IAAuB,EAC3B,GAEJ5mB,SAAU2mB,GACV5oB,UAAU,0GAAyGC,UAEnHC,EAAAA,EAAAA,KAAC2L,EAAAA,EAAa,CAAC7L,UAAS,WAAAvE,OAAamtB,GAAsB,eAAiB,SAEhF1oB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM2oB,GAAsB1rB,EAAE,uBAAwB,qBAAuBA,EAAE,oBAAqB,yBAM3G2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACIF,UAAS,2DAAAvE,OACQ,UAAbwzB,GAAuB,kEAAoE,IAE/F3uB,QAASA,IAAMutB,GAA4B,UAAboB,GAAuB,QAAU,SAAShvB,SAE1D,UAAbgvB,IACG/uB,EAAAA,EAAAA,KAACq4B,EAAAA,EAAc,CAACv4B,UAAU,aAE1BE,EAAAA,EAAAA,KAACs4B,EAAAA,EAAc,CAACx4B,UAAU,eAGlCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SAC1K/C,EAAV,UAAb+xB,GAAyB,qBAA0B,4BAK5DpvB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sBAAqBC,SAAA,EAChCJ,EAAAA,EAAAA,MAAA,UACIG,UAAS,kBAAAvE,OAAoBy4B,KAAyB,EAAI,kEAAoE,2CAA0C,aACxK5zB,QAASA,IAAM+rB,IAAsBD,IAAmBnsB,SAAA,EAExDC,EAAAA,EAAAA,KAACu4B,EAAAA,EAAU,CAACz4B,UAAU,YACrBk0B,KAAyB,IACtBh0B,EAAAA,EAAAA,KAAA,QAAMF,UAAU,gHAA+GC,SAC1Hi0B,WAIbh0B,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,uBAKXgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,OAAMC,UACjBC,EAAAA,EAAAA,KAACw4B,EAAAA,EAAiB,CACdC,QAAuB,UAAdpvB,EACW,UAAb0lB,GACG,CACE,CAAE1zB,GAAI,QAAS8qB,MAAOnpB,EAAE,wBACxB,CAAE3B,GAAI,SAAU8qB,MAAOnpB,EAAE,yBACzB,CAAE3B,GAAI,cAAe8qB,MAAOnpB,EAAE,8BAC9B,CAAE3B,GAAI,iBAAkB8qB,MAAOnpB,EAAE,iCACjC,CAAE3B,GAAI,SAAU8qB,MAAOnpB,EAAE,yBACzB,CAAE3B,GAAI,UAAW8qB,MAAOnpB,EAAE,0BAC1B,CAAE3B,GAAI,cAAe8qB,MAAOnpB,EAAE,+BAEhCkpB,EACU,iBAAd7c,EACc,UAAb0lB,GACG,CACE,CAAE1zB,GAAI,YAAa8qB,MAAOnpB,EAAE,iCAAkC,SAC9D,CAAE3B,GAAI,SAAU8qB,MAAOnpB,EAAE,8BAA+B,WACxD,CAAE3B,GAAI,gBAAiB8qB,MAAOnpB,EAAE,qCAAsC,mBACtE,CAAE3B,GAAI,cAAe8qB,MAAOnpB,EAAE,mCAAoC,aAClE,CAAE3B,GAAI,eAAgB8qB,MAAOnpB,EAAE,oCAAqC,cACpE,CAAE3B,GAAI,aAAc8qB,MAAOnpB,EAAE,kCAAmC,WAChE,CAAE3B,GAAI,aAAc8qB,MAAOnpB,EAAE,kCAAmC,WAChE,CAAE3B,GAAI,aAAc8qB,MAAOnpB,EAAE,kCAAmC,YAChE,CAAE3B,GAAI,SAAU8qB,MAAOnpB,EAAE,8BAA+B,WACxD,CAAE3B,GAAI,cAAe8qB,MAAOnpB,EAAE,mCAAoC,kBAEpEspB,EACJ,GACNoS,eAA6B,UAAb3J,GACVzyB,MAAMq8B,KAAK3I,IACXuH,GACNlI,YAA0B,UAAbN,GACPK,GACApC,GAASqC,YACfuJ,yBAA2BtI,IACvB,GAAiB,UAAbvB,IACA,GAAkB,UAAd1lB,EAAuB,CACvB,MAAMwvB,EAAcpT,GAAmB6K,GACvC,GAAIuI,EAEA,GAAoB,iCAAhBA,EAAgD,CAEhD,MAAMC,EAA6B,gBAAbxI,EAA6B,iBAAmB,cAClDX,GAAmBO,IAAI4I,GACnB9L,GAAS8C,cAAcxpB,SAASuyB,GAIpDtL,GAAuBsL,EAW/B,MAEItL,GAAuBsL,EAGnC,MAAO,GAAkB,iBAAdxvB,EAA8B,CAErC,MAAMwvB,EAAclT,GAA8B2K,GAC9CuI,GACAtL,GAAuBsL,EAE/B,OAEAtL,GAAuB+C,EAC3B,EAEJyI,aAA2B,UAAbhK,GACR,CAACkI,EAAmBC,KAClB,MAAM8B,EAAe,IAAI5J,IACnB6J,EAAUD,EAAa/B,GAC7B+B,EAAa5B,OAAOH,EAAW,GAC/B+B,EAAa5B,OAAOF,EAAY,EAAG+B,GAEnC,MAAMC,EAA0B,GAC1BC,EAAmB,IAAIrK,IAEX,UAAdzlB,GACA2vB,EAAapmB,SAAQ4c,IACjB,MAAMD,EAAW9J,GAAmB+J,GAChCD,IAAa4J,EAAiBjJ,IAAIX,KAClC4J,EAAiBhK,IAAII,GACrB2J,EAAcphB,KAAKyX,GACvB,IAGJrJ,EAAiBtT,SAAQwmB,IAChBF,EAAc5yB,SAAS8yB,EAAI/9B,KAAkB,YAAX+9B,EAAI/9B,IACvC69B,EAAcphB,KAAKshB,EAAI/9B,GAC3B,KAEiB,iBAAdgO,IAEP2vB,EAAapmB,SAAQ4c,IACjB,MAAMD,EAAW5J,GAA8B6J,GAC3CD,IAAa4J,EAAiBjJ,IAAIX,KAClC4J,EAAiBhK,IAAII,GACrB2J,EAAcphB,KAAKyX,GACvB,IAGJjJ,EAA4B1T,SAAQwmB,IAC3BF,EAAc5yB,SAAS8yB,EAAI/9B,KAAkB,YAAX+9B,EAAI/9B,IACvC69B,EAAcphB,KAAKshB,EAAI/9B,GAC3B,KAIR8xB,GAAkB+L,EAAc,EAElClC,GACNqC,YAAoCr8B,EAAV,UAAb+xB,GAAyB,6BAAkC,yBACxEuK,WAAmCt8B,EAAV,UAAb+xB,GAAyB,6BAAkC,yBACvEgD,eAA6B,UAAbhD,IAAsC,UAAd1lB,EAClC8mB,GACa,UAAbpB,IAAsC,iBAAd1lB,EACxBknB,QACAnuB,EACNm3B,sBAAoC,UAAbxK,IAAsC,UAAd1lB,EACzCgnB,GACa,UAAbtB,IAAsC,iBAAd1lB,EACxBonB,QACAruB,EACNo3B,kBAAgC,UAAbzK,KAAuC,UAAd1lB,GAAuC,iBAAdA,GACrEzM,QAASA,iBAOxBsvB,KACGlsB,EAAAA,EAAAA,KAAA,OAAKF,UAAwB,UAAbivB,GAAuB,+CAAiD,uBAAuBhvB,SAC5F,UAAdsJ,GACGrJ,EAAAA,EAAAA,KAACy5B,GAAAA,EAAU,CACPhB,QAAS,IAAIvS,KAAqBG,GAClCqT,QAAS5H,GACT6H,QAAS1F,GACT2F,gBAAiBpO,GACjBqO,eAAgBnO,GAChBoO,oBAAqBlO,GACrBmO,uBAAwBlO,GACxBmO,QAAS9U,MAGbllB,EAAAA,EAAAA,KAACy5B,GAAAA,EAAU,CACPhB,QAAS,IAAInS,KAAgCC,GAC7CmT,QAASvH,GACTwH,QAASzF,GACT0F,gBAAiB9O,GACjB+O,eAAgB7O,GAChB8O,oBAAqB5O,GACrB6O,uBAAwB5O,GACxB6O,QAAS7U,QAOzBnlB,EAAAA,EAAAA,KAACi6B,GAAAA,EAAe,CACZD,QAAuB,UAAd3wB,EAAwB6b,GAAiBC,GAClD+U,eAA8B,UAAd7wB,EAAwByoB,GAAwBK,GAChEwH,QAAuB,UAAdtwB,EAAwB4qB,GAAwBC,GACzDpI,iBAAgC,UAAdziB,EAAwByiB,GAAmBV,GAC7DY,iBAAgC,UAAd3iB,EAAwB2iB,GAAmBV,GAC7D6O,eAA8B,UAAd9wB,EAAwB+oB,GAAqBC,GAC7D+H,kBAAiC,UAAd/wB,EAAwBrM,EAAE,yBAA2B,QAI7D,UAAdqM,GAAsC,UAAb0lB,IAEtB/uB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,kBAAiBC,UAC5BJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,2DAA2D,kBAAgB,YAAWC,SAAA,EACnGC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,8BAA6BC,UAC1CC,EAAAA,EAAAA,KAAA,MAAAD,SACKw3B,GAAiBr1B,KAAKouB,IACnB,MAAMwF,EAAS5P,EAAiBzmB,MAAK25B,GAAOA,EAAI/9B,KAAOi1B,IACvD,OAAKwF,GAGD91B,EAAAA,EAAAA,KAAA,MAEIq6B,MAAM,MACNv6B,UAAS,qHAAAvE,OAAuH+0B,IAAa5B,GAAiB,+BAAiC,IAC/L4L,WAAW,EACXC,YAAaA,IAAMlD,GAAgB/G,GACnCzmB,WAAatJ,GAAM6I,GAAe7I,EAAG+vB,GACrC1mB,OAASrJ,GAAM4I,GAAW5I,EAAG+vB,GAC7BkK,UAAWlD,GAAcv3B,UAEzBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oBAAmBC,SAAA,CAC7BoM,OAAOC,YAAc,IAAM0pB,EAAO1P,WAAa0P,EAAO3P,MACzC,YAAbmK,IACGtwB,EAAAA,EAAAA,KAAA,UACII,QAASA,IAAMszB,GAAWpD,GAC1BxwB,UAAU,0BAAyBC,UAEnCC,EAAAA,EAAAA,KAACy6B,EAAAA,EAAgB,CAAC36B,UAAU,mDAhBnCwwB,GAJO,IAwBX,SAKrBtwB,EAAAA,EAAAA,KAAA,SAAOF,UAAU,0EAAyEC,SACrFpB,IACGqB,EAAAA,EAAAA,KAAA,MAAAD,UACIC,EAAAA,EAAAA,KAAA,MAAI06B,QAASnD,GAAiB52B,OAAQb,UAAU,wCAAuCC,UACnFC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,sBAAqBC,UAChCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4FAI3BrB,IACAuB,EAAAA,EAAAA,KAAA,MAAAD,UACIC,EAAAA,EAAAA,KAAA,MAAI06B,QAASnD,GAAiB52B,OAAQb,UAAU,uDAAsDC,SACjGtB,OAGyB,IAAlCu2B,GAAuBr0B,QACvBX,EAAAA,EAAAA,KAAA,MAAAD,UACIC,EAAAA,EAAAA,KAAA,MAAI06B,QAASnD,GAAiB52B,OAAQb,UAAU,yDAAwDC,UACpGJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,kDAAiDC,SAAA,EAChEC,EAAAA,EAAAA,KAACk4B,EAAAA,EAAyB,CAACp4B,UAAU,gDACrCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,UAASC,SAAE/C,EAAE,gCAKxCgD,EAAAA,EAAAA,KAAAwJ,EAAAA,SAAA,CAAAzJ,SACCi1B,GAAuB9yB,KAAImQ,IAC5B,MAAMsoB,GAAeC,EAAAA,GAAAA,IAAgBvoB,EAAKjK,QAAS,YAAQhG,EAAWiQ,EAAKpQ,MAAOoQ,EAAK7K,aACjFqzB,GAAeC,EAAAA,GAAAA,IAAsBH,GAE3C,OACI36B,EAAAA,EAAAA,KAAA,MAEIF,UAAS,2CAAAvE,OACY,SAAjBo/B,EAAuB,GAAAp/B,OAAMs/B,EAAaE,QAAO,KAAAx/B,OAAIs/B,EAAaG,YAAW,eAAgB,IAC9Fj7B,SAEFw3B,GAAiBr1B,KAAIouB,IACtB,OAAQA,GACJ,IAAK,QACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,4BAA2BC,UACpDJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,yEAAwEC,SAAA,CAClFsS,EAAKpQ,MACDoQ,EAAK7K,cACF7H,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sBAAqBC,SAAA,EAChCC,EAAAA,EAAAA,KAAA,UACIF,UAAU,gFAA+EC,UAEzFC,EAAAA,EAAAA,KAACi7B,EAAAA,EAAqB,CAACn7B,UAAU,eAErCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,4BAEPgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,+RAA8RC,UACzSC,EAAAA,EAAAA,KAACk7B,GAAAA,EAAe,CAACh0B,QAASmL,EAAK7K,YAAa2zB,kBAAkB,aAd7E7K,GAqBb,IAAK,SACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,QAAMF,UAAS,iEAAAvE,QAAmE6/B,EAAAA,GAAAA,IAAe/oB,EAAKjN,OAAQ,QAAO,kCAAiCrF,SACjJsS,EAAKjN,UAFLkrB,GAMjB,IAAK,+BACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gBAAeC,SAAA,EAC1BJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,2CAA0CC,SAAA,EACrDJ,EAAAA,EAAAA,MAAA,QAAMG,UAAU,4DAA2DC,SAAA,CAAE/C,EAAE,6BAA6B,QAC5G2C,EAAAA,EAAAA,MAAA,QAAMG,UAAU,4DAA2DC,SAAA,CAAE/C,EAAE,6BAA6BmK,UAAU,EAAG,GAAG,QAAQnH,EAAAA,EAAAA,KAAA,SACnIqS,EAAK3B,YAAW,GAAAnV,OAAM8W,EAAK3B,YAAYpF,UAAS,KAAA/P,OAAI8W,EAAK3B,YAAYnF,UAAa8G,EAAK7G,KAAO6G,EAAK7G,KAAKJ,KAAO,QAEpHzL,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gDAA+CC,SAAA,EAC1DC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,4DAA2DC,SAAE/C,EAAE,gCAC/E2C,EAAAA,EAAAA,MAAA,QAAMG,UAAU,4DAA2DC,SAAA,CAAE/C,EAAE,gCAAgCmK,UAAU,EAAG,GAAG,QAAQnH,EAAAA,EAAAA,KAAA,SACtIqS,EAAK5B,eAAc,GAAAlV,OAAM8W,EAAK5B,eAAenF,UAAS,KAAA/P,OAAI8W,EAAK5B,eAAelF,UAAa,WAV/F+kB,GAejB,IAAK,SACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SAAEsS,EAAK5G,OAAOL,QADlEklB,GAIjB,IAAK,UACD,MAAMqO,GAAuB/D,EAAAA,GAAAA,IAAgBvoB,EAAKjK,QAAS,YAAQhG,EAAWiQ,EAAKpQ,MAAOoQ,EAAK7K,aACzFo3B,GAAuB9D,EAAAA,GAAAA,IAAsB6D,GACnD,OACI3+B,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEJ,EAAAA,EAAAA,MAAA,OAAKG,UAAS,WAAAvE,OAAsC,SAAzBojC,EAAkCC,EAAqBrD,UAAY,oCAAqCx7B,SAAA,CAC9HsS,EAAKjK,QAAU,IAAI3H,KAAK4R,EAAKjK,SAASozB,qBAAuB,IACpC,SAAzBmD,IACG3+B,EAAAA,EAAAA,KAAA,QAAMF,UAAU,eAAcC,SAAC,eAJlCuwB,GASjB,IAAK,UACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gCAA+BC,SAAA,EAC1CC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,iBAAgBC,SAC1B6zB,GAAoBvhB,KAExBuD,EAAc,QAAS,QAAS,WAC7BjW,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAASA,KACLysB,GAAgBxa,GAChBsa,IAAmB,EAAK,EAE5B7sB,UAAU,sFAAqFC,UAE/FC,EAAAA,EAAAA,KAACy7B,EAAAA,EAAU,CAAC37B,UAAU,eAE1BE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,oBAId4Y,EAAc,QAAS,OAAQ,WAC5BjW,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAASA,IAAMs3B,GAAerlB,GAC9BvS,UAAU,0FAAyFC,UAEnGC,EAAAA,EAAAA,KAAC07B,EAAAA,EAAqB,CAAC57B,UAAU,eAErCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,2BAId4Y,EAAc,QAAS,SAAU,WAC9BjW,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAASA,IAAMy3B,GAAiBxlB,EAAKhX,IACrCyE,UAAU,kFAAiFC,UAE3FC,EAAAA,EAAAA,KAACuZ,EAAAA,EAAS,CAACzZ,UAAU,eAEzBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,0BA3CdszB,GAkDjB,QACI,OAAO,KACf,KAhICje,EAAKhX,GAkIL,aAQX,UAAdgO,GAEArJ,EAAAA,EAAAA,KAAA,OAAKF,UAAU,0BAAyBC,SAEnCpB,IAA4B,IAAjB6nB,EAAM7lB,QACdX,EAAAA,EAAAA,KAAC27B,GAAAA,EAAQ,CAAA57B,SACJzD,MAAM,GAAG6N,KAAK,MAAMjI,KAAI,CAAC+N,EAAGzB,KACzBxO,EAAAA,EAAAA,KAAA,OAA2BF,UAAU,sHAAqHC,UACtJJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWC,SAAA,EAEtBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,+BAA8BC,SAAA,EACzCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mDACfE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,gEAGnBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mDAEfH,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWC,SAAA,EACtBC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oDACfE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oDACfE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,0DAEjB,YAAAvE,OAfYiT,QAmB9B/P,IACAuB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2DAA0DC,SACpEtB,KAE6B,IAAlCu2B,GAAuBr0B,QACvBhB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,mFAAkFC,SAAA,EAC7FC,EAAAA,EAAAA,KAACk4B,EAAAA,EAAyB,CAACp4B,UAAU,qDACrCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,UAASC,SAAC,+BAG7BC,EAAAA,EAAAA,KAAC27B,GAAAA,EAAQ,CAAA57B,SACJi1B,GAAuB9yB,KAAImQ,KACHuoB,EAAAA,GAAAA,IAAgBvoB,EAAKjK,QAAS,YAAQhG,EAAWiQ,EAAKpQ,MAAOoQ,EAAK7K,aAAvF,MAGMo0B,EAA2B,GAajC,GAVI5L,GAAoBE,IAAI,WACxB0L,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAAC87B,EAAAA,EAAkB,CAACh8B,UAAU,YACpCqmB,MAAOnpB,EAAE,wBACT2E,MAAO0Q,EAAK5G,OAAOL,KACnB2wB,QAAS,SAKb/L,GAAoBE,IAAI,eAAgB,CAExC,MAAM8L,EAAmB3pB,EAAK3B,YAAW,GAAAnV,OAAM8W,EAAK3B,YAAYpF,UAAS,KAAA/P,OAAI8W,EAAK3B,YAAYnF,UAAc8G,EAAK7G,KAAO6G,EAAK7G,KAAKJ,KAAO,IACnI6wB,EAAgBD,EAAiBr7B,OAAS,GAA0B,MAArBq7B,EAA2BA,EAAiB70B,UAAU,EAAG,GAAK60B,EACnHJ,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACk8B,EAAAA,EAAQ,CAACp8B,UAAU,YAC1BqmB,MAAOnpB,EAAE,6BACT2E,MAAOs6B,EACPF,QAAS,QAEjB,CACA,GAAI/L,GAAoBE,IAAI,kBAAmB,CAE3C,MAAMiM,EAAsB9pB,EAAK5B,eAAc,GAAAlV,OAAM8W,EAAK5B,eAAenF,UAAS,KAAA/P,OAAI8W,EAAK5B,eAAelF,UAAa,IACjH0wB,EAAgBE,EAAoBx7B,OAAS,GAA6B,MAAxBw7B,EAA8BA,EAAoBh1B,UAAU,EAAG,GAAKg1B,EAC5HP,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACk8B,EAAAA,EAAQ,CAACp8B,UAAU,YAC1BqmB,MAAOnpB,EAAE,gCACT2E,MAAOs6B,EACPF,QAAS,eAEjB,CAGA,GAAI/L,GAAoBE,IAAI,WAAY,CACpC,MAAMkM,GAAcC,EAAAA,GAAAA,IAChBhqB,EAAKjK,QACL,OACAiK,EAAKpQ,MACLoQ,EAAK7K,aACLxH,EAAAA,EAAAA,KAACi4B,EAAAA,EAAY,CAACn4B,UAAU,YACxB9C,EAAE,0BACDkQ,IAAS/J,EAAAA,GAAAA,IAAO+J,EAAM,aAAc,CAAE9J,OAAQN,GAAAA,OAC/C,GAEJ84B,EAAS9jB,MAAItC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EACR4mB,GAAW,IACdL,QAAS,iBAEjB,CAGI/L,GAAoBE,IAAI,gBAAkB7d,EAAK7K,aAC/Co0B,EAAS9jB,KAAK,CACVqO,MAAOnpB,EAAE,6BACT2E,MAAO,GACP26B,mBAAoBjqB,EAAK7K,YACzB+0B,mBAAoBlqB,EAAK4D,aAAe,GACxC8lB,QAAS,SAKjB,MAAMS,GACF78B,EAAAA,EAAAA,MAAA,OAAKG,UAAU,8BAA6BC,SAAA,EAExCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,iBAAgBC,SAC1B6zB,GAAoBvhB,KAExBuD,EAAc,QAAS,QAAS,WAC7B5V,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACFie,GAAgBxa,GAChBsa,IAAmB,EAAK,EAER7sB,UAAU,sFAAqFC,UAEnHC,EAAAA,EAAAA,KAACy7B,EAAAA,EAAU,CAAC37B,UAAU,cAG7B8V,EAAc,QAAS,OAAQ,WAC5BjW,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACF8oB,GAAerlB,EAAK,EAExBvS,UAAU,0FAAyFC,UAEnGC,EAAAA,EAAAA,KAAC07B,EAAAA,EAAqB,CAAC57B,UAAU,eAErCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wLAAuLC,SACjM/C,EAAE,8BAOvB,OACIgD,EAAAA,EAAAA,KAACy8B,GAAAA,EAAQ,CAELx6B,OACEtC,EAAAA,EAAAA,MAAA,QAAAI,SAAA,EACEJ,EAAAA,EAAAA,MAAA,QAAMG,UAAU,2CAA0CC,SAAA,CAAEsS,EAAKhX,GAAG,OAAS,KAC7E2E,EAAAA,EAAAA,KAAA,QAAAD,SAAOsS,EAAKpQ,WAGhBmD,OAAQ,CACJ+gB,OAAOuW,EAAAA,GAAAA,IAAcrqB,EAAKjN,OAAQ,OAAQpI,GAC1C2/B,OAAOvB,EAAAA,GAAAA,IAAe/oB,EAAKjN,OAAQ,QACnCw3B,qBAAiBx6B,EACjBy6B,iBAAaz6B,GAEjBw5B,SAAUA,EACVkB,QAASN,GAdJnqB,EAAKhX,GAeZ,QAMtB,KAGW,iBAAdgO,GAA6C,UAAb0lB,KAC7B/uB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,0BAAyBC,SACnC6nB,IACG5nB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4BAA2BC,UACtCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wFAEnBgoB,IACA9nB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2DAA0DC,SACpE+nB,KAEoC,IAAzCuO,GAA8B11B,QAC9BhB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,mFAAkFC,SAAA,EAC7FC,EAAAA,EAAAA,KAACi4B,EAAAA,EAAY,CAACn4B,UAAU,qDACxBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,UAASC,SACnBmoB,IAAqD,QAA5BE,IAAwE,QAAnCE,GACzDtrB,EAAE,yBAA0B,+BAC5BA,EAAE,8BAA+B,sCAI/CgD,EAAAA,EAAAA,KAAC27B,GAAAA,EAAQ,CAAA57B,SACJs2B,GAA8Bn0B,KAAImc,IAC/B,MAAMhI,EAAcnT,IAChB,IAGI,MAAMgK,EAAO,IAAIzM,KAAKyC,GAEhB8Y,EAAO9O,EAAK8vB,iBACZ9gB,EAAQhP,EAAK+vB,cACb5gB,EAAMnP,EAAKgwB,aAEXC,EAAY,IAAI18B,KAAKub,EAAME,EAAOG,GACxC,OAAOlZ,EAAAA,GAAAA,IAAOg6B,EAAW,aAAc,CAAE/5B,OAAQN,GAAAA,IACrD,CAAE,MAAA+7B,GACE,OAAO37B,CACX,GAIE04B,EAA2B,GAGjCA,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACi4B,EAAAA,EAAY,CAACn4B,UAAU,YAC9BqmB,MAAOnpB,EAAE,0BAA2B,sBACpC2E,MAAM,GAADpG,OAAK8a,EAAWgI,EAAYC,aAAY,OAAA/iB,OAAM8a,EAAWgI,EAAYE,eAC1Ewd,QAAS,SAIT1d,EAAY2C,YACZ4a,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACo9B,EAAAA,EAAQ,CAACt9B,UAAU,YAC1B6B,MAAO0c,EAAY2C,WACnB+a,QAAS,gBAKb1d,EAAYuB,YACZgc,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAAC0D,EAAAA,EAAY,CAAC5D,UAAU,YAC9B6B,MAAO0c,EAAYuB,WACnBmc,QAAS,SAGb1d,EAAYqB,YACZkc,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACyD,EAAAA,EAAS,CAAC3D,UAAU,YAC3B6B,MAAO0c,EAAYqB,WACnBqc,QAAS,SAKb1d,EAAY5S,QACZmwB,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAAC87B,EAAAA,EAAkB,CAACh8B,UAAU,YACpC6B,MAAO0c,EAAY5S,OAAOL,KAC1B2wB,QAAS,SAKb1d,EAAYxZ,aACZ+2B,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACge,EAAAA,EAAQ,CAACle,UAAU,YAC1B6B,OACI3B,EAAAA,EAAAA,KAAA,KACI+E,KAAMsZ,EAAYxZ,YAClBhD,OAAO,SACPmD,IAAI,sBACJ5E,QAAUG,GAAMA,EAAEqO,kBAClB9O,UAAU,0CAAyCC,SAElD/C,EAAE,2BAA4B,kBAGvC++B,QAAS,WAMjB,MAAM1b,EAAShC,EAAYiC,oBAAsBjC,EAAYhjB,GAAGklB,WAC1Dzb,EAAcuZ,EAAYuB,WAAU,2DAAArkB,OACuB8kB,EAAM,WAAA9kB,OAAU8hC,mBAAmBhf,EAAYuB,YAAW,UACrH,KA+CN,GA9CI9a,GACA82B,EAAS9jB,KAAK,CACd+jB,MAAM77B,EAAAA,EAAAA,KAACge,EAAAA,EAAQ,CAACle,UAAU,YAC1B6B,OACIhC,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,KACI+E,KAAMD,EACNjD,OAAO,SACPmD,IAAI,sBACJ5E,QAAUG,GAAMA,EAAEqO,kBAClB9O,UAAU,gCAA+BC,SAExC/C,EAAE,2BAA4B,oBAEnCgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,8NAA6NC,SACvO+E,OAIbi3B,QAAS,WAKbH,EAAS9jB,KAAK,CACVqO,MAAOnpB,EAAE,sBAAuB,UAChC2E,OACI3B,EAAAA,EAAAA,KAAA,QAAMF,UAAS,yCAAAvE,OAA2C64B,GAA0B/V,EAAYjZ,SAAUrF,SACrG/C,EAAE,uBAADzB,OAAwB8iB,EAAYjZ,QAAUiZ,EAAYjZ,UAGpE22B,QAAS,UAIbH,EAAS9jB,KAAK,CACVqO,MAAOnpB,EAAE,6BAA8B,kBACvC2E,OACI3B,EAAAA,EAAAA,KAAA,QAAMF,UAAS,yCAAAvE,OAA2Co5B,GAAsBtW,EAAYiH,gBAAiBvlB,SACxG/C,EAAE,8BAADzB,OAA+B8iB,EAAYiH,eAAiBjH,EAAYiH,iBAGlFyW,QAAS,UAIT1d,EAAYxD,OAAQ,CACpB,MAAMyiB,EAA4C,kBAAvBjf,EAAYxD,OACjCS,WAAW+C,EAAYxD,QAAQ0iB,QAAQ,GACT,kBAAvBlf,EAAYxD,OACnBwD,EAAYxD,OAAO0iB,QAAQ,GAC3B,OACN3B,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAACw9B,EAAAA,EAAkB,CAAC19B,UAAU,YACpCqmB,MAAOnpB,EAAE,sBAAuB,UAChC2E,MAAM,GAADpG,OAAK+hC,EAAW,KAAA/hC,OAAI8iB,EAAYtD,UAAY,OACjDghB,QAAS,SAEjB,CAGA,GAAI1d,EAAYkH,YAAa,CACzB,MAAMtiB,EAAkBC,IACpB,IACI,OAAOC,EAAAA,GAAAA,IAAO,IAAI1C,KAAKyC,GAAa,mBAAoB,CAAEE,OAAQN,GAAAA,IACtE,CAAE,MAAAg8B,GACE,OAAO57B,CACX,GAEJ04B,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAAC2E,EAAAA,EAAS,CAAC7E,UAAU,YAC3BqmB,MAAOnpB,EAAE,2BAA4B,gBACrC2E,MAAOsB,EAAeob,EAAYkH,aAClCwW,QAAS,SAEjB,CAGI1d,EAAYyC,SACZ8a,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAAC6D,EAAAA,EAAO,CAAC/D,UAAU,YACzBqmB,MAAO9H,EAAY6C,aAAelkB,EAAE,uBAAwB,cAC5D2E,MAAO0c,EAAYyC,QACnBib,QAAS,UAKb1d,EAAYqf,wBACZ9B,EAAS9jB,KAAK,CACV+jB,MAAM77B,EAAAA,EAAAA,KAAC8D,EAAAA,EAAe,CAAChE,UAAU,2BACjCqmB,MAAOnpB,EAAE,6BAA8B,mBACvC2E,MAAO3E,EAAE,yBAA0B,iBACnC++B,QAAS,UAKjB,MACMS,EADqB5mB,EAAc,eAAgB,QAAS,UAE9DjW,EAAAA,EAAAA,MAAA,OAAKG,UAAU,8BAA6BC,SAAA,EAExCJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACFma,GAAoC1K,GACpC4K,IAAgC,EAAK,EAEzCnpB,UAAU,sFAAqFC,UAE/FC,EAAAA,EAAAA,KAAC2D,EAAAA,EAAiB,CAAC7D,UAAU,eAEjCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,yLAAwLC,SAClM/C,EAAE,2CAKX2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACFua,GAAkC9K,GAClCgL,IAA8B,EAAK,EAEvCvpB,UAAU,8FAA6FC,UAEvGC,EAAAA,EAAAA,KAAC6D,EAAAA,EAAO,CAAC/D,UAAU,eAEvBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,yLAAwLC,SAClM/C,EAAE,2CAIf,KAGEghC,EAAapP,GAAwBsB,IAAI7R,EAAYhjB,IACrD4iC,GACFj+B,EAAAA,EAAAA,KAAA,OAAKF,UAAU,YAAWC,UACtBC,EAAAA,EAAAA,KAACk+B,GAAAA,EAA2B,CAAC57B,cAAe+b,EAAYhjB,OAIhE,OACI2E,EAAAA,EAAAA,KAACy8B,GAAAA,EAAQ,CAELx6B,MAAOoc,EAAY3D,UACnByjB,SAAU9f,EAAYiC,mBAAkB,OAAA/kB,OAAU8iB,EAAYiC,yBAAuBle,EACrFw5B,SAAUA,EACVkB,QAASN,EACT4B,WAAYH,EAAoB,CAC5BD,WAAYA,EACZ92B,QAAS+2B,EACTI,SAAUA,IAAM3N,GAA0BrS,EAAYhjB,UACtD+G,GATCic,EAAYhjB,GAUnB,QASX,iBAAdgO,GAAgCme,KAC7BxnB,EAAAA,EAAAA,KAAA,OAAK0J,IAAK8oB,GAAyB1yB,UAAU,2BAA0BC,SAClE2nB,KACG1nB,EAAAA,EAAAA,KAACs+B,EAAAA,EAAgB,CAACrvB,KAAM,OAMrB,iBAAd5F,GAA6C,UAAb0lB,KAC7B/uB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,kBAAiBC,UAC5BJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,2DAA0DC,SAAA,EACvEC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,8BAA6BC,UAC1CC,EAAAA,EAAAA,KAAA,MAAAD,SACKw3B,GAAiBr1B,KAAKouB,IACnB,MAAMwF,EAASxP,EAA4B7mB,MAAK25B,GAAOA,EAAI/9B,KAAOi1B,IAClE,OAAKwF,GAGD91B,EAAAA,EAAAA,KAAA,MAEIq6B,MAAM,MACNv6B,UAAS,qHAAAvE,OAAuH+0B,IAAa5B,GAAiB,+BAAiC,IAC/L4L,WAAW,EACXC,YAAaA,IAAMlD,GAAgB/G,GACnCzmB,WAAatJ,GAAM6I,GAAe7I,EAAG+vB,GACrC1mB,OAASrJ,GAAM4I,GAAW5I,EAAG+vB,GAC7BkK,UAAWlD,GAAcv3B,UAEzBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oBAAmBC,SAAA,CAC7BoM,OAAOC,YAAc,IAAM0pB,EAAO1P,WAAa0P,EAAO3P,MACzC,YAAbmK,IACGtwB,EAAAA,EAAAA,KAAA,UACII,QAASA,IAAMuzB,GAAsBrD,GACrCxwB,UAAU,0BAAyBC,UAEnCC,EAAAA,EAAAA,KAACy6B,EAAAA,EAAgB,CAAC36B,UAAU,mDAhBnCwwB,GAJO,IAwBX,SAKrBtwB,EAAAA,EAAAA,KAAA,SAAOF,UAAU,0EAAyEC,SACrF6nB,IACG5nB,EAAAA,EAAAA,KAAA,MAAAD,UACIC,EAAAA,EAAAA,KAAA,MAAI06B,QAASnD,GAAiB52B,OAAQb,UAAU,wCAAuCC,UACnFC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,sBAAqBC,UAChCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,4FAI3BgoB,IACA9nB,EAAAA,EAAAA,KAAA,MAAAD,UACIC,EAAAA,EAAAA,KAAA,MAAI06B,QAASnD,GAAiB52B,OAAQb,UAAU,uDAAsDC,SACjG+nB,OAGgC,IAAzCuO,GAA8B11B,QAC9BX,EAAAA,EAAAA,KAAA,MAAAD,UACIC,EAAAA,EAAAA,KAAA,MAAI06B,QAASnD,GAAiB52B,OAAQb,UAAU,yDAAwDC,UACpGJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,kDAAiDC,SAAA,EAC5DC,EAAAA,EAAAA,KAACi4B,EAAAA,EAAY,CAACn4B,UAAU,gDACxBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,UAASC,SACnBmoB,IAAqD,QAA5BE,IAAwE,QAAnCE,GACzDtrB,EAAE,yBAA0B,+BAC5BA,EAAE,8BAA+B,0CAMvDgD,EAAAA,EAAAA,KAAAwJ,EAAAA,SAAA,CAAAzJ,SACKs2B,GAA8Bn0B,KAAImc,IAC/B,MAAMhI,EAAcnT,IAChB,IACI,OAAOC,EAAAA,GAAAA,IAAO,IAAI1C,KAAKyC,GAAa,aAAc,CAAEE,OAAQN,GAAAA,IAChE,CAAE,MAAAi8B,GACE,OAAO77B,CACX,GAGJ,OACIlD,EAAAA,EAAAA,KAAA,MAEIF,UAAU,yDACVM,QAASA,IAAM4lB,EAAS,iBAADzqB,OAAkB8iB,EAAYhjB,KAAM0E,SAE1Dw3B,GAAiBr1B,KAAIouB,IAAa,IAAD0O,EAC9B,OAAQ1O,GACJ,IAAK,YACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,4BAA2BC,UACpDJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,uDAAsDC,SAAA,CAChEse,EAAY3D,UACZ2D,EAAYiC,qBACT3gB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,2CAA0CC,SAAA,CAAC,OACjDse,EAAYiC,0BALxBgQ,GAWjB,IAAK,SACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,QAAMF,UAAS,iEAAAvE,OAAmE64B,GAA0B/V,EAAYjZ,SAAUrF,SAC7H/C,EAAE,uBAADzB,OAAwB8iB,EAAYjZ,QAAUiZ,EAAYjZ,WAF3DkrB,GAMjB,IAAK,gBACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,QAAMF,UAAS,iEAAAvE,OAAmEo5B,GAAsBtW,EAAYiH,gBAAiBvlB,SAChI/C,EAAE,8BAADzB,OAA+B8iB,EAAYiH,eAAiBjH,EAAYiH,kBAFzEgL,GAMjB,IAAK,cACL,IAAK,eACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SACpDsW,EAAwB,gBAAbia,EAA6BjS,EAAYC,YAAcD,EAAYE,iBAF9E+R,GAMjB,IAAK,aACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SACpDse,EAAY2C,YAAc,OAF1BsP,GAMjB,IAAK,SACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,UAClC,QAAlBi/B,EAAA3gB,EAAY5S,cAAM,IAAAuzB,OAAA,EAAlBA,EAAoB5zB,OAAQ,OAF5BklB,GAMjB,IAAK,aACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SACpDse,EAAYuB,YAAc,OAF1B0Q,GAMjB,IAAK,aACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SACpDse,EAAYqB,YAAc,OAF1B4Q,GAMjB,IAAK,SACD,MAAMgN,EAA4C,kBAAvBjf,EAAYxD,OACjCS,WAAW+C,EAAYxD,QAAQ0iB,QAAQ,GACT,kBAAvBlf,EAAYxD,OACnBwD,EAAYxD,OAAO0iB,QAAQ,GAC3B,OACN,OACIv9B,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,2CAA0CC,SAAA,CACpDu9B,EAAY,IAAEjf,EAAYtD,UAAY,UAFtCuV,GAMjB,IAAK,cACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SACpDse,EAAYkH,aAAcpiB,EAAAA,GAAAA,IAAO,IAAI1C,KAAK4d,EAAYkH,aAAc,mBAAoB,CAAEniB,OAAQN,GAAAA,KAAQ,OAF1GwtB,GAMjB,IAAK,UACD,OACItwB,EAAAA,EAAAA,KAAA,MAAmBF,UAAU,8CAA6CC,UACtEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,gCAA+BC,SACzC6V,EAAc,eAAgB,QAAS,WACpCjW,EAAAA,EAAAA,MAAA6J,EAAAA,SAAA,CAAAzJ,SAAA,EAEIJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACFma,GAAoC1K,GACpC4K,IAAgC,EAAK,EAEzCnpB,UAAU,sFAAqFC,UAE/FC,EAAAA,EAAAA,KAAC2D,EAAAA,EAAiB,CAAC7D,UAAU,eAEjCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,yLAAwLC,SAClM/C,EAAE,2CAKX2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACFua,GAAkC9K,GAClCgL,IAA8B,EAAK,EAEvCvpB,UAAU,8FAA6FC,UAEvGC,EAAAA,EAAAA,KAAC6D,EAAAA,EAAO,CAAC/D,UAAU,eAEvBE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,yLAAwLC,SAClM/C,EAAE,yCAKX2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,iBAAgBC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,UACII,QAAUG,IACNA,EAAEqO,kBACFoX,EAAS,iBAADzqB,OAAkB8iB,EAAYhjB,IAAK,EAE/CyE,UAAU,sFAAqFC,UAE/FC,EAAAA,EAAAA,KAACi7B,EAAAA,EAAqB,CAACn7B,UAAU,eAErCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,yLAAwLC,SAClM/C,EAAE,iCAlDlBszB,GA0DjB,QACI,OAAO,KACf,KA/JCjS,EAAYhjB,GAiKhB,aAWtB,UAAdgO,GAAyBud,KACtB5mB,EAAAA,EAAAA,KAAA,OAAK0J,IAAK6oB,GAAkBzyB,UAAU,2BAA0BC,SAC3D+mB,KACG9mB,EAAAA,EAAAA,KAACs+B,EAAAA,EAAgB,CAACrvB,KAAM,OAMrB,iBAAd5F,GAAgCqgB,KAC7B1pB,EAAAA,EAAAA,KAAA,OAAK0J,IAAK+oB,GAAyB3yB,UAAU,2BAA0BC,SAClE6pB,KACG5pB,EAAAA,EAAAA,KAACs+B,EAAAA,EAAgB,CAACrvB,KAAM,mBAYpDjP,EAAAA,EAAAA,KAACi/B,EAAe,CACZtiC,OAAQ6vB,GACR5vB,QAASA,IAAM6vB,IAAqB,GACpC5gB,cAAgBqzB,IAEG,MAAXA,IACAzY,IAASuM,IACL,MAAMmM,EAAanM,EAAUhxB,QAAOqQ,GAAgB,MAARA,IAC5C,MAAO,CAAC6sB,KAAYC,EAAW,IAEnCxS,IAAmB,GACnBE,GAAgBqS,GACpB,IAIPtS,KACG5sB,EAAAA,EAAAA,KAACo/B,EAAa,CACVziC,OAAQ+vB,GACR9vB,QAASA,KACL+vB,IAAmB,GACnBE,GAAgB,KAAK,EAEzBlX,cAAgB0pB,IAEO,MAAfA,IACA5Y,IAASuM,GACLA,EACKhxB,QAAOqQ,GAAgB,MAARA,IACfnQ,KAAImQ,GACDA,EAAKhX,KAAOgkC,EAAYhkC,GAAKgkC,EAAchtB,MAGvDsa,IAAmB,GACnBE,GAAgB,MAChBqG,GAAAA,GAAM7xB,QAAQrE,EAAE,kCACpB,EAEJqV,KAAMua,MAKd5sB,EAAAA,EAAAA,KAACs/B,GAAsB,CACnB3iC,OAAQ6rB,GACR5rB,QAASA,IAAM6rB,IAAgC,GAC/ChO,qBAAsBzb,UAElBsK,EAAa,sBAEPiU,QAAiBnb,OAAWA,GAAW,EAAO,GAAI,EAAE,IAKjE0mB,KACG9oB,EAAAA,EAAAA,KAACu/B,GAAsB,CACnB5iC,OAAQqsB,GACRpsB,QAASA,KACLqsB,IAAgC,GAChCF,GAAoC,KAAK,EAE7C1K,YAAayK,GACbrJ,UAAWzgB,gBAEDue,QAAiBnb,OAAWA,GAAW,EAAO,GAAI,EAAE,IAMrE8mB,KACGlpB,EAAAA,EAAAA,KAACw/B,GAAoB,CACjB7iC,OAAQysB,GACRxsB,QAASA,KACLysB,IAA8B,GAC9BF,GAAkC,KAAK,EAE3C9K,YAAa6K,GACbzJ,UAAWzgB,gBAEDue,QAAiBnb,OAAWA,GAAW,EAAO,GAAI,EAAE,IAMvD,iBAAdiH,IACG1J,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWC,SAAA,EAEtBJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oCAAmCC,SAAA,EAC9CC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,sDAAqDC,SAC9D/C,EAAE,qBAAsB,oBAE5B4Y,EAAc,gBAAiB,QAAS,WACrCjW,EAAAA,EAAAA,MAAA,UACIS,QAASA,IAAMqqB,IAAgC,GAC/C3qB,UAAU,sHAAqHC,SAAA,EAE/HC,EAAAA,EAAAA,KAACg4B,EAAAA,EAAQ,CAACl4B,UAAU,YACnB9C,EAAE,sBAAuB,uBAMtCgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,WAAUC,UACrBC,EAAAA,EAAAA,KAAA,SACImC,KAAK,OACL2H,YAAa9M,EAAE,gBAAiB,aAChC2E,MAAOuoB,GACPtoB,SAAWrB,GAAM4pB,GAA0B5pB,EAAEsB,OAAOF,OACpD7B,UAAU,gMAIjBgqB,IACG9pB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oDAAmDC,SAC7D/C,EAAE,oBAEPgtB,IACAhqB,EAAAA,EAAAA,KAAA,OAAKF,UAAU,kDAAiDC,SAC3DiqB,KAEmB,IAAxBV,GAAa3oB,QACbX,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oDAAmDC,SAC7D/C,EAAE,0BAA2B,gCAGlCgD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,kBAAiBC,UAC5BJ,EAAAA,EAAAA,MAAA,SAAOG,UAAU,2DAA0DC,SAAA,EACvEC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,8BAA6BC,UAC1CJ,EAAAA,EAAAA,MAAA,MAAAI,SAAA,EACIC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oGAAmGC,SAC5G/C,EAAE,oBAAqB,WAE5BgD,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oGAAmGC,SAC5G/C,EAAE,4BAA6B,YAEpCgD,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oGAAmGC,SAC5G/C,EAAE,wBAAyB,iBAEhCgD,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oGAAmGC,SAC5G/C,EAAE,oCAAqC,iBAE5CgD,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oGAAmGC,SAC5G/C,EAAE,0BAA2B,kBAElCgD,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oGAAmGC,SAC5G/C,EAAE,6BAA8B,qBAErCgD,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oGAAmGC,SAC5G/C,EAAE,sBAAuB,aAE9BgD,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oGAAmGC,SAC5G/C,EAAE,wBAAyB,kBAEhCgD,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oGAAmGC,SAC5G/C,EAAE,iBAAkB,oBAIjCgD,EAAAA,EAAAA,KAAA,SAAOF,UAAU,0EAAyEC,SACrFupB,GACItnB,QAAO4Z,IAAY,IAAD6jB,EAAAC,EAAA/jB,EAAAgkB,EAAAC,EACf,IAAK1V,GAAwB,OAAO,EACpC,MAAM2I,EAAS3I,GAAuB/K,cACtC,OACwB,QAApBsgB,EAAA7jB,EAAQ/d,oBAAY,IAAA4hC,OAAA,EAApBA,EAAsBtgB,cAAc7Y,SAASusB,MACxB,QAD+B6M,EACpD9jB,EAAQ7d,qBAAa,IAAA2hC,OAAA,EAArBA,EAAuBvgB,cAAc7Y,SAASusB,MAClC,QADyClX,EACrDC,EAAQ9e,YAAI,IAAA6e,GAAO,QAAPgkB,EAAZhkB,EAAc1Z,aAAK,IAAA09B,OAAP,EAAZA,EAAqBxgB,cAAc7Y,SAASusB,MACvB,QAD8B+M,EACnDhkB,EAAQ3d,qBAAa,IAAA2hC,OAAA,EAArBA,EAAuBt5B,SAASusB,GAAO,IAG9C3wB,KAAK0Z,IAAO,IAAAikB,EAAA,OACTlgC,EAAAA,EAAAA,MAAA,MAAqBG,UAAU,0CAAyCC,SAAA,EACpEC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,8BAA6BC,UACvCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,oDAAmDC,UACjD,QAAZ8/B,EAAAjkB,EAAQ9e,YAAI,IAAA+iC,OAAA,EAAZA,EAAc59B,QAAS,SAGhCtC,EAAAA,EAAAA,MAAA,MAAIG,UAAU,8BAA6BC,SAAA,EACvCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wCAAuCC,SACjD6b,EAAQ/d,eAEZ+d,EAAQ7d,gBACLiC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SACpD6b,EAAQ7d,gBAGhB6d,EAAQ3d,gBACL+B,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SACpD6b,EAAQ3d,oBAIrB+B,EAAAA,EAAAA,KAAA,MAAIF,UAAU,8BAA6BC,UACvCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wCAAuCC,UACjDoD,EAAAA,GAAAA,IAAO,IAAI1C,KAAKmb,EAAQne,UAAW,aAAc,CAAE2F,OAAQN,GAAAA,UAGpE9C,EAAAA,EAAAA,KAAA,MAAIF,UAAU,8BAA6BC,UACvCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wCAAuCC,SACjD6b,EAAQje,0BAGjBqC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,8BAA6BC,UACvCJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sDAAqDC,SAAA,CAC/DL,OAAOkc,EAAQ6B,YAAYe,iBAAiB,IAAE5C,EAAQb,eAG/D/a,EAAAA,EAAAA,KAAA,MAAIF,UAAU,8BAA6BC,UACvCC,EAAAA,EAAAA,KAAA,QAAMF,UAAS,kCAAAvE,OACe,SAA1BqgB,EAAQ0J,cAA2B,oEACT,mBAA1B1J,EAAQ0J,cAAqC,wEACnB,YAA1B1J,EAAQ0J,cAA8B,wEACtC,6DACDvlB,SACE/C,EAAE,8BAADzB,OAA+BqgB,EAAQ0J,eAAiB1J,EAAQ0J,oBAG1EtlB,EAAAA,EAAAA,KAAA,MAAIF,UAAU,8BAA6BC,UACvCC,EAAAA,EAAAA,KAAA,QAAMF,UAAS,kCAAAvE,OACQ,cAAnBqgB,EAAQxW,OAAyB,oEACd,cAAnBwW,EAAQxW,OAAyB,4DACd,cAAnBwW,EAAQxW,OAAyB,gEACjC,iEACDrF,SACE/C,EAAE,uBAADzB,OAAwBqgB,EAAQxW,QAAUwW,EAAQxW,aAG5DpF,EAAAA,EAAAA,KAAA,MAAIF,UAAU,8BAA6BC,SACtC6b,EAAQkkB,UACLngC,EAAAA,EAAAA,MAAA,OAAKG,UAAU,wCAAuCC,SAAA,CACjD6b,EAAQkkB,SAASx0B,UAAU,IAAEsQ,EAAQkkB,SAASv0B,aAGnDvL,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2CAA0CC,SAAC,SAKlEC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,kDAAiDC,UAC3DJ,EAAAA,EAAAA,MAAA,OAAKG,UAAU,0BAAyBC,SAAA,CACnC6V,EAAc,gBAAiB,QAAS,WACrC5V,EAAAA,EAAAA,KAAA,UACII,QAASA,KACLyqB,GAA0BjP,GAC1B+O,IAA8B,EAAK,EAEvC7qB,UAAU,gFACVmC,MAAOjF,EAAE,cAAe,cAAc+C,UAEtCC,EAAAA,EAAAA,KAACy7B,EAAAA,EAAU,CAAC37B,UAAU,eAG9BE,EAAAA,EAAAA,KAAA,UACII,QAASA,KACLiqB,GAA0BzO,GAC1B2O,IAAkC,EAAK,EAE3CzqB,UAAU,oFACVmC,MAAOjF,EAAE,8BAA+B,iCAA8B+C,UAEtEC,EAAAA,EAAAA,KAACge,EAAAA,EAAQ,CAACle,UAAU,qBAzF3B8b,EAAQvgB,GA6FZ,eAUrC2E,EAAAA,EAAAA,KAAC+/B,GAAAA,EAAsB,CACnBpjC,OAAQ6tB,GACR5tB,QAASA,IAAM6tB,IAAgC,GAC/C5tB,iBAAkBmC,gBACR0zB,IAAkB,KAKhC1yB,EAAAA,EAAAA,KAACggC,GAAoB,CACjBrjC,OAAQ+tB,GACR9tB,QAASA,KACL+tB,IAA8B,GAC9BE,GAA0B,KAAK,EAEnCjP,QAASgP,GACT/O,iBAAkB7c,gBACR0zB,IAAkB,IAK/BtI,KACGpqB,EAAAA,EAAAA,KAACigC,GAAwB,CACrBtjC,OAAQ2tB,GACR1tB,QAASA,KACL2tB,IAAkC,GAClCF,GAA0B,KAAK,EAEnCzO,QAASwO,GACT1N,SAAU1d,gBACA0zB,IAAkB,MAIlC,C","sources":["types/reservation.ts","services/reservationService.ts","components/tours/CreateTourBookingModal.tsx","components/reservations/ReservationNotificationLogs.tsx","components/CerebroArticleSelector.tsx","components/CreateTaskModal.tsx","components/TaskDataBox.tsx","components/EmailTemplateBox.tsx","components/SocialSecurityCompletionBox.tsx","components/EditTaskModal.tsx","components/reservations/CreateReservationModal.tsx","components/tours/EditTourBookingModal.tsx","components/tours/TourReservationLinkModal.tsx","services/countryLanguageService.ts","components/reservations/SendInvitationSidepane.tsx","components/reservations/SendPasscodeSidepane.tsx","components/WorktimeTracker.tsx","pages/Worktracker.tsx"],"sourcesContent":["/**\r\n * Reservation Types fr Frontend\r\n */\r\n\r\nexport enum ReservationStatus {\r\n  CONFIRMED = 'confirmed',\r\n  NOTIFICATION_SENT = 'notification_sent',\r\n  CHECKED_IN = 'checked_in',\r\n  CHECKED_OUT = 'checked_out',\r\n  CANCELLED = 'cancelled',\r\n  NO_SHOW = 'no_show'\r\n}\r\n\r\nexport enum PaymentStatus {\r\n  PENDING = 'pending',\r\n  PAID = 'paid',\r\n  PARTIALLY_PAID = 'partially_paid',\r\n  REFUNDED = 'refunded'\r\n}\r\n\r\nexport interface Reservation {\r\n  id: number;\r\n  lobbyReservationId?: string | null;\r\n  guestName: string;\r\n  guestEmail?: string | null;\r\n  guestPhone?: string | null;\r\n  checkInDate: string; // ISO date string\r\n  checkOutDate: string; // ISO date string\r\n  arrivalTime?: string | null; // ISO datetime string\r\n  roomNumber?: string | null;\r\n  roomDescription?: string | null;\r\n  status: ReservationStatus;\r\n  paymentStatus: PaymentStatus;\r\n  amount?: number | string | null; // Betrag der Reservierung\r\n  currency?: string | null; // Whrung (COP, USD, EUR, etc.)\r\n  paymentLink?: string | null;\r\n  doorPin?: string | null;\r\n  doorAppName?: string | null;\r\n  ttlLockId?: string | null;\r\n  ttlLockPassword?: string | null;\r\n  onlineCheckInCompleted: boolean;\r\n  onlineCheckInCompletedAt?: string | null; // ISO datetime string\r\n  sireRegistered: boolean;\r\n  sireRegistrationId?: string | null;\r\n  sireRegisteredAt?: string | null; // ISO datetime string\r\n  sireRegistrationError?: string | null;\r\n  sentMessage?: string | null; // Versendete WhatsApp-Nachricht\r\n  sentMessageAt?: string | null; // ISO datetime string\r\n  guestNationality?: string | null;\r\n  guestPassportNumber?: string | null;\r\n  guestBirthDate?: string | null; // ISO date string\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  branch?: {\r\n    id: number;\r\n    name: string;\r\n  } | null;\r\n  taskId?: number | null;\r\n  createdAt: string; // ISO datetime string\r\n  updatedAt: string; // ISO datetime string\r\n}\r\n\r\nexport interface ReservationSyncHistory {\r\n  id: number;\r\n  reservationId: number;\r\n  syncType: 'created' | 'updated' | 'status_changed';\r\n  syncData?: any;\r\n  success: boolean;\r\n  errorMessage?: string | null;\r\n  syncedAt: string; // ISO datetime string\r\n}\r\n\r\n","import axiosInstance from '../config/axios.ts';\r\nimport { Reservation } from '../types/reservation.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\n\r\n// WICHTIG: axiosInstance hat bereits baseURL mit /api, daher nur /reservations hier\r\nconst API_BASE = '/reservations';\r\n\r\nexport interface CreateReservationData {\r\n  guestName: string;\r\n  contact: string; // Telefonnummer oder Email\r\n  amount: number;\r\n  currency?: string; // Default: \"COP\"\r\n}\r\n\r\nexport const reservationService = {\r\n  /**\r\n   * Erstellt eine neue Reservierung\r\n   */\r\n  async create(data: CreateReservationData): Promise<Reservation> {\r\n    console.log('[reservationService] POST zu:', API_BASE);\r\n    console.log('[reservationService] Daten:', data);\r\n    const response = await axiosInstance.post(API_BASE, data);\r\n    console.log('[reservationService] Response:', response);\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Holt eine Reservierung nach ID\r\n   */\r\n  async getById(id: number): Promise<Reservation> {\r\n    const response = await axiosInstance.get(`${API_BASE}/${id}`);\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Aktualisiert Kontaktinformation (Telefonnummer oder Email)\r\n   */\r\n  async updateGuestContact(id: number, contact: string): Promise<Reservation> {\r\n    const response = await axiosInstance.put(`${API_BASE}/${id}/guest-contact`, {\r\n      contact\r\n    });\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Generiert PIN-Code und sendet Mitteilung (unabhngig von Zahlungsstatus/Check-in-Status)\r\n   */\r\n  async generatePinAndSend(id: number): Promise<Reservation> {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.RESERVATION.GENERATE_PIN_AND_SEND(id));\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Sendet Reservation-Einladung manuell (mit optionalen Parametern)\r\n   */\r\n  async sendInvitation(\r\n    id: number,\r\n    options?: {\r\n      guestPhone?: string;\r\n      guestEmail?: string;\r\n      customMessage?: string;\r\n      amount?: number;\r\n      currency?: string;\r\n    }\r\n  ): Promise<Reservation> {\r\n    const response = await axiosInstance.post(\r\n      API_ENDPOINTS.RESERVATION.SEND_INVITATION(id),\r\n      options || {}\r\n    );\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Sendet TTLock Passcode mit anpassbaren Kontaktdaten\r\n   */\r\n  async sendPasscode(\r\n    id: number,\r\n    options?: {\r\n      guestPhone?: string;\r\n      guestEmail?: string;\r\n      customMessage?: string;\r\n    }\r\n  ): Promise<Reservation> {\r\n    const response = await axiosInstance.post(\r\n      API_ENDPOINTS.RESERVATION.SEND_PASSCODE(id),\r\n      options || {}\r\n    );\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Holt Notification-Logs UND WhatsApp-Nachrichten fr eine Reservierung\r\n   */\r\n  async getNotificationLogs(id: number): Promise<{\r\n    notificationLogs: ReservationNotificationLog[];\r\n    whatsappMessages: WhatsAppMessage[];\r\n  }> {\r\n    const response = await axiosInstance.get(\r\n      API_ENDPOINTS.RESERVATION.NOTIFICATION_LOGS(id)\r\n    );\r\n    const data = response.data.data || response.data;\r\n    // Rckwrtskompatibilitt: Wenn nur Array zurckgegeben wird, als notificationLogs behandeln\r\n    if (Array.isArray(data)) {\r\n      return {\r\n        notificationLogs: data,\r\n        whatsappMessages: []\r\n      };\r\n    }\r\n    return data;\r\n  }\r\n};\r\n\r\nexport interface ReservationNotificationLog {\r\n  id: number;\r\n  reservationId: number;\r\n  notificationType: 'invitation' | 'pin' | 'checkin_confirmation';\r\n  channel: 'whatsapp' | 'email' | 'both';\r\n  success: boolean;\r\n  sentAt: string; // ISO datetime string\r\n  sentTo?: string | null;\r\n  message?: string | null;\r\n  paymentLink?: string | null;\r\n  checkInLink?: string | null;\r\n  errorMessage?: string | null;\r\n  createdAt: string; // ISO datetime string\r\n}\r\n\r\nexport interface WhatsAppMessage {\r\n  id: number;\r\n  reservationId?: number | null;\r\n  branchId: number;\r\n  conversationId?: number | null;\r\n  direction: 'outgoing' | 'incoming';\r\n  phoneNumber: string;\r\n  message: string;\r\n  messageId?: string | null;\r\n  status?: 'sent' | 'delivered' | 'read' | 'failed' | null;\r\n  errorMessage?: string | null;\r\n  sentAt: string; // ISO datetime string\r\n  createdAt: string; // ISO datetime string\r\n  updatedAt: string; // ISO datetime string\r\n}\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourBooking, TourBookingStatus } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\n\ninterface CreateTourBookingModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onBookingCreated: (newBooking: TourBooking) => void;\n    tour?: Tour | null;\n}\n\nconst CreateTourBookingModal = ({ isOpen, onClose, onBookingCreated, tour: preselectedTour }: CreateTourBookingModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    \n    const [tourId, setTourId] = useState<number | ''>(preselectedTour?.id || '');\n    const [tourDate, setTourDate] = useState('');\n    const [numberOfParticipants, setNumberOfParticipants] = useState<number | ''>(1);\n    const [customerName, setCustomerName] = useState('');\n    const [customerEmail, setCustomerEmail] = useState('');\n    const [customerPhone, setCustomerPhone] = useState('');\n    const [customerNotes, setCustomerNotes] = useState('');\n    \n    const [tours, setTours] = useState<Tour[]>([]);\n    const [selectedTour, setSelectedTour] = useState<Tour | null>(preselectedTour || null);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Touren\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BASE, {\n                    params: { isActive: true }\n                });\n                const toursData = response.data?.data || response.data || [];\n                setTours(Array.isArray(toursData) ? toursData : []);\n            } catch (err: any) {\n                console.error('Fehler beim Laden der Touren:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Setze preselectedTour wenn vorhanden\n    useEffect(() => {\n        if (preselectedTour) {\n            setTourId(preselectedTour.id);\n            setSelectedTour(preselectedTour);\n        }\n    }, [preselectedTour]);\n\n    // Update selectedTour when tourId changes\n    useEffect(() => {\n        if (tourId) {\n            const tour = tours.find(t => t.id === Number(tourId));\n            setSelectedTour(tour || null);\n        } else {\n            setSelectedTour(null);\n        }\n    }, [tourId, tours]);\n\n    // Reset form when modal opens/closes\n    useEffect(() => {\n        if (!isOpen) {\n            if (!preselectedTour) {\n                setTourId('');\n            }\n            setTourDate('');\n            setNumberOfParticipants(1);\n            setCustomerName('');\n            setCustomerEmail('');\n            setCustomerPhone('');\n            setCustomerNotes('');\n            setError(null);\n        }\n    }, [isOpen, preselectedTour]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierungen\n        if (!tourId) {\n            setError(t('tourBookings.validation.tourRequired', { defaultValue: 'Tour ist erforderlich' }));\n            return;\n        }\n\n        if (!tourDate) {\n            setError(t('tourBookings.validation.tourDateRequired', { defaultValue: 'Tour-Datum ist erforderlich' }));\n            return;\n        }\n\n        const tourDateObj = new Date(tourDate);\n        if (tourDateObj < new Date()) {\n            setError(t('tours.validation.tourDateFuture', { defaultValue: 'Tour-Datum muss in der Zukunft liegen' }));\n            return;\n        }\n\n        if (!numberOfParticipants || Number(numberOfParticipants) < 1) {\n            setError(t('tourBookings.validation.numberOfParticipantsMin', { defaultValue: 'Anzahl Teilnehmer muss >= 1 sein' }));\n            return;\n        }\n\n        if (!customerName.trim() || customerName.trim().length < 2) {\n            setError(t('tourBookings.validation.customerNameMinLength', { defaultValue: 'Kundenname muss mindestens 2 Zeichen lang sein' }));\n            return;\n        }\n\n        if (!customerPhone.trim() && !customerEmail.trim()) {\n            setError(t('tourBookings.validation.contactRequired', { defaultValue: 'Mindestens eine Kontaktinformation (Telefon oder E-Mail) ist erforderlich' }));\n            return;\n        }\n\n        // Validierung: Anzahl Teilnehmer zwischen min/max\n        if (selectedTour) {\n            const numPart = Number(numberOfParticipants);\n            if (selectedTour.minParticipants && numPart < selectedTour.minParticipants) {\n                setError(t('tours.validation.numberOfParticipantsRange', { \n                    defaultValue: 'Anzahl der Teilnehmer muss zwischen {min} und {max} sein',\n                    min: selectedTour.minParticipants,\n                    max: selectedTour.maxParticipants || ''\n                }));\n                return;\n            }\n            if (selectedTour.maxParticipants && numPart > selectedTour.maxParticipants) {\n                setError(t('tours.validation.numberOfParticipantsRange', { \n                    defaultValue: 'Anzahl der Teilnehmer muss zwischen {min} und {max} sein',\n                    min: selectedTour.minParticipants || 1,\n                    max: selectedTour.maxParticipants\n                }));\n                return;\n            }\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.post(API_ENDPOINTS.TOUR_BOOKINGS.BASE, {\n                tourId: Number(tourId),\n                tourDate,\n                numberOfParticipants: Number(numberOfParticipants),\n                customerName: customerName.trim(),\n                customerEmail: customerEmail.trim() || null,\n                customerPhone: customerPhone.trim() || null,\n                customerNotes: customerNotes.trim() || null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tourBookings.created', { defaultValue: 'Tour-Buchung erfolgreich erstellt' }),\n                    'success'\n                );\n                onBookingCreated(response.data.data);\n                onClose();\n            } else {\n                throw new Error(response.data?.message || 'Fehler beim Erstellen der Buchung');\n            }\n        } catch (err: any) {\n            console.error('Fehler beim Erstellen der Buchung:', err);\n            const errorMessage = err.response?.data?.message || err.message || t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                    <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                            {t('tourBookings.create', { defaultValue: 'Neue Tour-Buchung' })}\n                        </Dialog.Title>\n                        <button\n                            onClick={onClose}\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                        >\n                            <XMarkIcon className=\"h-6 w-6\" />\n                        </button>\n                    </div>\n\n                    <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.tour', { defaultValue: 'Tour' })} *\n                            </label>\n                            <select\n                                value={tourId}\n                                onChange={(e) => setTourId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData || !!preselectedTour}\n                            >\n                                <option value=\"\">{t('common.select', { defaultValue: 'Bitte whlen' })}</option>\n                                {tours.filter(t => t.isActive && t.title).map(tour => (\n                                    <option key={tour.id} value={tour.id}>\n                                        {tour.title || '-'}\n                                    </option>\n                                ))}\n                            </select>\n                            {selectedTour && (\n                                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                                    {selectedTour.minParticipants && selectedTour.maxParticipants\n                                        ? t('tourBookings.participantsRange', { \n                                            defaultValue: 'Teilnehmer: {min} - {max}',\n                                            min: selectedTour.minParticipants,\n                                            max: selectedTour.maxParticipants\n                                        })\n                                        : selectedTour.minParticipants\n                                        ? t('tourBookings.participantsMin', { \n                                            defaultValue: 'Min. Teilnehmer: {min}',\n                                            min: selectedTour.minParticipants\n                                        })\n                                        : selectedTour.maxParticipants\n                                        ? t('tourBookings.participantsMax', { \n                                            defaultValue: 'Max. Teilnehmer: {max}',\n                                            max: selectedTour.maxParticipants\n                                        })\n                                        : null}\n                                </p>\n                            )}\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.tourDate', { defaultValue: 'Tour-Datum' })} *\n                            </label>\n                            <input\n                                type=\"datetime-local\"\n                                value={tourDate}\n                                onChange={(e) => setTourDate(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.numberOfParticipants', { defaultValue: 'Anzahl Teilnehmer' })} *\n                            </label>\n                            <input\n                                type=\"number\"\n                                min={selectedTour?.minParticipants || 1}\n                                max={selectedTour?.maxParticipants || undefined}\n                                value={numberOfParticipants}\n                                onChange={(e) => setNumberOfParticipants(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerName', { defaultValue: 'Kundenname' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={customerName}\n                                onChange={(e) => setCustomerName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerPhone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={customerPhone}\n                                onChange={(e) => setCustomerPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerEmail', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={customerEmail}\n                                onChange={(e) => setCustomerEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerNotes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={customerNotes}\n                                onChange={(e) => setCustomerNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={onClose}\n                                className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\n                            >\n                                {t('common.cancel', 'Abbrechen')}\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                            >\n                                {loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            </button>\n                        </div>\n                    </form>\n                </Dialog.Panel>\n            </div>\n        </Dialog>\n    );\n};\n\nexport default CreateTourBookingModal;\n\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { reservationService, ReservationNotificationLog, WhatsAppMessage } from '../../services/reservationService.ts';\r\nimport { format } from 'date-fns';\r\nimport { de, es, enUS } from 'date-fns/locale';\r\nimport {\r\n  CheckCircleIcon,\r\n  XCircleIcon,\r\n  PaperAirplaneIcon,\r\n  EnvelopeIcon,\r\n  PhoneIcon,\r\n  KeyIcon,\r\n  ClockIcon,\r\n  ArrowDownIcon,\r\n  ArrowUpIcon\r\n} from '@heroicons/react/24/outline';\r\n\r\ninterface ReservationNotificationLogsProps {\r\n  reservationId: number;\r\n  refreshKey?: number; // Optional: Wird erhht, wenn Logs neu geladen werden sollen\r\n}\r\n\r\nconst ReservationNotificationLogs: React.FC<ReservationNotificationLogsProps> = ({\r\n  reservationId,\r\n  refreshKey\r\n}) => {\r\n  const { t, i18n } = useTranslation();\r\n  const [logs, setLogs] = useState<ReservationNotificationLog[]>([]);\r\n  const [whatsappMessages, setWhatsappMessages] = useState<WhatsAppMessage[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const getLocale = () => {\r\n    switch (i18n.language) {\r\n      case 'de': return de;\r\n      case 'es': return es;\r\n      default: return enUS;\r\n    }\r\n  };\r\n\r\n  const formatDateTime = (dateString: string) => {\r\n    try {\r\n      return format(new Date(dateString), 'dd.MM.yyyy HH:mm', { locale: getLocale() });\r\n    } catch {\r\n      return dateString;\r\n    }\r\n  };\r\n\r\n  const getNotificationTypeLabel = (type: string) => {\r\n    switch (type) {\r\n      case 'invitation':\r\n        return t('reservations.notificationLogs.type.invitation', 'Einladung');\r\n      case 'pin':\r\n        return t('reservations.notificationLogs.type.pin', 'PIN-Code');\r\n      case 'checkin_confirmation':\r\n        return t('reservations.notificationLogs.type.checkinConfirmation', 'Check-in-Besttigung');\r\n      default:\r\n        return type;\r\n    }\r\n  };\r\n\r\n  const getChannelIcon = (channel: string) => {\r\n    switch (channel) {\r\n      case 'whatsapp':\r\n        return <PhoneIcon className=\"h-4 w-4\" />;\r\n      case 'email':\r\n        return <EnvelopeIcon className=\"h-4 w-4\" />;\r\n      case 'both':\r\n        return (\r\n          <div className=\"flex items-center space-x-1\">\r\n            <PhoneIcon className=\"h-4 w-4\" />\r\n            <EnvelopeIcon className=\"h-4 w-4\" />\r\n          </div>\r\n        );\r\n      default:\r\n        return <PaperAirplaneIcon className=\"h-4 w-4\" />;\r\n    }\r\n  };\r\n\r\n  const getNotificationTypeIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'pin':\r\n        return <KeyIcon className=\"h-4 w-4\" />;\r\n      case 'invitation':\r\n        return <PaperAirplaneIcon className=\"h-4 w-4\" />;\r\n      case 'checkin_confirmation':\r\n        return <CheckCircleIcon className=\"h-4 w-4\" />;\r\n      default:\r\n        return <PaperAirplaneIcon className=\"h-4 w-4\" />;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const loadLogs = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setError(null);\r\n        const data = await reservationService.getNotificationLogs(reservationId);\r\n        setLogs(data.notificationLogs || []);\r\n        setWhatsappMessages(data.whatsappMessages || []);\r\n      } catch (err: any) {\r\n        console.error('Fehler beim Laden der Notification-Logs:', err);\r\n        setError(err.response?.data?.message || t('reservations.notificationLogs.loadError', 'Fehler beim Laden der Logs'));\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadLogs();\r\n  }, [reservationId, t, refreshKey]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-4\">\r\n        <div className=\"animate-pulse space-y-3\">\r\n          <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/4\"></div>\r\n          <div className=\"h-20 bg-gray-200 dark:bg-gray-700 rounded\"></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-4\">\r\n        <div className=\"text-red-600 dark:text-red-400 text-sm\">\r\n          {error}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Kombiniere und sortiere alle Nachrichten nach Zeit\r\n  const allMessages = [\r\n    ...logs.map(log => ({ type: 'notification' as const, data: log, timestamp: log.sentAt })),\r\n    ...whatsappMessages.map(msg => ({ type: 'whatsapp' as const, data: msg, timestamp: msg.sentAt }))\r\n  ].sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime());\r\n\r\n  if (allMessages.length === 0) {\r\n    return (\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-4\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\r\n          {t('reservations.notificationLogs.title', 'Benachrichtigungs-Historie')}\r\n        </h3>\r\n        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n          {t('reservations.notificationLogs.noLogs', 'Keine Logs vorhanden')}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-4\">\r\n      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\r\n        {t('reservations.notificationLogs.title', 'Benachrichtigungs-Historie')}\r\n      </h3>\r\n      \r\n      <div className=\"space-y-3\">\r\n        {allMessages.map((item) => {\r\n          if (item.type === 'notification') {\r\n            const log = item.data as ReservationNotificationLog;\r\n            return (\r\n              <div\r\n                key={`notification-${log.id}`}\r\n                className={`border rounded-lg p-3 ${\r\n                  log.success\r\n                    ? 'border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20'\r\n                    : 'border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-start justify-between mb-2\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    {log.success ? (\r\n                      <CheckCircleIcon className=\"h-5 w-5 text-green-600 dark:text-green-400\" />\r\n                    ) : (\r\n                      <XCircleIcon className=\"h-5 w-5 text-red-600 dark:text-red-400\" />\r\n                    )}\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      {getNotificationTypeIcon(log.notificationType)}\r\n                      <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                        {getNotificationTypeLabel(log.notificationType)}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-1 text-gray-500 dark:text-gray-400\">\r\n                      {getChannelIcon(log.channel)}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex items-center space-x-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                    <ClockIcon className=\"h-4 w-4\" />\r\n                    <span>{formatDateTime(log.sentAt)}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                {log.sentTo && (\r\n                  <div className=\"text-xs text-gray-600 dark:text-gray-300 mb-1\">\r\n                    <span className=\"font-medium\">{t('reservations.notificationLogs.sentTo', 'Gesendet an')}:</span> {log.sentTo}\r\n                  </div>\r\n                )}\r\n\r\n                {log.message && (\r\n                  <div className=\"text-xs text-gray-600 dark:text-gray-300 mb-2 mt-2 p-2 bg-white dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\r\n                    <div className=\"font-medium mb-1\">{t('reservations.notificationLogs.message', 'Nachricht')}:</div>\r\n                    <div className=\"whitespace-pre-wrap break-words\">{log.message}</div>\r\n                  </div>\r\n                )}\r\n\r\n                {(log.paymentLink || log.checkInLink) && (\r\n                  <div className=\"flex flex-wrap gap-2 mt-2\">\r\n                    {log.paymentLink && (\r\n                      <a\r\n                        href={log.paymentLink}\r\n                        target=\"_blank\"\r\n                        rel=\"noopener noreferrer\"\r\n                        className=\"text-xs text-blue-600 dark:text-blue-400 hover:underline\"\r\n                      >\r\n                        {t('reservations.notificationLogs.paymentLink', 'Zahlungslink')}\r\n                      </a>\r\n                    )}\r\n                    {log.checkInLink && (\r\n                      <a\r\n                        href={log.checkInLink}\r\n                        target=\"_blank\"\r\n                        rel=\"noopener noreferrer\"\r\n                        className=\"text-xs text-blue-600 dark:text-blue-400 hover:underline\"\r\n                      >\r\n                        {t('reservations.notificationLogs.checkInLink', 'Check-in-Link')}\r\n                      </a>\r\n                    )}\r\n                  </div>\r\n                )}\r\n\r\n                {log.errorMessage && (\r\n                  <div className=\"mt-2 p-2 bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded text-xs text-red-700 dark:text-red-300\">\r\n                    <div className=\"font-medium mb-1\">{t('reservations.notificationLogs.error', 'Fehler')}:</div>\r\n                    <div>{log.errorMessage}</div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            );\r\n          } else {\r\n            const msg = item.data as WhatsAppMessage;\r\n            const isIncoming = msg.direction === 'incoming';\r\n            const isFailed = msg.status === 'failed';\r\n            return (\r\n              <div\r\n                key={`whatsapp-${msg.id}`}\r\n                className={`border rounded-lg p-3 ${\r\n                  isIncoming\r\n                    ? 'border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20'\r\n                    : isFailed\r\n                    ? 'border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20'\r\n                    : 'border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-start justify-between mb-2\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    {isIncoming ? (\r\n                      <ArrowDownIcon className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\r\n                    ) : isFailed ? (\r\n                      <XCircleIcon className=\"h-5 w-5 text-red-600 dark:text-red-400\" />\r\n                    ) : (\r\n                      <ArrowUpIcon className=\"h-5 w-5 text-gray-600 dark:text-gray-400\" />\r\n                    )}\r\n                    <PhoneIcon className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\r\n                    <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                      {isIncoming \r\n                        ? t('reservations.notificationLogs.whatsapp.incoming', 'Eingehende WhatsApp-Nachricht')\r\n                        : t('reservations.notificationLogs.whatsapp.outgoing', 'Ausgehende WhatsApp-Nachricht')\r\n                      }\r\n                    </span>\r\n                    {msg.status && (\r\n                      <span className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                        ({msg.status})\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"flex items-center space-x-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                    <ClockIcon className=\"h-4 w-4\" />\r\n                    <span>{formatDateTime(msg.sentAt)}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"text-xs text-gray-600 dark:text-gray-300 mb-1\">\r\n                  <span className=\"font-medium\">{t('reservations.notificationLogs.sentTo', 'Gesendet an')}:</span> {msg.phoneNumber}\r\n                </div>\r\n\r\n                {msg.message && (\r\n                  <div className=\"text-xs text-gray-600 dark:text-gray-300 mb-2 mt-2 p-2 bg-white dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\r\n                    <div className=\"font-medium mb-1\">{t('reservations.notificationLogs.message', 'Nachricht')}:</div>\r\n                    <div className=\"whitespace-pre-wrap break-words\">{msg.message}</div>\r\n                  </div>\r\n                )}\r\n\r\n                {msg.errorMessage && (\r\n                  <div className=\"mt-2 p-2 bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded text-xs text-red-700 dark:text-red-300\">\r\n                    <div className=\"font-medium mb-1\">{t('reservations.notificationLogs.error', 'Fehler')}:</div>\r\n                    <div>{msg.errorMessage}</div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            );\r\n          }\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReservationNotificationLogs;\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { MagnifyingGlassIcon } from '@heroicons/react/24/solid';\nimport { XCircleIcon } from '@heroicons/react/24/solid';\nimport debounce from 'lodash/debounce';\n\ninterface CerebroArticle {\n  id: number;\n  title: string;\n  slug: string;\n  content?: string;\n}\n\ninterface CerebroArticleSelectorProps {\n  onArticleSelected: (article: CerebroArticle) => void;\n  excludeArticleIds?: number[];\n  selectedArticles?: CerebroArticle[];\n  onArticleRemove?: (articleId: number) => void;\n}\n\nconst CerebroArticleSelector: React.FC<CerebroArticleSelectorProps> = ({\n  onArticleSelected,\n  excludeArticleIds = [],\n  selectedArticles,\n  onArticleRemove\n}) => {\n  const [articles, setArticles] = useState<CerebroArticle[]>([]);\n  const [selectedArticleId, setSelectedArticleId] = useState<number | null>(null);\n  const [selectedArticlePreview, setSelectedArticlePreview] = useState<CerebroArticle | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Alle Artikel beim Laden abrufen\n  useEffect(() => {\n    const fetchAllArticles = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        \n        const response = await axiosInstance.get(API_ENDPOINTS.CEREBRO.ARTICLES.BASE);\n        \n        // Filtere bereits ausgewhlte Artikel\n        const filteredArticles = response.data.filter(\n          (article: CerebroArticle) => !excludeArticleIds.includes(article.id)\n        );\n        \n        setArticles(filteredArticles);\n      } catch (err) {\n        console.error('Fehler beim Abrufen der Artikel:', err);\n        // Einfachere Fehlerbehandlung ohne axios-Import\n        const axiosError = err as any;\n        setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchAllArticles();\n  }, [excludeArticleIds]);\n\n  // Artikeldetails abrufen, wenn ein Artikel ausgewhlt wird\n  const fetchArticleDetails = async (articleId: number) => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.CEREBRO.ARTICLES.BY_ID(articleId));\n      setSelectedArticlePreview(response.data);\n    } catch (err) {\n      console.error('Fehler beim Abrufen der Artikeldetails:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleArticleSelect = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    const articleId = parseInt(e.target.value, 10);\n    \n    if (!isNaN(articleId)) {\n      setSelectedArticleId(articleId);\n      \n      // Artikel aus der Liste finden\n      const selectedArticle = articles.find(article => article.id === articleId);\n      \n      if (selectedArticle) {\n        // Artikeldetails abrufen fr die Vorschau\n        fetchArticleDetails(articleId);\n      }\n    } else {\n      setSelectedArticleId(null);\n      setSelectedArticlePreview(null);\n    }\n  };\n\n  const handleArticleConfirm = () => {\n    if (selectedArticleId !== null) {\n      const selectedArticle = articles.find(article => article.id === selectedArticleId);\n      if (selectedArticle) {\n        onArticleSelected(selectedArticle);\n        setSelectedArticleId(null);\n        setSelectedArticlePreview(null);\n      }\n    }\n  };\n\n  return (\n    <div className=\"mt-4\">\n      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n        Cerebro-Artikel verknpfen\n      </label>\n      \n      <div className=\"flex flex-col gap-3\">\n        <div className=\"flex items-center gap-2\">\n          <select\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={selectedArticleId || ''}\n            onChange={handleArticleSelect}\n          >\n            <option value=\"\">-- Artikel auswhlen --</option>\n            {articles.map((article) => (\n              <option key={article.id} value={article.id}>\n                {article.title}\n              </option>\n            ))}\n          </select>\n          \n          <button\n            type=\"button\"\n            onClick={handleArticleConfirm}\n            disabled={selectedArticleId === null}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            Verknpfen\n          </button>\n        </div>\n\n        {loading && (\n          <div className=\"text-sm text-gray-500\">\n            Lade Artikel...\n          </div>\n        )}\n        \n        {error && (\n          <div className=\"text-sm text-red-600\">\n            {error}\n          </div>\n        )}\n        \n        {selectedArticlePreview && (\n          <div className=\"mt-2 p-4 border border-gray-300 rounded-md bg-gray-50\">\n            <h4 className=\"font-medium text-lg mb-2\">{selectedArticlePreview.title}</h4>\n            <div className=\"prose prose-sm max-w-none\">\n              {selectedArticlePreview.content ? (\n                <div className=\"text-sm text-gray-700 max-h-40 overflow-y-auto\">\n                  {selectedArticlePreview.content.substring(0, 300)}\n                  {selectedArticlePreview.content.length > 300 && '...'}\n                </div>\n              ) : (\n                <p className=\"text-sm text-gray-500 italic\">Kein Inhalt verfgbar</p>\n              )}\n            </div>\n            <div className=\"mt-2\">\n              <a \n                href={`/cerebro/articles/${selectedArticlePreview.slug}`}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-sm text-blue-600 hover:underline\"\n              >\n                Artikel ffnen\n              </a>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default CerebroArticleSelector; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ArrowPathIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport CerebroArticleSelector from './CerebroArticleSelector.tsx';\nimport MarkdownPreview from './MarkdownPreview.tsx';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface User {\n    id: number;\n    firstName: string;\n    lastName: string;\n}\n\ninterface Role {\n    id: number;\n    name: string;\n}\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface CerebroArticle {\n    id: number;\n    title: string;\n    slug: string;\n    content?: string;\n}\n\ninterface TaskAttachment {\n    id?: number;\n    fileName: string;\n    fileType: string;\n    fileSize: number;\n    filePath?: string;\n    uploadedAt?: string;\n    file?: File; // Fr temporre Anhnge vor dem Hochladen\n}\n\ninterface CreateTaskModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTaskCreated: (newTask: Task) => void;\n}\n\ninterface Task {\n    id: number;\n    title: string;\n    description: string | null;\n    status: 'open' | 'in_progress' | 'improval' | 'quality_control' | 'done';\n    responsible: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    responsibleId: number | null;\n    role: {\n        id: number;\n        name: string;\n    } | null;\n    roleId: number | null;\n    qualityControl: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    branch: {\n        id: number;\n        name: string;\n    };\n    dueDate: string | null;\n    requestId: number | null;\n}\n\nconst CreateTaskModal = ({ isOpen, onClose, onTaskCreated }: CreateTaskModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { openSidepane, closeSidepane } = useSidepane();\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [title, setTitle] = useState('');\n    const [description, setDescription] = useState('');\n    const [assigneeType, setAssigneeType] = useState<'user' | 'role'>('user');\n    const [responsibleId, setResponsibleId] = useState<number | ''>('');\n    const [roleId, setRoleId] = useState<number | ''>('');\n    const [qualityControlId, setQualityControlId] = useState<number | ''>('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    const [dueDate, setDueDate] = useState('');\n    const [users, setUsers] = useState<User[]>([]);\n    const [roles, setRoles] = useState<Role[]>([]);\n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [selectedArticles, setSelectedArticles] = useState<CerebroArticle[]>([]);\n    const [activeTab, setActiveTab] = useState<'data' | 'cerebro'>('data');\n    const [temporaryAttachments, setTemporaryAttachments] = useState<TaskAttachment[]>([]);\n    const [uploading, setUploading] = useState(false);\n    const fileInputRef = useRef<HTMLInputElement>(null);\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n    const getDefaultDueDate = () => {\n        const date = new Date();\n        date.setDate(date.getDate() + 7);\n        return date.toISOString().split('T')[0];\n    };\n\n    useEffect(() => {\n        if (isOpen) {\n            fetchUsers();\n            fetchRoles();\n            fetchBranches();\n            \n            if (user) {\n                setQualityControlId(user.id);\n            }\n            \n            setDueDate(getDefaultDueDate());\n        }\n    }, [isOpen, user]);\n\n    useEffect(() => {\n        if (branches.length > 0 && branchId === '') {\n            if (branches.length === 1) {\n                setBranchId(branches[0].id);\n            } else if (branches.length > 1) {\n                setBranchId(branches[0].id);\n            }\n        }\n    }, [branches, branchId]);\n    \n    useEffect(() => {\n        // Prfen der Bildschirmgre beim Mounten\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        // Initial prfen\n        checkScreenSize();\n        \n        // Event-Listener fr Grennderungen\n        window.addEventListener('resize', checkScreenSize);\n        \n        // Cleanup\n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    const fetchUsers = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n\n            console.log('Lade Benutzer fr CreateTaskModal...');\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.USERS.DROPDOWN);\n            \n            console.log('Benutzer geladen:', response.data.length);\n            setUsers(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Benutzer:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.createTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.createTask.errors.loadUsersError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchRoles = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.ROLES.BASE);\n            setRoles(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Rollen:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.createTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.createTask.errors.loadRolesError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchBranches = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n\n            console.log('Lade Niederlassungen fr CreateTaskModal...');\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n            \n            console.log('Niederlassungen geladen:', response.data.length);\n            setBranches(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Niederlassungen:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.createTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.createTask.errors.loadBranchesError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const handlePaste = async (event: React.ClipboardEvent) => {\n        const items = event.clipboardData.items;\n        \n        for (let i = 0; i < items.length; i++) {\n            const item = items[i];\n            \n            // Prfen, ob das eingefgte Element ein Bild ist\n            if (item.type.indexOf('image') === 0) {\n                event.preventDefault(); // Standardeingabe verhindern\n                \n                const file = item.getAsFile();\n                if (file) {\n                    await handleTemporaryAttachment(file);\n                }\n                return;\n            }\n        }\n    };\n\n    const handleDrop = async (event: React.DragEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n        \n        if (event.dataTransfer.files && event.dataTransfer.files.length > 0) {\n            const file = event.dataTransfer.files[0];\n            await handleTemporaryAttachment(file);\n        }\n    };\n\n    const handleDragOver = (event: React.DragEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    const handleTemporaryAttachment = async (file: File) => {\n        setUploading(true);\n        setError(null);\n\n        try {\n            // Erstelle einen temporren Anhang\n            const newAttachment: TaskAttachment = {\n                fileName: file.name,\n                fileType: file.type,\n                fileSize: file.size,\n                file: file // Speichern der Datei fr spteren Upload\n            };\n            \n            setTemporaryAttachments(prev => [...prev, newAttachment]);\n\n            // Fge Markdown-Link ins Textarea ein (fr Card-Anzeige)\n            // Bilder werden zustzlich als groe Vorschau unter dem Textarea angezeigt\n            let insertText = '';\n            if (file.type.startsWith('image/')) {\n                // Hinweis: Wir verwenden hier den Platzhalter, da die Datei erst nach dem Erstellen hochgeladen wird\n                // Die tatschliche URL wird nach dem erfolgreichen Upload im Backend gesetzt\n                insertText = `\\n![${file.name}](${t('tasks.createTask.form.uploadAfterCreate')})\\n`;\n            } else {\n                // Fr andere Dateien einen temporren Platzhalter\n                insertText = `\\n[${file.name}](${t('tasks.createTask.form.uploadAfterCreate')})\\n`;\n            }\n            \n            // Fge den Link an der aktuellen Cursorposition ein\n            if (textareaRef.current) {\n                const cursorPos = textareaRef.current.selectionStart;\n                const textBefore = description.substring(0, cursorPos);\n                const textAfter = description.substring(cursorPos);\n                \n                setDescription(textBefore + insertText + textAfter);\n                \n                // Setze den Cursor hinter den eingefgten Link\n                setTimeout(() => {\n                    if (textareaRef.current) {\n                        const newPos = cursorPos + insertText.length;\n                        textareaRef.current.selectionStart = newPos;\n                        textareaRef.current.selectionEnd = newPos;\n                        textareaRef.current.focus();\n                    }\n                }, 0);\n            } else {\n                setDescription(description + insertText);\n            }\n        } catch (err) {\n            console.error('Fehler beim Verarbeiten der Datei:', err);\n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        } finally {\n            setUploading(false);\n        }\n    };\n\n    const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n        const files = event.target.files;\n        if (!files || files.length === 0) return;\n\n        const file = files[0];\n        await handleTemporaryAttachment(file);\n        \n        // Zurcksetzen des Datei-Inputs\n        if (fileInputRef.current) {\n            fileInputRef.current.value = '';\n        }\n    };\n\n    const handleRemoveTemporaryAttachment = (index: number) => {\n        // Finde den zu entfernenden Anhang\n        const attachmentToRemove = temporaryAttachments[index];\n        \n        if (attachmentToRemove) {\n            // Entferne den Anhang aus dem temporaryAttachments-Array\n            setTemporaryAttachments(temporaryAttachments.filter((_, i) => i !== index));\n            \n            // Entferne auch den Verweis im Beschreibungstext\n            if (attachmentToRemove.fileName) {\n                // Suche nach Bild- und Link-Markdown mit dem Dateinamen\n                const escapedFileName = attachmentToRemove.fileName.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                const uploadText = t('tasks.createTask.form.uploadAfterCreate');\n                const imagePattern = new RegExp(`!\\\\[${escapedFileName}\\\\]\\\\(${uploadText.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\)`, 'g');\n                const linkPattern = new RegExp(`\\\\[${escapedFileName}\\\\]\\\\(${uploadText.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\)`, 'g');\n                \n                // Bereinige die Beschreibung\n                const newDescription = description\n                    .replace(imagePattern, '')\n                    .replace(linkPattern, '')\n                    // Entferne berschssige Leerzeilen, die durch das Entfernen entstehen knnten\n                    .replace(/\\n{3,}/g, '\\n\\n');\n                \n                setDescription(newDescription);\n            }\n        }\n    };\n\n    const uploadTemporaryAttachments = async (taskId: number) => {\n        if (temporaryAttachments.length === 0) return;\n        \n        try {\n            setLoading(true);\n            \n            // Upload jeder temporren Datei\n            for (const attachment of temporaryAttachments) {\n                if (!attachment.file) continue;\n                \n                const formData = new FormData();\n                formData.append('file', attachment.file);\n                \n                await axiosInstance.post(\n                    API_ENDPOINTS.TASKS.ATTACHMENTS(taskId),\n                    formData,\n                    {\n                        headers: {\n                            'Content-Type': 'multipart/form-data',\n                        },\n                    }\n                );\n            }\n            \n            console.log(`${temporaryAttachments.length} Anhnge erfolgreich hochgeladen.`);\n        } catch (err) {\n            console.error('Fehler beim Hochladen der Anhnge:', err);\n            // Wir zeigen hier keinen Fehler, da der Task bereits erstellt wurde\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n        setLoading(true);\n\n        try {\n            // Validierung\n            if (!title || (!responsibleId && !roleId) || !branchId) {\n                setError(t('tasks.createTask.errors.fillAllFields'));\n                setLoading(false);\n                return;\n            }\n\n            if (responsibleId && roleId) {\n                setError(t('tasks.createTask.errors.chooseUserOrRole'));\n                setLoading(false);\n                return;\n            }\n\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                setLoading(false);\n                return;\n            }\n\n            // Validiere die IDs\n            const branch = Number(branchId);\n            const qualityControl = qualityControlId ? Number(qualityControlId) : null;\n            const responsible = responsibleId ? Number(responsibleId) : null;\n            const role = roleId ? Number(roleId) : null;\n\n            if ((responsibleId && isNaN(responsible!)) || \n                (roleId && isNaN(role!)) || \n                isNaN(branch) || \n                (qualityControlId && isNaN(qualityControl!))) {\n                setError(t('tasks.createTask.errors.invalidIds'));\n                setLoading(false);\n                return;\n            }\n\n            // Basisdaten fr die Anfrage vorbereiten\n            const taskData: any = {\n                title,\n                description,\n                status: 'open',\n                qualityControlId: qualityControl,\n                branchId: branch,\n                dueDate\n            };\n\n            // Nur ein Feld hinzufgen - entweder responsibleId oder roleId, aber nicht beide\n            if (assigneeType === 'user' && responsibleId) {\n                taskData.responsibleId = responsibleId;\n            } else if (assigneeType === 'role' && roleId) {\n                taskData.roleId = roleId;\n            }\n\n            const response = await axiosInstance.post(API_ENDPOINTS.TASKS.BASE, taskData);\n\n            const newTaskId = response.data.id;\n            \n            // Verknpfe Cerebro-Artikel, falls vorhanden\n            if (selectedArticles.length > 0) {\n                await Promise.all(\n                    selectedArticles.map(article => \n                        axiosInstance.post(API_ENDPOINTS.TASKS.LINK_CARTICLE(newTaskId, article.id))\n                    )\n                );\n            }\n            \n            // Lade temporre Anhnge hoch, falls vorhanden\n            await uploadTemporaryAttachments(newTaskId);\n            \n            console.log('Task erfolgreich erstellt:', response.data);\n            // bergebe den neuen Task an den Callback\n            onTaskCreated(response.data);\n            handleClose();\n        } catch (err) {\n            console.error('Fehler beim Erstellen des Tasks:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.error || axiosError.message || t('tasks.createTask.errors.createError'));\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        setTitle('');\n        setDescription('');\n        setAssigneeType('user');\n        setResponsibleId('');\n        setRoleId('');\n        setQualityControlId('');\n        setBranchId('');\n        setDueDate('');\n        setError(null);\n        setSelectedArticles([]);\n        setTemporaryAttachments([]);\n        onClose();\n    };\n\n    const handleAddArticle = (article: CerebroArticle) => {\n        setSelectedArticles(prev => [...prev, article]);\n    };\n    \n    const handleRemoveArticle = (articleId: number) => {\n        setSelectedArticles(prev => prev.filter(a => a.id !== articleId));\n    };\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                                {t('tasks.createTask.title')}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <TaskForm \n                            error={error}\n                            title={title}\n                            setTitle={setTitle}\n                            description={description}\n                            setDescription={setDescription}\n                            assigneeType={assigneeType}\n                            setAssigneeType={setAssigneeType}\n                            responsibleId={responsibleId}\n                            setResponsibleId={setResponsibleId}\n                            roleId={roleId}\n                            setRoleId={setRoleId}\n                            qualityControlId={qualityControlId}\n                            setQualityControlId={setQualityControlId}\n                            branchId={branchId}\n                            setBranchId={setBranchId}\n                            dueDate={dueDate}\n                            setDueDate={setDueDate}\n                            users={users}\n                            roles={roles}\n                            branches={branches}\n                            loading={loading}\n                            handleSubmit={handleSubmit}\n                            handleClose={handleClose}\n                            selectedArticles={selectedArticles}\n                            onArticleSelect={handleAddArticle}\n                            onArticleRemove={handleRemoveArticle}\n                            uploading={uploading}\n                            temporaryAttachments={temporaryAttachments}\n                            onFileUpload={handleFileUpload}\n                            onRemoveAttachment={handleRemoveTemporaryAttachment}\n                            textareaRef={textareaRef}\n                            fileInputRef={fileInputRef}\n                            handlePaste={handlePaste}\n                            handleDrop={handleDrop}\n                            handleDragOver={handleDragOver}\n                        />\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tasks.createTask.title')}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <TaskForm \n                        error={error}\n                        title={title}\n                        setTitle={setTitle}\n                        description={description}\n                        setDescription={setDescription}\n                        assigneeType={assigneeType}\n                        setAssigneeType={setAssigneeType}\n                        responsibleId={responsibleId}\n                        setResponsibleId={setResponsibleId}\n                        roleId={roleId}\n                        setRoleId={setRoleId}\n                        qualityControlId={qualityControlId}\n                        setQualityControlId={setQualityControlId}\n                        branchId={branchId}\n                        setBranchId={setBranchId}\n                        dueDate={dueDate}\n                        setDueDate={setDueDate}\n                        users={users}\n                        roles={roles}\n                        branches={branches}\n                        loading={loading}\n                        handleSubmit={handleSubmit}\n                        handleClose={handleClose}\n                        selectedArticles={selectedArticles}\n                        onArticleSelect={handleAddArticle}\n                        onArticleRemove={handleRemoveArticle}\n                        uploading={uploading}\n                        temporaryAttachments={temporaryAttachments}\n                        onFileUpload={handleFileUpload}\n                        onRemoveAttachment={handleRemoveTemporaryAttachment}\n                        textareaRef={textareaRef}\n                        fileInputRef={fileInputRef}\n                        handlePaste={handlePaste}\n                        handleDrop={handleDrop}\n                        handleDragOver={handleDragOver}\n                    />\n                </div>\n            </div>\n        </>\n    );\n};\n\n// Ausgelagerte Formular-Komponente, um Code-Duplizierung zu vermeiden\ninterface TaskFormProps {\n    error: string | null;\n    title: string;\n    setTitle: (value: string) => void;\n    description: string;\n    setDescription: (value: string) => void;\n    assigneeType: 'user' | 'role';\n    setAssigneeType: (value: 'user' | 'role') => void;\n    responsibleId: number | '';\n    setResponsibleId: (value: number | '') => void;\n    roleId: number | '';\n    setRoleId: (value: number | '') => void;\n    qualityControlId: number | '';\n    setQualityControlId: (value: number | '') => void;\n    branchId: number | '';\n    setBranchId: (value: number | '') => void;\n    dueDate: string;\n    setDueDate: (value: string) => void;\n    users: User[];\n    roles: Role[];\n    branches: Branch[];\n    loading: boolean;\n    handleSubmit: (e: React.FormEvent) => Promise<void>;\n    handleClose: () => void;\n    selectedArticles: CerebroArticle[];\n    onArticleSelect: (article: CerebroArticle) => void;\n    onArticleRemove: (articleId: number) => void;\n    uploading?: boolean;\n    temporaryAttachments?: TaskAttachment[];\n    onFileUpload?: (event: React.ChangeEvent<HTMLInputElement>) => Promise<void>;\n    onRemoveAttachment?: (index: number) => void;\n    textareaRef?: React.RefObject<HTMLTextAreaElement>;\n    fileInputRef?: React.RefObject<HTMLInputElement>;\n    handlePaste?: (event: React.ClipboardEvent) => Promise<void>;\n    handleDrop?: (event: React.DragEvent) => Promise<void>;\n    handleDragOver?: (event: React.DragEvent) => void;\n}\n\nconst TaskForm: React.FC<TaskFormProps> = ({\n    error,\n    title,\n    setTitle,\n    description,\n    setDescription,\n    assigneeType,\n    setAssigneeType,\n    responsibleId,\n    setResponsibleId,\n    roleId,\n    setRoleId,\n    qualityControlId,\n    setQualityControlId,\n    branchId,\n    setBranchId,\n    dueDate,\n    setDueDate,\n    users,\n    roles,\n    branches,\n    loading,\n    handleSubmit,\n    handleClose,\n    selectedArticles,\n    onArticleSelect,\n    onArticleRemove,\n    uploading = false,\n    temporaryAttachments = [],\n    onFileUpload,\n    onRemoveAttachment,\n    textareaRef,\n    fileInputRef,\n    handlePaste,\n    handleDrop,\n    handleDragOver,\n}) => {\n    const { t } = useTranslation();\n    const [activeTab, setActiveTab] = useState<'data' | 'cerebro'>('data');\n    \n    return (\n        <form onSubmit={handleSubmit} className=\"space-y-4\" noValidate>\n            {error && (\n                <div className=\"bg-red-100 dark:bg-red-900 border-l-4 border-red-500 dark:border-red-700 text-red-700 dark:text-red-300 p-4 mb-4\">\n                    <p>{error}</p>\n                </div>\n            )}\n\n            {/* Tabs Navigation */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n                <nav className=\"-mb-px flex space-x-4\" aria-label=\"Tabs\">\n                    <button\n                        type=\"button\"\n                        className={`${\n                            activeTab === 'data'\n                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600'\n                        } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                        onClick={() => setActiveTab('data')}\n                    >\n                        Daten\n                    </button>\n                    <button\n                        type=\"button\"\n                        className={`${\n                            activeTab === 'cerebro'\n                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600'\n                        } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                        onClick={() => setActiveTab('cerebro')}\n                    >\n                        Cerebro Artikel\n                    </button>\n                </nav>\n            </div>\n\n            {/* Data Tab Content */}\n            {activeTab === 'data' && (\n                <>\n                    <div>\n                        <label htmlFor=\"title\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.title')} *\n                        </label>\n                        <input\n                            type=\"text\"\n                            id=\"title\"\n                            value={title}\n                            onChange={(e) => setTitle(e.target.value)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                            required\n                        />\n                    </div>\n\n                    <div className=\"space-y-4\">\n                        <div>\n                            <label htmlFor=\"description_sidepane\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.createTask.form.description')}\n                            </label>\n                            <div className=\"relative\">\n                                <textarea\n                                    ref={textareaRef}\n                                    id=\"description_task_create\"\n                                    rows={6}\n                                    className=\"block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm\"\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    onPaste={handlePaste}\n                                    onDrop={handleDrop}\n                                    onDragOver={handleDragOver}\n                                    placeholder={t('tasks.createTask.form.descriptionPlaceholder')}\n                                />\n                                {/* Heftklammer-Icon zum Hinzufgen von Dateien */}\n                                <div className=\"relative group absolute bottom-2 left-2\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => fileInputRef?.current?.click()}\n                                        className=\"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400 focus:outline-none\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\" />\n                                        </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tasks.createTask.form.fileUpload')}\n                                    </div>\n                                </div>\n                                <input\n                                    ref={fileInputRef}\n                                    type=\"file\"\n                                    onChange={onFileUpload}\n                                    className=\"hidden\"\n                                />\n                                {uploading && (\n                                    <div className=\"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-70 dark:bg-opacity-70\">\n                                        <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('tasks.createTask.form.uploading')}</span>\n                                    </div>\n                                )}\n                            </div>\n                            {/* Anzeige der temporren Anhnge direkt unter dem Textfeld */}\n                            {temporaryAttachments && temporaryAttachments.length > 0 && (\n                                <div className=\"mt-2\">\n                                    <ul className=\"flex flex-wrap gap-2\">\n                                        {temporaryAttachments.map((attachment, index) => (\n                                            <li key={index} className=\"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-md px-2 py-1 relative group\">\n                                                <span className=\"text-sm font-medium text-gray-800 dark:text-gray-300\">\n                                                    {attachment.fileName}\n                                                </span>\n                                                <div className=\"flex ml-2\">\n                                                    <div className=\"relative group ml-1\">\n                                                        <button\n                                                            type=\"button\"\n                                                            onClick={() => onRemoveAttachment?.(index)}\n                                                            className=\"text-red-600 hover:text-red-900\"\n                                                        >\n                                                            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                                                            </svg>\n                                                        </button>\n                                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                            {t('tasks.createTask.form.remove')}\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                                {/* Tooltip fr Bildvorschau bei Bild-Dateien */}\n                                                {attachment.fileType.startsWith('image/') && attachment.file && (\n                                                    <div className=\"absolute z-10 bg-white dark:bg-gray-800 p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 dark:border-gray-700 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                                        <img \n                                                            src={URL.createObjectURL(attachment.file)}\n                                                            alt={attachment.fileName}\n                                                            className=\"max-w-[200px] max-h-[150px] object-contain\"\n                                                        />\n                                                    </div>\n                                                )}\n                                            </li>\n                                        ))}\n                                    </ul>\n                                </div>\n                            )}\n                        </div>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.responsibleFor')} *\n                        </label>\n                        <div className=\"flex space-x-4\">\n                            <label className=\"inline-flex items-center\">\n                                <input\n                                    type=\"radio\"\n                                    className=\"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600\"\n                                    name=\"assigneeType\"\n                                    value=\"user\"\n                                    checked={assigneeType === 'user'}\n                                    onChange={() => {\n                                        setAssigneeType('user');\n                                        setRoleId('');\n                                    }}\n                                />\n                                <span className=\"ml-2 dark:text-gray-300\">{t('tasks.createTask.form.user')}</span>\n                            </label>\n                            <label className=\"inline-flex items-center\">\n                                <input\n                                    type=\"radio\"\n                                    className=\"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600\"\n                                    name=\"assigneeType\"\n                                    value=\"role\"\n                                    checked={assigneeType === 'role'}\n                                    onChange={() => {\n                                        setAssigneeType('role');\n                                        setResponsibleId('');\n                                    }}\n                                />\n                                <span className=\"ml-2 dark:text-gray-300\">{t('tasks.createTask.form.role')}</span>\n                            </label>\n                        </div>\n                    </div>\n\n                    {assigneeType === 'user' ? (\n                        <div>\n                            <label htmlFor=\"responsible\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.createTask.form.responsibleUser')} *\n                            </label>\n                            <select\n                                id=\"responsible\"\n                                value={responsibleId}\n                                onChange={(e) => setResponsibleId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                required\n                            >\n                                <option value=\"\">{t('tasks.createTask.form.pleaseSelect')}</option>\n                                {Array.isArray(users) && users.map(user => (\n                                    <option key={user.id} value={user.id}>\n                                        {user.firstName} {user.lastName}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n                    ) : (\n                        <div>\n                            <label htmlFor=\"role\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.createTask.form.responsibleRole')} *\n                            </label>\n                            <select\n                                id=\"role\"\n                                value={roleId}\n                                onChange={(e) => setRoleId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                required\n                            >\n                                <option value=\"\">{t('tasks.createTask.form.pleaseSelect')}</option>\n                                {Array.isArray(roles) && roles.map(role => (\n                                    <option key={role.id} value={role.id}>\n                                        {role.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n                    )}\n\n                    <div>\n                        <label htmlFor=\"qualityControl\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.qualityControl')}\n                        </label>\n                        <select\n                            id=\"qualityControl\"\n                            value={qualityControlId}\n                            onChange={(e) => setQualityControlId(e.target.value ? Number(e.target.value) : '')}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        >\n                            <option value=\"\">{t('tasks.createTask.form.noQualityControl')}</option>\n                            {Array.isArray(users) && users.map(user => (\n                                <option key={user.id} value={user.id}>\n                                    {user.firstName} {user.lastName}\n                                </option>\n                            ))}\n                        </select>\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"branch\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.branch')} *\n                        </label>\n                        <select\n                            id=\"branch\"\n                            value={branchId}\n                            onChange={(e) => setBranchId(Number(e.target.value))}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                            required\n                        >\n                            <option value=\"\">{t('common.pleaseSelect')}</option>\n                            {Array.isArray(branches) && branches.map(branch => (\n                                <option key={branch.id} value={branch.id}>\n                                    {branch.name}\n                                </option>\n                            ))}\n                        </select>\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"dueDate\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.dueDate')}\n                        </label>\n                        <input\n                            type=\"date\"\n                            id=\"dueDate\"\n                            value={dueDate}\n                            onChange={(e) => setDueDate(e.target.value)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        />\n                    </div>\n                </>\n            )}\n\n            {/* Cerebro Articles Tab Content */}\n            {activeTab === 'cerebro' && (\n                <div>\n                    <div className=\"mb-4\">\n                        <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Verknpfte Cerebro-Artikel</h3>\n                        \n                        {selectedArticles.length > 0 ? (\n                            <ul className=\"mt-2 space-y-2\">\n                                {selectedArticles.map(article => (\n                                    <li key={article.id} className=\"flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 rounded\">\n                                        <span className=\"dark:text-gray-300\">{article.title}</span>\n                                        <button\n                                            type=\"button\"\n                                            onClick={() => onArticleRemove(article.id)}\n                                            className=\"text-red-600 hover:text-red-800\"\n                                        >\n                                            {t('tasks.createTask.form.remove')}\n                                        </button>\n                                    </li>\n                                ))}\n                            </ul>\n                        ) : (\n                            <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">{t('tasks.createTask.form.noArticlesLinked')}</p>\n                        )}\n                    </div>\n                    \n                    <CerebroArticleSelector\n                        onArticleSelected={onArticleSelect}\n                        excludeArticleIds={selectedArticles.map(a => a.id)}\n                        selectedArticles={selectedArticles}\n                        onArticleRemove={onArticleRemove}\n                    />\n                </div>\n            )}\n\n            <div className=\"flex justify-end gap-3 pt-4\">\n                <div className=\"relative group\">\n                    <button\n                        type=\"button\"\n                        onClick={handleClose}\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                    >\n                        <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.createTask.form.cancel')}\n                    </div>\n                </div>\n                <div className=\"relative group\">\n                    <button\n                        type=\"submit\"\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                        disabled={loading}\n                    >\n                        {loading ? (\n                            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                        ) : (\n                            <CheckIcon className=\"h-5 w-5\" />\n                        )}\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {loading ? t('tasks.createTask.form.creating') : t('tasks.createTask.form.create')}\n                    </div>\n                </div>\n            </div>\n        </form>\n    );\n};\n\nexport default CreateTaskModal; ","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { ClipboardDocumentIcon } from '@heroicons/react/24/outline';\r\nimport useMessage from '../hooks/useMessage.ts';\r\n\r\ninterface Task {\r\n  id: number;\r\n  title: string;\r\n  description: string | null;\r\n  [key: string]: any;\r\n}\r\n\r\ninterface TaskDataBoxProps {\r\n  task: Task;\r\n}\r\n\r\nconst TaskDataBox: React.FC<TaskDataBoxProps> = ({ task }) => {\r\n  const { t } = useTranslation();\r\n  const { showMessage } = useMessage();\r\n\r\n  // Extrahiere automatisch generierte Daten aus task.description oder task.metadata\r\n  // Prfe ob Task ein Lebenszyklus-Task ist\r\n  const isLifecycleTask = task.title?.includes('ARL') || \r\n                          task.title?.includes('EPS') || \r\n                          task.title?.includes('Pension') || \r\n                          task.title?.includes('Caja') ||\r\n                          task.description?.includes('lifecycle');\r\n\r\n  // Versuche Daten aus description zu extrahieren (JSON-Format)\r\n  let autoGeneratedData: Record<string, any> = {};\r\n  \r\n  if (task.description) {\r\n    try {\r\n      // Versuche JSON aus description zu extrahieren\r\n      const jsonMatch = task.description.match(/\\{[\\s\\S]*\\}/);\r\n      if (jsonMatch) {\r\n        autoGeneratedData = JSON.parse(jsonMatch[0]);\r\n      }\r\n    } catch (e) {\r\n      // Kein JSON gefunden, versuche strukturierte Daten zu extrahieren\r\n      const lines = task.description.split('\\n');\r\n      lines.forEach(line => {\r\n        const match = line.match(/([^:]+):\\s*(.+)/);\r\n        if (match) {\r\n          const key = match[1].trim();\r\n          const value = match[2].trim();\r\n          autoGeneratedData[key] = value;\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  // Wenn keine Daten gefunden wurden und es ein Lebenszyklus-Task ist, zeige Standard-Daten\r\n  if (Object.keys(autoGeneratedData).length === 0 && isLifecycleTask) {\r\n    autoGeneratedData = {\r\n      taskType: task.title,\r\n      description: task.description || t('lifecycle.noDataAvailable')\r\n    };\r\n  }\r\n\r\n  const handleCopyData = async () => {\r\n    try {\r\n      const dataString = JSON.stringify(autoGeneratedData, null, 2);\r\n      await navigator.clipboard.writeText(dataString);\r\n      showMessage(t('lifecycle.dataCopied', { defaultValue: 'Daten in Zwischenablage kopiert' }), 'success');\r\n    } catch (error) {\r\n      console.error('Fehler beim Kopieren:', error);\r\n      showMessage(t('lifecycle.copyError', { defaultValue: 'Fehler beim Kopieren' }), 'error');\r\n    }\r\n  };\r\n\r\n  // Zeige Box nur wenn es ein Lebenszyklus-Task ist oder Daten vorhanden sind\r\n  if (!isLifecycleTask && Object.keys(autoGeneratedData).length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-4\">\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <h3 className=\"text-lg font-semibold flex items-center dark:text-white\">\r\n          <ClipboardDocumentIcon className=\"h-5 w-5 mr-2\" />\r\n          {t('lifecycle.autoGeneratedData', { defaultValue: 'Automatisch generierte Daten' })}\r\n        </h3>\r\n        <button\r\n          onClick={handleCopyData}\r\n          className=\"text-blue-600 dark:text-blue-400 hover:underline text-sm\"\r\n        >\r\n          {t('lifecycle.copyData', { defaultValue: 'Daten kopieren' })}\r\n        </button>\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        {Object.keys(autoGeneratedData).length > 0 ? (\r\n          Object.entries(autoGeneratedData).map(([key, value]) => (\r\n            <div key={key} className=\"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2\">\r\n              <span className=\"font-medium w-full sm:w-1/3 dark:text-gray-300\">\r\n                {t(`lifecycle.${key}`) || key}:\r\n              </span>\r\n              <span className=\"text-gray-600 dark:text-gray-400 flex-1 break-words\">\r\n                {typeof value === 'object' ? JSON.stringify(value, null, 2) : String(value)}\r\n              </span>\r\n            </div>\r\n          ))\r\n        ) : (\r\n          <div className=\"text-gray-500 dark:text-gray-400 text-sm\">\r\n            {t('lifecycle.noDataAvailable', { defaultValue: 'Keine automatisch generierten Daten verfgbar' })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TaskDataBox;\r\n\r\n","import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { EnvelopeIcon, PaperAirplaneIcon, ArrowPathIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Task {\n  id: number;\n  title: string;\n  description: string | null;\n  [key: string]: any;\n}\n\ninterface EmailTemplateBoxProps {\n  task: Task;\n}\n\nconst EmailTemplateBox: React.FC<EmailTemplateBoxProps> = ({ task }) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [emailTemplate, setEmailTemplate] = useState<string>('');\n  const [loading, setLoading] = useState(false);\n  const [emailSent, setEmailSent] = useState(false);\n  const [generating, setGenerating] = useState(false);\n\n  // Prfe ob Task ein Lebenszyklus-Task ist\n  const isLifecycleTask = task.title?.includes('ARL') || \n                          task.title?.includes('EPS') || \n                          task.title?.includes('Pension') || \n                          task.title?.includes('Caja') ||\n                          task.description?.includes('lifecycle');\n\n  // Zeige Box nur wenn es ein Lebenszyklus-Task ist\n  if (!isLifecycleTask) {\n    return null;\n  }\n\n  const handleGenerateTemplate = async () => {\n    setGenerating(true);\n    try {\n      // API-Call zum Generieren der Email-Vorlage\n      // TODO: Endpoint implementieren wenn Backend bereit ist\n      // const response = await axiosInstance.post(`/api/tasks/${task.id}/generate-email`);\n      // setEmailTemplate(response.data.template);\n      \n      // Temporr: Generiere einfache Vorlage basierend auf Task-Daten\n      const template = `Sehr geehrte Damen und Herren,\n\nim Rahmen des Onboarding-Prozesses bentigen wir die Anmeldung fr ${task.title}.\n\nBitte senden Sie uns die erforderlichen Informationen zurck.\n\nMit freundlichen Gren\nIhr Team`;\n      \n      setEmailTemplate(template);\n      showMessage(t('lifecycle.templateGenerated', { defaultValue: 'Email-Vorlage generiert' }), 'success');\n    } catch (error: any) {\n      console.error('Fehler beim Generieren der Email-Vorlage:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.templateGenerationError', { defaultValue: 'Fehler beim Generieren der Vorlage' }),\n        'error'\n      );\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const handleSendEmail = async () => {\n    if (!emailTemplate.trim()) {\n      showMessage(t('lifecycle.templateRequired', { defaultValue: 'Bitte generieren Sie zuerst eine Vorlage' }), 'warning');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      // API-Call zum Versenden der Email\n      // TODO: Endpoint implementieren wenn Backend bereit ist\n      // await axiosInstance.post(`/api/tasks/${task.id}/send-email`, {\n      //   template: emailTemplate\n      // });\n      \n      // Temporr: Simuliere Versand\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      setEmailSent(true);\n      showMessage(t('lifecycle.emailSent', { defaultValue: 'Email erfolgreich versendet' }), 'success');\n    } catch (error: any) {\n      console.error('Fehler beim Versenden der Email:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.emailSendError', { defaultValue: 'Fehler beim Versenden der Email' }),\n        'error'\n      );\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-4\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold flex items-center dark:text-white\">\n          <EnvelopeIcon className=\"h-5 w-5 mr-2\" />\n          {t('lifecycle.emailTemplate', { defaultValue: 'Email-Vorlage' })}\n        </h3>\n        <button\n          onClick={handleGenerateTemplate}\n          disabled={generating}\n          className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center text-sm\"\n        >\n          {generating ? (\n            <>\n              <ArrowPathIcon className=\"h-4 w-4 mr-2 animate-spin\" />\n              {t('common.generating', { defaultValue: 'Generiere...' })}\n            </>\n          ) : (\n            t('lifecycle.generateTemplate', { defaultValue: 'Vorlage generieren' })\n          )}\n        </button>\n      </div>\n      \n      {emailTemplate && (\n        <div className=\"space-y-4\">\n          <textarea\n            value={emailTemplate}\n            onChange={(e) => {\n              setEmailTemplate(e.target.value);\n              setEmailSent(false);\n            }}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            rows={10}\n            placeholder={t('lifecycle.templatePlaceholder', { defaultValue: 'Email-Vorlage wird hier angezeigt...' })}\n          />\n          <div className=\"flex justify-end\">\n            <button\n              onClick={handleSendEmail}\n              disabled={loading || emailSent}\n              className=\"p-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? t('common.sending', { defaultValue: 'Sende...' }) : emailSent ? t('lifecycle.emailSent', { defaultValue: 'Versendet' }) : t('lifecycle.sendEmail', { defaultValue: 'Email versenden' })}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : emailSent ? (\n                <CheckIcon className=\"h-5 w-5\" />\n              ) : (\n                <PaperAirplaneIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </div>\n      )}\n      \n      {!emailTemplate && (\n        <div className=\"text-gray-500 dark:text-gray-400 text-sm text-center py-4\">\n          {t('lifecycle.noTemplate', { defaultValue: 'Klicken Sie auf \"Vorlage generieren\" um eine Email-Vorlage zu erstellen' })}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default EmailTemplateBox;\n\n","import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Task {\n  id: number;\n  title: string;\n  description: string | null;\n  responsibleId: number | null;\n  [key: string]: any;\n}\n\ninterface SocialSecurityCompletionBoxProps {\n  task: Task;\n  onComplete?: () => void;\n}\n\nconst SocialSecurityCompletionBox: React.FC<SocialSecurityCompletionBoxProps> = ({\n  task,\n  onComplete\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [formData, setFormData] = useState({\n    registrationNumber: '',\n    provider: '',\n    registrationDate: '',\n    notes: ''\n  });\n  const [loading, setLoading] = useState(false);\n\n  // Prfe ob Task ein Lebenszyklus-Task ist\n  const isLifecycleTask = task.title?.includes('ARL') || \n                          task.title?.includes('EPS') || \n                          task.title?.includes('Pension') || \n                          task.title?.includes('Caja') ||\n                          task.description?.includes('lifecycle');\n\n  // Bestimme Typ der Sozialversicherung aus Task-Titel\n  const getSocialSecurityType = (): string | null => {\n    if (task.title?.includes('ARL')) return 'arl';\n    if (task.title?.includes('EPS')) return 'eps';\n    if (task.title?.includes('Pension')) return 'pension';\n    if (task.title?.includes('Caja')) return 'caja';\n    return null;\n  };\n\n  // Zeige Box nur wenn es ein Lebenszyklus-Task ist\n  if (!isLifecycleTask) {\n    return null;\n  }\n\n  const socialSecurityType = getSocialSecurityType();\n\n  // Extrahiere userId aus task (muss aus task.responsibleId oder task.description kommen)\n  // TODO: Backend sollte userId in task-Metadaten bereitstellen\n  const extractUserId = (): number | null => {\n    // Versuche userId aus description zu extrahieren\n    if (task.description) {\n      const userIdMatch = task.description.match(/userId[:\\s]+(\\d+)/i);\n      if (userIdMatch) {\n        return parseInt(userIdMatch[1], 10);\n      }\n    }\n    // Fallback: verwende responsibleId (wenn es der User selbst ist)\n    return task.responsibleId;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    \n    try {\n      const userId = extractUserId();\n      if (!userId || !socialSecurityType) {\n        showMessage(\n          t('lifecycle.missingData', { defaultValue: 'Benutzer-ID oder Sozialversicherungs-Typ fehlt' }),\n          'error'\n        );\n        return;\n      }\n\n      // API-Call zum Abschlieen der Anmeldung\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, socialSecurityType),\n        {\n          status: 'registered',\n          registrationNumber: formData.registrationNumber,\n          provider: formData.provider,\n          registrationDate: formData.registrationDate,\n          notes: formData.notes,\n          completedAt: new Date().toISOString()\n        }\n      );\n\n      showMessage(\n        t('lifecycle.registrationCompleted', { defaultValue: 'Anmeldung erfolgreich abgeschlossen' }),\n        'success'\n      );\n\n      // Formular zurcksetzen\n      setFormData({\n        registrationNumber: '',\n        provider: '',\n        registrationDate: '',\n        notes: ''\n      });\n\n      if (onComplete) {\n        onComplete();\n      }\n    } catch (error: any) {\n      console.error('Fehler beim Abschlieen der Anmeldung:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.registrationError', { defaultValue: 'Fehler beim Abschlieen der Anmeldung' }),\n        'error'\n      );\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-4\">\n      <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">\n        {t('lifecycle.completeRegistration', { defaultValue: 'Anmeldung abschlieen' })}\n      </h3>\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('lifecycle.registrationNumber', { defaultValue: 'Registrierungsnummer' })} *\n          </label>\n          <input\n            type=\"text\"\n            value={formData.registrationNumber}\n            onChange={(e) => setFormData({ ...formData, registrationNumber: e.target.value })}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n            placeholder={t('lifecycle.registrationNumberPlaceholder', { defaultValue: 'z.B. 123456789' })}\n          />\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('lifecycle.provider', { defaultValue: 'Anbieter' })} *\n          </label>\n          <input\n            type=\"text\"\n            value={formData.provider}\n            onChange={(e) => setFormData({ ...formData, provider: e.target.value })}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n            placeholder={t('lifecycle.providerPlaceholder', { defaultValue: 'z.B. ARL Sura, EPS Sanitas' })}\n          />\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('lifecycle.registrationDate', { defaultValue: 'Anmeldedatum' })} *\n          </label>\n          <input\n            type=\"date\"\n            value={formData.registrationDate}\n            onChange={(e) => setFormData({ ...formData, registrationDate: e.target.value })}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n          />\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('lifecycle.notes', { defaultValue: 'Notizen' })}\n          </label>\n          <textarea\n            value={formData.notes}\n            onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            rows={3}\n            placeholder={t('lifecycle.notesPlaceholder', { defaultValue: 'Zustzliche Informationen...' })}\n          />\n        </div>\n        <div className=\"flex justify-end\">\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"p-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n            title={loading ? t('common.saving', { defaultValue: 'Speichere...' }) : t('lifecycle.complete', { defaultValue: 'Abschlieen' })}\n          >\n            {loading ? (\n              <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n            ) : (\n              <CheckIcon className=\"h-5 w-5\" />\n            )}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default SocialSecurityCompletionBox;\n\n","import React, { useEffect, useState, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS, getTaskAttachmentUrl } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport CerebroArticleSelector from './CerebroArticleSelector.tsx';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, TrashIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport MarkdownPreview from './MarkdownPreview.tsx';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport TaskDataBox from './TaskDataBox.tsx';\nimport EmailTemplateBox from './EmailTemplateBox.tsx';\nimport SocialSecurityCompletionBox from './SocialSecurityCompletionBox.tsx';\n\ninterface User {\n    id: number;\n    firstName: string;\n    lastName: string;\n}\n\ninterface Role {\n    id: number;\n    name: string;\n}\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface TaskAttachment {\n    id: number;\n    fileName: string;\n    fileType: string;\n    fileSize: number;\n    filePath: string;\n    uploadedAt: string;\n    file?: File;\n}\n\ninterface CerebroArticle {\n    id: number;\n    title: string;\n    slug: string;\n    content?: string;\n}\n\ninterface Task {\n    id: number;\n    title: string;\n    description: string | null;\n    status: 'open' | 'in_progress' | 'improval' | 'quality_control' | 'done';\n    responsible: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    responsibleId: number | null;\n    role: {\n        id: number;\n        name: string;\n    } | null;\n    roleId: number | null;\n    qualityControl: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    branch: {\n        id: number;\n        name: string;\n    };\n    dueDate: string | null;\n    requestId: number | null;\n    attachments?: TaskAttachment[];\n}\n\ninterface EditTaskModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTaskUpdated: (updatedTask: Task) => void;\n    task: Task;\n}\n\nconst EditTaskModal: React.FC<EditTaskModalProps> = ({ isOpen, onClose, onTaskUpdated, task }) => {\n    const { t } = useTranslation();\n    const { hasPermission } = usePermissions();\n    const { user } = useAuth();\n    const { openSidepane, closeSidepane } = useSidepane();\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    // Entferne Bild-Markdown-Links aus der Beschreibung (fr Textarea-Anzeige)\n    const removeImageMarkdown = (text: string): string => {\n        if (!text) return '';\n        // Entferne alle Bild-Markdown-Links: ![alt](url)\n        return text.replace(/!\\[([^\\]]*)\\]\\([^)]+\\)/g, '').trim();\n    };\n    \n    const [title, setTitle] = useState(task.title || '');\n    const [description, setDescription] = useState(removeImageMarkdown(task.description || ''));\n    // Speichere die originale Beschreibung (mit Bildern) fr das Speichern\n    const originalDescription = task.description || '';\n    const [status, setStatus] = useState(task.status || 'open');\n    const [assigneeType, setAssigneeType] = useState<'user' | 'role'>(task.roleId ? 'role' : 'user');\n    const [responsibleId, setResponsibleId] = useState<number | null>(task.responsibleId || null);\n    const [roleId, setRoleId] = useState<number | null>(task.roleId || null);\n    const [qualityControlId, setQualityControlId] = useState<number | null>(task.qualityControl?.id || null);\n    const [branchId, setBranchId] = useState<number>(task.branch?.id || 0);\n    const [attachments, setAttachments] = useState<TaskAttachment[]>(task.attachments || []);\n    const [temporaryAttachments, setTemporaryAttachments] = useState<TaskAttachment[]>([]);\n    const [uploading, setUploading] = useState(false);\n    // Liste der whrend der Bearbeitung hochgeladenen Attachments (fr Cleanup bei Abbrechen)\n    const [uploadedDuringEdit, setUploadedDuringEdit] = useState<number[]>([]);\n    const fileInputRef = useRef<HTMLInputElement>(null);\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n    // Formatiere das Datum im Format YYYY-MM-DD fr das HTML-Datumseingabefeld\n    const formatDate = (dateString: string | null): string | null => {\n        if (!dateString) return null;\n        \n        // Versuche das Datum zu parsen\n        const date = new Date(dateString);\n        if (isNaN(date.getTime())) return null; // Ungltiges Datum\n        \n        // Formatiere als YYYY-MM-DD\n        return date.toISOString().split('T')[0];\n    };\n\n    const [dueDate, setDueDate] = useState<string | null>(formatDate(task.dueDate));\n    const [users, setUsers] = useState<User[]>([]);\n    const [roles, setRoles] = useState<Role[]>([]);\n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [confirmDelete, setConfirmDelete] = useState(false);\n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [linkedArticles, setLinkedArticles] = useState<CerebroArticle[]>([]);\n    const [activeTab, setActiveTab] = useState<'data' | 'cerebro'>('data');\n\n    const canDeleteTask = hasPermission('tasks', 'both', 'table');\n\n    // Responsive Design: berwache Fensterbreite\n    useEffect(() => {\n        const handleResize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        window.addEventListener('resize', handleResize);\n        return () => window.removeEventListener('resize', handleResize);\n    }, []);\n\n    // Cleanup: Lsche hochgeladene Attachments wenn Modal ohne Speichern geschlossen wird\n    useEffect(() => {\n        if (!isOpen && uploadedDuringEdit.length > 0) {\n            // Modal wurde geschlossen - lsche alle whrend der Bearbeitung hochgeladenen Attachments\n            const cleanup = async () => {\n                for (const attachmentId of uploadedDuringEdit) {\n                    try {\n                        await axiosInstance.delete(API_ENDPOINTS.TASKS.ATTACHMENT(task.id, attachmentId));\n                        console.log(`Task Attachment ${attachmentId} gelscht (Modal ohne Speichern geschlossen)`);\n                    } catch (err) {\n                        console.error(`Fehler beim Lschen von Task Attachment ${attachmentId}:`, err);\n                    }\n                }\n                setUploadedDuringEdit([]);\n            };\n            cleanup();\n        }\n    }, [isOpen, uploadedDuringEdit, task.id]);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    useEffect(() => {\n        if (isOpen) {\n            fetchUsers();\n            fetchRoles();\n            fetchBranches();\n            fetchLinkedArticles();\n            fetchAttachments();\n        }\n    }, [isOpen, task.id]);\n\n    const fetchUsers = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.USERS.DROPDOWN);\n            setUsers(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Benutzer:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.editTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.editTask.errors.loadUsersError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchRoles = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.ROLES.BASE);\n            setRoles(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Rollen:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.editTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.editTask.errors.loadRolesError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchBranches = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n            setBranches(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Niederlassungen:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.editTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.editTask.errors.loadBranchesError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchLinkedArticles = async () => {\n        try {\n            setError(null);\n            const response = await axiosInstance.get(API_ENDPOINTS.TASKS.CARTICLES(task.id));\n            setLinkedArticles(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der verknpften Artikel:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const fetchAttachments = async () => {\n        try {\n            setError(null);\n            const response = await axiosInstance.get(API_ENDPOINTS.TASKS.ATTACHMENTS(task.id));\n            setAttachments(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Anhnge:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n            setAttachments([]);\n        }\n    };\n\n    const handlePaste = async (event: React.ClipboardEvent) => {\n        const items = event.clipboardData.items;\n        \n        for (let i = 0; i < items.length; i++) {\n            const item = items[i];\n            \n            // Prfen, ob das eingefgte Element ein Bild ist\n            if (item.type.indexOf('image') === 0) {\n                event.preventDefault(); // Standardeingabe verhindern\n                \n                const file = item.getAsFile();\n                if (file) {\n                    await uploadFileAndInsertLink(file);\n                }\n                return;\n            }\n        }\n    };\n\n    const handleDrop = async (event: React.DragEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n        \n        if (event.dataTransfer.files && event.dataTransfer.files.length > 0) {\n            const file = event.dataTransfer.files[0];\n            await uploadFileAndInsertLink(file);\n        }\n    };\n\n    const handleDragOver = (event: React.DragEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    const uploadFileAndInsertLink = async (file: File) => {\n        setUploading(true);\n        setError(null);\n\n        try {\n            const formData = new FormData();\n            formData.append('file', file);\n\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.TASKS.ATTACHMENTS(task.id),\n                formData,\n                {\n                    headers: {\n                        'Content-Type': 'multipart/form-data',\n                    },\n                }\n            );\n\n            const newAttachment = response.data;\n            setAttachments([...attachments, newAttachment]);\n            // Merke diese Attachment-ID fr mgliches Cleanup\n            setUploadedDuringEdit(prev => [...prev, newAttachment.id]);\n\n            // Fr Bilder: KEIN Markdown-Link ins Textarea einfgen (wird beim Speichern automatisch hinzugefgt)\n            // Fr andere Dateien: Link ins Textarea einfgen\n            if (!newAttachment.fileType.startsWith('image/')) {\n                const insertText = `\\n[${newAttachment.fileName}](${getTaskAttachmentUrl(task.id, newAttachment.id)})\\n`;\n                \n                // Fge den Link an der aktuellen Cursorposition ein\n                if (textareaRef.current) {\n                    const cursorPos = textareaRef.current.selectionStart;\n                    const textBefore = description.substring(0, cursorPos);\n                    const textAfter = description.substring(cursorPos);\n                    \n                    setDescription(textBefore + insertText + textAfter);\n                    \n                    // Setze den Cursor hinter den eingefgten Link\n                    setTimeout(() => {\n                        if (textareaRef.current) {\n                            const newPos = cursorPos + insertText.length;\n                            textareaRef.current.selectionStart = newPos;\n                            textareaRef.current.selectionEnd = newPos;\n                            textareaRef.current.focus();\n                        }\n                    }, 0);\n                } else {\n                    setDescription(description + insertText);\n                }\n            }\n        } catch (err) {\n            console.error('Fehler beim Verarbeiten der Datei:', err);\n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        } finally {\n            setUploading(false);\n        }\n    };\n\n    const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n        const files = event.target.files;\n        if (!files || files.length === 0) return;\n\n        const file = files[0];\n        await uploadFileAndInsertLink(file);\n        \n        // Zurcksetzen des Datei-Inputs\n        if (fileInputRef.current) {\n            fileInputRef.current.value = '';\n        }\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n        setLoading(true);\n\n        try {\n            // Validierung\n            if (!title || !status || !branchId) {\n                setError(t('tasks.editTask.errors.fillAllFields'));\n                setLoading(false);\n                return;\n            }\n\n            // berprfen, ob entweder Benutzer oder Rolle ausgewhlt wurde\n            if (assigneeType === 'user' && !responsibleId) {\n                setError(t('tasks.editTask.form.chooseUser'));\n                setLoading(false);\n                return;\n            }\n            \n            if (assigneeType === 'role' && !roleId) {\n                setError(t('tasks.editTask.form.chooseRole'));\n                setLoading(false);\n                return;\n            }\n\n            // Verwende description (vom Textarea) als Basis\n            // Fge Markdown-Links fr Bilder automatisch hinzu (falls noch nicht vorhanden)\n            let finalDescription = description || ''; // WICHTIG: Verwende description als Basis, nicht originalDescription\n            const imageAttachments = attachments.filter(att => att.fileType?.startsWith('image/') && att.id);\n            \n            // Extrahiere bereits vorhandene Bilder aus originalDescription (falls vorhanden)\n            const existingImagePattern = /!\\[([^\\]]*)\\]\\([^)]+\\)/g;\n            const existingImages: string[] = [];\n            let match;\n            if (originalDescription) {\n                while ((match = existingImagePattern.exec(originalDescription)) !== null) {\n                    existingImages.push(match[0]);\n                }\n            }\n            \n            // Fge alle Bilder hinzu (sowohl neue als auch bereits vorhandene)\n            for (const attachment of imageAttachments) {\n                const imageUrl = getTaskAttachmentUrl(task.id, attachment.id!);\n                const imageMarkdown = `![${attachment.fileName}](${imageUrl})`;\n                \n                // Prfe, ob dieser Bild-Link bereits in der Beschreibung vorhanden ist\n                const escapedFileName = attachment.fileName.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                const imagePattern = new RegExp(`!\\\\[${escapedFileName}\\\\]\\\\([^)]+\\\\)`, 'g');\n                \n                if (!imagePattern.test(finalDescription)) {\n                    // Bild-Link ist noch nicht in der Beschreibung, fge ihn hinzu\n                    finalDescription = finalDescription ? `${finalDescription}\\n${imageMarkdown}` : imageMarkdown;\n                }\n            }\n            \n            // Fge auch bereits vorhandene Bilder hinzu, die nicht in attachments sind (z.B. von anderen Quellen)\n            for (const existingImage of existingImages) {\n                if (!finalDescription.includes(existingImage)) {\n                    finalDescription = finalDescription ? `${finalDescription}\\n${existingImage}` : existingImage;\n                }\n            }\n\n            // Basis-Daten fr die Anfrage\n            const taskData: any = {\n                title,\n                description: finalDescription,\n                status,\n                qualityControlId,\n                branchId,\n                dueDate\n            };\n\n            // Entweder responsibleId oder roleId hinzufgen, nicht beides\n            if (assigneeType === 'user') {\n                taskData.responsibleId = responsibleId;\n                taskData.roleId = null; // Rolle explizit auf null setzen, um sie zu entfernen\n            } else if (assigneeType === 'role') {\n                taskData.roleId = roleId;\n                taskData.responsibleId = null; // Benutzer explizit auf null setzen, um ihn zu entfernen\n            }\n\n            const response = await axiosInstance.put(`${API_ENDPOINTS.TASKS.BASE}/${task.id}`, taskData);\n\n            console.log('Task aktualisiert:', response.data);\n            \n            // Hole den aktualisierten Task vom Server (inkl. Attachments)\n            const updatedTaskResponse = await axiosInstance.get(API_ENDPOINTS.TASKS.BY_ID(task.id));\n            \n            // Attachments sind bereits in der Response enthalten\n            // URL-Generierung fr Attachments hinzufgen\n            if (updatedTaskResponse.data.attachments) {\n                updatedTaskResponse.data.attachments = updatedTaskResponse.data.attachments.map((att: any) => ({\n                    id: att.id,\n                    fileName: att.fileName,\n                    fileType: att.fileType,\n                    fileSize: att.fileSize,\n                    filePath: att.filePath,\n                    uploadedAt: att.uploadedAt,\n                    url: getTaskAttachmentUrl(task.id, att.id)\n                }));\n            } else {\n                updatedTaskResponse.data.attachments = [];\n            }\n            \n            // bergebe den aktualisierten Task an den Callback\n            // Reset uploadedDuringEdit da erfolgreich gespeichert\n            setUploadedDuringEdit([]);\n            onTaskUpdated(updatedTaskResponse.data);\n            onClose();\n        } catch (err) {\n            console.error('Fehler beim Aktualisieren des Tasks:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleDelete = async () => {\n        if (!confirmDelete) {\n            setConfirmDelete(true);\n            return;\n        }\n        \n        try {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n\n            await axiosInstance.delete(API_ENDPOINTS.TASKS.BY_ID(task.id));\n\n            // Beim Lschen wird kein Task zurckgegeben, daher undefined bergeben\n            onTaskUpdated(undefined as any);\n            onClose();\n        } catch (err) {\n            console.error('Delete Error:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleAddArticle = async (article: CerebroArticle) => {\n        try {\n            setError(null);\n            \n            await axiosInstance.post(\n                API_ENDPOINTS.TASKS.LINK_CARTICLE(task.id, article.id)\n            );\n            \n            setLinkedArticles(prev => [...prev, article]);\n        } catch (err) {\n            console.error('Fehler beim Verknpfen des Artikels:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n    \n    const handleRemoveArticle = async (articleId: number) => {\n        try {\n            setError(null);\n            \n            await axiosInstance.delete(\n                API_ENDPOINTS.TASKS.UNLINK_CARTICLE(task.id, articleId)\n            );\n            \n            setLinkedArticles(prev => prev.filter(a => a.id !== articleId));\n        } catch (err) {\n            console.error('Fehler beim Entfernen der Artikelverknpfung:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleDeleteAttachment = async (attachmentId: number) => {\n        try {\n            setError(null);\n            \n            // Finde den zu entfernenden Anhang\n            const attachmentToRemove = attachments.find(a => a.id === attachmentId);\n            \n            if (attachmentToRemove) {\n                await axiosInstance.delete(API_ENDPOINTS.TASKS.ATTACHMENT(task.id, attachmentId));\n                \n                // Entferne den Anhang aus der Liste\n                setAttachments(attachments.filter(attachment => attachment.id !== attachmentId));\n                \n                // Entferne auch die Verweise im Beschreibungstext\n                if (attachmentToRemove.fileName) {\n                    // Erzeuge URL-Muster fr diesen Anhang\n                    const attachmentUrl = getTaskAttachmentUrl(task.id, attachmentId);\n                    const escapedAttachmentUrl = attachmentUrl.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                    \n                    // Suche nach Bild- und Link-Markdown\n                    const imagePattern = new RegExp(`!\\\\[(.*?)\\\\]\\\\(${escapedAttachmentUrl}\\\\)`, 'g');\n                    const linkPattern = new RegExp(`\\\\[(.*?)\\\\]\\\\(${escapedAttachmentUrl}\\\\)`, 'g');\n                    \n                    // Bereinige die Beschreibung\n                    const newDescription = description\n                        .replace(imagePattern, '')\n                        .replace(linkPattern, '')\n                        // Entferne berschssige Leerzeilen, die durch das Entfernen entstehen knnten\n                        .replace(/\\n{3,}/g, '\\n\\n');\n                    \n                    setDescription(newDescription);\n                }\n            }\n        } catch (err) {\n            console.error('Fehler beim Lschen des Anhangs:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleDownloadAttachment = async (attachment: TaskAttachment) => {\n        try {\n            const response = await axiosInstance.get(\n                API_ENDPOINTS.TASKS.ATTACHMENT(task.id, attachment.id),\n                { responseType: 'blob' }\n            );\n            \n            // Blob-URL erstellen und Download auslsen\n            const url = window.URL.createObjectURL(new Blob([response.data]));\n            const link = document.createElement('a');\n            link.href = url;\n            link.setAttribute('download', attachment.fileName);\n            document.body.appendChild(link);\n            link.click();\n            link.remove();\n        } catch (err) {\n            console.error('Fehler beim Herunterladen des Anhangs:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleRemoveTemporaryAttachment = (index: number) => {\n        // Finde den zu entfernenden Anhang\n        const attachmentToRemove = temporaryAttachments[index];\n        \n        if (attachmentToRemove) {\n            // Entferne den Anhang aus dem temporaryAttachments-Array\n            setTemporaryAttachments(temporaryAttachments.filter((_, i) => i !== index));\n            \n            // Entferne auch den Verweis im Beschreibungstext\n            if (attachmentToRemove.fileName) {\n                // Suche nach Bild- und Link-Markdown mit dem Dateinamen\n                const escapedFileName = attachmentToRemove.fileName.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                const uploadText = t('tasks.editTask.form.uploadAfterCreate');\n                const imagePattern = new RegExp(`!\\\\[${escapedFileName}\\\\]\\\\(${uploadText.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\)`, 'g');\n                const linkPattern = new RegExp(`\\\\[${escapedFileName}\\\\]\\\\(${uploadText.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\)`, 'g');\n                \n                // Bereinige die Beschreibung\n                const newDescription = description\n                    .replace(imagePattern, '')\n                    .replace(linkPattern, '')\n                    // Entferne berschssige Leerzeilen, die durch das Entfernen entstehen knnten\n                    .replace(/\\n{3,}/g, '\\n\\n');\n                \n                setDescription(newDescription);\n            }\n        }\n    };\n\n    const renderForm = () => (\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Tabs Navigation */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n                <nav className=\"-mb-px flex space-x-4\" aria-label=\"Tabs\">\n                    <button\n                        type=\"button\"\n                        className={`${\n                            activeTab === 'data'\n                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600'\n                        } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                        onClick={() => setActiveTab('data')}\n                    >\n                        {t('tasks.editTask.tabs.data')}\n                    </button>\n                    <button\n                        type=\"button\"\n                        className={`${\n                            activeTab === 'cerebro'\n                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600'\n                        } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                        onClick={() => setActiveTab('cerebro')}\n                    >\n                        {t('tasks.editTask.tabs.cerebro')}\n                    </button>\n                </nav>\n            </div>\n\n            {/* Data Tab Content */}\n            {activeTab === 'data' && (\n                <>\n                    <div>\n                        <label htmlFor=\"title\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.title')}\n                        </label>\n                        <input\n                            type=\"text\"\n                            id=\"title\"\n                            value={title}\n                            onChange={(e) => setTitle(e.target.value)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                            required\n                        />\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"description_edit\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.description')}\n                        </label>\n                        <div className=\"relative\">\n                            <textarea\n                                ref={textareaRef}\n                                id=\"description_edit\"\n                                rows={6}\n                                className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                value={description}\n                                onChange={(e) => setDescription(e.target.value)}\n                                onPaste={handlePaste}\n                                onDrop={handleDrop}\n                                onDragOver={handleDragOver}\n                                placeholder={t('tasks.editTask.form.descriptionPlaceholder')}\n                            />\n                            <div className=\"relative group absolute bottom-2 left-2\">\n                                <button\n                                    type=\"button\"\n                                    onClick={() => fileInputRef.current?.click()}\n                                    className=\"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400 focus:outline-none\"\n                                >\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\" />\n                                    </svg>\n                                </button>\n                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                    {t('tasks.editTask.form.fileUpload')}\n                                </div>\n                            </div>\n                            <input\n                                ref={fileInputRef}\n                                type=\"file\"\n                                onChange={handleFileUpload}\n                                className=\"hidden\"\n                            />\n                            {uploading && (\n                                <div className=\"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-70 dark:bg-opacity-70\">\n                                    <span className=\"text-sm text-gray-600 dark:text-gray-300\">{t('tasks.editTask.form.uploading')}</span>\n                                </div>\n                            )}\n                        </div>\n                        {renderAttachments()}\n                        {renderTemporaryAttachments()}\n                        {/* Bilder werden bereits im Textarea als Markdown angezeigt und in der Card durch MarkdownPreview mit showImagePreview={true} */}\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"status\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.status')}\n                        </label>\n                        <select\n                            id=\"status\"\n                            value={status}\n                            onChange={(e) => setStatus(e.target.value as Task['status'])}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        >\n                            <option value=\"open\">{t('tasks.status.open')}</option>\n                            <option value=\"in_progress\">{t('tasks.status.in_progress')}</option>\n                            <option value=\"improval\">{t('tasks.status.improval')}</option>\n                            <option value=\"quality_control\">{t('tasks.status.quality_control')}</option>\n                            <option value=\"done\">{t('tasks.status.done')}</option>\n                        </select>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.responsibleFor')} *\n                        </label>\n                        <div className=\"flex space-x-4\">\n                            <label className=\"inline-flex items-center\">\n                                <input\n                                    type=\"radio\"\n                                    className=\"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600\"\n                                    name=\"assigneeType\"\n                                    value=\"user\"\n                                    checked={assigneeType === 'user'}\n                                    onChange={() => {\n                                        setAssigneeType('user');\n                                        setRoleId(null);\n                                    }}\n                                />\n                                <span className=\"ml-2 dark:text-gray-300\">{t('tasks.editTask.form.user')}</span>\n                            </label>\n                            <label className=\"inline-flex items-center\">\n                                <input\n                                    type=\"radio\"\n                                    className=\"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600\"\n                                    name=\"assigneeType\"\n                                    value=\"role\"\n                                    checked={assigneeType === 'role'}\n                                    onChange={() => {\n                                        setAssigneeType('role');\n                                        setResponsibleId(null);\n                                    }}\n                                />\n                                <span className=\"ml-2 dark:text-gray-300\">{t('tasks.editTask.form.role')}</span>\n                            </label>\n                        </div>\n                    </div>\n\n                    {assigneeType === 'user' ? (\n                        <div>\n                            <label htmlFor=\"responsible\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.editTask.form.responsibleUser')} *\n                            </label>\n                            <select\n                                id=\"responsible\"\n                                value={responsibleId === null ? '' : responsibleId}\n                                onChange={(e) => setResponsibleId(e.target.value ? Number(e.target.value) : null)}\n                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                required={assigneeType === 'user'}\n                            >\n                                <option value=\"\">{t('tasks.editTask.form.pleaseSelect')}</option>\n                                {Array.isArray(users) && users.map(user => (\n                                    <option key={user.id} value={user.id}>\n                                        {user.firstName} {user.lastName}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n                    ) : (\n                        <div>\n                            <label htmlFor=\"role\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.editTask.form.responsibleRole')} *\n                            </label>\n                            <select\n                                id=\"role\"\n                                value={roleId === null ? '' : roleId}\n                                onChange={(e) => setRoleId(e.target.value ? Number(e.target.value) : null)}\n                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                required={assigneeType === 'role'}\n                            >\n                                <option value=\"\">{t('tasks.editTask.form.pleaseSelect')}</option>\n                                {Array.isArray(roles) && roles.map(role => (\n                                    <option key={role.id} value={role.id}>\n                                        {role.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n                    )}\n\n                    <div>\n                        <label htmlFor=\"qualityControl\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.qualityControl')}\n                        </label>\n                        <select\n                            id=\"qualityControl\"\n                            value={qualityControlId === null ? '' : qualityControlId}\n                            onChange={(e) => setQualityControlId(e.target.value ? Number(e.target.value) : null)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        >\n                            <option value=\"\">{t('tasks.editTask.form.noQualityControl')}</option>\n                            {Array.isArray(users) && users.map(user => (\n                                <option key={user.id} value={user.id}>\n                                    {user.firstName} {user.lastName}\n                                </option>\n                            ))}\n                        </select>\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"branch\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.branch')}\n                        </label>\n                        <select\n                            id=\"branch\"\n                            value={branchId === 0 ? '' : branchId}\n                            onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : 0)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                            required\n                        >\n                            <option value=\"\">{t('common.pleaseSelect')}</option>\n                            {Array.isArray(branches) && branches.map(branch => (\n                                <option key={branch.id} value={branch.id}>\n                                    {branch.name}\n                                </option>\n                            ))}\n                        </select>\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"dueDate\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.dueDate')}\n                        </label>\n                        <input\n                            type=\"date\"\n                            id=\"dueDate\"\n                            value={dueDate || ''}\n                            onChange={(e) => {\n                                // Wenn das Feld leer ist, setze auf null\n                                if (!e.target.value) {\n                                    setDueDate(null);\n                                } else {\n                                    // Ansonsten behalte das Format YYYY-MM-DD bei\n                                    setDueDate(e.target.value);\n                                }\n                            }}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        />\n                    </div>\n                </>\n            )}\n\n            {/* Cerebro Articles Tab Content */}\n            {activeTab === 'cerebro' && (\n                <div>\n                    {linkedArticles.length > 0 && (\n                        <div className=\"mb-4\">\n                            <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('tasks.editTask.form.linkedCerebroArticles')}</h3>\n                            <ul className=\"space-y-2\">\n                                {linkedArticles.map(article => (\n                                    <li key={article.id} className=\"flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 rounded\">\n                                        <a \n                                            href={`/cerebro/articles/${article.slug}`} \n                                            target=\"_blank\" \n                                            rel=\"noopener noreferrer\"\n                                            className=\"text-blue-600 hover:underline dark:text-blue-400 dark:hover:text-blue-300\"\n                                        >\n                                            {article.title}\n                                        </a>\n                                        <button\n                                            type=\"button\"\n                                            onClick={() => handleRemoveArticle(article.id)}\n                                            className=\"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300\"\n                                        >\n                                            {t('tasks.editTask.form.remove')}\n                                        </button>\n                                    </li>\n                                ))}\n                            </ul>\n                        </div>\n                    )}\n\n                    <CerebroArticleSelector \n                        onArticleSelected={handleAddArticle}\n                        excludeArticleIds={linkedArticles.map(a => a.id)}\n                        selectedArticles={linkedArticles}\n                        onArticleRemove={handleRemoveArticle}\n                    />\n                </div>\n            )}\n\n            {/* Lifecycle Task Boxes - nur fr Lebenszyklus-Tasks */}\n            {activeTab === 'data' && (task.title?.includes('ARL') || \n                                      task.title?.includes('EPS') || \n                                      task.title?.includes('Pension') || \n                                      task.title?.includes('Caja') ||\n                                      task.description?.includes('lifecycle')) && (\n                <>\n                    <TaskDataBox task={task} />\n                    <EmailTemplateBox task={task} />\n                    <SocialSecurityCompletionBox \n                        task={task} \n                        onComplete={() => {\n                            // Optional: Task neu laden oder Status aktualisieren\n                            if (onTaskUpdated) {\n                                // Task wird automatisch aktualisiert wenn Modal geschlossen wird\n                            }\n                        }} \n                    />\n                </>\n            )}\n                \n            <div className=\"flex justify-between pt-4\">\n                {canDeleteTask && (\n                    <div className=\"relative group\">\n                        <button\n                            type=\"button\"\n                            onClick={handleDelete}\n                            className={`p-2 rounded-md ${\n                                confirmDelete\n                                    ? 'bg-red-600 text-white dark:bg-red-700 dark:text-white hover:bg-red-700 dark:hover:bg-red-600'\n                                    : 'text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300'\n                            }`}\n                        >\n                            {confirmDelete ? (\n                                <CheckIcon className=\"h-5 w-5\" />\n                            ) : (\n                                <TrashIcon className=\"h-5 w-5\" />\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {confirmDelete ? t('tasks.editTask.form.confirmDelete') : t('tasks.editTask.form.delete')}\n                        </div>\n                    </div>\n                )}\n                <div className=\"flex gap-2\">\n                    <div className=\"relative group\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                        >\n                            <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {t('tasks.editTask.form.cancel')}\n                        </div>\n                    </div>\n                    <div className=\"relative group\">\n                        <button\n                            type=\"submit\"\n                            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                            disabled={loading}\n                        >\n                            {loading ? (\n                                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                            ) : (\n                                <CheckIcon className=\"h-5 w-5\" />\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {loading ? t('tasks.editTask.form.saving') : t('tasks.editTask.form.save')}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </form>\n    );\n\n    const renderAttachments = () => {\n        if (attachments.length === 0) return null;\n        \n        return (\n            <div className=\"mt-2\">\n                <ul className=\"flex flex-wrap gap-2\">\n                    {attachments.map((attachment) => (\n                        <li key={attachment.id} className=\"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-md px-2 py-1 relative group\">\n                            <span className=\"text-sm font-medium text-gray-800 dark:text-gray-300\">\n                                {attachment.fileName}\n                            </span>\n                            <div className=\"flex ml-2\">\n                                <div className=\"relative group mr-1\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => handleDownloadAttachment(attachment)}\n                                        className=\"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\n                                        </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tasks.editTask.form.download')}\n                                    </div>\n                                </div>\n                                <div className=\"relative group ml-1\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => handleDeleteAttachment(attachment.id)}\n                                        className=\"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                                        </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tasks.editTask.form.remove')}\n                                    </div>\n                                </div>\n                            </div>\n                            {/* Tooltip fr Bildvorschau bei Bild-Dateien */}\n                            {attachment.fileType.startsWith('image/') && (\n                                <div className=\"absolute z-10 bg-white dark:bg-gray-800 p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 dark:border-gray-600 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                    <img \n                                        src={getTaskAttachmentUrl(task.id, attachment.id)}\n                                        alt={attachment.fileName}\n                                        className=\"max-w-[200px] max-h-[150px] object-contain\"\n                                    />\n                                </div>\n                            )}\n                        </li>\n                    ))}\n                </ul>\n            </div>\n        );\n    };\n\n    const renderTemporaryAttachments = () => {\n        if (temporaryAttachments.length === 0) return null;\n        \n        return (\n            <div className=\"mt-2\">\n                <ul className=\"flex flex-wrap gap-2\">\n                    {temporaryAttachments.map((attachment, index) => (\n                        <li key={`temp-${index}`} className=\"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-md px-2 py-1 relative group\">\n                            <span className=\"text-sm font-medium text-gray-800 dark:text-gray-300\">\n                                {attachment.fileName}\n                            </span>\n                            <div className=\"flex ml-2\">\n                                <div className=\"relative group ml-1\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => handleRemoveTemporaryAttachment(index)}\n                                        className=\"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                                        </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tasks.editTask.form.remove')}\n                                    </div>\n                                </div>\n                            </div>\n                            {/* Tooltip fr Bildvorschau bei Bild-Dateien */}\n                            {attachment.fileType?.startsWith('image/') && attachment.file && (\n                                <div className=\"absolute z-10 bg-white dark:bg-gray-800 p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 dark:border-gray-600 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                    <img \n                                        src={URL.createObjectURL(attachment.file)}\n                                        alt={attachment.fileName}\n                                        className=\"max-w-[200px] max-h-[150px] object-contain\"\n                                    />\n                                </div>\n                            )}\n                        </li>\n                    ))}\n                </ul>\n            </div>\n        );\n    };\n\n    if (!isOpen) return null;\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                                {t('tasks.editTask.title')}\n                            </Dialog.Title>\n                            <button\n                                onClick={onClose}\n                                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <div className=\"p-4\">\n                            {error && (\n                                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                                    {error}\n                                </div>\n                            )}\n\n                            {renderForm()}\n                        </div>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n\n    // Fr Desktop (ab 640px) - Sidepane\n    // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    onClick={onClose}\n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                            {t('tasks.editTask.title')}\n                    </h2>\n                    <button\n                        onClick={onClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    {error && (\n                        <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                            {error}\n                        </div>\n                    )}\n\n                    {renderForm()}\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default EditTaskModal; ","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon } from '@heroicons/react/24/outline';\r\nimport { reservationService, CreateReservationData } from '../../services/reservationService.ts';\r\nimport { Reservation } from '../../types/reservation.ts';\r\nimport useMessage from '../../hooks/useMessage.ts';\r\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\r\n\r\ninterface CreateReservationModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onReservationCreated: (newReservation: Reservation) => void;\r\n}\r\n\r\nconst CreateReservationModal: React.FC<CreateReservationModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onReservationCreated\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { showMessage } = useMessage();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n\r\n  const [guestName, setGuestName] = useState('');\r\n  const [contact, setContact] = useState('');\r\n  const [amount, setAmount] = useState('');\r\n  const [currency, setCurrency] = useState('COP');\r\n  const [contactType, setContactType] = useState<'phone' | 'email' | null>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Erkenne automatisch ob es Telefonnummer oder Email ist\r\n  const detectContactType = (value: string): 'phone' | 'email' | null => {\r\n    if (!value || value.trim().length === 0) {\r\n      return null;\r\n    }\r\n    // Email-Format: enthlt @ und .\r\n    if (value.includes('@') && value.includes('.')) {\r\n      return 'email';\r\n    }\r\n    // Telefonnummer: enthlt nur Ziffern, +, Leerzeichen, Bindestriche\r\n    return 'phone';\r\n  };\r\n\r\n  const handleContactChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const value = e.target.value;\r\n    setContact(value);\r\n    setContactType(detectContactType(value));\r\n  };\r\n\r\n  const handleAmountChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const value = e.target.value;\r\n    // Erlaube nur Zahlen und Dezimalpunkt\r\n    if (value === '' || /^\\d*\\.?\\d*$/.test(value)) {\r\n      setAmount(value);\r\n    }\r\n  };\r\n\r\n  // Responsive-Verhalten\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    handleResize();\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n    };\r\n  }, []);\r\n\r\n  // Sidepane-Status verwalten\r\n  useEffect(() => {\r\n    if (isOpen && !isMobile) {\r\n      openSidepane();\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n\r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, isMobile, openSidepane, closeSidepane]);\r\n\r\n  // Reset form when modal closes\r\n  useEffect(() => {\r\n    if (!isOpen) {\r\n      setGuestName('');\r\n      setContact('');\r\n      setAmount('');\r\n      setCurrency('COP');\r\n      setContactType(null);\r\n      setError(null);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n\r\n    // Validierung\r\n    if (!guestName || guestName.trim().length === 0) {\r\n      setError(t('reservations.createReservation.errors.guestNameRequired', 'Gast-Name ist erforderlich'));\r\n      return;\r\n    }\r\n\r\n    if (!contact || contact.trim().length === 0) {\r\n      setError(t('reservations.createReservation.errors.contactRequired', 'Kontaktinformation ist erforderlich'));\r\n      return;\r\n    }\r\n\r\n    if (!amount || parseFloat(amount) <= 0) {\r\n      setError(t('reservations.createReservation.errors.amountRequired', 'Betrag muss eine positive Zahl sein'));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      const data: CreateReservationData = {\r\n        guestName: guestName.trim(),\r\n        contact: contact.trim(),\r\n        amount: parseFloat(amount),\r\n        currency: currency\r\n      };\r\n\r\n      console.log('[CreateReservationModal] Sende Daten:', data);\r\n      console.log('[CreateReservationModal] API Endpoint:', '/api/reservations');\r\n      const newReservation = await reservationService.create(data);\r\n      console.log('[CreateReservationModal] Reservierung erstellt:', newReservation);\r\n      \r\n      showMessage(\r\n        t('reservations.createReservation.success', 'Reservierung erfolgreich erstellt'),\r\n        'success'\r\n      );\r\n\r\n      onReservationCreated(newReservation);\r\n      onClose();\r\n    } catch (err: any) {\r\n      console.error('[CreateReservationModal] Fehler beim Erstellen der Reservierung:', err);\r\n      console.error('[CreateReservationModal] Error Response:', err.response);\r\n      console.error('[CreateReservationModal] Error Status:', err.response?.status);\r\n      console.error('[CreateReservationModal] Error Data:', err.response?.data);\r\n      const errorMessage = err.response?.data?.message || err.message ||\r\n        t('reservations.createReservation.errors.createError', 'Fehler beim Erstellen der Reservierung');\r\n      setError(errorMessage);\r\n      showMessage(errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    onClose();\r\n  };\r\n\r\n  // Fr Mobile (< 640px) - Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n            <div className=\"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\r\n              <div className=\"flex items-center justify-between mb-4\">\r\n                <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                  {t('reservations.createReservation.title', 'Neue Reservierung')}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={handleClose}\r\n                  className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n\r\n            {error && (\r\n              <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded\">\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            <form onSubmit={handleSubmit}>\r\n              {/* Gast-Name */}\r\n              <div className=\"mb-4\">\r\n                <label htmlFor=\"guestName\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  {t('reservations.createReservation.guestName', 'Gast-Name')} *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"guestName\"\r\n                  value={guestName}\r\n                  onChange={(e) => setGuestName(e.target.value)}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              {/* Kontakt */}\r\n              <div className=\"mb-4\">\r\n                <label htmlFor=\"contact\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  {t('reservations.createReservation.contact', 'Telefonnummer oder Email')} *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"contact\"\r\n                  value={contact}\r\n                  onChange={handleContactChange}\r\n                  placeholder={t('reservations.createReservation.contactPlaceholder', 'z.B. +573001234567 oder email@example.com')}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  required\r\n                />\r\n                {contactType && (\r\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                    {contactType === 'email'\r\n                      ? t('reservations.createReservation.detectedEmail', 'Email erkannt')\r\n                      : t('reservations.createReservation.detectedPhone', 'Telefonnummer erkannt')\r\n                    }\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Betrag & Whrung */}\r\n              <div className=\"grid grid-cols-2 gap-4 mb-4\">\r\n                <div>\r\n                  <label htmlFor=\"amount\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                    {t('reservations.createReservation.amount', 'Betrag')} *\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    id=\"amount\"\r\n                    value={amount}\r\n                    onChange={handleAmountChange}\r\n                    placeholder=\"0.00\"\r\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                    required\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label htmlFor=\"currency\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                    {t('reservations.createReservation.currency', 'Whrung')}\r\n                  </label>\r\n                  <select\r\n                    id=\"currency\"\r\n                    value={currency}\r\n                    onChange={(e) => setCurrency(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  >\r\n                    <option value=\"COP\">COP</option>\r\n                    <option value=\"USD\">USD</option>\r\n                    <option value=\"EUR\">EUR</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n\r\n              <p className=\"mb-4 text-sm text-gray-500 dark:text-gray-400\">\r\n                {t('reservations.createReservation.hint', 'Nach der Erstellung wird automatisch eine WhatsApp-Nachricht mit Zahlungslink versendet (wenn Telefonnummer angegeben).')}\r\n              </p>\r\n\r\n              {/* Buttons */}\r\n              <div className=\"flex justify-end space-x-3\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={onClose}\r\n                  className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                >\r\n                  {t('common.cancel', 'Abbrechen')}\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={loading}\r\n                  className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                >\r\n                  {loading\r\n                    ? t('common.creating', 'Wird erstellt...')\r\n                    : t('common.create', 'Erstellen')\r\n                  }\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n    );\r\n  }\r\n\r\n  // Fr Desktop (ab 640px) - Sidepane\r\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \r\n          aria-hidden=\"true\" \r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div \r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('reservations.createReservation.title', 'Neue Reservierung')}\r\n          </h2>\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {error && (\r\n            <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded\">\r\n              {error}\r\n            </div>\r\n          )}\r\n\r\n          <form onSubmit={handleSubmit}>\r\n            {/* Gast-Name */}\r\n            <div className=\"mb-4\">\r\n              <label htmlFor=\"guestName\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                {t('reservations.createReservation.guestName', 'Gast-Name')} *\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"guestName\"\r\n                value={guestName}\r\n                onChange={(e) => setGuestName(e.target.value)}\r\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                required\r\n              />\r\n            </div>\r\n\r\n            {/* Kontakt */}\r\n            <div className=\"mb-4\">\r\n              <label htmlFor=\"contact\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                {t('reservations.createReservation.contact', 'Telefonnummer oder Email')} *\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"contact\"\r\n                value={contact}\r\n                onChange={handleContactChange}\r\n                placeholder={t('reservations.createReservation.contactPlaceholder', 'z.B. +573001234567 oder email@example.com')}\r\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                required\r\n              />\r\n              {contactType && (\r\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                  {contactType === 'email'\r\n                    ? t('reservations.createReservation.detectedEmail', 'Email erkannt')\r\n                    : t('reservations.createReservation.detectedPhone', 'Telefonnummer erkannt')\r\n                  }\r\n                </p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Betrag & Whrung */}\r\n            <div className=\"grid grid-cols-2 gap-4 mb-4\">\r\n              <div>\r\n                <label htmlFor=\"amount\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  {t('reservations.createReservation.amount', 'Betrag')} *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"amount\"\r\n                  value={amount}\r\n                  onChange={handleAmountChange}\r\n                  placeholder=\"0.00\"\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  required\r\n                />\r\n              </div>\r\n              <div>\r\n                <label htmlFor=\"currency\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  {t('reservations.createReservation.currency', 'Whrung')}\r\n                </label>\r\n                <select\r\n                  id=\"currency\"\r\n                  value={currency}\r\n                  onChange={(e) => setCurrency(e.target.value)}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                >\r\n                  <option value=\"COP\">COP</option>\r\n                  <option value=\"USD\">USD</option>\r\n                  <option value=\"EUR\">EUR</option>\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            <p className=\"mb-4 text-sm text-gray-500 dark:text-gray-400\">\r\n              {t('reservations.createReservation.hint', 'Nach der Erstellung wird automatisch eine WhatsApp-Nachricht mit Zahlungslink versendet (wenn Telefonnummer angegeben).')}\r\n            </p>\r\n\r\n            {/* Buttons */}\r\n            <div className=\"flex justify-end space-x-3\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleClose}\r\n                className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n              >\r\n                {t('common.cancel', 'Abbrechen')}\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading}\r\n                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {loading\r\n                  ? t('common.creating', 'Wird erstellt...')\r\n                  : t('common.create', 'Erstellen')\r\n                }\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CreateReservationModal;\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourBooking, TourBookingStatus } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\n\ninterface EditTourBookingModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    booking: TourBooking | null;\n    onBookingUpdated: (updatedBooking: TourBooking) => void;\n}\n\nconst EditTourBookingModal = ({ isOpen, onClose, booking, onBookingUpdated }: EditTourBookingModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    \n    const [tourDate, setTourDate] = useState('');\n    const [numberOfParticipants, setNumberOfParticipants] = useState<number | ''>(1);\n    const [customerName, setCustomerName] = useState('');\n    const [customerEmail, setCustomerEmail] = useState('');\n    const [customerPhone, setCustomerPhone] = useState('');\n    const [customerNotes, setCustomerNotes] = useState('');\n    \n    const [selectedTour, setSelectedTour] = useState<Tour | null>(null);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Tour-Details\n    useEffect(() => {\n        const loadTour = async () => {\n            if (booking?.tourId) {\n                try {\n                    setLoadingData(true);\n                    const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(booking.tourId));\n                    if (response.data?.success) {\n                        setSelectedTour(response.data.data);\n                    }\n                } catch (err: any) {\n                    console.error('Fehler beim Laden der Tour:', err);\n                } finally {\n                    setLoadingData(false);\n                }\n            }\n        };\n        \n        if (isOpen && booking) {\n            loadTour();\n        }\n    }, [isOpen, booking]);\n\n    // Setze Form-Daten wenn Booking geladen wird\n    useEffect(() => {\n        if (booking) {\n            // Format datetime-local: YYYY-MM-DDTHH:mm\n            const tourDateObj = new Date(booking.tourDate);\n            const year = tourDateObj.getFullYear();\n            const month = String(tourDateObj.getMonth() + 1).padStart(2, '0');\n            const day = String(tourDateObj.getDate()).padStart(2, '0');\n            const hours = String(tourDateObj.getHours()).padStart(2, '0');\n            const minutes = String(tourDateObj.getMinutes()).padStart(2, '0');\n            setTourDate(`${year}-${month}-${day}T${hours}:${minutes}`);\n            \n            setNumberOfParticipants(booking.numberOfParticipants);\n            setCustomerName(booking.customerName || '');\n            setCustomerEmail(booking.customerEmail || '');\n            setCustomerPhone(booking.customerPhone || '');\n            setCustomerNotes(booking.customerNotes || '');\n        } else {\n            setTourDate('');\n            setNumberOfParticipants(1);\n            setCustomerName('');\n            setCustomerEmail('');\n            setCustomerPhone('');\n            setCustomerNotes('');\n        }\n        setError(null);\n    }, [booking, isOpen]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!booking) return;\n        setError(null);\n\n        // Validierungen\n        if (!tourDate) {\n            setError(t('tourBookings.validation.tourDateRequired', { defaultValue: 'Tour-Datum ist erforderlich' }));\n            return;\n        }\n\n        const tourDateObj = new Date(tourDate);\n        if (tourDateObj < new Date()) {\n            setError(t('tours.validation.tourDateFuture', { defaultValue: 'Tour-Datum muss in der Zukunft liegen' }));\n            return;\n        }\n\n        if (!numberOfParticipants || Number(numberOfParticipants) < 1) {\n            setError(t('tourBookings.validation.numberOfParticipantsMin', { defaultValue: 'Anzahl Teilnehmer muss >= 1 sein' }));\n            return;\n        }\n\n        if (!customerName.trim() || customerName.trim().length < 2) {\n            setError(t('tourBookings.validation.customerNameMinLength', { defaultValue: 'Kundenname muss mindestens 2 Zeichen lang sein' }));\n            return;\n        }\n\n        if (!customerPhone.trim() && !customerEmail.trim()) {\n            setError(t('tourBookings.validation.contactRequired', { defaultValue: 'Mindestens eine Kontaktinformation (Telefon oder E-Mail) ist erforderlich' }));\n            return;\n        }\n\n        // Validierung: Anzahl Teilnehmer zwischen min/max\n        if (selectedTour) {\n            const numPart = Number(numberOfParticipants);\n            if (selectedTour.minParticipants && numPart < selectedTour.minParticipants) {\n                setError(t('tours.validation.numberOfParticipantsRange', { \n                    defaultValue: 'Anzahl der Teilnehmer muss zwischen {min} und {max} sein',\n                    min: selectedTour.minParticipants,\n                    max: selectedTour.maxParticipants || ''\n                }));\n                return;\n            }\n            if (selectedTour.maxParticipants && numPart > selectedTour.maxParticipants) {\n                setError(t('tours.validation.numberOfParticipantsRange', { \n                    defaultValue: 'Anzahl der Teilnehmer muss zwischen {min} und {max} sein',\n                    min: selectedTour.minParticipants || 1,\n                    max: selectedTour.maxParticipants\n                }));\n                return;\n            }\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.put(API_ENDPOINTS.TOUR_BOOKINGS.BY_ID(booking.id), {\n                tourDate,\n                numberOfParticipants: Number(numberOfParticipants),\n                customerName: customerName.trim(),\n                customerEmail: customerEmail.trim() || null,\n                customerPhone: customerPhone.trim() || null,\n                customerNotes: customerNotes.trim() || null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tourBookings.updated', { defaultValue: 'Tour-Buchung erfolgreich aktualisiert' }),\n                    'success'\n                );\n                onBookingUpdated(response.data.data);\n                onClose();\n            } else {\n                throw new Error(response.data?.message || 'Fehler beim Aktualisieren der Buchung');\n            }\n        } catch (err: any) {\n            console.error('Fehler beim Aktualisieren der Buchung:', err);\n            const errorMessage = err.response?.data?.message || err.message || t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    if (!booking) return null;\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                    <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                            {t('tourBookings.edit', { defaultValue: 'Tour-Buchung bearbeiten' })}\n                        </Dialog.Title>\n                        <button\n                            onClick={onClose}\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                        >\n                            <XMarkIcon className=\"h-6 w-6\" />\n                        </button>\n                    </div>\n\n                    <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        {/* Tour-Info (nur Anzeige) */}\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.tour', { defaultValue: 'Tour' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={booking.tour?.title || ''}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 cursor-not-allowed\"\n                                disabled\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.tourDate', { defaultValue: 'Tour-Datum' })} *\n                            </label>\n                            <input\n                                type=\"datetime-local\"\n                                value={tourDate}\n                                onChange={(e) => setTourDate(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.numberOfParticipants', { defaultValue: 'Anzahl Teilnehmer' })} *\n                            </label>\n                            <input\n                                type=\"number\"\n                                min={selectedTour?.minParticipants || 1}\n                                max={selectedTour?.maxParticipants || undefined}\n                                value={numberOfParticipants}\n                                onChange={(e) => setNumberOfParticipants(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerName', { defaultValue: 'Kundenname' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={customerName}\n                                onChange={(e) => setCustomerName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerPhone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={customerPhone}\n                                onChange={(e) => setCustomerPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerEmail', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={customerEmail}\n                                onChange={(e) => setCustomerEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerNotes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={customerNotes}\n                                onChange={(e) => setCustomerNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={onClose}\n                                className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\n                            >\n                                {t('common.cancel', 'Abbrechen')}\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                            >\n                                {loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            </button>\n                        </div>\n                    </form>\n                </Dialog.Panel>\n            </div>\n        </Dialog>\n    );\n};\n\nexport default EditTourBookingModal;\n\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, LinkIcon } from '@heroicons/react/24/outline';\r\nimport axiosInstance from '../../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport useMessage from '../../hooks/useMessage.ts';\r\nimport { TourBooking, TourReservation } from '../../types/tour.ts';\r\n\r\ninterface TourReservationLinkModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    booking: TourBooking | null;\r\n    onLinked: () => void;\r\n}\r\n\r\nconst TourReservationLinkModal = ({ isOpen, onClose, booking, onLinked }: TourReservationLinkModalProps) => {\r\n    const { t } = useTranslation();\r\n    const { showMessage } = useMessage();\r\n    \r\n    const [reservations, setReservations] = useState<any[]>([]);\r\n    const [selectedReservationId, setSelectedReservationId] = useState<number | ''>('');\r\n    const [tourPrice, setTourPrice] = useState<number | ''>('');\r\n    const [accommodationPrice, setAccommodationPrice] = useState<number | ''>('');\r\n    const [loading, setLoading] = useState(false);\r\n    const [loadingReservations, setLoadingReservations] = useState(false);\r\n    const [existingLinks, setExistingLinks] = useState<TourReservation[]>([]);\r\n\r\n    useEffect(() => {\r\n        if (isOpen && booking) {\r\n            loadReservations();\r\n            loadExistingLinks();\r\n            // Setze Tour-Preis als Standard\r\n            if (booking.totalPrice) {\r\n                setTourPrice(typeof booking.totalPrice === 'string' ? parseFloat(booking.totalPrice) : booking.totalPrice);\r\n            }\r\n        }\r\n    }, [isOpen, booking]);\r\n\r\n    const loadReservations = async () => {\r\n        try {\r\n            setLoadingReservations(true);\r\n            const response = await axiosInstance.get(API_ENDPOINTS.RESERVATION.BASE);\r\n            if (response.data.success || Array.isArray(response.data)) {\r\n                const data = response.data.success ? response.data.data : response.data;\r\n                setReservations(Array.isArray(data) ? data : []);\r\n            }\r\n        } catch (err: any) {\r\n            console.error('Fehler beim Laden der Reservations:', err);\r\n            showMessage(t('errors.loadError'), 'error');\r\n        } finally {\r\n            setLoadingReservations(false);\r\n        }\r\n    };\r\n\r\n    const loadExistingLinks = async () => {\r\n        if (!booking) return;\r\n        try {\r\n            const response = await axiosInstance.get(API_ENDPOINTS.TOUR_RESERVATIONS.BY_BOOKING(booking.id));\r\n            if (response.data.success) {\r\n                setExistingLinks(response.data.data || []);\r\n            }\r\n        } catch (err: any) {\r\n            console.error('Fehler beim Laden der Verknpfungen:', err);\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!booking || !selectedReservationId || !tourPrice || !accommodationPrice) {\r\n            showMessage(t('tours.reservationLink.fillAllFields', 'Bitte fllen Sie alle Felder aus'), 'error');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        try {\r\n            const response = await axiosInstance.post(API_ENDPOINTS.TOUR_RESERVATIONS.BASE, {\r\n                tourId: booking.tourId,\r\n                bookingId: booking.id,\r\n                reservationId: selectedReservationId,\r\n                tourPrice: Number(tourPrice),\r\n                accommodationPrice: Number(accommodationPrice),\r\n                currency: booking.currency || 'COP'\r\n            });\r\n\r\n            if (response.data.success) {\r\n                showMessage(t('tours.reservationLink.success', 'Verknpfung erfolgreich erstellt'), 'success');\r\n                onLinked();\r\n                onClose();\r\n            } else {\r\n                showMessage(response.data.message || t('errors.saveError'), 'error');\r\n            }\r\n        } catch (err: any) {\r\n            console.error('Fehler beim Erstellen der Verknpfung:', err);\r\n            showMessage(err.response?.data?.message || t('errors.saveError'), 'error');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleDeleteLink = async (linkId: number) => {\r\n        if (!window.confirm(t('tours.reservationLink.confirmDelete', 'Mchten Sie diese Verknpfung wirklich lschen?'))) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const response = await axiosInstance.delete(API_ENDPOINTS.TOUR_RESERVATIONS.BY_ID(linkId));\r\n            if (response.data.success) {\r\n                showMessage(t('tours.reservationLink.deleted', 'Verknpfung gelscht'), 'success');\r\n                loadExistingLinks();\r\n                onLinked();\r\n            } else {\r\n                showMessage(response.data.message || t('errors.deleteError'), 'error');\r\n            }\r\n        } catch (err: any) {\r\n            console.error('Fehler beim Lschen der Verknpfung:', err);\r\n            showMessage(err.response?.data?.message || t('errors.deleteError'), 'error');\r\n        }\r\n    };\r\n\r\n    if (!isOpen || !booking) return null;\r\n\r\n    const selectedReservation = reservations.find(r => r.id === Number(selectedReservationId));\r\n    const reservationAmount = selectedReservation?.amount ? Number(selectedReservation.amount) : 0;\r\n    const totalPrice = (Number(tourPrice) || 0) + (Number(accommodationPrice) || 0);\r\n    const isValid = totalPrice <= reservationAmount && totalPrice > 0;\r\n\r\n    return (\r\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n                <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\r\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white flex items-center gap-2\">\r\n                            <LinkIcon className=\"h-6 w-6\" />\r\n                            {t('tours.reservationLink.title', 'Tour mit Reservation verknpfen')}\r\n                        </Dialog.Title>\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n                        >\r\n                            <XMarkIcon className=\"h-6 w-6\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                {t('tours.reservationLink.reservation', 'Reservation')} *\r\n                            </label>\r\n                            <select\r\n                                value={selectedReservationId}\r\n                                onChange={(e) => {\r\n                                    setSelectedReservationId(e.target.value ? Number(e.target.value) : '');\r\n                                    const res = reservations.find(r => r.id === Number(e.target.value));\r\n                                    if (res?.amount) {\r\n                                        const resAmount = Number(res.amount);\r\n                                        const currentTourPrice = Number(tourPrice) || 0;\r\n                                        setAccommodationPrice(resAmount - currentTourPrice);\r\n                                    }\r\n                                }}\r\n                                required\r\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                disabled={loadingReservations}\r\n                            >\r\n                                <option value=\"\">{t('common.select', 'Auswhlen')}</option>\r\n                                {reservations.map(reservation => (\r\n                                    <option key={reservation.id} value={reservation.id}>\r\n                                        {reservation.guestName} - {reservation.checkInDate} bis {reservation.checkOutDate} ({Number(reservation.amount || 0).toLocaleString()} {reservation.currency || 'COP'})\r\n                                    </option>\r\n                                ))}\r\n                            </select>\r\n                            {selectedReservation && (\r\n                                <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">\r\n                                    {t('tours.reservationLink.reservationAmount', 'Reservationsbetrag')}: {reservationAmount.toLocaleString()} {selectedReservation.currency || 'COP'}\r\n                                </p>\r\n                            )}\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.reservationLink.tourPrice', 'Tour-Preis')} *\r\n                                </label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={tourPrice}\r\n                                    onChange={(e) => setTourPrice(e.target.value ? Number(e.target.value) : '')}\r\n                                    min=\"0\"\r\n                                    step=\"0.01\"\r\n                                    required\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.reservationLink.accommodationPrice', 'Betten-Preis')} *\r\n                                </label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={accommodationPrice}\r\n                                    onChange={(e) => setAccommodationPrice(e.target.value ? Number(e.target.value) : '')}\r\n                                    min=\"0\"\r\n                                    step=\"0.01\"\r\n                                    required\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {selectedReservation && (\r\n                            <div className={`p-3 rounded-md ${isValid ? 'bg-green-50 dark:bg-green-900/30' : 'bg-red-50 dark:bg-red-900/30'}`}>\r\n                                <p className={`text-sm ${isValid ? 'text-green-800 dark:text-green-200' : 'text-red-800 dark:text-red-200'}`}>\r\n                                    {t('tours.reservationLink.totalPrice', 'Gesamtpreis')}: {totalPrice.toLocaleString()} {booking.currency || 'COP'}\r\n                                    {!isValid && totalPrice > reservationAmount && (\r\n                                        <span className=\"block mt-1\">\r\n                                            {t('tours.reservationLink.exceedsAmount', 'berschreitet Reservationsbetrag')}\r\n                                        </span>\r\n                                    )}\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Bestehende Verknpfungen */}\r\n                        {existingLinks.length > 0 && (\r\n                            <div>\r\n                                <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                    {t('tours.reservationLink.existingLinks', 'Bestehende Verknpfungen')}\r\n                                </h3>\r\n                                <div className=\"space-y-2\">\r\n                                    {existingLinks.map(link => (\r\n                                        <div key={link.id} className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-md\">\r\n                                            <div>\r\n                                                <p className=\"text-sm font-medium dark:text-white\">\r\n                                                    {link.reservation?.guestName || `Reservation #${link.reservationId}`}\r\n                                                </p>\r\n                                                <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                                                    Tour: {Number(link.tourPrice || 0).toLocaleString()} {link.currency} | \r\n                                                    Betten: {Number(link.accommodationPrice || 0).toLocaleString()} {link.currency}\r\n                                                </p>\r\n                                            </div>\r\n                                            <button\r\n                                                type=\"button\"\r\n                                                onClick={() => handleDeleteLink(link.id)}\r\n                                                className=\"px-3 py-1 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-md\"\r\n                                            >\r\n                                                {t('common.delete', 'Lschen')}\r\n                                            </button>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={onClose}\r\n                                className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n                            >\r\n                                {t('common.cancel', 'Abbrechen')}\r\n                            </button>\r\n                            <button\r\n                                type=\"submit\"\r\n                                disabled={loading || !isValid || !selectedReservationId}\r\n                                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                            >\r\n                                {loading ? t('common.saving', 'Wird gespeichert...') : t('common.save', 'Speichern')}\r\n                            </button>\r\n                        </div>\r\n                    </form>\r\n                </Dialog.Panel>\r\n            </div>\r\n        </Dialog>\r\n    );\r\n};\r\n\r\nexport default TourReservationLinkModal;\r\n\r\n","/**\r\n * Country Language Service (Frontend)\r\n * \r\n * Mappt Lnder zu Sprachen fr Template-Auswahl basierend auf Reservation.guestNationality\r\n * \r\n * Wiederverwendet die Logik aus backend/src/services/countryLanguageService.ts\r\n */\r\nexport class CountryLanguageService {\r\n  /**\r\n   * Mapping: Land-Name (verschiedene Schreibweisen) -> Sprachcode\r\n   * \r\n   * Untersttzt:\r\n   * - Spanische Namen (z.B. \"Francia\", \"Colombia\")\r\n   * - Englische Namen (z.B. \"France\", \"Colombia\")\r\n   * - Deutsche Namen (z.B. \"Frankreich\", \"Kolumbien\")\r\n   */\r\n  private static readonly COUNTRY_LANGUAGE_MAP: Record<string, string> = {\r\n    // Spanisch-sprachige Lnder\r\n    'colombia': 'es',\r\n    'colombie': 'es',\r\n    'mexico': 'es',\r\n    'mxico': 'es',\r\n    'argentina': 'es',\r\n    'spain': 'es',\r\n    'espaa': 'es',\r\n    'espana': 'es',\r\n    'chile': 'es',\r\n    'peru': 'es',\r\n    'per': 'es',\r\n    'venezuela': 'es',\r\n    'ecuador': 'es',\r\n    'bolivia': 'es',\r\n    'paraguay': 'es',\r\n    'uruguay': 'es',\r\n    'costa rica': 'es',\r\n    'panama': 'es',\r\n    'panam': 'es',\r\n    'nicaragua': 'es',\r\n    'honduras': 'es',\r\n    'guatemala': 'es',\r\n    'el salvador': 'es',\r\n    'republica dominicana': 'es',\r\n    'repblica dominicana': 'es',\r\n    'cuba': 'es',\r\n    'puerto rico': 'es',\r\n    \r\n    // Englisch-sprachige Lnder\r\n    'united states': 'en',\r\n    'usa': 'en',\r\n    'united kingdom': 'en',\r\n    'uk': 'en',\r\n    'canada': 'en',\r\n    'australia': 'en',\r\n    'new zealand': 'en',\r\n    'south africa': 'en',\r\n    'ireland': 'en',\r\n    'singapore': 'en',\r\n    'philippines': 'en',\r\n    'filipinas': 'en',\r\n    \r\n    // Deutsch-sprachige Lnder  Englisch (keine deutschen Templates)\r\n    'germany': 'en',\r\n    'alemania': 'en',\r\n    'deutschland': 'en',\r\n    'switzerland': 'es', // Schweiz: Spanisch (da hauptschlich spanisch-sprachige Gste)\r\n    'suiza': 'es',\r\n    'schweiz': 'es',\r\n    'austria': 'en',\r\n    'sterreich': 'en',\r\n    \r\n    // Franzsisch-sprachige Lnder\r\n    'france': 'en', // Frankreich: Englisch als Fallback (keine franzsischen Templates)\r\n    'francia': 'en',\r\n    'frankreich': 'en',\r\n    'belgium': 'en',\r\n    'blgica': 'en',\r\n    'belgien': 'en',\r\n    'belgique': 'en',\r\n    \r\n    // Italienisch-sprachige Lnder\r\n    'italy': 'en', // Italien: Englisch als Fallback\r\n    'italia': 'en',\r\n    'italien': 'en',\r\n    \r\n    // Portugiesisch-sprachige Lnder\r\n    'brazil': 'en', // Brasilien: Englisch als Fallback (keine portugiesischen Templates)\r\n    'brasil': 'en',\r\n    'brasilien': 'en',\r\n    'portugal': 'en',\r\n    \r\n    // Weitere Lnder (Fallback auf Englisch)\r\n    'netherlands': 'en',\r\n    'holanda': 'en',\r\n    'niederlande': 'en',\r\n    'poland': 'en',\r\n    'polonia': 'en',\r\n    'polen': 'en',\r\n    'russia': 'en',\r\n    'rusia': 'en',\r\n    'russland': 'en',\r\n    'china': 'en',\r\n    'japan': 'en',\r\n    'japn': 'en',\r\n    'korea': 'en',\r\n    'corea': 'en',\r\n    'india': 'en',\r\n    'turkey': 'en',\r\n    'turqua': 'en',\r\n    'trkei': 'en',\r\n    'egypt': 'en',\r\n    'egipto': 'en',\r\n    'gypten': 'en',\r\n    'bielorrusia': 'en', // Belarus: Englisch als Fallback\r\n    'belarus': 'en',\r\n  };\r\n\r\n  /**\r\n   * Bestimmt Sprachcode basierend auf Land-Name\r\n   * \r\n   * Regel: Alle spanischsprachigen Lnder  'es', alle anderen  'en'\r\n   * \r\n   * @param countryName - Land-Name (z.B. \"Francia\", \"Colombia\", \"Germany\")\r\n   * @returns Sprachcode ('es' fr spanischsprachige Lnder, 'en' fr alle anderen) oder 'es' als Fallback\r\n   */\r\n  static getLanguageForCountry(countryName: string | null | undefined): string {\r\n    if (!countryName) {\r\n      return 'es'; // Fallback: Spanisch (Standard fr Kolumbien)\r\n    }\r\n\r\n    // Normalisiere: Kleinschreibung, entferne Leerzeichen\r\n    const normalized = countryName\r\n      .toLowerCase()\r\n      .trim()\r\n      .replace(/\\s+/g, ' ');\r\n\r\n    // Direktes Mapping\r\n    if (this.COUNTRY_LANGUAGE_MAP[normalized]) {\r\n      return this.COUNTRY_LANGUAGE_MAP[normalized];\r\n    }\r\n\r\n    // Fallback: Prfe ob Teilstring matcht (z.B. \"United States\" -> \"united states\")\r\n    for (const [country, language] of Object.entries(this.COUNTRY_LANGUAGE_MAP)) {\r\n      if (normalized.includes(country) || country.includes(normalized)) {\r\n        return language;\r\n      }\r\n    }\r\n\r\n    // Fallback: Spanisch (Standard fr Kolumbien)\r\n    return 'es';\r\n  }\r\n\r\n  /**\r\n   * Bestimmt Sprachcode fr Reservation basierend auf guestNationality\r\n   * \r\n   * Prioritt:\r\n   * 1. reservation.guestNationality (wenn vorhanden)\r\n   * 2. Fallback: 'es' (Spanisch)\r\n   * \r\n   * Regel: Alle spanischsprachigen Lnder  'es', alle anderen  'en'\r\n   * \r\n   * @param reservation - Reservation mit guestNationality\r\n   * @returns Sprachcode ('es' fr spanischsprachige Lnder, 'en' fr alle anderen)\r\n   */\r\n  static getLanguageForReservation(reservation: {\r\n    guestNationality?: string | null;\r\n  }): string {\r\n    // Prioritt 1: Land-basierte Erkennung\r\n    if (reservation.guestNationality) {\r\n      const language = this.getLanguageForCountry(reservation.guestNationality);\r\n      return language;\r\n    }\r\n\r\n    // Fallback: Spanisch\r\n    return 'es';\r\n  }\r\n}\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { XMarkIcon } from '@heroicons/react/24/outline';\nimport { reservationService } from '../../services/reservationService.ts';\nimport { Reservation } from '../../types/reservation.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\nimport { CountryLanguageService } from '../../services/countryLanguageService.ts';\n\ninterface SendInvitationSidepaneProps {\n  isOpen: boolean;\n  onClose: () => void;\n  reservation: Reservation;\n  onSuccess: () => void;\n}\n\nconst SendInvitationSidepane: React.FC<SendInvitationSidepaneProps> = ({\n  isOpen,\n  onClose,\n  reservation,\n  onSuccess\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n\n  // Formular-Felder\n  const [guestPhone, setGuestPhone] = useState(reservation.guestPhone || '');\n  const [guestEmail, setGuestEmail] = useState(reservation.guestEmail || '');\n  const [customMessage, setCustomMessage] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [previewMessage, setPreviewMessage] = useState('');\n\n  // Standard-Nachricht generieren (entspricht Meta Business Template: reservation_checkin_invitation)\n  // Sprache basierend auf reservation.guestNationality bestimmen\n  const generateStandardMessage = () => {\n    const languageCode = CountryLanguageService.getLanguageForReservation({\n      guestNationality: reservation.guestNationality\n    });\n\n    if (languageCode === 'en') {\n      // Englische Version (wie im Backend E-Mail-Service)\n      return `Hello {{guestName}},\n\nWe are pleased to welcome you to La Familia Hostel! \n\nIn case that you arrive after 18:00 or before 09:00, our recepcion  will be closed.\n\nWe would then kindly ask you to complete check-in & payment online in advance:\n\nCheck-In:\n\n{{checkInLink}}\n\nPlease make the payment in advance:\n\n{{paymentLink}}\n\nPlease write us briefly once you have completed both the check-in and the payment, so we can send you your pin code  for the entrance door.\n\nThank you!\n\nWe look forward to seeing you soon!`;\n    }\n\n    // Spanische Version (korrigiert, wie im Backend E-Mail-Service)\n    return `Hola {{guestName}},\n\nNos complace darte la bienvenida a La Familia Hostel! \n\nEn caso de que llegues despus de las 18:00 o antes de las 09:00, nuestra recepcin  estar cerrada.\n\nTe pedimos amablemente que completes el check-in y el pago en lnea con anticipacin:\n\nCheck-In:\n\n{{checkInLink}}\n\nPor favor, realiza el pago por adelantado:\n\n{{paymentLink}}\n\nPor favor, escrbenos brevemente una vez que hayas completado tanto el check-in como el pago, para que podamos enviarte tu cdigo PIN  para la puerta de entrada.\n\nGracias!\n\nEsperamos verte pronto!`;\n  };\n\n  // Initialisiere Standard-Nachricht beim ffnen\n  useEffect(() => {\n    if (isOpen && !customMessage) {\n      setCustomMessage(generateStandardMessage());\n    }\n  }, [isOpen, reservation]);\n\n  // Preview-Nachricht generieren (mit echten Links)\n  useEffect(() => {\n    if (customMessage) {\n      // Generiere LobbyPMS Check-in-Link (analog zu Backend generateLobbyPmsCheckInLink)\n      // Format: https://app.lobbypms.com/checkinonline/confirmar?codigo={lobbyReservationId}&email={email}&lg={language}\n      // WICHTIG: Check-in-Link IMMER mit der ursprnglich importierten E-Mail generieren\n      // (reservation.guestEmail), nicht mit der genderten E-Mail (guestEmail)\n      // Der Check-in-Link muss immer die Original-E-Mail verwenden, die beim Import verwendet wurde\n      // WICHTIG: Verwende lobbyReservationId (LobbyPMS booking_id) als codigo, nicht die interne ID\n      // Sprache basierend auf reservation.guestNationality bestimmen\n      const languageCode = CountryLanguageService.getLanguageForReservation({\n        guestNationality: reservation.guestNationality\n      });\n      const email = reservation.guestEmail || '';\n      let checkInLink = '[Check-in-Link wird generiert]';\n      if (email) {\n        // Verwende lobbyReservationId (LobbyPMS booking_id) als codigo, Fallback auf id wenn nicht vorhanden\n        const codigo = reservation.lobbyReservationId || reservation.id.toString();\n        const baseUrl = 'https://app.lobbypms.com/checkinonline/confirmar';\n        const params = new URLSearchParams();\n        params.append('codigo', codigo);\n        params.append('email', email);\n        // Sprache fr Check-in-Link: 'GB' fr Englisch, 'ES' fr Spanisch\n        params.append('lg', languageCode === 'en' ? 'GB' : 'ES');\n        checkInLink = `${baseUrl}?${params.toString()}`;\n      }\n      \n      // Verwende bestehenden Payment-Link oder Fallback\n      const paymentLink = reservation.paymentLink || '[Zahlungslink wird erstellt]';\n      \n      let preview = customMessage\n        .replace(/\\{\\{guestName\\}\\}/g, reservation.guestName)\n        .replace(/\\{\\{checkInLink\\}\\}/g, checkInLink)\n        .replace(/\\{\\{paymentLink\\}\\}/g, paymentLink);\n      setPreviewMessage(preview);\n    }\n  }, [customMessage, reservation.guestName, reservation.paymentLink, reservation.id, reservation.guestEmail, reservation.guestNationality]);\n\n  // Responsive-Verhalten\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n\n    window.addEventListener('resize', handleResize);\n    handleResize();\n\n    return () => {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen && !isMobile) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n\n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, isMobile, openSidepane, closeSidepane]);\n\n  // Reset form when sidepane closes\n  useEffect(() => {\n    if (!isOpen) {\n      setGuestPhone(reservation.guestPhone || '');\n      setGuestEmail(reservation.guestEmail || '');\n      setCustomMessage('');\n      setError(null);\n      setPreviewMessage('');\n    }\n  }, [isOpen, reservation]);\n\n  const handleClose = () => {\n    setError(null);\n    onClose();\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n\n    // Validierung: Mindestens eine Kontaktinfo muss vorhanden sein\n    if (!guestPhone && !guestEmail) {\n      setError(t('reservations.sendInvitation.noContact', 'Bitte geben Sie mindestens eine Telefonnummer oder E-Mail-Adresse an.'));\n      return;\n    }\n\n    try {\n      setLoading(true);\n\n      await reservationService.sendInvitation(reservation.id, {\n        guestPhone: guestPhone || undefined,\n        guestEmail: guestEmail || undefined,\n        customMessage: customMessage || undefined\n      });\n\n      showMessage(\n        t('reservations.sendInvitation.success', 'Einladung erfolgreich versendet'),\n        'success'\n      );\n      onSuccess();\n      handleClose();\n    } catch (err: any) {\n      console.error('Fehler beim Versenden der Einladung:', err);\n      const errorMessage = err.response?.data?.message || \n        t('reservations.sendInvitation.error', 'Fehler beim Versenden der Einladung');\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Warnung anzeigen, wenn bereits versendet wurde\n  const alreadySent = reservation.sentMessageAt;\n\n  // Fr Mobile (< 640px) - Dialog (Modal)\n  if (isMobile) {\n    return (\n      <div\n        className={`fixed inset-0 z-50 overflow-y-auto ${isOpen ? '' : 'hidden'}`}\n        aria-labelledby=\"modal-title\"\n        role=\"dialog\"\n        aria-modal=\"true\"\n      >\n        <div className=\"flex min-h-screen items-end justify-center p-4 text-center sm:items-center sm:p-0\">\n          <div\n            className=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\"\n            onClick={handleClose}\n          />\n\n          <div className=\"relative transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <h2 className=\"text-lg font-semibold dark:text-white\">\n                {t('reservations.sendInvitation.title', 'Einladung senden')}\n              </h2>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <div className=\"p-4 overflow-y-auto max-h-[calc(100vh-200px)]\">\n              {renderForm()}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('reservations.sendInvitation.title', 'Einladung senden')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {renderForm()}\n        </div>\n      </div>\n    </>\n  );\n\n  function renderForm() {\n    return (\n      <>\n        {error && (\n          <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded\">\n            {error}\n          </div>\n        )}\n\n        {alreadySent && (\n          <div className=\"mb-4 p-3 bg-yellow-100 dark:bg-yellow-900 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-200 rounded\">\n            <p className=\"text-sm\">\n              {t('reservations.sendInvitation.alreadySent', 'Bereits versendet am')}: {new Date(reservation.sentMessageAt!).toLocaleString()}\n            </p>\n            <p className=\"text-xs mt-1\">\n              {t('reservations.sendInvitation.canResend', 'Sie knnen die Einladung erneut senden.')}\n            </p>\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {/* Kontaktinfo */}\n          <div>\n            <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\n              {t('reservations.sendInvitation.contactInfo', 'Kontaktinformationen')}\n            </h3>\n\n            <div className=\"space-y-3\">\n              {/* Telefonnummer */}\n              <div>\n                <label htmlFor=\"guestPhone\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('reservations.phone', 'Telefonnummer')}\n                </label>\n                <input\n                  type=\"tel\"\n                  id=\"guestPhone\"\n                  value={guestPhone}\n                  onChange={(e) => setGuestPhone(e.target.value)}\n                  placeholder=\"+573001234567\"\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                />\n              </div>\n\n              {/* E-Mail */}\n              <div>\n                <label htmlFor=\"guestEmail\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('reservations.email', 'E-Mail')}\n                </label>\n                <input\n                  type=\"email\"\n                  id=\"guestEmail\"\n                  value={guestEmail}\n                  onChange={(e) => setGuestEmail(e.target.value)}\n                  placeholder=\"email@example.com\"\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Nachricht */}\n          <div>\n            <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\n              {t('reservations.sendInvitation.message', 'Nachricht')}\n            </h3>\n\n            <div className=\"space-y-3\">\n              {/* Textarea fr Nachricht */}\n              <div>\n                <label htmlFor=\"customMessage\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('reservations.sendInvitation.messageLabel', 'Nachricht (editierbar)')}\n                </label>\n                <textarea\n                  id=\"customMessage\"\n                  value={customMessage}\n                  onChange={(e) => setCustomMessage(e.target.value)}\n                  rows={10}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white font-mono text-xs\"\n                  placeholder={generateStandardMessage()}\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('reservations.sendInvitation.messageVariables', 'Verfgbare Variablen: {{guestName}}, {{checkInLink}}, {{paymentLink}}')}\n                </p>\n              </div>\n\n              {/* Preview */}\n              {previewMessage && (\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('reservations.sendInvitation.preview', 'Vorschau')}\n                  </label>\n                  <div className=\"p-3 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-md text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                    {previewMessage}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Buttons */}\n          <div className=\"flex justify-end space-x-3 pt-4 border-t dark:border-gray-700\">\n            <button\n              type=\"button\"\n              onClick={handleClose}\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              {t('common.cancel', 'Abbrechen')}\n            </button>\n            <button\n              type=\"submit\"\n              disabled={loading || (!guestPhone && !guestEmail)}\n              className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading\n                ? t('reservations.sendInvitation.sending', 'Wird gesendet...')\n                : t('reservations.sendInvitation.send', 'Senden')\n              }\n            </button>\n          </div>\n        </form>\n      </>\n    );\n  }\n};\n\nexport default SendInvitationSidepane;\n\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { XMarkIcon } from '@heroicons/react/24/outline';\r\nimport { reservationService } from '../../services/reservationService.ts';\r\nimport { Reservation } from '../../types/reservation.ts';\r\nimport useMessage from '../../hooks/useMessage.ts';\r\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\r\nimport { CountryLanguageService } from '../../services/countryLanguageService.ts';\r\n\r\ninterface SendPasscodeSidepaneProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  reservation: Reservation;\r\n  onSuccess: () => void;\r\n}\r\n\r\nconst SendPasscodeSidepane: React.FC<SendPasscodeSidepaneProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  reservation,\r\n  onSuccess\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { showMessage } = useMessage();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n\r\n  // Formular-Felder\r\n  const [guestPhone, setGuestPhone] = useState(reservation.guestPhone || '');\r\n  const [guestEmail, setGuestEmail] = useState(reservation.guestEmail || '');\r\n  const [customMessage, setCustomMessage] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [previewMessage, setPreviewMessage] = useState('');\r\n\r\n  // Standard-Nachricht generieren (entspricht Meta Business Template: reservation_checkin_completed)\r\n  // Template verwendet 2 Variablen: {{1}} = Begrung, {{2}} = Kompletter Text mit Zimmerinfo und PIN\r\n  // Fr die Vorschau kombinieren wir beide zu einem vollstndigen Text\r\n  // Sprache basierend auf reservation.guestNationality bestimmen\r\n  const generateStandardMessage = () => {\r\n    const languageCode = CountryLanguageService.getLanguageForReservation({\r\n      guestNationality: reservation.guestNationality\r\n    });\r\n\r\n    // Template-Format: {{1}} = Begrung, {{2}} = Kompletter Text\r\n    // Fr Vorschau im Sidepane verwenden wir Platzhalter, die dann ersetzt werden\r\n    if (languageCode === 'en') {\r\n      // Englische Version\r\n      return `Welcome,\r\n\r\nHello {{guestName}},\r\n\r\nYour check-in has been completed successfully!\r\n\r\nYour room information:\r\n- Room: {{roomNumber}}\r\n- Description: {{roomDescription}}\r\n\r\nAccess:\r\n- Door PIN: {{passcode}}\r\n- App: {{doorAppName}}\r\n\r\nWe wish you a pleasant stay!`;\r\n    }\r\n\r\n    // Spanische Version\r\n    return `Bienvenido,\r\n\r\nHola {{guestName}},\r\n\r\nTu check-in se ha completado exitosamente!\r\n\r\nInformacin de tu habitacin:\r\n- Habitacin: {{roomNumber}}\r\n- Descripcin: {{roomDescription}}\r\n\r\nAcceso:\r\n- PIN de la puerta: {{passcode}}\r\n- App: {{doorAppName}}\r\n\r\nTe deseamos una estancia agradable!`;\r\n  };\r\n\r\n  // Initialisiere Standard-Nachricht beim ffnen\r\n  useEffect(() => {\r\n    if (isOpen && !customMessage) {\r\n      setCustomMessage(generateStandardMessage());\r\n    }\r\n  }, [isOpen, reservation]);\r\n\r\n  // Preview-Nachricht generieren (mit Passcode-Platzhalter)\r\n  useEffect(() => {\r\n    if (customMessage) {\r\n      // Verwende bestehenden Passcode oder Platzhalter\r\n      const passcode = reservation.doorPin || reservation.ttlLockPassword || '[Passcode wird generiert]';\r\n      const roomNumber = reservation.roomNumber || '[Zimmernummer]';\r\n      const roomDescription = reservation.roomDescription || '[Zimmerbeschreibung]';\r\n      const doorAppName = reservation.doorAppName || 'TTLock';\r\n      \r\n      // Ersetze Variablen in der Nachricht\r\n      // Untersttzt sowohl Template-Format ({{1}}, {{2}}) als auch einzelne Variablen ({{guestName}}, etc.)\r\n      let preview = customMessage\r\n        .replace(/\\{\\{guestName\\}\\}/g, reservation.guestName)\r\n        .replace(/\\{\\{passcode\\}\\}/g, passcode)\r\n        .replace(/\\{\\{roomNumber\\}\\}/g, roomNumber)\r\n        .replace(/\\{\\{roomDescription\\}\\}/g, roomDescription)\r\n        .replace(/\\{\\{doorAppName\\}\\}/g, doorAppName);\r\n      setPreviewMessage(preview);\r\n    }\r\n  }, [customMessage, reservation.guestName, reservation.doorPin, reservation.ttlLockPassword, reservation.roomNumber, reservation.roomDescription, reservation.doorAppName, reservation.guestNationality]);\r\n\r\n  // Responsive-Verhalten\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    handleResize();\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n    };\r\n  }, []);\r\n\r\n  // Sidepane-Status verwalten\r\n  useEffect(() => {\r\n    if (isOpen && !isMobile) {\r\n      openSidepane();\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n\r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, isMobile, openSidepane, closeSidepane]);\r\n\r\n  // Reset form when sidepane closes\r\n  useEffect(() => {\r\n    if (!isOpen) {\r\n      setGuestPhone(reservation.guestPhone || '');\r\n      setGuestEmail(reservation.guestEmail || '');\r\n      setCustomMessage('');\r\n      setError(null);\r\n      setPreviewMessage('');\r\n    }\r\n  }, [isOpen, reservation]);\r\n\r\n  const handleClose = () => {\r\n    setError(null);\r\n    onClose();\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n\r\n    // Validierung: Mindestens eine Kontaktinfo muss vorhanden sein\r\n    if (!guestPhone && !guestEmail) {\r\n      setError(t('reservations.sendPasscode.noContact', 'Bitte geben Sie mindestens eine Telefonnummer oder E-Mail-Adresse an.'));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      await reservationService.sendPasscode(reservation.id, {\r\n        guestPhone: guestPhone || undefined,\r\n        guestEmail: guestEmail || undefined,\r\n        customMessage: customMessage || undefined\r\n      });\r\n\r\n      showMessage(\r\n        t('reservations.sendPasscode.success', 'Passcode erfolgreich versendet'),\r\n        'success'\r\n      );\r\n      onSuccess();\r\n      handleClose();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Versenden des Passcodes:', err);\r\n      const errorMessage = err.response?.data?.message || \r\n        t('reservations.sendPasscode.error', 'Fehler beim Versenden des Passcodes');\r\n      setError(errorMessage);\r\n      showMessage(errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Fr Mobile (< 640px) - Dialog (Modal)\r\n  if (isMobile) {\r\n    return (\r\n      <div\r\n        className={`fixed inset-0 z-50 overflow-y-auto ${isOpen ? '' : 'hidden'}`}\r\n        aria-labelledby=\"modal-title\"\r\n        role=\"dialog\"\r\n        aria-modal=\"true\"\r\n      >\r\n        <div className=\"flex min-h-screen items-end justify-center p-4 text-center sm:items-center sm:p-0\">\r\n          <div\r\n            className=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\"\r\n            onClick={handleClose}\r\n          />\r\n\r\n          <div className=\"relative transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg\">\r\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\r\n              <h2 className=\"text-lg font-semibold dark:text-white\">\r\n                {t('reservations.sendPasscode.title', 'Passcode senden')}\r\n              </h2>\r\n              <button\r\n                onClick={handleClose}\r\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n              >\r\n                <XMarkIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"p-4 overflow-y-auto max-h-[calc(100vh-200px)]\">\r\n              {renderForm()}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Fr Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \r\n          aria-hidden=\"true\" \r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div \r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('reservations.sendPasscode.title', 'Passcode senden')}\r\n          </h2>\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {renderForm()}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n\r\n  function renderForm() {\r\n    return (\r\n      <>\r\n        {error && (\r\n          <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded\">\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n          {/* Kontaktinfo */}\r\n          <div>\r\n            <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\r\n              {t('reservations.sendPasscode.contactInfo', 'Kontaktinformationen')}\r\n            </h3>\r\n\r\n            <div className=\"space-y-3\">\r\n              {/* Telefonnummer */}\r\n              <div>\r\n                <label htmlFor=\"guestPhone\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                  {t('reservations.phone', 'Telefonnummer')}\r\n                </label>\r\n                <input\r\n                  type=\"tel\"\r\n                  id=\"guestPhone\"\r\n                  value={guestPhone}\r\n                  onChange={(e) => setGuestPhone(e.target.value)}\r\n                  placeholder=\"+573001234567\"\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                />\r\n              </div>\r\n\r\n              {/* E-Mail */}\r\n              <div>\r\n                <label htmlFor=\"guestEmail\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                  {t('reservations.email', 'E-Mail')}\r\n                </label>\r\n                <input\r\n                  type=\"email\"\r\n                  id=\"guestEmail\"\r\n                  value={guestEmail}\r\n                  onChange={(e) => setGuestEmail(e.target.value)}\r\n                  placeholder=\"email@example.com\"\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Nachricht */}\r\n          <div>\r\n            <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\r\n              {t('reservations.sendPasscode.message', 'Nachricht')}\r\n            </h3>\r\n\r\n            <div className=\"space-y-3\">\r\n              {/* Textarea fr Nachricht */}\r\n              <div>\r\n                <label htmlFor=\"customMessage\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                  {t('reservations.sendPasscode.messageLabel', 'Nachricht (editierbar)')}\r\n                </label>\r\n                <textarea\r\n                  id=\"customMessage\"\r\n                  value={customMessage}\r\n                  onChange={(e) => setCustomMessage(e.target.value)}\r\n                  rows={8}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white font-mono text-xs\"\r\n                  placeholder={generateStandardMessage()}\r\n                />\r\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                  {t('reservations.sendPasscode.messageVariables', 'Verfgbare Variablen: {{guestName}}, {{passcode}}, {{roomNumber}}, {{roomDescription}}')}\r\n                </p>\r\n              </div>\r\n\r\n              {/* Preview */}\r\n              {previewMessage && (\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    {t('reservations.sendPasscode.preview', 'Vorschau')}\r\n                  </label>\r\n                  <div className=\"p-3 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-md text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\r\n                    {previewMessage}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Buttons */}\r\n          <div className=\"flex justify-end space-x-3 pt-4 border-t dark:border-gray-700\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleClose}\r\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n            >\r\n              {t('common.cancel', 'Abbrechen')}\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loading || (!guestPhone && !guestEmail)}\r\n              className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              {loading\r\n                ? t('reservations.sendPasscode.sending', 'Wird gesendet...')\r\n                : t('reservations.sendPasscode.send', 'Senden')\r\n              }\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default SendPasscodeSidepane;\r\n\r\n","import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { ClockIcon, ListBulletIcon, ArrowPathIcon, ExclamationTriangleIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useWorktime } from '../contexts/WorktimeContext.tsx';\nimport { useBranch } from '../contexts/BranchContext.tsx';\nimport { useOrganization } from '../contexts/OrganizationContext.tsx';\nimport { WorktimeModal } from './WorktimeModal.tsx';\n\n// Wir entfernen die benutzerdefinierten API-URL-Definitionen und verwenden die direkte URL,\n// um Konflikte mit der globalen Axios-Konfiguration zu vermeiden\n// const API_BASE_URL = 'http://localhost:5000';\n// const API_URL = `${API_BASE_URL}/api`;\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface WorkTime {\n    id: number;\n    startTime: Date;\n    endTime: Date | null;\n    branchId: number;\n    userId: number;\n    organizationId: number | null;\n    branch: {\n        id: number;\n        name: string;\n    };\n}\n\ninterface WorktimeModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nconst WorktimeTracker: React.FC = () => {\n    /* CLAUDE-ANCHOR: a7c238f1-9d6a-42e5-8af1-6d8b2e9a4f18 - WORKTIME_TRACKER_COMPONENT */\n    const { t } = useTranslation();\n    const [isTracking, setIsTracking] = useState(false);\n    const [startTime, setStartTime] = useState<Date | null>(null);\n    const [elapsedTime, setElapsedTime] = useState<string>('00:00:00');\n    const [activeWorktime, setActiveWorktime] = useState<WorkTime | null>(null);\n    const [isLoading, setIsLoading] = useState(true);\n    const [showWorkTimeModal, setShowWorkTimeModal] = useState(false);\n    const [statusError, setStatusError] = useState<string | null>(null);\n    const { user } = useAuth();\n    const { isTracking: contextTracking, updateTrackingStatus, checkTrackingStatus } = useWorktime();\n    const { branches, selectedBranch, setSelectedBranch } = useBranch();\n    const { organization } = useOrganization();\n\n    // Prfe ob aktive WorkTime zu anderer Organisation gehrt\n    const isDifferentOrganization = useMemo(() => {\n        if (!activeWorktime || !organization) return false;\n        // Beide null = standalone User, keine Warnung\n        if (activeWorktime.organizationId === null && organization.id === undefined) return false;\n        // Vergleich: WorkTime gehrt zu anderer Organisation\n        return activeWorktime.organizationId !== organization.id;\n    }, [activeWorktime, organization]);\n\n    // Funktion zum Abrufen des aktiven Worktime-Status\n    const checkActiveWorktime = useCallback(async () => {\n        try {\n            setIsLoading(true);\n            setStatusError(null);\n            \n            console.log('Prfe aktive Zeiterfassung...');\n            console.log('Benutzer geladen:', user?.id);\n            \n            const token = localStorage.getItem('token');\n            console.log('Token vorhanden:', token ? 'Ja' : 'Nein');\n            \n            if (!token) {\n                console.error('Kein Authentifizierungstoken gefunden');\n                setStatusError(t('worktime.tracker.notAuthenticated'));\n                setIsLoading(false);\n                return;\n            }\n            \n            try {\n                // Verwende axiosInstance statt direktem axios\n                const response = await axiosInstance.get(API_ENDPOINTS.WORKTIME.ACTIVE);\n                \n                console.log('API-Antwort Status:', response.status);\n                \n                const data = response.data;\n                console.log('Aktive Zeiterfassung Daten:', data);\n                \n                if (data && data.active === true) {\n                    console.log('Aktive Zeiterfassung gefunden:', data.id);\n                    // Startzeit setzen und Timer initialisieren\n                    // Entferne das 'Z' am Ende des Strings, damit JS den Zeitstempel nicht als UTC interpretiert\n                    const startISOString = data.startTime.endsWith('Z') \n                        ? data.startTime.substring(0, data.startTime.length - 1)\n                        : data.startTime;\n                    \n                    const startTimeDate = new Date(startISOString);\n                    \n                    // Initial berechnete Zeit anzeigen\n                    const now = new Date();\n                    const diff = now.getTime() - startTimeDate.getTime();\n                    const totalSeconds = Math.floor(diff / 1000);\n                    const hours = Math.floor(totalSeconds / 3600);\n                    const minutes = Math.floor((totalSeconds % 3600) / 60);\n                    const seconds = totalSeconds % 60;\n                    \n                    // Alle State-Updates in einem Batch zusammenfassen, um nur einen Re-Render zu verursachen\n                    setActiveWorktime(data);\n                    setStartTime(startTimeDate);\n                    setElapsedTime(\n                        `${hours.toString().padStart(2, '0')}:${minutes\n                            .toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`\n                    );\n                    setIsTracking(true);\n                    \n                    // Nur Branch setzen, wenn es sich gendert hat (vermeidet unntigen Re-Render)\n                    if (selectedBranch !== data.branchId) {\n                        setSelectedBranch(data.branchId);\n                    }\n                    \n                    // Aktualisiere den globalen Tracking-Status\n                    updateTrackingStatus(true);\n                } else {\n                    console.log('Keine aktive Zeiterfassung vorhanden');\n                    // Alle State-Updates in einem Batch zusammenfassen\n                    setIsTracking(false);\n                    setActiveWorktime(null);\n                    setStartTime(null);\n                    setElapsedTime('00:00:00');\n                    \n                    // Aktualisiere den globalen Tracking-Status\n                    updateTrackingStatus(false);\n                }\n            } catch (error) {\n                console.error('Fehler beim Abrufen der aktiven Zeiterfassung:', error);\n                \n                // Einfachere Fehlerbehandlung ohne axios-Import\n                const axiosError = error as any;\n                if (axiosError.code === 'ERR_NETWORK') {\n                    setStatusError(t('worktime.tracker.connectionError'));\n                } else {\n                    setStatusError(`${t('worktime.tracker.errorFetch')}: ${axiosError.response?.data?.message || axiosError.message}`);\n                }\n            }\n        } finally {\n            setIsLoading(false);\n        }\n    }, [user?.id, updateTrackingStatus, selectedBranch, organization]);\n    \n    //  PERFORMANCE: Verwende WorktimeContext statt eigenen Request\n    // Initiale Prfung: Verwende isTracking aus WorktimeContext (wird bereits beim Seitenaufruf geladen)\n    useEffect(() => {\n        if (user) {\n            // WorktimeContext ldt bereits beim Mount, verwende diesen Status\n            // Warte auf contextTracking (kann undefined sein beim ersten Render)\n            if (contextTracking !== undefined) {\n                // Context ist geladen, verwende diesen Status\n                setIsTracking(contextTracking);\n                setIsLoading(false);\n            }\n            // Wenn contextTracking noch undefined ist, warten wir einfach\n            // WorktimeContext wird den Status automatisch laden\n        } else {\n            setIsLoading(false);\n        }\n    }, [user, contextTracking]);\n\n    // Timer-Logik\n    useEffect(() => {\n        let intervalId: number;\n\n        if (isTracking && startTime) {\n            intervalId = window.setInterval(() => {\n                const now = new Date();\n                const diff = now.getTime() - startTime.getTime();\n                \n                // Berechnung mit Millisekunden, um negative Werte zu vermeiden\n                const totalSeconds = Math.floor(diff / 1000);\n                const hours = Math.floor(totalSeconds / 3600);\n                const minutes = Math.floor((totalSeconds % 3600) / 60);\n                const seconds = totalSeconds % 60;\n\n                setElapsedTime(\n                    `${hours.toString().padStart(2, '0')}:${minutes\n                        .toString()\n                        .padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`\n                );\n            }, 1000);\n        }\n\n        return () => {\n            if (intervalId) {\n                clearInterval(intervalId);\n            }\n        };\n    }, [isTracking, startTime]);\n\n    const handleToggleTracking = async () => {\n        if (isTracking) {\n            await handleStopTracking();\n        } else {\n            await handleStartTracking();\n        }\n    };\n\n    const handleStartTracking = async () => {\n        if (!selectedBranch) {\n            alert(t('worktime.tracker.selectBranch'));\n            return;\n        }\n\n        try {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                console.error('Kein Authentifizierungstoken gefunden');\n                alert(t('worktime.tracker.notAuthenticatedMessage'));\n                return;\n            }\n            \n            // Verwende axiosInstance statt direktem axios\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.WORKTIME.START,\n                {\n                    branchId: selectedBranch,\n                    // Die aktuelle Zeit mit Bercksichtigung der Zeitzonenverschiebung senden\n                    // Da die Datenbank in UTC speichert, mssen wir die lokale Zeit so senden,\n                    // dass sie nach der automatischen UTC-Umwandlung korrekt ist\n                    startTime: new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000)\n                },\n                {\n                    headers: {\n                        'Authorization': `Bearer ${token}`,\n                        'Content-Type': 'application/json'\n                    }\n                }\n            );\n\n            const data = response.data;\n            \n            // Erstelle ein Date-Objekt ohne Zeitzonenumrechnung\n            // Entferne das 'Z' am Ende des Strings, damit JS den Zeitstempel nicht als UTC interpretiert\n            const startISOString = data.startTime.endsWith('Z') \n                ? data.startTime.substring(0, data.startTime.length - 1)\n                : data.startTime;\n            \n            const startTimeDate = new Date(startISOString);\n            \n            // Initial berechnete Zeit anzeigen (0:00:00 beim Start)\n            // Alle State-Updates in einem Batch zusammenfassen, um nur einen Re-Render zu verursachen\n            setActiveWorktime(data);\n            setStartTime(startTimeDate);\n            setElapsedTime('00:00:00');\n            setIsTracking(true);\n            \n            // Aktualisiere den globalen Tracking-Status\n            updateTrackingStatus(true);\n        } catch (error) {\n            console.error('Fehler:', error);\n            \n            // Detaillierte Fehlerbehandlung\n            let errorMessage = t('worktime.tracker.errorStart');\n            if (error.response) {\n                errorMessage = error.response.data?.message || `Fehler (Status: ${error.response.status})`;\n            }\n            \n            alert(errorMessage);\n        }\n    };\n\n    const handleStopTracking = async () => {\n        try {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                console.error('Kein Authentifizierungstoken gefunden');\n                alert(t('worktime.tracker.notAuthenticatedMessage'));\n                return;\n            }\n            \n            // Verwende axiosInstance statt direktem axios\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.WORKTIME.STOP,\n                {\n                    // Die aktuelle Zeit mit Bercksichtigung der Zeitzonenverschiebung senden\n                    endTime: new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000)\n                },\n                {\n                    headers: {\n                        'Authorization': `Bearer ${token}`,\n                        'Content-Type': 'application/json'\n                    }\n                }\n            );\n\n            // Alle State-Updates in einem Batch zusammenfassen, um nur einen Re-Render zu verursachen\n            setIsTracking(false);\n            setActiveWorktime(null);\n            setStartTime(null);\n            setElapsedTime('00:00:00');\n            \n            // Aktualisiere den globalen Tracking-Status\n            updateTrackingStatus(false);\n        } catch (error) {\n            console.error('Fehler:', error);\n            \n            // Detaillierte Fehlerbehandlung\n            let errorMessage = t('worktime.tracker.errorStop');\n            if (error.response) {\n                errorMessage = error.response.data?.message || `Fehler (Status: ${error.response.status})`;\n            }\n            \n            alert(errorMessage);\n        }\n    };\n\n    const openWorkTimeModal = () => {\n        setShowWorkTimeModal(true);\n    };\n\n    const closeWorkTimeModal = () => {\n        setShowWorkTimeModal(false);\n    };\n\n    // Branch-Name memoized berechnen (vermeidet unntige Re-Berechnungen)\n    const branchName = useMemo(() => {\n        if (!activeWorktime) return null;\n        return branches.find(b => b.id === activeWorktime.branchId)?.name || t('worktime.tracker.unknown');\n    }, [branches, activeWorktime]);\n\n    // Manuelle Statusaktualisierung\n    const handleRefreshStatus = () => {\n        checkActiveWorktime();\n    };\n\n    // Manuelle Zeiterfassung forciert stoppen (fr Notflle)\n    const handleForceStop = async () => {\n        if (!window.confirm(t('worktime.tracker.forceStopConfirm'))) {\n            return;\n        }\n        \n        try {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                console.error('Kein Authentifizierungstoken gefunden');\n                alert(t('worktime.tracker.notAuthenticatedMessage'));\n                return;\n            }\n            \n            // Verwende axiosInstance statt direktem axios\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.WORKTIME.STOP,\n                {\n                    // Die aktuelle Zeit mit Bercksichtigung der Zeitzonenverschiebung senden\n                    endTime: new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000),\n                    force: true\n                },\n                {\n                    headers: {\n                        'Authorization': `Bearer ${token}`,\n                        'Content-Type': 'application/json'\n                    }\n                }\n            );\n\n            setIsTracking(false);\n            setStartTime(null);\n            setElapsedTime('00:00:00');\n            setActiveWorktime(null);\n            setStatusError(null);\n            alert(t('worktime.tracker.forceStopSuccess'));\n            \n            // Aktualisiere den globalen Tracking-Status\n            updateTrackingStatus(false);\n        } catch (error) {\n            console.error('Fehler:', error);\n            setStatusError(`Fehler beim Stoppen: ${error.response?.status || 'Netzwerkfehler'}`);\n            alert(t('worktime.tracker.forceStopError'));\n        }\n    };\n\n    // Formatiere das Startdatum fr die lokale Anzeige\n    const formatStartDate = (dateString: string | number | Date) => {\n        // Entferne das 'Z' am Ende des Strings, damit JS den Zeitstempel nicht als UTC interpretiert\n        if (typeof dateString === 'string' && dateString.endsWith('Z')) {\n            dateString = dateString.substring(0, dateString.length - 1);\n        }\n        \n        const date = new Date(dateString);\n        \n        // Tag, Monat und Jahr aus lokaler Zeit extrahieren\n        const day = date.getDate().toString().padStart(2, '0');\n        const month = (date.getMonth() + 1).toString().padStart(2, '0');\n        const year = date.getFullYear();\n        \n        // Stunden, Minuten und Sekunden aus lokaler Zeit extrahieren\n        const hours = date.getHours().toString().padStart(2, '0');\n        const minutes = date.getMinutes().toString().padStart(2, '0');\n        const seconds = date.getSeconds().toString().padStart(2, '0');\n        \n        // Im deutschen Format zurckgeben\n        return `${day}.${month}.${year}, ${hours}:${minutes}:${seconds}`;\n    };\n\n    if (isLoading) {\n        return (\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-6\">\n                <div className=\"flex justify-center items-center h-32\">\n                    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-gray-300\"></div>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 sm:mb-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-xl font-semibold flex items-center dark:text-white\">\n                    <ClockIcon className=\"h-6 w-6 mr-2\" />\n                    {t('worktime.tracker.title')}\n                </h2>\n            </div>\n            \n            {statusError && (\n                <div className=\"mb-4 p-2 bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-300 border border-red-200 dark:border-red-700 rounded-md flex justify-between items-center\">\n                    <span>{statusError}</span>\n                    {statusError !== t('worktime.tracker.noActiveTracking') && (\n                        <button \n                            onClick={handleForceStop}\n                            className=\"text-sm bg-red-100 hover:bg-red-200 text-red-700 dark:bg-red-800 dark:hover:bg-red-700 dark:text-red-300 px-2 py-1 rounded-md\"\n                        >\n                            {t('worktime.tracker.stop')} {t('common.force', 'Erzwingen')}\n                        </button>\n                    )}\n                </div>\n            )}\n\n            {/* Warnung wenn WorkTime zu anderer Organisation gehrt */}\n            {isTracking && isDifferentOrganization && (\n                <div className=\"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200 border border-yellow-200 dark:border-yellow-700 rounded-md flex items-start\">\n                    <ExclamationTriangleIcon className=\"h-5 w-5 mr-2 mt-0.5 flex-shrink-0\" />\n                    <div className=\"flex-1\">\n                        <p className=\"font-medium\">{t('worktime.tracker.differentOrganizationWarning.title', 'Hinweis: Andere Organisation')}</p>\n                        <p className=\"text-sm mt-1\">\n                            {t('worktime.tracker.differentOrganizationWarning.message', 'Diese Zeiterfassung wurde in einer anderen Organisation gestartet. Sie wird nach dem Stoppen der Organisation zugeordnet, in der sie gestartet wurde.')}\n                        </p>\n                    </div>\n                </div>\n            )}\n            \n            {/* Ein-/Ausschalter fr die Zeiterfassung - verkleinert */}\n            <div className=\"flex items-start justify-center mb-4\">\n                <div className=\"flex flex-col items-center\">\n                    <label className=\"relative inline-flex items-center cursor-pointer\">\n                        <input \n                            type=\"checkbox\" \n                            className=\"sr-only peer\" \n                            checked={isTracking}\n                            onChange={handleToggleTracking}\n                            disabled={!selectedBranch && !isTracking}\n                            data-onboarding={isTracking ? \"stop-worktime\" : \"start-worktime\"}\n                        />\n                        <div className={`w-20 h-10 rounded-full \n                            ${isTracking \n                                ? 'bg-green-500 shadow-lg shadow-green-200 dark:shadow-green-900/20' \n                                : 'bg-gray-300 dark:bg-gray-600'\n                            }\n                            before:content-[''] before:absolute before:top-0 before:left-0 before:bottom-0 before:right-0 \n                            peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-700\n                            peer-checked:after:translate-x-10\n                            after:content-[''] after:absolute after:top-1 after:left-1\n                            after:bg-white dark:after:bg-gray-200 after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full\n                            after:h-8 after:w-8 after:transition-all after:duration-300 ease-in-out\n                            transition-colors duration-300`}>\n                        </div>\n                    </label>\n                    <span className=\"mt-2 text-sm font-medium\">\n                        {isTracking \n                            ? <span className=\"text-green-600 dark:text-green-400 font-bold\">{t('worktime.tracker.running')}</span> \n                            : <span className=\"text-gray-600 dark:text-gray-400\">{t('worktime.tracker.start')}</span>\n                        }\n                    </span>\n                </div>\n\n                {/* Icon-Button zum ffnen des Modals */}\n                <button \n                    onClick={openWorkTimeModal}\n                    className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-2 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-blue-700 shadow-sm flex items-center justify-center ml-8 mt-1\"\n                    title={t('worktime.tracker.showTimes')}\n                >\n                    <ListBulletIcon className=\"h-6 w-6\" />\n                </button>\n            </div>\n\n            {/* Informationen zur aktiven Zeiterfassung oder Platzhalter */}\n            <div className={`p-2 my-2 rounded-md text-sm ${isTracking && activeWorktime ? 'bg-green-50 dark:bg-green-900/20 dark:text-green-200' : 'bg-gray-50 dark:bg-gray-700 dark:text-gray-300'}`}>\n                {isTracking && activeWorktime ? (\n                    <>\n                        <p><strong>{t('worktime.tracker.activeTracking')}</strong> {elapsedTime}</p>\n                        <p><strong>{t('worktime.tracker.started')}</strong> {formatStartDate(startTime || Date.now())}</p>\n                        <p><strong>{t('worktime.tracker.selectBranchLabel')}:</strong> {branchName || t('worktime.tracker.unknown')}</p>\n                    </>\n                ) : (\n                    <>\n                        <p>&nbsp;</p>\n                        <p>&nbsp;</p>\n                        <p>&nbsp;</p>\n                    </>\n                )}\n            </div>\n\n            {/* WorkTime Modal */}\n            {showWorkTimeModal && (\n                <WorktimeModal isOpen={showWorkTimeModal} onClose={closeWorkTimeModal} />\n            )}\n        </div>\n    );\n};\n\nexport default WorktimeTracker; ","import React, { useEffect, useState, useMemo, useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { CircularProgress } from '@mui/material';\nimport { useLocation } from 'react-router-dom';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useTableSettings } from '../hooks/useTableSettings.ts';\nimport TableColumnConfig from '../components/TableColumnConfig.tsx';\nimport { PencilIcon, TrashIcon, PlusIcon, ArrowLeftIcon, ArrowRightIcon, CheckCircleIcon, ArrowsUpDownIcon, FunnelIcon, XMarkIcon, DocumentDuplicateIcon, InformationCircleIcon, ClipboardDocumentListIcon, ArrowPathIcon, Squares2X2Icon, TableCellsIcon, UserIcon, BuildingOfficeIcon, CalendarIcon, ChevronLeftIcon, ChevronRightIcon, HomeIcon, EnvelopeIcon, PhoneIcon, LinkIcon, CurrencyDollarIcon, ClockIcon, KeyIcon, PaperAirplaneIcon, MapIcon, ArrowDownTrayIcon } from '@heroicons/react/24/outline';\nimport CreateTaskModal from '../components/CreateTaskModal.tsx';\nimport EditTaskModal from '../components/EditTaskModal.tsx';\nimport CreateReservationModal from '../components/reservations/CreateReservationModal.tsx';\nimport TourBookingsModal from '../components/tours/TourBookingsModal.tsx';\nimport CreateTourBookingModal from '../components/tours/CreateTourBookingModal.tsx';\nimport EditTourBookingModal from '../components/tours/EditTourBookingModal.tsx';\nimport TourReservationLinkModal from '../components/tours/TourReservationLinkModal.tsx';\nimport SendInvitationSidepane from '../components/reservations/SendInvitationSidepane.tsx';\nimport SendPasscodeSidepane from '../components/reservations/SendPasscodeSidepane.tsx';\nimport ReservationNotificationLogs from '../components/reservations/ReservationNotificationLogs.tsx';\nimport { Reservation, ReservationStatus, PaymentStatus } from '../types/reservation.ts';\nimport { Tour, TourType, TourBooking } from '../types/tour.ts';\nimport { useNavigate } from 'react-router-dom';\nimport useMessage from '../hooks/useMessage.ts';\nimport WorktimeTracker from '../components/WorktimeTracker.tsx';\nimport WorktimeList from '../components/WorktimeList.tsx';\nimport { API_ENDPOINTS, getTaskAttachmentUrl } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { applyFilters, evaluateDateCondition, evaluateUserRoleCondition, evaluateResponsibleAndQualityControl } from '../utils/filterLogic.ts';\nimport { toast } from 'react-toastify';\nimport MarkdownPreview from '../components/MarkdownPreview.tsx';\nimport { getExpiryStatus, getExpiryColorClasses, createDueDateMetadataItem } from '../utils/expiryUtils.ts';\nimport { getStatusText, getStatusColor } from '../utils/statusUtils.tsx';\nimport DataCard, { MetadataItem } from '../components/shared/DataCard.tsx';\nimport CardGrid from '../components/shared/CardGrid.tsx';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport { reservationService } from '../services/reservationService.ts';\n\ninterface Task {\n    id: number;\n    title: string;\n    description: string | null;\n    status: 'open' | 'in_progress' | 'improval' | 'quality_control' | 'done';\n    responsible: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    responsibleId: number | null;\n    role: {\n        id: number;\n        name: string;\n    } | null;\n    roleId: number | null;\n    qualityControl: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    branch: {\n        id: number;\n        name: string;\n    };\n    dueDate: string | null;\n    requestId: number | null;\n    attachments?: Array<{\n        id: number;\n        fileName: string;\n        fileType: string;\n        fileSize?: number;\n        filePath?: string;\n        uploadedAt?: string;\n        url: string;\n    }>;\n}\n\ninterface SortConfig {\n    key: keyof Task | 'responsible.firstName' | 'qualityControl.firstName' | 'branch.name';\n    direction: 'asc' | 'desc';\n}\n\ninterface ReservationSortConfig {\n    key: 'guestName' | 'status' | 'paymentStatus' | 'checkInDate' | 'checkOutDate' | 'roomNumber' | 'branch' | 'guestEmail' | 'guestPhone' | 'amount' | 'arrivalTime' | 'branch.name';\n    direction: 'asc' | 'desc';\n}\n\n\n// Standard-Spaltenreihenfolge (wird in der Komponente neu definiert)\nconst defaultColumnOrder = ['title', 'responsibleAndQualityControl', 'status', 'dueDate', 'branch', 'actions'];\n\n// Definiere eine tableId fr die To-Dos Tabelle\nconst TODOS_TABLE_ID = 'worktracker-todos';\n\n// Definiere eine tableId fr die Reservations Tabelle\nconst RESERVATIONS_TABLE_ID = 'worktracker-reservations';\n\n\n// Card-Einstellungen Standardwerte\nconst defaultCardMetadata = ['title', 'status', 'responsible', 'qualityControl', 'branch', 'dueDate', 'description'];\nconst defaultCardColumnOrder = ['title', 'status', 'responsible', 'qualityControl', 'branch', 'dueDate', 'description'];\nconst defaultCardSortDirections: Record<string, 'asc' | 'desc'> = {\n  title: 'asc',\n  status: 'asc',\n  responsible: 'asc',\n  qualityControl: 'asc',\n  branch: 'asc',\n  dueDate: 'asc',\n  description: 'asc'\n};\n\n// Default Sortierrichtungen fr Reservations Card-Metadaten\nconst defaultReservationCardSortDirections: Record<string, 'asc' | 'desc'> = {\n  guestName: 'asc',\n  status: 'asc',\n  paymentStatus: 'asc',\n  checkInDate: 'desc',  // Neueste zuerst (wie aktuell hardcoded)\n  checkOutDate: 'desc',\n  roomNumber: 'asc',\n  branch: 'asc',\n  guestEmail: 'asc',\n  guestPhone: 'asc',\n  amount: 'desc',\n  arrivalTime: 'desc'\n};\n\n// Mapping zwischen Tabellen-Spalten-IDs und Card-Metadaten-IDs\n// Tabellen-Spalte -> Card-Metadaten (kann Array sein fr 1:N Mapping)\nconst tableToCardMapping: Record<string, string[]> = {\n  'title': ['title'],\n  'status': ['status'],\n  'responsibleAndQualityControl': ['responsible', 'qualityControl'], // 1 Tabelle-Spalte -> 2 Card-Metadaten\n  'branch': ['branch'],\n  'dueDate': ['dueDate'],\n  'actions': [], // Keine Card-Entsprechung\n  'description': ['description'] // Nur in Cards verfgbar\n};\n\n// Reverse Mapping: Card-Metadaten -> Tabellen-Spalten\nconst cardToTableMapping: Record<string, string> = {\n  'title': 'title',\n  'status': 'status',\n  'responsible': 'responsibleAndQualityControl',\n  'qualityControl': 'responsibleAndQualityControl',\n  'branch': 'branch',\n  'dueDate': 'dueDate',\n  'description': 'description'\n};\n\n// Helfer-Funktion: Tabellen-Spalte ausgeblendet -> Card-Metadaten ausblenden\nconst getHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n  const hiddenCardMetadata = new Set<string>();\n  hiddenTableColumns.forEach(tableCol => {\n    const cardMetadata = tableToCardMapping[tableCol] || [];\n    cardMetadata.forEach(cardMeta => hiddenCardMetadata.add(cardMeta));\n  });\n  return hiddenCardMetadata;\n};\n\n// Helfer-Funktion: Card-Metadaten zu Tabellen-Spalten konvertieren\nconst getCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n  const cardMetadata: string[] = [];\n  columnOrder.forEach(tableCol => {\n    const cardMeta = tableToCardMapping[tableCol];\n    if (cardMeta && cardMeta.length > 0) {\n      cardMetadata.push(...cardMeta);\n    }\n  });\n  // Beschreibung hinzufgen, wenn nicht schon vorhanden\n  if (!cardMetadata.includes('description')) {\n    cardMetadata.push('description');\n  }\n  return cardMetadata;\n};\n\n// Reservations: Tabellen-Spalte -> Card-Metadaten (1:1 Mapping)\nconst reservationTableToCardMapping: Record<string, string[]> = {\n  'guestName': ['guestName'],\n  'status': ['status'],\n  'paymentStatus': ['paymentStatus'],\n  'checkInDate': ['checkInDate'],\n  'checkOutDate': ['checkOutDate'],\n  'roomNumber': ['roomNumber'],\n  'branch': ['branch'],\n  'guestEmail': ['guestEmail'],\n  'guestPhone': ['guestPhone'],\n  'amount': ['amount'],\n  'arrivalTime': ['arrivalTime'],\n  'actions': [] // Keine Card-Entsprechung\n};\n\n// Reservations: Reverse Mapping: Card-Metadaten -> Tabellen-Spalten (1:1 Mapping)\nconst reservationCardToTableMapping: Record<string, string> = {\n  'guestName': 'guestName',\n  'status': 'status',\n  'paymentStatus': 'paymentStatus',\n  'checkInDate': 'checkInDate',\n  'checkOutDate': 'checkOutDate',\n  'roomNumber': 'roomNumber',\n  'branch': 'branch',\n  'guestEmail': 'guestEmail',\n  'guestPhone': 'guestPhone',\n  'amount': 'amount',\n  'arrivalTime': 'arrivalTime'\n};\n\n// Tours: Tabellen-Spalte -> Card-Metadaten (1:1 Mapping)\nconst tourTableToCardMapping: Record<string, string[]> = {\n  'title': ['title'],\n  'type': ['type'],\n  'price': ['price'],\n  'location': ['location'],\n  'duration': ['duration'],\n  'branch': ['branch'],\n  'createdBy': ['createdBy'],\n  'isActive': ['isActive'],\n  'actions': [] // Keine Card-Entsprechung\n};\n\n// Tours: Reverse Mapping: Card-Metadaten -> Tabellen-Spalten (1:1 Mapping)\nconst tourCardToTableMapping: Record<string, string> = {\n  'title': 'title',\n  'type': 'type',\n  'price': 'price',\n  'location': 'location',\n  'duration': 'duration',\n  'branch': 'branch',\n  'createdBy': 'createdBy',\n  'isActive': 'isActive'\n};\n\n// Tours: Helfer-Funktion: Tabellen-Spalte ausgeblendet -> Card-Metadaten ausblenden\nconst getTourHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n  const hiddenCardMetadata = new Set<string>();\n  hiddenTableColumns.forEach(tableCol => {\n    const cardMetadata = tourTableToCardMapping[tableCol] || [];\n    cardMetadata.forEach(cardMeta => hiddenCardMetadata.add(cardMeta));\n  });\n  return hiddenCardMetadata;\n};\n\n// Tours: Helfer-Funktion: Card-Metadaten zu Tabellen-Spalten konvertieren\nconst getTourCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n  const cardMetadata: string[] = [];\n  columnOrder.forEach(tableCol => {\n    const cardMeta = tourTableToCardMapping[tableCol] || [];\n    if (cardMeta.length > 0) {\n      cardMetadata.push(...cardMeta);\n    }\n  });\n  return cardMetadata;\n};\n\n// Reservations: Helfer-Funktion: Tabellen-Spalte ausgeblendet -> Card-Metadaten ausblenden\nconst getReservationHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n  const hiddenCardMetadata = new Set<string>();\n  hiddenTableColumns.forEach(tableCol => {\n    const cardMetadata = reservationTableToCardMapping[tableCol] || [];\n    cardMetadata.forEach(cardMeta => hiddenCardMetadata.add(cardMeta));\n  });\n  return hiddenCardMetadata;\n};\n\n// Reservations: Helfer-Funktion: Card-Metadaten zu Tabellen-Spalten konvertieren\nconst getReservationCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n  const cardMetadata: string[] = [];\n  columnOrder.forEach(tableCol => {\n    const cardMeta = reservationTableToCardMapping[tableCol];\n    if (cardMeta && cardMeta.length > 0) {\n      cardMetadata.push(...cardMeta);\n    }\n  });\n  return cardMetadata;\n};\n\nconst Worktracker: React.FC = () => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { hasPermission, permissions } = usePermissions();\n    const location = useLocation();\n    const navigate = useNavigate();\n    const { showMessage } = useMessage();\n    \n    // Definiere die verfgbaren Spalten fr die Tabelle (dynamisch aus bersetzungen)\n    const availableColumns = useMemo(() => [\n        { id: 'title', label: t('tasks.columns.title'), shortLabel: t('tasks.columns.title') },\n        { id: 'status', label: t('tasks.columns.status'), shortLabel: t('tasks.columns.status') },\n        { id: 'responsibleAndQualityControl', label: t('tasks.columns.responsibleAndQualityControl'), shortLabel: t('tasks.columns.responsibleAndQualityControl').split('/')[0] },\n        { id: 'branch', label: t('tasks.columns.branch'), shortLabel: t('tasks.columns.branch').substring(0, 5) },\n        { id: 'dueDate', label: t('tasks.columns.dueDate'), shortLabel: t('tasks.columns.dueDate').substring(0, 5) },\n        { id: 'actions', label: t('tasks.columns.actions'), shortLabel: t('common.actions').substring(0, 3) },\n    ], [t]);\n\n    // Definiere zustzliche Spalten, die nur fr den Filter verfgbar sind, nicht fr die Tabellenanzeige\n    const filterOnlyColumns = useMemo(() => [\n        { id: 'responsible', label: t('tasks.columns.responsible'), shortLabel: t('tasks.columns.responsible').substring(0, 3) },\n        { id: 'qualityControl', label: t('tasks.columns.qualityControl'), shortLabel: t('tasks.columns.qualityControl').substring(0, 2) },\n    ], [t]);\n    \n    // Reservations-Spalten\n    const availableReservationColumns = useMemo(() => [\n        { id: 'guestName', label: t('reservations.columns.guestName', 'Gast'), shortLabel: t('reservations.columns.guestName', 'Gast').substring(0, 4) },\n        { id: 'status', label: t('reservations.columns.status', 'Status'), shortLabel: t('reservations.columns.status', 'Status').substring(0, 3) },\n        { id: 'paymentStatus', label: t('reservations.columns.paymentStatus', 'Zahlungsstatus'), shortLabel: t('reservations.columns.paymentStatus', 'Zahlungsstatus').substring(0, 3) },\n        { id: 'checkInDate', label: t('reservations.columns.checkInDate', 'Check-in'), shortLabel: t('reservations.columns.checkInDate', 'Check-in').substring(0, 5) },\n        { id: 'checkOutDate', label: t('reservations.columns.checkOutDate', 'Check-out'), shortLabel: t('reservations.columns.checkOutDate', 'Check-out').substring(0, 5) },\n        { id: 'roomNumber', label: t('reservations.columns.roomNumber', 'Zimmer'), shortLabel: t('reservations.columns.roomNumber', 'Zimmer').substring(0, 3) },\n        { id: 'branch', label: t('reservations.columns.branch', 'Niederlassung'), shortLabel: t('reservations.columns.branch', 'Niederlassung').substring(0, 5) },\n        { id: 'guestEmail', label: t('reservations.columns.guestEmail', 'E-Mail'), shortLabel: t('reservations.columns.guestEmail', 'E-Mail').substring(0, 3) },\n        { id: 'guestPhone', label: t('reservations.columns.guestPhone', 'Telefon'), shortLabel: t('reservations.columns.guestPhone', 'Telefon').substring(0, 3) },\n        { id: 'amount', label: t('reservations.columns.amount', 'Betrag'), shortLabel: t('reservations.columns.amount', 'Betrag').substring(0, 3) },\n        { id: 'arrivalTime', label: t('reservations.columns.arrivalTime', 'Ankunftszeit'), shortLabel: t('reservations.columns.arrivalTime', 'Ankunftszeit').substring(0, 3) },\n        { id: 'actions', label: t('reservations.columns.actions', 'Aktionen'), shortLabel: t('common.actions').substring(0, 3) },\n    ], [t]);\n    \n    // Reservations Filter-Spalten (zustzliche Spalten nur fr Filter)\n    const reservationFilterOnlyColumns = useMemo(() => [\n        { id: 'onlineCheckInCompleted', label: t('reservations.columns.onlineCheckInCompleted', 'Online Check-in'), shortLabel: t('reservations.columns.onlineCheckInCompleted', 'Online Check-in').substring(0, 3) },\n        { id: 'doorPin', label: t('reservations.columns.doorPin', 'Tr-PIN'), shortLabel: t('reservations.columns.doorPin', 'Tr-PIN').substring(0, 3) },\n    ], [t]);\n    \n    \n    // Status-bersetzungen (verwende zentrale Utils mit bersetzungsuntersttzung)\n    // WICHTIG: Funktionalitt bleibt identisch - nur Code-Duplikation entfernt!\n    const getStatusLabel = (status: Task['status']): string => {\n        return getStatusText(status, 'task', t);\n    };\n    // Tab-State\n    const [activeTab, setActiveTab] = useState<'todos' | 'reservations' | 'tourBookings'>('todos');\n    \n    const [tasks, setTasks] = useState<Task[]>([]);\n    const [tasksTotalCount, setTasksTotalCount] = useState<number>(0); //  PAGINATION: Gesamtanzahl\n    const [tasksHasMore, setTasksHasMore] = useState<boolean>(true); //  PAGINATION: Gibt es noch weitere Items?\n    const [tasksLoadingMore, setTasksLoadingMore] = useState<boolean>(false); //  PAGINATION: Ldt weitere Items\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n    const [initialFilterLoading, setInitialFilterLoading] = useState<boolean>(false); //  KRITISCH: Verhindert Endlosschleife beim initialen Filter-Load\n    const initialFilterAppliedRef = useRef<boolean>(false); //  KRITISCH: Verhindert mehrfaches Anwenden des initialen Filters fr Tasks\n    const [searchTerm, setSearchTerm] = useState('');\n    const [statusFilter, setStatusFilter] = useState<Task['status'] | 'all'>('all');\n    \n    // Reservations-States\n    const [reservations, setReservations] = useState<Reservation[]>([]);\n    const [reservationsTotalCount, setReservationsTotalCount] = useState<number>(0); //  PAGINATION: Gesamtanzahl\n    const [reservationsHasMore, setReservationsHasMore] = useState<boolean>(true); //  PAGINATION: Gibt es noch weitere Items?\n    const [reservationsLoadingMore, setReservationsLoadingMore] = useState<boolean>(false); //  PAGINATION: Ldt weitere Items\n    const [reservationsLoading, setReservationsLoading] = useState(false);\n    const [reservationsError, setReservationsError] = useState<string | null>(null);\n    const [initialReservationFilterLoading, setInitialReservationFilterLoading] = useState<boolean>(false); //  KRITISCH: Verhindert Endlosschleife beim initialen Filter-Load\n    const initialReservationFilterAppliedRef = useRef<boolean>(false); //  KRITISCH: Verhindert mehrfaches Anwenden des initialen Filters\n    const [reservationSearchTerm, setReservationSearchTerm] = useState('');\n    const [reservationFilterStatus, setReservationFilterStatus] = useState<ReservationStatus | 'all'>('all');\n    const [reservationFilterPaymentStatus, setReservationFilterPaymentStatus] = useState<PaymentStatus | 'all'>('all');\n    \n    const [isCreateReservationModalOpen, setIsCreateReservationModalOpen] = useState(false);\n    const [syncingReservations, setSyncingReservations] = useState(false);\n    const [generatingPinForReservation, setGeneratingPinForReservation] = useState<number | null>(null);\n    const [selectedReservationForInvitation, setSelectedReservationForInvitation] = useState<Reservation | null>(null);\n    const [isSendInvitationSidepaneOpen, setIsSendInvitationSidepaneOpen] = useState(false);\n    const [selectedReservationForPasscode, setSelectedReservationForPasscode] = useState<Reservation | null>(null);\n    const [isSendPasscodeSidepaneOpen, setIsSendPasscodeSidepaneOpen] = useState(false);\n    \n    // Tour-Bookings States\n    const [tourBookings, setTourBookings] = useState<TourBooking[]>([]);\n    const [tourBookingsTotalCount, setTourBookingsTotalCount] = useState<number>(0); //  PAGINATION: Gesamtanzahl\n    const [tourBookingsHasMore, setTourBookingsHasMore] = useState<boolean>(true); //  PAGINATION: Gibt es noch weitere Items?\n    const [tourBookingsLoadingMore, setTourBookingsLoadingMore] = useState<boolean>(false); //  PAGINATION: Ldt weitere Items\n    const [tourBookingsLoading, setTourBookingsLoading] = useState(false);\n    const [tourBookingsError, setTourBookingsError] = useState<string | null>(null);\n    const [tourBookingsSearchTerm, setTourBookingsSearchTerm] = useState('');\n    const [selectedBookingForLink, setSelectedBookingForLink] = useState<TourBooking | null>(null);\n    const [isTourReservationLinkModalOpen, setIsTourReservationLinkModalOpen] = useState(false);\n    const [isCreateTourBookingModalOpen, setIsCreateTourBookingModalOpen] = useState(false);\n    const [isEditTourBookingModalOpen, setIsEditTourBookingModalOpen] = useState(false);\n    const [selectedBookingForEdit, setSelectedBookingForEdit] = useState<TourBooking | null>(null);\n    \n    // Reservations Filter States (analog zu Tasks)\n    const [reservationFilterConditions, setReservationFilterConditions] = useState<FilterCondition[]>([]);\n    const [reservationFilterLogicalOperators, setReservationFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [reservationFilterSortDirections, setReservationFilterSortDirections] = useState<Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>>([]);\n    const [reservationActiveFilterName, setReservationActiveFilterName] = useState<string>('');\n    const [reservationSelectedFilterId, setReservationSelectedFilterId] = useState<number | null>(null);\n    \n    // State fr erweiterte Filterbedingungen\n    const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n    const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [filterSortDirections, setFilterSortDirections] = useState<Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>>([]);\n    \n    // Filter State Management (Controlled Mode)\n    const [activeFilterName, setActiveFilterName] = useState<string>('');\n    const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n    \n    const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n    // Tabellen-Header-Sortierung (nur fr Tabellen-Ansicht)\n    const [tableSortConfig, setTableSortConfig] = useState<SortConfig>({ key: 'dueDate', direction: 'asc' });\n    // Tabellen-Header-Sortierung fr Reservations (nur fr Tabellen-Ansicht)\n    const [reservationTableSortConfig, setReservationTableSortConfig] = useState<ReservationSortConfig>({ key: 'checkInDate', direction: 'desc' });\n    const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n    const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n    const [selectedTask, setSelectedTask] = useState<Task | null>(null);\n    const [copiedTask, setCopiedTask] = useState<Task | null>(null);\n\n    //  MEMORY: Cleanup - Alle groen Arrays beim Unmount lschen\n    useEffect(() => {\n        return () => {\n            // Tasks\n            setTasks([]);\n            \n            // Reservations\n            setReservations([]);\n            \n            // Tour Bookings\n            setTourBookings([]);\n            \n            // Filter States (knnen auch gro sein)\n            setFilterConditions([]);\n            setReservationFilterConditions([]);\n        };\n    }, []); // Nur beim Unmount ausfhren\n\n    //  ENTFERNEN: allTasks wird nicht mehr bentigt (Pagination ldt nur bentigte Items)\n\n    //  ENTFERNEN: allTourBookings wird nicht mehr bentigt (Pagination ldt nur bentigte Items)\n\n    // Tabellen-Einstellungen laden - Tasks\n    const {\n        settings: tasksSettings,\n        isLoading: isLoadingTasksSettings,\n        updateColumnOrder: updateTasksColumnOrder,\n        updateHiddenColumns: updateTasksHiddenColumns,\n        toggleColumnVisibility: toggleTasksColumnVisibility,\n        isColumnVisible: isTasksColumnVisible,\n        updateViewMode: updateTasksViewMode\n    } = useTableSettings('worktracker_tasks', {\n        defaultColumnOrder,\n        defaultHiddenColumns: [],\n        defaultViewMode: 'cards'\n    });\n    \n    // Tabellen-Einstellungen laden - Reservations\n    const defaultReservationColumnOrder = ['guestName', 'status', 'paymentStatus', 'checkInDate', 'checkOutDate', 'roomNumber', 'branch', 'actions'];\n    const {\n        settings: reservationsSettings,\n        isLoading: isLoadingReservationsSettings,\n        updateColumnOrder: updateReservationsColumnOrder,\n        updateHiddenColumns: updateReservationsHiddenColumns,\n        toggleColumnVisibility: toggleReservationsColumnVisibility,\n        isColumnVisible: isReservationsColumnVisible,\n        updateViewMode: updateReservationsViewMode\n    } = useTableSettings('worktracker-reservations', {\n        defaultColumnOrder: defaultReservationColumnOrder,\n        defaultHiddenColumns: [],\n        defaultViewMode: 'cards'\n    });\n    \n    // Dynamische Settings basierend auf activeTab\n    const settings = activeTab === 'todos' ? tasksSettings : reservationsSettings;\n    const isLoadingSettings = activeTab === 'todos' ? isLoadingTasksSettings : isLoadingReservationsSettings;\n    const updateColumnOrder = activeTab === 'todos' ? updateTasksColumnOrder : updateReservationsColumnOrder;\n    const updateHiddenColumns = activeTab === 'todos' ? updateTasksHiddenColumns : updateReservationsHiddenColumns;\n    const toggleColumnVisibility = activeTab === 'todos' ? toggleTasksColumnVisibility : toggleReservationsColumnVisibility;\n    const isColumnVisible = activeTab === 'todos' ? isTasksColumnVisible : isReservationsColumnVisible;\n    const updateViewMode = activeTab === 'todos' ? updateTasksViewMode : updateReservationsViewMode;\n\n    const [draggedColumn, setDraggedColumn] = useState<string | null>(null);\n    const [dragOverColumn, setDragOverColumn] = useState<string | null>(null);\n\n    // Expand/Collapse States fr Reservations (analog zu MonthlyReports)\n    const [expandedReservationRows, setExpandedReservationRows] = useState<Set<number>>(new Set());\n\n    // View-Mode aus Settings laden\n    const viewMode = settings.viewMode || 'cards';\n\n    // CSS-Klasse fr Container-Box setzen (fr CSS-basierte Schattierungs-Entfernung)\n    //  FIX: Nach viewMode-Deklaration verschoben (verhindert \"Cannot access 'fr' before initialization\")\n    useEffect(() => {\n        const wrappers = document.querySelectorAll('.dashboard-tasks-wrapper');\n        wrappers.forEach(wrapper => {\n            if (viewMode === 'cards') {\n                wrapper.classList.add('cards-mode');\n            } else {\n                wrapper.classList.remove('cards-mode');\n            }\n        });\n    }, [viewMode]);\n\n    // Abgeleitete Werte fr Card-Ansicht aus Tabellen-Settings\n    // Card-Metadaten-Reihenfolge aus columnOrder ableiten\n    const cardMetadataOrder = useMemo(() => {\n        if (activeTab === 'todos') {\n            return getCardMetadataFromColumnOrder(settings.columnOrder || defaultColumnOrder);\n        } else {\n            return getReservationCardMetadataFromColumnOrder(settings.columnOrder || defaultReservationColumnOrder);\n        }\n    }, [settings.columnOrder, activeTab]);\n\n    // Versteckte Card-Metadaten aus hiddenColumns ableiten\n    const hiddenCardMetadata = useMemo(() => {\n        if (activeTab === 'todos') {\n            return getHiddenCardMetadata(settings.hiddenColumns || []);\n        } else {\n            return getReservationHiddenCardMetadata(settings.hiddenColumns || []);\n        }\n    }, [settings.hiddenColumns, activeTab]);\n\n    // Sichtbare Card-Metadaten (alle Card-Metadaten minus versteckte)\n    const visibleCardMetadata = useMemo(() => {\n        return new Set(cardMetadataOrder.filter(meta => !hiddenCardMetadata.has(meta)));\n    }, [cardMetadataOrder, hiddenCardMetadata]);\n\n    // Lokale Sortierrichtungen fr Tasks Cards (nicht persistiert)\n    const [taskCardSortDirections, setTaskCardSortDirections] = useState<Record<string, 'asc' | 'desc'>>(() => {\n        return defaultCardSortDirections;\n    });\n\n    // Handler fr Sortierrichtung-nderung bei Tasks\n    const handleTaskCardSortDirectionChange = (columnId: string, direction: 'asc' | 'desc') => {\n        setTaskCardSortDirections(prev => ({\n            ...prev,\n            [columnId]: direction\n        }));\n    };\n\n    // Lokale Sortierrichtungen fr Reservations Cards (nicht persistiert)\n    const [reservationCardSortDirections, setReservationCardSortDirections] = useState<Record<string, 'asc' | 'desc'>>(() => {\n        return defaultReservationCardSortDirections;\n    });\n\n    // Handler fr Sortierrichtung-nderung bei Reservations\n    const handleReservationCardSortDirectionChange = (columnId: string, direction: 'asc' | 'desc') => {\n        setReservationCardSortDirections(prev => ({\n            ...prev,\n            [columnId]: direction\n        }));\n    };\n\n\n    // Toggle-Funktion fr Expand/Collapse bei Reservations\n    const toggleReservationExpanded = (reservationId: number) => {\n        setExpandedReservationRows(prev => {\n            const newSet = new Set(prev);\n            if (newSet.has(reservationId)) {\n                newSet.delete(reservationId);\n            } else {\n                newSet.add(reservationId);\n            }\n            return newSet;\n        });\n    };\n\n    // Ref um sicherzustellen, dass loadTasks nur einmal beim Mount aufgerufen wird\n    // (auch bei React.StrictMode doppelter Ausfhrung)\n    const hasLoadedRef = useRef(false);\n\n    //  PAGINATION: loadTasks mit Pagination\n    const loadTasks = useCallback(async (\n        filterId?: number, \n        filterConditions?: any[], \n        append = false, //  PAGINATION: Items anhngen statt ersetzen\n        limit = 20,\n        offset = 0\n    ) => {\n        try {\n            if (!append) {\n                setLoading(true);\n            } else {\n                setTasksLoadingMore(true);\n            }\n            \n            //  PAGINATION: limit/offset Parameter\n            const params: any = {\n                limit: limit,\n                offset: offset,\n                includeAttachments: 'false' //  PERFORMANCE: Attachments optional - nur laden wenn bentigt\n            };\n            if (filterId) {\n                params.filterId = filterId;\n            } else if (filterConditions && filterConditions.length > 0) {\n                params.filterConditions = JSON.stringify({\n                    conditions: filterConditions,\n                    operators: filterLogicalOperators\n                });\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.TASKS.BASE, { params });\n            const responseData = response.data;\n            \n            //  DEBUG: Log Response-Struktur\n            console.log('[Worktracker Tasks] Response-Struktur:', {\n                isObject: typeof responseData === 'object',\n                hasData: responseData?.data !== undefined,\n                dataIsArray: Array.isArray(responseData?.data),\n                responseDataIsArray: Array.isArray(responseData),\n                keys: responseData ? Object.keys(responseData) : [],\n                dataType: responseData?.data ? typeof responseData.data : 'undefined'\n            });\n            \n            //  PAGINATION: Response-Struktur mit totalCount\n            // Sicherstellen, dass tasksData immer ein Array ist\n            let tasksData: Task[] = [];\n            let totalCount = 0;\n            let hasMore = false;\n            \n            if (responseData && typeof responseData === 'object') {\n                // Neue Response-Struktur: { data: [...], totalCount: ..., hasMore: ... }\n                if (Array.isArray(responseData.data)) {\n                    tasksData = responseData.data;\n                    totalCount = responseData.totalCount || tasksData.length;\n                    hasMore = responseData.hasMore !== undefined \n                        ? responseData.hasMore \n                        : (offset + tasksData.length < totalCount);\n                } else if (Array.isArray(responseData)) {\n                    // Fallback: Alte Response-Struktur (direktes Array)\n                    tasksData = responseData;\n                    totalCount = tasksData.length;\n                    hasMore = false;\n                } else {\n                    //  FEHLER: responseData ist ein Objekt, aber data ist kein Array\n                    console.error('[Worktracker Tasks]  FEHLER: responseData.data ist kein Array!', {\n                        responseData,\n                        data: responseData.data,\n                        dataType: typeof responseData.data\n                    });\n                    throw new Error(`Ungltige Response-Struktur: responseData.data ist kein Array (Typ: ${typeof responseData.data})`);\n                }\n            } else {\n                //  FEHLER: responseData ist kein Objekt\n                console.error('[Worktracker Tasks]  FEHLER: responseData ist kein Objekt!', {\n                    responseData,\n                    type: typeof responseData\n                });\n                throw new Error(`Ungltige Response-Struktur: responseData ist kein Objekt (Typ: ${typeof responseData})`);\n            }\n            \n            //  Sicherheitsprfung: tasksData muss ein Array sein\n            if (!Array.isArray(tasksData)) {\n                console.error('[Worktracker Tasks]  FEHLER: tasksData ist kein Array!', {\n                    tasksData,\n                    type: typeof tasksData\n                });\n                throw new Error(`Ungltige Response-Struktur: tasksData ist kein Array (Typ: ${typeof tasksData})`);\n            }\n            \n            // Attachments sind bereits in der Response enthalten\n            // URL-Generierung fr Attachments hinzufgen\n            const tasksWithAttachments = tasksData\n                .filter((task: Task) => task != null)\n                .map((task: Task) => {\n                    const attachments = (task.attachments || [])\n                        .filter((att: any) => att != null)\n                        .map((att: any) => ({\n                            id: att.id,\n                            fileName: att.fileName,\n                            fileType: att.fileType,\n                            fileSize: att.fileSize,\n                            filePath: att.filePath,\n                            uploadedAt: att.uploadedAt,\n                            url: getTaskAttachmentUrl(task.id, att.id)\n                        }));\n                    \n                    return {\n                        ...task,\n                        attachments: attachments\n                    };\n                });\n            \n            if (append) {\n                //  PAGINATION: Items anhngen (Infinite Scroll)\n                setTasks(prev => [...prev, ...tasksWithAttachments]);\n            } else {\n                //  PAGINATION: Items ersetzen (Initial oder Filter-Change)\n                setTasks(tasksWithAttachments);\n            }\n            \n            setTasksTotalCount(totalCount);\n            setTasksHasMore(hasMore);\n            setError(null);\n        } catch (error) {\n            console.error('[Worktracker Tasks] Fehler beim Laden:', error);\n            const axiosError = error as any;\n            if (!append) {\n                // Zeige detaillierte Fehlermeldung\n                const errorMessage = axiosError.response?.data?.message \n                    || axiosError.response?.data?.error \n                    || axiosError.message \n                    || t('worktime.messages.tasksLoadError');\n                console.error('[Worktracker Tasks] Error Details:', {\n                    message: errorMessage,\n                    status: axiosError.response?.status,\n                    data: axiosError.response?.data\n                });\n                setError(errorMessage);\n            }\n        } finally {\n            if (!append) {\n                setLoading(false);\n            } else {\n                setTasksLoadingMore(false);\n            }\n        }\n    }, [filterLogicalOperators, t]);\n    \n    //  loadMoreTasks entfernt - nicht mehr ntig (Infinite Scroll nur fr Anzeige)\n\n    //  KRITISCH: useCallback fr Stabilitt in useEffect Dependencies - MUSS VOR useEffect sein, der es verwendet\n    const applyFilterConditions = useCallback(async (conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections?: Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>) => {\n        setFilterConditions(conditions);\n        setFilterLogicalOperators(operators);\n        if (sortDirections !== undefined) {\n            // Sicherstellen, dass sortDirections ein Array ist\n            const validSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n            setFilterSortDirections(validSortDirections);\n        }\n        \n        //  FIX: Lade Daten mit Filter (server-seitig)\n        setSelectedFilterId(null); // Kein gespeicherter Filter, nur direkte Bedingungen\n        setActiveFilterName(''); // Kein Filter-Name\n        setTableSortConfig({ key: 'dueDate', direction: 'asc' }); // Reset Sortierung\n        \n        if (conditions.length > 0) {\n            await loadTasks(undefined, conditions, false, 20, 0); //  PAGINATION: limit=20, offset=0\n        } else {\n            await loadTasks(undefined, undefined, false, 20, 0); //  PAGINATION: Kein Filter\n        }\n    }, [loadTasks]); //  loadTasks als Dependency\n\n    //  PAGINATION: loadReservations mit Pagination - useCallback fr Stabilitt\n    //  KRITISCH: MUSS VOR applyReservationFilterConditions definiert werden (wird dort verwendet)\n    const loadReservations = useCallback(async (\n        filterId?: number, \n        filterConditions?: any[],\n        append = false, //  PAGINATION: Items anhngen statt ersetzen\n        limit = 20,\n        offset = 0\n    ) => {\n        try {\n            if (!append) {\n            setReservationsLoading(true);\n            } else {\n                setReservationsLoadingMore(true);\n            }\n            setReservationsError(null);\n            \n            //  PAGINATION: limit/offset Parameter\n            const params: any = {\n                limit: limit,\n                offset: offset\n            };\n            if (filterId) {\n                params.filterId = filterId;\n            } else if (filterConditions && filterConditions.length > 0) {\n                params.filterConditions = JSON.stringify({\n                    conditions: filterConditions,\n                    operators: reservationFilterLogicalOperators\n                });\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.RESERVATION.BASE, { params });\n            const responseData = response.data;\n            \n            //  PAGINATION: Response-Struktur mit totalCount\n            // Sicherstellen, dass reservationsData immer ein Array ist\n            let reservationsData: Reservation[] = [];\n            let totalCount = 0;\n            let hasMore = false;\n            \n            if (responseData && typeof responseData === 'object') {\n                // Neue Response-Struktur: { success: true, data: [...], totalCount: ..., hasMore: ... }\n                if (responseData.success && Array.isArray(responseData.data)) {\n                    reservationsData = responseData.data;\n                    totalCount = responseData.totalCount || reservationsData.length;\n                    hasMore = responseData.hasMore !== undefined \n                        ? responseData.hasMore \n                        : (offset + reservationsData.length < totalCount);\n                } else if (Array.isArray(responseData.data)) {\n                    // Fallback: { data: [...] } ohne success\n                    reservationsData = responseData.data;\n                    totalCount = responseData.totalCount || reservationsData.length;\n                    hasMore = responseData.hasMore !== undefined \n                        ? responseData.hasMore \n                        : (offset + reservationsData.length < totalCount);\n                } else if (Array.isArray(responseData)) {\n                    // Fallback: Alte Response-Struktur (direktes Array)\n                    reservationsData = responseData;\n                    totalCount = reservationsData.length;\n                    hasMore = false;\n                }\n            }\n            \n            if (append) {\n                //  PAGINATION: Items anhngen (Infinite Scroll)\n                setReservations(prev => [...prev, ...reservationsData]);\n            } else {\n                //  PAGINATION: Items ersetzen (Initial oder Filter-Change)\n            setReservations(reservationsData);\n            }\n            \n            setReservationsTotalCount(totalCount);\n            setReservationsHasMore(hasMore);\n        } catch (err: any) {\n            if (process.env.NODE_ENV === 'development') {\n            console.error('Fehler beim Laden der Reservations:', err);\n            }\n            const errorMessage = err.response?.data?.message || t('reservations.loadError', 'Fehler beim Laden der Reservations');\n            if (!append) {\n            setReservationsError(errorMessage);\n            showMessage(errorMessage, 'error');\n            }\n        } finally {\n            if (!append) {\n            setReservationsLoading(false);\n            } else {\n                setReservationsLoadingMore(false);\n            }\n        }\n    }, [reservationFilterLogicalOperators, t]);\n\n    //  KRITISCH: useCallback fr Stabilitt - MUSS VOR useEffect sein, der es verwendet\n    const applyReservationFilterConditions = useCallback(async (conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections?: Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>) => {\n        setReservationFilterConditions(conditions);\n        setReservationFilterLogicalOperators(operators);\n        if (sortDirections !== undefined) {\n            const validSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n            setReservationFilterSortDirections(validSortDirections);\n        }\n        \n        //  FIX: Lade Daten mit Filter (server-seitig)\n        setReservationSelectedFilterId(null); // Kein gespeicherter Filter, nur direkte Bedingungen\n        setReservationActiveFilterName(''); // Kein Filter-Name\n        setReservationTableSortConfig({ key: 'checkInDate', direction: 'desc' }); // Reset Sortierung\n        \n        if (conditions.length > 0) {\n            await loadReservations(undefined, conditions, false, 20, 0); //  PAGINATION: limit=20, offset=0\n        } else {\n            await loadReservations(undefined, undefined, false, 20, 0); //  PAGINATION: Kein Filter\n        }\n    }, [loadReservations]); //  loadReservations als Dependency\n\n    //  KRITISCH: handleFilterChange MUSS NACH applyReservationFilterConditions definiert werden\n    const handleFilterChange = useCallback(async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections?: Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>) => {\n        if (activeTab === 'todos') {\n            //  FIX: Prfung entfernt - Filter-Tag-Klick soll immer Daten neu laden\n            //  Endlosschleife wird durch defaultFilterAppliedRef in SavedFilterTags verhindert\n            setActiveFilterName(name);\n            setSelectedFilterId(id);\n            setTableSortConfig({ key: 'dueDate', direction: 'asc' });\n            \n            //  FIX: Wenn id gesetzt ist (gespeicherter Filter), lade mit id\n            //  Sonst: Setze nur State (applyFilterConditions wrde doppelt laden)\n            if (id) {\n                // Gespeicherter Filter: Setze State und lade mit id\n                setFilterConditions(conditions);\n                setFilterLogicalOperators(operators);\n                if (sortDirections !== undefined) {\n                    const validSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n                    setFilterSortDirections(validSortDirections);\n                }\n                await loadTasks(id, undefined, false, 20, 0); //  PAGINATION: limit=20, offset=0\n            } else {\n                // Direkte Bedingungen: applyFilterConditions ldt bereits\n                await applyFilterConditions(conditions, operators, sortDirections);\n            }\n        } else if (activeTab === 'reservations') {\n            //  FIX: Prfung entfernt - Filter-Tag-Klick soll immer Daten neu laden\n            //  Endlosschleife wird durch defaultFilterAppliedRef in SavedFilterTags verhindert\n            setReservationActiveFilterName(name);\n            setReservationSelectedFilterId(id);\n            setReservationTableSortConfig({ key: 'checkInDate', direction: 'desc' });\n            \n            //  FIX: Wenn id gesetzt ist (gespeicherter Filter), lade mit id\n            //  Sonst: Setze nur State (applyReservationFilterConditions wrde doppelt laden)\n            if (id) {\n                // Gespeicherter Filter: Setze State und lade mit id\n                setReservationFilterConditions(conditions);\n                setReservationFilterLogicalOperators(operators);\n                if (sortDirections !== undefined) {\n                    const validSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n                    setReservationFilterSortDirections(validSortDirections);\n                }\n                await loadReservations(id, undefined, false, 20, 0); //  PAGINATION: limit=20, offset=0\n            } else {\n                // Direkte Bedingungen: applyReservationFilterConditions ldt bereits\n                await applyReservationFilterConditions(conditions, operators, sortDirections);\n            }\n        }\n    }, [activeTab, applyFilterConditions, loadTasks, loadReservations, applyReservationFilterConditions]);\n\n    //  KRITISCH: handleReservationFilterChange MUSS NACH applyReservationFilterConditions definiert werden\n    const handleReservationFilterChange = useCallback(async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections?: Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>) => {\n        //  FIX: Prfung entfernt - Filter-Tag-Klick soll immer Daten neu laden\n        //  Endlosschleife wird durch defaultFilterAppliedRef in SavedFilterTags verhindert\n        setReservationActiveFilterName(name);\n        setReservationSelectedFilterId(id);\n        setReservationTableSortConfig({ key: 'checkInDate', direction: 'desc' });\n        \n        //  FIX: Wenn id gesetzt ist (gespeicherter Filter), lade mit id\n        //  Sonst: Setze nur State (applyReservationFilterConditions wrde doppelt laden)\n        if (id) {\n            // Gespeicherter Filter: Setze State und lade mit id\n            setReservationFilterConditions(conditions);\n            setReservationFilterLogicalOperators(operators);\n            if (sortDirections !== undefined) {\n                const validSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n                setReservationFilterSortDirections(validSortDirections);\n            }\n            await loadReservations(id, undefined, false, 20, 0); //  PAGINATION: limit=20, offset=0\n        } else {\n            // Direkte Bedingungen: applyReservationFilterConditions ldt bereits\n            await applyReservationFilterConditions(conditions, operators, sortDirections);\n        }\n    }, [applyReservationFilterConditions, loadReservations]);\n\n    const handleGeneratePinAndSend = async (reservationId: number) => {\n        try {\n            setGeneratingPinForReservation(reservationId);\n            await reservationService.generatePinAndSend(reservationId);\n            showMessage(t('reservations.pinGeneratedAndSent', 'PIN-Code generiert und Mitteilung versendet'), 'success');\n            await loadReservations(undefined, undefined, false, 20, 0); //  PAGINATION: Aktualisiere Liste\n        } catch (error: any) {\n            if (process.env.NODE_ENV === 'development') {\n            console.error('Fehler beim Generieren des PIN-Codes und Versenden der Mitteilung:', error);\n            }\n            showMessage(\n                error.response?.data?.message || t('reservations.pinGenerateError', 'Fehler beim Generieren des PIN-Codes und Versenden der Mitteilung'),\n                'error'\n            );\n        } finally {\n            setGeneratingPinForReservation(null);\n        }\n    };\n\n    //  Initialer Filter-Load fr Reservations - DEAKTIVIERT, da SavedFilterTags den Default-Filter bereits anwendet\n    //  SavedFilterTags wendet den Default-Filter automatisch an, daher ist dieser useEffect nicht ntig\n    // useEffect(() => {\n    //     // SavedFilterTags bernimmt die Anwendung des Default-Filters\n    // }, [activeTab]);\n    \n    // Infinite Scroll Handler fr Tasks\n    //  PERFORMANCE: filterConditions als useRef verwenden (verhindert Re-Render-Loops)\n    const filterConditionsRef = useRef(filterConditions);\n    useEffect(() => {\n        filterConditionsRef.current = filterConditions;\n    }, [filterConditions]);\n    \n    //  PAGINATION: Infinite Scroll mit Intersection Observer\n    const tasksLoadMoreRef = useRef<HTMLDivElement>(null);\n    const reservationsLoadMoreRef = useRef<HTMLDivElement>(null);\n    const tourBookingsLoadMoreRef = useRef<HTMLDivElement>(null);\n    \n    // Funktion zum Laden der Tour-Buchungen\n    //  PAGINATION: loadTourBookings mit Pagination\n    const loadTourBookings = async (\n        append = false, //  PAGINATION: Items anhngen statt ersetzen\n        limit = 20,\n        offset = 0\n    ) => {\n        try {\n            if (!append) {\n                setTourBookingsLoading(true);\n            } else {\n                setTourBookingsLoadingMore(true);\n            }\n            setTourBookingsError(null);\n            \n            //  PAGINATION: limit/offset Parameter\n            const params: any = {\n                limit: limit,\n                offset: offset\n            };\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.TOUR_BOOKINGS.BASE, { params });\n            const responseData = response.data;\n            \n            //  PAGINATION: Response-Struktur mit totalCount\n            // Sicherstellen, dass bookingsData immer ein Array ist\n            let bookingsData: TourBooking[] = [];\n            let totalCount = 0;\n            let hasMore = false;\n            \n            if (responseData && typeof responseData === 'object') {\n                // Neue Response-Struktur: { success: true, data: [...], totalCount: ..., hasMore: ... }\n                if (responseData.success && Array.isArray(responseData.data)) {\n                    bookingsData = responseData.data;\n                    totalCount = responseData.totalCount || bookingsData.length;\n                    hasMore = responseData.hasMore !== undefined \n                        ? responseData.hasMore \n                        : (offset + bookingsData.length < totalCount);\n                } else if (Array.isArray(responseData.data)) {\n                    // Fallback: { data: [...] } ohne success\n                    bookingsData = responseData.data;\n                    totalCount = responseData.totalCount || bookingsData.length;\n                    hasMore = responseData.hasMore !== undefined \n                        ? responseData.hasMore \n                        : (offset + bookingsData.length < totalCount);\n                } else if (Array.isArray(responseData)) {\n                    // Fallback: Alte Response-Struktur (direktes Array)\n                    bookingsData = responseData;\n                    totalCount = bookingsData.length;\n                    hasMore = false;\n                }\n            }\n            \n            if (append) {\n                //  PAGINATION: Items anhngen (Infinite Scroll)\n                setTourBookings(prev => [...prev, ...bookingsData]);\n            } else {\n                //  PAGINATION: Items ersetzen (Initial oder Filter-Change)\n                setTourBookings(bookingsData);\n            }\n            \n            setTourBookingsTotalCount(totalCount);\n            setTourBookingsHasMore(hasMore);\n        } catch (err: any) {\n            if (process.env.NODE_ENV === 'development') {\n            console.error('Fehler beim Laden der Tour-Buchungen:', err);\n            }\n            const errorMessage = err.response?.data?.message || t('tourBookings.loadError', 'Fehler beim Laden der Tour-Buchungen');\n            if (!append) {\n            setTourBookingsError(errorMessage);\n            showMessage(errorMessage, 'error');\n            }\n        } finally {\n            if (!append) {\n            setTourBookingsLoading(false);\n            } else {\n                setTourBookingsLoadingMore(false);\n            }\n        }\n    };\n    \n    //  Initialer Filter-Load fr Todos - DEAKTIVIERT, da SavedFilterTags den Default-Filter bereits anwendet\n    //  SavedFilterTags wendet den Default-Filter automatisch an, daher ist dieser useEffect nicht ntig\n    // useEffect(() => {\n    //     // SavedFilterTags bernimmt die Anwendung des Default-Filters\n    // }, [activeTab]);\n    \n    useEffect(() => {\n        if (activeTab === 'tourBookings' && hasPermission('tour_bookings', 'read', 'table')) {\n            loadTourBookings(false, 20, 0);\n        }\n    }, [activeTab]);\n\n    // URL-Parameter fr editTask verarbeiten\n    useEffect(() => {\n        if (tasks.length > 0) {\n            const queryParams = new URLSearchParams(location.search);\n            const editTaskId = queryParams.get('editTask');\n            \n            if (editTaskId) {\n                const taskId = parseInt(editTaskId, 10);\n                if (!isNaN(taskId)) {\n                    const task = tasks.find(t => t.id === taskId);\n                    if (task) {\n                        setSelectedTask(task);\n                        setIsEditModalOpen(true);\n                    }\n                }\n            }\n        }\n    }, [tasks, location.search]);\n\n    //  Standard-Filter werden jetzt im Seed erstellt, nicht mehr im Frontend\n\n    // getStatusColor und getStatusText werden jetzt von statusUtils verwendet (siehe getStatusLabel oben)\n\n    const handleStatusChange = async (taskId: number, newStatus: Task['status']) => {\n        try {\n            // Optimistisches Update: State sofort aktualisieren\n            setTasks(prevTasks => {\n                const validTasks = prevTasks.filter(task => task != null);\n                return validTasks.map(task => \n                    task.id === taskId ? { ...task, status: newStatus } : task\n                );\n            });\n\n            await axiosInstance.patch(API_ENDPOINTS.TASKS.BY_ID(taskId), { status: newStatus });\n            toast.success(t('worktime.messages.taskUpdated'));\n        } catch (error) {\n            // Rollback bei Fehler: Vollstndiges Reload\n            if (process.env.NODE_ENV === 'development') {\n            console.error('Fehler beim Aktualisieren des Status:', error);\n            }\n            loadTasks();\n                toast.error(t('worktime.messages.taskUpdatedError'));\n        }\n    };\n\n    const handleEditClick = (task: Task) => {\n        setSelectedTask(task);\n        setIsEditModalOpen(true);\n    };\n\n    const isResponsibleForTask = (task: Task) => {\n        if (task.responsible) {\n            return task.responsible.id === user?.id;\n        } else if (task.role) {\n            // Prfe, ob der Benutzer die angegebene Rolle hat\n            return user?.roles?.some(userRole => userRole.role?.id === task.role?.id) || false;\n        }\n        return false;\n    };\n\n    const isQualityControlForTask = (task: Task) => {\n        return task.qualityControl?.id === user?.id;\n    };\n\n    const handleSort = (key: SortConfig['key']) => {\n        // Nur fr Tabellen-Ansicht (Header-Sortierung)\n        if (viewMode === 'table') {\n            setTableSortConfig(current => ({\n                key,\n                direction: current.key === key && current.direction === 'asc' ? 'desc' : 'asc'\n            }));\n        }\n    };\n\n    const handleReservationSort = (key: ReservationSortConfig['key']) => {\n        // Nur fr Tabellen-Ansicht (Header-Sortierung)\n        if (viewMode === 'table' && activeTab === 'reservations') {\n            setReservationTableSortConfig(current => ({\n                key,\n                direction: current.key === key && current.direction === 'asc' ? 'desc' : 'asc'\n            }));\n        }\n    };\n\n\n    const renderStatusButtons = (task: Task): JSX.Element[] => {\n        const buttons: JSX.Element[] = [];\n        \n        // Prfe, ob der Benutzer Schreibberechtigungen fr Tasks hat\n        const canModifyTasks = hasPermission('tasks', 'write', 'table');\n        \n        if (!canModifyTasks) return buttons;\n        \n        // Zurck-Button (links)\n        if (task.status === 'in_progress' && isResponsibleForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"back\"\n                        onClick={() => handleStatusChange(task.id, 'open')}\n                        className=\"p-1.5 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600\"\n                    >\n                        <ArrowLeftIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.backToOpen')}\n                    </div>\n                </div>\n            );\n        } else if (task.status === 'quality_control' && isResponsibleForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"back\"\n                        onClick={() => handleStatusChange(task.id, 'in_progress')}\n                        className=\"p-1.5 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600\"\n                    >\n                        <ArrowLeftIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.backToInProgress')}\n                    </div>\n                </div>\n            );\n        } else if (task.status === 'done' && isQualityControlForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"back\"\n                        onClick={() => handleStatusChange(task.id, 'quality_control')}\n                        className=\"p-2 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600\"\n                    >\n                        <ArrowLeftIcon className=\"h-6 w-6\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.backToQualityControl')}\n                    </div>\n                </div>\n            );\n        }\n\n        // Weiter-Button (rechts)\n        if (task.status === 'open' && isResponsibleForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"forward\"\n                        onClick={() => handleStatusChange(task.id, 'in_progress')}\n                        className=\"p-1.5 bg-blue-600 dark:bg-blue-500 text-white rounded hover:bg-blue-700 dark:hover:bg-blue-600\"\n                    >\n                        <ArrowRightIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.setInProgress')}\n                    </div>\n                </div>\n            );\n        } else if (task.status === 'in_progress' && isResponsibleForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"forward\"\n                        onClick={() => handleStatusChange(task.id, 'quality_control')}\n                        className=\"p-1.5 bg-purple-600 dark:bg-purple-500 text-white rounded hover:bg-purple-700 dark:hover:bg-purple-600\"\n                    >\n                        <ArrowRightIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.setQualityControl')}\n                    </div>\n                </div>\n            );\n        } else if (task.status === 'quality_control' && isQualityControlForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"forward\"\n                        onClick={() => handleStatusChange(task.id, 'done')}\n                        className=\"p-1.5 bg-green-600 dark:bg-green-500 text-white rounded hover:bg-green-700 dark:hover:bg-green-600\"\n                    >\n                        <ArrowRightIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.markDone')}\n                    </div>\n                </div>\n            );\n        }\n\n        return buttons;\n    };\n\n    const getActiveFilterCount = () => {\n        if (activeTab === 'todos') {\n            return filterConditions.length;\n        } else if (activeTab === 'reservations') {\n            return reservationFilterConditions.length;\n        }\n        return 0;\n    };\n    \n    const resetFilterConditions = () => {\n        setFilterConditions([]);\n        setFilterLogicalOperators([]);\n        setFilterSortDirections([]);\n        setActiveFilterName('');\n        setSelectedFilterId(null);\n    };\n    \n    const resetReservationFilterConditions = () => {\n        setReservationFilterConditions([]);\n        setReservationFilterLogicalOperators([]);\n        setReservationFilterSortDirections([]);\n        setReservationActiveFilterName('');\n        setReservationSelectedFilterId(null);\n    };\n    \n\n    const getStatusPriority = (status: Task['status']): number => {\n        switch (status) {\n            case 'open': return 1;\n            case 'in_progress': return 2;\n            case 'improval': return 3;\n            case 'quality_control': return 4;\n            case 'done': return 5;\n            default: return 99; // Fallback fr unbekannte Status\n        }\n    };\n\n    // Status-Farben fr Reservations\n    const getReservationStatusColor = (status: ReservationStatus): string => {\n        switch (status) {\n            case ReservationStatus.CONFIRMED:\n                return 'bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200';\n            case ReservationStatus.NOTIFICATION_SENT:\n                return 'bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200';\n            case ReservationStatus.CHECKED_IN:\n                return 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200';\n            case ReservationStatus.CHECKED_OUT:\n                return 'bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200';\n            case ReservationStatus.CANCELLED:\n                return 'bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200';\n            case ReservationStatus.NO_SHOW:\n                return 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200';\n            default:\n                return 'bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200';\n        }\n    };\n\n    const getPaymentStatusColor = (status: PaymentStatus): string => {\n        switch (status) {\n            case PaymentStatus.PAID:\n                return 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200';\n            case PaymentStatus.PARTIALLY_PAID:\n                return 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200';\n            case PaymentStatus.REFUNDED:\n                return 'bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200';\n            case PaymentStatus.PENDING:\n            default:\n                return 'bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200';\n        }\n    };\n\n    const filteredAndSortedTasks = useMemo(() => {\n        //  FAKT: Wenn selectedFilterId gesetzt ist, wurden Tasks bereits server-seitig gefiltert\n        //  FAKT: Wenn filterConditions gesetzt sind (ohne selectedFilterId), wurden Tasks bereits server-seitig gefiltert\n        //  NUR searchTerm wird client-seitig gefiltert (nicht server-seitig)\n        //  PAGINATION: Verwende tasks (bereits server-seitig gefiltert und paginiert)\n        const tasksToFilter = tasks;\n        \n        if (process.env.NODE_ENV === 'development') {\n        console.log(' Filtere Tasks:', tasksToFilter.length, 'Tasks vorhanden');\n            //  PAGINATION: tasks werden server-seitig gefiltert und paginiert\n        }\n        \n        // Sicherstellen, dass keine undefined/null Werte im Array sind\n        const validTasks = tasksToFilter.filter(task => task != null);\n        const filtered = validTasks\n            .filter(task => {\n                //  NUR Globale Suchfunktion (searchTerm) wird client-seitig angewendet\n                if (searchTerm) {\n                    const searchLower = searchTerm.toLowerCase();\n                    const matchesSearch = \n                        task.title.toLowerCase().includes(searchLower) ||\n                        (task.description && task.description.toLowerCase().includes(searchLower)) ||\n                        (task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}`.toLowerCase().includes(searchLower) : false) ||\n                        (task.role ? task.role.name.toLowerCase().includes(searchLower) : false) ||\n                        (task.qualityControl && `${task.qualityControl.firstName} ${task.qualityControl.lastName}`.toLowerCase().includes(searchLower)) ||\n                        task.branch.name.toLowerCase().includes(searchLower);\n                    \n                    if (!matchesSearch) return false;\n                }\n                \n                //  ENTFERNEN: Client-seitige Filterung wenn selectedFilterId oder filterConditions gesetzt sind\n                //  Server hat bereits gefiltert, keine doppelte Filterung mehr\n                //  PAGINATION: Server hat bereits gefiltert, keine client-seitige Filterung mehr ntig\n                \n                return true;\n            });\n        \n        if (process.env.NODE_ENV === 'development') {\n            console.log(' Gefilterte Tasks:', filtered.length, 'von', tasks.length, 'Tasks');\n        }\n        \n        // Hilfsfunktion zum Extrahieren von Werten fr Sortierung\n        const getSortValue = (task: Task, columnId: string): any => {\n            switch (columnId) {\n                case 'title':\n                    return task.title.toLowerCase();\n                case 'status':\n                    return getStatusPriority(task.status);\n                case 'responsible':\n                case 'responsibleAndQualityControl':\n                    return task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}`.toLowerCase() : (task.role ? `Rolle: ${task.role.name}`.toLowerCase() : '');\n                case 'qualityControl':\n                    return task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}`.toLowerCase() : '';\n                case 'branch':\n                    return task.branch.name.toLowerCase();\n                case 'dueDate':\n                    return task.dueDate ? new Date(task.dueDate).getTime() : Number.MAX_SAFE_INTEGER;\n                case 'description':\n                    return (task.description || '').toLowerCase();\n                default:\n                    return '';\n            }\n        };\n        \n        const sorted = filtered.sort((a, b) => {\n            // 1. Prioritt: Table-Header-Sortierung (temporre berschreibung, auch wenn Filter aktiv)\n            if (viewMode === 'table' && tableSortConfig.key) {\n                const valueA = getSortValue(a, tableSortConfig.key);\n                const valueB = getSortValue(b, tableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    comparison = String(valueA).localeCompare(String(valueB));\n                }\n                \n                if (comparison !== 0) {\n                    return tableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 2. Prioritt: Filter-Sortierrichtungen (wenn Filter aktiv)\n            if (filterSortDirections.length > 0 && (selectedFilterId !== null || filterConditions.length > 0)) {\n                // Sortiere nach Prioritt (1, 2, 3, ...)\n                const sortedByPriority = [...filterSortDirections].sort((sd1, sd2) => sd1.priority - sd2.priority);\n                \n                for (const sortDir of sortedByPriority) {\n                    const valueA = getSortValue(a, sortDir.column);\n                    const valueB = getSortValue(b, sortDir.column);\n                    \n                    let comparison = 0;\n                    if (typeof valueA === 'number' && typeof valueB === 'number') {\n                        comparison = valueA - valueB;\n                    } else {\n                        comparison = String(valueA).localeCompare(String(valueB));\n                    }\n                    \n                    if (sortDir.direction === 'desc') {\n                        comparison = -comparison;\n                    }\n                    \n                    if (comparison !== 0) {\n                        return comparison;\n                    }\n                }\n                return 0;\n            }\n            \n            // 3. Prioritt: Cards-Mode Multi-Sortierung (wenn kein Filter aktiv, Cards-Mode)\n            if (viewMode === 'cards' && selectedFilterId === null && filterConditions.length === 0) {\n                const sortableColumns = cardMetadataOrder.filter(colId => visibleCardMetadata.has(colId));\n                \n                for (const columnId of sortableColumns) {\n                    const direction = taskCardSortDirections[columnId] || 'asc';\n                    const valueA = getSortValue(a, columnId);\n                    const valueB = getSortValue(b, columnId);\n                    \n                    let comparison = 0;\n                    if (typeof valueA === 'number' && typeof valueB === 'number') {\n                        comparison = valueA - valueB;\n                    } else {\n                        comparison = String(valueA).localeCompare(String(valueB));\n                    }\n                    \n                    if (direction === 'desc') {\n                        comparison = -comparison;\n                    }\n                    \n                    if (comparison !== 0) {\n                        return comparison;\n                    }\n                }\n                return 0;\n            }\n            \n            // 4. Prioritt: Tabellen-Mode Einzel-Sortierung (wenn kein Filter aktiv, Table-Mode)\n            if (viewMode === 'table' && selectedFilterId === null && filterConditions.length === 0 && tableSortConfig.key) {\n                const valueA = getSortValue(a, tableSortConfig.key);\n                const valueB = getSortValue(b, tableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    comparison = String(valueA).localeCompare(String(valueB));\n                }\n                \n                if (comparison !== 0) {\n                    return tableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 5. Fallback: Standardsortierung (wenn keine benutzerdefinierte Sortierung)\n            const aDate = a.dueDate ? new Date(a.dueDate).getTime() : Number.MAX_SAFE_INTEGER;\n            const bDate = b.dueDate ? new Date(b.dueDate).getTime() : Number.MAX_SAFE_INTEGER;\n            \n            if (aDate !== bDate) {\n                return aDate - bDate;\n            }\n            \n            const aStatusPrio = getStatusPriority(a.status);\n            const bStatusPrio = getStatusPriority(b.status);\n            \n            if (aStatusPrio !== bStatusPrio) {\n                return aStatusPrio - bStatusPrio;\n            }\n            \n            return a.title.localeCompare(b.title);\n        });\n        \n        if (process.env.NODE_ENV === 'development') {\n        console.log(' Gefilterte und sortierte Tasks:', sorted.length);\n        }\n        return sorted;\n    }, [tasks, selectedFilterId, searchTerm, tableSortConfig, getStatusPriority, filterSortDirections, viewMode, cardMetadataOrder, visibleCardMetadata, taskCardSortDirections]);\n\n    // Filter- und Sortierlogik fr Reservations\n    const filteredAndSortedReservations = useMemo(() => {\n        //  FAKT: Wenn reservationSelectedFilterId gesetzt ist, wurden Reservierungen bereits server-seitig gefiltert\n        //  FAKT: Wenn reservationFilterConditions gesetzt sind (ohne reservationSelectedFilterId), wurden Reservierungen bereits server-seitig gefiltert\n        //  NUR reservationSearchTerm, reservationFilterStatus, reservationFilterPaymentStatus werden client-seitig gefiltert\n        const validReservations = reservations.filter(reservation => reservation != null);\n        \n        let filtered = validReservations.filter(reservation => {\n            //  Status-Filter (client-seitig, nicht server-seitig)\n            if (reservationFilterStatus !== 'all' && reservation.status !== reservationFilterStatus) {\n                return false;\n            }\n            \n            //  Payment-Status-Filter (client-seitig, nicht server-seitig)\n            if (reservationFilterPaymentStatus !== 'all' && reservation.paymentStatus !== reservationFilterPaymentStatus) {\n                return false;\n            }\n            \n            //  Such-Filter (client-seitig, nicht server-seitig)\n            if (reservationSearchTerm) {\n                const searchLower = reservationSearchTerm.toLowerCase();\n                const matchesSearch = \n                    (reservation.guestName && reservation.guestName.toLowerCase().includes(searchLower)) ||\n                    (reservation.guestEmail && reservation.guestEmail.toLowerCase().includes(searchLower)) ||\n                    (reservation.guestPhone && reservation.guestPhone.toLowerCase().includes(searchLower)) ||\n                    (reservation.roomNumber && reservation.roomNumber.toLowerCase().includes(searchLower)) ||\n                    (reservation.lobbyReservationId && reservation.lobbyReservationId.toLowerCase().includes(searchLower));\n                \n                if (!matchesSearch) return false;\n            }\n            \n            return true;\n        });\n\n        //  ENTFERNEN: Erweiterte Filterbedingungen (reservationFilterConditions) werden NICHT mehr client-seitig angewendet\n        //  Server hat bereits gefiltert, keine doppelte Filterung mehr\n        if (false && reservationFilterConditions.length > 0) {\n            // Column-Evaluatoren fr Reservations (analog zu Tasks)\n            const columnEvaluators: any = {\n                'guestName': (reservation: Reservation, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const guestName = (reservation.guestName || '').toLowerCase();\n                    if (cond.operator === 'equals') return reservation.guestName === cond.value;\n                    if (cond.operator === 'contains') return guestName.includes(value);\n                    if (cond.operator === 'startsWith') return guestName.startsWith(value);\n                    if (cond.operator === 'endsWith') return guestName.endsWith(value);\n                    return null;\n                },\n                'status': (reservation: Reservation, cond: FilterCondition) => {\n                    if (cond.operator === 'equals') return reservation.status === cond.value;\n                    if (cond.operator === 'notEquals') return reservation.status !== cond.value;\n                    return null;\n                },\n                'paymentStatus': (reservation: Reservation, cond: FilterCondition) => {\n                    if (cond.operator === 'equals') return reservation.paymentStatus === cond.value;\n                    if (cond.operator === 'notEquals') return reservation.paymentStatus !== cond.value;\n                    return null;\n                },\n                'checkInDate': (reservation: Reservation, cond: FilterCondition) => {\n                    return evaluateDateCondition(reservation.checkInDate, cond);\n                },\n                'checkOutDate': (reservation: Reservation, cond: FilterCondition) => {\n                    return evaluateDateCondition(reservation.checkOutDate, cond);\n                },\n                'arrivalTime': (reservation: Reservation, cond: FilterCondition) => {\n                    return evaluateDateCondition(reservation.arrivalTime, cond);\n                },\n                'amount': (reservation: Reservation, cond: FilterCondition) => {\n                    const amount = typeof reservation.amount === 'string' \n                        ? parseFloat(reservation.amount) \n                        : (reservation.amount || 0);\n                    const compareValue = parseFloat(String(cond.value));\n                    if (isNaN(compareValue)) return false;\n                    if (cond.operator === 'equals') return Math.abs(amount - compareValue) < 0.01;\n                    if (cond.operator === 'greaterThan') return amount > compareValue;\n                    if (cond.operator === 'lessThan') return amount < compareValue;\n                    return null;\n                },\n                'roomNumber': (reservation: Reservation, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const roomNumber = (reservation.roomNumber || '').toLowerCase();\n                    if (cond.operator === 'equals') return reservation.roomNumber === cond.value;\n                    if (cond.operator === 'contains') return roomNumber.includes(value);\n                    if (cond.operator === 'startsWith') return roomNumber.startsWith(value);\n                    if (cond.operator === 'endsWith') return roomNumber.endsWith(value);\n                    return null;\n                },\n                'guestEmail': (reservation: Reservation, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const guestEmail = (reservation.guestEmail || '').toLowerCase();\n                    if (cond.operator === 'equals') return reservation.guestEmail === cond.value;\n                    if (cond.operator === 'contains') return guestEmail.includes(value);\n                    if (cond.operator === 'startsWith') return guestEmail.startsWith(value);\n                    if (cond.operator === 'endsWith') return guestEmail.endsWith(value);\n                    return null;\n                },\n                'guestPhone': (reservation: Reservation, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const guestPhone = (reservation.guestPhone || '').toLowerCase();\n                    if (cond.operator === 'equals') return reservation.guestPhone === cond.value;\n                    if (cond.operator === 'contains') return guestPhone.includes(value);\n                    if (cond.operator === 'startsWith') return guestPhone.startsWith(value);\n                    if (cond.operator === 'endsWith') return guestPhone.endsWith(value);\n                    return null;\n                },\n                'branch': (reservation: Reservation, cond: FilterCondition) => {\n                    const branchName = (reservation.branch?.name || '').toLowerCase();\n                    const value = (cond.value as string || '').toLowerCase();\n                    if (cond.operator === 'equals') return branchName === value;\n                    if (cond.operator === 'contains') return branchName.includes(value);\n                    return null;\n                },\n                'doorPin': (reservation: Reservation, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const doorPin = (reservation.doorPin || '').toLowerCase();\n                    if (cond.operator === 'equals') return reservation.doorPin === cond.value;\n                    if (cond.operator === 'contains') return doorPin.includes(value);\n                    if (cond.operator === 'startsWith') return doorPin.startsWith(value);\n                    if (cond.operator === 'endsWith') return doorPin.endsWith(value);\n                    return null;\n                },\n                'onlineCheckInCompleted': (reservation: Reservation, cond: FilterCondition) => {\n                    const value = cond.value === 'true' || cond.value === true || cond.value === '1';\n                    if (cond.operator === 'equals') return reservation.onlineCheckInCompleted === value;\n                    if (cond.operator === 'notEquals') return reservation.onlineCheckInCompleted !== value;\n                    return null;\n                }\n            };\n\n            const getFieldValue = (reservation: Reservation, columnId: string): any => {\n                switch (columnId) {\n                    case 'guestName': return reservation.guestName || '';\n                    case 'status': return reservation.status || '';\n                    case 'paymentStatus': return reservation.paymentStatus || '';\n                    case 'roomNumber': return reservation.roomNumber || '';\n                    case 'branch': return reservation.branch?.name || '';\n                    case 'guestEmail': return reservation.guestEmail || '';\n                    case 'guestPhone': return reservation.guestPhone || '';\n                    case 'lobbyReservationId': return reservation.lobbyReservationId || '';\n                    case 'checkInDate': return reservation.checkInDate;\n                    case 'checkOutDate': return reservation.checkOutDate;\n                    case 'amount': return reservation.amount;\n                    case 'arrivalTime': return reservation.arrivalTime;\n                    case 'doorPin': return reservation.doorPin || '';\n                    case 'onlineCheckInCompleted': return reservation.onlineCheckInCompleted;\n                    default: {\n                        const value = (reservation as any)[columnId];\n                        if (value == null) return '';\n                        if (typeof value === 'string') return value;\n                        if (typeof value === 'number') return String(value);\n                        if (typeof value === 'boolean') return String(value);\n                        return String(value);\n                    }\n                }\n            };\n\n            filtered = applyFilters(\n                filtered,\n                reservationFilterConditions,\n                reservationFilterLogicalOperators,\n                getFieldValue,\n                columnEvaluators\n            );\n        }\n        \n        // Hilfsfunktion zum Extrahieren von Werten fr Sortierung\n        const getReservationSortValue = (reservation: Reservation, columnId: string): any => {\n            switch (columnId) {\n                case 'guestName':\n                    return (reservation.guestName || '').toLowerCase();\n                case 'status':\n                    return reservation.status.toLowerCase();\n                case 'paymentStatus':\n                    return reservation.paymentStatus.toLowerCase();\n                case 'checkInDate':\n                    return reservation.checkInDate ? new Date(reservation.checkInDate).getTime() : 0;\n                case 'checkOutDate':\n                    return reservation.checkOutDate ? new Date(reservation.checkOutDate).getTime() : 0;\n                case 'roomNumber':\n                    return (reservation.roomNumber || '').toLowerCase();\n                case 'branch':\n                case 'branch.name':\n                    return (reservation.branch?.name || '').toLowerCase();\n                case 'guestEmail':\n                    return (reservation.guestEmail || '').toLowerCase();\n                case 'guestPhone':\n                    return (reservation.guestPhone || '').toLowerCase();\n                case 'amount':\n                    return typeof reservation.amount === 'string' ? parseFloat(reservation.amount) : (reservation.amount || 0);\n                case 'arrivalTime':\n                    return reservation.arrivalTime ? new Date(reservation.arrivalTime).getTime() : 0;\n                default:\n                    return '';\n            }\n        };\n        \n        // Sortierung basierend auf Prioritten\n        const sorted = filtered.sort((a, b) => {\n            // 1. Prioritt: Table-Header-Sortierung (temporre berschreibung, auch wenn Filter aktiv)\n            if (viewMode === 'table' && reservationTableSortConfig.key) {\n                const valueA = getReservationSortValue(a, reservationTableSortConfig.key);\n                const valueB = getReservationSortValue(b, reservationTableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    comparison = String(valueA).localeCompare(String(valueB));\n                }\n                \n                if (comparison !== 0) {\n                    return reservationTableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 2. Prioritt: Filter-Sortierrichtungen (wenn Filter aktiv)\n            if (reservationFilterSortDirections.length > 0 && (reservationSelectedFilterId !== null || reservationFilterConditions.length > 0)) {\n                // Sortiere nach Prioritt (1, 2, 3, ...)\n                const sortedByPriority = [...reservationFilterSortDirections].sort((sd1, sd2) => sd1.priority - sd2.priority);\n                \n                for (const sortDir of sortedByPriority) {\n                    const valueA = getReservationSortValue(a, sortDir.column);\n                    const valueB = getReservationSortValue(b, sortDir.column);\n                    \n                    let comparison = 0;\n                    if (typeof valueA === 'number' && typeof valueB === 'number') {\n                        comparison = valueA - valueB;\n                    } else {\n                        comparison = String(valueA).localeCompare(String(valueB));\n                    }\n                    \n                    if (sortDir.direction === 'desc') {\n                        comparison = -comparison;\n                    }\n                    \n                    if (comparison !== 0) {\n                        return comparison;\n                    }\n                }\n                return 0;\n            }\n            \n            // 3. Prioritt: Cards-Mode Multi-Sortierung (wenn kein Filter aktiv, Cards-Mode)\n            if (viewMode === 'cards' && reservationSelectedFilterId === null && reservationFilterConditions.length === 0) {\n                const sortableColumns = cardMetadataOrder.filter(colId => visibleCardMetadata.has(colId));\n                \n                for (const columnId of sortableColumns) {\n                    const direction = reservationCardSortDirections[columnId] || 'asc';\n                    const valueA = getReservationSortValue(a, columnId);\n                    const valueB = getReservationSortValue(b, columnId);\n                    \n                    let comparison = 0;\n                    if (typeof valueA === 'number' && typeof valueB === 'number') {\n                        comparison = valueA - valueB;\n                    } else {\n                        comparison = String(valueA).localeCompare(String(valueB));\n                    }\n                    \n                    if (direction === 'desc') {\n                        comparison = -comparison;\n                    }\n                    \n                    if (comparison !== 0) {\n                        return comparison;\n                    }\n                }\n                return 0;\n            }\n            \n            // 4. Prioritt: Tabellen-Mode Einzel-Sortierung (wenn kein Filter aktiv, Table-Mode)\n            if (viewMode === 'table' && reservationSelectedFilterId === null && reservationFilterConditions.length === 0 && reservationTableSortConfig.key) {\n                const valueA = getReservationSortValue(a, reservationTableSortConfig.key);\n                const valueB = getReservationSortValue(b, reservationTableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    comparison = String(valueA).localeCompare(String(valueB));\n                }\n                \n                if (comparison !== 0) {\n                    return reservationTableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 5. Fallback: Check-in-Datum (neueste zuerst)\n            return new Date(b.checkInDate).getTime() - new Date(a.checkInDate).getTime();\n        });\n        \n        if (process.env.NODE_ENV === 'development') {\n        console.log(' Gefilterte und sortierte Reservations:', sorted.length);\n        }\n        return sorted;\n    }, [reservations, reservationFilterStatus, reservationFilterPaymentStatus, reservationSearchTerm, reservationFilterSortDirections, viewMode, cardMetadataOrder, visibleCardMetadata, reservationCardSortDirections, reservationTableSortConfig]);\n    \n    //  PAGINATION: Infinite Scroll fr Tasks mit Intersection Observer\n    useEffect(() => {\n        if (activeTab !== 'todos') return;\n        \n        const observer = new IntersectionObserver(\n            (entries) => {\n                const firstEntry = entries[0];\n                if (firstEntry.isIntersecting && tasksHasMore && !tasksLoadingMore && !loading) {\n                    const nextOffset = tasks.length;\n                    loadTasks(\n                        selectedFilterId || undefined,\n                        filterConditions.length > 0 ? filterConditions : undefined,\n                        true, // append = true\n                        20, // limit\n                        nextOffset // offset\n                    );\n                }\n            },\n            { threshold: 0.1 }\n        );\n\n        if (tasksLoadMoreRef.current) {\n            observer.observe(tasksLoadMoreRef.current);\n        }\n\n        return () => {\n            if (tasksLoadMoreRef.current) {\n                observer.unobserve(tasksLoadMoreRef.current);\n            }\n        };\n    }, [activeTab, tasksHasMore, tasksLoadingMore, loading, tasks.length, selectedFilterId, filterConditions, loadTasks]);\n    \n    //  PAGINATION: Infinite Scroll fr Reservations mit Intersection Observer\n    useEffect(() => {\n        if (activeTab !== 'reservations') return;\n        \n        const observer = new IntersectionObserver(\n            (entries) => {\n                const firstEntry = entries[0];\n                if (firstEntry.isIntersecting && reservationsHasMore && !reservationsLoadingMore && !reservationsLoading) {\n                    const nextOffset = reservations.length;\n                    loadReservations(\n                        reservationSelectedFilterId || undefined,\n                        reservationFilterConditions.length > 0 ? reservationFilterConditions : undefined,\n                        true, // append = true\n                        20, // limit\n                        nextOffset // offset\n                    );\n                }\n            },\n            { threshold: 0.1 }\n        );\n\n        if (reservationsLoadMoreRef.current) {\n            observer.observe(reservationsLoadMoreRef.current);\n        }\n\n        return () => {\n            if (reservationsLoadMoreRef.current) {\n                observer.unobserve(reservationsLoadMoreRef.current);\n            }\n        };\n    }, [activeTab, reservationsHasMore, reservationsLoadingMore, reservationsLoading, reservations.length, reservationSelectedFilterId, reservationFilterConditions]);\n    \n    //  PAGINATION: Infinite Scroll fr Tour Bookings mit Intersection Observer\n    useEffect(() => {\n        if (activeTab !== 'tourBookings') return;\n        \n        const observer = new IntersectionObserver(\n            (entries) => {\n                const firstEntry = entries[0];\n                if (firstEntry.isIntersecting && tourBookingsHasMore && !tourBookingsLoadingMore && !tourBookingsLoading) {\n                    const nextOffset = tourBookings.length;\n                    loadTourBookings(\n                        true, // append = true\n                        20, // limit\n                        nextOffset // offset\n                    );\n                }\n            },\n            { threshold: 0.1 }\n        );\n\n        if (tourBookingsLoadMoreRef.current) {\n            observer.observe(tourBookingsLoadMoreRef.current);\n        }\n\n        return () => {\n            if (tourBookingsLoadMoreRef.current) {\n                observer.unobserve(tourBookingsLoadMoreRef.current);\n            }\n        };\n    }, [activeTab, tourBookingsHasMore, tourBookingsLoadingMore, tourBookingsLoading, tourBookings.length]);\n\n    // Handler fr das Verschieben von Spalten per Drag & Drop\n    const handleMoveColumn = (dragIndex: number, hoverIndex: number) => {\n        // Neue Spaltenreihenfolge erstellen\n        const newColumnOrder = [...settings.columnOrder];\n        const draggedColumn = newColumnOrder[dragIndex];\n        \n        // Spalten neu anordnen\n        newColumnOrder.splice(dragIndex, 1); // Entferne die gezogene Spalte\n        newColumnOrder.splice(hoverIndex, 0, draggedColumn); // Fge sie an der neuen Position ein\n        \n        // Aktualisiere die Spaltenreihenfolge\n        updateColumnOrder(newColumnOrder);\n    };\n\n    // Handler fr Drag & Drop direkt in der Tabelle\n    const handleDragStart = (columnId: string) => {\n        setDraggedColumn(columnId);\n    };\n\n    const handleDragOver = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n        if (draggedColumn && draggedColumn !== columnId) {\n            setDragOverColumn(columnId);\n        }\n    };\n\n    const handleDrop = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n        if (draggedColumn && draggedColumn !== columnId) {\n            const dragIndex = settings.columnOrder.indexOf(draggedColumn);\n            const hoverIndex = settings.columnOrder.indexOf(columnId);\n            \n            if (dragIndex > -1 && hoverIndex > -1) {\n                handleMoveColumn(dragIndex, hoverIndex);\n            }\n        }\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n\n    const handleDragEnd = () => {\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n\n    // Filtern und sortieren der Spalten gem den Benutzereinstellungen\n    // Sicherstellen, dass alle Spalten aus defaultColumnOrder in columnOrder enthalten sind\n    const completeColumnOrder = useMemo(() => {\n        const currentOrder = settings.columnOrder || [];\n        // Sicherstellen, dass keine undefined/null Werte im Array sind\n        const validOrder = currentOrder.filter(id => id != null && typeof id === 'string');\n        // Fehlende Spalten aus defaultColumnOrder hinzufgen (dynamisch basierend auf activeTab)\n        const defaultOrder = activeTab === 'todos' ? defaultColumnOrder : defaultReservationColumnOrder;\n        const missingColumns = defaultOrder.filter(id => !validOrder.includes(id));\n        return [...validOrder, ...missingColumns];\n    }, [settings.columnOrder, activeTab, defaultColumnOrder, defaultReservationColumnOrder]);\n\n    const visibleColumnIds = completeColumnOrder.filter(id => id != null && typeof id === 'string' && isColumnVisible(id));\n\n    // Funktion zum Kopieren eines Tasks\n    const handleCopyTask = async (task: Task) => {\n        try {\n            // Kopie des Tasks erstellen mit angepasstem Titel\n            const copiedTaskData = {\n                title: `${task.title}-Kopie`,\n                description: task.description,\n                status: 'open', // Immer als \"offen\" erstellen\n                responsibleId: task.responsible ? task.responsible.id : null,\n                roleId: task.role ? task.role.id : null,\n                qualityControlId: task.qualityControl?.id || null,\n                branchId: task.branch.id,\n                dueDate: task.dueDate\n            };\n\n            // Task erstellen\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.TASKS.BASE,\n                copiedTaskData\n            );\n\n            // Optimistisches Update: Neuen Task zur Liste hinzufgen statt vollstndigem Reload\n            setTasks(prevTasks => [response.data, ...prevTasks]);\n            \n            // Bearbeitungsmodal fr den kopierten Task ffnen\n            setSelectedTask(response.data);\n            setIsEditModalOpen(true);\n            \n        } catch (err) {\n            if (process.env.NODE_ENV === 'development') {\n            console.error('Fehler beim Kopieren des Tasks:', err);\n            }\n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleDeleteTask = async (taskId: number) => {\n        if (window.confirm(t('worktime.messages.taskDeleteConfirm'))) {\n            if (process.env.NODE_ENV === 'development') {\n            console.log(' Starte Lschung von Task:', taskId);\n            console.log(' Aktuelle Tasks vor Lschung:', tasks.length);\n            }\n            \n            // Optimistisches Update: Task sofort aus Liste entfernen fr sofortiges Feedback\n            // Sicherstellen, dass keine undefined/null Werte im Array bleiben\n            setTasks(prevTasks => {\n                const filtered = prevTasks.filter(task => task != null && task.id !== taskId);\n                if (process.env.NODE_ENV === 'development') {\n                console.log(' Tasks nach Filterung:', filtered.length, 'von', prevTasks.length);\n                }\n                return filtered;\n            });\n\n            try {\n                if (process.env.NODE_ENV === 'development') {\n                console.log(' Sende Delete-Request...');\n                }\n                await axiosInstance.delete(API_ENDPOINTS.TASKS.BY_ID(taskId));\n                if (process.env.NODE_ENV === 'development') {\n                console.log(' Delete erfolgreich');\n                }\n                // Erfolgs-Rckmeldung anzeigen\n                toast.success(t('worktime.messages.taskDeleted'));\n            } catch (error) {\n                // Rollback bei Fehler: Vollstndiges Reload\n                if (process.env.NODE_ENV === 'development') {\n                console.error(' Fehler beim Lschen der Aufgabe:', error);\n                }\n                loadTasks();\n                toast.error(t('worktime.messages.taskDeletedError'));\n            }\n        }\n    };\n\n    const handleSaveTask = async (task: Task) => {\n        try {\n            await axiosInstance.put(API_ENDPOINTS.TASKS.BY_ID(task.id), task);\n            // Aktualisiere die Aufgabenliste\n            loadTasks();\n            setIsEditModalOpen(false);\n            setSelectedTask(null);\n            toast.success(t('worktime.messages.taskUpdated'));\n        } catch (error) {\n            if (process.env.NODE_ENV === 'development') {\n            console.error('Fehler beim Speichern der Aufgabe:', error);\n            }\n                toast.error(t('worktime.messages.taskSaveError'));\n        }\n    };\n\n    return (\n        <div className=\"min-h-screen dark:bg-gray-900\">\n            <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\n                {/* Neu angeordnete UI-Elemente in einer Zeile */}\n                <div className=\"w-full mb-4\">\n                    {/* Auf mobilen Gerten wird diese Reihenfolge angezeigt - Tasks oben, Zeiterfassung unten */}\n                    <div className=\"block sm:hidden w-full\">\n                    {/* Tasks */}\n                        <div className=\"dashboard-tasks-wrapper bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 w-full mb-20\">\n                            <div className=\"flex items-center justify-between px-3 sm:px-4 md:px-6\">\n                                {/* Linke Seite: \"Neuer Task\"-Button */}\n                                <div className=\"flex items-center\">\n                                    {hasPermission('tasks', 'write', 'table') && (\n                                        <div className=\"relative group\">\n                                            <button \n                                                onClick={() => setIsCreateModalOpen(true)}\n                                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                                style={{ width: '30.19px', height: '30.19px' }}\n                                                aria-label={t('tasks.createTask')}\n                                            >\n                                                <PlusIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {t('tasks.createTask')}\n                                            </div>\n                                        </div>\n                                    )}\n                                </div>\n                                \n                                {/* Mitte: Tab-Navigation */}\n                                <div className=\"flex items-center\">\n                                    <nav className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden\">\n                                        <button\n                                            onClick={() => setActiveTab('todos')}\n                                            className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 flex items-center gap-1.5 ${\n                                                activeTab === 'todos'\n                                                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                            }`}\n                                        >\n                                            <CheckCircleIcon className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                                            {t('tasks.title', \"To Do's\")}\n                                        </button>\n                                        {hasPermission('reservations', 'read', 'table') && (\n                                            <button\n                                                onClick={() => setActiveTab('reservations')}\n                                                className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 flex items-center gap-1.5 ${\n                                                    activeTab === 'reservations'\n                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                }`}\n                                            >\n                                                <CalendarIcon className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                                                {t('reservations.title', 'Reservations')}\n                                            </button>\n                                        )}\n                                        {hasPermission('tour_bookings', 'read', 'table') && (\n                                            <button\n                                                onClick={() => setActiveTab('tourBookings')}\n                                                className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 flex items-center gap-1.5 ${\n                                                    activeTab === 'tourBookings'\n                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                }`}\n                                            >\n                                                <ClipboardDocumentListIcon className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                                                {t('tourBookings.title', 'Tour-Buchungen')}\n                                            </button>\n                                        )}\n                                    </nav>\n                                </div>\n                                \n                                {/* Rechte Seite: Suchfeld, Sync-Button (nur Reservations), Filter-Button, Status-Filter, Spalten-Konfiguration */}\n                                <div className=\"flex items-center gap-1.5\">\n                                    <input\n                                        type=\"text\"\n                                        placeholder={t('common.search') + '...'}\n                                        className=\"w-[120px] sm:w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                                        value={activeTab === 'todos' ? searchTerm : reservationSearchTerm}\n                                        onChange={(e) => {\n                                            if (activeTab === 'todos') {\n                                                setSearchTerm(e.target.value);\n                                            } else {\n                                                setReservationSearchTerm(e.target.value);\n                                            }\n                                        }}\n                                    />\n                                    \n                                    {/* Sync-Button fr Reservations */}\n                                    {activeTab === 'reservations' && (\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={async () => {\n                                                    try {\n                                                        setSyncingReservations(true);\n                                                        await axiosInstance.post(API_ENDPOINTS.RESERVATIONS.SYNC);\n                                                        showMessage(t('reservations.syncSuccess', 'Reservations erfolgreich synchronisiert'), 'success');\n                                                        await loadReservations(undefined, undefined, false, 20, 0); //  PAGINATION: limit=20, offset=0\n                                                    } catch (err: any) {\n                                                        if (process.env.NODE_ENV === 'development') {\n                                                        console.error('Fehler beim Synchronisieren:', err);\n                                                        }\n                                                        showMessage(\n                                                            err.response?.data?.message || t('reservations.syncError', 'Fehler beim Synchronisieren'),\n                                                            'error'\n                                                        );\n                                                    } finally {\n                                                        setSyncingReservations(false);\n                                                    }\n                                                }}\n                                                disabled={syncingReservations}\n                                                className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                                            >\n                                                <ArrowPathIcon className={`h-5 w-5 ${syncingReservations ? 'animate-spin' : ''}`} />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {syncingReservations ? t('reservations.syncing', 'Synchronisiere...') : t('reservations.sync', 'Synchronisieren')}\n                                            </div>\n                                        </div>\n                                    )}\n                                    \n                                    {/* View-Mode Toggle */}\n                                    <div className=\"relative group\">\n                                        <button\n                                            className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n                                                viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n                                            }`}\n                                            onClick={() => updateViewMode(viewMode === 'table' ? 'cards' : 'table')}\n                                        >\n                                            {viewMode === 'table' ? (\n                                                <Squares2X2Icon className=\"h-5 w-5\" />\n                                            ) : (\n                                                <TableCellsIcon className=\"h-5 w-5\" />\n                                            )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Filter-Button */}\n                                    <div className=\"relative group ml-1\">\n                                        <button\n                                            className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n                                            onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                                        >\n                                            <FunnelIcon className=\"h-5 w-5\" />\n                                            {getActiveFilterCount() > 0 && (\n                                                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                                    {getActiveFilterCount()}\n                                                </span>\n                                            )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {t('common.filter')}\n                                        </div>\n                                    </div>\n                                    \n                                    \n                                    {/* Spalten-Konfiguration */}\n                                    <div className=\"ml-1\">\n                                        <TableColumnConfig \n                                            columns={activeTab === 'todos'\n                                                ? (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'title', label: t('tasks.columns.title') },\n                                                        { id: 'status', label: t('tasks.columns.status') },\n                                                        { id: 'responsible', label: t('tasks.columns.responsible') },\n                                                        { id: 'qualityControl', label: t('tasks.columns.qualityControl') },\n                                                        { id: 'branch', label: t('tasks.columns.branch') },\n                                                        { id: 'dueDate', label: t('tasks.columns.dueDate') },\n                                                        { id: 'description', label: t('tasks.columns.description') }\n                                                    ]\n                                                    : availableColumns)\n                                                : activeTab === 'reservations'\n                                                ? (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'guestName', label: t('reservations.columns.guestName', 'Gast') },\n                                                        { id: 'status', label: t('reservations.columns.status', 'Status') },\n                                                        { id: 'paymentStatus', label: t('reservations.columns.paymentStatus', 'Zahlungsstatus') },\n                                                        { id: 'checkInDate', label: t('reservations.columns.checkInDate', 'Check-in') },\n                                                        { id: 'checkOutDate', label: t('reservations.columns.checkOutDate', 'Check-out') },\n                                                        { id: 'roomNumber', label: t('reservations.columns.roomNumber', 'Zimmer') },\n                                                        { id: 'guestEmail', label: t('reservations.columns.guestEmail', 'E-Mail') },\n                                                        { id: 'guestPhone', label: t('reservations.columns.guestPhone', 'Telefon') },\n                                                        { id: 'amount', label: t('reservations.columns.amount', 'Betrag') },\n                                                        { id: 'arrivalTime', label: t('reservations.columns.arrivalTime', 'Ankunftszeit') }\n                                                    ]\n                                                    : availableReservationColumns)\n                                                : []}\n                                            visibleColumns={viewMode === 'cards'\n                                                ? Array.from(visibleCardMetadata)\n                                                : visibleColumnIds}\n                                            columnOrder={viewMode === 'cards'\n                                                ? cardMetadataOrder\n                                                : settings.columnOrder}\n                                            onToggleColumnVisibility={(columnId) => {\n                                                if (viewMode === 'cards') {\n                                                    // Fr Cards: Mapping zurck zu Tabellen-Spalten\n                                                    const tableColumn = cardToTableMapping[columnId];\n                                                    if (tableColumn) {\n                                                        // Spezielle Logik fr responsibleAndQualityControl\n                                                        if (tableColumn === 'responsibleAndQualityControl') {\n                                                            // Prfe ob beide bereits ausgeblendet sind\n                                                            const otherCardMeta = columnId === 'responsible' ? 'qualityControl' : 'responsible';\n                                                            const otherHidden = hiddenCardMetadata.has(otherCardMeta);\n                                                            const currentlyHidden = settings.hiddenColumns.includes(tableColumn);\n                                                            \n                                                            if (currentlyHidden && !otherHidden) {\n                                                                // Eine der beiden wird wieder angezeigt, also responsibleAndQualityControl wieder anzeigen\n                                                                toggleColumnVisibility(tableColumn);\n                                                            } else if (!currentlyHidden && otherHidden) {\n                                                                // Die andere ist bereits ausgeblendet, also responsibleAndQualityControl ausblenden\n                                                                toggleColumnVisibility(tableColumn);\n                                                            } else if (!currentlyHidden) {\n                                                                // Erste wird ausgeblendet, responsibleAndQualityControl ausblenden\n                                                                toggleColumnVisibility(tableColumn);\n                                                            } else {\n                                                                // Beide sind ausgeblendet, eine wird wieder angezeigt\n                                                                toggleColumnVisibility(tableColumn);\n                                                            }\n                                                        } else {\n                                                            // Normale Spalte: direkt ein/ausblenden\n                                                            toggleColumnVisibility(tableColumn);\n                                                        }\n                                                    }\n                                                } else {\n                                                    toggleColumnVisibility(columnId);\n                                                }\n                                            }}\n                                            onMoveColumn={viewMode === 'cards'\n                                                ? (dragIndex: number, hoverIndex: number) => {\n                                                    const newCardOrder = [...cardMetadataOrder];\n                                                    const dragged = newCardOrder[dragIndex];\n                                                    newCardOrder.splice(dragIndex, 1);\n                                                    newCardOrder.splice(hoverIndex, 0, dragged);\n                                                    \n                                                    // Konvertiere zurck zu Tabellen-Spalten-Reihenfolge\n                                                    const newTableOrder: string[] = [];\n                                                    const usedTableColumns = new Set<string>();\n                                                    \n                                                    newCardOrder.forEach(cardMeta => {\n                                                        const tableCol = cardToTableMapping[cardMeta];\n                                                        if (tableCol && !usedTableColumns.has(tableCol)) {\n                                                            usedTableColumns.add(tableCol);\n                                                            newTableOrder.push(tableCol);\n                                                        }\n                                                    });\n                                                    \n                                                    // Fge fehlende Tabellen-Spalten hinzu\n                                                    availableColumns.forEach(col => {\n                                                        if (!newTableOrder.includes(col.id) && col.id !== 'actions') {\n                                                            newTableOrder.push(col.id);\n                                                        }\n                                                    });\n                                                    \n                                                    updateColumnOrder(newTableOrder);\n                                                }\n                                                : handleMoveColumn}\n                                            buttonTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                                            modalTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                                            sortDirections={viewMode === 'cards' && activeTab === 'todos'\n                                                ? taskCardSortDirections\n                                                : viewMode === 'cards' && activeTab === 'reservations' \n                                                ? reservationCardSortDirections \n                                                : undefined}\n                                            onSortDirectionChange={viewMode === 'cards' && activeTab === 'todos'\n                                                ? handleTaskCardSortDirectionChange\n                                                : viewMode === 'cards' && activeTab === 'reservations'\n                                                ? handleReservationCardSortDirectionChange\n                                                : undefined}\n                                            showSortDirection={viewMode === 'cards' && (activeTab === 'todos' || activeTab === 'reservations')}\n                                            onClose={() => {}}\n                                        />\n                                    </div>\n                                </div>\n                            </div>\n\n                            {/* Filter-Pane */}\n                            {isFilterModalOpen && (\n                                <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n                                    {activeTab === 'todos' ? (\n                                        <FilterPane\n                                            columns={[...availableColumns, ...filterOnlyColumns]}\n                                            onApply={applyFilterConditions}\n                                            onReset={resetFilterConditions}\n                                            savedConditions={filterConditions}\n                                            savedOperators={filterLogicalOperators}\n                                            savedSortDirections={filterSortDirections}\n                                            onSortDirectionsChange={setFilterSortDirections}\n                                            tableId={TODOS_TABLE_ID}\n                                        />\n                                    ) : (\n                                        <FilterPane\n                                            columns={[...availableReservationColumns, ...reservationFilterOnlyColumns]}\n                                            onApply={applyReservationFilterConditions}\n                                            onReset={resetReservationFilterConditions}\n                                            savedConditions={reservationFilterConditions}\n                                            savedOperators={reservationFilterLogicalOperators}\n                                            savedSortDirections={reservationFilterSortDirections}\n                                            onSortDirectionsChange={setReservationFilterSortDirections}\n                                            tableId={RESERVATIONS_TABLE_ID}\n                                        />\n                                    )}\n                                </div>\n                            )}\n\n                            {/* Gespeicherte Filter als Tags anzeigen */}\n                            {(\n                                <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n                                    <SavedFilterTags\n                                    tableId={activeTab === 'todos' ? TODOS_TABLE_ID : RESERVATIONS_TABLE_ID}\n                                    onSelectFilter={activeTab === 'todos' ? applyFilterConditions : applyReservationFilterConditions}\n                                    onReset={activeTab === 'todos' ? resetFilterConditions : resetReservationFilterConditions}\n                                    activeFilterName={activeTab === 'todos' ? activeFilterName : reservationActiveFilterName}\n                                    selectedFilterId={activeTab === 'todos' ? selectedFilterId : reservationSelectedFilterId}\n                                    onFilterChange={activeTab === 'todos' ? handleFilterChange : handleReservationFilterChange}\n                                    defaultFilterName={activeTab === 'todos' ? 'Aktuell' : 'Hoy'}\n                                />\n                                </div>\n                            )}\n                            \n                            {/* Tabelle oder Cards - nur aktiven Tab rendern */}\n                            {activeTab === 'todos' && viewMode === 'table' ? (\n                                /* Tabellen-Ansicht - Tasks */\n                                <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                        <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <tr>\n                                                {visibleColumnIds.map((columnId) => {\n                                                    const column = availableColumns.find(col => col.id === columnId);\n                                                    if (!column) return null;\n                                                    \n                                                    return (\n                                                        <th\n                                                            key={columnId}\n                                                            scope=\"col\"\n                                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                                            draggable={true}\n                                                            onDragStart={() => handleDragStart(columnId)}\n                                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                                            onDrop={(e) => handleDrop(e, columnId)}\n                                                            onDragEnd={handleDragEnd}\n                                                        >\n                                                            <div className=\"flex items-center\">\n                                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                                {columnId !== 'actions' && (\n                                                                    <button \n                                                                        onClick={() => handleSort(columnId as keyof Task)}\n                                                                        className=\"ml-1 focus:outline-none\"\n                                                                    >\n                                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                                    </button>\n                                                                )}\n                                                            </div>\n                                                        </th>\n                                                    );\n                                                })}\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                            {loading ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-4 text-center\">\n                                                        <div className=\"flex justify-center\">\n                                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : error ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-red-600 dark:text-red-400\">\n                                                        {error}\n                                                    </td>\n                                                </tr>\n                                            ) : filteredAndSortedTasks.length === 0 ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                                                        <div className=\"flex flex-col items-center justify-center gap-4\">\n                                                        <ClipboardDocumentListIcon className=\"h-10 w-10 text-gray-400 dark:text-gray-500\" />\n                                                        <div className=\"text-sm\">{t('tasks.noTasksFound')}</div>\n                                                    </div>\n                                                </td>\n                                            </tr>\n                                        ) : (\n                                            <>\n                                            {filteredAndSortedTasks.map(task => {\n                                            const expiryStatus = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                            const expiryColors = getExpiryColorClasses(expiryStatus);\n                                            \n                                            return (\n                                                <tr \n                                                    key={task.id} \n                                                    className={`hover:bg-gray-50 dark:hover:bg-gray-700 ${\n                                                        expiryStatus !== 'none' ? `${expiryColors.bgClass} ${expiryColors.borderClass} border-l-4` : ''\n                                                    }`}\n                                                >\n                                                    {visibleColumnIds.map(columnId => {\n                                                    switch (columnId) {\n                                                        case 'title':\n                                                            return (\n                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words flex items-center\">\n                                                                        {task.title}\n                                                                            {task.description && (\n                                                                                <div className=\"ml-2 relative group\">\n                                                                                    <button \n                                                                                        className=\"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        <InformationCircleIcon className=\"h-5 w-5\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('tasks.showDescription')}\n                                                                                    </div>\n                                                                                    <div className=\"absolute left-0 mt-2 p-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 shadow-lg rounded-md border border-gray-200 dark:border-gray-700 w-144 max-h-96 overflow-y-auto min-w-[36rem] z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                                                                        <MarkdownPreview content={task.description} showImagePreview={true} />\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'status':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(task.status, 'task')} dark:bg-opacity-30 status-col`}>\n                                                                            {task.status}\n                                                                        </span>\n                                                                    </td>\n                                                                );\n                                                            case 'responsibleAndQualityControl':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"flex flex-col\">\n                                                                            <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline\">{t('tasks.columns.responsible')}:</span>\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden\">{t('tasks.columns.responsible').substring(0, 3)}:</span><br />\n                                                                                {task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}` : task.role ? task.role.name : '-'}\n                                                                            </div>\n                                                                            <div className=\"text-sm text-gray-900 dark:text-gray-200 mt-1\">\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline\">{t('tasks.qualityControlLabel')}</span>\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden\">{t('tasks.columns.qualityControl').substring(0, 2)}:</span><br />\n                                                                                {task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}` : '-'}\n                                                                            </div>\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'branch':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"text-sm text-gray-900 dark:text-gray-200\">{task.branch.name}</div>\n                                                                    </td>\n                                                                );\n                                                            case 'dueDate':\n                                                                const expiryStatusForDate = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                                                const expiryColorsForDate = getExpiryColorClasses(expiryStatusForDate);\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className={`text-sm ${expiryStatusForDate !== 'none' ? expiryColorsForDate.textClass : 'text-gray-900 dark:text-gray-200'}`}>\n                                                                            {task.dueDate ? new Date(task.dueDate).toLocaleDateString() : '-'}\n                                                                            {expiryStatusForDate !== 'none' && (\n                                                                                <span className=\"ml-2 text-xs\"></span>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'actions':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"flex space-x-2 action-buttons\">\n                                                                            <div className=\"status-buttons\">\n                                                                                {renderStatusButtons(task)}\n                                                                            </div>\n                                                                            {hasPermission('tasks', 'write', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => {\n                                                                                            setSelectedTask(task);\n                                                                                            setIsEditModalOpen(true);\n                                                                                        }}\n                                                                                        className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                    >\n                                                                                        <PencilIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('common.edit')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                            {hasPermission('tasks', 'both', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => handleCopyTask(task)}\n                                                                                        className=\"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                                                                                    >\n                                                                                        <DocumentDuplicateIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('tasks.actions.copy')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                            {hasPermission('tasks', 'delete', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => handleDeleteTask(task.id)}\n                                                                                        className=\"p-1.5 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300\"\n                                                                                    >\n                                                                                        <TrashIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('common.delete')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            default:\n                                                                return null;\n                                                        }\n                                                    })}\n                                                    </tr>\n                                                );\n                                            })}\n                                            </>\n                                        )}\n                                    </tbody>\n                                </table>\n                            </div>\n                            ) : activeTab === 'todos' ? (\n                                /* Card-Ansicht - Tasks - ohne Box-Schattierung, Cards auf voller Breite */\n                                <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n                                    {/*  PERFORMANCE: Skeleton-Loading fr LCP-Element (sofort sichtbar, auch ohne Daten) */}\n                                    {loading && tasks.length === 0 ? (\n                                        <CardGrid>\n                                            {Array(3).fill(null).map((_, i) => (\n                                                <div key={`skeleton-${i}`} className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-3 sm:p-4 md:p-5 lg:p-6 shadow-sm\">\n                                                    <div className=\"space-y-4\">\n                                                        {/* LCP-Element: Titel-Skeleton */}\n                                                        <div className=\"flex items-center gap-2 mb-2\">\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-12\"></div>\n                                                            <div className=\"h-6 bg-gray-200 dark:bg-gray-700 rounded flex-1 min-w-0\"></div>\n                                                        </div>\n                                                        {/* Status-Skeleton */}\n                                                        <div className=\"h-6 bg-gray-200 dark:bg-gray-700 rounded w-24\"></div>\n                                                        {/* Metadaten-Skeleton */}\n                                                        <div className=\"space-y-2\">\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4\"></div>\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2\"></div>\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6\"></div>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            ))}\n                                        </CardGrid>\n                                    ) : error ? (\n                                        <div className=\"flex justify-center py-12 text-red-600 dark:text-red-400\">\n                                            {error}\n                                        </div>\n                                    ) : filteredAndSortedTasks.length === 0 ? (\n                                        <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n                                            <ClipboardDocumentListIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n                                            <div className=\"text-sm\">Keine To Do's gefunden</div>\n                                        </div>\n                                    ) : (\n                                        <CardGrid>\n                                            {filteredAndSortedTasks.map(task => {\n                                                const expiryStatus = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                                \n                                                // Metadaten basierend auf sichtbaren Einstellungen - strukturiert nach Position\n                                                const metadata: MetadataItem[] = [];\n                                                \n                                                // Links: Niederlassung\n                                                if (visibleCardMetadata.has('branch')) {\n                                                    metadata.push({\n                                                        icon: <BuildingOfficeIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.branch'),\n                                                        value: task.branch.name,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Haupt-Metadaten: Verantwortlicher & Qualittskontrolle\n                                                if (visibleCardMetadata.has('responsible')) {\n                                                    // Benutzernamen auf 4 Zeichen krzen\n                                                    const responsibleValue = task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}` : (task.role ? task.role.name : '-');\n                                                    const shortenedName = responsibleValue.length > 4 && responsibleValue !== '-' ? responsibleValue.substring(0, 4) : responsibleValue;\n                                                    metadata.push({\n                                                        icon: <UserIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.responsible'),\n                                                        value: shortenedName,\n                                                        section: 'main'\n                                                    });\n                                                }\n                                                if (visibleCardMetadata.has('qualityControl')) {\n                                                    // Benutzernamen auf 4 Zeichen krzen\n                                                    const qualityControlValue = task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}` : '-';\n                                                    const shortenedName = qualityControlValue.length > 4 && qualityControlValue !== '-' ? qualityControlValue.substring(0, 4) : qualityControlValue;\n                                                    metadata.push({\n                                                        icon: <UserIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.qualityControl'),\n                                                        value: shortenedName,\n                                                        section: 'main-second'\n                                                    });\n                                                }\n                                                \n                                                // Rechts: Flligkeit (erste Zeile rechts, neben Status)\n                                                if (visibleCardMetadata.has('dueDate')) {\n                                                    const dueDateItem = createDueDateMetadataItem(\n                                                        task.dueDate,\n                                                        'todo',\n                                                        task.title,\n                                                        task.description,\n                                                        <CalendarIcon className=\"h-4 w-4\" />,\n                                                        t('tasks.columns.dueDate'),\n                                                        (date) => format(date, 'dd.MM.yyyy', { locale: de }),\n                                                        false // Keine Badge-Art, nur Text\n                                                    );\n                                                    metadata.push({\n                                                        ...dueDateItem,\n                                                        section: 'right-inline' // Neue Section fr inline rechts (neben Status)\n                                                    });\n                                                }\n                                                \n                                                // Full-Width: Beschreibung\n                                                if (visibleCardMetadata.has('description') && task.description) {\n                                                    metadata.push({\n                                                        label: t('tasks.columns.description'),\n                                                        value: '',\n                                                        descriptionContent: task.description,\n                                                        attachmentMetadata: task.attachments || [], // Attachment-Metadaten fr Vorschau\n                                                        section: 'full'\n                                                    });\n                                                }\n                                                \n                                                // Action-Buttons\n                                                const actionButtons = (\n                                                    <div className=\"flex items-center space-x-2\">\n                                                        {/* Status-Buttons */}\n                                                        <div className=\"status-buttons\">\n                                                            {renderStatusButtons(task)}\n                                                        </div>\n                                                        {hasPermission('tasks', 'write', 'table') && (\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedTask(task);\n                                                                    setIsEditModalOpen(true);\n                                                                }}\n                                                                                    className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                >\n                                                                <PencilIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                        )}\n                                                        {hasPermission('tasks', 'both', 'table') && (\n                                                            <div className=\"relative group\">\n                                                                <button\n                                                                    onClick={(e) => {\n                                                                        e.stopPropagation();\n                                                                        handleCopyTask(task);\n                                                                    }}\n                                                                    className=\"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                                                                >\n                                                                    <DocumentDuplicateIcon className=\"h-4 w-4\" />\n                                                                </button>\n                                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                    {t('tasks.actions.copy')}\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                );\n                                                \n                                                return (\n                                                    <DataCard\n                                                        key={task.id}\n                                                        title={\n                                                          <span>\n                                                            <span className=\"text-xs text-gray-600 dark:text-gray-400\">{task.id}:</span>{' '}\n                                                            <span>{task.title}</span>\n                                                          </span>\n                                                        }\n                                                        status={{\n                                                            label: getStatusText(task.status, 'task', t),\n                                                            color: getStatusColor(task.status, 'task'),\n                                                            onPreviousClick: undefined,\n                                                            onNextClick: undefined\n                                                        }}\n                                                        metadata={metadata}\n                                                        actions={actionButtons}\n                                                    />\n                                                );\n                                            })}\n                                        </CardGrid>\n                                    )}\n                                </div>\n                            ) : null}\n                            \n                            {/* Reservations Rendering - Cards */}\n                            {activeTab === 'reservations' && viewMode === 'cards' && (\n                                <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n                                    {reservationsLoading ? (\n                                        <div className=\"flex justify-center py-12\">\n                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                        </div>\n                                    ) : reservationsError ? (\n                                        <div className=\"flex justify-center py-12 text-red-600 dark:text-red-400\">\n                                            {reservationsError}\n                                        </div>\n                                    ) : filteredAndSortedReservations.length === 0 ? (\n                                        <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n                                            <CalendarIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n                                            <div className=\"text-sm\">\n                                                {reservationSearchTerm || reservationFilterStatus !== 'all' || reservationFilterPaymentStatus !== 'all'\n                                                    ? t('reservations.noResults', 'Keine Reservations gefunden')\n                                                    : t('reservations.noReservations', 'Keine Reservations vorhanden')}\n                                            </div>\n                                        </div>\n                                    ) : (\n                                        <CardGrid>\n                                            {filteredAndSortedReservations.map(reservation => {\n                                                const formatDate = (dateString: string) => {\n                                                    try {\n                                                        // Extrahiere nur den Datumsteil (YYYY-MM-DD) und parse als lokales Datum\n                                                        // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\n                                                        const date = new Date(dateString);\n                                                        // Verwende UTC-Methoden, um nur den Datumsteil zu extrahieren (ohne Zeitzone)\n                                                        const year = date.getUTCFullYear();\n                                                        const month = date.getUTCMonth();\n                                                        const day = date.getUTCDate();\n                                                        // Erstelle lokales Datum aus den UTC-Werten\n                                                        const localDate = new Date(year, month, day);\n                                                        return format(localDate, 'dd.MM.yyyy', { locale: de });\n                                                    } catch {\n                                                        return dateString;\n                                                    }\n                                                };\n                                                \n                                                // Metadaten fr Reservation-Card\n                                                const metadata: MetadataItem[] = [];\n                                                \n                                                // Haupt-Metadaten: Check-in/Check-out (rechts oben, unverndert)\n                                                metadata.push({\n                                                    icon: <CalendarIcon className=\"h-4 w-4\" />,\n                                                    label: t('reservations.checkInOut', 'Check-in/Check-out'),\n                                                    value: `${formatDate(reservation.checkInDate)} - ${formatDate(reservation.checkOutDate)}`,\n                                                    section: 'main'\n                                                });\n                                                \n                                                // Zweite Zeile: Zimmernummer\n                                                if (reservation.roomNumber) {\n                                                    metadata.push({\n                                                        icon: <HomeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.roomNumber,\n                                                        section: 'main-second'\n                                                    });\n                                                }\n                                                \n                                                // Links: Telefon/Email unter Titel (gleiche Zeile wie Status)\n                                                if (reservation.guestEmail) {\n                                                    metadata.push({\n                                                        icon: <EnvelopeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.guestEmail,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                if (reservation.guestPhone) {\n                                                    metadata.push({\n                                                        icon: <PhoneIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.guestPhone,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Links: Branch (nach Telefon/Email)\n                                                if (reservation.branch) {\n                                                    metadata.push({\n                                                        icon: <BuildingOfficeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.branch.name,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Mitte: Zahlungslink (gleiche Hhe wie Payment Status)\n                                                if (reservation.paymentLink) {\n                                                    metadata.push({\n                                                        icon: <LinkIcon className=\"h-4 w-4\" />,\n                                                        value: (\n                                                            <a \n                                                                href={reservation.paymentLink} \n                                                                target=\"_blank\" \n                                                                rel=\"noopener noreferrer\"\n                                                                onClick={(e) => e.stopPropagation()}\n                                                                className=\"text-gray-900 dark:text-white break-all\"\n                                                            >\n                                                                {t('reservations.paymentLink', 'Zahlungslink')}\n                                                            </a>\n                                                        ),\n                                                        section: 'center'\n                                                    });\n                                                }\n                                                \n                                                // Mitte: Check-in Link (direkt unter Zahlungslink)\n                                                // WICHTIG: Verwende lobbyReservationId (LobbyPMS booking_id) als codigo, nicht die interne ID\n                                                const codigo = reservation.lobbyReservationId || reservation.id.toString();\n                                                const checkInLink = reservation.guestEmail \n                                                    ? `https://app.lobbypms.com/checkinonline/confirmar?codigo=${codigo}&email=${encodeURIComponent(reservation.guestEmail)}&lg=GB`\n                                                    : null;\n                                                if (checkInLink) {\n                                                    metadata.push({\n                                                    icon: <LinkIcon className=\"h-4 w-4\" />,\n                                                    value: (\n                                                        <div className=\"relative group\">\n                                                            <a \n                                                                href={checkInLink} \n                                                                target=\"_blank\" \n                                                                rel=\"noopener noreferrer\"\n                                                                onClick={(e) => e.stopPropagation()}\n                                                                className=\"text-gray-900 dark:text-white\"\n                                                            >\n                                                                {t('reservations.checkInLink', 'Check-in Link')}\n                                                            </a>\n                                                            <div className=\"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {checkInLink}\n                                                            </div>\n                                                        </div>\n                                                    ),\n                                                    section: 'center'\n                                                    });\n                                                }\n                                                \n                                                // Rechts: Reservation Status als erstes Badge (mit Label)\n                                                metadata.push({\n                                                    label: t('reservations.status', 'Status'),\n                                                    value: (\n                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getReservationStatusColor(reservation.status)}`}>\n                                                            {t(`reservations.status.${reservation.status}`, reservation.status)}\n                                                        </span>\n                                                    ),\n                                                    section: 'right'\n                                                });\n                                                \n                                                // Rechts: Payment Status als zweites Badge (direkt unter Reservation Status)\n                                                metadata.push({\n                                                    label: t('reservations.paymentStatus', 'Zahlungsstatus'),\n                                                    value: (\n                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getPaymentStatusColor(reservation.paymentStatus)}`}>\n                                                            {t(`reservations.paymentStatus.${reservation.paymentStatus}`, reservation.paymentStatus)}\n                                                        </span>\n                                                    ),\n                                                    section: 'right'\n                                                });\n                                                \n                                                // Betrag und Whrung (wenn vorhanden)\n                                                if (reservation.amount) {\n                                                    const amountValue = typeof reservation.amount === 'string' \n                                                        ? parseFloat(reservation.amount).toFixed(2)\n                                                        : typeof reservation.amount === 'number'\n                                                        ? reservation.amount.toFixed(2)\n                                                        : '0.00';\n                                                    metadata.push({\n                                                        icon: <CurrencyDollarIcon className=\"h-4 w-4\" />,\n                                                        label: t('reservations.amount', 'Betrag'),\n                                                        value: `${amountValue} ${reservation.currency || 'COP'}`,\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Ankunftszeit (wenn vorhanden)\n                                                if (reservation.arrivalTime) {\n                                                    const formatDateTime = (dateString: string) => {\n                                                        try {\n                                                            return format(new Date(dateString), 'dd.MM.yyyy HH:mm', { locale: de });\n                                                        } catch {\n                                                            return dateString;\n                                                        }\n                                                    };\n                                                    metadata.push({\n                                                        icon: <ClockIcon className=\"h-4 w-4\" />,\n                                                        label: t('reservations.arrivalTime', 'Ankunftszeit'),\n                                                        value: formatDateTime(reservation.arrivalTime),\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Tr-PIN (wenn vorhanden)\n                                                if (reservation.doorPin) {\n                                                    metadata.push({\n                                                        icon: <KeyIcon className=\"h-4 w-4\" />,\n                                                        label: reservation.doorAppName || t('reservations.doorPin', 'Tr-PIN'),\n                                                        value: reservation.doorPin,\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Online Check-in Status\n                                                if (reservation.onlineCheckInCompleted) {\n                                                    metadata.push({\n                                                        icon: <CheckCircleIcon className=\"h-4 w-4 text-green-600\" />,\n                                                        label: t('reservations.onlineCheckIn', 'Online Check-in'),\n                                                        value: t('reservations.completed', 'Abgeschlossen'),\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Action-Button fr PIN-Generierung und Mitteilungsversand\n                                                const hasWritePermission = hasPermission('reservations', 'write', 'table');\n                                                // Debug: Log fr Berechtigungsprfung (nur fr erste Reservation) - IMMER loggen\n                                                if (reservation.id === filteredAndSortedReservations[0]?.id) {\n                                                    console.log('[Reservations] Berechtigungsprfung:', {\n                                                        hasWritePermission,\n                                                        reservationId: reservation.id,\n                                                        entity: 'reservations',\n                                                        accessLevel: 'write',\n                                                        entityType: 'table',\n                                                        actionButtonsWillBeCreated: hasWritePermission\n                                                    });\n                                                }\n                                                const actionButtons = hasWritePermission ? (\n                                                    <div className=\"flex items-center space-x-2\">\n                                                        {/* Einladung senden Button */}\n                                                        <div className=\"relative group\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedReservationForInvitation(reservation);\n                                                                    setIsSendInvitationSidepaneOpen(true);\n                                                                }}\n                                                                className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                            >\n                                                                <PaperAirplaneIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                            <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {t('reservations.sendInvitation.title')}\n                                                            </div>\n                                                        </div>\n                                                        \n                                                        {/* Key-Button fr PIN-Generierung */}\n                                                        <div className=\"relative group\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedReservationForPasscode(reservation);\n                                                                    setIsSendPasscodeSidepaneOpen(true);\n                                                                }}\n                                                                className=\"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300\"\n                                                            >\n                                                                <KeyIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                            <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {t('reservations.sendPasscode.title')}\n                                                            </div>\n                                                        </div>\n                                                    </div>\n                                                ) : null;\n                                                \n                                                // Expandable Content fr Details - zeigt alle Notification-Logs\n                                                const isExpanded = expandedReservationRows.has(reservation.id);\n                                                const expandableContent = (\n                                                    <div className=\"mt-2 pt-3\">\n                                                        <ReservationNotificationLogs reservationId={reservation.id} />\n                                                    </div>\n                                                );\n                                                \n                                                return (\n                                                    <DataCard\n                                                        key={reservation.id}\n                                                        title={reservation.guestName}\n                                                        subtitle={reservation.lobbyReservationId ? `ID: ${reservation.lobbyReservationId}` : undefined}\n                                                        metadata={metadata}\n                                                        actions={actionButtons}\n                                                        expandable={expandableContent ? {\n                                                            isExpanded: isExpanded,\n                                                            content: expandableContent,\n                                                            onToggle: () => toggleReservationExpanded(reservation.id)\n                                                        } : undefined}\n                                                    />\n                                                );\n                                            })}\n                                        </CardGrid>\n                                    )}\n                                </div>\n                            )}\n                            \n                            {/*  PAGINATION: Infinite Scroll Trigger fr Reservations */}\n                            {activeTab === 'reservations' && reservationsHasMore && (\n                                <div ref={reservationsLoadMoreRef} className=\"flex justify-center py-4\">\n                                    {reservationsLoadingMore && (\n                                        <CircularProgress size={24} />\n                                    )}\n                                </div>\n                            )}\n                            \n                            {/* Reservations Rendering - Tabelle (optional, analog zu Tasks) */}\n                            {activeTab === 'reservations' && viewMode === 'table' && (\n                                <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                        <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <tr>\n                                                {visibleColumnIds.map((columnId) => {\n                                                    const column = availableReservationColumns.find(col => col.id === columnId);\n                                                    if (!column) return null;\n                                                    \n                                                    return (\n                                                        <th\n                                                            key={columnId}\n                                                            scope=\"col\"\n                                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                                            draggable={true}\n                                                            onDragStart={() => handleDragStart(columnId)}\n                                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                                            onDrop={(e) => handleDrop(e, columnId)}\n                                                            onDragEnd={handleDragEnd}\n                                                        >\n                                                            <div className=\"flex items-center\">\n                                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                                {columnId !== 'actions' && (\n                                                                    <button \n                                                                        onClick={() => handleReservationSort(columnId as ReservationSortConfig['key'])}\n                                                                        className=\"ml-1 focus:outline-none\"\n                                                                    >\n                                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                                    </button>\n                                                                )}\n                                                            </div>\n                                                        </th>\n                                                    );\n                                                })}\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                            {reservationsLoading ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-4 text-center\">\n                                                        <div className=\"flex justify-center\">\n                                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : reservationsError ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-red-600 dark:text-red-400\">\n                                                        {reservationsError}\n                                                    </td>\n                                                </tr>\n                                            ) : filteredAndSortedReservations.length === 0 ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                                                        <div className=\"flex flex-col items-center justify-center gap-4\">\n                                                            <CalendarIcon className=\"h-10 w-10 text-gray-400 dark:text-gray-500\" />\n                                                            <div className=\"text-sm\">\n                                                                {reservationSearchTerm || reservationFilterStatus !== 'all' || reservationFilterPaymentStatus !== 'all'\n                                                                    ? t('reservations.noResults', 'Keine Reservations gefunden')\n                                                                    : t('reservations.noReservations', 'Keine Reservations vorhanden')}\n                                                            </div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : (\n                                                <>\n                                                    {filteredAndSortedReservations.map(reservation => {\n                                                        const formatDate = (dateString: string) => {\n                                                            try {\n                                                                return format(new Date(dateString), 'dd.MM.yyyy', { locale: de });\n                                                            } catch {\n                                                                return dateString;\n                                                            }\n                                                        };\n                                                        \n                                                        return (\n                                                            <tr \n                                                                key={reservation.id} \n                                                                className=\"hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer\"\n                                                                onClick={() => navigate(`/reservations/${reservation.id}`)}\n                                                            >\n                                                                {visibleColumnIds.map(columnId => {\n                                                                    switch (columnId) {\n                                                                        case 'guestName':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words\">\n                                                                                        {reservation.guestName}\n                                                                                        {reservation.lobbyReservationId && (\n                                                                                            <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                                                                                ID: {reservation.lobbyReservationId}\n                                                                                            </div>\n                                                                                        )}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'status':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getReservationStatusColor(reservation.status)}`}>\n                                                                                        {t(`reservations.status.${reservation.status}`, reservation.status)}\n                                                                                    </span>\n                                                                                </td>\n                                                                            );\n                                                                        case 'paymentStatus':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getPaymentStatusColor(reservation.paymentStatus)}`}>\n                                                                                        {t(`reservations.paymentStatus.${reservation.paymentStatus}`, reservation.paymentStatus)}\n                                                                                    </span>\n                                                                                </td>\n                                                                            );\n                                                                        case 'checkInDate':\n                                                                        case 'checkOutDate':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {formatDate(columnId === 'checkInDate' ? reservation.checkInDate : reservation.checkOutDate)}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'roomNumber':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.roomNumber || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'branch':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.branch?.name || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'guestEmail':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.guestEmail || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'guestPhone':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.guestPhone || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'amount':\n                                                                            const amountValue = typeof reservation.amount === 'string' \n                                                                                ? parseFloat(reservation.amount).toFixed(2)\n                                                                                : typeof reservation.amount === 'number'\n                                                                                ? reservation.amount.toFixed(2)\n                                                                                : '0.00';\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {amountValue} {reservation.currency || 'COP'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'arrivalTime':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.arrivalTime ? format(new Date(reservation.arrivalTime), 'dd.MM.yyyy HH:mm', { locale: de }) : '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'actions':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"flex space-x-2 action-buttons\">\n                                                                                        {hasPermission('reservations', 'write', 'table') && (\n                                                                                            <>\n                                                                                                {/* Einladung senden Button */}\n                                                                                                <div className=\"relative group\">\n                                                                                                    <button\n                                                                                                        onClick={(e) => {\n                                                                                                            e.stopPropagation();\n                                                                                                            setSelectedReservationForInvitation(reservation);\n                                                                                                            setIsSendInvitationSidepaneOpen(true);\n                                                                                                        }}\n                                                                                                        className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                                    >\n                                                                                                        <PaperAirplaneIcon className=\"h-4 w-4\" />\n                                                                                                    </button>\n                                                                                                    <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                                        {t('reservations.sendInvitation.title')}\n                                                                                                    </div>\n                                                                                                </div>\n                                                                                                \n                                                                                                {/* Key-Button fr PIN-Generierung */}\n                                                                                                <div className=\"relative group\">\n                                                                                                    <button\n                                                                                                        onClick={(e) => {\n                                                                                                            e.stopPropagation();\n                                                                                                            setSelectedReservationForPasscode(reservation);\n                                                                                                            setIsSendPasscodeSidepaneOpen(true);\n                                                                                                        }}\n                                                                                                        className=\"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300\"\n                                                                                                    >\n                                                                                                        <KeyIcon className=\"h-4 w-4\" />\n                                                                                                    </button>\n                                                                                                    <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                                        {t('reservations.sendPasscode.title')}\n                                                                                                    </div>\n                                                                                                </div>\n                                                                                                \n                                                                                                {/* Details Button */}\n                                                                                                <div className=\"relative group\">\n                                                                                                    <button\n                                                                                                        onClick={(e) => {\n                                                                                                            e.stopPropagation();\n                                                                                                            navigate(`/reservations/${reservation.id}`);\n                                                                                                        }}\n                                                                                                        className=\"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                                    >\n                                                                                                        <InformationCircleIcon className=\"h-4 w-4\" />\n                                                                                                    </button>\n                                                                                                    <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                                        {t('common.viewDetails')}\n                                                                                                    </div>\n                                                                                                </div>\n                                                                                            </>\n                                                                                        )}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        default:\n                                                                            return null;\n                                                                    }\n                                                                })}\n                                                            </tr>\n                                                        );\n                                                    })}\n                                                </>\n                                            )}\n                                        </tbody>\n                                    </table>\n                                </div>\n                            )}\n                            \n                            {/*  PAGINATION: Infinite Scroll Trigger fr Tasks */}\n                            {activeTab === 'todos' && tasksHasMore && (\n                                <div ref={tasksLoadMoreRef} className=\"flex justify-center py-4\">\n                                    {tasksLoadingMore && (\n                                        <CircularProgress size={24} />\n                                    )}\n                                </div>\n                            )}\n                            \n                            {/*  PAGINATION: Infinite Scroll Trigger fr Tour Bookings */}\n                            {activeTab === 'tourBookings' && tourBookingsHasMore && (\n                                <div ref={tourBookingsLoadMoreRef} className=\"flex justify-center py-4\">\n                                    {tourBookingsLoadingMore && (\n                                        <CircularProgress size={24} />\n                                    )}\n                                </div>\n                            )}\n                        </div>\n                        \n                        {/* Zeiterfassung - auf Mobilgerten fixiert ber dem Footermen */}\n                        <div className=\"fixed bottom-13 left-0 right-0 w-full bg-white dark:bg-gray-800 z-9 shadow-lg border-t-0 dark:border-t dark:border-gray-700\">\n                            <WorktimeTracker />\n                        </div>\n                    </div>\n\n                    {/* Auf greren Gerten bleibt die ursprngliche Reihenfolge - Zeiterfassung oben, Tasks unten */}\n                    <div className=\"hidden sm:block\">\n                        {/* Zeiterfassung */}\n                        <div className=\"mb-8\">\n                            <WorktimeTracker />\n                        </div>\n                        \n                        {/* Tasks - vollstndiger Inhalt fr Desktop-Ansicht */}\n                        <div className=\"dashboard-tasks-wrapper bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 w-full mb-20\">\n                            <div className=\"flex items-center mb-4 justify-between px-3 sm:px-4 md:px-6\">\n                                {/* Linke Seite: \"Neuer Task/Reservation\"-Button */}\n                                <div className=\"flex items-center\">\n                                    {activeTab === 'todos' && hasPermission('tasks', 'write', 'table') && (\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={() => setIsCreateModalOpen(true)}\n                                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                                style={{ width: '30.19px', height: '30.19px' }}\n                                                aria-label={t('tasks.createTask')}\n                                                data-onboarding=\"create-task-button\"\n                                            >\n                                                <PlusIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {t('tasks.createTask')}\n                                            </div>\n                                        </div>\n                                    )}\n                                    {activeTab === 'reservations' && hasPermission('reservations', 'write', 'table') && (\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={() => setIsCreateReservationModalOpen(true)}\n                                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                                style={{ width: '30.19px', height: '30.19px' }}\n                                                aria-label={t('reservations.createReservation.button', 'Neue Reservierung')}\n                                            >\n                                                <PlusIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {t('reservations.createReservation.button', 'Neue Reservierung')}\n                                            </div>\n                                        </div>\n                                    )}\n                                </div>\n                                \n                                {/* Mitte: Tab-Navigation */}\n                                <div className=\"flex items-center\">\n                                    <nav className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden\">\n                                        <button\n                                            onClick={() => setActiveTab('todos')}\n                                            className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 flex items-center gap-1.5 ${\n                                                activeTab === 'todos'\n                                                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                            }`}\n                                        >\n                                            <CheckCircleIcon className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                                            {t('tasks.title', \"To Do's\")}\n                                        </button>\n                                        {hasPermission('reservations', 'read', 'table') && (\n                                            <button\n                                                onClick={() => setActiveTab('reservations')}\n                                                className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 flex items-center gap-1.5 ${\n                                                    activeTab === 'reservations'\n                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                }`}\n                                            >\n                                                <CalendarIcon className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                                                {t('reservations.title', 'Reservations')}\n                                            </button>\n                                        )}\n                                        {hasPermission('tour_bookings', 'read', 'table') && (\n                                            <button\n                                                onClick={() => setActiveTab('tourBookings')}\n                                                className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 flex items-center gap-1.5 ${\n                                                    activeTab === 'tourBookings'\n                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                }`}\n                                            >\n                                                <ClipboardDocumentListIcon className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                                                {t('tourBookings.title', 'Tour-Buchungen')}\n                                            </button>\n                                        )}\n                                    </nav>\n                                </div>\n                                \n                                {/* Rechte Seite: Suchfeld, Sync-Button (nur Reservations), Filter-Button, Status-Filter, Spalten-Konfiguration */}\n                                <div className=\"flex items-center gap-1.5\">\n                                    <input\n                                        type=\"text\"\n                                        placeholder={t('common.search') + '...'}\n                                        className=\"w-[120px] sm:w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                                        value={activeTab === 'todos' ? searchTerm : reservationSearchTerm}\n                                        onChange={(e) => {\n                                            if (activeTab === 'todos') {\n                                                setSearchTerm(e.target.value);\n                                            } else {\n                                                setReservationSearchTerm(e.target.value);\n                                            }\n                                        }}\n                                    />\n                                    \n                                    {/* Sync-Button fr Reservations */}\n                                    {activeTab === 'reservations' && (\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={async () => {\n                                                    try {\n                                                        setSyncingReservations(true);\n                                                        await axiosInstance.post(API_ENDPOINTS.RESERVATIONS.SYNC);\n                                                        showMessage(t('reservations.syncSuccess', 'Reservations erfolgreich synchronisiert'), 'success');\n                                                        await loadReservations(undefined, undefined, false, 20, 0); //  PAGINATION: limit=20, offset=0\n                                                    } catch (err: any) {\n                                                        if (process.env.NODE_ENV === 'development') {\n                                                        console.error('Fehler beim Synchronisieren:', err);\n                                                        }\n                                                        showMessage(\n                                                            err.response?.data?.message || t('reservations.syncError', 'Fehler beim Synchronisieren'),\n                                                            'error'\n                                                        );\n                                                    } finally {\n                                                        setSyncingReservations(false);\n                                                    }\n                                                }}\n                                                disabled={syncingReservations}\n                                                className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                                            >\n                                                <ArrowPathIcon className={`h-5 w-5 ${syncingReservations ? 'animate-spin' : ''}`} />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {syncingReservations ? t('reservations.syncing', 'Synchronisiere...') : t('reservations.sync', 'Synchronisieren')}\n                                            </div>\n                                        </div>\n                                    )}\n                                    \n                                    {/* View-Mode Toggle */}\n                                    <div className=\"relative group\">\n                                        <button\n                                            className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n                                                viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n                                            }`}\n                                            onClick={() => updateViewMode(viewMode === 'table' ? 'cards' : 'table')}\n                                        >\n                                            {viewMode === 'table' ? (\n                                                <Squares2X2Icon className=\"h-5 w-5\" />\n                                            ) : (\n                                                <TableCellsIcon className=\"h-5 w-5\" />\n                                            )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Filter-Button */}\n                                    <div className=\"relative group ml-1\">\n                                        <button\n                                            className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n                                            onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                                        >\n                                            <FunnelIcon className=\"h-5 w-5\" />\n                                            {getActiveFilterCount() > 0 && (\n                                                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                                    {getActiveFilterCount()}\n                                                </span>\n                                            )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {t('common.filter')}\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Spalten-Konfiguration */}\n                                    <div className=\"ml-1\">\n                                        <TableColumnConfig\n                                            columns={activeTab === 'todos'\n                                                ? (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'title', label: t('tasks.columns.title') },\n                                                        { id: 'status', label: t('tasks.columns.status') },\n                                                        { id: 'responsible', label: t('tasks.columns.responsible') },\n                                                        { id: 'qualityControl', label: t('tasks.columns.qualityControl') },\n                                                        { id: 'branch', label: t('tasks.columns.branch') },\n                                                        { id: 'dueDate', label: t('tasks.columns.dueDate') },\n                                                        { id: 'description', label: t('tasks.columns.description') }\n                                                    ]\n                                                    : availableColumns)\n                                                : activeTab === 'reservations'\n                                                ? (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'guestName', label: t('reservations.columns.guestName', 'Gast') },\n                                                        { id: 'status', label: t('reservations.columns.status', 'Status') },\n                                                        { id: 'paymentStatus', label: t('reservations.columns.paymentStatus', 'Zahlungsstatus') },\n                                                        { id: 'checkInDate', label: t('reservations.columns.checkInDate', 'Check-in') },\n                                                        { id: 'checkOutDate', label: t('reservations.columns.checkOutDate', 'Check-out') },\n                                                        { id: 'roomNumber', label: t('reservations.columns.roomNumber', 'Zimmer') },\n                                                        { id: 'guestEmail', label: t('reservations.columns.guestEmail', 'E-Mail') },\n                                                        { id: 'guestPhone', label: t('reservations.columns.guestPhone', 'Telefon') },\n                                                        { id: 'amount', label: t('reservations.columns.amount', 'Betrag') },\n                                                        { id: 'arrivalTime', label: t('reservations.columns.arrivalTime', 'Ankunftszeit') }\n                                                    ]\n                                                    : availableReservationColumns)\n                                                : []}\n                                            visibleColumns={viewMode === 'cards'\n                                                ? Array.from(visibleCardMetadata)\n                                                : visibleColumnIds}\n                                            columnOrder={viewMode === 'cards'\n                                                ? cardMetadataOrder\n                                                : settings.columnOrder}\n                                            onToggleColumnVisibility={(columnId) => {\n                                                if (viewMode === 'cards') {\n                                                    if (activeTab === 'todos') {\n                                                        const tableColumn = cardToTableMapping[columnId];\n                                                        if (tableColumn) {\n                                                            // Spezielle Logik fr responsibleAndQualityControl\n                                                            if (tableColumn === 'responsibleAndQualityControl') {\n                                                                // Prfe ob beide bereits ausgeblendet sind\n                                                                const otherCardMeta = columnId === 'responsible' ? 'qualityControl' : 'responsible';\n                                                                const otherHidden = hiddenCardMetadata.has(otherCardMeta);\n                                                                const currentlyHidden = settings.hiddenColumns.includes(tableColumn);\n                                                                \n                                                                if (currentlyHidden && !otherHidden) {\n                                                                    // Eine der beiden wird wieder angezeigt, also responsibleAndQualityControl wieder anzeigen\n                                                                    toggleColumnVisibility(tableColumn);\n                                                                } else if (!currentlyHidden && otherHidden) {\n                                                                    // Die andere ist bereits ausgeblendet, also responsibleAndQualityControl ausblenden\n                                                                    toggleColumnVisibility(tableColumn);\n                                                                } else if (!currentlyHidden) {\n                                                                    // Erste wird ausgeblendet, responsibleAndQualityControl ausblenden\n                                                                    toggleColumnVisibility(tableColumn);\n                                                                } else {\n                                                                    // Beide sind ausgeblendet, eine wird wieder angezeigt\n                                                                    toggleColumnVisibility(tableColumn);\n                                                                }\n                                                            } else {\n                                                                // Normale Spalte: direkt ein/ausblenden\n                                                                toggleColumnVisibility(tableColumn);\n                                                            }\n                                                        }\n                                                    } else if (activeTab === 'reservations') {\n                                                        // Reservations: 1:1 Mapping\n                                                        const tableColumn = reservationCardToTableMapping[columnId];\n                                                        if (tableColumn) {\n                                                            toggleColumnVisibility(tableColumn);\n                                                        }\n                                                    }\n                                                } else {\n                                                    toggleColumnVisibility(columnId);\n                                                }\n                                            }}\n                                            onMoveColumn={viewMode === 'cards'\n                                                ? (dragIndex: number, hoverIndex: number) => {\n                                                    const newCardOrder = [...cardMetadataOrder];\n                                                    const dragged = newCardOrder[dragIndex];\n                                                    newCardOrder.splice(dragIndex, 1);\n                                                    newCardOrder.splice(hoverIndex, 0, dragged);\n                                                    \n                                                    const newTableOrder: string[] = [];\n                                                    const usedTableColumns = new Set<string>();\n                                                    \n                                                    if (activeTab === 'todos') {\n                                                        newCardOrder.forEach(cardMeta => {\n                                                            const tableCol = cardToTableMapping[cardMeta];\n                                                            if (tableCol && !usedTableColumns.has(tableCol)) {\n                                                                usedTableColumns.add(tableCol);\n                                                                newTableOrder.push(tableCol);\n                                                            }\n                                                        });\n                                                        \n                                                        availableColumns.forEach(col => {\n                                                            if (!newTableOrder.includes(col.id) && col.id !== 'actions') {\n                                                                newTableOrder.push(col.id);\n                                                            }\n                                                        });\n                                                    } else if (activeTab === 'reservations') {\n                                                        // Reservations: 1:1 Mapping\n                                                        newCardOrder.forEach(cardMeta => {\n                                                            const tableCol = reservationCardToTableMapping[cardMeta];\n                                                            if (tableCol && !usedTableColumns.has(tableCol)) {\n                                                                usedTableColumns.add(tableCol);\n                                                                newTableOrder.push(tableCol);\n                                                            }\n                                                        });\n                                                        \n                                                        availableReservationColumns.forEach(col => {\n                                                            if (!newTableOrder.includes(col.id) && col.id !== 'actions') {\n                                                                newTableOrder.push(col.id);\n                                                            }\n                                                        });\n                                                    }\n                                                    \n                                                    updateColumnOrder(newTableOrder);\n                                                }\n                                                : handleMoveColumn}\n                                            buttonTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                                            modalTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                                            sortDirections={viewMode === 'cards' && activeTab === 'todos'\n                                                ? taskCardSortDirections\n                                                : viewMode === 'cards' && activeTab === 'reservations' \n                                                ? reservationCardSortDirections \n                                                : undefined}\n                                            onSortDirectionChange={viewMode === 'cards' && activeTab === 'todos'\n                                                ? handleTaskCardSortDirectionChange\n                                                : viewMode === 'cards' && activeTab === 'reservations'\n                                                ? handleReservationCardSortDirectionChange\n                                                : undefined}\n                                            showSortDirection={viewMode === 'cards' && (activeTab === 'todos' || activeTab === 'reservations')}\n                                            onClose={() => {}}\n                                        />\n                                    </div>\n                                </div>\n                            </div>\n\n                            {/* Filter-Pane */}\n                            {isFilterModalOpen && (\n                                <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n                                    {activeTab === 'todos' ? (\n                                        <FilterPane\n                                            columns={[...availableColumns, ...filterOnlyColumns]}\n                                            onApply={applyFilterConditions}\n                                            onReset={resetFilterConditions}\n                                            savedConditions={filterConditions}\n                                            savedOperators={filterLogicalOperators}\n                                            savedSortDirections={filterSortDirections}\n                                            onSortDirectionsChange={setFilterSortDirections}\n                                            tableId={TODOS_TABLE_ID}\n                                        />\n                                    ) : (\n                                        <FilterPane\n                                            columns={[...availableReservationColumns, ...reservationFilterOnlyColumns]}\n                                            onApply={applyReservationFilterConditions}\n                                            onReset={resetReservationFilterConditions}\n                                            savedConditions={reservationFilterConditions}\n                                            savedOperators={reservationFilterLogicalOperators}\n                                            savedSortDirections={reservationFilterSortDirections}\n                                            onSortDirectionsChange={setReservationFilterSortDirections}\n                                            tableId={RESERVATIONS_TABLE_ID}\n                                        />\n                                    )}\n                                </div>\n                            )}\n\n                            {/* Gespeicherte Filter als Tags anzeigen */}\n                            <SavedFilterTags\n                                tableId={activeTab === 'todos' ? TODOS_TABLE_ID : RESERVATIONS_TABLE_ID}\n                                onSelectFilter={activeTab === 'todos' ? applyFilterConditions : applyReservationFilterConditions}\n                                onReset={activeTab === 'todos' ? resetFilterConditions : resetReservationFilterConditions}\n                                activeFilterName={activeTab === 'todos' ? activeFilterName : reservationActiveFilterName}\n                                selectedFilterId={activeTab === 'todos' ? selectedFilterId : reservationSelectedFilterId}\n                                onFilterChange={activeTab === 'todos' ? handleFilterChange : handleReservationFilterChange}\n                                defaultFilterName={activeTab === 'todos' ? t('tasks.filters.current') : 'Hoy'}\n                            />\n\n                            {/* Tabelle oder Cards */}\n                            {activeTab === 'todos' && viewMode === 'table' ? (\n                                /* Tabellen-Ansicht - Tasks */\n                                <div className=\"overflow-x-auto\">\n                                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\" data-onboarding=\"task-list\">\n                                        <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <tr>\n                                                {visibleColumnIds.map((columnId) => {\n                                                    const column = availableColumns.find(col => col.id === columnId);\n                                                    if (!column) return null;\n\n                                                    return (\n                                                        <th \n                                                            key={columnId}\n                                                            scope=\"col\"\n                                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                                            draggable={true}\n                                                            onDragStart={() => handleDragStart(columnId)}\n                                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                                            onDrop={(e) => handleDrop(e, columnId)}\n                                                            onDragEnd={handleDragEnd}\n                                                        >\n                                                            <div className=\"flex items-center\">\n                                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                                {columnId !== 'actions' && (\n                                                                    <button \n                                                                        onClick={() => handleSort(columnId as keyof Task)}\n                                                                        className=\"ml-1 focus:outline-none\"\n                                                                    >\n                                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                                    </button>\n                                                                )}\n                                                            </div>\n                                                        </th>\n                                                    );\n                                                })}\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                            {loading ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-4 text-center\">\n                                                        <div className=\"flex justify-center\">\n                                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : error ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-red-600 dark:text-red-400\">\n                                                        {error}\n                                                    </td>\n                                                </tr>\n                                            ) : filteredAndSortedTasks.length === 0 ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                                                        <div className=\"flex flex-col items-center justify-center gap-4\">\n                                                        <ClipboardDocumentListIcon className=\"h-10 w-10 text-gray-400 dark:text-gray-500\" />\n                                                        <div className=\"text-sm\">{t('tasks.noTasksFound')}</div>\n                                                    </div>\n                                                </td>\n                                            </tr>\n                                        ) : (\n                                            <>\n                                            {filteredAndSortedTasks.map(task => {\n                                            const expiryStatus = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                            const expiryColors = getExpiryColorClasses(expiryStatus);\n                                            \n                                            return (\n                                                <tr \n                                                    key={task.id} \n                                                    className={`hover:bg-gray-50 dark:hover:bg-gray-700 ${\n                                                        expiryStatus !== 'none' ? `${expiryColors.bgClass} ${expiryColors.borderClass} border-l-4` : ''\n                                                    }`}\n                                                >\n                                                    {visibleColumnIds.map(columnId => {\n                                                    switch (columnId) {\n                                                        case 'title':\n                                                            return (\n                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words flex items-center\">\n                                                                        {task.title}\n                                                                            {task.description && (\n                                                                                <div className=\"ml-2 relative group\">\n                                                                                    <button \n                                                                                        className=\"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        <InformationCircleIcon className=\"h-5 w-5\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('tasks.showDescription')}\n                                                                                    </div>\n                                                                                    <div className=\"absolute left-0 mt-2 p-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 shadow-lg rounded-md border border-gray-200 dark:border-gray-700 w-144 max-h-96 overflow-y-auto min-w-[36rem] z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                                                                        <MarkdownPreview content={task.description} showImagePreview={true} />\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'status':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(task.status, 'task')} dark:bg-opacity-30 status-col`}>\n                                                                            {task.status}\n                                                                        </span>\n                                                                    </td>\n                                                                );\n                                                            case 'responsibleAndQualityControl':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"flex flex-col\">\n                                                                            <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline\">{t('tasks.columns.responsible')}:</span>\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden\">{t('tasks.columns.responsible').substring(0, 3)}:</span><br />\n                                                                                {task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}` : task.role ? task.role.name : '-'}\n                                                                            </div>\n                                                                            <div className=\"text-sm text-gray-900 dark:text-gray-200 mt-1\">\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline\">{t('tasks.qualityControlLabel')}</span>\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden\">{t('tasks.columns.qualityControl').substring(0, 2)}:</span><br />\n                                                                                {task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}` : '-'}\n                                                                            </div>\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'branch':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"text-sm text-gray-900 dark:text-gray-200\">{task.branch.name}</div>\n                                                                    </td>\n                                                                );\n                                                            case 'dueDate':\n                                                                const expiryStatusForDate2 = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                                                const expiryColorsForDate2 = getExpiryColorClasses(expiryStatusForDate2);\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className={`text-sm ${expiryStatusForDate2 !== 'none' ? expiryColorsForDate2.textClass : 'text-gray-900 dark:text-gray-200'}`}>\n                                                                            {task.dueDate ? new Date(task.dueDate).toLocaleDateString() : '-'}\n                                                                            {expiryStatusForDate2 !== 'none' && (\n                                                                                <span className=\"ml-2 text-xs\"></span>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'actions':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"flex space-x-2 action-buttons\">\n                                                                            <div className=\"status-buttons\">\n                                                                                {renderStatusButtons(task)}\n                                                                            </div>\n                                                                            {hasPermission('tasks', 'write', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => {\n                                                                                            setSelectedTask(task);\n                                                                                            setIsEditModalOpen(true);\n                                                                                        }}\n                                                                                        className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                    >\n                                                                                        <PencilIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('common.edit')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                            {hasPermission('tasks', 'both', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => handleCopyTask(task)}\n                                                                                        className=\"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                                                                                    >\n                                                                                        <DocumentDuplicateIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('tasks.actions.copy')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                            {hasPermission('tasks', 'delete', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => handleDeleteTask(task.id)}\n                                                                                        className=\"p-1.5 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300\"\n                                                                                    >\n                                                                                        <TrashIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('common.delete')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            default:\n                                                                return null;\n                                                        }\n                                                    })}\n                                                    </tr>\n                                                );\n                                            })}\n                                            </>\n                                        )}\n                                    </tbody>\n                                </table>\n                            </div>\n                            ) : activeTab === 'todos' ? (\n                                /* Card-Ansicht - Tasks - ohne Box-Schattierung, Cards auf voller Breite */\n                                <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n                                    {/*  PERFORMANCE: Skeleton-Loading fr LCP-Element (sofort sichtbar, auch ohne Daten) */}\n                                    {loading && tasks.length === 0 ? (\n                                        <CardGrid>\n                                            {Array(3).fill(null).map((_, i) => (\n                                                <div key={`skeleton-${i}`} className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-3 sm:p-4 md:p-5 lg:p-6 shadow-sm\">\n                                                    <div className=\"space-y-4\">\n                                                        {/* LCP-Element: Titel-Skeleton */}\n                                                        <div className=\"flex items-center gap-2 mb-2\">\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-12\"></div>\n                                                            <div className=\"h-6 bg-gray-200 dark:bg-gray-700 rounded flex-1 min-w-0\"></div>\n                                                        </div>\n                                                        {/* Status-Skeleton */}\n                                                        <div className=\"h-6 bg-gray-200 dark:bg-gray-700 rounded w-24\"></div>\n                                                        {/* Metadaten-Skeleton */}\n                                                        <div className=\"space-y-2\">\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4\"></div>\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2\"></div>\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6\"></div>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            ))}\n                                        </CardGrid>\n                                    ) : error ? (\n                                        <div className=\"flex justify-center py-12 text-red-600 dark:text-red-400\">\n                                            {error}\n                                        </div>\n                                    ) : filteredAndSortedTasks.length === 0 ? (\n                                        <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n                                            <ClipboardDocumentListIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n                                            <div className=\"text-sm\">Keine To Do's gefunden</div>\n                                        </div>\n                                    ) : (\n                                        <CardGrid>\n                                            {filteredAndSortedTasks.map(task => {\n                                                const expiryStatus = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                                \n                                                // Metadaten basierend auf sichtbaren Einstellungen - strukturiert nach Position\n                                                const metadata: MetadataItem[] = [];\n                                                \n                                                // Links: Niederlassung\n                                                if (visibleCardMetadata.has('branch')) {\n                                                    metadata.push({\n                                                        icon: <BuildingOfficeIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.branch'),\n                                                        value: task.branch.name,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Haupt-Metadaten: Verantwortlicher & Qualittskontrolle\n                                                if (visibleCardMetadata.has('responsible')) {\n                                                    // Benutzernamen auf 4 Zeichen krzen\n                                                    const responsibleValue = task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}` : (task.role ? task.role.name : '-');\n                                                    const shortenedName = responsibleValue.length > 4 && responsibleValue !== '-' ? responsibleValue.substring(0, 4) : responsibleValue;\n                                                    metadata.push({\n                                                        icon: <UserIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.responsible'),\n                                                        value: shortenedName,\n                                                        section: 'main'\n                                                    });\n                                                }\n                                                if (visibleCardMetadata.has('qualityControl')) {\n                                                    // Benutzernamen auf 4 Zeichen krzen\n                                                    const qualityControlValue = task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}` : '-';\n                                                    const shortenedName = qualityControlValue.length > 4 && qualityControlValue !== '-' ? qualityControlValue.substring(0, 4) : qualityControlValue;\n                                                    metadata.push({\n                                                        icon: <UserIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.qualityControl'),\n                                                        value: shortenedName,\n                                                        section: 'main-second'\n                                                    });\n                                                }\n                                                \n                                                // Rechts: Flligkeit (erste Zeile rechts, neben Status)\n                                                if (visibleCardMetadata.has('dueDate')) {\n                                                    const dueDateItem = createDueDateMetadataItem(\n                                                        task.dueDate,\n                                                        'todo',\n                                                        task.title,\n                                                        task.description,\n                                                        <CalendarIcon className=\"h-4 w-4\" />,\n                                                        t('tasks.columns.dueDate'),\n                                                        (date) => format(date, 'dd.MM.yyyy', { locale: de }),\n                                                        false // Keine Badge-Art, nur Text\n                                                    );\n                                                    metadata.push({\n                                                        ...dueDateItem,\n                                                        section: 'right-inline' // Neue Section fr inline rechts (neben Status)\n                                                    });\n                                                }\n                                                \n                                                // Full-Width: Beschreibung\n                                                if (visibleCardMetadata.has('description') && task.description) {\n                                                    metadata.push({\n                                                        label: t('tasks.columns.description'),\n                                                        value: '',\n                                                        descriptionContent: task.description,\n                                                        attachmentMetadata: task.attachments || [], // Attachment-Metadaten fr Vorschau\n                                                        section: 'full'\n                                                    });\n                                                }\n                                                \n                                                // Action-Buttons\n                                                const actionButtons = (\n                                                    <div className=\"flex items-center space-x-2\">\n                                                        {/* Status-Buttons */}\n                                                        <div className=\"status-buttons\">\n                                                            {renderStatusButtons(task)}\n                                                        </div>\n                                                        {hasPermission('tasks', 'write', 'table') && (\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedTask(task);\n                                                                    setIsEditModalOpen(true);\n                                                                }}\n                                                                                    className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                >\n                                                                <PencilIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                        )}\n                                                        {hasPermission('tasks', 'both', 'table') && (\n                                                            <div className=\"relative group\">\n                                                                <button\n                                                                    onClick={(e) => {\n                                                                        e.stopPropagation();\n                                                                        handleCopyTask(task);\n                                                                    }}\n                                                                    className=\"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                                                                >\n                                                                    <DocumentDuplicateIcon className=\"h-4 w-4\" />\n                                                                </button>\n                                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                    {t('tasks.actions.copy')}\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                );\n                                                \n                                                return (\n                                                    <DataCard\n                                                        key={task.id}\n                                                        title={\n                                                          <span>\n                                                            <span className=\"text-xs text-gray-600 dark:text-gray-400\">{task.id}:</span>{' '}\n                                                            <span>{task.title}</span>\n                                                          </span>\n                                                        }\n                                                        status={{\n                                                            label: getStatusText(task.status, 'task', t),\n                                                            color: getStatusColor(task.status, 'task'),\n                                                            onPreviousClick: undefined,\n                                                            onNextClick: undefined\n                                                        }}\n                                                        metadata={metadata}\n                                                        actions={actionButtons}\n                                                    />\n                                                );\n                                            })}\n                                        </CardGrid>\n                                    )}\n                                </div>\n                            ) : null}\n                            \n                            {/* Reservations Rendering - Desktop - Cards */}\n                            {activeTab === 'reservations' && viewMode === 'cards' && (\n                                <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n                                    {reservationsLoading ? (\n                                        <div className=\"flex justify-center py-12\">\n                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                        </div>\n                                    ) : reservationsError ? (\n                                        <div className=\"flex justify-center py-12 text-red-600 dark:text-red-400\">\n                                            {reservationsError}\n                                        </div>\n                                    ) : filteredAndSortedReservations.length === 0 ? (\n                                        <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n                                            <CalendarIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n                                            <div className=\"text-sm\">\n                                                {reservationSearchTerm || reservationFilterStatus !== 'all' || reservationFilterPaymentStatus !== 'all'\n                                                    ? t('reservations.noResults', 'Keine Reservations gefunden')\n                                                    : t('reservations.noReservations', 'Keine Reservations vorhanden')}\n                                            </div>\n                                        </div>\n                                    ) : (\n                                        <CardGrid>\n                                            {filteredAndSortedReservations.map(reservation => {\n                                                const formatDate = (dateString: string) => {\n                                                    try {\n                                                        // Extrahiere nur den Datumsteil (YYYY-MM-DD) und parse als lokales Datum\n                                                        // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\n                                                        const date = new Date(dateString);\n                                                        // Verwende UTC-Methoden, um nur den Datumsteil zu extrahieren (ohne Zeitzone)\n                                                        const year = date.getUTCFullYear();\n                                                        const month = date.getUTCMonth();\n                                                        const day = date.getUTCDate();\n                                                        // Erstelle lokales Datum aus den UTC-Werten\n                                                        const localDate = new Date(year, month, day);\n                                                        return format(localDate, 'dd.MM.yyyy', { locale: de });\n                                                    } catch {\n                                                        return dateString;\n                                                    }\n                                                };\n                                                \n                                                // Metadaten fr Reservation-Card\n                                                const metadata: MetadataItem[] = [];\n                                                \n                                                // Haupt-Metadaten: Check-in/Check-out (rechts oben, unverndert)\n                                                metadata.push({\n                                                    icon: <CalendarIcon className=\"h-4 w-4\" />,\n                                                    label: t('reservations.checkInOut', 'Check-in/Check-out'),\n                                                    value: `${formatDate(reservation.checkInDate)} - ${formatDate(reservation.checkOutDate)}`,\n                                                    section: 'main'\n                                                });\n                                                \n                                                // Zweite Zeile: Zimmernummer\n                                                if (reservation.roomNumber) {\n                                                    metadata.push({\n                                                        icon: <HomeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.roomNumber,\n                                                        section: 'main-second'\n                                                    });\n                                                }\n                                                \n                                                // Links: Telefon/Email unter Titel (gleiche Zeile wie Status)\n                                                if (reservation.guestEmail) {\n                                                    metadata.push({\n                                                        icon: <EnvelopeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.guestEmail,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                if (reservation.guestPhone) {\n                                                    metadata.push({\n                                                        icon: <PhoneIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.guestPhone,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Links: Branch (nach Telefon/Email)\n                                                if (reservation.branch) {\n                                                    metadata.push({\n                                                        icon: <BuildingOfficeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.branch.name,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Mitte: Zahlungslink (gleiche Hhe wie Payment Status)\n                                                if (reservation.paymentLink) {\n                                                    metadata.push({\n                                                        icon: <LinkIcon className=\"h-4 w-4\" />,\n                                                        value: (\n                                                            <a \n                                                                href={reservation.paymentLink} \n                                                                target=\"_blank\" \n                                                                rel=\"noopener noreferrer\"\n                                                                onClick={(e) => e.stopPropagation()}\n                                                                className=\"text-gray-900 dark:text-white break-all\"\n                                                            >\n                                                                {t('reservations.paymentLink', 'Zahlungslink')}\n                                                            </a>\n                                                        ),\n                                                        section: 'center'\n                                                    });\n                                                }\n                                                \n                                                // Mitte: Check-in Link (direkt unter Zahlungslink)\n                                                // WICHTIG: Verwende lobbyReservationId (LobbyPMS booking_id) als codigo, nicht die interne ID\n                                                const codigo = reservation.lobbyReservationId || reservation.id.toString();\n                                                const checkInLink = reservation.guestEmail \n                                                    ? `https://app.lobbypms.com/checkinonline/confirmar?codigo=${codigo}&email=${encodeURIComponent(reservation.guestEmail)}&lg=GB`\n                                                    : null;\n                                                if (checkInLink) {\n                                                    metadata.push({\n                                                    icon: <LinkIcon className=\"h-4 w-4\" />,\n                                                    value: (\n                                                        <div className=\"relative group\">\n                                                            <a \n                                                                href={checkInLink} \n                                                                target=\"_blank\" \n                                                                rel=\"noopener noreferrer\"\n                                                                onClick={(e) => e.stopPropagation()}\n                                                                className=\"text-gray-900 dark:text-white\"\n                                                            >\n                                                                {t('reservations.checkInLink', 'Check-in Link')}\n                                                            </a>\n                                                            <div className=\"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {checkInLink}\n                                                            </div>\n                                                        </div>\n                                                    ),\n                                                    section: 'center'\n                                                    });\n                                                }\n                                                \n                                                // Rechts: Reservation Status als erstes Badge (mit Label)\n                                                metadata.push({\n                                                    label: t('reservations.status', 'Status'),\n                                                    value: (\n                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getReservationStatusColor(reservation.status)}`}>\n                                                            {t(`reservations.status.${reservation.status}`, reservation.status)}\n                                                        </span>\n                                                    ),\n                                                    section: 'right'\n                                                });\n                                                \n                                                // Rechts: Payment Status als zweites Badge (direkt unter Reservation Status)\n                                                metadata.push({\n                                                    label: t('reservations.paymentStatus', 'Zahlungsstatus'),\n                                                    value: (\n                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getPaymentStatusColor(reservation.paymentStatus)}`}>\n                                                            {t(`reservations.paymentStatus.${reservation.paymentStatus}`, reservation.paymentStatus)}\n                                                        </span>\n                                                    ),\n                                                    section: 'right'\n                                                });\n                                                \n                                                // Betrag und Whrung (wenn vorhanden)\n                                                if (reservation.amount) {\n                                                    const amountValue = typeof reservation.amount === 'string' \n                                                        ? parseFloat(reservation.amount).toFixed(2)\n                                                        : typeof reservation.amount === 'number'\n                                                        ? reservation.amount.toFixed(2)\n                                                        : '0.00';\n                                                    metadata.push({\n                                                        icon: <CurrencyDollarIcon className=\"h-4 w-4\" />,\n                                                        label: t('reservations.amount', 'Betrag'),\n                                                        value: `${amountValue} ${reservation.currency || 'COP'}`,\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Ankunftszeit (wenn vorhanden)\n                                                if (reservation.arrivalTime) {\n                                                    const formatDateTime = (dateString: string) => {\n                                                        try {\n                                                            return format(new Date(dateString), 'dd.MM.yyyy HH:mm', { locale: de });\n                                                        } catch {\n                                                            return dateString;\n                                                        }\n                                                    };\n                                                    metadata.push({\n                                                        icon: <ClockIcon className=\"h-4 w-4\" />,\n                                                        label: t('reservations.arrivalTime', 'Ankunftszeit'),\n                                                        value: formatDateTime(reservation.arrivalTime),\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Tr-PIN (wenn vorhanden)\n                                                if (reservation.doorPin) {\n                                                    metadata.push({\n                                                        icon: <KeyIcon className=\"h-4 w-4\" />,\n                                                        label: reservation.doorAppName || t('reservations.doorPin', 'Tr-PIN'),\n                                                        value: reservation.doorPin,\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Online Check-in Status\n                                                if (reservation.onlineCheckInCompleted) {\n                                                    metadata.push({\n                                                        icon: <CheckCircleIcon className=\"h-4 w-4 text-green-600\" />,\n                                                        label: t('reservations.onlineCheckIn', 'Online Check-in'),\n                                                        value: t('reservations.completed', 'Abgeschlossen'),\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Action-Buttons fr Einladung senden und PIN-Generierung\n                                                const hasWritePermission = hasPermission('reservations', 'write', 'table');\n                                                const actionButtons = hasWritePermission ? (\n                                                    <div className=\"flex items-center space-x-2\">\n                                                        {/* Einladung senden Button */}\n                                                        <div className=\"relative group\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedReservationForInvitation(reservation);\n                                                                    setIsSendInvitationSidepaneOpen(true);\n                                                                }}\n                                                                className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                            >\n                                                                <PaperAirplaneIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                            <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {t('reservations.sendInvitation.title')}\n                                                            </div>\n                                                        </div>\n                                                        \n                                                        {/* Key-Button fr PIN-Generierung */}\n                                                        <div className=\"relative group\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedReservationForPasscode(reservation);\n                                                                    setIsSendPasscodeSidepaneOpen(true);\n                                                                }}\n                                                                className=\"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300\"\n                                                            >\n                                                                <KeyIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                            <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {t('reservations.sendPasscode.title')}\n                                                            </div>\n                                                        </div>\n                                                    </div>\n                                                ) : null;\n                                                \n                                                // Expandable Content fr Details - zeigt alle Notification-Logs\n                                                const isExpanded = expandedReservationRows.has(reservation.id);\n                                                const expandableContent = (\n                                                    <div className=\"mt-2 pt-3\">\n                                                        <ReservationNotificationLogs reservationId={reservation.id} />\n                                                    </div>\n                                                );\n                                                \n                                                return (\n                                                    <DataCard\n                                                        key={reservation.id}\n                                                        title={reservation.guestName}\n                                                        subtitle={reservation.lobbyReservationId ? `ID: ${reservation.lobbyReservationId}` : undefined}\n                                                        metadata={metadata}\n                                                        actions={actionButtons}\n                                                        expandable={expandableContent ? {\n                                                            isExpanded: isExpanded,\n                                                            content: expandableContent,\n                                                            onToggle: () => toggleReservationExpanded(reservation.id)\n                                                        } : undefined}\n                                                    />\n                                                );\n                                            })}\n                                        </CardGrid>\n                                    )}\n                                </div>\n                            )}\n                            \n                            {/*  PAGINATION: Infinite Scroll Trigger fr Reservations (Desktop) */}\n                            {activeTab === 'reservations' && reservationsHasMore && (\n                                <div ref={reservationsLoadMoreRef} className=\"flex justify-center py-4\">\n                                    {reservationsLoadingMore && (\n                                        <CircularProgress size={24} />\n                                    )}\n                                </div>\n                            )}\n                            \n                            {/* Reservations Rendering - Desktop - Tabelle */}\n                            {activeTab === 'reservations' && viewMode === 'table' && (\n                                <div className=\"overflow-x-auto\">\n                                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                        <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <tr>\n                                                {visibleColumnIds.map((columnId) => {\n                                                    const column = availableReservationColumns.find(col => col.id === columnId);\n                                                    if (!column) return null;\n                                                    \n                                                    return (\n                                                        <th\n                                                            key={columnId}\n                                                            scope=\"col\"\n                                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                                            draggable={true}\n                                                            onDragStart={() => handleDragStart(columnId)}\n                                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                                            onDrop={(e) => handleDrop(e, columnId)}\n                                                            onDragEnd={handleDragEnd}\n                                                        >\n                                                            <div className=\"flex items-center\">\n                                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                                {columnId !== 'actions' && (\n                                                                    <button \n                                                                        onClick={() => handleReservationSort(columnId as ReservationSortConfig['key'])}\n                                                                        className=\"ml-1 focus:outline-none\"\n                                                                    >\n                                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                                    </button>\n                                                                )}\n                                                            </div>\n                                                        </th>\n                                                    );\n                                                })}\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                            {reservationsLoading ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-4 text-center\">\n                                                        <div className=\"flex justify-center\">\n                                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : reservationsError ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-red-600 dark:text-red-400\">\n                                                        {reservationsError}\n                                                    </td>\n                                                </tr>\n                                            ) : filteredAndSortedReservations.length === 0 ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                                                        <div className=\"flex flex-col items-center justify-center gap-4\">\n                                                            <CalendarIcon className=\"h-10 w-10 text-gray-400 dark:text-gray-500\" />\n                                                            <div className=\"text-sm\">\n                                                                {reservationSearchTerm || reservationFilterStatus !== 'all' || reservationFilterPaymentStatus !== 'all'\n                                                                    ? t('reservations.noResults', 'Keine Reservations gefunden')\n                                                                    : t('reservations.noReservations', 'Keine Reservations vorhanden')}\n                                                            </div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : (\n                                                <>\n                                                    {filteredAndSortedReservations.map(reservation => {\n                                                        const formatDate = (dateString: string) => {\n                                                            try {\n                                                                return format(new Date(dateString), 'dd.MM.yyyy', { locale: de });\n                                                            } catch {\n                                                                return dateString;\n                                                            }\n                                                        };\n                                                        \n                                                        return (\n                                                            <tr \n                                                                key={reservation.id} \n                                                                className=\"hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer\"\n                                                                onClick={() => navigate(`/reservations/${reservation.id}`)}\n                                                            >\n                                                                {visibleColumnIds.map(columnId => {\n                                                                    switch (columnId) {\n                                                                        case 'guestName':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words\">\n                                                                                        {reservation.guestName}\n                                                                                        {reservation.lobbyReservationId && (\n                                                                                            <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                                                                                ID: {reservation.lobbyReservationId}\n                                                                                            </div>\n                                                                                        )}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'status':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getReservationStatusColor(reservation.status)}`}>\n                                                                                        {t(`reservations.status.${reservation.status}`, reservation.status)}\n                                                                                    </span>\n                                                                                </td>\n                                                                            );\n                                                                        case 'paymentStatus':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getPaymentStatusColor(reservation.paymentStatus)}`}>\n                                                                                        {t(`reservations.paymentStatus.${reservation.paymentStatus}`, reservation.paymentStatus)}\n                                                                                    </span>\n                                                                                </td>\n                                                                            );\n                                                                        case 'checkInDate':\n                                                                        case 'checkOutDate':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {formatDate(columnId === 'checkInDate' ? reservation.checkInDate : reservation.checkOutDate)}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'roomNumber':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.roomNumber || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'branch':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.branch?.name || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'guestEmail':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.guestEmail || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'guestPhone':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.guestPhone || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'amount':\n                                                                            const amountValue = typeof reservation.amount === 'string' \n                                                                                ? parseFloat(reservation.amount).toFixed(2)\n                                                                                : typeof reservation.amount === 'number'\n                                                                                ? reservation.amount.toFixed(2)\n                                                                                : '0.00';\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {amountValue} {reservation.currency || 'COP'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'arrivalTime':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.arrivalTime ? format(new Date(reservation.arrivalTime), 'dd.MM.yyyy HH:mm', { locale: de }) : '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'actions':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"flex space-x-2 action-buttons\">\n                                                                                        {hasPermission('reservations', 'write', 'table') && (\n                                                                                            <>\n                                                                                                {/* Einladung senden Button */}\n                                                                                                <div className=\"relative group\">\n                                                                                                    <button\n                                                                                                        onClick={(e) => {\n                                                                                                            e.stopPropagation();\n                                                                                                            setSelectedReservationForInvitation(reservation);\n                                                                                                            setIsSendInvitationSidepaneOpen(true);\n                                                                                                        }}\n                                                                                                        className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                                    >\n                                                                                                        <PaperAirplaneIcon className=\"h-4 w-4\" />\n                                                                                                    </button>\n                                                                                                    <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                                        {t('reservations.sendInvitation.title')}\n                                                                                                    </div>\n                                                                                                </div>\n                                                                                                \n                                                                                                {/* Key-Button fr PIN-Generierung */}\n                                                                                                <div className=\"relative group\">\n                                                                                                    <button\n                                                                                                        onClick={(e) => {\n                                                                                                            e.stopPropagation();\n                                                                                                            setSelectedReservationForPasscode(reservation);\n                                                                                                            setIsSendPasscodeSidepaneOpen(true);\n                                                                                                        }}\n                                                                                                        className=\"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300\"\n                                                                                                    >\n                                                                                                        <KeyIcon className=\"h-4 w-4\" />\n                                                                                                    </button>\n                                                                                                    <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                                        {t('reservations.sendPasscode.title')}\n                                                                                                    </div>\n                                                                                                </div>\n                                                                                                \n                                                                                                {/* Details Button */}\n                                                                                                <div className=\"relative group\">\n                                                                                                    <button\n                                                                                                        onClick={(e) => {\n                                                                                                            e.stopPropagation();\n                                                                                                            navigate(`/reservations/${reservation.id}`);\n                                                                                                        }}\n                                                                                                        className=\"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                                    >\n                                                                                                        <InformationCircleIcon className=\"h-4 w-4\" />\n                                                                                                    </button>\n                                                                                                    <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                                        {t('common.viewDetails')}\n                                                                                                    </div>\n                                                                                                </div>\n                                                                                            </>\n                                                                                        )}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        default:\n                                                                            return null;\n                                                                    }\n                                                                })}\n                                                            </tr>\n                                                        );\n                                                    })}\n                                                </>\n                                            )}\n                                        </tbody>\n                                    </table>\n                                </div>\n                            )}\n                            \n                            {/*  PAGINATION: Infinite Scroll Trigger fr Tasks */}\n                            {activeTab === 'todos' && tasksHasMore && (\n                                <div ref={tasksLoadMoreRef} className=\"flex justify-center py-4\">\n                                    {tasksLoadingMore && (\n                                        <CircularProgress size={24} />\n                                    )}\n                                </div>\n                            )}\n                            \n                            {/*  PAGINATION: Infinite Scroll Trigger fr Tour Bookings */}\n                            {activeTab === 'tourBookings' && tourBookingsHasMore && (\n                                <div ref={tourBookingsLoadMoreRef} className=\"flex justify-center py-4\">\n                                    {tourBookingsLoadingMore && (\n                                        <CircularProgress size={24} />\n                                                    )}\n                                                </div>\n                            )}\n                            \n                            \n                                                    </div>\n                                            </div>\n                                </div>\n            </div>\n            \n            {/* Die Modals fr beide Ansichten (mobil und desktop) */}\n            <CreateTaskModal \n                isOpen={isCreateModalOpen}\n                onClose={() => setIsCreateModalOpen(false)}\n                onTaskCreated={(newTask) => {\n                    // Optimistisches Update: Neuen Task zur Liste hinzufgen statt vollstndigem Reload\n                    if (newTask != null) {\n                        setTasks(prevTasks => {\n                            const validTasks = prevTasks.filter(task => task != null);\n                            return [newTask, ...validTasks];\n                        });\n                        setIsEditModalOpen(true);\n                        setSelectedTask(newTask);\n                    }\n                }}\n            />\n            \n            {selectedTask && (\n                <EditTaskModal\n                    isOpen={isEditModalOpen}\n                    onClose={() => {\n                        setIsEditModalOpen(false);\n                        setSelectedTask(null);\n                    }}\n                    onTaskUpdated={(updatedTask) => {\n                        // Optimistisches Update: Task in Liste aktualisieren statt vollstndigem Reload\n                        if (updatedTask != null) {\n                            setTasks(prevTasks => \n                                prevTasks\n                                    .filter(task => task != null)\n                                    .map(task => \n                                        task.id === updatedTask.id ? updatedTask : task\n                                    )\n                            );\n                            setIsEditModalOpen(false);\n                            setSelectedTask(null);\n                            toast.success(t('worktime.messages.taskUpdated'));\n                        }\n                    }}\n                    task={selectedTask}\n                />\n            )}\n            \n            {/* Create Reservation Modal */}\n            <CreateReservationModal\n                isOpen={isCreateReservationModalOpen}\n                onClose={() => setIsCreateReservationModalOpen(false)}\n                onReservationCreated={async (newReservation) => {\n                    // Wechsle zum Reservations-Tab\n                    setActiveTab('reservations');\n                    // Lade Reservations neu, um den aktualisierten Status zu erhalten\n                    await loadReservations(undefined, undefined, false, 20, 0); //  PAGINATION: limit=20, offset=0\n                }}\n            />\n            \n            {/* Send Invitation Sidepane */}\n            {selectedReservationForInvitation && (\n                <SendInvitationSidepane\n                    isOpen={isSendInvitationSidepaneOpen}\n                    onClose={() => {\n                        setIsSendInvitationSidepaneOpen(false);\n                        setSelectedReservationForInvitation(null);\n                    }}\n                    reservation={selectedReservationForInvitation}\n                    onSuccess={async () => {\n                        // Lade Reservations neu, um den aktualisierten Status zu erhalten\n                        await loadReservations(undefined, undefined, false, 20, 0); //  PAGINATION: limit=20, offset=0\n                    }}\n                />\n            )}\n\n            {/* Send Passcode Sidepane */}\n            {selectedReservationForPasscode && (\n                <SendPasscodeSidepane\n                    isOpen={isSendPasscodeSidepaneOpen}\n                    onClose={() => {\n                        setIsSendPasscodeSidepaneOpen(false);\n                        setSelectedReservationForPasscode(null);\n                    }}\n                    reservation={selectedReservationForPasscode}\n                    onSuccess={async () => {\n                        // Lade Reservations neu, um den aktualisierten Status zu erhalten\n                        await loadReservations(undefined, undefined, false, 20, 0); //  PAGINATION: limit=20, offset=0\n                    }}\n                />\n            )}\n            \n            {/* Tour Bookings Tab Content */}\n            {activeTab === 'tourBookings' && (\n                <div className=\"space-y-4\">\n                    {/* Header mit Create-Button */}\n                    <div className=\"flex justify-between items-center\">\n                        <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                            {t('tourBookings.title', 'Tour-Buchungen')}\n                        </h2>\n                        {hasPermission('tour_bookings', 'write', 'table') && (\n                            <button\n                                onClick={() => setIsCreateTourBookingModalOpen(true)}\n                                className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors\"\n                            >\n                                <PlusIcon className=\"h-5 w-5\" />\n                                {t('tourBookings.create', 'Neue Buchung')}\n                            </button>\n                        )}\n                    </div>\n\n                    {/* Suche */}\n                    <div className=\"max-w-md\">\n                        <input\n                            type=\"text\"\n                            placeholder={t('common.search', 'Suchen...')}\n                            value={tourBookingsSearchTerm}\n                            onChange={(e) => setTourBookingsSearchTerm(e.target.value)}\n                            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                        />\n                    </div>\n\n                    {tourBookingsLoading ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                            {t('common.loading')}\n                        </div>\n                    ) : tourBookingsError ? (\n                        <div className=\"text-center py-8 text-red-500 dark:text-red-400\">\n                            {tourBookingsError}\n                        </div>\n                    ) : tourBookings.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                            {t('tourBookings.noBookings', 'Keine Buchungen vorhanden')}\n                        </div>\n                    ) : (\n                        <div className=\"overflow-x-auto\">\n                            <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                                    <tr>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.tour', 'Tour')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.customerName', 'Kunde')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.tourDate', 'Tour-Datum')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.numberOfParticipants', 'Teilnehmer')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.totalPrice', 'Gesamtpreis')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.paymentStatus', 'Zahlungsstatus')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.status', 'Status')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.bookedBy', 'Gebucht von')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('common.actions', 'Aktionen')}\n                                        </th>\n                                    </tr>\n                                </thead>\n                                <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                    {tourBookings\n                                        .filter(booking => {\n                                            if (!tourBookingsSearchTerm) return true;\n                                            const search = tourBookingsSearchTerm.toLowerCase();\n                                            return (\n                                                booking.customerName?.toLowerCase().includes(search) ||\n                                                booking.customerEmail?.toLowerCase().includes(search) ||\n                                                booking.tour?.title?.toLowerCase().includes(search) ||\n                                                booking.customerPhone?.includes(search)\n                                            );\n                                        })\n                                        .map((booking) => (\n                                            <tr key={booking.id} className=\"hover:bg-gray-50 dark:hover:bg-gray-700\">\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <div className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                                                        {booking.tour?.title || '-'}\n                                                    </div>\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <div className=\"text-sm text-gray-900 dark:text-white\">\n                                                        {booking.customerName}\n                                                    </div>\n                                                    {booking.customerEmail && (\n                                                        <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                                            {booking.customerEmail}\n                                                        </div>\n                                                    )}\n                                                    {booking.customerPhone && (\n                                                        <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                                            {booking.customerPhone}\n                                                        </div>\n                                                    )}\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <div className=\"text-sm text-gray-900 dark:text-white\">\n                                                        {format(new Date(booking.tourDate), 'dd.MM.yyyy', { locale: de })}\n                                                    </div>\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <div className=\"text-sm text-gray-900 dark:text-white\">\n                                                        {booking.numberOfParticipants}\n                                                    </div>\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <div className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                        {Number(booking.totalPrice).toLocaleString()} {booking.currency}\n                                                    </div>\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <span className={`px-2 py-1 text-xs rounded-full ${\n                                                        booking.paymentStatus === 'paid' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' :\n                                                        booking.paymentStatus === 'partially_paid' ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200' :\n                                                        booking.paymentStatus === 'pending' ? 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200' :\n                                                        'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'\n                                                    }`}>\n                                                        {t(`tourBookings.paymentStatus.${booking.paymentStatus}`, booking.paymentStatus)}\n                                                    </span>\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <span className={`px-2 py-1 text-xs rounded-full ${\n                                                        booking.status === 'confirmed' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' :\n                                                        booking.status === 'cancelled' ? 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200' :\n                                                        booking.status === 'completed' ? 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200' :\n                                                        'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                                    }`}>\n                                                        {t(`tourBookings.status.${booking.status}`, booking.status)}\n                                                    </span>\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    {booking.bookedBy ? (\n                                                        <div className=\"text-sm text-gray-900 dark:text-white\">\n                                                            {booking.bookedBy.firstName} {booking.bookedBy.lastName}\n                                                        </div>\n                                                    ) : (\n                                                        <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                                            -\n                                                        </div>\n                                                    )}\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                                                    <div className=\"flex items-center gap-2\">\n                                                        {hasPermission('tour_bookings', 'write', 'table') && (\n                                                            <button\n                                                                onClick={() => {\n                                                                    setSelectedBookingForEdit(booking);\n                                                                    setIsEditTourBookingModalOpen(true);\n                                                                }}\n                                                                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300\"\n                                                                title={t('common.edit', 'Bearbeiten')}\n                                                            >\n                                                                <PencilIcon className=\"h-5 w-5\" />\n                                                            </button>\n                                                        )}\n                                                        <button\n                                                            onClick={() => {\n                                                                setSelectedBookingForLink(booking);\n                                                                setIsTourReservationLinkModalOpen(true);\n                                                            }}\n                                                            className=\"text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300\"\n                                                            title={t('tours.reservationLink.title', 'Mit Reservation verknpfen')}\n                                                        >\n                                                            <LinkIcon className=\"h-5 w-5\" />\n                                                        </button>\n                                                    </div>\n                                                </td>\n                                            </tr>\n                                        ))}\n                                </tbody>\n                            </table>\n                        </div>\n                    )}\n                </div>\n            )}\n            \n            {/* Create Tour Booking Modal */}\n            <CreateTourBookingModal\n                isOpen={isCreateTourBookingModalOpen}\n                onClose={() => setIsCreateTourBookingModalOpen(false)}\n                onBookingCreated={async (newBooking) => {\n                    await loadTourBookings();\n                }}\n            />\n\n            {/* Edit Tour Booking Modal */}\n            <EditTourBookingModal\n                isOpen={isEditTourBookingModalOpen}\n                onClose={() => {\n                    setIsEditTourBookingModalOpen(false);\n                    setSelectedBookingForEdit(null);\n                }}\n                booking={selectedBookingForEdit}\n                onBookingUpdated={async (updatedBooking) => {\n                    await loadTourBookings();\n                }}\n            />\n\n            {/* Tour Reservation Link Modal */}\n            {selectedBookingForLink && (\n                <TourReservationLinkModal\n                    isOpen={isTourReservationLinkModalOpen}\n                    onClose={() => {\n                        setIsTourReservationLinkModalOpen(false);\n                        setSelectedBookingForLink(null);\n                    }}\n                    booking={selectedBookingForLink}\n                    onLinked={async () => {\n                        await loadTourBookings();\n                    }}\n                />\n            )}\n        </div>\n    );\n};\n\nexport default Worktracker; "],"names":["ReservationStatus","PaymentStatus","API_BASE","reservationService","create","data","console","log","response","axiosInstance","post","getById","id","get","concat","updateGuestContact","contact","put","generatePinAndSend","API_ENDPOINTS","RESERVATION","GENERATE_PIN_AND_SEND","sendInvitation","options","SEND_INVITATION","sendPasscode","SEND_PASSCODE","getNotificationLogs","NOTIFICATION_LOGS","Array","isArray","notificationLogs","whatsappMessages","_ref","isOpen","onClose","onBookingCreated","tour","preselectedTour","t","useTranslation","user","useAuth","showMessage","useMessage","tourId","setTourId","useState","tourDate","setTourDate","numberOfParticipants","setNumberOfParticipants","customerName","setCustomerName","customerEmail","setCustomerEmail","customerPhone","setCustomerPhone","customerNotes","setCustomerNotes","tours","setTours","selectedTour","setSelectedTour","error","setError","loading","setLoading","loadingData","setLoadingData","useEffect","async","_response$data","TOURS","BASE","params","isActive","toursData","err","loadData","find","Number","_jsxs","Dialog","open","className","children","_jsx","Panel","Title","defaultValue","onClick","XMarkIcon","onSubmit","e","preventDefault","Date","trim","length","numPart","minParticipants","min","max","maxParticipants","_response$data2","_response$data3","TOUR_BOOKINGS","_response$data4","success","Error","message","_err$response","_err$response$data","errorMessage","value","onChange","target","required","disabled","filter","title","map","type","undefined","rows","reservationId","refreshKey","i18n","logs","setLogs","setWhatsappMessages","getLocale","language","de","es","enUS","formatDateTime","dateString","format","locale","_unused","getNotificationTypeLabel","getChannelIcon","channel","PhoneIcon","EnvelopeIcon","PaperAirplaneIcon","getNotificationTypeIcon","KeyIcon","CheckCircleIcon","loadLogs","allMessages","timestamp","sentAt","msg","sort","a","b","getTime","item","XCircleIcon","notificationType","ClockIcon","sentTo","paymentLink","checkInLink","href","rel","isIncoming","direction","isFailed","status","ArrowDownIcon","ArrowUpIcon","phoneNumber","onArticleSelected","excludeArticleIds","selectedArticles","onArticleRemove","articles","setArticles","selectedArticleId","setSelectedArticleId","selectedArticlePreview","setSelectedArticlePreview","filteredArticles","CEREBRO","ARTICLES","article","includes","_axiosError$response","_axiosError$response$","axiosError","fetchAllArticles","articleId","parseInt","isNaN","BY_ID","fetchArticleDetails","handleArticleConfirm","selectedArticle","content","substring","slug","TaskForm","_ref2","setTitle","description","setDescription","assigneeType","setAssigneeType","responsibleId","setResponsibleId","roleId","setRoleId","qualityControlId","setQualityControlId","branchId","setBranchId","dueDate","setDueDate","users","roles","branches","handleSubmit","handleClose","onArticleSelect","uploading","temporaryAttachments","onFileUpload","onRemoveAttachment","textareaRef","fileInputRef","handlePaste","handleDrop","handleDragOver","activeTab","setActiveTab","noValidate","_Fragment","htmlFor","ref","onPaste","onDrop","onDragOver","placeholder","_fileInputRef$current","current","click","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","attachment","index","fileName","fileType","startsWith","file","src","URL","createObjectURL","alt","name","checked","firstName","lastName","role","branch","CerebroArticleSelector","ArrowPathIcon","CheckIcon","onTaskCreated","openSidepane","closeSidepane","useSidepane","isLargeScreen","setIsLargeScreen","window","innerWidth","setUsers","setRoles","setBranches","isMobile","setIsMobile","setSelectedArticles","setTemporaryAttachments","setUploading","useRef","fetchUsers","fetchRoles","fetchBranches","getDefaultDueDate","date","setDate","getDate","toISOString","split","checkScreenSize","addEventListener","removeEventListener","localStorage","getItem","USERS","DROPDOWN","code","ROLES","_axiosError$response2","_axiosError$response3","BRANCHES","_axiosError$response4","_axiosError$response5","items","event","clipboardData","i","indexOf","getAsFile","handleTemporaryAttachment","stopPropagation","dataTransfer","files","newAttachment","fileSize","size","prev","insertText","cursorPos","selectionStart","textBefore","textAfter","setTimeout","newPos","selectionEnd","focus","_axiosError$response6","_axiosError$response7","handleFileUpload","handleRemoveTemporaryAttachment","attachmentToRemove","_","escapedFileName","replace","uploadText","imagePattern","RegExp","linkPattern","newDescription","qualityControl","responsible","taskData","TASKS","newTaskId","Promise","all","LINK_CARTICLE","formData","FormData","append","ATTACHMENTS","taskId","headers","uploadTemporaryAttachments","_axiosError$response8","_axiosError$response9","handleAddArticle","handleRemoveArticle","style","opacity","transition","pointerEvents","_task$title","_task$title2","_task$title3","_task$title4","_task$description","task","isLifecycleTask","autoGeneratedData","jsonMatch","match","JSON","parse","forEach","line","key","Object","keys","taskType","ClipboardDocumentIcon","dataString","stringify","navigator","clipboard","writeText","entries","String","emailTemplate","setEmailTemplate","emailSent","setEmailSent","generating","setGenerating","template","_error$response","_error$response$data","resolve","_error$response2","_error$response2$data","onComplete","setFormData","registrationNumber","provider","registrationDate","notes","socialSecurityType","getSocialSecurityType","_task$title5","_task$title6","_task$title7","_task$title8","userId","extractUserId","userIdMatch","LIFECYCLE","SOCIAL_SECURITY","completedAt","_objectSpread","_task$qualityControl","_task$branch","onTaskUpdated","hasPermission","usePermissions","text","originalDescription","setStatus","attachments","setAttachments","uploadedDuringEdit","setUploadedDuringEdit","formatDate","confirmDelete","setConfirmDelete","linkedArticles","setLinkedArticles","canDeleteTask","handleResize","attachmentId","delete","ATTACHMENT","cleanup","fetchLinkedArticles","fetchAttachments","CARTICLES","uploadFileAndInsertLink","getTaskAttachmentUrl","_axiosError$response10","_axiosError$response11","finalDescription","imageAttachments","att","_att$fileType","existingImagePattern","existingImages","exec","push","imageUrl","imageMarkdown","test","existingImage","updatedTaskResponse","filePath","uploadedAt","url","_axiosError$response12","_axiosError$response13","handleDelete","_axiosError$response14","_axiosError$response15","_axiosError$response16","_axiosError$response17","UNLINK_CARTICLE","_axiosError$response18","_axiosError$response19","renderForm","renderAttachments","renderTemporaryAttachments","TaskDataBox","EmailTemplateBox","SocialSecurityCompletionBox","TrashIcon","responseType","Blob","link","document","createElement","setAttribute","body","appendChild","remove","_axiosError$response22","_axiosError$response23","handleDownloadAttachment","escapedAttachmentUrl","_axiosError$response20","_axiosError$response21","handleDeleteAttachment","_attachment$fileType","onReservationCreated","guestName","setGuestName","setContact","amount","setAmount","currency","setCurrency","contactType","setContactType","handleContactChange","detectContactType","handleAmountChange","parseFloat","newReservation","_err$response2","_err$response3","_err$response3$data","_booking$tour","booking","onBookingUpdated","loadTour","tourDateObj","year","getFullYear","month","getMonth","padStart","day","hours","getHours","minutes","getMinutes","onLinked","reservations","setReservations","selectedReservationId","setSelectedReservationId","tourPrice","setTourPrice","accommodationPrice","setAccommodationPrice","loadingReservations","setLoadingReservations","existingLinks","setExistingLinks","loadReservations","loadExistingLinks","totalPrice","TOUR_RESERVATIONS","BY_BOOKING","selectedReservation","r","reservationAmount","isValid","LinkIcon","bookingId","res","resAmount","currentTourPrice","reservation","checkInDate","checkOutDate","toLocaleString","step","_link$reservation","confirm","linkId","_err$response2$data","handleDeleteLink","CountryLanguageService","getLanguageForCountry","countryName","normalized","toLowerCase","this","COUNTRY_LANGUAGE_MAP","country","getLanguageForReservation","guestNationality","onSuccess","guestPhone","setGuestPhone","guestEmail","setGuestEmail","customMessage","setCustomMessage","previewMessage","setPreviewMessage","generateStandardMessage","languageCode","email","codigo","lobbyReservationId","toString","baseUrl","URLSearchParams","preview","alreadySent","sentMessageAt","passcode","doorPin","ttlLockPassword","roomNumber","roomDescription","doorAppName","WorktimeTracker","isTracking","setIsTracking","startTime","setStartTime","elapsedTime","setElapsedTime","activeWorktime","setActiveWorktime","isLoading","setIsLoading","showWorkTimeModal","setShowWorkTimeModal","statusError","setStatusError","contextTracking","updateTrackingStatus","checkTrackingStatus","useWorktime","selectedBranch","setSelectedBranch","useBranch","organization","useOrganization","isDifferentOrganization","useMemo","organizationId","useCallback","token","WORKTIME","ACTIVE","active","startISOString","endsWith","startTimeDate","diff","totalSeconds","Math","floor","seconds","intervalId","setInterval","clearInterval","handleStartTracking","alert","START","getTimezoneOffset","handleStopTracking","STOP","endTime","_error$response$data2","branchName","_branches$find","force","ExclamationTriangleIcon","openWorkTimeModal","ListBulletIcon","getSeconds","formatStartDate","now","WorktimeModal","closeWorkTimeModal","defaultColumnOrder","TODOS_TABLE_ID","RESERVATIONS_TABLE_ID","defaultCardSortDirections","defaultReservationCardSortDirections","paymentStatus","arrivalTime","tableToCardMapping","cardToTableMapping","reservationTableToCardMapping","reservationCardToTableMapping","Worktracker","permissions","location","useLocation","navigate","useNavigate","availableColumns","label","shortLabel","filterOnlyColumns","availableReservationColumns","reservationFilterOnlyColumns","tasks","setTasks","tasksTotalCount","setTasksTotalCount","tasksHasMore","setTasksHasMore","tasksLoadingMore","setTasksLoadingMore","initialFilterLoading","setInitialFilterLoading","searchTerm","setSearchTerm","statusFilter","setStatusFilter","reservationsTotalCount","setReservationsTotalCount","reservationsHasMore","setReservationsHasMore","reservationsLoadingMore","setReservationsLoadingMore","reservationsLoading","setReservationsLoading","reservationsError","setReservationsError","initialReservationFilterLoading","setInitialReservationFilterLoading","reservationSearchTerm","setReservationSearchTerm","reservationFilterStatus","setReservationFilterStatus","reservationFilterPaymentStatus","setReservationFilterPaymentStatus","isCreateReservationModalOpen","setIsCreateReservationModalOpen","syncingReservations","setSyncingReservations","generatingPinForReservation","setGeneratingPinForReservation","selectedReservationForInvitation","setSelectedReservationForInvitation","isSendInvitationSidepaneOpen","setIsSendInvitationSidepaneOpen","selectedReservationForPasscode","setSelectedReservationForPasscode","isSendPasscodeSidepaneOpen","setIsSendPasscodeSidepaneOpen","tourBookings","setTourBookings","tourBookingsTotalCount","setTourBookingsTotalCount","tourBookingsHasMore","setTourBookingsHasMore","tourBookingsLoadingMore","setTourBookingsLoadingMore","tourBookingsLoading","setTourBookingsLoading","tourBookingsError","setTourBookingsError","tourBookingsSearchTerm","setTourBookingsSearchTerm","selectedBookingForLink","setSelectedBookingForLink","isTourReservationLinkModalOpen","setIsTourReservationLinkModalOpen","isCreateTourBookingModalOpen","setIsCreateTourBookingModalOpen","isEditTourBookingModalOpen","setIsEditTourBookingModalOpen","selectedBookingForEdit","setSelectedBookingForEdit","reservationFilterConditions","setReservationFilterConditions","reservationFilterLogicalOperators","setReservationFilterLogicalOperators","reservationFilterSortDirections","setReservationFilterSortDirections","reservationActiveFilterName","setReservationActiveFilterName","reservationSelectedFilterId","setReservationSelectedFilterId","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","filterSortDirections","setFilterSortDirections","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","isFilterModalOpen","setIsFilterModalOpen","tableSortConfig","setTableSortConfig","reservationTableSortConfig","setReservationTableSortConfig","isCreateModalOpen","setIsCreateModalOpen","isEditModalOpen","setIsEditModalOpen","selectedTask","setSelectedTask","copiedTask","setCopiedTask","settings","tasksSettings","isLoadingTasksSettings","updateColumnOrder","updateTasksColumnOrder","updateHiddenColumns","updateTasksHiddenColumns","toggleColumnVisibility","toggleTasksColumnVisibility","isColumnVisible","isTasksColumnVisible","updateViewMode","updateTasksViewMode","useTableSettings","defaultHiddenColumns","defaultViewMode","defaultReservationColumnOrder","reservationsSettings","isLoadingReservationsSettings","updateReservationsColumnOrder","updateReservationsHiddenColumns","toggleReservationsColumnVisibility","isReservationsColumnVisible","updateReservationsViewMode","draggedColumn","setDraggedColumn","dragOverColumn","setDragOverColumn","expandedReservationRows","setExpandedReservationRows","Set","viewMode","querySelectorAll","wrapper","classList","add","cardMetadataOrder","columnOrder","cardMetadata","tableCol","cardMeta","getCardMetadataFromColumnOrder","getReservationCardMetadataFromColumnOrder","hiddenCardMetadata","hiddenTableColumns","getHiddenCardMetadata","hiddenColumns","getReservationHiddenCardMetadata","visibleCardMetadata","meta","has","taskCardSortDirections","setTaskCardSortDirections","handleTaskCardSortDirectionChange","columnId","reservationCardSortDirections","setReservationCardSortDirections","handleReservationCardSortDirectionChange","toggleReservationExpanded","newSet","loadTasks","filterId","arguments","limit","offset","includeAttachments","conditions","operators","responseData","isObject","hasData","dataIsArray","responseDataIsArray","dataType","tasksData","totalCount","hasMore","tasksWithAttachments","applyFilterConditions","sortDirections","validSortDirections","reservationsData","process","applyReservationFilterConditions","handleFilterChange","handleReservationFilterChange","filterConditionsRef","tasksLoadMoreRef","reservationsLoadMoreRef","tourBookingsLoadMoreRef","loadTourBookings","bookingsData","editTaskId","search","handleStatusChange","newStatus","prevTasks","patch","toast","isResponsibleForTask","_user$roles","some","userRole","_userRole$role","_task$role","isQualityControlForTask","handleSort","handleReservationSort","renderStatusButtons","buttons","ArrowLeftIcon","ArrowRightIcon","getActiveFilterCount","resetFilterConditions","resetReservationFilterConditions","getStatusPriority","getReservationStatusColor","CONFIRMED","NOTIFICATION_SENT","CHECKED_IN","CHECKED_OUT","CANCELLED","NO_SHOW","getPaymentStatusColor","PAID","PARTIALLY_PAID","REFUNDED","PENDING","filteredAndSortedTasks","filtered","searchLower","getSortValue","MAX_SAFE_INTEGER","valueA","valueB","comparison","localeCompare","sortedByPriority","sd1","sd2","priority","sortDir","column","sortableColumns","colId","aDate","bDate","aStatusPrio","bStatusPrio","filteredAndSortedReservations","validReservations","getReservationSortValue","_reservation$branch3","observer","IntersectionObserver","isIntersecting","nextOffset","threshold","observe","unobserve","handleMoveColumn","dragIndex","hoverIndex","newColumnOrder","splice","handleDragStart","handleDragEnd","visibleColumnIds","validOrder","missingColumns","handleCopyTask","_task$qualityControl2","copiedTaskData","handleDeleteTask","width","height","PlusIcon","CalendarIcon","ClipboardDocumentListIcon","RESERVATIONS","SYNC","Squares2X2Icon","TableCellsIcon","FunnelIcon","TableColumnConfig","columns","visibleColumns","from","onToggleColumnVisibility","tableColumn","otherCardMeta","onMoveColumn","newCardOrder","dragged","newTableOrder","usedTableColumns","col","buttonTitle","modalTitle","onSortDirectionChange","showSortDirection","FilterPane","onApply","onReset","savedConditions","savedOperators","savedSortDirections","onSortDirectionsChange","tableId","SavedFilterTags","onSelectFilter","onFilterChange","defaultFilterName","scope","draggable","onDragStart","onDragEnd","ArrowsUpDownIcon","colSpan","expiryStatus","getExpiryStatus","expiryColors","getExpiryColorClasses","bgClass","borderClass","InformationCircleIcon","MarkdownPreview","showImagePreview","getStatusColor","expiryStatusForDate","expiryColorsForDate","textClass","toLocaleDateString","PencilIcon","DocumentDuplicateIcon","CardGrid","metadata","icon","BuildingOfficeIcon","section","responsibleValue","shortenedName","UserIcon","qualityControlValue","dueDateItem","createDueDateMetadataItem","descriptionContent","attachmentMetadata","actionButtons","DataCard","getStatusText","color","onPreviousClick","onNextClick","actions","_filteredAndSortedRes","getUTCFullYear","getUTCMonth","getUTCDate","localDate","HomeIcon","encodeURIComponent","amountValue","toFixed","CurrencyDollarIcon","_unused2","onlineCheckInCompleted","hasWritePermission","entity","accessLevel","entityType","actionButtonsWillBeCreated","isExpanded","expandableContent","ReservationNotificationLogs","subtitle","expandable","onToggle","CircularProgress","_unused3","_reservation$branch4","_err$response4","_err$response4$data","expiryStatusForDate2","expiryColorsForDate2","_unused4","_unused5","_unused6","_reservation$branch5","CreateTaskModal","newTask","validTasks","EditTaskModal","updatedTask","CreateReservationModal","SendInvitationSidepane","SendPasscodeSidepane","_booking$customerName","_booking$customerEmai","_booking$tour$title","_booking$customerPhon","_booking$tour2","bookedBy","CreateTourBookingModal","EditTourBookingModal","TourReservationLinkModal"],"sourceRoot":""}