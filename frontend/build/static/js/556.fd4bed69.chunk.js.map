{"version":3,"file":"static/js/556.fd4bed69.chunk.js","mappings":"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","sources":["../node_modules/@heroicons/react/24/outline/esm/PlayIcon.js","api/clientApi.ts","components/EditClientModal.tsx","components/ClientSelectModal.tsx","components/CreateClientModal.tsx","api/consultationApi.ts","components/ConsultationTracker.tsx","components/LinkTaskModal.tsx","components/InvoiceSuccessModal.tsx","components/CreateInvoiceModal.tsx","components/ConsultationList.tsx","pages/Consultations.tsx","utils/dateUtils.ts","../node_modules/@heroicons/react/24/outline/esm/StopIcon.js","../node_modules/@heroicons/react/24/outline/esm/ChevronDownIcon.js","../node_modules/@heroicons/react/24/outline/esm/DocumentTextIcon.js","../node_modules/@heroicons/react/24/outline/esm/ChartBarIcon.js","../node_modules/@heroicons/react/24/outline/esm/CheckCircleIcon.js","../node_modules/@heroicons/react/24/outline/esm/ClockIcon.js","../node_modules/@heroicons/react/24/outline/esm/MagnifyingGlassIcon.js","../node_modules/@heroicons/react/24/outline/esm/FunnelIcon.js","../node_modules/@heroicons/react/24/outline/esm/DocumentArrowDownIcon.js","../node_modules/@heroicons/react/24/outline/esm/EyeIcon.js","../node_modules/@heroicons/react/24/outline/esm/LinkIcon.js"],"sourcesContent":["import * as React from \"react\";\nfunction PlayIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(PlayIcon);\nexport default ForwardRef;","import axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\n\r\n/**\r\n * API-Funktionen fr die Client-Verwaltung\r\n */\r\n\r\nexport interface CreateClientData {\r\n  name: string;\r\n  company?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  address?: string;\r\n  notes?: string;\r\n}\r\n\r\nexport interface UpdateClientData {\r\n  name?: string;\r\n  company?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  address?: string;\r\n  notes?: string;\r\n  isActive?: boolean;\r\n}\r\n\r\n/**\r\n * Holt alle Clients\r\n * @returns Liste aller Clients\r\n */\r\nexport const getClients = async () => {\r\n  try {\r\n    const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.BASE);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden der Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Holt einen einzelnen Client mit seinen Beratungen\r\n * @param clientId ID des Clients\r\n * @returns Client mit seinen letzten Beratungen\r\n */\r\nexport const getClientById = async (clientId: number) => {\r\n  try {\r\n    const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.BY_ID(clientId));\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Erstellt einen neuen Client\r\n * @param data Client-Daten\r\n * @returns Der erstellte Client\r\n */\r\nexport const createClient = async (data: CreateClientData) => {\r\n  try {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.CLIENTS.BASE, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Erstellen des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Aktualisiert einen bestehenden Client\r\n * @param clientId ID des Clients\r\n * @param data Update-Daten\r\n * @returns Der aktualisierte Client\r\n */\r\nexport const updateClient = async (clientId: number, data: UpdateClientData) => {\r\n  try {\r\n    const response = await axiosInstance.put(API_ENDPOINTS.CLIENTS.BY_ID(clientId), data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Aktualisieren des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Lscht einen Client\r\n * @param clientId ID des Clients\r\n * @returns Status der Lschoperation\r\n */\r\nexport const deleteClient = async (clientId: number) => {\r\n  try {\r\n    const response = await axiosInstance.delete(API_ENDPOINTS.CLIENTS.BY_ID(clientId));\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Lschen des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Holt die zuletzt beratenen Clients\r\n * @returns Liste der zuletzt beratenen Clients\r\n */\r\nexport const getRecentClients = async () => {\r\n  try {\r\n    const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.RECENT);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden der zuletzt beratenen Clients:', error);\r\n    throw error;\r\n  }\r\n}; ","import React, { useState, useEffect } from 'react';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, TrashIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { Client } from '../types/client.ts';\r\nimport { toast } from 'react-toastify';\r\nimport * as clientApi from '../api/clientApi.ts';\r\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\r\n\r\ninterface EditClientModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onClientUpdated?: (client: Client) => void;\r\n  onClientDeleted?: (clientId: number) => void;\r\n  client: Client | null;\r\n}\r\n\r\nconst EditClientModal: React.FC<EditClientModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onClientUpdated,\r\n  onClientDeleted,\r\n  client\r\n}) => {\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    company: '',\r\n    email: '',\r\n    phone: '',\r\n    address: '',\r\n    notes: '',\r\n    isActive: true\r\n  });\r\n  const [errors, setErrors] = useState<Record<string, string>>({});\r\n  const [loading, setLoading] = useState(false);\r\n  const [confirmDelete, setConfirmDelete] = useState(false);\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n\r\n  // Lade Client-Daten wenn Modal geffnet wird\r\n  useEffect(() => {\r\n    if (isOpen && client) {\r\n      setFormData({\r\n        name: client.name || '',\r\n        company: client.company || '',\r\n        email: client.email || '',\r\n        phone: client.phone || '',\r\n        address: client.address || '',\r\n        notes: client.notes || '',\r\n        isActive: client.isActive !== undefined ? client.isActive : true\r\n      });\r\n      setConfirmDelete(false);\r\n      setErrors({});\r\n    }\r\n  }, [isOpen, client]);\r\n\r\n  // berprfung der Bildschirmgre\r\n  useEffect(() => {\r\n    const checkScreenSize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    checkScreenSize();\r\n    window.addEventListener('resize', checkScreenSize);\r\n    \r\n    return () => {\r\n      window.removeEventListener('resize', checkScreenSize);\r\n    };\r\n  }, []);\r\n\r\n  // Sidepane-Status verwalten\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane]);\r\n\r\n  const validateForm = () => {\r\n    const newErrors: Record<string, string> = {};\r\n    \r\n    if (!formData.name.trim()) {\r\n      newErrors.name = 'Name ist erforderlich';\r\n    }\r\n    \r\n    if (formData.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\r\n      newErrors.email = 'Ungltige E-Mail-Adresse';\r\n    }\r\n    \r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!validateForm()) return;\r\n    \r\n    if (!client) return;\r\n    \r\n    try {\r\n      setLoading(true);\r\n      const updated = await clientApi.updateClient(client.id, {\r\n        name: formData.name,\r\n        company: formData.company || undefined,\r\n        email: formData.email || undefined,\r\n        phone: formData.phone || undefined,\r\n        address: formData.address || undefined,\r\n        notes: formData.notes || undefined,\r\n        isActive: formData.isActive\r\n      });\r\n      \r\n      toast.success('Client erfolgreich aktualisiert');\r\n      onClientUpdated?.(updated);\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || 'Fehler beim Aktualisieren des Clients');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!confirmDelete) {\r\n      setConfirmDelete(true);\r\n      return;\r\n    }\r\n    \r\n    if (!client) return;\r\n    \r\n    try {\r\n      setLoading(true);\r\n      await clientApi.deleteClient(client.id);\r\n      \r\n      toast.success('Client erfolgreich gelscht');\r\n      onClientDeleted?.(client.id);\r\n      onClose();\r\n    } catch (error: any) {\r\n      const errorMessage = error.response?.data?.message || 'Fehler beim Lschen des Clients';\r\n      const errorDetails = error.response?.data?.details;\r\n      const errorSuggestion = error.response?.data?.suggestion;\r\n      \r\n      // Zeige detaillierte Fehlermeldung bei Verknpfungen\r\n      if (error.response?.status === 409 && errorDetails) {\r\n        const details = Object.entries(errorDetails)\r\n          .filter(([_, count]) => (count as number) > 0)\r\n          .map(([key, count]) => `${count as number} ${key === 'workTimes' ? 'Zeiteintrge' : key === 'consultationInvoices' ? 'Rechnungen' : 'Monatsberichte'}`)\r\n          .join(', ');\r\n        \r\n        toast.error(`${errorMessage}. Verknpfungen: ${details}. ${errorSuggestion || ''}`);\r\n      } else {\r\n        toast.error(errorMessage);\r\n      }\r\n      \r\n      setConfirmDelete(false);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value, type } = e.target;\r\n    const checked = (e.target as HTMLInputElement).checked;\r\n    \r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [name]: type === 'checkbox' ? checked : value\r\n    }));\r\n    \r\n    // Fehler fr dieses Feld lschen\r\n    if (errors[name]) {\r\n      setErrors(prev => ({ ...prev, [name]: '' }));\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setConfirmDelete(false);\r\n    setErrors({});\r\n    onClose();\r\n  };\r\n\r\n  if (!client) return null;\r\n\r\n  // Fr Mobile (unter 640px) - klassisches Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\r\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                Client bearbeiten\r\n              </Dialog.Title>\r\n              <button\r\n                onClick={handleClose}\r\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n              >\r\n                <XMarkIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            <form onSubmit={handleSubmit} className=\"p-4\">\r\n              <div className=\"space-y-4\">\r\n                {/* Name */}\r\n                <div>\r\n                  <label htmlFor=\"name_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                    Name *\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    id=\"name_mobile\"\r\n                    name=\"name\"\r\n                    value={formData.name}\r\n                    onChange={handleChange}\r\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\r\n                      errors.name \r\n                        ? 'border-red-300 dark:border-red-600' \r\n                        : 'border-gray-300 dark:border-gray-600'\r\n                    }`}\r\n                  />\r\n                  {errors.name && (\r\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Firma */}\r\n                <div>\r\n                  <label htmlFor=\"company_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                    Firma\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    id=\"company_mobile\"\r\n                    name=\"company\"\r\n                    value={formData.company}\r\n                    onChange={handleChange}\r\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  />\r\n                </div>\r\n\r\n                {/* E-Mail */}\r\n                <div>\r\n                  <label htmlFor=\"email_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                    E-Mail\r\n                  </label>\r\n                  <input\r\n                    type=\"email\"\r\n                    id=\"email_mobile\"\r\n                    name=\"email\"\r\n                    value={formData.email}\r\n                    onChange={handleChange}\r\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\r\n                      errors.email \r\n                        ? 'border-red-300 dark:border-red-600' \r\n                        : 'border-gray-300 dark:border-gray-600'\r\n                    }`}\r\n                  />\r\n                  {errors.email && (\r\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Telefon */}\r\n                <div>\r\n                  <label htmlFor=\"phone_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                    Telefon\r\n                  </label>\r\n                  <input\r\n                    type=\"tel\"\r\n                    id=\"phone_mobile\"\r\n                    name=\"phone\"\r\n                    value={formData.phone}\r\n                    onChange={handleChange}\r\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  />\r\n                </div>\r\n\r\n                {/* Adresse */}\r\n                <div>\r\n                  <label htmlFor=\"address_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                    Adresse\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    id=\"address_mobile\"\r\n                    name=\"address\"\r\n                    value={formData.address}\r\n                    onChange={handleChange}\r\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  />\r\n                </div>\r\n\r\n                {/* Notizen */}\r\n                <div>\r\n                  <label htmlFor=\"notes_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                    Notizen\r\n                  </label>\r\n                  <textarea\r\n                    id=\"notes_mobile\"\r\n                    name=\"notes\"\r\n                    rows={3}\r\n                    value={formData.notes}\r\n                    onChange={handleChange}\r\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  />\r\n                </div>\r\n\r\n                {/* Aktiv-Status */}\r\n                <div className=\"flex items-center\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    id=\"isActive_mobile\"\r\n                    name=\"isActive\"\r\n                    checked={formData.isActive}\r\n                    onChange={handleChange}\r\n                    className=\"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:text-gray-300\"\r\n                  />\r\n                  <label htmlFor=\"isActive_mobile\" className=\"ml-2 block text-sm text-gray-700 dark:text-gray-300\">\r\n                    Aktiv\r\n                  </label>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Buttons */}\r\n              <div className=\"mt-6 flex items-center justify-between\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleDelete}\r\n                  disabled={loading}\r\n                  className={`inline-flex items-center px-4 py-2 border ${\r\n                    confirmDelete\r\n                      ? 'border-red-300 text-red-700 bg-red-50 dark:border-red-600 dark:text-red-400 dark:bg-red-900/20'\r\n                      : 'border-red-300 text-red-700 bg-white hover:bg-red-50 dark:border-red-600 dark:text-red-400 dark:bg-gray-700 dark:hover:bg-gray-600'\r\n                  } text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed`}\r\n                >\r\n                  <TrashIcon className=\"h-5 w-5 mr-2\" />\r\n                  {confirmDelete ? 'Wirklich lschen?' : 'Lschen'}\r\n                </button>\r\n\r\n                <div className=\"flex space-x-3\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={handleClose}\r\n                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n                    title=\"Abbrechen\"\r\n                  >\r\n                    <XMarkIcon className=\"h-5 w-5\" />\r\n                  </button>\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={loading}\r\n                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                    title={loading ? 'Speichere...' : 'Speichern'}\r\n                  >\r\n                    {loading ? (\r\n                      <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n                    ) : (\r\n                      <CheckIcon className=\"h-5 w-5\" />\r\n                    )}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </form>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  // Fr Desktop (ab 640px) - Sidepane\r\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \r\n          aria-hidden=\"true\" \r\n          onClick={handleClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div \r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            Client bearbeiten\r\n          </h2>\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {Object.keys(errors).length > 0 && (\r\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\r\n              {Object.values(errors).map((error, idx) => (\r\n                <p key={idx}>{error}</p>\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n            {/* Name */}\r\n            <div>\r\n              <label htmlFor=\"name\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                Name *\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"name\"\r\n                name=\"name\"\r\n                value={formData.name}\r\n                onChange={handleChange}\r\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\r\n                  errors.name \r\n                    ? 'border-red-300 dark:border-red-600' \r\n                    : 'border-gray-300 dark:border-gray-600'\r\n                }`}\r\n              />\r\n              {errors.name && (\r\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Firma */}\r\n            <div>\r\n              <label htmlFor=\"company\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                Firma\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"company\"\r\n                name=\"company\"\r\n                value={formData.company}\r\n                onChange={handleChange}\r\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n              />\r\n            </div>\r\n\r\n            {/* E-Mail */}\r\n            <div>\r\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                E-Mail\r\n              </label>\r\n              <input\r\n                type=\"email\"\r\n                id=\"email\"\r\n                name=\"email\"\r\n                value={formData.email}\r\n                onChange={handleChange}\r\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\r\n                  errors.email \r\n                    ? 'border-red-300 dark:border-red-600' \r\n                    : 'border-gray-300 dark:border-gray-600'\r\n                }`}\r\n              />\r\n              {errors.email && (\r\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Telefon */}\r\n            <div>\r\n              <label htmlFor=\"phone\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                Telefon\r\n              </label>\r\n              <input\r\n                type=\"tel\"\r\n                id=\"phone\"\r\n                name=\"phone\"\r\n                value={formData.phone}\r\n                onChange={handleChange}\r\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n              />\r\n            </div>\r\n\r\n            {/* Adresse */}\r\n            <div>\r\n              <label htmlFor=\"address\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                Adresse\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"address\"\r\n                name=\"address\"\r\n                value={formData.address}\r\n                onChange={handleChange}\r\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n              />\r\n            </div>\r\n\r\n            {/* Notizen */}\r\n            <div>\r\n              <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                Notizen\r\n              </label>\r\n              <textarea\r\n                id=\"notes\"\r\n                name=\"notes\"\r\n                rows={3}\r\n                value={formData.notes}\r\n                onChange={handleChange}\r\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n              />\r\n            </div>\r\n\r\n            {/* Aktiv-Status */}\r\n            <div className=\"flex items-center\">\r\n              <input\r\n                type=\"checkbox\"\r\n                id=\"isActive\"\r\n                name=\"isActive\"\r\n                checked={formData.isActive}\r\n                onChange={handleChange}\r\n                className=\"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:text-gray-300\"\r\n              />\r\n              <label htmlFor=\"isActive\" className=\"ml-2 block text-sm text-gray-700 dark:text-gray-300\">\r\n                Aktiv\r\n              </label>\r\n            </div>\r\n\r\n            {/* Buttons */}\r\n            <div className=\"flex items-center justify-between pt-4\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleDelete}\r\n                disabled={loading}\r\n                className={`p-2 rounded-md ${\r\n                  confirmDelete\r\n                    ? 'bg-red-600 text-white dark:bg-red-700 dark:text-white hover:bg-red-700 dark:hover:bg-red-600'\r\n                    : 'text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300'\r\n                } disabled:opacity-50 disabled:cursor-not-allowed`}\r\n                title={confirmDelete ? 'Lschen besttigen' : 'Client lschen'}\r\n              >\r\n                {confirmDelete ? (\r\n                  <CheckIcon className=\"h-5 w-5\" />\r\n                ) : (\r\n                  <TrashIcon className=\"h-5 w-5\" />\r\n                )}\r\n              </button>\r\n\r\n              <div className=\"flex gap-2\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleClose}\r\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n                  title=\"Abbrechen\"\r\n                >\r\n                  <XMarkIcon className=\"h-5 w-5\" />\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={loading}\r\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  title={loading ? 'Speichere...' : 'Speichern'}\r\n                >\r\n                  {loading ? (\r\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n                  ) : (\r\n                    <CheckIcon className=\"h-5 w-5\" />\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EditClientModal;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { MagnifyingGlassIcon, XMarkIcon, PlusIcon, PencilIcon, TrashIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { Client } from '../types/client.ts';\r\nimport { toast } from 'react-toastify';\r\nimport * as clientApi from '../api/clientApi.ts';\r\nimport EditClientModal from './EditClientModal.tsx';\r\n\r\ninterface ClientSelectModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSelect: (client: Client) => void;\r\n  onCreateNew: () => void;\r\n}\r\n\r\nconst ClientSelectModal: React.FC<ClientSelectModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onSelect,\r\n  onCreateNew\r\n}) => {\r\n  const [clients, setClients] = useState<Client[]>([]);\r\n  const [filteredClients, setFilteredClients] = useState<Client[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [editingClient, setEditingClient] = useState<Client | null>(null);\r\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      loadClients();\r\n    }\r\n  }, [isOpen]);\r\n\r\n  useEffect(() => {\r\n    if (searchTerm) {\r\n      const filtered = clients.filter(client => \r\n        client.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        (client.company && client.company.toLowerCase().includes(searchTerm.toLowerCase())) ||\r\n        (client.email && client.email.toLowerCase().includes(searchTerm.toLowerCase()))\r\n      );\r\n      setFilteredClients(filtered);\r\n    } else {\r\n      setFilteredClients(clients);\r\n    }\r\n  }, [searchTerm, clients]);\r\n\r\n  const loadClients = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.BASE);\r\n      setClients(response.data);\r\n      setFilteredClients(response.data);\r\n    } catch (error) {\r\n      // Stille Behandlung - Fehler wird im UI durch leere Liste sichtbar\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleEdit = (client: Client, e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setEditingClient(client);\r\n    setIsEditModalOpen(true);\r\n  };\r\n\r\n  const handleDelete = async (client: Client, e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    \r\n    if (!window.confirm(`Mchten Sie den Client \"${client.name}\" wirklich lschen?`)) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await clientApi.deleteClient(client.id);\r\n      toast.success('Client erfolgreich gelscht');\r\n      loadClients(); // Liste neu laden\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || 'Fehler beim Lschen des Clients');\r\n    }\r\n  };\r\n\r\n  const handleClientUpdated = (updatedClient: Client) => {\r\n    // Aktualisiere lokale Liste\r\n    const index = clients.findIndex(c => c.id === updatedClient.id);\r\n    if (index !== -1) {\r\n      const newClients = [...clients];\r\n      newClients[index] = updatedClient;\r\n      setClients(newClients);\r\n      setFilteredClients(newClients);\r\n    }\r\n    setIsEditModalOpen(false);\r\n    setEditingClient(null);\r\n  };\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n      \r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n          <div className=\"p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                Client auswhlen\r\n              </Dialog.Title>\r\n              <button\r\n                onClick={onClose}\r\n                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n              >\r\n                <XMarkIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Suchfeld */}\r\n            <div className=\"relative mb-4\">\r\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                <MagnifyingGlassIcon className=\"h-5 w-5 text-gray-400\" />\r\n              </div>\r\n              <input\r\n                type=\"text\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n                placeholder=\"Client suchen...\"\r\n                autoFocus\r\n              />\r\n            </div>\r\n\r\n            {/* Client-Liste */}\r\n            <div className=\"max-h-96 overflow-y-auto\">\r\n              {loading ? (\r\n                <div className=\"text-center py-4 text-gray-500 dark:text-gray-400\">\r\n                  Lade Clients...\r\n                </div>\r\n              ) : filteredClients.length === 0 ? (\r\n                <div className=\"text-center py-8\">\r\n                  <p className=\"text-gray-500 dark:text-gray-400 mb-4\">\r\n                    {searchTerm ? 'Keine Clients gefunden' : 'Noch keine Clients vorhanden'}\r\n                  </p>\r\n                  <button\r\n                    onClick={onCreateNew}\r\n                    className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                  >\r\n                    <PlusIcon className=\"h-5 w-5 mr-2\" />\r\n                    Neuen Client anlegen\r\n                  </button>\r\n                </div>\r\n              ) : (\r\n                <ul className=\"divide-y divide-gray-200 dark:divide-gray-700\">\r\n                  {filteredClients.map((client) => (\r\n                    <li key={client.id}>\r\n                      <div className=\"flex items-center\">\r\n                        <button\r\n                          onClick={() => onSelect(client)}\r\n                          className=\"flex-1 px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 text-left transition-colors\"\r\n                        >\r\n                          <div>\r\n                            <p className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                              {client.name}\r\n                            </p>\r\n                            {client.company && (\r\n                              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                {client.company}\r\n                              </p>\r\n                            )}\r\n                            {client.email && (\r\n                              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                {client.email}\r\n                              </p>\r\n                            )}\r\n                          </div>\r\n                        </button>\r\n                        <div className=\"flex items-center space-x-2 px-2\">\r\n                          <button\r\n                            onClick={(e) => handleEdit(client, e)}\r\n                            className=\"p-2 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors\"\r\n                            title=\"Client bearbeiten\"\r\n                          >\r\n                            <PencilIcon className=\"h-5 w-5\" />\r\n                          </button>\r\n                          <button\r\n                            onClick={(e) => handleDelete(client, e)}\r\n                            className=\"p-2 text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors\"\r\n                            title=\"Client lschen\"\r\n                          >\r\n                            <TrashIcon className=\"h-5 w-5\" />\r\n                          </button>\r\n                        </div>\r\n                      </div>\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              )}\r\n            </div>\r\n\r\n            {/* Footer mit \"Neuer Client\" Button */}\r\n            {filteredClients.length > 0 && (\r\n              <div className=\"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n                <button\r\n                  onClick={onCreateNew}\r\n                  className=\"w-full inline-flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                >\r\n                  <PlusIcon className=\"h-5 w-5 mr-2\" />\r\n                  Neuen Client anlegen\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n\r\n      {/* Edit Modal */}\r\n      {editingClient && (\r\n        <EditClientModal\r\n          isOpen={isEditModalOpen}\r\n          onClose={() => {\r\n            setIsEditModalOpen(false);\r\n            setEditingClient(null);\r\n          }}\r\n          onClientUpdated={handleClientUpdated}\r\n          onClientDeleted={(clientId) => {\r\n            // Ldt Liste neu nach Lschung\r\n            loadClients();\r\n            setIsEditModalOpen(false);\r\n            setEditingClient(null);\r\n          }}\r\n          client={editingClient}\r\n        />\r\n      )}\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default ClientSelectModal; ","import React, { useState, useEffect } from 'react';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { Client } from '../types/client.ts';\nimport { toast } from 'react-toastify';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface CreateClientModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSave: (client: Client) => void;\n}\n\nconst CreateClientModal: React.FC<CreateClientModalProps> = ({\n  isOpen,\n  onClose,\n  onSave\n}) => {\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [formData, setFormData] = useState({\n    name: '',\n    company: '',\n    email: '',\n    phone: '',\n    address: '',\n    notes: ''\n  });\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [loading, setLoading] = useState(false);\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.name.trim()) {\n      newErrors.name = 'Name ist erforderlich';\n    }\n    \n    if (formData.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\n      newErrors.email = 'Ungltige E-Mail-Adresse';\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) return;\n    \n    try {\n      setLoading(true);\n      const response = await axiosInstance.post(API_ENDPOINTS.CLIENTS.BASE, {\n        ...formData,\n        company: formData.company || null,\n        email: formData.email || null,\n        phone: formData.phone || null,\n        address: formData.address || null,\n        notes: formData.notes || null\n      });\n      \n      toast.success('Client erfolgreich angelegt');\n      onSave(response.data);\n      \n      // Form zurcksetzen\n      setFormData({\n        name: '',\n        company: '',\n        email: '',\n        phone: '',\n        address: '',\n        notes: ''\n      });\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'Fehler beim Anlegen des Clients');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // berprfung der Bildschirmgre\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    // Initial prfen\n    checkScreenSize();\n    \n    // Event-Listener fr Grennderungen\n    window.addEventListener('resize', checkScreenSize);\n    \n    // Cleanup\n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleClose = () => {\n    // Form zurcksetzen\n    setFormData({\n      name: '',\n      company: '',\n      email: '',\n      phone: '',\n      address: '',\n      notes: ''\n    });\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                Neuen Client anlegen\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              <div className=\"space-y-4\">\n                {/* Name */}\n                <div>\n                  <label htmlFor=\"name_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Name *\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"name_mobile\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.name \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.name && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n                  )}\n                </div>\n\n                {/* Firma */}\n                <div>\n                  <label htmlFor=\"company_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Firma\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"company_mobile\"\n                    name=\"company\"\n                    value={formData.company}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* E-Mail */}\n                <div>\n                  <label htmlFor=\"email_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    E-Mail\n                  </label>\n                  <input\n                    type=\"email\"\n                    id=\"email_mobile\"\n                    name=\"email\"\n                    value={formData.email}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.email \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.email && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n                  )}\n                </div>\n\n                {/* Telefon */}\n                <div>\n                  <label htmlFor=\"phone_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Telefon\n                  </label>\n                  <input\n                    type=\"tel\"\n                    id=\"phone_mobile\"\n                    name=\"phone\"\n                    value={formData.phone}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Adresse */}\n                <div>\n                  <label htmlFor=\"address_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Adresse\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"address_mobile\"\n                    name=\"address\"\n                    value={formData.address}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Notizen */}\n                <div>\n                  <label htmlFor=\"notes_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Notizen\n                  </label>\n                  <textarea\n                    id=\"notes_mobile\"\n                    name=\"notes\"\n                    rows={3}\n                    value={formData.notes}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n              </div>\n\n              {/* Buttons */}\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title=\"Abbrechen\"\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? 'Speichere...' : 'Speichern'}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            Neuen Client anlegen\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {Object.keys(errors).length > 0 && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {Object.values(errors).map((error, idx) => (\n                <p key={idx}>{error}</p>\n              ))}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Name */}\n            <div>\n              <label htmlFor=\"name\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Name *\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.name \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.name && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n              )}\n            </div>\n\n            {/* Firma */}\n            <div>\n              <label htmlFor=\"company\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Firma\n              </label>\n              <input\n                type=\"text\"\n                id=\"company\"\n                name=\"company\"\n                value={formData.company}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* E-Mail */}\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                E-Mail\n              </label>\n              <input\n                type=\"email\"\n                id=\"email\"\n                name=\"email\"\n                value={formData.email}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.email \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.email && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n              )}\n            </div>\n\n            {/* Telefon */}\n            <div>\n              <label htmlFor=\"phone\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Telefon\n              </label>\n              <input\n                type=\"tel\"\n                id=\"phone\"\n                name=\"phone\"\n                value={formData.phone}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Adresse */}\n            <div>\n              <label htmlFor=\"address\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Adresse\n              </label>\n              <input\n                type=\"text\"\n                id=\"address\"\n                name=\"address\"\n                value={formData.address}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Notizen */}\n            <div>\n              <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Notizen\n              </label>\n              <textarea\n                id=\"notes\"\n                name=\"notes\"\n                rows={3}\n                value={formData.notes}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Buttons */}\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title=\"Abbrechen\"\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? 'Speichere...' : 'Speichern'}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default CreateClientModal; ","import axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\n\r\n/**\r\n * API-Funktionen fr das Consultation-Modul\r\n */\r\n\r\nexport interface StartConsultationData {\r\n  branchId: number;\r\n  clientId: number;\r\n  notes?: string;\r\n  startTime?: string;\r\n}\r\n\r\nexport interface StopConsultationData {\r\n  endTime?: string;\r\n  notes?: string;\r\n}\r\n\r\nexport interface UpdateNotesData {\r\n  notes: string;\r\n}\r\n\r\nexport interface LinkTaskData {\r\n  taskId: number;\r\n}\r\n\r\nexport interface CreateTaskData {\r\n  title: string;\r\n  description: string;\r\n  dueDate?: string;\r\n  branchId: number;\r\n  qualityControlId?: number;\r\n}\r\n\r\nexport interface UpdateTimeData {\r\n  startTime?: string;\r\n  endTime?: string;\r\n}\r\n\r\n/**\r\n * Startet eine neue Beratung\r\n * @param data Beratungsdaten (branchId, clientId, notes, startTime)\r\n * @returns Die erstellte Beratung\r\n */\r\nexport const startConsultation = async (data: StartConsultationData) => {\r\n  try {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.CONSULTATIONS.START, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Starten der Beratung:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Stoppt eine laufende Beratung\r\n * @param data Stopp-Daten (endTime, notes)\r\n * @returns Die aktualisierte Beratung\r\n */\r\nexport const stopConsultation = async (data: StopConsultationData) => {\r\n  try {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.CONSULTATIONS.STOP, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Stoppen der Beratung:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Holt alle Beratungen des aktuellen Benutzers\r\n * @param clientId Optionale Client-ID zum Filtern\r\n * @param from Optionales Start-Datum\r\n * @param to Optionales End-Datum\r\n * @returns Liste der Beratungen\r\n */\r\nexport const getConsultations = async (clientId?: number, from?: string, to?: string) => {\r\n  try {\r\n    const params = new URLSearchParams();\r\n    if (clientId) params.append('clientId', clientId.toString());\r\n    if (from) params.append('from', from);\r\n    if (to) params.append('to', to);\r\n    \r\n    const url = params.toString() \r\n      ? `${API_ENDPOINTS.CONSULTATIONS.BASE}?${params}`\r\n      : API_ENDPOINTS.CONSULTATIONS.BASE;\r\n      \r\n    const response = await axiosInstance.get(url);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden der Beratungen:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Aktualisiert die Notizen einer Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Notizen-Daten\r\n * @returns Die aktualisierte Beratung\r\n */\r\nexport const updateConsultationNotes = async (consultationId: number, data: UpdateNotesData) => {\r\n  try {\r\n    const response = await axiosInstance.patch(\r\n      API_ENDPOINTS.CONSULTATIONS.UPDATE_NOTES(consultationId), \r\n      data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Aktualisieren der Notizen:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Verknpft einen Task mit einer Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Task-Verknpfungsdaten\r\n * @returns Status der Verknpfung\r\n */\r\nexport const linkTaskToConsultation = async (consultationId: number, data: LinkTaskData) => {\r\n  try {\r\n    const response = await axiosInstance.post(\r\n      API_ENDPOINTS.CONSULTATIONS.LINK_TASK(consultationId), \r\n      data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Verknpfen des Tasks:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Erstellt einen neuen Task fr eine Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Task-Erstellungsdaten\r\n * @returns Der erstellte Task\r\n */\r\nexport const createTaskForConsultation = async (consultationId: number, data: CreateTaskData) => {\r\n  try {\r\n    const response = await axiosInstance.post(\r\n      API_ENDPOINTS.CONSULTATIONS.CREATE_TASK(consultationId), \r\n      data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Erstellen des Tasks:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Lscht eine Beratung\r\n * @param consultationId ID der Beratung\r\n * @returns Status der Lschoperation\r\n */\r\nexport const deleteConsultation = async (consultationId: number) => {\r\n  try {\r\n    const response = await axiosInstance.delete(API_ENDPOINTS.CONSULTATIONS.BY_ID(consultationId));\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Lschen der Beratung:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Aktualisiert die Start- oder Endzeit einer Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Zeit-Update-Daten (startTime oder endTime)\r\n * @returns Die aktualisierte Beratung\r\n */\r\nexport const updateConsultationTime = async (consultationId: number, data: UpdateTimeData) => {\r\n  try {\r\n    /* KONSISTENTE API-BEHANDLUNG:\r\n     * Diese Funktion kapselt die Zeit-Update-Logik und macht sie testbar und wartbar.\r\n     * Verwendet den WorkTime-Endpoint, da Consultations erweiterte WorkTime-Eintrge sind.\r\n     */\r\n    const response = await axiosInstance.put(`${API_ENDPOINTS.WORKTIME.BASE}/${consultationId}`, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Aktualisieren der Zeit:', error);\r\n    throw error;\r\n  }\r\n}; ","import React, { useState, useEffect, useRef, useLayoutEffect, useCallback, useMemo } from 'react';\nimport { PlayIcon, StopIcon, PlusIcon, ClockIcon, UserGroupIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { formatTime, calculateDuration } from '../utils/dateUtils.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { useBranch } from '../contexts/BranchContext.tsx';\nimport { toast } from 'react-toastify';\nimport ClientSelectModal from './ClientSelectModal.tsx';\nimport CreateClientModal from './CreateClientModal.tsx';\nimport { Client, Consultation } from '../types/client.ts';\nimport * as consultationApi from '../api/consultationApi.ts';\nimport * as clientApi from '../api/clientApi.ts';\n\n// Union-Type fr Client und Placeholder\ntype ClientOrPlaceholder = Client | {\n  id: string;\n  name: string;\n  isPlaceholder: boolean;\n  status?: 'past' | 'planned';\n  lastConsultationDate?: string;\n};\n\n// Type Guard fr Placeholder\nconst isPlaceholder = (client: ClientOrPlaceholder): client is { id: string; name: string; isPlaceholder: boolean; status?: 'past' | 'planned'; lastConsultationDate?: string; } => {\n  return 'isPlaceholder' in client && client.isPlaceholder === true;\n};\n\ninterface ConsultationTrackerProps {\n  onConsultationChange: () => void;\n  onConsultationStarted?: (clientName: string) => void;\n}\n\nconst ConsultationTracker: React.FC<ConsultationTrackerProps> = ({ onConsultationChange, onConsultationStarted }) => {\n  const { user } = useAuth();\n  const { selectedBranch } = useBranch();\n  const [activeConsultation, setActiveConsultation] = useState<Consultation | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [isStarting, setIsStarting] = useState(false);\n  const [isClientSelectModalOpen, setIsClientSelectModalOpen] = useState(false);\n  const [isCreateClientModalOpen, setIsCreateClientModalOpen] = useState(false);\n  const [selectedClient, setSelectedClient] = useState<Client | null>(null);\n  const [recentClients, setRecentClients] = useState<Client[]>([]);\n  const [notes, setNotes] = useState('');\n  const [lastStartedClientId, setLastStartedClientId] = useState<number | null>(null);\n  \n  // Responsive Tag-Display States (optimiert)\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [visibleTagCount, setVisibleTagCount] = useState(3); // Fallback fr SSR\n  const [containerWidth, setContainerWidth] = useState(0);\n  const resizeTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Manuelle Erfassung States\n  const [isManualEntry, setIsManualEntry] = useState(false);\n  const [manualStartTime, setManualStartTime] = useState('');\n  const [manualEndTime, setManualEndTime] = useState('');\n\n  useEffect(() => {\n    checkActiveConsultation();\n    loadRecentClients();\n  }, []);\n\n  const checkActiveConsultation = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.WORKTIME.ACTIVE);\n      if (response.data && response.data.clientId) {\n        setActiveConsultation(response.data);\n        setNotes(response.data.notes || '');\n      }\n    } catch (error) {\n      // Stille Behandlung - normale Situation wenn keine aktive Beratung luft\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadRecentClients = async () => {\n    try {\n      console.log('=== FRONTEND: loadRecentClients() called ===');\n      const clients = await clientApi.getRecentClients();\n      console.log('=== FRONTEND: received clients:', clients);\n      setRecentClients(clients || []);\n    } catch (error) {\n      console.error('=== FRONTEND: loadRecentClients() ERROR ===', error);\n      // Stille Behandlung - normale Situation wenn noch keine Clients beraten wurden\n    }\n  };\n\n  const handleStartConsultation = async (clientId: number, notes?: string) => {\n    if (!selectedBranch) {\n      toast.error('Bitte whlen Sie eine Niederlassung aus');\n      return;\n    }\n\n    try {\n      setIsStarting(true);\n      \n      // Zeitzone-korrigierte aktuelle Zeit (gleiche Logik wie bei stopConsultation)\n      const correctedStartTime = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000);\n      \n      const consultation = await consultationApi.startConsultation({\n        branchId: selectedBranch,\n        clientId,\n        notes: notes || '',\n        startTime: correctedStartTime.toISOString()\n      });\n\n      setActiveConsultation(consultation);\n      setNotes(notes || '');\n      setSelectedClient(null);\n      setIsClientSelectModalOpen(false);\n      \n      // Speichere den zuletzt gestarteten Client fr Tag-Priorisierung\n      setLastStartedClientId(clientId);\n      \n      // Sende Event fr SavedFilterTags Aktualisierung\n      window.dispatchEvent(new CustomEvent('consultationChanged'));\n      \n      // Entfernt: Frontend LRU-Logic - Backend sortiert bereits korrekt nach startTime DESC\n      // Lade Recent Clients neu vom Server (Backend liefert bereits richtige Sortierung)\n      loadRecentClients();\n      \n      // Callback fr Parent-Komponente - bergebe die neue Consultation\n      onConsultationChange?.(consultation);\n      \n      // Callback fr Filter-Wechsel (wenn Client-Name verfgbar)\n      if (onConsultationStarted && consultation.client?.name) {\n        onConsultationStarted(consultation.client.name);\n      }\n      \n      toast.success('Beratung gestartet');\n    } catch (error) {\n      console.error('Fehler beim Starten der Beratung:', error);\n      toast.error('Fehler beim Starten der Beratung');\n    } finally {\n      setIsStarting(false);\n    }\n  };\n\n  const stopConsultation = async () => {\n    try {\n      const correctedEndTime = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000);\n      \n      const stoppedConsultation = await consultationApi.stopConsultation({\n        endTime: correctedEndTime.toISOString(),\n        notes: notes || undefined\n      });\n      setActiveConsultation(null);\n      setNotes('');\n      toast.success('Beratung beendet');\n      // Recent Clients nach dem Stoppen aktualisieren\n      loadRecentClients();\n      // Beratungsliste aktualisieren - bergebe die aktualisierte Consultation\n      onConsultationChange?.(stoppedConsultation);\n      // Sende Event fr SavedFilterTags Aktualisierung\n      console.log(' ConsultationTracker: Sending consultationChanged event (stop)');\n      window.dispatchEvent(new CustomEvent('consultationChanged'));\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'Fehler beim Beenden der Beratung');\n    }\n  };\n\n  const handleClientSelect = (client: Client) => {\n    setSelectedClient(client);\n    setIsClientSelectModalOpen(false);\n    if (!isManualEntry) {\n      handleStartConsultation(client.id, notes);\n    }\n  };\n\n  const handleCreateClient = () => {\n    setIsClientSelectModalOpen(false);\n    setIsCreateClientModalOpen(true);\n  };\n\n  const handleClientCreated = (client: Client) => {\n    setIsCreateClientModalOpen(false);\n    setSelectedClient(client);\n    // Entfernt: Automatischer Beratungsstart nach Client-Erstellung\n    // Client wird nur gespeichert, Beratung muss manuell gestartet werden\n    \n    // Recent Clients neu laden um den neuen Client anzuzeigen\n    loadRecentClients();\n    \n    // Success-Toast fr Client-Erstellung (wird bereits im Modal angezeigt)\n    // toast.success(`Client \"${client.name}\" wurde angelegt`);\n  };\n\n  /* CLAUDE-ANCHOR: CONSULTATION-MANUAL-SAVE-001 - Timezone-sichere manuelle Beratungserfassung */\n  const handleManualSave = async () => {\n    if (!selectedClient) {\n      toast.error('Bitte whlen Sie einen Client aus');\n      return;\n    }\n    if (!manualStartTime || !manualEndTime) {\n      toast.error('Bitte geben Sie Start- und Endzeit an');\n      return;\n    }\n    if (!selectedBranch) {\n      toast.error('Bitte whlen Sie eine Niederlassung aus');\n      return;\n    }\n\n    try {\n      setIsStarting(true);\n      \n      /* KRITISCHE TIMEZONE-BEHANDLUNG:\n       * Problem: Inkonsistenz zwischen normaler und manueller Beratung!\n       * \n       * NORMAL WORKING ():\n       * const correctedTime = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000);\n       * \n       * MANUAL BROKEN ():\n       * convertDatetimeLocalToApi() fhrt zu 5h Versatz\n       * \n       * LSUNG: Gleiche getTimezoneOffset-Logik fr beide verwenden!\n       * \n       * datetime-local Input: \"2024-01-15T14:01\"\n       *  new Date(\"2024-01-15T14:01\") erstellt lokales Date-Objekt\n       *  getTimezoneOffset() korrigiert zur gleichen Zeit wie bei normaler Beratung\n       *  KONSISTENTE Zeitbehandlung!\n       */\n      \n      //  KORRIGIERT: Verwende gleiche Logik wie bei normalem Start/Stop\n      const manualStart = new Date(manualStartTime);\n      const correctedStartTime = new Date(manualStart.getTime() - manualStart.getTimezoneOffset() * 60000);\n      \n      const manualEnd = new Date(manualEndTime);\n      const correctedEndTime = new Date(manualEnd.getTime() - manualEnd.getTimezoneOffset() * 60000);\n      \n      // Starte die Beratung mit der korrigierten Startzeit\n      const consultation = await consultationApi.startConsultation({\n        branchId: selectedBranch,\n        clientId: selectedClient.id,\n        notes: notes || '',\n        startTime: correctedStartTime.toISOString()  //  Konsistent mit normaler Beratung\n      });\n      \n      // Beende sie sofort mit der korrigierten Endzeit\n      const stoppedConsultation = await consultationApi.stopConsultation({\n        endTime: correctedEndTime.toISOString(),      //  Konsistent mit normaler Beratung\n        notes: notes || ''\n      });\n      \n      // Reset der Eingaben\n      setIsManualEntry(false);\n      setManualStartTime('');\n      setManualEndTime('');\n      setNotes('');\n      setSelectedClient(null);\n      \n      // Speichere den zuletzt gestarteten Client fr Tag-Priorisierung\n      setLastStartedClientId(selectedClient.id);\n      \n      // Sende Event fr SavedFilterTags Aktualisierung\n      console.log(' ConsultationTracker: Sending consultationChanged event (start)');\n      window.dispatchEvent(new CustomEvent('consultationChanged'));\n      \n      // Lade Recent Clients neu\n      loadRecentClients();\n      \n      // Callback fr Parent-Komponente - bergebe die beendete Consultation\n      onConsultationChange?.(stoppedConsultation);\n      \n      // Callback fr Filter-Wechsel\n      if (onConsultationStarted && selectedClient.name) {\n        onConsultationStarted(selectedClient.name);\n      }\n      \n      toast.success('Beratung erfolgreich erfasst');\n    } catch (error) {\n      console.error('Fehler beim Erfassen der Beratung:', error);\n      toast.error('Fehler beim Erfassen der Beratung');\n    } finally {\n      setIsStarting(false);\n    }\n  };\n\n  const updateNotes = async () => {\n    if (!activeConsultation) return;\n    \n    try {\n      await consultationApi.updateConsultationNotes(activeConsultation.id, { notes });\n    } catch (error) {\n      // Stille Behandlung - Auto-Save sollte nicht strend sein\n    }\n  };\n\n  // Auto-save Notizen alle 30 Sekunden\n  useEffect(() => {\n    if (!activeConsultation || !notes) return;\n    \n    const timeout = setTimeout(() => {\n      updateNotes();\n    }, 30000);\n    \n    return () => clearTimeout(timeout);\n  }, [notes, activeConsultation]);\n\n  // Recent Clients aktualisieren wenn Fenster wieder fokussiert wird\n  useEffect(() => {\n    const handleFocus = () => {\n      loadRecentClients();\n    };\n\n    window.addEventListener('focus', handleFocus);\n    \n    return () => {\n      window.removeEventListener('focus', handleFocus);\n    };\n  }, []);\n\n  // Optimierte Tag-Breiten-Berechnung mit useMemo\n  const averageTagWidth = useMemo(() => {\n    if (recentClients.length === 0) return 85; // Reduzierter Fallback\n    \n    return recentClients.reduce((sum, client) => {\n      // Przisere Schtzung: ~6px pro Zeichen + 24px Padding\n      return sum + (client.name.length * 6 + 24);\n    }, 0) / recentClients.length;\n  }, [recentClients]);\n\n  // Optimierte Sichtbarkeits-Berechnung mit useCallback (vereinfacht ohne Dropdown)\n  const calculateVisibleTags = useCallback(() => {\n    if (!containerRef.current || recentClients.length === 0) return;\n\n    const container = containerRef.current;\n    const currentWidth = container.clientWidth;\n    \n    // Nur neu berechnen wenn sich die Breite signifikant gendert hat (>= 40px)\n    if (Math.abs(currentWidth - containerWidth) < 40) return;\n    \n    setContainerWidth(currentWidth);\n    \n    // Moderate responsive Abstnde fr bessere Tag-Anzeige\n    const isMobile = currentWidth < 768; // md breakpoint\n    const PLUS_BUTTON_WIDTH = 32; // Reduziert von 42\n    const GAPS_AND_MARGINS = isMobile ? 8 : 20; // Mobile: 8px, Desktop: 20px (weniger extrem)\n    const BUFFER = 12; // Reduziert von 16\n    \n    const availableWidth = currentWidth - PLUS_BUTTON_WIDTH - GAPS_AND_MARGINS - BUFFER;\n    \n    // Berechne maximal mgliche Tags (einfach soviele wie reinpassen)\n    const maxPossibleTags = Math.max(1, Math.floor(availableWidth / averageTagWidth));\n    \n    // Zeige soviele Tags wie reinpassen, maximal aber die verfgbaren\n    setVisibleTagCount(Math.min(maxPossibleTags, recentClients.length));\n  }, [recentClients, averageTagWidth, containerWidth]);\n\n  // Debounced ResizeObserver fr bessere Performance\n  const handleResize = useCallback(() => {\n    if (resizeTimeoutRef.current) {\n      clearTimeout(resizeTimeoutRef.current);\n    }\n    \n    resizeTimeoutRef.current = setTimeout(() => {\n      calculateVisibleTags();\n    }, 150); // 150ms Debounce fr smooth responsive behavior\n  }, [calculateVisibleTags]);\n\n  // Optimierter ResizeObserver\n  useEffect(() => {\n    if (!containerRef.current) return;\n\n    const resizeObserver = new ResizeObserver(handleResize);\n    resizeObserver.observe(containerRef.current);\n    \n    // Auch Window-Resize berwachen fr bessere Abdeckung\n    window.addEventListener('resize', handleResize);\n\n    return () => {\n      resizeObserver.disconnect();\n      window.removeEventListener('resize', handleResize);\n      if (resizeTimeoutRef.current) {\n        clearTimeout(resizeTimeoutRef.current);\n      }\n    };\n  }, [handleResize]);\n\n  // Initial calculation nach Client-nderungen\n  useLayoutEffect(() => {\n    calculateVisibleTags();\n  }, [calculateVisibleTags]);\n\n  // Optimistische Tag-Anzeige fr bessere UX\n  const showOptimisticTags = recentClients.length === 0 && loading;\n  const optimisticTags = useMemo(() => {\n    if (!showOptimisticTags) return [];\n    return Array(3).fill(null).map((_, i) => ({\n      id: `placeholder-${i}`,\n      name: '', // Placeholder\n      isPlaceholder: true,\n      status: undefined,\n      lastConsultationDate: undefined\n    }));\n  }, [showOptimisticTags]);\n\n  const displayTags = showOptimisticTags ? optimisticTags : recentClients;\n  const currentVisibleCount = showOptimisticTags ? optimisticTags.length : visibleTagCount;\n\n  // Sortiere displayTags: Zuletzt gestarteter Client zuerst\n  const sortedDisplayTags = useMemo(() => {\n    if (showOptimisticTags || !lastStartedClientId) {\n      return displayTags;\n    }\n    \n    // Finde den zuletzt gestarteten Client\n    const lastStartedClient = displayTags.find(client => client.id === lastStartedClientId);\n    if (!lastStartedClient) {\n      return displayTags;\n    }\n    \n    // Setze den zuletzt gestarteten Client an die erste Position\n    const otherClients = displayTags.filter(client => client.id !== lastStartedClientId);\n    return [lastStartedClient, ...otherClients];\n  }, [displayTags, lastStartedClientId, showOptimisticTags]);\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-4\"></div>\n          <div className=\"h-12 bg-gray-200 dark:bg-gray-700 rounded mb-2\"></div>\n          <div className=\"h-12 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <div className=\"bg-white dark:bg-gray-800 shadow rounded-lg p-6 sm:p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white flex items-center pl-2 sm:pl-0\">\n            <UserGroupIcon className=\"h-6 w-6 mr-2 sm:h-6 sm:w-6 sm:mr-2\" />\n            Beratungs-Tracker\n          </h2>\n          {activeConsultation && (\n            <div className=\"flex items-center text-green-600 dark:text-green-400\">\n              <ClockIcon className=\"h-5 w-5 mr-2 animate-pulse\" />\n              <span className=\"font-medium\">\n                {calculateDuration(activeConsultation.startTime, null)} - {activeConsultation.client?.name}\n              </span>\n            </div>\n          )}\n        </div>\n\n        {/* Aktive Beratung oder Start-Buttons */}\n        {activeConsultation ? (\n          <div className=\"space-y-4\">\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">Aktive Beratung mit</p>\n              <p className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                {activeConsultation.client?.name}\n              </p>\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                Gestartet: {formatTime(activeConsultation.startTime)}\n              </p>\n            </div>\n\n            {/* Notizen-Bereich */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                Notizen zur Beratung\n              </label>\n              <textarea\n                value={notes}\n                onChange={(e) => setNotes(e.target.value)}\n                onBlur={updateNotes}\n                className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                rows={3}\n                placeholder=\"Notizen hier eingeben...\"\n              />\n            </div>\n\n            <button\n              onClick={stopConsultation}\n              className=\"w-full flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n            >\n              <StopIcon className=\"h-5 w-5 mr-2\" />\n              Beratung beenden\n            </button>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {/* Zuletzt beratene Clients als Tags mit vereinfachtem responsive Layout (ohne Dropdown) */}\n            {(sortedDisplayTags.length > 0) && !isManualEntry && (\n              <div>\n                <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  {sortedDisplayTags.some(c => !isPlaceholder(c) && c.status === 'planned') ? \n                    'Zuletzt beraten & geplante Beratungen:' : \n                    'Zuletzt beraten:'\n                  }\n                </p>\n                <div ref={containerRef} className=\"flex items-center gap-0.5 md:gap-6\">\n                  {/* Neuer Client Button - links positioniert mit extremen responsiven Abstnden */}\n                  <button\n                    onClick={() => setIsCreateClientModalOpen(true)}\n                    disabled={showOptimisticTags}\n                    className={`bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center flex-shrink-0 ${showOptimisticTags ? 'opacity-50 cursor-not-allowed' : ''}`}\n                    style={{ width: '30.19px', height: '30.19px' }}\n                    title=\"Neuen Client anlegen\"\n                    aria-label=\"Neuen Client anlegen\"\n                  >\n                    <PlusIcon className=\"h-4 w-4\" />\n                  </button>\n                  \n                  {/* Soviele Client-Tags wie reinpassen (ohne Dropdown) */}\n                  <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                    {sortedDisplayTags.slice(0, currentVisibleCount).map((client, index) => {\n                      const isPast = !isPlaceholder(client) && client.status === 'past';\n                      const isPlanned = !isPlaceholder(client) && client.status === 'planned';\n                      \n                      return (\n                        <button\n                          key={client.id}\n                          onClick={() => !isPlaceholder(client) && handleStartConsultation(Number(client.id), notes)}\n                          disabled={isPlaceholder(client)}\n                          className={`inline-flex items-center px-3 py-2 rounded-full text-sm font-medium flex-shrink-0 transition-colors ${\n                            isPlaceholder(client) \n                              ? 'bg-gray-200 dark:bg-gray-600 text-gray-400 dark:text-gray-500 animate-pulse cursor-default'\n                              : isPlanned\n                                ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 hover:bg-blue-200 dark:hover:bg-blue-900/50 cursor-pointer border border-blue-200 dark:border-blue-700'\n                                : 'bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600 cursor-pointer'\n                          }`}\n                          title={\n                            isPlaceholder(client) \n                              ? 'Ldt...' \n                              : isPlanned\n                                ? `Geplante Beratung mit ${client.name} am ${client.lastConsultationDate ? new Date(client.lastConsultationDate).toLocaleDateString('de-DE', { day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit' }) : ''}`\n                                : `Beratung mit ${client.name} starten (zuletzt beraten${client.lastConsultationDate ? ` am ${new Date(client.lastConsultationDate).toLocaleDateString('de-DE')}` : ''})`\n                          }\n                        >\n                          {isPlanned && !isPlaceholder(client) && (\n                            <svg className=\"h-3 w-3 mr-1.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                              <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\" clipRule=\"evenodd\"/>\n                            </svg>\n                          )}\n                          <span className=\"truncate max-w-[120px]\">\n                            {isPlaceholder(client) ? (\n                              <span className=\"inline-block w-16 h-4 bg-gray-300 dark:bg-gray-500 rounded animate-pulse\"></span>\n                            ) : (\n                              client.name\n                            )}\n                          </span>\n                        </button>\n                      );\n                    })}\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Start-Buttons */}\n            <div className=\"flex gap-6\">\n              <button\n                onClick={() => setIsClientSelectModalOpen(true)}\n                className=\"w-2/3 flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                title=\"Beratung starten\"\n              >\n                <PlayIcon className=\"h-5 w-5\" />\n              </button>\n\n              <button\n                onClick={() => {\n                  setIsManualEntry(!isManualEntry);\n                  setSelectedClient(null);\n                  setManualStartTime('');\n                  setManualEndTime('');\n                  setNotes('');\n                }}\n                className={`w-1/3 flex items-center justify-center px-4 py-3 border text-base font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${\n                  isManualEntry\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20'\n                    : 'border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600'\n                }`}\n                title=\"Planen\"\n              >\n                <ClockIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n\n            {/* Manuelle Erfassung / Planen */}\n            {isManualEntry && (\n              <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 space-y-3\">\n                <h3 className=\"text-sm font-medium text-gray-900 dark:text-white mb-3\">\n                  Beratung planen\n                </h3>\n                \n                {/* Client-Auswahl */}\n                <div>\n                  <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Client\n                  </label>\n                  {selectedClient ? (\n                    <div className=\"flex items-center justify-between bg-white dark:bg-gray-800 rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2\">\n                      <span className=\"text-sm text-gray-900 dark:text-white\">{selectedClient.name}</span>\n                      <button\n                        onClick={() => setIsClientSelectModalOpen(true)}\n                        className=\"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                      >\n                        ndern\n                      </button>\n                    </div>\n                  ) : (\n                    <button\n                      onClick={() => setIsClientSelectModalOpen(true)}\n                      className=\"w-full text-left bg-white dark:bg-gray-800 rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 text-sm text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700\"\n                    >\n                      Client auswhlen...\n                    </button>\n                  )}\n                </div>\n\n                {/* Zeit-Inputs */}\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      Startzeit\n                    </label>\n                    <input\n                      type=\"datetime-local\"\n                      value={manualStartTime}\n                      onChange={(e) => setManualStartTime(e.target.value)}\n                      className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      Endzeit\n                    </label>\n                    <input\n                      type=\"datetime-local\"\n                      value={manualEndTime}\n                      onChange={(e) => setManualEndTime(e.target.value)}\n                      className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    />\n                  </div>\n                </div>\n\n                {/* Notizen */}\n                <div>\n                  <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Notizen\n                  </label>\n                  <textarea\n                    value={notes}\n                    onChange={(e) => setNotes(e.target.value)}\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    rows={2}\n                    placeholder=\"Optionale Notizen...\"\n                  />\n                </div>\n\n                {/* Speichern-Button */}\n                <div className=\"flex justify-end\">\n                  <button\n                    onClick={handleManualSave}\n                    disabled={!selectedClient || !manualStartTime || !manualEndTime}\n                    className=\"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    Beratung speichern\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Modals */}\n      <ClientSelectModal\n        isOpen={isClientSelectModalOpen}\n        onClose={() => setIsClientSelectModalOpen(false)}\n        onSelect={handleClientSelect}\n        onCreateNew={handleCreateClient}\n      />\n\n      <CreateClientModal\n        isOpen={isCreateClientModalOpen}\n        onClose={() => setIsCreateClientModalOpen(false)}\n        onSave={handleClientCreated}\n      />\n    </>\n  );\n};\n\nexport default ConsultationTracker; ","import React, { useState, useEffect } from 'react';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, MagnifyingGlassIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { toast } from 'react-toastify';\r\n\r\ninterface Task {\r\n  id: number;\r\n  title: string;\r\n  status: string;\r\n  responsible?: {\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n}\r\n\r\ninterface LinkTaskModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  consultationId: number;\r\n  onTaskLinked: () => void;\r\n}\r\n\r\nconst LinkTaskModal: React.FC<LinkTaskModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  consultationId,\r\n  onTaskLinked\r\n}) => {\r\n  const [tasks, setTasks] = useState<Task[]>([]);\r\n  const [filteredTasks, setFilteredTasks] = useState<Task[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedTaskId, setSelectedTaskId] = useState<number | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      loadTasks();\r\n    }\r\n  }, [isOpen]);\r\n\r\n  useEffect(() => {\r\n    if (searchTerm) {\r\n      const filtered = tasks.filter(task => \r\n        task.title.toLowerCase().includes(searchTerm.toLowerCase())\r\n      );\r\n      setFilteredTasks(filtered);\r\n    } else {\r\n      setFilteredTasks(tasks);\r\n    }\r\n  }, [searchTerm, tasks]);\r\n\r\n  const loadTasks = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await axiosInstance.get(API_ENDPOINTS.TASKS.BASE);\r\n      // Filtere nur offene und in Bearbeitung befindliche Tasks\r\n      const activeTasks = response.data.filter((task: Task) => \r\n        task.status === 'open' || task.status === 'in_progress'\r\n      );\r\n      setTasks(activeTasks);\r\n      setFilteredTasks(activeTasks);\r\n    } catch (error) {\r\n      toast.error('Fehler beim Laden der Tasks');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleLinkTask = async () => {\r\n    if (!selectedTaskId) {\r\n      toast.error('Bitte whlen Sie einen Task aus');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await axiosInstance.post(\r\n        API_ENDPOINTS.CONSULTATIONS.LINK_TASK(consultationId),\r\n        { taskId: selectedTaskId }\r\n      );\r\n      \r\n      toast.success('Task erfolgreich verknpft');\r\n      onTaskLinked();\r\n      onClose();\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || 'Fehler beim Verknpfen des Tasks');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n      \r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n          <div className=\"p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                Task verknpfen\r\n              </Dialog.Title>\r\n              <button\r\n                onClick={onClose}\r\n                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n              >\r\n                <XMarkIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Suchfeld */}\r\n            <div className=\"relative mb-4\">\r\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                <MagnifyingGlassIcon className=\"h-5 w-5 text-gray-400\" />\r\n              </div>\r\n              <input\r\n                type=\"text\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n                placeholder=\"Task suchen...\"\r\n                autoFocus\r\n              />\r\n            </div>\r\n\r\n            {/* Task-Liste */}\r\n            <div className=\"max-h-96 overflow-y-auto\">\r\n              {loading ? (\r\n                <div className=\"text-center py-4 text-gray-500 dark:text-gray-400\">\r\n                  Lade Tasks...\r\n                </div>\r\n              ) : filteredTasks.length === 0 ? (\r\n                <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\r\n                  Keine passenden Tasks gefunden\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  {filteredTasks.map((task) => (\r\n                    <label\r\n                      key={task.id}\r\n                      className=\"flex items-center p-3 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer\"\r\n                    >\r\n                      <input\r\n                        type=\"radio\"\r\n                        name=\"task\"\r\n                        value={task.id}\r\n                        checked={selectedTaskId === task.id}\r\n                        onChange={() => setSelectedTaskId(task.id)}\r\n                        className=\"mr-3\"\r\n                      />\r\n                      <div className=\"flex-1\">\r\n                        <p className=\"font-medium text-gray-900 dark:text-white\">\r\n                          {task.title}\r\n                        </p>\r\n                        {task.responsible && (\r\n                          <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                            Verantwortlich: {task.responsible.firstName} {task.responsible.lastName}\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                      <span className={`px-2 py-1 text-xs rounded-full ${\r\n                        task.status === 'open' \r\n                          ? 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'\r\n                          : 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300'\r\n                      }`}>\r\n                        {task.status === 'open' ? 'Offen' : 'In Bearbeitung'}\r\n                      </span>\r\n                    </label>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Buttons */}\r\n            <div className=\"mt-6 flex items-center justify-end space-x-3\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={onClose}\r\n                className=\"px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n              >\r\n                Abbrechen\r\n              </button>\r\n              <button\r\n                onClick={handleLinkTask}\r\n                disabled={!selectedTaskId}\r\n                className=\"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                Verknpfen\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default LinkTaskModal; ","import React, { useState } from 'react';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { \r\n  CheckCircleIcon, \r\n  XMarkIcon, \r\n  DocumentArrowDownIcon,\r\n  EyeIcon \r\n} from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { toast } from 'react-toastify';\r\n\r\ninterface InvoiceSuccessModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  invoiceId: number;\r\n  invoiceNumber: string;\r\n  totalAmount: string;\r\n  clientName: string;\r\n}\r\n\r\nconst InvoiceSuccessModal: React.FC<InvoiceSuccessModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  invoiceId,\r\n  invoiceNumber,\r\n  totalAmount,\r\n  clientName\r\n}) => {\r\n  const [downloadingPdf, setDownloadingPdf] = useState(false);\r\n\r\n  const handleDownloadPdf = async () => {\r\n    try {\r\n      setDownloadingPdf(true);\r\n      \r\n      const response = await axiosInstance.get(\r\n        API_ENDPOINTS.CONSULTATION_INVOICES.GENERATE_PDF(invoiceId),\r\n        { \r\n          responseType: 'blob',\r\n          headers: {\r\n            'Accept': 'application/pdf'\r\n          }\r\n        }\r\n      );\r\n      \r\n      // Erstelle Blob und Download-Link\r\n      const blob = new Blob([response.data], { type: 'application/pdf' });\r\n      const url = window.URL.createObjectURL(blob);\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      link.download = `Rechnung_${invoiceNumber}.pdf`;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n      window.URL.revokeObjectURL(url);\r\n      \r\n      toast.success('PDF erfolgreich heruntergeladen');\r\n    } catch (error: any) {\r\n      console.error('Fehler beim Download der PDF:', error);\r\n      toast.error(error.response?.data?.message || 'Fehler beim Download der PDF');\r\n    } finally {\r\n      setDownloadingPdf(false);\r\n    }\r\n  };\r\n\r\n  const handleViewInvoiceManagement = () => {\r\n    // TODO: Navigation zur Rechnungsverwaltung (wird in Phase 5 implementiert)\r\n    toast.info('Rechnungsverwaltung wird in Phase 5 implementiert');\r\n    onClose();\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n      \r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n          <div className=\"p-6\">\r\n            {/* Header mit Success Icon */}\r\n            <div className=\"flex items-center justify-between mb-6\">\r\n              <div className=\"flex items-center\">\r\n                <CheckCircleIcon className=\"h-8 w-8 text-green-500 mr-3\" />\r\n                <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                  Rechnung erstellt\r\n                </Dialog.Title>\r\n              </div>\r\n              <button\r\n                onClick={onClose}\r\n                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n              >\r\n                <XMarkIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Success Inhalt */}\r\n            <div className=\"space-y-4\">\r\n              <div className=\"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4\">\r\n                <h3 className=\"font-medium text-green-800 dark:text-green-200 mb-2\">\r\n                  Rechnung erfolgreich erstellt\r\n                </h3>\r\n                <div className=\"text-sm text-green-700 dark:text-green-300 space-y-1\">\r\n                  <p><strong>Rechnungsnummer:</strong> {invoiceNumber}</p>\r\n                  <p><strong>Kunde:</strong> {clientName}</p>\r\n                  <p><strong>Betrag:</strong> CHF {totalAmount}</p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Hinweise */}\r\n              <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\r\n                <h4 className=\"font-medium text-blue-800 dark:text-blue-200 mb-2\">\r\n                  Nchste Schritte\r\n                </h4>\r\n                <ul className=\"text-sm text-blue-700 dark:text-blue-300 space-y-1\">\r\n                  <li> PDF herunterladen und an Kunde senden</li>\r\n                  <li> Beratungen sind nun als abgerechnet markiert</li>\r\n                  <li> Rechnung in der Rechnungsverwaltung verwalten</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Aktionen */}\r\n            <div className=\"mt-6 flex flex-col space-y-3\">\r\n              <button\r\n                onClick={handleDownloadPdf}\r\n                disabled={downloadingPdf}\r\n                className=\"w-full flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {downloadingPdf ? (\r\n                  <>\r\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                    PDF wird generiert...\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <DocumentArrowDownIcon className=\"h-5 w-5 mr-2\" />\r\n                    PDF herunterladen\r\n                  </>\r\n                )}\r\n              </button>\r\n\r\n              <button\r\n                onClick={handleViewInvoiceManagement}\r\n                className=\"w-full flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n              >\r\n                <EyeIcon className=\"h-5 w-5 mr-2\" />\r\n                Zur Rechnungsverwaltung\r\n              </button>\r\n\r\n              <button\r\n                onClick={onClose}\r\n                className=\"w-full px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200\"\r\n              >\r\n                Schlieen\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default InvoiceSuccessModal; ","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, CheckIcon, ArrowPathIcon, DocumentTextIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { usePermissions } from '../hooks/usePermissions.ts';\r\nimport { toast } from 'react-toastify';\r\nimport { Consultation } from '../types/client.ts';\r\nimport { calculateDuration, formatTime } from '../utils/dateUtils.ts';\r\nimport { format } from 'date-fns';\r\nimport InvoiceSuccessModal from './InvoiceSuccessModal.tsx';\r\n\r\ninterface CreateInvoiceModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  consultations: Consultation[];\r\n  onInvoiceCreated: (invoiceId: number) => void;\r\n}\r\n\r\ninterface InvoiceSettings {\r\n  companyName: string;\r\n  companyAddress: string;\r\n  companyZip: string;\r\n  companyCity: string;\r\n  companyCountry: string;\r\n  companyPhone?: string;\r\n  companyEmail?: string;\r\n  vatNumber?: string;\r\n  iban: string;\r\n  defaultHourlyRate: number;\r\n  defaultVatRate?: number;\r\n  invoicePrefix: string;\r\n  nextInvoiceNumber: number;\r\n}\r\n\r\ninterface CreatedInvoice {\r\n  id: number;\r\n  invoiceNumber: string;\r\n  total: number;\r\n  clientName: string;\r\n}\r\n\r\nconst CreateInvoiceModal: React.FC<CreateInvoiceModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  consultations,\r\n  onInvoiceCreated\r\n}) => {\r\n  const { hasPermission } = usePermissions();\r\n  const [loading, setLoading] = useState(false);\r\n  const [settings, setSettings] = useState<InvoiceSettings | null>(null);\r\n  const [createdInvoice, setCreatedInvoice] = useState<CreatedInvoice | null>(null);\r\n  const [showSuccessModal, setShowSuccessModal] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    issueDate: format(new Date(), 'yyyy-MM-dd'),\r\n    dueDate: format(new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), 'yyyy-MM-dd'),\r\n    hourlyRate: 0,\r\n    vatRate: 0,\r\n    notes: ''\r\n  });\r\n\r\n  // Berechtigungsprfung\r\n  const canCreateInvoices = hasPermission('invoice_create', 'write', 'button');\r\n  \r\n  // loadInvoiceSettings Funktion MUSS vor useEffect definiert werden\r\n  const loadInvoiceSettings = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await axiosInstance.get(API_ENDPOINTS.INVOICE_SETTINGS.BASE);\r\n      const settingsData = response.data;\r\n      \r\n      setSettings(settingsData);\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        hourlyRate: settingsData.defaultHourlyRate || 0,\r\n        vatRate: settingsData.defaultVatRate || 0\r\n      }));\r\n    } catch (error: any) {\r\n      console.error('Fehler beim Laden der Rechnungseinstellungen:', error);\r\n      if (error.response?.status === 404) {\r\n        toast.error('Bitte konfigurieren Sie zuerst Ihre Rechnungseinstellungen');\r\n      } else {\r\n        toast.error('Fehler beim Laden der Rechnungseinstellungen');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n  \r\n  // useEffect MUSS vor allen frhen Returns stehen!\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      loadInvoiceSettings();\r\n    }\r\n  }, [isOpen, loadInvoiceSettings]);\r\n\r\n  // Berechtigungsprfung - NACH useEffect\r\n  if (!canCreateInvoices) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6\">\r\n            <div className=\"text-center\">\r\n              <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\r\n                Keine Berechtigung\r\n              </h3>\r\n              <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\r\n                Sie haben keine Berechtigung, Rechnungen zu erstellen.\r\n              </p>\r\n              <button\r\n                onClick={onClose}\r\n                className=\"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400\"\r\n              >\r\n                Schlieen\r\n              </button>\r\n            </div>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!settings) {\r\n      toast.error('Rechnungseinstellungen konnten nicht geladen werden');\r\n      return;\r\n    }\r\n\r\n    if (consultations.length === 0) {\r\n      toast.error('Keine Beratungen zum Abrechnen vorhanden');\r\n      return;\r\n    }\r\n\r\n    // Validiere, dass alle Consultations den gleichen Client haben\r\n    const uniqueClientIds = [...new Set(consultations.map(c => c.clientId))];\r\n    if (uniqueClientIds.length > 1) {\r\n      toast.error('Alle Beratungen mssen den gleichen Kunden haben');\r\n      return;\r\n    }\r\n\r\n    const clientId = uniqueClientIds[0];\r\n    if (!clientId) {\r\n      toast.error('Kein gltiger Kunde in den Beratungen gefunden');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      const response = await axiosInstance.post(\r\n        API_ENDPOINTS.CONSULTATION_INVOICES.CREATE_FROM_CONSULTATIONS,\r\n        {\r\n          consultationIds: consultations.map(c => c.id),\r\n          clientId: clientId,\r\n          issueDate: formData.issueDate,\r\n          dueDate: formData.dueDate,\r\n          hourlyRate: formData.hourlyRate,\r\n          vatRate: formData.vatRate || 0,\r\n          notes: formData.notes\r\n        }\r\n      );\r\n      \r\n      const invoice = response.data;\r\n      const clientName = consultations[0]?.client?.name || 'Unbekannt';\r\n      \r\n      setCreatedInvoice({\r\n        id: invoice.id,\r\n        invoiceNumber: invoice.invoiceNumber,\r\n        total: invoice.total,\r\n        clientName: clientName\r\n      });\r\n      \r\n      setShowSuccessModal(true);\r\n      onInvoiceCreated(invoice.id);\r\n      \r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || 'Fehler beim Erstellen der Rechnung');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value } = e.target;\r\n    setFormData(prev => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const handleCloseAll = () => {\r\n    setShowSuccessModal(false);\r\n    setCreatedInvoice(null);\r\n    onClose();\r\n  };\r\n\r\n  // Berechnungen fr die Kostenbersicht\r\n  const totalHours = consultations.reduce((sum, consultation) => {\r\n    if (consultation.endTime) {\r\n      const duration = calculateDuration(consultation.startTime, consultation.endTime);\r\n      const hours = parseFloat(duration.replace('h', '').replace(',', '.'));\r\n      return sum + hours;\r\n    }\r\n    return sum;\r\n  }, 0);\r\n\r\n  const estimatedTotal = totalHours * formData.hourlyRate;\r\n  const vatAmount = formData.vatRate > 0 ? (estimatedTotal * formData.vatRate / 100) : 0;\r\n  const totalWithVat = estimatedTotal + vatAmount;\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <>\r\n      <Dialog open={isOpen && !showSuccessModal} onClose={onClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n            <form onSubmit={handleSubmit} className=\"p-6\">\r\n              <div className=\"flex items-center justify-between mb-6\">\r\n                <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                  Rechnung erstellen\r\n                </Dialog.Title>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={onClose}\r\n                  className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n\r\n              {/* Beratungen bersicht */}\r\n              <div className=\"mb-6 bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4\">\r\n                <h3 className=\"font-medium text-gray-900 dark:text-white mb-3\">\r\n                  Zu verrechnende Beratungen\r\n                </h3>\r\n                <div className=\"space-y-2 max-h-40 overflow-y-auto\">\r\n                  {consultations.map((consultation) => (\r\n                    <div key={consultation.id} className=\"flex justify-between items-center text-sm\">\r\n                      <div>\r\n                        <span className=\"text-gray-900 dark:text-white\">\r\n                          {consultation.client?.name} - {formatTime(consultation.startTime)}\r\n                        </span>\r\n                      </div>\r\n                      <span className=\"text-gray-600 dark:text-gray-400\">\r\n                        {calculateDuration(consultation.startTime, consultation.endTime)}\r\n                      </span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n                <div className=\"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600 flex justify-between text-sm font-medium\">\r\n                  <span>Gesamtdauer:</span>\r\n                  <span>{totalHours.toFixed(2)}h</span>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Rechnungsdetails */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    Rechnungsdatum\r\n                  </label>\r\n                  <input\r\n                    type=\"date\"\r\n                    name=\"issueDate\"\r\n                    value={formData.issueDate}\r\n                    onChange={handleChange}\r\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    Flligkeitsdatum\r\n                  </label>\r\n                  <input\r\n                    type=\"date\"\r\n                    name=\"dueDate\"\r\n                    value={formData.dueDate}\r\n                    onChange={handleChange}\r\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    Stundensatz (CHF)\r\n                  </label>\r\n                  <input\r\n                    type=\"number\"\r\n                    name=\"hourlyRate\"\r\n                    value={formData.hourlyRate}\r\n                    onChange={handleChange}\r\n                    step=\"0.01\"\r\n                    min=\"0\"\r\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    MwSt.-Satz (%)\r\n                  </label>\r\n                  <input\r\n                    type=\"number\"\r\n                    name=\"vatRate\"\r\n                    value={formData.vatRate}\r\n                    onChange={handleChange}\r\n                    step=\"0.1\"\r\n                    min=\"0\"\r\n                    max=\"100\"\r\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Notizen */}\r\n              <div className=\"mb-6\">\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                  Zustzliche Notizen\r\n                </label>\r\n                <textarea\r\n                  name=\"notes\"\r\n                  value={formData.notes}\r\n                  onChange={handleChange}\r\n                  rows={3}\r\n                  className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                  placeholder=\"Optionale Notizen zur Rechnung...\"\r\n                />\r\n              </div>\r\n\r\n              {/* Kostenbersicht */}\r\n              <div className=\"mb-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\r\n                <h3 className=\"font-medium text-blue-800 dark:text-blue-200 mb-3\">\r\n                  Kostenbersicht\r\n                </h3>\r\n                <div className=\"space-y-2 text-sm\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Beratungszeit ({totalHours.toFixed(2)}h  CHF {formData.hourlyRate}):</span>\r\n                    <span>CHF {estimatedTotal.toFixed(2)}</span>\r\n                  </div>\r\n                  {formData.vatRate > 0 && (\r\n                    <div className=\"flex justify-between\">\r\n                      <span>MwSt. ({formData.vatRate}%):</span>\r\n                      <span>CHF {vatAmount.toFixed(2)}</span>\r\n                    </div>\r\n                  )}\r\n                  <div className=\"border-t border-blue-200 dark:border-blue-700 pt-2 flex justify-between font-medium\">\r\n                    <span>Gesamtbetrag:</span>\r\n                    <span>CHF {totalWithVat.toFixed(2)}</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Buttons */}\r\n              <div className=\"flex items-center justify-end space-x-3\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={onClose}\r\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\r\n                  title=\"Abbrechen\"\r\n                >\r\n                  <XMarkIcon className=\"h-5 w-5\" />\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={loading || !settings || totalHours === 0}\r\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                  title={loading ? 'Erstelle Rechnung...' : 'Rechnung erstellen'}\r\n                >\r\n                  {loading ? (\r\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n                  ) : (\r\n                    <DocumentTextIcon className=\"h-5 w-5\" />\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n\r\n      {/* Success Modal */}\r\n      {showSuccessModal && createdInvoice && (\r\n        <InvoiceSuccessModal\r\n          isOpen={showSuccessModal}\r\n          onClose={handleCloseAll}\r\n          invoiceId={createdInvoice.id}\r\n          invoiceNumber={createdInvoice.invoiceNumber}\r\n          totalAmount={Number(createdInvoice.total).toFixed(2)}\r\n          clientName={createdInvoice.clientName}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CreateInvoiceModal; ","import React, { useState, useEffect, useMemo, useImperativeHandle, forwardRef, useCallback } from 'react';\nimport { \n  ClockIcon, \n  FunnelIcon,\n  XMarkIcon,\n  LinkIcon,\n  TrashIcon,\n  DocumentTextIcon,\n  ChartBarIcon,\n  CheckIcon\n} from '@heroicons/react/24/outline';\nimport { useNavigate } from 'react-router-dom';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { \n  formatTime, \n  calculateDuration, \n  formatTotalDuration, \n  isConsultationInvoiced, \n  getConsultationInvoiceInfo,\n  getInvoiceStatusText,\n  getInvoiceStatusColor \n} from '../utils/dateUtils.ts';\nimport { Consultation, Client } from '../types/client.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { toast } from 'react-toastify';\nimport LinkTaskModal from './LinkTaskModal.tsx';\nimport FilterPane from './FilterPane.tsx';\nimport SavedFilterTags from './SavedFilterTags.tsx';\nimport { FilterCondition } from './FilterRow.tsx';\nimport * as consultationApi from '../api/consultationApi.ts';\nimport * as clientApi from '../api/clientApi.ts';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport CreateInvoiceModal from './CreateInvoiceModal.tsx';\n\n// TableID fr gespeicherte Filter\nconst CONSULTATIONS_TABLE_ID = 'consultations-table';\n\ninterface ConsultationListProps {\n  onConsultationChange?: () => void;\n}\n\n// Ref-Interface fr imperatives Handle\nexport interface ConsultationListRef {\n  refresh: () => void;\n  addConsultation?: (consultation: Consultation) => void;\n  updateConsultation?: (consultation: Consultation) => void;\n  removeConsultation?: (consultationId: number) => void;\n  activateClientFilter?: (clientName: string) => void;\n}\n\nconst ConsultationList = forwardRef<ConsultationListRef, ConsultationListProps>(({ onConsultationChange }, ref) => {\n  const { hasPermission } = usePermissions();\n  const navigate = useNavigate();\n  const [consultations, setConsultations] = useState<Consultation[]>([]);\n  const [recentClients, setRecentClients] = useState<Client[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [editingNotesId, setEditingNotesId] = useState<number | null>(null);\n  const [editingNotes, setEditingNotes] = useState('');\n  const [editingTimeId, setEditingTimeId] = useState<number | null>(null);\n  const [editingTimeType, setEditingTimeType] = useState<'startTime' | 'endTime' | null>(null);\n  const [editingTimeValue, setEditingTimeValue] = useState('');\n  const [linkTaskModalOpen, setLinkTaskModalOpen] = useState(false);\n  const [selectedConsultationId, setSelectedConsultationId] = useState<number | null>(null);\n\n  // Filter State Management\n  const [activeFilterName, setActiveFilterName] = useState<string>('Heute');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n\n  // Invoice Creation State\n  const [showCreateInvoiceModal, setShowCreateInvoiceModal] = useState(false);\n\n  const loadConsultations = async () => {\n    try {\n      setLoading(true);\n      const consultations = await consultationApi.getConsultations();\n      setConsultations(consultations || []);\n      setError(null);\n    } catch (error) {\n      console.error('Fehler beim Laden der Beratungen:', error);\n      setError('Fehler beim Laden der Beratungen');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadRecentClients = async () => {\n    try {\n      const clients = await clientApi.getRecentClients();\n      setRecentClients(clients || []);\n    } catch (error) {\n      // Stille Behandlung - normale Situation wenn noch keine Clients beraten wurden\n    }\n  };\n\n  // Imperatives Handle fr Ref-basierte Refresh-Funktion\n  useImperativeHandle(ref, () => ({\n    refresh: loadConsultations,\n    addConsultation: (consultation: Consultation) => {\n      // Optimistisches Update: Fge Consultation zur Liste hinzu\n      setConsultations(prev => [consultation, ...prev]);\n    },\n    updateConsultation: (consultation: Consultation) => {\n      // Optimistisches Update: Aktualisiere Consultation in der Liste\n      setConsultations(prev => \n        prev.map(c => c.id === consultation.id ? consultation : c)\n      );\n    },\n    removeConsultation: (consultationId: number) => {\n      // Optimistisches Update: Entferne Consultation aus der Liste\n      setConsultations(prev => prev.filter(c => c.id !== consultationId));\n    },\n    activateClientFilter: createAndActivateClientFilter\n  }));\n\n  // Initial load\n  useEffect(() => {\n    loadConsultations();\n    loadRecentClients();\n  }, []);\n\n  // Initialer Default-Filter\n  useEffect(() => {\n    const setInitialFilter = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const filters = response.data;\n        \n        const heuteFilter = filters.find((filter: any) => filter.name === 'Heute');\n        if (heuteFilter) {\n          setActiveFilterName('Heute');\n          setSelectedFilterId(heuteFilter.id);\n          applyFilterConditions(heuteFilter.conditions, heuteFilter.operators);\n        }\n      } catch (error) {\n        console.error('Fehler beim Setzen des initialen Filters:', error);\n      }\n    };\n\n    setInitialFilter();\n  }, []);\n\n  // Filter Change Handler\n  const handleFilterChange = (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  // Client-Filter erstellen und aktivieren\n  const createAndActivateClientFilter = async (clientName: string) => {\n    try {\n      // Prfe ob Client-Filter bereits existiert\n      const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n      const existingFilters = response.data;\n      \n      let clientFilter = existingFilters.find((filter: any) => filter.name === clientName);\n      \n      if (!clientFilter) {\n        // Erstelle neuen Client-Filter\n        const newFilter = {\n          tableId: CONSULTATIONS_TABLE_ID,\n          name: clientName,\n          conditions: [\n            { column: 'client', operator: 'equals', value: clientName }\n          ],\n          operators: []\n        };\n        \n        const createResponse = await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, newFilter);\n        clientFilter = createResponse.data;\n        \n        // Refresh die Filter-Liste\n        if ((window as any).refreshSavedFilters) {\n          (window as any).refreshSavedFilters();\n        }\n      }\n      \n      // Aktiviere den Client-Filter\n      if (clientFilter) {\n        setActiveFilterName(clientName);\n        setSelectedFilterId(clientFilter.id);\n        applyFilterConditions(clientFilter.conditions, clientFilter.operators);\n      }\n    } catch (error) {\n      console.error('Fehler beim Erstellen/Aktivieren des Client-Filters:', error);\n    }\n  };\n\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        if (!token) return;\n\n        // Prfe, ob Standard-Filter bereits existieren\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const existingFilters = response.data;\n\n        // Lsche veralteten \"Alle\" Filter falls vorhanden\n        const alleFilter = existingFilters.find((filter: any) => filter.name === 'Alle');\n        if (alleFilter) {\n          try {\n            await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(alleFilter.id));\n            console.log('Veralteter \"Alle\" Filter gelscht');\n          } catch (error) {\n            console.error('Fehler beim Lschen des \"Alle\" Filters:', error);\n          }\n        }\n\n        // Lsche veralteten \"Diese Woche\" Filter falls vorhanden\n        const dieseWocheFilter = existingFilters.find((filter: any) => filter.name === 'Diese Woche');\n        if (dieseWocheFilter) {\n          try {\n            await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(dieseWocheFilter.id));\n            console.log('Veralteter \"Diese Woche\" Filter gelscht');\n          } catch (error) {\n            console.error('Fehler beim Lschen des \"Diese Woche\" Filters:', error);\n          }\n        }\n\n        const archivFilterExists = existingFilters.some((filter: any) => filter.name === 'Archiv');\n        const heuteFilterExists = existingFilters.some((filter: any) => filter.name === 'Heute');\n        const wocheFilterExists = existingFilters.some((filter: any) => filter.name === 'Woche');\n        const nichtAbgerechnetFilterExists = existingFilters.some((filter: any) => filter.name === 'Nicht abgerechnet');\n\n        // Erstelle \"Archiv\"-Filter (zeigt nur vergangene Beratungen - strikt vor heute)\n        if (!archivFilterExists) {\n          const today = new Date().toISOString().split('T')[0];\n          const archivFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: 'Archiv',\n            conditions: [\n              { column: 'startTime', operator: 'before', value: today }\n            ],\n            operators: []\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, archivFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Archiv-Filters:', error);\n          }\n        }\n\n        // Erstelle \"Heute\"-Filter\n        if (!heuteFilterExists) {\n          const heuteFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: 'Heute',\n            conditions: [\n              { column: 'startTime', operator: 'equals', value: '__TODAY__' }\n            ],\n            operators: []\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, heuteFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Heute-Filters:', error);\n          }\n        }\n\n        // Erstelle \"Woche\"-Filter (von heute bis heute + 7 Tage)\n        if (!wocheFilterExists) {\n          const wocheFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: 'Woche',\n            conditions: [\n              { column: 'startTime', operator: 'after', value: '__TODAY__' },\n              { column: 'startTime', operator: 'before', value: '__WEEK_FROM_TODAY__' }\n            ],\n            operators: ['AND']\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, wocheFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Woche-Filters:', error);\n          }\n        }\n\n        // Erstelle \"Nicht abgerechnet\"-Filter\n        if (!nichtAbgerechnetFilterExists) {\n          const nichtAbgerechnetFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: 'Nicht abgerechnet',\n            conditions: [\n              { column: 'invoiceStatus', operator: 'equals', value: 'nicht abgerechnet' }\n            ],\n            operators: []\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, nichtAbgerechnetFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Nicht abgerechnet-Filters:', error);\n          }\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []); // Nur einmal beim ersten Laden\n\n  // Aktualisiere bestehende Filter die alte statische Datumswerte haben\n  useEffect(() => {\n    const updateExistingFilters = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const existingFilters = response.data;\n\n        // Finde \"Heute\" Filter mit statischem Datum\n        const heuteFilter = existingFilters.find((filter: any) => filter.name === 'Heute');\n        if (heuteFilter && heuteFilter.conditions.length > 0) {\n          const condition = heuteFilter.conditions[0];\n          // Prfe ob es ein statisches Datum ist (Format: YYYY-MM-DD) anstatt unseres Markers\n          if (condition.value && condition.value !== '__TODAY__' && /^\\d{4}-\\d{2}-\\d{2}$/.test(condition.value)) {\n            console.log('Aktualisiere Heute-Filter mit dynamischem Marker...');\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, {\n              tableId: CONSULTATIONS_TABLE_ID,\n              name: 'Heute',\n              conditions: [\n                { column: 'startTime', operator: 'equals', value: '__TODAY__' }\n              ],\n              operators: []\n            });\n          }\n        }\n\n        // Finde \"Woche\" Filter mit statischen Datums\n        const wocheFilter = existingFilters.find((filter: any) => filter.name === 'Woche');\n        if (wocheFilter && wocheFilter.conditions.length >= 2) {\n          const firstCondition = wocheFilter.conditions[0];\n          const secondCondition = wocheFilter.conditions[1];\n          \n          // Prfe ob es statische Datumsangaben sind\n          const hasStaticDates = (\n            firstCondition.value !== '__TODAY__' && /^\\d{4}-\\d{2}-\\d{2}$/.test(firstCondition.value)\n          ) || (\n            secondCondition.value !== '__WEEK_FROM_TODAY__' && /^\\d{4}-\\d{2}-\\d{2}$/.test(secondCondition.value)\n          );\n\n          if (hasStaticDates) {\n            console.log('Aktualisiere Woche-Filter mit dynamischen Markern...');\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, {\n              tableId: CONSULTATIONS_TABLE_ID,\n              name: 'Woche',\n              conditions: [\n                { column: 'startTime', operator: 'after', value: '__TODAY__' },\n                { column: 'startTime', operator: 'before', value: '__WEEK_FROM_TODAY__' }\n              ],\n              operators: ['AND']\n            });\n          }\n        }\n      } catch (error) {\n        console.error('Fehler beim Aktualisieren bestehender Filter:', error);\n      }\n    };\n\n    // Nach kurzer Verzgerung ausfhren, damit die Standard-Filter-Erstellung abgeschlossen ist\n    const timeoutId = setTimeout(() => {\n      updateExistingFilters();\n    }, 1000);\n\n    return () => clearTimeout(timeoutId);\n  }, []); // Nur einmal beim ersten Laden\n\n  // Separater Effect fr Client-Filter-Management\n  useEffect(() => {\n    const updateClientFilters = async () => {\n      if (recentClients.length === 0) return; // Warte bis Recent Clients geladen sind\n      \n      try {\n        const token = localStorage.getItem('token');\n        if (!token) return;\n\n        // Hole aktuelle Filter\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const existingFilters = response.data;\n\n        // Finde alle bestehenden Client-Filter (alle Filter auer den Standard-Filtern)\n        const existingClientFilters = existingFilters.filter((filter: any) => \n          !['Archiv', 'Heute', 'Woche'].includes(filter.name)\n        );\n        \n        // Aktuelle Recent Client Namen\n        const currentRecentClientNames = recentClients.map(client => client.name);\n        \n        // Lsche veraltete Client-Filter (die nicht mehr in Recent Clients sind)\n        for (const existingFilter of existingClientFilters) {\n          if (!currentRecentClientNames.includes(existingFilter.name)) {\n            try {\n              await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(existingFilter.id));\n              console.log(`Veralteter Client-Filter gelscht: ${existingFilter.name}`);\n            } catch (error) {\n              console.error(`Fehler beim Lschen des veralteten Client-Filters ${existingFilter.name}:`, error);\n            }\n          }\n        }\n        \n        // Erstelle neue Client-Filter fr aktuelle Recent Clients\n        for (const client of recentClients) {\n          const clientFilterName = client.name;\n          const clientFilterExists = existingFilters.some((filter: any) => filter.name === clientFilterName);\n          \n          if (!clientFilterExists) {\n            const clientFilter = {\n              tableId: CONSULTATIONS_TABLE_ID,\n              name: clientFilterName,\n              conditions: [\n                { column: 'client', operator: 'equals', value: client.name }\n              ],\n              operators: []\n            };\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, clientFilter);\n            console.log(`Neuer Client-Filter erstellt: ${clientFilterName}`);\n          }\n        }\n      } catch (error) {\n        console.error('Fehler beim Aktualisieren der Client-Filter:', error);\n      }\n    };\n\n    // Debounce um Race Conditions zu vermeiden\n    const timeoutId = setTimeout(() => {\n      updateClientFilters();\n    }, 500);\n\n    return () => clearTimeout(timeoutId);\n  }, [recentClients]);\n\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n  };\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  const updateNotes = async (consultationId: number, notes: string) => {\n    try {\n      await consultationApi.updateConsultationNotes(consultationId, { notes });\n      setConsultations(prev => \n        prev.map(consultation => \n          consultation.id === consultationId \n            ? { ...consultation, notes }\n            : consultation\n        )\n      );\n      toast.success('Notizen aktualisiert');\n    } catch (error) {\n      console.error('Fehler beim Aktualisieren der Notizen:', error);\n      toast.error('Fehler beim Aktualisieren der Notizen');\n    }\n  };\n\n  const handleNotesEdit = (consultation: Consultation) => {\n    setEditingNotesId(consultation.id);\n    setEditingNotes(consultation.notes || '');\n  };\n\n  const handleNotesSave = (consultationId: number) => {\n    updateNotes(consultationId, editingNotes);\n    setEditingNotesId(null);\n  };\n\n  const handleNotesCancel = () => {\n    setEditingNotesId(null);\n    setEditingNotes('');\n  };\n\n  const handleTimeEdit = (consultation: Consultation, timeType: 'startTime' | 'endTime') => {\n    setEditingTimeId(consultation.id);\n    setEditingTimeType(timeType);\n    const currentTime = timeType === 'startTime' ? consultation.startTime : consultation.endTime;\n    if (currentTime) {\n      /* TIMEZONE-PROBLEM BEHOBEN:\n       * \n       * PROBLEM: Doppelte Timezone-Konvertierung!\n       * - DB-Zeit: \"2025-05-31T11:35:33.542Z\" (UTC)\n       * - new Date() konvertiert automatisch: 11:35 UTC  06:35 lokale Zeit\n       * - getTimezoneOffset-Addition: 06:35 + 5h = 11:35 lokale Zeit\n       * - Aber datetime-local zeigt: 16:35 (FALSCH!)\n       * \n       * LSUNG: UTC-Zeit direkt verwenden ohne zustzliche Konvertierung\n       * - DB-Zeit \"11:35 UTC\" soll im Input als \"11:35\" angezeigt werden\n       * - Keine getTimezoneOffset-Addition ntig!\n       */\n      \n      //  KORREKT: Direkte UTC-Zeit-Nutzung ohne doppelte Konvertierung\n      const dbTime = new Date(currentTime);\n      \n      // Verwende die UTC-Komponenten direkt fr datetime-local Input\n      const year = dbTime.getUTCFullYear();\n      const month = String(dbTime.getUTCMonth() + 1).padStart(2, '0');\n      const day = String(dbTime.getUTCDate()).padStart(2, '0');\n      const hours = String(dbTime.getUTCHours()).padStart(2, '0');\n      const minutes = String(dbTime.getUTCMinutes()).padStart(2, '0');\n      \n      const inputValue = `${year}-${month}-${day}T${hours}:${minutes}`;\n      \n      console.log(' DEBUG handleTimeEdit (KORRIGIERT):');\n      console.log('- DB Zeit (UTC):', currentTime);\n      console.log('- Extrahierte UTC-Komponenten:', `${hours}:${minutes}`);\n      console.log('- inputValue fr datetime-local:', inputValue);\n      \n      setEditingTimeValue(inputValue);\n    }\n  };\n\n  /* CLAUDE-ANCHOR: CONSULTATION-TIME-SAVE-001 - Timezone-sichere Zeitspeicherung */\n  const handleTimeSave = async (consultationId: number) => {\n    if (!editingTimeType || !editingTimeValue) return;\n    \n    try {\n      /* KONSISTENTE API-ARCHITEKTUR:\n       * Verwende die zentralisierte consultationApi.updateConsultationTime Funktion\n       * anstatt direkter axiosInstance Calls fr bessere Wartbarkeit und Testbarkeit\n       */\n      \n      //  KORREKT: Datetime-local Input direkt als UTC verwenden\n      const timeString = `${editingTimeValue}:00.000Z`;  // \"2025-05-31T11:35:00.000Z\"\n      \n      console.log(' DEBUG handleTimeSave (REFACTORED):');\n      console.log('- editingTimeValue (Input):', editingTimeValue);\n      console.log('- timeString fr API (UTC):', timeString);\n      console.log('- editingTimeType:', editingTimeType);\n      \n      //  REFACTORED: Verwende zentralisierte API-Funktion\n      const response = await consultationApi.updateConsultationTime(consultationId, {\n        [editingTimeType]: timeString\n      });\n      \n      setConsultations(prev => \n        prev.map(consultation => \n          consultation.id === consultationId \n            ? { ...consultation, [editingTimeType]: timeString }\n            : consultation\n        )\n      );\n      \n      toast.success('Zeit aktualisiert');\n      setEditingTimeId(null);\n      setEditingTimeType(null);\n      setEditingTimeValue('');\n    } catch (error: any) {\n      console.error('Fehler beim Aktualisieren der Zeit:', error);\n      toast.error(`Fehler beim Aktualisieren der Zeit: ${error.response?.data?.message || error.message}`);\n    }\n  };\n\n  const handleTimeCancel = () => {\n    setEditingTimeId(null);\n    setEditingTimeType(null);\n    setEditingTimeValue('');\n  };\n\n  const handleLinkTask = (consultationId: number) => {\n    setSelectedConsultationId(consultationId);\n    setLinkTaskModalOpen(true);\n  };\n\n  const handleTaskLinked = (consultationId: number) => {\n    // Nach Task-Link: Lade nur die betroffene Consultation neu\n    // Fr jetzt: Reload der betroffenen Consultation (spter knnte optimiert werden)\n    loadConsultations();\n    onConsultationChange?.();\n  };\n\n  // Prfung ob Rechnung erstellt werden kann\n  const canCreateInvoice = () => {\n    // Prfe zuerst die Berechtigung\n    const canCreate = hasPermission('invoice_create', 'write', 'button');\n    if (!canCreate) return false;\n    \n    const hasConsultations = filteredConsultations.length > 0;\n    if (!hasConsultations) return false;\n    \n    // Filter mssen aktiv sein (auer Standard-Filter)\n    const hasActiveFilters = filterConditions.length > 0 || searchTerm.trim() !== '';\n    if (!hasActiveFilters) return false;\n    \n    // Alle Beratungen mssen abgeschlossen sein (endTime vorhanden)\n    const allCompleted = filteredConsultations.every(c => c.endTime);\n    if (!allCompleted) return false;\n    \n    // Keine bereits abgerechneten Beratungen\n    const hasInvoicedConsultations = filteredConsultations.some(c => isConsultationInvoiced(c));\n    if (hasInvoicedConsultations) return false;\n    \n    return true;\n  };\n\n  const handleCreateInvoice = () => {\n    setShowCreateInvoiceModal(true);\n  };\n\n  const handleDeleteConsultation = async (consultationId: number) => {\n    // Besttigungsdialog\n    if (!window.confirm('Sind Sie sicher, dass Sie diese Beratung lschen mchten? Diese Aktion kann nicht rckgngig gemacht werden.')) {\n      return;\n    }\n\n    try {\n      await consultationApi.deleteConsultation(consultationId);\n      \n      // Entferne die Beratung aus der lokalen Liste\n      setConsultations(prev => prev.filter(consultation => consultation.id !== consultationId));\n      \n      toast.success('Beratung erfolgreich gelscht');\n      \n      // Informiere die bergeordnete Komponente ber die nderung\n      onConsultationChange?.();\n    } catch (error: any) {\n      console.error('Fehler beim Lschen der Beratung:', error);\n      const errorMessage = error.response?.data?.message || 'Fehler beim Lschen der Beratung';\n      toast.error(errorMessage);\n    }\n  };\n\n  const applyFiltersAndSearch = useCallback((consultations: Consultation[]) => {\n    let filtered = consultations;\n\n    // Suchterm-Filter\n    if (searchTerm) {\n      const search = searchTerm.toLowerCase();\n      filtered = filtered.filter(consultation => \n        consultation.client?.name?.toLowerCase().includes(search) ||\n        consultation.notes?.toLowerCase().includes(search) ||\n        consultation.branch?.name?.toLowerCase().includes(search)\n      );\n    }\n\n    // Erweiterte Filter\n    if (filterConditions.length > 0) {\n      filtered = filtered.filter((consultation) => {\n        let result = true;\n        \n        for (let i = 0; i < filterConditions.length; i++) {\n          const condition = filterConditions[i];\n          let conditionResult = false;\n          \n          switch (condition.column) {\n            case 'client':\n              conditionResult = consultation.client?.name?.toLowerCase().includes(String(condition.value).toLowerCase()) || false;\n              break;\n            case 'branch':\n              conditionResult = consultation.branch?.name?.toLowerCase().includes(String(condition.value).toLowerCase()) || false;\n              break;\n            case 'notes':\n              conditionResult = consultation.notes?.toLowerCase().includes(String(condition.value).toLowerCase()) || false;\n              break;\n            case 'startTime':\n              const consultationDate = new Date(consultation.startTime).toISOString().split('T')[0];\n              let filterDate = String(condition.value);\n              \n              // Dynamische Datums-Marker verarbeiten\n              if (filterDate === '__TODAY__') {\n                //  KORREKT: Lokale Zeit verwenden (Timezone-Dokumentation befolgen)\n                const localToday = new Date();\n                const correctedToday = new Date(localToday.getTime() - localToday.getTimezoneOffset() * 60000);\n                filterDate = correctedToday.toISOString().split('T')[0];\n              } else if (filterDate === '__WEEK_FROM_TODAY__') {\n                //  KORREKT: Lokale Zeit verwenden (Timezone-Dokumentation befolgen)\n                const localToday = new Date();\n                const correctedToday = new Date(localToday.getTime() - localToday.getTimezoneOffset() * 60000);\n                const weekFromToday = new Date(correctedToday);\n                weekFromToday.setDate(correctedToday.getDate() + 7); // Heute + 7 Tage\n                filterDate = weekFromToday.toISOString().split('T')[0];\n              }\n              \n              switch (condition.operator) {\n                case 'after':\n                  conditionResult = consultationDate >= filterDate;\n                  break;\n                case 'before':\n                  conditionResult = consultationDate < filterDate;\n                  break;\n                case 'equals':\n                  conditionResult = consultationDate === filterDate;\n                  break;\n                default:\n                  conditionResult = false;\n              }\n              break;\n            case 'duration':\n              const duration = calculateDurationInMinutes(consultation.startTime, consultation.endTime);\n              const filterValue = Number(condition.value) * 60; // Convert hours to minutes\n              switch (condition.operator) {\n                case 'greater_than':\n                  conditionResult = duration > filterValue;\n                  break;\n                case 'less_than':\n                  conditionResult = duration < filterValue;\n                  break;\n                case 'equals':\n                  conditionResult = Math.abs(duration - filterValue) < 30; // 30-minute tolerance\n                  break;\n                default:\n                  conditionResult = false;\n              }\n              break;\n            case 'invoiceStatus':\n              const isInvoiced = isConsultationInvoiced(consultation);\n              const isInMonthlyReport = isConsultationInMonthlyReport(consultation);\n              const filterValueLower = String(condition.value).toLowerCase();\n              \n              if (filterValueLower === 'abgerechnet' || filterValueLower === 'invoiced' || filterValueLower === 'ja') {\n                conditionResult = isInvoiced || isInMonthlyReport;\n              } else if (filterValueLower === 'nicht abgerechnet' || filterValueLower === 'not invoiced' || filterValueLower === 'nein') {\n                conditionResult = !isInvoiced && !isInMonthlyReport;\n              } else if (filterValueLower === 'einzelrechnung' || filterValueLower === 'invoice') {\n                conditionResult = isInvoiced;\n              } else if (filterValueLower === 'monatsbericht' || filterValueLower === 'monthly report') {\n                conditionResult = isInMonthlyReport;\n              } else {\n                // Exact status match wenn ein spezifischer Status eingegeben wurde\n                if (isInvoiced) {\n                  const invoiceInfo = getConsultationInvoiceInfo(consultation);\n                  const statusText = invoiceInfo ? getInvoiceStatusText(invoiceInfo.status as any).toLowerCase() : '';\n                  conditionResult = statusText.includes(filterValueLower);\n                } else if (isInMonthlyReport) {\n                  const monthlyReportInfo = getConsultationMonthlyReportInfo(consultation);\n                  if (monthlyReportInfo) {\n                    const statusText = monthlyReportInfo.status === 'GENERATED' ? 'erstellt' : \n                                     monthlyReportInfo.status === 'SENT' ? 'gesendet' : 'archiviert';\n                    conditionResult = statusText.includes(filterValueLower);\n                  } else {\n                    conditionResult = false;\n                  }\n                } else {\n                  conditionResult = false;\n                }\n              }\n              break;\n            default:\n              conditionResult = false;\n          }\n          \n          if (i === 0) {\n            result = conditionResult;\n          } else {\n            const operator = filterLogicalOperators[i - 1];\n            if (operator === 'AND') {\n              result = result && conditionResult;\n            } else {\n              result = result || conditionResult;\n            }\n          }\n        }\n        \n        return result;\n      });\n    }\n\n    return filtered;\n  }, [consultations, searchTerm, filterConditions, filterLogicalOperators]);\n\n  const calculateDurationInMinutes = (startTime: string, endTime: string | null): number => {\n    if (!endTime) return 0;\n    const start = new Date(startTime);\n    const end = new Date(endTime);\n    return (end.getTime() - start.getTime()) / (1000 * 60);\n  };\n\n  // Timeline-Markierungen generieren\n  const generateTimelineMarkers = (consultations: Consultation[]) => {\n    const markers: Array<{\n      id: string;\n      type: 'day' | 'midday';\n      date: string;\n      label: string;\n      position: number; // Index position in der gefilterten Liste\n    }> = [];\n\n    consultations.forEach((consultation, index) => {\n      const currentDate = new Date(consultation.startTime);\n      const currentDay = format(currentDate, 'yyyy-MM-dd', { locale: de });\n      const currentHour = currentDate.getUTCHours(); // UTC verwenden statt getHours()\n      \n      // Prfe vorherige Beratung fr Tagesbergang\n      if (index > 0) {\n        const prevDate = new Date(consultations[index - 1].startTime);\n        const prevDay = format(prevDate, 'yyyy-MM-dd', { locale: de });\n        \n        if (currentDay !== prevDay) {\n          markers.push({\n            id: `day-${currentDay}`,\n            type: 'day',\n            date: currentDay,\n            label: format(currentDate, 'EEE, dd.MM.', { locale: de }),\n            position: index\n          });\n        }\n      } else if (index === 0) {\n        // Erste Beratung bekommt immer eine Tagesmarkierung\n        markers.push({\n          id: `day-${currentDay}`,\n          type: 'day', \n          date: currentDay,\n          label: format(currentDate, 'EEE, dd.MM.', { locale: de }),\n          position: index\n        });\n      }\n\n      // Prfe fr Mittag-Markierung (12:00 bergang) - jetzt mit UTC\n      if (index > 0) {\n        const prevDate = new Date(consultations[index - 1].startTime);\n        const prevHour = prevDate.getUTCHours(); // UTC verwenden statt getHours()\n        const prevDay = format(prevDate, 'yyyy-MM-dd', { locale: de });\n        \n        // Mittag-Markierung nur wenn am gleichen Tag und bergang ber 12:00 UTC\n        if (currentDay === prevDay && prevHour < 12 && currentHour >= 12) {\n          markers.push({\n            id: `midday-${currentDay}`,\n            type: 'midday',\n            date: currentDay,\n            label: 'Mittag',\n            position: index\n          });\n        }\n      }\n    });\n\n    return markers;\n  };\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const filteredConsultations = useMemo(() => {\n    return applyFiltersAndSearch(consultations).sort((a, b) => {\n      return new Date(a.startTime).getTime() - new Date(b.startTime).getTime();\n    });\n  }, [consultations, filterConditions, filterLogicalOperators]);\n\n  // Total-Dauer aller sichtbaren Beratungen berechnen\n  const totalDuration = useMemo(() => {\n    return formatTotalDuration(filteredConsultations);\n  }, [filteredConsultations]);\n\n  // Timeline-Markierungen berechnen\n  const timelineMarkers = useMemo(() => {\n    return generateTimelineMarkers(filteredConsultations);\n  }, [filteredConsultations]);\n\n  // Helper function to check if consultation is billed in monthly report\n  const isConsultationInMonthlyReport = (consultation: Consultation): boolean => {\n    return consultation.monthlyReportId !== null && consultation.monthlyReportId !== undefined;\n  };\n\n  // Helper function to get monthly report info\n  const getConsultationMonthlyReportInfo = (consultation: Consultation) => {\n    return consultation.monthlyReport;\n  };\n\n  // Helper function to get the billing status\n  const getConsultationBillingStatus = (consultation: Consultation) => {\n    const isInvoiced = isConsultationInvoiced(consultation);\n    const isInMonthlyReport = isConsultationInMonthlyReport(consultation);\n    \n    if (isInvoiced) {\n      const invoiceInfo = getConsultationInvoiceInfo(consultation);\n      return {\n        type: 'invoice' as const,\n        status: 'Einzelrechnung',\n        info: invoiceInfo\n      };\n    } else if (isInMonthlyReport) {\n      const monthlyReportInfo = getConsultationMonthlyReportInfo(consultation);\n      return {\n        type: 'monthly' as const,\n        status: 'Monatsbericht',\n        info: monthlyReportInfo\n      };\n    }\n    \n    return null;\n  };\n\n  // Navigation functions\n  const navigateToMonthlyReports = (reportId?: number) => {\n    const url = reportId \n      ? `/payroll?tab=monthly-reports&reportId=${reportId}`\n      : '/payroll?tab=monthly-reports';\n    navigate(url);\n  };\n\n  const navigateToInvoices = (invoiceId?: number) => {\n    const url = invoiceId \n      ? `/payroll?tab=invoices&invoiceId=${invoiceId}`\n      : '/payroll?tab=invoices';\n    navigate(url);\n  };\n\n  const navigateToTask = (taskId: number) => {\n    navigate(`/worktracker?editTask=${taskId}`);\n  };\n\n  if (loading) return <div className=\"p-4\">Ldt...</div>;\n  if (error) return <div className=\"p-4 text-red-600\">{error}</div>;\n\n  return (\n    <>\n      <div className=\"bg-white dark:bg-gray-800 sm:shadow sm:rounded-lg sm:p-6 sm:border sm:border-gray-200 sm:dark:border-gray-700\">\n        {/* Header */}\n        <div className=\"flex items-center mb-6 justify-between px-2 sm:px-0\">\n          <div className=\"flex items-center\">\n            <ClockIcon className=\"h-6 w-6 mr-2 dark:text-white\" />\n            <div>\n              <h2 className=\"text-xl font-semibold dark:text-white\">Beratungsliste</h2>\n              {/* Total-Anzeige */}\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-0.5\">\n                {filteredConsultations.length} Beratung{filteredConsultations.length !== 1 ? 'en' : ''} - Total: {totalDuration}\n              </p>\n            </div>\n          </div>\n          \n          <div className=\"flex items-center gap-1.5\">\n            <input\n              type=\"text\"\n              placeholder=\"Suchen...\"\n              className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n            \n            <button\n              className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} ml-1 relative`}\n              onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n              title=\"Erweiterte Filter\"\n            >\n              <FunnelIcon className=\"h-5 w-5\" />\n              {getActiveFilterCount() > 0 && (\n                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                  {getActiveFilterCount()}\n                </span>\n              )}\n            </button>\n\n            {/* Rechnung erstellen Button */}\n            {canCreateInvoice() && (\n              <button\n                onClick={handleCreateInvoice}\n                className=\"p-2 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors ml-2\"\n                title=\"Rechnung aus gefilterten Beratungen erstellen\"\n              >\n                <DocumentTextIcon className=\"h-5 w-5\" />\n              </button>\n            )}\n          </div>\n        </div>\n\n        {/* Filter-Pane */}\n        {isFilterPanelOpen && (\n          <div className=\"px-2 sm:px-0\">\n            <FilterPane\n              columns={[\n                { id: 'client', label: 'Client' },\n                { id: 'branch', label: 'Niederlassung' },\n                { id: 'notes', label: 'Notizen' },\n                { id: 'startTime', label: 'Datum' },\n                { id: 'duration', label: 'Dauer (Stunden)' },\n                { id: 'invoiceStatus', label: 'Abrechnungsstatus' }\n              ]}\n              onApply={applyFilterConditions}\n              onReset={resetFilterConditions}\n              savedConditions={filterConditions}\n              savedOperators={filterLogicalOperators}\n              tableId={CONSULTATIONS_TABLE_ID}\n            />\n          </div>\n        )}\n        \n        {/* Gespeicherte Filter als Tags anzeigen */}\n        <div className=\"px-2 sm:px-0\">\n          <SavedFilterTags\n            tableId={CONSULTATIONS_TABLE_ID}\n            onSelectFilter={applyFilterConditions}\n            onReset={resetFilterConditions}\n            activeFilterName={activeFilterName}\n            selectedFilterId={selectedFilterId}\n            onFilterChange={handleFilterChange}\n          />\n        </div>\n\n        {/* Timeline + Cards Layout */}\n        <div className=\"space-y-0.5 sm:space-y-1\">\n          {filteredConsultations.length === 0 ? (\n            <div className=\"text-center py-12 px-2 sm:px-0\">\n              <ClockIcon className=\"h-12 w-12 text-gray-400 dark:text-gray-500 mx-auto mb-4\" />\n              <div>\n                <p className=\"font-medium text-gray-900 dark:text-white\">Keine Beratungen gefunden</p>\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                  {searchTerm || filterConditions.length > 0\n                    ? 'Versuchen Sie andere Suchbegriffe oder Filter.' \n                    : 'Es wurden noch keine Beratungen durchgefhrt.'}\n                </p>\n              </div>\n            </div>\n          ) : (\n            filteredConsultations.map((consultation, index) => {\n              const dayMarker = timelineMarkers.find(m => m.type === 'day' && m.position === index);\n              const middayMarker = timelineMarkers.find(m => m.type === 'midday' && m.position === index);\n              \n              return (\n                <div key={consultation.id} className=\"relative\">\n                  {/* Tagesmarkierung ber der Card */}\n                  {dayMarker && (\n                    <div className=\"flex items-center mb-3 px-2 sm:px-0\">\n                      <div className=\"flex items-center\">\n                        <div className=\"w-3 h-3 rounded-full bg-blue-500 dark:bg-blue-400 border-2 border-white dark:border-gray-800\"></div>\n                        <div className=\"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300\">\n                          {dayMarker.label}\n                        </div>\n                      </div>\n                      <div className=\"flex-1 ml-4 h-px bg-gray-200 dark:bg-gray-600\"></div>\n                    </div>\n                  )}\n                  \n                  {/* Mittag-Markierung */}\n                  {middayMarker && (\n                    <div className=\"flex items-center mb-3 px-2 sm:px-0\">\n                      <div className=\"flex items-center\">\n                        <div className=\"w-1.5 h-1.5 rounded-full bg-gray-400 dark:bg-gray-500\"></div>\n                        <div className=\"ml-3 text-xs text-gray-500 dark:text-gray-400\">\n                          {middayMarker.label}\n                        </div>\n                      </div>\n                      <div className=\"flex-1 ml-4 h-px bg-gray-300 dark:bg-gray-600\"></div>\n                    </div>\n                  )}\n\n                  {/* Card ohne Timeline-Punkt */}\n                  <div className=\"bg-white dark:bg-gray-800 shadow rounded-lg md:border md:border-gray-200 md:dark:border-gray-700 hover:shadow-md transition-shadow\">\n                    {/* Card Content - 1/3 left, 2/3 right auf allen Bildschirmgren */}\n                    <div className=\"p-4\">\n                      <div className=\"grid grid-cols-3 gap-4\">\n                        {/* Left: Compact Info - 1/3 auf allen Bildschirmgren */}\n                        <div className=\"col-span-1 space-y-3\">\n                          {/* Client Header */}\n                          <div className=\"flex items-center space-x-2\">\n                            <div className=\"min-w-0 flex-1\">\n                              <h3 className=\"font-medium text-gray-900 dark:text-white text-sm truncate\">\n                                {consultation.client?.name}\n                              </h3>\n                              {consultation.client?.company && (\n                                <p className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">\n                                  {consultation.client.company}\n                                </p>\n                              )}\n                            </div>\n                          </div>\n\n                          {/* Billing Status Indicator */}\n                          {(() => {\n                            const billingStatus = getConsultationBillingStatus(consultation);\n                            \n                            if (billingStatus) {\n                              if (billingStatus.type === 'invoice') {\n                                // Individual invoice\n                                return (\n                                  <div className=\"flex items-center space-x-2\">\n                                    <div className=\"flex items-center space-x-1\">\n                                      <DocumentTextIcon className=\"h-4 w-4 text-green-600 dark:text-green-400\" />\n                                      <button \n                                        onClick={() => navigateToInvoices(billingStatus.info?.id)}\n                                        className=\"text-xs text-green-700 dark:text-green-400 font-medium hover:underline cursor-pointer\"\n                                      >\n                                        Einzelrechnung\n                                      </button>\n                                    </div>\n                                    {billingStatus.info && 'invoiceNumber' in billingStatus.info && (\n                                      <div className=\"flex items-center space-x-1\">\n                                        <button\n                                          onClick={() => navigateToInvoices(billingStatus.info?.id)}\n                                          className={`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium hover:opacity-80 cursor-pointer ${getInvoiceStatusColor(billingStatus.info.status as any)}`}\n                                          title={`Rechnung ${billingStatus.info.invoiceNumber} vom ${format(new Date(billingStatus.info.issueDate), 'dd.MM.yyyy', { locale: de })}`}\n                                        >\n                                          {getInvoiceStatusText(billingStatus.info.status as any)}\n                                        </button>\n                                      </div>\n                                    )}\n                                  </div>\n                                );\n                              } else if (billingStatus.type === 'monthly') {\n                                // Monthly report\n                                return (\n                                  <div className=\"flex items-center space-x-2\">\n                                    <div className=\"flex items-center space-x-1\">\n                                      <ChartBarIcon className=\"h-4 w-4 text-green-600 dark:text-green-400\" />\n                                      <button \n                                        onClick={() => navigateToMonthlyReports(billingStatus.info?.id)}\n                                        className=\"text-xs text-green-700 dark:text-green-400 font-medium hover:underline cursor-pointer\"\n                                      >\n                                        Monatsbericht\n                                      </button>\n                                    </div>\n                                    {billingStatus.info && 'reportNumber' in billingStatus.info && (\n                                      <div className=\"flex items-center space-x-1\">\n                                        <button \n                                          onClick={() => navigateToMonthlyReports(billingStatus.info?.id)}\n                                          className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300 hover:opacity-80 cursor-pointer\"\n                                          title={`Monatsbericht ${billingStatus.info.reportNumber}`}\n                                        >\n                                          {billingStatus.info.status === 'GENERATED' ? 'Erstellt' : \n                                           billingStatus.info.status === 'SENT' ? 'Gesendet' : 'Archiviert'}\n                                        </button>\n                                      </div>\n                                    )}\n                                  </div>\n                                );\n                              }\n                            }\n                            \n                            return null;\n                          })()}\n\n                          {/* Time Range - Single compact field */}\n                          <div>\n                            <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">Zeit</p>\n                            <div className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                              {editingTimeId === consultation.id && editingTimeType === 'startTime' ? (\n                                <div className=\"flex items-center space-x-1\">\n                                  <input\n                                    type=\"datetime-local\"\n                                    value={editingTimeValue}\n                                    onChange={(e) => setEditingTimeValue(e.target.value)}\n                                    className=\"text-xs rounded border-gray-300 dark:border-gray-600 dark:bg-gray-700 w-full\"\n                                  />\n                                  <button\n                                    onClick={() => handleTimeSave(consultation.id)}\n                                    className=\"p-0.5 text-green-600 hover:text-green-700\"\n                                    title=\"Speichern\"\n                                  >\n                                    <svg className=\"h-3 w-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                                    </svg>\n                                  </button>\n                                  <button\n                                    onClick={handleTimeCancel}\n                                    className=\"p-0.5 text-red-600 hover:text-red-700\"\n                                    title=\"Abbrechen\"\n                                  >\n                                    <XMarkIcon className=\"h-3 w-3\" />\n                                  </button>\n                                </div>\n                              ) : editingTimeId === consultation.id && editingTimeType === 'endTime' ? (\n                                <div className=\"flex items-center space-x-1\">\n                                  <input\n                                    type=\"datetime-local\"\n                                    value={editingTimeValue}\n                                    onChange={(e) => setEditingTimeValue(e.target.value)}\n                                    className=\"text-xs rounded border-gray-300 dark:border-gray-600 dark:bg-gray-700 w-full\"\n                                  />\n                                  <button\n                                    onClick={() => handleTimeSave(consultation.id)}\n                                    className=\"p-0.5 text-green-600 hover:text-green-700\"\n                                    title=\"Speichern\"\n                                  >\n                                    <svg className=\"h-3 w-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                                    </svg>\n                                  </button>\n                                  <button\n                                    onClick={handleTimeCancel}\n                                    className=\"p-0.5 text-red-600 hover:text-red-700\"\n                                    title=\"Abbrechen\"\n                                  >\n                                    <XMarkIcon className=\"h-3 w-3\" />\n                                  </button>\n                                </div>\n                              ) : (\n                                <div className=\"flex items-center space-x-1\">\n                                  <button\n                                    onClick={() => handleTimeEdit(consultation, 'startTime')}\n                                    className=\"text-blue-600 hover:text-blue-700 dark:text-blue-400 hover:underline\"\n                                  >\n                                    {formatTime(consultation.startTime)}\n                                  </button>\n                                  <span className=\"text-gray-400\">-</span>\n                                  {consultation.endTime ? (\n                                    <button\n                                      onClick={() => handleTimeEdit(consultation, 'endTime')}\n                                      className=\"text-blue-600 hover:text-blue-700 dark:text-blue-400 hover:underline\"\n                                    >\n                                      {formatTime(consultation.endTime)}\n                                    </button>\n                                  ) : (\n                                    <div className=\"flex items-center\">\n                                      <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full mr-1 animate-pulse\"></div>\n                                      <span className=\"text-green-600 dark:text-green-400 text-xs\">Aktiv</span>\n                                    </div>\n                                  )}\n                                </div>\n                              )}\n                            </div>\n                          </div>\n\n                          {/* Duration */}\n                          <div>\n                            <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">Dauer</p>\n                            <p className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                              {calculateDuration(consultation.startTime, consultation.endTime)}\n                            </p>\n                          </div>\n\n                          {/* Tasks - Compact */}\n                          {consultation.taskLinks && consultation.taskLinks.length > 0 && (\n                            <div>\n                              <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                Tasks ({consultation.taskLinks.length})\n                              </p>\n                              <div className=\"space-y-1\">\n                                {consultation.taskLinks.slice(0, 2).map((taskLink) => (\n                                  <button\n                                    key={taskLink.id}\n                                    onClick={() => navigateToTask(taskLink.task.id)}\n                                    className=\"flex items-center text-xs text-blue-700 dark:text-blue-300 bg-blue-50 dark:bg-blue-900/20 rounded px-2 py-1 hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors cursor-pointer w-full text-left\"\n                                  >\n                                    <LinkIcon className=\"h-3 w-3 mr-1 flex-shrink-0\" />\n                                    <span className=\"truncate\">{taskLink.task.title}</span>\n                                  </button>\n                                ))}\n                                {consultation.taskLinks.length > 2 && (\n                                  <button\n                                    onClick={() => {\n                                      // Navigate to first task if more than 2 tasks\n                                      if (consultation.taskLinks && consultation.taskLinks.length > 0) {\n                                        navigateToTask(consultation.taskLinks[0].task.id);\n                                      }\n                                    }}\n                                    className=\"text-xs text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 cursor-pointer\"\n                                  >\n                                    +{consultation.taskLinks.length - 2} weitere\n                                  </button>\n                                )}\n                              </div>\n                            </div>\n                          )}\n                        </div>\n\n                        {/* Right: Notes - 2/3 auf allen Bildschirmgren */}\n                        <div className=\"col-span-2 relative\">\n                          {/* Action Icons in der rechten oberen Ecke */}\n                          <div className=\"absolute top-0 right-0 flex items-center space-x-1 z-10\">\n                            {hasPermission('consultations', 'write') && (\n                              <button\n                                onClick={() => handleLinkTask(consultation.id)}\n                                className=\"p-1 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 rounded\"\n                                title=\"Task verknpfen\"\n                              >\n                                <LinkIcon className=\"h-4 w-4\" />\n                              </button>\n                            )}\n                            {hasPermission('consultations', 'write') && consultation.endTime && (\n                              <button\n                                onClick={() => handleDeleteConsultation(consultation.id)}\n                                className=\"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400 rounded\"\n                                title=\"Beratung lschen\"\n                              >\n                                <TrashIcon className=\"h-4 w-4\" />\n                              </button>\n                            )}\n                          </div>\n                          \n                          <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2\">Notizen</p>\n                          {editingNotesId === consultation.id ? (\n                            <div className=\"space-y-2\">\n                              <textarea\n                                value={editingNotes}\n                                onChange={(e) => setEditingNotes(e.target.value)}\n                                className=\"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm resize-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n                                rows={3}\n                                placeholder=\"Notizen zur Beratung...\"\n                              />\n                              <div className=\"flex justify-end space-x-2\">\n                                <button\n                                  onClick={handleNotesCancel}\n                                  className=\"p-1.5 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                  title=\"Abbrechen\"\n                                >\n                                  <XMarkIcon className=\"h-4 w-4\" />\n                                </button>\n                                <button\n                                  onClick={() => handleNotesSave(consultation.id)}\n                                  className=\"p-1.5 bg-blue-600 text-white hover:bg-blue-700 rounded-md\"\n                                  title=\"Speichern\"\n                                >\n                                  <CheckIcon className=\"h-4 w-4\" />\n                                </button>\n                              </div>\n                            </div>\n                          ) : (\n                            <div \n                              className=\"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded p-2 min-h-[60px] border border-dashed border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 transition-colors\"\n                              onClick={() => handleNotesEdit(consultation)}\n                            >\n                              {consultation.notes ? (\n                                <p className=\"text-sm text-gray-900 dark:text-white whitespace-pre-wrap leading-relaxed\">\n                                  {consultation.notes}\n                                </p>\n                              ) : (\n                                <div className=\"flex items-center justify-center h-full text-center\">\n                                  <span className=\"text-xs text-gray-400 dark:text-gray-500\">\n                                    Notizen hinzufgen...\n                                  </span>\n                                </div>\n                              )}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              );\n            })\n          )}\n        </div>\n      </div>\n\n      {/* Link Task Modal */}\n      {linkTaskModalOpen && selectedConsultationId && (\n        <LinkTaskModal\n          isOpen={linkTaskModalOpen}\n          onClose={() => {\n            setLinkTaskModalOpen(false);\n            setSelectedConsultationId(null);\n          }}\n          consultationId={selectedConsultationId}\n          onTaskLinked={handleTaskLinked}\n        />\n      )}\n\n      {/* Create Invoice Modal */}\n      {showCreateInvoiceModal && (\n        <CreateInvoiceModal\n          isOpen={showCreateInvoiceModal}\n          onClose={() => setShowCreateInvoiceModal(false)}\n          consultations={filteredConsultations}\n          onInvoiceCreated={(invoiceId) => {\n            setShowCreateInvoiceModal(false);\n            // Nach Rechnungserstellung: Markiere betroffene Consultations als abgerechnet\n            // Fr jetzt: Reload der Liste (spter knnte optimiert werden)\n            loadConsultations();\n            toast.success(`Rechnung erstellt! PDF kann in der Rechnungsverwaltung heruntergeladen werden.`);\n          }}\n        />\n      )}\n    </>\n  );\n});\n\nexport default ConsultationList; ","import React, { useCallback, useRef } from 'react';\r\nimport { usePermissions } from '../hooks/usePermissions.ts';\r\nimport ConsultationTracker from '../components/ConsultationTracker.tsx';\r\nimport ConsultationList, { ConsultationListRef } from '../components/ConsultationList.tsx';\r\n\r\nconst Consultations: React.FC = () => {\r\n  const { hasPermission } = usePermissions();\r\n  const consultationListRef = useRef<ConsultationListRef>(null);\r\n\r\n  // Callback-Funktion fr das Neuladen der Beratungsliste (normale Aktionen)\r\n  const handleConsultationChange = useCallback((consultation?: any) => {\r\n    if (consultation && consultation.id) {\r\n      // Wenn eine Consultation bergeben wurde, verwenden wir den imperativen Handle\r\n      // um die Consultation zur Liste hinzuzufgen oder zu aktualisieren\r\n      // Prfe: Wenn endTime vorhanden, ist es ein Update (Stop), sonst ein Add (Start)\r\n      if (consultation.endTime) {\r\n        // Consultation wurde beendet - Update\r\n        consultationListRef.current?.updateConsultation?.(consultation);\r\n      } else {\r\n        // Consultation wurde gestartet - Add\r\n        consultationListRef.current?.addConsultation?.(consultation);\r\n      }\r\n    } else {\r\n      // Fallback: Vollstndiges Reload wenn keine Consultation bergeben\r\n      consultationListRef.current?.refresh();\r\n    }\r\n  }, []);\r\n\r\n  // Callback-Funktion fr das Starten einer Beratung (Filter wechseln)\r\n  const handleConsultationStarted = useCallback((clientName: string) => {\r\n    // Triggert ein Neuladen der Beratungsliste UND wechselt zum Client-Filter\r\n    consultationListRef.current?.refresh();\r\n    consultationListRef.current?.activateClientFilter?.(clientName);\r\n  }, []);\r\n\r\n  // Prfe Berechtigungen\r\n  if (!hasPermission('consultations', 'read')) {\r\n    return (\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n        <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-4\">\r\n          <div className=\"flex\">\r\n            <div className=\"ml-3\">\r\n              <h3 className=\"text-sm font-medium text-red-800 dark:text-red-200\">\r\n                Keine Berechtigung\r\n              </h3>\r\n              <div className=\"mt-2 text-sm text-red-700 dark:text-red-300\">\r\n                <p>Sie haben keine Berechtigung, Beratungen anzuzeigen.</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\r\n      <div className=\"py-1 space-y-6\">\r\n        {/* Consultation Tracker */}\r\n        <div className=\"px-2 sm:px-0\">\r\n          <ConsultationTracker \r\n            onConsultationChange={handleConsultationChange}\r\n            onConsultationStarted={handleConsultationStarted}\r\n          />\r\n        </div>\r\n\r\n        {/* Consultation List */}\r\n        <ConsultationList \r\n          ref={consultationListRef}\r\n          onConsultationChange={handleConsultationChange}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Consultations; ","import { format, parseISO, differenceInMinutes, parse, getWeek, getYear, addDays, startOfWeek } from 'date-fns';\nimport { de } from 'date-fns/locale';\n\n/**\n * Utility-Funktionen fr die Datums- und Zeitverarbeitung im Frontend.\n * Diese Funktionen sorgen fr eine konsistente Handhabung von Datum und Zeit\n * in allen Komponenten.\n */\n\n/**\n * Formatiert ein Datum fr die Anzeige im deutschen Format.\n * @param dateString Das zu formatierende Datum im Format YYYY-MM-DD\n * @returns Formatiertes Datum im Format DD.MM.YYYY oder '-' bei Fehler\n */\nexport const formatDate = (dateString: string): string => {\n    if (!dateString) return '-';\n    \n    try {\n        // Wir erstellen ein neues Date-Objekt und setzen die Uhrzeit auf 12:00 Mittag\n        // um Probleme mit Zeitzonen zu vermeiden\n        const dateParts = dateString.split('-');\n        if (dateParts.length !== 3) return '-';\n        \n        const year = parseInt(dateParts[0]);\n        const month = parseInt(dateParts[1]) - 1; // Monate sind 0-basiert in JavaScript\n        const day = parseInt(dateParts[2]);\n        \n        const date = new Date(year, month, day, 12, 0, 0);\n        \n        return date.toLocaleDateString('de-DE', {\n            day: '2-digit',\n            month: '2-digit',\n            year: 'numeric'\n        });\n    } catch (error) {\n        console.error('Fehler beim Formatieren des Datums:', error);\n        return '-';\n    }\n};\n\n/**\n * Formatiert eine Zeit fr die Anzeige basierend auf UTC.\n * @param dateString Das zu formatierende Datum im ISO-Format\n * @returns Formatierte Zeit im Format HH:MM oder '-' bei Fehler\n */\nexport const formatTime = (dateString: string): string => {\n    if (!dateString) return '-';\n    \n    try {\n        // Direkt aus dem ISO-String die Uhrzeit extrahieren ohne Umrechnung\n        const date = parseISO(dateString);\n        \n        // Verwende UTC-Stunden und -Minuten, um die DB-Zeit direkt zu zeigen\n        const hours = date.getUTCHours().toString().padStart(2, '0');\n        const minutes = date.getUTCMinutes().toString().padStart(2, '0');\n        \n        return `${hours}:${minutes}`;\n    } catch (error) {\n        console.error(`Fehler beim Formatieren der Zeit fr ${dateString}:`, error);\n        return '-';\n    }\n};\n\n/**\n * Berechnet die Dauer zwischen zwei Zeitpunkten und formatiert sie als \"Nh Nm\".\n * @param startTime Startzeit im ISO-Format\n * @param endTime Endzeit im ISO-Format\n * @returns Formatierte Dauer als \"Nh Nm\" oder '-' bei Fehler\n */\nexport const calculateDuration = (startTime: string, endTime: string | null): string => {\n    if (!startTime || !endTime) return '-';\n    \n    try {\n        // Entferne das 'Z' am Ende der ISO-Strings, um Zeitzonenumrechnungen zu verhindern\n        const startISOString = startTime.endsWith('Z') \n            ? startTime.substring(0, startTime.length - 1)\n            : startTime;\n        \n        const endISOString = endTime.endsWith('Z') \n            ? endTime.substring(0, endTime.length - 1)\n            : endTime;\n        \n        const start = new Date(startISOString);\n        const end = new Date(endISOString);\n        \n        const durationMs = end.getTime() - start.getTime();\n        const durationMinutes = Math.floor(durationMs / (1000 * 60));\n        \n        const hours = Math.floor(durationMinutes / 60);\n        const minutes = durationMinutes % 60;\n        \n        return `${hours}h ${minutes}m`;\n    } catch (error) {\n        console.error('Fehler bei der Dauerberechnung:', error);\n        return '-';\n    }\n};\n\n/**\n * Konvertiert ein Wochenformat (YYYY-Www) in ein Datum (YYYY-MM-DD) fr den Montag dieser Woche.\n * @param weekString Wochenformat im Format YYYY-Www\n * @returns Datum des Montags der Woche im Format YYYY-MM-DD\n */\nexport const convertWeekToDate = (weekString: string): string => {\n    try {\n        // Format: YYYY-Www\n        const year = parseInt(weekString.substring(0, 4));\n        const week = parseInt(weekString.substring(6));\n        \n        // Alternative Methode zur Berechnung des Montags fr eine Kalenderwoche\n        // Statt parse mit yyyy und ww (was einen Fehler verursacht) verwenden wir\n        // einen direkten Algorithmus zur Berechnung\n        \n        // 1. Beginne mit dem ersten Tag des Jahres\n        const firstDayOfYear = new Date(Date.UTC(year, 0, 1, 12, 0, 0));\n        \n        // 2. Finde den ersten Donnerstag des Jahres (fr ISO-Wochen)\n        // Verschiebe den Tag, bis wir am ersten Donnerstag sind\n        const dayOfWeek = firstDayOfYear.getUTCDay(); // 0 = Sonntag, 4 = Donnerstag\n        const daysToThursday = dayOfWeek <= 4 ? 4 - dayOfWeek : 11 - dayOfWeek; // Falls Sonntag ist 7\n        const firstThursday = new Date(Date.UTC(year, 0, 1 + daysToThursday, 12, 0, 0));\n        \n        // 3. Der erste Donnerstag ist immer in der ersten Woche\n        // Jetzt berechnen wir den Donnerstag der gewnschten Woche\n        const targetThursday = new Date(Date.UTC(\n            firstThursday.getUTCFullYear(),\n            firstThursday.getUTCMonth(),\n            firstThursday.getUTCDate() + (7 * (week - 1)),\n            12, 0, 0\n        ));\n        \n        // 4. Berechne den Montag dieser Woche (3 Tage vor dem Donnerstag)\n        const monday = new Date(Date.UTC(\n            targetThursday.getUTCFullYear(),\n            targetThursday.getUTCMonth(),\n            targetThursday.getUTCDate() - 3,\n            12, 0, 0\n        ));\n        \n        // Formatiere das Datum als YYYY-MM-DD\n        const formattedDate = format(monday, 'yyyy-MM-dd');\n        \n        // Protokolliere das berechnete Datum fr Debug-Zwecke\n        console.log(`Konvertierte Woche ${weekString} zu Datum: ${formattedDate} (Wochentag: ${format(monday, 'EEEE', { locale: de })})`);\n        \n        // Zustzliche Sicherheitsberprfung: Stelle sicher, dass es ein Montag ist\n        if (format(monday, 'EEEE', { locale: de }) !== 'Montag') {\n            console.warn(`Berechnetes Datum ist kein Montag! Korrigiere...`);\n            // Finde den nchsten Montag\n            const correctedMonday = startOfWeek(monday, { weekStartsOn: 1 });\n            return format(correctedMonday, 'yyyy-MM-dd');\n        }\n        \n        return formattedDate;\n    } catch (error) {\n        console.error('Fehler beim Konvertieren des Wochendatums:', error);\n        // Im Fehlerfall den letzten Montag als Fallback verwenden\n        const fallbackMonday = startOfWeek(new Date(), { weekStartsOn: 1 });\n        return format(fallbackMonday, 'yyyy-MM-dd');\n    }\n};\n\n/**\n * Prft, ob ein Worktime-Eintrag fr den ausgewhlten Tag relevant ist.\n * @param worktime Der Worktime-Eintrag\n * @param selectedDate Ausgewhltes Datum im Format YYYY-MM-DD\n * @returns true, wenn der Eintrag fr den ausgewhlten Tag relevant ist\n */\nexport const isWorktimeRelevantForSelectedDate = (worktime: any, selectedDate: string): boolean => {\n    try {\n        if (!worktime || !worktime.startTime) return false;\n        \n        // Extrahiere nur den Datumsteil (YYYY-MM-DD) aus dem startTime ISO-String\n        const dateOnly = worktime.startTime.split('T')[0];\n        \n        // Vergleiche mit selectedDate\n        return dateOnly === selectedDate;\n    } catch (error) {\n        console.error(\"Fehler beim Prfen der Relevanz eines Worktime-Eintrags:\", error);\n        return false;\n    }\n};\n\n/**\n * Berechnet die Wochentage von Montag bis Sonntag basierend auf einem Startdatum.\n * @param weekStartDate Montag der Woche im Format YYYY-MM-DD\n * @returns Array von Objekten mit date und day Eigenschaften\n */\nexport const getWeekDays = (weekStartDate: string): Array<{ date: string; day: string }> => {\n    if (!weekStartDate) return [];\n    \n    // Beginne mit dem angegebenen Datum als Montag\n    const weekStart = new Date(weekStartDate);\n    \n    // Berechne alle 7 Tage der Woche\n    const weekDays: Array<{ date: string; day: string }> = [];\n    for (let i = 0; i < 7; i++) {\n        const day = addDays(weekStart, i);\n        const dayInfo = {\n            date: format(day, 'yyyy-MM-dd'),\n            day: format(day, 'EEEE', { locale: de })\n        };\n        weekDays.push(dayInfo);\n    }\n    \n    return weekDays;\n};\n\n/**\n * Formatiert ein ISO-DateTime fr die Anzeige im deutschen Format mit Uhrzeit.\n * Diese Funktion wird speziell fr Cerebro-Artikel verwendet.\n * @param dateTimeString Das zu formatierende Datum im ISO-Format (z.B. 2023-06-15T14:30:00Z)\n * @returns Formatiertes Datum und Uhrzeit im Format DD.MM.YYYY HH:MM\n */\nexport const formatDateTimeForCerebro = (dateTimeString: string): string => {\n    if (!dateTimeString) return '-';\n    \n    try {\n        const date = new Date(dateTimeString);\n        \n        // Datum und Uhrzeit im deutschen Format\n        return date.toLocaleDateString('de-DE', {\n            day: '2-digit',\n            month: '2-digit',\n            year: 'numeric',\n            hour: '2-digit',\n            minute: '2-digit'\n        });\n    } catch (error) {\n        console.error('Fehler beim Formatieren des Datums und der Zeit:', error);\n        return '-';\n    }\n};\n\n/**\n * Hilfsfunktionen fr die Datumsbehandlung im Frontend\n */\n\n/**\n * Erstellt ein Date-Objekt ohne Zeitzonenverschiebung\n * @param dateString Ein ISO-Zeitstring\n * @returns Date-Objekt mit korrigiertem Zeitzonenversatz\n */\nexport const createLocalDate = (dateString: string): Date => {\n  const date = new Date(dateString);\n  // Korrigiere den Zeitzonenversatz\n  return new Date(date.getTime() + date.getTimezoneOffset() * 60000);\n};\n\n/* CLAUDE-ANCHOR: TIMEZONE-CONVERSION-001 - Zentrale Timezone-sichere Konvertierung fr datetime-local Inputs */\n/**\n * KRITISCH: Konvertiert datetime-local Input-Werte korrekt fr die API.\n * \n * PROBLEM: datetime-local gibt lokale Zeit zurck (z.B. \"2024-01-15T14:01\")\n * Wenn wir einfach \":00.000\" anhngen, wird es als UTC interpretiert  5h Unterschied!\n * \n * LSUNG: Explizit als lokale Zeit interpretieren und korrekt formatieren.\n * \n * @param datetimeLocalValue Wert aus datetime-local Input (Format: \"YYYY-MM-DDTHH:mm\")\n * @returns ISO-String der als lokale Zeit interpretiert wird (ohne 'Z' Suffix)\n * \n * @example\n * Input: \"2024-01-15T14:01\" (User gibt 14:01 ein)\n * Output: \"2024-01-15T14:01:00.000\" (wird als lokale Zeit gespeichert)\n * Nicht: \"2024-01-15T14:01:00.000Z\" (wrde als UTC interpretiert)\n */\nexport const convertDatetimeLocalToApi = (datetimeLocalValue: string): string => {\n    if (!datetimeLocalValue) {\n        throw new Error('Datetime-local Wert ist erforderlich');\n    }\n    \n    try {\n        // datetime-local Format: \"YYYY-MM-DDTHH:mm\"\n        // Wir fgen nur Sekunden und Millisekunden hinzu, KEIN 'Z' Suffix\n        const apiFormat = `${datetimeLocalValue}:00.000`;\n        \n        // Zustzliche Validierung: Prfe ob das Format gltig ist\n        if (!/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}$/.test(apiFormat)) {\n            throw new Error(`Ungltiges Datumsformat: ${apiFormat}`);\n        }\n        \n        return apiFormat;\n    } catch (error) {\n        console.error('Fehler bei der Datetime-Local Konvertierung:', error);\n        throw new Error(`Konvertierung von datetime-local fehlgeschlagen: ${datetimeLocalValue}`);\n    }\n};\n\n/**\n * KRITISCH: Konvertiert API-Zeitstempel zurck zu datetime-local Format.\n * \n * Wird verwendet beim Bearbeiten von Zeiten - konvertiert DB-Zeit zurck zu Input-Format.\n * Behandelt sowohl UTC-Timestamps (mit 'Z') als auch lokale Timestamps (ohne 'Z').\n * \n * @param apiTimestamp Zeitstempel aus der API (ISO-String)\n * @returns Formatiert fr datetime-local Input (Format: \"YYYY-MM-DDTHH:mm\")\n * \n * @example\n * Input: \"2024-01-15T14:01:00.000Z\" (UTC aus DB)\n * Output: \"2024-01-15T14:01\" (fr datetime-local Input)\n */\nexport const convertApiToDatetimeLocal = (apiTimestamp: string): string => {\n    if (!apiTimestamp) {\n        throw new Error('API-Timestamp ist erforderlich');\n    }\n    \n    try {\n        // Entferne das 'Z' am Ende des Strings, damit JS den Zeitstempel nicht als UTC interpretiert\n        // Dies ist wichtig fr konsistente Zeitbehandlung\n        const localISOString = apiTimestamp.endsWith('Z')\n            ? apiTimestamp.substring(0, apiTimestamp.length - 1)\n            : apiTimestamp;\n        \n        const date = new Date(localISOString);\n        \n        // Validierung: Prfe ob das Datum gltig ist\n        if (isNaN(date.getTime())) {\n            throw new Error(`Ungltiger Zeitstempel: ${apiTimestamp}`);\n        }\n        \n        // Formatiere fr datetime-local Input: \"YYYY-MM-DDTHH:mm\"\n        const formattedDate = format(date, 'yyyy-MM-dd');\n        const formattedTime = format(date, 'HH:mm');\n        \n        return `${formattedDate}T${formattedTime}`;\n    } catch (error) {\n        console.error('Fehler bei der API-zu-Datetime-Local Konvertierung:', error);\n        throw new Error(`Konvertierung von API-Timestamp fehlgeschlagen: ${apiTimestamp}`);\n    }\n};\n\n/**\n * Formatiert die Gesamtdauer einer Liste von Beratungen in Stunden und Minuten.\n * Bercksichtigt nur abgeschlossene Beratungen (mit endTime).\n * \n * @param consultations Array von Consultation-Objekten\n * @returns Formatierte Gesamtdauer als \"Xh Ym\" oder \"0h 0m\" bei leerer Liste\n * \n * @example\n * // Bei Beratungen mit Gesamtdauer von 125 Minuten\n * formatTotalDuration(consultations) // \"2h 5m\"\n */\nexport const formatTotalDuration = (consultations: Array<{ startTime: string; endTime: string | null }>): string => {\n    try {\n        // Berechne die Gesamtdauer in Minuten\n        const totalMinutes = consultations.reduce((total, consultation) => {\n            // Nur abgeschlossene Beratungen bercksichtigen\n            if (!consultation.endTime) return total;\n            \n            // Berechne Dauer dieser Beratung in Minuten\n            const startTime = consultation.startTime.endsWith('Z') \n                ? consultation.startTime.substring(0, consultation.startTime.length - 1)\n                : consultation.startTime;\n            \n            const endTime = consultation.endTime.endsWith('Z') \n                ? consultation.endTime.substring(0, consultation.endTime.length - 1)\n                : consultation.endTime;\n            \n            const start = new Date(startTime);\n            const end = new Date(endTime);\n            \n            const durationMs = end.getTime() - start.getTime();\n            const durationMinutes = Math.floor(durationMs / (1000 * 60));\n            \n            return total + durationMinutes;\n        }, 0);\n        \n        // Konvertiere zu Stunden und Minuten\n        const hours = Math.floor(totalMinutes / 60);\n        const minutes = totalMinutes % 60;\n        \n        return `${hours}h ${minutes}m`;\n    } catch (error) {\n        console.error('Fehler bei der Formatierung der Gesamtdauer:', error);\n        return '0h 0m';\n    }\n};\n\n/**\n * Prft, ob eine Beratung bereits abgerechnet wurde.\n * \n * @param consultation Consultation-Objekt\n * @returns true wenn abgerechnet, false wenn nicht\n */\nexport const isConsultationInvoiced = (consultation: { invoiceItems?: Array<{ invoice: { status: string } }> }): boolean => {\n    return !!(consultation.invoiceItems && consultation.invoiceItems.length > 0);\n};\n\n/**\n * Holt die Rechnungsinformationen einer Beratung.\n * \n * @param consultation Consultation-Objekt\n * @returns Rechnungsinfo oder null wenn nicht abgerechnet\n */\nexport const getConsultationInvoiceInfo = (consultation: { invoiceItems?: Array<{ invoice: { id: number; invoiceNumber: string; status: string; issueDate: string; total: number } }> }) => {\n    if (!consultation.invoiceItems || consultation.invoiceItems.length === 0) {\n        return null;\n    }\n    \n    // Nimm die erste (und normalerweise einzige) Rechnung\n    const firstItem = consultation.invoiceItems[0];\n    return firstItem.invoice;\n};\n\n/**\n * Erstellt einen benutzerfreundlichen Text fr den Rechnungsstatus.\n * \n * @param status Rechnungsstatus\n * @returns Deutscher Status-Text\n */\nexport const getInvoiceStatusText = (status: 'DRAFT' | 'SENT' | 'PAID' | 'OVERDUE' | 'CANCELLED'): string => {\n    const statusMap = {\n        'DRAFT': 'Entwurf',\n        'SENT': 'Gesendet',\n        'PAID': 'Bezahlt',\n        'OVERDUE': 'berfllig',\n        'CANCELLED': 'Storniert'\n    };\n    return statusMap[status] || status;\n};\n\n/**\n * Gibt die Farbe fr einen Rechnungsstatus zurck.\n * \n * @param status Rechnungsstatus\n * @returns CSS-Klassen fr die Statusfarbe\n */\nexport const getInvoiceStatusColor = (status: 'DRAFT' | 'SENT' | 'PAID' | 'OVERDUE' | 'CANCELLED'): string => {\n    const colorMap = {\n        'DRAFT': 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300',\n        'SENT': 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300',\n        'PAID': 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300',\n        'OVERDUE': 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300',\n        'CANCELLED': 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300'\n    };\n    return colorMap[status] || 'bg-gray-100 text-gray-800';\n}; ","import * as React from \"react\";\nfunction StopIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(StopIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction ChevronDownIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"m19.5 8.25-7.5 7.5-7.5-7.5\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(ChevronDownIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction DocumentTextIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(DocumentTextIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction ChartBarIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(ChartBarIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction CheckCircleIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(CheckCircleIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction ClockIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(ClockIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction MagnifyingGlassIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(MagnifyingGlassIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction FunnelIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(FunnelIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction DocumentArrowDownIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(DocumentArrowDownIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction EyeIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(EyeIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction LinkIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(LinkIcon);\nexport default ForwardRef;"],"names":["PlayIcon","_ref","svgRef","title","titleId","props","React","Object","assign","xmlns","fill","viewBox","strokeWidth","stroke","ref","id","strokeLinecap","strokeLinejoin","d","deleteClient","async","axiosInstance","delete","API_ENDPOINTS","CLIENTS","BY_ID","clientId","data","error","console","getRecentClients","get","RECENT","isOpen","onClose","onClientUpdated","onClientDeleted","client","openSidepane","closeSidepane","useSidepane","isLargeScreen","setIsLargeScreen","useState","window","innerWidth","formData","setFormData","name","company","email","phone","address","notes","isActive","errors","setErrors","loading","setLoading","confirmDelete","setConfirmDelete","isMobile","setIsMobile","useEffect","undefined","checkScreenSize","addEventListener","removeEventListener","handleSubmit","e","preventDefault","validateForm","newErrors","trim","test","keys","length","updated","put","clientApi","toast","success","_error$response","_error$response$data","response","message","handleDelete","_error$response2","_error$response2$data","_error$response3","_error$response3$data","_error$response4","_error$response4$data","_error$response5","errorMessage","errorDetails","details","errorSuggestion","suggestion","status","entries","filter","_ref2","_","count","map","_ref3","key","join","handleChange","value","type","target","checked","prev","handleClose","_jsxs","Dialog","open","className","children","_jsx","Panel","Title","onClick","XMarkIcon","onSubmit","htmlFor","onChange","rows","disabled","TrashIcon","ArrowPathIcon","CheckIcon","_Fragment","style","opacity","transition","pointerEvents","role","values","idx","onSelect","onCreateNew","clients","setClients","filteredClients","setFilteredClients","searchTerm","setSearchTerm","editingClient","setEditingClient","isEditModalOpen","setIsEditModalOpen","loadClients","filtered","toLowerCase","includes","BASE","MagnifyingGlassIcon","placeholder","autoFocus","PlusIcon","handleEdit","stopPropagation","PencilIcon","confirm","EditClientModal","updatedClient","index","findIndex","c","newClients","onSave","post","startConsultation","CONSULTATIONS","START","stopConsultation","STOP","updateConsultationNotes","consultationId","patch","UPDATE_NOTES","isPlaceholder","_activeConsultation$c","_activeConsultation$c2","onConsultationChange","onConsultationStarted","user","useAuth","selectedBranch","useBranch","activeConsultation","setActiveConsultation","isStarting","setIsStarting","isClientSelectModalOpen","setIsClientSelectModalOpen","isCreateClientModalOpen","setIsCreateClientModalOpen","selectedClient","setSelectedClient","recentClients","setRecentClients","setNotes","lastStartedClientId","setLastStartedClientId","containerRef","useRef","visibleTagCount","setVisibleTagCount","containerWidth","setContainerWidth","resizeTimeoutRef","isManualEntry","setIsManualEntry","manualStartTime","setManualStartTime","manualEndTime","setManualEndTime","checkActiveConsultation","loadRecentClients","WORKTIME","ACTIVE","log","handleStartConsultation","_consultation$client","correctedStartTime","Date","getTime","getTimezoneOffset","consultation","consultationApi","branchId","startTime","toISOString","dispatchEvent","CustomEvent","updateNotes","timeout","setTimeout","clearTimeout","handleFocus","averageTagWidth","useMemo","reduce","sum","calculateVisibleTags","useCallback","current","currentWidth","clientWidth","Math","abs","availableWidth","maxPossibleTags","max","floor","min","handleResize","resizeObserver","ResizeObserver","observe","disconnect","useLayoutEffect","showOptimisticTags","optimisticTags","Array","i","lastConsultationDate","displayTags","currentVisibleCount","sortedDisplayTags","lastStartedClient","find","UserGroupIcon","ClockIcon","calculateDuration","formatTime","onBlur","correctedEndTime","stoppedConsultation","endTime","StopIcon","some","width","height","slice","isPlanned","Number","toLocaleDateString","day","month","hour","minute","fillRule","clipRule","manualStart","manualEnd","ClientSelectModal","handleCreateClient","CreateClientModal","onTaskLinked","tasks","setTasks","filteredTasks","setFilteredTasks","selectedTaskId","setSelectedTaskId","loadTasks","task","activeTasks","TASKS","responsible","firstName","lastName","LINK_TASK","taskId","invoiceId","invoiceNumber","totalAmount","clientName","downloadingPdf","setDownloadingPdf","CheckCircleIcon","CONSULTATION_INVOICES","GENERATE_PDF","responseType","headers","blob","Blob","url","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","DocumentArrowDownIcon","handleViewInvoiceManagement","info","EyeIcon","consultations","onInvoiceCreated","hasPermission","usePermissions","settings","setSettings","createdInvoice","setCreatedInvoice","showSuccessModal","setShowSuccessModal","issueDate","format","dueDate","now","hourlyRate","vatRate","canCreateInvoices","loadInvoiceSettings","settingsData","INVOICE_SETTINGS","defaultHourlyRate","defaultVatRate","totalHours","duration","parseFloat","replace","estimatedTotal","vatAmount","totalWithVat","uniqueClientIds","Set","_consultations$","_consultations$$clien","invoice","CREATE_FROM_CONSULTATIONS","consultationIds","total","toFixed","step","DocumentTextIcon","InvoiceSuccessModal","handleCloseAll","CONSULTATIONS_TABLE_ID","forwardRef","navigate","useNavigate","setConsultations","setError","isFilterPanelOpen","setIsFilterPanelOpen","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","editingNotesId","setEditingNotesId","editingNotes","setEditingNotes","editingTimeId","setEditingTimeId","editingTimeType","setEditingTimeType","editingTimeValue","setEditingTimeValue","linkTaskModalOpen","setLinkTaskModalOpen","selectedConsultationId","setSelectedConsultationId","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","showCreateInvoiceModal","setShowCreateInvoiceModal","loadConsultations","from","to","params","URLSearchParams","append","toString","useImperativeHandle","refresh","addConsultation","updateConsultation","removeConsultation","activateClientFilter","createAndActivateClientFilter","SAVED_FILTERS","BY_TABLE","heuteFilter","applyFilterConditions","conditions","operators","setInitialFilter","clientFilter","newFilter","tableId","column","operator","refreshSavedFilters","localStorage","getItem","existingFilters","alleFilter","dieseWocheFilter","archivFilterExists","heuteFilterExists","wocheFilterExists","nichtAbgerechnetFilterExists","today","split","archivFilter","wocheFilter","nichtAbgerechnetFilter","createStandardFilters","timeoutId","condition","firstCondition","secondCondition","updateExistingFilters","existingClientFilters","currentRecentClientNames","existingFilter","clientFilterName","updateClientFilters","resetFilterConditions","getActiveFilterCount","handleNotesSave","handleNotesCancel","handleTimeEdit","timeType","currentTime","dbTime","year","getUTCFullYear","String","getUTCMonth","padStart","getUTCDate","hours","getUTCHours","minutes","getUTCMinutes","inputValue","handleTimeSave","timeString","handleTimeCancel","handleDeleteConsultation","applyFiltersAndSearch","search","_consultation$client$","_consultation$notes","_consultation$branch","_consultation$branch$","branch","_consultation$client2","_consultation$client3","_consultation$branch2","_consultation$branch3","_consultation$notes2","result","conditionResult","consultationDate","filterDate","localToday","correctedToday","weekFromToday","setDate","getDate","calculateDurationInMinutes","filterValue","isInvoiced","isConsultationInvoiced","isInMonthlyReport","isConsultationInMonthlyReport","filterValueLower","invoiceInfo","getConsultationInvoiceInfo","getInvoiceStatusText","monthlyReportInfo","getConsultationMonthlyReportInfo","start","filteredConsultations","sort","a","b","totalDuration","formatTotalDuration","timelineMarkers","markers","forEach","currentDate","currentDay","locale","de","currentHour","prevDate","push","date","label","position","prevHour","generateTimelineMarkers","monthlyReportId","monthlyReport","navigateToMonthlyReports","reportId","navigateToInvoices","navigateToTask","FunnelIcon","canCreateInvoice","every","handleCreateInvoice","FilterPane","columns","onApply","onReset","savedConditions","savedOperators","SavedFilterTags","onSelectFilter","onFilterChange","handleFilterChange","_consultation$client4","_consultation$client5","dayMarker","m","middayMarker","billingStatus","getConsultationBillingStatus","_billingStatus$info","_billingStatus$info2","getInvoiceStatusColor","ChartBarIcon","_billingStatus$info3","_billingStatus$info4","reportNumber","taskLinks","taskLink","LinkIcon","handleLinkTask","handleNotesEdit","LinkTaskModal","CreateInvoiceModal","Consultations","consultationListRef","handleConsultationChange","_consultationListRef$","_consultationListRef$2","_consultationListRef$3","_consultationListRef$4","_consultationListRef$5","call","handleConsultationStarted","_consultationListRef$6","_consultationListRef$7","_consultationListRef$8","ConsultationTracker","ConsultationList","formatDate","dateString","dateParts","parseInt","parseISO","startISOString","endsWith","substring","endISOString","durationMs","durationMinutes","convertWeekToDate","weekString","week","dayOfWeek","UTC","getUTCDay","daysToThursday","firstThursday","targetThursday","monday","formattedDate","warn","correctedMonday","startOfWeek","weekStartsOn","fallbackMonday","isWorktimeRelevantForSelectedDate","worktime","selectedDate","getWeekDays","weekStartDate","weekStart","weekDays","addDays","dayInfo","formatDateTimeForCerebro","dateTimeString","createLocalDate","totalMinutes","invoiceItems","ChevronDownIcon"],"sourceRoot":""}