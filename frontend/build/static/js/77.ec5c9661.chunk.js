"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[77],{1060:(e,t,a)=>{a.d(t,{A:()=>u});var r=a(5043),s=a(4117),n=a(6443),l=a(7591),o=a(2069),i=a(7855),d=a(5657),c=a(579);const u=e=>{let{isOpen:t,onClose:a,onReservationCreated:u}=e;const{t:m}=(0,s.Bd)(),{showMessage:x}=(0,i.A)(),{openSidepane:g,closeSidepane:h}=(0,d.N)(),[p,b]=(0,r.useState)(window.innerWidth<640),[y,v]=(0,r.useState)(window.innerWidth>1070),[f,k]=(0,r.useState)(""),[N,w]=(0,r.useState)(""),[j,A]=(0,r.useState)(""),[S,C]=(0,r.useState)("COP"),[T,E]=(0,r.useState)(null),[D,I]=(0,r.useState)(null),[R,L]=(0,r.useState)(!1),F=e=>{const t=e.target.value;w(t),E((e=>e&&0!==e.trim().length?e.includes("@")&&e.includes(".")?"email":"phone":null)(t))},P=e=>{const t=e.target.value;(""===t||/^\d*\.?\d*$/.test(t))&&A(t)};(0,r.useEffect)((()=>{const e=()=>{b(window.innerWidth<640),v(window.innerWidth>1070)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>(t&&!p?g():h(),()=>{h()})),[t,p,g,h]),(0,r.useEffect)((()=>{t||(k(""),w(""),A(""),C("COP"),E(null),I(null))}),[t]);const z=async e=>{if(e.preventDefault(),I(null),f&&0!==f.trim().length)if(N&&0!==N.trim().length)if(!j||parseFloat(j)<=0)I(m("reservations.createReservation.errors.amountRequired","Betrag muss eine positive Zahl sein"));else try{L(!0);const e={guestName:f.trim(),contact:N.trim(),amount:parseFloat(j),currency:S};console.log("[CreateReservationModal] Sende Daten:",e),console.log("[CreateReservationModal] API Endpoint:","/api/reservations");const t=await o.u.create(e);console.log("[CreateReservationModal] Reservierung erstellt:",t),x(m("reservations.createReservation.success","Reservierung erfolgreich erstellt"),"success"),u(t),a()}catch(l){var t,r,s,n;console.error("[CreateReservationModal] Fehler beim Erstellen der Reservierung:",l),console.error("[CreateReservationModal] Error Response:",l.response),console.error("[CreateReservationModal] Error Status:",null===(t=l.response)||void 0===t?void 0:t.status),console.error("[CreateReservationModal] Error Data:",null===(r=l.response)||void 0===r?void 0:r.data);const e=(null===(s=l.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.message)||l.message||m("reservations.createReservation.errors.createError","Fehler beim Erstellen der Reservierung");I(e),x(e,"error")}finally{L(!1)}else I(m("reservations.createReservation.errors.contactRequired","Kontaktinformation ist erforderlich"));else I(m("reservations.createReservation.errors.guestNameRequired","Gast-Name ist erforderlich"))},O=()=>{a()};return p?(0,c.jsxs)(n.lG,{open:t,onClose:O,className:"relative z-50",children:[(0,c.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,c.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,c.jsx)(n.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:(0,c.jsxs)("div",{className:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,c.jsx)(n.lG.Title,{className:"text-lg font-medium text-gray-900 dark:text-white",children:m("reservations.createReservation.title","Neue Reservierung")}),(0,c.jsx)("button",{onClick:O,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",children:(0,c.jsx)(l.A,{className:"h-6 w-6"})})]}),D&&(0,c.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded",children:D}),(0,c.jsxs)("form",{onSubmit:z,children:[(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsxs)("label",{htmlFor:"guestName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[m("reservations.createReservation.guestName","Gast-Name")," *"]}),(0,c.jsx)("input",{type:"text",id:"guestName",value:f,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsxs)("label",{htmlFor:"contact",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[m("reservations.createReservation.contact","Telefonnummer oder Email")," *"]}),(0,c.jsx)("input",{type:"text",id:"contact",value:N,onChange:F,placeholder:m("reservations.createReservation.contactPlaceholder","z.B. +573001234567 oder email@example.com"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0}),T&&(0,c.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"email"===T?m("reservations.createReservation.detectedEmail","Email erkannt"):m("reservations.createReservation.detectedPhone","Telefonnummer erkannt")})]}),(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[m("reservations.createReservation.amount","Betrag")," *"]}),(0,c.jsx)("input",{type:"text",id:"amount",value:j,onChange:P,placeholder:"0.00",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:m("reservations.createReservation.currency","W\xe4hrung")}),(0,c.jsxs)("select",{id:"currency",value:S,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",children:[(0,c.jsx)("option",{value:"COP",children:"COP"}),(0,c.jsx)("option",{value:"USD",children:"USD"}),(0,c.jsx)("option",{value:"EUR",children:"EUR"})]})]})]}),(0,c.jsx)("p",{className:"mb-4 text-sm text-gray-500 dark:text-gray-400",children:m("reservations.createReservation.hint","Nach der Erstellung wird automatisch eine WhatsApp-Nachricht mit Zahlungslink versendet (wenn Telefonnummer angegeben).")}),(0,c.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,c.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:m("common.cancel","Abbrechen")}),(0,c.jsx)("button",{type:"submit",disabled:R,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:R?m("common.creating","Wird erstellt..."):m("common.create","Erstellen")})]})]})]})})})]}):(0,c.jsxs)(c.Fragment,{children:[t&&!y&&(0,c.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,c.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,c.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,c.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:m("reservations.createReservation.title","Neue Reservierung")}),(0,c.jsx)("button",{onClick:O,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,c.jsx)(l.A,{className:"h-6 w-6"})})]}),(0,c.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[D&&(0,c.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded",children:D}),(0,c.jsxs)("form",{onSubmit:z,children:[(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsxs)("label",{htmlFor:"guestName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[m("reservations.createReservation.guestName","Gast-Name")," *"]}),(0,c.jsx)("input",{type:"text",id:"guestName",value:f,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsxs)("label",{htmlFor:"contact",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[m("reservations.createReservation.contact","Telefonnummer oder Email")," *"]}),(0,c.jsx)("input",{type:"text",id:"contact",value:N,onChange:F,placeholder:m("reservations.createReservation.contactPlaceholder","z.B. +573001234567 oder email@example.com"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0}),T&&(0,c.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"email"===T?m("reservations.createReservation.detectedEmail","Email erkannt"):m("reservations.createReservation.detectedPhone","Telefonnummer erkannt")})]}),(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[m("reservations.createReservation.amount","Betrag")," *"]}),(0,c.jsx)("input",{type:"text",id:"amount",value:j,onChange:P,placeholder:"0.00",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",required:!0})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:m("reservations.createReservation.currency","W\xe4hrung")}),(0,c.jsxs)("select",{id:"currency",value:S,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",children:[(0,c.jsx)("option",{value:"COP",children:"COP"}),(0,c.jsx)("option",{value:"USD",children:"USD"}),(0,c.jsx)("option",{value:"EUR",children:"EUR"})]})]})]}),(0,c.jsx)("p",{className:"mb-4 text-sm text-gray-500 dark:text-gray-400",children:m("reservations.createReservation.hint","Nach der Erstellung wird automatisch eine WhatsApp-Nachricht mit Zahlungslink versendet (wenn Telefonnummer angegeben).")}),(0,c.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,c.jsx)("button",{type:"button",onClick:O,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:m("common.cancel","Abbrechen")}),(0,c.jsx)("button",{type:"submit",disabled:R,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:R?m("common.creating","Wird erstellt..."):m("common.create","Erstellen")})]})]})]})]})]})}},1726:(e,t,a)=>{a.d(t,{X:()=>r,d:()=>s});let r=function(e){return e.CONFIRMED="confirmed",e.NOTIFICATION_SENT="notification_sent",e.CHECKED_IN="checked_in",e.CHECKED_OUT="checked_out",e.CANCELLED="cancelled",e.NO_SHOW="no_show",e}({}),s=function(e){return e.PENDING="pending",e.PAID="paid",e.PARTIALLY_PAID="partially_paid",e.REFUNDED="refunded",e}({})},2069:(e,t,a)=>{a.d(t,{u:()=>l});var r=a(1923),s=a(1801);const n="/reservations",l={async create(e){console.log("[reservationService] POST zu:",n),console.log("[reservationService] Daten:",e);const t=await r.A.post(n,e);return console.log("[reservationService] Response:",t),t.data.data||t.data},async getById(e){const t=await r.A.get("".concat(n,"/").concat(e));return t.data.data||t.data},async updateGuestContact(e,t){const a=await r.A.put("".concat(n,"/").concat(e,"/guest-contact"),{contact:t});return a.data.data||a.data},async generatePinAndSend(e){const t=await r.A.post(s.Sn.RESERVATION.GENERATE_PIN_AND_SEND(e));return t.data.data||t.data},async sendInvitation(e,t){const a=await r.A.post(s.Sn.RESERVATION.SEND_INVITATION(e),t||{});return a.data.data||a.data},async getNotificationLogs(e){const t=await r.A.get(s.Sn.RESERVATION.NOTIFICATION_LOGS(e));return t.data.data||t.data}}},8077:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Ae});var r=a(9379),s=a(5043),n=a(4117),l=a(3216),o=a(2672),i=a(2760),d=a(2023),c=a(8897),u=a(5442),m=a(6287),x=a(8662),g=a(4538),h=a(4850),p=a(1663),b=a(8010),y=a(1909),v=a(1369),f=a(1252),k=a(2811),N=a(3744),w=a(9248),j=a(6238),A=a(4129),S=a(7988),C=a(5501),T=a(8682),E=a(9850),D=a(9670),I=a(2683),R=a(7012),L=a(6693),F=a(1816),P=a(7438),z=a(1923),O=a(6443),M=a(7591),q=a(9422),B=a(1801),_=a(579);const V=e=>{let{onArticleSelected:t,excludeArticleIds:a=[],selectedArticles:r,onArticleRemove:n}=e;const[l,o]=(0,s.useState)([]),[i,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(null),[m,x]=(0,s.useState)(!1),[g,h]=(0,s.useState)(null);(0,s.useEffect)((()=>{(async()=>{try{x(!0),h(null);const e=(await z.A.get(B.Sn.CEREBRO.ARTICLES.BASE)).data.filter((e=>!a.includes(e.id)));o(e)}catch(r){var e,t;console.error("Fehler beim Abrufen der Artikel:",r);const a=r;h((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message||"Ein unerwarteter Fehler ist aufgetreten")}finally{x(!1)}})()}),[a]);return(0,_.jsxs)("div",{className:"mt-4",children:[(0,_.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cerebro-Artikel verkn\xfcpfen"}),(0,_.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,_.jsxs)("div",{className:"flex items-center gap-2",children:[(0,_.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:i||"",onChange:e=>{const t=parseInt(e.target.value,10);if(isNaN(t))d(null),u(null);else{d(t);l.find((e=>e.id===t))&&(async e=>{try{x(!0);const t=await z.A.get(B.Sn.CEREBRO.ARTICLES.BY_ID(e));u(t.data)}catch(t){console.error("Fehler beim Abrufen der Artikeldetails:",t)}finally{x(!1)}})(t)}},children:[(0,_.jsx)("option",{value:"",children:"-- Artikel ausw\xe4hlen --"}),l.map((e=>(0,_.jsx)("option",{value:e.id,children:e.title},e.id)))]}),(0,_.jsx)("button",{type:"button",onClick:()=>{if(null!==i){const e=l.find((e=>e.id===i));e&&(t(e),d(null),u(null))}},disabled:null===i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"Verkn\xfcpfen"})]}),m&&(0,_.jsx)("div",{className:"text-sm text-gray-500",children:"Lade Artikel..."}),g&&(0,_.jsx)("div",{className:"text-sm text-red-600",children:g}),c&&(0,_.jsxs)("div",{className:"mt-2 p-4 border border-gray-300 rounded-md bg-gray-50",children:[(0,_.jsx)("h4",{className:"font-medium text-lg mb-2",children:c.title}),(0,_.jsx)("div",{className:"prose prose-sm max-w-none",children:c.content?(0,_.jsxs)("div",{className:"text-sm text-gray-700 max-h-40 overflow-y-auto",children:[c.content.substring(0,300),c.content.length>300&&"..."]}):(0,_.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Kein Inhalt verf\xfcgbar"})}),(0,_.jsx)("div",{className:"mt-2",children:(0,_.jsx)("a",{href:"/cerebro/articles/".concat(c.slug),target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"Artikel \xf6ffnen"})})]})]})]})};var W=a(5657);const K=e=>{let{error:t,title:a,setTitle:r,description:l,setDescription:o,assigneeType:i,setAssigneeType:d,responsibleId:c,setResponsibleId:u,roleId:m,setRoleId:x,qualityControlId:g,setQualityControlId:h,branchId:p,setBranchId:b,dueDate:y,setDueDate:v,users:f,roles:k,branches:N,loading:w,handleSubmit:j,handleClose:A,selectedArticles:S,onArticleSelect:C,onArticleRemove:T,uploading:E=!1,temporaryAttachments:D=[],onFileUpload:I,onRemoveAttachment:R,textareaRef:L,fileInputRef:P,handlePaste:z,handleDrop:O,handleDragOver:B}=e;const{t:W}=(0,n.Bd)(),[K,G]=(0,s.useState)("data");return(0,_.jsxs)("form",{onSubmit:j,className:"space-y-4",noValidate:!0,children:[t&&(0,_.jsx)("div",{className:"bg-red-100 dark:bg-red-900 border-l-4 border-red-500 dark:border-red-700 text-red-700 dark:text-red-300 p-4 mb-4",children:(0,_.jsx)("p",{children:t})}),(0,_.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,_.jsxs)("nav",{className:"-mb-px flex space-x-4","aria-label":"Tabs",children:[(0,_.jsx)("button",{type:"button",className:"".concat("data"===K?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),onClick:()=>G("data"),children:"Daten"}),(0,_.jsx)("button",{type:"button",className:"".concat("cerebro"===K?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),onClick:()=>G("cerebro"),children:"Cerebro Artikel"})]})}),"data"===K&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{children:[(0,_.jsxs)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[W("tasks.createTask.form.title")," *"]}),(0,_.jsx)("input",{type:"text",id:"title",value:a,onChange:e=>r(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,_.jsx)("div",{className:"space-y-4",children:(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{htmlFor:"description_sidepane",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:W("tasks.createTask.form.description")}),(0,_.jsxs)("div",{className:"relative",children:[(0,_.jsx)("textarea",{ref:L,id:"description_task_create",rows:6,className:"block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm",value:l,onChange:e=>o(e.target.value),onPaste:z,onDrop:O,onDragOver:B,placeholder:W("tasks.createTask.form.descriptionPlaceholder")}),(0,_.jsxs)("div",{className:"relative group absolute bottom-2 left-2",children:[(0,_.jsx)("button",{type:"button",onClick:()=>{var e;return null===P||void 0===P||null===(e=P.current)||void 0===e?void 0:e.click()},className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400 focus:outline-none",children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:W("tasks.createTask.form.fileUpload")})]}),(0,_.jsx)("input",{ref:P,type:"file",onChange:I,className:"hidden"}),E&&(0,_.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-70 dark:bg-opacity-70",children:(0,_.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:W("tasks.createTask.form.uploading")})})]}),D&&D.length>0&&(0,_.jsx)("div",{className:"mt-2",children:(0,_.jsx)("ul",{className:"flex flex-wrap gap-2",children:D.map(((e,t)=>(0,_.jsxs)("li",{className:"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-md px-2 py-1 relative group",children:[(0,_.jsx)("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-300",children:e.fileName}),(0,_.jsx)("div",{className:"flex ml-2",children:(0,_.jsxs)("div",{className:"relative group ml-1",children:[(0,_.jsx)("button",{type:"button",onClick:()=>null===R||void 0===R?void 0:R(t),className:"text-red-600 hover:text-red-900",children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:W("tasks.createTask.form.remove")})]})}),e.fileType.startsWith("image/")&&e.file&&(0,_.jsx)("div",{className:"absolute z-10 bg-white dark:bg-gray-800 p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 dark:border-gray-700 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:(0,_.jsx)("img",{src:URL.createObjectURL(e.file),alt:e.fileName,className:"max-w-[200px] max-h-[150px] object-contain"})})]},t)))})})]})}),(0,_.jsxs)("div",{className:"space-y-2",children:[(0,_.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[W("tasks.createTask.form.responsibleFor")," *"]}),(0,_.jsxs)("div",{className:"flex space-x-4",children:[(0,_.jsxs)("label",{className:"inline-flex items-center",children:[(0,_.jsx)("input",{type:"radio",className:"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600",name:"assigneeType",value:"user",checked:"user"===i,onChange:()=>{d("user"),x("")}}),(0,_.jsx)("span",{className:"ml-2 dark:text-gray-300",children:W("tasks.createTask.form.user")})]}),(0,_.jsxs)("label",{className:"inline-flex items-center",children:[(0,_.jsx)("input",{type:"radio",className:"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600",name:"assigneeType",value:"role",checked:"role"===i,onChange:()=>{d("role"),u("")}}),(0,_.jsx)("span",{className:"ml-2 dark:text-gray-300",children:W("tasks.createTask.form.role")})]})]})]}),"user"===i?(0,_.jsxs)("div",{children:[(0,_.jsxs)("label",{htmlFor:"responsible",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[W("tasks.createTask.form.responsibleUser")," *"]}),(0,_.jsxs)("select",{id:"responsible",value:c,onChange:e=>u(e.target.value?Number(e.target.value):""),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[(0,_.jsx)("option",{value:"",children:W("tasks.createTask.form.pleaseSelect")}),Array.isArray(f)&&f.map((e=>(0,_.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})]}):(0,_.jsxs)("div",{children:[(0,_.jsxs)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[W("tasks.createTask.form.responsibleRole")," *"]}),(0,_.jsxs)("select",{id:"role",value:m,onChange:e=>x(e.target.value?Number(e.target.value):""),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[(0,_.jsx)("option",{value:"",children:W("tasks.createTask.form.pleaseSelect")}),Array.isArray(k)&&k.map((e=>(0,_.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{htmlFor:"qualityControl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:W("tasks.createTask.form.qualityControl")}),(0,_.jsxs)("select",{id:"qualityControl",value:g,onChange:e=>h(e.target.value?Number(e.target.value):""),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,_.jsx)("option",{value:"",children:W("tasks.createTask.form.noQualityControl")}),Array.isArray(f)&&f.map((e=>(0,_.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})]}),(0,_.jsxs)("div",{children:[(0,_.jsxs)("label",{htmlFor:"branch",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[W("tasks.createTask.form.branch")," *"]}),(0,_.jsxs)("select",{id:"branch",value:p,onChange:e=>b(Number(e.target.value)),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[(0,_.jsx)("option",{value:"",children:W("common.pleaseSelect")}),Array.isArray(N)&&N.map((e=>(0,_.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{htmlFor:"dueDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:W("tasks.createTask.form.dueDate")}),(0,_.jsx)("input",{type:"date",id:"dueDate",value:y,onChange:e=>v(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),"cerebro"===K&&(0,_.jsxs)("div",{children:[(0,_.jsxs)("div",{className:"mb-4",children:[(0,_.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Verkn\xfcpfte Cerebro-Artikel"}),S.length>0?(0,_.jsx)("ul",{className:"mt-2 space-y-2",children:S.map((e=>(0,_.jsxs)("li",{className:"flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 rounded",children:[(0,_.jsx)("span",{className:"dark:text-gray-300",children:e.title}),(0,_.jsx)("button",{type:"button",onClick:()=>T(e.id),className:"text-red-600 hover:text-red-800",children:W("tasks.createTask.form.remove")})]},e.id)))}):(0,_.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:W("tasks.createTask.form.noArticlesLinked")})]}),(0,_.jsx)(V,{onArticleSelected:C,excludeArticleIds:S.map((e=>e.id)),selectedArticles:S,onArticleRemove:T})]}),(0,_.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{type:"button",onClick:A,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,_.jsx)(M.A,{className:"h-5 w-5"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:W("tasks.createTask.form.cancel")})]}),(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",disabled:w,children:w?(0,_.jsx)(F.A,{className:"h-5 w-5 animate-spin"}):(0,_.jsx)(q.A,{className:"h-5 w-5"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:W(w?"tasks.createTask.form.creating":"tasks.createTask.form.create")})]})]})]})},G=e=>{let{isOpen:t,onClose:a,onTaskCreated:r}=e;const{t:l}=(0,n.Bd)(),{user:i}=(0,o.As)(),{openSidepane:d,closeSidepane:c}=(0,W.N)(),[u,m]=(0,s.useState)(window.innerWidth>1070),[x,g]=(0,s.useState)(""),[h,p]=(0,s.useState)(""),[b,y]=(0,s.useState)("user"),[v,f]=(0,s.useState)(""),[k,N]=(0,s.useState)(""),[w,j]=(0,s.useState)(""),[A,S]=(0,s.useState)(""),[C,T]=(0,s.useState)(""),[E,D]=(0,s.useState)([]),[I,R]=(0,s.useState)([]),[L,F]=(0,s.useState)([]),[P,q]=(0,s.useState)(null),[V,G]=(0,s.useState)(!1),[U,Z]=(0,s.useState)(window.innerWidth<640),[H,Q]=(0,s.useState)([]),[Y,$]=(0,s.useState)("data"),[X,J]=(0,s.useState)([]),[ee,te]=(0,s.useState)(!1),ae=(0,s.useRef)(null),re=(0,s.useRef)(null);(0,s.useEffect)((()=>{t&&(se(),ne(),le(),i&&j(i.id),T((()=>{const e=new Date;return e.setDate(e.getDate()+7),e.toISOString().split("T")[0]})()))}),[t,i]),(0,s.useEffect)((()=>{L.length>0&&""===A&&(1===L.length||L.length>1)&&S(L[0].id)}),[L,A]),(0,s.useEffect)((()=>{const e=()=>{Z(window.innerWidth<640),m(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,s.useEffect)((()=>(t?d():c(),()=>{c()})),[t,d,c]);const se=async()=>{try{q(null);if(!localStorage.getItem("token"))return void q("Nicht authentifiziert");console.log("Lade Benutzer f\xfcr CreateTaskModal...");const e=await z.A.get(B.Sn.USERS.DROPDOWN);console.log("Benutzer geladen:",e.data.length),D(e.data||[])}catch(a){console.error("Fehler beim Laden der Benutzer:",a);const r=a;var e,t;if("ERR_NETWORK"===r.code)q(l("tasks.createTask.errors.connectionError"));else q("".concat(l("tasks.createTask.errors.loadUsersError"),": ").concat((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||r.message))}},ne=async()=>{try{q(null);if(!localStorage.getItem("token"))return void q("Nicht authentifiziert");const e=await z.A.get(B.Sn.ROLES.BASE);R(e.data||[])}catch(a){console.error("Fehler beim Laden der Rollen:",a);const r=a;var e,t;if("ERR_NETWORK"===r.code)q(l("tasks.createTask.errors.connectionError"));else q("".concat(l("tasks.createTask.errors.loadRolesError"),": ").concat((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||r.message))}},le=async()=>{try{q(null);if(!localStorage.getItem("token"))return void q("Nicht authentifiziert");console.log("Lade Niederlassungen f\xfcr CreateTaskModal...");const e=await z.A.get(B.Sn.BRANCHES.BASE);console.log("Niederlassungen geladen:",e.data.length),F(e.data||[])}catch(a){console.error("Fehler beim Laden der Niederlassungen:",a);const r=a;var e,t;if("ERR_NETWORK"===r.code)q(l("tasks.createTask.errors.connectionError"));else q("".concat(l("tasks.createTask.errors.loadBranchesError"),": ").concat((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||r.message))}},oe=async e=>{const t=e.clipboardData.items;for(let a=0;a<t.length;a++){const r=t[a];if(0===r.type.indexOf("image")){e.preventDefault();const t=r.getAsFile();return void(t&&await ce(t))}}},ie=async e=>{if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&e.dataTransfer.files.length>0){const t=e.dataTransfer.files[0];await ce(t)}},de=e=>{e.preventDefault(),e.stopPropagation()},ce=async e=>{te(!0),q(null);try{const t={fileName:e.name,fileType:e.type,fileSize:e.size,file:e};J((e=>[...e,t]));let a="";if(a=e.type.startsWith("image/")?"\n![".concat(e.name,"](").concat(l("tasks.createTask.form.uploadAfterCreate"),")\n"):"\n[".concat(e.name,"](").concat(l("tasks.createTask.form.uploadAfterCreate"),")\n"),re.current){const e=re.current.selectionStart,t=h.substring(0,e),r=h.substring(e);p(t+a+r),setTimeout((()=>{if(re.current){const t=e+a.length;re.current.selectionStart=t,re.current.selectionEnd=t,re.current.focus()}}),0)}else p(h+a)}catch(r){var t,a;console.error("Fehler beim Verarbeiten der Datei:",r);const e=r;q((null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||e.message||"Ein unerwarteter Fehler ist aufgetreten")}finally{te(!1)}},ue=async e=>{const t=e.target.files;if(!t||0===t.length)return;const a=t[0];await ce(a),ae.current&&(ae.current.value="")},me=e=>{const t=X[e];if(t&&(J(X.filter(((t,a)=>a!==e))),t.fileName)){const e=t.fileName.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),a=l("tasks.createTask.form.uploadAfterCreate"),r=new RegExp("!\\[".concat(e,"\\]\\(").concat(a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\)"),"g"),s=new RegExp("\\[".concat(e,"\\]\\(").concat(a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\)"),"g"),n=h.replace(r,"").replace(s,"").replace(/\n{3,}/g,"\n\n");p(n)}},xe=async e=>{e.preventDefault(),q(null),G(!0);try{if(!x||!v&&!k||!A)return q(l("tasks.createTask.errors.fillAllFields")),void G(!1);if(v&&k)return q(l("tasks.createTask.errors.chooseUserOrRole")),void G(!1);if(!localStorage.getItem("token"))return q("Nicht authentifiziert"),void G(!1);const e=Number(A),t=w?Number(w):null,a=v?Number(v):null,s=k?Number(k):null;if(v&&isNaN(a)||k&&isNaN(s)||isNaN(e)||w&&isNaN(t))return q(l("tasks.createTask.errors.invalidIds")),void G(!1);const n={title:x,description:h,status:"open",qualityControlId:t,branchId:e,dueDate:C};"user"===b&&v?n.responsibleId=v:"role"===b&&k&&(n.roleId=k);const o=await z.A.post(B.Sn.TASKS.BASE,n),i=o.data.id;H.length>0&&await Promise.all(H.map((e=>z.A.post(B.Sn.TASKS.LINK_CARTICLE(i,e.id))))),await(async e=>{if(0!==X.length)try{G(!0);for(const t of X){if(!t.file)continue;const a=new FormData;a.append("file",t.file),await z.A.post(B.Sn.TASKS.ATTACHMENTS(e),a,{headers:{"Content-Type":"multipart/form-data"}})}console.log("".concat(X.length," Anh\xe4nge erfolgreich hochgeladen."))}catch(t){console.error("Fehler beim Hochladen der Anh\xe4nge:",t)}finally{G(!1)}})(i),console.log("Task erfolgreich erstellt:",o.data),r(o.data),ge()}catch(s){var t,a;console.error("Fehler beim Erstellen des Tasks:",s);const e=s;q((null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||e.message||l("tasks.createTask.errors.createError"))}finally{G(!1)}},ge=()=>{g(""),p(""),y("user"),f(""),N(""),j(""),S(""),T(""),q(null),Q([]),J([]),a()},he=e=>{Q((t=>[...t,e]))},pe=e=>{Q((t=>t.filter((t=>t.id!==e))))};return U?(0,_.jsxs)(O.lG,{open:t,onClose:ge,className:"relative z-50",children:[(0,_.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,_.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,_.jsxs)(O.lG.Panel,{className:"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,_.jsx)(O.lG.Title,{className:"text-lg font-semibold dark:text-white",children:l("tasks.createTask.title")}),(0,_.jsx)("button",{onClick:ge,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,_.jsx)(M.A,{className:"h-6 w-6"})})]}),(0,_.jsx)(K,{error:P,title:x,setTitle:g,description:h,setDescription:p,assigneeType:b,setAssigneeType:y,responsibleId:v,setResponsibleId:f,roleId:k,setRoleId:N,qualityControlId:w,setQualityControlId:j,branchId:A,setBranchId:S,dueDate:C,setDueDate:T,users:E,roles:I,branches:L,loading:V,handleSubmit:xe,handleClose:ge,selectedArticles:H,onArticleSelect:he,onArticleRemove:pe,uploading:ee,temporaryAttachments:X,onFileUpload:ue,onRemoveAttachment:me,textareaRef:re,fileInputRef:ae,handlePaste:oe,handleDrop:ie,handleDragOver:de})]})})]}):(0,_.jsxs)(_.Fragment,{children:[t&&!u&&(0,_.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,_.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,_.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,_.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:l("tasks.createTask.title")}),(0,_.jsx)("button",{onClick:ge,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,_.jsx)(M.A,{className:"h-6 w-6"})})]}),(0,_.jsx)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:(0,_.jsx)(K,{error:P,title:x,setTitle:g,description:h,setDescription:p,assigneeType:b,setAssigneeType:y,responsibleId:v,setResponsibleId:f,roleId:k,setRoleId:N,qualityControlId:w,setQualityControlId:j,branchId:A,setBranchId:S,dueDate:C,setDueDate:T,users:E,roles:I,branches:L,loading:V,handleSubmit:xe,handleClose:ge,selectedArticles:H,onArticleSelect:he,onArticleRemove:pe,uploading:ee,temporaryAttachments:X,onFileUpload:ue,onRemoveAttachment:me,textareaRef:re,fileInputRef:ae,handlePaste:oe,handleDrop:ie,handleDragOver:de})})]})]})};var U=a(5377),Z=a(7855);const H=e=>{var t,a,r,s,l;let{task:o}=e;const{t:i}=(0,n.Bd)(),{showMessage:d}=(0,Z.A)(),c=(null===(t=o.title)||void 0===t?void 0:t.includes("ARL"))||(null===(a=o.title)||void 0===a?void 0:a.includes("EPS"))||(null===(r=o.title)||void 0===r?void 0:r.includes("Pension"))||(null===(s=o.title)||void 0===s?void 0:s.includes("Caja"))||(null===(l=o.description)||void 0===l?void 0:l.includes("lifecycle"));let u={};if(o.description)try{const e=o.description.match(/\{[\s\S]*\}/);e&&(u=JSON.parse(e[0]))}catch(m){o.description.split("\n").forEach((e=>{const t=e.match(/([^:]+):\s*(.+)/);if(t){const e=t[1].trim(),a=t[2].trim();u[e]=a}}))}0===Object.keys(u).length&&c&&(u={taskType:o.title,description:o.description||i("lifecycle.noDataAvailable")});return c||0!==Object.keys(u).length?(0,_.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-4",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,_.jsxs)("h3",{className:"text-lg font-semibold flex items-center dark:text-white",children:[(0,_.jsx)(U.A,{className:"h-5 w-5 mr-2"}),i("lifecycle.autoGeneratedData",{defaultValue:"Automatisch generierte Daten"})]}),(0,_.jsx)("button",{onClick:async()=>{try{const e=JSON.stringify(u,null,2);await navigator.clipboard.writeText(e),d(i("lifecycle.dataCopied",{defaultValue:"Daten in Zwischenablage kopiert"}),"success")}catch(e){console.error("Fehler beim Kopieren:",e),d(i("lifecycle.copyError",{defaultValue:"Fehler beim Kopieren"}),"error")}},className:"text-blue-600 dark:text-blue-400 hover:underline text-sm",children:i("lifecycle.copyData",{defaultValue:"Daten kopieren"})})]}),(0,_.jsx)("div",{className:"space-y-2",children:Object.keys(u).length>0?Object.entries(u).map((e=>{let[t,a]=e;return(0,_.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[(0,_.jsxs)("span",{className:"font-medium w-full sm:w-1/3 dark:text-gray-300",children:[i("lifecycle.".concat(t))||t,":"]}),(0,_.jsx)("span",{className:"text-gray-600 dark:text-gray-400 flex-1 break-words",children:"object"===typeof a?JSON.stringify(a,null,2):String(a)})]},t)})):(0,_.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-sm",children:i("lifecycle.noDataAvailable",{defaultValue:"Keine automatisch generierten Daten verf\xfcgbar"})})})]}):null},Q=e=>{var t,a,r,l,o;let{task:i}=e;const{t:d}=(0,n.Bd)(),{showMessage:c}=(0,Z.A)(),[u,m]=(0,s.useState)(""),[x,g]=(0,s.useState)(!1),[h,p]=(0,s.useState)(!1),[b,y]=(0,s.useState)(!1);if(!((null===(t=i.title)||void 0===t?void 0:t.includes("ARL"))||(null===(a=i.title)||void 0===a?void 0:a.includes("EPS"))||(null===(r=i.title)||void 0===r?void 0:r.includes("Pension"))||(null===(l=i.title)||void 0===l?void 0:l.includes("Caja"))||(null===(o=i.description)||void 0===o?void 0:o.includes("lifecycle"))))return null;return(0,_.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-4",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,_.jsxs)("h3",{className:"text-lg font-semibold flex items-center dark:text-white",children:[(0,_.jsx)(T.A,{className:"h-5 w-5 mr-2"}),d("lifecycle.emailTemplate",{defaultValue:"Email-Vorlage"})]}),(0,_.jsx)("button",{onClick:async()=>{y(!0);try{const e="Sehr geehrte Damen und Herren,\n\nim Rahmen des Onboarding-Prozesses ben\xf6tigen wir die Anmeldung f\xfcr ".concat(i.title,".\n\nBitte senden Sie uns die erforderlichen Informationen zur\xfcck.\n\nMit freundlichen Gr\xfc\xdfen\nIhr Team");m(e),c(d("lifecycle.templateGenerated",{defaultValue:"Email-Vorlage generiert"}),"success")}catch(a){var e,t;console.error("Fehler beim Generieren der Email-Vorlage:",a),c((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||d("lifecycle.templateGenerationError",{defaultValue:"Fehler beim Generieren der Vorlage"}),"error")}finally{y(!1)}},disabled:b,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center text-sm",children:b?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(F.A,{className:"h-4 w-4 mr-2 animate-spin"}),d("common.generating",{defaultValue:"Generiere..."})]}):d("lifecycle.generateTemplate",{defaultValue:"Vorlage generieren"})})]}),u&&(0,_.jsxs)("div",{className:"space-y-4",children:[(0,_.jsx)("textarea",{value:u,onChange:e=>{m(e.target.value),p(!1)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",rows:10,placeholder:d("lifecycle.templatePlaceholder",{defaultValue:"Email-Vorlage wird hier angezeigt..."})}),(0,_.jsx)("div",{className:"flex justify-end",children:(0,_.jsx)("button",{onClick:async()=>{if(u.trim()){g(!0);try{await new Promise((e=>setTimeout(e,1e3))),p(!0),c(d("lifecycle.emailSent",{defaultValue:"Email erfolgreich versendet"}),"success")}catch(a){var e,t;console.error("Fehler beim Versenden der Email:",a),c((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||d("lifecycle.emailSendError",{defaultValue:"Fehler beim Versenden der Email"}),"error")}finally{g(!1)}}else c(d("lifecycle.templateRequired",{defaultValue:"Bitte generieren Sie zuerst eine Vorlage"}),"warning")},disabled:x||h,className:"p-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",title:x?d("common.sending",{defaultValue:"Sende..."}):h?d("lifecycle.emailSent",{defaultValue:"Versendet"}):d("lifecycle.sendEmail",{defaultValue:"Email versenden"}),children:x?(0,_.jsx)(F.A,{className:"h-5 w-5 animate-spin"}):h?(0,_.jsx)(q.A,{className:"h-5 w-5"}):(0,_.jsx)(P.A,{className:"h-5 w-5"})})})]}),!u&&(0,_.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-sm text-center py-4",children:d("lifecycle.noTemplate",{defaultValue:'Klicken Sie auf "Vorlage generieren" um eine Email-Vorlage zu erstellen'})})]})},Y=e=>{var t,a,l,o,i;let{task:d,onComplete:c}=e;const{t:u}=(0,n.Bd)(),{showMessage:m}=(0,Z.A)(),[x,g]=(0,s.useState)({registrationNumber:"",provider:"",registrationDate:"",notes:""}),[h,p]=(0,s.useState)(!1);if(!((null===(t=d.title)||void 0===t?void 0:t.includes("ARL"))||(null===(a=d.title)||void 0===a?void 0:a.includes("EPS"))||(null===(l=d.title)||void 0===l?void 0:l.includes("Pension"))||(null===(o=d.title)||void 0===o?void 0:o.includes("Caja"))||(null===(i=d.description)||void 0===i?void 0:i.includes("lifecycle"))))return null;const b=(()=>{var e,t,a,r;return null!==(e=d.title)&&void 0!==e&&e.includes("ARL")?"arl":null!==(t=d.title)&&void 0!==t&&t.includes("EPS")?"eps":null!==(a=d.title)&&void 0!==a&&a.includes("Pension")?"pension":null!==(r=d.title)&&void 0!==r&&r.includes("Caja")?"caja":null})();return(0,_.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-4",children:[(0,_.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-white",children:u("lifecycle.completeRegistration",{defaultValue:"Anmeldung abschlie\xdfen"})}),(0,_.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),p(!0);try{const e=(()=>{if(d.description){const e=d.description.match(/userId[:\s]+(\d+)/i);if(e)return parseInt(e[1],10)}return d.responsibleId})();if(!e||!b)return void m(u("lifecycle.missingData",{defaultValue:"Benutzer-ID oder Sozialversicherungs-Typ fehlt"}),"error");await z.A.put(B.Sn.LIFECYCLE.SOCIAL_SECURITY(e,b),{status:"registered",registrationNumber:x.registrationNumber,provider:x.provider,registrationDate:x.registrationDate,notes:x.notes,completedAt:(new Date).toISOString()}),m(u("lifecycle.registrationCompleted",{defaultValue:"Anmeldung erfolgreich abgeschlossen"}),"success"),g({registrationNumber:"",provider:"",registrationDate:"",notes:""}),c&&c()}catch(r){var t,a;console.error("Fehler beim Abschlie\xdfen der Anmeldung:",r),m((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||u("lifecycle.registrationError",{defaultValue:"Fehler beim Abschlie\xdfen der Anmeldung"}),"error")}finally{p(!1)}},className:"space-y-4",children:[(0,_.jsxs)("div",{children:[(0,_.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[u("lifecycle.registrationNumber",{defaultValue:"Registrierungsnummer"})," *"]}),(0,_.jsx)("input",{type:"text",value:x.registrationNumber,onChange:e=>g((0,r.A)((0,r.A)({},x),{},{registrationNumber:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,placeholder:u("lifecycle.registrationNumberPlaceholder",{defaultValue:"z.B. 123456789"})})]}),(0,_.jsxs)("div",{children:[(0,_.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[u("lifecycle.provider",{defaultValue:"Anbieter"})," *"]}),(0,_.jsx)("input",{type:"text",value:x.provider,onChange:e=>g((0,r.A)((0,r.A)({},x),{},{provider:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,placeholder:u("lifecycle.providerPlaceholder",{defaultValue:"z.B. ARL Sura, EPS Sanitas"})})]}),(0,_.jsxs)("div",{children:[(0,_.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[u("lifecycle.registrationDate",{defaultValue:"Anmeldedatum"})," *"]}),(0,_.jsx)("input",{type:"date",value:x.registrationDate,onChange:e=>g((0,r.A)((0,r.A)({},x),{},{registrationDate:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:u("lifecycle.notes",{defaultValue:"Notizen"})}),(0,_.jsx)("textarea",{value:x.notes,onChange:e=>g((0,r.A)((0,r.A)({},x),{},{notes:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:u("lifecycle.notesPlaceholder",{defaultValue:"Zus\xe4tzliche Informationen..."})})]}),(0,_.jsx)("div",{className:"flex justify-end",children:(0,_.jsx)("button",{type:"submit",disabled:h,className:"p-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",title:h?u("common.saving",{defaultValue:"Speichere..."}):u("lifecycle.complete",{defaultValue:"Abschlie\xdfen"}),children:h?(0,_.jsx)(F.A,{className:"h-5 w-5 animate-spin"}):(0,_.jsx)(q.A,{className:"h-5 w-5"})})})]})]})},$=e=>{var t,a;let{isOpen:r,onClose:l,onTaskUpdated:d,task:c}=e;const{t:u}=(0,n.Bd)(),{hasPermission:m}=(0,i.S)(),{user:x}=(0,o.As)(),{openSidepane:g,closeSidepane:h}=(0,W.N)(),[p,b]=(0,s.useState)(window.innerWidth>1070),[y,v]=(0,s.useState)(c.title||""),[f,k]=(0,s.useState)((N=c.description||"")?N.replace(/!\[([^\]]*)\]\([^)]+\)/g,"").trim():"");var N;const j=c.description||"",[A,S]=(0,s.useState)(c.status||"open"),[C,T]=(0,s.useState)(c.roleId?"role":"user"),[E,D]=(0,s.useState)(c.responsibleId||null),[I,R]=(0,s.useState)(c.roleId||null),[L,P]=(0,s.useState)((null===(t=c.qualityControl)||void 0===t?void 0:t.id)||null),[K,G]=(0,s.useState)((null===(a=c.branch)||void 0===a?void 0:a.id)||0),[U,Z]=(0,s.useState)(c.attachments||[]),[$,X]=(0,s.useState)([]),[J,ee]=(0,s.useState)(!1),[te,ae]=(0,s.useState)([]),re=(0,s.useRef)(null),se=(0,s.useRef)(null),[ne,le]=(0,s.useState)((e=>{if(!e)return null;const t=new Date(e);return isNaN(t.getTime())?null:t.toISOString().split("T")[0]})(c.dueDate)),[oe,ie]=(0,s.useState)([]),[de,ce]=(0,s.useState)([]),[ue,me]=(0,s.useState)([]),[xe,ge]=(0,s.useState)(null),[he,pe]=(0,s.useState)(!1),[be,ye]=(0,s.useState)(!1),[ve,fe]=(0,s.useState)(window.innerWidth<640),[ke,Ne]=(0,s.useState)([]),[we,je]=(0,s.useState)("data"),Ae=m("tasks","both","table");(0,s.useEffect)((()=>{const e=()=>{fe(window.innerWidth<640),b(window.innerWidth>1070)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,s.useEffect)((()=>{if(!r&&te.length>0){(async()=>{for(const t of te)try{await z.A.delete(B.Sn.TASKS.ATTACHMENT(c.id,t)),console.log("Task Attachment ".concat(t," gel\xf6scht (Modal ohne Speichern geschlossen)"))}catch(e){console.error("Fehler beim L\xf6schen von Task Attachment ".concat(t,":"),e)}ae([])})()}}),[r,te,c.id]),(0,s.useEffect)((()=>(r?g():h(),()=>{h()})),[r,g,h]),(0,s.useEffect)((()=>{r&&(Se(),Ce(),Te(),Ee(),De())}),[r,c.id]);const Se=async()=>{try{ge(null);if(!localStorage.getItem("token"))return void ge("Nicht authentifiziert");const e=await z.A.get(B.Sn.USERS.DROPDOWN);ie(e.data||[])}catch(a){console.error("Fehler beim Laden der Benutzer:",a);const r=a;var e,t;if("ERR_NETWORK"===r.code)ge(u("tasks.editTask.errors.connectionError"));else ge("".concat(u("tasks.editTask.errors.loadUsersError"),": ").concat((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||r.message))}},Ce=async()=>{try{ge(null);if(!localStorage.getItem("token"))return void ge("Nicht authentifiziert");const e=await z.A.get(B.Sn.ROLES.BASE);ce(e.data||[])}catch(a){console.error("Fehler beim Laden der Rollen:",a);const r=a;var e,t;if("ERR_NETWORK"===r.code)ge(u("tasks.editTask.errors.connectionError"));else ge("".concat(u("tasks.editTask.errors.loadRolesError"),": ").concat((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||r.message))}},Te=async()=>{try{ge(null);if(!localStorage.getItem("token"))return void ge("Nicht authentifiziert");const e=await z.A.get(B.Sn.BRANCHES.BASE);me(e.data||[])}catch(a){console.error("Fehler beim Laden der Niederlassungen:",a);const r=a;var e,t;if("ERR_NETWORK"===r.code)ge(u("tasks.editTask.errors.connectionError"));else ge("".concat(u("tasks.editTask.errors.loadBranchesError"),": ").concat((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||r.message))}},Ee=async()=>{try{ge(null);const e=await z.A.get(B.Sn.TASKS.CARTICLES(c.id));Ne(e.data||[])}catch(a){var e,t;console.error("Fehler beim Laden der verkn\xfcpften Artikel:",a);const r=a;ge((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||r.message||"Ein unerwarteter Fehler ist aufgetreten")}},De=async()=>{try{ge(null);const e=await z.A.get(B.Sn.TASKS.ATTACHMENTS(c.id));Z(e.data||[])}catch(a){var e,t;console.error("Fehler beim Laden der Anh\xe4nge:",a);const r=a;ge((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||r.message||"Ein unerwarteter Fehler ist aufgetreten"),Z([])}},Ie=async e=>{const t=e.clipboardData.items;for(let a=0;a<t.length;a++){const r=t[a];if(0===r.type.indexOf("image")){e.preventDefault();const t=r.getAsFile();return void(t&&await Fe(t))}}},Re=async e=>{if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&e.dataTransfer.files.length>0){const t=e.dataTransfer.files[0];await Fe(t)}},Le=e=>{e.preventDefault(),e.stopPropagation()},Fe=async e=>{ee(!0),ge(null);try{const t=new FormData;t.append("file",e);const a=(await z.A.post(B.Sn.TASKS.ATTACHMENTS(c.id),t,{headers:{"Content-Type":"multipart/form-data"}})).data;if(Z([...U,a]),ae((e=>[...e,a.id])),!a.fileType.startsWith("image/")){const e="\n[".concat(a.fileName,"](").concat((0,B._y)(c.id,a.id),")\n");if(se.current){const t=se.current.selectionStart,a=f.substring(0,t),r=f.substring(t);k(a+e+r),setTimeout((()=>{if(se.current){const a=t+e.length;se.current.selectionStart=a,se.current.selectionEnd=a,se.current.focus()}}),0)}else k(f+e)}}catch(r){var t,a;console.error("Fehler beim Verarbeiten der Datei:",r);const e=r;ge((null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||e.message||"Ein unerwarteter Fehler ist aufgetreten")}finally{ee(!1)}},Pe=async e=>{const t=e.target.files;if(!t||0===t.length)return;const a=t[0];await Fe(a),re.current&&(re.current.value="")},ze=async e=>{e.preventDefault(),ge(null),pe(!0);try{if(!y||!A||!K)return ge(u("tasks.editTask.errors.fillAllFields")),void pe(!1);if("user"===C&&!E)return ge(u("tasks.editTask.form.chooseUser")),void pe(!1);if("role"===C&&!I)return ge(u("tasks.editTask.form.chooseRole")),void pe(!1);let e=f||"";const t=U.filter((e=>{var t;return(null===(t=e.fileType)||void 0===t?void 0:t.startsWith("image/"))&&e.id})),a=/!\[([^\]]*)\]\([^)]+\)/g,r=[];let s;if(j)for(;null!==(s=a.exec(j));)r.push(s[0]);for(const l of t){const t=(0,B._y)(c.id,l.id),a="![".concat(l.fileName,"](").concat(t,")"),r=l.fileName.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");new RegExp("!\\[".concat(r,"\\]\\([^)]+\\)"),"g").test(e)||(e=e?"".concat(e,"\n").concat(a):a)}for(const l of r)e.includes(l)||(e=e?"".concat(e,"\n").concat(l):l);const n={title:y,description:e,status:A,qualityControlId:L,branchId:K,dueDate:ne};"user"===C?(n.responsibleId=E,n.roleId=null):"role"===C&&(n.roleId=I,n.responsibleId=null);const o=await z.A.put("".concat(B.Sn.TASKS.BASE,"/").concat(c.id),n);console.log("Task aktualisiert:",o.data);const i=await z.A.get(B.Sn.TASKS.BY_ID(c.id));i.data.attachments?i.data.attachments=i.data.attachments.map((e=>({id:e.id,fileName:e.fileName,fileType:e.fileType,fileSize:e.fileSize,filePath:e.filePath,uploadedAt:e.uploadedAt,url:(0,B._y)(c.id,e.id)}))):i.data.attachments=[],ae([]),d(i.data),l()}catch(r){var t,a;console.error("Fehler beim Aktualisieren des Tasks:",r);const e=r;ge((null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||e.message||"Ein unerwarteter Fehler ist aufgetreten")}finally{pe(!1)}},Oe=async()=>{if(be)try{if(!localStorage.getItem("token"))return void ge("Nicht authentifiziert");await z.A.delete(B.Sn.TASKS.BY_ID(c.id)),d(void 0),l()}catch(a){var e,t;console.error("Delete Error:",a);const r=a;ge((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||r.message||"Ein unerwarteter Fehler ist aufgetreten")}else ye(!0)},Me=async e=>{try{ge(null),await z.A.post(B.Sn.TASKS.LINK_CARTICLE(c.id,e.id)),Ne((t=>[...t,e]))}catch(r){var t,a;console.error("Fehler beim Verkn\xfcpfen des Artikels:",r);const e=r;ge((null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||e.message||"Ein unerwarteter Fehler ist aufgetreten")}},qe=async e=>{try{ge(null),await z.A.delete(B.Sn.TASKS.UNLINK_CARTICLE(c.id,e)),Ne((t=>t.filter((t=>t.id!==e))))}catch(r){var t,a;console.error("Fehler beim Entfernen der Artikelverkn\xfcpfung:",r);const e=r;ge((null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||e.message||"Ein unerwarteter Fehler ist aufgetreten")}},Be=()=>{var e,t,a,r,s;return(0,_.jsxs)("form",{onSubmit:ze,className:"space-y-4",children:[(0,_.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,_.jsxs)("nav",{className:"-mb-px flex space-x-4","aria-label":"Tabs",children:[(0,_.jsx)("button",{type:"button",className:"".concat("data"===we?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),onClick:()=>je("data"),children:u("tasks.editTask.tabs.data")}),(0,_.jsx)("button",{type:"button",className:"".concat("cerebro"===we?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),onClick:()=>je("cerebro"),children:u("tasks.editTask.tabs.cerebro")})]})}),"data"===we&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:u("tasks.editTask.form.title")}),(0,_.jsx)("input",{type:"text",id:"title",value:y,onChange:e=>v(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{htmlFor:"description_edit",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:u("tasks.editTask.form.description")}),(0,_.jsxs)("div",{className:"relative",children:[(0,_.jsx)("textarea",{ref:se,id:"description_edit",rows:6,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",value:f,onChange:e=>k(e.target.value),onPaste:Ie,onDrop:Re,onDragOver:Le,placeholder:u("tasks.editTask.form.descriptionPlaceholder")}),(0,_.jsxs)("div",{className:"relative group absolute bottom-2 left-2",children:[(0,_.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=re.current)||void 0===e?void 0:e.click()},className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400 focus:outline-none",children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:u("tasks.editTask.form.fileUpload")})]}),(0,_.jsx)("input",{ref:re,type:"file",onChange:Pe,className:"hidden"}),J&&(0,_.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-70 dark:bg-opacity-70",children:(0,_.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:u("tasks.editTask.form.uploading")})})]}),_e(),Ve()]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:u("tasks.editTask.form.status")}),(0,_.jsxs)("select",{id:"status",value:A,onChange:e=>S(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,_.jsx)("option",{value:"open",children:u("tasks.status.open")}),(0,_.jsx)("option",{value:"in_progress",children:u("tasks.status.in_progress")}),(0,_.jsx)("option",{value:"improval",children:u("tasks.status.improval")}),(0,_.jsx)("option",{value:"quality_control",children:u("tasks.status.quality_control")}),(0,_.jsx)("option",{value:"done",children:u("tasks.status.done")})]})]}),(0,_.jsxs)("div",{className:"space-y-2",children:[(0,_.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[u("tasks.editTask.form.responsibleFor")," *"]}),(0,_.jsxs)("div",{className:"flex space-x-4",children:[(0,_.jsxs)("label",{className:"inline-flex items-center",children:[(0,_.jsx)("input",{type:"radio",className:"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600",name:"assigneeType",value:"user",checked:"user"===C,onChange:()=>{T("user"),R(null)}}),(0,_.jsx)("span",{className:"ml-2 dark:text-gray-300",children:u("tasks.editTask.form.user")})]}),(0,_.jsxs)("label",{className:"inline-flex items-center",children:[(0,_.jsx)("input",{type:"radio",className:"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600",name:"assigneeType",value:"role",checked:"role"===C,onChange:()=>{T("role"),D(null)}}),(0,_.jsx)("span",{className:"ml-2 dark:text-gray-300",children:u("tasks.editTask.form.role")})]})]})]}),"user"===C?(0,_.jsxs)("div",{children:[(0,_.jsxs)("label",{htmlFor:"responsible",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[u("tasks.editTask.form.responsibleUser")," *"]}),(0,_.jsxs)("select",{id:"responsible",value:null===E?"":E,onChange:e=>D(e.target.value?Number(e.target.value):null),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:"user"===C,children:[(0,_.jsx)("option",{value:"",children:u("tasks.editTask.form.pleaseSelect")}),Array.isArray(oe)&&oe.map((e=>(0,_.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})]}):(0,_.jsxs)("div",{children:[(0,_.jsxs)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[u("tasks.editTask.form.responsibleRole")," *"]}),(0,_.jsxs)("select",{id:"role",value:null===I?"":I,onChange:e=>R(e.target.value?Number(e.target.value):null),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:"role"===C,children:[(0,_.jsx)("option",{value:"",children:u("tasks.editTask.form.pleaseSelect")}),Array.isArray(de)&&de.map((e=>(0,_.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{htmlFor:"qualityControl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:u("tasks.editTask.form.qualityControl")}),(0,_.jsxs)("select",{id:"qualityControl",value:null===L?"":L,onChange:e=>P(e.target.value?Number(e.target.value):null),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,_.jsx)("option",{value:"",children:u("tasks.editTask.form.noQualityControl")}),Array.isArray(oe)&&oe.map((e=>(0,_.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{htmlFor:"branch",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:u("tasks.editTask.form.branch")}),(0,_.jsxs)("select",{id:"branch",value:0===K?"":K,onChange:e=>G(e.target.value?Number(e.target.value):0),className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[(0,_.jsx)("option",{value:"",children:u("common.pleaseSelect")}),Array.isArray(ue)&&ue.map((e=>(0,_.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{htmlFor:"dueDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:u("tasks.editTask.form.dueDate")}),(0,_.jsx)("input",{type:"date",id:"dueDate",value:ne||"",onChange:e=>{e.target.value?le(e.target.value):le(null)},className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),"cerebro"===we&&(0,_.jsxs)("div",{children:[ke.length>0&&(0,_.jsxs)("div",{className:"mb-4",children:[(0,_.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:u("tasks.editTask.form.linkedCerebroArticles")}),(0,_.jsx)("ul",{className:"space-y-2",children:ke.map((e=>(0,_.jsxs)("li",{className:"flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 rounded",children:[(0,_.jsx)("a",{href:"/cerebro/articles/".concat(e.slug),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline dark:text-blue-400 dark:hover:text-blue-300",children:e.title}),(0,_.jsx)("button",{type:"button",onClick:()=>qe(e.id),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",children:u("tasks.editTask.form.remove")})]},e.id)))})]}),(0,_.jsx)(V,{onArticleSelected:Me,excludeArticleIds:ke.map((e=>e.id)),selectedArticles:ke,onArticleRemove:qe})]}),"data"===we&&((null===(e=c.title)||void 0===e?void 0:e.includes("ARL"))||(null===(t=c.title)||void 0===t?void 0:t.includes("EPS"))||(null===(a=c.title)||void 0===a?void 0:a.includes("Pension"))||(null===(r=c.title)||void 0===r?void 0:r.includes("Caja"))||(null===(s=c.description)||void 0===s?void 0:s.includes("lifecycle")))&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(H,{task:c}),(0,_.jsx)(Q,{task:c}),(0,_.jsx)(Y,{task:c,onComplete:()=>{}})]}),(0,_.jsxs)("div",{className:"flex justify-between pt-4",children:[Ae&&(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{type:"button",onClick:Oe,className:"p-2 rounded-md ".concat(be?"bg-red-600 text-white dark:bg-red-700 dark:text-white hover:bg-red-700 dark:hover:bg-red-600":"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"),children:be?(0,_.jsx)(q.A,{className:"h-5 w-5"}):(0,_.jsx)(w.A,{className:"h-5 w-5"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:u(be?"tasks.editTask.form.confirmDelete":"tasks.editTask.form.delete")})]}),(0,_.jsxs)("div",{className:"flex gap-2",children:[(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{type:"button",onClick:l,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,_.jsx)(M.A,{className:"h-5 w-5"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:u("tasks.editTask.form.cancel")})]}),(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",disabled:he,children:he?(0,_.jsx)(F.A,{className:"h-5 w-5 animate-spin"}):(0,_.jsx)(q.A,{className:"h-5 w-5"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:u(he?"tasks.editTask.form.saving":"tasks.editTask.form.save")})]})]})]})]})},_e=()=>0===U.length?null:(0,_.jsx)("div",{className:"mt-2",children:(0,_.jsx)("ul",{className:"flex flex-wrap gap-2",children:U.map((e=>(0,_.jsxs)("li",{className:"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-md px-2 py-1 relative group",children:[(0,_.jsx)("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-300",children:e.fileName}),(0,_.jsxs)("div",{className:"flex ml-2",children:[(0,_.jsxs)("div",{className:"relative group mr-1",children:[(0,_.jsx)("button",{type:"button",onClick:()=>(async e=>{try{const t=await z.A.get(B.Sn.TASKS.ATTACHMENT(c.id,e.id),{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([t.data])),r=document.createElement("a");r.href=a,r.setAttribute("download",e.fileName),document.body.appendChild(r),r.click(),r.remove()}catch(r){var t,a;console.error("Fehler beim Herunterladen des Anhangs:",r);const e=r;ge((null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||e.message||"Ein unerwarteter Fehler ist aufgetreten")}})(e),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:u("tasks.editTask.form.download")})]}),(0,_.jsxs)("div",{className:"relative group ml-1",children:[(0,_.jsx)("button",{type:"button",onClick:()=>(async e=>{try{ge(null);const t=U.find((t=>t.id===e));if(t&&(await z.A.delete(B.Sn.TASKS.ATTACHMENT(c.id,e)),Z(U.filter((t=>t.id!==e))),t.fileName)){const t=(0,B._y)(c.id,e).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),a=new RegExp("!\\[(.*?)\\]\\(".concat(t,"\\)"),"g"),r=new RegExp("\\[(.*?)\\]\\(".concat(t,"\\)"),"g"),s=f.replace(a,"").replace(r,"").replace(/\n{3,}/g,"\n\n");k(s)}}catch(r){var t,a;console.error("Fehler beim L\xf6schen des Anhangs:",r);const e=r;ge((null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||e.message||"Ein unerwarteter Fehler ist aufgetreten")}})(e.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:u("tasks.editTask.form.remove")})]})]}),e.fileType.startsWith("image/")&&(0,_.jsx)("div",{className:"absolute z-10 bg-white dark:bg-gray-800 p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 dark:border-gray-600 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:(0,_.jsx)("img",{src:(0,B._y)(c.id,e.id),alt:e.fileName,className:"max-w-[200px] max-h-[150px] object-contain"})})]},e.id)))})}),Ve=()=>0===$.length?null:(0,_.jsx)("div",{className:"mt-2",children:(0,_.jsx)("ul",{className:"flex flex-wrap gap-2",children:$.map(((e,t)=>{var a;return(0,_.jsxs)("li",{className:"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-md px-2 py-1 relative group",children:[(0,_.jsx)("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-300",children:e.fileName}),(0,_.jsx)("div",{className:"flex ml-2",children:(0,_.jsxs)("div",{className:"relative group ml-1",children:[(0,_.jsx)("button",{type:"button",onClick:()=>(e=>{const t=$[e];if(t&&(X($.filter(((t,a)=>a!==e))),t.fileName)){const e=t.fileName.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),a=u("tasks.editTask.form.uploadAfterCreate"),r=new RegExp("!\\[".concat(e,"\\]\\(").concat(a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\)"),"g"),s=new RegExp("\\[".concat(e,"\\]\\(").concat(a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\)"),"g"),n=f.replace(r,"").replace(s,"").replace(/\n{3,}/g,"\n\n");k(n)}})(t),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:u("tasks.editTask.form.remove")})]})}),(null===(a=e.fileType)||void 0===a?void 0:a.startsWith("image/"))&&e.file&&(0,_.jsx)("div",{className:"absolute z-10 bg-white dark:bg-gray-800 p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 dark:border-gray-600 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:(0,_.jsx)("img",{src:URL.createObjectURL(e.file),alt:e.fileName,className:"max-w-[200px] max-h-[150px] object-contain"})})]},"temp-".concat(t))}))})});return r?ve?(0,_.jsxs)(O.lG,{open:r,onClose:l,className:"relative z-50",children:[(0,_.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,_.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,_.jsxs)(O.lG.Panel,{className:"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,_.jsx)(O.lG.Title,{className:"text-lg font-semibold dark:text-white",children:u("tasks.editTask.title")}),(0,_.jsx)("button",{onClick:l,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,_.jsx)(M.A,{className:"h-6 w-6"})})]}),(0,_.jsxs)("div",{className:"p-4",children:[xe&&(0,_.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:xe}),Be()]})]})})]}):(0,_.jsxs)(_.Fragment,{children:[r&&!p&&(0,_.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:l,style:{opacity:r?1:0,transition:"opacity 300ms ease-out"}}),(0,_.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(r?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:r?"auto":"none"},"aria-hidden":!r,role:"dialog","aria-modal":r,children:[(0,_.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,_.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:u("tasks.editTask.title")}),(0,_.jsx)("button",{onClick:l,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,_.jsx)(M.A,{className:"h-6 w-6"})})]}),(0,_.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[xe&&(0,_.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:xe}),Be()]})]})]}):null};var X=a(1060),J=a(2069);const ee=e=>{let{isOpen:t,onClose:a,reservation:r,onSuccess:l}=e;const{t:o}=(0,n.Bd)(),{showMessage:i}=(0,Z.A)(),{openSidepane:d,closeSidepane:c}=(0,W.N)(),[u,m]=(0,s.useState)(window.innerWidth<640),[x,g]=(0,s.useState)(window.innerWidth>1070),[h,p]=(0,s.useState)(r.guestPhone||""),[b,y]=(0,s.useState)(r.guestEmail||""),[v,f]=(0,s.useState)(""),[k,N]=(0,s.useState)(!1),[w,j]=(0,s.useState)(null),[A,S]=(0,s.useState)(""),C=()=>{const e=r.amount||0,t=r.currency||"COP";return"Hola {{guestName}},\n\n\xa1Bienvenido a La Familia Hostel!\n\nTu reserva ha sido confirmada.\nCargos: ".concat(e," ").concat(t,"\n\nPuedes realizar el check-in en l\xednea ahora:\n{{checkInLink}}\n\nPor favor, realiza el pago:\n{{paymentLink}}\n\n\xa1Te esperamos!")};(0,s.useEffect)((()=>{t&&!v&&f(C())}),[t,r]),(0,s.useEffect)((()=>{if(v){const e=b||r.guestEmail||"";let t="[Check-in-Link wird generiert]";if(e){const a=r.id.toString(),s="https://app.lobbypms.com/checkinonline/confirmar",n=new URLSearchParams;n.append("codigo",a),n.append("email",e),n.append("lg","GB"),t="".concat(s,"?").concat(n.toString())}const a=r.paymentLink||"[Zahlungslink wird erstellt]";let s=v.replace(/\{\{guestName\}\}/g,r.guestName).replace(/\{\{checkInLink\}\}/g,t).replace(/\{\{paymentLink\}\}/g,a);S(s)}}),[v,r.guestName,r.paymentLink,r.id,r.guestEmail,b]),(0,s.useEffect)((()=>{const e=()=>{m(window.innerWidth<640),g(window.innerWidth>1070)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}}),[]),(0,s.useEffect)((()=>(t&&!u?d():c(),()=>{c()})),[t,u,d,c]),(0,s.useEffect)((()=>{t||(p(r.guestPhone||""),y(r.guestEmail||""),f(""),j(null),S(""))}),[t,r]);const T=()=>{j(null),a()},E=async e=>{if(e.preventDefault(),j(null),h||b)try{N(!0),await J.u.sendInvitation(r.id,{guestPhone:h||void 0,guestEmail:b||void 0,customMessage:v||void 0}),i(o("reservations.sendInvitation.success","Einladung erfolgreich versendet"),"success"),l(),T()}catch(s){var t,a;console.error("Fehler beim Versenden der Einladung:",s);const e=(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||o("reservations.sendInvitation.error","Fehler beim Versenden der Einladung");j(e),i(e,"error")}finally{N(!1)}else j(o("reservations.sendInvitation.noContact","Bitte geben Sie mindestens eine Telefonnummer oder E-Mail-Adresse an."))},D=r.sentMessageAt;return u?(0,_.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto ".concat(t?"":"hidden"),"aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:(0,_.jsxs)("div",{className:"flex min-h-screen items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[(0,_.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:T}),(0,_.jsxs)("div",{className:"relative transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,_.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:o("reservations.sendInvitation.title","Einladung senden")}),(0,_.jsx)("button",{onClick:T,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,_.jsx)(M.A,{className:"h-6 w-6"})})]}),(0,_.jsx)("div",{className:"p-4 overflow-y-auto max-h-[calc(100vh-200px)]",children:I()})]})]})}):(0,_.jsxs)(_.Fragment,{children:[t&&!x&&(0,_.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,_.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,_.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,_.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:o("reservations.sendInvitation.title","Einladung senden")}),(0,_.jsx)("button",{onClick:T,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,_.jsx)(M.A,{className:"h-6 w-6"})})]}),(0,_.jsx)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:I()})]})]});function I(){return(0,_.jsxs)(_.Fragment,{children:[w&&(0,_.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded",children:w}),D&&(0,_.jsxs)("div",{className:"mb-4 p-3 bg-yellow-100 dark:bg-yellow-900 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-200 rounded",children:[(0,_.jsxs)("p",{className:"text-sm",children:[o("reservations.sendInvitation.alreadySent","Bereits versendet am"),": ",new Date(r.sentMessageAt).toLocaleString()]}),(0,_.jsx)("p",{className:"text-xs mt-1",children:o("reservations.sendInvitation.canResend","Sie k\xf6nnen die Einladung erneut senden.")})]}),(0,_.jsxs)("form",{onSubmit:E,className:"space-y-4",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:o("reservations.sendInvitation.contactInfo","Kontaktinformationen")}),(0,_.jsxs)("div",{className:"space-y-3",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{htmlFor:"guestPhone",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:o("reservations.phone","Telefonnummer")}),(0,_.jsx)("input",{type:"tel",id:"guestPhone",value:h,onChange:e=>p(e.target.value),placeholder:"+573001234567",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white"})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{htmlFor:"guestEmail",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:o("reservations.email","E-Mail")}),(0,_.jsx)("input",{type:"email",id:"guestEmail",value:b,onChange:e=>y(e.target.value),placeholder:"email@example.com",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white"})]})]})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:o("reservations.sendInvitation.message","Nachricht")}),(0,_.jsxs)("div",{className:"space-y-3",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{htmlFor:"customMessage",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:o("reservations.sendInvitation.messageLabel","Nachricht (editierbar)")}),(0,_.jsx)("textarea",{id:"customMessage",value:v,onChange:e=>f(e.target.value),rows:10,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white font-mono text-xs",placeholder:C()}),(0,_.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:o("reservations.sendInvitation.messageVariables","Verf\xfcgbare Variablen: {{guestName}}, {{checkInLink}}, {{paymentLink}}")})]}),A&&(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:o("reservations.sendInvitation.preview","Vorschau")}),(0,_.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-md text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:A})]})]})]}),(0,_.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t dark:border-gray-700",children:[(0,_.jsx)("button",{type:"button",onClick:T,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:o("common.cancel","Abbrechen")}),(0,_.jsx)("button",{type:"submit",disabled:k||!h&&!b,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:k?o("reservations.sendInvitation.sending","Wird gesendet..."):o("reservations.sendInvitation.send","Senden")})]})]})]})}};var te=a(1726),ae=a(9399),re=a(8526),se=a(7460),ne=a(7952),le=a(2395),oe=a(8658);const ie=()=>{const{t:e}=(0,n.Bd)(),[t,a]=(0,s.useState)(!1),[r,l]=(0,s.useState)(null),[i,d]=(0,s.useState)("00:00:00"),[c,u]=(0,s.useState)(null),[m,x]=(0,s.useState)(!0),[g,h]=(0,s.useState)(!1),[p,b]=(0,s.useState)(null),{user:y}=(0,o.As)(),{updateTrackingStatus:v}=(0,se.S)(),{branches:f,selectedBranch:k,setSelectedBranch:N}=(0,ne.O)(),{organization:w}=(0,le.Z)(),j=(0,s.useMemo)((()=>!(!c||!w)&&((null!==c.organizationId||void 0!==w.id)&&c.organizationId!==w.id)),[c,w]),A=(0,s.useCallback)((async()=>{try{x(!0),b(null),console.log("Pr\xfcfe aktive Zeiterfassung..."),console.log("Benutzer geladen:",null===y||void 0===y?void 0:y.id);const n=localStorage.getItem("token");if(console.log("Token vorhanden:",n?"Ja":"Nein"),!n)return console.error("Kein Authentifizierungstoken gefunden"),b(e("worktime.tracker.notAuthenticated")),void x(!1);try{const e=await z.A.get(B.Sn.WORKTIME.ACTIVE);console.log("API-Antwort Status:",e.status);const t=e.data;if(console.log("Aktive Zeiterfassung Daten:",t),t&&!0===t.active){console.log("Aktive Zeiterfassung gefunden:",t.id);const e=t.startTime.endsWith("Z")?t.startTime.substring(0,t.startTime.length-1):t.startTime,r=new Date(e),s=(new Date).getTime()-r.getTime(),n=Math.floor(s/1e3),o=Math.floor(n/3600),i=Math.floor(n%3600/60),c=n%60;u(t),l(r),d("".concat(o.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"),":").concat(c.toString().padStart(2,"0"))),a(!0),k!==t.branchId&&N(t.branchId),v(!0)}else console.log("Keine aktive Zeiterfassung vorhanden"),a(!1),u(null),l(null),d("00:00:00"),v(!1)}catch(s){console.error("Fehler beim Abrufen der aktiven Zeiterfassung:",s);const a=s;var t,r;if("ERR_NETWORK"===a.code)b(e("worktime.tracker.connectionError"));else b("".concat(e("worktime.tracker.errorFetch"),": ").concat((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||a.message))}}finally{x(!1)}}),[null===y||void 0===y?void 0:y.id,v,k,w]);(0,s.useEffect)((()=>{y?(console.log("Benutzer geladen, pr\xfcfe aktive Zeiterfassung f\xfcr Benutzer-ID:",y.id),A()):(console.log("Warte auf Benutzer-Daten vor dem Pr\xfcfen der Zeiterfassung..."),x(!1))}),[y,A]),(0,s.useEffect)((()=>{let e;return t&&r&&(e=window.setInterval((()=>{const e=(new Date).getTime()-r.getTime(),t=Math.floor(e/1e3),a=Math.floor(t/3600),s=Math.floor(t%3600/60),n=t%60;d("".concat(a.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0")))}),1e3)),()=>{e&&clearInterval(e)}}),[t,r]);const S=async()=>{if(k)try{const t=localStorage.getItem("token");if(!t)return console.error("Kein Authentifizierungstoken gefunden"),void alert(e("worktime.tracker.notAuthenticatedMessage"));const r=(await z.A.post(B.Sn.WORKTIME.START,{branchId:k,startTime:new Date((new Date).getTime()-6e4*(new Date).getTimezoneOffset())},{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}})).data,s=r.startTime.endsWith("Z")?r.startTime.substring(0,r.startTime.length-1):r.startTime,n=new Date(s);u(r),l(n),d("00:00:00"),a(!0),v(!0)}catch(r){console.error("Fehler:",r);let a=e("worktime.tracker.errorStart");var t;if(r.response)a=(null===(t=r.response.data)||void 0===t?void 0:t.message)||"Fehler (Status: ".concat(r.response.status,")");alert(a)}else alert(e("worktime.tracker.selectBranch"))},C=async()=>{try{const t=localStorage.getItem("token");if(!t)return console.error("Kein Authentifizierungstoken gefunden"),void alert(e("worktime.tracker.notAuthenticatedMessage"));await z.A.post(B.Sn.WORKTIME.STOP,{endTime:new Date((new Date).getTime()-6e4*(new Date).getTimezoneOffset())},{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});a(!1),u(null),l(null),d("00:00:00"),v(!1)}catch(r){console.error("Fehler:",r);let a=e("worktime.tracker.errorStop");var t;if(r.response)a=(null===(t=r.response.data)||void 0===t?void 0:t.message)||"Fehler (Status: ".concat(r.response.status,")");alert(a)}},T=(0,s.useMemo)((()=>{var t;return c?(null===(t=f.find((e=>e.id===c.branchId)))||void 0===t?void 0:t.name)||e("worktime.tracker.unknown"):null}),[f,c]);return m?(0,_.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-6",children:(0,_.jsx)("div",{className:"flex justify-center items-center h-32",children:(0,_.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-gray-300"})})}):(0,_.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 sm:mb-6",children:[(0,_.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,_.jsxs)("h2",{className:"text-xl font-semibold flex items-center dark:text-white",children:[(0,_.jsx)(R.A,{className:"h-6 w-6 mr-2"}),e("worktime.tracker.title")]})}),p&&(0,_.jsxs)("div",{className:"mb-4 p-2 bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-300 border border-red-200 dark:border-red-700 rounded-md flex justify-between items-center",children:[(0,_.jsx)("span",{children:p}),p!==e("worktime.tracker.noActiveTracking")&&(0,_.jsxs)("button",{onClick:async()=>{if(window.confirm(e("worktime.tracker.forceStopConfirm")))try{const t=localStorage.getItem("token");if(!t)return console.error("Kein Authentifizierungstoken gefunden"),void alert(e("worktime.tracker.notAuthenticatedMessage"));await z.A.post(B.Sn.WORKTIME.STOP,{endTime:new Date((new Date).getTime()-6e4*(new Date).getTimezoneOffset()),force:!0},{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});a(!1),l(null),d("00:00:00"),u(null),b(null),alert(e("worktime.tracker.forceStopSuccess")),v(!1)}catch(r){var t;console.error("Fehler:",r),b("Fehler beim Stoppen: ".concat((null===(t=r.response)||void 0===t?void 0:t.status)||"Netzwerkfehler")),alert(e("worktime.tracker.forceStopError"))}},className:"text-sm bg-red-100 hover:bg-red-200 text-red-700 dark:bg-red-800 dark:hover:bg-red-700 dark:text-red-300 px-2 py-1 rounded-md",children:[e("worktime.tracker.stop")," ",e("common.force","Erzwingen")]})]}),t&&j&&(0,_.jsxs)("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200 border border-yellow-200 dark:border-yellow-700 rounded-md flex items-start",children:[(0,_.jsx)(ae.A,{className:"h-5 w-5 mr-2 mt-0.5 flex-shrink-0"}),(0,_.jsxs)("div",{className:"flex-1",children:[(0,_.jsx)("p",{className:"font-medium",children:e("worktime.tracker.differentOrganizationWarning.title","Hinweis: Andere Organisation")}),(0,_.jsx)("p",{className:"text-sm mt-1",children:e("worktime.tracker.differentOrganizationWarning.message","Diese Zeiterfassung wurde in einer anderen Organisation gestartet. Sie wird nach dem Stoppen der Organisation zugeordnet, in der sie gestartet wurde.")})]})]}),(0,_.jsxs)("div",{className:"flex items-start justify-center mb-4",children:[(0,_.jsxs)("div",{className:"flex flex-col items-center",children:[(0,_.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,_.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:t,onChange:async()=>{t?await C():await S()},disabled:!k&&!t,"data-onboarding":t?"stop-worktime":"start-worktime"}),(0,_.jsx)("div",{className:"w-20 h-10 rounded-full \n                            ".concat(t?"bg-green-500 shadow-lg shadow-green-200 dark:shadow-green-900/20":"bg-gray-300 dark:bg-gray-600","\n                            before:content-[''] before:absolute before:top-0 before:left-0 before:bottom-0 before:right-0 \n                            peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-700\n                            peer-checked:after:translate-x-10\n                            after:content-[''] after:absolute after:top-1 after:left-1\n                            after:bg-white dark:after:bg-gray-200 after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full\n                            after:h-8 after:w-8 after:transition-all after:duration-300 ease-in-out\n                            transition-colors duration-300")})]}),(0,_.jsx)("span",{className:"mt-2 text-sm font-medium",children:t?(0,_.jsx)("span",{className:"text-green-600 dark:text-green-400 font-bold",children:e("worktime.tracker.running")}):(0,_.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:e("worktime.tracker.start")})})]}),(0,_.jsx)("button",{onClick:()=>{h(!0)},className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-2 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-blue-700 shadow-sm flex items-center justify-center ml-8 mt-1",title:e("worktime.tracker.showTimes"),children:(0,_.jsx)(re.A,{className:"h-6 w-6"})})]}),(0,_.jsx)("div",{className:"p-2 my-2 rounded-md text-sm ".concat(t&&c?"bg-green-50 dark:bg-green-900/20 dark:text-green-200":"bg-gray-50 dark:bg-gray-700 dark:text-gray-300"),children:t&&c?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("p",{children:[(0,_.jsx)("strong",{children:e("worktime.tracker.activeTracking")})," ",i]}),(0,_.jsxs)("p",{children:[(0,_.jsx)("strong",{children:e("worktime.tracker.started")})," ",(e=>{"string"===typeof e&&e.endsWith("Z")&&(e=e.substring(0,e.length-1));const t=new Date(e),a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getFullYear(),n=t.getHours().toString().padStart(2,"0"),l=t.getMinutes().toString().padStart(2,"0"),o=t.getSeconds().toString().padStart(2,"0");return"".concat(a,".").concat(r,".").concat(s,", ").concat(n,":").concat(l,":").concat(o)})(r||Date.now())]}),(0,_.jsxs)("p",{children:[(0,_.jsxs)("strong",{children:[e("worktime.tracker.selectBranchLabel"),":"]})," ",T||e("worktime.tracker.unknown")]})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("p",{children:"\xa0"}),(0,_.jsx)("p",{children:"\xa0"}),(0,_.jsx)("p",{children:"\xa0"})]})}),g&&(0,_.jsx)(oe.G,{isOpen:g,onClose:()=>{h(!1)}})]})};var de=a(4426),ce=a(7829),ue=a(6400),me=a(7488),xe=a(6896),ge=a(1052),he=a(1853),pe=a(957),be=a(637),ye=a(9837),ve=a(887);const fe=["title","responsibleAndQualityControl","status","dueDate","branch","actions"],ke="worktracker-todos",Ne="worktracker-reservations",we={title:["title"],status:["status"],responsibleAndQualityControl:["responsible","qualityControl"],branch:["branch"],dueDate:["dueDate"],actions:[],description:["description"]},je={title:"title",status:"status",responsible:"responsibleAndQualityControl",qualityControl:"responsibleAndQualityControl",branch:"branch",dueDate:"dueDate",description:"description"},Ae=()=>{const{t:e}=(0,n.Bd)(),{user:t}=(0,o.As)(),{hasPermission:a,permissions:O}=(0,i.S)(),M=(0,l.zy)(),q=(0,l.Zp)(),{showMessage:V}=(0,Z.A)(),W=(0,s.useMemo)((()=>[{id:"title",label:e("tasks.columns.title"),shortLabel:e("tasks.columns.title")},{id:"status",label:e("tasks.columns.status"),shortLabel:e("tasks.columns.status")},{id:"responsibleAndQualityControl",label:e("tasks.columns.responsibleAndQualityControl"),shortLabel:e("tasks.columns.responsibleAndQualityControl").split("/")[0]},{id:"branch",label:e("tasks.columns.branch"),shortLabel:e("tasks.columns.branch").substring(0,5)},{id:"dueDate",label:e("tasks.columns.dueDate"),shortLabel:e("tasks.columns.dueDate").substring(0,5)},{id:"actions",label:e("tasks.columns.actions"),shortLabel:e("common.actions").substring(0,3)}]),[e]),K=(0,s.useMemo)((()=>[{id:"responsible",label:e("tasks.columns.responsible"),shortLabel:e("tasks.columns.responsible").substring(0,3)},{id:"qualityControl",label:e("tasks.columns.qualityControl"),shortLabel:e("tasks.columns.qualityControl").substring(0,2)}]),[e]),U=(0,s.useMemo)((()=>[{id:"guestName",label:e("reservations.columns.guestName","Gast"),shortLabel:e("reservations.columns.guestName","Gast").substring(0,4)},{id:"status",label:e("reservations.columns.status","Status"),shortLabel:e("reservations.columns.status","Status").substring(0,3)},{id:"paymentStatus",label:e("reservations.columns.paymentStatus","Zahlungsstatus"),shortLabel:e("reservations.columns.paymentStatus","Zahlungsstatus").substring(0,3)},{id:"checkInDate",label:e("reservations.columns.checkInDate","Check-in"),shortLabel:e("reservations.columns.checkInDate","Check-in").substring(0,5)},{id:"checkOutDate",label:e("reservations.columns.checkOutDate","Check-out"),shortLabel:e("reservations.columns.checkOutDate","Check-out").substring(0,5)},{id:"roomNumber",label:e("reservations.columns.roomNumber","Zimmer"),shortLabel:e("reservations.columns.roomNumber","Zimmer").substring(0,3)},{id:"guestEmail",label:e("reservations.columns.guestEmail","E-Mail"),shortLabel:e("reservations.columns.guestEmail","E-Mail").substring(0,3)},{id:"guestPhone",label:e("reservations.columns.guestPhone","Telefon"),shortLabel:e("reservations.columns.guestPhone","Telefon").substring(0,3)},{id:"amount",label:e("reservations.columns.amount","Betrag"),shortLabel:e("reservations.columns.amount","Betrag").substring(0,3)},{id:"arrivalTime",label:e("reservations.columns.arrivalTime","Ankunftszeit"),shortLabel:e("reservations.columns.arrivalTime","Ankunftszeit").substring(0,3)},{id:"actions",label:e("reservations.columns.actions","Aktionen"),shortLabel:e("common.actions").substring(0,3)}]),[e]),[H,Q]=((0,s.useMemo)((()=>[{id:"onlineCheckInCompleted",label:e("reservations.columns.onlineCheckInCompleted","Online Check-in"),shortLabel:e("reservations.columns.onlineCheckInCompleted","Online Check-in").substring(0,3)},{id:"doorPin",label:e("reservations.columns.doorPin","T\xfcr-PIN"),shortLabel:e("reservations.columns.doorPin","T\xfcr-PIN").substring(0,3)}]),[e]),(0,s.useState)("todos")),[Y,ae]=(0,s.useState)([]),[re,se]=(0,s.useState)(!0),[ne,le]=(0,s.useState)(null),[oe,Ae]=(0,s.useState)(""),[Se,Ce]=(0,s.useState)("all"),[Te,Ee]=(0,s.useState)([]),[De,Ie]=(0,s.useState)(!1),[Re,Le]=(0,s.useState)(null),[Fe,Pe]=(0,s.useState)(""),[ze,Oe]=(0,s.useState)("all"),[Me,qe]=(0,s.useState)("all"),[Be,_e]=(0,s.useState)(!1),[Ve,We]=(0,s.useState)(!1),[Ke,Ge]=(0,s.useState)(null),[Ue,Ze]=(0,s.useState)(null),[He,Qe]=(0,s.useState)(!1),[Ye,$e]=(0,s.useState)([]),[Xe,Je]=(0,s.useState)([]),[et,tt]=(0,s.useState)([]),[at,rt]=(0,s.useState)(""),[st,nt]=(0,s.useState)(null),[lt,ot]=(0,s.useState)([]),[it,dt]=(0,s.useState)([]),[ct,ut]=(0,s.useState)([]),[mt,xt]=(0,s.useState)(""),[gt,ht]=(0,s.useState)(null),[pt,bt]=(0,s.useState)(!1),[yt,vt]=(0,s.useState)({key:"dueDate",direction:"asc"}),[ft,kt]=(0,s.useState)(!1),[Nt,wt]=(0,s.useState)(!1),[jt,At]=(0,s.useState)(null),[St,Ct]=(0,s.useState)(null),{settings:Tt,isLoading:Et,updateColumnOrder:Dt,updateHiddenColumns:It,toggleColumnVisibility:Rt,isColumnVisible:Lt,updateViewMode:Ft}=(0,d.F)("worktracker_tasks",{defaultColumnOrder:fe,defaultHiddenColumns:[],defaultViewMode:"cards"}),Pt=["guestName","status","paymentStatus","checkInDate","checkOutDate","roomNumber","actions"],{settings:zt,isLoading:Ot,updateColumnOrder:Mt,updateHiddenColumns:qt,toggleColumnVisibility:Bt,isColumnVisible:_t,updateViewMode:Vt}=(0,d.F)("worktracker-reservations",{defaultColumnOrder:Pt,defaultHiddenColumns:[],defaultViewMode:"cards"}),Wt="todos"===H?Tt:zt,Kt="todos"===H?Dt:Mt,Gt="todos"===H?Rt:Bt,Ut="todos"===H?Lt:_t,Zt="todos"===H?Ft:Vt,[Ht,Qt]=(0,s.useState)(null),[Yt,$t]=(0,s.useState)(null),[Xt,Jt]=(0,s.useState)(10),ea=Wt.viewMode||"cards",ta=(0,s.useMemo)((()=>(e=>{const t=[];return e.forEach((e=>{const a=we[e];a&&a.length>0&&t.push(...a)})),t.includes("description")||t.push("description"),t})(Wt.columnOrder||fe)),[Wt.columnOrder]),aa=(0,s.useMemo)((()=>(e=>{const t=new Set;return e.forEach((e=>{(we[e]||[]).forEach((e=>t.add(e)))})),t})(Wt.hiddenColumns||[])),[Wt.hiddenColumns]),ra=(0,s.useMemo)((()=>new Set(ta.filter((e=>!aa.has(e))))),[ta,aa]);(0,s.useEffect)((()=>{document.querySelectorAll(".dashboard-tasks-wrapper").forEach((e=>{"cards"===ea?e.classList.add("cards-mode"):e.classList.remove("cards-mode")}))}),[ea]);const sa=(0,s.useRef)(!1),na=async()=>{try{se(!0);const e=await z.A.get(B.Sn.TASKS.BASE),t=e.data.filter((e=>null!=e)).map((e=>{const t=(e.attachments||[]).filter((e=>null!=e)).map((t=>({id:t.id,fileName:t.fileName,fileType:t.fileType,fileSize:t.fileSize,filePath:t.filePath,uploadedAt:t.uploadedAt,url:(0,B._y)(e.id,t.id)})));return(0,r.A)((0,r.A)({},e),{},{attachments:t})}));console.log("\ud83d\udccb Tasks geladen:",t.length,"Tasks"),ae(t),le(null)}catch(ne){console.error("Fehler beim Laden der Tasks:",ne),le(e("worktime.messages.tasksLoadError"))}finally{se(!1)}},la=async t=>{try{Ge(t),await J.u.generatePinAndSend(t),V(e("reservations.pinGeneratedAndSent","PIN-Code generiert und Mitteilung versendet"),"success"),await oa()}catch(ne){var a,r;console.error("Fehler beim Generieren des PIN-Codes und Versenden der Mitteilung:",ne),V((null===(a=ne.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||e("reservations.pinGenerateError","Fehler beim Generieren des PIN-Codes und Versenden der Mitteilung"),"error")}finally{Ge(null)}},oa=async()=>{try{var t;Ie(!0),Le(null);const e=await z.A.get(B.Sn.RESERVATION.BASE),a=(null===(t=e.data)||void 0===t?void 0:t.data)||e.data||[];console.log("\ud83d\udccb Reservations geladen:",a.length,"Reservations"),Ee(a)}catch(s){var a,r;console.error("Fehler beim Laden der Reservations:",s);const t=(null===(a=s.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||e("reservations.loadError","Fehler beim Laden der Reservations");Le(t),V(t,"error")}finally{Ie(!1)}};(0,s.useEffect)((()=>{"reservations"===H&&a("reservations","read","table")&&oa()}),[H]),(0,s.useEffect)((()=>{sa.current||(sa.current=!0,na())}),[]),(0,s.useEffect)((()=>{if(Y.length>0){const e=new URLSearchParams(M.search).get("editTask");if(e){const t=parseInt(e,10);if(!isNaN(t)){const e=Y.find((e=>e.id===t));e&&(At(e),wt(!0))}}}}),[Y,M.search]),(0,s.useEffect)((()=>{(async()=>{try{const t=await z.A.get(B.Sn.SAVED_FILTERS.BY_TABLE(ke)),a=t.data.find((e=>"Aktuell"===e.name));if(a){xt(e("tasks.filters.current")),ht(a.id);let t=a.sortDirections||[];Array.isArray(t)&&t.length>0||t&&"object"===typeof t&&!Array.isArray(t)&&(t=Object.entries(t).map(((e,t)=>{let[a,r]=e;return{column:a,direction:r,priority:t+1,conditionIndex:lt.findIndex((e=>e.column===a))}}))),ga(a.conditions,a.operators,t)}}catch(ne){console.error("Fehler beim Setzen des initialen Filters:",ne)}})()}),[]),(0,s.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token");if(!e)return void console.error("Nicht authentifiziert");const t=(await z.A.get("".concat(B.Sn.SAVED_FILTERS.BY_TABLE(ke)),{headers:{Authorization:"Bearer ".concat(e)}})).data||[],a=t.some((e=>"Archiv"===e.name)),r=t.some((e=>"Aktuell"===e.name));if(!a){const t={tableId:ke,name:"Archiv",conditions:[{column:"status",operator:"equals",value:"done"}],operators:[]};await z.A.post("".concat(B.Sn.SAVED_FILTERS.BASE),t,{headers:{Authorization:"Bearer ".concat(e)}})}if(!r){const t={tableId:ke,name:"Aktuell",conditions:[{column:"status",operator:"notEquals",value:"done"}],operators:[]};await z.A.post("".concat(B.Sn.SAVED_FILTERS.BASE),t,{headers:{Authorization:"Bearer ".concat(e)}})}}catch(ne){console.error("Fehler beim Erstellen der Standard-Filter:",ne)}})()}),[]);const ia=async(t,a)=>{try{ae((e=>e.filter((e=>null!=e)).map((e=>e.id===t?(0,r.A)((0,r.A)({},e),{},{status:a}):e)))),await z.A.patch(B.Sn.TASKS.BY_ID(t),{status:a}),me.oR.success(e("worktime.messages.taskUpdated"))}catch(ne){console.error("Fehler beim Aktualisieren des Status:",ne),na(),me.oR.error(e("worktime.messages.taskUpdatedError"))}},da=e=>{return e.responsible?e.responsible.id===(null===t||void 0===t?void 0:t.id):e.role&&(null===t||void 0===t||null===(a=t.roles)||void 0===a?void 0:a.some((t=>{var a,r;return(null===(a=t.role)||void 0===a?void 0:a.id)===(null===(r=e.role)||void 0===r?void 0:r.id)})))||!1;var a},ca=e=>{var a;return(null===(a=e.qualityControl)||void 0===a?void 0:a.id)===(null===t||void 0===t?void 0:t.id)},ua=e=>{"table"===ea&&vt((t=>({key:e,direction:t.key===e&&"asc"===t.direction?"desc":"asc"})))},ma=t=>{const r=[];return a("tasks","write","table")?("in_progress"===t.status&&da(t)?r.push((0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>ia(t.id,"open"),className:"p-1.5 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600",children:(0,_.jsx)(u.A,{className:"h-5 w-5"})},"back"),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.actions.backToOpen")})]})):"quality_control"===t.status&&da(t)?r.push((0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>ia(t.id,"in_progress"),className:"p-1.5 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600",children:(0,_.jsx)(u.A,{className:"h-5 w-5"})},"back"),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.actions.backToInProgress")})]})):"done"===t.status&&ca(t)&&r.push((0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>ia(t.id,"quality_control"),className:"p-2 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600",children:(0,_.jsx)(u.A,{className:"h-6 w-6"})},"back"),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.actions.backToQualityControl")})]})),"open"===t.status&&da(t)?r.push((0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>ia(t.id,"in_progress"),className:"p-1.5 bg-blue-600 dark:bg-blue-500 text-white rounded hover:bg-blue-700 dark:hover:bg-blue-600",children:(0,_.jsx)(m.A,{className:"h-5 w-5"})},"forward"),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.actions.setInProgress")})]})):"in_progress"===t.status&&da(t)?r.push((0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>ia(t.id,"quality_control"),className:"p-1.5 bg-purple-600 dark:bg-purple-500 text-white rounded hover:bg-purple-700 dark:hover:bg-purple-600",children:(0,_.jsx)(m.A,{className:"h-5 w-5"})},"forward"),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.actions.setQualityControl")})]})):"quality_control"===t.status&&ca(t)&&r.push((0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>ia(t.id,"done"),className:"p-1.5 bg-green-600 dark:bg-green-500 text-white rounded hover:bg-green-700 dark:hover:bg-green-600",children:(0,_.jsx)(m.A,{className:"h-5 w-5"})},"forward"),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.actions.markDone")})]})),r):r},xa=()=>lt.length,ga=(e,t,a)=>{if(ot(e),dt(t),void 0!==a){const e=Array.isArray(a)?a:[];ut(e)}},ha=()=>{ot([]),dt([]),ut([]),xt(""),ht(null)},pa=(e,t,a)=>{if($e(e),Je(t),void 0!==a){const e=Array.isArray(a)?a:[];tt(e)}},ba=()=>{$e([]),Je([]),tt([]),rt(""),nt(null)},ya=(e,t,a,r,s)=>{"todos"===H?(xt(e),ht(t),ga(a,r,s)):(rt(e),nt(t),pa(a,r,s))},va=e=>{switch(e){case"open":return 1;case"in_progress":return 2;case"improval":return 3;case"quality_control":return 4;case"done":return 5;default:return 99}},fa=e=>{switch(e){case te.X.CONFIRMED:return"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200";case te.X.NOTIFICATION_SENT:return"bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200";case te.X.CHECKED_IN:return"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200";case te.X.CHECKED_OUT:return"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200";case te.X.CANCELLED:return"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200";case te.X.NO_SHOW:return"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200";default:return"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}},ka=e=>{switch(e){case te.d.PAID:return"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200";case te.d.PARTIALLY_PAID:return"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200";case te.d.REFUNDED:return"bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200";case te.d.PENDING:default:return"bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200"}},Na=(0,s.useMemo)((()=>{console.log("\ud83d\udd04 Filtere Tasks:",Y.length,"Tasks vorhanden"),console.log("\ud83d\udd04 Filterbedingungen:",lt);const e=Y.filter((e=>null!=e)).filter((e=>{if(oe){const t=oe.toLowerCase();if(!(e.title.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)||!!e.responsible&&"".concat(e.responsible.firstName," ").concat(e.responsible.lastName).toLowerCase().includes(t)||!!e.role&&e.role.name.toLowerCase().includes(t)||e.qualityControl&&"".concat(e.qualityControl.firstName," ").concat(e.qualityControl.lastName).toLowerCase().includes(t)||e.branch.name.toLowerCase().includes(t)))return!1}if(lt.length>0){const t={title:(e,t)=>{const a=(t.value||"").toLowerCase(),r=e.title.toLowerCase();return"equals"===t.operator?e.title===t.value:"contains"===t.operator?r.includes(a):"startsWith"===t.operator?r.startsWith(a):"endsWith"===t.operator?r.endsWith(a):null},status:(e,t)=>"equals"===t.operator?e.status===t.value:"notEquals"===t.operator?e.status!==t.value:null,responsible:(e,t)=>{var a,r;const s=e.responsible?"".concat(e.responsible.firstName," ").concat(e.responsible.lastName):e.role?e.role.name:"";return(0,ue.Ac)((null===(a=e.responsible)||void 0===a?void 0:a.id)||null,(null===(r=e.role)||void 0===r?void 0:r.id)||null,t,s)},qualityControl:(e,t)=>{var a;const r=e.qualityControl?"".concat(e.qualityControl.firstName," ").concat(e.qualityControl.lastName):"";return(0,ue.Ac)((null===(a=e.qualityControl)||void 0===a?void 0:a.id)||null,null,t,r)},responsibleAndQualityControl:(e,t)=>{var a,r,s;const n=e.responsible?"".concat(e.responsible.firstName," ").concat(e.responsible.lastName):e.role?e.role.name:"",l=e.qualityControl?"".concat(e.qualityControl.firstName," ").concat(e.qualityControl.lastName):"";return(0,ue.hw)((null===(a=e.responsible)||void 0===a?void 0:a.id)||null,(null===(r=e.role)||void 0===r?void 0:r.id)||null,(null===(s=e.qualityControl)||void 0===s?void 0:s.id)||null,t,n,l)},branch:(e,t)=>{const a=e.branch.name.toLowerCase(),r=(t.value||"").toLowerCase();return"equals"===t.operator?a===r:"contains"===t.operator?a.includes(r):null},dueDate:(e,t)=>(0,ue.J1)(e.dueDate,t)},a=(e,t)=>{switch(t){case"title":return e.title;case"status":return e.status;case"responsible":case"responsibleAndQualityControl":return e.responsible?"".concat(e.responsible.firstName," ").concat(e.responsible.lastName):e.role?e.role.name:"";case"qualityControl":return e.qualityControl?"".concat(e.qualityControl.firstName," ").concat(e.qualityControl.lastName):"";case"branch":return e.branch.name;case"dueDate":return e.dueDate;default:return e[t]}};if(0===(0,ue.W5)([e],lt,it,a,t).length)return!1}return!0}));console.log("\u2705 Gefilterte Tasks:",e.length,"von",Y.length);const t=(e,t)=>{switch(t){case"title":return e.title.toLowerCase();case"status":return va(e.status);case"responsible":case"responsibleAndQualityControl":return e.responsible?"".concat(e.responsible.firstName," ").concat(e.responsible.lastName).toLowerCase():e.role?"Rolle: ".concat(e.role.name).toLowerCase():"";case"qualityControl":return e.qualityControl?"".concat(e.qualityControl.firstName," ").concat(e.qualityControl.lastName).toLowerCase():"";case"branch":return e.branch.name.toLowerCase();case"dueDate":return e.dueDate?new Date(e.dueDate).getTime():Number.MAX_SAFE_INTEGER;case"description":return(e.description||"").toLowerCase();default:return""}},a=e.sort(((e,a)=>{if(ct.length>0&&lt.length>0){const r=[...ct].sort(((e,t)=>e.priority-t.priority));for(const s of r){const r=t(e,s.column),n=t(a,s.column);let l=0;if(l="number"===typeof r&&"number"===typeof n?r-n:String(r).localeCompare(String(n)),"desc"===s.direction&&(l=-l),0!==l)return l}return 0}if("table"===ea&&yt.key){let t,r;switch(yt.key){case"title":t=e.title,r=a.title;break;case"status":t=va(e.status),r=va(a.status);break;case"responsible.firstName":t=e.responsible?"".concat(e.responsible.firstName," ").concat(e.responsible.lastName):e.role?"Rolle: ".concat(e.role.name):"",r=a.responsible?"".concat(a.responsible.firstName," ").concat(a.responsible.lastName):a.role?"Rolle: ".concat(a.role.name):"";break;case"qualityControl.firstName":t=e.qualityControl?"".concat(e.qualityControl.firstName," ").concat(e.qualityControl.lastName):"",r=a.qualityControl?"".concat(a.qualityControl.firstName," ").concat(a.qualityControl.lastName):"";break;case"branch.name":t=e.branch.name,r=a.branch.name;break;case"dueDate":t=e.dueDate?new Date(e.dueDate).getTime():Number.MAX_SAFE_INTEGER,r=a.dueDate?new Date(a.dueDate).getTime():Number.MAX_SAFE_INTEGER;break;default:t=e[yt.key],r=a[yt.key]}if("number"===typeof t&&"number"===typeof r)return"asc"===yt.direction?t-r:r-t;{const e=String(t).localeCompare(String(r));return"asc"===yt.direction?e:-e}}const r=e.dueDate?new Date(e.dueDate).getTime():Number.MAX_SAFE_INTEGER,s=a.dueDate?new Date(a.dueDate).getTime():Number.MAX_SAFE_INTEGER;if(r!==s)return r-s;const n=va(e.status),l=va(a.status);return n!==l?n-l:e.title.localeCompare(a.title)}));return console.log("\u2705 Gefilterte und sortierte Tasks:",a.length),a}),[Y,oe,yt,va,lt,it,ct,ea]),wa=(0,s.useMemo)((()=>{console.log("\ud83d\udd04 Filtere Reservations:",Te.length,"Reservations vorhanden");const e=Te.filter((e=>null!=e)),t=e.filter((e=>{if("all"!==ze&&e.status!==ze)return!1;if("all"!==Me&&e.paymentStatus!==Me)return!1;if(Fe){const t=Fe.toLowerCase();if(!(e.guestName.toLowerCase().includes(t)||e.guestEmail&&e.guestEmail.toLowerCase().includes(t)||e.guestPhone&&e.guestPhone.toLowerCase().includes(t)||e.roomNumber&&e.roomNumber.toLowerCase().includes(t)||e.lobbyReservationId&&e.lobbyReservationId.toLowerCase().includes(t)))return!1}return!0})),a=[...t].sort(((e,t)=>new Date(t.checkInDate).getTime()-new Date(e.checkInDate).getTime()));return console.log("\u2705 Gefilterte und sortierte Reservations:",a.length),a}),[Te,ze,Me,Fe]),ja=(e,t)=>{const a=[...Wt.columnOrder],r=a[e];a.splice(e,1),a.splice(t,0,r),Kt(a)},Aa=e=>{Qt(e)},Sa=(e,t)=>{e.preventDefault(),Ht&&Ht!==t&&$t(t)},Ca=(e,t)=>{if(e.preventDefault(),Ht&&Ht!==t){const e=Wt.columnOrder.indexOf(Ht),a=Wt.columnOrder.indexOf(t);e>-1&&a>-1&&ja(e,a)}Qt(null),$t(null)},Ta=()=>{Qt(null),$t(null)},Ea=(0,s.useMemo)((()=>{const e=(Wt.columnOrder||[]).filter((e=>null!=e&&"string"===typeof e)),t=("todos"===H?fe:Pt).filter((t=>!e.includes(t)));return[...e,...t]}),[Wt.columnOrder,H,fe,Pt]).filter((e=>null!=e&&"string"===typeof e&&Ut(e))),Da=async e=>{try{var t;const a={title:"".concat(e.title,"-Kopie"),description:e.description,status:"open",responsibleId:e.responsible?e.responsible.id:null,roleId:e.role?e.role.id:null,qualityControlId:(null===(t=e.qualityControl)||void 0===t?void 0:t.id)||null,branchId:e.branch.id,dueDate:e.dueDate},r=await z.A.post(B.Sn.TASKS.BASE,a);ae((e=>[r.data,...e])),At(r.data),wt(!0)}catch(s){var a,r;console.error("Fehler beim Kopieren des Tasks:",s);const e=s;le((null===(a=e.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||e.message||"Ein unerwarteter Fehler ist aufgetreten")}},Ia=async t=>{if(window.confirm(e("worktime.messages.taskDeleteConfirm"))){console.log("\ud83d\uddd1\ufe0f Starte L\xf6schung von Task:",t),console.log("\ud83d\udccb Aktuelle Tasks vor L\xf6schung:",Y.length),ae((e=>{const a=e.filter((e=>null!=e&&e.id!==t));return console.log("\ud83d\udccb Tasks nach Filterung:",a.length,"von",e.length),a}));try{console.log("\ud83d\udce1 Sende Delete-Request..."),await z.A.delete(B.Sn.TASKS.BY_ID(t)),console.log("\u2705 Delete erfolgreich"),me.oR.success(e("worktime.messages.taskDeleted"))}catch(ne){console.error("\u274c Fehler beim L\xf6schen der Aufgabe:",ne),na(),me.oR.error(e("worktime.messages.taskDeletedError"))}}};return(0,_.jsxs)("div",{className:"min-h-screen dark:bg-gray-900",children:[(0,_.jsx)("div",{className:"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6",children:(0,_.jsxs)("div",{className:"w-full mb-4",children:[(0,_.jsxs)("div",{className:"block sm:hidden w-full",children:[(0,_.jsxs)("div",{className:"dashboard-tasks-wrapper bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 w-full mb-20",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between px-3 sm:px-4 md:px-6",children:[(0,_.jsx)("div",{className:"flex items-center",children:a("tasks","write","table")&&(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>kt(!0),className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":e("tasks.createTask"),children:(0,_.jsx)(x.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.createTask")})]})}),(0,_.jsxs)("div",{className:"flex items-center",children:[(0,_.jsx)(g.A,{className:"h-6 w-6 mr-2 dark:text-white"}),(0,_.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:e("tasks.title")})]}),(0,_.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,_.jsx)("input",{type:"text",placeholder:e("common.search")+"...",className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:oe,onChange:e=>Ae(e.target.value)}),(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("cards"===ea?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""),onClick:()=>Zt("table"===ea?"cards":"table"),children:"table"===ea?(0,_.jsx)(h.A,{className:"h-5 w-5"}):(0,_.jsx)(p.A,{className:"h-5 w-5"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("table"===ea?"common.viewAsCards":"common.viewAsTable")})]}),(0,_.jsxs)("div",{className:"relative group ml-1",children:[(0,_.jsxs)("button",{className:"p-2 rounded-md ".concat(xa()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"," relative"),onClick:()=>bt(!pt),children:[(0,_.jsx)(b.A,{className:"h-5 w-5"}),xa()>0&&(0,_.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center",children:xa()})]}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("common.filter")})]}),(0,_.jsx)("div",{className:"ml-1",children:(0,_.jsx)(c.A,{columns:"todos"===H?"cards"===ea?[{id:"title",label:e("tasks.columns.title")},{id:"status",label:e("tasks.columns.status")},{id:"responsible",label:e("tasks.columns.responsible")},{id:"qualityControl",label:e("tasks.columns.qualityControl")},{id:"branch",label:e("tasks.columns.branch")},{id:"dueDate",label:e("tasks.columns.dueDate")},{id:"description",label:e("tasks.columns.description")}]:W:"cards"===ea?[{id:"guestName",label:e("reservations.columns.guestName","Gast")},{id:"status",label:e("reservations.columns.status","Status")},{id:"paymentStatus",label:e("reservations.columns.paymentStatus","Zahlungsstatus")},{id:"checkInDate",label:e("reservations.columns.checkInDate","Check-in")},{id:"checkOutDate",label:e("reservations.columns.checkOutDate","Check-out")},{id:"roomNumber",label:e("reservations.columns.roomNumber","Zimmer")},{id:"guestEmail",label:e("reservations.columns.guestEmail","E-Mail")},{id:"guestPhone",label:e("reservations.columns.guestPhone","Telefon")},{id:"amount",label:e("reservations.columns.amount","Betrag")},{id:"arrivalTime",label:e("reservations.columns.arrivalTime","Ankunftszeit")}]:U,visibleColumns:"cards"===ea?Array.from(ra):Ea,columnOrder:"cards"===ea?ta:Wt.columnOrder,onToggleColumnVisibility:e=>{if("cards"===ea){const t=je[e];if(t)if("responsibleAndQualityControl"===t){const a="responsible"===e?"qualityControl":"responsible";aa.has(a),Wt.hiddenColumns.includes(t);Gt(t)}else Gt(t)}else Gt(e)},onMoveColumn:"cards"===ea?(e,t)=>{const a=[...ta],r=a[e];a.splice(e,1),a.splice(t,0,r);const s=[],n=new Set;a.forEach((e=>{const t=je[e];t&&!n.has(t)&&(n.add(t),s.push(t))})),W.forEach((e=>{s.includes(e.id)||"actions"===e.id||s.push(e.id)})),Kt(s)}:ja,buttonTitle:e("cards"===ea?"tableColumn.sortAndDisplay":"tableColumn.configure"),modalTitle:e("cards"===ea?"tableColumn.sortAndDisplay":"tableColumn.configure"),onClose:()=>{}})})]})]}),(0,_.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6 px-3 sm:px-4 md:px-6",children:(0,_.jsxs)("nav",{className:"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden",children:[(0,_.jsx)("button",{onClick:()=>Q("todos"),className:"py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ".concat("todos"===H?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("tasks.title","To Do's")}),a("reservations","read","table")&&(0,_.jsx)("button",{onClick:()=>Q("reservations"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("reservations"===H?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("reservations.title","Reservations")})]})}),pt&&"todos"===H&&(0,_.jsx)("div",{className:"cards"===ea?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,_.jsx)(de.A,{columns:[...W,...K],onApply:ga,onReset:ha,savedConditions:lt,savedOperators:it,savedSortDirections:ct,onSortDirectionsChange:ut,tableId:ke})}),(0,_.jsx)("div",{className:"cards"===ea?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,_.jsx)(ce.A,{tableId:"todos"===H?ke:Ne,onSelectFilter:"todos"===H?ga:pa,onReset:"todos"===H?ha:ba,activeFilterName:"todos"===H?mt:at,selectedFilterId:"todos"===H?gt:st,onFilterChange:ya,defaultFilterName:"todos"===H?e("tasks.filters.current"):e("reservations.filters.current","Aktuell")})}),"todos"===H&&"table"===ea?(0,_.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,_.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,_.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,_.jsx)("tr",{children:Ea.map((e=>{const t=W.find((t=>t.id===e));return t?(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider ".concat(e===Yt?"bg-blue-100 dark:bg-blue-800":""),draggable:!0,onDragStart:()=>Aa(e),onDragOver:t=>Sa(t,e),onDrop:t=>Ca(t,e),onDragEnd:Ta,children:(0,_.jsxs)("div",{className:"flex items-center",children:[window.innerWidth<=640?t.shortLabel:t.label,"actions"!==e&&(0,_.jsx)("button",{onClick:()=>ua(e),className:"ml-1 focus:outline-none",children:(0,_.jsx)(y.A,{className:"h-4 w-4 text-gray-400 dark:text-gray-500"})})]})},e):null}))})}),(0,_.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:re?(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:Ea.length,className:"px-3 sm:px-4 md:px-6 py-4 text-center",children:(0,_.jsx)("div",{className:"flex justify-center",children:(0,_.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100"})})})}):ne?(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:Ea.length,className:"px-6 py-4 text-center text-red-600 dark:text-red-400",children:ne})}):0===Na.length?(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:Ea.length,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:(0,_.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,_.jsx)(v.A,{className:"h-10 w-10 text-gray-400 dark:text-gray-500"}),(0,_.jsx)("div",{className:"text-sm",children:e("tasks.noTasksFound")})]})})}):(0,_.jsx)(_.Fragment,{children:Na.slice(0,Xt).map((t=>{const r=(0,ge.go)(t.dueDate,"todo",void 0,t.title,t.description),s=(0,ge.F2)(r);return(0,_.jsx)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 ".concat("none"!==r?"".concat(s.bgClass," ").concat(s.borderClass," border-l-4"):""),children:Ea.map((r=>{switch(r){case"title":return(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4",children:(0,_.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-200 break-words flex items-center",children:[t.title,t.description&&(0,_.jsxs)("div",{className:"ml-2 relative group",children:[(0,_.jsx)("button",{className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",children:(0,_.jsx)(f.A,{className:"h-5 w-5"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.showDescription")}),(0,_.jsx)("div",{className:"absolute left-0 mt-2 p-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 shadow-lg rounded-md border border-gray-200 dark:border-gray-700 w-144 max-h-96 overflow-y-auto min-w-[36rem] z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:(0,_.jsx)(xe.A,{content:t.description,showImagePreview:!0})})]})]})},r);case"status":return(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat((0,he.qY)(t.status,"task")," dark:bg-opacity-30 status-col"),children:t.status})},r);case"responsibleAndQualityControl":return(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsxs)("div",{className:"flex flex-col",children:[(0,_.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:[(0,_.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline",children:[e("tasks.columns.responsible"),":"]}),(0,_.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden",children:[e("tasks.columns.responsible").substring(0,3),":"]}),(0,_.jsx)("br",{}),t.responsible?"".concat(t.responsible.firstName," ").concat(t.responsible.lastName):t.role?t.role.name:"-"]}),(0,_.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-200 mt-1",children:[(0,_.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline",children:e("tasks.qualityControlLabel")}),(0,_.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden",children:[e("tasks.columns.qualityControl").substring(0,2),":"]}),(0,_.jsx)("br",{}),t.qualityControl?"".concat(t.qualityControl.firstName," ").concat(t.qualityControl.lastName):"-"]})]})},r);case"branch":return(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsx)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:t.branch.name})},r);case"dueDate":const s=(0,ge.go)(t.dueDate,"todo",void 0,t.title,t.description),n=(0,ge.F2)(s);return(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsxs)("div",{className:"text-sm ".concat("none"!==s?n.textClass:"text-gray-900 dark:text-gray-200"),children:[t.dueDate?new Date(t.dueDate).toLocaleDateString():"-","none"!==s&&(0,_.jsx)("span",{className:"ml-2 text-xs",children:"\u26a0"})]})},r);case"actions":return(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsxs)("div",{className:"flex space-x-2 action-buttons",children:[(0,_.jsx)("div",{className:"status-buttons",children:ma(t)}),a("tasks","write","table")&&(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>{At(t),wt(!0)},className:"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:(0,_.jsx)(k.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("common.edit")})]}),a("tasks","both","table")&&(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>Da(t),className:"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300",children:(0,_.jsx)(N.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.actions.copy")})]}),a("tasks","delete","table")&&(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>Ia(t.id),className:"p-1.5 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",children:(0,_.jsx)(w.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("common.delete")})]})]})},r);default:return null}}))},t.id)}))})})]})}):"todos"===H?(0,_.jsx)("div",{className:"-mx-3 sm:-mx-4 md:-mx-6",children:re?(0,_.jsx)("div",{className:"flex justify-center py-12",children:(0,_.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100"})}):ne?(0,_.jsx)("div",{className:"flex justify-center py-12 text-red-600 dark:text-red-400",children:ne}):0===Na.length?(0,_.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400",children:[(0,_.jsx)(v.A,{className:"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500"}),(0,_.jsx)("div",{className:"text-sm",children:"Keine To Do's gefunden"})]}):(0,_.jsx)(be.A,{children:Na.slice(0,Xt).map((t=>{(0,ge.go)(t.dueDate,"todo",void 0,t.title,t.description);const s=[];if(ra.has("branch")&&s.push({icon:(0,_.jsx)(j.A,{className:"h-4 w-4"}),label:e("tasks.columns.branch"),value:t.branch.name,section:"left"}),ra.has("responsible")){const a=t.responsible?"".concat(t.responsible.firstName," ").concat(t.responsible.lastName):t.role?t.role.name:"-",r=a.length>4&&"-"!==a?a.substring(0,4):a;s.push({icon:(0,_.jsx)(A.A,{className:"h-4 w-4"}),label:e("tasks.columns.responsible"),value:r,section:"main"})}if(ra.has("qualityControl")){const a=t.qualityControl?"".concat(t.qualityControl.firstName," ").concat(t.qualityControl.lastName):"-",r=a.length>4&&"-"!==a?a.substring(0,4):a;s.push({icon:(0,_.jsx)(A.A,{className:"h-4 w-4"}),label:e("tasks.columns.qualityControl"),value:r,section:"main-second"})}if(ra.has("dueDate")){const a=(0,ge.Rj)(t.dueDate,"todo",t.title,t.description,(0,_.jsx)(S.A,{className:"h-4 w-4"}),e("tasks.columns.dueDate"),(e=>(0,ye.GP)(e,"dd.MM.yyyy",{locale:ve.de})),!1);s.push((0,r.A)((0,r.A)({},a),{},{section:"right-inline"}))}ra.has("description")&&t.description&&s.push({label:e("tasks.columns.description"),value:"",descriptionContent:t.description,attachmentMetadata:t.attachments||[],section:"full"});const n=(0,_.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,_.jsx)("div",{className:"status-buttons",children:ma(t)}),a("tasks","write","table")&&(0,_.jsx)("button",{onClick:e=>{e.stopPropagation(),At(t),wt(!0)},className:"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:(0,_.jsx)(k.A,{className:"h-4 w-4"})}),a("tasks","both","table")&&(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:e=>{e.stopPropagation(),Da(t)},className:"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300",children:(0,_.jsx)(N.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.actions.copy")})]})]});return(0,_.jsx)(pe.A,{title:(0,_.jsxs)("span",{children:[(0,_.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[t.id,":"]})," ",(0,_.jsx)("span",{children:t.title})]}),status:{label:(0,he.Iw)(t.status,"task",e),color:(0,he.qY)(t.status,"task"),onPreviousClick:void 0,onNextClick:void 0},metadata:s,actions:n},t.id)}))})}):null,"todos"===H&&Na.length>Xt&&(0,_.jsx)("div",{className:"mt-4 flex justify-center",children:(0,_.jsxs)("button",{className:"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600",onClick:()=>Jt((e=>e+10)),children:[e("common.showMore")," (",Na.length-Xt," ",e("common.remaining"),")"]})}),"reservations"===H&&"cards"===ea&&(0,_.jsx)("div",{className:"-mx-3 sm:-mx-4 md:-mx-6",children:De?(0,_.jsx)("div",{className:"flex justify-center py-12",children:(0,_.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100"})}):Re?(0,_.jsx)("div",{className:"flex justify-center py-12 text-red-600 dark:text-red-400",children:Re}):0===wa.length?(0,_.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400",children:[(0,_.jsx)(S.A,{className:"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500"}),(0,_.jsx)("div",{className:"text-sm",children:Fe||"all"!==ze||"all"!==Me?e("reservations.noResults","Keine Reservations gefunden"):e("reservations.noReservations","Keine Reservations vorhanden")})]}):(0,_.jsx)(be.A,{children:wa.slice(0,Xt).map((t=>{var r;const s=e=>{try{return(0,ye.GP)(new Date(e),"dd.MM.yyyy",{locale:ve.de})}catch(t){return e}},n=[];n.push({icon:(0,_.jsx)(S.A,{className:"h-4 w-4"}),label:e("reservations.checkInOut","Check-in/Check-out"),value:"".concat(s(t.checkInDate)," - ").concat(s(t.checkOutDate)),section:"main"}),t.roomNumber&&n.push({icon:(0,_.jsx)(C.A,{className:"h-4 w-4"}),label:e("reservations.room","Zimmer"),value:t.roomNumber,section:"main-second"}),t.guestEmail?n.push({icon:(0,_.jsx)(T.A,{className:"h-4 w-4"}),label:e("reservations.email","E-Mail"),value:t.guestEmail,section:"left"}):t.guestPhone&&n.push({icon:(0,_.jsx)(E.A,{className:"h-4 w-4"}),label:e("reservations.phone","Telefon"),value:t.guestPhone,section:"left"}),t.paymentLink&&n.push({icon:(0,_.jsx)(D.A,{className:"h-4 w-4"}),label:e("reservations.paymentLink","Zahlungslink"),value:(0,_.jsx)("a",{href:t.paymentLink,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"text-blue-600 dark:text-blue-400 hover:underline break-all",children:t.paymentLink.length>30?"".concat(t.paymentLink.substring(0,30),"..."):t.paymentLink}),section:"center"});const l="".concat(window.location.origin,"/check-in/").concat(t.id);if(n.push({icon:(0,_.jsx)(D.A,{className:"h-4 w-4"}),label:e("reservations.checkInLink","Check-in Link"),value:(0,_.jsx)("a",{href:l,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"text-blue-600 dark:text-blue-400 hover:underline break-all",children:l.length>30?"".concat(l.substring(0,30),"..."):l}),section:"center"}),n.push({label:e("reservations.status","Status"),value:(0,_.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(fa(t.status)),children:e("reservations.status.".concat(t.status),t.status)}),section:"right"}),n.push({label:e("reservations.paymentStatus","Zahlungsstatus"),value:(0,_.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(ka(t.paymentStatus)),children:e("reservations.paymentStatus.".concat(t.paymentStatus),t.paymentStatus)}),section:"right"}),t.amount){const a="string"===typeof t.amount?parseFloat(t.amount).toFixed(2):"number"===typeof t.amount?t.amount.toFixed(2):"0.00";n.push({icon:(0,_.jsx)(I.A,{className:"h-4 w-4"}),label:e("reservations.amount","Betrag"),value:"".concat(a," ").concat(t.currency||"COP"),section:"right"})}if(t.arrivalTime){const a=e=>{try{return(0,ye.GP)(new Date(e),"dd.MM.yyyy HH:mm",{locale:ve.de})}catch(t){return e}};n.push({icon:(0,_.jsx)(R.A,{className:"h-4 w-4"}),label:e("reservations.arrivalTime","Ankunftszeit"),value:a(t.arrivalTime),section:"right"})}if(t.doorPin&&n.push({icon:(0,_.jsx)(L.A,{className:"h-4 w-4"}),label:t.doorAppName||e("reservations.doorPin","T\xfcr-PIN"),value:t.doorPin,section:"right"}),t.onlineCheckInCompleted&&n.push({icon:(0,_.jsx)(g.A,{className:"h-4 w-4 text-green-600"}),label:e("reservations.onlineCheckIn","Online Check-in"),value:e("reservations.completed","Abgeschlossen"),section:"right"}),t.sentMessage){const a=e=>{if(!e)return"";try{return(0,ye.GP)(new Date(e),"dd.MM.yyyy HH:mm",{locale:ve.de})}catch(t){return e}};n.push({label:e("reservations.sentMessage","Versendete Nachricht"),value:t.sentMessageAt?"".concat(e("reservations.sentAt","Versendet am")," ").concat(a(t.sentMessageAt)):"",descriptionContent:t.sentMessage,section:"full"})}const o=a("reservations","write","table");t.id===(null===(r=wa[0])||void 0===r?void 0:r.id)&&console.log("[Reservations] Berechtigungspr\xfcfung:",{hasWritePermission:o,reservationId:t.id,entity:"reservations",accessLevel:"write",entityType:"table",actionButtonsWillBeCreated:o});const i=o?(0,_.jsx)("div",{className:"flex items-center space-x-2",children:(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:e=>{e.stopPropagation(),la(t.id)},disabled:Ke===t.id,className:"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300 disabled:opacity-50 disabled:cursor-not-allowed",title:e("reservations.generatePinAndSend","PIN generieren & Mitteilung versenden"),children:Ke===t.id?(0,_.jsx)(F.A,{className:"h-4 w-4 animate-spin"}):(0,_.jsx)(L.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("reservations.generatePinAndSend","PIN generieren & Mitteilung versenden")})]})}):null;return(0,_.jsx)(pe.A,{title:t.guestName,subtitle:t.lobbyReservationId?"ID: ".concat(t.lobbyReservationId):void 0,metadata:n,actions:i},t.id)}))})}),"reservations"===H&&"table"===ea&&(0,_.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,_.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,_.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e("reservations.guestName","Gast")}),(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e("reservations.status","Status")}),(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e("reservations.paymentStatus","Zahlungsstatus")}),(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e("reservations.checkInOut","Check-in/Check-out")}),(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e("reservations.room","Zimmer")}),(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e("common.actions","Aktionen")})]})}),(0,_.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:De?(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:6,className:"px-3 sm:px-4 md:px-6 py-4 text-center",children:(0,_.jsx)("div",{className:"flex justify-center",children:(0,_.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100"})})})}):Re?(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:6,className:"px-6 py-4 text-center text-red-600 dark:text-red-400",children:Re})}):0===wa.length?(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:(0,_.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,_.jsx)(S.A,{className:"h-10 w-10 text-gray-400 dark:text-gray-500"}),(0,_.jsx)("div",{className:"text-sm",children:Fe||"all"!==ze||"all"!==Me?e("reservations.noResults","Keine Reservations gefunden"):e("reservations.noReservations","Keine Reservations vorhanden")})]})})}):(0,_.jsx)(_.Fragment,{children:wa.slice(0,Xt).map((t=>{const r=e=>{try{return(0,ye.GP)(new Date(e),"dd.MM.yyyy",{locale:ve.de})}catch(t){return e}};return(0,_.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer",onClick:()=>q("/reservations/".concat(t.id)),children:[(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4",children:(0,_.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-200 break-words",children:[t.guestName,t.lobbyReservationId&&(0,_.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",t.lobbyReservationId]})]})}),(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(fa(t.status)),children:e("reservations.status.".concat(t.status),t.status)})}),(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(ka(t.paymentStatus)),children:e("reservations.paymentStatus.".concat(t.paymentStatus),t.paymentStatus)})}),(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:[r(t.checkInDate)," - ",r(t.checkOutDate)]})}),(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsx)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:t.roomNumber||"-"})}),(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsx)("div",{className:"flex space-x-2 action-buttons",children:a("reservations","write","table")&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:e=>{e.stopPropagation(),Ze(t),Qe(!0)},className:"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",title:e("reservations.sendInvitation","Einladung senden"),children:(0,_.jsx)(P.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("reservations.sendInvitation","Einladung senden")})]}),(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:e=>{e.stopPropagation(),la(t.id)},disabled:Ke===t.id,className:"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300 disabled:opacity-50 disabled:cursor-not-allowed",title:e("reservations.generatePinAndSend","PIN generieren & Mitteilung versenden"),children:Ke===t.id?(0,_.jsx)(F.A,{className:"h-4 w-4 animate-spin"}):(0,_.jsx)(L.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("reservations.generatePinAndSend","PIN generieren & Mitteilung versenden")})]}),(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:e=>{e.stopPropagation(),q("/reservations/".concat(t.id))},className:"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300",title:e("common.viewDetails","Details anzeigen"),children:(0,_.jsx)(f.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("common.viewDetails","Details anzeigen")})]})]})})})]},t.id)}))})})]})}),"reservations"===H&&wa.length>Xt&&(0,_.jsx)("div",{className:"mt-4 flex justify-center",children:(0,_.jsxs)("button",{className:"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600",onClick:()=>Jt((e=>e+10)),children:[e("common.showMore")," (",wa.length-Xt," ",e("common.remaining"),")"]})})]}),(0,_.jsx)("div",{className:"fixed bottom-13 left-0 right-0 w-full bg-white dark:bg-gray-800 z-9 shadow-lg border-t-0 dark:border-t dark:border-gray-700",children:(0,_.jsx)(ie,{})})]}),(0,_.jsxs)("div",{className:"hidden sm:block",children:[(0,_.jsx)("div",{className:"mb-8",children:(0,_.jsx)(ie,{})}),(0,_.jsxs)("div",{className:"dashboard-tasks-wrapper bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 w-full mb-20",children:[(0,_.jsxs)("div",{className:"flex items-center mb-4 justify-between px-3 sm:px-4 md:px-6",children:[(0,_.jsxs)("div",{className:"flex items-center",children:["todos"===H&&a("tasks","write","table")&&(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>kt(!0),className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":e("tasks.createTask"),"data-onboarding":"create-task-button",children:(0,_.jsx)(x.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.createTask")})]}),"reservations"===H&&a("reservations","write","table")&&(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>_e(!0),className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":e("reservations.createReservation.button","Neue Reservierung"),children:(0,_.jsx)(x.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("reservations.createReservation.button","Neue Reservierung")})]})]}),(0,_.jsxs)("div",{className:"flex items-center",children:[(0,_.jsx)(g.A,{className:"h-6 w-6 mr-2 dark:text-white"}),(0,_.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:"todos"===H?e("tasks.title"):e("reservations.title","Reservations")})]}),(0,_.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,_.jsx)("input",{type:"text",placeholder:e("common.search")+"...",className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:"todos"===H?oe:Fe,onChange:e=>{"todos"===H?Ae(e.target.value):Pe(e.target.value)}}),"reservations"===H&&(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:async()=>{try{We(!0),await z.A.post(B.Sn.RESERVATIONS.SYNC),V(e("reservations.syncSuccess","Reservations erfolgreich synchronisiert"),"success"),await oa()}catch(r){var t,a;console.error("Fehler beim Synchronisieren:",r),V((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||e("reservations.syncError","Fehler beim Synchronisieren"),"error")}finally{We(!1)}},disabled:Ve,className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,_.jsx)(F.A,{className:"h-5 w-5 ".concat(Ve?"animate-spin":"")})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:Ve?e("reservations.syncing","Synchronisiere..."):e("reservations.sync","Synchronisieren")})]}),(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("cards"===ea?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""),onClick:()=>Zt("table"===ea?"cards":"table"),children:"table"===ea?(0,_.jsx)(h.A,{className:"h-5 w-5"}):(0,_.jsx)(p.A,{className:"h-5 w-5"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("table"===ea?"common.viewAsCards":"common.viewAsTable")})]}),(0,_.jsxs)("div",{className:"relative group ml-1",children:[(0,_.jsxs)("button",{className:"p-2 rounded-md ".concat(xa()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"," relative"),onClick:()=>bt(!pt),children:[(0,_.jsx)(b.A,{className:"h-5 w-5"}),xa()>0&&(0,_.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center",children:xa()})]}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("common.filter")})]}),(0,_.jsx)("div",{className:"ml-1",children:(0,_.jsx)(c.A,{columns:"todos"===H?"cards"===ea?[{id:"title",label:e("tasks.columns.title")},{id:"status",label:e("tasks.columns.status")},{id:"responsible",label:e("tasks.columns.responsible")},{id:"qualityControl",label:e("tasks.columns.qualityControl")},{id:"branch",label:e("tasks.columns.branch")},{id:"dueDate",label:e("tasks.columns.dueDate")},{id:"description",label:e("tasks.columns.description")}]:W:"cards"===ea?[{id:"guestName",label:e("reservations.columns.guestName","Gast")},{id:"status",label:e("reservations.columns.status","Status")},{id:"paymentStatus",label:e("reservations.columns.paymentStatus","Zahlungsstatus")},{id:"checkInDate",label:e("reservations.columns.checkInDate","Check-in")},{id:"checkOutDate",label:e("reservations.columns.checkOutDate","Check-out")},{id:"roomNumber",label:e("reservations.columns.roomNumber","Zimmer")},{id:"guestEmail",label:e("reservations.columns.guestEmail","E-Mail")},{id:"guestPhone",label:e("reservations.columns.guestPhone","Telefon")},{id:"amount",label:e("reservations.columns.amount","Betrag")},{id:"arrivalTime",label:e("reservations.columns.arrivalTime","Ankunftszeit")}]:U,visibleColumns:"cards"===ea?Array.from(ra):Ea,columnOrder:"cards"===ea?ta:Wt.columnOrder,onToggleColumnVisibility:e=>{if("cards"===ea){const t=je[e];if(t)if("responsibleAndQualityControl"===t){const a="responsible"===e?"qualityControl":"responsible";aa.has(a),Wt.hiddenColumns.includes(t);Gt(t)}else Gt(t)}else Gt(e)},onMoveColumn:"cards"===ea?(e,t)=>{const a=[...ta],r=a[e];a.splice(e,1),a.splice(t,0,r);const s=[],n=new Set;a.forEach((e=>{const t=je[e];t&&!n.has(t)&&(n.add(t),s.push(t))})),W.forEach((e=>{s.includes(e.id)||"actions"===e.id||s.push(e.id)})),Kt(s)}:ja,buttonTitle:e("cards"===ea?"tableColumn.sortAndDisplay":"tableColumn.configure"),modalTitle:e("cards"===ea?"tableColumn.sortAndDisplay":"tableColumn.configure"),onClose:()=>{}})})]})]}),(0,_.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6 px-3 sm:px-4 md:px-6",children:(0,_.jsxs)("nav",{className:"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden",children:[(0,_.jsx)("button",{onClick:()=>Q("todos"),className:"py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ".concat("todos"===H?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("tasks.title","To Do's")}),a("reservations","read","table")&&(0,_.jsx)("button",{onClick:()=>Q("reservations"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("reservations"===H?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("reservations.title","Reservations")})]})}),pt&&"todos"===H&&(0,_.jsx)("div",{className:"cards"===ea?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,_.jsx)(de.A,{columns:[...W,...K],onApply:ga,onReset:ha,savedConditions:lt,savedOperators:it,savedSortDirections:ct,onSortDirectionsChange:ut,tableId:ke})}),(0,_.jsx)(ce.A,{tableId:"todos"===H?ke:Ne,onSelectFilter:"todos"===H?ga:pa,onReset:"todos"===H?ha:ba,activeFilterName:"todos"===H?mt:at,selectedFilterId:"todos"===H?gt:st,onFilterChange:ya,defaultFilterName:"todos"===H?e("tasks.filters.current"):e("reservations.filters.current","Aktuell")}),"table"===ea?(0,_.jsx)("div",{className:"overflow-x-auto",children:(0,_.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700","data-onboarding":"task-list",children:[(0,_.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,_.jsx)("tr",{children:Ea.map((e=>{const t=W.find((t=>t.id===e));return t?(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider ".concat(e===Yt?"bg-blue-100 dark:bg-blue-800":""),draggable:!0,onDragStart:()=>Aa(e),onDragOver:t=>Sa(t,e),onDrop:t=>Ca(t,e),onDragEnd:Ta,children:(0,_.jsxs)("div",{className:"flex items-center",children:[window.innerWidth<=640?t.shortLabel:t.label,"actions"!==e&&(0,_.jsx)("button",{onClick:()=>ua(e),className:"ml-1 focus:outline-none",children:(0,_.jsx)(y.A,{className:"h-4 w-4 text-gray-400 dark:text-gray-500"})})]})},e):null}))})}),(0,_.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:re?(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:Ea.length,className:"px-3 sm:px-4 md:px-6 py-4 text-center",children:(0,_.jsx)("div",{className:"flex justify-center",children:(0,_.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100"})})})}):ne?(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:Ea.length,className:"px-6 py-4 text-center text-red-600 dark:text-red-400",children:ne})}):0===Na.length?(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:Ea.length,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:(0,_.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,_.jsx)(v.A,{className:"h-10 w-10 text-gray-400 dark:text-gray-500"}),(0,_.jsx)("div",{className:"text-sm",children:e("tasks.noTasksFound")})]})})}):(0,_.jsx)(_.Fragment,{children:Na.slice(0,Xt).map((t=>{const r=(0,ge.go)(t.dueDate,"todo",void 0,t.title,t.description),s=(0,ge.F2)(r);return(0,_.jsx)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 ".concat("none"!==r?"".concat(s.bgClass," ").concat(s.borderClass," border-l-4"):""),children:Ea.map((r=>{switch(r){case"title":return(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4",children:(0,_.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-200 break-words flex items-center",children:[t.title,t.description&&(0,_.jsxs)("div",{className:"ml-2 relative group",children:[(0,_.jsx)("button",{className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",children:(0,_.jsx)(f.A,{className:"h-5 w-5"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.showDescription")}),(0,_.jsx)("div",{className:"absolute left-0 mt-2 p-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 shadow-lg rounded-md border border-gray-200 dark:border-gray-700 w-144 max-h-96 overflow-y-auto min-w-[36rem] z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:(0,_.jsx)(xe.A,{content:t.description,showImagePreview:!0})})]})]})},r);case"status":return(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat((0,he.qY)(t.status,"task")," dark:bg-opacity-30 status-col"),children:t.status})},r);case"responsibleAndQualityControl":return(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsxs)("div",{className:"flex flex-col",children:[(0,_.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:[(0,_.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline",children:[e("tasks.columns.responsible"),":"]}),(0,_.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden",children:[e("tasks.columns.responsible").substring(0,3),":"]}),(0,_.jsx)("br",{}),t.responsible?"".concat(t.responsible.firstName," ").concat(t.responsible.lastName):t.role?t.role.name:"-"]}),(0,_.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-200 mt-1",children:[(0,_.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline",children:e("tasks.qualityControlLabel")}),(0,_.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden",children:[e("tasks.columns.qualityControl").substring(0,2),":"]}),(0,_.jsx)("br",{}),t.qualityControl?"".concat(t.qualityControl.firstName," ").concat(t.qualityControl.lastName):"-"]})]})},r);case"branch":return(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsx)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:t.branch.name})},r);case"dueDate":const s=(0,ge.go)(t.dueDate,"todo",void 0,t.title,t.description),n=(0,ge.F2)(s);return(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsxs)("div",{className:"text-sm ".concat("none"!==s?n.textClass:"text-gray-900 dark:text-gray-200"),children:[t.dueDate?new Date(t.dueDate).toLocaleDateString():"-","none"!==s&&(0,_.jsx)("span",{className:"ml-2 text-xs",children:"\u26a0"})]})},r);case"actions":return(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsxs)("div",{className:"flex space-x-2 action-buttons",children:[(0,_.jsx)("div",{className:"status-buttons",children:ma(t)}),a("tasks","write","table")&&(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>{At(t),wt(!0)},className:"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:(0,_.jsx)(k.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("common.edit")})]}),a("tasks","both","table")&&(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>Da(t),className:"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300",children:(0,_.jsx)(N.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.actions.copy")})]}),a("tasks","delete","table")&&(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:()=>Ia(t.id),className:"p-1.5 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",children:(0,_.jsx)(w.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("common.delete")})]})]})},r);default:return null}}))},t.id)}))})})]})}):"todos"===H?(0,_.jsx)("div",{className:"-mx-3 sm:-mx-4 md:-mx-6",children:re?(0,_.jsx)("div",{className:"flex justify-center py-12",children:(0,_.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100"})}):ne?(0,_.jsx)("div",{className:"flex justify-center py-12 text-red-600 dark:text-red-400",children:ne}):0===Na.length?(0,_.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400",children:[(0,_.jsx)(v.A,{className:"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500"}),(0,_.jsx)("div",{className:"text-sm",children:"Keine To Do's gefunden"})]}):(0,_.jsx)(be.A,{children:Na.slice(0,Xt).map((t=>{(0,ge.go)(t.dueDate,"todo",void 0,t.title,t.description);const s=[];if(ra.has("branch")&&s.push({icon:(0,_.jsx)(j.A,{className:"h-4 w-4"}),label:e("tasks.columns.branch"),value:t.branch.name,section:"left"}),ra.has("responsible")){const a=t.responsible?"".concat(t.responsible.firstName," ").concat(t.responsible.lastName):t.role?t.role.name:"-",r=a.length>4&&"-"!==a?a.substring(0,4):a;s.push({icon:(0,_.jsx)(A.A,{className:"h-4 w-4"}),label:e("tasks.columns.responsible"),value:r,section:"main"})}if(ra.has("qualityControl")){const a=t.qualityControl?"".concat(t.qualityControl.firstName," ").concat(t.qualityControl.lastName):"-",r=a.length>4&&"-"!==a?a.substring(0,4):a;s.push({icon:(0,_.jsx)(A.A,{className:"h-4 w-4"}),label:e("tasks.columns.qualityControl"),value:r,section:"main-second"})}if(ra.has("dueDate")){const a=(0,ge.Rj)(t.dueDate,"todo",t.title,t.description,(0,_.jsx)(S.A,{className:"h-4 w-4"}),e("tasks.columns.dueDate"),(e=>(0,ye.GP)(e,"dd.MM.yyyy",{locale:ve.de})),!1);s.push((0,r.A)((0,r.A)({},a),{},{section:"right-inline"}))}ra.has("description")&&t.description&&s.push({label:e("tasks.columns.description"),value:"",descriptionContent:t.description,attachmentMetadata:t.attachments||[],section:"full"});const n=(0,_.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,_.jsx)("div",{className:"status-buttons",children:ma(t)}),a("tasks","write","table")&&(0,_.jsx)("button",{onClick:e=>{e.stopPropagation(),At(t),wt(!0)},className:"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:(0,_.jsx)(k.A,{className:"h-4 w-4"})}),a("tasks","both","table")&&(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:e=>{e.stopPropagation(),Da(t)},className:"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300",children:(0,_.jsx)(N.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("tasks.actions.copy")})]})]});return(0,_.jsx)(pe.A,{title:(0,_.jsxs)("span",{children:[(0,_.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[t.id,":"]})," ",(0,_.jsx)("span",{children:t.title})]}),status:{label:(0,he.Iw)(t.status,"task",e),color:(0,he.qY)(t.status,"task"),onPreviousClick:void 0,onNextClick:void 0},metadata:s,actions:n},t.id)}))})}):null,"todos"===H&&Na.length>Xt&&(0,_.jsx)("div",{className:"mt-4 flex justify-center",children:(0,_.jsxs)("button",{className:"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600",onClick:()=>Jt((e=>e+10)),children:[e("common.showMore")," (",Na.length-Xt," ",e("common.remaining"),")"]})}),"reservations"===H&&"cards"===ea&&(0,_.jsx)("div",{className:"-mx-3 sm:-mx-4 md:-mx-6",children:De?(0,_.jsx)("div",{className:"flex justify-center py-12",children:(0,_.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100"})}):Re?(0,_.jsx)("div",{className:"flex justify-center py-12 text-red-600 dark:text-red-400",children:Re}):0===wa.length?(0,_.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400",children:[(0,_.jsx)(S.A,{className:"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500"}),(0,_.jsx)("div",{className:"text-sm",children:Fe||"all"!==ze||"all"!==Me?e("reservations.noResults","Keine Reservations gefunden"):e("reservations.noReservations","Keine Reservations vorhanden")})]}):(0,_.jsx)(be.A,{children:wa.slice(0,Xt).map((t=>{const r=e=>{try{return(0,ye.GP)(new Date(e),"dd.MM.yyyy",{locale:ve.de})}catch(t){return e}},s=[];s.push({icon:(0,_.jsx)(S.A,{className:"h-4 w-4"}),label:e("reservations.checkInOut","Check-in/Check-out"),value:"".concat(r(t.checkInDate)," - ").concat(r(t.checkOutDate)),section:"main"}),t.roomNumber&&s.push({icon:(0,_.jsx)(C.A,{className:"h-4 w-4"}),label:e("reservations.room","Zimmer"),value:t.roomNumber,section:"main-second"}),t.guestEmail?s.push({icon:(0,_.jsx)(T.A,{className:"h-4 w-4"}),label:e("reservations.email","E-Mail"),value:t.guestEmail,section:"left"}):t.guestPhone&&s.push({icon:(0,_.jsx)(E.A,{className:"h-4 w-4"}),label:e("reservations.phone","Telefon"),value:t.guestPhone,section:"left"}),t.paymentLink&&s.push({icon:(0,_.jsx)(D.A,{className:"h-4 w-4"}),label:e("reservations.paymentLink","Zahlungslink"),value:(0,_.jsx)("a",{href:t.paymentLink,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"text-blue-600 dark:text-blue-400 hover:underline break-all",children:t.paymentLink.length>30?"".concat(t.paymentLink.substring(0,30),"..."):t.paymentLink}),section:"center"});const n="".concat(window.location.origin,"/check-in/").concat(t.id);if(s.push({icon:(0,_.jsx)(D.A,{className:"h-4 w-4"}),label:e("reservations.checkInLink","Check-in Link"),value:(0,_.jsx)("a",{href:n,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"text-blue-600 dark:text-blue-400 hover:underline break-all",children:n.length>30?"".concat(n.substring(0,30),"..."):n}),section:"center"}),s.push({label:e("reservations.status","Status"),value:(0,_.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(fa(t.status)),children:e("reservations.status.".concat(t.status),t.status)}),section:"right"}),s.push({label:e("reservations.paymentStatus","Zahlungsstatus"),value:(0,_.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(ka(t.paymentStatus)),children:e("reservations.paymentStatus.".concat(t.paymentStatus),t.paymentStatus)}),section:"right"}),t.amount){const a="string"===typeof t.amount?parseFloat(t.amount).toFixed(2):"number"===typeof t.amount?t.amount.toFixed(2):"0.00";s.push({icon:(0,_.jsx)(I.A,{className:"h-4 w-4"}),label:e("reservations.amount","Betrag"),value:"".concat(a," ").concat(t.currency||"COP"),section:"right"})}if(t.arrivalTime){const a=e=>{try{return(0,ye.GP)(new Date(e),"dd.MM.yyyy HH:mm",{locale:ve.de})}catch(t){return e}};s.push({icon:(0,_.jsx)(R.A,{className:"h-4 w-4"}),label:e("reservations.arrivalTime","Ankunftszeit"),value:a(t.arrivalTime),section:"right"})}if(t.doorPin&&s.push({icon:(0,_.jsx)(L.A,{className:"h-4 w-4"}),label:t.doorAppName||e("reservations.doorPin","T\xfcr-PIN"),value:t.doorPin,section:"right"}),t.onlineCheckInCompleted&&s.push({icon:(0,_.jsx)(g.A,{className:"h-4 w-4 text-green-600"}),label:e("reservations.onlineCheckIn","Online Check-in"),value:e("reservations.completed","Abgeschlossen"),section:"right"}),t.sentMessage){const a=e=>{if(!e)return"";try{return(0,ye.GP)(new Date(e),"dd.MM.yyyy HH:mm",{locale:ve.de})}catch(t){return e}};s.push({label:e("reservations.sentMessage","Versendete Nachricht"),value:t.sentMessageAt?"".concat(e("reservations.sentAt","Versendet am")," ").concat(a(t.sentMessageAt)):"",descriptionContent:t.sentMessage,section:"full"})}const l=a("reservations","write","table")?(0,_.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:e=>{e.stopPropagation(),Ze(t),Qe(!0)},className:"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",title:e("reservations.sendInvitation","Einladung senden"),children:(0,_.jsx)(P.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("reservations.sendInvitation","Einladung senden")})]}),(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:e=>{e.stopPropagation(),la(t.id)},disabled:Ke===t.id,className:"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300 disabled:opacity-50 disabled:cursor-not-allowed",title:e("reservations.generatePinAndSend","PIN generieren & Mitteilung versenden"),children:Ke===t.id?(0,_.jsx)(F.A,{className:"h-4 w-4 animate-spin"}):(0,_.jsx)(L.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("reservations.generatePinAndSend","PIN generieren & Mitteilung versenden")})]})]}):null;return(0,_.jsx)(pe.A,{title:t.guestName,subtitle:t.lobbyReservationId?"ID: ".concat(t.lobbyReservationId):void 0,metadata:s,actions:l},t.id)}))})}),"reservations"===H&&"table"===ea&&(0,_.jsx)("div",{className:"overflow-x-auto",children:(0,_.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,_.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e("reservations.guestName","Gast")}),(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e("reservations.status","Status")}),(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e("reservations.paymentStatus","Zahlungsstatus")}),(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e("reservations.checkInOut","Check-in/Check-out")}),(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e("reservations.room","Zimmer")}),(0,_.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e("common.actions","Aktionen")})]})}),(0,_.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:De?(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:6,className:"px-3 sm:px-4 md:px-6 py-4 text-center",children:(0,_.jsx)("div",{className:"flex justify-center",children:(0,_.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100"})})})}):Re?(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:6,className:"px-6 py-4 text-center text-red-600 dark:text-red-400",children:Re})}):0===wa.length?(0,_.jsx)("tr",{children:(0,_.jsx)("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:(0,_.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,_.jsx)(S.A,{className:"h-10 w-10 text-gray-400 dark:text-gray-500"}),(0,_.jsx)("div",{className:"text-sm",children:Fe||"all"!==ze||"all"!==Me?e("reservations.noResults","Keine Reservations gefunden"):e("reservations.noReservations","Keine Reservations vorhanden")})]})})}):(0,_.jsx)(_.Fragment,{children:wa.slice(0,Xt).map((t=>{const r=e=>{try{return(0,ye.GP)(new Date(e),"dd.MM.yyyy",{locale:ve.de})}catch(t){return e}};return(0,_.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer",onClick:()=>q("/reservations/".concat(t.id)),children:[(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4",children:(0,_.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-200 break-words",children:[t.guestName,t.lobbyReservationId&&(0,_.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",t.lobbyReservationId]})]})}),(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(fa(t.status)),children:e("reservations.status.".concat(t.status),t.status)})}),(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(ka(t.paymentStatus)),children:e("reservations.paymentStatus.".concat(t.paymentStatus),t.paymentStatus)})}),(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:[r(t.checkInDate)," - ",r(t.checkOutDate)]})}),(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsx)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:t.roomNumber||"-"})}),(0,_.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,_.jsx)("div",{className:"flex space-x-2 action-buttons",children:a("reservations","write","table")&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:e=>{e.stopPropagation(),Ze(t),Qe(!0)},className:"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",title:e("reservations.sendInvitation","Einladung senden"),children:(0,_.jsx)(P.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("reservations.sendInvitation","Einladung senden")})]}),(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:e=>{e.stopPropagation(),la(t.id)},disabled:Ke===t.id,className:"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300 disabled:opacity-50 disabled:cursor-not-allowed",title:e("reservations.generatePinAndSend","PIN generieren & Mitteilung versenden"),children:Ke===t.id?(0,_.jsx)(F.A,{className:"h-4 w-4 animate-spin"}):(0,_.jsx)(L.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("reservations.generatePinAndSend","PIN generieren & Mitteilung versenden")})]}),(0,_.jsxs)("div",{className:"relative group",children:[(0,_.jsx)("button",{onClick:e=>{e.stopPropagation(),q("/reservations/".concat(t.id))},className:"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300",title:e("common.viewDetails","Details anzeigen"),children:(0,_.jsx)(f.A,{className:"h-4 w-4"})}),(0,_.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("common.viewDetails","Details anzeigen")})]})]})})})]},t.id)}))})})]})}),"reservations"===H&&wa.length>Xt&&(0,_.jsx)("div",{className:"mt-4 flex justify-center",children:(0,_.jsxs)("button",{className:"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600",onClick:()=>Jt((e=>e+10)),children:[e("common.showMore")," (",wa.length-Xt," ",e("common.remaining"),")"]})})]})]})]})}),(0,_.jsx)(G,{isOpen:ft,onClose:()=>kt(!1),onTaskCreated:e=>{null!=e&&(ae((t=>{const a=t.filter((e=>null!=e));return[e,...a]})),wt(!0),At(e))}}),jt&&(0,_.jsx)($,{isOpen:Nt,onClose:()=>{wt(!1),At(null)},onTaskUpdated:t=>{null!=t&&(ae((e=>e.filter((e=>null!=e)).map((e=>e.id===t.id?t:e)))),wt(!1),At(null),me.oR.success(e("worktime.messages.taskUpdated")))},task:jt}),(0,_.jsx)(X.A,{isOpen:Be,onClose:()=>_e(!1),onReservationCreated:async e=>{Q("reservations"),await oa()}}),Ue&&(0,_.jsx)(ee,{isOpen:He,onClose:()=>{Qe(!1),Ze(null)},reservation:Ue,onSuccess:async()=>{await oa()}})]})}}}]);
//# sourceMappingURL=77.ec5c9661.chunk.js.map