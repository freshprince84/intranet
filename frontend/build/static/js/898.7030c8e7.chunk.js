"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[898],{542:(e,t,r)=>{r.d(t,{Ay:()=>l,Zj:()=>o,i$:()=>i});var a=r(1923),n=r(1801);console.log("DEBUGAUSGABE API-Client: API_URL ist:",n.H$);const s=a.A;s.interceptors.request.use((e=>{var t;const r=`${e.baseURL}${e.url}`;console.log("DEBUGAUSGABE API-Client: Vollst\xe4ndige Request URL:",r),console.log("DEBUGAUSGABE API-Client: Request-Methode:",null===(t=e.method)||void 0===t?void 0:t.toUpperCase()),console.log("DEBUGAUSGABE API-Client: Request-Headers:",e.headers),console.log("DEBUGAUSGABE API-Client: Request-Daten:",e.data);const a=localStorage.getItem("token");return console.log("DEBUGAUSGABE API-Client: Token vorhanden:",!!a),e}),(e=>(console.error("DEBUGAUSGABE API-Client: Fehler im Request Interceptor:",e),Promise.reject(e)))),s.interceptors.response.use((e=>(console.log("DEBUGAUSGABE API-Client: Response erhalten:",e.status,e.config.url),e)),(e=>(console.error("DEBUGAUSGABE API-Client: Fehler im Response Interceptor:",e.message),e.response?(console.error("DEBUGAUSGABE API-Client: Response Status:",e.response.status),console.error("DEBUGAUSGABE API-Client: Response Daten:",e.response.data)):console.error("DEBUGAUSGABE API-Client: Keine Response erhalten"),Promise.reject(e))));const i={getAll:()=>s.get("/users"),getById:e=>s.get(`/users/${e}`),create:e=>{console.log("DEBUGAUSGABE API-Client: userApi.create wird aufgerufen mit Daten:",e);try{return s.post("/users",e).then((e=>(console.log("DEBUGAUSGABE API-Client: userApi.create Antwort:",e),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: userApi.create Fehler:",e.response||e),e}))}catch(t){throw console.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in userApi.create:",t),t}},update:(e,t)=>s.put(`/users/${e}`,t),updateRoles:(e,t)=>s.put(`/users/${e}/roles`,{roleIds:t})},o={getAll:()=>(console.log("DEBUGAUSGABE API-Client: roleApi.getAll wird aufgerufen"),s.get("/roles").then((e=>(console.log("DEBUGAUSGABE API-Client: roleApi.getAll erfolgreich:",e.data.length,"Rollen geladen"),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: roleApi.getAll Fehler:",e.message),e}))),getById:e=>(console.log(`DEBUGAUSGABE API-Client: roleApi.getById(${e}) wird aufgerufen`),s.get(`/roles/${e}`)),create:e=>{console.log("DEBUGAUSGABE API-Client: roleApi.create wird aufgerufen mit Daten:",e);try{return s.post("/roles",e).then((e=>(console.log("DEBUGAUSGABE API-Client: roleApi.create Antwort:",e),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: roleApi.create Fehler:",e.response||e),e}))}catch(t){throw console.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in roleApi.create:",t),t}},update:(e,t)=>{console.log(`DEBUGAUSGABE API-Client: roleApi.update f\xfcr ID ${e} wird aufgerufen mit Daten:`,t);try{return s.put(`/roles/${e}`,t).then((e=>(console.log("DEBUGAUSGABE API-Client: roleApi.update Antwort:",e),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: roleApi.update Fehler:",e.response||e),e}))}catch(r){throw console.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in roleApi.update:",r),r}},delete:e=>(console.log(`DEBUGAUSGABE API-Client: roleApi.delete(${e}) wird aufgerufen`),s.delete(`/roles/${e}`))},l=s},2704:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(5043);function n(e,t){let{title:r,titleId:n,...s}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),r?a.createElement("title",{id:n},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const s=a.forwardRef(n)},2811:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(5043);function n(e,t){let{title:r,titleId:n,...s}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),r?a.createElement("title",{id:n},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const s=a.forwardRef(n)},6009:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(5043);function n(e,t){let{title:r,titleId:n,...s}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),r?a.createElement("title",{id:n},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const s=a.forwardRef(n)},9e3:(e,t,r)=>{r.d(t,{A:()=>A});var a=r(5043),n=r(4117),s=r(542),i=r(1801);const o=async(e,t)=>{try{return(await s.Ay.post(i.Sn.IDENTIFICATION_DOCUMENTS.BY_USER(e),t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){throw console.error("Fehler beim Hinzuf\xfcgen des Dokuments:",r),r}},l=async(e,t)=>{try{return(await s.Ay.put(i.Sn.IDENTIFICATION_DOCUMENTS.BY_ID(e),t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){throw console.error("Fehler beim Aktualisieren des Dokuments:",r),r}};var d=r(7855);const c=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<768;var u=r(579);const m=e=>{let{onCapture:t,onCancel:r}=e;const[n,s]=(0,a.useState)(null),[i,o]=(0,a.useState)(null),[l,d]=(0,a.useState)(null),m=(0,a.useRef)(null),g=(0,a.useRef)(null),h=async()=>{try{d(null);const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});s(e),m.current&&(m.current.srcObject=e)}catch(l){console.error("Fehler beim Zugriff auf die Kamera:",l),d("Kamerazugriff nicht m\xf6glich. Bitte pr\xfcfen Sie die Berechtigungen und stellen Sie sicher, dass Ihr Ger\xe4t eine Kamera hat.")}},x=()=>{n&&(n.getTracks().forEach((e=>e.stop())),s(null))};return(0,a.useEffect)((()=>(c()&&h(),()=>{x()})),[]),c()?(0,u.jsxs)("div",{className:"camera-capture p-2 dark:bg-gray-800",children:[(0,u.jsx)("canvas",{ref:g,className:"hidden"}),l&&(0,u.jsxs)("div",{className:"error bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4",children:[(0,u.jsx)("p",{children:l}),(0,u.jsx)("button",{className:"mt-2 px-4 py-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:r,children:"Zur\xfcck"})]}),l||i?!l&&i?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"preview-container mb-4 rounded overflow-hidden border border-gray-300 dark:border-gray-700",children:(0,u.jsx)("img",{src:i,alt:"Aufgenommenes Dokument",className:"w-full h-auto"})}),(0,u.jsxs)("div",{className:"flex justify-between",children:[(0,u.jsx)("button",{className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:()=>{o(null),h()},children:"Neu aufnehmen"}),(0,u.jsx)("button",{className:"px-4 py-2 bg-green-500 dark:bg-green-600 text-white rounded-md hover:bg-green-600 dark:hover:bg-green-700",onClick:()=>{i&&t(i)},children:"Verwenden"})]})]}):null:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"video-container mb-4 rounded overflow-hidden border border-gray-300 dark:border-gray-700",children:(0,u.jsx)("video",{ref:m,autoPlay:!0,playsInline:!0,className:"w-full h-auto"})}),(0,u.jsxs)("div",{className:"flex justify-between",children:[(0,u.jsx)("button",{className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:r,children:"Abbrechen"}),(0,u.jsx)("button",{className:"px-4 py-2 bg-blue-500 dark:bg-blue-600 text-white rounded-md hover:bg-blue-600 dark:hover:bg-blue-700",onClick:()=>{if(m.current&&g.current){const e=g.current,t=m.current;e.width=t.videoWidth,e.height=t.videoHeight;const r=e.getContext("2d");if(r){r.drawImage(t,0,0);const a=e.toDataURL("image/jpeg",.9);o(a),x()}}},children:"Foto aufnehmen"})]})]})]}):(0,u.jsxs)("div",{className:"p-4 text-center dark:bg-gray-800 dark:text-white",children:[(0,u.jsx)("p",{className:"mb-4",children:"Kamerafunktion ist nur auf mobilen Ger\xe4ten verf\xfcgbar."}),(0,u.jsx)("button",{className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:r,children:"Zur\xfcck"})]})};var g=r(2704);function h(e,t){let{title:r,titleId:n,...s}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),r?a.createElement("title",{id:n},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"}))}const x=a.forwardRef(h);var p=r(1816),y=r(7591),b=r(9422);const f=[{value:"passport",label:"Reisepass"},{value:"national_id",label:"Personalausweis"},{value:"driving_license",label:"F\xfchrerschein"},{value:"residence_permit",label:"Aufenthaltserlaubnis"},{value:"work_permit",label:"Arbeitserlaubnis"},{value:"tax_id",label:"Steuer-ID"},{value:"social_security",label:"Sozialversicherungsausweis"}],k=e=>{let{userId:t,document:r,onDocumentSaved:n,onCancel:h}=e;const[k,w]=(0,a.useState)((null===r||void 0===r?void 0:r.documentType)||""),[A,v]=(0,a.useState)((null===r||void 0===r?void 0:r.documentNumber)||""),[D,j]=(0,a.useState)(null!==r&&void 0!==r&&r.issueDate?r.issueDate.substring(0,10):""),[N,E]=(0,a.useState)(null!==r&&void 0!==r&&r.expiryDate?r.expiryDate.substring(0,10):""),[C,I]=(0,a.useState)((null===r||void 0===r?void 0:r.issuingCountry)||""),[S,B]=(0,a.useState)((null===r||void 0===r?void 0:r.issuingAuthority)||""),[U,G]=(0,a.useState)(null),[F,P]=(0,a.useState)(null),[T,_]=(0,a.useState)(!1),[R,O]=(0,a.useState)(!1),[$,M]=(0,a.useState)(!1),[L,V]=(0,a.useState)(null),{showMessage:K}=(0,d.A)(),W=e=>{P(e),_(!1),G(null)},Z=()=>{_(!1)};return T?(0,u.jsx)(m,{onCapture:W,onCancel:Z}):(0,u.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),k&&A&&C){O(!0);try{if(r){if(U){const e=new FormData;A&&e.append("documentNumber",A),D&&e.append("issueDate",D),N&&e.append("expiryDate",N),C&&e.append("issuingCountry",C),S&&e.append("issuingAuthority",S),e.append("documentFile",U),await l(r.id,e)}else if(F)await(async(e,t,r)=>{try{return(await s.Ay.put(i.Sn.IDENTIFICATION_DOCUMENTS.BY_ID(e),{...r,imageData:t})).data}catch(a){throw console.error("Fehler beim Aktualisieren des Dokuments mit Kamera:",a),a}})(r.id,F,{documentNumber:A,issuingCountry:C,issueDate:D,expiryDate:N,issuingAuthority:S});else{const e=new FormData;A&&e.append("documentNumber",A),D&&e.append("issueDate",D),N&&e.append("expiryDate",N),C&&e.append("issuingCountry",C),S&&e.append("issuingAuthority",S),await l(r.id,e)}K("Dokument erfolgreich aktualisiert","success")}else{if(U){const e=new FormData;e.append("documentType",k),e.append("documentNumber",A),e.append("issuingCountry",C),D&&e.append("issueDate",D),N&&e.append("expiryDate",N),S&&e.append("issuingAuthority",S),e.append("documentFile",U),await o(t,e)}else if(F)await(async(e,t,r)=>{try{return(await s.Ay.post(i.Sn.IDENTIFICATION_DOCUMENTS.BY_USER(e),{...r,imageData:t})).data}catch(a){throw console.error("Fehler beim Hinzuf\xfcgen des Dokuments mit Kamera:",a),a}})(t,F,{documentType:k,documentNumber:A,issuingCountry:C,issueDate:D,expiryDate:N,issuingAuthority:S});else{const e=new FormData;e.append("documentType",k),e.append("documentNumber",A),e.append("issuingCountry",C),D&&e.append("issueDate",D),N&&e.append("expiryDate",N),S&&e.append("issuingAuthority",S),await o(t,e)}K("Dokument erfolgreich hinzugef\xfcgt","success")}n()}catch(c){var a,d;K(`Fehler: ${(null===(a=c.response)||void 0===a||null===(d=a.data)||void 0===d?void 0:d.error)||"Unbekannter Fehler"}`,"error")}finally{O(!1)}}else K("Bitte f\xfcllen Sie alle Pflichtfelder aus","error")},className:"space-y-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("label",{htmlFor:"documentType",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Dokumenttyp ",(0,u.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"*"})]}),(0,u.jsxs)("select",{id:"documentType",value:k,onChange:e=>w(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white",required:!0,children:[(0,u.jsx)("option",{value:"",children:"Bitte ausw\xe4hlen"}),f.map((e=>(0,u.jsx)("option",{value:e.value,children:e.label},e.value)))]})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("label",{htmlFor:"documentNumber",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Dokumentnummer ",(0,u.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"*"})]}),(0,u.jsx)("input",{type:"text",id:"documentNumber",value:A,onChange:e=>v(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white",required:!0})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("label",{htmlFor:"issuingCountry",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Ausstellungsland ",(0,u.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"*"})]}),(0,u.jsx)("input",{type:"text",id:"issuingCountry",value:C,onChange:e=>I(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white",required:!0})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"issuingAuthority",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Ausstellende Beh\xf6rde"}),(0,u.jsx)("input",{type:"text",id:"issuingAuthority",value:S,onChange:e=>B(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"issueDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Ausstellungsdatum"}),(0,u.jsx)("input",{type:"date",id:"issueDate",value:D,onChange:e=>j(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"expiryDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Ablaufdatum"}),(0,u.jsx)("input",{type:"date",id:"expiryDate",value:N,onChange:e=>E(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Dokumentbild"}),(0,u.jsxs)("div",{className:"mt-1 flex items-center space-x-2",children:[(0,u.jsxs)("label",{className:"flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 cursor-pointer",children:[(0,u.jsx)(g.A,{className:"h-5 w-5 mr-2 text-gray-500 dark:text-gray-400"}),"Datei hochladen",(0,u.jsx)("input",{type:"file",className:"sr-only",onChange:e=>{e.target.files&&e.target.files.length>0&&(G(e.target.files[0]),P(null))},accept:"image/*"})]}),c()&&(0,u.jsxs)("button",{type:"button",onClick:()=>_(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",children:[(0,u.jsx)(x,{className:"h-5 w-5 mr-2 text-gray-500 dark:text-gray-400"}),"Foto aufnehmen"]}),(0,u.jsx)("button",{type:"button",onClick:async()=>{try{if(M(!0),V(null),!U&&!F)throw new Error("Bitte lade zuerst ein Dokument hoch oder nimm ein Foto auf");let e=null;if(U?e=await new Promise(((e,t)=>{const r=new FileReader;r.onload=()=>e(r.result),r.onerror=t,r.readAsDataURL(U)})):F&&(e=F),!e)throw new Error("Kann keine Bilddaten finden");const t=await(async e=>{try{console.log("Starte KI-basierte Dokumentenerkennung..."),e.startsWith("data:image")||(e=e.startsWith("/9j/")?"data:image/jpeg;base64,"+e:e.startsWith("iVBOR")?"data:image/png;base64,"+e:"data:image/jpeg;base64,"+e);const t=localStorage.getItem("token");if(!t)throw new Error("Nicht authentifiziert. Bitte melden Sie sich an.");const r=`${i.H$}/document-recognition`;console.log("Verwende API-Endpunkt:",r);const a=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},credentials:"include",mode:"cors",body:JSON.stringify({image:e,documentType:"id_card"})});if(!a.ok){const e=await a.text();throw new Error(`API-Anfrage fehlgeschlagen: ${a.status} ${e}`)}const n=await a.json();return console.log("KI-Ergebnis:",n),n}catch(t){return console.error("Fehler bei der KI-basierten Dokumentenerkennung:",t),{}}})(e);console.log("Erkannte Daten:",t),t.documentType&&w(t.documentType),t.documentNumber&&v(t.documentNumber),t.issueDate&&j(t.issueDate),t.expiryDate&&E(t.expiryDate),t.issuingCountry&&I(t.issuingCountry),t.issuingAuthority&&B(t.issuingAuthority),K("Dokument wurde erfolgreich erkannt","success")}catch(e){console.error("Fehler bei der automatischen Erkennung:",e),V(e.message),K("Fehler bei der Dokumentenerkennung: "+e.message,"error")}finally{M(!1)}},disabled:$||!U&&!F,className:"inline-flex items-center px-4 py-2 border rounded-md shadow-sm text-sm font-medium "+($||!U&&!F?"bg-gray-100 dark:bg-gray-800 text-gray-400 dark:text-gray-500 border-gray-300 dark:border-gray-700 cursor-not-allowed":"border-blue-300 dark:border-blue-700 text-blue-700 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 hover:bg-blue-100 dark:hover:bg-blue-900/50"),children:$?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(p.A,{className:"h-5 w-5 mr-2 animate-spin"}),"Erkennung l\xe4uft..."]}):"Automatisch erkennen"})]}),U&&(0,u.jsxs)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:["Ausgew\xe4hlte Datei: ",U.name]}),F&&(0,u.jsxs)("div",{className:"mt-2",children:[(0,u.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Aufgenommenes Bild:"}),(0,u.jsx)("img",{src:F,alt:"Aufgenommenes Dokument",className:"max-h-40 border dark:border-gray-700 rounded"})]}),L&&(0,u.jsxs)("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:["Fehler bei der Erkennung: ",L]})]}),(0,u.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,u.jsx)("button",{type:"button",onClick:h,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:"Abbrechen",children:(0,u.jsx)(y.A,{className:"h-5 w-5"})}),(0,u.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",disabled:R,title:R?"Wird gespeichert...":r?"Aktualisieren":"Speichern",children:R?(0,u.jsx)(p.A,{className:"h-5 w-5 animate-spin"}):(0,u.jsx)(b.A,{className:"h-5 w-5"})})]})]})};var w=r(2672);const A=e=>{let{userId:t,isAdmin:r=!1}=e;const{t:o}=(0,n.Bd)(),[l,c]=(0,a.useState)([]),[m,g]=(0,a.useState)(!0),[h,x]=(0,a.useState)(null),[p,y]=(0,a.useState)(!1),[b,f]=(0,a.useState)(null),[A,v]=(0,a.useState)(null),{showMessage:D}=(0,d.A)(),{user:j}=(0,w.As)(),N=async()=>{g(!0);try{const e=await(async e=>{try{return(await s.Ay.get(i.Sn.IDENTIFICATION_DOCUMENTS.BY_USER(e))).data}catch(h){throw console.error("Fehler beim Abrufen der Identifikationsdokumente:",h),h}})(t);c(e),x(null)}catch(e){x(e.message||o("identificationDocuments.loadError")),D(o("identificationDocuments.loadError"),"error")}finally{g(!1)}};(0,a.useEffect)((()=>{N()}),[t]);const E=async e=>{if(window.confirm(o("identificationDocuments.deleteConfirm")))try{await(async e=>{try{await s.Ay.delete(i.Sn.IDENTIFICATION_DOCUMENTS.BY_ID(e))}catch(h){throw console.error("Fehler beim L\xf6schen des Dokuments:",h),h}})(e),D(o("identificationDocuments.deleteSuccess"),"success"),N()}catch(t){D(`${o("identificationDocuments.deleteError")}: ${t.message||"Unbekannter Fehler"}`,"error")}},C=async e=>{if(j)try{await(async(e,t)=>{try{await s.Ay.post(i.Sn.IDENTIFICATION_DOCUMENTS.VERIFY(e),{adminId:t})}catch(h){throw console.error("Fehler bei der Verifizierung des Dokuments:",h),h}})(e,j.id),D(o("identificationDocuments.verifySuccess"),"success"),N()}catch(t){D(`${o("identificationDocuments.verifyError")}: ${t.message||"Unbekannter Fehler"}`,"error")}else D(o("identificationDocuments.notAuthenticated"),"error")},I=async e=>{v(e);try{const t=(e=>`${window.location.origin}/api${i.Sn.IDENTIFICATION_DOCUMENTS.DOWNLOAD(e)}`)(e);window.open(t,"_blank")}catch(t){D(`${o("identificationDocuments.downloadError")}: ${t.message||"Unbekannter Fehler"}`,"error")}finally{v(null)}},S=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("de-DE")}catch{return e}};return p?(0,u.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[(0,u.jsx)("h3",{className:"text-lg font-medium mb-4",children:o("identificationDocuments.addDocument")}),(0,u.jsx)(k,{userId:t,onDocumentSaved:()=>{y(!1),N()},onCancel:()=>y(!1)})]}):b?(0,u.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[(0,u.jsx)("h3",{className:"text-lg font-medium mb-4",children:o("identificationDocuments.editDocument")}),(0,u.jsx)(k,{userId:t,document:b,onDocumentSaved:()=>{f(null),N()},onCancel:()=>f(null)})]}):(0,u.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[(0,u.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,u.jsx)("h3",{className:"text-lg font-medium",children:o("identificationDocuments.title")}),(0,u.jsx)("button",{onClick:()=>y(!0),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700",children:o("identificationDocuments.newDocument")})]}),m?(0,u.jsx)("div",{className:"flex justify-center items-center p-4",children:(0,u.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-white"})}):h?(0,u.jsx)("div",{className:"text-red-600 p-4",children:h}):0===l.length?(0,u.jsx)("div",{className:"text-gray-500 dark:text-gray-400 p-4",children:o("identificationDocuments.noDocuments")}):(0,u.jsx)("div",{className:"overflow-x-auto",children:(0,u.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,u.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:o("identificationDocuments.columns.type")}),(0,u.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:o("identificationDocuments.columns.number")}),(0,u.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:o("identificationDocuments.columns.country")}),(0,u.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:o("identificationDocuments.columns.validFrom")}),(0,u.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:o("identificationDocuments.columns.validTo")}),(0,u.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:o("identificationDocuments.columns.status")}),(0,u.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:o("identificationDocuments.columns.actions")})]})}),(0,u.jsx)("tbody",{className:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700",children:l.map((e=>{return(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:(t=e.documentType,{passport:o("identificationDocuments.types.passport"),national_id:o("identificationDocuments.types.national_id"),driving_license:o("identificationDocuments.types.driving_license"),residence_permit:o("identificationDocuments.types.residence_permit"),work_permit:o("identificationDocuments.types.work_permit"),tax_id:o("identificationDocuments.types.tax_id"),social_security:o("identificationDocuments.types.social_security")}[t]||t)}),(0,u.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:e.documentNumber}),(0,u.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:e.issuingCountry}),(0,u.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:S(e.issueDate)}),(0,u.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:S(e.expiryDate)}),(0,u.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:e.isVerified?(0,u.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-700 dark:text-green-100",children:o("identificationDocuments.status.verified")}):(0,u.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-700 dark:text-yellow-100",children:o("identificationDocuments.status.pending")})}),(0,u.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-medium",children:(0,u.jsxs)("div",{className:"flex space-x-2",children:[(0,u.jsx)("button",{onClick:()=>I(e.id),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",disabled:A===e.id,children:A===e.id?o("identificationDocuments.actions.downloading"):o("identificationDocuments.actions.view")}),(0,u.jsx)("button",{onClick:()=>f(e),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",children:o("identificationDocuments.actions.edit")}),(0,u.jsx)("button",{onClick:()=>E(e.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:o("identificationDocuments.actions.delete")}),r&&!e.isVerified&&(0,u.jsx)("button",{onClick:()=>C(e.id),className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",children:o("identificationDocuments.actions.verify")})]})})]},e.id);var t}))})]})})]})}}}]);
//# sourceMappingURL=898.7030c8e7.chunk.js.map