"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[898],{542:(e,t,r)=>{r.d(t,{Ay:()=>d,Zj:()=>s,i$:()=>o});var n=r(1923),a=r(1801);console.log("DEBUGAUSGABE API-Client: API_URL ist:",a.H$);const i=n.A;i.interceptors.request.use((e=>{var t;const r="".concat(e.baseURL).concat(e.url);console.log("DEBUGAUSGABE API-Client: Vollst\xe4ndige Request URL:",r),console.log("DEBUGAUSGABE API-Client: Request-Methode:",null===(t=e.method)||void 0===t?void 0:t.toUpperCase()),console.log("DEBUGAUSGABE API-Client: Request-Headers:",e.headers),console.log("DEBUGAUSGABE API-Client: Request-Daten:",e.data);const n=localStorage.getItem("token");return console.log("DEBUGAUSGABE API-Client: Token vorhanden:",!!n),e}),(e=>(console.error("DEBUGAUSGABE API-Client: Fehler im Request Interceptor:",e),Promise.reject(e)))),i.interceptors.response.use((e=>(console.log("DEBUGAUSGABE API-Client: Response erhalten:",e.status,e.config.url),e)),(e=>(console.error("DEBUGAUSGABE API-Client: Fehler im Response Interceptor:",e.message),e.response?(console.error("DEBUGAUSGABE API-Client: Response Status:",e.response.status),console.error("DEBUGAUSGABE API-Client: Response Daten:",e.response.data)):console.error("DEBUGAUSGABE API-Client: Keine Response erhalten"),Promise.reject(e))));const o={getAll:()=>i.get("/users"),getById:e=>i.get("/users/".concat(e)),create:e=>{console.log("DEBUGAUSGABE API-Client: userApi.create wird aufgerufen mit Daten:",e);try{return i.post("/users",e).then((e=>(console.log("DEBUGAUSGABE API-Client: userApi.create Antwort:",e),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: userApi.create Fehler:",e.response||e),e}))}catch(t){throw console.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in userApi.create:",t),t}},update:(e,t)=>i.put("/users/".concat(e),t),updateRoles:(e,t)=>i.put("/users/".concat(e,"/roles"),{roleIds:t})},s={getAll:()=>(console.log("DEBUGAUSGABE API-Client: roleApi.getAll wird aufgerufen"),i.get("/roles").then((e=>(console.log("DEBUGAUSGABE API-Client: roleApi.getAll erfolgreich:",e.data.length,"Rollen geladen"),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: roleApi.getAll Fehler:",e.message),e}))),getById:e=>(console.log("DEBUGAUSGABE API-Client: roleApi.getById(".concat(e,") wird aufgerufen")),i.get("/roles/".concat(e))),create:e=>{console.log("DEBUGAUSGABE API-Client: roleApi.create wird aufgerufen mit Daten:",e);try{return i.post("/roles",e).then((e=>(console.log("DEBUGAUSGABE API-Client: roleApi.create Antwort:",e),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: roleApi.create Fehler:",e.response||e),e}))}catch(t){throw console.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in roleApi.create:",t),t}},update:(e,t)=>{console.log("DEBUGAUSGABE API-Client: roleApi.update f\xfcr ID ".concat(e," wird aufgerufen mit Daten:"),t);try{return i.put("/roles/".concat(e),t).then((e=>(console.log("DEBUGAUSGABE API-Client: roleApi.update Antwort:",e),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: roleApi.update Fehler:",e.response||e),e}))}catch(r){throw console.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in roleApi.update:",r),r}},delete:e=>(console.log("DEBUGAUSGABE API-Client: roleApi.delete(".concat(e,") wird aufgerufen")),i.delete("/roles/".concat(e)))},d=i},2704:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(45),a=r(5043);const i=["title","titleId"];function o(e,t){let{title:r,titleId:o}=e,s=(0,n.A)(e,i);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":o},s),r?a.createElement("title",{id:o},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const s=a.forwardRef(o)},2811:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(45),a=r(5043);const i=["title","titleId"];function o(e,t){let{title:r,titleId:o}=e,s=(0,n.A)(e,i);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":o},s),r?a.createElement("title",{id:o},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const s=a.forwardRef(o)},6009:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(45),a=r(5043);const i=["title","titleId"];function o(e,t){let{title:r,titleId:o}=e,s=(0,n.A)(e,i);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":o},s),r?a.createElement("title",{id:o},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const s=a.forwardRef(o)},9e3:(e,t,r)=>{r.d(t,{A:()=>v});var n=r(5043),a=r(4117),i=r(9379),o=r(542),s=r(1801);const d=async(e,t)=>{try{return(await o.Ay.post(s.Sn.IDENTIFICATION_DOCUMENTS.BY_USER(e),t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){throw console.error("Fehler beim Hinzuf\xfcgen des Dokuments:",r),r}},c=async(e,t)=>{try{return(await o.Ay.put(s.Sn.IDENTIFICATION_DOCUMENTS.BY_ID(e),t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){throw console.error("Fehler beim Aktualisieren des Dokuments:",r),r}};var l=r(7855);const u=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<768;var m=r(579);const g=e=>{let{onCapture:t,onCancel:r}=e;const[a,i]=(0,n.useState)(null),[o,s]=(0,n.useState)(null),[d,c]=(0,n.useState)(null),l=(0,n.useRef)(null),g=(0,n.useRef)(null),p=async()=>{try{c(null);const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});i(e),l.current&&(l.current.srcObject=e)}catch(d){console.error("Fehler beim Zugriff auf die Kamera:",d),c("Kamerazugriff nicht m\xf6glich. Bitte pr\xfcfen Sie die Berechtigungen und stellen Sie sicher, dass Ihr Ger\xe4t eine Kamera hat.")}},h=()=>{a&&(a.getTracks().forEach((e=>e.stop())),i(null))};return(0,n.useEffect)((()=>(u()&&p(),()=>{h()})),[]),u()?(0,m.jsxs)("div",{className:"camera-capture p-2 dark:bg-gray-800",children:[(0,m.jsx)("canvas",{ref:g,className:"hidden"}),d&&(0,m.jsxs)("div",{className:"error bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4",children:[(0,m.jsx)("p",{children:d}),(0,m.jsx)("button",{className:"mt-2 px-4 py-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:r,children:"Zur\xfcck"})]}),d||o?!d&&o?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"preview-container mb-4 rounded overflow-hidden border border-gray-300 dark:border-gray-700",children:(0,m.jsx)("img",{src:o,alt:"Aufgenommenes Dokument",className:"w-full h-auto"})}),(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("button",{className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:()=>{s(null),p()},children:"Neu aufnehmen"}),(0,m.jsx)("button",{className:"px-4 py-2 bg-green-500 dark:bg-green-600 text-white rounded-md hover:bg-green-600 dark:hover:bg-green-700",onClick:()=>{o&&t(o)},children:"Verwenden"})]})]}):null:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"video-container mb-4 rounded overflow-hidden border border-gray-300 dark:border-gray-700",children:(0,m.jsx)("video",{ref:l,autoPlay:!0,playsInline:!0,className:"w-full h-auto"})}),(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("button",{className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:r,children:"Abbrechen"}),(0,m.jsx)("button",{className:"px-4 py-2 bg-blue-500 dark:bg-blue-600 text-white rounded-md hover:bg-blue-600 dark:hover:bg-blue-700",onClick:()=>{if(l.current&&g.current){const e=g.current,t=l.current;e.width=t.videoWidth,e.height=t.videoHeight;const r=e.getContext("2d");if(r){r.drawImage(t,0,0);const n=e.toDataURL("image/jpeg",.9);s(n),h()}}},children:"Foto aufnehmen"})]})]})]}):(0,m.jsxs)("div",{className:"p-4 text-center dark:bg-gray-800 dark:text-white",children:[(0,m.jsx)("p",{className:"mb-4",children:"Kamerafunktion ist nur auf mobilen Ger\xe4ten verf\xfcgbar."}),(0,m.jsx)("button",{className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:r,children:"Zur\xfcck"})]})};var p=r(2704),h=r(45);const x=["title","titleId"];function y(e,t){let{title:r,titleId:a}=e,i=(0,h.A)(e,x);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},i),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"}))}const f=n.forwardRef(y);var b=r(1816),k=r(7591),w=r(9422);const A=e=>{let{userId:t,document:r,onDocumentSaved:h,onCancel:x}=e;const{t:y}=(0,a.Bd)(),[A,D]=(0,n.useState)((null===r||void 0===r?void 0:r.documentType)||""),[v,j]=(0,n.useState)((null===r||void 0===r?void 0:r.documentNumber)||""),[N,E]=(0,n.useState)(null!==r&&void 0!==r&&r.issueDate?r.issueDate.substring(0,10):""),[I,C]=(0,n.useState)(null!==r&&void 0!==r&&r.expiryDate?r.expiryDate.substring(0,10):""),[S,B]=(0,n.useState)((null===r||void 0===r?void 0:r.issuingCountry)||""),[U,G]=(0,n.useState)((null===r||void 0===r?void 0:r.issuingAuthority)||""),[F,P]=(0,n.useState)(null),[T,_]=(0,n.useState)(null),[R,O]=(0,n.useState)(!1),[L,M]=(0,n.useState)(!1),[V,q]=(0,n.useState)(!1),[K,W]=(0,n.useState)(null),{showMessage:Z}=(0,l.A)(),H=[{value:"passport",label:y("identificationDocuments.types.passport")},{value:"national_id",label:y("identificationDocuments.types.national_id")},{value:"driving_license",label:y("identificationDocuments.types.driving_license")},{value:"residence_permit",label:y("identificationDocuments.types.residence_permit")},{value:"work_permit",label:y("identificationDocuments.types.work_permit")},{value:"tax_id",label:y("identificationDocuments.types.tax_id")},{value:"social_security",label:y("identificationDocuments.types.social_security")}],z=e=>{_(e),O(!1),P(null)},Y=()=>{O(!1)};return R?(0,m.jsx)(g,{onCapture:z,onCancel:Y}):(0,m.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),A&&v&&S){M(!0);try{if(r){if(F){const e=new FormData;v&&e.append("documentNumber",v),N&&e.append("issueDate",N),I&&e.append("expiryDate",I),S&&e.append("issuingCountry",S),U&&e.append("issuingAuthority",U),e.append("documentFile",F),await c(r.id,e)}else if(T)await(async(e,t,r)=>{try{return(await o.Ay.put(s.Sn.IDENTIFICATION_DOCUMENTS.BY_ID(e),(0,i.A)((0,i.A)({},r),{},{imageData:t}))).data}catch(n){throw console.error("Fehler beim Aktualisieren des Dokuments mit Kamera:",n),n}})(r.id,T,{documentNumber:v,issuingCountry:S,issueDate:N,expiryDate:I,issuingAuthority:U});else{const e=new FormData;v&&e.append("documentNumber",v),N&&e.append("issueDate",N),I&&e.append("expiryDate",I),S&&e.append("issuingCountry",S),U&&e.append("issuingAuthority",U),await c(r.id,e)}Z(y("identificationDocuments.form.updateSuccess"),"success")}else{if(F){const e=new FormData;e.append("documentType",A),e.append("documentNumber",v),e.append("issuingCountry",S),N&&e.append("issueDate",N),I&&e.append("expiryDate",I),U&&e.append("issuingAuthority",U),e.append("documentFile",F),await d(t,e)}else if(T)await(async(e,t,r)=>{try{return(await o.Ay.post(s.Sn.IDENTIFICATION_DOCUMENTS.BY_USER(e),(0,i.A)((0,i.A)({},r),{},{imageData:t}))).data}catch(n){throw console.error("Fehler beim Hinzuf\xfcgen des Dokuments mit Kamera:",n),n}})(t,T,{documentType:A,documentNumber:v,issuingCountry:S,issueDate:N,expiryDate:I,issuingAuthority:U});else{const e=new FormData;e.append("documentType",A),e.append("documentNumber",v),e.append("issuingCountry",S),N&&e.append("issueDate",N),I&&e.append("expiryDate",I),U&&e.append("issuingAuthority",U),await d(t,e)}Z(y("identificationDocuments.form.createSuccess"),"success")}h()}catch(l){var n,a;Z(y("identificationDocuments.form.error",{error:(null===(n=l.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.error)||y("common.error")}),"error")}finally{M(!1)}}else Z(y("identificationDocuments.form.fillRequiredFields"),"error")},className:"space-y-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{htmlFor:"documentType",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[y("identificationDocuments.form.documentType")," ",(0,m.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"*"})]}),(0,m.jsxs)("select",{id:"documentType",value:A,onChange:e=>D(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white",required:!0,children:[(0,m.jsx)("option",{value:"",children:y("identificationDocuments.form.selectDocumentType")}),H.map((e=>(0,m.jsx)("option",{value:e.value,children:e.label},e.value)))]})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{htmlFor:"documentNumber",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[y("identificationDocuments.form.documentNumber")," ",(0,m.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"*"})]}),(0,m.jsx)("input",{type:"text",id:"documentNumber",value:v,onChange:e=>j(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white",required:!0})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{htmlFor:"issuingCountry",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[y("identificationDocuments.form.issuingCountry")," ",(0,m.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"*"})]}),(0,m.jsx)("input",{type:"text",id:"issuingCountry",value:S,onChange:e=>B(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white",required:!0})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"issuingAuthority",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:y("identificationDocuments.form.issuingAuthority")}),(0,m.jsx)("input",{type:"text",id:"issuingAuthority",value:U,onChange:e=>G(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"issueDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:y("identificationDocuments.form.issueDate")}),(0,m.jsx)("input",{type:"date",id:"issueDate",value:N,onChange:e=>E(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"expiryDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:y("identificationDocuments.form.expiryDate")}),(0,m.jsx)("input",{type:"date",id:"expiryDate",value:I,onChange:e=>C(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:y("identificationDocuments.form.documentImage")}),(0,m.jsxs)("div",{className:"mt-1 flex items-center space-x-2",children:[(0,m.jsxs)("label",{className:"flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 cursor-pointer",children:[(0,m.jsx)(p.A,{className:"h-5 w-5 mr-2 text-gray-500 dark:text-gray-400"}),y("identificationDocuments.form.uploadFile"),(0,m.jsx)("input",{type:"file",className:"sr-only",onChange:e=>{e.target.files&&e.target.files.length>0&&(P(e.target.files[0]),_(null))},accept:"image/*"})]}),u()&&(0,m.jsxs)("button",{type:"button",onClick:()=>O(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",children:[(0,m.jsx)(f,{className:"h-5 w-5 mr-2 text-gray-500 dark:text-gray-400"}),y("identificationDocuments.form.takePhoto")]}),(0,m.jsx)("button",{type:"button",onClick:async()=>{try{if(q(!0),W(null),!F&&!T)throw new Error(y("identificationDocuments.form.noDocumentUploaded"));let e=null;if(F?e=await new Promise(((e,t)=>{const r=new FileReader;r.onload=()=>e(r.result),r.onerror=t,r.readAsDataURL(F)})):T&&(e=T),!e)throw new Error(y("identificationDocuments.form.noImageData"));const t=await(async e=>{try{console.log("Starte KI-basierte Dokumentenerkennung..."),e.startsWith("data:image")||(e=e.startsWith("/9j/")?"data:image/jpeg;base64,"+e:e.startsWith("iVBOR")?"data:image/png;base64,"+e:"data:image/jpeg;base64,"+e);const t=localStorage.getItem("token");if(!t)throw new Error("Nicht authentifiziert. Bitte melden Sie sich an.");const r="".concat(s.H$,"/document-recognition");console.log("Verwende API-Endpunkt:",r);const n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},credentials:"include",mode:"cors",body:JSON.stringify({image:e,documentType:"id_card"})});if(!n.ok){const e=await n.text();throw new Error("API-Anfrage fehlgeschlagen: ".concat(n.status," ").concat(e))}const a=await n.json();return console.log("KI-Ergebnis:",a),a}catch(t){return console.error("Fehler bei der KI-basierten Dokumentenerkennung:",t),{}}})(e);console.log("Erkannte Daten:",t),t.documentType&&D(t.documentType),t.documentNumber&&j(t.documentNumber),t.issueDate&&E(t.issueDate),t.expiryDate&&C(t.expiryDate),t.issuingCountry&&B(t.issuingCountry),t.issuingAuthority&&G(t.issuingAuthority),Z(y("identificationDocuments.form.recognitionSuccess"),"success")}catch(e){console.error("Fehler bei der automatischen Erkennung:",e),W(e.message),Z(y("identificationDocuments.form.recognitionError",{error:e.message}),"error")}finally{q(!1)}},disabled:V||!F&&!T,className:"inline-flex items-center px-4 py-2 border rounded-md shadow-sm text-sm font-medium ".concat(V||!F&&!T?"bg-gray-100 dark:bg-gray-800 text-gray-400 dark:text-gray-500 border-gray-300 dark:border-gray-700 cursor-not-allowed":"border-blue-300 dark:border-blue-700 text-blue-700 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 hover:bg-blue-100 dark:hover:bg-blue-900/50"),children:V?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(b.A,{className:"h-5 w-5 mr-2 animate-spin"}),y("identificationDocuments.form.recognitionRunning")]}):y("identificationDocuments.form.autoRecognize")})]}),F&&(0,m.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:y("identificationDocuments.form.selectedFile",{name:F.name})}),T&&(0,m.jsxs)("div",{className:"mt-2",children:[(0,m.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:y("identificationDocuments.form.capturedImage")}),(0,m.jsx)("img",{src:T,alt:y("identificationDocuments.form.capturedDocument"),className:"max-h-40 border dark:border-gray-700 rounded"})]}),K&&(0,m.jsx)("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:y("identificationDocuments.form.recognitionErrorLabel",{error:K})})]}),(0,m.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,m.jsx)("button",{type:"button",onClick:x,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:y("common.cancel"),children:(0,m.jsx)(k.A,{className:"h-5 w-5"})}),(0,m.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",disabled:L,title:y(L?"common.saving":r?"identificationDocuments.form.update":"common.save"),children:L?(0,m.jsx)(b.A,{className:"h-5 w-5 animate-spin"}):(0,m.jsx)(w.A,{className:"h-5 w-5"})})]})]})};var D=r(2672);const v=e=>{let{userId:t,isAdmin:r=!1}=e;const{t:i}=(0,a.Bd)(),[d,c]=(0,n.useState)([]),[u,g]=(0,n.useState)(!0),[p,h]=(0,n.useState)(null),[x,y]=(0,n.useState)(!1),[f,b]=(0,n.useState)(null),[k,w]=(0,n.useState)(null),{showMessage:v}=(0,l.A)(),{user:j}=(0,D.As)(),N=async()=>{g(!0);try{const e=await(async e=>{try{return(await o.Ay.get(s.Sn.IDENTIFICATION_DOCUMENTS.BY_USER(e))).data}catch(p){throw console.error("Fehler beim Abrufen der Identifikationsdokumente:",p),p}})(t);c(e),h(null)}catch(e){h(e.message||i("identificationDocuments.loadError")),v(i("identificationDocuments.loadError"),"error")}finally{g(!1)}};(0,n.useEffect)((()=>{N()}),[t]);const E=async e=>{if(window.confirm(i("identificationDocuments.deleteConfirm")))try{await(async e=>{try{await o.Ay.delete(s.Sn.IDENTIFICATION_DOCUMENTS.BY_ID(e))}catch(p){throw console.error("Fehler beim L\xf6schen des Dokuments:",p),p}})(e),v(i("identificationDocuments.deleteSuccess"),"success"),N()}catch(t){v("".concat(i("identificationDocuments.deleteError"),": ").concat(t.message||"Unbekannter Fehler"),"error")}},I=async e=>{if(j)try{await(async(e,t)=>{try{await o.Ay.post(s.Sn.IDENTIFICATION_DOCUMENTS.VERIFY(e),{adminId:t})}catch(p){throw console.error("Fehler bei der Verifizierung des Dokuments:",p),p}})(e,j.id),v(i("identificationDocuments.verifySuccess"),"success"),N()}catch(t){v("".concat(i("identificationDocuments.verifyError"),": ").concat(t.message||"Unbekannter Fehler"),"error")}else v(i("identificationDocuments.notAuthenticated"),"error")},C=async e=>{w(e);try{const t=(e=>"".concat(window.location.origin,"/api").concat(s.Sn.IDENTIFICATION_DOCUMENTS.DOWNLOAD(e)))(e);window.open(t,"_blank")}catch(t){v("".concat(i("identificationDocuments.downloadError"),": ").concat(t.message||"Unbekannter Fehler"),"error")}finally{w(null)}},S=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("de-DE")}catch(t){return e}};return x?(0,m.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[(0,m.jsx)("h3",{className:"text-lg font-medium mb-4",children:i("identificationDocuments.addDocument")}),(0,m.jsx)(A,{userId:t,onDocumentSaved:()=>{y(!1),N()},onCancel:()=>y(!1)})]}):f?(0,m.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[(0,m.jsx)("h3",{className:"text-lg font-medium mb-4",children:i("identificationDocuments.editDocument")}),(0,m.jsx)(A,{userId:t,document:f,onDocumentSaved:()=>{b(null),N()},onCancel:()=>b(null)})]}):(0,m.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[(0,m.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,m.jsx)("h3",{className:"text-lg font-medium",children:i("identificationDocuments.title")}),(0,m.jsx)("button",{onClick:()=>y(!0),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700",children:i("identificationDocuments.newDocument")})]}),u?(0,m.jsx)("div",{className:"flex justify-center items-center p-4",children:(0,m.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-white"})}):p?(0,m.jsx)("div",{className:"text-red-600 p-4",children:p}):0===d.length?(0,m.jsx)("div",{className:"text-gray-500 dark:text-gray-400 p-4",children:i("identificationDocuments.noDocuments")}):(0,m.jsx)("div",{className:"overflow-x-auto",children:(0,m.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,m.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:i("identificationDocuments.columns.type")}),(0,m.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:i("identificationDocuments.columns.number")}),(0,m.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:i("identificationDocuments.columns.country")}),(0,m.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:i("identificationDocuments.columns.validFrom")}),(0,m.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:i("identificationDocuments.columns.validTo")}),(0,m.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:i("identificationDocuments.columns.status")}),(0,m.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:i("identificationDocuments.columns.actions")})]})}),(0,m.jsx)("tbody",{className:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700",children:d.map((e=>{return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:(t=e.documentType,{passport:i("identificationDocuments.types.passport"),national_id:i("identificationDocuments.types.national_id"),driving_license:i("identificationDocuments.types.driving_license"),residence_permit:i("identificationDocuments.types.residence_permit"),work_permit:i("identificationDocuments.types.work_permit"),tax_id:i("identificationDocuments.types.tax_id"),social_security:i("identificationDocuments.types.social_security")}[t]||t)}),(0,m.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:e.documentNumber}),(0,m.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:e.issuingCountry}),(0,m.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:S(e.issueDate)}),(0,m.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:S(e.expiryDate)}),(0,m.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:e.isVerified?(0,m.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-700 dark:text-green-100",children:i("identificationDocuments.status.verified")}):(0,m.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-700 dark:text-yellow-100",children:i("identificationDocuments.status.pending")})}),(0,m.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-medium",children:(0,m.jsxs)("div",{className:"flex space-x-2",children:[(0,m.jsx)("button",{onClick:()=>C(e.id),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",disabled:k===e.id,children:k===e.id?i("identificationDocuments.actions.downloading"):i("identificationDocuments.actions.view")}),(0,m.jsx)("button",{onClick:()=>b(e),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",children:i("identificationDocuments.actions.edit")}),(0,m.jsx)("button",{onClick:()=>E(e.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:i("identificationDocuments.actions.delete")}),r&&!e.isVerified&&(0,m.jsx)("button",{onClick:()=>I(e.id),className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",children:i("identificationDocuments.actions.verify")})]})})]},e.id);var t}))})]})})]})}}}]);
//# sourceMappingURL=898.2b48a214.chunk.js.map