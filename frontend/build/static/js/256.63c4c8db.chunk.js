"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[256],{256:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Ie});var r=a(5043),s=a(4117),i=a(5590),l=a(1923),d=a(1801),n=a(9837),o=a(9379),c=a(8756),m=a(6981),x=a(4399),u=a(887),g=a(1909),h=a(4850),b=a(1663),p=a(8010),y=a(2302),f=a(2811),k=a(4129),v=a(7012),j=a(6238),N=a(6018),w=a(6443),S=a(7591),W=a(1816),T=a(9422),A=a(579);const C=e=>{let{isOpen:t,onClose:a,onConfirm:i,userName:l}=e;const{t:d}=(0,s.Bd)(),o=new Date,c=(0,n.GP)(o,"yyyy-MM-dd"),m=(0,n.GP)(o,"HH:mm:ss"),[x,u]=(0,r.useState)(c),[g,h]=(0,r.useState)(m),[b,p]=(0,r.useState)(!1);return(0,A.jsx)(N.e,{appear:!0,show:t,as:r.Fragment,children:(0,A.jsxs)(w.lG,{as:"div",className:"relative z-10",onClose:a,children:[(0,A.jsx)(N.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,A.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,A.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,A.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,A.jsx)(N.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,A.jsxs)(w.lG.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-6 text-left align-middle shadow-xl transition-all",children:[(0,A.jsxs)("div",{className:"flex justify-between items-start",children:[(0,A.jsx)(w.lG.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white",children:d("teamWorktime.modal.stopTracking.title")}),(0,A.jsxs)("button",{type:"button",className:"bg-white dark:bg-gray-800 rounded-md text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:a,children:[(0,A.jsx)("span",{className:"sr-only",children:d("common.close")}),(0,A.jsx)(S.A,{className:"h-6 w-6","aria-hidden":"true"})]})]}),(0,A.jsx)("div",{className:"mt-2",children:(0,A.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:d("teamWorktime.modal.stopTracking.description",{userName:l})})}),(0,A.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:d("teamWorktime.modal.stopTracking.date")}),(0,A.jsx)("input",{type:"date",id:"date",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",value:x,onChange:e=>u(e.target.value)})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{htmlFor:"time",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:d("teamWorktime.modal.stopTracking.time")}),(0,A.jsx)("input",{type:"time",id:"time",step:"1",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",value:g,onChange:e=>h(e.target.value)})]})]}),(0,A.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,A.jsx)("button",{type:"button",className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",onClick:a,disabled:b,title:d("common.cancel"),children:(0,A.jsx)(S.A,{className:"h-5 w-5"})}),(0,A.jsx)("button",{type:"button",className:"p-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:async()=>{try{p(!0);const e="".concat(x,"T").concat(g);await i(e)}catch(e){console.error("Fehler beim Stoppen der Zeiterfassung:",e)}finally{p(!1)}},disabled:b,title:d(b?"teamWorktime.modal.stopTracking.stopping":"teamWorktime.modal.stopTracking.stop"),children:b?(0,A.jsx)(W.A,{className:"h-5 w-5 animate-spin"}):(0,A.jsx)(T.A,{className:"h-5 w-5"})})]})]})})})})]})})};var D=a(9248);const E=e=>{let{isOpen:t,onClose:a,onSave:i,userName:l,entries:d,selectedDate:n}=e;const{t:c}=(0,s.Bd)(),[m,x]=(0,r.useState)([]),[u,g]=(0,r.useState)(!1),[h,b]=(0,r.useState)(null);(0,r.useEffect)((()=>{if(d&&d.length>0){const e=d.map((e=>{const t=e.startTime.split("T")[0],a=e.startTime.split("T")[1].substring(0,8),r=e.endTime?e.endTime.split("T")[1].substring(0,8):null;return(0,o.A)((0,o.A)({},e),{},{date:t,startTimeTime:a,endTimeTime:r,isDeleted:!1,isModified:!1})}));x(e)}else x([])}),[d]);const p=e=>{const t=e.filter((e=>!e.isDeleted));for(let a=0;a<t.length;a++){const e=t[a],r=e.startTimeTime,s=e.endTimeTime;if(s&&r>=s)return b("Eintrag ".concat(a+1,": Die Endzeit muss nach der Startzeit liegen.")),!1;for(let i=a+1;i<t.length;i++){const e=t[i],l=e.startTimeTime,d=e.endTimeTime;if(s&&d&&r<d&&s>l||s&&!d&&s>l||d&&!s&&d>r)return b("Es gibt eine \xdcberlappung zwischen Eintrag ".concat(a+1," und Eintrag ").concat(i+1,".")),!1}}return b(null),!0};return(0,A.jsx)(N.e,{appear:!0,show:t,as:r.Fragment,children:(0,A.jsxs)(w.lG,{as:"div",className:"relative z-10",onClose:a,children:[(0,A.jsx)(N.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,A.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,A.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,A.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,A.jsx)(N.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,A.jsxs)(w.lG.Panel,{className:"w-full max-w-xl transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-6 text-left align-middle shadow-xl transition-all",children:[(0,A.jsxs)("div",{className:"flex justify-between items-start",children:[(0,A.jsx)(w.lG.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white",children:c("teamWorktime.modal.editWorktimes.title")}),(0,A.jsxs)("button",{type:"button",className:"bg-white dark:bg-gray-800 rounded-md text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:a,children:[(0,A.jsx)("span",{className:"sr-only",children:c("common.close")}),(0,A.jsx)(S.A,{className:"h-6 w-6","aria-hidden":"true"})]})]}),(0,A.jsx)("div",{className:"mt-2",children:(0,A.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:c("teamWorktime.modal.editWorktimes.description",{userName:l,date:n.split("-").reverse().join(".")})})}),h&&(0,A.jsx)("div",{className:"mt-2 p-2 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded",children:h}),(0,A.jsx)("div",{className:"mt-4",children:(0,A.jsx)("div",{className:"overflow-hidden border dark:border-gray-700 rounded-lg",children:(0,A.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,A.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:c("teamWorktime.modal.editWorktimes.columns.number")}),(0,A.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:c("teamWorktime.modal.editWorktimes.columns.startTime")}),(0,A.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:c("teamWorktime.modal.editWorktimes.columns.endTime")}),(0,A.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:c("common.actions")})]})}),(0,A.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:0===m.length?(0,A.jsx)("tr",{children:(0,A.jsx)("td",{colSpan:4,className:"px-4 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:c("teamWorktime.modal.editWorktimes.noEntries")})}):m.map(((e,t)=>(0,A.jsxs)("tr",{className:e.isDeleted?"bg-red-50 dark:bg-red-900":"",children:[(0,A.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:t+1}),(0,A.jsx)("td",{className:"px-4 py-2 whitespace-nowrap",children:(0,A.jsx)("input",{type:"time",step:"1",className:"rounded-md border ".concat(e.isDeleted?"border-red-300 bg-red-50 dark:border-red-700 dark:bg-red-900":"border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"," shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"),value:e.startTimeTime.substring(0,5),onChange:e=>((e,t)=>{const a=[...m];a[e].startTimeTime!==t&&(a[e].startTimeTime=t,a[e].isModified=!0,x(a),p(a))})(t,e.target.value+":00"),disabled:e.isDeleted})}),(0,A.jsx)("td",{className:"px-4 py-2 whitespace-nowrap",children:(0,A.jsx)("input",{type:"time",step:"1",className:"rounded-md border ".concat(e.isDeleted?"border-red-300 bg-red-50 dark:border-red-700 dark:bg-red-900":"border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"," shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"),value:e.endTimeTime?e.endTimeTime.substring(0,5):"",onChange:e=>{const a=e.target.value?e.target.value+":00":null;((e,t)=>{const a=[...m];a[e].endTimeTime!==t&&(a[e].endTimeTime=t,a[e].isModified=!0,x(a),p(a))})(t,a)},disabled:e.isDeleted})}),(0,A.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-right text-sm font-medium",children:(0,A.jsx)("button",{type:"button",onClick:()=>(e=>{const t=[...m];t[e].isDeleted=!t[e].isDeleted,t[e].isModified=!0,x(t)})(t),className:"p-1 rounded ".concat(e.isDeleted?"text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300":"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300"),title:e.isDeleted?c("teamWorktime.modal.editWorktimes.restore"):c("teamWorktime.modal.editWorktimes.markForDelete"),children:(0,A.jsx)(D.A,{className:"h-5 w-5"})})})]},e.id)))})]})})}),(0,A.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,A.jsx)("button",{type:"button",className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",onClick:a,disabled:u,title:c("common.cancel"),children:(0,A.jsx)(S.A,{className:"h-5 w-5"})}),(0,A.jsx)("button",{type:"button",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",onClick:async()=>{if(p(m))try{g(!0);const e=m.filter((e=>e.isModified||e.isDeleted)).map((e=>{const t="".concat(e.date,"T").concat(e.startTimeTime),a=e.endTimeTime?"".concat(e.date,"T").concat(e.endTimeTime):null;return(0,o.A)((0,o.A)({},e),{},{startTime:t,endTime:a})}));e.length>0&&await i(e),a()}catch(h){console.error("Fehler beim Speichern der Zeiterfassungen:",h),b(c("teamWorktime.modal.editWorktimes.saveError"))}finally{g(!1)}},disabled:u||Boolean(h),title:c(u?"common.saving":"common.save"),children:u?(0,A.jsx)(W.A,{className:"h-5 w-5 animate-spin"}):(0,A.jsx)(T.A,{className:"h-5 w-5"})})]})]})})})})]})})};var I=a(4426),L=a(7829),F=a(6400),M=a(2023),q=a(2760),P=a(1713);var H=a(8897),O=a(957),z=a(637);const R=["name","startTime","duration","pauseTime","branch","actions"],G={name:"asc",startTime:"asc",duration:"asc",pauseTime:"asc",branch:"asc"},B={name:["name"],startTime:["startTime"],duration:["duration"],pauseTime:["pauseTime"],branch:["branch"],actions:[]},_={name:"name",startTime:"startTime",duration:"duration",pauseTime:"pauseTime",branch:"branch"},V="workcenter-table",U=e=>{let{activeUsers:t,allWorktimes:a,loading:i,selectedDate:N,onDateChange:w,onStopWorktime:S,onRefresh:W,showTodos:T=!1,showRequests:D=!1}=e;const{t:U}=(0,s.Bd)(),Y=(0,r.useMemo)((()=>[{id:"name",label:U("teamWorktime.columns.name")},{id:"startTime",label:U("teamWorktime.columns.startTime")},{id:"duration",label:U("teamWorktime.columns.duration")},{id:"pauseTime",label:U("teamWorktime.columns.pauseTime")},{id:"branch",label:U("teamWorktime.columns.branch")},{id:"actions",label:U("teamWorktime.columns.actions")}]),[U]),[K,Z]=(0,r.useState)(!1),[Q,$]=(0,r.useState)(!1),[J,X]=(0,r.useState)(null),[ee,te]=(0,r.useState)(""),[ae,re]=(0,r.useState)({key:"startTime",direction:"asc"}),[se,ie]=(0,r.useState)(!1),[le,de]=(0,r.useState)(null),[ne,oe]=(0,r.useState)(!1),[ce,me]=(0,r.useState)(10),[xe,ue]=(0,r.useState)([]),[ge,he]=(0,r.useState)([]),[be,pe]=(0,r.useState)(U("teamWorktime.filters.active")),[ye,fe]=(0,r.useState)(null),[ke,ve]=(0,r.useState)({}),[je,Ne]=(0,r.useState)({}),[we,Se]=(0,r.useState)(new Set),[We,Te]=(0,r.useState)(!1),[Ae,Ce]=(0,r.useState)(!1),{hasPermission:De}=(0,q.S)();(0,r.useEffect)((()=>{(async()=>{if(T&&N)try{Te(!0);const e=await l.A.get(d.Sn.TEAM_WORKTIME.ANALYTICS.TODOS_BY_USER,{params:{date:N}}),t={};e.data.forEach((e=>{t[e.userId]=e.todos})),ve(t)}catch(e){console.error("Fehler beim Laden der To-Dos:",e)}finally{Te(!1)}})()}),[T,N]),(0,r.useEffect)((()=>{(async()=>{if(D&&N)try{Ce(!0);const e=await l.A.get(d.Sn.TEAM_WORKTIME.ANALYTICS.REQUESTS_BY_USER,{params:{date:N}}),t={};e.data.forEach((e=>{t[e.userId]=e.requests})),Ne(t)}catch(e){console.error("Fehler beim Laden der Requests:",e)}finally{Ce(!1)}})()}),[D,N]);const Ee=e=>{Se((t=>{const a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a}))},{settings:Ie,updateColumnOrder:Le,updateHiddenColumns:Fe,isColumnVisible:Me,updateViewMode:qe}=(0,M.F)("team_worktime_active",{defaultColumnOrder:R,defaultHiddenColumns:[],defaultViewMode:"cards"}),Pe=Ie.columnOrder,He=Ie.hiddenColumns,Oe=Ie.viewMode||"cards",[ze,Re]=(0,r.useState)((()=>G)),Ge=(0,r.useMemo)((()=>(e=>{const t=[];return e.forEach((e=>{const a=B[e];a&&a.length>0&&t.push(...a)})),t})(Ie.columnOrder||R)),[Ie.columnOrder]),Be=(0,r.useMemo)((()=>(e=>{const t=new Set;return e.forEach((e=>{(B[e]||[]).forEach((e=>t.add(e)))})),t})(Ie.hiddenColumns||[])),[Ie.hiddenColumns]),_e=(0,r.useMemo)((()=>new Set(Ge.filter((e=>!Be.has(e))))),[Ge,Be]);(0,r.useEffect)((()=>{document.querySelectorAll(".dashboard-workcenter-wrapper").forEach((e=>{"cards"===Oe?e.classList.add("cards-mode"):e.classList.remove("cards-mode")}))}),[Oe]);const Ve=e=>{X(e),Z(!0)},Ue=()=>{Z(!1),X(null)},Ye=e=>{X(e),$(!0)},Ke=()=>{$(!1),X(null)},Ze=e=>{de(e)},Qe=(0,r.useCallback)((e=>{e.preventDefault()}),[]),$e=(0,r.useCallback)(((e,t)=>{if(e.preventDefault(),!le||le===t)return;const a=[...Pe],r=a.indexOf(le),s=a.indexOf(t);a.splice(r,1),a.splice(s,0,le),Le(a)}),[le,Pe,Le]),Je=()=>{de(null)},Xe=()=>xe.length,et=(0,r.useMemo)((()=>{const e=[...a];t.filter((e=>e.startTime.split("T")[0]===N)).forEach((t=>{e.find((e=>e.id===t.id))||e.push(t)}));const r=e.reduce(((e,t)=>{const a=t.user.id;e[a]||(e[a]={user:t.user,branch:t.branch,entries:[],startTime:(0,P.IF)(t.startTime),endTime:t.endTime?(0,P.IF)(t.endTime):null,totalDuration:0,activeEntries:[],hasActiveWorktime:!1});const r=e[a];r.entries.push(t);const s=(0,P.IF)(t.startTime);if(s<r.startTime&&(r.startTime=s),t.endTime){const e=(0,P.IF)(t.endTime);(!r.endTime||e>r.endTime)&&(r.endTime=e)}else r.hasActiveWorktime=!0,r.activeEntries.push(t);if(t.endTime){const e=(0,P.IF)(t.endTime).getTime()-(0,P.IF)(t.startTime).getTime();r.totalDuration+=e}return e}),{});let s=Object.values(r).filter((e=>{const t="".concat(e.user.firstName," ").concat(e.user.lastName).toLowerCase(),a=e.user.username.toLowerCase(),r=e.branch.name.toLowerCase(),s=ee.toLowerCase();return!(ee&&!(t.includes(s)||a.includes(s)||r.includes(s)))}));if(xe.length>0){const e={name:(e,t)=>{const a="".concat(e.user.firstName," ").concat(e.user.lastName).toLowerCase(),r=(t.value||"").toLowerCase();return"equals"===t.operator?a===r:"contains"===t.operator?a.includes(r):"startsWith"===t.operator?a.startsWith(r):"endsWith"===t.operator?a.endsWith(r):null},branch:(e,t)=>{const a=e.branch.name.toLowerCase(),r=(t.value||"").toLowerCase();return"equals"===t.operator?a===r:"contains"===t.operator?a.includes(r):"startsWith"===t.operator?a.startsWith(r):"endsWith"===t.operator?a.endsWith(r):null},hasActiveWorktime:(e,t)=>{if("equals"===t.operator){const a="true"===t.value||!0===t.value;return e.hasActiveWorktime===a}return null},duration:(e,t)=>{const a=60*parseInt(t.value||"0")*60*1e3;if("greaterThan"===t.operator)return e.totalDuration>a;if("lessThan"===t.operator)return e.totalDuration<a;if("equals"===t.operator){const t=18e5;return Math.abs(e.totalDuration-a)<=t}return null}},t=(e,t)=>{switch(t){case"name":return"".concat(e.user.firstName," ").concat(e.user.lastName);case"branch":return e.branch.name;case"hasActiveWorktime":return e.hasActiveWorktime;case"duration":return e.totalDuration;case"startTime":return e.startTime;case"endTime":return e.endTime;default:return e[t]}};s=(0,F.W5)(s,xe,ge,t,e)}if("cards"===Oe){const e=Ge.filter((e=>_e.has(e)));s.sort(((t,a)=>{for(const r of e){const e=ze[r]||"asc";let s,i;switch(r){case"name":s="".concat(t.user.firstName," ").concat(t.user.lastName).toLowerCase(),i="".concat(a.user.firstName," ").concat(a.user.lastName).toLowerCase();break;case"startTime":s=t.startTime.getTime(),i=a.startTime.getTime();break;case"duration":s=t.totalDuration,i=a.totalDuration;break;case"pauseTime":s=t.endTime?t.endTime.getTime()-t.startTime.getTime()-t.totalDuration:0,i=a.endTime?a.endTime.getTime()-a.startTime.getTime()-a.totalDuration:0;break;case"branch":s=t.branch.name.toLowerCase(),i=a.branch.name.toLowerCase();break;default:continue}let l=0;if(l="number"===typeof s&&"number"===typeof i?s-i:String(s).localeCompare(String(i)),"desc"===e&&(l=-l),0!==l)return l}return 0}))}else ae.key&&s.sort(((e,t)=>{let a,r;return"name"===ae.key?(a="".concat(e.user.firstName," ").concat(e.user.lastName),r="".concat(t.user.firstName," ").concat(t.user.lastName)):"startTime"===ae.key?(a=e.startTime.getTime(),r=t.startTime.getTime()):"duration"===ae.key?(a=e.totalDuration,r=t.totalDuration):"branch"===ae.key?(a=e.branch.name,r=t.branch.name):(a=e[ae.key],r=t[ae.key]),a<r?"asc"===ae.direction?-1:1:a>r?"asc"===ae.direction?1:-1:0}));return s}),[a,t,ee,ae,N,xe,ge,Oe,Ge,_e,ze]),tt=(e,t)=>{const a=(null===ae||void 0===ae?void 0:ae.key)===e;return(0,A.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer group relative",onClick:()=>{return t=e,void re((e=>({key:t,direction:e.key===t&&"asc"===e.direction?"desc":"asc"})));var t},draggable:!0,onDragStart:()=>Ze(e),onDragOver:Qe,onDrop:t=>$e(t,e),onDragEnd:Je,children:(0,A.jsxs)("div",{className:"flex items-center ".concat(le===e?"opacity-50":""),children:[(0,A.jsx)(g.A,{className:"h-3 w-3 mr-1 text-gray-400 dark:text-gray-500"}),t," ",a&&("asc"===ae.direction?"\u2191":"\u2193")]})},e)};r.useEffect((()=>{(async()=>{try{const e=localStorage.getItem("token");if(!e)return void console.error("Nicht authentifiziert");const t=(await l.A.get("".concat(d.Sn.SAVED_FILTERS.BY_TABLE(V)),{headers:{Authorization:"Bearer ".concat(e)}})).data||[],a=t.some((e=>"Aktive"===e.name||e.name===U("teamWorktime.filters.active")||"Active"===e.name||"Activo"===e.name)),r=t.some((e=>"Alle"===e.name||e.name===U("teamWorktime.filters.all")||"All"===e.name||"Todos"===e.name));if(!a){const t={tableId:V,name:U("teamWorktime.filters.active"),conditions:[{column:"hasActiveWorktime",operator:"equals",value:"true"}],operators:[]};await l.A.post("".concat(d.Sn.SAVED_FILTERS.BASE),t,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),console.log("Aktive-Filter f\xfcr Workcenter erstellt")}if(!r){const t={tableId:V,name:U("teamWorktime.filters.all"),conditions:[],operators:[]};await l.A.post("".concat(d.Sn.SAVED_FILTERS.BASE),t,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),console.log("Alle-Filter f\xfcr Workcenter erstellt")}}catch(e){console.error("Fehler beim Erstellen der Standard-Filter:",e)}})()}),[U]),r.useEffect((()=>{(async()=>{try{const e=await l.A.get(d.Sn.SAVED_FILTERS.BY_TABLE(V)),t=e.data.find((e=>e.name===U("teamWorktime.filters.active")||"Aktive"===e.name||"Active"===e.name||"Activo"===e.name));t&&(pe(U("teamWorktime.filters.active")),fe(t.id),at(t.conditions,t.operators))}catch(e){console.error("Fehler beim Setzen des initialen Filters:",e)}})()}),[U]);const at=(e,t)=>{ue(e),he(t)},rt=()=>{ue([]),he([]),pe(""),fe(null)},st=(0,r.useMemo)((()=>{const e=new Date;e.setHours(0,0,0,0);const[t,a,r]=N.split("-").map(Number),s=new Date(t,a-1,r);return s.setHours(0,0,0,0),s.getTime()<e.getTime()}),[N]);return(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{className:"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6",children:[(0,A.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{type:"button",onClick:()=>{const[e,t,a]=N.split("-").map(Number),r=new Date(e,t-1,a),s=(0,c.e)(r,1);w((0,n.GP)(s,"yyyy-MM-dd"))},className:"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,A.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,A.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:U("common.previousDay")})]}),(0,A.jsx)("div",{className:"relative w-[180px]",children:(0,A.jsx)("input",{type:"date",id:"date-select",className:"block w-full pl-3 pr-8 py-2 text-base border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:N,onChange:e=>w(e.target.value)})}),st&&(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{type:"button",onClick:()=>{const[e,t,a]=N.split("-").map(Number),r=new Date(e,t-1,a),s=(0,m.f)(r,1);w((0,n.GP)(s,"yyyy-MM-dd"))},className:"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,A.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,A.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:U("common.nextDay")})]})]}),(0,A.jsxs)("div",{className:"flex items-center",children:[(0,A.jsx)("input",{type:"text",className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",placeholder:U("common.searchPlaceholder"),value:ee,onChange:e=>te(e.target.value)}),(0,A.jsxs)("div",{className:"relative group ml-1",children:[(0,A.jsx)("button",{type:"button",className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("cards"===Oe?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""),onClick:()=>qe("table"===Oe?"cards":"table"),children:"table"===Oe?(0,A.jsx)(h.A,{className:"h-5 w-5"}):(0,A.jsx)(b.A,{className:"h-5 w-5"})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:U("table"===Oe?"common.viewAsCards":"common.viewAsTable")})]}),(0,A.jsxs)("div",{className:"relative group ml-1",children:[(0,A.jsxs)("button",{type:"button",className:"p-2 rounded-md ".concat(Xe()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"," relative"),onClick:()=>ie(!se),children:[(0,A.jsx)(p.A,{className:"h-5 w-5"}),Xe()>0&&(0,A.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10",style:{position:"absolute",top:"-0.25rem",right:"-0.25rem"},children:Xe()})]}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:U("common.showFilter")})]}),(0,A.jsx)("div",{className:"ml-1",children:(0,A.jsx)(H.A,{columns:"cards"===Oe?[{id:"name",label:U("teamWorktime.columns.name")},{id:"startTime",label:U("teamWorktime.columns.startTime")},{id:"duration",label:U("teamWorktime.columns.duration")},{id:"pauseTime",label:U("teamWorktime.columns.pauseTime")},{id:"branch",label:U("teamWorktime.columns.branch")}]:Y,visibleColumns:"cards"===Oe?Array.from(_e):Pe.filter((e=>!He.includes(e))),columnOrder:"cards"===Oe?Ge:Pe,onToggleColumnVisibility:e=>{if("cards"===Oe){const t=_[e];if(t){const e=He.includes(t)?He.filter((e=>e!==t)):[...He,t];Fe(e)}}else{const t=He.includes(e)?He.filter((t=>t!==e)):[...He,e];Fe(t)}},onMoveColumn:(e,t)=>{if("cards"===Oe){const a=[...Ge],r=a[e];a.splice(e,1),a.splice(t,0,r);const s=[],i=new Set;a.forEach((e=>{const t=_[e];t&&!i.has(t)&&(i.add(t),s.push(t))})),Y.forEach((e=>{s.includes(e.id)||"actions"===e.id||s.push(e.id)})),Le(s)}else{const a=[...Pe],r=a[e];a.splice(e,1),a.splice(t,0,r),Le(a)}},sortDirections:"cards"===Oe?ze:void 0,onSortDirectionChange:"cards"===Oe?(e,t)=>{Re((a=>(0,o.A)((0,o.A)({},a),{},{[e]:t})))}:void 0,showSortDirection:"cards"===Oe,buttonTitle:U("cards"===Oe?"teamWorktime.sortAndDisplay":"teamWorktime.configureColumns"),modalTitle:U("cards"===Oe?"teamWorktime.sortAndDisplay":"teamWorktime.configureColumns"),onClose:()=>{}})})]})]}),se&&(0,A.jsx)("div",{className:"cards"===Oe?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,A.jsx)(I.A,{columns:[{id:"name",label:U("teamWorktime.columns.name")},{id:"branch",label:U("teamWorktime.columns.branch")},{id:"hasActiveWorktime",label:U("worktime.active")},{id:"duration",label:U("teamWorktime.columns.duration")}],onApply:at,onReset:rt,savedConditions:xe,savedOperators:ge,tableId:V})}),(0,A.jsx)("div",{className:"cards"===Oe?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,A.jsx)(L.A,{tableId:V,onSelectFilter:at,onReset:rt,activeFilterName:be,selectedFilterId:ye,onFilterChange:(e,t,a,r)=>{pe(e),fe(t),at(a,r)},defaultFilterName:U("teamWorktime.filters.active")})}),"table"===Oe?(0,A.jsx)("div",{className:"dashboard-workcenter-wrapper border-0 rounded-lg overflow-hidden -mx-3 sm:-mx-4 md:-mx-6",children:(0,A.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,A.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,A.jsx)("tr",{children:Pe.filter((e=>!He.includes(e))).map((e=>{const t=Y.find((t=>t.id===e));return t?"actions"===e?(0,A.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",draggable:!0,onDragStart:()=>Ze(e),onDragOver:Qe,onDrop:t=>$e(t,e),onDragEnd:Je,children:t.label},e):tt(e,t.label):null}))})}),(0,A.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:0===et.length?(0,A.jsx)("tr",{children:(0,A.jsx)("td",{colSpan:Pe.filter((e=>!He.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"Keine Zeiterfassungen gefunden"})}):et.slice(0,ce).map((e=>{const t=e.endTime?e.endTime.getTime()-e.startTime.getTime()-e.totalDuration:0,a=ke[e.user.id]||null,s=je[e.user.id]||null,i=we.has(e.user.id),l=T&&a&&a.total>0||D&&s&&s.total>0;return(0,A.jsxs)(r.Fragment,{children:[(0,A.jsx)("tr",{children:Pe.filter((e=>!He.includes(e))).map((a=>"name"===a?(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,A.jsx)("div",{className:"flex items-center",children:(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[e.user.firstName," ",e.user.lastName]}),(0,A.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.user.username})]})})},a):"startTime"===a?(0,A.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,A.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:(0,n.GP)(e.startTime,"dd.MM.yyyy")}),(0,A.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:(0,n.GP)(e.startTime,"HH:mm:ss")})]},a):"duration"===a?(0,A.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,A.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:(0,x.m)(new Date(Date.now()-e.totalDuration),{locale:u.de,addSuffix:!1})})},a):"pauseTime"===a?(0,A.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,A.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:t>0?(0,x.m)(new Date(Date.now()-t),{locale:u.de,addSuffix:!1}):"-"})},a):"branch"===a?(0,A.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name},a):"actions"===a?(0,A.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,A.jsxs)("div",{className:"flex flex-row space-x-2 justify-end items-center",children:[e.hasActiveWorktime&&(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{onClick:()=>Ve(e),className:"p-1 bg-red-600 text-white rounded hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600",children:(0,A.jsx)(y.A,{className:"h-5 w-5 text-white fill-white"})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:U("teamWorktime.actions.stopTracking")})]}),De("team_worktime_control","both","page")&&De("team_worktime","both","table")&&(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{onClick:()=>Ye(e),className:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 edit-button",children:(0,A.jsx)(f.A,{className:"h-5 w-5"})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:U("teamWorktime.actions.editWorktimes")})]})]})},a):null))}),(T||D)&&l&&(0,A.jsx)("tr",{className:"bg-gray-50 dark:bg-gray-800/50",children:(0,A.jsx)("td",{colSpan:Pe.filter((e=>!He.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-3",children:(0,A.jsxs)("div",{className:"ml-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4",children:[T&&a&&a.total>0&&(0,A.jsxs)("div",{className:"mb-3",children:[(0,A.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,A.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["To-Dos (",N,"): ",a.completed," erledigt | ",a.open," offen | ",a.inProgress," in Bearbeitung"]}),(0,A.jsx)("button",{onClick:()=>Ee(e.user.id),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:i?"Weniger anzeigen \u25b2":"Details anzeigen \u25bc"})]}),i&&a.details&&a.details.length>0&&(0,A.jsx)("div",{className:"mt-2 space-y-1",children:a.details.map((e=>(0,A.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,A.jsx)("span",{className:"done"===e.status?"text-green-600 dark:text-green-400":"text-gray-400",children:"done"===e.status?"\u2713":"\u25cb"}),(0,A.jsx)("span",{className:"font-medium",children:e.title}),(0,A.jsxs)("span",{className:"text-gray-400",children:["(",e.status,")"]}),(0,A.jsxs)("span",{className:"text-gray-400",children:["- ",(0,n.GP)(new Date(e.updatedAt),"HH:mm")]})]},e.id)))})]}),D&&s&&s.total>0&&(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,A.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Requests (",N,"): ",s.approved," genehmigt | ",s.pending," offen"]}),!T&&(0,A.jsx)("button",{onClick:()=>Ee(e.user.id),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:i?"Weniger anzeigen \u25b2":"Details anzeigen \u25bc"})]}),i&&s.details&&s.details.length>0&&(0,A.jsx)("div",{className:"mt-2 space-y-1",children:s.details.map((e=>(0,A.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,A.jsx)("span",{className:"approved"===e.status?"text-green-600 dark:text-green-400":"text-gray-400",children:"approved"===e.status?"\u2713":"\u25cb"}),(0,A.jsx)("span",{className:"font-medium",children:e.title}),(0,A.jsxs)("span",{className:"text-gray-400",children:["(",e.status,")"]}),(0,A.jsxs)("span",{className:"text-gray-400",children:["- ",(0,n.GP)(new Date(e.createdAt),"HH:mm")]})]},e.id)))})]})]})})})]},e.user.id)}))})]})}):(0,A.jsx)("div",{className:"dashboard-workcenter-wrapper -mx-3 sm:-mx-4 md:-mx-6",children:0===et.length?(0,A.jsx)("div",{className:"text-center py-8 text-sm text-gray-500 dark:text-gray-400",children:"Keine Zeiterfassungen gefunden"}):(0,A.jsx)(z.A,{gap:"md",children:et.slice(0,ce).map((e=>{const t=e.endTime?e.endTime.getTime()-e.startTime.getTime()-e.totalDuration:0,a=ke[e.user.id]||null,r=je[e.user.id]||null,s=we.has(e.user.id),i=T&&a&&a.total>0||D&&r&&r.total>0,l=[],d=[],o=[];_e.has("name")&&d.push({label:"Name",value:"".concat(e.user.firstName," ").concat(e.user.lastName," (").concat(e.user.username,")"),icon:(0,A.jsx)(k.A,{className:"h-4 w-4"})}),_e.has("startTime")&&d.push({label:"Startzeit",value:"".concat((0,n.GP)(e.startTime,"dd.MM.yyyy")," ").concat((0,n.GP)(e.startTime,"HH:mm:ss")),icon:(0,A.jsx)(v.A,{className:"h-4 w-4"})}),_e.has("duration")&&o.push({label:"Arbeitszeit",value:(0,x.m)(new Date(Date.now()-e.totalDuration),{locale:u.de,addSuffix:!1}),icon:(0,A.jsx)(v.A,{className:"h-4 w-4"})}),_e.has("pauseTime")&&o.push({label:"Pausen",value:t>0?(0,x.m)(new Date(Date.now()-t),{locale:u.de,addSuffix:!1}):"-",icon:(0,A.jsx)(v.A,{className:"h-4 w-4"})}),_e.has("branch")&&l.push({label:"Niederlassung",value:e.branch.name,icon:(0,A.jsx)(j.A,{className:"h-4 w-4"})});const c=(0,A.jsxs)("div",{className:"flex flex-row space-x-2 justify-end items-center",children:[e.hasActiveWorktime&&(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{onClick:()=>Ve(e),className:"p-1 bg-red-600 text-white rounded hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600",children:(0,A.jsx)(y.A,{className:"h-5 w-5 text-white fill-white"})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:U("teamWorktime.actions.stopTracking")})]}),De("team_worktime_control","both","page")&&De("team_worktime","both","table")&&(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{onClick:()=>Ye(e),className:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300",children:(0,A.jsx)(f.A,{className:"h-5 w-5"})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:U("teamWorktime.actions.editWorktimes")})]})]}),m=i?(0,A.jsxs)("div",{children:[T&&a&&a.total>0&&(0,A.jsxs)("div",{className:"mb-3",children:[(0,A.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["To-Dos (",N,"): ",a.completed," erledigt | ",a.open," offen | ",a.inProgress," in Bearbeitung"]}),a.details&&a.details.length>0&&(0,A.jsx)("div",{className:"mt-2 space-y-1",children:a.details.map((e=>(0,A.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,A.jsx)("span",{className:"done"===e.status?"text-green-600 dark:text-green-400":"text-gray-400",children:"done"===e.status?"\u2713":"\u25cb"}),(0,A.jsx)("span",{className:"font-medium",children:e.title}),(0,A.jsxs)("span",{className:"text-gray-400",children:["(",e.status,")"]}),(0,A.jsxs)("span",{className:"text-gray-400",children:["- ",(0,n.GP)(new Date(e.updatedAt),"HH:mm")]})]},e.id)))})]}),D&&r&&r.total>0&&(0,A.jsxs)("div",{children:[(0,A.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Requests (",N,"): ",r.approved," genehmigt | ",r.pending," offen"]}),r.details&&r.details.length>0&&(0,A.jsx)("div",{className:"mt-2 space-y-1",children:r.details.map((e=>(0,A.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,A.jsx)("span",{className:"approved"===e.status?"text-green-600 dark:text-green-400":"text-gray-400",children:"approved"===e.status?"\u2713":"\u25cb"}),(0,A.jsx)("span",{className:"font-medium",children:e.title}),(0,A.jsxs)("span",{className:"text-gray-400",children:["(",e.status,")"]}),(0,A.jsxs)("span",{className:"text-gray-400",children:["- ",(0,n.GP)(new Date(e.createdAt),"HH:mm")]})]},e.id)))})]})]}):null;return(0,A.jsxs)(O.A,{title:"".concat(e.user.firstName," ").concat(e.user.lastName),metadata:l,actions:c,expandable:m?{isExpanded:s,content:m,onToggle:()=>Ee(e.user.id)}:void 0,children:[d.length>0&&(0,A.jsx)("div",{className:"flex flex-wrap items-center gap-3 sm:gap-4 mb-3 sm:mb-4",children:d.map(((e,t)=>(0,A.jsxs)("div",{className:"flex items-center gap-1 sm:gap-1.5 text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl 2xl:text-2xl text-gray-600 dark:text-gray-400",children:[e.icon&&(0,A.jsx)("span",{className:"flex-shrink-0",children:e.icon}),(0,A.jsxs)("span",{className:"font-medium mr-1 whitespace-nowrap",children:[e.label,":"]}),(0,A.jsx)("span",{className:e.className||"text-gray-900 dark:text-white",children:(e.value,e.value)})]},t)))}),o.length>0&&(0,A.jsx)("div",{className:"flex flex-col gap-2 mb-3 sm:mb-4",children:o.map(((e,t)=>(0,A.jsxs)("div",{className:"flex items-center gap-1 sm:gap-1.5 text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl 2xl:text-2xl text-gray-600 dark:text-gray-400",children:[e.icon&&(0,A.jsx)("span",{className:"flex-shrink-0",children:e.icon}),(0,A.jsxs)("span",{className:"font-medium mr-1 whitespace-nowrap",children:[e.label,":"]}),(0,A.jsx)("span",{className:e.className||"text-gray-900 dark:text-white",children:(e.value,e.value)})]},t)))})]},e.user.id)}))})}),et.length>ce&&(0,A.jsx)("div",{className:"mt-4 flex justify-center",children:(0,A.jsxs)("button",{className:"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-blue-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600",onClick:()=>me((e=>e+10)),children:["Mehr anzeigen (",et.length-ce," verbleibend)"]})}),K&&J&&(0,A.jsx)(C,{isOpen:K,onClose:Ue,onConfirm:async e=>{if(!J)return;const t=J.activeEntries.length>0?J.activeEntries.reduce(((e,t)=>{const a=(0,P.IF)(e.startTime);return(0,P.IF)(t.startTime)>a?t:e}),J.activeEntries[0]):null;t?await S(t.user.id,e):await S(J.user.id,e),Ue()},userName:"".concat(J.user.firstName," ").concat(J.user.lastName)}),Q&&J&&(0,A.jsx)(E,{isOpen:Q,onClose:Ke,onSave:async e=>{try{await(async e=>{try{const t=e.filter((e=>!e.isDeleted)),a=e.filter((e=>e.isDeleted)).map((e=>e.id)),r=t.map((e=>l.A.put("/worktime/".concat(e.id),{startTime:e.startTime,endTime:e.endTime}))),s=a.map((e=>l.A.delete("/worktime/".concat(e))));return await Promise.all([...r,...s]),{success:!0}}catch(t){throw console.error("Fehler beim Aktualisieren der Zeiterfassungen:",t),t}})(e),W(),alert(U("teamWorktime.messages.saveSuccess")),Ke()}catch(t){console.error("Fehler beim Aktualisieren der Zeiterfassungen:",t);let e=U("teamWorktime.messages.unknownError");t.response?401===t.response.status?e=U("teamWorktime.messages.unauthorized"):403===t.response.status?e=U("teamWorktime.messages.forbidden"):404===t.response.status?e=U("teamWorktime.messages.notFound"):500===t.response.status?e=U("teamWorktime.messages.serverError"):t.response.data&&t.response.data.message&&(e=t.response.data.message):e=t.request?U("teamWorktime.messages.noResponse"):t.message||U("teamWorktime.messages.error"),alert(U("teamWorktime.messages.saveError")+" "+e)}},userName:"".concat(J.user.firstName," ").concat(J.user.lastName),entries:J.entries,selectedDate:N})]})};var Y=a(1369),K=a(3332),Z=a(2517),Q=a(3315);const $="todo-analytics-table",J=["time","title","status","responsible","qualityControl","branch"],X=e=>{let{selectedDate:t}=e;const{t:a}=(0,s.Bd)(),[i,o]=(0,r.useState)([]),[c,m]=(0,r.useState)(!1),[x,u]=(0,r.useState)(null),[g,y]=(0,r.useState)(""),[f,N]=(0,r.useState)([]),[w,S]=(0,r.useState)([]),[T,C]=(0,r.useState)(""),[D,E]=(0,r.useState)(null),[F,q]=(0,r.useState)(!1),{settings:P,isLoading:H,updateColumnOrder:R,updateHiddenColumns:G,toggleColumnVisibility:B,isColumnVisible:_,updateViewMode:V}=(0,M.F)($,{defaultColumnOrder:J,defaultViewMode:"table"}),U=(null===P||void 0===P?void 0:P.columnOrder)||J,X=(null===P||void 0===P?void 0:P.hiddenColumns)||[],ee=U.filter((e=>!X.includes(e))),te=(null===P||void 0===P?void 0:P.viewMode)||"table",[ae,re]=(0,r.useState)(te);(0,r.useEffect)((()=>{null!==P&&void 0!==P&&P.viewMode&&P.viewMode!==ae&&re(P.viewMode)}),[null===P||void 0===P?void 0:P.viewMode]);const[se,ie]=(0,r.useState)(new Set),le=e=>{ie((t=>{const a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a}))},[de,ne]=(0,r.useState)(null),[oe,ce]=(0,r.useState)(!1),[me,xe]=(0,r.useState)(!1),[ue,ge]=(0,r.useState)(null),[he,be]=(0,r.useState)(!1),[pe,ye]=(0,r.useState)(!1),[fe,ke]=(0,r.useState)(new Set),ve=(0,r.useMemo)((()=>[{id:"time",label:a("analytics.todo.columns.time")},{id:"title",label:a("analytics.todo.columns.title")},{id:"status",label:a("analytics.todo.columns.status")},{id:"responsible",label:a("analytics.todo.columns.responsible")},{id:"qualityControl",label:a("analytics.todo.columns.qualityControl")},{id:"branch",label:a("analytics.todo.columns.branch")}]),[a]);(0,r.useEffect)((()=>{t&&(async()=>{try{m(!0),u(null);const e={date:t};f.forEach((t=>{"branch"===t.column&&t.value&&(e.branchId=t.value),"responsible"===t.column&&t.value&&(e.userId=t.value),"status"===t.column&&t.value}));const a=await l.A.get(d.Sn.TEAM_WORKTIME.ANALYTICS.TODOS_CHRONOLOGICAL,{params:e});o(a.data||[])}catch(x){console.error("Fehler beim Laden der To-Dos:",x),u(a("analytics.todo.loadError"))}finally{m(!1)}})()}),[t,f]),(0,r.useEffect)((()=>{(async()=>{if(t&&me)try{ce(!0);const e=await l.A.get(d.Sn.TEAM_WORKTIME.ANALYTICS.TODOS_FREQUENCY,{params:{date:t}});ne(e.data)}catch(x){console.error("Fehler beim Laden der H\xe4ufigkeitsanalyse:",x)}finally{ce(!1)}})()}),[t,me]),(0,r.useEffect)((()=>{(async()=>{if(t&&pe)try{be(!0);const e=await l.A.get(d.Sn.TEAM_WORKTIME.ANALYTICS.TODOS_SHIFTS,{params:{date:t}});ge(e.data)}catch(x){console.error("Fehler beim Laden der Schicht-Analyse:",x)}finally{be(!1)}})()}),[t,pe]);const je=(0,r.useCallback)(((e,t)=>{N(e),S(t),q(!1)}),[]),Ne=(0,r.useCallback)((()=>{N([]),S([]),C(""),E(null)}),[]),we=(0,r.useCallback)(((e,t,a,r)=>{C(e),E(t),je(a,r)}),[je]),Se=(0,r.useCallback)((()=>f.filter((e=>""!==e.column&&null!==e.value)).length),[f]),We=e=>{switch(e){case"done":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"in_progress":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400";case"quality_control":return"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400";case"open":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"improval":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},Te=e=>({done:"Erledigt",in_progress:"In Bearbeitung",quality_control:"Qualit\xe4tskontrolle",open:"Offen",improval:"Nachbesserung"}[e]||e),Ae=(0,r.useMemo)((()=>{let e=[...i];if(g){const t=g.toLowerCase();e=e.filter((e=>e.title.toLowerCase().includes(t)||e.branch.name.toLowerCase().includes(t)||e.responsible&&"".concat(e.responsible.firstName," ").concat(e.responsible.lastName).toLowerCase().includes(t)))}return f.forEach(((t,a)=>{if(""===t.column||null===t.value)return;const r=t.operator||"equals",s=t.value;e=e.filter((e=>{switch(t.column){case"status":return"equals"!==r||e.status===s;case"title":return"contains"!==r||e.title.toLowerCase().includes(String(s).toLowerCase());default:return!0}}))})),e}),[i,g,f]),Ce=(0,r.useMemo)((()=>({total:Ae.length,done:Ae.filter((e=>"done"===e.status)).length,inProgress:Ae.filter((e=>"in_progress"===e.status)).length,open:Ae.filter((e=>"open"===e.status)).length,qualityControl:Ae.filter((e=>"quality_control"===e.status)).length,improval:Ae.filter((e=>"improval"===e.status)).length})),[Ae]);return x?(0,A.jsx)("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded",children:x}):(0,A.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 todo-analytics-wrapper",children:[(0,A.jsxs)("div",{className:"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6",children:[(0,A.jsxs)("div",{className:"flex items-center",children:[(0,A.jsx)(Y.A,{className:"h-6 w-6 mr-2 dark:text-white"}),(0,A.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:a("analytics.todo.title")})]}),(0,A.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,A.jsx)("input",{type:"text",placeholder:a("common.searchPlaceholder"),className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:g,onChange:e=>y(e.target.value)}),(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("cards"===ae?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""),onClick:()=>{const e="table"===ae?"cards":"table";re(e),V&&V(e)},children:"table"===ae?(0,A.jsx)(h.A,{className:"h-5 w-5"}):(0,A.jsx)(b.A,{className:"h-5 w-5"})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("table"===ae?"common.viewAsCards":"common.viewAsTable")})]}),(0,A.jsxs)("div",{className:"relative group ml-1",children:[(0,A.jsxs)("button",{className:"p-2 rounded-md ".concat(Se()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"," relative"),onClick:()=>q(!F),style:{position:"relative"},children:[(0,A.jsx)(p.A,{className:"h-5 w-5"}),Se()>0&&(0,A.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10",children:Se()})]}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("common.filter")})]})]})]}),F&&(0,A.jsx)("div",{className:"cards"===ae?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,A.jsx)(I.A,{columns:ve,onApply:je,onReset:Ne,savedConditions:f,savedOperators:w,tableId:$})}),(0,A.jsx)("div",{className:"cards"===ae?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,A.jsx)(L.A,{tableId:$,onSelectFilter:je,onReset:Ne,activeFilterName:T,selectedFilterId:D,onFilterChange:we,defaultFilterName:a("teamWorktime.filters.all")})}),(0,A.jsxs)("div",{className:"mb-4 flex items-center gap-2",children:[(0,A.jsxs)("button",{onClick:()=>xe(!me),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,A.jsx)(W.A,{className:"h-4 w-4 transition-transform ".concat(me?"rotate-180":"")}),a("analytics.todo.frequencyAnalysis")," ",a(me?"common.collapse":"common.expand")]}),(0,A.jsxs)("button",{onClick:()=>ye(!pe),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,A.jsx)(v.A,{className:"h-4 w-4 transition-transform ".concat(pe?"rotate-180":"")}),a("analytics.todo.shiftAnalysis")," ",a(pe?"common.collapse":"common.expand")]})]}),me&&(0,A.jsxs)("div",{className:"mb-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,A.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,A.jsx)(W.A,{className:"h-5 w-5"}),a("analytics.todo.frequencyAnalysis")]}),oe?(0,A.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,A.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:a("analytics.todo.loadingAnalysis")})}):de?(0,A.jsxs)("div",{className:"space-y-6",children:[(0,A.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,A.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:[(0,A.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:a("analytics.todo.frequency.totalTodos")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:de.summary.totalTasks})]}),(0,A.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800",children:[(0,A.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:a("analytics.todo.frequency.completed")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:de.summary.completedTasks})]}),(0,A.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800",children:[(0,A.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:a("analytics.todo.frequency.neverCompleted")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:de.summary.neverCompletedTasks})]}),(0,A.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-800",children:[(0,A.jsx)("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:a("analytics.todo.frequency.completionRate")}),(0,A.jsxs)("div",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300",children:[de.summary.completionRate,"%"]})]})]}),de.userStats&&de.userStats.length>0&&(0,A.jsxs)("div",{children:[(0,A.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.frequency.completionsPerUser")}),(0,A.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,A.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,A.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.user")}),(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.completed")}),(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.lastCompletion")})]})}),(0,A.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:de.userStats.slice(0,10).map((e=>(0,A.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.user?"".concat(e.user.firstName," ").concat(e.user.lastName):a("analytics.todo.unknown")}),(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.completedCount}),(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.lastCompletedAt?(0,n.GP)(new Date(e.lastCompletedAt),"HH:mm"):"-"})]},e.userId)))})]})})]}),de.taskStats&&de.taskStats.length>0&&(0,A.jsxs)("div",{children:[(0,A.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.frequency.frequentCompleted")}),(0,A.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,A.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,A.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.title")}),(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.status")}),(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.branch")}),(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.completed")})]})}),(0,A.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:de.taskStats.slice(0,20).map((e=>(0,A.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800 ".concat(e.neverCompleted?"bg-red-50 dark:bg-red-900/10":""),children:[(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:e.title}),(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,A.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(We(e.currentStatus)),children:Te(e.currentStatus)})}),(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name}),(0,A.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.completedCount,"x ",e.neverCompleted&&(0,A.jsx)("span",{className:"text-red-600 dark:text-red-400",children:a("analytics.todo.never")})]})]},e.taskId)))})]})})]}),de.statusAverages&&Object.keys(de.statusAverages).length>0&&(0,A.jsxs)("div",{children:[(0,A.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.frequency.averageTimePerStatus")}),(0,A.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:Object.entries(de.statusAverages).map((e=>{let[t,a]=e;return(0,A.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[(0,A.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:Te(t)}),(0,A.jsxs)("div",{className:"text-xl font-bold text-gray-900 dark:text-white",children:[a.averageHours.toFixed(1),"h"]}),(0,A.jsxs)("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:[a.taskCount," To-Do(s)"]})]},t)}))})]}),de.summary&&(0,A.jsxs)("div",{children:[(0,A.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.frequency.statusDistribution")}),(0,A.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:(0,A.jsxs)("div",{className:"relative",style:{height:"200px"},children:[(0,A.jsxs)("div",{className:"absolute right-0 h-full flex flex-col justify-between text-xs text-gray-500 dark:text-gray-400 pr-1",children:[(0,A.jsx)("span",{children:de.summary.totalTasks}),(0,A.jsx)("span",{children:Math.round(.75*de.summary.totalTasks)}),(0,A.jsx)("span",{children:Math.round(.5*de.summary.totalTasks)}),(0,A.jsx)("span",{children:Math.round(.25*de.summary.totalTasks)}),(0,A.jsx)("span",{children:"0"})]}),(0,A.jsxs)("div",{className:"absolute inset-0 flex flex-col justify-between pointer-events-none pr-8",children:[(0,A.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,A.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,A.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,A.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,A.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})]}),(0,A.jsxs)("div",{className:"absolute inset-0 flex items-end justify-around gap-2 pr-8 pb-1",children:[(0,A.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,A.jsxs)("div",{className:"relative group w-full",children:[(0,A.jsx)("div",{className:"w-full bg-green-500 dark:bg-green-600 rounded-t",style:{height:"".concat(de.summary.completedTasks>0?de.summary.completedTasks/de.summary.totalTasks*100:0,"%"),minHeight:de.summary.completedTasks>0?"4px":"0px"}}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("analytics.todo.frequency.completed"),": ").concat(de.summary.completedTasks)})]}),(0,A.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium",children:a("analytics.todo.frequency.completed")}),(0,A.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:de.summary.completedTasks})]}),(0,A.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,A.jsxs)("div",{className:"relative group w-full",children:[(0,A.jsx)("div",{className:"w-full bg-yellow-500 dark:bg-yellow-600 rounded-t",style:{height:"".concat(de.summary.totalTasks-de.summary.completedTasks-de.summary.neverCompletedTasks>0?(de.summary.totalTasks-de.summary.completedTasks-de.summary.neverCompletedTasks)/de.summary.totalTasks*100:0,"%"),minHeight:de.summary.totalTasks-de.summary.completedTasks-de.summary.neverCompletedTasks>0?"4px":"0px"}}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("tasks.status.open"),": ").concat(de.summary.totalTasks-de.summary.completedTasks-de.summary.neverCompletedTasks)})]}),(0,A.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium",children:a("tasks.status.open")}),(0,A.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:de.summary.totalTasks-de.summary.completedTasks-de.summary.neverCompletedTasks})]}),(0,A.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,A.jsxs)("div",{className:"relative group w-full",children:[(0,A.jsx)("div",{className:"w-full bg-red-500 dark:bg-red-600 rounded-t",style:{height:"".concat(de.summary.neverCompletedTasks>0?de.summary.neverCompletedTasks/de.summary.totalTasks*100:0,"%"),minHeight:de.summary.neverCompletedTasks>0?"4px":"0px"}}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("analytics.todo.frequency.neverCompleted"),": ").concat(de.summary.neverCompletedTasks)})]}),(0,A.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium",children:a("analytics.todo.frequency.neverCompleted")}),(0,A.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:de.summary.neverCompletedTasks})]})]})]})})]})]}):(0,A.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:a("analytics.todo.noData")})]}),pe&&(0,A.jsxs)("div",{className:"mb-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,A.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,A.jsx)(v.A,{className:"h-5 w-5"}),a("analytics.todo.shift.shiftBased")]}),he?(0,A.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,A.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:a("analytics.todo.loadingAnalysis")})}):ue?(0,A.jsxs)("div",{className:"space-y-6",children:[(0,A.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,A.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:[(0,A.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:a("analytics.todo.shift.totalShifts")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:ue.summary.totalShifts})]}),(0,A.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800",children:[(0,A.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:a("analytics.todo.shift.todosInShifts")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:ue.summary.totalTasksInShifts})]}),(0,A.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-800",children:[(0,A.jsx)("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:a("analytics.todo.shift.totalHours")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300",children:ue.summary.totalDurationHours||"0.00"})]}),(0,A.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800",children:[(0,A.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:a("analytics.todo.shift.averageDuration")}),(0,A.jsxs)("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:[ue.summary.averageDurationHours||"-","h"]})]}),(0,A.jsxs)("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-4 border border-indigo-200 dark:border-indigo-800",children:[(0,A.jsx)("div",{className:"text-sm text-indigo-600 dark:text-indigo-400",children:a("analytics.todo.shift.averageTodosPerShift")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-indigo-700 dark:text-indigo-300",children:ue.summary.totalShifts>0?(ue.summary.totalTasksInShifts/ue.summary.totalShifts).toFixed(1):"0"})]})]}),ue.shifts&&ue.shifts.length>0&&(0,A.jsxs)("div",{children:[(0,A.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.shift.shiftsWithTodos")}),(0,A.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,A.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,A.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.user")}),(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.branch")}),(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.shift.time")}),(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.shift.duration")}),(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.title")})]})}),(0,A.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:ue.shifts.map((e=>{const t=fe.has(e.workTimeId);return(0,A.jsxs)(r.Fragment,{children:[(0,A.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,A.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:[e.user.firstName," ",e.user.lastName]}),(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name}),(0,A.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[(0,n.GP)(new Date(e.startTime),"HH:mm"),e.endTime&&" - ".concat((0,n.GP)(new Date(e.endTime),"HH:mm"))]}),(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.durationHours?"".concat(e.durationHours,"h"):a("worktime.running")}),(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(0,A.jsxs)("div",{className:"flex items-center gap-2",children:[(0,A.jsx)("span",{children:e.linkedTasksCount}),e.linkedTasksCount>0&&(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{onClick:()=>{return t=e.workTimeId,void ke((e=>{const a=new Set(e);return a.has(t)?a.delete(t):a.add(t),a}));var t},className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:t?(0,A.jsx)(K.A,{className:"h-4 w-4"}):(0,A.jsx)(Z.A,{className:"h-4 w-4"})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("analytics.todo.shift.showTodos")})]})]})})]}),t&&e.linkedTasksCount>0&&(0,A.jsx)("tr",{className:"bg-gray-50 dark:bg-gray-800/50",children:(0,A.jsx)("td",{colSpan:5,className:"px-3 sm:px-4 md:px-6 py-4",children:(0,A.jsxs)("div",{className:"ml-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4",children:[(0,A.jsx)("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:a("analytics.todo.shift.linkedTasks")}),(0,A.jsx)("div",{className:"space-y-2",children:e.linkedTasks.map((e=>(0,A.jsxs)("div",{className:"flex items-center gap-3 text-xs text-gray-600 dark:text-gray-400",children:[(0,A.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(We(e.status)),children:Te(e.status)}),(0,A.jsx)("span",{className:"font-medium",children:e.title}),e.responsible&&(0,A.jsxs)("span",{className:"text-gray-400",children:["(",e.responsible.firstName," ",e.responsible.lastName,")"]})]},e.id)))})]})})})]},e.workTimeId)}))})]})})]}),ue.tasksWithShifts&&ue.tasksWithShifts.length>0&&(0,A.jsxs)("div",{children:[(0,A.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.shift.tasksWithShiftDistribution")}),(0,A.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,A.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,A.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.title")}),(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.status")}),(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.shift.totalShifts")}),(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.shift.totalTime")})]})}),(0,A.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:ue.tasksWithShifts.slice(0,30).map((e=>(0,A.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:e.task.title}),(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,A.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(We(e.task.status)),children:Te(e.task.status)})}),(0,A.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.shiftCount,"x"]}),(0,A.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.totalDurationHours,"h"]})]},e.task.id)))})]})})]})]}):(0,A.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:a("analytics.todo.noShiftData")})]}),(0,A.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6",children:[(0,A.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[(0,A.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("analytics.todo.stats.total")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:Ce.total})]}),(0,A.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800",children:[(0,A.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:a("analytics.todo.frequency.completed")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:Ce.done})]}),(0,A.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:[(0,A.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:a("analytics.todo.stats.inProgress")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:Ce.inProgress})]}),(0,A.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-800",children:[(0,A.jsx)("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:a("analytics.todo.stats.qualityControl")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300",children:Ce.qualityControl})]}),(0,A.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800",children:[(0,A.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:a("tasks.status.open")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:Ce.open})]}),(0,A.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4 border border-red-200 dark:border-red-800",children:[(0,A.jsx)("div",{className:"text-sm text-red-600 dark:text-red-400",children:a("tasks.status.improval")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-red-700 dark:text-red-300",children:Ce.improval})]})]}),Ae.length>0&&(0,A.jsxs)("div",{className:"mb-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,A.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,A.jsx)(Q.A,{className:"h-5 w-5"}),a("analytics.todo.statusDistribution")]}),(0,A.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:(0,A.jsxs)("div",{className:"relative",style:{height:"200px"},children:[(0,A.jsxs)("div",{className:"absolute right-0 h-full flex flex-col justify-between text-xs text-gray-500 dark:text-gray-400 pr-1",children:[(0,A.jsx)("span",{children:Ce.total}),(0,A.jsx)("span",{children:Math.round(.75*Ce.total)}),(0,A.jsx)("span",{children:Math.round(.5*Ce.total)}),(0,A.jsx)("span",{children:Math.round(.25*Ce.total)}),(0,A.jsx)("span",{children:"0"})]}),(0,A.jsxs)("div",{className:"absolute inset-0 flex flex-col justify-between pointer-events-none pr-8",children:[(0,A.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,A.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,A.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,A.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,A.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})]}),(0,A.jsxs)("div",{className:"absolute inset-0 flex items-end justify-around gap-1 sm:gap-2 pr-8 pb-1",children:[(0,A.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,A.jsxs)("div",{className:"relative group w-full",children:[(0,A.jsx)("div",{className:"w-full bg-green-500 dark:bg-green-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(Ce.total>0?Ce.done/Ce.total*100:0,"%"),minHeight:Ce.done>0?"4px":"0px"}}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("analytics.todo.frequency.completed"),": ").concat(Ce.done)})]}),(0,A.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("analytics.todo.frequency.completed")}),(0,A.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:Ce.done})]}),(0,A.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,A.jsxs)("div",{className:"relative group w-full",children:[(0,A.jsx)("div",{className:"w-full bg-blue-500 dark:bg-blue-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(Ce.total>0?Ce.inProgress/Ce.total*100:0,"%"),minHeight:Ce.inProgress>0?"4px":"0px"}}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("analytics.todo.stats.inProgress"),": ").concat(Ce.inProgress)})]}),(0,A.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("analytics.todo.stats.inProgress")}),(0,A.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:Ce.inProgress})]}),(0,A.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,A.jsxs)("div",{className:"relative group w-full",children:[(0,A.jsx)("div",{className:"w-full bg-purple-500 dark:bg-purple-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(Ce.total>0?Ce.qualityControl/Ce.total*100:0,"%"),minHeight:Ce.qualityControl>0?"4px":"0px"}}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("analytics.todo.stats.qualityControl"),": ").concat(Ce.qualityControl)})]}),(0,A.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("analytics.todo.columns.qualityControl")}),(0,A.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:Ce.qualityControl})]}),(0,A.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,A.jsxs)("div",{className:"relative group w-full",children:[(0,A.jsx)("div",{className:"w-full bg-yellow-500 dark:bg-yellow-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(Ce.total>0?Ce.open/Ce.total*100:0,"%"),minHeight:Ce.open>0?"4px":"0px"}}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("tasks.status.open"),": ").concat(Ce.open)})]}),(0,A.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("tasks.status.open")}),(0,A.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:Ce.open})]}),(0,A.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,A.jsxs)("div",{className:"relative group w-full",children:[(0,A.jsx)("div",{className:"w-full bg-red-500 dark:bg-red-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(Ce.total>0?Ce.improval/Ce.total*100:0,"%"),minHeight:Ce.improval>0?"4px":"0px"}}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("tasks.status.improval"),": ").concat(Ce.improval)})]}),(0,A.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("tasks.status.improval")}),(0,A.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:Ce.improval})]})]})]})})]}),c?(0,A.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,A.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:a("common.loading")})}):"table"===ae?(0,A.jsx)("div",{className:"overflow-x-auto",children:(0,A.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,A.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,A.jsx)("tr",{children:U.filter((e=>ee.includes(e))).map((e=>{const t=ve.find((t=>t.id===e));return t?(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:t.label},e):null}))})}),(0,A.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:0===Ae.length?(0,A.jsx)("tr",{children:(0,A.jsx)("td",{colSpan:U.filter((e=>ee.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"Keine To-Dos f\xfcr dieses Datum gefunden"})}):Ae.map((e=>{const t=se.has(e.id),a=e.statusHistory&&e.statusHistory.length>0;return(0,A.jsxs)(r.Fragment,{children:[(0,A.jsx)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:U.filter((e=>ee.includes(e))).map((r=>{switch(r){case"time":return(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(0,n.GP)(new Date(e.updatedAt),"HH:mm")},r);case"title":return(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:(0,A.jsxs)("div",{className:"flex items-center gap-2",children:[a&&(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{onClick:()=>le(e.id),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:t?(0,A.jsx)(K.A,{className:"h-4 w-4"}):(0,A.jsx)(Z.A,{className:"h-4 w-4"})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Status-Historie anzeigen"})]}),(0,A.jsx)("span",{children:e.title})]})},r);case"status":return(0,A.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,A.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(We(e.status)),children:Te(e.status)})},r);case"responsible":return(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.responsible?"".concat(e.responsible.firstName," ").concat(e.responsible.lastName):"-"},r);case"qualityControl":return(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.qualityControl?"".concat(e.qualityControl.firstName," ").concat(e.qualityControl.lastName):"-"},r);case"branch":return(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name},r);default:return null}}))}),t&&a&&(0,A.jsx)("tr",{className:"bg-gray-50 dark:bg-gray-800/50",children:(0,A.jsx)("td",{colSpan:U.filter((e=>ee.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-4",children:(0,A.jsxs)("div",{className:"ml-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4",children:[(0,A.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[(0,A.jsx)(W.A,{className:"h-4 w-4"}),"Status-Wechsel"]}),(0,A.jsx)("div",{className:"space-y-2",children:e.statusHistory.map(((e,t)=>(0,A.jsxs)("div",{className:"flex items-center gap-3 text-xs text-gray-600 dark:text-gray-400",children:[(0,A.jsx)("span",{className:"font-medium",children:(0,n.GP)(new Date(e.changedAt),"HH:mm:ss")}),(0,A.jsx)("span",{className:"text-gray-400",children:"\u2192"}),(0,A.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(We(e.oldStatus||"open")),children:Te(e.oldStatus||"open")}),(0,A.jsx)("span",{className:"text-gray-400",children:"\u2192"}),(0,A.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(We(e.newStatus)),children:Te(e.newStatus)}),(0,A.jsx)("span",{className:"text-gray-400",children:"von"}),(0,A.jsxs)("span",{className:"font-medium",children:[e.user.firstName," ",e.user.lastName]})]},e.id)))})]})})})]},e.id)}))})]})}):(0,A.jsx)("div",{className:"-mx-3 sm:-mx-4 md:-mx-6",children:0===Ae.length?(0,A.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400",children:[(0,A.jsx)(Y.A,{className:"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500"}),(0,A.jsx)("div",{className:"text-sm",children:"Keine To-Dos gefunden"})]}):(0,A.jsx)(z.A,{children:Ae.map((e=>{const t=[];ee.includes("branch")&&t.push({icon:(0,A.jsx)(j.A,{className:"h-4 w-4"}),label:"Niederlassung",value:e.branch.name,section:"left"}),ee.includes("responsible")&&t.push({icon:(0,A.jsx)(k.A,{className:"h-4 w-4"}),label:"Verantwortlich",value:e.responsible?"".concat(e.responsible.firstName," ").concat(e.responsible.lastName):"-",section:"main"}),ee.includes("qualityControl")&&t.push({icon:(0,A.jsx)(k.A,{className:"h-4 w-4"}),label:"Qualit\xe4tskontrolle",value:e.qualityControl?"".concat(e.qualityControl.firstName," ").concat(e.qualityControl.lastName):"-",section:"main"}),ee.includes("time")&&t.push({icon:(0,A.jsx)(v.A,{className:"h-4 w-4"}),label:"Zeit",value:(0,n.GP)(new Date(e.updatedAt),"HH:mm"),section:"right"});const a=e.statusHistory&&e.statusHistory.length>0,r=se.has(e.id),s=a?(0,A.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,A.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2",children:[(0,A.jsx)(W.A,{className:"h-4 w-4"}),"Status-Wechsel"]}),(0,A.jsx)("div",{className:"space-y-2",children:e.statusHistory.map((e=>(0,A.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[(0,A.jsx)("span",{className:"font-medium",children:(0,n.GP)(new Date(e.changedAt),"HH:mm:ss")}),(0,A.jsx)("span",{className:"text-gray-400",children:"\u2192"}),(0,A.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(We(e.oldStatus||"open")),children:Te(e.oldStatus||"open")}),(0,A.jsx)("span",{className:"text-gray-400",children:"\u2192"}),(0,A.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(We(e.newStatus)),children:Te(e.newStatus)}),(0,A.jsx)("span",{className:"text-gray-400",children:"von"}),(0,A.jsxs)("span",{className:"font-medium",children:[e.user.firstName," ",e.user.lastName]})]},e.id)))})]}):null;return(0,A.jsx)(O.A,{title:"".concat(e.id," - ").concat(e.title),status:{label:Te(e.status),color:We(e.status)},metadata:t,expandable:s?{isExpanded:r,content:s,onToggle:()=>le(e.id)}:void 0},e.id)}))})})]})};var ee=a(2704);const te="request-analytics-table",ae=["time","title","status","requester","responsible","branch"],re=e=>{let{selectedDate:t}=e;const{t:a}=(0,s.Bd)(),[i,o]=(0,r.useState)([]),[c,m]=(0,r.useState)(!1),[x,u]=(0,r.useState)(null),[g,y]=(0,r.useState)(""),[f,N]=(0,r.useState)([]),[w,S]=(0,r.useState)([]),[W,T]=(0,r.useState)(""),[C,D]=(0,r.useState)(null),[E,F]=(0,r.useState)(!1),{settings:q,isLoading:P,updateColumnOrder:H,updateHiddenColumns:R,toggleColumnVisibility:G,isColumnVisible:B,updateViewMode:_}=(0,M.F)(te,{defaultColumnOrder:ae,defaultViewMode:"table"}),V=(null===q||void 0===q?void 0:q.columnOrder)||ae,U=(null===q||void 0===q?void 0:q.hiddenColumns)||[],Y=V.filter((e=>!U.includes(e))),K=(null===q||void 0===q?void 0:q.viewMode)||"table",[Z,Q]=(0,r.useState)(K);(0,r.useEffect)((()=>{null!==q&&void 0!==q&&q.viewMode&&q.viewMode!==Z&&Q(q.viewMode)}),[null===q||void 0===q?void 0:q.viewMode]);const $=(0,r.useMemo)((()=>[{id:"time",label:a("analytics.request.columns.time")},{id:"title",label:a("analytics.request.columns.title")},{id:"status",label:a("analytics.request.columns.status")},{id:"requester",label:a("analytics.request.columns.requester")},{id:"responsible",label:a("analytics.request.columns.responsible")},{id:"branch",label:a("analytics.request.columns.branch")}]),[a]);(0,r.useEffect)((()=>{t&&(async()=>{try{m(!0),u(null);const e={date:t};f.forEach((t=>{"branch"===t.column&&t.value&&(e.branchId=t.value),"requester"===t.column&&t.value&&(e.userId=t.value),"status"===t.column&&t.value}));const a=await l.A.get(d.Sn.TEAM_WORKTIME.ANALYTICS.REQUESTS_CHRONOLOGICAL,{params:e});o(a.data||[])}catch(x){console.error("Fehler beim Laden der Requests:",x),u(a("analytics.request.loadError"))}finally{m(!1)}})()}),[t,f]);const J=(0,r.useCallback)(((e,t)=>{N(e),S(t),F(!1)}),[]),X=(0,r.useCallback)((()=>{N([]),S([]),T(""),D(null)}),[]),re=(0,r.useCallback)(((e,t,a,r)=>{T(e),D(t),J(a,r)}),[J]),se=(0,r.useCallback)((()=>f.filter((e=>""!==e.column&&null!==e.value)).length),[f]),ie=e=>{switch(e){case"approved":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"approval":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"denied":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";case"to_improve":return"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},le=e=>({approved:a("analytics.request.status.approved"),approval:a("analytics.request.status.approval"),denied:a("analytics.request.status.denied"),to_improve:a("analytics.request.status.to_improve")}[e]||e),de=(0,r.useMemo)((()=>{let e=[...i];if(g){const t=g.toLowerCase();e=e.filter((e=>e.title.toLowerCase().includes(t)||e.branch.name.toLowerCase().includes(t)||"".concat(e.requester.firstName," ").concat(e.requester.lastName).toLowerCase().includes(t)||"".concat(e.responsible.firstName," ").concat(e.responsible.lastName).toLowerCase().includes(t)))}return f.forEach((t=>{if(""===t.column||null===t.value)return;const a=t.operator||"equals",r=t.value;e=e.filter((e=>{switch(t.column){case"status":return"equals"!==a||e.status===r;case"title":return"contains"!==a||e.title.toLowerCase().includes(String(r).toLowerCase());default:return!0}}))})),e}),[i,g,f]),ne=(0,r.useMemo)((()=>({total:de.length,approved:de.filter((e=>"approved"===e.status)).length,pending:de.filter((e=>"approval"===e.status)).length,denied:de.filter((e=>"denied"===e.status)).length,toImprove:de.filter((e=>"to_improve"===e.status)).length})),[de]);return x?(0,A.jsx)("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded",children:x}):(0,A.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 request-analytics-wrapper",children:[(0,A.jsxs)("div",{className:"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6",children:[(0,A.jsxs)("div",{className:"flex items-center",children:[(0,A.jsx)(ee.A,{className:"h-6 w-6 mr-2 dark:text-white"}),(0,A.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:a("analytics.request.title")})]}),(0,A.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,A.jsx)("input",{type:"text",placeholder:a("common.searchPlaceholder"),className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:g,onChange:e=>y(e.target.value)}),(0,A.jsx)("button",{className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("cards"===Z?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""),onClick:()=>{const e="table"===Z?"cards":"table";Q(e),_&&_(e)},title:a("table"===Z?"common.viewAsCards":"common.viewAsTable"),children:"table"===Z?(0,A.jsx)(h.A,{className:"h-5 w-5"}):(0,A.jsx)(b.A,{className:"h-5 w-5"})}),(0,A.jsxs)("button",{className:"p-2 rounded-md ".concat(se()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"," ml-1 relative"),onClick:()=>F(!E),title:a("common.filter"),style:{position:"relative"},children:[(0,A.jsx)(p.A,{className:"h-5 w-5"}),se()>0&&(0,A.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10",children:se()})]})]})]}),E&&(0,A.jsx)("div",{className:"cards"===Z?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,A.jsx)(I.A,{columns:$,onApply:J,onReset:X,savedConditions:f,savedOperators:w,tableId:te})}),(0,A.jsx)("div",{className:"cards"===Z?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,A.jsx)(L.A,{tableId:te,onSelectFilter:J,onReset:X,activeFilterName:W,selectedFilterId:C,onFilterChange:re,defaultFilterName:a("teamWorktime.filters.all")})}),(0,A.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[(0,A.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[(0,A.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("analytics.request.stats.total")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:ne.total})]}),(0,A.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800",children:[(0,A.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:a("analytics.request.status.approved")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:ne.approved})]}),(0,A.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800",children:[(0,A.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:a("analytics.request.status.approval")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:ne.pending})]}),(0,A.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4 border border-red-200 dark:border-red-800",children:[(0,A.jsx)("div",{className:"text-sm text-red-600 dark:text-red-400",children:a("analytics.request.status.denied")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-red-700 dark:text-red-300",children:ne.denied})]}),(0,A.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-4 border border-orange-200 dark:border-orange-800",children:[(0,A.jsx)("div",{className:"text-sm text-orange-600 dark:text-orange-400",children:a("analytics.request.status.to_improve")}),(0,A.jsx)("div",{className:"text-2xl font-bold text-orange-700 dark:text-orange-300",children:ne.toImprove})]})]}),c?(0,A.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,A.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:a("analytics.request.loading")})}):"table"===Z?(0,A.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,A.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,A.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,A.jsx)("tr",{children:V.filter((e=>Y.includes(e))).map((e=>{const t=$.find((t=>t.id===e));return t?(0,A.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:t.label},e):null}))})}),(0,A.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:0===de.length?(0,A.jsx)("tr",{children:(0,A.jsx)("td",{colSpan:V.filter((e=>Y.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:a("analytics.request.noRequestsForDate")})}):de.map((e=>(0,A.jsx)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:V.filter((e=>Y.includes(e))).map((t=>{switch(t){case"time":return(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(0,n.GP)(new Date(e.createdAt),"HH:mm")},t);case"title":return(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:e.title},t);case"status":return(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,A.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(ie(e.status)),children:le(e.status)})},t);case"requester":return(0,A.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.requester.firstName," ",e.requester.lastName]},t);case"responsible":return(0,A.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.responsible.firstName," ",e.responsible.lastName]},t);case"branch":return(0,A.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name},t);default:return null}}))},e.id)))})]})}):(0,A.jsx)("div",{className:"-mx-3 sm:-mx-4 md:-mx-6",children:0===de.length?(0,A.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400",children:[(0,A.jsx)(ee.A,{className:"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500"}),(0,A.jsx)("div",{className:"text-sm",children:a("analytics.request.noRequests")})]}):(0,A.jsx)(z.A,{children:de.map((e=>{const t=[];return Y.includes("branch")&&t.push({icon:(0,A.jsx)(j.A,{className:"h-4 w-4"}),label:a("analytics.request.metadata.branch"),value:e.branch.name,section:"left"}),Y.includes("requester")&&t.push({icon:(0,A.jsx)(k.A,{className:"h-4 w-4"}),label:a("analytics.request.metadata.requester"),value:"".concat(e.requester.firstName," ").concat(e.requester.lastName),section:"main"}),Y.includes("responsible")&&t.push({icon:(0,A.jsx)(k.A,{className:"h-4 w-4"}),label:a("analytics.request.metadata.responsible"),value:"".concat(e.responsible.firstName," ").concat(e.responsible.lastName),section:"main"}),Y.includes("time")&&t.push({icon:(0,A.jsx)(v.A,{className:"h-4 w-4"}),label:a("analytics.request.metadata.time"),value:(0,n.GP)(new Date(e.createdAt),"HH:mm"),section:"right"}),(0,A.jsx)(O.A,{title:"".concat(e.id," - ").concat(e.title),status:{label:le(e.status),color:ie(e.status)},metadata:t},e.id)}))})})]})};var se=a(8662),ie=a(7988),le=a(1620),de=a(8605),ne=a(8018),oe=a(1821),ce=a(2672),me=a(7285),xe=a(3805),ue=a(4625),ge=a(7807),he=a(5657);const be=e=>{let{isOpen:t,onClose:a,onShiftCreated:i,initialDate:o,initialBranchId:c,initialRoleId:m}=e;const{t:x}=(0,s.Bd)(),{user:u}=(0,ce.As)(),{openSidepane:g,closeSidepane:h}=(0,he.N)(),[b,p]=(0,r.useState)(window.innerWidth>1070),[y,f]=(0,r.useState)(window.innerWidth<640),[k,v]=(0,r.useState)(""),[j,N]=(0,r.useState)(c||""),[W,T]=(0,r.useState)(m||""),[C,D]=(0,r.useState)(""),[E,I]=(0,r.useState)(o?(0,n.GP)(o,"yyyy-MM-dd"):(0,n.GP)(new Date,"yyyy-MM-dd")),[L,F]=(0,r.useState)(""),[M,q]=(0,r.useState)([]),[P,H]=(0,r.useState)([]),[O,z]=(0,r.useState)([]),[R,G]=(0,r.useState)([]),[B,_]=(0,r.useState)(null),[V,U]=(0,r.useState)(!1),[Y,K]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=()=>{f(window.innerWidth<640),p(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>(t?(g(),Z()):h(),()=>{h()})),[t,g,h]),(0,r.useEffect)((()=>{t&&j&&W&&Q()}),[t,j,W]),(0,r.useEffect)((()=>{if(R.length>0&&""===j){const e=c&&R.find((e=>e.id===c))||R[0];N(e.id)}}),[R,j,c]),(0,r.useEffect)((()=>{if(O.length>0&&""===W){const e=m&&O.find((e=>e.id===m))||O[0];T(e.id)}}),[O,W,m]);const Z=async()=>{K(!0),_(null);try{if(!localStorage.getItem("token"))return _("Nicht authentifiziert"),void K(!1);const[e,t,a]=await Promise.all([l.A.get(d.Sn.BRANCHES.BASE),l.A.get(d.Sn.ROLES.BASE),l.A.get(d.Sn.USERS.DROPDOWN)]);G(e.data||[]),z(t.data||[]),H(a.data||[]),j&&W&&await Q()}catch(a){var e,t;console.error("Fehler beim Laden der Daten:",a),_((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message||x("teamWorktime.shifts.modal.errors.loadDataError"))}finally{K(!1)}},Q=async()=>{if(j&&W)try{_(null);const e=await l.A.get(d.Sn.SHIFTS.TEMPLATES.BASE,{params:{branchId:Number(j),roleId:Number(W),includeInactive:!1}}),t=e.data.data||e.data||[];q(t),1!==t.length||k||v(t[0].id)}catch(a){var e,t;console.error("Fehler beim Laden der Templates:",a),_((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message||x("teamWorktime.shifts.modal.errors.loadTemplatesError"))}},$=async e=>{e.preventDefault(),_(null),U(!0);try{if(!k||!j||!W||!E)return _(x("teamWorktime.shifts.modal.errors.fillRequiredFields")),void U(!1);if(!localStorage.getItem("token"))return _("Nicht authentifiziert"),void U(!1);const e={shiftTemplateId:Number(k),branchId:Number(j),roleId:Number(W),date:E,notes:L||null};C&&(e.userId=Number(C));const t=await l.A.post(d.Sn.SHIFTS.BASE,e);console.log("Schicht erfolgreich erstellt:",t.data),i(t.data.data||t.data),J()}catch(r){var t,a;console.error("Fehler beim Erstellen der Schicht:",r);const e=(null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r.message||x("teamWorktime.shifts.modal.errors.createError");_(e)}finally{U(!1)}},J=()=>{_(null),v(""),N(c||""),T(m||""),D(""),I(o?(0,n.GP)(o,"yyyy-MM-dd"):(0,n.GP)(new Date,"yyyy-MM-dd")),F(""),a()};M.find((e=>e.id===Number(k)));return y?(0,A.jsxs)(w.lG,{open:t,onClose:J,className:"relative z-50",children:[(0,A.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,A.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,A.jsxs)(w.lG.Panel,{className:"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden",children:[(0,A.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0",children:(0,A.jsxs)("div",{className:"flex items-center justify-between",children:[(0,A.jsx)(w.lG.Title,{className:"text-lg font-semibold dark:text-white",children:x("teamWorktime.shifts.modal.create.title")}),(0,A.jsx)("button",{onClick:J,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]})}),(0,A.jsxs)("form",{onSubmit:$,className:"flex flex-col flex-1 min-h-0",children:[(0,A.jsxs)("div",{className:"p-6 overflow-y-auto flex-1 min-h-0",children:[B&&(0,A.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded",children:B}),Y?(0,A.jsx)("div",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:x("common.loading")}):(0,A.jsxs)("div",{className:"space-y-4",children:[(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[x("teamWorktime.shifts.modal.create.branch")," *"]}),(0,A.jsxs)("select",{value:j,onChange:e=>{N(Number(e.target.value)),v("")},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,A.jsx)("option",{value:"",children:x("teamWorktime.shifts.modal.create.selectBranch")}),R.map((e=>(0,A.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[x("teamWorktime.shifts.modal.create.role")," *"]}),(0,A.jsxs)("select",{value:W,onChange:e=>{T(Number(e.target.value)),v("")},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,A.jsx)("option",{value:"",children:x("teamWorktime.shifts.modal.create.selectRole")}),O.map((e=>(0,A.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[x("teamWorktime.shifts.modal.create.template")," *"]}),(0,A.jsxs)("select",{value:k,onChange:e=>v(Number(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:!j||!W,children:[(0,A.jsx)("option",{value:"",children:x("teamWorktime.shifts.modal.create.selectTemplate")}),M.map((e=>(0,A.jsxs)("option",{value:e.id,children:[e.name," (",e.startTime," - ",e.endTime,")"]},e.id)))]}),(!j||!W)&&(0,A.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:x("teamWorktime.shifts.modal.create.selectBranchRoleFirst")})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[x("teamWorktime.shifts.modal.create.date")," *"]}),(0,A.jsx)("input",{type:"date",value:E,onChange:e=>I(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x("teamWorktime.shifts.modal.create.user")}),(0,A.jsxs)("select",{value:C,onChange:e=>D(e.target.value?Number(e.target.value):""),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,A.jsx)("option",{value:"",children:x("teamWorktime.shifts.modal.create.selectUser")}),P.map((e=>(0,A.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x("teamWorktime.shifts.modal.create.notes")}),(0,A.jsx)("textarea",{value:L,onChange:e=>F(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:x("teamWorktime.shifts.modal.create.notesPlaceholder")})]})]})]}),(0,A.jsxs)("div",{className:"px-6 py-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2",children:[(0,A.jsx)("button",{type:"button",onClick:J,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:x("common.cancel")}),(0,A.jsx)("button",{type:"submit",disabled:V||Y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:x(V?"common.saving":"common.save")})]})]})]})})]}):(0,A.jsxs)(A.Fragment,{children:[t&&!b&&(0,A.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:J,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,A.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,A.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,A.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:x("teamWorktime.shifts.modal.create.title")}),(0,A.jsx)("button",{onClick:J,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]}),(0,A.jsxs)("form",{onSubmit:$,className:"flex flex-col flex-1 min-h-0",children:[(0,A.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[B&&(0,A.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded",children:B}),Y?(0,A.jsx)("div",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:x("common.loading")}):(0,A.jsxs)("div",{className:"space-y-4",children:[(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[x("teamWorktime.shifts.modal.create.branch")," *"]}),(0,A.jsxs)("select",{value:j,onChange:e=>{N(Number(e.target.value)),v("")},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,A.jsx)("option",{value:"",children:x("teamWorktime.shifts.modal.create.selectBranch")}),R.map((e=>(0,A.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[x("teamWorktime.shifts.modal.create.role")," *"]}),(0,A.jsxs)("select",{value:W,onChange:e=>{T(Number(e.target.value)),v("")},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,A.jsx)("option",{value:"",children:x("teamWorktime.shifts.modal.create.selectRole")}),O.map((e=>(0,A.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[x("teamWorktime.shifts.modal.create.template")," *"]}),(0,A.jsxs)("select",{value:k,onChange:e=>v(Number(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:!j||!W,children:[(0,A.jsx)("option",{value:"",children:x("teamWorktime.shifts.modal.create.selectTemplate")}),M.map((e=>(0,A.jsxs)("option",{value:e.id,children:[e.name," (",e.startTime," - ",e.endTime,")"]},e.id)))]}),(!j||!W)&&(0,A.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:x("teamWorktime.shifts.modal.create.selectBranchRoleFirst")})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[x("teamWorktime.shifts.modal.create.date")," *"]}),(0,A.jsx)("input",{type:"date",value:E,onChange:e=>I(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x("teamWorktime.shifts.modal.create.user")}),(0,A.jsxs)("select",{value:C,onChange:e=>D(e.target.value?Number(e.target.value):""),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,A.jsx)("option",{value:"",children:x("teamWorktime.shifts.modal.create.selectUser")}),P.map((e=>(0,A.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x("teamWorktime.shifts.modal.create.notes")}),(0,A.jsx)("textarea",{value:L,onChange:e=>F(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:x("teamWorktime.shifts.modal.create.notesPlaceholder")})]})]})]}),(0,A.jsxs)("div",{className:"p-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2",children:[(0,A.jsx)("button",{type:"button",onClick:J,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:x("common.cancel")}),(0,A.jsx)("button",{type:"submit",disabled:V||Y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:x(V?"common.saving":"common.save")})]})]})]})]})};var pe=a(6011);const ye=e=>{let{isOpen:t,onClose:a,onSwapRequestCreated:i,originalShift:o}=e;const{t:c}=(0,s.Bd)(),{user:m}=(0,ce.As)(),{openSidepane:x,closeSidepane:u}=(0,he.N)(),[g,h]=(0,r.useState)(window.innerWidth>1070),[b,p]=(0,r.useState)(window.innerWidth<640),[y,f]=(0,r.useState)(""),[k,v]=(0,r.useState)(""),[j,N]=(0,r.useState)([]),[W,T]=(0,r.useState)(!1),[C,D]=(0,r.useState)(!1),[E,I]=(0,r.useState)(null),[L,F]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=()=>{p(window.innerWidth<640),h(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>(t?(x(),M()):(u(),f(""),v(""),I(null)),()=>{u()})),[t,x,u,o]);const M=async()=>{if(o){D(!0),I(null);try{var e;const t=new Date(o.date);t.setDate(t.getDate()-t.getDay()+1);const a=new Date(t);a.setDate(a.getDate()+6);const r=await l.A.get(d.Sn.SHIFTS.BASE,{params:{startDate:(0,n.GP)(t,"yyyy-MM-dd"),endDate:(0,n.GP)(a,"yyyy-MM-dd")}}),s=((null===(e=r.data)||void 0===e?void 0:e.data)||r.data||[]).filter((e=>e.id!==o.id&&null!==e.userId&&"cancelled"!==e.status&&"swapped"!==e.status&&e.roleId===o.roleId&&e.branchId===o.branchId));N(s)}catch(r){var t,a;console.error("Fehler beim Laden der verf\xfcgbaren Schichten:",r),I((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r.message||c("teamWorktime.shifts.swap.errors.loadShiftsError"))}finally{D(!1)}}},q=async e=>{e.preventDefault(),I(null),F(!0);try{if(!y)return I(c("teamWorktime.shifts.swap.errors.selectTargetShift")),void F(!1);const e=await l.A.post(d.Sn.SHIFTS.SWAPS.BASE,{originalShiftId:o.id,targetShiftId:Number(y),message:k.trim()||null});if(e.data&&!1!==e.data.success)i(),a();else{var t;const a=(null===(t=e.data)||void 0===t?void 0:t.message)||c("teamWorktime.shifts.swap.errors.createError");I(a)}}catch(n){var r,s;console.error("Fehler beim Erstellen der Tausch-Anfrage:",n);const e=(null===(r=n.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.message)||n.message||c("teamWorktime.shifts.swap.errors.createError");I(e)}finally{F(!1)}},P=()=>{I(null),f(""),v(""),a()},H=()=>{var e;return(0,A.jsxs)("div",{className:"space-y-4",children:[(0,A.jsxs)("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:[(0,A.jsx)("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-300 mb-2",children:c("teamWorktime.shifts.swap.form.yourShift")}),(0,A.jsxs)("div",{className:"text-sm text-blue-800 dark:text-blue-400",children:[(0,A.jsx)("div",{children:(null===(e=o.shiftTemplate)||void 0===e?void 0:e.name)||c("teamWorktime.shifts.swap.form.shift")}),(0,A.jsx)("div",{children:(0,n.GP)(new Date(o.date),"dd.MM.yyyy")}),(0,A.jsxs)("div",{children:[(0,n.GP)(new Date(o.startTime),"HH:mm")," - ",(0,n.GP)(new Date(o.endTime),"HH:mm")]}),o.branch&&(0,A.jsx)("div",{children:o.branch.name}),o.role&&(0,A.jsx)("div",{children:o.role.name})]})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[c("teamWorktime.shifts.swap.form.targetShift")," *"]}),C?(0,A.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-md text-sm text-gray-500 dark:text-gray-400",children:c("common.loading")}):0===j.length?(0,A.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-md text-sm text-gray-500 dark:text-gray-400",children:c("teamWorktime.shifts.swap.form.noShiftsAvailable")}):(0,A.jsxs)("select",{value:y,onChange:e=>f(Number(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,A.jsx)("option",{value:"",children:c("teamWorktime.shifts.swap.form.selectTargetShift")}),j.map((e=>(0,A.jsxs)("option",{value:e.id,children:[(0,n.GP)(new Date(e.date),"dd.MM.yyyy")," - ",(0,n.GP)(new Date(e.startTime),"HH:mm")," - ",(0,n.GP)(new Date(e.endTime),"HH:mm"),e.user&&" (".concat(e.user.firstName," ").concat(e.user.lastName,")")]},e.id)))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:c("teamWorktime.shifts.swap.form.message")}),(0,A.jsx)("textarea",{value:k,onChange:e=>v(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:c("teamWorktime.shifts.swap.form.messagePlaceholder")})]})]})};return b?(0,A.jsxs)(w.lG,{open:t,onClose:P,className:"relative z-50",children:[(0,A.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,A.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,A.jsxs)(w.lG.Panel,{className:"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden",children:[(0,A.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0",children:(0,A.jsxs)("div",{className:"flex items-center justify-between",children:[(0,A.jsx)(w.lG.Title,{className:"text-lg font-semibold dark:text-white",children:c("teamWorktime.shifts.swap.title")}),(0,A.jsx)("button",{onClick:P,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]})}),(0,A.jsxs)("form",{onSubmit:q,className:"flex flex-col flex-1 min-h-0",children:[(0,A.jsxs)("div",{className:"p-6 overflow-y-auto flex-1 min-h-0",children:[E&&(0,A.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded",children:E}),H()]}),(0,A.jsxs)("div",{className:"px-6 py-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2",children:[(0,A.jsx)("button",{type:"button",onClick:P,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:c("common.cancel")}),(0,A.jsx)("button",{type:"submit",disabled:L||C||!y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:c(L?"teamWorktime.shifts.swap.submitting":"teamWorktime.shifts.swap.submit")})]})]})]})})]}):(0,A.jsxs)(A.Fragment,{children:[t&&!g&&(0,A.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:P,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,A.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,A.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,A.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:c("teamWorktime.shifts.swap.title")}),(0,A.jsx)("button",{onClick:P,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]}),(0,A.jsxs)("form",{onSubmit:q,className:"flex flex-col flex-1 min-h-0",children:[(0,A.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[E&&(0,A.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded",children:E}),H()]}),(0,A.jsxs)("div",{className:"p-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2",children:[(0,A.jsx)("button",{type:"button",onClick:P,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:c("common.cancel")}),(0,A.jsx)("button",{type:"submit",disabled:L||C||!y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:c(L?"teamWorktime.shifts.swap.submitting":"teamWorktime.shifts.swap.submit")})]})]})]})]})},fe=e=>{let{isOpen:t,onClose:a,onShiftUpdated:i,onShiftDeleted:o,shift:c}=e;const{t:m}=(0,s.Bd)(),{user:x}=(0,ce.As)(),{openSidepane:u,closeSidepane:g}=(0,he.N)(),[h,b]=(0,r.useState)(window.innerWidth>1070),[p,y]=(0,r.useState)(window.innerWidth<640),[f,k]=(0,r.useState)(c.shiftTemplateId),[v,j]=(0,r.useState)(c.branchId),[N,W]=(0,r.useState)(c.roleId),[T,C]=(0,r.useState)(c.userId||""),[E,I]=(0,r.useState)((0,n.GP)(new Date(c.date),"yyyy-MM-dd")),[L,F]=(0,r.useState)(c.notes||""),[M,q]=(0,r.useState)(c.status),[P,H]=(0,r.useState)([]),[O,z]=(0,r.useState)([]),[R,G]=(0,r.useState)([]),[B,_]=(0,r.useState)([]),[V,U]=(0,r.useState)(null),[Y,K]=(0,r.useState)(!1),[Z,Q]=(0,r.useState)(!1),[$,J]=(0,r.useState)(!1),[X,ee]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=()=>{y(window.innerWidth<640),b(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>(t?(u(),k(c.shiftTemplateId),j(c.branchId),W(c.roleId),C(c.userId||""),I((0,n.GP)(new Date(c.date),"yyyy-MM-dd")),F(c.notes||""),q(c.status),U(null),te()):(g(),J(!1)),()=>{g()})),[t,c,u,g]),(0,r.useEffect)((()=>{t&&v&&N&&ae()}),[t,v,N]);const te=async()=>{Q(!0),U(null);try{if(!localStorage.getItem("token"))return U("Nicht authentifiziert"),void Q(!1);const[e,t,a]=await Promise.all([l.A.get(d.Sn.BRANCHES.BASE),l.A.get(d.Sn.ROLES.BASE),l.A.get(d.Sn.USERS.DROPDOWN)]);_(e.data||[]),G(t.data||[]),z(a.data||[]),v&&N&&await ae()}catch(a){var e,t;console.error("Fehler beim Laden der Daten:",a),U((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message||m("teamWorktime.shifts.modal.errors.loadDataError"))}finally{Q(!1)}},ae=async()=>{if(v&&N)try{U(null);const e=await l.A.get(d.Sn.SHIFTS.TEMPLATES.BASE,{params:{branchId:Number(v),roleId:Number(N),includeInactive:!0}}),t=e.data.data||e.data||[];H(t)}catch(a){var e,t;console.error("Fehler beim Laden der Templates:",a),U((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message||m("teamWorktime.shifts.modal.errors.loadTemplatesError"))}},re=async e=>{e.preventDefault(),U(null),K(!0);try{if(!f||!v||!N||!E)return U(m("teamWorktime.shifts.modal.errors.fillRequiredFields")),void K(!1);if(!localStorage.getItem("token"))return U("Nicht authentifiziert"),void K(!1);const e={userId:T?Number(T):null,date:E,notes:L||null,status:M},t=await l.A.put(d.Sn.SHIFTS.BY_ID(c.id),e);console.log("Schicht erfolgreich aktualisiert:",t.data),i(t.data.data||t.data),ie()}catch(r){var t,a;console.error("Fehler beim Aktualisieren der Schicht:",r);const e=(null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r.message||m("teamWorktime.shifts.modal.errors.updateError");U(e)}finally{K(!1)}},se=async()=>{U(null),K(!0);try{if(!localStorage.getItem("token"))return U("Nicht authentifiziert"),void K(!1);await l.A.delete(d.Sn.SHIFTS.BY_ID(c.id)),console.log("Schicht erfolgreich gel\xf6scht"),o(c.id),ie()}catch(a){var e,t;console.error("Fehler beim L\xf6schen der Schicht:",a);const r=(null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message||m("teamWorktime.shifts.modal.errors.deleteError");U(r)}finally{K(!1),J(!1)}},ie=()=>{U(null),J(!1),a()},le=()=>{var e,t,a;return(0,A.jsxs)("div",{className:"space-y-4",children:[(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("teamWorktime.shifts.modal.edit.branch")}),(0,A.jsx)("input",{type:"text",value:(null===(e=B.find((e=>e.id===v)))||void 0===e?void 0:e.name)||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed"})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("teamWorktime.shifts.modal.edit.role")}),(0,A.jsx)("input",{type:"text",value:(null===(t=R.find((e=>e.id===N)))||void 0===t?void 0:t.name)||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed"})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("teamWorktime.shifts.modal.edit.template")}),(0,A.jsx)("input",{type:"text",value:(null===(a=c.shiftTemplate)||void 0===a?void 0:a.name)||"",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed"})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[m("teamWorktime.shifts.modal.edit.date")," *"]}),(0,A.jsx)("input",{type:"date",value:E,onChange:e=>I(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("teamWorktime.shifts.modal.edit.user")}),(0,A.jsxs)("select",{value:T,onChange:e=>C(e.target.value?Number(e.target.value):""),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,A.jsx)("option",{value:"",children:m("teamWorktime.shifts.modal.edit.selectUser")}),O.map((e=>(0,A.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[m("teamWorktime.shifts.modal.edit.status")," *"]}),(0,A.jsxs)("select",{value:M,onChange:e=>q(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,A.jsx)("option",{value:"scheduled",children:m("teamWorktime.shifts.status.scheduled")}),(0,A.jsx)("option",{value:"confirmed",children:m("teamWorktime.shifts.status.confirmed")}),(0,A.jsx)("option",{value:"cancelled",children:m("teamWorktime.shifts.status.cancelled")}),(0,A.jsx)("option",{value:"swapped",children:m("teamWorktime.shifts.status.swapped")})]})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("teamWorktime.shifts.modal.edit.notes")}),(0,A.jsx)("textarea",{value:L,onChange:e=>F(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:m("teamWorktime.shifts.modal.edit.notesPlaceholder")})]}),c.userId===(null===x||void 0===x?void 0:x.id)&&"cancelled"!==c.status&&"swapped"!==c.status&&(0,A.jsx)("div",{className:"pt-4 border-t dark:border-gray-700",children:(0,A.jsxs)("button",{type:"button",onClick:()=>ee(!0),className:"w-full px-4 py-2 text-sm font-medium text-blue-700 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md hover:bg-blue-100 dark:hover:bg-blue-900/30 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center justify-center gap-2",children:[(0,A.jsx)(pe.A,{className:"h-5 w-5"}),m("teamWorktime.shifts.actions.swap")]})}),(0,A.jsx)("div",{className:"pt-4 border-t dark:border-gray-700",children:(0,A.jsxs)("button",{type:"button",onClick:()=>J(!0),className:"w-full px-4 py-2 text-sm font-medium text-red-700 dark:text-red-400 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md hover:bg-red-100 dark:hover:bg-red-900/30 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 flex items-center justify-center gap-2",children:[(0,A.jsx)(D.A,{className:"h-5 w-5"}),m("teamWorktime.shifts.modal.edit.delete")]})}),$&&(0,A.jsxs)("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md",children:[(0,A.jsx)("p",{className:"text-sm text-red-700 dark:text-red-400 mb-3",children:m("teamWorktime.shifts.modal.edit.deleteConfirm")}),(0,A.jsxs)("div",{className:"flex gap-2",children:[(0,A.jsx)("button",{type:"button",onClick:se,disabled:Y,className:"flex-1 px-3 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:m("common.yes")}),(0,A.jsx)("button",{type:"button",onClick:()=>J(!1),className:"flex-1 px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",children:m("common.no")})]})]})]})};return p?(0,A.jsxs)(w.lG,{open:t,onClose:ie,className:"relative z-50",children:[(0,A.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,A.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,A.jsxs)(w.lG.Panel,{className:"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden",children:[(0,A.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0",children:(0,A.jsxs)("div",{className:"flex items-center justify-between",children:[(0,A.jsx)(w.lG.Title,{className:"text-lg font-semibold dark:text-white",children:m("teamWorktime.shifts.modal.edit.title")}),(0,A.jsx)("button",{onClick:ie,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]})}),(0,A.jsxs)("form",{onSubmit:re,className:"flex flex-col flex-1 min-h-0",children:[(0,A.jsxs)("div",{className:"p-6 overflow-y-auto flex-1 min-h-0",children:[V&&(0,A.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded",children:V}),Z?(0,A.jsx)("div",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:m("common.loading")}):le()]}),(0,A.jsxs)("div",{className:"px-6 py-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2",children:[(0,A.jsx)("button",{type:"button",onClick:ie,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:m("common.cancel")}),(0,A.jsx)("button",{type:"submit",disabled:Y||Z,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m(Y?"common.saving":"common.save")})]})]})]})})]}):(0,A.jsxs)(A.Fragment,{children:[t&&!h&&(0,A.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:ie,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,A.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,A.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,A.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:m("teamWorktime.shifts.modal.edit.title")}),(0,A.jsx)("button",{onClick:ie,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]}),(0,A.jsxs)("form",{onSubmit:re,className:"flex flex-col flex-1 min-h-0",children:[(0,A.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[V&&(0,A.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded",children:V}),Z?(0,A.jsx)("div",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:m("common.loading")}):le()]}),(0,A.jsxs)("div",{className:"p-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2",children:[(0,A.jsx)("button",{type:"button",onClick:ie,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:m("common.cancel")}),(0,A.jsx)("button",{type:"submit",disabled:Y||Z,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m(Y?"common.saving":"common.save")})]})]})]}),c.userId===(null===x||void 0===x?void 0:x.id)&&(0,A.jsx)(ye,{isOpen:X,onClose:()=>ee(!1),onSwapRequestCreated:()=>{ee(!1),i(c)},originalShift:c})]})};var ke=a(9399),ve=a(4538);const je=e=>{let{isOpen:t,onClose:a,onPlanGenerated:i,initialStartDate:o,initialEndDate:c}=e;const{t:m}=(0,s.Bd)(),{openSidepane:x,closeSidepane:u}=(0,he.N)(),[g,h]=(0,r.useState)(window.innerWidth>1070),[b,p]=(0,r.useState)(window.innerWidth<640),[y,f]=(0,r.useState)(o?(0,n.GP)(o,"yyyy-MM-dd"):(0,n.GP)((0,le.k)(new Date,{weekStartsOn:1}),"yyyy-MM-dd")),[k,v]=(0,r.useState)(c?(0,n.GP)(c,"yyyy-MM-dd"):(0,n.GP)((0,de.$)(new Date,{weekStartsOn:1}),"yyyy-MM-dd")),[j,N]=(0,r.useState)(""),[W,T]=(0,r.useState)([]),[C,D]=(0,r.useState)([]),[E,I]=(0,r.useState)([]),[L,F]=(0,r.useState)(null),[M,q]=(0,r.useState)(!1),[P,H]=(0,r.useState)(!1),[O,z]=(0,r.useState)(!1),[R,G]=(0,r.useState)(null),[B,_]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=()=>{p(window.innerWidth<640),h(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>(t?(x(),V(),G(null),_(!1)):u(),()=>{u()})),[t,x,u]),(0,r.useEffect)((()=>{t&&j?U():(I([]),T([]))}),[t,j]),(0,r.useEffect)((()=>{C.length>0&&""===j&&N(C[0].id)}),[C,j]);const V=async()=>{H(!0),F(null);try{if(!localStorage.getItem("token"))return F("Nicht authentifiziert"),void H(!1);const e=await l.A.get(d.Sn.BRANCHES.BASE);D(e.data||[])}catch(a){var e,t;console.error("Fehler beim Laden der Branches:",a),F((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message||m("teamWorktime.shifts.generate.errors.loadBranchesError"))}finally{H(!1)}},U=async()=>{if(j)try{F(null);const e=(await l.A.get(d.Sn.ROLES.BASE)).data||[];I(e)}catch(a){var e,t;console.error("Fehler beim Laden der Rollen:",a),F((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message||m("teamWorktime.shifts.generate.errors.loadRolesError"))}},Y=()=>{W.length===E.length?T([]):T(E.map((e=>e.id)))},K=async e=>{e.preventDefault(),F(null),z(!0),G(null),_(!1);try{if(!y||!k||!j)return F(m("teamWorktime.shifts.generate.errors.fillRequiredFields")),void z(!1);const e=new Date(y),t=new Date(k);if(isNaN(e.getTime())||isNaN(t.getTime()))return F(m("teamWorktime.shifts.generate.errors.invalidDates")),void z(!1);if(e>=t)return F(m("teamWorktime.shifts.generate.errors.startDateAfterEndDate")),void z(!1);if(!localStorage.getItem("token"))return F("Nicht authentifiziert"),void z(!1);const a={startDate:e.toISOString().split("T")[0],endDate:t.toISOString().split("T")[0],branchId:Number(j)};W.length>0&&(a.roleIds=W);const r=await l.A.post(d.Sn.SHIFTS.GENERATE,a),s=r.data.data||r.data;G(s),_(!0),i()}catch(r){var t,a;console.error("Fehler beim Generieren des Schichtplans:",r);const e=(null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r.message||m("teamWorktime.shifts.generate.errors.generateError");F(e)}finally{z(!1)}},Z=()=>{F(null),G(null),_(!1),T([]),a()},Q=()=>(0,A.jsxs)("div",{className:"space-y-4",children:[(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[m("teamWorktime.shifts.generate.form.startDate")," *"]}),(0,A.jsx)("input",{type:"date",value:y,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[m("teamWorktime.shifts.generate.form.endDate")," *"]}),(0,A.jsx)("input",{type:"date",value:k,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[m("teamWorktime.shifts.generate.form.branch")," *"]}),(0,A.jsxs)("select",{value:j,onChange:e=>{N(Number(e.target.value)),T([])},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,A.jsx)("option",{value:"",children:m("teamWorktime.shifts.generate.form.selectBranch")}),C.map((e=>(0,A.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:m("teamWorktime.shifts.generate.form.roles")}),E.length>0&&(0,A.jsx)("button",{type:"button",onClick:Y,className:"text-xs text-blue-600 dark:text-blue-400 hover:underline",children:W.length===E.length?m("teamWorktime.shifts.generate.form.deselectAll"):m("teamWorktime.shifts.generate.form.selectAll")})]}),(0,A.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:m("teamWorktime.shifts.generate.form.rolesHint")}),j?0===E.length?(0,A.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-md text-sm text-gray-500 dark:text-gray-400",children:m("teamWorktime.shifts.generate.form.noRolesAvailable")}):(0,A.jsx)("div",{className:"max-h-48 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2 space-y-2",children:E.map((e=>(0,A.jsxs)("label",{className:"flex items-center cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded",children:[(0,A.jsx)("input",{type:"checkbox",checked:W.includes(e.id),onChange:()=>{return t=e.id,void T((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t]));var t},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,A.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:e.name})]},e.id)))}):(0,A.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-md text-sm text-gray-500 dark:text-gray-400",children:m("teamWorktime.shifts.generate.form.selectBranchFirst")})]})]}),$=()=>R?(0,A.jsxs)("div",{className:"space-y-4",children:[(0,A.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:[(0,A.jsx)("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-300 mb-3",children:m("teamWorktime.shifts.generate.result.summary")}),(0,A.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,A.jsxs)("div",{children:[(0,A.jsx)("div",{className:"text-xs text-blue-700 dark:text-blue-400",children:m("teamWorktime.shifts.generate.result.total")}),(0,A.jsx)("div",{className:"text-lg font-semibold text-blue-900 dark:text-blue-300",children:R.summary.total})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("div",{className:"text-xs text-green-700 dark:text-green-400",children:m("teamWorktime.shifts.generate.result.assigned")}),(0,A.jsx)("div",{className:"text-lg font-semibold text-green-900 dark:text-green-300",children:R.summary.assigned})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("div",{className:"text-xs text-orange-700 dark:text-orange-400",children:m("teamWorktime.shifts.generate.result.unassigned")}),(0,A.jsx)("div",{className:"text-lg font-semibold text-orange-900 dark:text-orange-300",children:R.summary.unassigned})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("div",{className:"text-xs text-red-700 dark:text-red-400",children:m("teamWorktime.shifts.generate.result.conflicts")}),(0,A.jsx)("div",{className:"text-lg font-semibold text-red-900 dark:text-red-300",children:R.summary.conflicts})]})]})]}),R.conflicts&&R.conflicts.length>0&&(0,A.jsxs)("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md",children:[(0,A.jsxs)("div",{className:"flex items-start gap-2 mb-2",children:[(0,A.jsx)(ke.A,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-0.5"}),(0,A.jsxs)("h3",{className:"text-sm font-semibold text-yellow-900 dark:text-yellow-300",children:[m("teamWorktime.shifts.generate.result.conflictsTitle")," (",R.conflicts.length,")"]})]}),(0,A.jsx)("div",{className:"max-h-40 overflow-y-auto space-y-1",children:R.conflicts.map(((e,t)=>(0,A.jsxs)("div",{className:"text-xs text-yellow-800 dark:text-yellow-400",children:[(0,n.GP)(new Date(e.date),"dd.MM.yyyy"),": ",e.reason]},t)))})]}),0===R.summary.conflicts&&0===R.summary.unassigned&&(0,A.jsx)("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md",children:(0,A.jsxs)("div",{className:"flex items-center gap-2",children:[(0,A.jsx)(ve.A,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),(0,A.jsx)("span",{className:"text-sm font-medium text-green-900 dark:text-green-300",children:m("teamWorktime.shifts.generate.result.success")})]})})]}):null;return b?(0,A.jsxs)(w.lG,{open:t,onClose:Z,className:"relative z-50",children:[(0,A.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,A.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,A.jsxs)(w.lG.Panel,{className:"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden",children:[(0,A.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0",children:(0,A.jsxs)("div",{className:"flex items-center justify-between",children:[(0,A.jsx)(w.lG.Title,{className:"text-lg font-semibold dark:text-white",children:m("teamWorktime.shifts.generate.title")}),(0,A.jsx)("button",{onClick:Z,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]})}),(0,A.jsxs)("form",{onSubmit:K,className:"flex flex-col flex-1 min-h-0",children:[(0,A.jsxs)("div",{className:"p-6 overflow-y-auto flex-1 min-h-0",children:[L&&(0,A.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded",children:L}),B&&R?$():P?(0,A.jsx)("div",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:m("common.loading")}):Q()]}),(0,A.jsx)("div",{className:"px-6 py-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2",children:B?(0,A.jsx)("button",{type:"button",onClick:Z,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:m("common.close")}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("button",{type:"button",onClick:Z,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:m("common.cancel")}),(0,A.jsx)("button",{type:"submit",disabled:O||P,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m(O?"teamWorktime.shifts.generate.generating":"teamWorktime.shifts.generate.generate")})]})})]})]})})]}):(0,A.jsxs)(A.Fragment,{children:[t&&!g&&(0,A.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:Z,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,A.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,A.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,A.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:m("teamWorktime.shifts.generate.title")}),(0,A.jsx)("button",{onClick:Z,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]}),(0,A.jsxs)("form",{onSubmit:K,className:"flex flex-col flex-1 min-h-0",children:[(0,A.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[L&&(0,A.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded",children:L}),B&&R?$():P?(0,A.jsx)("div",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:m("common.loading")}):Q()]}),(0,A.jsx)("div",{className:"p-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2",children:B?(0,A.jsx)("button",{type:"button",onClick:Z,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:m("common.close")}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("button",{type:"button",onClick:Z,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:m("common.cancel")}),(0,A.jsx)("button",{type:"submit",disabled:O||P,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m(O?"teamWorktime.shifts.generate.generating":"teamWorktime.shifts.generate.generate")})]})})]})]})]})};var Ne=a(7098);const we=e=>{let{isOpen:t,onClose:a,onSwapRequestUpdated:i}=e;const{t:o}=(0,s.Bd)(),{user:c}=(0,ce.As)(),{openSidepane:m,closeSidepane:x}=(0,he.N)(),[u,g]=(0,r.useState)(window.innerWidth>1070),[h,b]=(0,r.useState)(window.innerWidth<640),[p,y]=(0,r.useState)([]),[f,k]=(0,r.useState)(!1),[v,j]=(0,r.useState)(null),[N,C]=(0,r.useState)(null),[D,E]=(0,r.useState)("all");(0,r.useEffect)((()=>{const e=()=>{b(window.innerWidth<640),g(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>(t?(m(),I()):x(),()=>{x()})),[t,m,x]);const I=async()=>{k(!0),j(null);try{var e;const t=await l.A.get(d.Sn.SHIFTS.SWAPS.BASE,{params:null!==c&&void 0!==c&&c.id?{userId:c.id}:{}}),a=(null===(e=t.data)||void 0===e?void 0:e.data)||t.data||[];y(Array.isArray(a)?a:[])}catch(r){var t,a;console.error("Fehler beim Laden der Tausch-Anfragen:",r),j((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r.message||o("teamWorktime.shifts.swapList.errors.loadError"))}finally{k(!1)}},L=p.filter((e=>"all"===D||e.status===D)),F=L.filter((e=>e.requestedBy===(null===c||void 0===c?void 0:c.id))),M=L.filter((e=>e.requestedFrom===(null===c||void 0===c?void 0:c.id))),q=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"approved":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case"rejected":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},P=e=>{switch(e){case"pending":return o("teamWorktime.shifts.swapList.status.pending");case"approved":return o("teamWorktime.shifts.swapList.status.approved");case"rejected":return o("teamWorktime.shifts.swapList.status.rejected");default:return e}},H=(e,t)=>{var a,r;return(0,A.jsxs)("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg mb-4",children:[(0,A.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,A.jsxs)("div",{className:"flex-1",children:[(0,A.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,A.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(q(e.status)),children:P(e.status)}),(0,A.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:(0,n.GP)(new Date(e.createdAt),"dd.MM.yyyy HH:mm")})]}),t?(0,A.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[(0,A.jsxs)("span",{className:"font-medium",children:[e.requester.firstName," ",e.requester.lastName]})," ",o("teamWorktime.shifts.swapList.wantsToSwap")]}):(0,A.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[o("teamWorktime.shifts.swapList.youRequestedSwap")," ",(0,A.jsxs)("span",{className:"font-medium",children:[e.requestee.firstName," ",e.requestee.lastName]})]})]})}),(0,A.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[(0,A.jsxs)("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:[(0,A.jsx)("h4",{className:"text-xs font-semibold text-blue-900 dark:text-blue-300 mb-1",children:o(t?"teamWorktime.shifts.swapList.theirShift":"teamWorktime.shifts.swapList.yourShift")}),(0,A.jsxs)("div",{className:"text-xs text-blue-800 dark:text-blue-400",children:[(0,A.jsx)("div",{children:(null===(a=e.originalShift.shiftTemplate)||void 0===a?void 0:a.name)||o("teamWorktime.shifts.swap.form.shift")}),(0,A.jsx)("div",{children:(0,n.GP)(new Date(e.originalShift.date),"dd.MM.yyyy")}),(0,A.jsxs)("div",{children:[(0,n.GP)(new Date(e.originalShift.startTime),"HH:mm")," - ",(0,n.GP)(new Date(e.originalShift.endTime),"HH:mm")]}),e.originalShift.branch&&(0,A.jsx)("div",{children:e.originalShift.branch.name})]})]}),(0,A.jsxs)("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md",children:[(0,A.jsx)("h4",{className:"text-xs font-semibold text-green-900 dark:text-green-300 mb-1",children:o(t?"teamWorktime.shifts.swapList.theirShift":"teamWorktime.shifts.swapList.yourShift")}),(0,A.jsxs)("div",{className:"text-xs text-green-800 dark:text-green-400",children:[(0,A.jsx)("div",{children:(null===(r=e.targetShift.shiftTemplate)||void 0===r?void 0:r.name)||o("teamWorktime.shifts.swap.form.shift")}),(0,A.jsx)("div",{children:(0,n.GP)(new Date(e.targetShift.date),"dd.MM.yyyy")}),(0,A.jsxs)("div",{children:[(0,n.GP)(new Date(e.targetShift.startTime),"HH:mm")," - ",(0,n.GP)(new Date(e.targetShift.endTime),"HH:mm")]}),e.targetShift.branch&&(0,A.jsx)("div",{children:e.targetShift.branch.name})]})]})]}),e.message&&(0,A.jsxs)("div",{className:"mb-3 p-2 bg-gray-50 dark:bg-gray-700 rounded text-sm text-gray-700 dark:text-gray-300",children:[(0,A.jsxs)("span",{className:"font-medium",children:[o("teamWorktime.shifts.swapList.message"),":"]})," ",e.message]}),e.responseMessage&&(0,A.jsxs)("div",{className:"mb-3 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-sm text-blue-700 dark:text-blue-300",children:[(0,A.jsxs)("span",{className:"font-medium",children:[o("teamWorktime.shifts.swapList.response"),":"]})," ",e.responseMessage]}),t&&"pending"===e.status&&(0,A.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,A.jsx)("button",{onClick:()=>(async e=>{if(c){C(e.id),j(null);try{await l.A.put(d.Sn.SHIFTS.SWAPS.APPROVE(e.id),{responseMessage:null}),await I(),i()}catch(r){var t,a;console.error("Fehler beim Genehmigen der Tausch-Anfrage:",r),j((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r.message||o("teamWorktime.shifts.swapList.errors.approveError"))}finally{C(null)}}})(e),disabled:N===e.id,className:"flex-1 px-3 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:N===e.id?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(W.A,{className:"h-4 w-4 animate-spin"}),o("teamWorktime.shifts.swapList.approving")]}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(T.A,{className:"h-4 w-4"}),o("teamWorktime.shifts.swapList.approve")]})}),(0,A.jsx)("button",{onClick:()=>(async e=>{if(c){C(e.id),j(null);try{await l.A.put(d.Sn.SHIFTS.SWAPS.REJECT(e.id),{responseMessage:null}),await I(),i()}catch(r){var t,a;console.error("Fehler beim Ablehnen der Tausch-Anfrage:",r),j((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r.message||o("teamWorktime.shifts.swapList.errors.rejectError"))}finally{C(null)}}})(e),disabled:N===e.id,className:"flex-1 px-3 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:N===e.id?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(W.A,{className:"h-4 w-4 animate-spin"}),o("teamWorktime.shifts.swapList.rejecting")]}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(Ne.A,{className:"h-4 w-4"}),o("teamWorktime.shifts.swapList.reject")]})})]})]},e.id)},O=()=>(0,A.jsxs)("div",{className:"space-y-4",children:[(0,A.jsxs)("div",{className:"flex gap-2",children:[(0,A.jsx)("button",{onClick:()=>E("all"),className:"px-3 py-1 text-sm rounded-md ".concat("all"===D?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:o("teamWorktime.shifts.swapList.filter.all")}),(0,A.jsx)("button",{onClick:()=>E("pending"),className:"px-3 py-1 text-sm rounded-md ".concat("pending"===D?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:o("teamWorktime.shifts.swapList.filter.pending")}),(0,A.jsx)("button",{onClick:()=>E("approved"),className:"px-3 py-1 text-sm rounded-md ".concat("approved"===D?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:o("teamWorktime.shifts.swapList.filter.approved")}),(0,A.jsx)("button",{onClick:()=>E("rejected"),className:"px-3 py-1 text-sm rounded-md ".concat("rejected"===D?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:o("teamWorktime.shifts.swapList.filter.rejected")})]}),v&&(0,A.jsx)("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded",children:v}),f?(0,A.jsx)("div",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:o("common.loading")}):(0,A.jsxs)(A.Fragment,{children:[M.length>0&&(0,A.jsxs)("div",{children:[(0,A.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:[o("teamWorktime.shifts.swapList.receivedRequests")," (",M.length,")"]}),M.map((e=>H(e,!0)))]}),F.length>0&&(0,A.jsxs)("div",{children:[(0,A.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:[o("teamWorktime.shifts.swapList.yourRequests")," (",F.length,")"]}),F.map((e=>H(e,!1)))]}),0===L.length&&(0,A.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:o("teamWorktime.shifts.swapList.noRequests")})]})]});return h?(0,A.jsxs)(w.lG,{open:t,onClose:a,className:"relative z-50",children:[(0,A.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,A.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,A.jsxs)(w.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden",children:[(0,A.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0",children:(0,A.jsxs)("div",{className:"flex items-center justify-between",children:[(0,A.jsx)(w.lG.Title,{className:"text-lg font-semibold dark:text-white",children:o("teamWorktime.shifts.swapList.title")}),(0,A.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]})}),(0,A.jsx)("div",{className:"p-6 overflow-y-auto flex-1 min-h-0",children:O()})]})})]}):(0,A.jsxs)(A.Fragment,{children:[t&&!u&&(0,A.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:a,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,A.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,A.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,A.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:o("teamWorktime.shifts.swapList.title")}),(0,A.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]}),(0,A.jsx)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:O()})]})]})},Se=e=>{let{isOpen:t,onClose:a}=e;const{t:i}=(0,s.Bd)(),{openSidepane:n,closeSidepane:c}=(0,he.N)(),[m,x]=(0,r.useState)(window.innerWidth>1070),[u,g]=(0,r.useState)(window.innerWidth<640),[h,b]=(0,r.useState)([]),[p,y]=(0,r.useState)([]),[k,v]=(0,r.useState)([]),[j,N]=(0,r.useState)(!1),[W,T]=(0,r.useState)(!1),[C,E]=(0,r.useState)(null),[I,L]=(0,r.useState)(!1),[F,M]=(0,r.useState)(null),[q,P]=(0,r.useState)({name:"",roleId:"",branchId:"",startTime:"",endTime:"",duration:"",isActive:!0});(0,r.useEffect)((()=>{const e=()=>{g(window.innerWidth<640),x(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>(t?(n(),H()):(c(),L(!1),M(null),O()),()=>{c()})),[t,n,c]);const H=async()=>{T(!0),E(null);try{var e;const[t,a,r]=await Promise.all([l.A.get(d.Sn.SHIFTS.TEMPLATES.BASE,{params:{includeInactive:!0}}),l.A.get(d.Sn.ROLES.BASE),l.A.get(d.Sn.BRANCHES.BASE)]);b((null===(e=t.data)||void 0===e?void 0:e.data)||t.data||[]),y(a.data||[]),v(r.data||[])}catch(r){var t,a;console.error("Fehler beim Laden der Daten:",r),E((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r.message||i("teamWorktime.shifts.templates.errors.loadError"))}finally{T(!1)}},O=()=>{P({name:"",roleId:"",branchId:"",startTime:"",endTime:"",duration:"",isActive:!0}),M(null)},z=async e=>{e.preventDefault(),E(null),N(!0);try{if(!q.name||!q.roleId||!q.branchId||!q.startTime||!q.endTime)return E(i("teamWorktime.shifts.templates.errors.fillRequiredFields")),void N(!1);const e={name:q.name.trim(),roleId:Number(q.roleId),branchId:Number(q.branchId),startTime:q.startTime,endTime:q.endTime,duration:q.duration?Number(q.duration):null,isActive:q.isActive};F?await l.A.put(d.Sn.SHIFTS.TEMPLATES.BY_ID(F.id),e):await l.A.post(d.Sn.SHIFTS.TEMPLATES.BASE,e),await H(),L(!1),O()}catch(r){var t,a;console.error("Fehler beim Speichern des Templates:",r),E((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r.message||i("teamWorktime.shifts.templates.errors.saveError"))}finally{N(!1)}},R=()=>(0,A.jsxs)("div",{className:"space-y-4",children:[C&&(0,A.jsx)("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded",children:C}),I?(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,A.jsx)("h3",{className:"text-lg font-semibold dark:text-white",children:i(F?"teamWorktime.shifts.templates.editTitle":"teamWorktime.shifts.templates.createTitle")}),(0,A.jsx)("button",{onClick:()=>{L(!1),O()},className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]}),(0,A.jsxs)("form",{onSubmit:z,className:"space-y-4",children:[(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("teamWorktime.shifts.templates.form.name")," *"]}),(0,A.jsx)("input",{type:"text",value:q.name,onChange:e=>P((0,o.A)((0,o.A)({},q),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("teamWorktime.shifts.templates.form.branch")," *"]}),(0,A.jsxs)("select",{value:q.branchId,onChange:e=>P((0,o.A)((0,o.A)({},q),{},{branchId:Number(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:!!F,children:[(0,A.jsx)("option",{value:"",children:i("teamWorktime.shifts.templates.form.selectBranch")}),k.map((e=>(0,A.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("teamWorktime.shifts.templates.form.role")," *"]}),(0,A.jsxs)("select",{value:q.roleId,onChange:e=>P((0,o.A)((0,o.A)({},q),{},{roleId:Number(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:!!F,children:[(0,A.jsx)("option",{value:"",children:i("teamWorktime.shifts.templates.form.selectRole")}),p.map((e=>(0,A.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("teamWorktime.shifts.templates.form.startTime")," *"]}),(0,A.jsx)("input",{type:"time",value:q.startTime,onChange:e=>P((0,o.A)((0,o.A)({},q),{},{startTime:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("teamWorktime.shifts.templates.form.endTime")," *"]}),(0,A.jsx)("input",{type:"time",value:q.endTime,onChange:e=>P((0,o.A)((0,o.A)({},q),{},{endTime:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("teamWorktime.shifts.templates.form.duration")}),(0,A.jsx)("input",{type:"number",value:q.duration,onChange:e=>P((0,o.A)((0,o.A)({},q),{},{duration:e.target.value?Number(e.target.value):""})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:i("teamWorktime.shifts.templates.form.durationPlaceholder"),min:"0"})]}),(0,A.jsxs)("div",{className:"flex items-center",children:[(0,A.jsx)("input",{type:"checkbox",id:"isActive",checked:q.isActive,onChange:e=>P((0,o.A)((0,o.A)({},q),{},{isActive:e.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,A.jsx)("label",{htmlFor:"isActive",className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:i("teamWorktime.shifts.templates.form.isActive")})]}),(0,A.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,A.jsx)("button",{type:"button",onClick:()=>{L(!1),O()},className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",children:i("common.cancel")}),(0,A.jsx)("button",{type:"submit",disabled:j,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i(j?"common.saving":"common.save")})]})]})]}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,A.jsx)("h3",{className:"text-lg font-semibold dark:text-white",children:i("teamWorktime.shifts.templates.title")}),(0,A.jsx)("button",{onClick:()=>L(!0),className:"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,A.jsx)(se.A,{className:"h-5 w-5"})})]}),W?(0,A.jsx)("div",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:i("common.loading")}):0===h.length?(0,A.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:i("teamWorktime.shifts.templates.noTemplates")}):(0,A.jsx)("div",{className:"space-y-2",children:h.map((e=>{var t,a;return(0,A.jsxs)("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg flex items-center justify-between",children:[(0,A.jsxs)("div",{className:"flex-1",children:[(0,A.jsxs)("div",{className:"flex items-center gap-2",children:[(0,A.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),!e.isActive&&(0,A.jsx)("span",{className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded",children:i("teamWorktime.shifts.templates.inactive")})]}),(0,A.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[null===(t=e.branch)||void 0===t?void 0:t.name," - ",null===(a=e.role)||void 0===a?void 0:a.name]}),(0,A.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:[e.startTime," - ",e.endTime,e.duration&&" (".concat(e.duration," ").concat(i("teamWorktime.shifts.templates.minutes"),")")]})]}),(0,A.jsxs)("div",{className:"flex gap-2",children:[(0,A.jsx)("button",{onClick:()=>(e=>{M(e),P({name:e.name,roleId:e.roleId,branchId:e.branchId,startTime:e.startTime,endTime:e.endTime,duration:e.duration||"",isActive:e.isActive}),L(!0)})(e),className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded",children:(0,A.jsx)(f.A,{className:"h-5 w-5"})}),(0,A.jsx)("button",{onClick:()=>(async e=>{if(window.confirm(i("teamWorktime.shifts.templates.deleteConfirm"))){E(null),N(!0);try{await l.A.delete(d.Sn.SHIFTS.TEMPLATES.BY_ID(e)),await H()}catch(r){var t,a;console.error("Fehler beim L\xf6schen des Templates:",r),E((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r.message||i("teamWorktime.shifts.templates.errors.deleteError"))}finally{N(!1)}}})(e.id),className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:(0,A.jsx)(D.A,{className:"h-5 w-5"})})]})]},e.id)}))})]})]});return u?(0,A.jsxs)(w.lG,{open:t,onClose:a,className:"relative z-50",children:[(0,A.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,A.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,A.jsxs)(w.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden",children:[(0,A.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0",children:(0,A.jsxs)("div",{className:"flex items-center justify-between",children:[(0,A.jsx)(w.lG.Title,{className:"text-lg font-semibold dark:text-white",children:i("teamWorktime.shifts.templates.title")}),(0,A.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]})}),(0,A.jsx)("div",{className:"p-6 overflow-y-auto flex-1 min-h-0",children:R()})]})})]}):(0,A.jsxs)(A.Fragment,{children:[t&&!m&&(0,A.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:a,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,A.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,A.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,A.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:i("teamWorktime.shifts.templates.title")}),(0,A.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]}),(0,A.jsx)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:R()})]})]})},We=e=>{let{isOpen:t,onClose:a}=e;const{t:i}=(0,s.Bd)(),{user:c}=(0,ce.As)(),{hasPermission:m}=(0,q.S)(),{openSidepane:x,closeSidepane:u}=(0,he.N)(),[g,h]=(0,r.useState)(window.innerWidth>1070),[b,p]=(0,r.useState)(window.innerWidth<640),y=m("availability_management","write","page"),[k,v]=(0,r.useState)([]),[j,N]=(0,r.useState)([]),[W,T]=(0,r.useState)([]),[C,E]=(0,r.useState)([]),[I,L]=(0,r.useState)(null),[F,M]=(0,r.useState)(!1),[P,H]=(0,r.useState)(!1),[O,z]=(0,r.useState)(null),[R,G]=(0,r.useState)(!1),[B,_]=(0,r.useState)(null),[V,U]=(0,r.useState)({userId:null,branchId:"",roleId:"",dayOfWeek:"",startTime:"",endTime:"",startDate:"",endDate:"",type:"available",priority:5,notes:"",isActive:!0}),Y=[{value:"",label:i("teamWorktime.shifts.availabilities.form.allDays")},{value:0,label:i("teamWorktime.shifts.availabilities.form.sunday")},{value:1,label:i("teamWorktime.shifts.availabilities.form.monday")},{value:2,label:i("teamWorktime.shifts.availabilities.form.tuesday")},{value:3,label:i("teamWorktime.shifts.availabilities.form.wednesday")},{value:4,label:i("teamWorktime.shifts.availabilities.form.thursday")},{value:5,label:i("teamWorktime.shifts.availabilities.form.friday")},{value:6,label:i("teamWorktime.shifts.availabilities.form.saturday")}];(0,r.useEffect)((()=>{const e=()=>{p(window.innerWidth<640),h(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>(t?(x(),K()):(u(),G(!1),_(null),Z(),L(null)),()=>{u()})),[t,x,u,I,y]);const K=async()=>{H(!0),z(null);try{var e;if(y)try{const e=await l.A.get(d.Sn.USERS.DROPDOWN);E(e.data||[])}catch(r){console.error("Fehler beim Laden der User:",r)}const t={includeInactive:!0};y&&I?t.userId=I:y&&!I||null!==c&&void 0!==c&&c.id&&(t.userId=c.id);const[a,s,i]=await Promise.all([l.A.get(d.Sn.SHIFTS.AVAILABILITIES.BASE,{params:t}),l.A.get(d.Sn.ROLES.BASE),l.A.get(d.Sn.BRANCHES.BASE)]);v((null===(e=a.data)||void 0===e?void 0:e.data)||a.data||[]),N(s.data||[]),T(i.data||[])}catch(r){var t,a;console.error("Fehler beim Laden der Daten:",r),z((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r.message||i("teamWorktime.shifts.availabilities.errors.loadError"))}finally{H(!1)}},Z=()=>{U({userId:null,branchId:"",roleId:"",dayOfWeek:"",startTime:"",endTime:"",startDate:"",endDate:"",type:"available",priority:5,notes:"",isActive:!0}),_(null)},Q=async e=>{e.preventDefault(),z(null),M(!0);try{const e={branchId:V.branchId?Number(V.branchId):null,roleId:V.roleId?Number(V.roleId):null,dayOfWeek:""===V.dayOfWeek||null===V.dayOfWeek?null:Number(V.dayOfWeek),startTime:V.startTime||null,endTime:V.endTime||null,startDate:V.startDate||null,endDate:V.endDate||null,type:V.type,priority:V.priority,notes:V.notes.trim()||null,isActive:V.isActive};y&&V.userId&&(e.userId=V.userId),B?await l.A.put(d.Sn.SHIFTS.AVAILABILITIES.BY_ID(B.id),e):await l.A.post(d.Sn.SHIFTS.AVAILABILITIES.BASE,e),await K(),G(!1),Z()}catch(r){var t,a;console.error("Fehler beim Speichern der Verf\xfcgbarkeit:",r),z((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r.message||i("teamWorktime.shifts.availabilities.errors.saveError"))}finally{M(!1)}},$=e=>{if(null===e)return i("teamWorktime.shifts.availabilities.form.allDays");return[i("teamWorktime.shifts.availabilities.form.sunday"),i("teamWorktime.shifts.availabilities.form.monday"),i("teamWorktime.shifts.availabilities.form.tuesday"),i("teamWorktime.shifts.availabilities.form.wednesday"),i("teamWorktime.shifts.availabilities.form.thursday"),i("teamWorktime.shifts.availabilities.form.friday"),i("teamWorktime.shifts.availabilities.form.saturday")][e]},J=e=>{switch(e){case"available":return i("teamWorktime.shifts.availabilities.type.available");case"preferred":return i("teamWorktime.shifts.availabilities.type.preferred");case"unavailable":return i("teamWorktime.shifts.availabilities.type.unavailable");default:return e}},X=e=>{switch(e){case"available":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case"preferred":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300";case"unavailable":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},ee=()=>(0,A.jsxs)("div",{className:"space-y-4",children:[O&&(0,A.jsx)("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded",children:O}),y&&!R&&(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("teamWorktime.shifts.availabilities.filter.user")}),(0,A.jsxs)("select",{value:I||"",onChange:e=>{const t=e.target.value?parseInt(e.target.value,10):null;L(t)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,A.jsx)("option",{value:"",children:i("teamWorktime.shifts.availabilities.filter.allUsers")}),C.map((e=>(0,A.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})]}),R?(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,A.jsx)("h3",{className:"text-lg font-semibold dark:text-white",children:i(B?"teamWorktime.shifts.availabilities.editTitle":"teamWorktime.shifts.availabilities.createTitle")}),(0,A.jsx)("button",{onClick:()=>{G(!1),Z()},className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]}),(0,A.jsxs)("form",{onSubmit:Q,className:"space-y-4",children:[y&&(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("teamWorktime.shifts.availabilities.form.user")}),(0,A.jsxs)("select",{value:V.userId||"",onChange:e=>U((0,o.A)((0,o.A)({},V),{},{userId:e.target.value?Number(e.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!!B,children:[(0,A.jsx)("option",{value:"",children:i("teamWorktime.shifts.availabilities.form.selectUser")}),C.map((e=>(0,A.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]}),B&&(0,A.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:i("teamWorktime.shifts.availabilities.form.userReadOnly")})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("teamWorktime.shifts.availabilities.form.branch")}),(0,A.jsxs)("select",{value:V.branchId,onChange:e=>U((0,o.A)((0,o.A)({},V),{},{branchId:e.target.value?Number(e.target.value):""})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,A.jsx)("option",{value:"",children:i("teamWorktime.shifts.availabilities.form.selectBranch")}),W.map((e=>(0,A.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("teamWorktime.shifts.availabilities.form.role")}),(0,A.jsxs)("select",{value:V.roleId,onChange:e=>U((0,o.A)((0,o.A)({},V),{},{roleId:e.target.value?Number(e.target.value):""})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,A.jsx)("option",{value:"",children:i("teamWorktime.shifts.availabilities.form.selectRole")}),j.map((e=>(0,A.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("teamWorktime.shifts.availabilities.form.dayOfWeek")}),(0,A.jsx)("select",{value:null===V.dayOfWeek?"":V.dayOfWeek,onChange:e=>U((0,o.A)((0,o.A)({},V),{},{dayOfWeek:""===e.target.value?null:Number(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:Y.map((e=>(0,A.jsx)("option",{value:e.value,children:e.label},e.value)))})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("teamWorktime.shifts.availabilities.form.startTime")}),(0,A.jsx)("input",{type:"time",value:V.startTime,onChange:e=>U((0,o.A)((0,o.A)({},V),{},{startTime:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,A.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:i("teamWorktime.shifts.availabilities.form.startTimeHint")})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("teamWorktime.shifts.availabilities.form.endTime")}),(0,A.jsx)("input",{type:"time",value:V.endTime,onChange:e=>U((0,o.A)((0,o.A)({},V),{},{endTime:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,A.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:i("teamWorktime.shifts.availabilities.form.endTimeHint")})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("teamWorktime.shifts.availabilities.form.startDate")}),(0,A.jsx)("input",{type:"date",value:V.startDate,onChange:e=>U((0,o.A)((0,o.A)({},V),{},{startDate:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,A.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:i("teamWorktime.shifts.availabilities.form.startDateHint")})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("teamWorktime.shifts.availabilities.form.endDate")}),(0,A.jsx)("input",{type:"date",value:V.endDate,onChange:e=>U((0,o.A)((0,o.A)({},V),{},{endDate:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,A.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:i("teamWorktime.shifts.availabilities.form.endDateHint")})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("teamWorktime.shifts.availabilities.form.type")}),(0,A.jsxs)("select",{value:V.type,onChange:e=>U((0,o.A)((0,o.A)({},V),{},{type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,A.jsx)("option",{value:"available",children:i("teamWorktime.shifts.availabilities.type.available")}),(0,A.jsx)("option",{value:"preferred",children:i("teamWorktime.shifts.availabilities.type.preferred")}),(0,A.jsx)("option",{value:"unavailable",children:i("teamWorktime.shifts.availabilities.type.unavailable")})]})]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[i("teamWorktime.shifts.availabilities.form.priority")," (1-10)"]}),(0,A.jsx)("input",{type:"number",value:V.priority,onChange:e=>U((0,o.A)((0,o.A)({},V),{},{priority:Number(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"10"})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:i("teamWorktime.shifts.availabilities.form.notes")}),(0,A.jsx)("textarea",{value:V.notes,onChange:e=>U((0,o.A)((0,o.A)({},V),{},{notes:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:i("teamWorktime.shifts.availabilities.form.notesPlaceholder")})]}),(0,A.jsxs)("div",{className:"flex items-center",children:[(0,A.jsx)("input",{type:"checkbox",id:"isActive",checked:V.isActive,onChange:e=>U((0,o.A)((0,o.A)({},V),{},{isActive:e.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,A.jsx)("label",{htmlFor:"isActive",className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:i("teamWorktime.shifts.availabilities.form.isActive")})]}),(0,A.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,A.jsx)("button",{type:"button",onClick:()=>{G(!1),Z()},className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",children:i("common.cancel")}),(0,A.jsx)("button",{type:"submit",disabled:F,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i(F?"common.saving":"common.save")})]})]})]}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,A.jsx)("h3",{className:"text-lg font-semibold dark:text-white",children:i("teamWorktime.shifts.availabilities.title")}),(0,A.jsx)("button",{onClick:()=>G(!0),className:"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,A.jsx)(se.A,{className:"h-5 w-5"})})]}),P?(0,A.jsx)("div",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:i("common.loading")}):0===k.length?(0,A.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:i("teamWorktime.shifts.availabilities.noAvailabilities")}):(0,A.jsx)("div",{className:"space-y-2",children:k.map((e=>(0,A.jsx)("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:(0,A.jsxs)("div",{className:"flex items-start justify-between",children:[(0,A.jsxs)("div",{className:"flex-1",children:[(0,A.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,A.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(X(e.type)),children:J(e.type)}),!e.isActive&&(0,A.jsx)("span",{className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded",children:i("teamWorktime.shifts.availabilities.inactive")}),e.priority&&(0,A.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[i("teamWorktime.shifts.availabilities.priority"),": ",e.priority]})]}),(0,A.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-1",children:[e.user&&y&&(0,A.jsxs)("div",{children:[(0,A.jsxs)("span",{className:"font-medium",children:[i("teamWorktime.shifts.availabilities.userLabel"),":"]})," ",e.user.firstName," ",e.user.lastName]}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("span",{className:"font-medium",children:[i("teamWorktime.shifts.availabilities.form.dayOfWeek"),":"]})," ",$(e.dayOfWeek)]}),e.startTime&&e.endTime&&(0,A.jsxs)("div",{children:[(0,A.jsxs)("span",{className:"font-medium",children:[i("teamWorktime.shifts.availabilities.form.startTime")," - ",i("teamWorktime.shifts.availabilities.form.endTime"),":"]})," ",e.startTime," - ",e.endTime]}),e.startDate&&e.endDate&&(0,A.jsxs)("div",{children:[(0,A.jsxs)("span",{className:"font-medium",children:[i("teamWorktime.shifts.availabilities.form.startDate")," - ",i("teamWorktime.shifts.availabilities.form.endDate"),":"]})," ",(0,n.GP)(new Date(e.startDate),"dd.MM.yyyy")," - ",(0,n.GP)(new Date(e.endDate),"dd.MM.yyyy")]}),e.branch&&(0,A.jsxs)("div",{children:[(0,A.jsxs)("span",{className:"font-medium",children:[i("teamWorktime.shifts.availabilities.form.branch"),":"]})," ",e.branch.name]}),e.role&&(0,A.jsxs)("div",{children:[(0,A.jsxs)("span",{className:"font-medium",children:[i("teamWorktime.shifts.availabilities.form.role"),":"]})," ",e.role.name]}),e.notes&&(0,A.jsx)("div",{className:"mt-2 p-2 bg-gray-50 dark:bg-gray-700 rounded text-xs",children:e.notes})]})]}),(0,A.jsxs)("div",{className:"flex gap-2",children:[(0,A.jsx)("button",{onClick:()=>(e=>{_(e),U({userId:e.userId,branchId:e.branchId||"",roleId:e.roleId||"",dayOfWeek:null!==e.dayOfWeek?e.dayOfWeek:"",startTime:e.startTime||"",endTime:e.endTime||"",startDate:e.startDate?(0,n.GP)(new Date(e.startDate),"yyyy-MM-dd"):"",endDate:e.endDate?(0,n.GP)(new Date(e.endDate),"yyyy-MM-dd"):"",type:e.type,priority:e.priority,notes:e.notes||"",isActive:e.isActive}),G(!0)})(e),className:"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded",children:(0,A.jsx)(f.A,{className:"h-5 w-5"})}),(0,A.jsx)("button",{onClick:()=>(async e=>{if(window.confirm(i("teamWorktime.shifts.availabilities.deleteConfirm"))){z(null),M(!0);try{await l.A.delete(d.Sn.SHIFTS.AVAILABILITIES.BY_ID(e)),await K()}catch(r){var t,a;console.error("Fehler beim L\xf6schen der Verf\xfcgbarkeit:",r),z((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||r.message||i("teamWorktime.shifts.availabilities.errors.deleteError"))}finally{M(!1)}}})(e.id),className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:(0,A.jsx)(D.A,{className:"h-5 w-5"})})]})]})},e.id)))})]})]});return b?(0,A.jsxs)(w.lG,{open:t,onClose:a,className:"relative z-50",children:[(0,A.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,A.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,A.jsxs)(w.lG.Panel,{className:"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden",children:[(0,A.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0",children:(0,A.jsxs)("div",{className:"flex items-center justify-between",children:[(0,A.jsx)(w.lG.Title,{className:"text-lg font-semibold dark:text-white",children:i("teamWorktime.shifts.availabilities.title")}),(0,A.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]})}),(0,A.jsx)("div",{className:"p-6 overflow-y-auto flex-1 min-h-0",children:ee()})]})})]}):(0,A.jsxs)(A.Fragment,{children:[t&&!g&&(0,A.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:a,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,A.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,A.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,A.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:i("teamWorktime.shifts.availabilities.title")}),(0,A.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-6 w-6"})})]}),(0,A.jsx)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:ee()})]})]})},Te=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#06b6d4","#84cc16","#f97316","#6366f1","#14b8a6","#a855f7","#eab308","#22c55e","#64748b"],Ae={scheduled:"#3b82f6",confirmed:"#10b981",cancelled:"#ef4444",swapped:"#f59e0b"};function Ce(e){return e?Te[e%Te.length]:"#64748b"}function De(e){return Ae[e]||"#64748b"}const Ee=e=>{let{selectedDate:t}=e;const{t:a}=(0,s.Bd)(),{user:i}=(0,ce.As)(),[o,c]=(0,r.useState)([]),[m,x]=(0,r.useState)([]),[u,g]=(0,r.useState)(!1),[b,y]=(0,r.useState)(null),[f,k]=(0,r.useState)(new Date),[v,j]=(0,r.useState)("timeGridWeek"),N=(0,r.useRef)(null),w=(0,r.useRef)(!1),[T,C]=(0,r.useState)(!1),[D,E]=(0,r.useState)([]),[I,L]=(0,r.useState)([]),[F,M]=(0,r.useState)([]),[q,P]=(0,r.useState)([]),[H,O]=(0,r.useState)([]),[z,R]=(0,r.useState)([]),[G,B]=(0,r.useState)([]),[_,V]=(0,r.useState)(!1),[U,Y]=(0,r.useState)(!1),[K,Z]=(0,r.useState)(!1),[Q,$]=(0,r.useState)(!1),[J,X]=(0,r.useState)(!1),[ee,te]=(0,r.useState)(!1),[ae,re]=(0,r.useState)(null),[he,pe]=(0,r.useState)(void 0),ye=(0,r.useCallback)((async e=>{try{g(!0),y(null);const r=(0,le.k)(e,{weekStartsOn:1}),s=(0,de.$)(e,{weekStartsOn:1}),i=d.Sn.SHIFTS.BASE,o={startDate:(0,n.GP)(r,"yyyy-MM-dd"),endDate:(0,n.GP)(s,"yyyy-MM-dd")};console.log("[ShiftPlanner] Fetching shifts from:",i),console.log("[ShiftPlanner] Params:",o),console.log("[ShiftPlanner] Full URL:","".concat(l.A.defaults.baseURL).concat(i));const c=await l.A.get(i,{params:o});if(console.log("[ShiftPlanner] Response status:",c.status),console.log("[ShiftPlanner] Response data:",c.data),c.data&&!1!==c.data.success){const e=c.data.data||c.data||[],t=Array.isArray(e)?e:[];x(t),console.log("[ShiftPlanner] Loaded shifts:",t.length)}else{var t;const e=(null===(t=c.data)||void 0===t?void 0:t.message)||a("teamWorktime.shifts.messages.loadError");console.error("[ShiftPlanner] Error in response:",e),y(e)}}catch(b){var r,s,i,o,c;if(console.error("[ShiftPlanner] Fehler beim Laden der Schichten:",b),console.error("[ShiftPlanner] Error details:",{message:b.message,response:b.response,status:null===(r=b.response)||void 0===r?void 0:r.status,statusText:null===(s=b.response)||void 0===s?void 0:s.statusText,data:null===(i=b.response)||void 0===i?void 0:i.data,url:null===(o=b.config)||void 0===o?void 0:o.url,baseURL:null===(c=b.config)||void 0===c?void 0:c.baseURL,fullURL:b.config?"".concat(b.config.baseURL).concat(b.config.url):"unknown"}),b.response){const t=b.response.status,r=b.response.data;var m;if(404===t)console.error("[ShiftPlanner] 404 - Route nicht gefunden. URL:",null===(m=b.config)||void 0===m?void 0:m.url),y(a("teamWorktime.shifts.messages.routeNotFound"));else if(401===t)console.error("[ShiftPlanner] 401 - Nicht authentifiziert"),y(a("teamWorktime.shifts.messages.unauthorized"));else if(403===t)console.error("[ShiftPlanner] 403 - Keine Berechtigung"),y(a("teamWorktime.shifts.messages.forbidden"));else{const s=(null===r||void 0===r?void 0:r.message)||b.message||a("teamWorktime.shifts.messages.loadError");console.error("[ShiftPlanner] Anderer Fehler:",t,s),y(s)}}else b.request?(console.error("[ShiftPlanner] Keine Response erhalten. Request:",b.request),y(a("teamWorktime.shifts.messages.loadError")+" (Keine Verbindung zum Server)")):(console.error("[ShiftPlanner] Fehler beim Setup der Request:",b.message),y(b.message||a("teamWorktime.shifts.messages.loadError")))}finally{g(!1)}}),[a]);(0,r.useEffect)((()=>{ye(f)}),[f,ye]),(0,r.useEffect)((()=>{(async()=>{try{const[e,t,a]=await Promise.all([l.A.get(d.Sn.BRANCHES.BASE),l.A.get(d.Sn.ROLES.BASE),l.A.get(d.Sn.USERS.DROPDOWN)]);O(e.data||[]),R(t.data||[]),B(a.data||[])}catch(e){console.error("Fehler beim Laden der Filter-Daten:",e)}})()}),[]),(0,r.useEffect)((()=>{let e=[...m];D.length>0&&(e=e.filter((e=>D.includes(e.branchId)))),I.length>0&&(e=e.filter((e=>I.includes(e.roleId)))),F.length>0&&(e=e.filter((e=>F.includes(e.status)))),q.length>0&&(e=e.filter((e=>e.userId&&q.includes(e.userId)))),c(e)}),[m,D,I,F,q]);const ke=(0,le.k)(f,{weekStartsOn:1}),ve=(0,de.$)(f,{weekStartsOn:1}),Ne=(0,r.useMemo)((()=>o.map((e=>{var t,a;const r=new Date(e.startTime),s=new Date(e.endTime),i=Ce(e.branchId),l=De(e.status);return{id:e.id.toString(),title:e.user?"".concat((null===(t=e.shiftTemplate)||void 0===t?void 0:t.name)||"Schicht"," - ").concat(e.user.firstName," ").concat(e.user.lastName):"".concat((null===(a=e.shiftTemplate)||void 0===a?void 0:a.name)||"Schicht"," - Nicht zugewiesen"),start:r.toISOString(),end:s.toISOString(),backgroundColor:i,borderColor:l,borderWidth:3,textColor:"#ffffff",extendedProps:{shift:e}}}))),[o]),Te=()=>D.length+I.length+F.length+q.length,Ae=[{value:"scheduled",label:a("teamWorktime.shifts.status.scheduled")},{value:"confirmed",label:a("teamWorktime.shifts.status.confirmed")},{value:"cancelled",label:a("teamWorktime.shifts.status.cancelled")},{value:"swapped",label:a("teamWorktime.shifts.status.swapped")}];return(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{className:"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6",children:[(0,A.jsx)("div",{className:"flex items-center",children:(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{type:"button",onClick:()=>{pe(f),V(!0)},className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":a("teamWorktime.shifts.actions.add"),children:(0,A.jsx)(se.A,{className:"h-4 w-4"})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("teamWorktime.shifts.actions.add")})]})}),(0,A.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{type:"button",onClick:()=>{w.current=!0,k((0,ne.k)(f,1))},className:"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,A.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,A.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("common.previousDay")})]}),(0,A.jsxs)("div",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white px-2 sm:px-3",children:[(0,n.GP)(ke,"dd.MM.yyyy")," - ",(0,n.GP)(ve,"dd.MM.yyyy")]}),(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{type:"button",onClick:()=>{w.current=!0,k((0,oe.J)(f,1))},className:"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,A.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,A.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("common.nextDay")})]}),(0,A.jsxs)("div",{className:"relative group ml-1",children:[(0,A.jsx)("button",{type:"button",onClick:()=>{w.current=!0,k(new Date)},className:"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,A.jsx)(ie.A,{className:"h-4 w-4"})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("common.today")})]})]}),(0,A.jsxs)("div",{className:"flex items-center gap-1",children:[(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsxs)("button",{type:"button",onClick:()=>C(!T),className:"p-2 rounded-md ".concat(Te()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"," focus:outline-none focus:ring-2 focus:ring-blue-500 relative"),children:[(0,A.jsx)(p.A,{className:"h-5 w-5"}),Te()>0&&(0,A.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10",children:Te()})]}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("common.filter")})]}),(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{type:"button",onClick:()=>te(!0),className:"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,A.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,A.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("teamWorktime.shifts.availabilities.title")})]}),(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{type:"button",onClick:()=>X(!0),className:"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,A.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,A.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("teamWorktime.shifts.templates.title")})]}),(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{type:"button",onClick:()=>$(!0),className:"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,A.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,A.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("teamWorktime.shifts.swapList.title")})]}),(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{type:"button",onClick:()=>{Z(!0)},className:"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,A.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,A.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("teamWorktime.shifts.actions.generate")})]}),(0,A.jsxs)("div",{className:"relative group",children:[(0,A.jsx)("button",{type:"button",onClick:()=>ye(f),className:"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,A.jsx)(W.A,{className:"h-5 w-5"})}),(0,A.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("common.refresh")})]})]})]}),b&&(0,A.jsx)("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4",children:b}),!u&&o.length>0&&(()=>{const e=new Map,t=new Map;o.forEach((r=>{if(r.branch&&!e.has(r.branch.id)&&e.set(r.branch.id,{id:r.branch.id,name:r.branch.name,color:Ce(r.branch.id)}),!t.has(r.status)){const e={scheduled:a("teamWorktime.shifts.status.scheduled"),confirmed:a("teamWorktime.shifts.status.confirmed"),cancelled:a("teamWorktime.shifts.status.cancelled"),swapped:a("teamWorktime.shifts.status.swapped")};t.set(r.status,{status:r.status,label:e[r.status]||r.status,color:De(r.status)})}}));const r=Array.from(e.values()),s=Array.from(t.values());return 0===r.length&&0===s.length?null:(0,A.jsx)("div",{className:"mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:(0,A.jsxs)("div",{className:"flex flex-wrap gap-6",children:[r.length>0&&(0,A.jsxs)("div",{children:[(0,A.jsx)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:a("teamWorktime.shifts.legend.branches")}),(0,A.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map((e=>(0,A.jsxs)("div",{className:"flex items-center gap-2",children:[(0,A.jsx)("div",{className:"w-4 h-4 rounded",style:{backgroundColor:e.color}}),(0,A.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:e.name})]},e.id)))})]}),s.length>0&&(0,A.jsxs)("div",{children:[(0,A.jsx)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:a("teamWorktime.shifts.legend.statuses")}),(0,A.jsx)("div",{className:"flex flex-wrap gap-2",children:s.map((e=>(0,A.jsxs)("div",{className:"flex items-center gap-2",children:[(0,A.jsx)("div",{className:"w-4 h-4 rounded border-2",style:{backgroundColor:"transparent",borderColor:e.color}}),(0,A.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:e.label})]},e.status)))})]})]})})})(),u?(0,A.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,A.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:a("teamWorktime.shifts.messages.loading")})}):(0,A.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4",children:[(0,A.jsx)("div",{className:"flex justify-end mb-4",children:(0,A.jsxs)("div",{className:"inline-flex rounded-md shadow-sm gap-1",role:"group",children:[(0,A.jsx)("button",{onClick:()=>{var e;j("timeGridWeek"),null===(e=N.current)||void 0===e||e.getApi().changeView("timeGridWeek")},className:"p-2 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ".concat("timeGridWeek"===v?"bg-blue-600 text-white":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600"),title:a("common.week","Woche"),children:(0,A.jsx)(ie.A,{className:"h-5 w-5"})}),(0,A.jsx)("button",{onClick:()=>{var e;j("dayGridMonth"),null===(e=N.current)||void 0===e||e.getApi().changeView("dayGridMonth")},className:"p-2 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ".concat("dayGridMonth"===v?"bg-blue-600 text-white":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600"),title:a("common.month","Monat"),children:(0,A.jsx)(h.A,{className:"h-5 w-5"})})]})}),T&&(0,A.jsx)("div",{className:"mb-4 px-3 sm:px-4 md:px-6",children:(0,A.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,A.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,A.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:a("teamWorktime.shifts.filters.title")}),(0,A.jsx)("button",{onClick:()=>C(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,A.jsx)(S.A,{className:"h-5 w-5"})})]}),(0,A.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:a("teamWorktime.shifts.filters.branch")}),(0,A.jsx)("div",{className:"max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2 bg-white dark:bg-gray-700",children:H.map((e=>(0,A.jsxs)("label",{className:"flex items-center space-x-2 py-1",children:[(0,A.jsx)("input",{type:"checkbox",checked:D.includes(e.id),onChange:t=>{t.target.checked?E([...D,e.id]):E(D.filter((t=>t!==e.id)))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,A.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.name})]},e.id)))})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:a("teamWorktime.shifts.filters.role")}),(0,A.jsx)("div",{className:"max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2 bg-white dark:bg-gray-700",children:z.map((e=>(0,A.jsxs)("label",{className:"flex items-center space-x-2 py-1",children:[(0,A.jsx)("input",{type:"checkbox",checked:I.includes(e.id),onChange:t=>{t.target.checked?L([...I,e.id]):L(I.filter((t=>t!==e.id)))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,A.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.name})]},e.id)))})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:a("teamWorktime.shifts.filters.status")}),(0,A.jsx)("div",{className:"max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2 bg-white dark:bg-gray-700",children:Ae.map((e=>(0,A.jsxs)("label",{className:"flex items-center space-x-2 py-1",children:[(0,A.jsx)("input",{type:"checkbox",checked:F.includes(e.value),onChange:t=>{t.target.checked?M([...F,e.value]):M(F.filter((t=>t!==e.value)))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,A.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.label})]},e.value)))})]}),(0,A.jsxs)("div",{children:[(0,A.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:a("teamWorktime.shifts.filters.user")}),(0,A.jsx)("div",{className:"max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2 bg-white dark:bg-gray-700",children:G.map((e=>(0,A.jsxs)("label",{className:"flex items-center space-x-2 py-1",children:[(0,A.jsx)("input",{type:"checkbox",checked:q.includes(e.id),onChange:t=>{t.target.checked?P([...q,e.id]):P(q.filter((t=>t!==e.id)))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,A.jsxs)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:[e.firstName," ",e.lastName]})]},e.id)))})]})]}),(0,A.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,A.jsx)("button",{onClick:()=>{E([]),L([]),M([]),P([])},className:"px-3 py-1.5 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",children:a("teamWorktime.shifts.filters.reset")}),(0,A.jsx)("button",{onClick:()=>C(!1),className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",children:a("common.apply")})]})]})}),(0,A.jsx)("div",{className:"fullcalendar-container",children:(0,A.jsx)(me.A,{ref:N,plugins:[xe.A,ue.A,ge.Ay],initialView:v,initialDate:f,headerToolbar:{left:"prev,next today",center:"title",right:""},locale:"de",firstDay:1,weekNumbers:!0,weekNumberCalculation:"ISO",slotMinTime:"00:00:00",slotMaxTime:"24:00:00",slotDuration:"01:00:00",slotLabelInterval:"01:00:00",allDaySlot:!1,height:"auto",events:Ne,eventClick:e=>{const t=e.event.extendedProps.shift;console.log("Shift clicked:",t),re(t),Y(!0)},dateClick:e=>{console.log("Date clicked:",e.date),pe(e.date),V(!0)},datesSet:e=>{var t;const a=null===(t=N.current)||void 0===t?void 0:t.getApi().view.type;if(a&&a!==v&&j(a),"timeGridWeek"===a&&!w.current){const t=(0,le.k)(e.start,{weekStartsOn:1}),a=(0,le.k)(f,{weekStartsOn:1});t.getTime()!==a.getTime()&&k(e.start)}w.current=!1},eventDisplay:"block",eventTimeFormat:{hour:"2-digit",minute:"2-digit",hour12:!1},slotLabelFormat:{hour:"2-digit",minute:"2-digit",hour12:!1},eventClassNames:"cursor-pointer",eventContent:e=>{var t;const r=e.event.extendedProps.shift;return(0,A.jsxs)("div",{className:"p-1 text-xs",children:[(0,A.jsx)("div",{className:"font-semibold truncate",children:(null===(t=r.shiftTemplate)||void 0===t?void 0:t.name)||"Schicht"}),r.user&&(0,A.jsxs)("div",{className:"truncate text-gray-600 dark:text-gray-300",children:[r.user.firstName," ",r.user.lastName]}),!r.user&&(0,A.jsx)("div",{className:"text-gray-500 dark:text-gray-400 italic",children:a("teamWorktime.shifts.legend.unassigned")})]})}})}),(0,A.jsxs)("div",{className:"mt-4 flex flex-wrap gap-4 text-sm",children:[(0,A.jsxs)("div",{className:"flex items-center",children:[(0,A.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded mr-2"}),(0,A.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:a("teamWorktime.shifts.legend.scheduled")})]}),(0,A.jsxs)("div",{className:"flex items-center",children:[(0,A.jsx)("div",{className:"w-4 h-4 bg-green-500 rounded mr-2"}),(0,A.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:a("teamWorktime.shifts.legend.confirmed")})]}),(0,A.jsxs)("div",{className:"flex items-center",children:[(0,A.jsx)("div",{className:"w-4 h-4 bg-red-500 rounded mr-2"}),(0,A.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:a("teamWorktime.shifts.legend.cancelled")})]}),(0,A.jsxs)("div",{className:"flex items-center",children:[(0,A.jsx)("div",{className:"w-4 h-4 bg-orange-500 rounded mr-2"}),(0,A.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:a("teamWorktime.shifts.legend.swapped")})]})]})]}),(0,A.jsx)(be,{isOpen:_,onClose:()=>{V(!1),pe(void 0)},onShiftCreated:e=>{c((t=>[...t,e])),ye(f)},initialDate:he}),ae&&(0,A.jsx)(fe,{isOpen:U,onClose:()=>{Y(!1),re(null)},onShiftUpdated:e=>{c((t=>t.map((t=>t.id===e.id?e:t)))),ye(f)},onShiftDeleted:e=>{c((t=>t.filter((t=>t.id!==e)))),ye(f)},shift:ae}),(0,A.jsx)(je,{isOpen:K,onClose:()=>Z(!1),onPlanGenerated:()=>{ye(f)},initialStartDate:(0,le.k)(f,{weekStartsOn:1}),initialEndDate:(0,de.$)(f,{weekStartsOn:1})}),(0,A.jsx)(we,{isOpen:Q,onClose:()=>$(!1),onSwapRequestUpdated:()=>{ye(f)}}),(0,A.jsx)(Se,{isOpen:J,onClose:()=>X(!1)}),(0,A.jsx)(We,{isOpen:ee,onClose:()=>te(!1)})]})},Ie=()=>{const{t:e}=(0,s.Bd)(),{hasPermission:t}=(0,q.S)(),a=t("team_worktime_control","read","page"),o=t("team_worktime","read","table"),c=a&&o,[m,x]=(0,r.useState)([]),[u,g]=(0,r.useState)([]),[h,b]=(0,r.useState)((0,n.GP)(new Date,"yyyy-MM-dd")),[p,y]=(0,r.useState)("worktimes"),[f,k]=(0,r.useState)(!1),[v,j]=(0,r.useState)(null),N=(0,r.useCallback)((async()=>{try{k(!0),j(null);const e=await l.A.get(d.Sn.TEAM_WORKTIME.ACTIVE);x(e.data)}catch(v){var t,a,r;console.error("Fehler beim Laden der aktiven Benutzer:",v);let l=e("teamWorktime.messages.loadActiveUsersError");if(v.response){var s;const t=v.response.status,a=null===(s=v.response.data)||void 0===s?void 0:s.message;403===t?l=a||e("teamWorktime.permissions.insufficientShort"):401===t?l=e("teamWorktime.messages.unauthorized",{defaultValue:"Nicht autorisiert"}):500===t?l=e("teamWorktime.messages.serverError",{defaultValue:"Serverfehler"}):a&&(l=a)}else v.message&&(l=v.message);j(l),console.error("Fehlerdetails:",{status:null===(t=v.response)||void 0===t?void 0:t.status,statusText:null===(a=v.response)||void 0===a?void 0:a.statusText,data:null===(r=v.response)||void 0===r?void 0:r.data,message:v.message})}finally{k(!1)}}),[e]),w=(0,r.useCallback)((async()=>{try{k(!0),j(null);const e=await l.A.get("".concat(d.Sn.TEAM_WORKTIME.USER_DAY,"?date=").concat(h));g(e.data)}catch(v){console.error("Fehler beim Laden der Zeiterfassungen:",v),j(e("teamWorktime.messages.loadWorktimesError"))}finally{k(!1)}}),[h,e]);return(0,r.useEffect)((()=>{if(!c)return void j(e("teamWorktime.permissions.insufficientDetails"));N(),w();const t=setInterval(N,3e4);return()=>clearInterval(t)}),[N,w,c]),(0,r.useEffect)((()=>{w()}),[h,w]),(0,A.jsx)("div",{className:"min-h-screen dark:bg-gray-900",children:(0,A.jsx)("div",{className:"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6",children:(0,A.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,A.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,A.jsxs)("div",{className:"flex items-center pl-2 sm:pl-0",children:[(0,A.jsx)(i.A,{className:"h-6 w-6 text-gray-900 dark:text-white mr-2"}),(0,A.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:e("teamWorktime.title")})]})}),!c&&(0,A.jsxs)("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4",children:[(0,A.jsx)("p",{className:"font-medium mb-2",children:e("teamWorktime.permissions.insufficient")}),(0,A.jsxs)("ul",{className:"list-disc list-inside text-sm space-y-1",children:[!a&&(0,A.jsx)("li",{children:e("teamWorktime.permissions.missingPage")}),!o&&(0,A.jsx)("li",{children:e("teamWorktime.permissions.missingTable")})]}),(0,A.jsx)("p",{className:"text-sm mt-2",children:e("teamWorktime.permissions.contactAdmin")})]}),v&&(0,A.jsx)("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4",children:v}),(0,A.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:(0,A.jsxs)("nav",{className:"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden",children:[(0,A.jsx)("button",{onClick:()=>y("worktimes"),className:"py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ".concat("worktimes"===p?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("teamWorktime.tabs.worktimes")}),(0,A.jsx)("button",{onClick:()=>y("shifts"),className:"py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ".concat("shifts"===p?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("teamWorktime.tabs.shifts")}),(0,A.jsx)("button",{onClick:()=>y("todos"),className:"py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ".concat("todos"===p?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("teamWorktime.tabs.todos")}),(0,A.jsx)("button",{onClick:()=>y("requests"),className:"py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ".concat("requests"===p?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("teamWorktime.tabs.requests")})]})}),"worktimes"===p&&(0,A.jsx)(U,{activeUsers:m,allWorktimes:u,loading:f,selectedDate:h,onDateChange:b,onStopWorktime:async(t,a)=>{try{k(!0),j(null),await l.A.post(d.Sn.TEAM_WORKTIME.STOP_USER,{userId:t,endTime:new Date((new Date).getTime()-6e4*(new Date).getTimezoneOffset())}),N()}catch(v){console.error("Fehler beim Stoppen der Benutzer-Zeiterfassung:",v),j(e("teamWorktime.messages.stopWorktimeError"))}finally{k(!1)}},onRefresh:N,showTodos:!0,showRequests:!0}),"shifts"===p&&(0,A.jsx)(Ee,{selectedDate:h}),"todos"===p&&(0,A.jsx)(X,{selectedDate:h}),"requests"===p&&(0,A.jsx)(re,{selectedDate:h})]})})})}}}]);
//# sourceMappingURL=256.63c4c8db.chunk.js.map