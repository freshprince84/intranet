"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[768],{542:(e,t,r)=>{r.d(t,{Ay:()=>d,H_:()=>c,Zj:()=>o,i$:()=>i});var a=r(1923),n=r(1801);console.log("DEBUGAUSGABE API-Client: API_URL ist:",n.H$);const s=a.A;s.interceptors.request.use((e=>{var t;const r="".concat(e.baseURL).concat(e.url);console.log("DEBUGAUSGABE API-Client: Vollst\xe4ndige Request URL:",r),console.log("DEBUGAUSGABE API-Client: Request-Methode:",null===(t=e.method)||void 0===t?void 0:t.toUpperCase()),console.log("DEBUGAUSGABE API-Client: Request-Headers:",e.headers),console.log("DEBUGAUSGABE API-Client: Request-Daten:",e.data);const a=localStorage.getItem("token");return console.log("DEBUGAUSGABE API-Client: Token vorhanden:",!!a),e}),(e=>(console.error("DEBUGAUSGABE API-Client: Fehler im Request Interceptor:",e),Promise.reject(e)))),s.interceptors.response.use((e=>(console.log("DEBUGAUSGABE API-Client: Response erhalten:",e.status,e.config.url),e)),(e=>(console.error("DEBUGAUSGABE API-Client: Fehler im Response Interceptor:",e.message),e.response?(console.error("DEBUGAUSGABE API-Client: Response Status:",e.response.status),console.error("DEBUGAUSGABE API-Client: Response Daten:",e.response.data)):console.error("DEBUGAUSGABE API-Client: Keine Response erhalten"),Promise.reject(e))));const i={getAll:()=>s.get("/users"),getById:e=>s.get("/users/".concat(e)),create:e=>{console.log("DEBUGAUSGABE API-Client: userApi.create wird aufgerufen mit Daten:",e);try{return s.post("/users",e).then((e=>(console.log("DEBUGAUSGABE API-Client: userApi.create Antwort:",e),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: userApi.create Fehler:",e.response||e),e}))}catch(t){throw console.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in userApi.create:",t),t}},update:(e,t)=>s.put("/users/".concat(e),t),updateRoles:(e,t)=>s.put("/users/".concat(e,"/roles"),{roleIds:t}),updateBranches:(e,t)=>s.put("/users/".concat(e,"/branches"),{branchIds:t})},o={getAll:e=>{console.log("DEBUGAUSGABE API-Client: roleApi.getAll wird aufgerufen",e?"mit branchId=".concat(e):"");const t=e?"/roles?branchId=".concat(e):"/roles";return s.get(t).then((e=>(console.log("DEBUGAUSGABE API-Client: roleApi.getAll erfolgreich:",e.data.length,"Rollen geladen"),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: roleApi.getAll Fehler:",e.message),e}))},getById:e=>(console.log("DEBUGAUSGABE API-Client: roleApi.getById(".concat(e,") wird aufgerufen")),s.get("/roles/".concat(e))),create:e=>{console.log("DEBUGAUSGABE API-Client: roleApi.create wird aufgerufen mit Daten:",e);try{return s.post("/roles",e).then((e=>(console.log("DEBUGAUSGABE API-Client: roleApi.create Antwort:",e),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: roleApi.create Fehler:",e.response||e),e}))}catch(t){throw console.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in roleApi.create:",t),t}},update:(e,t)=>{console.log("DEBUGAUSGABE API-Client: roleApi.update f\xfcr ID ".concat(e," wird aufgerufen mit Daten:"),t);try{return s.put("/roles/".concat(e),t).then((e=>(console.log("DEBUGAUSGABE API-Client: roleApi.update Antwort:",e),e))).catch((e=>{throw console.error("DEBUGAUSGABE API-Client: roleApi.update Fehler:",e.response||e),e}))}catch(r){throw console.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in roleApi.update:",r),r}},delete:e=>(console.log("DEBUGAUSGABE API-Client: roleApi.delete(".concat(e,") wird aufgerufen")),s.delete("/roles/".concat(e))),getRoleBranches:e=>(console.log("DEBUGAUSGABE API-Client: roleApi.getRoleBranches(".concat(e,") wird aufgerufen")),s.get("/roles/".concat(e,"/branches"))),updateRoleBranches:(e,t)=>(console.log("DEBUGAUSGABE API-Client: roleApi.updateRoleBranches(".concat(e,") wird aufgerufen mit:"),t),s.put("/roles/".concat(e,"/branches"),t))},c={getAll:e=>{const t=e?"/branches?roleId=".concat(e):"/branches";return s.get(t)},getById:e=>s.get("/branches/".concat(e)),getUserBranches:()=>s.get("/branches/user"),switchBranch:e=>s.put("/branches/switch",{branchId:e}),create:e=>s.post("/branches",e),update:(e,t)=>s.put("/branches/".concat(e),t),delete:e=>s.delete("/branches/".concat(e))},d=s},5408:(e,t,r)=>{r.d(t,{Gp:()=>d,Nn:()=>u,Pe:()=>g,Tt:()=>m,Yw:()=>i,f:()=>l,n4:()=>o,xv:()=>c});var a=r(9379),n=r(542),s=r(1801);const i=async e=>{try{return(await n.Ay.get(s.Sn.IDENTIFICATION_DOCUMENTS.BY_USER(e))).data}catch(t){throw console.error("Fehler beim Abrufen der Identifikationsdokumente:",t),t}},o=async(e,t)=>{try{return(await n.Ay.post(s.Sn.IDENTIFICATION_DOCUMENTS.BY_USER(e),t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){throw console.error("Fehler beim Hinzuf\xfcgen des Dokuments:",r),r}},c=async(e,t,r)=>{try{return(await n.Ay.post(s.Sn.IDENTIFICATION_DOCUMENTS.BY_USER(e),(0,a.A)((0,a.A)({},r),{},{imageData:t}))).data}catch(i){throw console.error("Fehler beim Hinzuf\xfcgen des Dokuments mit Kamera:",i),i}},d=async(e,t)=>{try{return(await n.Ay.put(s.Sn.IDENTIFICATION_DOCUMENTS.BY_ID(e),t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){throw console.error("Fehler beim Aktualisieren des Dokuments:",r),r}},l=async(e,t,r)=>{try{return(await n.Ay.put(s.Sn.IDENTIFICATION_DOCUMENTS.BY_ID(e),(0,a.A)((0,a.A)({},r),{},{imageData:t}))).data}catch(i){throw console.error("Fehler beim Aktualisieren des Dokuments mit Kamera:",i),i}},u=async e=>{try{await n.Ay.delete(s.Sn.IDENTIFICATION_DOCUMENTS.BY_ID(e))}catch(t){throw console.error("Fehler beim L\xf6schen des Dokuments:",t),t}},m=async(e,t)=>{try{await n.Ay.post(s.Sn.IDENTIFICATION_DOCUMENTS.VERIFY(e),{adminId:t})}catch(r){throw console.error("Fehler bei der Verifizierung des Dokuments:",r),r}},g=e=>"".concat(window.location.origin,"/api").concat(s.Sn.IDENTIFICATION_DOCUMENTS.DOWNLOAD(e))},6768:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(5043),n=r(4117),s=r(5408),i=r(7855),o=r(9743),c=r(2672),d=r(579);const l=e=>{let{userId:t,isAdmin:r=!1}=e;const{t:l}=(0,n.Bd)(),[u,m]=(0,a.useState)([]),[g,p]=(0,a.useState)(!0),[h,x]=(0,a.useState)(null),[y,b]=(0,a.useState)(!1),[f,w]=(0,a.useState)(null),[A,D]=(0,a.useState)(null),{showMessage:k}=(0,i.A)(),{user:v}=(0,c.As)(),N=async()=>{p(!0);try{const e=await s.Yw(t);m(e),x(null)}catch(e){x(e.message||l("identificationDocuments.loadError")),k(l("identificationDocuments.loadError"),"error")}finally{p(!1)}};(0,a.useEffect)((()=>{N()}),[t]);const j=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("de-DE")}catch(t){return e}};return y?(0,d.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[(0,d.jsx)("h3",{className:"text-lg font-medium mb-4",children:l("identificationDocuments.addDocument")}),(0,d.jsx)(o.A,{userId:t,onDocumentSaved:()=>{b(!1),N()},onCancel:()=>b(!1)})]}):f?(0,d.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[(0,d.jsx)("h3",{className:"text-lg font-medium mb-4",children:l("identificationDocuments.editDocument")}),(0,d.jsx)(o.A,{userId:t,document:f,onDocumentSaved:()=>{w(null),N()},onCancel:()=>w(null)})]}):(0,d.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,d.jsx)("h3",{className:"text-lg font-medium",children:l("identificationDocuments.title")}),(0,d.jsx)("button",{onClick:()=>b(!0),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700",children:l("identificationDocuments.newDocument")})]}),g?(0,d.jsx)("div",{className:"flex justify-center items-center p-4",children:(0,d.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-white"})}):h?(0,d.jsx)("div",{className:"text-red-600 p-4",children:h}):0===u.length?(0,d.jsx)("div",{className:"text-gray-500 dark:text-gray-400 p-4",children:l("identificationDocuments.noDocuments")}):(0,d.jsx)("div",{className:"overflow-x-auto",children:(0,d.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,d.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:l("identificationDocuments.columns.type")}),(0,d.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:l("identificationDocuments.columns.number")}),(0,d.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:l("identificationDocuments.columns.country")}),(0,d.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:l("identificationDocuments.columns.validFrom")}),(0,d.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:l("identificationDocuments.columns.validTo")}),(0,d.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:l("identificationDocuments.columns.status")}),(0,d.jsx)("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:l("identificationDocuments.columns.actions")})]})}),(0,d.jsx)("tbody",{className:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700",children:u.map((e=>{return(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:(t=e.documentType,{passport:l("identificationDocuments.types.passport"),national_id:l("identificationDocuments.types.national_id"),driving_license:l("identificationDocuments.types.driving_license"),residence_permit:l("identificationDocuments.types.residence_permit"),work_permit:l("identificationDocuments.types.work_permit"),tax_id:l("identificationDocuments.types.tax_id"),social_security:l("identificationDocuments.types.social_security")}[t]||t)}),(0,d.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:e.documentNumber}),(0,d.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:e.issuingCountry}),(0,d.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:j(e.issueDate)}),(0,d.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:j(e.expiryDate)}),(0,d.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:e.isVerified?(0,d.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-700 dark:text-green-100",children:l("identificationDocuments.status.verified")}):(0,d.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-700 dark:text-yellow-100",children:l("identificationDocuments.status.pending")})}),(0,d.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-medium",children:(0,d.jsxs)("div",{className:"flex space-x-2",children:[(0,d.jsx)("button",{onClick:()=>(async e=>{D(e);try{const t=s.Pe(e);window.open(t,"_blank")}catch(t){k("".concat(l("identificationDocuments.downloadError"),": ").concat(t.message||"Unbekannter Fehler"),"error")}finally{D(null)}})(e.id),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",disabled:A===e.id,children:A===e.id?l("identificationDocuments.actions.downloading"):l("identificationDocuments.actions.view")}),(0,d.jsx)("button",{onClick:()=>w(e),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",children:l("identificationDocuments.actions.edit")}),(0,d.jsx)("button",{onClick:()=>(async e=>{if(window.confirm(l("identificationDocuments.deleteConfirm")))try{await s.Nn(e),k(l("identificationDocuments.deleteSuccess"),"success"),N()}catch(t){k("".concat(l("identificationDocuments.deleteError"),": ").concat(t.message||"Unbekannter Fehler"),"error")}})(e.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:l("identificationDocuments.actions.delete")}),r&&!e.isVerified&&(0,d.jsx)("button",{onClick:()=>(async e=>{if(v)try{await s.Tt(e,v.id),k(l("identificationDocuments.verifySuccess"),"success"),N()}catch(t){k("".concat(l("identificationDocuments.verifyError"),": ").concat(t.message||"Unbekannter Fehler"),"error")}else k(l("identificationDocuments.notAuthenticated"),"error")})(e.id),className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",children:l("identificationDocuments.actions.verify")})]})})]},e.id);var t}))})]})})]})}},9743:(e,t,r)=>{r.d(t,{A:()=>x});var a=r(5043),n=r(4117),s=r(5408),i=r(7855);const o=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<768;var c=r(7591),d=r(2965),l=r(1816),u=r(9422),m=r(579);const g=e=>{let{onCapture:t,onCancel:r}=e;const{t:s}=(0,n.Bd)(),[i,g]=(0,a.useState)(null),[p,h]=(0,a.useState)(null),[x,y]=(0,a.useState)(null),b=(0,a.useRef)(null),f=(0,a.useRef)(null),w=async()=>{try{y(null);const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});g(e),b.current&&(b.current.srcObject=e)}catch(x){console.error("Fehler beim Zugriff auf die Kamera:",x),y(s("camera.accessError"))}},A=()=>{i&&(i.getTracks().forEach((e=>e.stop())),g(null))};return(0,a.useEffect)((()=>(o()&&w(),()=>{A()})),[]),o()?(0,m.jsxs)("div",{className:"camera-capture p-2 dark:bg-gray-800",children:[(0,m.jsx)("canvas",{ref:f,className:"hidden"}),x&&(0,m.jsxs)("div",{className:"error bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4",children:[(0,m.jsx)("p",{children:x}),(0,m.jsxs)("div",{className:"relative group mt-2",children:[(0,m.jsx)("button",{className:"p-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:r,children:(0,m.jsx)(c.A,{className:"h-5 w-5"})}),(0,m.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:s("camera.back")})]})]}),x||p?!x&&p?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"preview-container mb-4 rounded overflow-hidden border border-gray-300 dark:border-gray-700",children:(0,m.jsx)("img",{src:p,alt:"Aufgenommenes Dokument",className:"w-full h-auto"})}),(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsxs)("div",{className:"relative group",children:[(0,m.jsx)("button",{className:"p-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:()=>{h(null),w()},children:(0,m.jsx)(l.A,{className:"h-5 w-5"})}),(0,m.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Neu aufnehmen"})]}),(0,m.jsxs)("div",{className:"relative group",children:[(0,m.jsx)("button",{className:"p-2 bg-green-500 dark:bg-green-600 text-white rounded-md hover:bg-green-600 dark:hover:bg-green-700",onClick:()=>{p&&t(p)},children:(0,m.jsx)(u.A,{className:"h-5 w-5"})}),(0,m.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Verwenden"})]})]})]}):null:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"video-container mb-4 rounded overflow-hidden border border-gray-300 dark:border-gray-700",children:(0,m.jsx)("video",{ref:b,autoPlay:!0,playsInline:!0,className:"w-full h-auto"})}),(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsxs)("div",{className:"relative group",children:[(0,m.jsx)("button",{className:"p-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:r,children:(0,m.jsx)(c.A,{className:"h-5 w-5"})}),(0,m.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Abbrechen"})]}),(0,m.jsxs)("div",{className:"relative group",children:[(0,m.jsx)("button",{className:"p-2 bg-blue-500 dark:bg-blue-600 text-white rounded-md hover:bg-blue-600 dark:hover:bg-blue-700",onClick:()=>{if(b.current&&f.current){const e=f.current,t=b.current;e.width=t.videoWidth,e.height=t.videoHeight;const r=e.getContext("2d");if(r){r.drawImage(t,0,0);const a=e.toDataURL("image/jpeg",.9);h(a),A()}}},children:(0,m.jsx)(d.A,{className:"h-5 w-5"})}),(0,m.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Foto aufnehmen"})]})]})]})]}):(0,m.jsxs)("div",{className:"p-4 text-center dark:bg-gray-800 dark:text-white",children:[(0,m.jsx)("p",{className:"mb-4",children:s("camera.onlyMobile")}),(0,m.jsxs)("div",{className:"relative group",children:[(0,m.jsx)("button",{className:"p-2 bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 rounded-md",onClick:r,children:(0,m.jsx)(c.A,{className:"h-5 w-5"})}),(0,m.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:s("camera.back")})]})]})};var p=r(1801);var h=r(2704);const x=e=>{let{userId:t,document:r,onDocumentSaved:x,onCancel:y}=e;const{t:b}=(0,n.Bd)(),[f,w]=(0,a.useState)((null===r||void 0===r?void 0:r.documentType)||""),[A,D]=(0,a.useState)((null===r||void 0===r?void 0:r.documentNumber)||""),[k,v]=(0,a.useState)(null!==r&&void 0!==r&&r.issueDate?r.issueDate.substring(0,10):""),[N,j]=(0,a.useState)(null!==r&&void 0!==r&&r.expiryDate?r.expiryDate.substring(0,10):""),[E,I]=(0,a.useState)((null===r||void 0===r?void 0:r.issuingCountry)||""),[C,S]=(0,a.useState)((null===r||void 0===r?void 0:r.issuingAuthority)||""),[B,U]=(0,a.useState)(null),[G,F]=(0,a.useState)(null),[P,T]=(0,a.useState)(!1),[_,R]=(0,a.useState)(!1),[O,M]=(0,a.useState)(!1),[z,q]=(0,a.useState)(null),{showMessage:L}=(0,i.A)(),Y=[{value:"passport",label:b("identificationDocuments.types.passport")},{value:"national_id",label:b("identificationDocuments.types.national_id")},{value:"driving_license",label:b("identificationDocuments.types.driving_license")},{value:"residence_permit",label:b("identificationDocuments.types.residence_permit")},{value:"work_permit",label:b("identificationDocuments.types.work_permit")},{value:"tax_id",label:b("identificationDocuments.types.tax_id")},{value:"social_security",label:b("identificationDocuments.types.social_security")}],V=e=>{F(e),T(!1),U(null)},H=()=>{T(!1)};return P?(0,m.jsx)(g,{onCapture:V,onCancel:H}):(0,m.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),f&&A&&E){R(!0);try{if(r){if(B){const e=new FormData;A&&e.append("documentNumber",A),k&&e.append("issueDate",k),N&&e.append("expiryDate",N),E&&e.append("issuingCountry",E),C&&e.append("issuingAuthority",C),e.append("documentFile",B),await s.Gp(r.id,e)}else if(G)await s.f(r.id,G,{documentNumber:A,issuingCountry:E,issueDate:k,expiryDate:N,issuingAuthority:C});else{const e=new FormData;A&&e.append("documentNumber",A),k&&e.append("issueDate",k),N&&e.append("expiryDate",N),E&&e.append("issuingCountry",E),C&&e.append("issuingAuthority",C),await s.Gp(r.id,e)}L(b("identificationDocuments.form.updateSuccess"),"success")}else{if(B){const e=new FormData;e.append("documentType",f),e.append("documentNumber",A),e.append("issuingCountry",E),k&&e.append("issueDate",k),N&&e.append("expiryDate",N),C&&e.append("issuingAuthority",C),e.append("documentFile",B),await s.n4(t,e)}else if(G)await s.xv(t,G,{documentType:f,documentNumber:A,issuingCountry:E,issueDate:k,expiryDate:N,issuingAuthority:C});else{const e=new FormData;e.append("documentType",f),e.append("documentNumber",A),e.append("issuingCountry",E),k&&e.append("issueDate",k),N&&e.append("expiryDate",N),C&&e.append("issuingAuthority",C),await s.n4(t,e)}L(b("identificationDocuments.form.createSuccess"),"success")}x()}catch(i){var a,n;L(b("identificationDocuments.form.error",{error:(null===(a=i.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.error)||b("common.error")}),"error")}finally{R(!1)}}else L(b("identificationDocuments.form.fillRequiredFields"),"error")},className:"space-y-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{htmlFor:"documentType",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[b("identificationDocuments.form.documentType")," ",(0,m.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"*"})]}),(0,m.jsxs)("select",{id:"documentType",value:f,onChange:e=>w(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white",required:!0,children:[(0,m.jsx)("option",{value:"",children:b("identificationDocuments.form.selectDocumentType")}),Y.map((e=>(0,m.jsx)("option",{value:e.value,children:e.label},e.value)))]})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{htmlFor:"documentNumber",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[b("identificationDocuments.form.documentNumber")," ",(0,m.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"*"})]}),(0,m.jsx)("input",{type:"text",id:"documentNumber",value:A,onChange:e=>D(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white",required:!0})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{htmlFor:"issuingCountry",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[b("identificationDocuments.form.issuingCountry")," ",(0,m.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"*"})]}),(0,m.jsx)("input",{type:"text",id:"issuingCountry",value:E,onChange:e=>I(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white",required:!0})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"issuingAuthority",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:b("identificationDocuments.form.issuingAuthority")}),(0,m.jsx)("input",{type:"text",id:"issuingAuthority",value:C,onChange:e=>S(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"issueDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:b("identificationDocuments.form.issueDate")}),(0,m.jsx)("input",{type:"date",id:"issueDate",value:k,onChange:e=>v(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"expiryDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:b("identificationDocuments.form.expiryDate")}),(0,m.jsx)("input",{type:"date",id:"expiryDate",value:N,onChange:e=>j(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:text-white"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:b("identificationDocuments.form.documentImage")}),(0,m.jsxs)("div",{className:"mt-1 flex items-center space-x-2",children:[(0,m.jsxs)("label",{className:"flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 cursor-pointer",children:[(0,m.jsx)(h.A,{className:"h-5 w-5 mr-2 text-gray-500 dark:text-gray-400"}),b("identificationDocuments.form.uploadFile"),(0,m.jsx)("input",{type:"file",className:"sr-only",onChange:e=>{e.target.files&&e.target.files.length>0&&(U(e.target.files[0]),F(null))},accept:"image/*"})]}),o()&&(0,m.jsxs)("button",{type:"button",onClick:()=>T(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",children:[(0,m.jsx)(d.A,{className:"h-5 w-5 mr-2 text-gray-500 dark:text-gray-400"}),b("identificationDocuments.form.takePhoto")]}),(0,m.jsx)("button",{type:"button",onClick:async()=>{try{if(M(!0),q(null),!B&&!G)throw new Error(b("identificationDocuments.form.noDocumentUploaded"));let e=null;if(B?e=await new Promise(((e,t)=>{const r=new FileReader;r.onload=()=>e(r.result),r.onerror=t,r.readAsDataURL(B)})):G&&(e=G),!e)throw new Error(b("identificationDocuments.form.noImageData"));const t=await(async e=>{try{console.log("Starte KI-basierte Dokumentenerkennung..."),e.startsWith("data:image")||(e=e.startsWith("/9j/")?"data:image/jpeg;base64,"+e:e.startsWith("iVBOR")?"data:image/png;base64,"+e:"data:image/jpeg;base64,"+e);const t=localStorage.getItem("token");if(!t)throw new Error("Nicht authentifiziert. Bitte melden Sie sich an.");const r="".concat(p.H$,"/document-recognition");console.log("Verwende API-Endpunkt:",r);const a=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},credentials:"include",mode:"cors",body:JSON.stringify({image:e,documentType:"id_card"})});if(!a.ok){const e=await a.text();throw new Error("API-Anfrage fehlgeschlagen: ".concat(a.status," ").concat(e))}const n=await a.json();return console.log("KI-Ergebnis:",n),n}catch(t){return console.error("Fehler bei der KI-basierten Dokumentenerkennung:",t),{}}})(e);console.log("Erkannte Daten:",t),t.documentType&&w(t.documentType),t.documentNumber&&D(t.documentNumber),t.issueDate&&v(t.issueDate),t.expiryDate&&j(t.expiryDate),t.issuingCountry&&I(t.issuingCountry),t.issuingAuthority&&S(t.issuingAuthority),L(b("identificationDocuments.form.recognitionSuccess"),"success")}catch(e){console.error("Fehler bei der automatischen Erkennung:",e),q(e.message),L(b("identificationDocuments.form.recognitionError",{error:e.message}),"error")}finally{M(!1)}},disabled:O||!B&&!G,className:"inline-flex items-center px-4 py-2 border rounded-md shadow-sm text-sm font-medium ".concat(O||!B&&!G?"bg-gray-100 dark:bg-gray-800 text-gray-400 dark:text-gray-500 border-gray-300 dark:border-gray-700 cursor-not-allowed":"border-blue-300 dark:border-blue-700 text-blue-700 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 hover:bg-blue-100 dark:hover:bg-blue-900/50"),children:O?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(l.A,{className:"h-5 w-5 mr-2 animate-spin"}),b("identificationDocuments.form.recognitionRunning")]}):b("identificationDocuments.form.autoRecognize")})]}),B&&(0,m.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:b("identificationDocuments.form.selectedFile",{name:B.name})}),G&&(0,m.jsxs)("div",{className:"mt-2",children:[(0,m.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:b("identificationDocuments.form.capturedImage")}),(0,m.jsx)("img",{src:G,alt:b("identificationDocuments.form.capturedDocument"),className:"max-h-40 border dark:border-gray-700 rounded"})]}),z&&(0,m.jsx)("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:b("identificationDocuments.form.recognitionErrorLabel",{error:z})})]}),(0,m.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,m.jsx)("button",{type:"button",onClick:y,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",title:b("common.cancel"),children:(0,m.jsx)(c.A,{className:"h-5 w-5"})}),(0,m.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",disabled:_,title:b(_?"common.saving":r?"identificationDocuments.form.update":"common.save"),children:_?(0,m.jsx)(l.A,{className:"h-5 w-5 animate-spin"}):(0,m.jsx)(u.A,{className:"h-5 w-5"})})]})]})}}}]);
//# sourceMappingURL=768.ed67b344.chunk.js.map