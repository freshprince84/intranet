{"version":3,"file":"static/js/931.6c9b2664.chunk.js","mappings":"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","sources":["components/CertificateCreationModal.tsx","components/ContractCreationModal.tsx","components/CertificateEditModal.tsx","components/ContractEditModal.tsx","components/SocialSecurityEditor.tsx","components/OffboardingStartModal.tsx","components/OffboardingCompleteModal.tsx","components/LifecycleView.tsx","components/UserManagementTab.tsx","components/RoleManagementTab.tsx","components/BranchManagementTab.tsx","components/organization/CreateOrganizationModal.tsx","components/organization/JoinOrganizationModal.tsx","components/organization/RoleConfigurationTab.tsx","components/organization/DocumentConfigurationTab.tsx","components/organization/SMTPConfigurationTab.tsx","utils/urlValidation.ts","components/organization/ApiConfigurationTab.tsx","components/organization/EditOrganizationModal.tsx","components/organization/MyJoinRequestsList.tsx","components/organization/OrganizationSettings.tsx","components/organization/ProcessJoinRequestModal.tsx","components/organization/JoinRequestsList.tsx","pages/Organisation.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, UserIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface CertificateCreationModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCertificateCreated: () => void;\n  userId: number;\n  userName: string;\n}\n\ninterface UserData {\n  firstName: string;\n  lastName: string;\n  identificationNumber: string | null;\n  contractStartDate: string | null;\n  contractEndDate: string | null;\n  contractType: string | null;\n  salary: number | null;\n  position: string | null;\n}\n\nconst CertificateCreationModal: React.FC<CertificateCreationModalProps> = ({\n  isOpen,\n  onClose,\n  onCertificateCreated,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { user: currentUser } = useAuth();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [activeTab, setActiveTab] = useState<'data' | 'text'>('data');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [userData, setUserData] = useState<UserData | null>(null);\n  const [issueDate, setIssueDate] = useState(new Date().toISOString().split('T')[0]);\n  const [certificateType, setCertificateType] = useState('employment');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [uploading, setUploading] = useState(false);\n  const [availableTemplates, setAvailableTemplates] = useState<Array<{type: string; version: string; path: string}>>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null);\n  const [useTemplate, setUseTemplate] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitszeugnisse erstellen', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      fetchUserData();\n      fetchTemplates();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const fetchTemplates = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      const templates: Array<{type: string; version: string; path: string}> = [];\n      \n      if (documentTemplates.employmentCertificate) {\n        templates.push({\n          type: 'employmentCertificate',\n          version: documentTemplates.employmentCertificate.version,\n          path: documentTemplates.employmentCertificate.path\n        });\n      }\n      \n      setAvailableTemplates(templates);\n      if (templates.length > 0) {\n        setSelectedTemplate(templates[0].type);\n        setUseTemplate(true);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Templates:', err);\n      // Kein Fehler anzeigen, Templates sind optional\n    }\n  };\n\n  const fetchUserData = async () => {\n    try {\n      const [userResponse, lifecycleResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.USERS.BY_ID(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId))\n      ]);\n\n      const user = userResponse.data;\n      const lifecycle = lifecycleResponse.data.lifecycle;\n\n      const userDataObj = {\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        identificationNumber: user.identificationNumber || null,\n        contractStartDate: lifecycle?.contractStartDate || null,\n        contractEndDate: lifecycle?.contractEndDate || null,\n        contractType: lifecycle?.contractType || null,\n        salary: user.salary || null,\n        position: null // TODO: Aus Rollen ableiten\n      };\n\n      setUserData(userDataObj);\n\n      // Automatische Vorausfllung: Ausstellungsdatum auf heute setzen (wenn noch nicht gesetzt)\n      if (!issueDate || issueDate === new Date().toISOString().split('T')[0]) {\n        setIssueDate(new Date().toISOString().split('T')[0]);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der User-Daten:', err);\n      setError('Fehler beim Laden der Daten');\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) { // 10MB\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      setUseTemplate(false); // Deaktiviere Template wenn PDF hochgeladen wird\n      // Erstelle Preview-URL\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n    }\n  };\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const validateForm = (): string | null => {\n    if (!useTemplate && !pdfFile) {\n      return 'Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch';\n    }\n    if (!issueDate) {\n      return 'Bitte geben Sie ein Ausstellungsdatum an';\n    }\n    const issueDateObj = new Date(issueDate);\n    if (isNaN(issueDateObj.getTime())) {\n      return 'Ungltiges Ausstellungsdatum';\n    }\n    if (issueDateObj > new Date()) {\n      return 'Ausstellungsdatum darf nicht in der Zukunft liegen';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Client-seitige Validierung\n    const validationError = validateForm();\n    if (validationError) {\n      setError(validationError);\n      showMessage(validationError, 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      let pdfPath: string | undefined = undefined;\n      let templateUsed: string | null = null;\n      let templateVersion: string | null = null;\n\n      // Wenn Template verwendet werden soll und kein PDF hochgeladen wurde\n      if (useTemplate && selectedTemplate && !pdfFile) {\n        const template = availableTemplates.find(t => t.type === selectedTemplate);\n        if (template) {\n          templateUsed = template.type;\n          templateVersion = template.version;\n          // PDF wird vom Backend generiert\n        }\n      } else if (pdfFile) {\n        // PDF wurde hochgeladen - verwende dieses\n        pdfPath = `temp-${Date.now()}-${pdfFile.name}`; // Temporr\n      } else {\n        showMessage('Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch', 'error');\n        setLoading(false);\n        return;\n      }\n\n      const certificateData = {\n        certificateType,\n        issueDate: new Date(issueDate),\n        pdfPath,\n        templateUsed,\n        templateVersion\n      };\n\n      await axiosInstance.post(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATES(userId),\n        certificateData\n      );\n\n      showMessage('Arbeitszeugnis erfolgreich erstellt', 'success');\n      onCertificateCreated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      setIssueDate(new Date().toISOString().split('T')[0]);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Erstellen des Arbeitszeugnisses:', err);\n      setError(err.response?.data?.message || 'Fehler beim Erstellen des Arbeitszeugnisses');\n      showMessage('Fehler beim Erstellen des Arbeitszeugnisses', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {/* Overlay - nur auf Mobile und Desktop (nicht Large Desktop) */}\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n          `}\n          style={{\n            animation: isMobile ? 'none' : 'slideIn 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94)'\n          }}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitszeugnis erstellen\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Fr: <span className=\"font-medium dark:text-white\">{userName}</span>\n              </p>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n              <nav className=\"-mb-px flex space-x-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('data')}\n                  className={`${\n                    activeTab === 'data'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Daten\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('text')}\n                  className={`${\n                    activeTab === 'text'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  PDF hochladen\n                </button>\n              </nav>\n            </div>\n\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            {/* Tab Content */}\n            {activeTab === 'data' && (\n              <div className=\"space-y-4\">\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4\">\n                  <h3 className=\"text-sm font-semibold dark:text-white mb-3\">\n                    Automatisch erkannte Daten\n                  </h3>\n                  <div className=\"space-y-2 text-sm\">\n                    {userData && (\n                      <>\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4 text-gray-400\" />\n                          <span className=\"text-gray-600 dark:text-gray-400\">Name:</span>\n                          <span className=\"dark:text-white\">\n                            {userData.firstName} {userData.lastName}\n                          </span>\n                        </div>\n                        {userData.identificationNumber && (\n                          <div className=\"flex items-center space-x-2\">\n                            <DocumentTextIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Cdula:</span>\n                            <span className=\"dark:text-white\">{userData.identificationNumber}</span>\n                          </div>\n                        )}\n                        {userData.contractStartDate && (\n                          <div className=\"flex items-center space-x-2\">\n                            <CalendarIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Eintrittsdatum:</span>\n                            <span className=\"dark:text-white\">\n                              {new Date(userData.contractStartDate).toLocaleDateString('de-DE')}\n                            </span>\n                          </div>\n                        )}\n                        {userData.contractEndDate && (\n                          <div className=\"flex items-center space-x-2\">\n                            <CalendarIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Austrittsdatum:</span>\n                            <span className=\"dark:text-white\">\n                              {new Date(userData.contractEndDate).toLocaleDateString('de-DE')}\n                            </span>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Ausstellungsdatum <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={issueDate}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setIssueDate(value);\n                      // Validierung: Datum darf nicht in der Zukunft liegen\n                      if (value && new Date(value) > new Date()) {\n                        setError('Ausstellungsdatum darf nicht in der Zukunft liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    max={new Date().toISOString().split('T')[0]}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && issueDate && new Date(issueDate) > new Date()\n                        ? 'border-red-500 dark:border-red-500' \n                        : error && !issueDate\n                        ? 'border-red-500 dark:border-red-500'\n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    required\n                    aria-invalid={(!issueDate || (issueDate && new Date(issueDate) > new Date())) ? true : undefined}\n                    aria-describedby={(!issueDate || (issueDate && new Date(issueDate) > new Date())) ? \"issueDate-error\" : undefined}\n                  />\n                  {error && (!issueDate || (issueDate && new Date(issueDate) > new Date())) && (\n                    <p id=\"issueDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                  {!error && (\n                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                      Das Datum darf nicht in der Zukunft liegen\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Zertifikat-Typ <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={certificateType}\n                    onChange={(e) => setCertificateType(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    required\n                  >\n                    <option value=\"employment\">Arbeitszeugnis</option>\n                    <option value=\"salary\">Gehaltsbescheinigung</option>\n                    <option value=\"work_experience\">Arbeitsbescheinigung</option>\n                  </select>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'text' && (\n              <div className=\"space-y-4\">\n                {/* Template-Auswahl */}\n                {availableTemplates.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Template verwenden\n                    </label>\n                    <div className=\"flex items-center space-x-3 mb-4\">\n                      <input\n                        type=\"checkbox\"\n                        checked={useTemplate}\n                        onChange={(e) => {\n                          setUseTemplate(e.target.checked);\n                          if (e.target.checked && pdfFile) {\n                            // Wenn Template aktiviert wird, entferne PDF\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      />\n                      <label className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        Template fr automatische PDF-Generierung verwenden\n                      </label>\n                    </div>\n                    {useTemplate && (\n                      <select\n                        value={selectedTemplate || ''}\n                        onChange={(e) => setSelectedTemplate(e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4\"\n                      >\n                        {availableTemplates.map((template) => (\n                          <option key={template.type} value={template.type}>\n                            Arbeitszeugnis (Version {template.version})\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    {useTemplate ? 'ODER PDF-Datei hochladen' : 'PDF-Datei hochladen'} {!useTemplate && <span className=\"text-red-500\">*</span>}\n                  </label>\n                  <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\".pdf\"\n                      onChange={handleFileSelect}\n                      className=\"hidden\"\n                    />\n                    {!pdfFile ? (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => fileInputRef.current?.click()}\n                          className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                        >\n                          PDF-Datei auswhlen\n                        </button>\n                        <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                          oder Datei hierher ziehen\n                        </p>\n                        <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                          Max. 10MB\n                        </p>\n                      </div>\n                    ) : (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                        <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                          {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                        </p>\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                            if (fileInputRef.current) {\n                              fileInputRef.current.value = '';\n                            }\n                          }}\n                          className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                        >\n                          Datei entfernen\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* PDF-Vorschau */}\n                {pdfPreviewUrl && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl}#view=FitH`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || (!pdfFile && !useTemplate)}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird erstellt...' : 'Erstellen'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default CertificateCreationModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, UserIcon, CurrencyDollarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface ContractCreationModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onContractCreated: () => void;\n  userId: number;\n  userName: string;\n}\n\ninterface UserData {\n  firstName: string;\n  lastName: string;\n  identificationNumber: string | null;\n  contractStartDate: string | null;\n  contractEndDate: string | null;\n  contractType: string | null;\n  salary: number | null;\n  position: string | null;\n}\n\nconst ContractCreationModal: React.FC<ContractCreationModalProps> = ({\n  isOpen,\n  onClose,\n  onContractCreated,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { user: currentUser } = useAuth();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [activeTab, setActiveTab] = useState<'data' | 'text'>('data');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [userData, setUserData] = useState<UserData | null>(null);\n  const [contractType, setContractType] = useState('employment');\n  const [startDate, setStartDate] = useState(new Date().toISOString().split('T')[0]);\n  const [endDate, setEndDate] = useState<string>('');\n  const [salary, setSalary] = useState<string>('');\n  const [workingHours, setWorkingHours] = useState<string>('');\n  const [position, setPosition] = useState<string>('');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [availableTemplates, setAvailableTemplates] = useState<Array<{type: string; version: string; path: string}>>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null);\n  const [useTemplate, setUseTemplate] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitsvertrge erstellen', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      fetchUserData();\n      fetchTemplates();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const fetchTemplates = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      const templates: Array<{type: string; version: string; path: string}> = [];\n      \n      if (documentTemplates.employmentContract) {\n        templates.push({\n          type: 'employmentContract',\n          version: documentTemplates.employmentContract.version,\n          path: documentTemplates.employmentContract.path\n        });\n      }\n      \n      setAvailableTemplates(templates);\n      if (templates.length > 0) {\n        setSelectedTemplate(templates[0].type);\n        setUseTemplate(true);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Templates:', err);\n      // Kein Fehler anzeigen, Templates sind optional\n    }\n  };\n\n  const fetchUserData = async () => {\n    try {\n      const [userResponse, lifecycleResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.USERS.BY_ID(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId))\n      ]);\n\n      const user = userResponse.data;\n      const lifecycle = lifecycleResponse.data.lifecycle;\n\n      const data: UserData = {\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        identificationNumber: user.identificationNumber || null,\n        contractStartDate: lifecycle?.contractStartDate || null,\n        contractEndDate: lifecycle?.contractEndDate || null,\n        contractType: lifecycle?.contractType || null,\n        salary: user.salary || null,\n        position: null\n      };\n\n      setUserData(data);\n      \n      // Setze Standard-Werte\n      if (data.contractStartDate) {\n        setStartDate(new Date(data.contractStartDate).toISOString().split('T')[0]);\n      }\n      if (data.contractEndDate) {\n        setEndDate(new Date(data.contractEndDate).toISOString().split('T')[0]);\n      }\n      if (data.salary) {\n        setSalary(data.salary.toString());\n      }\n      if (data.contractType) {\n        setContractType(data.contractType);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der User-Daten:', err);\n      setError('Fehler beim Laden der Daten');\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) { // 10MB\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      setUseTemplate(false); // Deaktiviere Template wenn PDF hochgeladen wird\n      // Erstelle Preview-URL\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n    }\n  };\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const validateForm = (): string | null => {\n    if (!useTemplate && !pdfFile) {\n      return 'Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch';\n    }\n    if (!startDate) {\n      return 'Bitte geben Sie ein Startdatum an';\n    }\n    const startDateObj = new Date(startDate);\n    if (isNaN(startDateObj.getTime())) {\n      return 'Ungltiges Startdatum';\n    }\n    if (endDate) {\n      const endDateObj = new Date(endDate);\n      if (isNaN(endDateObj.getTime())) {\n        return 'Ungltiges Enddatum';\n      }\n      if (endDateObj < startDateObj) {\n        return 'Enddatum muss nach dem Startdatum liegen';\n      }\n    }\n    if (salary && parseFloat(salary) < 0) {\n      return 'Gehalt darf nicht negativ sein';\n    }\n    if (workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)) {\n      return 'Arbeitsstunden mssen zwischen 0 und 168 liegen';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Client-seitige Validierung\n    const validationError = validateForm();\n    if (validationError) {\n      setError(validationError);\n      showMessage(validationError, 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      let pdfPath: string | undefined = undefined;\n      let templateUsed: string | null = null;\n      let templateVersion: string | null = null;\n\n      // Wenn Template verwendet werden soll und kein PDF hochgeladen wurde\n      if (useTemplate && selectedTemplate && !pdfFile) {\n        const template = availableTemplates.find(t => t.type === selectedTemplate);\n        if (template) {\n          templateUsed = template.type;\n          templateVersion = template.version;\n          // PDF wird vom Backend generiert\n        }\n      } else if (pdfFile) {\n        // PDF wurde hochgeladen - verwende dieses\n        pdfPath = `temp-${Date.now()}-${pdfFile.name}`; // Temporr\n      } else {\n        showMessage('Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch', 'error');\n        setLoading(false);\n        return;\n      }\n\n      const contractData = {\n        contractType,\n        startDate: new Date(startDate),\n        endDate: endDate ? new Date(endDate) : null,\n        salary: salary ? parseFloat(salary) : null,\n        workingHours: workingHours ? parseFloat(workingHours) : null,\n        position: position || null,\n        pdfPath,\n        templateUsed,\n        templateVersion\n      };\n\n      await axiosInstance.post(\n        API_ENDPOINTS.LIFECYCLE.CONTRACTS(userId),\n        contractData\n      );\n\n      showMessage('Arbeitsvertrag erfolgreich erstellt', 'success');\n      onContractCreated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      setStartDate(new Date().toISOString().split('T')[0]);\n      setEndDate('');\n      setSalary('');\n      setWorkingHours('');\n      setPosition('');\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Erstellen des Arbeitsvertrags:', err);\n      setError(err.response?.data?.message || 'Fehler beim Erstellen des Arbeitsvertrags');\n      showMessage('Fehler beim Erstellen des Arbeitsvertrags', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {/* Overlay */}\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitsvertrag erstellen\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Fr: <span className=\"font-medium dark:text-white\">{userName}</span>\n              </p>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n              <nav className=\"-mb-px flex space-x-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('data')}\n                  className={`${\n                    activeTab === 'data'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Vertragsdaten\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('text')}\n                  className={`${\n                    activeTab === 'text'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  PDF hochladen\n                </button>\n              </nav>\n            </div>\n\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            {/* Tab Content */}\n            {activeTab === 'data' && (\n              <div className=\"space-y-4\">\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4\">\n                  <h3 className=\"text-sm font-semibold dark:text-white mb-3\">\n                    Automatisch erkannte Daten\n                  </h3>\n                  <div className=\"space-y-2 text-sm\">\n                    {userData && (\n                      <>\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4 text-gray-400\" />\n                          <span className=\"text-gray-600 dark:text-gray-400\">Name:</span>\n                          <span className=\"dark:text-white\">\n                            {userData.firstName} {userData.lastName}\n                          </span>\n                        </div>\n                        {userData.identificationNumber && (\n                          <div className=\"flex items-center space-x-2\">\n                            <DocumentTextIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Cdula:</span>\n                            <span className=\"dark:text-white\">{userData.identificationNumber}</span>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Vertragstyp <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={contractType}\n                    onChange={(e) => setContractType(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  >\n                    <option value=\"employment\">Arbeitsvertrag</option>\n                    <option value=\"amendment\">Vertragsnderung</option>\n                    <option value=\"extension\">Vertragsverlngerung</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Startdatum <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={startDate}\n                    onChange={(e) => {\n                      setStartDate(e.target.value);\n                      setError(null); // Clear error when user starts typing\n                    }}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && !startDate \n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    required\n                    aria-invalid={!startDate}\n                    aria-describedby={!startDate ? \"startDate-error\" : undefined}\n                  />\n                  {error && !startDate && (\n                    <p id=\"startDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Enddatum (optional)\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={endDate}\n                    onChange={(e) => {\n                      setEndDate(e.target.value);\n                      // Wenn Enddatum gesetzt wird, prfe ob es nach Startdatum liegt\n                      if (e.target.value && startDate && new Date(e.target.value) < new Date(startDate)) {\n                        setError('Enddatum muss nach dem Startdatum liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    min={startDate || undefined}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && endDate && startDate && new Date(endDate) < new Date(startDate)\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    aria-invalid={endDate && startDate && new Date(endDate) < new Date(startDate) ? true : undefined}\n                    aria-describedby={endDate && startDate && new Date(endDate) < new Date(startDate) ? \"endDate-error\" : undefined}\n                  />\n                  {error && endDate && startDate && new Date(endDate) < new Date(startDate) && (\n                    <p id=\"endDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Position\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={position}\n                    onChange={(e) => setPosition(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    placeholder=\"z.B. Frontend-Entwickler\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Gehalt (optional)\n                  </label>\n                  <div className=\"relative\">\n                    <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                    <input\n                      type=\"number\"\n                      value={salary}\n                      onChange={(e) => {\n                        const value = e.target.value;\n                        setSalary(value);\n                        // Validierung: Gehalt darf nicht negativ sein\n                        if (value && parseFloat(value) < 0) {\n                          setError('Gehalt darf nicht negativ sein');\n                        } else {\n                          setError(null); // Clear error when valid\n                        }\n                      }}\n                      className={`w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                        error && salary && parseFloat(salary) < 0\n                          ? 'border-red-500 dark:border-red-500' \n                          : 'border-gray-300 dark:border-gray-600'\n                      }`}\n                      placeholder=\"0.00\"\n                      step=\"0.01\"\n                      min=\"0\"\n                      aria-invalid={salary && parseFloat(salary) < 0 ? true : undefined}\n                      aria-describedby={salary && parseFloat(salary) < 0 ? \"salary-error\" : undefined}\n                    />\n                  </div>\n                  {error && salary && parseFloat(salary) < 0 && (\n                    <p id=\"salary-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Arbeitsstunden/Woche (optional)\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={workingHours}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setWorkingHours(value);\n                      // Validierung: Arbeitsstunden mssen zwischen 0 und 168 liegen\n                      if (value && (parseFloat(value) < 0 || parseFloat(value) > 168)) {\n                        setError('Arbeitsstunden mssen zwischen 0 und 168 liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    placeholder=\"40\"\n                    step=\"0.1\"\n                    min=\"0\"\n                    max=\"168\"\n                    aria-invalid={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? true : undefined}\n                    aria-describedby={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? \"workingHours-error\" : undefined}\n                  />\n                  {error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) && (\n                    <p id=\"workingHours-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                    Maximal 168 Stunden pro Woche (24h  7 Tage)\n                  </p>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'text' && (\n              <div className=\"space-y-4\">\n                {/* Template-Auswahl */}\n                {availableTemplates.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Template verwenden\n                    </label>\n                    <div className=\"flex items-center space-x-3 mb-4\">\n                      <input\n                        type=\"checkbox\"\n                        checked={useTemplate}\n                        onChange={(e) => {\n                          setUseTemplate(e.target.checked);\n                          if (e.target.checked && pdfFile) {\n                            // Wenn Template aktiviert wird, entferne PDF\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      />\n                      <label className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        Template fr automatische PDF-Generierung verwenden\n                      </label>\n                    </div>\n                    {useTemplate && (\n                      <select\n                        value={selectedTemplate || ''}\n                        onChange={(e) => setSelectedTemplate(e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4\"\n                      >\n                        {availableTemplates.map((template) => (\n                          <option key={template.type} value={template.type}>\n                            Arbeitsvertrag (Version {template.version})\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    {useTemplate ? 'ODER PDF-Datei hochladen' : 'PDF-Datei hochladen'} {!useTemplate && <span className=\"text-red-500\">*</span>}\n                  </label>\n                  <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\".pdf\"\n                      onChange={handleFileSelect}\n                      className=\"hidden\"\n                    />\n                    {!pdfFile ? (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => fileInputRef.current?.click()}\n                          className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                        >\n                          PDF-Datei auswhlen\n                        </button>\n                        <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                          oder Datei hierher ziehen\n                        </p>\n                        <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                          Max. 10MB\n                        </p>\n                      </div>\n                    ) : (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                        <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                          {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                        </p>\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                            if (fileInputRef.current) {\n                              fileInputRef.current.value = '';\n                            }\n                          }}\n                          className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                        >\n                          Datei entfernen\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* PDF-Vorschau */}\n                {pdfPreviewUrl && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl}#view=FitH`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || (!pdfFile && !useTemplate) || !startDate}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird erstellt...' : 'Erstellen'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default ContractCreationModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Certificate {\n  id: number;\n  certificateType: string;\n  issueDate: string;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n}\n\ninterface CertificateEditModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCertificateUpdated: () => void;\n  userId: number;\n  certificate: Certificate;\n}\n\nconst CertificateEditModal: React.FC<CertificateEditModalProps> = ({\n  isOpen,\n  onClose,\n  onCertificateUpdated,\n  userId,\n  certificate\n}) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [issueDate, setIssueDate] = useState(\n    certificate.issueDate ? new Date(certificate.issueDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]\n  );\n  const [certificateType, setCertificateType] = useState(certificate.certificateType || 'employment');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [existingPdfUrl, setExistingPdfUrl] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitszeugnisse bearbeiten', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Lade bestehende PDF-URL wenn vorhanden\n      if (certificate.id) {\n        setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certificate.id));\n      }\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane, certificate.id, userId]);\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) {\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      // Erstelle Preview-URL fr neue Datei\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n      setExistingPdfUrl(null); // Verstecke bestehende PDF wenn neue hochgeladen wird\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const updateData: any = {\n        issueDate: new Date(issueDate),\n        certificateType\n      };\n\n      // Nur pdfPath aktualisieren, wenn neue Datei hochgeladen wurde\n      if (pdfFile) {\n        updateData.pdfPath = `temp-${Date.now()}-${pdfFile.name}`;\n        updateData.templateVersion = certificate.templateVersion || '1.0';\n      }\n\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATE(userId, certificate.id),\n        updateData\n      );\n\n      showMessage('Arbeitszeugnis erfolgreich aktualisiert', 'success');\n      onCertificateUpdated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Aktualisieren des Arbeitszeugnisses:', err);\n      setError(err.response?.data?.message || 'Fehler beim Aktualisieren des Arbeitszeugnisses');\n      showMessage('Fehler beim Aktualisieren des Arbeitszeugnisses', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitszeugnis bearbeiten\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Ausstellungsdatum\n                </label>\n                <input\n                  type=\"date\"\n                  value={issueDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setIssueDate(value);\n                    // Validierung: Datum darf nicht in der Zukunft liegen\n                    if (value && new Date(value) > new Date()) {\n                      setError('Ausstellungsdatum darf nicht in der Zukunft liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  max={new Date().toISOString().split('T')[0]}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && issueDate && new Date(issueDate) > new Date()\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  aria-invalid={issueDate && new Date(issueDate) > new Date() ? true : undefined}\n                  aria-describedby={issueDate && new Date(issueDate) > new Date() ? \"issueDate-error\" : undefined}\n                />\n                {error && issueDate && new Date(issueDate) > new Date() && (\n                  <p id=\"issueDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n                {!error && (\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                    Das Datum darf nicht in der Zukunft liegen\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Zertifikat-Typ\n                </label>\n                <select\n                  value={certificateType}\n                  onChange={(e) => setCertificateType(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                >\n                  <option value=\"employment\">Arbeitszeugnis</option>\n                  <option value=\"salary\">Gehaltsbescheinigung</option>\n                  <option value=\"work_experience\">Arbeitsbescheinigung</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  PDF-Datei aktualisieren (optional)\n                </label>\n                <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  {!pdfFile ? (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                      <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                      >\n                        Neue PDF-Datei auswhlen\n                      </button>\n                      <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                        oder Datei hierher ziehen\n                      </p>\n                      <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                        Max. 10MB\n                      </p>\n                    </div>\n                  ) : (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                      <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                        {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          setPdfFile(null);\n                          if (pdfPreviewUrl) {\n                            URL.revokeObjectURL(pdfPreviewUrl);\n                            setPdfPreviewUrl(null);\n                          }\n                          setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certificate.id));\n                          if (fileInputRef.current) {\n                            fileInputRef.current.value = '';\n                          }\n                        }}\n                        className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                      >\n                        Datei entfernen\n                      </button>\n                    </div>\n                  )}\n                </div>\n\n                {/* PDF-Vorschau */}\n                {(pdfPreviewUrl || existingPdfUrl) && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl || existingPdfUrl}${pdfPreviewUrl ? '#view=FitH' : '?preview=true#view=FitH'}`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4\">\n                <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n                  <strong>Hinweis:</strong> Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt.\n                  Eine neue Version wird erstellt (isLatest = true).\n                </p>\n              </div>\n            </form>\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird aktualisiert...' : 'Aktualisieren'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default CertificateEditModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, CurrencyDollarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Contract {\n  id: number;\n  contractType: string;\n  startDate: string;\n  endDate: string | null;\n  salary: number | null;\n  workingHours: number | null;\n  position: string | null;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n}\n\ninterface ContractEditModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onContractUpdated: () => void;\n  userId: number;\n  contract: Contract;\n}\n\nconst ContractEditModal: React.FC<ContractEditModalProps> = ({\n  isOpen,\n  onClose,\n  onContractUpdated,\n  userId,\n  contract\n}) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [contractType, setContractType] = useState(contract.contractType || 'employment');\n  const [startDate, setStartDate] = useState(\n    contract.startDate ? new Date(contract.startDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]\n  );\n  const [endDate, setEndDate] = useState(\n    contract.endDate ? new Date(contract.endDate).toISOString().split('T')[0] : ''\n  );\n  const [salary, setSalary] = useState(contract.salary ? contract.salary.toString() : '');\n  const [workingHours, setWorkingHours] = useState(contract.workingHours ? contract.workingHours.toString() : '');\n  const [position, setPosition] = useState(contract.position || '');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [existingPdfUrl, setExistingPdfUrl] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitsvertrge bearbeiten', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Lade bestehende PDF-URL wenn vorhanden\n      if (contract.id) {\n        setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contract.id));\n      }\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane, contract.id, userId]);\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) {\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      // Erstelle Preview-URL fr neue Datei\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n      setExistingPdfUrl(null); // Verstecke bestehende PDF wenn neue hochgeladen wird\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!startDate) {\n      showMessage('Bitte geben Sie ein Startdatum an', 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const updateData: any = {\n        contractType,\n        startDate: new Date(startDate),\n        endDate: endDate ? new Date(endDate) : null,\n        salary: salary ? parseFloat(salary) : null,\n        workingHours: workingHours ? parseFloat(workingHours) : null,\n        position: position || null\n      };\n\n      // Nur pdfPath aktualisieren, wenn neue Datei hochgeladen wurde\n      if (pdfFile) {\n        updateData.pdfPath = `temp-${Date.now()}-${pdfFile.name}`;\n        updateData.templateVersion = contract.templateVersion || '1.0';\n      }\n\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.CONTRACT(userId, contract.id),\n        updateData\n      );\n\n      showMessage('Arbeitsvertrag erfolgreich aktualisiert', 'success');\n      onContractUpdated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Aktualisieren des Arbeitsvertrags:', err);\n      setError(err.response?.data?.message || 'Fehler beim Aktualisieren des Arbeitsvertrags');\n      showMessage('Fehler beim Aktualisieren des Arbeitsvertrags', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitsvertrag bearbeiten\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Vertragstyp <span className=\"text-red-500\">*</span>\n                </label>\n                <select\n                  value={contractType}\n                  onChange={(e) => setContractType(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                >\n                  <option value=\"employment\">Arbeitsvertrag</option>\n                  <option value=\"amendment\">Vertragsnderung</option>\n                  <option value=\"extension\">Vertragsverlngerung</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Startdatum <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"date\"\n                  value={startDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setStartDate(value);\n                    // Wenn Enddatum gesetzt ist, prfe ob es nach Startdatum liegt\n                    if (endDate && value && new Date(endDate) < new Date(value)) {\n                      setError('Enddatum muss nach dem Startdatum liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && !startDate \n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  required\n                  aria-invalid={!startDate ? true : undefined}\n                  aria-describedby={!startDate ? \"startDate-error\" : undefined}\n                />\n                {error && !startDate && (\n                  <p id=\"startDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Enddatum (optional)\n                </label>\n                <input\n                  type=\"date\"\n                  value={endDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setEndDate(value);\n                    // Wenn Enddatum gesetzt wird, prfe ob es nach Startdatum liegt\n                    if (value && startDate && new Date(value) < new Date(startDate)) {\n                      setError('Enddatum muss nach dem Startdatum liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  min={startDate || undefined}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && endDate && startDate && new Date(endDate) < new Date(startDate)\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  aria-invalid={endDate && startDate && new Date(endDate) < new Date(startDate) ? true : undefined}\n                  aria-describedby={endDate && startDate && new Date(endDate) < new Date(startDate) ? \"endDate-error\" : undefined}\n                />\n                {error && endDate && startDate && new Date(endDate) < new Date(startDate) && (\n                  <p id=\"endDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Position\n                </label>\n                <input\n                  type=\"text\"\n                  value={position}\n                  onChange={(e) => setPosition(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  placeholder=\"z.B. Frontend-Entwickler\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Gehalt (optional)\n                </label>\n                <div className=\"relative\">\n                  <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                  <input\n                    type=\"number\"\n                    value={salary}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setSalary(value);\n                      // Validierung: Gehalt darf nicht negativ sein\n                      if (value && parseFloat(value) < 0) {\n                        setError('Gehalt darf nicht negativ sein');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    className={`w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && salary && parseFloat(salary) < 0\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    placeholder=\"0.00\"\n                    step=\"0.01\"\n                    min=\"0\"\n                    aria-invalid={salary && parseFloat(salary) < 0 ? true : undefined}\n                    aria-describedby={salary && parseFloat(salary) < 0 ? \"salary-error\" : undefined}\n                  />\n                </div>\n                {error && salary && parseFloat(salary) < 0 && (\n                  <p id=\"salary-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Arbeitsstunden/Woche (optional)\n                </label>\n                <input\n                  type=\"number\"\n                  value={workingHours}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setWorkingHours(value);\n                    // Validierung: Arbeitsstunden mssen zwischen 0 und 168 liegen\n                    if (value && (parseFloat(value) < 0 || parseFloat(value) > 168)) {\n                      setError('Arbeitsstunden mssen zwischen 0 und 168 liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  placeholder=\"40\"\n                  step=\"0.1\"\n                  min=\"0\"\n                  max=\"168\"\n                  aria-invalid={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? true : undefined}\n                  aria-describedby={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? \"workingHours-error\" : undefined}\n                />\n                {error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) && (\n                  <p id=\"workingHours-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  Maximal 168 Stunden pro Woche (24h  7 Tage)\n                </p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  PDF-Datei aktualisieren (optional)\n                </label>\n                <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  {!pdfFile ? (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                      <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                      >\n                        Neue PDF-Datei auswhlen\n                      </button>\n                      <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                        oder Datei hierher ziehen\n                      </p>\n                      <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                        Max. 10MB\n                      </p>\n                    </div>\n                  ) : (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                      <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                        {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          setPdfFile(null);\n                          if (pdfPreviewUrl) {\n                            URL.revokeObjectURL(pdfPreviewUrl);\n                            setPdfPreviewUrl(null);\n                          }\n                          setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contract.id));\n                          if (fileInputRef.current) {\n                            fileInputRef.current.value = '';\n                          }\n                        }}\n                        className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                      >\n                        Datei entfernen\n                      </button>\n                    </div>\n                  )}\n                </div>\n\n                {/* PDF-Vorschau */}\n                {(pdfPreviewUrl || existingPdfUrl) && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl || existingPdfUrl}${pdfPreviewUrl ? '#view=FitH' : '?preview=true#view=FitH'}`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4\">\n                <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n                  <strong>Hinweis:</strong> Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt.\n                  Eine neue Version wird erstellt (isLatest = true).\n                </p>\n              </div>\n            </form>\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || !startDate}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird aktualisiert...' : 'Aktualisieren'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default ContractEditModal;\n\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n  CheckCircleIcon,\n  ClockIcon,\n  XCircleIcon,\n  PencilIcon,\n  EnvelopeIcon,\n  DocumentTextIcon,\n  XMarkIcon,\n  ArrowPathIcon\n} from '@heroicons/react/24/outline';\n// Social Security Editor Component\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface SocialSecurityRegistration {\n  id: number;\n  registrationType: string;\n  registrationNumber: string | null;\n  provider: string | null;\n  registrationDate: string | null;\n  status: string;\n  notes: string | null;\n  completedAt: string | null;\n}\n\ninterface SocialSecurityEditorProps {\n  userId: number;\n  lifecycleId: number;\n  onUpdate?: () => void;\n}\n\ntype SocialSecurityType = 'arl' | 'eps' | 'pension' | 'caja';\n\nconst SocialSecurityEditor: React.FC<SocialSecurityEditorProps> = ({\n  userId,\n  lifecycleId,\n  onUpdate\n}) => {\n  const { t } = useTranslation();\n  const { isLegal, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  \n  const [registrations, setRegistrations] = useState<Record<SocialSecurityType, SocialSecurityRegistration | null>>({\n    arl: null,\n    eps: null,\n    pension: null,\n    caja: null\n  });\n  const [loading, setLoading] = useState(true);\n  const [editingType, setEditingType] = useState<SocialSecurityType | null>(null);\n  const [formData, setFormData] = useState({\n    status: 'pending' as string,\n    registrationNumber: '',\n    provider: '',\n    registrationDate: '',\n    notes: ''\n  });\n  const [saving, setSaving] = useState(false);\n  const loadingRef = useRef(false);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  // loadRegistrations auerhalb von useEffect definieren, damit es von handleSave aufgerufen werden kann\n  const loadRegistrations = useCallback(async () => {\n    // Erstelle neuen AbortController\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n    const abortController = new AbortController();\n    abortControllerRef.current = abortController;\n\n    loadingRef.current = true;\n    setLoading(true);\n    try {\n      const types: SocialSecurityType[] = ['arl', 'eps', 'pension', 'caja'];\n      const registrationPromises = types.map(async (type) => {\n        // Prfe ob Request abgebrochen wurde\n        if (abortController.signal.aborted) {\n          return { type, registration: null };\n        }\n\n        try {\n          const response = await axiosInstance.get(\n            API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, type),\n            {\n              timeout: 5000, // 5 Sekunden Timeout\n              signal: abortController.signal\n            }\n          );\n          return { type, registration: response.data };\n        } catch (error: any) {\n          // Ignoriere Abort-Errors (AbortError oder CanceledError von Axios)\n          if (error.name === 'AbortError' || error.name === 'CanceledError' || abortController.signal.aborted) {\n            return { type, registration: null };\n          }\n          // Behandle 404 als \"nicht vorhanden\" (normal)\n          if (error.response?.status === 404) {\n            return { type, registration: null };\n          }\n          // Behandle Network Errors und Timeouts\n          if (error.code === 'ERR_NETWORK' || error.code === 'ECONNABORTED' || error.message?.includes('ERR_INSUFFICIENT_RESOURCES')) {\n            console.warn(`Network error loading ${type}, treating as not found`);\n            return { type, registration: null };\n          }\n          console.error(`Error loading ${type}:`, error);\n          return { type, registration: null };\n        }\n      });\n\n      const results = await Promise.all(registrationPromises);\n      \n      // Prfe erneut ob Request abgebrochen wurde\n      if (abortController.signal.aborted) {\n        return;\n      }\n\n      const newRegistrations: Record<SocialSecurityType, SocialSecurityRegistration | null> = {\n        arl: null,\n        eps: null,\n        pension: null,\n        caja: null\n      };\n\n      results.forEach(({ type, registration }) => {\n        if (registration) {\n          // Backend gibt zurck: { id, type, status, number, provider, registeredAt, notes, completedAt }\n          // Mappe auf Frontend-Format: { id, registrationType, registrationNumber, provider, registrationDate, status, notes, completedAt }\n          newRegistrations[type as SocialSecurityType] = {\n            id: registration.id || 0,\n            registrationType: type,\n            registrationNumber: registration.number || registration.registrationNumber || null,\n            provider: registration.provider || null,\n            registrationDate: registration.registeredAt || registration.registrationDate || null,\n            status: registration.status || 'pending',\n            notes: registration.notes || null,\n            completedAt: registration.completedAt || null\n          };\n        }\n      });\n\n      setRegistrations(newRegistrations);\n    } catch (error: any) {\n      // Ignoriere Abort-Errors (AbortError oder CanceledError von Axios)\n      if (error.name === 'AbortError' || error.name === 'CanceledError' || abortController.signal.aborted) {\n        return;\n      }\n      console.error('Error loading registrations:', error);\n      showMessage(t('socialSecurity.loadError'), 'error');\n    } finally {\n      // Setze loading immer auf false, auch bei Abbruch\n      setLoading(false);\n      loadingRef.current = false;\n    }\n  }, [userId, t, showMessage]);\n\n  useEffect(() => {\n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      return;\n    }\n    \n    // Prfe Berechtigung und lade nur einmal pro userId/lifecycleId\n    const hasPermission = isLegal() || isAdmin();\n    if (!hasPermission || !userId || !lifecycleId) {\n      setLoading(false);\n      return;\n    }\n\n    // Verhindere mehrfaches gleichzeitiges Laden\n    if (loadingRef.current) {\n      return;\n    }\n\n    loadRegistrations();\n\n    // Cleanup: Breche Request ab wenn Component unmountet oder Dependencies sich ndern\n    return () => {\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n      loadingRef.current = false;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userId, lifecycleId, permissionsLoading]); // permissionsLoading als Dependency hinzugefgt\n\n  const handleEdit = (type: SocialSecurityType) => {\n    const registration = registrations[type];\n    if (registration) {\n      setFormData({\n        status: registration.status,\n        registrationNumber: registration.registrationNumber || '',\n        provider: registration.provider || '',\n        registrationDate: registration.registrationDate \n          ? new Date(registration.registrationDate).toISOString().split('T')[0]\n          : '',\n        notes: registration.notes || ''\n      });\n    } else {\n      setFormData({\n        status: 'pending',\n        registrationNumber: '',\n        provider: '',\n        registrationDate: '',\n        notes: ''\n      });\n    }\n    setEditingType(type);\n  };\n\n  const handleCancel = () => {\n    setEditingType(null);\n    setFormData({\n      status: 'pending',\n      registrationNumber: '',\n      provider: '',\n      registrationDate: '',\n      notes: ''\n    });\n  };\n\n  const handleSave = async () => {\n    if (!editingType) return;\n    \n    // Prfe Berechtigung nochmal vor dem Speichern\n    if (permissionsLoading) {\n      showMessage(t('common.loading', { defaultValue: 'Berechtigungen werden geladen...' }), 'warning');\n      return;\n    }\n    \n    if (!isLegal() && !isAdmin()) {\n      showMessage(t('lifecycle.noPermission', { defaultValue: 'Keine Berechtigung - nur Legal oder Admin' }), 'error');\n      return;\n    }\n\n    setSaving(true);\n    try {\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, editingType),\n        {\n          status: formData.status,\n          number: formData.registrationNumber || undefined,\n          provider: formData.provider || undefined,\n          registrationDate: formData.registrationDate \n            ? new Date(formData.registrationDate).toISOString()\n            : undefined,\n          notes: formData.notes || undefined\n        }\n      );\n\n      showMessage('Sozialversicherung erfolgreich aktualisiert', 'success');\n      setEditingType(null);\n      \n      // Warte kurz, damit Backend die Daten aktualisiert hat\n      await new Promise(resolve => setTimeout(resolve, 200));\n      \n      // Lade Registrierungen neu nach Update\n      await loadRegistrations();\n      \n      // onUpdate nur aufrufen, wenn es eine Funktion ist (verhindert Re-Render-Loops)\n      if (onUpdate && typeof onUpdate === 'function') {\n        // Rufe onUpdate auf, um LifecycleView zu aktualisieren\n        onUpdate();\n      }\n    } catch (error: any) {\n      console.error('Error updating social security:', error);\n      showMessage(\n        error.response?.data?.message || t('socialSecurity.updateError'),\n        'error'\n      );\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'registered':\n        return <CheckCircleIcon className=\"h-5 w-5 text-green-500\" />;\n      case 'pending':\n        return <ClockIcon className=\"h-5 w-5 text-yellow-500\" />;\n      case 'failed':\n        return <XCircleIcon className=\"h-5 w-5 text-red-500\" />;\n      case 'not_required':\n        return <CheckCircleIcon className=\"h-5 w-5 text-gray-400\" />;\n      case 'deregistered':\n        return <XCircleIcon className=\"h-5 w-5 text-gray-400\" />;\n      default:\n        return <ClockIcon className=\"h-5 w-5 text-gray-400\" />;\n    }\n  };\n\n  const getStatusLabel = (status: string) => {\n    const labelKey = `lifecycle.socialSecurityStatus.${status}`;\n    return t(labelKey) || status;\n  };\n\n  const getTypeLabel = (type: SocialSecurityType) => {\n    const labels: Record<SocialSecurityType, string> = {\n      arl: 'ARL (Risiko-Arbeit)',\n      eps: 'EPS (Gesundheit)',\n      pension: 'Pension',\n      caja: 'Caja de Compensacin'\n    };\n    return labels[type];\n  };\n\n  // Warte bis Berechtigungen geladen sind\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isLegal() && !isAdmin()) {\n    return null;\n  }\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  const types: SocialSecurityType[] = ['arl', 'eps', 'pension', 'caja'];\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n          <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n          {t('lifecycle.socialSecurity', { defaultValue: 'Sozialversicherungen' })}\n        </h3>\n      </div>\n\n      <div className=\"space-y-4\">\n        {types.map((type) => {\n          const registration = registrations[type];\n          const isEditing = editingType === type;\n\n          return (\n            <div\n              key={type}\n              className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\"\n            >\n              {!isEditing ? (\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex items-start space-x-3 flex-1\">\n                    {getStatusIcon(registration?.status || 'pending')}\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center space-x-2 mb-2\">\n                        <h4 className=\"font-medium dark:text-white uppercase\">\n                          {getTypeLabel(type)}\n                        </h4>\n                        <span className=\"text-sm font-medium dark:text-white\">\n                          {getStatusLabel(registration?.status || 'pending')}\n                        </span>\n                      </div>\n                      {registration && (\n                        <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                          {registration.provider && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.provider')}:</span> {registration.provider}\n                            </div>\n                          )}\n                          {registration.registrationNumber && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.number')}:</span> {registration.registrationNumber}\n                            </div>\n                          )}\n                          {registration.registrationDate && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.registrationDate')}:</span>{' '}\n                              {new Date(registration.registrationDate).toLocaleDateString('de-DE')}\n                            </div>\n                          )}\n                          {registration.notes && (\n                            <div className=\"mt-2\">\n                              <span className=\"font-medium\">{t('socialSecurity.notes')}:</span>\n                              <p className=\"text-gray-500 dark:text-gray-400 mt-1\">\n                                {registration.notes}\n                              </p>\n                            </div>\n                          )}\n                          {registration.completedAt && (\n                            <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\n                              {t('socialSecurity.completedAt')}{' '}\n                              {new Date(registration.completedAt).toLocaleDateString('de-DE')}\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      {!registration && (\n                        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                          {t('socialSecurity.notRegistered')}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                  <button\n                    onClick={() => handleEdit(type)}\n                    className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition ml-4\"\n                    title={t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  >\n                    <PencilIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium dark:text-white uppercase mb-3\">\n                    {t('socialSecurity.editType', { type: getTypeLabel(type) })}\n                  </h4>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('socialSecurity.status')} <span className=\"text-red-500\">*</span>\n                    </label>\n                    <select\n                      value={formData.status}\n                      onChange={(e) => setFormData({ ...formData, status: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    >\n                      <option value=\"not_required\">Nicht erforderlich</option>\n                      <option value=\"pending\">Ausstehend</option>\n                      <option value=\"registered\">Registriert</option>\n                      <option value=\"failed\">Fehlgeschlagen</option>\n                      <option value=\"deregistered\">Abgemeldet</option>\n                    </select>\n                  </div>\n\n                  {formData.status === 'registered' && (\n                    <>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.registrationNumber')}\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={formData.registrationNumber}\n                          onChange={(e) => setFormData({ ...formData, registrationNumber: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                          placeholder=\"z.B. 123456789\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.provider')}\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={formData.provider}\n                          onChange={(e) => setFormData({ ...formData, provider: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                          placeholder=\"z.B. ARL Sura, EPS Sanitas\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.registrationDate')}\n                        </label>\n                        <input\n                          type=\"date\"\n                          value={formData.registrationDate}\n                          onChange={(e) => setFormData({ ...formData, registrationDate: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                        />\n                      </div>\n                    </>\n                  )}\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('socialSecurity.notes')}\n                    </label>\n                    <textarea\n                      value={formData.notes}\n                      onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      rows={3}\n                      placeholder={t('socialSecurity.additionalInfo')}\n                    />\n                  </div>\n\n                  <div className=\"flex items-center justify-end space-x-3\">\n                    <button\n                      onClick={handleCancel}\n                      disabled={saving}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={t('common.cancel')}\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      onClick={handleSave}\n                      disabled={saving}\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={saving ? t('common.saving') : t('common.save')}\n                    >\n                      {saving ? (\n                        <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                      ) : (\n                        <CheckCircleIcon className=\"h-5 w-5\" />\n                      )}\n                    </button>\n                  </div>\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default SocialSecurityEditor;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ExclamationTriangleIcon, CalendarIcon, ArrowPathIcon, ArrowRightIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface OffboardingStartModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onOffboardingStarted: () => void;\n  userId: number;\n  userName: string;\n}\n\nconst OffboardingStartModal: React.FC<OffboardingStartModalProps> = ({\n  isOpen,\n  onClose,\n  onOffboardingStarted,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [exitDate, setExitDate] = useState('');\n  const [exitReason, setExitReason] = useState('');\n  \n  // Validierung\n  const [validationErrors, setValidationErrors] = useState<{\n    exitDate?: string;\n    exitReason?: string;\n  }>({});\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Setze Standard-Datum auf heute\n      const today = new Date().toISOString().split('T')[0];\n      setExitDate(today);\n      setExitReason('');\n      setError(null);\n      setValidationErrors({});\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = (): boolean => {\n    const errors: { exitDate?: string; exitReason?: string } = {};\n\n    // Validierung: exitDate\n    if (!exitDate) {\n      errors.exitDate = t('lifecycle.offboarding.exitDateRequired', { defaultValue: 'Austrittsdatum ist erforderlich' });\n    } else {\n      const selectedDate = new Date(exitDate);\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      \n      // exitDate darf in der Vergangenheit liegen (rckwirkende Erfassung erlaubt)\n      // Aber nicht zu weit in der Zukunft (max. 1 Jahr)\n      const maxDate = new Date();\n      maxDate.setFullYear(maxDate.getFullYear() + 1);\n      \n      if (selectedDate > maxDate) {\n        errors.exitDate = t('lifecycle.offboarding.exitDateTooFar', { defaultValue: 'Austrittsdatum darf nicht mehr als 1 Jahr in der Zukunft liegen' });\n      }\n    }\n\n    // Validierung: exitReason\n    if (!exitReason || exitReason.trim().length === 0) {\n      errors.exitReason = t('lifecycle.offboarding.exitReasonRequired', { defaultValue: 'Austrittsgrund ist erforderlich' });\n    } else if (exitReason.trim().length < 10) {\n      errors.exitReason = t('lifecycle.offboarding.exitReasonTooShort', { defaultValue: 'Austrittsgrund muss mindestens 10 Zeichen lang sein' });\n    }\n\n    setValidationErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\n        status: 'offboarding',\n        exitDate: exitDate,\n        exitReason: exitReason.trim()\n      });\n\n      showMessage(\n        t('lifecycle.offboarding.started', { defaultValue: 'Offboarding erfolgreich gestartet' }),\n        'success'\n      );\n      \n      onOffboardingStarted();\n      onClose();\n    } catch (err: any) {\n      console.error('Fehler beim Starten des Offboarding:', err);\n      const errorMessage = err.response?.data?.message || \n        t('lifecycle.offboarding.startError', { defaultValue: 'Fehler beim Starten des Offboarding' });\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const renderForm = () => (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      {/* Warnung */}\n      <div className=\"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4\">\n        <div className=\"flex items-start\">\n          <ExclamationTriangleIcon className=\"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5 mr-3 flex-shrink-0\" />\n          <div className=\"text-sm text-orange-800 dark:text-orange-200\">\n            <p className=\"font-medium mb-1\">\n              {t('lifecycle.offboarding.warningTitle', { defaultValue: 'Wichtiger Hinweis' })}\n            </p>\n            <p>\n              {t('lifecycle.offboarding.warningText', { defaultValue: 'Durch das Starten des Offboarding-Prozesses werden automatisch Tasks erstellt. Dieser Vorgang kann nicht rckgngig gemacht werden.' })}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* User-Info */}\n      <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">\n          {t('lifecycle.offboarding.user', { defaultValue: 'Mitarbeiter' })}\n        </p>\n        <p className=\"font-medium dark:text-white\">{userName}</p>\n      </div>\n\n      {/* exitDate */}\n      <div>\n        <label htmlFor=\"exitDate\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {t('lifecycle.offboarding.exitDate', { defaultValue: 'Austrittsdatum' })} *\n        </label>\n        <div className=\"relative\">\n          <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n            <CalendarIcon className=\"h-5 w-5 text-gray-400\" />\n          </div>\n          <input\n            type=\"date\"\n            id=\"exitDate\"\n            value={exitDate}\n            onChange={(e) => {\n              setExitDate(e.target.value);\n              if (validationErrors.exitDate) {\n                setValidationErrors(prev => ({ ...prev, exitDate: undefined }));\n              }\n            }}\n            className={`block w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n              validationErrors.exitDate\n                ? 'border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500'\n                : 'border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500'\n            }`}\n            required\n          />\n        </div>\n        {validationErrors.exitDate && (\n          <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{validationErrors.exitDate}</p>\n        )}\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n          {t('lifecycle.offboarding.exitDateHint', { defaultValue: 'Das Datum, an dem der Mitarbeiter die Organisation verlsst' })}\n        </p>\n      </div>\n\n      {/* exitReason */}\n      <div>\n        <label htmlFor=\"exitReason\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {t('lifecycle.offboarding.exitReason', { defaultValue: 'Austrittsgrund' })} *\n        </label>\n        <textarea\n          id=\"exitReason\"\n          value={exitReason}\n          onChange={(e) => {\n            setExitReason(e.target.value);\n            if (validationErrors.exitReason) {\n              setValidationErrors(prev => ({ ...prev, exitReason: undefined }));\n            }\n          }}\n          rows={4}\n          className={`block w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n            validationErrors.exitReason\n              ? 'border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500'\n              : 'border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500'\n          }`}\n          placeholder={t('lifecycle.offboarding.exitReasonPlaceholder', { defaultValue: 'z.B. Kndigung, Vertragsende, etc.' })}\n          required\n        />\n        {validationErrors.exitReason && (\n          <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{validationErrors.exitReason}</p>\n        )}\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n          {t('lifecycle.offboarding.exitReasonHint', { defaultValue: 'Mindestens 10 Zeichen. Beschreiben Sie den Grund fr den Austritt.' })}\n        </p>\n      </div>\n\n      {/* Error-Message */}\n      {error && (\n        <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n          <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n        </div>\n      )}\n\n      {/* Buttons */}\n      <div className=\"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n        <button\n          type=\"button\"\n          onClick={onClose}\n          disabled={loading}\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\n          title={t('common.cancel', { defaultValue: 'Abbrechen' })}\n        >\n          <XMarkIcon className=\"h-5 w-5\" />\n        </button>\n        <button\n          type=\"submit\"\n          disabled={loading}\n          className=\"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n          title={loading ? t('common.saving', { defaultValue: 'Speichern...' }) : t('lifecycle.offboarding.startButton', { defaultValue: 'Offboarding starten' })}\n        >\n          {loading ? (\n            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n          ) : (\n            <ArrowRightIcon className=\"h-5 w-5\" />\n          )}\n        </button>\n      </div>\n    </form>\n  );\n\n  if (!isOpen) return null;\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('lifecycle.offboarding.startTitle', { defaultValue: 'Offboarding starten' })}\n              </Dialog.Title>\n              <button\n                onClick={onClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <div className=\"p-4\">\n              {renderForm()}\n            </div>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={onClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('lifecycle.offboarding.startTitle', { defaultValue: 'Offboarding starten' })}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {renderForm()}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default OffboardingStartModal;\n\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, ExclamationTriangleIcon, CheckCircleIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\r\nimport useMessage from '../hooks/useMessage.ts';\r\n\r\ninterface Task {\r\n  id: number;\r\n  title: string;\r\n  description: string | null;\r\n  status: string;\r\n  dueDate: string | null;\r\n  createdAt: string;\r\n}\r\n\r\ninterface OffboardingCompleteModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onOffboardingCompleted: () => void;\r\n  userId: number;\r\n  userName: string;\r\n  offboardingTasks: Task[];\r\n}\r\n\r\nconst OffboardingCompleteModal: React.FC<OffboardingCompleteModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onOffboardingCompleted,\r\n  userId,\r\n  userName,\r\n  offboardingTasks\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const { showMessage } = useMessage();\r\n  \r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [confirmText, setConfirmText] = useState('');\r\n  \r\n  // Prfe, ob alle Tasks abgeschlossen sind\r\n  const completedTasks = offboardingTasks.filter(task => task.status === 'done');\r\n  const allTasksCompleted = offboardingTasks.length > 0 && completedTasks.length === offboardingTasks.length;\r\n  const requiredConfirmText = userName.trim().toLowerCase();\r\n  \r\n  // Responsive Erkennung\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n  \r\n  // Sidepane-Status verwalten\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      // Reset form on open\r\n      setConfirmText('');\r\n      setError(null);\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane]);\r\n  \r\n  const validateForm = () => {\r\n    if (confirmText.trim().toLowerCase() !== requiredConfirmText) {\r\n      setError(t('lifecycle.offboarding.complete.confirmTextMismatch', { defaultValue: 'Besttigungstext stimmt nicht berein' }));\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  \r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\r\n        status: 'archived'\r\n      });\r\n      \r\n      showMessage(\r\n        t('lifecycle.offboarding.complete.success', { defaultValue: 'Offboarding erfolgreich abgeschlossen' }),\r\n        'success'\r\n      );\r\n      \r\n      onOffboardingCompleted();\r\n      onClose();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Abschlieen des Offboarding:', err);\r\n      const errorMessage = err.response?.data?.message || \r\n        t('lifecycle.offboarding.complete.error', { defaultValue: 'Fehler beim Abschlieen des Offboarding' });\r\n      setError(errorMessage);\r\n      showMessage(errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  const renderForm = () => (\r\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n      {/* User Info */}\r\n      <div className=\"bg-gray-50 dark:bg-gray-700 p-3 rounded-md flex items-center space-x-3\">\r\n        <CheckCircleIcon className=\"h-5 w-5 text-gray-500 dark:text-gray-400\" />\r\n        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n          {t('lifecycle.offboarding.complete.user', { defaultValue: 'Mitarbeiter' })}: {userName}\r\n        </span>\r\n      </div>\r\n      \r\n      {/* Tasks Status */}\r\n      {offboardingTasks.length > 0 && (\r\n        <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-md\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n            {t('lifecycle.offboarding.complete.tasksStatus', { defaultValue: 'Status der Offboarding-Aufgaben' })}\r\n          </h4>\r\n          <div className=\"space-y-2\">\r\n            {offboardingTasks.map((task) => {\r\n                  const isCompleted = task.status === 'done';\r\n              return (\r\n                <div\r\n                  key={task.id}\r\n                  className={`flex items-center space-x-2 text-sm ${\r\n                    isCompleted\r\n                      ? 'text-green-700 dark:text-green-300'\r\n                      : 'text-orange-700 dark:text-orange-300'\r\n                  }`}\r\n                >\r\n                  {isCompleted ? (\r\n                    <CheckCircleIcon className=\"h-4 w-4 flex-shrink-0\" />\r\n                  ) : (\r\n                    <ExclamationTriangleIcon className=\"h-4 w-4 flex-shrink-0\" />\r\n                  )}\r\n                  <span>{task.title}</span>\r\n                  <span className=\"ml-auto text-xs\">\r\n                    {isCompleted\r\n                      ? `(${t('common.done', { defaultValue: 'Abgeschlossen' })})`\r\n                      : `(${t('common.open', { defaultValue: 'Offen' })})`}\r\n                  </span>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Warning wenn nicht alle Tasks abgeschlossen */}\r\n      {!allTasksCompleted && offboardingTasks.length > 0 && (\r\n        <div className=\"bg-orange-50 dark:bg-orange-900/20 border-l-4 border-orange-400 p-4\">\r\n          <div className=\"flex\">\r\n            <div className=\"flex-shrink-0\">\r\n              <ExclamationTriangleIcon className=\"h-5 w-5 text-orange-400\" aria-hidden=\"true\" />\r\n            </div>\r\n            <div className=\"ml-3\">\r\n              <h3 className=\"text-sm font-medium text-orange-800 dark:text-orange-300\">\r\n                {t('lifecycle.offboarding.complete.warningTitle', { defaultValue: 'Nicht alle Aufgaben abgeschlossen' })}\r\n              </h3>\r\n              <div className=\"mt-2 text-sm text-orange-700 dark:text-orange-200\">\r\n                <p>\r\n                  {t('lifecycle.offboarding.complete.warningText', { \r\n                    defaultValue: 'Es sind noch nicht alle Offboarding-Aufgaben abgeschlossen. Sie knnen das Offboarding trotzdem abschlieen, aber es wird empfohlen, alle Aufgaben zuerst zu erledigen.'\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Info wenn alle Tasks abgeschlossen */}\r\n      {allTasksCompleted && (\r\n        <div className=\"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-400 p-4\">\r\n          <div className=\"flex\">\r\n            <div className=\"flex-shrink-0\">\r\n              <CheckCircleIcon className=\"h-5 w-5 text-green-400\" aria-hidden=\"true\" />\r\n            </div>\r\n            <div className=\"ml-3\">\r\n              <h3 className=\"text-sm font-medium text-green-800 dark:text-green-300\">\r\n                {t('lifecycle.offboarding.complete.allTasksCompleted', { defaultValue: 'Alle Aufgaben abgeschlossen' })}\r\n              </h3>\r\n              <div className=\"mt-2 text-sm text-green-700 dark:text-green-200\">\r\n                <p>\r\n                  {t('lifecycle.offboarding.complete.allTasksCompletedText', { \r\n                    defaultValue: 'Alle Offboarding-Aufgaben sind abgeschlossen. Sie knnen das Offboarding jetzt abschlieen.'\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Confirm Text Input */}\r\n      <div>\r\n        <label htmlFor=\"confirmText\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('lifecycle.offboarding.complete.confirmLabel', { userName }) || \r\n            `Besttigen Sie durch Eingabe des Namens: \"${userName}\"`} *\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"confirmText\"\r\n          value={confirmText}\r\n          onChange={(e) => {\r\n            setConfirmText(e.target.value);\r\n            setError(null);\r\n          }}\r\n          className={`w-full px-3 py-2 border ${\r\n            error && error.includes('Besttigung') ? 'border-red-500' : 'border-gray-300'\r\n          } dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500`}\r\n          placeholder={userName}\r\n          required\r\n        />\r\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n          {t('lifecycle.offboarding.complete.confirmHint', { \r\n            defaultValue: 'Geben Sie den vollstndigen Namen des Mitarbeiters ein, um das Offboarding abzuschlieen'\r\n          })}\r\n        </p>\r\n      </div>\r\n      \r\n      {/* Final Warning */}\r\n      <div className=\"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\r\n        <div className=\"flex\">\r\n          <div className=\"flex-shrink-0\">\r\n            <ExclamationTriangleIcon className=\"h-5 w-5 text-red-400\" aria-hidden=\"true\" />\r\n          </div>\r\n          <div className=\"ml-3\">\r\n            <h3 className=\"text-sm font-medium text-red-800 dark:text-red-300\">\r\n              {t('lifecycle.offboarding.complete.finalWarningTitle', { defaultValue: 'Wichtiger Hinweis' })}\r\n            </h3>\r\n            <div className=\"mt-2 text-sm text-red-700 dark:text-red-200\">\r\n              <p>\r\n                {t('lifecycle.offboarding.complete.finalWarningText', { \r\n                  defaultValue: 'Durch das Abschlieen des Offboarding wird der Mitarbeiter archiviert. Dieser Vorgang kann nicht rckgngig gemacht werden.'\r\n                })}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Submit Button */}\r\n      <div className=\"flex justify-end space-x-3\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={onClose}\r\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          disabled={loading}\r\n          title={t('common.cancel', { defaultValue: 'Abbrechen' })}\r\n        >\r\n          <XMarkIcon className=\"h-5 w-5\" />\r\n        </button>\r\n        <button\r\n          type=\"submit\"\r\n          className=\"p-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          disabled={loading || confirmText.trim().toLowerCase() !== requiredConfirmText}\r\n          title={loading ? t('common.saving', { defaultValue: 'Speichern...' }) : t('lifecycle.offboarding.complete.button', { defaultValue: 'Offboarding abschlieen' })}\r\n        >\r\n          {loading ? (\r\n            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n          ) : (\r\n            <CheckCircleIcon className=\"h-5 w-5\" />\r\n          )}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n  \r\n  if (!isOpen) return null;\r\n  \r\n  // Fr Mobile (unter 640px) - klassisches Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n            {/* Header */}\r\n            <div className=\"px-6 py-4 border-b dark:border-gray-700\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                  {t('lifecycle.offboarding.complete.title', { defaultValue: 'Offboarding abschlieen' })}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Form */}\r\n            <div className=\"p-6\">\r\n              {error && (\r\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\r\n                  {error}\r\n                </div>\r\n              )}\r\n              {renderForm()}\r\n            </div>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n  \r\n  // Fr Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div\r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\"\r\n          aria-hidden=\"true\"\r\n          onClick={onClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div\r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${\r\n          isOpen ? 'translate-x-0' : 'translate-x-full'\r\n        }`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('lifecycle.offboarding.complete.title', { defaultValue: 'Offboarding abschlieen' })}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n        \r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {error && (\r\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\r\n              {error}\r\n            </div>\r\n          )}\r\n          {renderForm()}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default OffboardingCompleteModal;\r\n\r\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { \n  CheckCircleIcon, \n  ClockIcon, \n  XCircleIcon,\n  DocumentTextIcon,\n  BuildingOfficeIcon,\n  PlusIcon,\n  PencilIcon,\n  ArrowDownTrayIcon,\n  CalendarIcon,\n  UserIcon,\n  ArrowRightIcon\n} from '@heroicons/react/24/outline';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport useMessage from '../hooks/useMessage.ts';\nimport CertificateCreationModal from './CertificateCreationModal.tsx';\nimport ContractCreationModal from './ContractCreationModal.tsx';\nimport CertificateEditModal from './CertificateEditModal.tsx';\nimport ContractEditModal from './ContractEditModal.tsx';\nimport SocialSecurityEditor from './SocialSecurityEditor.tsx';\nimport OffboardingStartModal from './OffboardingStartModal.tsx';\nimport OffboardingCompleteModal from './OffboardingCompleteModal.tsx';\n\ninterface LifecycleViewProps {\n  userId: number;\n  userName: string;\n}\n\ninterface LifecycleData {\n  lifecycle: {\n    id: number;\n    status: string;\n    onboardingStartedAt: string | null;\n    onboardingCompletedAt: string | null;\n    contractStartDate: string | null;\n    contractEndDate: string | null;\n    exitDate: string | null;\n    exitReason: string | null;\n    offboardingStartedAt: string | null;\n    offboardingCompletedAt: string | null;\n  };\n  progress: {\n    completed: number;\n    total: number;\n    percent: number;\n  };\n  socialSecurityRegistrations?: Array<{\n    id: number;\n    registrationType: string;\n    status: string;\n    registrationNumber: string | null;\n    provider: string | null;\n    registrationDate: string | null;\n  }>;\n}\n\ninterface Task {\n  id: number;\n  title: string;\n  description: string | null;\n  status: string;\n  dueDate: string | null;\n  createdAt: string;\n}\n\ninterface Certificate {\n  id: number;\n  certificateType: string;\n  issueDate: string;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n  generatedBy: number | null;\n  generatedByUser: {\n    id: number;\n    firstName: string;\n    lastName: string;\n  } | null;\n  createdAt: string;\n}\n\ninterface Contract {\n  id: number;\n  contractType: string;\n  startDate: string;\n  endDate: string | null;\n  salary: number | null;\n  workingHours: number | null;\n  position: string | null;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n  generatedBy: number | null;\n  generatedByUser: {\n    id: number;\n    firstName: string;\n    lastName: string;\n  } | null;\n  createdAt: string;\n}\n\nconst LifecycleView: React.FC<LifecycleViewProps> = ({ userId, userName }) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin } = usePermissions();\n  const { showMessage } = useMessage();\n  \n  const [lifecycleData, setLifecycleData] = useState<LifecycleData | null>(null);\n  const [certificates, setCertificates] = useState<Certificate[]>([]);\n  const [contracts, setContracts] = useState<Contract[]>([]);\n  const [offboardingTasks, setOffboardingTasks] = useState<Task[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Modal States\n  const [isCertificateCreateModalOpen, setIsCertificateCreateModalOpen] = useState(false);\n  const [isContractCreateModalOpen, setIsContractCreateModalOpen] = useState(false);\n  const [editingCertificate, setEditingCertificate] = useState<Certificate | null>(null);\n  const [editingContract, setEditingContract] = useState<Contract | null>(null);\n  \n  const [downloadingCertId, setDownloadingCertId] = useState<number | null>(null);\n  const [downloadingContractId, setDownloadingContractId] = useState<number | null>(null);\n  const [isOffboardingStartModalOpen, setIsOffboardingStartModalOpen] = useState(false);\n  const [isOffboardingCompleteModalOpen, setIsOffboardingCompleteModalOpen] = useState(false);\n  const [isEditContractDatesModalOpen, setIsEditContractDatesModalOpen] = useState(false);\n  const [editingContractStartDate, setEditingContractStartDate] = useState<string>('');\n  const [editingContractEndDate, setEditingContractEndDate] = useState<string>('');\n\n  const fetchDataRef = useRef(false);\n\n  const fetchData = useCallback(async (force: boolean = false) => {\n    // Verhindere mehrfaches gleichzeitiges Laden (auer wenn force=true)\n    if (fetchDataRef.current && !force) {\n      // Wenn bereits geladen wird, warte kurz und versuche es erneut\n      setTimeout(() => {\n        if (!fetchDataRef.current) {\n          fetchData(true);\n        }\n      }, 500);\n      return;\n    }\n    \n    try {\n      fetchDataRef.current = true;\n      setLoading(true);\n      const [lifecycleResponse, certsResponse, contractsResponse, tasksResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.CERTIFICATES(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.CONTRACTS(userId)),\n        axiosInstance.get(API_ENDPOINTS.TASKS.BY_USER(userId)).catch(() => ({ data: [] })) // Optional, falls fehlschlgt\n      ]);\n      \n      setLifecycleData(lifecycleResponse.data);\n      setCertificates(certsResponse.data?.certificates || []);\n      setContracts(contractsResponse.data?.contracts || []);\n      \n      // Filtere Offboarding-Tasks (die 3 spezifischen Tasks)\n      const allTasks = tasksResponse.data || [];\n      const offboardingTaskTitles = [\n        'Crear certificado laboral',\n        'Realizar liquidacin final',\n        'Desafiliar de seguridad social'\n      ];\n      const filteredTasks = allTasks.filter((task: Task) => \n        offboardingTaskTitles.includes(task.title)\n      );\n      setOffboardingTasks(filteredTasks);\n      \n      // Prfe ob automatische Status-nderung ntig ist (wird im Backend gemacht, aber hier prfen wir fr UI-Feedback)\n      if (lifecycleResponse.data?.lifecycle?.status === 'onboarding' && lifecycleResponse.data?.progress?.percent === 100) {\n        // Status wird automatisch im Backend gendert, lade Daten nach kurzer Verzgerung neu\n        setTimeout(() => {\n          fetchData();\n        }, 1000);\n      }\n      \n      setError(null);\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Lebenszyklus-Daten:', err);\n      setError(err.response?.data?.message || 'Fehler beim Laden der Daten');\n      showMessage('Fehler beim Laden der Daten', 'error');\n    } finally {\n      setLoading(false);\n      fetchDataRef.current = false;\n    }\n  }, [userId]); // showMessage entfernt, da es sich ndern kann\n\n  useEffect(() => {\n    fetchDataRef.current = false; // Reset beim userId-Wechsel\n    fetchData();\n  }, [fetchData]);\n\n  const handleDownloadCertificate = async (certId: number) => {\n    setDownloadingCertId(certId);\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certId),\n        { responseType: 'blob' }\n      );\n      \n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = `arbeitszeugnis-${certId}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadUrl);\n      \n      showMessage('Arbeitszeugnis erfolgreich heruntergeladen', 'success');\n    } catch (err: any) {\n      console.error('Fehler beim Herunterladen:', err);\n      showMessage('Fehler beim Herunterladen des Arbeitszeugnisses', 'error');\n    } finally {\n      setDownloadingCertId(null);\n    }\n  };\n\n  const handleEditContractDates = () => {\n    if (!lifecycleData?.lifecycle) return;\n    \n    setEditingContractStartDate(\n      lifecycleData.lifecycle.contractStartDate \n        ? new Date(lifecycleData.lifecycle.contractStartDate).toISOString().split('T')[0]\n        : ''\n    );\n    setEditingContractEndDate(\n      lifecycleData.lifecycle.contractEndDate \n        ? new Date(lifecycleData.lifecycle.contractEndDate).toISOString().split('T')[0]\n        : ''\n    );\n    setIsEditContractDatesModalOpen(true);\n  };\n\n  const handleSaveContractDates = async () => {\n    try {\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\n        status: lifecycleData?.lifecycle.status || 'active',\n        contractStartDate: editingContractStartDate || null,\n        contractEndDate: editingContractEndDate || null\n      });\n      \n      showMessage('Vertragsdaten erfolgreich aktualisiert', 'success');\n      setIsEditContractDatesModalOpen(false);\n      fetchData();\n    } catch (err: any) {\n      console.error('Fehler beim Speichern der Vertragsdaten:', err);\n      showMessage('Fehler beim Speichern der Vertragsdaten', 'error');\n    }\n  };\n\n\n  const handleDownloadContract = async (contractId: number) => {\n    setDownloadingContractId(contractId);\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contractId),\n        { responseType: 'blob' }\n      );\n      \n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = `arbeitsvertrag-${contractId}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadUrl);\n      \n      showMessage('Arbeitsvertrag erfolgreich heruntergeladen', 'success');\n    } catch (err: any) {\n      console.error('Fehler beim Herunterladen:', err);\n      showMessage('Fehler beim Herunterladen des Arbeitsvertrags', 'error');\n    } finally {\n      setDownloadingContractId(null);\n    }\n  };\n\n  const getStatusBadge = (status: string, clickable: boolean = false) => {\n    const statusConfig: Record<string, { color: string; labelKey: string }> = {\n      onboarding: { color: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300', labelKey: 'lifecycle.status.onboarding' },\n      active: { color: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300', labelKey: 'lifecycle.status.active' },\n      contract_change: { color: 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300', labelKey: 'lifecycle.status.contract_change' },\n      offboarding: { color: 'bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300', labelKey: 'lifecycle.status.offboarding' },\n      archived: { color: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300', labelKey: 'lifecycle.status.archived' }\n    };\n\n    const config = statusConfig[status] || { color: 'bg-gray-100 text-gray-800', labelKey: status };\n    \n    return (\n      <span className={`px-3 py-1 rounded-full text-sm font-medium ${config.color} ${clickable ? 'cursor-pointer hover:opacity-80' : ''}`}>\n        {t(config.labelKey) || status}\n      </span>\n    );\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('de-DE', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n          <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!lifecycleData) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <p className=\"text-gray-500 dark:text-gray-400\">{t('lifecycle.noData', { defaultValue: 'Keine Lebenszyklus-Daten verfgbar' })}</p>\n      </div>\n    );\n  }\n\n  // Extrahiere socialSecurityRegistrations aus lifecycle (falls direkt vorhanden) oder aus lifecycleData\n  const socialSecurityRegistrations = lifecycleData.lifecycle?.socialSecurityRegistrations || lifecycleData.socialSecurityRegistrations || [];\n  const { lifecycle, progress } = lifecycleData;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Status-Box */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <BuildingOfficeIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.statusTitle')}\n          </h3>\n          <div className=\"flex items-center space-x-3\">\n          {/* Status-Badge (nur Anzeige, keine nderung mglich) */}\n          {getStatusBadge(lifecycle.status)}\n            {/* Offboarding-Start-Button (nur fr HR/Admin, nur wenn Status = \"active\") */}\n            {(isHR() || isAdmin()) && lifecycle.status === 'active' && (\n              <button\n                onClick={() => setIsOffboardingStartModalOpen(true)}\n                className=\"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500\"\n                title={t('lifecycle.offboarding.startButton', { defaultValue: 'Offboarding starten' })}\n              >\n                <ArrowRightIcon className=\"h-5 w-5\" />\n              </button>\n            )}\n            {/* Offboarding-Abschluss-Button (nur fr HR/Admin, nur wenn Status = \"offboarding\") */}\n            {(isHR() || isAdmin()) && lifecycle.status === 'offboarding' && (\n              <button\n                onClick={() => setIsOffboardingCompleteModalOpen(true)}\n                className=\"p-2 bg-red-600 dark:bg-red-700 text-white rounded-md hover:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n                title={t('lifecycle.offboarding.complete.button', { defaultValue: 'Offboarding abschlieen' })}\n              >\n                <CheckCircleIcon className=\"h-5 w-5\" />\n              </button>\n            )}\n          </div>\n        </div>\n\n        <div className=\"space-y-2 text-sm\">\n          {lifecycle.onboardingStartedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.onboardingStarted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.onboardingStartedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.onboardingCompletedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.onboardingCompleted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.onboardingCompletedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.contractStart')}</span>\n            <div className=\"flex items-center space-x-2\">\n              {lifecycle.contractStartDate ? (\n                <span className=\"dark:text-white\">\n                  {new Date(lifecycle.contractStartDate).toLocaleDateString('de-DE')}\n                </span>\n              ) : (\n                <span className=\"text-gray-400 italic text-sm\">{t('lifecycle.notSet', { defaultValue: 'Nicht gesetzt' })}</span>\n              )}\n              {(isHR() || isAdmin()) && (\n                <button\n                  onClick={() => handleEditContractDates()}\n                  className=\"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition\"\n                  title={t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                >\n                  <PencilIcon className=\"h-4 w-4\" />\n                </button>\n              )}\n            </div>\n          </div>\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.contractEnd')}</span>\n            <div className=\"flex items-center space-x-2\">\n              {lifecycle.contractEndDate ? (\n                <span className=\"dark:text-white\">\n                  {new Date(lifecycle.contractEndDate).toLocaleDateString('de-DE')}\n                </span>\n              ) : (\n                <span className=\"text-gray-400 italic text-sm\">{t('lifecycle.notSet', { defaultValue: 'Nicht gesetzt' })}</span>\n              )}\n              {(isHR() || isAdmin()) && (\n                <button\n                  onClick={() => handleEditContractDates()}\n                  className=\"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition\"\n                  title={t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                >\n                  <PencilIcon className=\"h-4 w-4\" />\n                </button>\n              )}\n            </div>\n          </div>\n          {lifecycle.offboardingStartedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.offboardingStarted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.offboardingStartedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.exitDate && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.exitDate')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.exitDate).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.exitReason && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.exitReason')}</span>\n              <span className=\"dark:text-white\">{lifecycle.exitReason}</span>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Progress-Bar - Onboarding */}\n      {lifecycle.status === 'onboarding' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold dark:text-white mb-4\">{t('lifecycle.progressTitle')}</h3>\n          <div className=\"space-y-2\">\n            <div className=\"flex justify-between text-sm mb-2\">\n              <span className=\"text-gray-600 dark:text-gray-400\">\n                {t('lifecycle.progressSteps', { completed: progress.completed, total: progress.total })}\n              </span>\n              <span className=\"font-medium dark:text-white\">{progress.percent}%</span>\n            </div>\n            <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3\">\n              <div\n                className=\"bg-blue-600 h-3 rounded-full transition-all duration-300\"\n                style={{ width: `${progress.percent}%` }}\n              ></div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Progress-Bar - Offboarding */}\n      {lifecycle.status === 'offboarding' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold dark:text-white mb-4\">{t('lifecycle.offboarding.progressTitle', { defaultValue: 'Offboarding-Fortschritt' })}</h3>\n          <div className=\"space-y-4\">\n            {/* Progress-Bar */}\n            {(() => {\n              const completedTasks = offboardingTasks.filter(task => task.status === 'done').length;\n              const totalTasks = offboardingTasks.length || 3; // Fallback: 3 Tasks\n              const percent = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;\n              \n              return (\n                <>\n                  <div className=\"flex justify-between text-sm mb-2\">\n                    <span className=\"text-gray-600 dark:text-gray-400\">\n                      {t('lifecycle.offboarding.progressSteps', { completed: completedTasks, total: totalTasks }) || `${completedTasks} von ${totalTasks} Schritten abgeschlossen`}\n                    </span>\n                    <span className=\"font-medium dark:text-white\">{percent}%</span>\n                  </div>\n                  <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3\">\n                    <div\n                      className=\"bg-orange-600 h-3 rounded-full transition-all duration-300\"\n                      style={{ width: `${percent}%` }}\n                    ></div>\n                  </div>\n                </>\n              );\n            })()}\n            \n            {/* Offboarding-Tasks Liste */}\n            {offboardingTasks.length > 0 && (\n              <div className=\"mt-4 space-y-2\">\n                <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  {t('lifecycle.offboarding.tasksTitle', { defaultValue: 'Offboarding-Aufgaben' })}\n                </h4>\n                {offboardingTasks.map((task) => {\n                  const isCompleted = task.status === 'done';\n                  return (\n                    <div\n                      key={task.id}\n                      className={`flex items-center justify-between p-3 rounded-lg border ${\n                        isCompleted\n                          ? 'bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800'\n                          : 'bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600'\n                      }`}\n                    >\n                      <div className=\"flex items-center space-x-3 flex-1\">\n                        {isCompleted ? (\n                          <CheckCircleIcon className=\"h-5 w-5 text-green-600 dark:text-green-400 flex-shrink-0\" />\n                        ) : (\n                          <ClockIcon className=\"h-5 w-5 text-orange-600 dark:text-orange-400 flex-shrink-0\" />\n                        )}\n                        <div className=\"flex-1 min-w-0\">\n                          <p className={`text-sm font-medium ${isCompleted ? 'text-green-800 dark:text-green-200' : 'text-gray-800 dark:text-gray-200'}`}>\n                            {task.title}\n                          </p>\n                          {task.description && (\n                            <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-1 truncate\">\n                              {task.description}\n                            </p>\n                          )}\n                        </div>\n                      </div>\n                      <span className={`text-xs px-2 py-1 rounded ${\n                        isCompleted\n                          ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200'\n                          : 'bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200'\n                      }`}>\n                        {isCompleted\n                          ? t('common.done', { defaultValue: 'Abgeschlossen' })\n                          : t('common.open', { defaultValue: 'Offen' })}\n                      </span>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Dokumente - Arbeitszeugnisse */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.certificates')}\n          </h3>\n          {(isHR() || isAdmin()) && (\n            <button\n              onClick={() => setIsCertificateCreateModalOpen(true)}\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('lifecycle.createCertificate')}\n              aria-label={t('lifecycle.createCertificate')}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n            </button>\n          )}\n        </div>\n\n        {certificates.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noCertificates')}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {certificates.map((cert) => (\n              <div\n                key={cert.id}\n                className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition\"\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <h4 className=\"font-medium dark:text-white\">\n                        {t('lifecycle.certificate')}\n                        {cert.certificateType !== 'employment' && ` (${cert.certificateType})`}\n                      </h4>\n                      {cert.isLatest && (\n                        <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center\">\n                          <CheckCircleIcon className=\"h-3 w-3 mr-1\" />\n                          {t('lifecycle.current')}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                      <div className=\"flex items-center space-x-2\">\n                        <CalendarIcon className=\"h-4 w-4\" />\n                        <span>{t('lifecycle.issuedOn')} {formatDate(cert.issueDate)}</span>\n                      </div>\n                      {cert.generatedByUser && (\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4\" />\n                          <span>\n                            {t('lifecycle.createdBy')} {cert.generatedByUser.firstName} {cert.generatedByUser.lastName}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2 ml-4\">\n                    {(isHR() || isAdmin()) && (\n                      <button\n                        onClick={() => setEditingCertificate(cert)}\n                        className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition\"\n                        title={t('lifecycle.edit')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                      </button>\n                    )}\n                    <button\n                      onClick={() => handleDownloadCertificate(cert.id)}\n                      disabled={downloadingCertId === cert.id}\n                      className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={t('lifecycle.download')}\n                    >\n                      {downloadingCertId === cert.id ? (\n                        <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                      ) : (\n                        <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                      )}\n                    </button>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Dokumente - Arbeitsvertrge */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center mb-4\">\n          {(isHR() || isAdmin()) && (\n            <button\n              onClick={() => setIsContractCreateModalOpen(true)}\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center mr-3\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('lifecycle.createContract')}\n              aria-label={t('lifecycle.createContract')}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n            </button>\n          )}\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.contracts')}\n          </h3>\n        </div>\n\n        {contracts.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noContracts')}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {contracts.map((contract) => (\n              <div\n                key={contract.id}\n                className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition\"\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <h4 className=\"font-medium dark:text-white\">\n                        {t('lifecycle.contract')}\n                        {contract.contractType !== 'employment' && ` (${contract.contractType})`}\n                      </h4>\n                      {contract.isLatest && (\n                        <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center\">\n                          <CheckCircleIcon className=\"h-3 w-3 mr-1\" />\n                          {t('lifecycle.current')}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                      <div className=\"flex items-center space-x-2\">\n                        <CalendarIcon className=\"h-4 w-4\" />\n                        <span>\n                          {formatDate(contract.startDate)}\n                          {contract.endDate && ` - ${formatDate(contract.endDate)}`}\n                        </span>\n                      </div>\n                      {contract.position && (\n                        <div>{t('lifecycle.position')} {contract.position}</div>\n                      )}\n                      {contract.salary && (\n                        <div>{t('lifecycle.salary')} {contract.salary.toLocaleString('de-DE', { style: 'currency', currency: 'EUR' })}</div>\n                      )}\n                      {contract.workingHours && (\n                        <div>{t('lifecycle.workingHours')} {contract.workingHours}h/Woche</div>\n                      )}\n                      {contract.generatedByUser && (\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4\" />\n                          <span>\n                            {t('lifecycle.createdBy')} {contract.generatedByUser.firstName} {contract.generatedByUser.lastName}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2 ml-4\">\n                    {(isHR() || isAdmin()) && (\n                      <button\n                        onClick={() => setEditingContract(contract)}\n                        className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition\"\n                        title={t('lifecycle.edit')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                      </button>\n                    )}\n                    <button\n                      onClick={() => handleDownloadContract(contract.id)}\n                      disabled={downloadingContractId === contract.id}\n                      className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={t('lifecycle.download')}\n                    >\n                      {downloadingContractId === contract.id ? (\n                        <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                      ) : (\n                        <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                      )}\n                    </button>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Social Security Editor - Nur fr Legal/Admin */}\n      {lifecycleData?.lifecycle && (\n        <SocialSecurityEditor\n          userId={userId}\n          lifecycleId={lifecycleData.lifecycle.id}\n          onUpdate={() => fetchData(true)}\n        />\n      )}\n\n      {/* Modals */}\n      <CertificateCreationModal\n        isOpen={isCertificateCreateModalOpen}\n        onClose={() => setIsCertificateCreateModalOpen(false)}\n        onCertificateCreated={() => {\n          fetchData();\n          setIsCertificateCreateModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n\n      <ContractCreationModal\n        isOpen={isContractCreateModalOpen}\n        onClose={() => setIsContractCreateModalOpen(false)}\n        onContractCreated={() => {\n          fetchData();\n          setIsContractCreateModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n\n      {editingCertificate && (\n        <CertificateEditModal\n          isOpen={!!editingCertificate}\n          onClose={() => setEditingCertificate(null)}\n          onCertificateUpdated={() => {\n            fetchData();\n            setEditingCertificate(null);\n          }}\n          userId={userId}\n          certificate={editingCertificate}\n        />\n      )}\n\n      {editingContract && (\n        <ContractEditModal\n          isOpen={!!editingContract}\n          onClose={() => setEditingContract(null)}\n          onContractUpdated={() => {\n            fetchData();\n            setEditingContract(null);\n          }}\n          userId={userId}\n          contract={editingContract}\n        />\n      )}\n\n      {/* Offboarding-Start-Modal */}\n      <OffboardingStartModal\n        isOpen={isOffboardingStartModalOpen}\n        onClose={() => setIsOffboardingStartModalOpen(false)}\n        onOffboardingStarted={() => {\n          fetchData();\n          setIsOffboardingStartModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n      \n      {/* Offboarding-Abschluss-Modal */}\n      <OffboardingCompleteModal\n        isOpen={isOffboardingCompleteModalOpen}\n        onClose={() => setIsOffboardingCompleteModalOpen(false)}\n        onOffboardingCompleted={() => {\n          fetchData();\n          setIsOffboardingCompleteModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n        offboardingTasks={offboardingTasks}\n      />\n\n      {/* Modal zum Bearbeiten der Vertragsdaten */}\n      {isEditContractDatesModalOpen && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md mx-4\">\n            <h2 className=\"text-xl font-semibold dark:text-white mb-4\">\n              {t('lifecycle.editContractDates', { defaultValue: 'Vertragsdaten bearbeiten' })}\n            </h2>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('lifecycle.contractStart', { defaultValue: 'Vertragsbeginn' })} *\n                </label>\n                <input\n                  type=\"date\"\n                  value={editingContractStartDate}\n                  onChange={(e) => setEditingContractStartDate(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  required\n                />\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('lifecycle.contractEnd', { defaultValue: 'Vertragsende' })} (optional)\n                </label>\n                <input\n                  type=\"date\"\n                  value={editingContractEndDate}\n                  onChange={(e) => setEditingContractEndDate(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('lifecycle.contractEndHint', { defaultValue: 'Nur bei befristeten Vertrgen ausfllen' })}\n                </p>\n              </div>\n            </div>\n            \n            <div className=\"flex justify-end space-x-3 mt-6\">\n              <button\n                onClick={() => setIsEditContractDatesModalOpen(false)}\n                className=\"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition\"\n              >\n                {t('common.cancel', { defaultValue: 'Abbrechen' })}\n              </button>\n              <button\n                onClick={handleSaveContractDates}\n                disabled={!editingContractStartDate}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {t('common.save', { defaultValue: 'Speichern' })}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LifecycleView;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { userApi, roleApi } from '../api/apiClient.ts';\nimport { User, Role } from '../types/interfaces.ts';\nimport { CheckIcon, PlusIcon, PencilIcon, DocumentTextIcon, UserCircleIcon, ShieldCheckIcon, XMarkIcon, ArrowPathIcon, BuildingOfficeIcon } from '@heroicons/react/24/outline';\nimport useMessage from '../hooks/useMessage.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport IdentificationDocumentList from './IdentificationDocumentList.tsx';\nimport LifecycleView from './LifecycleView.tsx';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface UserManagementTabProps {\n  onError: (error: string) => void;\n}\n\n// Lnder und Sprachen werden dynamisch aus bersetzungen geladen\n\n// Definiere Rollen, die immer vorhanden sein sollten (z.B. Admin-Rolle)\nconst fixedRoles = [1, 2, 999]; // Admin (1), User (2) und Hamburger (999) sind fixe Rollen\n\n// Vertragstypen fr Kolumbien (CO)\nconst CONTRACT_TYPES = [\n  { code: 'tiempo_completo', name: 'Tiempo Completo (>21 Tage/Monat)' },\n  { code: 'tiempo_parcial_7', name: 'Tiempo Parcial (7 Tage/Monat)' },\n  { code: 'tiempo_parcial_14', name: 'Tiempo Parcial (14 Tage/Monat)' },\n  { code: 'tiempo_parcial_21', name: 'Tiempo Parcial (21 Tage/Monat)' },\n  { code: 'prestacion_de_servicios', name: 'Prestacin de Servicios' },\n  { code: 'externo', name: 'Externo' }\n];\n\n// Gemeinsame Debug-Komponente hinzufgen\nconst RoleDebugInfo = ({ title, data }: { title: string, data: any }) => (\n  <div className=\"mb-2 p-2 border border-gray-300 rounded bg-gray-50\">\n    <h5 className=\"font-bold text-sm\">{title}</h5>\n    <pre className=\"text-xs overflow-auto max-h-24\">\n      {JSON.stringify(data, null, 2)}\n    </pre>\n  </div>\n);\n\nconst UserManagementTab = ({ onError }: UserManagementTabProps): JSX.Element => {\n  const { t } = useTranslation();\n  \n  // Lnder fr die Auswahl (dynamisch aus bersetzungen)\n  const COUNTRIES = [\n    { code: 'CO', name: t('countries.CO') },\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'DE', name: t('countries.DE') },\n    { code: 'AT', name: t('countries.AT') }\n  ];\n\n  // Lnder fr die Payroll-Auswahl (dynamisch aus bersetzungen)\n  const PAYROLL_COUNTRIES = [\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'CO', name: t('countries.CO') }\n  ];\n\n  // Sprachen fr die Auswahl (dynamisch aus bersetzungen)\n  const LANGUAGES = [\n    { code: 'es', name: t('languages.es') },\n    { code: 'de', name: t('languages.de') },\n    { code: 'en', name: t('languages.en') }\n  ];\n  \n  // Benutzer-States\n  const [users, setUsers] = useState<User[]>([]);\n  const [selectedUser, setSelectedUser] = useState<User | null>(null);\n  const [userFormData, setUserFormData] = useState<Partial<User>>({});\n  const [isEditingUser, setIsEditingUser] = useState(false);\n  const [selectedRoles, setSelectedRoles] = useState<number[]>([]);\n  const [lifecycleRefreshKey, setLifecycleRefreshKey] = useState(0);\n  const [isDebugMode, setIsDebugMode] = useState(false);\n  const [roleWarning, setRoleWarning] = useState<string | null>(null);\n  const { showMessage } = useMessage();\n  const { isAdmin } = usePermissions();\n  \n  // Neuer State fr Rollen\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState(false);\n  \n  // Neuer State fr die aktive Unterseite\n  const [activeUserTab, setActiveUserTab] = useState<'details' | 'documents' | 'roles' | 'lifecycle'>('details');\n  \n  // State fr Active/Inactive Filter\n  const [userFilterTab, setUserFilterTab] = useState<'active' | 'inactive'>('active');\n  \n  // State fr Benutzererstellung\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n  const [isMobile, setIsMobile] = useState<boolean>(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [newUserFormData, setNewUserFormData] = useState({\n    email: '',\n    password: '',\n    firstName: '',\n    lastName: ''\n  });\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isCreateModalOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isCreateModalOpen, openSidepane, closeSidepane]);\n\n  // Alle Benutzer (fr Filterung)\n  const [allUsers, setAllUsers] = useState<User[]>([]);\n\n  // Initialisierung - Laden von Benutzern\n  useEffect(() => {\n    fetchAllUsers();\n  }, []);\n\n  // Benutzerdaten laden - Verwende gefilterten Endpoint, damit nur Benutzer der eigenen Organisation angezeigt werden\n  const fetchAllUsers = async () => {\n    try {\n      const response = await userApi.getAll();\n      setAllUsers(response.data);\n      // Initial: Nur aktive Benutzer anzeigen\n      filterUsersByActiveStatus('active', response.data);\n    } catch (err) {\n      handleError(err);\n    }\n  };\n\n  // Benutzer nach Active/Inactive filtern und alphabetisch sortieren\n  const filterUsersByActiveStatus = (status: 'active' | 'inactive', usersToFilter: User[] = allUsers) => {\n    const filtered = usersToFilter.filter(user => {\n      const isActive = user.active !== undefined ? user.active : true; // Default: true\n      return status === 'active' ? isActive : !isActive;\n    });\n    \n    // Alphabetisch sortieren nach username, dann firstName\n    const sorted = filtered.sort((a, b) => {\n      const aUsername = (a.username || '').toLowerCase();\n      const bUsername = (b.username || '').toLowerCase();\n      const aFirstName = (a.firstName || '').toLowerCase();\n      const bFirstName = (b.firstName || '').toLowerCase();\n      \n      // Zuerst nach username sortieren\n      if (aUsername !== bUsername) {\n        return aUsername.localeCompare(bUsername);\n      }\n      // Wenn username gleich, nach Vorname sortieren\n      return aFirstName.localeCompare(bFirstName);\n    });\n    \n    setUsers(sorted);\n  };\n\n  // Wenn Filter-Tab wechselt, Benutzerliste neu filtern\n  useEffect(() => {\n    if (allUsers.length > 0) {\n      filterUsersByActiveStatus(userFilterTab, allUsers);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userFilterTab]);\n  \n  // Rollen laden - Wird erst aufgerufen, wenn ein Benutzer ausgewhlt wurde\n  const fetchRoles = async () => {\n    try {\n      setLoadingRoles(true);\n      \n      // Fallback-Rollen fr den Notfall bereithalten\n      const fallbackRoles = [\n        { id: 1, name: 'admin', description: 'Administrator mit allen Rechten', permissions: [] },\n        { id: 2, name: 'user', description: 'Standardbenutzer', permissions: [] },\n        { id: 999, name: 'hamburger', description: 'Hamburger-Rolle fr neue Benutzer', permissions: [] }\n      ];\n      \n      try {\n        const response = await roleApi.getAll();\n        if (response.data && Array.isArray(response.data) && response.data.length > 0) {\n          setRoles(response.data);\n          console.log(`${response.data.length} Rollen erfolgreich geladen`);\n        } else {\n          console.warn('Keine Rollen vom Server erhalten, verwende Fallback');\n          setRoles(fallbackRoles);\n        }\n      } catch (error) {\n        console.warn('Fehler beim Laden der Rollen, verwende Fallback:', error);\n        setRoles(fallbackRoles);\n      }\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  // Detaillierte Benutzerdaten laden\n  const fetchUserDetails = async (userId: number) => {\n    try {\n      if (!userId || isNaN(userId)) {\n        setSelectedUser(null);\n        return;\n      }\n      \n      console.log('Lade Benutzerdetails fr ID:', userId);\n      const response = await userApi.getById(userId);\n      \n      const userData = {\n        ...response.data,\n        active: response.data.active !== undefined ? response.data.active : true,\n        birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n      };\n      \n      // Extrahiere Rollen-IDs aus der verschachtelten Struktur\n      let roleIds: number[] = [];\n      \n      if (response.data.roles && Array.isArray(response.data.roles)) {\n        console.log('Rollenstruktur (Typ):', typeof response.data.roles, 'Lnge:', response.data.roles.length);\n        \n        // Struktur: roles: [{ role: { id, name, ... } }]\n        if (response.data.roles.length > 0 && response.data.roles[0].role) {\n          roleIds = response.data.roles.map(userRole => userRole.role.id);\n          console.log('Extrahierte Rollen-IDs aus verschachtelter Struktur:', roleIds);\n        }\n        // Fallback fr andere Formate\n        else if (response.data.roles.length > 0) {\n          if (typeof response.data.roles[0] === 'number') {\n            roleIds = response.data.roles;\n          } else if (response.data.roles[0].roleId) {\n            roleIds = response.data.roles.map(role => role.roleId);\n          } else if (response.data.roles[0].id) {\n            roleIds = response.data.roles.map(role => role.id);\n          }\n        }\n      } else {\n        console.warn('Rollen fehlen oder sind kein Array:', response.data.roles);\n      }\n      \n      // Wenn keine Rollen gefunden wurden, probieren wir, diese aus roles in der Response direkt zu extrahieren\n      if (roleIds.length === 0 && response.data.role) {\n        console.log('Versuche Rollen aus role-Eigenschaft zu extrahieren:', response.data.role);\n        if (Array.isArray(response.data.role)) {\n          roleIds = response.data.role.map((r: any) => r.id);\n        } else if (typeof response.data.role === 'object' && response.data.role !== null) {\n          roleIds = [response.data.role.id];\n        }\n      }\n      \n      console.log('Endgltige extrahierte Rollen-IDs:', roleIds);\n      \n      setSelectedUser(userData);\n      setUserFormData(userData);\n      setSelectedRoles(roleIds);\n      \n      // Rollen nur einmal laden, wenn sie noch nicht geladen wurden\n      if (roles.length === 0) {\n        await fetchRoles();\n      }\n    } catch (err) {\n      console.error('Fehler beim Laden der Benutzerdetails:', err);\n      handleError(err);\n    }\n  };\n\n  // Fehlerbehandlung\n  const handleError = (err: any) => {\n    let message = 'Ein Fehler ist aufgetreten';\n    if (err.response?.data?.message) {\n      message = err.response.data.message;\n    } else if (err instanceof Error) {\n      message = err.message;\n    }\n    \n    // Fehler \"Ungltige Rollen-ID\" nicht weitergeben, wenn kein Benutzer ausgewhlt ist\n    if (message.includes('Ungltige Rollen-ID') && !selectedUser) {\n      console.warn('Fehler unterdrckt, da kein Benutzer ausgewhlt ist:', message);\n      return;\n    }\n    \n    onError(message);\n  };\n\n  // Handler fr Auswahl eines Benutzers\n  const handleUserSelect = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const userId = parseInt(event.target.value, 10);\n    if (userId && !isNaN(userId)) {\n      fetchUserDetails(userId);\n    } else {\n      setSelectedUser(null);\n      setUserFormData({});\n      setSelectedRoles([]);\n    }\n  };\n\n  // Erweitere den handleUserInputChange\n  const handleUserInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value, type } = e.target;\n    let finalValue: string | number | null = value;\n    \n    // Korrekte Typenkonvertierung fr numerische Felder\n    if (type === 'number') {\n      // Wenn das Feld leer ist, setzen wir null statt NaN\n      finalValue = value === '' ? null : Number(value);\n    }\n    \n    setUserFormData({ ...userFormData, [name]: finalValue });\n    setIsEditingUser(true); // Aktiviere Edit-Modus sobald etwas gendert wird\n  };\n\n  // Abbrechen der Bearbeitung\n  const handleCancelEdit = () => {\n    if (selectedUser) {\n      setUserFormData({\n        ...selectedUser,\n        birthday: selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : null\n      });\n    }\n    setIsEditingUser(false);\n  };\n\n  // Speichern der Benutzerdaten\n  const handleUserSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!selectedUser || !selectedUser.id) {\n      onError('Kein Benutzer ausgewhlt');\n      showMessage('Kein Benutzer ausgewhlt', 'error');\n      return;\n    }\n\n    try {\n      // Validierung\n      if (!userFormData.username?.trim()) throw new Error('Benutzername ist erforderlich');\n      if (!userFormData.email?.trim()) throw new Error('E-Mail ist erforderlich');\n      if (!userFormData.firstName?.trim()) throw new Error('Vorname ist erforderlich');\n      if (!userFormData.lastName?.trim()) throw new Error('Nachname ist erforderlich');\n\n      // Bereite die Daten korrekt vor\n      const dataToSend = {\n        ...userFormData,\n        // Korrekte Behandlung von numerischen Werten\n        salary: userFormData.salary === null || userFormData.salary === undefined || userFormData.salary === '' as any\n          ? null \n          : typeof userFormData.salary === 'string' \n            ? parseFloat(userFormData.salary) \n            : userFormData.salary,\n        normalWorkingHours: userFormData.normalWorkingHours === null || userFormData.normalWorkingHours === undefined || userFormData.normalWorkingHours === '' as any\n          ? 7.6 \n          : typeof userFormData.normalWorkingHours === 'string' \n            ? parseFloat(userFormData.normalWorkingHours) \n            : userFormData.normalWorkingHours,\n        hourlyRate: userFormData.hourlyRate === null || userFormData.hourlyRate === undefined || userFormData.hourlyRate === '' as any\n          ? null \n          : typeof userFormData.hourlyRate === 'string' \n            ? userFormData.hourlyRate  // Keine Konvertierung fr Decimal-Werte, da sie als Strings bergeben werden sollten\n            : userFormData.hourlyRate.toString(),  // Konvertierung zu String fr Decimal-Werte\n        monthlySalary: userFormData.monthlySalary === null || userFormData.monthlySalary === undefined || userFormData.monthlySalary === '' as any\n          ? null \n          : typeof userFormData.monthlySalary === 'string' \n            ? parseFloat(userFormData.monthlySalary) \n            : userFormData.monthlySalary,\n        birthday: userFormData.birthday || null\n      };\n\n      console.log('Sende Daten zum Server:', dataToSend);\n\n      // Update Benutzerdaten\n      const response = await userApi.update(selectedUser.id, dataToSend);\n\n      if (response.data) {\n        const updatedData = {\n          ...response.data,\n          birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n        };\n        setSelectedUser(updatedData);\n        setUserFormData({\n          ...updatedData,\n          birthday: updatedData.birthday ? new Date(updatedData.birthday).toISOString().split('T')[0] : null\n        });\n        \n        // Optimistisches Update: User in allUsers und users aktualisieren\n        setAllUsers(prevUsers => \n          prevUsers.map(user => \n            user.id === updatedData.id ? updatedData : user\n          )\n        );\n        \n        // Benutzerliste neu filtern basierend auf aktuellem Tab\n        filterUsersByActiveStatus(userFilterTab, allUsers.map(user => \n          user.id === updatedData.id ? updatedData : user\n        ));\n        \n        showMessage('Benutzerprofil erfolgreich aktualisiert', 'success');\n        setIsEditingUser(false);\n        \n        // Lifecycle-Daten neu laden, falls Vertragstyp gendert wurde\n        if (dataToSend.contract !== undefined) {\n          setLifecycleRefreshKey(prev => prev + 1);\n        }\n      }\n    } catch (err) {\n      console.error('Fehler beim Speichern der Benutzerdaten:', err);\n      // Bei Fehler: Rollback durch vollstndiges Reload\n      await fetchAllUsers();\n      if (err.response?.status === 400) {\n        const errorMsg = `Validierungsfehler: ${err.response?.data?.message || 'Bitte berprfe die eingegebenen Daten'}`;\n        onError(errorMsg);\n        showMessage(errorMsg, 'error');\n      } else if (err.response?.status === 404) {\n        onError('Benutzer wurde nicht gefunden');\n        showMessage('Benutzer wurde nicht gefunden', 'error');\n      } else {\n        handleError(err);\n      }\n    }\n  };\n\n  // Benutzer aktivieren/deaktivieren\n  const handleToggleActive = async () => {\n    if (!selectedUser || !selectedUser.id) {\n      showMessage('Kein Benutzer ausgewhlt', 'error');\n      return;\n    }\n\n    // Verhindere, dass der Admin-Benutzer sich selbst deaktiviert\n    const currentUserId = parseInt(localStorage.getItem('userId') || '0', 10);\n    if (selectedUser.id === currentUserId) {\n      showMessage('Du kannst dich nicht selbst deaktivieren', 'warning');\n      return;\n    }\n\n    try {\n      // Aktueller Status: wenn undefined, dann true (Default)\n      const currentActiveStatus = selectedUser.active !== undefined ? selectedUser.active : true;\n      const newActiveStatus = !currentActiveStatus;\n      \n      console.log('Toggle active:', { \n        currentActiveStatus, \n        newActiveStatus, \n        selectedUser,\n        selectedUserActive: selectedUser.active,\n        userId: selectedUser.id\n      });\n      \n      const updatePayload = { active: newActiveStatus };\n      console.log('Sending update payload:', updatePayload, 'Type of active:', typeof newActiveStatus);\n      \n      // Update Benutzer\n      const response = await userApi.update(selectedUser.id, updatePayload);\n      \n      console.log('Update response:', response.data);\n\n      if (response.data) {\n        const updatedData = {\n          ...response.data,\n          active: response.data.active !== undefined ? response.data.active : true,\n          birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n        };\n        \n        console.log('Updated user data:', updatedData);\n        \n        setSelectedUser(updatedData);\n        setUserFormData({\n          ...updatedData,\n          birthday: updatedData.birthday ? new Date(updatedData.birthday).toISOString().split('T')[0] : null\n        });\n        \n        // Optimistisches Update: User in allUsers und users aktualisieren\n        setAllUsers(prevUsers => \n          prevUsers.map(user => \n            user.id === updatedData.id ? updatedData : user\n          )\n        );\n        \n        // Benutzerliste neu filtern basierend auf aktuellem Tab\n        filterUsersByActiveStatus(userFilterTab, allUsers.map(user => \n          user.id === updatedData.id ? updatedData : user\n        ));\n        \n        // Benutzerliste neu laden, um sicherzustellen, dass alles synchron ist\n        await fetchAllUsers();\n        \n        showMessage(\n          newActiveStatus \n            ? 'Benutzer erfolgreich aktiviert' \n            : 'Benutzer erfolgreich deaktiviert',\n          'success'\n        );\n      }\n    } catch (err) {\n      console.error('Fehler beim Aktivieren/Deaktivieren des Benutzers:', err);\n      handleError(err);\n      // Bei Fehler: Benutzerliste neu laden\n      await fetchAllUsers();\n    }\n  };\n\n  // Toggle Rolle fr einen Benutzer (hinzufgen/entfernen)\n  const toggleRole = async (roleId: number) => {\n    if (!roleId || !selectedUser) return;\n    \n    // Prfe, ob es sich um eine fixe Rolle handelt - Nur fr Admin-Benutzer (ID: 1) sind Admin-Rollen (ID: 1) nicht entfernbar\n    if (roleId === 1 && selectedUser.id === 1 && selectedRoles.includes(roleId)) {\n      showMessage('Die Admin-Rolle kann vom Admin-Benutzer nicht entfernt werden', 'warning');\n      return;\n    }\n    \n    try {\n      console.log('Toggle Rolle:', roleId, 'fr Benutzer:', selectedUser.id);\n      console.log('Aktuelle ausgewhlte Rollen:', selectedRoles);\n      \n      // berprfen, ob die Rolle bereits zugewiesen ist\n      const isRoleSelected = selectedRoles.includes(roleId);\n      \n      const newSelectedRoles = isRoleSelected\n        ? selectedRoles.filter(id => id !== roleId)\n        : [...selectedRoles, roleId];\n      \n      console.log('Neue ausgewhlte Rollen:', newSelectedRoles);\n      \n      // Optimistisches UI-Update\n      setSelectedRoles(newSelectedRoles);\n      \n      // API-Aufruf zur Aktualisierung der Rollen\n      console.log('Sende Rollenaktualisierung an API:', { userId: selectedUser.id, roleIds: newSelectedRoles });\n      const response = await userApi.updateRoles(selectedUser.id, newSelectedRoles);\n      console.log('API-Antwort bei Rollenaktualisierung:', response.data);\n      \n      // Benutzer nach dem Update neu laden\n      await fetchUserDetails(selectedUser.id);\n      \n      // Erfolgsmeldung anzeigen mit showMessage statt setUserSuccess\n      showMessage(\n        isRoleSelected\n          ? `Rolle erfolgreich entfernt`\n          : `Rolle erfolgreich zugewiesen`,\n        'success'\n      );\n    } catch (error) {\n      // Bei Fehler auf vorherigen Zustand zurcksetzen\n      console.error('Fehler beim Aktualisieren der Rollen:', error);\n      fetchUserDetails(selectedUser.id);\n      handleError(error);\n      showMessage('Fehler beim Aktualisieren der Rollen', 'error');\n    }\n  };\n\n  // Initialisiere FormData wenn Benutzer ausgewhlt wird\n  useEffect(() => {\n    if (selectedUser) {\n      setUserFormData({\n        ...selectedUser,\n        birthday: selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : null\n      });\n      setIsEditingUser(false); // Starte im Read-Only Modus\n    }\n  }, [selectedUser]);\n\n  // Handler fr neue Benutzer-Formular\n  const handleNewUserInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setNewUserFormData({ ...newUserFormData, [name]: value });\n  };\n\n  // Neuen Benutzer erstellen\n  const handleCreateUser = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Validierung\n    if (!newUserFormData.email || !newUserFormData.password || !newUserFormData.firstName || !newUserFormData.lastName) {\n      showMessage('Bitte fllen Sie alle Felder aus', 'error');\n      return;\n    }\n\n    // E-Mail-Format validieren\n    if (!newUserFormData.email.match(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/)) {\n      showMessage('Ungltiges E-Mail-Format', 'error');\n      return;\n    }\n\n    try {\n      const response = await userApi.create(newUserFormData);\n      \n      // Optimistisches Update: User zu allUsers hinzufgen\n      if (response.data) {\n        const newUser = {\n          ...response.data,\n          active: response.data.active !== undefined ? response.data.active : true\n        };\n        setAllUsers(prevUsers => [newUser, ...prevUsers]);\n        \n        // Wenn aktueller Tab \"active\" ist und neuer User aktiv ist, auch zu users hinzufgen\n        if (userFilterTab === 'active' && newUser.active) {\n          setUsers(prevUsers => [newUser, ...prevUsers]);\n        }\n      }\n      \n      showMessage('Benutzer erfolgreich erstellt', 'success');\n      setIsCreateModalOpen(false);\n      setNewUserFormData({\n        email: '',\n        password: '',\n        firstName: '',\n        lastName: ''\n      });\n    } catch (err: any) {\n      // Bei Fehler: Rollback durch vollstndiges Reload\n      await fetchAllUsers();\n      const errorMessage = err.response?.data?.message || 'Fehler beim Erstellen des Benutzers';\n      showMessage(errorMessage, 'error');\n      onError(errorMessage);\n    }\n  };\n\n  return (\n    <div className=\"container mx-auto px-4 pb-6\">\n      {/* Die lokale Erfolgsmeldungs-Anzeige wird entfernt, da wir jetzt HeaderMessage verwenden */}\n      {/* {userSuccess && (\n        <div className=\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4\">\n          {userSuccess}\n        </div>\n      )} */}\n\n      {/* Titelzeile: Button links, Dropdown rechts */}\n      <div className=\"mb-6\">\n        <div className=\"flex items-start gap-4\">\n          {/* Linke Seite: \"Neuer Benutzer\"-Button */}\n          <div className=\"flex items-center pt-8\">\n            {isAdmin() && (\n              <button\n                onClick={() => setIsCreateModalOpen(true)}\n                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                style={{ width: '30.19px', height: '30.19px' }}\n                title={t('users.create')}\n                aria-label={t('users.create')}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n              </button>\n            )}\n          </div>\n          \n          {/* Rechts: Benutzer-Dropdown mit Active/Inactive Tabs */}\n          <div className=\"flex-1\">\n            {/* Active/Inactive Tabs */}\n            <div className=\"flex gap-2 mb-2\">\n              <button\n                type=\"button\"\n                onClick={() => setUserFilterTab('active')}\n                className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${\n                  userFilterTab === 'active'\n                    ? 'bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400'\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600'\n                }`}\n              >\n                {t('users.active')}\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setUserFilterTab('inactive')}\n                className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${\n                  userFilterTab === 'inactive'\n                    ? 'bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400'\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600'\n                }`}\n              >\n                {t('users.inactive')}\n              </button>\n            </div>\n            \n            <select\n              id=\"userSelect\"\n              onChange={handleUserSelect}\n              className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n            >\n              <option value=\"\">-- {t('common.select')} --</option>\n              {users.map(user => (\n                <option key={user.id} value={user.id}>\n                  {user.firstName} {user.lastName} ({user.username})\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n      </div>\n\n      {selectedUser && (\n        <div>\n          {/* Tabs fr Benutzerdetails, Dokumente und Rollen - zusammenhngende Box ohne Shadow/Border */}\n          <div className=\"bg-white dark:bg-gray-800 mb-6\">\n            {/* Tab-Navigation */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n              <nav className=\"flex -mb-px\">\n                <button\n                  onClick={() => setActiveUserTab('details')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'details'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <UserCircleIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('users.title')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('documents')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'documents'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <DocumentTextIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('profile.documents')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('roles')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'roles'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <ShieldCheckIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('roles.title')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('lifecycle')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'lifecycle'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <BuildingOfficeIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('lifecycle.tabTitle')}\n                </button>\n              </nav>\n          </div>\n\n            {/* Tab-Inhalte */}\n          {/* Benutzerdetails Formular */}\n          {activeUserTab === 'details' && (\n              <form onSubmit={handleUserSubmit} className=\"p-6\">\n              {/* Bestehender Code fr Benutzerdetails */}\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-6\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.username')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"username\"\n                    value={userFormData.username || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.email')}\n                  </label>\n                  <input\n                    type=\"email\"\n                    name=\"email\"\n                    value={userFormData.email || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.firstName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"firstName\"\n                    value={userFormData.firstName || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.lastName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"lastName\"\n                    value={userFormData.lastName || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.birthday')}\n                  </label>\n                  <input\n                    type=\"date\"\n                    name=\"birthday\"\n                    value={userFormData.birthday || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.bankDetails')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"bankDetails\"\n                    value={userFormData.bankDetails || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.contract')}\n                  </label>\n                  <select\n                    name=\"contract\"\n                    value={userFormData.contract || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  >\n                    <option value=\"\">{t('common.pleaseSelect', { defaultValue: 'Bitte auswhlen...' })}</option>\n                    {CONTRACT_TYPES.map((type) => (\n                      <option key={type.code} value={type.code}>\n                        {type.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.salary')}\n                  </label>\n                  <input\n                    type=\"number\"\n                    name=\"salary\"\n                    value={userFormData.salary === null || userFormData.salary === undefined ? '' : userFormData.salary}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.normalWorkingHours')}\n                  </label>\n                  <input\n                    type=\"number\"\n                    step=\"0.1\"\n                    name=\"normalWorkingHours\"\n                    value={userFormData.normalWorkingHours === null || userFormData.normalWorkingHours === undefined ? '7.6' : userFormData.normalWorkingHours}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.country')}\n                  </label>\n                  <select\n                    name=\"country\"\n                    value={userFormData.country || 'CO'}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  >\n                    {COUNTRIES.map((country) => (\n                      <option key={country.code} value={country.code}>\n                        {country.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.language')}\n                  </label>\n                  <select\n                    name=\"language\"\n                    value={userFormData.language || 'es'}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  >\n                    {LANGUAGES.map((language) => (\n                      <option key={language.code} value={language.code}>\n                        {language.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n              </div>\n\n              {/* Lohnabrechnung-Einstellungen */}\n              <div className=\"mt-4 border-t pt-4\">\n                <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('users.form.payrollSettings')}</h3>\n                \n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('users.form.payrollCountry')}\n                    </label>\n                    <select\n                      name=\"payrollCountry\"\n                      value={userFormData.payrollCountry || selectedUser.payrollCountry || 'CH'}\n                      onChange={handleUserInputChange}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    >\n                      {PAYROLL_COUNTRIES.map(country => (\n                        <option key={country.code} value={country.code}>\n                          {country.name}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  \n                  {(userFormData.payrollCountry === 'CO' || \n                    (selectedUser.payrollCountry === 'CO' && !userFormData.payrollCountry)) && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('users.form.contractType')}\n                      </label>\n                      <select\n                        name=\"contractType\"\n                        value={userFormData.contractType || ''}\n                        onChange={handleUserInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      >\n                        <option value=\"\">Bitte auswhlen</option>\n                        {CONTRACT_TYPES.map(type => (\n                          <option key={type.code} value={type.code}>\n                            {type.name}\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                  )}\n                </div>\n                \n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('users.form.hourlyRate')} ({(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? 'CHF' : 'COP'})\n                    </label>\n                    <input\n                      type=\"number\"\n                      name=\"hourlyRate\"\n                      min=\"0\"\n                      step={(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? '0.05' : '1'}\n                      value={userFormData.hourlyRate === null || userFormData.hourlyRate === undefined ? '' : userFormData.hourlyRate}\n                      onChange={handleUserInputChange}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      placeholder={(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? 'z.B. 45.00' : 'z.B. 50000'}\n                    />\n                  </div>\n                  \n                  {((userFormData.payrollCountry === 'CO' || selectedUser.payrollCountry === 'CO') && \n                    (userFormData.contractType !== 'servicios_externos' && selectedUser.contractType !== 'servicios_externos') &&\n                    (userFormData.contractType || selectedUser.contractType)) && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('users.form.monthlySalary')} (COP)\n                      </label>\n                      <input\n                        type=\"number\"\n                        name=\"monthlySalary\"\n                        min=\"0\"\n                        step=\"1000\"\n                        value={userFormData.monthlySalary === null || userFormData.monthlySalary === undefined ? '' : userFormData.monthlySalary}\n                        onChange={handleUserInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                        placeholder=\"z.B. 3500000\"\n                      />\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {isEditingUser && (\n                <div className=\"mt-4 flex justify-end gap-3\">\n                  <button\n                    type=\"button\"\n                    onClick={handleCancelEdit}\n                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                    title={t('common.cancel')}\n                  >\n                    <XMarkIcon className=\"h-5 w-5\" />\n                  </button>\n                  <button\n                    type=\"submit\"\n                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                    title={t('common.save')}\n                  >\n                    <CheckIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              )}\n\n              {/* Status-Badge und Activate/Deactivate Button unter den Profil-Feldern */}\n              <div className=\"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-between items-center\">\n                {selectedUser.active !== undefined && (\n                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                    selectedUser.active \n                      ? 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300' \n                      : 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300'\n                  }`}>\n                    {selectedUser.active ? t('users.active') : t('users.inactive')}\n                  </span>\n                )}\n                {isAdmin() && (\n                  <button\n                    onClick={handleToggleActive}\n                    className={`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${\n                      selectedUser.active\n                        ? 'bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30'\n                        : 'bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900/20 dark:text-green-400 dark:hover:bg-green-900/30'\n                    }`}\n                    title={selectedUser.active ? t('users.deactivate') : t('users.activate')}\n                  >\n                    {selectedUser.active ? (\n                      <>\n                        <XMarkIcon className=\"h-5 w-5\" />\n                        {t('users.deactivate')}\n                      </>\n                    ) : (\n                      <>\n                        <CheckIcon className=\"h-5 w-5\" />\n                        {t('users.activate')}\n                      </>\n                    )}\n                  </button>\n                )}\n              </div>\n            </form>\n          )}\n\n          {/* Identifikationsdokumente Tab */}\n          {activeUserTab === 'documents' && (\n              <div className=\"p-6\">\n            <IdentificationDocumentList userId={selectedUser.id} isAdmin={true} />\n              </div>\n          )}\n\n          {/* Rollen Tab */}\n          {activeUserTab === 'roles' && (\n              <div className=\"p-6\">\n              {/* Rollenzuweisung - nur anzeigen, wenn Rollen geladen wurden */}\n              {loadingRoles ? (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('roleAssignment.title')}</h3>\n                  <p className=\"dark:text-gray-300\">{t('roleAssignment.loading')}</p>\n                </div>\n              ) : roles.length > 0 && (\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('roleAssignment.title')}</h3>\n                  \n                  {/* berprfung auf unbekannte Rollen */}\n                  {selectedRoles.some(roleId => !roles.some(role => role.id === roleId)) && (\n                    <div className=\"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4\">\n                      <p className=\"font-bold\">{t('roleAssignment.unknownRolesWarning')}</p>\n                      <p>{t('roleAssignment.unknownRolesMessage', { ids: selectedRoles.filter(roleId => !roles.some(role => role.id === roleId)).join(', ') })}</p>\n                      <p className=\"mt-2 text-sm\">{t('roleAssignment.availableRoleIds', { ids: roles.map(r => r.id).join(', ') })}</p>\n                    </div>\n                  )}\n                  \n                  {/* Aktuell zugewiesene Rollen */}\n                  <div className=\"mb-4\">\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('roleAssignment.currentRoles')}</h4>\n                    {selectedRoles.length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('roleAssignment.noRolesAssigned')}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {/* Bekannte zugewiesene Rollen */}\n                        {roles\n                          .filter(role => selectedRoles.includes(role.id))\n                          .map(role => {\n                            // Eine Rolle ist nur dann nicht entfernbar, wenn es sich um die Admin-Rolle (ID: 1) fr den Admin-Benutzer (ID: 1) handelt\n                            const isFixedRole = role.id === 1 && selectedUser && selectedUser.id === 1;\n                            return (\n                              <div \n                                key={role.id} \n                                className={`border rounded-lg p-4 ${isFixedRole ? 'border-green-500 bg-green-50 dark:bg-green-900/20 dark:border-green-700 cursor-not-allowed' : 'border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 cursor-pointer'}`}\n                                onClick={() => !isFixedRole && toggleRole(role.id)}\n                              >\n                                <div className=\"flex justify-between items-center\">\n                                  <div>\n                                    <h4 className=\"font-medium flex items-center dark:text-white\">\n                                      {role.name}\n                                      {isFixedRole && (\n                                        <span className=\"ml-2 text-xs bg-green-600 text-white px-2 py-0.5 rounded-full\">\n                                          {t('roleAssignment.fixed')}\n                                        </span>\n                                      )}\n                                    </h4>\n                                    <p className=\"text-sm text-gray-600 dark:text-gray-400\">{role.description}</p>\n                                  </div>\n                                  <div className={`flex items-center ${isFixedRole ? 'text-gray-400 dark:text-gray-500' : 'text-blue-600 dark:text-blue-400'}`}>\n                                    <span className=\"mr-2 text-sm\">{isFixedRole ? t('roleAssignment.fixedAssigned') : t('roleAssignment.remove')}</span>\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </div>\n                                </div>\n                              </div>\n                            );\n                          })}\n                        \n                        {/* Unbekannte zugewiesene Rollen */}\n                        {selectedRoles\n                          .filter(roleId => !roles.some(role => role.id === roleId))\n                          .map(roleId => (\n                            <div \n                              key={`unknown-${roleId}`} \n                              className=\"border border-orange-500 bg-orange-50 rounded-lg p-4\"\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{t('roleAssignment.unknownRole', { id: roleId })}</h4>\n                                  <p className=\"text-sm text-orange-600\">{t('roleAssignment.unknownRoleDescription')}</p>\n                                </div>\n                                <div className=\"flex items-center text-orange-600\">\n                                  <span className=\"mr-2 text-sm\">{t('roleAssignment.remove')}</span>\n                                  <button \n                                    onClick={() => toggleRole(roleId)}\n                                    className=\"focus:outline-none\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </button>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Verfgbare Rollen */}\n                  <div>\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('roleAssignment.availableRoles')}</h4>\n                    {roles.filter(role => !selectedRoles.includes(role.id)).length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('roleAssignment.noRolesAvailable')}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {roles\n                          .filter(role => !selectedRoles.includes(role.id))\n                          .map(role => (\n                            <div \n                              key={role.id} \n                              className=\"border border-gray-300 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50\"\n                              onClick={() => toggleRole(role.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{role.name}</h4>\n                                  <p className=\"text-sm text-gray-600\">{role.description}</p>\n                                </div>\n                                <div className=\"flex items-center text-gray-500 hover:text-blue-600\">\n                                  <span className=\"mr-2 text-sm\">{t('roleAssignment.add')}</span>\n                                  <PlusIcon className=\"h-5 w-5\" />\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Lebenszyklus Tab */}\n          {activeUserTab === 'lifecycle' && selectedUser && (\n              <div className=\"p-6\">\n            <LifecycleView \n              key={`lifecycle-${selectedUser.id}-${lifecycleRefreshKey}`}\n              userId={selectedUser.id} \n              userName={`${selectedUser.firstName} ${selectedUser.lastName}`}\n            />\n              </div>\n          )}\n          </div>\n        </div>\n      )}\n\n      {/* Sidepane/Modal fr Benutzererstellung */}\n      {isCreateModalOpen && (\n        <>\n          {/* Fr Mobile (unter 640px) - klassisches Modal */}\n          {isMobile ? (\n            <Dialog open={isCreateModalOpen} onClose={() => setIsCreateModalOpen(false)} className=\"relative z-50\">\n              <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n              \n              <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                  {/* Header */}\n                  <div className=\"px-6 py-4 border-b dark:border-gray-700\">\n                    <div className=\"flex items-center justify-between\">\n                      <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                        {t('organisation.createUser.title')}\n                      </Dialog.Title>\n                      <button\n                        onClick={() => setIsCreateModalOpen(false)}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                      >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                      </button>\n                    </div>\n                  </div>\n                  \n                  {/* Form */}\n                  <form onSubmit={handleCreateUser} className=\"p-6\">\n                    <div className=\"space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.email')} *\n                        </label>\n                        <input\n                          type=\"email\"\n                          name=\"email\"\n                          value={newUserFormData.email}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.password')} *\n                        </label>\n                        <input\n                          type=\"password\"\n                          name=\"password\"\n                          value={newUserFormData.password}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.firstName')} *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"firstName\"\n                          value={newUserFormData.firstName}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.lastName')} *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"lastName\"\n                          value={newUserFormData.lastName}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                    </div>\n                    \n                    {/* Footer */}\n                    <div className=\"mt-6 flex justify-end gap-3\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setIsCreateModalOpen(false)}\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                        title={t('common.cancel')}\n                      >\n                        <XMarkIcon className=\"h-5 w-5\" />\n                      </button>\n                      <button\n                        type=\"submit\"\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                        title={t('organisation.createUser.create')}\n                      >\n                        <CheckIcon className=\"h-5 w-5\" />\n                      </button>\n                    </div>\n                  </form>\n                </Dialog.Panel>\n              </div>\n            </Dialog>\n          ) : (\n            // Fr Desktop (ab 640px) - Sidepane\n            // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n            <>\n              {/* Backdrop - nur wenn offen und <= 1070px */}\n              {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n              {isCreateModalOpen && !isLargeScreen && (\n                <div \n                  className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                  aria-hidden=\"true\" \n                  style={{\n                    opacity: isCreateModalOpen ? 1 : 0,\n                    transition: 'opacity 300ms ease-out'\n                  }}\n                />\n              )}\n              \n              {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n              <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isCreateModalOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                  transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                  pointerEvents: isCreateModalOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isCreateModalOpen}\n                role=\"dialog\"\n                aria-modal={isCreateModalOpen}\n              >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                  <h2 className=\"text-lg font-semibold dark:text-white\">\n                    {t('organisation.createUser.title')}\n                  </h2>\n                  <button\n                    onClick={() => setIsCreateModalOpen(false)}\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                <div className=\"flex flex-col flex-1 min-h-0\">\n                  <form onSubmit={handleCreateUser} className=\"flex flex-col flex-1 min-h-0\">\n                    <div className=\"p-4 overflow-y-auto flex-1 min-h-0 space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.email')} *\n                        </label>\n                      <input\n                        type=\"email\"\n                        name=\"email\"\n                        value={newUserFormData.email}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.password')} *\n                      </label>\n                      <input\n                        type=\"password\"\n                        name=\"password\"\n                        value={newUserFormData.password}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.firstName')} *\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"firstName\"\n                        value={newUserFormData.firstName}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.lastName')} *\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"lastName\"\n                        value={newUserFormData.lastName}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                      </div>\n                    </div>\n                    \n                    {/* Footer */}\n                    <div className=\"flex justify-end gap-3 border-t dark:border-gray-700 pt-4 px-4 flex-shrink-0\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setIsCreateModalOpen(false)}\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                        title={t('common.cancel')}\n                      >\n                        <XMarkIcon className=\"h-5 w-5\" />\n                      </button>\n                      <button\n                        type=\"submit\"\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                        title={t('organisation.createUser.create')}\n                      >\n                        <CheckIcon className=\"h-5 w-5\" />\n                      </button>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default UserManagementTab; ","import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { roleApi } from '../api/apiClient.ts';\nimport { Role, AccessLevel } from '../types/interfaces.ts';\nimport { PencilIcon, TrashIcon, PlusIcon, FunnelIcon, XMarkIcon, CheckIcon, ArrowPathIcon, DocumentDuplicateIcon, ChevronDownIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { ErrorCategory } from '../services/ErrorHandler.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface RoleManagementTabProps {\n  onRolesChange?: () => void;\n  onError: (error: string) => void;\n  readOnly?: boolean;\n}\n\n// Definiere Seiten, die immer sichtbar sein sollen (ohne Berechtigungsprfung)\nconst alwaysVisiblePages = ['dashboard', 'worktracker', 'cerebro', 'settings', 'profile'];\n\n// ALLE SEITEN IM SYSTEM (synchron mit Backend)\nconst defaultPages = [\n  'dashboard',\n  'worktracker',\n  'consultations',\n  'team_worktime_control', // = workcenter\n  'payroll', // = lohnabrechnung\n  'organization_management', // = organisation (Hauptseite)\n  'cerebro',\n  'settings',\n  'profile'\n];\n\n// ALLE TABELLEN IM SYSTEM (synchron mit Backend)\nconst defaultTables = [\n  'requests',           // auf dashboard\n  'tasks',             // auf worktracker\n  'users',             // auf organization_management\n  'roles',             // auf organization_management\n  'organization',      // auf organization_management\n  'organization_join_requests', // auf organization_management\n  'organization_users',  // auf organization_management\n  'team_worktime',     // auf team_worktime_control\n  'worktime',          // auf worktracker\n  'clients',           // auf consultations\n  'consultation_invoices', // auf consultations\n  'branches',          // auf settings/system\n  'notifications',     // allgemein\n  'settings',          // auf settings\n  'monthly_reports'    // auf consultations/reports\n];\n\n// ALLE BUTTONS IM SYSTEM (synchron mit Backend)\nconst defaultButtons = [\n  // Database Management Buttons (Settings/System)\n  'database_reset_table',\n  'database_logs',\n  \n  // Invoice Functions Buttons\n  'invoice_create',\n  'invoice_download', \n  'invoice_mark_paid',\n  'invoice_settings',\n  \n  // Todo/Task Buttons (Worktracker)\n  'todo_create',\n  'todo_edit',\n  'todo_delete',\n  'task_create',\n  'task_edit', \n  'task_delete',\n  \n  // User Management Buttons\n  'user_create',\n  'user_edit',\n  'user_delete',\n  'role_assign',\n  'role_create',\n  'role_edit',\n  'role_delete',\n  \n  // Organization Management Buttons\n  'organization_create',\n  'organization_edit',\n  'organization_delete',\n  \n  // Worktime Buttons\n  'worktime_start',\n  'worktime_stop', \n  'worktime_edit',\n  'worktime_delete',\n  \n  // General Cerebro Button\n  'cerebro',\n  \n  // Consultation Buttons\n  'consultation_start',\n  'consultation_stop',\n  'consultation_edit',\n  \n  // Client Management Buttons\n  'client_create',\n  'client_edit',\n  'client_delete',\n  \n  // Settings Buttons\n  'settings_system',\n  'settings_notifications',\n  'settings_profile',\n  \n  // Payroll Buttons\n  'payroll_generate',\n  'payroll_export',\n  'payroll_edit'\n];\n\n// Definiert die Zuordnung von Tabellen zu ihren bergeordneten Seiten\nconst tableToPageMapping = {\n  'requests': 'dashboard',\n  'tasks': 'worktracker',\n  'users': 'organization_management',\n  'roles': 'organization_management',\n  'organization': 'organization_management',\n  'organization_join_requests': 'organization_management',\n  'organization_users': 'organization_management',\n  'team_worktime': 'team_worktime_control',\n  'worktime': 'worktracker',\n  'clients': 'consultations',\n  'consultation_invoices': 'consultations',\n  'branches': 'settings',\n  'notifications': 'general',\n  'settings': 'settings',\n  'monthly_reports': 'consultations'\n};\n\n// Definiert die Zuordnung von Buttons zu ihren bergeordneten Seiten/Bereichen\nconst buttonToPageMapping = {\n  'database_reset_table': 'settings',\n  'database_logs': 'settings',\n  'invoice_create': 'consultations',\n  'invoice_download': 'consultations',\n  'invoice_mark_paid': 'consultations',\n  'invoice_settings': 'consultations',\n  'todo_create': 'worktracker',\n  'todo_edit': 'worktracker',\n  'todo_delete': 'worktracker',\n  'task_create': 'worktracker',\n  'task_edit': 'worktracker',\n  'task_delete': 'worktracker',\n  'user_create': 'organization_management',\n  'user_edit': 'organization_management',\n  'user_delete': 'organization_management',\n  'role_assign': 'organization_management',\n  'role_create': 'organization_management',\n  'role_edit': 'organization_management',\n  'role_delete': 'organization_management',\n  'organization_create': 'organization_management',\n  'organization_edit': 'organization_management',\n  'organization_delete': 'organization_management',\n  'worktime_start': 'worktracker',\n  'worktime_stop': 'worktracker',\n  'worktime_edit': 'worktracker',\n  'worktime_delete': 'worktracker',\n  'cerebro': 'cerebro',\n  'consultation_start': 'consultations',\n  'consultation_stop': 'consultations',\n  'consultation_edit': 'consultations',\n  'client_create': 'consultations',\n  'client_edit': 'consultations',\n  'client_delete': 'consultations',\n  'settings_system': 'settings',\n  'settings_notifications': 'settings',\n  'settings_profile': 'settings',\n  'payroll_generate': 'payroll',\n  'payroll_export': 'payroll',\n  'payroll_edit': 'payroll'\n};\n\n// Definiert die Zuordnung von Buttons zu ihren zugehrigen Tabellen\nconst buttonToTableMapping: Record<string, string | null> = {\n  // Worktime Buttons  worktime Tabelle\n  'worktime_start': 'worktime',\n  'worktime_stop': 'worktime',\n  'worktime_edit': 'worktime',\n  'worktime_delete': 'worktime',\n  // Task/Todo Buttons  tasks Tabelle\n  'task_create': 'tasks',\n  'task_edit': 'tasks',\n  'task_delete': 'tasks',\n  'todo_create': 'tasks',\n  'todo_edit': 'tasks',\n  'todo_delete': 'tasks',\n  // Client Buttons  clients Tabelle\n  'client_create': 'clients',\n  'client_edit': 'clients',\n  'client_delete': 'clients',\n  'consultation_start': 'clients',\n  'consultation_stop': 'clients',\n  'consultation_edit': 'clients',\n  // Invoice Buttons  consultation_invoices Tabelle\n  'invoice_create': 'consultation_invoices',\n  'invoice_download': 'consultation_invoices',\n  'invoice_mark_paid': 'consultation_invoices',\n  'invoice_settings': 'consultation_invoices',\n  // User Management Buttons  users/roles Tabellen\n  'user_create': 'users',\n  'user_edit': 'users',\n  'user_delete': 'users',\n  'role_assign': 'roles',\n  'role_create': 'roles',\n  'role_edit': 'roles',\n  'role_delete': 'roles',\n  // Organization Management Buttons  organization Tabelle\n  'organization_create': 'organization',\n  'organization_edit': 'organization',\n  'organization_delete': 'organization',\n  // Settings Buttons  settings Tabelle\n  'settings_system': 'settings',\n  'settings_notifications': 'settings',\n  'settings_profile': 'settings',\n  // Buttons ohne direkte Tabelle-Zuordnung\n  'database_reset_table': null,\n  'database_logs': null,\n  'cerebro': null,\n  'payroll_generate': null,\n  'payroll_export': null,\n  'payroll_edit': null\n};\n\n// Display-Name-Mapping fr Seiten (DB-Interne Bezeichnung  Frontend-Bezeichnung)\n// Wird dynamisch aus bersetzungen geladen\n\n// Display-Name-Mapping fr Tabellen (DB-Interne Bezeichnung  Frontend-Bezeichnung)\n// Wird dynamisch aus bersetzungen geladen\n\n// Display-Name-Mapping fr Buttons wird dynamisch in der Komponente geladen\n\n// TableID fr gespeicherte Filter\nconst ROLES_TABLE_ID = 'roles-table';\n\n// Standardrollen-IDs (fr Rollen ohne Organisation)\nconst STANDARD_ROLE_IDS = [1, 2, 999]; // Admin (1), User (2), Hamburger (999)\n\n// Standardrollen-Namen (drfen nicht bearbeitet/gelscht werden, egal von welcher Organisation)\nconst STANDARD_ROLE_NAMES = ['Admin', 'User', 'Hamburger'];\n\n// Helper-Funktion zur Prfung ob es sich um eine Standardrolle handelt\nconst isStandardRole = (roleId: number, roleName?: string): boolean => {\n  // Prfe zuerst auf Standard-IDs (fr Rollen ohne Organisation)\n  if (STANDARD_ROLE_IDS.includes(roleId)) {\n    return true;\n  }\n  // Prfe auf Standard-Namen (fr Rollen in Organisationen)\n  if (roleName && STANDARD_ROLE_NAMES.includes(roleName)) {\n    return true;\n  }\n  return false;\n};\n\ninterface RoleFormData {\n  name: string;\n  description: string;\n  permissions: {\n    entity: string;\n    entityType: string;\n    accessLevel: AccessLevel;\n  }[];\n}\n\n\n// RoleCard-Komponente fr mobile Ansicht\nconst RoleCard: React.FC<{\n  role: Role;\n  onEdit: (role: Role) => void;\n  onDelete: (roleId: number) => void;\n  onCopy: (role: Role) => void;\n  canEdit: boolean;\n  canDelete: boolean;\n  canCopy: boolean;\n}> = ({ role, onEdit, onDelete, onCopy, canEdit, canDelete, canCopy }) => {\n  const { t } = useTranslation();\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4 mb-4\">\n      {/* Header mit Rollenname und Aktionen */}\n      <div className=\"flex justify-between items-start mb-2\">\n        <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{role.name}</h3>\n        \n        <div className=\"flex space-x-2\">\n          {canCopy && (\n            <button\n              onClick={() => onCopy(role)}\n              className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n              title={t('roles.actions.copy')}\n            >\n              <DocumentDuplicateIcon className=\"h-5 w-5\" />\n            </button>\n          )}\n          \n          {canEdit && (\n            <button\n              onClick={() => onEdit(role)}\n              className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n              title={t('roles.actions.edit')}\n            >\n              <PencilIcon className=\"h-5 w-5\" />\n            </button>\n          )}\n          \n          {canDelete && (\n            <button\n              onClick={() => onDelete(role.id)}\n              className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n              title={t('roles.actions.delete')}\n            >\n              <TrashIcon className=\"h-5 w-5\" />\n            </button>\n          )}\n        </div>\n      </div>\n      \n      {/* Beschreibung */}\n      <p className=\"text-sm text-gray-600 dark:text-gray-400\">{role.description || t('roles.noDescription')}</p>\n      \n      {/* Berechtigungen - kompakt */}\n      <div className=\"mt-2\">\n        <h4 className=\"text-sm font-medium text-gray-900 dark:text-white mb-1\">{t('roles.permissions')}:</h4>\n        <div className=\"flex flex-wrap gap-1\">\n          {role.permissions\n            .filter(perm => perm.accessLevel !== 'none') // Nur relevante Berechtigungen anzeigen\n            .slice(0, 8) // Begrenze die Anzahl der angezeigten Berechtigungen\n            .map(permission => (\n              <span \n                key={`${permission.entity}-${permission.entityType}`}\n                className=\"text-xs bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 px-2 py-1 rounded\"\n              >\n                {permission.entity}: {permission.accessLevel}\n              </span>\n            ))}\n          {role.permissions.filter(perm => perm.accessLevel !== 'none').length > 8 && (\n            <span className=\"text-xs bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-300 px-2 py-1 rounded\">\n                +{role.permissions.filter(perm => perm.accessLevel !== 'none').length - 8} {t('common.showMore')}\n            </span>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst RoleManagementTab: React.FC<RoleManagementTabProps> = ({ onRolesChange, onError, readOnly = false }) => {\n  const { t } = useTranslation();\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [editingRole, setEditingRole] = useState<Role | null>(null);\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loading, setLoading] = useState(true);\n  \n  // Display-Name-Mapping fr Seiten (dynamisch aus bersetzungen)\n  const pageDisplayNames = useMemo(() => ({\n    'dashboard': t('roles.pages.dashboard'),\n    'worktracker': t('roles.pages.worktracker'),\n    'consultations': t('roles.pages.consultations'),\n    'team_worktime_control': t('roles.pages.team_worktime_control'),\n    'payroll': t('roles.pages.payroll'),\n    'organization_management': t('roles.pages.organization_management'), // Organisation-Seite (Hauptseite)\n    'cerebro': t('roles.pages.cerebro'),\n    'settings': t('roles.pages.settings'),\n    'profile': t('roles.pages.profile')\n  }), [t]);\n\n  // Display-Name-Mapping fr Tabellen (dynamisch aus bersetzungen)\n  const tableDisplayNames = useMemo(() => ({\n    'tasks': t('roles.tables.tasks'),\n    'worktime': t('roles.tables.worktime'),\n    'users': t('roles.tables.users'),\n    'roles': t('roles.tables.roles'),\n    'organization': t('roles.tables.organization'),\n    'organization_join_requests': t('roles.tables.organization_join_requests'),\n    'organization_users': t('roles.tables.organization_users'),\n    'clients': t('roles.tables.clients'),\n    'consultation_invoices': t('roles.tables.consultation_invoices'),\n    'requests': t('roles.tables.requests'),\n    'team_worktime': t('roles.tables.team_worktime'),\n    'settings': t('roles.tables.settings'),\n    'notifications': t('roles.tables.notifications'),\n    'branches': t('roles.tables.branches'),\n    'monthly_reports': t('roles.tables.monthly_reports')\n  }), [t]);\n\n  // Display-Name-Mapping fr Buttons (dynamisch aus bersetzungen)\n  const buttonDisplayNames = useMemo(() => ({\n    'worktime_start': t('roles.buttons.worktime_start'),\n    'worktime_stop': t('roles.buttons.worktime_stop'),\n    'worktime_edit': t('roles.buttons.worktime_edit'),\n    'worktime_delete': t('roles.buttons.worktime_delete'),\n    'task_create': t('roles.buttons.task_create'),\n    'task_edit': t('roles.buttons.task_edit'),\n    'task_delete': t('roles.buttons.task_delete'),\n    'todo_create': t('roles.buttons.todo_create'),\n    'todo_edit': t('roles.buttons.todo_edit'),\n    'todo_delete': t('roles.buttons.todo_delete'),\n    'client_create': t('roles.buttons.client_create'),\n    'client_edit': t('roles.buttons.client_edit'),\n    'client_delete': t('roles.buttons.client_delete'),\n    'consultation_start': t('roles.buttons.consultation_start'),\n    'consultation_stop': t('roles.buttons.consultation_stop'),\n    'consultation_edit': t('roles.buttons.consultation_edit'),\n    'invoice_create': t('roles.buttons.invoice_create'),\n    'invoice_download': t('roles.buttons.invoice_download'),\n    'invoice_mark_paid': t('roles.buttons.invoice_mark_paid'),\n    'invoice_settings': t('roles.buttons.invoice_settings'),\n    'user_create': t('roles.buttons.user_create'),\n    'user_edit': t('roles.buttons.user_edit'),\n    'user_delete': t('roles.buttons.user_delete'),\n    'role_assign': t('roles.buttons.role_assign'),\n    'role_create': t('roles.buttons.role_create'),\n    'role_edit': t('roles.buttons.role_edit'),\n    'role_delete': t('roles.buttons.role_delete'),\n    'organization_create': t('roles.buttons.organization_create'),\n    'organization_edit': t('roles.buttons.organization_edit'),\n    'organization_delete': t('roles.buttons.organization_delete'),\n    'settings_system': t('roles.buttons.settings_system'),\n    'settings_notifications': t('roles.buttons.settings_notifications'),\n    'settings_profile': t('roles.buttons.settings_profile'),\n    'database_reset_table': t('roles.buttons.database_reset_table'),\n    'database_logs': t('roles.buttons.database_logs'),\n    'payroll_generate': t('roles.buttons.payroll_generate'),\n    'payroll_export': t('roles.buttons.payroll_export'),\n    'payroll_edit': t('roles.buttons.payroll_edit'),\n    'cerebro': t('roles.buttons.cerebro')\n  }), [t]);\n  const [formData, setFormData] = useState<RoleFormData>({\n    name: '',\n    description: '',\n    permissions: [\n      // Seiten-Berechtigungen\n      ...defaultPages.map(page => ({\n        entity: page,\n        entityType: 'page',\n        accessLevel: 'none' as AccessLevel\n      })),\n      // Tabellen-Berechtigungen\n      ...defaultTables.map(table => ({\n        entity: table,\n        entityType: 'table',\n        accessLevel: 'none' as AccessLevel\n      })),\n      // Button-Berechtigungen\n      ...defaultButtons.map(button => ({\n        entity: button,\n        entityType: 'button',\n        accessLevel: 'none' as AccessLevel\n      }))\n    ]\n  });\n  const [error, setError] = useState<string | null>(null);\n  const { hasPermission } = usePermissions();\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n  \n  // Neue State-Variablen fr erweiterte Filterbedingungen\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  // Responsiveness Hook (640px wie Standard)\n  const [isMobile, setIsMobile] = useState<boolean>(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  \n  // Neue Fehlerbehandlung hinzufgen\n  const { handleError, handleValidationError } = useError();\n  \n  // Neue State-Variablen fr die Berechtigungen\n  const [isAddPermissionModalOpen, setIsAddPermissionModalOpen] = useState(false);\n  const [selectedPermission, setSelectedPermission] = useState<string | null>(null);\n  const [displayLimit, setDisplayLimit] = useState<number>(10);\n  \n  // berwache Bildschirmgre\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isModalOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isModalOpen, openSidepane, closeSidepane]);\n\n  // Aktualisiere die fetchRoles-Funktion, um den neuen ErrorHandler zu nutzen\n  const fetchRoles = useCallback(async () => {\n    setLoading(true);\n    console.log('DEBUGAUSGABE: Hole Rollen vom Server...');\n    \n    try {\n      const response = await roleApi.getAll();\n      console.log('DEBUGAUSGABE: Rollen erfolgreich geholt:', response.data);\n      setRoles(response.data);\n      setError(null);\n    } catch (error) {\n      console.error('DEBUGAUSGABE: Fehler beim Abrufen der Rollen:', error);\n      // Nutze den neuen ErrorHandler\n      handleError(error, { \n        component: 'RoleManagementTab', \n        action: 'fetchRoles' \n      });\n      // Rufe auch den bergebenen onError auf, falls vorhanden\n      if (onError) {\n        onError('Fehler beim Laden der Rollen');\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [handleError, onError]);\n\n  // Direkt Rollen laden\n  useEffect(() => {\n    fetchRoles();\n  }, [fetchRoles]);\n\n  // Speichern einer Rolle\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n    \n    if (!formData.name) {\n      handleValidationError('Rollenname darf nicht leer sein', { name: 'Rollenname ist erforderlich' });\n      return;\n    }\n    \n    if (editingRole) {\n      // Stelle sicher, dass die immer sichtbaren Seiten auch tatschlich auf 'both' gesetzt sind\n      const updatedPermissions = formData.permissions.map(permission => {\n        if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n          return { ...permission, accessLevel: 'both' };\n        }\n        return permission;\n      });\n      \n      // Filtere nur die relevanten Berechtigungen (nicht 'none')\n      const filteredPermissions = updatedPermissions\n        .filter(permission => permission.accessLevel !== 'none')\n        .map(permission => ({\n          entity: permission.entity,\n          entityType: permission.entityType,\n          accessLevel: permission.accessLevel\n        }));\n      \n      if (!editingRole.id || isNaN(editingRole.id)) {\n        console.warn('DEBUGAUSGABE: Ungltige Rollen-ID erkannt, Bearbeitung abgebrochen');\n        handleError('Ungltige Rollen-ID, Bearbeitung abgebrochen', { \n          component: 'RoleManagementTab',\n          roleId: editingRole.id\n        });\n        return;\n      }\n      \n      // berprfen, ob es sich um eine geschtzte Rolle handelt\n      if (isStandardRole(editingRole.id, editingRole.name)) {\n        console.warn(`DEBUGAUSGABE: Versuch, geschtzte Rolle mit ID ${editingRole.id} zu bearbeiten`);\n        handleError({\n          message: 'Geschtzte Systemrollen knnen nicht bearbeitet werden',\n          name: 'PermissionError'\n        }, {\n          component: 'RoleManagementTab',\n          roleId: editingRole.id,\n          category: ErrorCategory.PERMISSION\n        });\n        setIsModalOpen(false);\n        return;\n      }\n      \n      // berprfen, ob die Rolle noch in der aktuellen Liste existiert\n      const roleExists = roles.some(r => r.id === editingRole.id);\n      if (!roleExists) {\n        console.error(`DEBUGAUSGABE: Rolle mit ID ${editingRole.id} existiert nicht in der aktuellen Liste`);\n        handleError(`Rolle mit ID ${editingRole.id} existiert nicht mehr. Bitte aktualisieren Sie die Seite.`, {\n          component: 'RoleManagementTab',\n          roleId: editingRole.id\n        });\n        setIsModalOpen(false);\n        // Rollen neu laden, um die Anzeige zu aktualisieren\n        await fetchRoles();\n        return;\n      }\n      \n      console.log(`DEBUGAUSGABE: Bearbeite Rolle mit ID ${editingRole.id}`);\n      \n      try {\n        console.log('DEBUGAUSGABE: Sende Aktualisierung an API:', {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        });\n        \n        const dataToSend = {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        };\n        \n        console.log('DEBUGAUSGABE: Vor dem API-Aufruf roleApi.update');\n        const response = await roleApi.update(editingRole.id, dataToSend);\n        console.log('DEBUGAUSGABE: Nach dem API-Aufruf roleApi.update');\n        console.log('DEBUGAUSGABE: API-Antwort bei Rollenaktualisierung:', response);\n        await fetchRoles();\n      } catch (updateError) {\n        console.error('DEBUGAUSGABE: Fehler bei Rollenaktualisierung:', updateError);\n        if (updateError.response) {\n          // Spezifischere Fehlerbehandlung\n          if (updateError.response.data.meta && updateError.response.data.meta.cause === \"Record to update not found.\") {\n            handleError('Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.', {\n              component: 'RoleManagementTab',\n              roleId: editingRole.id\n            });\n            setIsModalOpen(false);\n            // Rollenliste aktualisieren, um Frontend zu synchronisieren\n            await fetchRoles();\n          } else {\n            handleError(updateError.response.data.message || 'Fehler beim Aktualisieren der Rolle', {\n              component: 'RoleManagementTab',\n              roleId: editingRole.id\n            });\n          }\n        } else {\n          handleError('Fehler beim Aktualisieren der Rolle', {\n            component: 'RoleManagementTab',\n            roleId: editingRole.id\n          });\n        }\n        return;\n      }\n    } else {\n      // Erstellen einer neuen Rolle\n      try {\n        // Stelle sicher, dass die immer sichtbaren Seiten auch tatschlich auf 'both' gesetzt sind\n        const updatedPermissions = formData.permissions.map(permission => {\n          if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n            return { ...permission, accessLevel: 'both' };\n          }\n          return permission;\n        });\n        \n        // Filtere nur die relevanten Berechtigungen (nicht 'none')\n        const filteredPermissions = updatedPermissions\n          .filter(permission => permission.accessLevel !== 'none')\n          .map(permission => ({\n            entity: permission.entity,\n            entityType: permission.entityType,\n            accessLevel: permission.accessLevel\n          }));\n        \n        console.log('DEBUGAUSGABE: Sende Daten an API fr neue Rolle:', {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        });\n        \n        const dataToSend = {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        };\n        \n        console.log('DEBUGAUSGABE: Vor dem API-Aufruf roleApi.create');\n        const response = await roleApi.create(dataToSend);\n        console.log('DEBUGAUSGABE: Nach dem API-Aufruf roleApi.create');\n        console.log('DEBUGAUSGABE: API-Antwort beim Erstellen der Rolle:', response);\n        await fetchRoles();\n      } catch (createError) {\n        console.error('DEBUGAUSGABE: Fehler bei API-Anfrage zum Erstellen der Rolle:', createError);\n        if (createError.response) {\n          handleError(createError.response.data.message || 'Fehler beim Erstellen der Rolle', {\n            component: 'RoleManagementTab'\n          });\n        } else {\n          handleError('Fehler beim Erstellen der Rolle', {\n            component: 'RoleManagementTab'\n          });\n        }\n        return;\n      }\n    }\n    \n    if (onRolesChange) onRolesChange();\n    \n    setIsModalOpen(false);\n    resetForm();\n  };\n\n  // Lschen einer Rolle\n  const handleDelete = async (roleId: number) => {\n    if (!roleId || isNaN(roleId)) {\n      console.warn('Ungltige Rollen-ID erkannt, Lschvorgang abgebrochen');\n      handleError('Ungltige Rollen-ID, Lschvorgang abgebrochen', {\n        component: 'RoleManagementTab',\n        roleId: roleId\n      });\n      return;\n    }\n    \n    // Finde die Rolle in der Liste, um den Namen zu prfen\n    const role = roles.find(r => r.id === roleId);\n    \n    // berprfen, ob es sich um eine geschtzte Rolle handelt\n    if (role && isStandardRole(roleId, role.name)) {\n      console.warn(`Versuch, geschtzte Rolle mit ID ${roleId} (${role.name}) zu lschen`);\n      handleError('Geschtzte Systemrollen knnen nicht gelscht werden', {\n        component: 'RoleManagementTab',\n        roleId: roleId\n      });\n      return;\n    }\n    \n    if (!window.confirm('Mchten Sie diese Rolle wirklich lschen?')) return;\n    \n    try {\n      console.log(`Starte Lschvorgang fr Rolle mit ID ${roleId}`);\n      \n      // berprfen, ob die Rolle in der aktuellen Liste existiert\n      const roleExists = roles.some(r => r.id === roleId);\n      if (!roleExists) {\n        console.error(`Rolle mit ID ${roleId} existiert nicht in der aktuellen Liste`);\n        handleError(`Rolle mit ID ${roleId} existiert nicht mehr. Bitte aktualisieren Sie die Seite.`, {\n          component: 'RoleManagementTab',\n          roleId: roleId\n        });\n        // Rollen neu laden, um die Anzeige zu aktualisieren\n        await fetchRoles();\n        return;\n      }\n      \n      // Bei Mock-Daten lokales Lschen (wird nicht verwendet)\n      if (false) {\n        console.log('Lsche Mock-Rolle');\n        const updatedRoles = roles.filter(role => role.id !== roleId);\n        setRoles(updatedRoles);\n      } else {\n        console.log('Sende Lschanfrage an API');\n        \n        try {\n          const response = await roleApi.delete(roleId);\n          console.log('API-Antwort beim Lschen der Rolle:', response);\n          \n          // Nach erfolgreichem Lschen die Rollenliste aktualisieren\n          await fetchRoles();\n          console.log('Rollenliste nach Lschen aktualisiert');\n        } catch (deleteError) {\n          console.error('API-Fehler beim Lschen der Rolle:', deleteError);\n          \n          if (deleteError.response) {\n            console.error('API-Fehlerdaten:', deleteError.response.data);\n            \n            // Spezifischere Fehlerbehandlung\n            if (deleteError.response.data.meta && deleteError.response.data.meta.cause === \"Record to delete does not exist.\") {\n              handleError('Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.', {\n                component: 'RoleManagementTab',\n                roleId: roleId\n              });\n              // Rollenliste aktualisieren, um Frontend zu synchronisieren\n              await fetchRoles();\n            } else {\n              handleError(deleteError.response.data.message || t('roleManagement.deleteError'), {\n                component: 'RoleManagementTab',\n                roleId: roleId\n              });\n            }\n          } else {\n            handleError(t('roleManagement.networkError'), {\n              component: 'RoleManagementTab',\n              roleId: roleId\n            });\n          }\n          return;\n        }\n      }\n      \n      console.log('Rolle erfolgreich gelscht');\n      if (onRolesChange) onRolesChange();\n    } catch (err) {\n      console.error(t('roleManagement.unhandledError'), err);\n      handleError(err);\n      \n      // Bei einem unbehandelten Fehler trotzdem versuchen, die Rollenliste zu aktualisieren\n      try {\n        await fetchRoles();\n      } catch (refreshError) {\n        console.error('Fehler beim Aktualisieren der Rollenliste nach fehlgeschlagenem Lschvorgang:', refreshError);\n      }\n    }\n  };\n\n  // Kopieren einer Rolle (fr Standardrollen)\n  const handleCopyRole = async (role: Role) => {\n    try {\n      if (!role || !role.id) {\n        handleError('Ungltige Rolle zum Kopieren', {\n          component: 'RoleManagementTab'\n        });\n        return;\n      }\n\n      // Kopie der Rolle erstellen mit angepasstem Namen\n      const copiedRoleData = {\n        name: `${role.name}-Kopie`,\n        description: role.description || '',\n        permissions: role.permissions\n          .filter(permission => permission.accessLevel !== 'none')\n          .map(permission => ({\n            entity: permission.entity,\n            entityType: permission.entityType,\n            accessLevel: permission.accessLevel\n          }))\n      };\n\n      console.log('DEBUGAUSGABE: Kopiere Rolle:', role.name, 'mit Daten:', copiedRoleData);\n\n      // Rolle erstellen\n      const response = await roleApi.create(copiedRoleData);\n      console.log('DEBUGAUSGABE: Rolle erfolgreich kopiert:', response.data);\n\n      // Optimistisches Update: Neue Rolle zur Liste hinzufgen\n      setRoles(prevRoles => [response.data, ...prevRoles]);\n      \n      // Bearbeitungsmodal fr die kopierte Rolle ffnen\n      prepareRoleForEditing(response.data);\n      \n      if (onRolesChange) onRolesChange();\n    } catch (err) {\n      console.error('DEBUGAUSGABE: Fehler beim Kopieren der Rolle:', err);\n      handleError(err, {\n        component: 'RoleManagementTab',\n        roleId: role.id\n      });\n    }\n  };\n\n  // Rolle zum Bearbeiten vorbereiten\n  const prepareRoleForEditing = (role: Role) => {\n    // Verhindere das Bearbeiten von geschtzten Rollen\n    if (isStandardRole(role.id, role.name)) {\n      handleError('Geschtzte Systemrollen knnen nicht bearbeitet werden', {\n        component: 'RoleManagementTab',\n        roleId: role.id\n      });\n      return;\n    }\n    \n    // Alle mglichen Berechtigungen erstellen (Seiten, Tabellen und Buttons)\n    const allPermissions = [\n      ...defaultPages.map(page => ({\n        entity: page,\n        entityType: 'page',\n        // Fr die immer sichtbaren Seiten 'both' als Standard setzen\n        accessLevel: alwaysVisiblePages.includes(page) ? 'both' as AccessLevel : 'none' as AccessLevel\n      })),\n      ...defaultTables.map(table => ({\n        entity: table,\n        entityType: 'table',\n        accessLevel: 'none' as AccessLevel\n      })),\n      ...defaultButtons.map(button => ({\n        entity: button,\n        entityType: 'button',\n        accessLevel: 'none' as AccessLevel\n      }))\n    ];\n\n    // Vorhandene Berechtigungen bernehmen\n    role.permissions.forEach(permission => {\n      const existingPermIndex = allPermissions.findIndex(\n        p => p.entity === permission.entity && p.entityType === permission.entityType\n      );\n      \n      if (existingPermIndex !== -1) {\n        // Stelle sicher, dass alwaysVisiblePages immer 'both' als AccessLevel haben\n        if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n          allPermissions[existingPermIndex].accessLevel = 'both';\n        } else {\n          allPermissions[existingPermIndex].accessLevel = permission.accessLevel;\n        }\n      }\n    });\n\n    setFormData({\n      name: role.name,\n      description: role.description || '',\n      permissions: allPermissions\n    });\n    \n    setEditingRole(role);\n    setIsModalOpen(true);\n  };\n\n  // Formular fr neue Rolle zurcksetzen\n  const resetForm = () => {\n    setEditingRole(null);\n    setFormData({\n      name: '',\n      description: '',\n      permissions: [\n        // Seiten-Berechtigungen\n        ...defaultPages.map(page => ({\n          entity: page,\n          entityType: 'page',\n          // Fr die immer sichtbaren Seiten 'both' als Standard setzen\n          accessLevel: alwaysVisiblePages.includes(page) ? 'both' as AccessLevel : 'none' as AccessLevel\n        })),\n        // Tabellen-Berechtigungen\n        ...defaultTables.map(table => ({\n          entity: table,\n          entityType: 'table',\n          accessLevel: 'none' as AccessLevel\n        })),\n        // Button-Berechtigungen\n        ...defaultButtons.map(button => ({\n          entity: button,\n          entityType: 'button',\n          accessLevel: 'none' as AccessLevel\n        }))\n      ]\n    });\n  };\n\n  // Setzt alle Seitenberechtigungen (auer die immer sichtbaren) auf den gleichen Wert\n  const setAllPagePermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'page' && !alwaysVisiblePages.includes(p.entity))\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Setzt alle Tabellen-Berechtigungen auf den gleichen Wert\n  const setAllTablePermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'table')\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Setzt alle Button-Berechtigungen auf den gleichen Wert\n  const setAllButtonPermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'button')\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Funktion zum Zhlen der aktiven Filter\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  // Filtern und sortieren der Rollen\n  const filteredAndSortedRoles = useMemo(() => {\n    return roles\n      .filter(role => {\n        // Globale Suche\n        if (searchTerm) {\n          const searchLower = searchTerm.toLowerCase();\n          const matchesSearch = \n            role.name.toLowerCase().includes(searchLower) ||\n            (role.description && role.description.toLowerCase().includes(searchLower));\n          \n          if (!matchesSearch) return false;\n        }\n        \n        // Prfe erweiterte Filterbedingungen, wenn vorhanden\n        if (filterConditions.length > 0) {\n          // Implementiere die logische Verknpfung der Bedingungen (UND/ODER)\n          let result = filterConditions.length > 0;\n          \n          for (let i = 0; i < filterConditions.length; i++) {\n            const condition = filterConditions[i];\n            let conditionMet = false;\n            \n            switch (condition.column) {\n              case 'name':\n                if (condition.operator === 'equals') {\n                  conditionMet = role.name.toLowerCase() === (condition.value as string || '').toLowerCase();\n                } else if (condition.operator === 'contains') {\n                  conditionMet = role.name.toLowerCase().includes((condition.value as string || '').toLowerCase());\n                } else if (condition.operator === 'startsWith') {\n                  conditionMet = role.name.toLowerCase().startsWith((condition.value as string || '').toLowerCase());\n                }\n                break;\n              \n              case 'description':\n                if (!role.description) {\n                  conditionMet = false;\n                  break;\n                }\n                \n                if (condition.operator === 'equals') {\n                  conditionMet = role.description.toLowerCase() === (condition.value as string || '').toLowerCase();\n                } else if (condition.operator === 'contains') {\n                  conditionMet = role.description.toLowerCase().includes((condition.value as string || '').toLowerCase());\n                } else if (condition.operator === 'startsWith') {\n                  conditionMet = role.description.toLowerCase().startsWith((condition.value as string || '').toLowerCase());\n                }\n                break;\n              \n              case 'permissions':\n                // Vereinfachter Filter fr Berechtigungen - zhle die Anzahl der Berechtigungen mit dem angegebenen Level\n                const accessLevel = condition.value as AccessLevel;\n                const count = role.permissions.filter(p => p.accessLevel === accessLevel).length;\n                \n                if (condition.operator === 'greaterThan') {\n                  conditionMet = count > 0;\n                } else if (condition.operator === 'equals') {\n                  conditionMet = count > 0;\n                }\n                break;\n            }\n            \n            // Verknpfe das Ergebnis dieser Bedingung mit dem Gesamtergebnis\n            if (i === 0) {\n              result = conditionMet;\n            } else {\n              const operator = filterLogicalOperators[i - 1];\n              result = operator === 'AND' ? (result && conditionMet) : (result || conditionMet);\n            }\n          }\n          \n          if (!result) return false;\n        }\n        \n        return true;\n      })\n      .sort((a, b) => {\n        return a.name.localeCompare(b.name);\n      });\n  }, [roles, searchTerm, filterConditions, filterLogicalOperators]);\n\n  // Mobile Ansicht renderRoles-Funktion\n  const renderRoles = () => {\n    if (roles.length === 0) {\n      return (\n        <div className=\"p-4 bg-gray-50 rounded text-center\">\n          <p>Keine Rollen gefunden. Erstellen Sie eine neue Rolle mit dem Button oben.</p>\n        </div>\n      );\n    }\n    \n    if (isMobile) {\n      // Mobile Ansicht mit Karten\n      return (\n        <>\n          <div className=\"space-y-4\">\n            {filteredAndSortedRoles.slice(0, displayLimit).map((role) => (\n              <RoleCard \n                key={role.id} \n                role={role} \n                onEdit={prepareRoleForEditing}\n                onDelete={handleDelete}\n                onCopy={handleCopyRole}\n                canEdit={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canDelete={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canCopy={!readOnly && hasPermission('roles', 'write', 'table') && isStandardRole(role.id, role.name)}\n              />\n            ))}\n          </div>\n          \n          {/* \"Mehr anzeigen\" Button - Mobil */}\n          {filteredAndSortedRoles.length > displayLimit && (\n            <div className=\"mt-4 flex justify-center\">\n              <button\n                className=\"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                title={`Mehr anzeigen (${filteredAndSortedRoles.length - displayLimit} verbleibend)`}\n              >\n                <ChevronDownIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n          )}\n        </>\n      );\n    } else {\n      // Card-Ansicht fr grere Bildschirme\n      return (\n        <>\n          <div className=\"space-y-4\">\n            {filteredAndSortedRoles.slice(0, displayLimit).map((role) => (\n              <RoleCard \n                key={role.id} \n                role={role} \n                onEdit={prepareRoleForEditing}\n                onDelete={handleDelete}\n                onCopy={handleCopyRole}\n                canEdit={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canDelete={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canCopy={!readOnly && hasPermission('roles', 'write', 'table') && isStandardRole(role.id, role.name)}\n              />\n            ))}\n          </div>\n          \n          {/* \"Mehr anzeigen\" Button - Desktop */}\n          {filteredAndSortedRoles.length > displayLimit && (\n            <div className=\"mt-4 flex justify-center\">\n              <button\n                className=\"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                title={`Mehr anzeigen (${filteredAndSortedRoles.length - displayLimit} verbleibend)`}\n              >\n                <ChevronDownIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n          )}\n        </>\n      );\n    }\n  };\n\n  // Standard-Filter erstellen und speichern\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(ROLES_TABLE_ID)\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        const alleFilterExists = existingFilters.some(filter => filter.name === 'Alle');\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: ROLES_TABLE_ID,\n            name: 'Alle',\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\n            alleFilter\n          );\n          console.log('Alle-Filter fr Rollen erstellt');\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []);\n\n  // Initialer Default-Filter setzen (Controlled Mode)\n  useEffect(() => {\n    const setInitialFilter = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(ROLES_TABLE_ID));\n        const filters = response.data;\n        \n        const alleFilter = filters.find((filter: any) => filter.name === 'Alle');\n        if (alleFilter) {\n          setActiveFilterName('Alle');\n          setSelectedFilterId(alleFilter.id);\n          applyFilterConditions(alleFilter.conditions, alleFilter.operators);\n        }\n      } catch (error) {\n        console.error('Fehler beim Setzen des initialen Filters:', error);\n      }\n    };\n\n    setInitialFilter();\n  }, []);\n\n  // Funktion zum Anwenden von Filterbedingungen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n  \n  // Funktion zum Zurcksetzen der Filter\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n  \n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  return (\n    <div>\n      {/* Spaltenanzeige und Suche */}\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          {/* Linke Seite: \"Neue Rolle erstellen\"-Button */}\n          <div className=\"flex items-center\">\n            {!readOnly && hasPermission('roles', 'write', 'table') && (\n              <button\n                onClick={() => setIsModalOpen(true)}\n                className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                style={{ width: '30.19px', height: '30.19px' }}\n                title={t('roles.createRole')}\n                aria-label={t('roles.createRole')}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n              </button>\n            )}\n          </div>\n          \n          {/* Mitte: Titel - Kein Titel in der Mitte notwendig bei dieser Komponente, da der Tab-Header bereits den Titel zeigt */}\n          <div></div>\n          \n          {/* Rechte Seite: Suchfeld, Filter-Button, Spalten-Konfiguration */}\n          <div className=\"flex items-center gap-1.5\">\n            <input\n              type=\"text\"\n              placeholder=\"Suchen...\"\n              className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n            <button\n              className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100'} ml-1 relative`}\n              onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n              title=\"Filter\"\n            >\n              <FunnelIcon className=\"w-5 h-5\" />\n              {getActiveFilterCount() > 0 && (\n                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                  {getActiveFilterCount()}\n                </span>\n              )}\n            </button>\n          </div>\n        </div>\n\n        {/* Filter-Modal */}\n        {isFilterModalOpen && (\n          <FilterPane\n            columns={[\n              { id: 'name', label: 'Name' },\n              { id: 'description', label: 'Beschreibung' },\n              { id: 'permissions', label: 'Berechtigungen' }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={ROLES_TABLE_ID}\n          />\n        )}\n        \n        {/* Gespeicherte Filter als Tags anzeigen */}\n        <SavedFilterTags\n          tableId={ROLES_TABLE_ID}\n          onSelectFilter={applyFilterConditions}\n          onReset={resetFilterConditions}\n          activeFilterName={activeFilterName}\n          selectedFilterId={selectedFilterId}\n          onFilterChange={handleFilterChange}\n          defaultFilterName=\"Alle\"\n        />\n\n        {loading ? (\n          <div className=\"flex justify-center items-center py-8\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n          </div>\n        ) : (\n          renderRoles()\n        )}\n      </div>\n\n      {/* Modal/Sidepane fr Rollenerstellung/Bearbeitung */}\n      {isModalOpen && (\n        <>\n          {/* Mobile (unter 640px) - Modal */}\n          {isMobile ? (\n            <Dialog open={isModalOpen} onClose={() => setIsModalOpen(false)} className=\"relative z-50\">\n              <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n              \n              <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden\">\n                  {/* Header */}\n                  <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <div className=\"flex items-center justify-between\">\n                      <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                        {editingRole ? t('roles.editRole') : t('roles.createRole')}\n                      </Dialog.Title>\n                      <button\n                        onClick={() => setIsModalOpen(false)}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                      >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                      </button>\n                    </div>\n                  </div>\n                  \n                  {/* Form */}\n                  <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\n                    {/* Content - scrollbarer Bereich */}\n                    <div className=\"flex-1 overflow-y-auto min-h-0\">\n                      <div className=\"p-6 space-y-5\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Name</label>\n                  <input\n                    type=\"text\"\n                    value={formData.name}\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    required\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Beschreibung</label>\n                  <input\n                    type=\"text\"\n                    value={formData.description}\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n                  </div>\n                  \n                  <div className=\"mt-2\">\n                    <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.detailedPermissions')}</label>\n                        {/* Bulk Actions - kompakt integriert */}\n                        <div className=\"flex flex-wrap items-center gap-1.5\">\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllPagePermissions('both')}\n                            className=\"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800\"\n                            title={t('roles.form.activateAllPages')}\n                          >\n                            {t('roles.form.pagesChecked')}\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllPagePermissions('none')}\n                            className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            title={t('roles.form.deactivateAllPages')}\n                          >\n                            {t('roles.form.pagesUnchecked')}\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllTablePermissions('both')}\n                            className=\"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800\"\n                            title={t('roles.form.activateAllTables')}\n                          >\n                            {t('roles.form.tablesChecked')}\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllTablePermissions('none')}\n                            className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            title={t('roles.form.deactivateAllTables')}\n                          >\n                            {t('roles.form.tablesUnchecked')}\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllButtonPermissions('both')}\n                            className=\"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800\"\n                            title={t('roles.form.activateAllButtons')}\n                          >\n                            {t('roles.form.buttonsChecked')}\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllButtonPermissions('none')}\n                            className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            title={t('roles.form.deactivateAllButtons')}\n                          >\n                            {t('roles.form.buttonsUnchecked')}\n                          </button>\n                        </div>\n                    </div>\n                    \n                    <div className=\"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600\">\n                    {formData.permissions\n                      .filter(permission => \n                        permission.entityType === 'page'\n                      )\n                      .map((permission, index) => {\n                        const permIndex = formData.permissions.indexOf(permission);\n                        const isActive = permission.accessLevel === 'both';\n                        return (\n                          <div key={`permission-page-${permission.entity}-${index}`}>\n                            <div className=\"flex items-center justify-between\">\n                              <span className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">{pageDisplayNames[permission.entity] || permission.entity}</span>\n                              <label className={`inline-flex items-center ${alwaysVisiblePages.includes(permission.entity) ? 'cursor-not-allowed opacity-80' : 'cursor-pointer'}`}>\n                                <input\n                                  type=\"checkbox\"\n                                  className=\"sr-only peer\"\n                                  checked={isActive}\n                                  disabled={alwaysVisiblePages.includes(permission.entity)}\n                                  onChange={() => {\n                                    const newPermissions = [...formData.permissions];\n                                    newPermissions[permIndex] = {\n                                      ...permission,\n                                      accessLevel: isActive ? 'none' : 'both'\n                                    };\n                                    setFormData({ ...formData, permissions: newPermissions });\n                                  }}\n                                />\n                                <div className={`relative w-11 h-6 ${alwaysVisiblePages.includes(permission.entity) ? 'bg-blue-600 dark:bg-blue-700' : 'bg-gray-200 dark:bg-gray-700'} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700`}>\n                                  {alwaysVisiblePages.includes(permission.entity) && (\n                                    <span className=\"absolute inset-0 flex items-center justify-center text-xs text-white font-medium\">\n                                      Fix\n                                    </span>\n                                  )}\n                                </div>\n                              </label>\n                            </div>\n                            \n                            {/* Tabellen-Berechtigungen mit zugehrigen Buttons gruppiert */}\n                            {formData.permissions\n                              .filter(tablePerm => \n                                tablePerm.entityType === 'table' && \n                                tableToPageMapping[tablePerm.entity] === permission.entity\n                              )\n                              .sort((a, b) => {\n                                const aName = tableDisplayNames[a.entity] || a.entity;\n                                const bName = tableDisplayNames[b.entity] || b.entity;\n                                // Sortierung: users, roles, organization zuerst (in dieser Reihenfolge)\n                                const priorityOrder = ['users', 'roles', 'organization'];\n                                const aIndex = priorityOrder.indexOf(a.entity);\n                                const bIndex = priorityOrder.indexOf(b.entity);\n                                if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                if (aIndex !== -1) return -1;\n                                if (bIndex !== -1) return 1;\n                                return aName.localeCompare(bName);\n                              })\n                              .map((tablePerm, tableIndex) => {\n                                const tablePermIndex = formData.permissions.indexOf(tablePerm);\n                                const isTableActive = tablePerm.accessLevel === 'both';\n                                const tableEntity = tablePerm.entity;\n                                const tableDisplayName = tableDisplayNames[tableEntity] || tableEntity;\n                                \n                                // Finde alle Buttons, die zu dieser Tabelle gehren\n                                // Filtere Duplikate: task_* und todo_* sind dasselbe, nur task_* behalten\n                                const relatedButtons = formData.permissions\n                                  .filter(buttonPerm => \n                                    buttonPerm.entityType === 'button' && \n                                    buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                    buttonToTableMapping[buttonPerm.entity] === tableEntity &&\n                                    // Entferne todo_* Buttons wenn task_* existiert (sind dasselbe)\n                                    !(tableEntity === 'tasks' && buttonPerm.entity.startsWith('todo_'))\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = buttonDisplayNames[a.entity] || a.entity;\n                                    const bName = buttonDisplayNames[b.entity] || b.entity;\n                                    // Logische Reihenfolge: Start, Stop, Erstellen, Bearbeiten, Lschen, dann alphabetisch\n                                    const order = [\n                                      t('roleManagement.buttonOrder.start'),\n                                      t('roleManagement.buttonOrder.stop'),\n                                      t('roleManagement.buttonOrder.create'),\n                                      t('roleManagement.buttonOrder.edit'),\n                                      t('roleManagement.buttonOrder.delete')\n                                    ];\n                                    const aIndex = order.indexOf(aName);\n                                    const bIndex = order.indexOf(bName);\n                                    if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                    if (aIndex !== -1) return -1;\n                                    if (bIndex !== -1) return 1;\n                                    return aName.localeCompare(bName);\n                                  });\n                                \n                                return (\n                                  <div key={`table-permission-${tableEntity}-${tableIndex}`} className=\"mt-3\">\n                                    {/* Tabelle selbst */}\n                                    <div className=\"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600\">\n                                      <span className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\"> {tableDisplayName}</span>\n                                      <label className=\"inline-flex items-center cursor-pointer\">\n                                        <input\n                                          type=\"checkbox\"\n                                          className=\"sr-only peer\"\n                                          checked={isTableActive}\n                                          onChange={() => {\n                                            const newPermissions = [...formData.permissions];\n                                            newPermissions[tablePermIndex] = {\n                                              ...tablePerm,\n                                              accessLevel: isTableActive ? 'none' : 'both'\n                                            };\n                                            setFormData({ ...formData, permissions: newPermissions });\n                                          }}\n                                        />\n                                        <div className=\"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                        </div>\n                                      </label>\n                                    </div>\n                                    \n                                    {/* Zu dieser Tabelle gehrige Buttons */}\n                                    {relatedButtons.map((buttonPerm, buttonIndex) => {\n                                      const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                      const isButtonActive = buttonPerm.accessLevel === 'both';\n                                      const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                      return (\n                                        <div key={`button-permission-${buttonPerm.entity}-${buttonIndex}`} \n                                          className=\"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600\">\n                                          <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                          <label className=\"inline-flex items-center cursor-pointer\">\n                                            <input\n                                              type=\"checkbox\"\n                                              className=\"sr-only peer\"\n                                              checked={isButtonActive}\n                                              onChange={() => {\n                                                const newPermissions = [...formData.permissions];\n                                                newPermissions[buttonPermIndex] = {\n                                                  ...buttonPerm,\n                                                  accessLevel: isButtonActive ? 'none' : 'both'\n                                                };\n                                                setFormData({ ...formData, permissions: newPermissions });\n                                              }}\n                                            />\n                                            <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                            </div>\n                                          </label>\n                                        </div>\n                                      );\n                                    })}\n                                  </div>\n                                );\n                              })\n                            }\n                              \n                              {/* Button-Berechtigungen ohne Tabelle-Zuordnung (am Ende) */}\n                              {formData.permissions\n                                .filter(buttonPerm => \n                                  buttonPerm.entityType === 'button' && \n                                  buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                  !buttonToTableMapping[buttonPerm.entity]\n                                )\n                                .sort((a, b) => {\n                                  const aName = buttonDisplayNames[a.entity] || a.entity;\n                                  const bName = buttonDisplayNames[b.entity] || b.entity;\n                                  return aName.localeCompare(bName);\n                                })\n                                .map((buttonPerm, buttonIndex) => {\n                                  const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                  const isButtonActive = buttonPerm.accessLevel === 'both';\n                                  const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                  return (\n                                    <div key={`button-permission-${buttonPerm.entity}-${buttonIndex}`} \n                                      className=\"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600\">\n                                      <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                      <label className=\"inline-flex items-center cursor-pointer\">\n                                        <input\n                                          type=\"checkbox\"\n                                          className=\"sr-only peer\"\n                                          checked={isButtonActive}\n                                          onChange={() => {\n                                            const newPermissions = [...formData.permissions];\n                                            newPermissions[buttonPermIndex] = {\n                                              ...buttonPerm,\n                                              accessLevel: isButtonActive ? 'none' : 'both'\n                                            };\n                                            setFormData({ ...formData, permissions: newPermissions });\n                                          }}\n                                        />\n                                        <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                        </div>\n                                      </label>\n                          </div>\n                        );\n                      })\n                    }\n                            </div>\n                          );\n                        })\n                      }\n                    </div>\n                  </div>\n                    </div>\n                  </div>\n                  \n                  {/* Footer */}\n                  <div className=\"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-end gap-2 border-t dark:border-gray-600 flex-shrink-0\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setIsModalOpen(false)}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                      title=\"Abbrechen\"\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      type=\"submit\"\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                      title={editingRole ? 'Aktualisieren' : 'Erstellen'}\n                    >\n                      <CheckIcon className=\"h-5 w-5\" />\n                    </button>\n                  </div>\n                </form>\n              </Dialog.Panel>\n            </div>\n          </Dialog>\n          ) : (\n            /* Desktop (ab 640px) - Sidepane */\n            /* WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition */\n            <>\n              {/* Backdrop - nur wenn offen und <= 1070px */}\n              {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n              {isModalOpen && !isLargeScreen && (\n                <div \n                  className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                  aria-hidden=\"true\" \n                  style={{\n                    opacity: isModalOpen ? 1 : 0,\n                    transition: 'opacity 300ms ease-out'\n                  }}\n                />\n              )}\n              \n              {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n              <div \n                className={`fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isModalOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                  transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                  pointerEvents: isModalOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isModalOpen}\n                role=\"dialog\"\n                aria-modal={isModalOpen}\n              >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                  <h2 className=\"text-lg font-semibold dark:text-white\">\n                    {editingRole ? 'Rolle bearbeiten' : 'Neue Rolle erstellen'}\n                  </h2>\n                  <button\n                    onClick={() => setIsModalOpen(false)}\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                  <form onSubmit={handleSubmit} className=\"space-y-5\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.name')}</label>\n                        <input\n                          type=\"text\"\n                          value={formData.name}\n                          onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                          className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.description')}</label>\n                        <input\n                          type=\"text\"\n                          value={formData.description}\n                          onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                          className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                        />\n                      </div>\n                    </div>\n                    \n                    <div className=\"mt-2\">\n                      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Detaillierte Berechtigungen</label>\n                        {/* Bulk Actions */}\n                        <div className=\"flex flex-wrap items-center gap-1.5\">\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllPagePermissions('both')}\n                            className=\"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800\"\n                            title=\"Alle Seiten aktivieren\"\n                          >\n                            Seiten \n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllPagePermissions('none')}\n                            className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            title=\"Alle Seiten deaktivieren\"\n                          >\n                            Seiten \n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllTablePermissions('both')}\n                            className=\"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800\"\n                            title=\"Alle Tabellen aktivieren\"\n                          >\n                            Tabellen \n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllTablePermissions('none')}\n                            className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            title=\"Alle Tabellen deaktivieren\"\n                          >\n                            Tabellen \n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllButtonPermissions('both')}\n                            className=\"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800\"\n                            title=\"Alle Buttons aktivieren\"\n                          >\n                            Buttons \n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => setAllButtonPermissions('none')}\n                            className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            title=\"Alle Buttons deaktivieren\"\n                          >\n                            Buttons \n                          </button>\n                        </div>\n                      </div>\n                      \n                      <div className=\"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600 max-h-[60vh]\">\n                        {formData.permissions\n                          .filter(permission => \n                            permission.entityType === 'page'\n                          )\n                          .map((permission, index) => {\n                            const permIndex = formData.permissions.indexOf(permission);\n                            const isActive = permission.accessLevel === 'both';\n                            return (\n                              <div key={`permission-page-desktop-${permission.entity}-${index}`}>\n                                <div className=\"flex items-center justify-between\">\n                                  <span className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">{pageDisplayNames[permission.entity] || permission.entity}</span>\n                                  <label className={`inline-flex items-center ${alwaysVisiblePages.includes(permission.entity) ? 'cursor-not-allowed opacity-80' : 'cursor-pointer'}`}>\n                                    <input\n                                      type=\"checkbox\"\n                                      className=\"sr-only peer\"\n                                      checked={isActive}\n                                      disabled={alwaysVisiblePages.includes(permission.entity)}\n                                      onChange={() => {\n                                        const newPermissions = [...formData.permissions];\n                                        newPermissions[permIndex] = {\n                                          ...permission,\n                                          accessLevel: isActive ? 'none' : 'both'\n                                        };\n                                        setFormData({ ...formData, permissions: newPermissions });\n                                      }}\n                                    />\n                                    <div className={`relative w-11 h-6 ${alwaysVisiblePages.includes(permission.entity) ? 'bg-blue-600 dark:bg-blue-700' : 'bg-gray-200 dark:bg-gray-700'} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700`}>\n                                      {alwaysVisiblePages.includes(permission.entity) && (\n                                        <span className=\"absolute inset-0 flex items-center justify-center text-xs text-white font-medium\">\n                                          Fix\n                                        </span>\n                                      )}\n                                    </div>\n                                  </label>\n                                </div>\n                                \n                                {/* Tabellen-Berechtigungen mit zugehrigen Buttons gruppiert */}\n                                {formData.permissions\n                                  .filter(tablePerm => \n                                    tablePerm.entityType === 'table' && \n                                    tableToPageMapping[tablePerm.entity] === permission.entity\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = tableDisplayNames[a.entity] || a.entity;\n                                    const bName = tableDisplayNames[b.entity] || b.entity;\n                                    return aName.localeCompare(bName);\n                                  })\n                                  .map((tablePerm, tableIndex) => {\n                                    const tablePermIndex = formData.permissions.indexOf(tablePerm);\n                                    const isTableActive = tablePerm.accessLevel === 'both';\n                                    const tableEntity = tablePerm.entity;\n                                    const tableDisplayName = tableDisplayNames[tableEntity] || tableEntity;\n                                    \n                                    // Finde alle Buttons, die zu dieser Tabelle gehren\n                                    const relatedButtons = formData.permissions\n                                      .filter(buttonPerm => \n                                        buttonPerm.entityType === 'button' && \n                                        buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                        buttonToTableMapping[buttonPerm.entity] === tableEntity &&\n                                        !(tableEntity === 'tasks' && buttonPerm.entity.startsWith('todo_'))\n                                      )\n                                      .sort((a, b) => {\n                                        const aName = buttonDisplayNames[a.entity] || a.entity;\n                                        const bName = buttonDisplayNames[b.entity] || b.entity;\n                                        const order = [\n                                      t('roleManagement.buttonOrder.start'),\n                                      t('roleManagement.buttonOrder.stop'),\n                                      t('roleManagement.buttonOrder.create'),\n                                      t('roleManagement.buttonOrder.edit'),\n                                      t('roleManagement.buttonOrder.delete')\n                                    ];\n                                        const aIndex = order.indexOf(aName);\n                                        const bIndex = order.indexOf(bName);\n                                        if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                        if (aIndex !== -1) return -1;\n                                        if (bIndex !== -1) return 1;\n                                        return aName.localeCompare(bName);\n                                      });\n                                    \n                                    return (\n                                      <div key={`table-permission-desktop-${tableEntity}-${tableIndex}`} className=\"mt-3\">\n                                        {/* Tabelle selbst */}\n                                        <div className=\"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600\">\n                                          <span className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\"> {tableDisplayName}</span>\n                                          <label className=\"inline-flex items-center cursor-pointer\">\n                                            <input\n                                              type=\"checkbox\"\n                                              className=\"sr-only peer\"\n                                              checked={isTableActive}\n                                              onChange={() => {\n                                                const newPermissions = [...formData.permissions];\n                                                newPermissions[tablePermIndex] = {\n                                                  ...tablePerm,\n                                                  accessLevel: isTableActive ? 'none' : 'both'\n                                                };\n                                                setFormData({ ...formData, permissions: newPermissions });\n                                              }}\n                                            />\n                                            <div className=\"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                            </div>\n                                          </label>\n                                        </div>\n                                        \n                                        {/* Zu dieser Tabelle gehrige Buttons */}\n                                        {relatedButtons.map((buttonPerm, buttonIndex) => {\n                                          const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                          const isButtonActive = buttonPerm.accessLevel === 'both';\n                                          const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                          return (\n                                            <div key={`button-permission-desktop-${buttonPerm.entity}-${buttonIndex}`} \n                                              className=\"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600\">\n                                              <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                              <label className=\"inline-flex items-center cursor-pointer\">\n                                                <input\n                                                  type=\"checkbox\"\n                                                  className=\"sr-only peer\"\n                                                  checked={isButtonActive}\n                                                  onChange={() => {\n                                                    const newPermissions = [...formData.permissions];\n                                                    newPermissions[buttonPermIndex] = {\n                                                      ...buttonPerm,\n                                                      accessLevel: isButtonActive ? 'none' : 'both'\n                                                    };\n                                                    setFormData({ ...formData, permissions: newPermissions });\n                                                  }}\n                                                />\n                                                <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                                </div>\n                                              </label>\n                                            </div>\n                                          );\n                                        })}\n                                      </div>\n                                    );\n                                  })\n                                }\n                                  \n                                {/* Button-Berechtigungen ohne Tabelle-Zuordnung (am Ende) */}\n                                {formData.permissions\n                                  .filter(buttonPerm => \n                                    buttonPerm.entityType === 'button' && \n                                    buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                    !buttonToTableMapping[buttonPerm.entity]\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = buttonDisplayNames[a.entity] || a.entity;\n                                    const bName = buttonDisplayNames[b.entity] || b.entity;\n                                    return aName.localeCompare(bName);\n                                  })\n                                  .map((buttonPerm, buttonIndex) => {\n                                    const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                    const isButtonActive = buttonPerm.accessLevel === 'both';\n                                    const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                    return (\n                                      <div key={`button-permission-desktop-${buttonPerm.entity}-${buttonIndex}`} \n                                        className=\"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600\">\n                                        <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                        <label className=\"inline-flex items-center cursor-pointer\">\n                                          <input\n                                            type=\"checkbox\"\n                                            className=\"sr-only peer\"\n                                            checked={isButtonActive}\n                                            onChange={() => {\n                                              const newPermissions = [...formData.permissions];\n                                              newPermissions[buttonPermIndex] = {\n                                                ...buttonPerm,\n                                                accessLevel: isButtonActive ? 'none' : 'both'\n                                              };\n                                              setFormData({ ...formData, permissions: newPermissions });\n                                            }}\n                                          />\n                                          <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                          </div>\n                                        </label>\n                                      </div>\n                                    );\n                                  })\n                                }\n                              </div>\n                            );\n                          })\n                        }\n                      </div>\n                    </div>\n\n                    {/* Buttons */}\n                    <div className=\"flex justify-end pt-4 gap-2\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setIsModalOpen(false)}\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                        title=\"Abbrechen\"\n                      >\n                        <XMarkIcon className=\"h-5 w-5\" />\n                      </button>\n                      <button\n                        type=\"submit\"\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                        title={editingRole ? 'Aktualisieren' : 'Erstellen'}\n                      >\n                        <CheckIcon className=\"h-5 w-5\" />\n                      </button>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default RoleManagementTab; ","import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { PencilIcon, TrashIcon, PlusIcon, XMarkIcon, CheckIcon, FunnelIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface BranchManagementTabProps {\n    onError: (error: string) => void;\n}\n\n// BranchCard-Komponente fr mobile und Desktop-Ansicht\nconst BranchCard: React.FC<{\n    branch: Branch;\n    onEdit: (branch: Branch) => void;\n    onDelete: (branchId: number) => void;\n    canEdit: boolean;\n    canDelete: boolean;\n}> = ({ branch, onEdit, onDelete, canEdit, canDelete }) => {\n    const { t } = useTranslation();\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4 mb-4\">\n            {/* Header mit Branchname und Aktionen */}\n            <div className=\"flex justify-between items-start mb-2\">\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{branch.name}</h3>\n                \n                <div className=\"flex space-x-2\">\n                    {canEdit && (\n                        <button\n                            onClick={() => onEdit(branch)}\n                            className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                            title={t('common.edit', { defaultValue: 'Bearbeiten' })}\n                        >\n                            <PencilIcon className=\"h-5 w-5\" />\n                        </button>\n                    )}\n                    \n                    {canDelete && (\n                        <button\n                            onClick={() => onDelete(branch.id)}\n                            className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n                            title={t('common.delete', { defaultValue: 'Lschen' })}\n                        >\n                            <TrashIcon className=\"h-5 w-5\" />\n                        </button>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\n// TableID fr gespeicherte Filter\nconst BRANCHES_TABLE_ID = 'branches-table';\n\nconst BranchManagementTab: React.FC<BranchManagementTabProps> = ({ onError }) => {\n    const { t } = useTranslation();\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [editingBranch, setEditingBranch] = useState<Branch | null>(null);\n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [formData, setFormData] = useState({ name: '' });\n    const [searchTerm, setSearchTerm] = useState('');\n    const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n    const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n    const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [activeFilterName, setActiveFilterName] = useState<string>('');\n    const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n    const [displayLimit, setDisplayLimit] = useState(10);\n    const { hasPermission } = usePermissions();\n    const { openSidepane, closeSidepane } = useSidepane();\n\n    // Berechtigungen prfen\n    const canCreate = hasPermission('branches', 'write', 'table');\n    const canEdit = hasPermission('branches', 'write', 'table');\n    const canDelete = hasPermission('branches', 'write', 'table');\n\n    // Branches laden\n    const fetchBranches = useCallback(async () => {\n        setLoading(true);\n        try {\n            const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n            setBranches(response.data);\n        } catch (error: any) {\n            console.error('Fehler beim Laden der Niederlassungen:', error);\n            const errorMessage = error.response?.data?.message || t('branches.loadError');\n            onError(errorMessage);\n        } finally {\n            setLoading(false);\n        }\n    }, [onError]);\n\n    useEffect(() => {\n        fetchBranches();\n    }, [fetchBranches]);\n\n    // Sidepane ffnen/schlieen basierend auf Modal-Status\n    useEffect(() => {\n        if (isModalOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isModalOpen, openSidepane, closeSidepane]);\n\n    // Formular zurcksetzen\n    const resetForm = () => {\n        setFormData({ name: '' });\n        setEditingBranch(null);\n    };\n\n    // Modal ffnen fr neue Branch\n    const handleCreate = () => {\n        resetForm();\n        setIsModalOpen(true);\n    };\n\n    // Modal ffnen fr Bearbeitung\n    const handleEdit = (branch: Branch) => {\n        setEditingBranch(branch);\n        setFormData({ name: branch.name });\n        setIsModalOpen(true);\n    };\n\n    // Modal schlieen\n    const handleCloseModal = () => {\n        setIsModalOpen(false);\n        resetForm();\n    };\n\n    // Formular absenden\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        \n        if (!formData.name.trim()) {\n            onError(t('branches.nameRequired'));\n            return;\n        }\n\n        try {\n            if (editingBranch) {\n                // Branch aktualisieren\n                await axiosInstance.put(API_ENDPOINTS.BRANCHES.UPDATE(editingBranch.id), {\n                    name: formData.name.trim()\n                });\n            } else {\n                // Neue Branch erstellen\n                await axiosInstance.post(API_ENDPOINTS.BRANCHES.CREATE, {\n                    name: formData.name.trim()\n                });\n            }\n            \n            await fetchBranches();\n            handleCloseModal();\n        } catch (error: any) {\n            console.error('Fehler beim Speichern der Niederlassung:', error);\n            const errorMessage = error.response?.data?.message || t('branches.saveError');\n            onError(errorMessage);\n        }\n    };\n\n    // Branch lschen\n    const handleDelete = async (branchId: number) => {\n        if (!window.confirm(t('branches.deleteConfirm', { defaultValue: 'Mchten Sie diese Niederlassung wirklich lschen?' }))) {\n            return;\n        }\n\n        try {\n            await axiosInstance.delete(API_ENDPOINTS.BRANCHES.DELETE(branchId));\n            await fetchBranches();\n        } catch (error: any) {\n            console.error('Fehler beim Lschen der Niederlassung:', error);\n            const errorMessage = error.response?.data?.message || t('branches.deleteError');\n            onError(errorMessage);\n        }\n    };\n\n    // Funktion zum Zhlen der aktiven Filter\n    const getActiveFilterCount = () => {\n        return filterConditions.length;\n    };\n\n    // Filtern und sortieren der Branches\n    const filteredAndSortedBranches = useMemo(() => {\n        return branches\n            .filter(branch => {\n                // Globale Suche\n                if (searchTerm) {\n                    const searchLower = searchTerm.toLowerCase();\n                    const matchesSearch = branch.name.toLowerCase().includes(searchLower);\n                    \n                    if (!matchesSearch) return false;\n                }\n                \n                // Prfe erweiterte Filterbedingungen, wenn vorhanden\n                if (filterConditions.length > 0) {\n                    let result = filterConditions.length > 0;\n                    \n                    for (let i = 0; i < filterConditions.length; i++) {\n                        const condition = filterConditions[i];\n                        let conditionMet = false;\n                        \n                        switch (condition.column) {\n                            case 'name':\n                                if (condition.operator === 'equals') {\n                                    conditionMet = branch.name.toLowerCase() === (condition.value as string || '').toLowerCase();\n                                } else if (condition.operator === 'contains') {\n                                    conditionMet = branch.name.toLowerCase().includes((condition.value as string || '').toLowerCase());\n                                } else if (condition.operator === 'startsWith') {\n                                    conditionMet = branch.name.toLowerCase().startsWith((condition.value as string || '').toLowerCase());\n                                }\n                                break;\n                        }\n                        \n                        // Verknpfe das Ergebnis dieser Bedingung mit dem Gesamtergebnis\n                        if (i === 0) {\n                            result = conditionMet;\n                        } else {\n                            const operator = filterLogicalOperators[i - 1];\n                            result = operator === 'AND' ? (result && conditionMet) : (result || conditionMet);\n                        }\n                    }\n                    \n                    if (!result) return false;\n                }\n                \n                return true;\n            })\n            .sort((a, b) => {\n                return a.name.localeCompare(b.name);\n            });\n    }, [branches, searchTerm, filterConditions, filterLogicalOperators]);\n\n    // Funktion zum Anwenden von Filterbedingungen\n    const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setFilterConditions(conditions);\n        setFilterLogicalOperators(operators);\n    };\n    \n    // Funktion zum Zurcksetzen der Filter\n    const resetFilterConditions = () => {\n        setFilterConditions([]);\n        setFilterLogicalOperators([]);\n        setActiveFilterName('');\n        setSelectedFilterId(null);\n    };\n    \n    // Filter Change Handler (Controlled Mode)\n    const handleFilterChange = (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setActiveFilterName(name);\n        setSelectedFilterId(id);\n        applyFilterConditions(conditions, operators);\n    };\n\n    // Standard-Filter erstellen und speichern\n    useEffect(() => {\n        const createStandardFilters = async () => {\n            try {\n                const token = localStorage.getItem('token');\n                \n                if (!token) {\n                    console.error(t('common.notAuthenticated'));\n                    return;\n                }\n\n                // Prfen, ob die Standard-Filter bereits existieren\n                const existingFiltersResponse = await axiosInstance.get(\n                    API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(BRANCHES_TABLE_ID)\n                );\n\n                const existingFilters = existingFiltersResponse.data || [];\n                const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\n\n                // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n                if (!alleFilterExists) {\n                    const alleFilter = {\n                        tableId: BRANCHES_TABLE_ID,\n                        name: 'Alle',\n                        conditions: [],\n                        operators: []\n                    };\n\n                    await axiosInstance.post(\n                        API_ENDPOINTS.SAVED_FILTERS.BASE,\n                        alleFilter\n                    );\n                    console.log(t('branches.filterCreated'));\n                }\n            } catch (error) {\n                console.error(t('branches.createStandardFiltersError'), error);\n            }\n        };\n\n        createStandardFilters();\n    }, []);\n\n    // Initialer Default-Filter setzen (Controlled Mode)\n    useEffect(() => {\n        const setInitialFilter = async () => {\n            try {\n                const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(BRANCHES_TABLE_ID));\n                const filters = response.data;\n                \n                const alleFilter = filters.find((filter: any) => filter.name === 'Alle');\n                if (alleFilter) {\n                    setActiveFilterName('Alle');\n                    setSelectedFilterId(alleFilter.id);\n                    applyFilterConditions(alleFilter.conditions, alleFilter.operators);\n                }\n            } catch (error) {\n                console.error(t('branches.setInitialFilterError'), error);\n            }\n        };\n\n        setInitialFilter();\n    }, []);\n\n    // Branches rendern\n    const renderBranches = () => {\n        if (filteredAndSortedBranches.length === 0) {\n            return (\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded text-center\">\n                    <p className=\"text-gray-600 dark:text-gray-400\">\n                        {t('branches.noBranches', { defaultValue: 'Keine Niederlassungen gefunden. Erstellen Sie eine neue Niederlassung mit dem Button oben.' })}\n                    </p>\n                </div>\n            );\n        }\n        \n        // Card-Ansicht\n        return (\n            <>\n                <div className=\"space-y-4\">\n                    {filteredAndSortedBranches.slice(0, displayLimit).map((branch) => (\n                        <BranchCard \n                            key={branch.id} \n                            branch={branch} \n                            onEdit={handleEdit}\n                            onDelete={handleDelete}\n                            canEdit={canEdit}\n                            canDelete={canDelete}\n                        />\n                    ))}\n                </div>\n                \n                {/* \"Mehr anzeigen\" Button */}\n                {filteredAndSortedBranches.length > displayLimit && (\n                    <div className=\"mt-4 flex justify-center\">\n                        <button\n                            className=\"px-4 py-2 text-sm font-medium text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                            onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                        >\n                            {t('common.showMore', { defaultValue: 'Mehr anzeigen' })} ({filteredAndSortedBranches.length - displayLimit} {t('common.remaining', { defaultValue: 'verbleibend' })})\n                        </button>\n                    </div>\n                )}\n            </>\n        );\n    };\n\n    // Mobile-Erkennung\n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    \n    useEffect(() => {\n        const handleResize = () => {\n            setIsMobile(window.innerWidth < 640);\n        };\n        window.addEventListener('resize', handleResize);\n        return () => window.removeEventListener('resize', handleResize);\n    }, []);\n\n    return (\n        <div>\n            {/* Spaltenanzeige und Suche */}\n            <div className=\"space-y-4\">\n                <div className=\"flex items-center justify-between mb-4\">\n                    {/* Linke Seite: \"Neue Niederlassung erstellen\"-Button */}\n                    <div className=\"flex items-center\">\n                        {canCreate && (\n                            <button\n                                onClick={handleCreate}\n                                className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                                style={{ width: '30.19px', height: '30.19px' }}\n                                title={t('branches.create', { defaultValue: 'Neue Niederlassung' })}\n                                aria-label={t('branches.create', { defaultValue: 'Neue Niederlassung' })}\n                            >\n                                <PlusIcon className=\"h-4 w-4\" />\n                            </button>\n                        )}\n                    </div>\n                    \n                    {/* Mitte: Titel - Kein Titel in der Mitte notwendig bei dieser Komponente, da der Tab-Header bereits den Titel zeigt */}\n                    <div></div>\n                    \n                    {/* Rechte Seite: Suchfeld, Filter-Button */}\n                    <div className=\"flex items-center gap-1.5\">\n                        <input\n                            type=\"text\"\n                            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n                            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                        />\n                        <button\n                            className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100'} ml-1 relative`}\n                            onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                            title={t('common.filter', { defaultValue: 'Filter' })}\n                        >\n                            <FunnelIcon className=\"w-5 h-5\" />\n                            {getActiveFilterCount() > 0 && (\n                                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                    {getActiveFilterCount()}\n                                </span>\n                            )}\n                        </button>\n                    </div>\n                </div>\n\n                {/* Filter-Modal */}\n                {isFilterModalOpen && (\n                    <FilterPane\n                        columns={[\n                            { id: 'name', label: t('branches.name', { defaultValue: 'Name' }) }\n                        ]}\n                        onApply={applyFilterConditions}\n                        onReset={resetFilterConditions}\n                        savedConditions={filterConditions}\n                        savedOperators={filterLogicalOperators}\n                        tableId={BRANCHES_TABLE_ID}\n                    />\n                )}\n                \n                {/* Gespeicherte Filter als Tags anzeigen */}\n                <SavedFilterTags\n                    tableId={BRANCHES_TABLE_ID}\n                    onSelectFilter={applyFilterConditions}\n                    onReset={resetFilterConditions}\n                    activeFilterName={activeFilterName}\n                    selectedFilterId={selectedFilterId}\n                    onFilterChange={handleFilterChange}\n                    defaultFilterName=\"Alle\"\n                />\n\n                {loading ? (\n                    <div className=\"flex justify-center items-center py-8\">\n                        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n                    </div>\n                ) : (\n                    renderBranches()\n                )}\n            </div>\n\n            {/* Modal/Sidepane fr Branch-Erstellung/Bearbeitung */}\n            {isModalOpen && (\n                <>\n                    {/* Mobile (unter 640px) - Modal */}\n                    {isMobile ? (\n                        <Dialog open={isModalOpen} onClose={handleCloseModal} className=\"relative z-50\">\n                            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                            \n                            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                                <Dialog.Panel className=\"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                                    {/* Header */}\n                                    <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                                        <div className=\"flex items-center justify-between\">\n                                            <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                                                {editingBranch \n                                                    ? t('branches.edit', { defaultValue: 'Niederlassung bearbeiten' })\n                                                    : t('branches.create', { defaultValue: 'Neue Niederlassung' })\n                                                }\n                                            </Dialog.Title>\n                                            <button\n                                                onClick={handleCloseModal}\n                                                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                            >\n                                                <XMarkIcon className=\"h-6 w-6\" />\n                                            </button>\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Form */}\n                                    <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.name', { defaultValue: 'Name' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.name}\n                                                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                required\n                                                autoFocus\n                                            />\n                                        </div>\n\n                                        {/* Buttons */}\n                                        <div className=\"flex justify-end pt-4 gap-2\">\n                                            <button\n                                                type=\"button\"\n                                                onClick={handleCloseModal}\n                                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                                                title={t('common.cancel', { defaultValue: 'Abbrechen' })}\n                                            >\n                                                <XMarkIcon className=\"h-5 w-5\" />\n                                            </button>\n                                            <button\n                                                type=\"submit\"\n                                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                                                title={editingBranch ? t('common.update', { defaultValue: 'Aktualisieren' }) : t('common.create', { defaultValue: 'Erstellen' })}\n                                            >\n                                                <CheckIcon className=\"h-5 w-5\" />\n                                            </button>\n                                        </div>\n                                    </form>\n                                </Dialog.Panel>\n                            </div>\n                        </Dialog>\n                    ) : (\n                        // Desktop - Sidepane\n                        <div className=\"fixed inset-y-0 right-0 w-full sm:w-96 bg-white dark:bg-gray-800 shadow-xl z-50 flex flex-col\">\n                            {/* Header */}\n                            <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                                <div className=\"flex items-center justify-between\">\n                                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                                        {editingBranch \n                                            ? t('branches.edit', { defaultValue: 'Niederlassung bearbeiten' })\n                                            : t('branches.create', { defaultValue: 'Neue Niederlassung' })\n                                        }\n                                    </h2>\n                                    <button\n                                        onClick={handleCloseModal}\n                                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                    >\n                                        <XMarkIcon className=\"h-6 w-6\" />\n                                    </button>\n                                </div>\n                            </div>\n                            \n                            {/* Form */}\n                            <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\n                                <div className=\"flex-1 overflow-y-auto min-h-0\">\n                                    <div className=\"p-6 space-y-4\">\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.name', { defaultValue: 'Name' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.name}\n                                                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                required\n                                                autoFocus\n                                            />\n                                        </div>\n                                    </div>\n                                </div>\n\n                                {/* Buttons */}\n                                <div className=\"flex justify-end pt-4 gap-2 px-6 pb-6 border-t dark:border-gray-700\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={handleCloseModal}\n                                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                                        title={t('common.cancel', { defaultValue: 'Abbrechen' })}\n                                    >\n                                        <XMarkIcon className=\"h-5 w-5\" />\n                                    </button>\n                                    <button\n                                        type=\"submit\"\n                                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                                        title={editingBranch ? t('common.update', { defaultValue: 'Aktualisieren' }) : t('common.create', { defaultValue: 'Erstellen' })}\n                                    >\n                                        <CheckIcon className=\"h-5 w-5\" />\n                                    </button>\n                                </div>\n                            </form>\n                        </div>\n                    )}\n                </>\n            )}\n        </div>\n    );\n};\n\nexport default BranchManagementTab;\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { CreateOrganizationRequest } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\nimport { useAuth } from '../../hooks/useAuth.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nconst CreateOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<CreateOrganizationRequest>({\n    name: '',\n    displayName: '',\n    domain: ''\n  });\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  const { fetchCurrentUser } = useAuth();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.name.trim()) {\n      newErrors.name = t('organization.create.nameRequired');\n    }\n    \n    if (!formData.displayName.trim()) {\n      newErrors.displayName = t('organization.create.displayNameRequired');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      await organizationService.createOrganization(formData);\n      setErrors({});\n      showMessage(t('organization.create.createSuccess'), 'success');\n      \n      // WICHTIG: User und Berechtigungen neu laden nach Erstellen der Organisation\n      // Der User wurde der Admin-Rolle zugeordnet und hat jetzt neue Berechtigungen\n      await fetchCurrentUser();\n      \n      // Formular zurcksetzen\n      setFormData({\n        name: '',\n        displayName: '',\n        domain: ''\n      });\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.create.createError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    setFormData({\n      name: '',\n      displayName: '',\n      domain: ''\n    });\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.create.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label \n                    htmlFor=\"name\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.name')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"name\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.name \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.name && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"displayName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.displayName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"displayName\"\n                    name=\"displayName\"\n                    value={formData.displayName}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.displayName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.displayName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"domain\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.domain')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"domain\"\n                    name=\"domain\"\n                    value={formData.domain}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.create.creating') : t('organization.create.createButton')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.create.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label \n                htmlFor=\"name\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.name')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.name \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.name && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"displayName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.displayName')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"displayName\"\n                name=\"displayName\"\n                value={formData.displayName}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.displayName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.displayName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"domain\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.domain')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"domain\"\n                name=\"domain\"\n                value={formData.domain}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? t('organization.create.creating') : t('organization.create.createButton')}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default CreateOrganizationModal; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { CreateJoinRequestRequest, Organization } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nconst JoinOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<CreateJoinRequestRequest>({\n    organizationName: '',\n    message: ''\n  });\n  const [loading, setLoading] = useState<boolean>(false);\n  const [searching, setSearching] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [organizations, setOrganizations] = useState<Organization[]>([]);\n  const [showDropdown, setShowDropdown] = useState<boolean>(false);\n  const [selectedOrganization, setSelectedOrganization] = useState<Organization | null>(null);\n  const searchTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  const { showMessage } = useMessage();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  // Click outside handler fr Dropdown\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setShowDropdown(false);\n      }\n    };\n\n    if (showDropdown) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showDropdown]);\n\n  const searchOrganizations = async (searchTerm: string) => {\n    if (searchTerm.length < 2) {\n      setOrganizations([]);\n      setShowDropdown(false);\n      return;\n    }\n\n    try {\n      setSearching(true);\n      const results = await organizationService.searchOrganizations(searchTerm);\n      setOrganizations(results);\n      setShowDropdown(true);\n    } catch (err: any) {\n      console.error('Fehler bei der Organisationen-Suche:', err);\n      setOrganizations([]);\n    } finally {\n      setSearching(false);\n    }\n  };\n\n  const handleOrganizationInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setFormData(prev => ({ ...prev, organizationName: value }));\n    setSelectedOrganization(null);\n    \n    // Fehler lschen\n    if (errors.organizationName) {\n      setErrors(prev => ({ ...prev, organizationName: '' }));\n    }\n\n    // Debounce fr Suche\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current);\n    }\n\n    searchTimeoutRef.current = setTimeout(() => {\n      searchOrganizations(value);\n    }, 300);\n  };\n\n  const handleSelectOrganization = (org: Organization) => {\n    setSelectedOrganization(org);\n    setFormData(prev => ({ ...prev, organizationName: org.name }));\n    setShowDropdown(false);\n    setOrganizations([]);\n  };\n\n  const handleMessageChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setFormData(prev => ({ ...prev, message: e.target.value }));\n    if (errors.message) {\n      setErrors(prev => ({ ...prev, message: '' }));\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.organizationName.trim()) {\n      newErrors.organizationName = t('organization.join.nameRequired');\n    } else if (!selectedOrganization) {\n      newErrors.organizationName = t('organization.join.selectFromList');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      await organizationService.createJoinRequest(formData);\n      setErrors({});\n      showMessage(t('organization.join.sendSuccess'), 'success');\n      // Formular zurcksetzen\n      setFormData({\n        organizationName: '',\n        message: ''\n      });\n      setSelectedOrganization(null);\n      setOrganizations([]);\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.join.sendError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    setFormData({\n      organizationName: '',\n      message: ''\n    });\n    setSelectedOrganization(null);\n    setOrganizations([]);\n    setErrors({});\n    setShowDropdown(false);\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current);\n    }\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.join.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div className=\"relative\" ref={dropdownRef}>\n                  <label \n                    htmlFor=\"organizationName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.join.search')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"organizationName\"\n                    name=\"organizationName\"\n                    value={formData.organizationName}\n                    onChange={handleOrganizationInputChange}\n                    placeholder={t('organization.join.searchPlaceholder')}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.organizationName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.organizationName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.organizationName}</p>\n                  )}\n                  \n                  {/* Autocomplete Dropdown */}\n                  {showDropdown && (organizations.length > 0 || searching) && (\n                    <div className=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto\">\n                      {searching ? (\n                        <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                          {t('organization.join.searching')}\n                        </div>\n                      ) : organizations.length > 0 ? (\n                        organizations.map(org => (\n                          <button\n                            key={org.id}\n                            type=\"button\"\n                            onClick={() => handleSelectOrganization(org)}\n                            className=\"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none\"\n                          >\n                            <div className=\"font-medium text-gray-900 dark:text-white\">\n                              {org.displayName || org.name}\n                            </div>\n                            {org.displayName && (\n                              <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                {org.name}\n                              </div>\n                            )}\n                          </button>\n                        ))\n                      ) : (\n                        <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                          {t('organization.join.noOrganizations')}\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"message\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.join.message')}\n                  </label>\n                  <textarea\n                    id=\"message\"\n                    name=\"message\"\n                    value={formData.message || ''}\n                    onChange={handleMessageChange}\n                    rows={3}\n                    placeholder={t('organization.join.messagePlaceholder')}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.join.sending') : t('organization.join.send')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.join.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"relative\" ref={dropdownRef}>\n              <label \n                htmlFor=\"organizationName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.join.search')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"organizationName\"\n                name=\"organizationName\"\n                value={formData.organizationName}\n                onChange={handleOrganizationInputChange}\n                placeholder={t('organization.join.searchPlaceholder')}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.organizationName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.organizationName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.organizationName}</p>\n              )}\n              \n              {/* Autocomplete Dropdown */}\n              {showDropdown && (organizations.length > 0 || searching) && (\n                <div className=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto\">\n                  {searching ? (\n                    <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                      {t('organization.join.searching')}\n                    </div>\n                  ) : organizations.length > 0 ? (\n                    organizations.map(org => (\n                      <button\n                        key={org.id}\n                        type=\"button\"\n                        onClick={() => handleSelectOrganization(org)}\n                        className=\"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none\"\n                      >\n                        <div className=\"font-medium text-gray-900 dark:text-white\">\n                          {org.displayName || org.name}\n                        </div>\n                        {org.displayName && (\n                          <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                            {org.name}\n                          </div>\n                        )}\n                      </button>\n                    ))\n                  ) : (\n                    <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                      {t('organization.join.noOrganizations')}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"message\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.join.message')}\n              </label>\n              <textarea\n                id=\"message\"\n                name=\"message\"\n                value={formData.message || ''}\n                onChange={handleMessageChange}\n                rows={3}\n                placeholder={t('organization.join.messagePlaceholder')}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? t('organization.join.sending') : t('organization.join.send')}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default JoinOrganizationModal; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { roleApi } from '../../api/apiClient.ts';\nimport { Role } from '../../types/interfaces.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\n\ninterface Organization {\n  id: number;\n  displayName?: string;\n  name?: string;\n  settings?: any;\n}\n\ninterface RoleConfigurationTabProps {\n  organization: Organization | null;\n  onSave?: () => void;\n}\n\nconst RoleConfigurationTab: React.FC<RoleConfigurationTabProps> = ({\n  organization,\n  onSave\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [lifecycleRoles, setLifecycleRoles] = useState<{\n    adminRoleId?: number | null;\n    hrRoleId?: number | null;\n    legalRoleId?: number | null;\n    employeeRoleIds?: number[];\n  }>({});\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [loadingRoles, setLoadingRoles] = useState(false);\n\n  useEffect(() => {\n    if (organization) {\n      loadRoles();\n      loadLifecycleRoles();\n    }\n  }, [organization]);\n\n  const loadRoles = async () => {\n    setLoadingRoles(true);\n    try {\n      const response = await roleApi.getAll();\n      if (response.data && Array.isArray(response.data)) {\n        setRoles(response.data);\n      }\n    } catch (error) {\n      console.error('Fehler beim Laden der Rollen:', error);\n      showMessage(\n        t('lifecycle.loadRolesError', { defaultValue: 'Fehler beim Laden der Rollen' }),\n        'error'\n      );\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  const loadLifecycleRoles = async () => {\n    setLoading(true);\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.LIFECYCLE_ROLES);\n      setLifecycleRoles(response.data.lifecycleRoles || {});\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Lebenszyklus-Rollen:', error);\n      // Wenn 404, dann gibt es noch keine Konfiguration - das ist OK\n      if (error.response?.status !== 404) {\n        showMessage(\n          error.response?.data?.message || t('lifecycle.loadLifecycleRolesError', { defaultValue: 'Fehler beim Laden der Konfiguration' }),\n          'error'\n        );\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSave = async () => {\n    setSaving(true);\n    try {\n      // Konvertiere zu Number oder null (verhindert, dass 0 oder undefined als String gesendet wird)\n      const prepareRoleId = (id: number | null | undefined): number | null => {\n        if (id === null || id === undefined || id === 0) {\n          return null;\n        }\n        return Number(id);\n      };\n\n      await axiosInstance.put(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.LIFECYCLE_ROLES, {\n        adminRoleId: prepareRoleId(lifecycleRoles.adminRoleId),\n        hrRoleId: prepareRoleId(lifecycleRoles.hrRoleId),\n        legalRoleId: prepareRoleId(lifecycleRoles.legalRoleId),\n        employeeRoleIds: (lifecycleRoles.employeeRoleIds || []).map(prepareRoleId).filter((id): id is number => id !== null)\n      });\n      showMessage(\n        t('lifecycle.rolesSaved', { defaultValue: 'Rollen-Konfiguration erfolgreich gespeichert' }),\n        'success'\n      );\n      if (onSave) {\n        onSave();\n      }\n    } catch (error: any) {\n      console.error('Fehler beim Speichern:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.saveError', { defaultValue: 'Fehler beim Speichern' }),\n        'error'\n      );\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleAssignStandardRoles = () => {\n    // Finde Standard-Rollen\n    const adminRole = roles.find(r => r.name.toLowerCase().includes('admin') || r.name.toLowerCase().includes('administrator'));\n    const hrRole = roles.find(r => r.name.toLowerCase().includes('hr') || r.name.toLowerCase().includes('human'));\n    const legalRole = roles.find(r => r.name.toLowerCase() === 'derecho' || r.name.toLowerCase().includes('legal'));\n\n    setLifecycleRoles({\n      ...lifecycleRoles,\n      adminRoleId: adminRole?.id || null,\n      hrRoleId: hrRole?.id || null,\n      legalRoleId: legalRole?.id || null\n    });\n\n    showMessage(\n      t('lifecycle.standardRolesAssigned', { defaultValue: 'Standard-Rollen zugewiesen' }),\n      'success'\n    );\n  };\n\n  if (loading && !lifecycleRoles) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <ArrowPathIcon className=\"h-6 w-6 animate-spin text-gray-400\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.lifecycleRoles.title', { defaultValue: 'Lebenszyklus-Rollen' })}\n          </h3>\n          <button\n            onClick={handleAssignStandardRoles}\n            className=\"px-3 py-1.5 text-sm font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors\"\n          >\n            {t('lifecycle.assignStandardRoles', { defaultValue: 'Standard-Rollen zuweisen' })}\n          </button>\n        </div>\n        \n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              {t('organization.lifecycleRoles.admin', { defaultValue: 'Admin-Rolle' })}\n            </label>\n            <select\n              value={lifecycleRoles.adminRoleId || ''}\n              onChange={(e) => {\n                const value = e.target.value;\n                setLifecycleRoles({ \n                ...lifecycleRoles, \n                  adminRoleId: (value && value !== '' && !isNaN(parseInt(value, 10))) ? parseInt(value, 10) : null \n                });\n              }}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              disabled={loadingRoles}\n            >\n              <option value=\"\">{t('common.pleaseSelect')}</option>\n              {roles.map(role => (\n                <option key={role.id} value={role.id}>\n                  {role.name}\n                </option>\n              ))}\n            </select>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              {t('organization.lifecycleRoles.hr', { defaultValue: 'HR-Rolle' })}\n            </label>\n            <select\n              value={lifecycleRoles.hrRoleId || ''}\n              onChange={(e) => {\n                const value = e.target.value;\n                setLifecycleRoles({ \n                ...lifecycleRoles, \n                  hrRoleId: (value && value !== '' && !isNaN(parseInt(value, 10))) ? parseInt(value, 10) : null \n                });\n              }}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              disabled={loadingRoles}\n            >\n              <option value=\"\">{t('common.pleaseSelect')}</option>\n              {roles.map(role => (\n                <option key={role.id} value={role.id}>\n                  {role.name}\n                </option>\n              ))}\n            </select>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              {t('organization.lifecycleRoles.legal', { defaultValue: 'Legal-Rolle' })}\n            </label>\n            <select\n              value={lifecycleRoles.legalRoleId || ''}\n              onChange={(e) => {\n                const value = e.target.value;\n                setLifecycleRoles({ \n                ...lifecycleRoles, \n                  legalRoleId: (value && value !== '' && !isNaN(parseInt(value, 10))) ? parseInt(value, 10) : null \n                });\n              }}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              disabled={loadingRoles}\n            >\n              <option value=\"\">{t('common.pleaseSelect')}</option>\n              {roles.map(role => (\n                <option key={role.id} value={role.id}>\n                  {role.name}\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n        \n        <div className=\"mt-6 flex justify-end\">\n          <button\n            onClick={handleSave}\n            disabled={saving || loadingRoles}\n            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            title={saving ? t('common.saving', { defaultValue: 'Speichere...' }) : t('common.save', { defaultValue: 'Speichern' })}\n          >\n            {saving ? (\n              <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n            ) : (\n              <CheckIcon className=\"h-5 w-5\" />\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default RoleConfigurationTab;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { DocumentTextIcon, ArrowPathIcon, CheckIcon, PlusIcon, TrashIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../../config/axios.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { organizationService } from '../../services/organizationService.ts';\n\ninterface Organization {\n  id: number;\n  displayName?: string;\n  name?: string;\n  settings?: any;\n}\n\ninterface DocumentConfigurationTabProps {\n  organization: Organization | null;\n  onSave?: () => void;\n}\n\ninterface DocumentTemplate {\n  id?: number;\n  name: string;\n  type: 'certificate' | 'contract';\n  filePath?: string;\n  version?: string;\n}\n\nconst DocumentConfigurationTab: React.FC<DocumentConfigurationTabProps> = ({\n  organization,\n  onSave\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [templates, setTemplates] = useState<DocumentTemplate[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const [templateType, setTemplateType] = useState<'certificate' | 'contract'>('certificate');\n  const fileInputRef = React.useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    if (organization) {\n      loadTemplates();\n    }\n  }, [organization]);\n\n  const loadTemplates = async () => {\n    setLoading(true);\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      \n      // Konvertiere zu Template-Array\n      const templatesList: DocumentTemplate[] = [];\n      if (documentTemplates.employmentCertificate) {\n        templatesList.push({\n          name: 'Arbeitszeugnis',\n          type: 'certificate',\n          filePath: documentTemplates.employmentCertificate.path,\n          version: documentTemplates.employmentCertificate.version\n        });\n      }\n      if (documentTemplates.employmentContract) {\n        templatesList.push({\n          name: 'Arbeitsvertrag',\n          type: 'contract',\n          filePath: documentTemplates.employmentContract.path,\n          version: documentTemplates.employmentContract.version\n        });\n      }\n      \n      setTemplates(templatesList);\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Templates:', error);\n      if (error.response?.status !== 404) {\n        showMessage(\n          error.response?.data?.message || t('lifecycle.loadTemplatesError', { defaultValue: 'Fehler beim Laden der Templates' }),\n          'error'\n        );\n      }\n      setTemplates([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // Prfe Dateityp\n    if (file.type !== 'application/pdf') {\n      showMessage(\n        t('lifecycle.onlyPdfAllowed', { defaultValue: 'Nur PDF-Dateien sind erlaubt' }),\n        'error'\n      );\n      return;\n    }\n\n    setUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('type', templateType === 'certificate' ? 'employmentCertificate' : 'employmentContract');\n\n      const response = await axiosInstance.post(\n        API_ENDPOINTS.ORGANIZATION_LIFECYCLE.UPLOAD_TEMPLATE,\n        formData,\n        {\n          headers: { 'Content-Type': 'multipart/form-data' }\n        }\n      );\n      \n      showMessage(\n        response.data.message || t('lifecycle.templateUploaded', { defaultValue: 'Template erfolgreich hochgeladen' }),\n        'success'\n      );\n      \n      // Lade Templates neu\n      loadTemplates();\n    } catch (error: any) {\n      console.error('Fehler beim Hochladen:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.uploadError', { defaultValue: 'Fehler beim Hochladen' }),\n        'error'\n      );\n    } finally {\n      setUploading(false);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    }\n  };\n\n  const handleDeleteTemplate = async (templateType: 'certificate' | 'contract') => {\n    if (!window.confirm(t('lifecycle.deleteTemplateConfirm', { defaultValue: 'Template wirklich lschen?' }))) {\n      return;\n    }\n\n    try {\n      // Hole aktuelle Organisation\n      const orgResponse = await axiosInstance.get(API_ENDPOINTS.ORGANIZATIONS.CURRENT);\n      const settings = orgResponse.data.settings || {};\n      \n      // Entferne Template\n      if (settings.documentTemplates) {\n        const typeKey = templateType === 'certificate' ? 'employmentCertificate' : 'employmentContract';\n        delete settings.documentTemplates[typeKey];\n        \n        // Aktualisiere Organisation\n        await axiosInstance.put(API_ENDPOINTS.ORGANIZATIONS.CURRENT, {\n          settings\n        });\n      }\n      \n      showMessage(\n        t('lifecycle.templateDeleted', { defaultValue: 'Template erfolgreich gelscht' }),\n        'success'\n      );\n      \n      // Lade Templates neu\n      loadTemplates();\n    } catch (error: any) {\n      console.error('Fehler beim Lschen:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.deleteError', { defaultValue: 'Fehler beim Lschen' }),\n        'error'\n      );\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <ArrowPathIcon className=\"h-6 w-6 animate-spin text-gray-400\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold flex items-center dark:text-white\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('organization.documentTemplates', { defaultValue: 'Dokumenten-Templates' })}\n          </h3>\n          <div className=\"flex items-center space-x-2\">\n            <select\n              value={templateType}\n              onChange={(e) => setTemplateType(e.target.value as 'certificate' | 'contract')}\n              className=\"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n            >\n              <option value=\"certificate\">Arbeitszeugnis</option>\n              <option value=\"contract\">Arbeitsvertrag</option>\n            </select>\n            <button\n              onClick={() => fileInputRef.current?.click()}\n              disabled={uploading}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n              title={uploading ? t('common.uploading', { defaultValue: 'Lade hoch...' }) : t('lifecycle.uploadTemplate', { defaultValue: 'Template hochladen' })}\n            >\n              {uploading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <PlusIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept=\".pdf\"\n            onChange={handleFileUpload}\n            className=\"hidden\"\n          />\n        </div>\n        \n        {templates.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noTemplates', { defaultValue: 'Keine Templates vorhanden' })}</p>\n            <p className=\"text-sm mt-2\">{t('lifecycle.uploadFirstTemplate', { defaultValue: 'Laden Sie Ihr erstes Template hoch' })}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-2\">\n            {templates.map((template) => (\n              <div\n                key={template.type}\n                className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg\"\n              >\n                <div>\n                  <div className=\"font-medium dark:text-white\">{template.name}</div>\n                  <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                    {template.type === 'certificate' \n                      ? t('lifecycle.certificate', { defaultValue: 'Arbeitszeugnis' })\n                      : t('lifecycle.contract', { defaultValue: 'Arbeitsvertrag' })}\n                    {template.version && ` - Version ${template.version}`}\n                  </div>\n                  {template.filePath && (\n                    <div className=\"text-xs text-gray-400 dark:text-gray-500 mt-1\">\n                      {template.filePath}\n                    </div>\n                  )}\n                </div>\n                <button\n                  onClick={() => handleDeleteTemplate(template.type)}\n                  className=\"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900 rounded-md\"\n                  title={t('common.delete', { defaultValue: 'Lschen' })}\n                >\n                  <TrashIcon className=\"h-5 w-5\" />\n                </button>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n      \n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold flex items-center dark:text-white\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('organization.documentSignatures', { defaultValue: 'Dokumenten-Signaturen' })}\n          </h3>\n        </div>\n        \n        <SignatureUploadSection \n          organization={organization}\n          onUpload={loadTemplates}\n        />\n      </div>\n      \n      <FieldPositionConfiguration \n        organization={organization}\n        onSave={onSave}\n      />\n    </div>\n  );\n};\n\ninterface SignatureUploadSectionProps {\n  organization: Organization | null;\n  onUpload: () => void;\n}\n\nconst SignatureUploadSection: React.FC<SignatureUploadSectionProps> = ({\n  organization,\n  onUpload\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [signatures, setSignatures] = useState<Array<{\n    type: 'certificate' | 'contract';\n    signerName: string;\n    signerPosition?: string;\n    path: string;\n    position?: {\n      x: number;\n      y: number;\n      page: number;\n    };\n  }>>([]);\n  const [loading, setLoading] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const [signatureType, setSignatureType] = useState<'certificate' | 'contract'>('certificate');\n  const [signerName, setSignerName] = useState('');\n  const [signerPosition, setSignerPosition] = useState('');\n  const [positionX, setPositionX] = useState<string>('400');\n  const [positionY, setPositionY] = useState<string>('100');\n  const [positionPage, setPositionPage] = useState<string>('1');\n  const fileInputRef = React.useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    if (organization) {\n      loadSignatures();\n    }\n  }, [organization]);\n\n  const loadSignatures = async () => {\n    setLoading(true);\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_SIGNATURES);\n      const documentSignatures = response.data.documentSignatures || {};\n      \n      const signaturesList: Array<{\n        type: 'certificate' | 'contract';\n        signerName: string;\n        signerPosition?: string;\n        path: string;\n        position?: {\n          x: number;\n          y: number;\n          page: number;\n        };\n      }> = [];\n      \n      if (documentSignatures.employmentCertificate) {\n        signaturesList.push({\n          type: 'certificate',\n          signerName: documentSignatures.employmentCertificate.signerName,\n          signerPosition: documentSignatures.employmentCertificate.signerPosition,\n          path: documentSignatures.employmentCertificate.path,\n          position: documentSignatures.employmentCertificate.position\n        });\n      }\n      if (documentSignatures.employmentContract) {\n        signaturesList.push({\n          type: 'contract',\n          signerName: documentSignatures.employmentContract.signerName,\n          signerPosition: documentSignatures.employmentContract.signerPosition,\n          path: documentSignatures.employmentContract.path,\n          position: documentSignatures.employmentContract.position\n        });\n      }\n      \n      setSignatures(signaturesList);\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Signaturen:', error);\n      if (error.response?.status !== 404) {\n        showMessage(\n          error.response?.data?.message || t('lifecycle.loadSignaturesError', { defaultValue: 'Fehler beim Laden der Signaturen' }),\n          'error'\n        );\n      }\n      setSignatures([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // Prfe Dateityp\n    const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'application/pdf'];\n    if (!allowedTypes.includes(file.type)) {\n      showMessage(\n        t('lifecycle.onlyImageOrPdfAllowed', { defaultValue: 'Nur Bilder (JPEG, PNG, GIF) oder PDF-Dateien sind erlaubt' }),\n        'error'\n      );\n      return;\n    }\n\n    if (!signerName.trim()) {\n      showMessage(\n        t('lifecycle.signerNameRequired', { defaultValue: 'Name des Unterzeichners ist erforderlich' }),\n        'error'\n      );\n      return;\n    }\n\n    setUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('type', signatureType === 'certificate' ? 'employmentCertificate' : 'employmentContract');\n      formData.append('signerName', signerName);\n      if (signerPosition) {\n        formData.append('signerPosition', signerPosition);\n      }\n      // Positionen hinzufgen\n      formData.append('positionX', positionX || '400');\n      formData.append('positionY', positionY || '100');\n      formData.append('page', positionPage || '1');\n\n      const response = await axiosInstance.post(\n        API_ENDPOINTS.ORGANIZATION_LIFECYCLE.UPLOAD_SIGNATURE,\n        formData,\n        {\n          headers: { 'Content-Type': 'multipart/form-data' }\n        }\n      );\n      \n      showMessage(\n        response.data.message || t('lifecycle.signatureUploaded', { defaultValue: 'Signatur erfolgreich hochgeladen' }),\n        'success'\n      );\n      \n      // Reset form\n      setSignerName('');\n      setSignerPosition('');\n      setPositionX('400');\n      setPositionY('100');\n      setPositionPage('1');\n      \n      // Lade Signaturen neu\n      loadSignatures();\n      onUpload();\n    } catch (error: any) {\n      console.error('Fehler beim Hochladen:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.uploadError', { defaultValue: 'Fehler beim Hochladen' }),\n        'error'\n      );\n    } finally {\n      setUploading(false);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    }\n  };\n\n  const handleDeleteSignature = async (signatureType: 'certificate' | 'contract') => {\n    if (!window.confirm(t('lifecycle.deleteSignatureConfirm', { defaultValue: 'Signatur wirklich lschen?' }))) {\n      return;\n    }\n\n    try {\n      const orgResponse = await axiosInstance.get(API_ENDPOINTS.ORGANIZATIONS.CURRENT);\n      const settings = orgResponse.data.settings || {};\n      \n      if (settings.documentSignatures) {\n        const typeKey = signatureType === 'certificate' ? 'employmentCertificate' : 'employmentContract';\n        delete settings.documentSignatures[typeKey];\n        \n        await axiosInstance.put(API_ENDPOINTS.ORGANIZATIONS.CURRENT, {\n          settings\n        });\n      }\n      \n      showMessage(\n        t('lifecycle.signatureDeleted', { defaultValue: 'Signatur erfolgreich gelscht' }),\n        'success'\n      );\n      \n      loadSignatures();\n    } catch (error: any) {\n      console.error('Fehler beim Lschen:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.deleteError', { defaultValue: 'Fehler beim Lschen' }),\n        'error'\n      );\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-4\">\n        <ArrowPathIcon className=\"h-5 w-5 animate-spin text-gray-400\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"border border-gray-300 dark:border-gray-600 rounded-lg p-4\">\n        <div className=\"space-y-3\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              {t('lifecycle.signatureType', { defaultValue: 'Signatur-Typ' })}\n            </label>\n            <select\n              value={signatureType}\n              onChange={(e) => setSignatureType(e.target.value as 'certificate' | 'contract')}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n            >\n              <option value=\"certificate\">{t('lifecycle.certificate', { defaultValue: 'Arbeitszeugnis' })}</option>\n              <option value=\"contract\">{t('lifecycle.contract', { defaultValue: 'Arbeitsvertrag' })}</option>\n            </select>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              {t('lifecycle.signerName', { defaultValue: 'Name des Unterzeichners' })} <span className=\"text-red-500\">*</span>\n            </label>\n            <input\n              type=\"text\"\n              value={signerName}\n              onChange={(e) => setSignerName(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n              placeholder={t('lifecycle.signerNamePlaceholder', { defaultValue: 'z.B. Stefan Bossart' })}\n            />\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              {t('lifecycle.signerPosition', { defaultValue: 'Position' })}\n            </label>\n            <input\n              type=\"text\"\n              value={signerPosition}\n              onChange={(e) => setSignerPosition(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n              placeholder={t('lifecycle.signerPositionPlaceholder', { defaultValue: 'z.B. Geschftsfhrer' })}\n            />\n          </div>\n          \n          <div className=\"border-t border-gray-200 dark:border-gray-700 pt-3\">\n            <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\n              {t('lifecycle.signaturePosition', { defaultValue: 'Signatur-Position im PDF' })}\n            </h4>\n            <div className=\"grid grid-cols-3 gap-3\">\n              <div>\n                <label className=\"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1\">\n                  {t('lifecycle.positionX', { defaultValue: 'X (horizontal)' })}\n                </label>\n                <input\n                  type=\"number\"\n                  value={positionX}\n                  onChange={(e) => setPositionX(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n                  placeholder=\"400\"\n                  min=\"0\"\n                />\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                  {t('lifecycle.positionXHint', { defaultValue: '0 = links' })}\n                </p>\n              </div>\n              <div>\n                <label className=\"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1\">\n                  {t('lifecycle.positionY', { defaultValue: 'Y (vertikal)' })}\n                </label>\n                <input\n                  type=\"number\"\n                  value={positionY}\n                  onChange={(e) => setPositionY(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n                  placeholder=\"100\"\n                  min=\"0\"\n                />\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                  {t('lifecycle.positionYHint', { defaultValue: '0 = unten' })}\n                </p>\n              </div>\n              <div>\n                <label className=\"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1\">\n                  {t('lifecycle.positionPage', { defaultValue: 'Seite' })}\n                </label>\n                <input\n                  type=\"number\"\n                  value={positionPage}\n                  onChange={(e) => setPositionPage(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n                  placeholder=\"1\"\n                  min=\"1\"\n                />\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                  {t('lifecycle.positionPageHint', { defaultValue: 'Seitennummer' })}\n                </p>\n              </div>\n            </div>\n            <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\n              {t('lifecycle.signaturePositionHint', { defaultValue: 'Koordinaten in PDF-Punkten (1 Punkt = 1/72 Zoll). A4: 595 x 842 Punkte. Standard: X=400, Y=100, Seite=1' })}\n            </p>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              {t('lifecycle.signatureFile', { defaultValue: 'Signatur-Datei' })} <span className=\"text-red-500\">*</span>\n            </label>\n            <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center\">\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\"image/jpeg,image/png,image/gif,application/pdf\"\n                onChange={handleFileUpload}\n                className=\"hidden\"\n              />\n              <button\n                onClick={() => fileInputRef.current?.click()}\n                disabled={uploading || !signerName.trim()}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {uploading ? (\n                  <span className=\"flex items-center space-x-2\">\n                    <ArrowPathIcon className=\"h-4 w-4 animate-spin\" />\n                    <span>{t('common.uploading', { defaultValue: 'Lade hoch...' })}</span>\n                  </span>\n                ) : (\n                  t('lifecycle.selectSignatureFile', { defaultValue: 'Datei auswhlen' })\n                )}\n              </button>\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\n                {t('lifecycle.signatureFileHint', { defaultValue: 'JPEG, PNG, GIF oder PDF (max. 5MB)' })}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      {signatures.length > 0 && (\n        <div className=\"space-y-2\">\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n            {t('lifecycle.uploadedSignatures', { defaultValue: 'Hochgeladene Signaturen' })}\n          </h4>\n          {signatures.map((signature) => (\n            <div\n              key={signature.type}\n              className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg\"\n            >\n              <div>\n                <div className=\"font-medium dark:text-white\">\n                  {signature.type === 'certificate' \n                    ? t('lifecycle.certificate', { defaultValue: 'Arbeitszeugnis' })\n                    : t('lifecycle.contract', { defaultValue: 'Arbeitsvertrag' })}\n                </div>\n                <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                  {signature.signerName}\n                  {signature.signerPosition && ` - ${signature.signerPosition}`}\n                </div>\n                {signature.position && (\n                  <div className=\"text-xs text-gray-400 dark:text-gray-500 mt-1\">\n                    {t('lifecycle.position', { defaultValue: 'Position' })}: X={signature.position.x}, Y={signature.position.y}, {t('lifecycle.page', { defaultValue: 'Seite' })} {signature.position.page}\n                  </div>\n                )}\n              </div>\n              <button\n                onClick={() => handleDeleteSignature(signature.type)}\n                className=\"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900 rounded-md\"\n                title={t('common.delete', { defaultValue: 'Lschen' })}\n              >\n                <TrashIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\ninterface FieldPositionConfigurationProps {\n  organization: Organization | null;\n  onSave?: () => void;\n}\n\nconst FieldPositionConfiguration: React.FC<FieldPositionConfigurationProps> = ({\n  organization,\n  onSave\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [templateType, setTemplateType] = useState<'certificate' | 'contract'>('certificate');\n  const [fields, setFields] = useState<Record<string, { x: number; y: number; fontSize?: number }>>({});\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n\n  // Standard-Felder fr Certificate und Contract\n  const certificateFields = ['userName', 'organizationName', 'currentDate', 'identificationNumber', 'startDate', 'endDate'];\n  const contractFields = ['userName', 'organizationName', 'currentDate', 'identificationNumber', 'startDate', 'endDate', 'position', 'salary', 'workingHours'];\n\n  useEffect(() => {\n    if (organization) {\n      loadFields();\n    }\n  }, [organization, templateType]);\n\n  const loadFields = async () => {\n    try {\n      const settings = organization?.settings as any;\n      const templateSettings = settings?.documentTemplates?.[templateType === 'certificate' ? 'employmentCertificate' : 'employmentContract'];\n      const savedFields = templateSettings?.fields || {};\n      \n      // Standard-Positionen (A4: 595.28 x 841.89 Punkte)\n      // Y-Koordinate: 0 ist unten, 841.89 ist oben (PDF-Koordinatensystem)\n      const pageHeight = 841.89;\n      const margin = 50;\n      const lineHeight = 20;\n      let currentY = pageHeight - margin - 30;\n      \n      // Lade gespeicherte Felder oder verwende Standard-Werte (synchronisiert mit Backend)\n      const defaultFields: Record<string, { x: number; y: number; fontSize?: number }> = {};\n      const fieldList = templateType === 'certificate' ? certificateFields : contractFields;\n      \n      // Standard-Positionen (wie im Backend getDefaultFieldPositions)\n      const defaultPositions: Record<string, { x: number; y: number; fontSize?: number }> = {\n        userName: { x: margin, y: currentY, fontSize: 14 },\n        organizationName: { x: margin, y: currentY - lineHeight, fontSize: 12 },\n        currentDate: { x: margin, y: currentY - lineHeight * 2, fontSize: 12 },\n        identificationNumber: { x: margin, y: currentY - lineHeight * 3, fontSize: 12 },\n        startDate: { x: margin, y: currentY - lineHeight * 4, fontSize: 12 },\n        endDate: { x: margin, y: currentY - lineHeight * 5, fontSize: 12 }\n      };\n      \n      if (templateType === 'contract') {\n        defaultPositions.position = { x: margin, y: currentY - lineHeight * 6, fontSize: 12 };\n        defaultPositions.salary = { x: margin, y: currentY - lineHeight * 7, fontSize: 12 };\n        defaultPositions.workingHours = { x: margin, y: currentY - lineHeight * 8, fontSize: 12 };\n      }\n      \n      fieldList.forEach((fieldName) => {\n        defaultFields[fieldName] = savedFields[fieldName] || defaultPositions[fieldName] || {\n          x: margin,\n          y: currentY,\n          fontSize: fieldName === 'userName' ? 14 : 12\n        };\n      });\n      \n      setFields(defaultFields);\n    } catch (error) {\n      console.error('Fehler beim Laden der Felder:', error);\n    }\n  };\n\n  const handleFieldChange = (fieldName: string, property: 'x' | 'y' | 'fontSize', value: string) => {\n    setFields(prev => ({\n      ...prev,\n      [fieldName]: {\n        ...prev[fieldName],\n        [property]: property === 'fontSize' ? parseFloat(value) || 12 : parseFloat(value) || 0\n      }\n    }));\n  };\n\n  const handleSave = async () => {\n    setSaving(true);\n    try {\n      const orgResponse = await axiosInstance.get(API_ENDPOINTS.ORGANIZATIONS.CURRENT);\n      const currentSettings = orgResponse.data.settings || {};\n      \n      if (!currentSettings.documentTemplates) {\n        currentSettings.documentTemplates = {};\n      }\n      \n      const typeKey = templateType === 'certificate' ? 'employmentCertificate' : 'employmentContract';\n      if (!currentSettings.documentTemplates[typeKey]) {\n        currentSettings.documentTemplates[typeKey] = {};\n      }\n      \n      currentSettings.documentTemplates[typeKey].fields = fields;\n      \n      await organizationService.updateOrganization({\n        settings: currentSettings\n      });\n      \n      showMessage(\n        t('lifecycle.fieldPositionsSaved', { defaultValue: 'Feld-Positionen erfolgreich gespeichert' }),\n        'success'\n      );\n      \n      if (onSave) {\n        onSave();\n      }\n    } catch (error: any) {\n      console.error('Fehler beim Speichern:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.saveError', { defaultValue: 'Fehler beim Speichern' }),\n        'error'\n      );\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleReset = async () => {\n    if (window.confirm(t('lifecycle.resetFieldPositionsConfirm', { defaultValue: 'Positionen auf Standardwerte zurcksetzen?' }))) {\n      // Setze Felder auf Standard-Werte zurck\n      const pageHeight = 841.89;\n      const margin = 50;\n      const lineHeight = 20;\n      let currentY = pageHeight - margin - 30;\n      \n      const defaultPositions: Record<string, { x: number; y: number; fontSize?: number }> = {\n        userName: { x: margin, y: currentY, fontSize: 14 },\n        organizationName: { x: margin, y: currentY - lineHeight, fontSize: 12 },\n        currentDate: { x: margin, y: currentY - lineHeight * 2, fontSize: 12 },\n        identificationNumber: { x: margin, y: currentY - lineHeight * 3, fontSize: 12 },\n        startDate: { x: margin, y: currentY - lineHeight * 4, fontSize: 12 },\n        endDate: { x: margin, y: currentY - lineHeight * 5, fontSize: 12 }\n      };\n      \n      if (templateType === 'contract') {\n        defaultPositions.position = { x: margin, y: currentY - lineHeight * 6, fontSize: 12 };\n        defaultPositions.salary = { x: margin, y: currentY - lineHeight * 7, fontSize: 12 };\n        defaultPositions.workingHours = { x: margin, y: currentY - lineHeight * 8, fontSize: 12 };\n      }\n      \n      const fieldList = templateType === 'certificate' ? certificateFields : contractFields;\n      const resetFields: Record<string, { x: number; y: number; fontSize?: number }> = {};\n      \n      fieldList.forEach((fieldName) => {\n        resetFields[fieldName] = defaultPositions[fieldName] || {\n          x: margin,\n          y: currentY,\n          fontSize: fieldName === 'userName' ? 14 : 12\n        };\n      });\n      \n      setFields(resetFields);\n    }\n  };\n\n  const fieldList = templateType === 'certificate' ? certificateFields : contractFields;\n  const fieldLabels: Record<string, string> = {\n    userName: t('lifecycle.fieldUserName', { defaultValue: 'Benutzername' }),\n    organizationName: t('lifecycle.fieldOrganizationName', { defaultValue: 'Organisationsname' }),\n    currentDate: t('lifecycle.fieldCurrentDate', { defaultValue: 'Aktuelles Datum' }),\n    identificationNumber: t('lifecycle.fieldIdentificationNumber', { defaultValue: 'Ausweisnummer' }),\n    startDate: t('lifecycle.fieldStartDate', { defaultValue: 'Startdatum' }),\n    endDate: t('lifecycle.fieldEndDate', { defaultValue: 'Enddatum' }),\n    position: t('lifecycle.fieldPosition', { defaultValue: 'Position' }),\n    salary: t('lifecycle.fieldSalary', { defaultValue: 'Gehalt' }),\n    workingHours: t('lifecycle.fieldWorkingHours', { defaultValue: 'Arbeitsstunden' })\n  };\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold dark:text-white\">\n          {t('organization.fieldPositions', { defaultValue: 'Feld-Positionen konfigurieren' })}\n        </h3>\n        <div className=\"flex items-center space-x-2\">\n          <select\n            value={templateType}\n            onChange={(e) => setTemplateType(e.target.value as 'certificate' | 'contract')}\n            className=\"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n          >\n            <option value=\"certificate\">{t('lifecycle.certificate', { defaultValue: 'Certificado Laboral' })}</option>\n            <option value=\"contract\">{t('lifecycle.contract', { defaultValue: 'Contrato de Trabajo' })}</option>\n          </select>\n        </div>\n      </div>\n      \n      <div className=\"space-y-4\">\n        <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3\">\n          <p className=\"text-sm text-blue-800 dark:text-blue-200 font-medium mb-1\">\n            {t('lifecycle.fieldPositionsInfo', { defaultValue: 'Konfigurieren Sie die Positionen der Felder im Template-PDF.' })}\n          </p>\n          <p className=\"text-xs text-blue-700 dark:text-blue-300\">\n            {t('lifecycle.fieldPositionsHint', { defaultValue: 'Koordinaten in PDF-Punkten. A4: 595 x 842 Punkte. Y=0 ist unten, Y=842 ist oben. X=0 ist links, X=595 ist rechts.' })}\n          </p>\n        </div>\n        \n        <div className=\"space-y-3 max-h-96 overflow-y-auto\">\n          {fieldList.map((fieldName) => (\n            <div key={fieldName} className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-3\">\n              <div className=\"font-medium text-sm dark:text-white mb-2\">\n                {fieldLabels[fieldName] || fieldName}\n              </div>\n              <div className=\"grid grid-cols-3 gap-2\">\n                <div>\n                  <label className=\"block text-xs text-gray-600 dark:text-gray-400 mb-1\">\n                    X\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={fields[fieldName]?.x || 0}\n                    onChange={(e) => handleFieldChange(fieldName, 'x', e.target.value)}\n                    className=\"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n                    min=\"0\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-xs text-gray-600 dark:text-gray-400 mb-1\">\n                    Y\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={fields[fieldName]?.y || 0}\n                    onChange={(e) => handleFieldChange(fieldName, 'y', e.target.value)}\n                    className=\"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n                    min=\"0\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-xs text-gray-600 dark:text-gray-400 mb-1\">\n                    {t('lifecycle.fontSize', { defaultValue: 'Schriftgre' })}\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={fields[fieldName]?.fontSize || 12}\n                    onChange={(e) => handleFieldChange(fieldName, 'fontSize', e.target.value)}\n                    className=\"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white text-sm\"\n                    min=\"8\"\n                    max=\"72\"\n                  />\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n        \n        <div className=\"flex items-center justify-end space-x-2 pt-2 border-t border-gray-200 dark:border-gray-700\">\n          <button\n            onClick={handleReset}\n            className=\"p-2 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 dark:text-white\"\n            title={t('common.reset', { defaultValue: 'Zurcksetzen' })}\n          >\n            <ArrowPathIcon className=\"h-5 w-5\" />\n          </button>\n          <button\n            onClick={handleSave}\n            disabled={saving}\n            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-700 dark:hover:bg-blue-800\"\n            title={saving ? t('common.saving', { defaultValue: 'Speichern...' }) : t('common.save', { defaultValue: 'Speichern' })}\n          >\n            {saving ? (\n              <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n            ) : (\n              <CheckIcon className=\"h-5 w-5\" />\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default DocumentConfigurationTab;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { EnvelopeIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { Organization } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\n\ninterface Props {\n  organization: Organization | null;\n  onSave?: () => void;\n}\n\nconst SMTPConfigurationTab: React.FC<Props> = ({ organization, onSave }) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [loading, setLoading] = useState(false);\n  const [smtpSettings, setSmtpSettings] = useState({\n    smtpHost: '',\n    smtpPort: '587',\n    smtpUser: '',\n    smtpPass: '',\n    smtpFromEmail: '',\n    smtpFromName: ''\n  });\n  const [showPassword, setShowPassword] = useState(false);\n\n  useEffect(() => {\n    if (organization?.settings) {\n      const settings = organization.settings as any;\n      setSmtpSettings({\n        smtpHost: settings.smtpHost || '',\n        smtpPort: settings.smtpPort?.toString() || '587',\n        smtpUser: settings.smtpUser || '',\n        smtpPass: settings.smtpPass || '',\n        smtpFromEmail: settings.smtpFromEmail || (organization?.domain ? `noreply@${organization.domain}` : ''),\n        smtpFromName: settings.smtpFromName || organization?.displayName || ''\n      });\n    }\n  }, [organization]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setSmtpSettings(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!smtpSettings.smtpHost || !smtpSettings.smtpUser || !smtpSettings.smtpPass) {\n      showMessage(t('organization.smtp.requiredFields'), 'error');\n      return;\n    }\n\n    try {\n      setLoading(true);\n      \n      const settings = {\n        ...(organization?.settings || {}),\n        smtpHost: smtpSettings.smtpHost,\n        smtpPort: parseInt(smtpSettings.smtpPort) || 587,\n        smtpUser: smtpSettings.smtpUser,\n        smtpPass: smtpSettings.smtpPass,\n        smtpFromEmail: smtpSettings.smtpFromEmail,\n        smtpFromName: smtpSettings.smtpFromName\n      };\n\n      await organizationService.updateOrganization({\n        settings: settings\n      });\n      \n      showMessage(t('organization.smtp.saveSuccess'), 'success');\n      if (onSave) {\n        onSave();\n      }\n    } catch (error: any) {\n      const errorMessage = error.response?.data?.message || t('organization.smtp.saveError');\n      showMessage(errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClear = () => {\n    setSmtpSettings({\n      smtpHost: '',\n      smtpPort: '587',\n      smtpUser: '',\n      smtpPass: '',\n      smtpFromEmail: organization?.domain ? `noreply@${organization.domain}` : '',\n      smtpFromName: organization?.displayName || ''\n    });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center gap-2 mb-4\">\n        <EnvelopeIcon className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n          {t('organization.smtp.title')}\n        </h3>\n      </div>\n\n      <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\n        {t('organization.smtp.description')}\n      </p>\n\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        <div>\n          <label htmlFor=\"smtpHost\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('organization.smtp.host')} <span className=\"text-red-500\">*</span>\n          </label>\n          <input\n            type=\"text\"\n            id=\"smtpHost\"\n            name=\"smtpHost\"\n            value={smtpSettings.smtpHost}\n            onChange={handleChange}\n            placeholder=\"smtp.example.com\"\n            required\n            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n          />\n          <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n            {t('organization.smtp.hostHint')}\n          </p>\n        </div>\n\n        <div>\n          <label htmlFor=\"smtpPort\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('organization.smtp.port')} <span className=\"text-red-500\">*</span>\n          </label>\n          <input\n            type=\"number\"\n            id=\"smtpPort\"\n            name=\"smtpPort\"\n            value={smtpSettings.smtpPort}\n            onChange={handleChange}\n            placeholder=\"587\"\n            required\n            min=\"1\"\n            max=\"65535\"\n            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n          />\n          <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n            {t('organization.smtp.portHint')}\n          </p>\n        </div>\n\n        <div>\n          <label htmlFor=\"smtpUser\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('organization.smtp.user')} <span className=\"text-red-500\">*</span>\n          </label>\n          <input\n            type=\"text\"\n            id=\"smtpUser\"\n            name=\"smtpUser\"\n            value={smtpSettings.smtpUser}\n            onChange={handleChange}\n            placeholder=\"noreply@example.com\"\n            required\n            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n          />\n          <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n            {t('organization.smtp.userHint')}\n          </p>\n        </div>\n\n        <div>\n          <label htmlFor=\"smtpPass\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('organization.smtp.password')} <span className=\"text-red-500\">*</span>\n          </label>\n          <div className=\"relative\">\n            <input\n              type={showPassword ? 'text' : 'password'}\n              id=\"smtpPass\"\n              name=\"smtpPass\"\n              value={smtpSettings.smtpPass}\n              onChange={handleChange}\n              placeholder=\"\"\n              required\n              className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n            />\n            <button\n              type=\"button\"\n              onClick={() => setShowPassword(!showPassword)}\n              className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n            >\n              {showPassword ? (\n                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                </svg>\n              ) : (\n                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                </svg>\n              )}\n            </button>\n          </div>\n          <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n            {t('organization.smtp.passwordHint')}\n          </p>\n        </div>\n\n        <div className=\"border-t pt-4\">\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\n            {t('organization.smtp.fromSettings')}\n          </h4>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"smtpFromEmail\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.smtp.fromEmail')}\n              </label>\n              <input\n                type=\"email\"\n                id=\"smtpFromEmail\"\n                name=\"smtpFromEmail\"\n                value={smtpSettings.smtpFromEmail}\n                onChange={handleChange}\n                placeholder=\"noreply@example.com\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n              <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                {t('organization.smtp.fromEmailHint')}\n              </p>\n            </div>\n\n            <div>\n              <label htmlFor=\"smtpFromName\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.smtp.fromName')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"smtpFromName\"\n                name=\"smtpFromName\"\n                value={smtpSettings.smtpFromName}\n                onChange={handleChange}\n                placeholder={organization?.displayName || 'Intranet'}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n              <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                {t('organization.smtp.fromNameHint')}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md p-4\">\n          <p className=\"text-sm text-blue-800 dark:text-blue-200\">\n            <strong>{t('organization.smtp.infoTitle')}</strong>\n          </p>\n          <ul className=\"mt-2 text-sm text-blue-700 dark:text-blue-300 list-disc list-inside space-y-1\">\n            <li>{t('organization.smtp.info1')}</li>\n            <li>{t('organization.smtp.info2')}</li>\n            <li>{t('organization.smtp.info3')}</li>\n          </ul>\n        </div>\n\n        <div className=\"flex justify-end gap-2 pt-4\">\n          <button\n            type=\"button\"\n            onClick={handleClear}\n            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\n            title={t('organization.smtp.clear')}\n          >\n            <ArrowPathIcon className=\"h-5 w-5\" />\n          </button>\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n            title={loading ? t('organization.saving') : t('common.save')}\n          >\n            {loading ? (\n              <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n            ) : (\n              <CheckIcon className=\"h-5 w-5\" />\n            )}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default SMTPConfigurationTab;\n\n","/**\n * URL-Validierung fr API-Endpunkte (Frontend)\n * \n * Verhindert SSRF durch Whitelist-basierte Validierung\n */\n\nconst ALLOWED_DOMAINS = {\n  lobbyPms: ['app.lobbypms.com'],\n  ttlock: ['open.ttlock.com', 'euopen.ttlock.com', 'api.sciener.com'],\n  sire: ['api.sire.gov.co'],\n  boldPayment: ['api.bold.co', 'sandbox.bold.co'],\n} as const;\n\nexport type ApiService = keyof typeof ALLOWED_DOMAINS;\n\n/**\n * Validiert eine API-URL gegen eine Whitelist\n * \n * @param url - Die zu validierende URL\n * @param service - Der API-Service\n * @returns true wenn URL gltig ist, false sonst\n */\nexport const validateApiUrl = (url: string, service: ApiService): boolean => {\n  if (!url || typeof url !== 'string') {\n    return false;\n  }\n\n  try {\n    const parsed = new URL(url);\n    const allowedDomains = ALLOWED_DOMAINS[service];\n\n    return allowedDomains.some(domain => {\n      // Exakte bereinstimmung\n      if (parsed.hostname === domain) {\n        return true;\n      }\n\n      // Subdomain (z.B. api.app.lobbypms.com)\n      if (parsed.hostname.endsWith(`.${domain}`)) {\n        return true;\n      }\n\n      return false;\n    });\n  } catch (error) {\n    // Ungltige URL\n    return false;\n  }\n};\n\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { KeyIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { Organization, OrganizationSettings } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport { validateApiUrl } from '../../utils/urlValidation.ts';\n\n// Feste LobbyPMS API URL\nconst LOBBYPMS_API_URL = 'https://app.lobbypms.com/api';\n\ninterface Props {\n  organization: Organization | null;\n  onSave?: () => void;\n}\n\nconst ApiConfigurationTab: React.FC<Props> = ({ organization, onSave }) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const { canManageOrganization, loading: permissionsLoading } = usePermissions();\n  const [loading, setLoading] = useState(false);\n  const [apiSettings, setApiSettings] = useState({\n    // LobbyPMS\n    lobbyPmsApiKey: '',\n    lobbyPmsPropertyId: '',\n    lobbyPmsSyncEnabled: false,\n    lobbyPmsAutoCreateTasks: false,\n    lobbyPmsLateCheckInThreshold: '22:00',\n    \n    // TTLock\n    ttlockClientId: '',\n    ttlockClientSecret: '',\n    ttlockApiUrl: 'https://open.ttlock.com',\n    ttlockUsername: '',\n    ttlockPassword: '',\n    ttlockPasscodeType: 'auto' as 'auto' | 'custom',\n    \n    // SIRE\n    sireApiUrl: '',\n    sireApiKey: '',\n    sireApiSecret: '',\n    sireEnabled: false,\n    sireAutoRegisterOnCheckIn: false,\n    sirePropertyCode: '',\n    \n    // Bold Payment\n    boldPaymentApiKey: '',\n    boldPaymentMerchantId: '',\n    boldPaymentEnvironment: 'sandbox' as 'sandbox' | 'production',\n    \n    // WhatsApp\n    whatsappProvider: 'twilio' as 'twilio' | 'whatsapp-business-api',\n    whatsappApiKey: '',\n    whatsappApiSecret: '',\n    whatsappPhoneNumberId: ''\n  });\n  const [showSecrets, setShowSecrets] = useState<Record<string, boolean>>({});\n\n  useEffect(() => {\n    if (organization?.settings) {\n      const settings = organization.settings as OrganizationSettings;\n      const lobbyPms = settings.lobbyPms || {};\n      const doorSystem = settings.doorSystem || {};\n      const sire = settings.sire || {};\n      const boldPayment = settings.boldPayment || {};\n      const whatsapp = settings.whatsapp || {};\n      \n      setApiSettings({\n        lobbyPmsApiKey: lobbyPms.apiKey || '',\n        lobbyPmsPropertyId: lobbyPms.propertyId || '',\n        lobbyPmsSyncEnabled: lobbyPms.syncEnabled || false,\n        lobbyPmsAutoCreateTasks: lobbyPms.autoCreateTasks || false,\n        lobbyPmsLateCheckInThreshold: lobbyPms.lateCheckInThreshold || '22:00',\n        \n        ttlockClientId: doorSystem.clientId || '',\n        ttlockClientSecret: doorSystem.clientSecret || '',\n        ttlockApiUrl: doorSystem.apiUrl || 'https://open.ttlock.com',\n        ttlockUsername: doorSystem.username || '',\n        ttlockPassword: '', // Password wird nicht angezeigt (aus Sicherheitsgrnden)\n        ttlockPasscodeType: (doorSystem.passcodeType as 'auto' | 'custom') || 'auto',\n        \n        sireApiUrl: sire.apiUrl || '',\n        sireApiKey: sire.apiKey || '',\n        sireApiSecret: sire.apiSecret || '',\n        sireEnabled: sire.enabled || false,\n        sireAutoRegisterOnCheckIn: sire.autoRegisterOnCheckIn || false,\n        sirePropertyCode: sire.propertyCode || '',\n        \n        boldPaymentApiKey: boldPayment.apiKey || '',\n        boldPaymentMerchantId: boldPayment.merchantId || '',\n        boldPaymentEnvironment: boldPayment.environment || 'sandbox',\n        \n        whatsappProvider: (whatsapp.provider as 'twilio' | 'whatsapp-business-api') || 'twilio',\n        whatsappApiKey: whatsapp.apiKey || '',\n        whatsappApiSecret: whatsapp.apiSecret || '',\n        whatsappPhoneNumberId: whatsapp.phoneNumberId || ''\n      });\n    }\n  }, [organization]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value, type } = e.target;\n    const checked = (e.target as HTMLInputElement).checked;\n    \n    setApiSettings(prev => ({\n      ...prev,\n      [name]: type === 'checkbox' ? checked : value\n    }));\n  };\n\n  const toggleShowSecret = (key: string) => {\n    setShowSecrets(prev => ({\n      ...prev,\n      [key]: !prev[key]\n    }));\n  };\n\n  const handleClear = () => {\n    setApiSettings({\n      lobbyPmsApiKey: '',\n      lobbyPmsPropertyId: '',\n      lobbyPmsSyncEnabled: false,\n      lobbyPmsAutoCreateTasks: false,\n      lobbyPmsLateCheckInThreshold: '22:00',\n      ttlockClientId: '',\n      ttlockClientSecret: '',\n      ttlockApiUrl: 'https://open.ttlock.com',\n      ttlockUsername: '',\n      ttlockPassword: '',\n      ttlockPasscodeType: 'auto' as 'auto' | 'custom',\n      sireApiUrl: '',\n      sireApiKey: '',\n      sireApiSecret: '',\n      sireEnabled: false,\n      sireAutoRegisterOnCheckIn: false,\n      sirePropertyCode: '',\n        boldPaymentApiKey: '',\n        boldPaymentMerchantId: '',\n        boldPaymentEnvironment: 'sandbox',\n        whatsappProvider: 'twilio' as 'twilio' | 'whatsapp-business-api',\n        whatsappApiKey: '',\n        whatsappApiSecret: '',\n        whatsappPhoneNumberId: ''\n    });\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    //  VALIDIERUNG: Prfe Pflichtfelder\n    if (apiSettings.lobbyPmsSyncEnabled) {\n      if (!apiSettings.lobbyPmsApiKey) {\n        showMessage(t('organization.api.validation.apiKeyRequired'), 'error');\n        return;\n      }\n    }\n\n    //  URL-VALIDIERUNG: Prfe alle URLs\n    if (apiSettings.ttlockApiUrl && !validateApiUrl(apiSettings.ttlockApiUrl, 'ttlock')) {\n      showMessage(t('organization.api.validation.invalidUrl'), 'error');\n      return;\n    }\n    if (apiSettings.sireApiUrl && !validateApiUrl(apiSettings.sireApiUrl, 'sire')) {\n      showMessage(t('organization.api.validation.invalidUrl'), 'error');\n      return;\n    }\n\n    //  ZEITFORMAT-VALIDIERUNG: Prfe lateCheckInThreshold\n    if (apiSettings.lobbyPmsLateCheckInThreshold && !/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(apiSettings.lobbyPmsLateCheckInThreshold)) {\n      showMessage(t('organization.api.validation.invalidTimeFormat'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      \n      const currentSettings = (organization?.settings || {}) as OrganizationSettings;\n      const settings: OrganizationSettings = {\n        ...currentSettings,\n        lobbyPms: {\n          ...currentSettings.lobbyPms,\n          apiUrl: LOBBYPMS_API_URL, // Feste URL\n          apiKey: apiSettings.lobbyPmsApiKey || undefined,\n          propertyId: apiSettings.lobbyPmsPropertyId || undefined,\n          syncEnabled: apiSettings.lobbyPmsSyncEnabled,\n          autoCreateTasks: apiSettings.lobbyPmsAutoCreateTasks,\n          lateCheckInThreshold: apiSettings.lobbyPmsLateCheckInThreshold || undefined\n        },\n        doorSystem: {\n          ...currentSettings.doorSystem,\n          provider: 'ttlock' as const,\n          apiUrl: apiSettings.ttlockApiUrl || undefined,\n          clientId: apiSettings.ttlockClientId || undefined,\n          clientSecret: apiSettings.ttlockClientSecret || undefined,\n          username: apiSettings.ttlockUsername || undefined,\n          password: apiSettings.ttlockPassword || undefined, // Wird MD5-gehasht im Backend\n          passcodeType: apiSettings.ttlockPasscodeType || 'auto'\n        },\n        sire: {\n          ...currentSettings.sire,\n          apiUrl: apiSettings.sireApiUrl || undefined,\n          apiKey: apiSettings.sireApiKey || undefined,\n          apiSecret: apiSettings.sireApiSecret || undefined,\n          enabled: apiSettings.sireEnabled,\n          autoRegisterOnCheckIn: apiSettings.sireAutoRegisterOnCheckIn,\n          propertyCode: apiSettings.sirePropertyCode || undefined\n        },\n        boldPayment: {\n          ...currentSettings.boldPayment,\n          apiKey: apiSettings.boldPaymentApiKey || undefined,\n          merchantId: apiSettings.boldPaymentMerchantId || undefined,\n          environment: apiSettings.boldPaymentEnvironment\n        },\n        whatsapp: {\n          ...currentSettings.whatsapp,\n          provider: apiSettings.whatsappProvider,\n          apiKey: apiSettings.whatsappApiKey || undefined,\n          apiSecret: apiSettings.whatsappApiSecret || undefined,\n          phoneNumberId: apiSettings.whatsappPhoneNumberId || undefined\n        }\n      };\n\n      await organizationService.updateOrganization({\n        settings: settings\n      });\n      \n      showMessage(t('organization.api.saveSuccess'), 'success');\n      if (onSave) {\n        onSave();\n      }\n    } catch (error: any) {\n      console.error('Error saving API settings:', error);\n      \n      // Detaillierte Fehlermeldung\n      let errorMessage = t('organization.api.saveError');\n      \n      if (error.response?.data) {\n        const data = error.response.data;\n        \n        // Spezifische Fehlermeldung vom Backend\n        if (data.message) {\n          errorMessage = data.message;\n        }\n        \n        // Validierungsfehler anzeigen\n        if (data.errors && Array.isArray(data.errors)) {\n          const validationErrors = data.errors\n            .map((err: any) => `${err.path?.join('.') || ''}: ${err.message || ''}`)\n            .filter((msg: string) => msg)\n            .join(', ');\n          \n          if (validationErrors) {\n            errorMessage += ` (${validationErrors})`;\n          }\n          \n          // URL-Fehler anzeigen (wenn errors Strings sind)\n          if (data.errors.length > 0 && typeof data.errors[0] === 'string') {\n            errorMessage = data.errors.join(', ');\n          }\n        }\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      \n      showMessage(errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const SecretInput: React.FC<{\n    name: string;\n    value: string;\n    onChange: (e: React.ChangeEvent<HTMLInputElement>) => void;\n    placeholder?: string;\n    label: string;\n    required?: boolean;\n  }> = ({ name, value, onChange, placeholder, label, required = false }) => {\n    const showSecret = showSecrets[name] || false;\n    \n    return (\n      <div>\n        <label htmlFor={name} className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {label} {required && <span className=\"text-red-500\">*</span>}\n        </label>\n        <div className=\"relative\">\n          <input\n            type={showSecret ? 'text' : 'password'}\n            id={name}\n            name={name}\n            value={value}\n            onChange={onChange}\n            placeholder={placeholder || ''}\n            required={required}\n            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n          />\n          <button\n            type=\"button\"\n            onClick={() => toggleShowSecret(name)}\n            className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            {showSecret ? (\n              <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n              </svg>\n            ) : (\n              <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n              </svg>\n            )}\n          </button>\n        </div>\n      </div>\n    );\n  };\n\n  //  BERECHTIGUNGSPRFUNG\n  if (permissionsLoading) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <ArrowPathIcon className=\"h-6 w-6 animate-spin text-gray-400\" />\n        <span className=\"ml-3 text-gray-600 dark:text-gray-400\">{t('common.loadingPermissions')}</span>\n      </div>\n    );\n  }\n\n  if (!canManageOrganization()) {\n    return (\n      <div className=\"text-center py-8\">\n        <p className=\"text-gray-500 dark:text-gray-400\">{t('organization.api.noPermission')}</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center gap-2 mb-4\">\n        <KeyIcon className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n          {t('organization.api.title')}\n        </h3>\n      </div>\n\n      <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\n        {t('organization.api.description')}\n      </p>\n\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {/* LobbyPMS */}\n        <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n          <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n            {t('organization.api.lobbyPms.title')}\n          </h4>\n          \n          <div className=\"space-y-4\">\n            <SecretInput\n              name=\"lobbyPmsApiKey\"\n              value={apiSettings.lobbyPmsApiKey}\n              onChange={handleChange}\n              label={t('organization.api.lobbyPms.apiKey')}\n              placeholder=\"API Token\"\n            />\n\n            <div>\n              <label htmlFor=\"lobbyPmsPropertyId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.lobbyPms.propertyId')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"lobbyPmsPropertyId\"\n                name=\"lobbyPmsPropertyId\"\n                value={apiSettings.lobbyPmsPropertyId}\n                onChange={handleChange}\n                placeholder=\"Property ID\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <label className=\"flex items-center\">\n                <input\n                  type=\"checkbox\"\n                  name=\"lobbyPmsSyncEnabled\"\n                  checked={apiSettings.lobbyPmsSyncEnabled}\n                  onChange={handleChange}\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n                <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                  {t('organization.api.lobbyPms.syncEnabled')}\n                </span>\n              </label>\n\n              <label className=\"flex items-center\">\n                <input\n                  type=\"checkbox\"\n                  name=\"lobbyPmsAutoCreateTasks\"\n                  checked={apiSettings.lobbyPmsAutoCreateTasks}\n                  onChange={handleChange}\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n                <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                  {t('organization.api.lobbyPms.autoCreateTasks')}\n                </span>\n              </label>\n            </div>\n\n            <div>\n              <label htmlFor=\"lobbyPmsLateCheckInThreshold\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.lobbyPms.lateCheckInThreshold')}\n              </label>\n              <input\n                type=\"time\"\n                id=\"lobbyPmsLateCheckInThreshold\"\n                name=\"lobbyPmsLateCheckInThreshold\"\n                value={apiSettings.lobbyPmsLateCheckInThreshold}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* TTLock */}\n        <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n          <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n            {t('organization.api.ttlock.title')}\n          </h4>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"ttlockApiUrl\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.ttlock.apiUrl')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"ttlockApiUrl\"\n                name=\"ttlockApiUrl\"\n                value={apiSettings.ttlockApiUrl}\n                onChange={handleChange}\n                placeholder=\"https://open.ttlock.com\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"ttlockClientId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.ttlock.clientId')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"ttlockClientId\"\n                name=\"ttlockClientId\"\n                value={apiSettings.ttlockClientId}\n                onChange={handleChange}\n                placeholder=\"Client ID\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <SecretInput\n              name=\"ttlockClientSecret\"\n              value={apiSettings.ttlockClientSecret}\n              onChange={handleChange}\n              label={t('organization.api.ttlock.clientSecret')}\n              placeholder=\"Client Secret\"\n            />\n\n            <div>\n              <label htmlFor=\"ttlockUsername\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.ttlock.username')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"ttlockUsername\"\n                name=\"ttlockUsername\"\n                value={apiSettings.ttlockUsername}\n                onChange={handleChange}\n                placeholder=\"TTLock App Username (z.B. +573024498991)\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n              <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                {t('organization.api.ttlock.usernameHint')}\n              </p>\n            </div>\n\n            <SecretInput\n              name=\"ttlockPassword\"\n              value={apiSettings.ttlockPassword}\n              onChange={handleChange}\n              label={t('organization.api.ttlock.password')}\n              placeholder=\"TTLock App Password\"\n            />\n            <p className=\"text-xs text-gray-500 dark:text-gray-400 -mt-2\">\n              {t('organization.api.ttlock.passwordHint')}\n            </p>\n\n            <div>\n              <label htmlFor=\"ttlockPasscodeType\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.ttlock.passcodeType')}\n              </label>\n              <select\n                id=\"ttlockPasscodeType\"\n                name=\"ttlockPasscodeType\"\n                value={apiSettings.ttlockPasscodeType}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              >\n                <option value=\"auto\">{t('organization.api.ttlock.passcodeTypeAuto')}</option>\n                <option value=\"custom\">{t('organization.api.ttlock.passcodeTypeCustom')}</option>\n              </select>\n              <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                {t('organization.api.ttlock.passcodeTypeHint')}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        {/* SIRE */}\n        <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n          <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n            {t('organization.api.sire.title')}\n          </h4>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"sireApiUrl\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.sire.apiUrl')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"sireApiUrl\"\n                name=\"sireApiUrl\"\n                value={apiSettings.sireApiUrl}\n                onChange={handleChange}\n                placeholder=\"https://api.sire.gov.co\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <SecretInput\n              name=\"sireApiKey\"\n              value={apiSettings.sireApiKey}\n              onChange={handleChange}\n              label={t('organization.api.sire.apiKey')}\n              placeholder=\"API Key\"\n            />\n\n            <SecretInput\n              name=\"sireApiSecret\"\n              value={apiSettings.sireApiSecret}\n              onChange={handleChange}\n              label={t('organization.api.sire.apiSecret')}\n              placeholder=\"API Secret\"\n            />\n\n            <div>\n              <label htmlFor=\"sirePropertyCode\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.sire.propertyCode')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"sirePropertyCode\"\n                name=\"sirePropertyCode\"\n                value={apiSettings.sirePropertyCode}\n                onChange={handleChange}\n                placeholder=\"Property Code\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <label className=\"flex items-center\">\n                <input\n                  type=\"checkbox\"\n                  name=\"sireEnabled\"\n                  checked={apiSettings.sireEnabled}\n                  onChange={handleChange}\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n                <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                  {t('organization.api.sire.enabled')}\n                </span>\n              </label>\n\n              <label className=\"flex items-center\">\n                <input\n                  type=\"checkbox\"\n                  name=\"sireAutoRegisterOnCheckIn\"\n                  checked={apiSettings.sireAutoRegisterOnCheckIn}\n                  onChange={handleChange}\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n                <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                  {t('organization.api.sire.autoRegisterOnCheckIn')}\n                </span>\n              </label>\n            </div>\n          </div>\n        </div>\n\n        {/* Bold Payment */}\n        <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n          <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n            {t('organization.api.boldPayment.title')}\n          </h4>\n          \n          <div className=\"space-y-4\">\n            <SecretInput\n              name=\"boldPaymentApiKey\"\n              value={apiSettings.boldPaymentApiKey}\n              onChange={handleChange}\n              label={t('organization.api.boldPayment.apiKey')}\n              placeholder=\"API Key\"\n            />\n\n            <div>\n              <label htmlFor=\"boldPaymentMerchantId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.boldPayment.merchantId')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"boldPaymentMerchantId\"\n                name=\"boldPaymentMerchantId\"\n                value={apiSettings.boldPaymentMerchantId}\n                onChange={handleChange}\n                placeholder=\"Merchant ID\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"boldPaymentEnvironment\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.boldPayment.environment')}\n              </label>\n              <select\n                id=\"boldPaymentEnvironment\"\n                name=\"boldPaymentEnvironment\"\n                value={apiSettings.boldPaymentEnvironment}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              >\n                <option value=\"sandbox\">{t('organization.api.boldPayment.sandbox')}</option>\n                <option value=\"production\">{t('organization.api.boldPayment.production')}</option>\n              </select>\n            </div>\n          </div>\n        </div>\n\n        {/* WhatsApp */}\n        <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n          <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n            {t('organization.api.whatsapp.title')}\n          </h4>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"whatsappProvider\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.whatsapp.provider')}\n              </label>\n              <select\n                id=\"whatsappProvider\"\n                name=\"whatsappProvider\"\n                value={apiSettings.whatsappProvider}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              >\n                <option value=\"twilio\">{t('organization.api.whatsapp.providerTwilio')}</option>\n                <option value=\"whatsapp-business-api\">{t('organization.api.whatsapp.providerBusinessApi')}</option>\n              </select>\n            </div>\n\n            <SecretInput\n              name=\"whatsappApiKey\"\n              value={apiSettings.whatsappApiKey}\n              onChange={handleChange}\n              label={t('organization.api.whatsapp.apiKey')}\n              placeholder=\"API Key / Access Token\"\n            />\n\n            <SecretInput\n              name=\"whatsappApiSecret\"\n              value={apiSettings.whatsappApiSecret}\n              onChange={handleChange}\n              label={t('organization.api.whatsapp.apiSecret')}\n              placeholder=\"API Secret (optional)\"\n            />\n\n            <div>\n              <label htmlFor=\"whatsappPhoneNumberId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('organization.api.whatsapp.phoneNumberId')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"whatsappPhoneNumberId\"\n                name=\"whatsappPhoneNumberId\"\n                value={apiSettings.whatsappPhoneNumberId}\n                onChange={handleChange}\n                placeholder=\"Phone Number ID\"\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"flex justify-end gap-2 pt-4\">\n          <button\n            type=\"button\"\n            onClick={handleClear}\n            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\n            title={t('organization.api.clear')}\n          >\n            <ArrowPathIcon className=\"h-5 w-5\" />\n          </button>\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n            title={loading ? t('organization.saving') : t('common.save')}\n          >\n            {loading ? (\n              <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n            ) : (\n              <CheckIcon className=\"h-5 w-5\" />\n            )}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default ApiConfigurationTab;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { UpdateOrganizationRequest, Organization } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\nimport { useLanguage } from '../../hooks/useLanguage.ts';\nimport RoleConfigurationTab from './RoleConfigurationTab.tsx';\nimport DocumentConfigurationTab from './DocumentConfigurationTab.tsx';\nimport SMTPConfigurationTab from './SMTPConfigurationTab.tsx';\nimport ApiConfigurationTab from './ApiConfigurationTab.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n  organization: Organization | null;\n}\n\nconst EditOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess, organization }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<UpdateOrganizationRequest>({\n    displayName: '',\n    domain: '',\n    logo: '',\n    country: null,\n    nit: null,\n    settings: {}\n  });\n  const [selectedCountry, setSelectedCountry] = useState<string>('');\n  const [nit, setNit] = useState<string>('');\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  const { organizationLanguage, setOrganizationLanguage } = useLanguage();\n  const [selectedOrgLanguage, setSelectedOrgLanguage] = useState<string>('');\n  const [savingOrgLanguage, setSavingOrgLanguage] = useState<boolean>(false);\n  const [activeTab, setActiveTab] = useState<'general' | 'roles' | 'documents' | 'smtp' | 'api'>('general');\n\n  // Lnder-Liste\n  const COUNTRIES = [\n    { code: 'CO', name: t('countries.CO') },\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'DE', name: t('countries.DE') },\n    { code: 'AT', name: t('countries.AT') }\n  ];\n\n  // Lade Organisations-Daten wenn Modal geffnet wird\n  useEffect(() => {\n    if (isOpen && organization) {\n      const orgSettings = organization.settings || {};\n      setFormData({\n        displayName: organization.displayName || '',\n        domain: organization.domain || '',\n        logo: organization.logo || '',\n        country: organization.country || null,\n        nit: organization.nit || null,\n        settings: orgSettings\n      });\n      \n      // Setze Land direkt aus organization (statt aus settings)\n      setSelectedCountry(organization.country || '');\n      setNit(organization.nit || '');\n      \n      // Lade Organisation-Sprache\n      const loadOrgLanguage = async () => {\n        try {\n          const langResponse = await organizationService.getOrganizationLanguage();\n          setSelectedOrgLanguage(langResponse.language || '');\n        } catch (langError) {\n          console.error(t('organization.loadLanguageError'), langError);\n          setSelectedOrgLanguage('');\n        }\n      };\n      \n      loadOrgLanguage();\n    }\n  }, [isOpen, organization, t]);\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    if (name === 'country') {\n      setSelectedCountry(value);\n      setFormData(prev => ({\n        ...prev,\n        country: value || null\n      }));\n      // Wenn Country nicht \"CO\" ist, NIT zurcksetzen\n      if (value !== 'CO') {\n        setNit('');\n        setFormData(prev => ({\n          ...prev,\n          nit: null\n        }));\n      }\n    } else if (name === 'nit') {\n      setNit(value);\n      setFormData(prev => ({\n        ...prev,\n        nit: value || null\n      }));\n    } else {\n      setFormData(prev => ({ ...prev, [name]: value }));\n    }\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    try {\n      setLoading(true);\n      setErrors({});\n      await organizationService.updateOrganization(formData);\n      showMessage(t('organization.updateSuccess'), 'success');\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.updateError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    if (organization) {\n      const orgSettings = organization.settings || {};\n      setFormData({\n        displayName: organization.displayName || '',\n        domain: organization.domain || '',\n        logo: organization.logo || '',\n        country: organization.country || null,\n        nit: organization.nit || null,\n        settings: orgSettings\n      });\n      setSelectedCountry(organization.country || '');\n      setNit(organization.nit || '');\n    }\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.edit.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label \n                    htmlFor=\"displayName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.displayName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"displayName\"\n                    name=\"displayName\"\n                    value={formData.displayName || ''}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.displayName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.displayName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"domain\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.domain')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"domain\"\n                    name=\"domain\"\n                    value={formData.domain || ''}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"logo\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.logoUrl')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"logo\"\n                    name=\"logo\"\n                    value={formData.logo || ''}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n\n                {/* Land */}\n                <div className=\"border-t pt-4\">\n                  <label \n                    htmlFor=\"country\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.country')}\n                  </label>\n                  <select\n                    id=\"country\"\n                    name=\"country\"\n                    value={selectedCountry}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  >\n                    <option value=\"\">{t('organization.selectCountry')}</option>\n                    {COUNTRIES.map((country) => (\n                      <option key={country.code} value={country.code}>\n                        {country.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                {/* Organisation-Sprache */}\n                <div className=\"border-t pt-4\">\n                  <label \n                    htmlFor=\"organizationLanguage\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.language')}\n                  </label>\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\n                    {t('organization.languageDescription')}\n                  </p>\n                  <select\n                    id=\"organizationLanguage\"\n                    value={selectedOrgLanguage || organizationLanguage || ''}\n                    onChange={async (e) => {\n                      const newLanguage = e.target.value;\n                      setSelectedOrgLanguage(newLanguage);\n                      if (newLanguage && newLanguage !== organizationLanguage) {\n                        setSavingOrgLanguage(true);\n                        try {\n                          await setOrganizationLanguage(newLanguage);\n                          showMessage(t('common.save'), 'success');\n                        } catch (error) {\n                          console.error(t('organization.saveLanguageError'), error);\n                          showMessage(t('worktime.messages.orgLanguageError'), 'error');\n                        } finally {\n                          setSavingOrgLanguage(false);\n                        }\n                      }\n                    }}\n                    disabled={savingOrgLanguage || loading}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed\"\n                  >\n                    <option value=\"\">{t('settings.useOrganizationLanguage')} ({t('worktime.language.fallback')}: {t('worktime.language.german')})</option>\n                    <option value=\"de\">{t('worktime.language.german')}</option>\n                    <option value=\"es\">{t('worktime.language.spanish')}</option>\n                    <option value=\"en\">{t('worktime.language.english')}</option>\n                  </select>\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.saving') : t('common.save')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.edit.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        {/* Tabs Navigation */}\n        <div className=\"border-b border-gray-200 dark:border-gray-700\">\n          <nav className=\"-mb-px flex space-x-4 px-4\" aria-label=\"Tabs\">\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('general')}\n              className={`${\n                activeTab === 'general'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.general')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('roles')}\n              className={`${\n                activeTab === 'roles'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.roles')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('documents')}\n              className={`${\n                activeTab === 'documents'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.documents')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('smtp')}\n              className={`${\n                activeTab === 'smtp'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.smtp')}\n            </button>\n            {selectedCountry === 'CO' && (\n              <button\n                type=\"button\"\n                onClick={() => setActiveTab('api')}\n                className={`${\n                  activeTab === 'api'\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n              >\n                {t('organization.tabs.api')}\n              </button>\n            )}\n          </nav>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          {activeTab === 'general' && (\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label \n                htmlFor=\"displayName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.displayName')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"displayName\"\n                name=\"displayName\"\n                value={formData.displayName || ''}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.displayName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.displayName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"domain\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.domain')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"domain\"\n                name=\"domain\"\n                value={formData.domain || ''}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"logo\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.logoUrl')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"logo\"\n                name=\"logo\"\n                value={formData.logo || ''}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            {/* Land */}\n            <div className=\"border-t pt-4\">\n              <label \n                htmlFor=\"country\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.country')}\n              </label>\n              <select\n                id=\"country\"\n                name=\"country\"\n                value={selectedCountry}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              >\n                <option value=\"\">{t('organization.selectCountry')}</option>\n                {COUNTRIES.map((country) => (\n                  <option key={country.code} value={country.code}>\n                    {country.name}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            {/* NIT (nur fr Kolumbien) */}\n            {selectedCountry === 'CO' && (\n              <div>\n                <label \n                  htmlFor=\"nit\" \n                  className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                >\n                  {t('organization.nit')}\n                </label>\n                <input\n                  type=\"text\"\n                  id=\"nit\"\n                  name=\"nit\"\n                  value={nit}\n                  onChange={handleChange}\n                  placeholder={t('organization.nitDescription')}\n                  className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('organization.nitDescription')}\n                </p>\n              </div>\n            )}\n\n            {/* Organisation-Sprache */}\n            <div className=\"border-t pt-4\">\n              <label \n                htmlFor=\"organizationLanguage\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.language')}\n              </label>\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\n                {t('organization.languageDescription')}\n              </p>\n              <select\n                id=\"organizationLanguage\"\n                value={selectedOrgLanguage || organizationLanguage || ''}\n                onChange={async (e) => {\n                  const newLanguage = e.target.value;\n                  setSelectedOrgLanguage(newLanguage);\n                  if (newLanguage && newLanguage !== organizationLanguage) {\n                    setSavingOrgLanguage(true);\n                    try {\n                      await setOrganizationLanguage(newLanguage);\n                      showMessage(t('common.save'), 'success');\n                    } catch (error) {\n                      console.error('Fehler beim Speichern der Organisation-Sprache:', error);\n                      showMessage(t('worktime.messages.orgLanguageError'), 'error');\n                    } finally {\n                      setSavingOrgLanguage(false);\n                    }\n                  }\n                }}\n                disabled={savingOrgLanguage || loading}\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed\"\n              >\n                <option value=\"\">{t('settings.useOrganizationLanguage')} ({t('worktime.language.fallback')}: {t('worktime.language.german')})</option>\n                <option value=\"de\">{t('worktime.language.german')}</option>\n                <option value=\"es\">{t('worktime.language.spanish')}</option>\n                <option value=\"en\">{t('worktime.language.english')}</option>\n              </select>\n            </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.saving') : t('common.save')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          )}\n\n          {activeTab === 'roles' && (\n            <RoleConfigurationTab \n              organization={organization}\n              onSave={() => {\n                if (onSuccess) {\n                  onSuccess();\n                }\n              }}\n            />\n          )}\n\n          {activeTab === 'documents' && (\n            <DocumentConfigurationTab \n              organization={organization}\n              onSave={() => {\n                if (onSuccess) {\n                  onSuccess();\n                }\n              }}\n            />\n          )}\n\n          {activeTab === 'smtp' && (\n            <SMTPConfigurationTab \n              organization={organization}\n              onSave={() => {\n                if (onSuccess) {\n                  onSuccess();\n                }\n              }}\n            />\n          )}\n\n          {activeTab === 'api' && selectedCountry === 'CO' && (\n            <ApiConfigurationTab \n              organization={organization}\n              onSave={() => {\n                if (onSuccess) {\n                  onSuccess();\n                }\n              }}\n            />\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default EditOrganizationModal;\n\n","import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { XMarkIcon, ArrowPathIcon, FunnelIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport axiosInstance from '../../config/axios.ts';\n\n// Status-Badge Funktionen\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case 'pending':\n      return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';\n    case 'approved':\n      return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\n    case 'rejected':\n      return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\n    case 'withdrawn':\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n    default:\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n  }\n};\n\nconst getStatusText = (status: string, t: any) => {\n  switch (status) {\n    case 'pending':\n      return t('joinRequestsList.status.pending');\n    case 'approved':\n      return t('joinRequestsList.status.approved');\n    case 'rejected':\n      return t('joinRequestsList.status.rejected');\n    case 'withdrawn':\n      return t('joinRequestsList.status.withdrawn');\n    default:\n      return status;\n  }\n};\n\nconst MY_JOIN_REQUESTS_TABLE_ID = 'my-join-requests-table';\n\nconst MyJoinRequestsList: React.FC = () => {\n  const { t } = useTranslation();\n  const [joinRequests, setJoinRequests] = useState<OrganizationJoinRequest[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState<boolean>(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const { showMessage } = useMessage();\n  const mountedRef = useRef(true);\n  const [withdrawingId, setWithdrawingId] = useState<number | null>(null);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n\n  useEffect(() => {\n    return () => {\n      mountedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    console.log('MyJoinRequestsList: useEffect called - component mounted');\n    \n    // WICHTIG: State beim Mount zurcksetzen, um Caching zwischen Usern zu vermeiden\n    console.log('MyJoinRequestsList: Resetting state on mount to prevent data leaks');\n    setJoinRequests([]);\n    setError(null);\n    setLoading(true);\n    \n    let isMounted = true;\n    \n    const fetchMyJoinRequests = async () => {\n      if (!isMounted) {\n        console.log('MyJoinRequestsList: Component unmounted, skipping fetch');\n        return;\n      }\n      \n      console.log('MyJoinRequestsList: Starting fetch');\n      \n      // Timeout nach 10 Sekunden\n      const timeoutId = setTimeout(() => {\n        if (isMounted) {\n          console.error('Request timeout after 10 seconds');\n          setError('Anfrage dauert zu lange. Bitte Seite neu laden.');\n          setLoading(false);\n        }\n      }, 10000);\n      \n      try {\n        console.log('MyJoinRequestsList: Setting loading to true');\n        setLoading(true);\n        setError(null);\n        \n        // Debug: Log die URL die aufgerufen wird\n        console.log('MyJoinRequestsList: Fetching my join requests from:', API_ENDPOINTS.ORGANIZATIONS.MY_JOIN_REQUESTS);\n        \n        const requests = await organizationService.getMyJoinRequests();\n        \n        console.log('MyJoinRequestsList: Received requests:', requests);\n        console.log('MyJoinRequestsList: Requests type:', typeof requests);\n        console.log('MyJoinRequestsList: Requests isArray:', Array.isArray(requests));\n        console.log('MyJoinRequestsList: Requests length:', requests?.length || 0);\n        \n        // SICHERHEIT: Validiere, dass alle Anfragen wirklich Arrays sind\n        if (!Array.isArray(requests)) {\n          console.error(' MyJoinRequestsList: Response is not an array!', requests);\n          throw new Error('Ungltige Antwort vom Server');\n        }\n        \n        clearTimeout(timeoutId);\n        \n        // State immer setzen, auch wenn Component unmounted ist\n        // (React kann den State trotzdem setzen, wenn Component wieder gemountet wird)\n        if (isMounted) {\n          console.log('MyJoinRequestsList: Setting joinRequests state');\n          setJoinRequests(requests);\n          console.log('MyJoinRequestsList: State updated with', requests.length, 'requests');\n        } else {\n          console.log('MyJoinRequestsList: Component was unmounted, but setting state anyway');\n          setJoinRequests(requests);\n        }\n      } catch (err: any) {\n        clearTimeout(timeoutId);\n        \n        if (!isMounted) {\n          console.log('MyJoinRequestsList: Component unmounted during error, skipping error handling');\n          return;\n        }\n        \n        console.error('MyJoinRequestsList: Error fetching my join requests:', err);\n        console.error('MyJoinRequestsList: Error response:', err.response);\n        console.error('MyJoinRequestsList: Error status:', err.response?.status);\n        console.error('MyJoinRequestsList: Error data:', err.response?.data);\n        \n        const errorMessage = err.response?.data?.message || err.message || t('myJoinRequests.loadError');\n        setError(errorMessage);\n        setTimeout(() => {\n          showMessage(errorMessage, 'error');\n        }, 0);\n      } finally {\n        if (isMounted) {\n          console.log('MyJoinRequestsList: Setting loading to false');\n          setLoading(false);\n        } else {\n          // Auch wenn unmounted, loading auf false setzen\n          console.log('MyJoinRequestsList: Component unmounted, but setting loading to false anyway');\n          setLoading(false);\n        }\n      }\n    };\n\n    // IMMER neu laden beim Mount (auch beim Tab-Wechsel zurck)\n    fetchMyJoinRequests();\n    \n    return () => {\n      console.log('MyJoinRequestsList: useEffect cleanup - component unmounting');\n      isMounted = false;\n      mountedRef.current = false;\n      // State beim Unmount zurcksetzen\n      setJoinRequests([]);\n      setError(null);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleWithdraw = async (requestId: number) => {\n    if (!window.confirm(t('myJoinRequests.confirmWithdraw'))) {\n      return;\n    }\n\n    try {\n      setWithdrawingId(requestId);\n      await organizationService.withdrawJoinRequest(requestId);\n      \n      // Update local state\n      setJoinRequests(prev => \n        prev.map(req => \n          req.id === requestId \n            ? { ...req, status: 'withdrawn' as const, processedAt: new Date().toISOString() }\n            : req\n        )\n      );\n      \n      showMessage(t('myJoinRequests.withdrawSuccess'), 'success');\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('myJoinRequests.withdrawError');\n      showMessage(errorMessage, 'error');\n    } finally {\n      setWithdrawingId(null);\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('de-DE', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  // Filter-Funktionen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n\n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  // Initialer Default-Filter setzen (Controlled Mode)\n  useEffect(() => {\n    const setInitialFilter = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(MY_JOIN_REQUESTS_TABLE_ID));\n        const filters = response.data;\n        \n        const alleFilter = filters.find((filter: any) => filter.name === 'Alle');\n        if (alleFilter) {\n          setActiveFilterName('Alle');\n          setSelectedFilterId(alleFilter.id);\n          applyFilterConditions(alleFilter.conditions, alleFilter.operators);\n        }\n      } catch (error) {\n        console.error('Fehler beim Setzen des initialen Filters:', error);\n      }\n    };\n\n    setInitialFilter();\n  }, []);\n\n  // Standard-Filter erstellen und speichern\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(MY_JOIN_REQUESTS_TABLE_ID)\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: MY_JOIN_REQUESTS_TABLE_ID,\n            name: 'Alle',\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\n            alleFilter\n          );\n          console.log('Alle-Filter fr Meine Beitrittsanfragen erstellt');\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []);\n\n  // Gefilterte Join-Requests\n  const filteredJoinRequests = useMemo(() => {\n    let filtered = [...joinRequests];\n\n    // Suchfeld-Filter\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(request => {\n        const orgName = (request.organization.displayName || request.organization.name || '').toLowerCase();\n        const message = request.message?.toLowerCase() || '';\n        return orgName.includes(searchLower) || message.includes(searchLower);\n      });\n    }\n\n    // Filter-Bedingungen aus FilterPane\n    if (filterConditions.length > 0) {\n      filtered = filterConditions.reduce((acc, condition, index) => {\n        if (!condition.column || condition.value === null || condition.value === '') {\n          return acc;\n        }\n\n        const operator = condition.operator;\n        const value = condition.value;\n\n        return acc.filter(request => {\n          switch (condition.column) {\n            case 'organization':\n              const orgName = (request.organization.displayName || request.organization.name || '').toLowerCase();\n              const searchValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return orgName.includes(searchValue);\n              } else if (operator === 'equals') {\n                return orgName === searchValue;\n              } else if (operator === 'startsWith') {\n                return orgName.startsWith(searchValue);\n              }\n              return false;\n\n            case 'message':\n              const message = request.message?.toLowerCase() || '';\n              const msgValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return message.includes(msgValue);\n              } else if (operator === 'equals') {\n                return message === msgValue;\n              } else if (operator === 'startsWith') {\n                return message.startsWith(msgValue);\n              }\n              return false;\n\n            case 'status':\n              if (operator === 'equals') {\n                return request.status === value;\n              }\n              return false;\n\n            default:\n              return true;\n          }\n        });\n      }, filtered);\n    }\n\n    return filtered;\n  }, [joinRequests, searchTerm, filterConditions, filterLogicalOperators]);\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n      {/* Titelzeile mit Icon, Suchfeld, Filter-Button */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <h2 className=\"text-xl font-semibold dark:text-white\">\n          {t('myJoinRequests.title')}\n        </h2>\n        \n        <div className=\"flex items-center gap-1.5\">\n          {/* Suchfeld */}\n          <input\n            type=\"text\"\n            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n\n          {/* Filter-Button */}\n          <button\n            className={`p-2 rounded-md border ${getActiveFilterCount() > 0 ? 'border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n            onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n            title={t('common.filter')}\n          >\n            <FunnelIcon className=\"h-5 w-5\" />\n            {getActiveFilterCount() > 0 && (\n              <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                {getActiveFilterCount()}\n              </span>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Filter-Panel */}\n      {isFilterPanelOpen && (\n        <div className=\"mb-4\">\n          <FilterPane\n            columns={[\n              { id: 'organization', label: t('myJoinRequests.filter.organization', { defaultValue: 'Organisation' }) },\n              { id: 'message', label: t('joinRequestsList.filter.message') },\n              { id: 'status', label: t('joinRequestsList.status.title', { defaultValue: 'Status' }) }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={MY_JOIN_REQUESTS_TABLE_ID}\n          />\n        </div>\n      )}\n\n      {/* Gespeicherte Filter als Tags anzeigen */}\n      <SavedFilterTags\n        tableId={MY_JOIN_REQUESTS_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n        defaultFilterName=\"Alle\"\n      />\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded\">\n          {error}\n        </div>\n      )}\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('myJoinRequests.loading')}</span>\n        </div>\n      ) : joinRequests.length === 0 ? (\n        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n          {t('myJoinRequests.noRequests')}\n        </div>\n      ) : (\n        /* Cards fr Join-Requests */\n        <div className=\"space-y-4\">\n          {filteredJoinRequests.map(request => (\n            <div\n              key={request.id}\n              className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\"\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                        {request.organization.displayName || request.organization.name}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        {formatDate(request.createdAt)}\n                      </p>\n                    </div>\n                    <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(request.status)}`}>\n                      {getStatusText(request.status, t)}\n                    </span>\n                  </div>\n\n                  {request.message && (\n                    <div className=\"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.filter.message')}:</span> {request.message}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.response && (\n                    <div className=\"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700\">\n                      <p className=\"text-sm text-blue-700 dark:text-blue-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.response')}:</span> {request.response}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.processor && (\n                    <div className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\n                      {t('myJoinRequests.processedBy')}: {request.processor.firstName} {request.processor.lastName}\n                      {request.processedAt && ` - ${formatDate(request.processedAt)}`}\n                    </div>\n                  )}\n\n                  {request.status === 'pending' && (\n                    <div className=\"mt-4 flex items-center gap-2\">\n                      <button \n                        onClick={() => handleWithdraw(request.id)}\n                        disabled={withdrawingId === request.id}\n                        className=\"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-md dark:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 flex items-center disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {withdrawingId === request.id ? (\n                          <>\n                            <ArrowPathIcon className=\"h-4 w-4 mr-1 animate-spin\" />\n                            {t('myJoinRequests.withdrawing')}\n                          </>\n                        ) : (\n                          <>\n                            <XMarkIcon className=\"h-4 w-4 mr-1\" />\n                            {t('myJoinRequests.withdraw')}\n                          </>\n                        )}\n                      </button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default MyJoinRequestsList;\n\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { BuildingOfficeIcon, PlusIcon, UserPlusIcon, UserGroupIcon, ShieldCheckIcon, EnvelopeIcon, ChartBarIcon, PencilIcon } from '@heroicons/react/24/outline';\nimport { useTranslation } from 'react-i18next';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { Organization } from '../../types/organization.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useOrganization } from '../../contexts/OrganizationContext.tsx';\nimport CreateOrganizationModal from './CreateOrganizationModal.tsx';\nimport JoinOrganizationModal from './JoinOrganizationModal.tsx';\nimport EditOrganizationModal from './EditOrganizationModal.tsx';\nimport MyJoinRequestsList from './MyJoinRequestsList.tsx';\n\ninterface OrganizationStats {\n  currentUsers: number;\n  maxUsers: number;\n  availableSlots: number;\n  utilizationPercent: number;\n  _count: {\n    roles: number;\n    joinRequests: number;\n    invitations: number;\n  };\n}\n\nconst OrganizationSettings: React.FC = () => {\n  const [organization, setOrganization] = useState<Organization | null>(null);\n  const [stats, setStats] = useState<OrganizationStats | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [loadingStats, setLoadingStats] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState<boolean>(false);\n  const [isJoinModalOpen, setIsJoinModalOpen] = useState<boolean>(false);\n  const [isEditModalOpen, setIsEditModalOpen] = useState<boolean>(false);\n  const { canViewOrganization, canManageOrganization, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  const { t } = useTranslation();\n  const { refreshOrganization } = useOrganization();\n\n  const fetchOrganization = useCallback(async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const org = await organizationService.getCurrentOrganization();\n      setOrganization(org);\n      \n      // Statistiken laden\n      try {\n        setLoadingStats(true);\n        const statsData = await organizationService.getOrganizationStats();\n        setStats(statsData);\n      } catch (statsErr: any) {\n        console.error('Fehler beim Laden der Statistiken:', statsErr);\n        // Statistiken-Fehler nicht kritisch, keine Error-Message\n      } finally {\n        setLoadingStats(false);\n      }\n    } catch (err: any) {\n      // Prfe ob es ein 404-Fehler ist (keine Organisation gefunden)\n      if (err.response?.status === 404 && err.response?.data?.hasOrganization === false) {\n        // Benutzer hat keine Organisation - das ist OK, setze Error aber nicht kritisch\n        // Verwende IMMER die bersetzung, nicht die Backend-Nachricht\n        setError(t('organization.notFound'));\n        setOrganization(null);\n        // Zeige Info-Message statt Error\n        showMessage(t('organization.notFound'), 'info');\n      } else {\n        // Andere Fehler - kritisch\n        const errorMessage = err.response?.data?.message || t('organization.loadError');\n        setError(errorMessage);\n        showMessage(errorMessage, 'error');\n      }\n    } finally {\n      setLoading(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const hasInitialLoadRef = useRef(false);\n\n  useEffect(() => {\n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      return;\n    }\n\n    // Nur einmal beim initialen Load ausfhren\n    if (hasInitialLoadRef.current) {\n      return;\n    }\n\n    const hasPermission = canViewOrganization();\n    if (hasPermission) {\n      hasInitialLoadRef.current = true;\n      fetchOrganization();\n    } else {\n      setError(t('organization.noPermission'));\n      setLoading(false);\n      hasInitialLoadRef.current = true;\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [permissionsLoading]);\n\n  const handleEditSuccess = () => {\n    fetchOrganization();\n    // Aktualisiere auch den OrganizationContext\n    refreshOrganization();\n  };\n\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('common.loadingPermissions')}</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canViewOrganization()) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n          <div className=\"p-4 text-red-600 dark:text-red-400\">\n          {t('organization.noPermission')}\n        </div>\n      </div>\n    );\n  }\n\n  const handleCreateSuccess = () => {\n    fetchOrganization();\n  };\n\n  const handleJoinSuccess = () => {\n    // Nach Beitritt: Organisation neu laden\n    fetchOrganization();\n  };\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        {/* Titelzeile mit Action-Buttons */}\n        <div className=\"flex items-center mb-4 sm:mb-4\">\n          {/* Linke Seite: Action-Buttons */}\n          <div className=\"flex items-center\">\n            {/* Button: Neue Organisation erstellen - immer sichtbar (nicht nur fr Admins) */}\n            <button\n              onClick={() => setIsCreateModalOpen(true)}\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('organization.createOrganization')}\n              aria-label={t('organization.createOrganization')}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n            </button>\n            \n            {/* Button: Organisation beitreten - immer sichtbar */}\n            <button\n              onClick={() => setIsJoinModalOpen(true)}\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center ml-2\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('organization.joinOrganization')}\n              aria-label={t('organization.joinOrganization')}\n            >\n              <UserPlusIcon className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('common.loadingOrganization')}</span>\n        </div>\n      ) : (\n        <>\n          {/* Error/Info Display */}\n          {error && (\n            <div className={`mb-4 p-4 border rounded ${\n              !organization \n                ? 'bg-blue-50 dark:bg-blue-900/30 border-blue-400 dark:border-blue-700 text-blue-700 dark:text-blue-300'\n                : 'bg-red-100 dark:bg-red-900 border-red-400 dark:border-red-700 text-red-700 dark:text-red-300'\n            }`}>\n              <div className=\"flex items-start\">\n                <div className=\"flex-shrink-0\">\n                  {!organization ? (\n                    <UserGroupIcon className=\"h-5 w-5\" />\n                  ) : (\n                    <span className=\"text-red-600 dark:text-red-400\"></span>\n                  )}\n                </div>\n                <div className=\"ml-3 flex-1\">\n                  <p className=\"font-medium\">{error}</p>\n                  {!organization && (\n                    <p className=\"mt-2 text-sm\">{t('organization.createOrJoinHint')}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Card-Ansicht - nur anzeigen wenn Organisation existiert */}\n          {organization ? (\n            <>\n            {/* Card mit Organisations-Infos */}\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-4\">\n            <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white flex items-center\">\n                        <BuildingOfficeIcon className=\"h-5 w-5 mr-2\" />\n                        {organization.displayName || organization.name}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                        {organization.domain || t('organization.noDomain')}\n                      </p>\n            </div>\n                    {canManageOrganization() && (\n                      <button\n                        onClick={() => setIsEditModalOpen(true)}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                        title={t('organization.edit.title')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                      </button>\n                    )}\n            </div>\n\n                  {/* Organisations-Infos */}\n                  <div className=\"space-y-3\">\n                    {organization.subscriptionPlan && (\n            <div>\n                        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">{t('organization.subscriptionPlan')}:</span>\n                        <span className=\"ml-2 text-sm text-gray-900 dark:text-white capitalize\">{organization.subscriptionPlan}</span>\n              </div>\n            )}\n              </div>\n\n                  {/* Statistiken direkt in der Card */}\n          {stats && (\n                    <>\n            <div className=\"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700\">\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">{t('organization.statistics')}</h3>\n              {loadingStats ? (\n                <div className=\"flex items-center justify-center py-4\">\n                  <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-2\"></div>\n                  <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('common.loadingStatistics')}</span>\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {/* Benutzer Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-blue-100 dark:bg-blue-900/30 rounded-lg p-3\">\n                        <UserGroupIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.users')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats.currentUsers} / {stats.maxUsers}\n                        </p>\n                            {stats.utilizationPercent !== undefined && (\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            {stats.utilizationPercent}% {t('organization.utilizationPercent')}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Rollen Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-purple-100 dark:bg-purple-900/30 rounded-lg p-3\">\n                        <ShieldCheckIcon className=\"h-6 w-6 text-purple-600 dark:text-purple-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.roles')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats._count.roles}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Beitrittsanfragen Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg p-3\">\n                        <EnvelopeIcon className=\"h-6 w-6 text-yellow-600 dark:text-yellow-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.joinRequests')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats._count.joinRequests}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Einladungen Card */}\n                  {stats._count.invitations !== undefined && (\n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 bg-green-100 dark:bg-green-900/30 rounded-lg p-3\">\n                          <EnvelopeIcon className=\"h-6 w-6 text-green-600 dark:text-green-400\" />\n                        </div>\n                        <div className=\"ml-4\">\n                          <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.invitations')}</p>\n                          <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                            {stats._count.invitations}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Auslastung Card */}\n                  {stats.utilizationPercent !== undefined && (\n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg p-3\">\n                          <ChartBarIcon className=\"h-6 w-6 text-indigo-600 dark:text-indigo-400\" />\n                        </div>\n                        <div className=\"ml-4\">\n                          <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.utilization')}</p>\n                          <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                            {stats.utilizationPercent}%\n                          </p>\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            {stats.availableSlots} {t('organization.availableSlots')}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n                    </>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            </>\n          ) : (\n            /* Keine Organisation - zeige Hinweis */\n            <div className=\"text-center py-8\">\n            <UserGroupIcon className=\"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500 mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\n              {t('organization.notFound')}\n            </h3>\n            <p className=\"text-gray-600 dark:text-gray-400\">\n              {t('organization.createOrJoinHint')}\n            </p>\n          </div>\n        )}\n        </>\n      )}\n      </div>\n\n      {/* Meine Beitrittsanfragen - immer anzeigen */}\n      <MyJoinRequestsList />\n\n      {/* Modals */}\n      <CreateOrganizationModal\n        isOpen={isCreateModalOpen}\n        onClose={() => setIsCreateModalOpen(false)}\n        onSuccess={handleCreateSuccess}\n      />\n\n      <JoinOrganizationModal\n        isOpen={isJoinModalOpen}\n        onClose={() => setIsJoinModalOpen(false)}\n        onSuccess={handleJoinSuccess}\n      />\n\n      <EditOrganizationModal\n        isOpen={isEditModalOpen}\n        onClose={() => setIsEditModalOpen(false)}\n        onSuccess={handleEditSuccess}\n        organization={organization}\n      />\n    </>\n  );\n};\n\nexport default OrganizationSettings; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon, XCircleIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest, ProcessJoinRequestRequest } from '../../types/organization.ts';\nimport { roleApi } from '../../api/apiClient.ts';\nimport { Role } from '../../types/interfaces.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  joinRequest: OrganizationJoinRequest | null;\n  onSuccess: () => void;\n}\n\nconst ProcessJoinRequestModal: React.FC<Props> = ({ isOpen, onClose, joinRequest, onSuccess }) => {\n  const { t } = useTranslation();\n  const [action, setAction] = useState<'approve' | 'reject'>('approve');\n  const [roleId, setRoleId] = useState<number | null>(null);\n  const [response, setResponse] = useState<string>('');\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState<boolean>(false);\n  const [saving, setSaving] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  useEffect(() => {\n    if (isOpen && joinRequest) {\n      // Reset form when modal opens\n      setAction('approve');\n      setRoleId(null);\n      setResponse('');\n      setErrors({});\n      \n      // Load roles for the organization\n      if (joinRequest.organizationId) {\n        fetchRoles();\n      }\n    }\n  }, [isOpen, joinRequest]);\n\n  const fetchRoles = async () => {\n    try {\n      setLoadingRoles(true);\n      const response = await roleApi.getAll();\n      if (response.data && Array.isArray(response.data)) {\n        setRoles(response.data);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Rollen:', err);\n      showMessage(t('joinRequest.loadRolesError'), 'error');\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (action === 'approve' && !roleId) {\n      newErrors.roleId = t('joinRequest.selectRoleError');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    if (!joinRequest) {\n      return;\n    }\n    \n    try {\n      setSaving(true);\n      const data: ProcessJoinRequestRequest = {\n        action,\n        response: response.trim() || undefined,\n        roleId: action === 'approve' ? roleId || undefined : undefined\n      };\n      \n      await organizationService.processJoinRequest(joinRequest.id, data);\n      showMessage(\n        action === 'approve' ? t('joinRequest.approveSuccess') : t('joinRequest.rejectSuccess'),\n        'success'\n      );\n      \n      // Reset form\n      setAction('approve');\n      setRoleId(null);\n      setResponse('');\n      setErrors({});\n      \n      onClose();\n      onSuccess();\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('joinRequest.processError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleClose = () => {\n    setAction('approve');\n    setRoleId(null);\n    setResponse('');\n    setErrors({});\n    onClose();\n  };\n\n  if (!joinRequest) {\n    return null;\n  }\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('joinRequest.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                {/* Antragsteller Info */}\n                <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                  <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.applicant')}:</p>\n                  <p className=\"text-sm text-gray-900 dark:text-white\">\n                    {joinRequest.requester.firstName} {joinRequest.requester.lastName}\n                  </p>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.requester.email}</p>\n                  {joinRequest.message && (\n                    <div className=\"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.message')}:</p>\n                      <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.message}</p>\n                    </div>\n                  )}\n                </div>\n\n                {/* Aktion (Genehmigen/Ablehnen) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('joinRequest.actionRequired')}\n                  </label>\n                  <div className=\"flex gap-4 mt-2\">\n                    <label className=\"flex items-center\">\n                      <input\n                        type=\"radio\"\n                        value=\"approve\"\n                        checked={action === 'approve'}\n                        onChange={(e) => {\n                          setAction(e.target.value as 'approve' | 'reject');\n                          setErrors({});\n                        }}\n                        className=\"mr-2 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.approve')}</span>\n                    </label>\n                    <label className=\"flex items-center\">\n                      <input\n                        type=\"radio\"\n                        value=\"reject\"\n                        checked={action === 'reject'}\n                        onChange={(e) => {\n                          setAction(e.target.value as 'approve' | 'reject');\n                          setErrors({});\n                        }}\n                        className=\"mr-2 text-red-600 focus:ring-red-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.reject')}</span>\n                    </label>\n                  </div>\n                </div>\n\n                {/* Rollenauswahl (nur bei Genehmigung) */}\n                {action === 'approve' && (\n                  <div>\n                    <label \n                      htmlFor=\"roleId\" \n                      className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                    >\n                      {t('joinRequest.assignRole')}\n                    </label>\n                    {loadingRoles ? (\n                      <div className=\"flex items-center py-2\">\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n                        <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('joinRequest.loadingRoles')}</span>\n                      </div>\n                    ) : (\n                      <select\n                        id=\"roleId\"\n                        value={roleId || ''}\n                        onChange={(e) => {\n                          setRoleId(Number(e.target.value) || null);\n                          if (errors.roleId) {\n                            setErrors(prev => ({ ...prev, roleId: '' }));\n                          }\n                        }}\n                        className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                          errors.roleId \n                            ? 'border-red-300 dark:border-red-600' \n                            : 'border-gray-300 dark:border-gray-600'\n                        }`}\n                      >\n                        <option value=\"\">{t('joinRequest.selectRole')}</option>\n                        {roles.map(role => (\n                          <option key={role.id} value={role.id}>\n                            {role.name} {role.description ? `- ${role.description}` : ''}\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                    {errors.roleId && (\n                      <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.roleId}</p>\n                    )}\n                  </div>\n                )}\n\n                {/* Antwort-Message */}\n                <div>\n                  <label \n                    htmlFor=\"response\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('joinRequest.response')}\n                  </label>\n                  <textarea\n                    id=\"response\"\n                    value={response}\n                    onChange={(e) => setResponse(e.target.value)}\n                    rows={3}\n                    placeholder={t('joinRequest.addOptional', { type: action === 'approve' ? t('joinRequest.welcomeMessage') : t('joinRequest.rejectionReason') })}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={saving}\n                  className={`p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ${\n                    action === 'approve'\n                      ? 'bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500'\n                      : 'bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500'\n                  }`}\n                  title={saving ? (action === 'approve' ? t('joinRequest.approving') : t('joinRequest.rejecting')) : (action === 'approve' ? t('joinRequest.approve') : t('joinRequest.reject'))}\n                >\n                  {saving ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : action === 'approve' ? (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  ) : (\n                    <XCircleIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('joinRequest.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Antragsteller Info */}\n            <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n              <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.applicant')}:</p>\n              <p className=\"text-sm text-gray-900 dark:text-white\">\n                {joinRequest.requester.firstName} {joinRequest.requester.lastName}\n              </p>\n              <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.requester.email}</p>\n              {joinRequest.message && (\n                <div className=\"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600\">\n                  <p className=\"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.message')}:</p>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.message}</p>\n                </div>\n              )}\n            </div>\n\n            {/* Aktion (Genehmigen/Ablehnen) */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('joinRequest.actionRequired')}\n              </label>\n              <div className=\"flex gap-4 mt-2\">\n                <label className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    value=\"approve\"\n                    checked={action === 'approve'}\n                    onChange={(e) => {\n                      setAction(e.target.value as 'approve' | 'reject');\n                      setErrors({});\n                    }}\n                    className=\"mr-2 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.approve')}</span>\n                </label>\n                <label className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    value=\"reject\"\n                    checked={action === 'reject'}\n                    onChange={(e) => {\n                      setAction(e.target.value as 'approve' | 'reject');\n                      setErrors({});\n                    }}\n                    className=\"mr-2 text-red-600 focus:ring-red-500\"\n                  />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.reject')}</span>\n                </label>\n              </div>\n            </div>\n\n            {/* Rollenauswahl (nur bei Genehmigung) */}\n            {action === 'approve' && (\n              <div>\n                <label \n                  htmlFor=\"roleId\" \n                  className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                >\n                  {t('joinRequest.assignRole')}\n                </label>\n                {loadingRoles ? (\n                  <div className=\"flex items-center py-2\">\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n                    <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('joinRequest.loadingRoles')}</span>\n                  </div>\n                ) : (\n                  <select\n                    id=\"roleId\"\n                    value={roleId || ''}\n                    onChange={(e) => {\n                      setRoleId(Number(e.target.value) || null);\n                      if (errors.roleId) {\n                        setErrors(prev => ({ ...prev, roleId: '' }));\n                      }\n                    }}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.roleId \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  >\n                    <option value=\"\">{t('joinRequest.selectRole')}</option>\n                    {roles.map(role => (\n                      <option key={role.id} value={role.id}>\n                        {role.name} {role.description ? `- ${role.description}` : ''}\n                      </option>\n                    ))}\n                  </select>\n                )}\n                {errors.roleId && (\n                  <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.roleId}</p>\n                )}\n              </div>\n            )}\n\n            {/* Antwort-Message */}\n            <div>\n              <label \n                htmlFor=\"response\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('joinRequest.response')}\n              </label>\n              <textarea\n                id=\"response\"\n                value={response}\n                onChange={(e) => setResponse(e.target.value)}\n                rows={3}\n                placeholder={t('joinRequest.addOptional', { type: action === 'approve' ? t('joinRequest.welcomeMessage') : t('joinRequest.rejectionReason') })}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={saving}\n                className={`p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ${\n                  action === 'approve'\n                    ? 'bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500'\n                    : 'bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500'\n                }`}\n                title={saving ? (action === 'approve' ? 'Genehmige...' : 'Lehne ab...') : (action === 'approve' ? 'Genehmigen' : 'Ablehnen')}\n              >\n                {saving ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : action === 'approve' ? (\n                  <CheckIcon className=\"h-5 w-5\" />\n                ) : (\n                  <XCircleIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default ProcessJoinRequestModal;\n\n","import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { UserPlusIcon, FunnelIcon, PencilIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest } from '../../types/organization.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport ProcessJoinRequestModal from './ProcessJoinRequestModal.tsx';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\n\n// Status-Badge Funktionen\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case 'pending':\n      return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';\n    case 'approved':\n      return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\n    case 'rejected':\n      return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\n    case 'withdrawn':\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n    default:\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n  }\n};\n\nconst getStatusText = (status: string, t: any) => {\n  switch (status) {\n    case 'pending':\n      return t('joinRequestsList.status.pending');\n    case 'approved':\n      return t('joinRequestsList.status.approved');\n    case 'rejected':\n      return t('joinRequestsList.status.rejected');\n    case 'withdrawn':\n      return t('joinRequestsList.status.withdrawn');\n    default:\n      return status;\n  }\n};\n\nconst JOIN_REQUESTS_TABLE_ID = 'join-requests-table';\n\nconst JoinRequestsList: React.FC = () => {\n  const { t } = useTranslation();\n  const [joinRequests, setJoinRequests] = useState<OrganizationJoinRequest[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState<boolean>(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [isProcessModalOpen, setIsProcessModalOpen] = useState<boolean>(false);\n  const [selectedRequest, setSelectedRequest] = useState<OrganizationJoinRequest | null>(null);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  const { canViewJoinRequests, canManageJoinRequests, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  const mountedRef = useRef(true);\n  const hasInitialLoadRef = useRef(false);\n\n  // Debug: Log permissionsLoading nderungen\n  useEffect(() => {\n    console.log('[JoinRequestsList] permissionsLoading gendert:', permissionsLoading);\n  }, [permissionsLoading]);\n\n  // Reset beim Mount - wichtig fr Neuladen wenn Komponente neu gemountet wird\n  useEffect(() => {\n    console.log('[JoinRequestsList] Component mounted, reset hasInitialLoadRef');\n    hasInitialLoadRef.current = false;\n    mountedRef.current = true;\n    \n    return () => {\n      console.log('[JoinRequestsList] Component unmounting');\n      mountedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    console.log('[JoinRequestsList] useEffect triggered', { \n      permissionsLoading, \n      hasInitialLoad: hasInitialLoadRef.current,\n      joinRequestsCount: joinRequests.length \n    });\n    \n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      console.log('[JoinRequestsList] Warte auf Berechtigungen...');\n      return;\n    }\n\n    // Prfe Berechtigung direkt\n    const hasPermission = canViewJoinRequests();\n    console.log('[JoinRequestsList] Berechtigung geprft:', hasPermission);\n    \n    if (!hasPermission) {\n      console.log('[JoinRequestsList] Keine Berechtigung zum Anzeigen');\n      setError(t('joinRequestsList.noPermission'));\n      setLoading(false);\n      hasInitialLoadRef.current = true;\n      return;\n    }\n\n    // WICHTIG: Nur laden wenn noch nicht erfolgreich geladen wurde\n    // Das verhindert unntige Re-Fetches bei jedem permissionsLoading-Change\n    if (hasInitialLoadRef.current) {\n      console.log('[JoinRequestsList] Bereits geladen, berspringe Fetch');\n      return;\n    }\n\n    console.log('[JoinRequestsList] Starte Fetch der Join Requests...');\n    \n    const fetchJoinRequests = async () => {\n      if (!mountedRef.current) {\n        console.log('[JoinRequestsList] Component unmounted, breche ab');\n        return;\n      }\n      \n      try {\n        console.log('[JoinRequestsList] Setze loading auf true');\n        setLoading(true);\n        setError(null);\n        \n        console.log('[JoinRequestsList] Rufe organizationService.getJoinRequests() auf...');\n        console.log('[JoinRequestsList] API Endpoint:', API_ENDPOINTS.ORGANIZATIONS.JOIN_REQUESTS);\n        \n        const requests = await organizationService.getJoinRequests();\n        \n        console.log('[JoinRequestsList] Antwort erhalten:', requests);\n        console.log('[JoinRequestsList] Antwort Typ:', typeof requests);\n        console.log('[JoinRequestsList] Ist Array:', Array.isArray(requests));\n        console.log('[JoinRequestsList] Ist null/undefined:', requests === null || requests === undefined);\n        \n        if (!mountedRef.current) {\n          console.log('[JoinRequestsList] Component whrend Request unmounted');\n          return;\n        }\n        \n        // Validiere, dass die Antwort vorhanden ist\n        if (requests === null || requests === undefined) {\n          console.error('[JoinRequestsList]  Antwort ist null oder undefined!');\n          throw new Error('Ungltige Antwort vom Server: Antwort ist null oder undefined');\n        }\n        \n        // Validiere, dass die Antwort ein Array ist\n        if (!Array.isArray(requests)) {\n          console.error('[JoinRequestsList]  Antwort ist kein Array!', requests);\n          throw new Error('Ungltige Antwort vom Server: Erwartetes Array, erhalten: ' + typeof requests);\n        }\n        \n        console.log('[JoinRequestsList]  Setze', requests.length, 'Join Requests');\n        setJoinRequests(requests);\n        setError(null); // Fehler zurcksetzen bei Erfolg\n        hasInitialLoadRef.current = true; // Nur bei Erfolg setzen\n      } catch (err: any) {\n        console.error('[JoinRequestsList]  Fehler beim Laden:', err);\n        console.error('[JoinRequestsList] Fehler Details:', {\n          message: err.message,\n          response: err.response,\n          status: err.response?.status,\n          data: err.response?.data,\n          stack: err.stack\n        });\n        \n        if (!mountedRef.current) {\n          console.log('[JoinRequestsList] Component whrend Error-Handling unmounted');\n          return;\n        }\n        \n        const errorMessage = err.response?.data?.message || err.message || t('joinRequestsList.loadError', { defaultValue: 'Fehler beim Laden der Beitrittsanfragen' });\n        console.log('[JoinRequestsList] Zeige Fehlermeldung:', errorMessage);\n        setError(errorMessage);\n        // showMessage nur auerhalb useEffect verwenden, um Re-Renders zu vermeiden\n        // Verwende setTimeout, um es asynchron auszufhren\n        setTimeout(() => {\n          showMessage(errorMessage, 'error');\n        }, 0);\n        // Bei Fehler NICHT hasInitialLoadRef setzen, damit bei nchstem permissionsLoading-Change neu geladen wird\n      } finally {\n        if (mountedRef.current) {\n          console.log('[JoinRequestsList] Setze loading auf false');\n          setLoading(false);\n        }\n      }\n    };\n\n    fetchJoinRequests();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [permissionsLoading]); // canViewJoinRequests ist eine Funktion, nicht als Dependency\n\n  const handleOpenProcessModal = (request: OrganizationJoinRequest) => {\n    if (!canManageJoinRequests()) {\n      const errorMessage = t('joinRequestsList.noPermissionEdit');\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n      return;\n    }\n    setSelectedRequest(request);\n    setIsProcessModalOpen(true);\n  };\n\n  const handleProcessSuccess = async () => {\n    // Neulade die Liste nach erfolgreicher Bearbeitung\n    // Reset das Flag, damit neu geladen werden kann\n    hasInitialLoadRef.current = false;\n    \n    try {\n      setLoading(true);\n      const requests = await organizationService.getJoinRequests();\n      setJoinRequests(requests);\n      setError(null);\n      hasInitialLoadRef.current = true;\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || 'Fehler beim Laden der Beitrittsanfragen';\n      setError(errorMessage);\n      hasInitialLoadRef.current = true;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Filter-Funktionen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n\n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  // Initialer Default-Filter setzen (Controlled Mode)\n  useEffect(() => {\n    const setInitialFilter = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(JOIN_REQUESTS_TABLE_ID));\n        const filters = response.data;\n        \n        const alleFilter = filters.find((filter: any) => filter.name === 'Alle');\n        if (alleFilter) {\n          setActiveFilterName('Alle');\n          setSelectedFilterId(alleFilter.id);\n          applyFilterConditions(alleFilter.conditions, alleFilter.operators);\n        }\n      } catch (error) {\n        console.error('Fehler beim Setzen des initialen Filters:', error);\n      }\n    };\n\n    setInitialFilter();\n  }, []);\n\n  // Standard-Filter erstellen und speichern\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(JOIN_REQUESTS_TABLE_ID)\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: JOIN_REQUESTS_TABLE_ID,\n            name: 'Alle',\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\n            alleFilter\n          );\n          console.log('Alle-Filter fr Join Requests erstellt');\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []);\n\n  // Gefilterte Join-Requests\n  const filteredJoinRequests = useMemo(() => {\n    let filtered = [...joinRequests];\n\n    // Suchfeld-Filter\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(request => {\n        const requesterName = `${request.requester.firstName} ${request.requester.lastName}`.toLowerCase();\n        const requesterEmail = request.requester.email?.toLowerCase() || '';\n        const message = request.message?.toLowerCase() || '';\n        return requesterName.includes(searchLower) || requesterEmail.includes(searchLower) || message.includes(searchLower);\n      });\n    }\n\n    // Filter-Bedingungen aus FilterPane\n    if (filterConditions.length > 0) {\n      filtered = filterConditions.reduce((acc, condition, index) => {\n        if (!condition.column || condition.value === null || condition.value === '') {\n          return acc;\n        }\n\n        const operator = condition.operator;\n        const value = condition.value;\n\n        return acc.filter(request => {\n          switch (condition.column) {\n            case 'requester':\n              const requesterName = `${request.requester.firstName} ${request.requester.lastName}`.toLowerCase();\n              const requesterEmail = request.requester.email?.toLowerCase() || '';\n              const searchValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return requesterName.includes(searchValue) || requesterEmail.includes(searchValue);\n              } else if (operator === 'equals') {\n                return requesterName === searchValue || requesterEmail === searchValue;\n              } else if (operator === 'startsWith') {\n                return requesterName.startsWith(searchValue) || requesterEmail.startsWith(searchValue);\n    }\n              return false;\n\n            case 'message':\n              const message = request.message?.toLowerCase() || '';\n              const msgValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return message.includes(msgValue);\n              } else if (operator === 'equals') {\n                return message === msgValue;\n              } else if (operator === 'startsWith') {\n                return message.startsWith(msgValue);\n              }\n              return false;\n\n            case 'status':\n              if (operator === 'equals') {\n                return request.status === value;\n              }\n              return false;\n\n            default:\n              return true;\n          }\n        });\n      }, filtered);\n    }\n\n    return filtered;\n  }, [joinRequests, searchTerm, filterConditions, filterLogicalOperators]);\n\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('joinRequestsList.loadingPermissions')}</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canViewJoinRequests()) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n      <div className=\"p-4 text-red-600 dark:text-red-400\">\n        {t('joinRequestsList.noPermission')}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 sm:p-6 mb-6\">\n      {/* Titelzeile mit Icon, Suchfeld, Filter-Button */}\n      <div className=\"flex items-center justify-between mb-4 sm:mb-4\">\n        <h2 className=\"text-xl sm:text-xl font-semibold flex items-center dark:text-white\">\n          <UserPlusIcon className=\"h-6 w-6 sm:h-6 sm:w-6 mr-2 sm:mr-2\" />\n          {t('joinRequestsList.title')}\n        </h2>\n        \n        <div className=\"flex items-center gap-1.5\">\n          {/* Suchfeld */}\n          <input\n            type=\"text\"\n            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n\n          {/* Filter-Button */}\n          <button\n            className={`p-2 rounded-md border ${getActiveFilterCount() > 0 ? 'border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n            onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n            title={t('common.filter')}\n          >\n            <FunnelIcon className=\"h-5 w-5\" />\n            {getActiveFilterCount() > 0 && (\n              <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                {getActiveFilterCount()}\n              </span>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Filter-Panel */}\n      {isFilterPanelOpen && (\n        <div className=\"mb-4\">\n          <FilterPane\n            columns={[\n              { id: 'requester', label: t('joinRequestsList.filter.requester') },\n              { id: 'message', label: t('joinRequestsList.filter.message') },\n              { id: 'status', label: t('joinRequestsList.status.title', { defaultValue: 'Status' }) }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={JOIN_REQUESTS_TABLE_ID}\n          />\n        </div>\n      )}\n\n      {/* Gespeicherte Filter als Tags anzeigen */}\n      <SavedFilterTags\n        tableId={JOIN_REQUESTS_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n        defaultFilterName=\"Alle\"\n      />\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded\">\n          {error}\n        </div>\n      )}\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('joinRequestsList.loading')}</span>\n        </div>\n      ) : filteredJoinRequests.length === 0 ? (\n        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n          {joinRequests.length === 0 \n            ? t('joinRequestsList.noRequests')\n            : t('joinRequestsList.noMatching')}\n        </div>\n      ) : (\n        /* Cards fr Join-Requests */\n        <div className=\"space-y-4\">\n          {filteredJoinRequests.map(request => (\n            <div\n              key={request.id}\n              className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\"\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                        {request.requester.firstName} {request.requester.lastName}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        {request.requester.email}\n              </p>\n                    </div>\n                    <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(request.status)}`}>\n                      {getStatusText(request.status, t)}\n                    </span>\n                  </div>\n\n                  {request.message && (\n                    <div className=\"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.filter.message')}:</span> {request.message}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.response && (\n                    <div className=\"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700\">\n                      <p className=\"text-sm text-blue-700 dark:text-blue-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.response')}:</span> {request.response}\n                      </p>\n                    </div>\n                  )}\n\n              {request.status === 'pending' && canManageJoinRequests() && (\n                    <div className=\"mt-4 flex items-center gap-2\">\n                  <button \n                        onClick={() => handleOpenProcessModal(request)}\n                        className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-md dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center\"\n                      >\n                        <PencilIcon className=\"h-4 w-4 mr-1\" />\n                        {t('joinRequestsList.edit')}\n                  </button>\n                </div>\n              )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Process Join Request Modal */}\n      <ProcessJoinRequestModal\n        isOpen={isProcessModalOpen}\n        onClose={() => {\n          setIsProcessModalOpen(false);\n          setSelectedRequest(null);\n        }}\n        joinRequest={selectedRequest}\n        onSuccess={handleProcessSuccess}\n      />\n    </div>\n  );\n};\n\nexport default JoinRequestsList; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { UserGroupIcon, UserIcon, ShieldCheckIcon, MapPinIcon } from '@heroicons/react/24/outline';\nimport UserManagementTab from '../components/UserManagementTab.tsx';\nimport RoleManagementTab from '../components/RoleManagementTab.tsx';\nimport BranchManagementTab from '../components/BranchManagementTab.tsx';\nimport useMessage from '../hooks/useMessage.ts';\nimport OrganizationSettings from '../components/organization/OrganizationSettings.tsx';\nimport JoinRequestsList from '../components/organization/JoinRequestsList.tsx';\n\nconst Organisation: React.FC = () => {\n  const { t } = useTranslation();\n  // Gemeinsame States\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const { showMessage } = useMessage();\n\n  const { \n    isAdmin, \n    hasPermission, \n    canViewOrganization,\n    loading: permissionsLoading\n  } = usePermissions();\n\n  // Berechtigungen prfen\n  const canViewOrganisation = hasPermission('organization_management', 'read', 'page');\n  const canViewUsers = hasPermission('users', 'read', 'table');\n  const canViewRoles = hasPermission('roles', 'read', 'table');\n  const canViewBranches = hasPermission('branches', 'read', 'table');\n  const canViewOrg = canViewOrganization();\n\n  const [activeTabState, setActiveTabState] = useState<'users' | 'roles' | 'branches' | 'organization'>('users');\n  const isInitialized = useRef(false);\n\n  // Tab beim ersten Laden basierend auf Berechtigungen setzen (nur wenn Berechtigungen geladen sind)\n  // Reihenfolge: users -> roles -> branches -> organization\n  useEffect(() => {\n    if (!permissionsLoading && !isInitialized.current) {\n      let defaultTab: 'users' | 'roles' | 'branches' | 'organization' = 'organization'; // Fallback\n      \n      if (canViewUsers) {\n        defaultTab = 'users';\n      } else if (canViewRoles) {\n        defaultTab = 'roles';\n      } else if (canViewBranches) {\n        defaultTab = 'branches';\n      } else if (canViewOrg) {\n        defaultTab = 'organization';\n      }\n      \n      setActiveTabState(defaultTab);\n      isInitialized.current = true;\n    }\n  }, [permissionsLoading, canViewUsers, canViewRoles, canViewBranches, canViewOrg]);\n\n  // Tab-Wechsel Handler - Fehler beim Wechsel zurcksetzen\n  const handleTabChange = (tab: 'users' | 'roles' | 'branches' | 'organization') => {\n    // Prfe Berechtigung fr den Tab\n    if (tab === 'users' && !canViewUsers) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'roles' && !canViewRoles) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'branches' && !canViewBranches) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'organization' && !canViewOrg) {\n      return; // Tab nicht aktivierbar\n    }\n    setActiveTabState(tab);\n    setError(null);\n  };\n\n  // Gemeinsame Fehlerbehandlung\n  const handleError = (err: any) => {\n    let message = t('errors.unknownError');\n    if (err.response?.data?.message) {\n      message = err.response.data.message;\n    } else if (err instanceof Error) {\n      message = err.message;\n    }\n    setError(message);\n    showMessage(message, 'error');\n  };\n\n  // Keine Berechtigung fr die Seite\n  if (!canViewOrganisation) {\n    return <div className=\"p-4 text-red-600 dark:text-red-400\">{t('organisation.noPermission')}</div>;\n  }\n\n  return (\n    <div className=\"min-h-screen dark:bg-gray-900\">\n      <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          {/* Header mit Icon */}\n          <div className=\"flex items-center mb-6\">\n            <UserGroupIcon className=\"h-6 w-6 mr-2 dark:text-white\" />\n            <h2 className=\"text-xl font-semibold dark:text-white\">{t('organisation.title')}</h2>\n          </div>\n\n          {/* Tabs fr Navigation */}\n          <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n            <nav className=\"-mb-px flex space-x-8\">\n              {/* Users Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'users' && canViewUsers\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewUsers\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center relative`}\n                onClick={() => canViewUsers && handleTabChange('users')}\n                disabled={!canViewUsers}\n              >\n                <UserIcon className=\"h-5 w-5 mr-2\" />\n                {t('organisation.tabs.users')}\n                {!canViewUsers && (\n                  <span className=\"ml-2 px-2 py-0.5 text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Roles Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'roles' && canViewRoles\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewRoles\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center relative`}\n                onClick={() => canViewRoles && handleTabChange('roles')}\n                disabled={!canViewRoles}\n              >\n                <ShieldCheckIcon className=\"h-5 w-5 mr-2\" />\n                {t('organisation.tabs.roles')}\n                {!canViewRoles && (\n                  <span className=\"ml-2 px-2 py-0.5 text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Branches Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'branches' && canViewBranches\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewBranches\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center relative`}\n                onClick={() => canViewBranches && handleTabChange('branches')}\n                disabled={!canViewBranches}\n              >\n                <MapPinIcon className=\"h-5 w-5 mr-2\" />\n                {t('organisation.tabs.branches', { defaultValue: 'Niederlassungen' })}\n                {!canViewBranches && (\n                  <span className=\"ml-2 px-2 py-0.5 text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Organization Tab - sichtbar wenn berechtigt */}\n              {canViewOrg && (\n                <button\n                  className={`${\n                    activeTabState === 'organization'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                  } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`}\n                  onClick={() => handleTabChange('organization')}\n                >\n                  <UserGroupIcon className=\"h-5 w-5 mr-2\" />\n                  {t('organisation.tabs.organization')}\n                </button>\n              )}\n            </nav>\n          </div>\n\n          {error && (\n            <div className=\"bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded mb-4\">\n              <p className=\"font-bold\">{t('organisation.error')}</p>\n              <p>{error}</p>\n            </div>\n          )}\n\n          {loading && <div className=\"p-4 dark:text-gray-300\">{t('organisation.loading')}</div>}\n\n          {/* Tab Inhalte */}\n          <div className=\"mt-6\">\n            {activeTabState === 'users' ? (\n              canViewUsers ? (\n                <UserManagementTab onError={handleError} />\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.users')}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'roles' ? (\n              canViewRoles ? (\n                <RoleManagementTab onError={handleError} />\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.roles')}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'branches' ? (\n              canViewBranches ? (\n                <BranchManagementTab onError={handleError} />\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.branches', { defaultValue: 'Niederlassungs-Verwaltung ist eine PRO-Funktion' })}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'organization' && canViewOrg ? (\n              <div className=\"space-y-6\">\n                <OrganizationSettings />\n                <JoinRequestsList />\n              </div>\n            ) : (\n              <div className=\"p-4 text-red-600 dark:text-red-400\">\n                {t('organisation.noPermissionForPage')}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Organisation;\n\n\n"],"names":["_ref","isOpen","onClose","onCertificateCreated","userId","userName","t","useTranslation","user","currentUser","useAuth","isHR","isAdmin","loading","permissionsLoading","usePermissions","openSidepane","closeSidepane","useSidepane","showMessage","useMessage","isMobile","setIsMobile","useState","window","innerWidth","isLargeScreen","setIsLargeScreen","activeTab","setActiveTab","setLoading","error","setError","userData","setUserData","issueDate","setIssueDate","Date","toISOString","split","certificateType","setCertificateType","pdfFile","setPdfFile","pdfPreviewUrl","setPdfPreviewUrl","uploading","setUploading","availableTemplates","setAvailableTemplates","selectedTemplate","setSelectedTemplate","useTemplate","setUseTemplate","fileInputRef","useRef","useEffect","handleResize","addEventListener","removeEventListener","fetchUserData","fetchTemplates","async","documentTemplates","axiosInstance","get","API_ENDPOINTS","ORGANIZATION_LIFECYCLE","DOCUMENT_TEMPLATES","data","templates","employmentCertificate","push","type","version","path","length","err","console","userResponse","lifecycleResponse","Promise","all","USERS","BY_ID","LIFECYCLE","BY_USER","lifecycle","userDataObj","firstName","lastName","identificationNumber","contractStartDate","contractEndDate","contractType","salary","position","URL","revokeObjectURL","_jsxs","Dialog","open","className","children","_jsx","Panel","concat","style","animation","DocumentTextIcon","Title","onClick","XMarkIcon","_Fragment","UserIcon","CalendarIcon","toLocaleDateString","value","onChange","e","target","max","required","undefined","id","checked","map","template","ref","accept","event","_event$target$files","file","files","size","url","createObjectURL","name","toFixed","current","_fileInputRef$current","click","src","height","title","preventDefault","validationError","validateForm","issueDateObj","isNaN","getTime","pdfPath","templateUsed","templateVersion","find","now","certificateData","post","CERTIFICATES","_err$response","_err$response$data","response","message","disabled","ArrowPathIcon","CheckIcon","onContractCreated","setContractType","startDate","setStartDate","endDate","setEndDate","setSalary","workingHours","setWorkingHours","setPosition","employmentContract","toString","min","placeholder","CurrencyDollarIcon","parseFloat","step","startDateObj","endDateObj","contractData","CONTRACTS","onCertificateUpdated","certificate","existingPdfUrl","setExistingPdfUrl","CERTIFICATE_DOWNLOAD","handleSubmit","updateData","put","CERTIFICATE","onSubmit","onContractUpdated","contract","CONTRACT_DOWNLOAD","CONTRACT","lifecycleId","onUpdate","isLegal","registrations","setRegistrations","arl","eps","pension","caja","editingType","setEditingType","formData","setFormData","status","registrationNumber","provider","registrationDate","notes","saving","setSaving","loadingRef","abortControllerRef","loadRegistrations","useCallback","abort","abortController","AbortController","registrationPromises","signal","aborted","registration","SOCIAL_SECURITY","timeout","_error$response","_error$message","code","includes","warn","results","newRegistrations","forEach","_ref2","registrationType","number","registeredAt","completedAt","handleCancel","handleSave","defaultValue","resolve","setTimeout","_error$response2","_error$response2$data","getStatusIcon","CheckCircleIcon","ClockIcon","XCircleIcon","getStatusLabel","labelKey","getTypeLabel","isEditing","_objectSpread","rows","handleEdit","PencilIcon","onOffboardingStarted","exitDate","setExitDate","exitReason","setExitReason","validationErrors","setValidationErrors","today","errors","selectedDate","setHours","maxDate","setFullYear","getFullYear","trim","Object","keys","STATUS","errorMessage","renderForm","ExclamationTriangleIcon","htmlFor","prev","ArrowRightIcon","opacity","transition","pointerEvents","role","onOffboardingCompleted","offboardingTasks","confirmText","setConfirmText","completedTasks","filter","task","allTasksCompleted","requiredConfirmText","toLowerCase","isCompleted","_lifecycleData$lifecy","lifecycleData","setLifecycleData","certificates","setCertificates","contracts","setContracts","setOffboardingTasks","isCertificateCreateModalOpen","setIsCertificateCreateModalOpen","isContractCreateModalOpen","setIsContractCreateModalOpen","editingCertificate","setEditingCertificate","editingContract","setEditingContract","downloadingCertId","setDownloadingCertId","downloadingContractId","setDownloadingContractId","isOffboardingStartModalOpen","setIsOffboardingStartModalOpen","isOffboardingCompleteModalOpen","setIsOffboardingCompleteModalOpen","isEditContractDatesModalOpen","setIsEditContractDatesModalOpen","editingContractStartDate","setEditingContractStartDate","editingContractEndDate","setEditingContractEndDate","fetchDataRef","fetchData","force","arguments","_certsResponse$data","_contractsResponse$da","_lifecycleResponse$da","_lifecycleResponse$da2","_lifecycleResponse$da3","_lifecycleResponse$da4","certsResponse","contractsResponse","tasksResponse","TASKS","catch","allTasks","offboardingTaskTitles","filteredTasks","progress","percent","handleEditContractDates","formatDate","dateString","year","month","day","socialSecurityRegistrations","BuildingOfficeIcon","clickable","config","onboarding","color","active","contract_change","offboarding","archived","getStatusBadge","onboardingStartedAt","onboardingCompletedAt","offboardingStartedAt","completed","total","width","totalTasks","Math","round","description","PlusIcon","cert","isLatest","generatedByUser","certId","responseType","blob","Blob","downloadUrl","link","document","createElement","href","download","body","appendChild","removeChild","handleDownloadCertificate","ArrowDownTrayIcon","toLocaleString","currency","contractId","handleDownloadContract","SocialSecurityEditor","CertificateCreationModal","ContractCreationModal","CertificateEditModal","ContractEditModal","OffboardingStartModal","OffboardingCompleteModal","CONTRACT_TYPES","onError","COUNTRIES","PAYROLL_COUNTRIES","LANGUAGES","users","setUsers","selectedUser","setSelectedUser","userFormData","setUserFormData","isEditingUser","setIsEditingUser","selectedRoles","setSelectedRoles","lifecycleRefreshKey","setLifecycleRefreshKey","isDebugMode","setIsDebugMode","roleWarning","setRoleWarning","roles","setRoles","loadingRoles","setLoadingRoles","activeUserTab","setActiveUserTab","userFilterTab","setUserFilterTab","isCreateModalOpen","setIsCreateModalOpen","newUserFormData","setNewUserFormData","email","password","allUsers","setAllUsers","fetchAllUsers","userApi","getAll","filterUsersByActiveStatus","handleError","sorted","isActive","sort","a","b","aUsername","username","bUsername","aFirstName","bFirstName","localeCompare","fetchUserDetails","log","getById","birthday","roleIds","Array","isArray","userRole","roleId","r","fallbackRoles","permissions","roleApi","fetchRoles","Error","handleUserInputChange","finalValue","Number","toggleRole","isRoleSelected","newSelectedRoles","updateRoles","handleNewUserInputChange","handleCreateUser","match","create","newUser","prevUsers","_err$response5","_err$response5$data","parseInt","UserCircleIcon","ShieldCheckIcon","_userFormData$usernam","_userFormData$email","_userFormData$firstNa","_userFormData$lastNam","dataToSend","normalWorkingHours","hourlyRate","monthlySalary","update","updatedData","_err$response2","_err$response4","_err$response3","_err$response3$data","errorMsg","bankDetails","country","language","payrollCountry","handleCancelEdit","currentUserId","localStorage","getItem","currentActiveStatus","newActiveStatus","selectedUserActive","updatePayload","IdentificationDocumentList","some","ids","join","isFixedRole","xmlns","viewBox","fill","fillRule","d","clipRule","LifecycleView","alwaysVisiblePages","defaultPages","defaultTables","defaultButtons","tableToPageMapping","buttonToPageMapping","buttonToTableMapping","ROLES_TABLE_ID","STANDARD_ROLE_IDS","STANDARD_ROLE_NAMES","isStandardRole","roleName","RoleCard","onEdit","onDelete","onCopy","canEdit","canDelete","canCopy","DocumentDuplicateIcon","TrashIcon","perm","accessLevel","slice","permission","entity","entityType","onRolesChange","readOnly","isModalOpen","setIsModalOpen","editingRole","setEditingRole","pageDisplayNames","useMemo","tableDisplayNames","buttonDisplayNames","page","table","button","hasPermission","searchTerm","setSearchTerm","isFilterModalOpen","setIsFilterModalOpen","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","handleValidationError","useError","isAddPermissionModalOpen","setIsAddPermissionModalOpen","selectedPermission","setSelectedPermission","displayLimit","setDisplayLimit","component","action","filteredPermissions","category","ErrorCategory","PERMISSION","updateError","meta","cause","createError","resetForm","handleDelete","confirm","delete","deleteError","refreshError","handleCopyRole","copiedRoleData","prevRoles","prepareRoleForEditing","allPermissions","existingPermIndex","findIndex","p","setAllPagePermissions","newPermissions","permIndex","indexOf","setAllTablePermissions","setAllButtonPermissions","getActiveFilterCount","filteredAndSortedRoles","searchLower","result","i","condition","conditionMet","column","operator","startsWith","count","existingFilters","SAVED_FILTERS","BY_TABLE","alleFilter","tableId","conditions","operators","BASE","createStandardFilters","applyFilterConditions","setInitialFilter","resetFilterConditions","FunnelIcon","FilterPane","columns","label","onApply","onReset","savedConditions","savedOperators","SavedFilterTags","onSelectFilter","onFilterChange","handleFilterChange","defaultFilterName","prevLimit","ChevronDownIcon","index","tablePerm","aName","bName","priorityOrder","aIndex","bIndex","tableIndex","tablePermIndex","isTableActive","tableEntity","tableDisplayName","relatedButtons","buttonPerm","order","buttonIndex","buttonPermIndex","isButtonActive","buttonDisplayName","BranchCard","branch","BRANCHES_TABLE_ID","editingBranch","setEditingBranch","branches","setBranches","canCreate","fetchBranches","BRANCHES","_error$response$data","handleCloseModal","UPDATE","CREATE","DELETE","branchId","_error$response3","_error$response3$data","filteredAndSortedBranches","handleCreate","autoFocus","onSuccess","displayName","domain","setErrors","fetchCurrentUser","checkScreenSize","handleChange","newErrors","organizationService","createOrganization","submit","handleClose","organizationName","searching","setSearching","organizations","setOrganizations","showDropdown","setShowDropdown","selectedOrganization","setSelectedOrganization","searchTimeoutRef","dropdownRef","handleClickOutside","contains","handleOrganizationInputChange","clearTimeout","searchOrganizations","handleSelectOrganization","org","handleMessageChange","createJoinRequest","organization","onSave","lifecycleRoles","setLifecycleRoles","loadRoles","loadLifecycleRoles","LIFECYCLE_ROLES","handleAssignStandardRoles","adminRole","hrRole","legalRole","adminRoleId","hrRoleId","legalRoleId","prepareRoleId","employeeRoleIds","SignatureUploadSection","onUpload","signatures","setSignatures","signatureType","setSignatureType","signerName","setSignerName","signerPosition","setSignerPosition","positionX","setPositionX","positionY","setPositionY","positionPage","setPositionPage","React","loadSignatures","documentSignatures","DOCUMENT_SIGNATURES","signaturesList","_error$response5","_error$response6","_error$response6$data","_event$target$files2","FormData","append","UPLOAD_SIGNATURE","headers","_error$response7","_error$response7$data","_fileInputRef$current2","signature","x","y","settings","ORGANIZATIONS","CURRENT","typeKey","_error$response8","_error$response8$data","handleDeleteSignature","FieldPositionConfiguration","_ref3","templateType","setTemplateType","fields","setFields","certificateFields","contractFields","loadFields","_settings$documentTem","templateSettings","savedFields","margin","lineHeight","currentY","defaultFields","fieldList","defaultPositions","fontSize","currentDate","fieldName","handleFieldChange","property","fieldLabels","_fields$fieldName","_fields$fieldName2","_fields$fieldName3","resetFields","currentSettings","updateOrganization","_error$response9","_error$response9$data","setTemplates","loadTemplates","templatesList","filePath","UPLOAD_TEMPLATE","_error$response4","_error$response4$data","handleDeleteTemplate","smtpSettings","setSmtpSettings","smtpHost","smtpPort","smtpUser","smtpPass","smtpFromEmail","smtpFromName","showPassword","setShowPassword","_settings$smtpPort","EnvelopeIcon","stroke","strokeLinecap","strokeLinejoin","strokeWidth","handleClear","ALLOWED_DOMAINS","lobbyPms","ttlock","sire","boldPayment","validateApiUrl","service","parsed","hostname","endsWith","canManageOrganization","apiSettings","setApiSettings","lobbyPmsApiKey","lobbyPmsPropertyId","lobbyPmsSyncEnabled","lobbyPmsAutoCreateTasks","lobbyPmsLateCheckInThreshold","ttlockClientId","ttlockClientSecret","ttlockApiUrl","ttlockUsername","ttlockPassword","ttlockPasscodeType","sireApiUrl","sireApiKey","sireApiSecret","sireEnabled","sireAutoRegisterOnCheckIn","sirePropertyCode","boldPaymentApiKey","boldPaymentMerchantId","boldPaymentEnvironment","whatsappProvider","whatsappApiKey","whatsappApiSecret","whatsappPhoneNumberId","showSecrets","setShowSecrets","doorSystem","whatsapp","apiKey","propertyId","syncEnabled","autoCreateTasks","lateCheckInThreshold","clientId","clientSecret","apiUrl","passcodeType","apiSecret","enabled","autoRegisterOnCheckIn","propertyCode","merchantId","environment","phoneNumberId","SecretInput","showSecret","toggleShowSecret","key","KeyIcon","test","_err$path","msg","logo","nit","selectedCountry","setSelectedCountry","setNit","organizationLanguage","setOrganizationLanguage","useLanguage","selectedOrgLanguage","setSelectedOrgLanguage","savingOrgLanguage","setSavingOrgLanguage","orgSettings","langResponse","getOrganizationLanguage","langError","loadOrgLanguage","newLanguage","RoleConfigurationTab","DocumentConfigurationTab","SMTPConfigurationTab","ApiConfigurationTab","getStatusColor","getStatusText","MY_JOIN_REQUESTS_TABLE_ID","MyJoinRequestsList","joinRequests","setJoinRequests","isFilterPanelOpen","setIsFilterPanelOpen","mountedRef","withdrawingId","setWithdrawingId","isMounted","timeoutId","MY_JOIN_REQUESTS","requests","getMyJoinRequests","fetchMyJoinRequests","hour","minute","filteredJoinRequests","filtered","request","_request$message","orgName","reduce","acc","_request$message2","searchValue","String","msgValue","createdAt","processor","processedAt","requestId","withdrawJoinRequest","req","_err$response4$data","handleWithdraw","OrganizationSettings","setOrganization","stats","setStats","loadingStats","setLoadingStats","isJoinModalOpen","setIsJoinModalOpen","isEditModalOpen","setIsEditModalOpen","canViewOrganization","refreshOrganization","useOrganization","fetchOrganization","getCurrentOrganization","statsData","getOrganizationStats","statsErr","_err$response2$data","hasOrganization","hasInitialLoadRef","UserPlusIcon","UserGroupIcon","subscriptionPlan","currentUsers","maxUsers","utilizationPercent","_count","invitations","ChartBarIcon","availableSlots","CreateOrganizationModal","handleCreateSuccess","JoinOrganizationModal","handleJoinSuccess","EditOrganizationModal","handleEditSuccess","joinRequest","setAction","setRoleId","setResponse","organizationId","processJoinRequest","requester","JOIN_REQUESTS_TABLE_ID","JoinRequestsList","isProcessModalOpen","setIsProcessModalOpen","selectedRequest","setSelectedRequest","canViewJoinRequests","canManageJoinRequests","hasInitialLoad","joinRequestsCount","JOIN_REQUESTS","getJoinRequests","stack","fetchJoinRequests","_request$requester$em","requesterName","requesterEmail","_request$requester$em2","handleOpenProcessModal","ProcessJoinRequestModal","Organisation","canViewOrganisation","canViewUsers","canViewRoles","canViewBranches","canViewOrg","activeTabState","setActiveTabState","isInitialized","defaultTab","handleTabChange","tab","MapPinIcon","UserManagementTab","RoleManagementTab","BranchManagementTab"],"sourceRoot":""}