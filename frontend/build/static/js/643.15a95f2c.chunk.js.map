{"version":3,"file":"static/js/643.15a95f2c.chunk.js","mappings":"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","sources":["components/shared/CardGrid.tsx","api/tableSettingsApi.ts","hooks/useTableSettings.ts","utils/filterLogic.ts","components/tours/CreateTourBookingModal.tsx","components/CertificateCreationModal.tsx","components/ContractCreationModal.tsx","components/CertificateEditModal.tsx","components/ContractEditModal.tsx","components/SocialSecurityEditor.tsx","components/OffboardingStartModal.tsx","components/OffboardingCompleteModal.tsx","components/LifecycleView.tsx","components/UserManagementTab.tsx","config/permissionStructure.ts","components/PermissionEditor.tsx","components/RoleManagementTab.tsx","components/branches/RoomDescriptionsSection.tsx","components/BranchManagementTab.tsx","components/tours/CreateTourProviderModal.tsx","components/tours/EditTourProviderModal.tsx","components/tours/TourProvidersTab.tsx","types/tour.ts","components/tours/CreateTourModal.tsx","components/tours/EditTourModal.tsx","components/tours/TourDetailsModal.tsx","components/tours/TourExportDialog.tsx","components/tours/TourImageLightbox.tsx","components/tours/ToursTab.tsx","components/organization/CreateOrganizationModal.tsx","components/organization/JoinOrganizationModal.tsx","components/organization/EditOrganizationModal.tsx","components/organization/MyJoinRequestsList.tsx","components/organization/OrganizationSettings.tsx","components/organization/ProcessJoinRequestModal.tsx","components/organization/JoinRequestsList.tsx","pages/Organisation.tsx","components/TableColumnConfig.tsx"],"sourcesContent":["import React from 'react';\n\nexport interface CardGridProps {\n  children: React.ReactNode;\n  columns?: {\n    mobile?: number;\n    tablet?: number;\n    desktop?: number;\n    largeDesktop?: number;\n  };\n  gap?: 'sm' | 'md' | 'lg';\n  className?: string;\n}\n\nconst CardGrid: React.FC<CardGridProps> = ({\n  children,\n  columns = {\n    mobile: 1,\n    tablet: 1,\n    desktop: 1,\n    largeDesktop: 1\n  },\n  gap = 'md',\n  className = ''\n}) => {\n  const gapClass = {\n    sm: 'gap-0.5',\n    md: 'gap-0.5',\n    lg: 'gap-1'\n  }[gap];\n\n  // Immer 1 Spalte fr bessere bersichtlichkeit - Cards nehmen volle Breite ein\n  return (\n    <div \n      className={`flex flex-col ${gapClass} ${className}`}\n    >\n      {children}\n    </div>\n  );\n};\n\nexport default CardGrid;\n\n","// import axios from 'axios';\nimport axiosInstance from '../config/axios.ts';\nimport { logger } from '../utils/logger.ts';\nimport { API_URL } from '../config/api.ts';\n\nexport interface TableSettings {\n  tableId: string;\n  columnOrder: string[];\n  hiddenColumns: string[];\n  viewMode?: 'table' | 'cards';\n  sortConfig?: { key: string; direction: 'asc' | 'desc' };\n}\n\n// Helfer-Funktion, um den localStorage-Schlssel fr eine Tabelle zu generieren\nconst getLocalStorageKey = (tableId: string) => `table_settings_${tableId}`;\n\n// API zum Verwalten der Tabelleneinstellungen\nexport const tableSettingsApi = {\n  // Benutzerspezifische Tabelleneinstellungen abrufen\n  getTableSettings: async (tableId: string): Promise<TableSettings> => {\n    try {\n      // Zuerst versuchen, Einstellungen vom API-Server zu laden\n      const response = await axiosInstance.get(`/table-settings/${tableId}`);\n      return response.data;\n    } catch (error) {\n      console.error('Fehler beim Abrufen der Tabelleneinstellungen vom Server:', error);\n      \n      // Fallback: Versuchen, aus dem localStorage zu laden\n      try {\n        const localStorageKey = getLocalStorageKey(tableId);\n        const storedSettings = localStorage.getItem(localStorageKey);\n        \n        if (storedSettings) {\n          return JSON.parse(storedSettings);\n        }\n      } catch (localError) {\n        console.error('Fehler beim Laden aus localStorage:', localError);\n      }\n      \n      // Default-Einstellungen zurckgeben, wenn keine gespeicherten verfgbar sind\n      return {\n        tableId,\n        columnOrder: [],\n        hiddenColumns: []\n      };\n    }\n  },\n  \n  // Tabelleneinstellungen speichern (server-side und localStorage)\n  saveTableSettings: async (settings: TableSettings): Promise<void> => {\n    try {\n      // Zum API-Server senden\n      await axiosInstance.post(`/table-settings`, settings);\n      \n      // Auch im localStorage speichern\n      const localStorageKey = getLocalStorageKey(settings.tableId);\n      localStorage.setItem(localStorageKey, JSON.stringify(settings));\n    } catch (error) {\n      console.error('Fehler beim Speichern der Tabelleneinstellungen auf dem Server:', error);\n      \n      // Trotzdem im localStorage speichern\n      try {\n        const localStorageKey = getLocalStorageKey(settings.tableId);\n        localStorage.setItem(localStorageKey, JSON.stringify(settings));\n      } catch (localError) {\n        console.error('Fehler beim Speichern im localStorage:', localError);\n      }\n    }\n  },\n  \n  // Tabelleneinstellungen zurcksetzen\n  resetTableSettings: (tableId: string): void => {\n    try {\n      const localStorageKey = getLocalStorageKey(tableId);\n      localStorage.removeItem(localStorageKey);\n      logger.log(`Tabelleneinstellungen fr ${tableId} zurckgesetzt`);\n    } catch (error) {\n      console.error('Fehler beim Zurcksetzen der Tabelleneinstellungen:', error);\n    }\n  }\n}; ","import { useState, useEffect, useCallback, useRef } from 'react';\nimport { tableSettingsApi, TableSettings } from '../api/tableSettingsApi.ts';\nimport { logger } from '../utils/logger.ts';\n\ninterface UseTableSettingsOptions {\n  defaultColumnOrder?: string[];\n  defaultHiddenColumns?: string[];\n  defaultViewMode?: 'table' | 'cards';\n  defaultVisibleCardMetadata?: string[];\n  defaultCardColumnOrder?: string[];\n  defaultCardSortDirections?: Record<string, 'asc' | 'desc'>;\n  defaultSortConfig?: { key: string; direction: 'asc' | 'desc' };\n}\n\n/**\n * Hook zum Verwalten von benutzerdefinierten Tabelleneinstellungen\n * @param tableId Eindeutige ID der Tabelle\n * @param options Optionale Standardwerte\n */\nexport const useTableSettings = (tableId: string, options?: UseTableSettingsOptions) => {\n  const [settings, setSettings] = useState<TableSettings>({\n    tableId,\n    columnOrder: options?.defaultColumnOrder || [],\n    hiddenColumns: options?.defaultHiddenColumns || []\n  });\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n\n  // Tabelleneinstellungen laden - beim Mount oder wenn tableId sich ndert\n  useEffect(() => {\n    let isMounted = true;\n    \n    const loadSettings = async () => {\n      try {\n        setIsLoading(true);\n        const loadedSettings = await tableSettingsApi.getTableSettings(tableId);\n        \n        if (!isMounted) return; // Component wurde bereits unmounted\n        \n        logger.log('Geladene Tabelleneinstellungen vom Server:', loadedSettings);\n        \n        // Wenn leere Einstellungen zurckgegeben werden, verwende die Standardwerte\n        if (loadedSettings.columnOrder.length === 0 && options?.defaultColumnOrder) {\n          loadedSettings.columnOrder = options.defaultColumnOrder;\n        }\n        \n        // View-Mode initialisieren, falls nicht vorhanden\n        if (!loadedSettings.viewMode && options?.defaultViewMode) {\n          loadedSettings.viewMode = options.defaultViewMode;\n        }\n        \n        // sortConfig initialisieren, falls nicht vorhanden\n        let needsSave = false;\n        if (!loadedSettings.sortConfig && options?.defaultSortConfig) {\n          loadedSettings.sortConfig = options.defaultSortConfig;\n          needsSave = true;\n        }\n        \n        logger.log('Finale Tabelleneinstellungen nach Initialisierung:', loadedSettings);\n        setSettings(loadedSettings);\n        setError(null);\n        \n        //  FIX: Speichere defaultSortConfig auch auf dem Server (nach setState, um Initialisierungsprobleme zu vermeiden)\n        if (needsSave) {\n          tableSettingsApi.saveTableSettings(loadedSettings).catch(err => {\n            setError(err instanceof Error ? err : new Error('Fehler beim Speichern der Standard-Sortierung'));\n            console.error('Fehler beim Speichern der Standard-Sortierung:', err);\n          });\n        }\n      } catch (err) {\n        if (!isMounted) return;\n        setError(err instanceof Error ? err : new Error('Fehler beim Laden der Einstellungen'));\n        console.error('Fehler beim Laden der Tabelleneinstellungen:', err);\n      } finally {\n        if (isMounted) {\n          setIsLoading(false);\n        }\n      }\n    };\n\n    loadSettings();\n    \n    return () => {\n      isMounted = false;\n    };\n  }, [tableId]); // NUR tableId als Dependency!\n\n  // Spaltenreihenfolge aktualisieren\n  const updateColumnOrder = useCallback(async (newColumnOrder: string[]) => {\n    try {\n      const updatedSettings = { ...settings, columnOrder: newColumnOrder };\n      setSettings(updatedSettings);\n      await tableSettingsApi.saveTableSettings(updatedSettings);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim Speichern der Spaltenreihenfolge'));\n      console.error('Fehler beim Speichern der Spaltenreihenfolge:', err);\n    }\n  }, [settings]);\n\n  // Versteckte Spalten aktualisieren\n  const updateHiddenColumns = useCallback(async (newHiddenColumns: string[]) => {\n    try {\n      //  FIX: Verwende funktionales Update, um stale closure zu vermeiden\n      setSettings(prevSettings => {\n        const updatedSettings = { ...prevSettings, hiddenColumns: newHiddenColumns };\n        tableSettingsApi.saveTableSettings(updatedSettings).catch(err => {\n          setError(err instanceof Error ? err : new Error('Fehler beim Speichern der versteckten Spalten'));\n          console.error('Fehler beim Speichern der versteckten Spalten:', err);\n        });\n        return updatedSettings;\n      });\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim Speichern der versteckten Spalten'));\n      console.error('Fehler beim Speichern der versteckten Spalten:', err);\n    }\n  }, []);\n\n  // Eine einzelne Spalte ein- oder ausblenden\n  const toggleColumnVisibility = useCallback(async (columnId: string) => {\n    try {\n      let newHiddenColumns: string[];\n      \n      if (settings.hiddenColumns.includes(columnId)) {\n        // Spalte einblenden (aus hiddenColumns entfernen)\n        newHiddenColumns = settings.hiddenColumns.filter(id => id !== columnId);\n      } else {\n        // Spalte ausblenden (zu hiddenColumns hinzufgen)\n        newHiddenColumns = [...settings.hiddenColumns, columnId];\n      }\n      \n      const updatedSettings = { ...settings, hiddenColumns: newHiddenColumns };\n      setSettings(updatedSettings);\n      await tableSettingsApi.saveTableSettings(updatedSettings);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim ndern der Spaltenansicht'));\n      console.error('Fehler beim ndern der Spaltenansicht:', err);\n    }\n  }, [settings]);\n\n  // View-Mode aktualisieren\n  const updateViewMode = useCallback(async (newViewMode: 'table' | 'cards') => {\n    try {\n      //  FIX: Verwende funktionales Update, um stale closure zu vermeiden\n      setSettings(prevSettings => {\n        const updatedSettings = { ...prevSettings, viewMode: newViewMode };\n        tableSettingsApi.saveTableSettings(updatedSettings).catch(err => {\n          setError(err instanceof Error ? err : new Error('Fehler beim Speichern des View-Modes'));\n          console.error('Fehler beim Speichern des View-Modes:', err);\n        });\n        return updatedSettings;\n      });\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim Speichern des View-Modes'));\n      console.error('Fehler beim Speichern des View-Modes:', err);\n    }\n  }, []);\n\n  // Sortierung aktualisieren\n  const updateSortConfig = useCallback(async (newSortConfig: { key: string; direction: 'asc' | 'desc' }) => {\n    try {\n      //  FIX: Verwende funktionales Update, um stale closure zu vermeiden\n      setSettings(prevSettings => {\n        const updatedSettings = { ...prevSettings, sortConfig: newSortConfig };\n        // Speichere asynchron (nicht await, da setState synchron sein muss)\n        tableSettingsApi.saveTableSettings(updatedSettings).catch(err => {\n          setError(err instanceof Error ? err : new Error('Fehler beim Speichern der Sortierung'));\n          console.error('Fehler beim Speichern der Sortierung:', err);\n        });\n        return updatedSettings;\n      });\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim Speichern der Sortierung'));\n      console.error('Fehler beim Speichern der Sortierung:', err);\n    }\n  }, []); //  FIX: Keine Dependencies mehr - verwendet funktionales Update\n\n  return {\n    settings,\n    isLoading,\n    error,\n    updateColumnOrder,\n    updateHiddenColumns,\n    toggleColumnVisibility,\n    isColumnVisible: (columnId: string) => !settings.hiddenColumns.includes(columnId),\n    updateViewMode,\n    updateSortConfig\n  };\n}; ","/**\r\n * Zentrale Filter-Logik zur Eliminierung von Code-Duplikation\r\n * \r\n * Diese Datei konsolidiert die Filter-Logik, die zuvor in mehreren Komponenten\r\n * dupliziert war (Requests.tsx, Worktracker.tsx, InvoiceManagementTab.tsx, etc.)\r\n * \r\n * WICHTIG: Die Logik ist exakt identisch mit der vorherigen Implementierung.\r\n * Nur die Code-Duplikation wurde entfernt, keine Funktionalittsnderung!\r\n */\r\n\r\nimport { startOfWeek, endOfWeek, startOfMonth, endOfMonth, startOfYear, endOfYear } from 'date-fns';\r\n\r\nexport interface FilterCondition {\r\n  column: string;\r\n  operator: string;\r\n  value: string | number | Date | null;\r\n}\r\n\r\n/**\r\n * Evaluates a single filter condition against a field value\r\n * @param fieldValue - The value to test against\r\n * @param condition - The filter condition to apply\r\n * @returns true if condition is met, false otherwise\r\n */\r\nexport const evaluateCondition = (\r\n  fieldValue: any,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  const { operator, value } = condition;\r\n  \r\n  // Sicherstellen, dass value definiert ist\r\n  if (value === undefined) {\r\n    console.error('evaluateCondition: value ist undefined', condition);\r\n    return false;\r\n  }\r\n  \r\n  // Handle null/undefined values\r\n  if (fieldValue == null && value == null) {\r\n    return operator === 'equals';\r\n  }\r\n  if (fieldValue == null || value == null) {\r\n    if (operator === 'notEquals') return true;\r\n    return false;\r\n  }\r\n\r\n  // String operations\r\n  // Sicherstellen, dass fieldValue und value Strings sind, bevor toLowerCase() aufgerufen wird\r\n  let strField: string = '';\r\n  let strValue: string = '';\r\n  \r\n  try {\r\n    // Konvertiere fieldValue zu String, auch wenn es ein Objekt ist\r\n    const fieldValueStr = fieldValue == null ? '' : (typeof fieldValue === 'string' ? fieldValue : String(fieldValue));\r\n    if (typeof fieldValueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerField = fieldValueStr.toLowerCase();\r\n    if (lowerField === undefined || lowerField === null || typeof lowerField !== 'string') {\r\n      return false;\r\n    }\r\n    strField = lowerField;\r\n    \r\n    // Konvertiere value zu String, auch wenn es ein Objekt ist\r\n    const valueStr = value == null ? '' : (typeof value === 'string' ? value : String(value));\r\n    if (typeof valueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerValue = valueStr.toLowerCase();\r\n    if (lowerValue === undefined || lowerValue === null || typeof lowerValue !== 'string') {\r\n      return false;\r\n    }\r\n    strValue = lowerValue;\r\n  } catch (error) {\r\n    // Falls toLowerCase() fehlschlgt, gebe false zurck\r\n    return false;\r\n  }\r\n\r\n  // Sicherstellen, dass strField und strValue Strings sind und nicht undefined\r\n  if (typeof strField !== 'string' || typeof strValue !== 'string' || strField === undefined || strValue === undefined || strField === null || strValue === null) {\r\n    return false;\r\n  }\r\n\r\n  switch (operator) {\r\n    case 'equals':\r\n      return strField === strValue;\r\n    case 'notEquals':\r\n      return strField !== strValue;\r\n    case 'contains':\r\n      return strField.includes(strValue);\r\n    case 'startsWith':\r\n      return strField.startsWith(strValue);\r\n    case 'endsWith':\r\n      // Explizite Prfung, dass strField und strValue Strings sind, bevor endsWith aufgerufen wird\r\n      if (strField === undefined || strField === null) {\r\n        console.error('endsWith: strField ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (strValue === undefined || strValue === null) {\r\n        console.error('endsWith: strValue ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strField !== 'string') {\r\n        console.error('endsWith: strField ist kein String', { strField, typeof: typeof strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strValue !== 'string') {\r\n        console.error('endsWith: strValue ist kein String', { strField, strValue, typeof: typeof strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      try {\r\n        return strField.endsWith(strValue);\r\n      } catch (error) {\r\n        console.error('endsWith: Fehler bei endsWith-Aufruf', error, { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n    case 'before':\r\n    case 'after': {\r\n      // Date operations\r\n      const fieldDate = new Date(fieldValue);\r\n      const valueDate = new Date(value as string);\r\n      if (isNaN(fieldDate.getTime()) || isNaN(valueDate.getTime())) {\r\n        return false;\r\n      }\r\n      return operator === 'before' \r\n        ? fieldDate < valueDate \r\n        : fieldDate > valueDate;\r\n    }\r\n    case 'greaterThan':\r\n    case 'lessThan': {\r\n      // Numeric operations\r\n      const fieldNum = parseFloat(String(fieldValue));\r\n      const valueNum = parseFloat(String(value));\r\n      if (isNaN(fieldNum) || isNaN(valueNum)) {\r\n        return false;\r\n      }\r\n      return operator === 'greaterThan'\r\n        ? fieldNum > valueNum\r\n        : fieldNum < valueNum;\r\n    }\r\n    default:\r\n      return true;\r\n  }\r\n};\r\n\r\n/**\r\n * Type for getting field values from items\r\n */\r\nexport type GetFieldValue<T> = (item: T, columnId: string) => any;\r\n\r\n/**\r\n * Type for column-specific evaluation handlers\r\n * Returns true if condition is met, false otherwise\r\n */\r\nexport type ColumnEvaluator<T> = (item: T, condition: FilterCondition) => boolean | null;\r\n\r\n/**\r\n * Applies filter conditions to an array of items\r\n * \r\n * @param items - Array of items to filter\r\n * @param conditions - Array of filter conditions\r\n * @param operators - Array of logical operators ('AND' | 'OR') between conditions\r\n * @param getFieldValue - Function to extract field values from items\r\n * @param columnEvaluators - Optional map of column-specific evaluators for custom logic\r\n * @returns Filtered array of items\r\n * \r\n * @example\r\n * // Standard usage with getFieldValue\r\n * const filtered = applyFilters(items, conditions, operators, (item, col) => item[col]);\r\n * \r\n * // With custom column evaluators\r\n * const filtered = applyFilters(\r\n *   items,\r\n *   conditions,\r\n *   operators,\r\n *   (item, col) => item[col],\r\n *   {\r\n *     'responsible': (item, condition) => {\r\n *       // Custom logic for responsible column\r\n *       return evaluateUserRoleCondition(item.responsible?.id, item.role?.id, condition);\r\n *     }\r\n *   }\r\n * );\r\n */\r\nexport const applyFilters = <T>(\r\n  items: T[],\r\n  conditions: FilterCondition[],\r\n  operators: ('AND' | 'OR')[],\r\n  getFieldValue: GetFieldValue<T>,\r\n  columnEvaluators?: Record<string, ColumnEvaluator<T>>\r\n): T[] => {\r\n  if (conditions.length === 0) {\r\n    return items;\r\n  }\r\n\r\n  return items.filter(item => {\r\n    let result = true;\r\n\r\n    for (let i = 0; i < conditions.length; i++) {\r\n      const condition = conditions[i];\r\n      let conditionMet = false;\r\n\r\n      // Check if there's a custom evaluator for this column\r\n      if (columnEvaluators && columnEvaluators[condition.column]) {\r\n        const customResult = columnEvaluators[condition.column](item, condition);\r\n        if (customResult !== null) {\r\n          conditionMet = customResult;\r\n        } else {\r\n          // Fallback to standard evaluation if custom evaluator returns null\r\n          const fieldValue = getFieldValue(item, condition.column);\r\n          conditionMet = evaluateCondition(fieldValue, condition);\r\n        }\r\n      } else {\r\n        // Standard evaluation\r\n        const fieldValue = getFieldValue(item, condition.column);\r\n        conditionMet = evaluateCondition(fieldValue, condition);\r\n      }\r\n\r\n      // Apply logical operators\r\n      if (i === 0) {\r\n        result = conditionMet;\r\n      } else {\r\n        const operator = operators[i - 1] || 'AND';\r\n        result = operator === 'AND' \r\n          ? (result && conditionMet) \r\n          : (result || conditionMet);\r\n      }\r\n    }\r\n\r\n    return result;\r\n  });\r\n};\r\n\r\n/**\r\n * Helper function to evaluate date conditions with proper date comparison\r\n * Supports __TODAY__ as a dynamic date value\r\n * \r\n * WICHTIG: Extrahiert nur den Datumsteil (Jahr, Monat, Tag) ohne Zeitzone,\r\n * um Zeitzone-Konvertierungsprobleme zu vermeiden (verhindert Tag-Versatz)\r\n */\r\nexport const evaluateDateCondition = (\r\n  dateValue: Date | string | null | undefined,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  if (!dateValue) {\r\n    return false;\r\n  }\r\n\r\n  const date = new Date(dateValue);\r\n  if (isNaN(date.getTime())) {\r\n    return false;\r\n  }\r\n\r\n  // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n  // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n  const dateYear = date.getUTCFullYear();\r\n  const dateMonth = date.getUTCMonth();\r\n  const dateDay = date.getUTCDate();\r\n  // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n  const normalizedDate = new Date(dateYear, dateMonth, dateDay);\r\n\r\n  //  PHASE 5: Handle Zeitraum-Platzhalter (__THIS_WEEK__, __THIS_MONTH__, __THIS_YEAR__)\r\n  // Diese funktionieren analog zu __TODAY__, aber fr Zeitrume\r\n  try {\r\n    if (condition.value === '__THIS_WEEK__') {\r\n      if (condition.operator === 'equals') {\r\n        const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekStart.setHours(0, 0, 0, 0);\r\n        const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= weekStart && normalizedDate <= weekEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Woche als einzelnes Datum\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < weekEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > weekStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_MONTH__') {\r\n      if (condition.operator === 'equals') {\r\n        const monthStart = startOfMonth(new Date());\r\n        monthStart.setHours(0, 0, 0, 0);\r\n        const monthEnd = endOfMonth(new Date());\r\n        monthEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= monthStart && normalizedDate <= monthEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Monat als einzelnes Datum\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < monthEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > monthStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_YEAR__') {\r\n      if (condition.operator === 'equals') {\r\n        const yearStart = startOfYear(new Date());\r\n        yearStart.setHours(0, 0, 0, 0);\r\n        const yearEnd = endOfYear(new Date());\r\n        yearEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= yearStart && normalizedDate <= yearEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Jahr als einzelnes Datum\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < yearEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > yearStart;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    // Handle __TODAY__, __WEEK_START__, __WEEK_END__, __MONTH_START__, __MONTH_END__, __YEAR_START__, __YEAR_END__ dynamic dates\r\n    let conditionDate: Date;\r\n    if (condition.value === '__TODAY__') {\r\n      // Get today's date in local timezone (set to midnight)\r\n      const localToday = new Date();\r\n      localToday.setHours(0, 0, 0, 0);\r\n      conditionDate = localToday;\r\n    } else if (condition.value === '__WEEK_START__') {\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      conditionDate = weekStart;\r\n    } else if (condition.value === '__WEEK_END__') {\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = weekEnd;\r\n    } else if (condition.value === '__MONTH_START__') {\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      conditionDate = monthStart;\r\n    } else if (condition.value === '__MONTH_END__') {\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = monthEnd;\r\n    } else if (condition.value === '__YEAR_START__') {\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      conditionDate = yearStart;\r\n    } else if (condition.value === '__YEAR_END__') {\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = yearEnd;\r\n    } else {\r\n      const conditionDateRaw = new Date(condition.value as string);\r\n      if (isNaN(conditionDateRaw.getTime())) {\r\n        return false;\r\n      }\r\n      // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n      // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n      const conditionYear = conditionDateRaw.getUTCFullYear();\r\n      const conditionMonth = conditionDateRaw.getUTCMonth();\r\n      const conditionDay = conditionDateRaw.getUTCDate();\r\n      // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n      conditionDate = new Date(conditionYear, conditionMonth, conditionDay);\r\n    }\r\n\r\n    switch (condition.operator) {\r\n      case 'equals':\r\n        return normalizedDate.getTime() === conditionDate.getTime();\r\n      case 'before':\r\n        return normalizedDate < conditionDate;\r\n      case 'after':\r\n        return normalizedDate > conditionDate;\r\n      default:\r\n        return true;\r\n    }\r\n  } catch (error) {\r\n    //  PHASE 5: Error Handling fr ungltige Platzhalter-Werte\r\n    console.error(`[evaluateDateCondition] Error with placeholder ${condition.value}:`, error);\r\n    return false; // Fallback: Filter schliet Datensatz aus\r\n  }\r\n};\r\n\r\n/**\r\n * Helper function to evaluate user/role conditions with user-{id} or role-{id} format\r\n * Supports both user-{id} and role-{id} formats, plus text fallback for legacy support\r\n */\r\nexport const evaluateUserRoleCondition = (\r\n  userId: number | null | undefined,\r\n  roleId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  textValue?: string  // Optional: text representation for fallback (e.g. \"John Doe\")\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = userId === targetUserId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = roleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  if (textValue !== undefined) {\r\n    const textValueLower = textValue.toLowerCase();\r\n    const valueLower = value.toLowerCase();\r\n    if (condition.operator === 'equals') {\r\n      return textValueLower === valueLower;\r\n    } else if (condition.operator === 'notEquals') {\r\n      return textValueLower !== valueLower;\r\n    } else if (condition.operator === 'contains') {\r\n      return textValueLower.includes(valueLower);\r\n    }\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n/**\r\n * Helper function for combined responsible/qualityControl filter (specific to Tasks)\r\n */\r\nexport const evaluateResponsibleAndQualityControl = (\r\n  responsibleId: number | null | undefined,\r\n  responsibleRoleId: number | null | undefined,\r\n  qualityControlId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  responsibleText?: string,\r\n  qualityControlText?: string\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format - matches either responsible OR qualityControl\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = (responsibleId === targetUserId) || (qualityControlId === targetUserId);\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format - only matches with responsible role\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = responsibleRoleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  const valueLower = value.toLowerCase();\r\n  if (condition.operator === 'equals') {\r\n    return (responsibleText?.toLowerCase() === valueLower) || (qualityControlText?.toLowerCase() === valueLower);\r\n  } else if (condition.operator === 'notEquals') {\r\n    return (responsibleText?.toLowerCase() !== valueLower) && (qualityControlText?.toLowerCase() !== valueLower);\r\n  } else if (condition.operator === 'contains') {\r\n    return (responsibleText?.toLowerCase()?.includes(valueLower) ?? false) || (qualityControlText?.toLowerCase()?.includes(valueLower) ?? false);\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourBooking, TourBookingStatus } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\n\ninterface CreateTourBookingModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onBookingCreated: (newBooking: TourBooking) => void;\n    tour?: Tour | null;\n}\n\nconst CreateTourBookingModal = ({ isOpen, onClose, onBookingCreated, tour: preselectedTour }: CreateTourBookingModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    \n    const [tourId, setTourId] = useState<number | ''>(preselectedTour?.id || '');\n    const [tourDate, setTourDate] = useState('');\n    const [numberOfParticipants, setNumberOfParticipants] = useState<number | ''>(1);\n    const [customerName, setCustomerName] = useState('');\n    const [customerEmail, setCustomerEmail] = useState('');\n    const [customerPhone, setCustomerPhone] = useState('');\n    const [customerNotes, setCustomerNotes] = useState('');\n    \n    const [tours, setTours] = useState<Tour[]>([]);\n    const [selectedTour, setSelectedTour] = useState<Tour | null>(preselectedTour || null);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Touren\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BASE, {\n                    params: { isActive: true }\n                });\n                const toursData = response.data?.data || response.data || [];\n                setTours(Array.isArray(toursData) ? toursData : []);\n            } catch (err: unknown) {\n                console.error('Error loading tours:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Setze preselectedTour wenn vorhanden\n    useEffect(() => {\n        if (preselectedTour) {\n            setTourId(preselectedTour.id);\n            setSelectedTour(preselectedTour);\n        }\n    }, [preselectedTour]);\n\n    // Update selectedTour when tourId changes\n    useEffect(() => {\n        if (tourId) {\n            const tour = tours.find(t => t.id === Number(tourId));\n            setSelectedTour(tour || null);\n        } else {\n            setSelectedTour(null);\n        }\n    }, [tourId, tours]);\n\n    // Reset form when modal opens/closes\n    useEffect(() => {\n        if (!isOpen) {\n            if (!preselectedTour) {\n                setTourId('');\n            }\n            setTourDate('');\n            setNumberOfParticipants(1);\n            setCustomerName('');\n            setCustomerEmail('');\n            setCustomerPhone('');\n            setCustomerNotes('');\n            setError(null);\n        }\n    }, [isOpen, preselectedTour]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierungen\n        if (!tourId) {\n            setError(t('tourBookings.validation.tourRequired', { defaultValue: 'Tour ist erforderlich' }));\n            return;\n        }\n\n        if (!tourDate) {\n            setError(t('tourBookings.validation.tourDateRequired', { defaultValue: 'Tour-Datum ist erforderlich' }));\n            return;\n        }\n\n        const tourDateObj = new Date(tourDate);\n        if (tourDateObj < new Date()) {\n            setError(t('tours.validation.tourDateFuture', { defaultValue: 'Tour-Datum muss in der Zukunft liegen' }));\n            return;\n        }\n\n        if (!numberOfParticipants || Number(numberOfParticipants) < 1) {\n            setError(t('tourBookings.validation.numberOfParticipantsMin', { defaultValue: 'Anzahl Teilnehmer muss >= 1 sein' }));\n            return;\n        }\n\n        if (!customerName.trim() || customerName.trim().length < 2) {\n            setError(t('tourBookings.validation.customerNameMinLength', { defaultValue: 'Kundenname muss mindestens 2 Zeichen lang sein' }));\n            return;\n        }\n\n        if (!customerPhone.trim() && !customerEmail.trim()) {\n            setError(t('tourBookings.validation.contactRequired', { defaultValue: 'Mindestens eine Kontaktinformation (Telefon oder E-Mail) ist erforderlich' }));\n            return;\n        }\n\n        // Validierung: Anzahl Teilnehmer zwischen min/max\n        if (selectedTour) {\n            const numPart = Number(numberOfParticipants);\n            if (selectedTour.minParticipants && numPart < selectedTour.minParticipants) {\n                setError(t('tours.validation.numberOfParticipantsRange', { \n                    defaultValue: 'Anzahl der Teilnehmer muss zwischen {min} und {max} sein',\n                    min: selectedTour.minParticipants,\n                    max: selectedTour.maxParticipants || ''\n                }));\n                return;\n            }\n            if (selectedTour.maxParticipants && numPart > selectedTour.maxParticipants) {\n                setError(t('tours.validation.numberOfParticipantsRange', { \n                    defaultValue: 'Anzahl der Teilnehmer muss zwischen {min} und {max} sein',\n                    min: selectedTour.minParticipants || 1,\n                    max: selectedTour.maxParticipants\n                }));\n                return;\n            }\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.post(API_ENDPOINTS.TOUR_BOOKINGS.BASE, {\n                tourId: Number(tourId),\n                tourDate,\n                numberOfParticipants: Number(numberOfParticipants),\n                customerName: customerName.trim(),\n                customerEmail: customerEmail.trim() || null,\n                customerPhone: customerPhone.trim() || null,\n                customerNotes: customerNotes.trim() || null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tourBookings.created', { defaultValue: 'Tour-Buchung erfolgreich erstellt' }),\n                    'success'\n                );\n                onBookingCreated(response.data.data);\n                onClose();\n            } else {\n                throw new Error(response.data?.message || t('tours.bookings.createError', { defaultValue: 'Fehler beim Erstellen der Buchung' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error creating booking:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                    <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                            {t('tourBookings.create', { defaultValue: 'Neue Tour-Buchung' })}\n                        </Dialog.Title>\n                        <button\n                            onClick={onClose}\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                        >\n                            <XMarkIcon className=\"h-6 w-6\" />\n                        </button>\n                    </div>\n\n                    <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.tour', { defaultValue: 'Tour' })} *\n                            </label>\n                            <select\n                                value={tourId}\n                                onChange={(e) => setTourId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData || !!preselectedTour}\n                            >\n                                <option value=\"\">{t('common.select', { defaultValue: 'Bitte whlen' })}</option>\n                                {tours.filter(t => t.isActive && t.title).map(tour => (\n                                    <option key={tour.id} value={tour.id}>\n                                        {tour.title || '-'}\n                                    </option>\n                                ))}\n                            </select>\n                            {selectedTour && (\n                                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                                    {selectedTour.minParticipants && selectedTour.maxParticipants\n                                        ? t('tourBookings.participantsRange', { \n                                            defaultValue: 'Teilnehmer: {min} - {max}',\n                                            min: selectedTour.minParticipants,\n                                            max: selectedTour.maxParticipants\n                                        })\n                                        : selectedTour.minParticipants\n                                        ? t('tourBookings.participantsMin', { \n                                            defaultValue: 'Min. Teilnehmer: {min}',\n                                            min: selectedTour.minParticipants\n                                        })\n                                        : selectedTour.maxParticipants\n                                        ? t('tourBookings.participantsMax', { \n                                            defaultValue: 'Max. Teilnehmer: {max}',\n                                            max: selectedTour.maxParticipants\n                                        })\n                                        : null}\n                                </p>\n                            )}\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.tourDate', { defaultValue: 'Tour-Datum' })} *\n                            </label>\n                            <input\n                                type=\"datetime-local\"\n                                value={tourDate}\n                                onChange={(e) => setTourDate(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.numberOfParticipants', { defaultValue: 'Anzahl Teilnehmer' })} *\n                            </label>\n                            <input\n                                type=\"number\"\n                                min={selectedTour?.minParticipants || 1}\n                                max={selectedTour?.maxParticipants || undefined}\n                                value={numberOfParticipants}\n                                onChange={(e) => setNumberOfParticipants(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerName', { defaultValue: 'Kundenname' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={customerName}\n                                onChange={(e) => setCustomerName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerPhone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={customerPhone}\n                                onChange={(e) => setCustomerPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerEmail', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={customerEmail}\n                                onChange={(e) => setCustomerEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerNotes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={customerNotes}\n                                onChange={(e) => setCustomerNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={onClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </Dialog.Panel>\n            </div>\n        </Dialog>\n    );\n};\n\nexport default CreateTourBookingModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, UserIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface CertificateCreationModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCertificateCreated: () => void;\n  userId: number;\n  userName: string;\n}\n\ninterface UserData {\n  firstName: string;\n  lastName: string;\n  identificationNumber: string | null;\n  contractStartDate: string | null;\n  contractEndDate: string | null;\n  contractType: string | null;\n  salary: number | null;\n  position: string | null;\n}\n\nconst CertificateCreationModal: React.FC<CertificateCreationModalProps> = ({\n  isOpen,\n  onClose,\n  onCertificateCreated,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { user: currentUser } = useAuth();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [activeTab, setActiveTab] = useState<'data' | 'text'>('data');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [userData, setUserData] = useState<UserData | null>(null);\n  const [issueDate, setIssueDate] = useState(new Date().toISOString().split('T')[0]);\n  const [certificateType, setCertificateType] = useState('employment');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [uploading, setUploading] = useState(false);\n  const [availableTemplates, setAvailableTemplates] = useState<Array<{type: string; version: string; path: string}>>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null);\n  const [useTemplate, setUseTemplate] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitszeugnisse erstellen', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      fetchUserData();\n      fetchTemplates();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const fetchTemplates = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      const templates: Array<{type: string; version: string; path: string}> = [];\n      \n      if (documentTemplates.employmentCertificate) {\n        templates.push({\n          type: 'employmentCertificate',\n          version: documentTemplates.employmentCertificate.version,\n          path: documentTemplates.employmentCertificate.path\n        });\n      }\n      \n      setAvailableTemplates(templates);\n      if (templates.length > 0) {\n        setSelectedTemplate(templates[0].type);\n        setUseTemplate(true);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Templates:', err);\n      // Kein Fehler anzeigen, Templates sind optional\n    }\n  };\n\n  const fetchUserData = async () => {\n    try {\n      const [userResponse, lifecycleResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.USERS.BY_ID(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId))\n      ]);\n\n      const user = userResponse.data;\n      const lifecycle = lifecycleResponse.data.lifecycle;\n\n      const userDataObj = {\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        identificationNumber: user.identificationNumber || null,\n        contractStartDate: lifecycle?.contractStartDate || null,\n        contractEndDate: lifecycle?.contractEndDate || null,\n        contractType: lifecycle?.contractType || null,\n        salary: user.salary || null,\n        position: null // TODO: Aus Rollen ableiten\n      };\n\n      setUserData(userDataObj);\n\n      // Automatische Vorausfllung: Ausstellungsdatum auf heute setzen (wenn noch nicht gesetzt)\n      if (!issueDate || issueDate === new Date().toISOString().split('T')[0]) {\n        setIssueDate(new Date().toISOString().split('T')[0]);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der User-Daten:', err);\n      setError('Fehler beim Laden der Daten');\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) { // 10MB\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      setUseTemplate(false); // Deaktiviere Template wenn PDF hochgeladen wird\n      // Erstelle Preview-URL\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n    }\n  };\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const validateForm = (): string | null => {\n    if (!useTemplate && !pdfFile) {\n      return 'Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch';\n    }\n    if (!issueDate) {\n      return 'Bitte geben Sie ein Ausstellungsdatum an';\n    }\n    const issueDateObj = new Date(issueDate);\n    if (isNaN(issueDateObj.getTime())) {\n      return 'Ungltiges Ausstellungsdatum';\n    }\n    if (issueDateObj > new Date()) {\n      return 'Ausstellungsdatum darf nicht in der Zukunft liegen';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Client-seitige Validierung\n    const validationError = validateForm();\n    if (validationError) {\n      setError(validationError);\n      showMessage(validationError, 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      let pdfPath: string | undefined = undefined;\n      let templateUsed: string | null = null;\n      let templateVersion: string | null = null;\n\n      // Wenn Template verwendet werden soll und kein PDF hochgeladen wurde\n      if (useTemplate && selectedTemplate && !pdfFile) {\n        const template = availableTemplates.find(t => t.type === selectedTemplate);\n        if (template) {\n          templateUsed = template.type;\n          templateVersion = template.version;\n          // PDF wird vom Backend generiert\n        }\n      } else if (pdfFile) {\n        // PDF wurde hochgeladen - verwende dieses\n        pdfPath = `temp-${Date.now()}-${pdfFile.name}`; // Temporr\n      } else {\n        showMessage('Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch', 'error');\n        setLoading(false);\n        return;\n      }\n\n      const certificateData = {\n        certificateType,\n        issueDate: new Date(issueDate),\n        pdfPath,\n        templateUsed,\n        templateVersion\n      };\n\n      await axiosInstance.post(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATES(userId),\n        certificateData\n      );\n\n      showMessage('Arbeitszeugnis erfolgreich erstellt', 'success');\n      onCertificateCreated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      setIssueDate(new Date().toISOString().split('T')[0]);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Erstellen des Arbeitszeugnisses:', err);\n      setError(err.response?.data?.message || 'Fehler beim Erstellen des Arbeitszeugnisses');\n      showMessage('Fehler beim Erstellen des Arbeitszeugnisses', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {/* Overlay - nur auf Mobile und Desktop (nicht Large Desktop) */}\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n          style={{\n            animation: isMobile ? 'none' : 'slideIn 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94)'\n          }}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitszeugnis erstellen\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Fr: <span className=\"font-medium dark:text-white\">{userName}</span>\n              </p>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n              <nav className=\"-mb-px flex space-x-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('data')}\n                  className={`${\n                    activeTab === 'data'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Daten\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('text')}\n                  className={`${\n                    activeTab === 'text'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  PDF hochladen\n                </button>\n              </nav>\n            </div>\n\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            {/* Tab Content */}\n            {activeTab === 'data' && (\n              <div className=\"space-y-4\">\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4\">\n                  <h3 className=\"text-sm font-semibold dark:text-white mb-3\">\n                    Automatisch erkannte Daten\n                  </h3>\n                  <div className=\"space-y-2 text-sm\">\n                    {userData && (\n                      <>\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4 text-gray-400\" />\n                          <span className=\"text-gray-600 dark:text-gray-400\">Name:</span>\n                          <span className=\"dark:text-white\">\n                            {userData.firstName} {userData.lastName}\n                          </span>\n                        </div>\n                        {userData.identificationNumber && (\n                          <div className=\"flex items-center space-x-2\">\n                            <DocumentTextIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Cdula:</span>\n                            <span className=\"dark:text-white\">{userData.identificationNumber}</span>\n                          </div>\n                        )}\n                        {userData.contractStartDate && (\n                          <div className=\"flex items-center space-x-2\">\n                            <CalendarIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Eintrittsdatum:</span>\n                            <span className=\"dark:text-white\">\n                              {new Date(userData.contractStartDate).toLocaleDateString('de-DE')}\n                            </span>\n                          </div>\n                        )}\n                        {userData.contractEndDate && (\n                          <div className=\"flex items-center space-x-2\">\n                            <CalendarIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Austrittsdatum:</span>\n                            <span className=\"dark:text-white\">\n                              {new Date(userData.contractEndDate).toLocaleDateString('de-DE')}\n                            </span>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Ausstellungsdatum <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={issueDate}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setIssueDate(value);\n                      // Validierung: Datum darf nicht in der Zukunft liegen\n                      if (value && new Date(value) > new Date()) {\n                        setError('Ausstellungsdatum darf nicht in der Zukunft liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    max={new Date().toISOString().split('T')[0]}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && issueDate && new Date(issueDate) > new Date()\n                        ? 'border-red-500 dark:border-red-500' \n                        : error && !issueDate\n                        ? 'border-red-500 dark:border-red-500'\n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    required\n                    aria-invalid={(!issueDate || (issueDate && new Date(issueDate) > new Date())) ? true : undefined}\n                    aria-describedby={(!issueDate || (issueDate && new Date(issueDate) > new Date())) ? \"issueDate-error\" : undefined}\n                  />\n                  {error && (!issueDate || (issueDate && new Date(issueDate) > new Date())) && (\n                    <p id=\"issueDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                  {!error && (\n                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                      Das Datum darf nicht in der Zukunft liegen\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Zertifikat-Typ <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={certificateType}\n                    onChange={(e) => setCertificateType(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    required\n                  >\n                    <option value=\"employment\">Arbeitszeugnis</option>\n                    <option value=\"salary\">Gehaltsbescheinigung</option>\n                    <option value=\"work_experience\">Arbeitsbescheinigung</option>\n                  </select>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'text' && (\n              <div className=\"space-y-4\">\n                {/* Template-Auswahl */}\n                {availableTemplates.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Template verwenden\n                    </label>\n                    <div className=\"flex items-center space-x-3 mb-4\">\n                      <input\n                        type=\"checkbox\"\n                        checked={useTemplate}\n                        onChange={(e) => {\n                          setUseTemplate(e.target.checked);\n                          if (e.target.checked && pdfFile) {\n                            // Wenn Template aktiviert wird, entferne PDF\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      />\n                      <label className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        Template fr automatische PDF-Generierung verwenden\n                      </label>\n                    </div>\n                    {useTemplate && (\n                      <select\n                        value={selectedTemplate || ''}\n                        onChange={(e) => setSelectedTemplate(e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4\"\n                      >\n                        {availableTemplates.map((template) => (\n                          <option key={template.type} value={template.type}>\n                            Arbeitszeugnis (Version {template.version})\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    {useTemplate ? 'ODER PDF-Datei hochladen' : 'PDF-Datei hochladen'} {!useTemplate && <span className=\"text-red-500\">*</span>}\n                  </label>\n                  <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\".pdf\"\n                      onChange={handleFileSelect}\n                      className=\"hidden\"\n                    />\n                    {!pdfFile ? (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => fileInputRef.current?.click()}\n                          className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                        >\n                          PDF-Datei auswhlen\n                        </button>\n                        <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                          oder Datei hierher ziehen\n                        </p>\n                        <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                          Max. 10MB\n                        </p>\n                      </div>\n                    ) : (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                        <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                          {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                        </p>\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                            if (fileInputRef.current) {\n                              fileInputRef.current.value = '';\n                            }\n                          }}\n                          className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                        >\n                          Datei entfernen\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* PDF-Vorschau */}\n                {pdfPreviewUrl && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl}#view=FitH`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || (!pdfFile && !useTemplate)}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird erstellt...' : 'Erstellen'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default CertificateCreationModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, UserIcon, CurrencyDollarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface ContractCreationModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onContractCreated: () => void;\n  userId: number;\n  userName: string;\n}\n\ninterface UserData {\n  firstName: string;\n  lastName: string;\n  identificationNumber: string | null;\n  contractStartDate: string | null;\n  contractEndDate: string | null;\n  contractType: string | null;\n  salary: number | null;\n  position: string | null;\n}\n\nconst ContractCreationModal: React.FC<ContractCreationModalProps> = ({\n  isOpen,\n  onClose,\n  onContractCreated,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { user: currentUser } = useAuth();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [activeTab, setActiveTab] = useState<'data' | 'text'>('data');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [userData, setUserData] = useState<UserData | null>(null);\n  const [contractType, setContractType] = useState('employment');\n  const [startDate, setStartDate] = useState(new Date().toISOString().split('T')[0]);\n  const [endDate, setEndDate] = useState<string>('');\n  const [salary, setSalary] = useState<string>('');\n  const [workingHours, setWorkingHours] = useState<string>('');\n  const [position, setPosition] = useState<string>('');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [availableTemplates, setAvailableTemplates] = useState<Array<{type: string; version: string; path: string}>>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null);\n  const [useTemplate, setUseTemplate] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitsvertrge erstellen', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      fetchUserData();\n      fetchTemplates();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const fetchTemplates = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      const templates: Array<{type: string; version: string; path: string}> = [];\n      \n      if (documentTemplates.employmentContract) {\n        templates.push({\n          type: 'employmentContract',\n          version: documentTemplates.employmentContract.version,\n          path: documentTemplates.employmentContract.path\n        });\n      }\n      \n      setAvailableTemplates(templates);\n      if (templates.length > 0) {\n        setSelectedTemplate(templates[0].type);\n        setUseTemplate(true);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Templates:', err);\n      // Kein Fehler anzeigen, Templates sind optional\n    }\n  };\n\n  const fetchUserData = async () => {\n    try {\n      const [userResponse, lifecycleResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.USERS.BY_ID(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId))\n      ]);\n\n      const user = userResponse.data;\n      const lifecycle = lifecycleResponse.data.lifecycle;\n\n      const data: UserData = {\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        identificationNumber: user.identificationNumber || null,\n        contractStartDate: lifecycle?.contractStartDate || null,\n        contractEndDate: lifecycle?.contractEndDate || null,\n        contractType: lifecycle?.contractType || null,\n        salary: user.salary || null,\n        position: null\n      };\n\n      setUserData(data);\n      \n      // Setze Standard-Werte\n      if (data.contractStartDate) {\n        setStartDate(new Date(data.contractStartDate).toISOString().split('T')[0]);\n      }\n      if (data.contractEndDate) {\n        setEndDate(new Date(data.contractEndDate).toISOString().split('T')[0]);\n      }\n      if (data.salary) {\n        setSalary(data.salary.toString());\n      }\n      if (data.contractType) {\n        setContractType(data.contractType);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der User-Daten:', err);\n      setError('Fehler beim Laden der Daten');\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) { // 10MB\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      setUseTemplate(false); // Deaktiviere Template wenn PDF hochgeladen wird\n      // Erstelle Preview-URL\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n    }\n  };\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const validateForm = (): string | null => {\n    if (!useTemplate && !pdfFile) {\n      return 'Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch';\n    }\n    if (!startDate) {\n      return 'Bitte geben Sie ein Startdatum an';\n    }\n    const startDateObj = new Date(startDate);\n    if (isNaN(startDateObj.getTime())) {\n      return 'Ungltiges Startdatum';\n    }\n    if (endDate) {\n      const endDateObj = new Date(endDate);\n      if (isNaN(endDateObj.getTime())) {\n        return 'Ungltiges Enddatum';\n      }\n      if (endDateObj < startDateObj) {\n        return 'Enddatum muss nach dem Startdatum liegen';\n      }\n    }\n    if (salary && parseFloat(salary) < 0) {\n      return 'Gehalt darf nicht negativ sein';\n    }\n    if (workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)) {\n      return 'Arbeitsstunden mssen zwischen 0 und 168 liegen';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Client-seitige Validierung\n    const validationError = validateForm();\n    if (validationError) {\n      setError(validationError);\n      showMessage(validationError, 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      let pdfPath: string | undefined = undefined;\n      let templateUsed: string | null = null;\n      let templateVersion: string | null = null;\n\n      // Wenn Template verwendet werden soll und kein PDF hochgeladen wurde\n      if (useTemplate && selectedTemplate && !pdfFile) {\n        const template = availableTemplates.find(t => t.type === selectedTemplate);\n        if (template) {\n          templateUsed = template.type;\n          templateVersion = template.version;\n          // PDF wird vom Backend generiert\n        }\n      } else if (pdfFile) {\n        // PDF wurde hochgeladen - verwende dieses\n        pdfPath = `temp-${Date.now()}-${pdfFile.name}`; // Temporr\n      } else {\n        showMessage('Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch', 'error');\n        setLoading(false);\n        return;\n      }\n\n      const contractData = {\n        contractType,\n        startDate: new Date(startDate),\n        endDate: endDate ? new Date(endDate) : null,\n        salary: salary ? parseFloat(salary) : null,\n        workingHours: workingHours ? parseFloat(workingHours) : null,\n        position: position || null,\n        pdfPath,\n        templateUsed,\n        templateVersion\n      };\n\n      await axiosInstance.post(\n        API_ENDPOINTS.LIFECYCLE.CONTRACTS(userId),\n        contractData\n      );\n\n      showMessage('Arbeitsvertrag erfolgreich erstellt', 'success');\n      onContractCreated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      setStartDate(new Date().toISOString().split('T')[0]);\n      setEndDate('');\n      setSalary('');\n      setWorkingHours('');\n      setPosition('');\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Erstellen des Arbeitsvertrags:', err);\n      setError(err.response?.data?.message || 'Fehler beim Erstellen des Arbeitsvertrags');\n      showMessage('Fehler beim Erstellen des Arbeitsvertrags', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {/* Overlay */}\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitsvertrag erstellen\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Fr: <span className=\"font-medium dark:text-white\">{userName}</span>\n              </p>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n              <nav className=\"-mb-px flex space-x-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('data')}\n                  className={`${\n                    activeTab === 'data'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Vertragsdaten\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('text')}\n                  className={`${\n                    activeTab === 'text'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  PDF hochladen\n                </button>\n              </nav>\n            </div>\n\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            {/* Tab Content */}\n            {activeTab === 'data' && (\n              <div className=\"space-y-4\">\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4\">\n                  <h3 className=\"text-sm font-semibold dark:text-white mb-3\">\n                    Automatisch erkannte Daten\n                  </h3>\n                  <div className=\"space-y-2 text-sm\">\n                    {userData && (\n                      <>\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4 text-gray-400\" />\n                          <span className=\"text-gray-600 dark:text-gray-400\">Name:</span>\n                          <span className=\"dark:text-white\">\n                            {userData.firstName} {userData.lastName}\n                          </span>\n                        </div>\n                        {userData.identificationNumber && (\n                          <div className=\"flex items-center space-x-2\">\n                            <DocumentTextIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Cdula:</span>\n                            <span className=\"dark:text-white\">{userData.identificationNumber}</span>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Vertragstyp <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={contractType}\n                    onChange={(e) => setContractType(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  >\n                    <option value=\"employment\">Arbeitsvertrag</option>\n                    <option value=\"amendment\">Vertragsnderung</option>\n                    <option value=\"extension\">Vertragsverlngerung</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Startdatum <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={startDate}\n                    onChange={(e) => {\n                      setStartDate(e.target.value);\n                      setError(null); // Clear error when user starts typing\n                    }}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && !startDate \n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    required\n                    aria-invalid={!startDate}\n                    aria-describedby={!startDate ? \"startDate-error\" : undefined}\n                  />\n                  {error && !startDate && (\n                    <p id=\"startDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Enddatum (optional)\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={endDate}\n                    onChange={(e) => {\n                      setEndDate(e.target.value);\n                      // Wenn Enddatum gesetzt wird, prfe ob es nach Startdatum liegt\n                      if (e.target.value && startDate && new Date(e.target.value) < new Date(startDate)) {\n                        setError('Enddatum muss nach dem Startdatum liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    min={startDate || undefined}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && endDate && startDate && new Date(endDate) < new Date(startDate)\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    aria-invalid={endDate && startDate && new Date(endDate) < new Date(startDate) ? true : undefined}\n                    aria-describedby={endDate && startDate && new Date(endDate) < new Date(startDate) ? \"endDate-error\" : undefined}\n                  />\n                  {error && endDate && startDate && new Date(endDate) < new Date(startDate) && (\n                    <p id=\"endDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Position\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={position}\n                    onChange={(e) => setPosition(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    placeholder=\"z.B. Frontend-Entwickler\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Gehalt (optional)\n                  </label>\n                  <div className=\"relative\">\n                    <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                    <input\n                      type=\"number\"\n                      value={salary}\n                      onChange={(e) => {\n                        const value = e.target.value;\n                        setSalary(value);\n                        // Validierung: Gehalt darf nicht negativ sein\n                        if (value && parseFloat(value) < 0) {\n                          setError('Gehalt darf nicht negativ sein');\n                        } else {\n                          setError(null); // Clear error when valid\n                        }\n                      }}\n                      className={`w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                        error && salary && parseFloat(salary) < 0\n                          ? 'border-red-500 dark:border-red-500' \n                          : 'border-gray-300 dark:border-gray-600'\n                      }`}\n                      placeholder=\"0.00\"\n                      step=\"0.01\"\n                      min=\"0\"\n                      aria-invalid={salary && parseFloat(salary) < 0 ? true : undefined}\n                      aria-describedby={salary && parseFloat(salary) < 0 ? \"salary-error\" : undefined}\n                    />\n                  </div>\n                  {error && salary && parseFloat(salary) < 0 && (\n                    <p id=\"salary-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Arbeitsstunden/Woche (optional)\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={workingHours}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setWorkingHours(value);\n                      // Validierung: Arbeitsstunden mssen zwischen 0 und 168 liegen\n                      if (value && (parseFloat(value) < 0 || parseFloat(value) > 168)) {\n                        setError('Arbeitsstunden mssen zwischen 0 und 168 liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    placeholder=\"40\"\n                    step=\"0.1\"\n                    min=\"0\"\n                    max=\"168\"\n                    aria-invalid={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? true : undefined}\n                    aria-describedby={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? \"workingHours-error\" : undefined}\n                  />\n                  {error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) && (\n                    <p id=\"workingHours-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                    Maximal 168 Stunden pro Woche (24h  7 Tage)\n                  </p>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'text' && (\n              <div className=\"space-y-4\">\n                {/* Template-Auswahl */}\n                {availableTemplates.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Template verwenden\n                    </label>\n                    <div className=\"flex items-center space-x-3 mb-4\">\n                      <input\n                        type=\"checkbox\"\n                        checked={useTemplate}\n                        onChange={(e) => {\n                          setUseTemplate(e.target.checked);\n                          if (e.target.checked && pdfFile) {\n                            // Wenn Template aktiviert wird, entferne PDF\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      />\n                      <label className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        Template fr automatische PDF-Generierung verwenden\n                      </label>\n                    </div>\n                    {useTemplate && (\n                      <select\n                        value={selectedTemplate || ''}\n                        onChange={(e) => setSelectedTemplate(e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4\"\n                      >\n                        {availableTemplates.map((template) => (\n                          <option key={template.type} value={template.type}>\n                            Arbeitsvertrag (Version {template.version})\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    {useTemplate ? 'ODER PDF-Datei hochladen' : 'PDF-Datei hochladen'} {!useTemplate && <span className=\"text-red-500\">*</span>}\n                  </label>\n                  <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\".pdf\"\n                      onChange={handleFileSelect}\n                      className=\"hidden\"\n                    />\n                    {!pdfFile ? (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => fileInputRef.current?.click()}\n                          className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                        >\n                          PDF-Datei auswhlen\n                        </button>\n                        <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                          oder Datei hierher ziehen\n                        </p>\n                        <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                          Max. 10MB\n                        </p>\n                      </div>\n                    ) : (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                        <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                          {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                        </p>\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                            if (fileInputRef.current) {\n                              fileInputRef.current.value = '';\n                            }\n                          }}\n                          className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                        >\n                          Datei entfernen\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* PDF-Vorschau */}\n                {pdfPreviewUrl && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl}#view=FitH`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || (!pdfFile && !useTemplate) || !startDate}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird erstellt...' : 'Erstellen'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default ContractCreationModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Certificate {\n  id: number;\n  certificateType: string;\n  issueDate: string;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n}\n\ninterface CertificateEditModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCertificateUpdated: () => void;\n  userId: number;\n  certificate: Certificate;\n}\n\nconst CertificateEditModal: React.FC<CertificateEditModalProps> = ({\n  isOpen,\n  onClose,\n  onCertificateUpdated,\n  userId,\n  certificate\n}) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [issueDate, setIssueDate] = useState(\n    certificate.issueDate ? new Date(certificate.issueDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]\n  );\n  const [certificateType, setCertificateType] = useState(certificate.certificateType || 'employment');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [existingPdfUrl, setExistingPdfUrl] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitszeugnisse bearbeiten', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Lade bestehende PDF-URL wenn vorhanden\n      if (certificate.id) {\n        setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certificate.id));\n      }\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane, certificate.id, userId]);\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) {\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      // Erstelle Preview-URL fr neue Datei\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n      setExistingPdfUrl(null); // Verstecke bestehende PDF wenn neue hochgeladen wird\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const updateData: any = {\n        issueDate: new Date(issueDate),\n        certificateType\n      };\n\n      // Nur pdfPath aktualisieren, wenn neue Datei hochgeladen wurde\n      if (pdfFile) {\n        updateData.pdfPath = `temp-${Date.now()}-${pdfFile.name}`;\n        updateData.templateVersion = certificate.templateVersion || '1.0';\n      }\n\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATE(userId, certificate.id),\n        updateData\n      );\n\n      showMessage('Arbeitszeugnis erfolgreich aktualisiert', 'success');\n      onCertificateUpdated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Aktualisieren des Arbeitszeugnisses:', err);\n      setError(err.response?.data?.message || 'Fehler beim Aktualisieren des Arbeitszeugnisses');\n      showMessage('Fehler beim Aktualisieren des Arbeitszeugnisses', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitszeugnis bearbeiten\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Ausstellungsdatum\n                </label>\n                <input\n                  type=\"date\"\n                  value={issueDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setIssueDate(value);\n                    // Validierung: Datum darf nicht in der Zukunft liegen\n                    if (value && new Date(value) > new Date()) {\n                      setError('Ausstellungsdatum darf nicht in der Zukunft liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  max={new Date().toISOString().split('T')[0]}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && issueDate && new Date(issueDate) > new Date()\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  aria-invalid={issueDate && new Date(issueDate) > new Date() ? true : undefined}\n                  aria-describedby={issueDate && new Date(issueDate) > new Date() ? \"issueDate-error\" : undefined}\n                />\n                {error && issueDate && new Date(issueDate) > new Date() && (\n                  <p id=\"issueDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n                {!error && (\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                    Das Datum darf nicht in der Zukunft liegen\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Zertifikat-Typ\n                </label>\n                <select\n                  value={certificateType}\n                  onChange={(e) => setCertificateType(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                >\n                  <option value=\"employment\">Arbeitszeugnis</option>\n                  <option value=\"salary\">Gehaltsbescheinigung</option>\n                  <option value=\"work_experience\">Arbeitsbescheinigung</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  PDF-Datei aktualisieren (optional)\n                </label>\n                <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  {!pdfFile ? (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                      <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                      >\n                        Neue PDF-Datei auswhlen\n                      </button>\n                      <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                        oder Datei hierher ziehen\n                      </p>\n                      <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                        Max. 10MB\n                      </p>\n                    </div>\n                  ) : (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                      <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                        {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          setPdfFile(null);\n                          if (pdfPreviewUrl) {\n                            URL.revokeObjectURL(pdfPreviewUrl);\n                            setPdfPreviewUrl(null);\n                          }\n                          setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certificate.id));\n                          if (fileInputRef.current) {\n                            fileInputRef.current.value = '';\n                          }\n                        }}\n                        className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                      >\n                        Datei entfernen\n                      </button>\n                    </div>\n                  )}\n                </div>\n\n                {/* PDF-Vorschau */}\n                {(pdfPreviewUrl || existingPdfUrl) && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl || existingPdfUrl}${pdfPreviewUrl ? '#view=FitH' : '?preview=true#view=FitH'}`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4\">\n                <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n                  <strong>Hinweis:</strong> Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt.\n                  Eine neue Version wird erstellt (isLatest = true).\n                </p>\n              </div>\n            </form>\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird aktualisiert...' : 'Aktualisieren'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default CertificateEditModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, CurrencyDollarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Contract {\n  id: number;\n  contractType: string;\n  startDate: string;\n  endDate: string | null;\n  salary: number | null;\n  workingHours: number | null;\n  position: string | null;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n}\n\ninterface ContractEditModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onContractUpdated: () => void;\n  userId: number;\n  contract: Contract;\n}\n\nconst ContractEditModal: React.FC<ContractEditModalProps> = ({\n  isOpen,\n  onClose,\n  onContractUpdated,\n  userId,\n  contract\n}) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [contractType, setContractType] = useState(contract.contractType || 'employment');\n  const [startDate, setStartDate] = useState(\n    contract.startDate ? new Date(contract.startDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]\n  );\n  const [endDate, setEndDate] = useState(\n    contract.endDate ? new Date(contract.endDate).toISOString().split('T')[0] : ''\n  );\n  const [salary, setSalary] = useState(contract.salary ? contract.salary.toString() : '');\n  const [workingHours, setWorkingHours] = useState(contract.workingHours ? contract.workingHours.toString() : '');\n  const [position, setPosition] = useState(contract.position || '');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [existingPdfUrl, setExistingPdfUrl] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitsvertrge bearbeiten', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Lade bestehende PDF-URL wenn vorhanden\n      if (contract.id) {\n        setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contract.id));\n      }\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane, contract.id, userId]);\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) {\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      // Erstelle Preview-URL fr neue Datei\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n      setExistingPdfUrl(null); // Verstecke bestehende PDF wenn neue hochgeladen wird\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!startDate) {\n      showMessage('Bitte geben Sie ein Startdatum an', 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const updateData: any = {\n        contractType,\n        startDate: new Date(startDate),\n        endDate: endDate ? new Date(endDate) : null,\n        salary: salary ? parseFloat(salary) : null,\n        workingHours: workingHours ? parseFloat(workingHours) : null,\n        position: position || null\n      };\n\n      // Nur pdfPath aktualisieren, wenn neue Datei hochgeladen wurde\n      if (pdfFile) {\n        updateData.pdfPath = `temp-${Date.now()}-${pdfFile.name}`;\n        updateData.templateVersion = contract.templateVersion || '1.0';\n      }\n\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.CONTRACT(userId, contract.id),\n        updateData\n      );\n\n      showMessage('Arbeitsvertrag erfolgreich aktualisiert', 'success');\n      onContractUpdated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Aktualisieren des Arbeitsvertrags:', err);\n      setError(err.response?.data?.message || 'Fehler beim Aktualisieren des Arbeitsvertrags');\n      showMessage('Fehler beim Aktualisieren des Arbeitsvertrags', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitsvertrag bearbeiten\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Vertragstyp <span className=\"text-red-500\">*</span>\n                </label>\n                <select\n                  value={contractType}\n                  onChange={(e) => setContractType(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                >\n                  <option value=\"employment\">Arbeitsvertrag</option>\n                  <option value=\"amendment\">Vertragsnderung</option>\n                  <option value=\"extension\">Vertragsverlngerung</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Startdatum <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"date\"\n                  value={startDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setStartDate(value);\n                    // Wenn Enddatum gesetzt ist, prfe ob es nach Startdatum liegt\n                    if (endDate && value && new Date(endDate) < new Date(value)) {\n                      setError('Enddatum muss nach dem Startdatum liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && !startDate \n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  required\n                  aria-invalid={!startDate ? true : undefined}\n                  aria-describedby={!startDate ? \"startDate-error\" : undefined}\n                />\n                {error && !startDate && (\n                  <p id=\"startDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Enddatum (optional)\n                </label>\n                <input\n                  type=\"date\"\n                  value={endDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setEndDate(value);\n                    // Wenn Enddatum gesetzt wird, prfe ob es nach Startdatum liegt\n                    if (value && startDate && new Date(value) < new Date(startDate)) {\n                      setError('Enddatum muss nach dem Startdatum liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  min={startDate || undefined}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && endDate && startDate && new Date(endDate) < new Date(startDate)\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  aria-invalid={endDate && startDate && new Date(endDate) < new Date(startDate) ? true : undefined}\n                  aria-describedby={endDate && startDate && new Date(endDate) < new Date(startDate) ? \"endDate-error\" : undefined}\n                />\n                {error && endDate && startDate && new Date(endDate) < new Date(startDate) && (\n                  <p id=\"endDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Position\n                </label>\n                <input\n                  type=\"text\"\n                  value={position}\n                  onChange={(e) => setPosition(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  placeholder=\"z.B. Frontend-Entwickler\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Gehalt (optional)\n                </label>\n                <div className=\"relative\">\n                  <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                  <input\n                    type=\"number\"\n                    value={salary}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setSalary(value);\n                      // Validierung: Gehalt darf nicht negativ sein\n                      if (value && parseFloat(value) < 0) {\n                        setError('Gehalt darf nicht negativ sein');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    className={`w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && salary && parseFloat(salary) < 0\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    placeholder=\"0.00\"\n                    step=\"0.01\"\n                    min=\"0\"\n                    aria-invalid={salary && parseFloat(salary) < 0 ? true : undefined}\n                    aria-describedby={salary && parseFloat(salary) < 0 ? \"salary-error\" : undefined}\n                  />\n                </div>\n                {error && salary && parseFloat(salary) < 0 && (\n                  <p id=\"salary-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Arbeitsstunden/Woche (optional)\n                </label>\n                <input\n                  type=\"number\"\n                  value={workingHours}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setWorkingHours(value);\n                    // Validierung: Arbeitsstunden mssen zwischen 0 und 168 liegen\n                    if (value && (parseFloat(value) < 0 || parseFloat(value) > 168)) {\n                      setError('Arbeitsstunden mssen zwischen 0 und 168 liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  placeholder=\"40\"\n                  step=\"0.1\"\n                  min=\"0\"\n                  max=\"168\"\n                  aria-invalid={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? true : undefined}\n                  aria-describedby={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? \"workingHours-error\" : undefined}\n                />\n                {error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) && (\n                  <p id=\"workingHours-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  Maximal 168 Stunden pro Woche (24h  7 Tage)\n                </p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  PDF-Datei aktualisieren (optional)\n                </label>\n                <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  {!pdfFile ? (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                      <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                      >\n                        Neue PDF-Datei auswhlen\n                      </button>\n                      <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                        oder Datei hierher ziehen\n                      </p>\n                      <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                        Max. 10MB\n                      </p>\n                    </div>\n                  ) : (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                      <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                        {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          setPdfFile(null);\n                          if (pdfPreviewUrl) {\n                            URL.revokeObjectURL(pdfPreviewUrl);\n                            setPdfPreviewUrl(null);\n                          }\n                          setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contract.id));\n                          if (fileInputRef.current) {\n                            fileInputRef.current.value = '';\n                          }\n                        }}\n                        className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                      >\n                        Datei entfernen\n                      </button>\n                    </div>\n                  )}\n                </div>\n\n                {/* PDF-Vorschau */}\n                {(pdfPreviewUrl || existingPdfUrl) && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl || existingPdfUrl}${pdfPreviewUrl ? '#view=FitH' : '?preview=true#view=FitH'}`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4\">\n                <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n                  <strong>Hinweis:</strong> Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt.\n                  Eine neue Version wird erstellt (isLatest = true).\n                </p>\n              </div>\n            </form>\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || !startDate}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird aktualisiert...' : 'Aktualisieren'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default ContractEditModal;\n\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n  CheckCircleIcon,\n  ClockIcon,\n  XCircleIcon,\n  PencilIcon,\n  EnvelopeIcon,\n  DocumentTextIcon,\n  XMarkIcon,\n  ArrowPathIcon\n} from '@heroicons/react/24/outline';\n// Social Security Editor Component\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface SocialSecurityRegistration {\n  id: number;\n  registrationType: string;\n  registrationNumber: string | null;\n  provider: string | null;\n  registrationDate: string | null;\n  status: string;\n  notes: string | null;\n  completedAt: string | null;\n}\n\ninterface SocialSecurityEditorProps {\n  userId: number;\n  lifecycleId: number;\n  onUpdate?: () => void;\n}\n\ntype SocialSecurityType = 'arl' | 'eps' | 'pension' | 'caja';\n\nconst SocialSecurityEditor: React.FC<SocialSecurityEditorProps> = ({\n  userId,\n  lifecycleId,\n  onUpdate\n}) => {\n  const { t } = useTranslation();\n  const { isLegal, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  \n  const [registrations, setRegistrations] = useState<Record<SocialSecurityType, SocialSecurityRegistration | null>>({\n    arl: null,\n    eps: null,\n    pension: null,\n    caja: null\n  });\n  const [loading, setLoading] = useState(true);\n  const [editingType, setEditingType] = useState<SocialSecurityType | null>(null);\n  const [formData, setFormData] = useState({\n    status: 'pending' as string,\n    registrationNumber: '',\n    provider: '',\n    registrationDate: '',\n    notes: ''\n  });\n  const [saving, setSaving] = useState(false);\n  const loadingRef = useRef(false);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  // loadRegistrations auerhalb von useEffect definieren, damit es von handleSave aufgerufen werden kann\n  const loadRegistrations = useCallback(async () => {\n    // Erstelle neuen AbortController\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n    const abortController = new AbortController();\n    abortControllerRef.current = abortController;\n\n    loadingRef.current = true;\n    setLoading(true);\n    try {\n      const types: SocialSecurityType[] = ['arl', 'eps', 'pension', 'caja'];\n      const registrationPromises = types.map(async (type) => {\n        // Prfe ob Request abgebrochen wurde\n        if (abortController.signal.aborted) {\n          return { type, registration: null };\n        }\n\n        try {\n          const response = await axiosInstance.get(\n            API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, type),\n            {\n              timeout: 5000, // 5 Sekunden Timeout\n              signal: abortController.signal\n            }\n          );\n          return { type, registration: response.data };\n        } catch (error: any) {\n          // Ignoriere Abort-Errors (AbortError oder CanceledError von Axios)\n          if (error.name === 'AbortError' || error.name === 'CanceledError' || abortController.signal.aborted) {\n            return { type, registration: null };\n          }\n          // Behandle 404 als \"nicht vorhanden\" (normal)\n          if (error.response?.status === 404) {\n            return { type, registration: null };\n          }\n          // Behandle Network Errors und Timeouts\n          if (error.code === 'ERR_NETWORK' || error.code === 'ECONNABORTED' || error.message?.includes('ERR_INSUFFICIENT_RESOURCES')) {\n            console.warn(`Network error loading ${type}, treating as not found`);\n            return { type, registration: null };\n          }\n          console.error(`Error loading ${type}:`, error);\n          return { type, registration: null };\n        }\n      });\n\n      const results = await Promise.all(registrationPromises);\n      \n      // Prfe erneut ob Request abgebrochen wurde\n      if (abortController.signal.aborted) {\n        return;\n      }\n\n      const newRegistrations: Record<SocialSecurityType, SocialSecurityRegistration | null> = {\n        arl: null,\n        eps: null,\n        pension: null,\n        caja: null\n      };\n\n      results.forEach(({ type, registration }) => {\n        if (registration) {\n          // Backend gibt zurck: { id, type, status, number, provider, registeredAt, notes, completedAt }\n          // Mappe auf Frontend-Format: { id, registrationType, registrationNumber, provider, registrationDate, status, notes, completedAt }\n          newRegistrations[type as SocialSecurityType] = {\n            id: registration.id || 0,\n            registrationType: type,\n            registrationNumber: registration.number || registration.registrationNumber || null,\n            provider: registration.provider || null,\n            registrationDate: registration.registeredAt || registration.registrationDate || null,\n            status: registration.status || 'pending',\n            notes: registration.notes || null,\n            completedAt: registration.completedAt || null\n          };\n        }\n      });\n\n      setRegistrations(newRegistrations);\n    } catch (error: any) {\n      // Ignoriere Abort-Errors (AbortError oder CanceledError von Axios)\n      if (error.name === 'AbortError' || error.name === 'CanceledError' || abortController.signal.aborted) {\n        return;\n      }\n      console.error('Error loading registrations:', error);\n      showMessage(t('socialSecurity.loadError'), 'error');\n    } finally {\n      // Setze loading immer auf false, auch bei Abbruch\n      setLoading(false);\n      loadingRef.current = false;\n    }\n  }, [userId, t, showMessage]);\n\n  useEffect(() => {\n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      return;\n    }\n    \n    // Prfe Berechtigung und lade nur einmal pro userId/lifecycleId\n    const hasPermission = isLegal() || isAdmin();\n    if (!hasPermission || !userId || !lifecycleId) {\n      setLoading(false);\n      return;\n    }\n\n    // Verhindere mehrfaches gleichzeitiges Laden\n    if (loadingRef.current) {\n      return;\n    }\n\n    loadRegistrations();\n\n    // Cleanup: Breche Request ab wenn Component unmountet oder Dependencies sich ndern\n    return () => {\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n      loadingRef.current = false;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userId, lifecycleId, permissionsLoading]); // permissionsLoading als Dependency hinzugefgt\n\n  const handleEdit = (type: SocialSecurityType) => {\n    const registration = registrations[type];\n    if (registration) {\n      setFormData({\n        status: registration.status,\n        registrationNumber: registration.registrationNumber || '',\n        provider: registration.provider || '',\n        registrationDate: registration.registrationDate \n          ? new Date(registration.registrationDate).toISOString().split('T')[0]\n          : '',\n        notes: registration.notes || ''\n      });\n    } else {\n      setFormData({\n        status: 'pending',\n        registrationNumber: '',\n        provider: '',\n        registrationDate: '',\n        notes: ''\n      });\n    }\n    setEditingType(type);\n  };\n\n  const handleCancel = () => {\n    setEditingType(null);\n    setFormData({\n      status: 'pending',\n      registrationNumber: '',\n      provider: '',\n      registrationDate: '',\n      notes: ''\n    });\n  };\n\n  const handleSave = async () => {\n    if (!editingType) return;\n    \n    // Prfe Berechtigung nochmal vor dem Speichern\n    if (permissionsLoading) {\n      showMessage(t('common.loading', { defaultValue: 'Berechtigungen werden geladen...' }), 'warning');\n      return;\n    }\n    \n    if (!isLegal() && !isAdmin()) {\n      showMessage(t('lifecycle.noPermission', { defaultValue: 'Keine Berechtigung - nur Legal oder Admin' }), 'error');\n      return;\n    }\n\n    setSaving(true);\n    try {\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, editingType),\n        {\n          status: formData.status,\n          number: formData.registrationNumber || undefined,\n          provider: formData.provider || undefined,\n          registrationDate: formData.registrationDate \n            ? new Date(formData.registrationDate).toISOString()\n            : undefined,\n          notes: formData.notes || undefined\n        }\n      );\n\n      showMessage('Sozialversicherung erfolgreich aktualisiert', 'success');\n      setEditingType(null);\n      \n      // Warte kurz, damit Backend die Daten aktualisiert hat\n      await new Promise(resolve => setTimeout(resolve, 200));\n      \n      // Lade Registrierungen neu nach Update\n      await loadRegistrations();\n      \n      // onUpdate nur aufrufen, wenn es eine Funktion ist (verhindert Re-Render-Loops)\n      if (onUpdate && typeof onUpdate === 'function') {\n        // Rufe onUpdate auf, um LifecycleView zu aktualisieren\n        onUpdate();\n      }\n    } catch (error: any) {\n      console.error('Error updating social security:', error);\n      showMessage(\n        error.response?.data?.message || t('socialSecurity.updateError'),\n        'error'\n      );\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'registered':\n        return <CheckCircleIcon className=\"h-5 w-5 text-green-500\" />;\n      case 'pending':\n        return <ClockIcon className=\"h-5 w-5 text-yellow-500\" />;\n      case 'failed':\n        return <XCircleIcon className=\"h-5 w-5 text-red-500\" />;\n      case 'not_required':\n        return <CheckCircleIcon className=\"h-5 w-5 text-gray-400\" />;\n      case 'deregistered':\n        return <XCircleIcon className=\"h-5 w-5 text-gray-400\" />;\n      default:\n        return <ClockIcon className=\"h-5 w-5 text-gray-400\" />;\n    }\n  };\n\n  const getStatusLabel = (status: string) => {\n    const labelKey = `lifecycle.socialSecurityStatus.${status}`;\n    return t(labelKey) || status;\n  };\n\n  const getTypeLabel = (type: SocialSecurityType) => {\n    const labels: Record<SocialSecurityType, string> = {\n      arl: 'ARL (Risiko-Arbeit)',\n      eps: 'EPS (Gesundheit)',\n      pension: 'Pension',\n      caja: 'Caja de Compensacin'\n    };\n    return labels[type];\n  };\n\n  // Warte bis Berechtigungen geladen sind\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isLegal() && !isAdmin()) {\n    return null;\n  }\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  const types: SocialSecurityType[] = ['arl', 'eps', 'pension', 'caja'];\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n          <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n          {t('lifecycle.socialSecurity', { defaultValue: 'Sozialversicherungen' })}\n        </h3>\n      </div>\n\n      <div className=\"space-y-4\">\n        {types.map((type) => {\n          const registration = registrations[type];\n          const isEditing = editingType === type;\n\n          return (\n            <div\n              key={type}\n              className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\"\n            >\n              {!isEditing ? (\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex items-start space-x-3 flex-1\">\n                    {getStatusIcon(registration?.status || 'pending')}\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center space-x-2 mb-2\">\n                        <h4 className=\"font-medium dark:text-white uppercase\">\n                          {getTypeLabel(type)}\n                        </h4>\n                        <span className=\"text-sm font-medium dark:text-white\">\n                          {getStatusLabel(registration?.status || 'pending')}\n                        </span>\n                      </div>\n                      {registration && (\n                        <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                          {registration.provider && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.provider')}:</span> {registration.provider}\n                            </div>\n                          )}\n                          {registration.registrationNumber && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.number')}:</span> {registration.registrationNumber}\n                            </div>\n                          )}\n                          {registration.registrationDate && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.registrationDate')}:</span>{' '}\n                              {new Date(registration.registrationDate).toLocaleDateString('de-DE')}\n                            </div>\n                          )}\n                          {registration.notes && (\n                            <div className=\"mt-2\">\n                              <span className=\"font-medium\">{t('socialSecurity.notes')}:</span>\n                              <p className=\"text-gray-500 dark:text-gray-400 mt-1\">\n                                {registration.notes}\n                              </p>\n                            </div>\n                          )}\n                          {registration.completedAt && (\n                            <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\n                              {t('socialSecurity.completedAt')}{' '}\n                              {new Date(registration.completedAt).toLocaleDateString('de-DE')}\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      {!registration && (\n                        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                          {t('socialSecurity.notRegistered')}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                  <button\n                    onClick={() => handleEdit(type)}\n                    className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition ml-4\"\n                    title={t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  >\n                    <PencilIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium dark:text-white uppercase mb-3\">\n                    {t('socialSecurity.editType', { type: getTypeLabel(type) })}\n                  </h4>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('socialSecurity.status')} <span className=\"text-red-500\">*</span>\n                    </label>\n                    <select\n                      value={formData.status}\n                      onChange={(e) => setFormData({ ...formData, status: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    >\n                      <option value=\"not_required\">Nicht erforderlich</option>\n                      <option value=\"pending\">Ausstehend</option>\n                      <option value=\"registered\">Registriert</option>\n                      <option value=\"failed\">Fehlgeschlagen</option>\n                      <option value=\"deregistered\">Abgemeldet</option>\n                    </select>\n                  </div>\n\n                  {formData.status === 'registered' && (\n                    <>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.registrationNumber')}\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={formData.registrationNumber}\n                          onChange={(e) => setFormData({ ...formData, registrationNumber: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                          placeholder=\"z.B. 123456789\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.provider')}\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={formData.provider}\n                          onChange={(e) => setFormData({ ...formData, provider: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                          placeholder=\"z.B. ARL Sura, EPS Sanitas\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.registrationDate')}\n                        </label>\n                        <input\n                          type=\"date\"\n                          value={formData.registrationDate}\n                          onChange={(e) => setFormData({ ...formData, registrationDate: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                        />\n                      </div>\n                    </>\n                  )}\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('socialSecurity.notes')}\n                    </label>\n                    <textarea\n                      value={formData.notes}\n                      onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      rows={3}\n                      placeholder={t('socialSecurity.additionalInfo')}\n                    />\n                  </div>\n\n                  <div className=\"flex items-center justify-end space-x-3\">\n                    <button\n                      onClick={handleCancel}\n                      disabled={saving}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={t('common.cancel')}\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      onClick={handleSave}\n                      disabled={saving}\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={saving ? t('common.saving') : t('common.save')}\n                    >\n                      {saving ? (\n                        <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                      ) : (\n                        <CheckCircleIcon className=\"h-5 w-5\" />\n                      )}\n                    </button>\n                  </div>\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default SocialSecurityEditor;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ExclamationTriangleIcon, CalendarIcon, ArrowPathIcon, ArrowRightIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface OffboardingStartModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onOffboardingStarted: () => void;\n  userId: number;\n  userName: string;\n}\n\nconst OffboardingStartModal: React.FC<OffboardingStartModalProps> = ({\n  isOpen,\n  onClose,\n  onOffboardingStarted,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [exitDate, setExitDate] = useState('');\n  const [exitReason, setExitReason] = useState('');\n  \n  // Validierung\n  const [validationErrors, setValidationErrors] = useState<{\n    exitDate?: string;\n    exitReason?: string;\n  }>({});\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Setze Standard-Datum auf heute\n      const today = new Date().toISOString().split('T')[0];\n      setExitDate(today);\n      setExitReason('');\n      setError(null);\n      setValidationErrors({});\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = (): boolean => {\n    const errors: { exitDate?: string; exitReason?: string } = {};\n\n    // Validierung: exitDate\n    if (!exitDate) {\n      errors.exitDate = t('lifecycle.offboarding.exitDateRequired', { defaultValue: 'Austrittsdatum ist erforderlich' });\n    } else {\n      const selectedDate = new Date(exitDate);\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      \n      // exitDate darf in der Vergangenheit liegen (rckwirkende Erfassung erlaubt)\n      // Aber nicht zu weit in der Zukunft (max. 1 Jahr)\n      const maxDate = new Date();\n      maxDate.setFullYear(maxDate.getFullYear() + 1);\n      \n      if (selectedDate > maxDate) {\n        errors.exitDate = t('lifecycle.offboarding.exitDateTooFar', { defaultValue: 'Austrittsdatum darf nicht mehr als 1 Jahr in der Zukunft liegen' });\n      }\n    }\n\n    // Validierung: exitReason\n    if (!exitReason || exitReason.trim().length === 0) {\n      errors.exitReason = t('lifecycle.offboarding.exitReasonRequired', { defaultValue: 'Austrittsgrund ist erforderlich' });\n    } else if (exitReason.trim().length < 10) {\n      errors.exitReason = t('lifecycle.offboarding.exitReasonTooShort', { defaultValue: 'Austrittsgrund muss mindestens 10 Zeichen lang sein' });\n    }\n\n    setValidationErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\n        status: 'offboarding',\n        exitDate: exitDate,\n        exitReason: exitReason.trim()\n      });\n\n      showMessage(\n        t('lifecycle.offboarding.started', { defaultValue: 'Offboarding erfolgreich gestartet' }),\n        'success'\n      );\n      \n      onOffboardingStarted();\n      onClose();\n    } catch (err: any) {\n      console.error('Fehler beim Starten des Offboarding:', err);\n      const errorMessage = err.response?.data?.message || \n        t('lifecycle.offboarding.startError', { defaultValue: 'Fehler beim Starten des Offboarding' });\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const renderForm = () => (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      {/* Warnung */}\n      <div className=\"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4\">\n        <div className=\"flex items-start\">\n          <ExclamationTriangleIcon className=\"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5 mr-3 flex-shrink-0\" />\n          <div className=\"text-sm text-orange-800 dark:text-orange-200\">\n            <p className=\"font-medium mb-1\">\n              {t('lifecycle.offboarding.warningTitle', { defaultValue: 'Wichtiger Hinweis' })}\n            </p>\n            <p>\n              {t('lifecycle.offboarding.warningText', { defaultValue: 'Durch das Starten des Offboarding-Prozesses werden automatisch Tasks erstellt. Dieser Vorgang kann nicht rckgngig gemacht werden.' })}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* User-Info */}\n      <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">\n          {t('lifecycle.offboarding.user', { defaultValue: 'Mitarbeiter' })}\n        </p>\n        <p className=\"font-medium dark:text-white\">{userName}</p>\n      </div>\n\n      {/* exitDate */}\n      <div>\n        <label htmlFor=\"exitDate\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {t('lifecycle.offboarding.exitDate', { defaultValue: 'Austrittsdatum' })} *\n        </label>\n        <div className=\"relative\">\n          <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n            <CalendarIcon className=\"h-5 w-5 text-gray-400\" />\n          </div>\n          <input\n            type=\"date\"\n            id=\"exitDate\"\n            value={exitDate}\n            onChange={(e) => {\n              setExitDate(e.target.value);\n              if (validationErrors.exitDate) {\n                setValidationErrors(prev => ({ ...prev, exitDate: undefined }));\n              }\n            }}\n            className={`block w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n              validationErrors.exitDate\n                ? 'border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500'\n                : 'border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500'\n            }`}\n            required\n          />\n        </div>\n        {validationErrors.exitDate && (\n          <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{validationErrors.exitDate}</p>\n        )}\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n          {t('lifecycle.offboarding.exitDateHint', { defaultValue: 'Das Datum, an dem der Mitarbeiter die Organisation verlsst' })}\n        </p>\n      </div>\n\n      {/* exitReason */}\n      <div>\n        <label htmlFor=\"exitReason\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {t('lifecycle.offboarding.exitReason', { defaultValue: 'Austrittsgrund' })} *\n        </label>\n        <textarea\n          id=\"exitReason\"\n          value={exitReason}\n          onChange={(e) => {\n            setExitReason(e.target.value);\n            if (validationErrors.exitReason) {\n              setValidationErrors(prev => ({ ...prev, exitReason: undefined }));\n            }\n          }}\n          rows={4}\n          className={`block w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n            validationErrors.exitReason\n              ? 'border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500'\n              : 'border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500'\n          }`}\n          placeholder={t('lifecycle.offboarding.exitReasonPlaceholder', { defaultValue: 'z.B. Kndigung, Vertragsende, etc.' })}\n          required\n        />\n        {validationErrors.exitReason && (\n          <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{validationErrors.exitReason}</p>\n        )}\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n          {t('lifecycle.offboarding.exitReasonHint', { defaultValue: 'Mindestens 10 Zeichen. Beschreiben Sie den Grund fr den Austritt.' })}\n        </p>\n      </div>\n\n      {/* Error-Message */}\n      {error && (\n        <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n          <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n        </div>\n      )}\n\n      {/* Buttons */}\n      <div className=\"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n        <button\n          type=\"button\"\n          onClick={onClose}\n          disabled={loading}\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\n          title={t('common.cancel', { defaultValue: 'Abbrechen' })}\n        >\n          <XMarkIcon className=\"h-5 w-5\" />\n        </button>\n        <button\n          type=\"submit\"\n          disabled={loading}\n          className=\"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n          title={loading ? t('common.saving', { defaultValue: 'Speichern...' }) : t('lifecycle.offboarding.startButton', { defaultValue: 'Offboarding starten' })}\n        >\n          {loading ? (\n            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n          ) : (\n            <ArrowRightIcon className=\"h-5 w-5\" />\n          )}\n        </button>\n      </div>\n    </form>\n  );\n\n  if (!isOpen) return null;\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('lifecycle.offboarding.startTitle', { defaultValue: 'Offboarding starten' })}\n              </Dialog.Title>\n              <button\n                onClick={onClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <div className=\"p-4\">\n              {renderForm()}\n            </div>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={onClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('lifecycle.offboarding.startTitle', { defaultValue: 'Offboarding starten' })}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {renderForm()}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default OffboardingStartModal;\n\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, ExclamationTriangleIcon, CheckCircleIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\r\nimport useMessage from '../hooks/useMessage.ts';\r\n\r\ninterface Task {\r\n  id: number;\r\n  title: string;\r\n  description: string | null;\r\n  status: string;\r\n  dueDate: string | null;\r\n  createdAt: string;\r\n}\r\n\r\ninterface OffboardingCompleteModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onOffboardingCompleted: () => void;\r\n  userId: number;\r\n  userName: string;\r\n  offboardingTasks: Task[];\r\n}\r\n\r\nconst OffboardingCompleteModal: React.FC<OffboardingCompleteModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onOffboardingCompleted,\r\n  userId,\r\n  userName,\r\n  offboardingTasks\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const { showMessage } = useMessage();\r\n  \r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [confirmText, setConfirmText] = useState('');\r\n  \r\n  // Prfe, ob alle Tasks abgeschlossen sind\r\n  const completedTasks = offboardingTasks.filter(task => task.status === 'done');\r\n  const allTasksCompleted = offboardingTasks.length > 0 && completedTasks.length === offboardingTasks.length;\r\n  const requiredConfirmText = userName.trim().toLowerCase();\r\n  \r\n  // Responsive Erkennung\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n  \r\n  // Sidepane-Status verwalten\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      // Reset form on open\r\n      setConfirmText('');\r\n      setError(null);\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane]);\r\n  \r\n  const validateForm = () => {\r\n    if (confirmText.trim().toLowerCase() !== requiredConfirmText) {\r\n      setError(t('lifecycle.offboarding.complete.confirmTextMismatch', { defaultValue: 'Besttigungstext stimmt nicht berein' }));\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  \r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\r\n        status: 'archived'\r\n      });\r\n      \r\n      showMessage(\r\n        t('lifecycle.offboarding.complete.success', { defaultValue: 'Offboarding erfolgreich abgeschlossen' }),\r\n        'success'\r\n      );\r\n      \r\n      onOffboardingCompleted();\r\n      onClose();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Abschlieen des Offboarding:', err);\r\n      const errorMessage = err.response?.data?.message || \r\n        t('lifecycle.offboarding.complete.error', { defaultValue: 'Fehler beim Abschlieen des Offboarding' });\r\n      setError(errorMessage);\r\n      showMessage(errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  const renderForm = () => (\r\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n      {/* User Info */}\r\n      <div className=\"bg-gray-50 dark:bg-gray-700 p-3 rounded-md flex items-center space-x-3\">\r\n        <CheckCircleIcon className=\"h-5 w-5 text-gray-500 dark:text-gray-400\" />\r\n        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n          {t('lifecycle.offboarding.complete.user', { defaultValue: 'Mitarbeiter' })}: {userName}\r\n        </span>\r\n      </div>\r\n      \r\n      {/* Tasks Status */}\r\n      {offboardingTasks.length > 0 && (\r\n        <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-md\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n            {t('lifecycle.offboarding.complete.tasksStatus', { defaultValue: 'Status der Offboarding-Aufgaben' })}\r\n          </h4>\r\n          <div className=\"space-y-2\">\r\n            {offboardingTasks.map((task) => {\r\n                  const isCompleted = task.status === 'done';\r\n              return (\r\n                <div\r\n                  key={task.id}\r\n                  className={`flex items-center space-x-2 text-sm ${\r\n                    isCompleted\r\n                      ? 'text-green-700 dark:text-green-300'\r\n                      : 'text-orange-700 dark:text-orange-300'\r\n                  }`}\r\n                >\r\n                  {isCompleted ? (\r\n                    <CheckCircleIcon className=\"h-4 w-4 flex-shrink-0\" />\r\n                  ) : (\r\n                    <ExclamationTriangleIcon className=\"h-4 w-4 flex-shrink-0\" />\r\n                  )}\r\n                  <span>{task.title}</span>\r\n                  <span className=\"ml-auto text-xs\">\r\n                    {isCompleted\r\n                      ? `(${t('common.done', { defaultValue: 'Abgeschlossen' })})`\r\n                      : `(${t('common.open', { defaultValue: 'Offen' })})`}\r\n                  </span>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Warning wenn nicht alle Tasks abgeschlossen */}\r\n      {!allTasksCompleted && offboardingTasks.length > 0 && (\r\n        <div className=\"bg-orange-50 dark:bg-orange-900/20 border-l-4 border-orange-400 p-4\">\r\n          <div className=\"flex\">\r\n            <div className=\"flex-shrink-0\">\r\n              <ExclamationTriangleIcon className=\"h-5 w-5 text-orange-400\" aria-hidden=\"true\" />\r\n            </div>\r\n            <div className=\"ml-3\">\r\n              <h3 className=\"text-sm font-medium text-orange-800 dark:text-orange-300\">\r\n                {t('lifecycle.offboarding.complete.warningTitle', { defaultValue: 'Nicht alle Aufgaben abgeschlossen' })}\r\n              </h3>\r\n              <div className=\"mt-2 text-sm text-orange-700 dark:text-orange-200\">\r\n                <p>\r\n                  {t('lifecycle.offboarding.complete.warningText', { \r\n                    defaultValue: 'Es sind noch nicht alle Offboarding-Aufgaben abgeschlossen. Sie knnen das Offboarding trotzdem abschlieen, aber es wird empfohlen, alle Aufgaben zuerst zu erledigen.'\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Info wenn alle Tasks abgeschlossen */}\r\n      {allTasksCompleted && (\r\n        <div className=\"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-400 p-4\">\r\n          <div className=\"flex\">\r\n            <div className=\"flex-shrink-0\">\r\n              <CheckCircleIcon className=\"h-5 w-5 text-green-400\" aria-hidden=\"true\" />\r\n            </div>\r\n            <div className=\"ml-3\">\r\n              <h3 className=\"text-sm font-medium text-green-800 dark:text-green-300\">\r\n                {t('lifecycle.offboarding.complete.allTasksCompleted', { defaultValue: 'Alle Aufgaben abgeschlossen' })}\r\n              </h3>\r\n              <div className=\"mt-2 text-sm text-green-700 dark:text-green-200\">\r\n                <p>\r\n                  {t('lifecycle.offboarding.complete.allTasksCompletedText', { \r\n                    defaultValue: 'Alle Offboarding-Aufgaben sind abgeschlossen. Sie knnen das Offboarding jetzt abschlieen.'\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Confirm Text Input */}\r\n      <div>\r\n        <label htmlFor=\"confirmText\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('lifecycle.offboarding.complete.confirmLabel', { userName }) || \r\n            `Besttigen Sie durch Eingabe des Namens: \"${userName}\"`} *\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"confirmText\"\r\n          value={confirmText}\r\n          onChange={(e) => {\r\n            setConfirmText(e.target.value);\r\n            setError(null);\r\n          }}\r\n          className={`w-full px-3 py-2 border ${\r\n            error && error.includes('Besttigung') ? 'border-red-500' : 'border-gray-300'\r\n          } dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500`}\r\n          placeholder={userName}\r\n          required\r\n        />\r\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n          {t('lifecycle.offboarding.complete.confirmHint', { \r\n            defaultValue: 'Geben Sie den vollstndigen Namen des Mitarbeiters ein, um das Offboarding abzuschlieen'\r\n          })}\r\n        </p>\r\n      </div>\r\n      \r\n      {/* Final Warning */}\r\n      <div className=\"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\r\n        <div className=\"flex\">\r\n          <div className=\"flex-shrink-0\">\r\n            <ExclamationTriangleIcon className=\"h-5 w-5 text-red-400\" aria-hidden=\"true\" />\r\n          </div>\r\n          <div className=\"ml-3\">\r\n            <h3 className=\"text-sm font-medium text-red-800 dark:text-red-300\">\r\n              {t('lifecycle.offboarding.complete.finalWarningTitle', { defaultValue: 'Wichtiger Hinweis' })}\r\n            </h3>\r\n            <div className=\"mt-2 text-sm text-red-700 dark:text-red-200\">\r\n              <p>\r\n                {t('lifecycle.offboarding.complete.finalWarningText', { \r\n                  defaultValue: 'Durch das Abschlieen des Offboarding wird der Mitarbeiter archiviert. Dieser Vorgang kann nicht rckgngig gemacht werden.'\r\n                })}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Submit Button */}\r\n      <div className=\"flex justify-end space-x-3\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={onClose}\r\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          disabled={loading}\r\n          title={t('common.cancel', { defaultValue: 'Abbrechen' })}\r\n        >\r\n          <XMarkIcon className=\"h-5 w-5\" />\r\n        </button>\r\n        <button\r\n          type=\"submit\"\r\n          className=\"p-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          disabled={loading || confirmText.trim().toLowerCase() !== requiredConfirmText}\r\n          title={loading ? t('common.saving', { defaultValue: 'Speichern...' }) : t('lifecycle.offboarding.complete.button', { defaultValue: 'Offboarding abschlieen' })}\r\n        >\r\n          {loading ? (\r\n            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n          ) : (\r\n            <CheckCircleIcon className=\"h-5 w-5\" />\r\n          )}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n  \r\n  if (!isOpen) return null;\r\n  \r\n  // Fr Mobile (unter 640px) - klassisches Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n            {/* Header */}\r\n            <div className=\"px-6 py-4 border-b dark:border-gray-700\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                  {t('lifecycle.offboarding.complete.title', { defaultValue: 'Offboarding abschlieen' })}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Form */}\r\n            <div className=\"p-6\">\r\n              {error && (\r\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\r\n                  {error}\r\n                </div>\r\n              )}\r\n              {renderForm()}\r\n            </div>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n  \r\n  // Fr Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div\r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\"\r\n          aria-hidden=\"true\"\r\n          onClick={onClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div\r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${\r\n          isOpen ? 'translate-x-0' : 'translate-x-full'\r\n        }`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('lifecycle.offboarding.complete.title', { defaultValue: 'Offboarding abschlieen' })}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n        \r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {error && (\r\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\r\n              {error}\r\n            </div>\r\n          )}\r\n          {renderForm()}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default OffboardingCompleteModal;\r\n\r\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { \n  CheckCircleIcon, \n  ClockIcon, \n  XCircleIcon,\n  DocumentTextIcon,\n  BuildingOfficeIcon,\n  PlusIcon,\n  PencilIcon,\n  ArrowDownTrayIcon,\n  CalendarIcon,\n  UserIcon,\n  ArrowRightIcon\n} from '@heroicons/react/24/outline';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport useMessage from '../hooks/useMessage.ts';\nimport CertificateCreationModal from './CertificateCreationModal.tsx';\nimport ContractCreationModal from './ContractCreationModal.tsx';\nimport CertificateEditModal from './CertificateEditModal.tsx';\nimport ContractEditModal from './ContractEditModal.tsx';\nimport SocialSecurityEditor from './SocialSecurityEditor.tsx';\nimport OffboardingStartModal from './OffboardingStartModal.tsx';\nimport OffboardingCompleteModal from './OffboardingCompleteModal.tsx';\n\ninterface LifecycleViewProps {\n  userId: number;\n  userName: string;\n}\n\ninterface LifecycleData {\n  lifecycle: {\n    id: number;\n    status: string;\n    onboardingStartedAt: string | null;\n    onboardingCompletedAt: string | null;\n    contractStartDate: string | null;\n    contractEndDate: string | null;\n    exitDate: string | null;\n    exitReason: string | null;\n    offboardingStartedAt: string | null;\n    offboardingCompletedAt: string | null;\n  };\n  progress: {\n    completed: number;\n    total: number;\n    percent: number;\n  };\n  socialSecurityRegistrations?: Array<{\n    id: number;\n    registrationType: string;\n    status: string;\n    registrationNumber: string | null;\n    provider: string | null;\n    registrationDate: string | null;\n  }>;\n}\n\ninterface Task {\n  id: number;\n  title: string;\n  description: string | null;\n  status: string;\n  dueDate: string | null;\n  createdAt: string;\n}\n\ninterface Certificate {\n  id: number;\n  certificateType: string;\n  issueDate: string;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n  generatedBy: number | null;\n  generatedByUser: {\n    id: number;\n    firstName: string;\n    lastName: string;\n  } | null;\n  createdAt: string;\n}\n\ninterface Contract {\n  id: number;\n  contractType: string;\n  startDate: string;\n  endDate: string | null;\n  salary: number | null;\n  workingHours: number | null;\n  position: string | null;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n  generatedBy: number | null;\n  generatedByUser: {\n    id: number;\n    firstName: string;\n    lastName: string;\n  } | null;\n  createdAt: string;\n}\n\nconst LifecycleView: React.FC<LifecycleViewProps> = ({ userId, userName }) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin } = usePermissions();\n  const { showMessage } = useMessage();\n  \n  const [lifecycleData, setLifecycleData] = useState<LifecycleData | null>(null);\n  const [certificates, setCertificates] = useState<Certificate[]>([]);\n  const [contracts, setContracts] = useState<Contract[]>([]);\n  const [offboardingTasks, setOffboardingTasks] = useState<Task[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Modal States\n  const [isCertificateCreateModalOpen, setIsCertificateCreateModalOpen] = useState(false);\n  const [isContractCreateModalOpen, setIsContractCreateModalOpen] = useState(false);\n  const [editingCertificate, setEditingCertificate] = useState<Certificate | null>(null);\n  const [editingContract, setEditingContract] = useState<Contract | null>(null);\n  \n  const [downloadingCertId, setDownloadingCertId] = useState<number | null>(null);\n  const [downloadingContractId, setDownloadingContractId] = useState<number | null>(null);\n  const [isOffboardingStartModalOpen, setIsOffboardingStartModalOpen] = useState(false);\n  const [isOffboardingCompleteModalOpen, setIsOffboardingCompleteModalOpen] = useState(false);\n  const [isEditContractDatesModalOpen, setIsEditContractDatesModalOpen] = useState(false);\n  const [editingContractStartDate, setEditingContractStartDate] = useState<string>('');\n  const [editingContractEndDate, setEditingContractEndDate] = useState<string>('');\n\n  const fetchDataRef = useRef(false);\n  //  MEMORY FIX: Ref fr Mounted-Status und Timer-Cleanup\n  const isMountedRef = useRef(true);\n  const retryTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const statusChangeTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  const fetchData = useCallback(async (force: boolean = false) => {\n    // Verhindere mehrfaches gleichzeitiges Laden (auer wenn force=true)\n    if (fetchDataRef.current && !force) {\n      // Wenn bereits geladen wird, warte kurz und versuche es erneut\n      retryTimeoutRef.current = setTimeout(() => {\n        if (!fetchDataRef.current && isMountedRef.current) {\n          fetchData(true);\n        }\n      }, 500);\n      return;\n    }\n    \n    try {\n      fetchDataRef.current = true;\n      setLoading(true);\n      const [lifecycleResponse, certsResponse, contractsResponse, tasksResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.CERTIFICATES(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.CONTRACTS(userId)),\n        axiosInstance.get(API_ENDPOINTS.TASKS.BY_USER(userId)).catch(() => ({ data: [] })) // Optional, falls fehlschlgt\n      ]);\n      \n      //  MEMORY FIX: Nur State setzen wenn noch gemounted\n      if (!isMountedRef.current) return;\n      \n      setLifecycleData(lifecycleResponse.data);\n      setCertificates(certsResponse.data?.certificates || []);\n      setContracts(contractsResponse.data?.contracts || []);\n      \n      // Filtere Offboarding-Tasks (die 3 spezifischen Tasks)\n      const allTasks = tasksResponse.data || [];\n      const offboardingTaskTitles = [\n        'Crear certificado laboral',\n        'Realizar liquidacin final',\n        'Desafiliar de seguridad social'\n      ];\n      const filteredTasks = allTasks.filter((task: Task) => \n        offboardingTaskTitles.includes(task.title)\n      );\n      setOffboardingTasks(filteredTasks);\n      \n      // Prfe ob automatische Status-nderung ntig ist (wird im Backend gemacht, aber hier prfen wir fr UI-Feedback)\n      if (lifecycleResponse.data?.lifecycle?.status === 'onboarding' && lifecycleResponse.data?.progress?.percent === 100) {\n        // Status wird automatisch im Backend gendert, lade Daten nach kurzer Verzgerung neu\n        statusChangeTimeoutRef.current = setTimeout(() => {\n          if (isMountedRef.current) {\n            fetchData();\n          }\n        }, 1000);\n      }\n      \n      setError(null);\n    } catch (err: any) {\n      if (!isMountedRef.current) return;\n      console.error('Fehler beim Laden der Lebenszyklus-Daten:', err);\n      setError(err.response?.data?.message || 'Fehler beim Laden der Daten');\n      showMessage('Fehler beim Laden der Daten', 'error');\n    } finally {\n      setLoading(false);\n      fetchDataRef.current = false;\n    }\n  }, [userId]); // showMessage entfernt, da es sich ndern kann\n\n  useEffect(() => {\n    isMountedRef.current = true;\n    fetchDataRef.current = false; // Reset beim userId-Wechsel\n    fetchData();\n    \n    //  MEMORY FIX: Cleanup Timer bei Unmount\n    return () => {\n      isMountedRef.current = false;\n      if (retryTimeoutRef.current) clearTimeout(retryTimeoutRef.current);\n      if (statusChangeTimeoutRef.current) clearTimeout(statusChangeTimeoutRef.current);\n    };\n  }, [fetchData]);\n\n  const handleDownloadCertificate = async (certId: number) => {\n    setDownloadingCertId(certId);\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certId),\n        { responseType: 'blob' }\n      );\n      \n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = `arbeitszeugnis-${certId}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadUrl);\n      \n      showMessage('Arbeitszeugnis erfolgreich heruntergeladen', 'success');\n    } catch (err: any) {\n      console.error('Fehler beim Herunterladen:', err);\n      showMessage('Fehler beim Herunterladen des Arbeitszeugnisses', 'error');\n    } finally {\n      setDownloadingCertId(null);\n    }\n  };\n\n  const handleEditContractDates = () => {\n    if (!lifecycleData?.lifecycle) return;\n    \n    setEditingContractStartDate(\n      lifecycleData.lifecycle.contractStartDate \n        ? new Date(lifecycleData.lifecycle.contractStartDate).toISOString().split('T')[0]\n        : ''\n    );\n    setEditingContractEndDate(\n      lifecycleData.lifecycle.contractEndDate \n        ? new Date(lifecycleData.lifecycle.contractEndDate).toISOString().split('T')[0]\n        : ''\n    );\n    setIsEditContractDatesModalOpen(true);\n  };\n\n  const handleSaveContractDates = async () => {\n    try {\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\n        status: lifecycleData?.lifecycle.status || 'active',\n        contractStartDate: editingContractStartDate || null,\n        contractEndDate: editingContractEndDate || null\n      });\n      \n      showMessage('Vertragsdaten erfolgreich aktualisiert', 'success');\n      setIsEditContractDatesModalOpen(false);\n      fetchData();\n    } catch (err: any) {\n      console.error('Fehler beim Speichern der Vertragsdaten:', err);\n      showMessage('Fehler beim Speichern der Vertragsdaten', 'error');\n    }\n  };\n\n\n  const handleDownloadContract = async (contractId: number) => {\n    setDownloadingContractId(contractId);\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contractId),\n        { responseType: 'blob' }\n      );\n      \n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = `arbeitsvertrag-${contractId}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadUrl);\n      \n      showMessage('Arbeitsvertrag erfolgreich heruntergeladen', 'success');\n    } catch (err: any) {\n      console.error('Fehler beim Herunterladen:', err);\n      showMessage('Fehler beim Herunterladen des Arbeitsvertrags', 'error');\n    } finally {\n      setDownloadingContractId(null);\n    }\n  };\n\n  const getStatusBadge = (status: string, clickable: boolean = false) => {\n    const statusConfig: Record<string, { color: string; labelKey: string }> = {\n      onboarding: { color: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300', labelKey: 'lifecycle.status.onboarding' },\n      active: { color: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300', labelKey: 'lifecycle.status.active' },\n      contract_change: { color: 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300', labelKey: 'lifecycle.status.contract_change' },\n      offboarding: { color: 'bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300', labelKey: 'lifecycle.status.offboarding' },\n      archived: { color: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300', labelKey: 'lifecycle.status.archived' }\n    };\n\n    const config = statusConfig[status] || { color: 'bg-gray-100 text-gray-800', labelKey: status };\n    \n    return (\n      <span className={`px-3 py-1 rounded-full text-sm font-medium ${config.color} ${clickable ? 'cursor-pointer hover:opacity-80' : ''}`}>\n        {t(config.labelKey) || status}\n      </span>\n    );\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('de-DE', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n          <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!lifecycleData) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <p className=\"text-gray-500 dark:text-gray-400\">{t('lifecycle.noData', { defaultValue: 'Keine Lebenszyklus-Daten verfgbar' })}</p>\n      </div>\n    );\n  }\n\n  // Extrahiere socialSecurityRegistrations aus lifecycle (falls direkt vorhanden) oder aus lifecycleData\n  const socialSecurityRegistrations = lifecycleData.lifecycle?.socialSecurityRegistrations || lifecycleData.socialSecurityRegistrations || [];\n  const { lifecycle, progress } = lifecycleData;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Status-Box */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <BuildingOfficeIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.statusTitle')}\n          </h3>\n          <div className=\"flex items-center space-x-3\">\n          {/* Status-Badge (nur Anzeige, keine nderung mglich) */}\n          {getStatusBadge(lifecycle.status)}\n            {/* Offboarding-Start-Button (nur fr HR/Admin, nur wenn Status = \"active\") */}\n            {(isHR() || isAdmin()) && lifecycle.status === 'active' && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsOffboardingStartModalOpen(true)}\n                  className=\"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500\"\n                >\n                  <ArrowRightIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('lifecycle.offboarding.startButton', { defaultValue: 'Offboarding starten' })}\n                </div>\n              </div>\n            )}\n            {/* Offboarding-Abschluss-Button (nur fr HR/Admin, nur wenn Status = \"offboarding\") */}\n            {(isHR() || isAdmin()) && lifecycle.status === 'offboarding' && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsOffboardingCompleteModalOpen(true)}\n                  className=\"p-2 bg-red-600 dark:bg-red-700 text-white rounded-md hover:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n                >\n                  <CheckCircleIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('lifecycle.offboarding.complete.button', { defaultValue: 'Offboarding abschlieen' })}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        <div className=\"space-y-2 text-sm\">\n          {lifecycle.onboardingStartedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.onboardingStarted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.onboardingStartedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.onboardingCompletedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.onboardingCompleted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.onboardingCompletedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.contractStart')}</span>\n            <div className=\"flex items-center space-x-2\">\n              {lifecycle.contractStartDate ? (\n                <span className=\"dark:text-white\">\n                  {new Date(lifecycle.contractStartDate).toLocaleDateString('de-DE')}\n                </span>\n              ) : (\n                <span className=\"text-gray-400 italic text-sm\">{t('lifecycle.notSet', { defaultValue: 'Nicht gesetzt' })}</span>\n              )}\n              {(isHR() || isAdmin()) && (\n                <div className=\"relative group\">\n                  <button\n                    onClick={() => handleEditContractDates()}\n                    className=\"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition\"\n                  >\n                    <PencilIcon className=\"h-4 w-4\" />\n                  </button>\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                    {t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.contractEnd')}</span>\n            <div className=\"flex items-center space-x-2\">\n              {lifecycle.contractEndDate ? (\n                <span className=\"dark:text-white\">\n                  {new Date(lifecycle.contractEndDate).toLocaleDateString('de-DE')}\n                </span>\n              ) : (\n                <span className=\"text-gray-400 italic text-sm\">{t('lifecycle.notSet', { defaultValue: 'Nicht gesetzt' })}</span>\n              )}\n              {(isHR() || isAdmin()) && (\n                <div className=\"relative group\">\n                  <button\n                    onClick={() => handleEditContractDates()}\n                    className=\"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition\"\n                  >\n                    <PencilIcon className=\"h-4 w-4\" />\n                  </button>\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                    {t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n          {lifecycle.offboardingStartedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.offboardingStarted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.offboardingStartedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.exitDate && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.exitDate')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.exitDate).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.exitReason && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.exitReason')}</span>\n              <span className=\"dark:text-white\">{lifecycle.exitReason}</span>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Progress-Bar - Onboarding */}\n      {lifecycle.status === 'onboarding' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold dark:text-white mb-4\">{t('lifecycle.progressTitle')}</h3>\n          <div className=\"space-y-2\">\n            <div className=\"flex justify-between text-sm mb-2\">\n              <span className=\"text-gray-600 dark:text-gray-400\">\n                {t('lifecycle.progressSteps', { completed: progress.completed, total: progress.total })}\n              </span>\n              <span className=\"font-medium dark:text-white\">{progress.percent}%</span>\n            </div>\n            <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3\">\n              <div\n                className=\"bg-blue-600 h-3 rounded-full transition-all duration-300\"\n                style={{ width: `${progress.percent}%` }}\n              ></div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Progress-Bar - Offboarding */}\n      {lifecycle.status === 'offboarding' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold dark:text-white mb-4\">{t('lifecycle.offboarding.progressTitle', { defaultValue: 'Offboarding-Fortschritt' })}</h3>\n          <div className=\"space-y-4\">\n            {/* Progress-Bar */}\n            {(() => {\n              const completedTasks = offboardingTasks.filter(task => task.status === 'done').length;\n              const totalTasks = offboardingTasks.length || 3; // Fallback: 3 Tasks\n              const percent = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;\n              \n              return (\n                <>\n                  <div className=\"flex justify-between text-sm mb-2\">\n                    <span className=\"text-gray-600 dark:text-gray-400\">\n                      {t('lifecycle.offboarding.progressSteps', { completed: completedTasks, total: totalTasks }) || `${completedTasks} von ${totalTasks} Schritten abgeschlossen`}\n                    </span>\n                    <span className=\"font-medium dark:text-white\">{percent}%</span>\n                  </div>\n                  <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3\">\n                    <div\n                      className=\"bg-orange-600 h-3 rounded-full transition-all duration-300\"\n                      style={{ width: `${percent}%` }}\n                    ></div>\n                  </div>\n                </>\n              );\n            })()}\n            \n            {/* Offboarding-Tasks Liste */}\n            {offboardingTasks.length > 0 && (\n              <div className=\"mt-4 space-y-2\">\n                <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  {t('lifecycle.offboarding.tasksTitle', { defaultValue: 'Offboarding-Aufgaben' })}\n                </h4>\n                {offboardingTasks.map((task) => {\n                  const isCompleted = task.status === 'done';\n                  return (\n                    <div\n                      key={task.id}\n                      className={`flex items-center justify-between p-3 rounded-lg border ${\n                        isCompleted\n                          ? 'bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800'\n                          : 'bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600'\n                      }`}\n                    >\n                      <div className=\"flex items-center space-x-3 flex-1\">\n                        {isCompleted ? (\n                          <CheckCircleIcon className=\"h-5 w-5 text-green-600 dark:text-green-400 flex-shrink-0\" />\n                        ) : (\n                          <ClockIcon className=\"h-5 w-5 text-orange-600 dark:text-orange-400 flex-shrink-0\" />\n                        )}\n                        <div className=\"flex-1 min-w-0\">\n                          <p className={`text-sm font-medium ${isCompleted ? 'text-green-800 dark:text-green-200' : 'text-gray-800 dark:text-gray-200'}`}>\n                            {task.title}\n                          </p>\n                          {task.description && (\n                            <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-1 truncate\">\n                              {task.description}\n                            </p>\n                          )}\n                        </div>\n                      </div>\n                      <span className={`text-xs px-2 py-1 rounded ${\n                        isCompleted\n                          ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200'\n                          : 'bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200'\n                      }`}>\n                        {isCompleted\n                          ? t('common.done', { defaultValue: 'Abgeschlossen' })\n                          : t('common.open', { defaultValue: 'Offen' })}\n                      </span>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Dokumente - Arbeitszeugnisse */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.certificates')}\n          </h3>\n          {(isHR() || isAdmin()) && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => setIsCertificateCreateModalOpen(true)}\n                className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                style={{ width: '30.19px', height: '30.19px' }}\n                aria-label={t('lifecycle.createCertificate')}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('lifecycle.createCertificate')}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {certificates.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noCertificates')}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {certificates.map((cert) => (\n              <div\n                key={cert.id}\n                className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition\"\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <h4 className=\"font-medium dark:text-white\">\n                        {t('lifecycle.certificate')}\n                        {cert.certificateType !== 'employment' && ` (${cert.certificateType})`}\n                      </h4>\n                      {cert.isLatest && (\n                        <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center\">\n                          <CheckCircleIcon className=\"h-3 w-3 mr-1\" />\n                          {t('lifecycle.current')}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                      <div className=\"flex items-center space-x-2\">\n                        <CalendarIcon className=\"h-4 w-4\" />\n                        <span>{t('lifecycle.issuedOn')} {formatDate(cert.issueDate)}</span>\n                      </div>\n                      {cert.generatedByUser && (\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4\" />\n                          <span>\n                            {t('lifecycle.createdBy')} {cert.generatedByUser.firstName} {cert.generatedByUser.lastName}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2 ml-4\">\n                    {(isHR() || isAdmin()) && (\n                      <div className=\"relative group\">\n                        <button\n                          onClick={() => setEditingCertificate(cert)}\n                          className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition\"\n                        >\n                          <PencilIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('lifecycle.edit')}\n                        </div>\n                      </div>\n                    )}\n                    <div className=\"relative group\">\n                      <button\n                        onClick={() => handleDownloadCertificate(cert.id)}\n                        disabled={downloadingCertId === cert.id}\n                        className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {downloadingCertId === cert.id ? (\n                          <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                        ) : (\n                          <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                        )}\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('lifecycle.download')}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Dokumente - Arbeitsvertrge */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center mb-4\">\n          {(isHR() || isAdmin()) && (\n            <div className=\"relative group mr-3\">\n              <button\n                onClick={() => setIsContractCreateModalOpen(true)}\n                className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                style={{ width: '30.19px', height: '30.19px' }}\n                aria-label={t('lifecycle.createContract')}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('lifecycle.createContract')}\n              </div>\n            </div>\n          )}\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.contracts')}\n          </h3>\n        </div>\n\n        {contracts.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noContracts')}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {contracts.map((contract) => (\n              <div\n                key={contract.id}\n                className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition\"\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <h4 className=\"font-medium dark:text-white\">\n                        {t('lifecycle.contract')}\n                        {contract.contractType !== 'employment' && ` (${contract.contractType})`}\n                      </h4>\n                      {contract.isLatest && (\n                        <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center\">\n                          <CheckCircleIcon className=\"h-3 w-3 mr-1\" />\n                          {t('lifecycle.current')}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                      <div className=\"flex items-center space-x-2\">\n                        <CalendarIcon className=\"h-4 w-4\" />\n                        <span>\n                          {formatDate(contract.startDate)}\n                          {contract.endDate && ` - ${formatDate(contract.endDate)}`}\n                        </span>\n                      </div>\n                      {contract.position && (\n                        <div>{t('lifecycle.position')} {contract.position}</div>\n                      )}\n                      {contract.salary && (\n                        <div>{t('lifecycle.salary')} {contract.salary.toLocaleString('de-DE', { style: 'currency', currency: 'EUR' })}</div>\n                      )}\n                      {contract.workingHours && (\n                        <div>{t('lifecycle.workingHours')} {contract.workingHours}h/Woche</div>\n                      )}\n                      {contract.generatedByUser && (\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4\" />\n                          <span>\n                            {t('lifecycle.createdBy')} {contract.generatedByUser.firstName} {contract.generatedByUser.lastName}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2 ml-4\">\n                    {(isHR() || isAdmin()) && (\n                      <div className=\"relative group\">\n                        <button\n                          onClick={() => setEditingContract(contract)}\n                          className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition\"\n                        >\n                          <PencilIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('lifecycle.edit')}\n                        </div>\n                      </div>\n                    )}\n                    <div className=\"relative group\">\n                      <button\n                        onClick={() => handleDownloadContract(contract.id)}\n                        disabled={downloadingContractId === contract.id}\n                        className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {downloadingContractId === contract.id ? (\n                          <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                        ) : (\n                          <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                        )}\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('lifecycle.download')}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Social Security Editor - Nur fr Legal/Admin */}\n      {lifecycleData?.lifecycle && (\n        <SocialSecurityEditor\n          userId={userId}\n          lifecycleId={lifecycleData.lifecycle.id}\n          onUpdate={() => fetchData(true)}\n        />\n      )}\n\n      {/* Modals */}\n      <CertificateCreationModal\n        isOpen={isCertificateCreateModalOpen}\n        onClose={() => setIsCertificateCreateModalOpen(false)}\n        onCertificateCreated={() => {\n          fetchData();\n          setIsCertificateCreateModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n\n      <ContractCreationModal\n        isOpen={isContractCreateModalOpen}\n        onClose={() => setIsContractCreateModalOpen(false)}\n        onContractCreated={() => {\n          fetchData();\n          setIsContractCreateModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n\n      {editingCertificate && (\n        <CertificateEditModal\n          isOpen={!!editingCertificate}\n          onClose={() => setEditingCertificate(null)}\n          onCertificateUpdated={() => {\n            fetchData();\n            setEditingCertificate(null);\n          }}\n          userId={userId}\n          certificate={editingCertificate}\n        />\n      )}\n\n      {editingContract && (\n        <ContractEditModal\n          isOpen={!!editingContract}\n          onClose={() => setEditingContract(null)}\n          onContractUpdated={() => {\n            fetchData();\n            setEditingContract(null);\n          }}\n          userId={userId}\n          contract={editingContract}\n        />\n      )}\n\n      {/* Offboarding-Start-Modal */}\n      <OffboardingStartModal\n        isOpen={isOffboardingStartModalOpen}\n        onClose={() => setIsOffboardingStartModalOpen(false)}\n        onOffboardingStarted={() => {\n          fetchData();\n          setIsOffboardingStartModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n      \n      {/* Offboarding-Abschluss-Modal */}\n      <OffboardingCompleteModal\n        isOpen={isOffboardingCompleteModalOpen}\n        onClose={() => setIsOffboardingCompleteModalOpen(false)}\n        onOffboardingCompleted={() => {\n          fetchData();\n          setIsOffboardingCompleteModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n        offboardingTasks={offboardingTasks}\n      />\n\n      {/* Modal zum Bearbeiten der Vertragsdaten */}\n      {isEditContractDatesModalOpen && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md mx-4\">\n            <h2 className=\"text-xl font-semibold dark:text-white mb-4\">\n              {t('lifecycle.editContractDates', { defaultValue: 'Vertragsdaten bearbeiten' })}\n            </h2>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('lifecycle.contractStart', { defaultValue: 'Vertragsbeginn' })} *\n                </label>\n                <input\n                  type=\"date\"\n                  value={editingContractStartDate}\n                  onChange={(e) => setEditingContractStartDate(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  required\n                />\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('lifecycle.contractEnd', { defaultValue: 'Vertragsende' })} (optional)\n                </label>\n                <input\n                  type=\"date\"\n                  value={editingContractEndDate}\n                  onChange={(e) => setEditingContractEndDate(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('lifecycle.contractEndHint', { defaultValue: 'Nur bei befristeten Vertrgen ausfllen' })}\n                </p>\n              </div>\n            </div>\n            \n            <div className=\"flex justify-end space-x-3 mt-6\">\n              <button\n                onClick={() => setIsEditContractDatesModalOpen(false)}\n                className=\"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition\"\n              >\n                {t('common.cancel', { defaultValue: 'Abbrechen' })}\n              </button>\n              <button\n                onClick={handleSaveContractDates}\n                disabled={!editingContractStartDate}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {t('common.save', { defaultValue: 'Speichern' })}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LifecycleView;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { userApi, roleApi, branchApi } from '../api/apiClient.ts';\nimport { User, Role } from '../types/interfaces.ts';\nimport { CheckIcon, PlusIcon, PencilIcon, DocumentTextIcon, UserCircleIcon, ShieldCheckIcon, XMarkIcon, ArrowPathIcon, BuildingOfficeIcon, MapPinIcon } from '@heroicons/react/24/outline';\nimport useMessage from '../hooks/useMessage.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport IdentificationDocumentList from './IdentificationDocumentList.tsx';\nimport LifecycleView from './LifecycleView.tsx';\nimport { handleDirectDocumentUpload } from '../utils/documentUploadHandler.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { logger } from '../utils/logger.ts';\n\ninterface UserManagementTabProps {\n}\n\n// Lnder und Sprachen werden dynamisch aus bersetzungen geladen\n\n// Definiere Rollen, die immer vorhanden sein sollten (z.B. Admin-Rolle)\nconst fixedRoles = [1, 2, 999]; // Admin (1), User (2) und Hamburger (999) sind fixe Rollen\n\n// Vertragstypen fr Kolumbien (CO)\nconst CONTRACT_TYPES = [\n  { code: 'tiempo_completo', name: 'Tiempo Completo (>21 Tage/Monat)' },\n  { code: 'tiempo_parcial_7', name: 'Tiempo Parcial (7 Tage/Monat)' },\n  { code: 'tiempo_parcial_14', name: 'Tiempo Parcial (14 Tage/Monat)' },\n  { code: 'tiempo_parcial_21', name: 'Tiempo Parcial (21 Tage/Monat)' },\n  { code: 'prestacion_de_servicios', name: 'Prestacin de Servicios' },\n  { code: 'externo', name: 'Externo' }\n];\n\n// Gemeinsame Debug-Komponente hinzufgen\nconst RoleDebugInfo = ({ title, data }: { title: string, data: any }) => (\n  <div className=\"mb-2 p-2 border border-gray-300 rounded bg-gray-50\">\n    <h5 className=\"font-bold text-sm\">{title}</h5>\n    <pre className=\"text-xs overflow-auto max-h-24\">\n      {JSON.stringify(data, null, 2)}\n    </pre>\n  </div>\n);\n\nconst UserManagementTab = (): JSX.Element => {\n  const { t } = useTranslation();\n  const { handleError: handleErrorContext } = useError();\n  \n  // Lnder fr die Auswahl (dynamisch aus bersetzungen)\n  const COUNTRIES = [\n    { code: 'CO', name: t('countries.CO') },\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'DE', name: t('countries.DE') },\n    { code: 'AT', name: t('countries.AT') }\n  ];\n\n  // Lnder fr die Payroll-Auswahl (dynamisch aus bersetzungen)\n  const PAYROLL_COUNTRIES = [\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'CO', name: t('countries.CO') }\n  ];\n\n  // Sprachen fr die Auswahl (dynamisch aus bersetzungen)\n  const LANGUAGES = [\n    { code: 'es', name: t('languages.es') },\n    { code: 'de', name: t('languages.de') },\n    { code: 'en', name: t('languages.en') }\n  ];\n  \n  // Benutzer-States\n  const [users, setUsers] = useState<User[]>([]);\n  const [selectedUser, setSelectedUser] = useState<User | null>(null);\n  const [userFormData, setUserFormData] = useState<Partial<User>>({});\n  const [isEditingUser, setIsEditingUser] = useState(false);\n  const [selectedRoles, setSelectedRoles] = useState<number[]>([]);\n  const [lifecycleRefreshKey, setLifecycleRefreshKey] = useState(0);\n  const [isDebugMode, setIsDebugMode] = useState(false);\n  const [roleWarning, setRoleWarning] = useState<string | null>(null);\n  const { showMessage } = useMessage();\n  const { isAdmin } = usePermissions();\n  \n  // Neuer State fr Rollen\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState(false);\n  \n  // State fr Branches\n  const [branches, setBranches] = useState<Array<{ id: number; name: string }>>([]);\n  const [loadingBranches, setLoadingBranches] = useState(false);\n  const [selectedBranches, setSelectedBranches] = useState<number[]>([]);\n  \n  // Neuer State fr die aktive Unterseite\n  const [activeUserTab, setActiveUserTab] = useState<'details' | 'documents' | 'roles' | 'branches' | 'lifecycle'>('details');\n  \n  // State fr Active/Inactive Filter\n  const [userFilterTab, setUserFilterTab] = useState<'active' | 'inactive'>('active');\n  \n  // State fr Dokument-Upload\n  const [isUploading, setIsUploading] = useState(false);\n  const documentListRef = useRef<{ loadDocuments: () => void }>(null);\n  \n  // State fr Benutzererstellung\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n  const [isMobile, setIsMobile] = useState<boolean>(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [newUserFormData, setNewUserFormData] = useState({\n    email: '',\n    password: '',\n    firstName: '',\n    lastName: ''\n  });\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isCreateModalOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isCreateModalOpen, openSidepane, closeSidepane]);\n\n  // Alle Benutzer (fr Filterung)\n  const [allUsers, setAllUsers] = useState<User[]>([]);\n\n  // Initialisierung - Laden von Benutzern\n  useEffect(() => {\n    fetchAllUsers();\n  }, []);\n\n  // Benutzerdaten laden - Verwende gefilterten Endpoint, damit nur Benutzer der eigenen Organisation angezeigt werden\n  const fetchAllUsers = async () => {\n    try {\n      const response = await userApi.getAll();\n      setAllUsers(response.data);\n      // Initial: Nur aktive Benutzer anzeigen\n      filterUsersByActiveStatus('active', response.data);\n    } catch (err) {\n      handleError(err);\n    }\n  };\n\n  // Benutzer nach Active/Inactive filtern und alphabetisch sortieren\n  const filterUsersByActiveStatus = (status: 'active' | 'inactive', usersToFilter: User[] = allUsers) => {\n    const filtered = usersToFilter.filter(user => {\n      const isActive = user.active !== undefined ? user.active : true; // Default: true\n      return status === 'active' ? isActive : !isActive;\n    });\n    \n    // Alphabetisch sortieren nach username, dann firstName\n    const sorted = filtered.sort((a, b) => {\n      const aUsername = (a.username || '').toLowerCase();\n      const bUsername = (b.username || '').toLowerCase();\n      const aFirstName = (a.firstName || '').toLowerCase();\n      const bFirstName = (b.firstName || '').toLowerCase();\n      \n      // Zuerst nach username sortieren\n      if (aUsername !== bUsername) {\n        return aUsername.localeCompare(bUsername);\n      }\n      // Wenn username gleich, nach Vorname sortieren\n      return aFirstName.localeCompare(bFirstName);\n    });\n    \n    setUsers(sorted);\n  };\n\n  // Wenn Filter-Tab wechselt, Benutzerliste neu filtern\n  useEffect(() => {\n    if (allUsers.length > 0) {\n      filterUsersByActiveStatus(userFilterTab, allUsers);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userFilterTab]);\n  \n  // Rollen laden - Wird erst aufgerufen, wenn ein Benutzer ausgewhlt wurde\n  const fetchRoles = async () => {\n    try {\n      setLoadingRoles(true);\n      \n      // Fallback-Rollen fr den Notfall bereithalten\n      const fallbackRoles = [\n        { id: 1, name: 'admin', description: 'Administrator mit allen Rechten', permissions: [] },\n        { id: 2, name: 'user', description: 'Standardbenutzer', permissions: [] },\n        { id: 999, name: 'hamburger', description: 'Hamburger-Rolle fr neue Benutzer', permissions: [] }\n      ];\n      \n      try {\n        const response = await roleApi.getAll();\n        if (response.data && Array.isArray(response.data) && response.data.length > 0) {\n          setRoles(response.data);\n          logger.log(`${response.data.length} Rollen erfolgreich geladen`);\n        } else {\n          console.warn('Keine Rollen vom Server erhalten, verwende Fallback');\n          setRoles(fallbackRoles);\n        }\n      } catch (error) {\n        console.warn('Fehler beim Laden der Rollen, verwende Fallback:', error);\n        setRoles(fallbackRoles);\n      }\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  // Branches laden - Wird erst aufgerufen, wenn ein Benutzer ausgewhlt wurde\n  const fetchBranches = async () => {\n    try {\n      setLoadingBranches(true);\n      \n      try {\n        const response = await branchApi.getAll();\n        if (response.data && Array.isArray(response.data) && response.data.length > 0) {\n          setBranches(response.data);\n          logger.log(`${response.data.length} Branches erfolgreich geladen`);\n        } else {\n          console.warn('Keine Branches vom Server erhalten');\n          setBranches([]);\n        }\n      } catch (error) {\n        console.warn('Fehler beim Laden der Branches:', error);\n        setBranches([]);\n      }\n    } finally {\n      setLoadingBranches(false);\n    }\n  };\n\n  const handleDirectDocumentUploadWrapper = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (!e.target.files || e.target.files.length === 0) return;\n    if (!selectedUser) return;\n    \n    setIsUploading(true);\n    \n    const result = await handleDirectDocumentUpload(\n      e.target.files[0],\n      selectedUser.id,\n      async () => {\n        await fetchUserDetails(selectedUser.id);\n        // Warte kurz, damit Backend verarbeitet\n        await new Promise(resolve => setTimeout(resolve, 500));\n        // Lade Dokumente neu, wenn die Komponente gemountet ist\n        documentListRef.current?.loadDocuments();\n        showMessage(t('profile.documentUploadSuccess', { defaultValue: 'Dokument erfolgreich hochgeladen. Felder werden automatisch ausgefllt.' }), 'success');\n      },\n      (error) => {\n        showMessage(error, 'error');\n      }\n    );\n    \n    setIsUploading(false);\n    e.target.value = '';\n  };\n\n  // Detaillierte Benutzerdaten laden\n  const fetchUserDetails = async (userId: number) => {\n    try {\n      if (!userId || isNaN(userId)) {\n        setSelectedUser(null);\n        return;\n      }\n      \n      logger.log('Lade Benutzerdetails fr ID:', userId);\n      const response = await userApi.getById(userId);\n      \n      const userData = {\n        ...response.data,\n        active: response.data.active !== undefined ? response.data.active : true,\n        birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n      };\n      \n      // Extrahiere Rollen-IDs aus der verschachtelten Struktur\n      let roleIds: number[] = [];\n      \n      if (response.data.roles && Array.isArray(response.data.roles)) {\n        logger.log('Rollenstruktur (Typ):', typeof response.data.roles, 'Lnge:', response.data.roles.length);\n        \n        // Struktur: roles: [{ role: { id, name, ... } }]\n        if (response.data.roles.length > 0 && response.data.roles[0].role) {\n          roleIds = response.data.roles.map(userRole => userRole.role.id);\n          logger.log('Extrahierte Rollen-IDs aus verschachtelter Struktur:', roleIds);\n        }\n        // Fallback fr andere Formate\n        else if (response.data.roles.length > 0) {\n          if (typeof response.data.roles[0] === 'number') {\n            roleIds = response.data.roles;\n          } else if (response.data.roles[0].roleId) {\n            roleIds = response.data.roles.map(role => role.roleId);\n          } else if (response.data.roles[0].id) {\n            roleIds = response.data.roles.map(role => role.id);\n          }\n        }\n      } else {\n        console.warn('Rollen fehlen oder sind kein Array:', response.data.roles);\n      }\n      \n      // Wenn keine Rollen gefunden wurden, probieren wir, diese aus roles in der Response direkt zu extrahieren\n      if (roleIds.length === 0 && response.data.role) {\n        logger.log('Versuche Rollen aus role-Eigenschaft zu extrahieren:', response.data.role);\n        if (Array.isArray(response.data.role)) {\n          roleIds = response.data.role.map((r: any) => r.id);\n        } else if (typeof response.data.role === 'object' && response.data.role !== null) {\n          roleIds = [response.data.role.id];\n        }\n      }\n      \n      logger.log('Endgltige extrahierte Rollen-IDs:', roleIds);\n      \n      // Extrahiere Branch-IDs aus der verschachtelten Struktur\n      let branchIds: number[] = [];\n      \n      if (response.data.branches && Array.isArray(response.data.branches)) {\n        logger.log('Branches-Struktur (Typ):', typeof response.data.branches, 'Lnge:', response.data.branches.length);\n        \n        // Struktur: branches: [{ branch: { id, name, ... } }]\n        if (response.data.branches.length > 0 && response.data.branches[0].branch) {\n          branchIds = response.data.branches.map(userBranch => userBranch.branch.id);\n          logger.log('Extrahierte Branch-IDs aus verschachtelter Struktur:', branchIds);\n        }\n        // Fallback fr andere Formate\n        else if (response.data.branches.length > 0) {\n          if (typeof response.data.branches[0] === 'number') {\n            branchIds = response.data.branches;\n          } else if (response.data.branches[0].branchId) {\n            branchIds = response.data.branches.map(branch => branch.branchId);\n          } else if (response.data.branches[0].id) {\n            branchIds = response.data.branches.map(branch => branch.id);\n          }\n        }\n      } else {\n        console.warn('Branches fehlen oder sind kein Array:', response.data.branches);\n      }\n      \n      logger.log('Endgltige extrahierte Branch-IDs:', branchIds);\n      \n      setSelectedUser(userData);\n      setUserFormData(userData);\n      setSelectedRoles(roleIds);\n      setSelectedBranches(branchIds);\n      \n      // Rollen nur einmal laden, wenn sie noch nicht geladen wurden\n      if (roles.length === 0) {\n        await fetchRoles();\n      }\n      \n      // Branches nur einmal laden, wenn sie noch nicht geladen wurden\n      if (branches.length === 0) {\n        await fetchBranches();\n      }\n    } catch (err) {\n      console.error('Fehler beim Laden der Benutzerdetails:', err);\n      handleError(err);\n    }\n  };\n\n  // Fehlerbehandlung\n  const handleError = (err: any) => {\n    let message = 'Ein Fehler ist aufgetreten';\n    if (err.response?.data?.message) {\n      message = err.response.data.message;\n    } else if (err instanceof Error) {\n      message = err.message;\n    }\n    \n    // Fehler \"Ungltige Rollen-ID\" nicht weitergeben, wenn kein Benutzer ausgewhlt ist\n    if (message.includes('Ungltige Rollen-ID') && !selectedUser) {\n      console.warn('Fehler unterdrckt, da kein Benutzer ausgewhlt ist:', message);\n      return;\n    }\n    \n    handleErrorContext({ message });\n  };\n\n  // Handler fr Auswahl eines Benutzers\n  const handleUserSelect = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const userId = parseInt(event.target.value, 10);\n    if (userId && !isNaN(userId)) {\n      fetchUserDetails(userId);\n    } else {\n      setSelectedUser(null);\n      setUserFormData({});\n      setSelectedRoles([]);\n    }\n  };\n\n  // Erweitere den handleUserInputChange\n  const handleUserInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value, type } = e.target;\n    let finalValue: string | number | null = value;\n    \n    // Korrekte Typenkonvertierung fr numerische Felder\n    if (type === 'number') {\n      // Wenn das Feld leer ist, setzen wir null statt NaN\n      finalValue = value === '' ? null : Number(value);\n    }\n    \n    setUserFormData({ ...userFormData, [name]: finalValue });\n    setIsEditingUser(true); // Aktiviere Edit-Modus sobald etwas gendert wird\n  };\n\n  // Abbrechen der Bearbeitung\n  const handleCancelEdit = () => {\n    if (selectedUser) {\n      setUserFormData({\n        ...selectedUser,\n        birthday: selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : null\n      });\n    }\n    setIsEditingUser(false);\n  };\n\n  // Speichern der Benutzerdaten\n  const handleUserSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!selectedUser || !selectedUser.id) {\n      handleErrorContext({ message: 'Kein Benutzer ausgewhlt' });\n      showMessage('Kein Benutzer ausgewhlt', 'error');\n      return;\n    }\n\n    try {\n      // Validierung\n      if (!userFormData.username?.trim()) throw new Error('Benutzername ist erforderlich');\n      if (!userFormData.email?.trim()) throw new Error('E-Mail ist erforderlich');\n      // firstName, lastName, birthday werden nur von KI aus Dokument gesetzt, nicht manuell validiert\n\n      // Bereite die Daten korrekt vor\n      // Contract, Salary, Normal Working Hours werden zu Lifecycle verschoben\n      // firstName, lastName, birthday werden nur von KI aus Dokument gesetzt, nicht manuell editierbar\n      const dataToSend = {\n        username: userFormData.username,\n        email: userFormData.email,\n        bankDetails: userFormData.bankDetails || null,\n        gender: userFormData.gender || null,\n        phoneNumber: userFormData.phoneNumber || null,\n        language: userFormData.language || null,\n        // Payroll-Felder bleiben (sind separate Sektion)\n        hourlyRate: userFormData.hourlyRate === null || userFormData.hourlyRate === undefined || userFormData.hourlyRate === '' as any\n          ? null \n          : typeof userFormData.hourlyRate === 'string' \n            ? userFormData.hourlyRate  // Keine Konvertierung fr Decimal-Werte, da sie als Strings bergeben werden sollten\n            : userFormData.hourlyRate.toString(),  // Konvertierung zu String fr Decimal-Werte\n        monthlySalary: userFormData.monthlySalary === null || userFormData.monthlySalary === undefined || userFormData.monthlySalary === '' as any\n          ? null \n          : typeof userFormData.monthlySalary === 'string' \n            ? parseFloat(userFormData.monthlySalary) \n            : userFormData.monthlySalary,\n        payrollCountry: userFormData.payrollCountry || null,\n        contractType: userFormData.contractType || null,\n      };\n\n      logger.log('Sende Daten zum Server:', dataToSend);\n\n      // Update Benutzerdaten\n      const response = await userApi.update(selectedUser.id, dataToSend);\n\n      if (response.data) {\n        const updatedData = {\n          ...response.data,\n          birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n        };\n        setSelectedUser(updatedData);\n        setUserFormData({\n          ...updatedData,\n          birthday: updatedData.birthday ? new Date(updatedData.birthday).toISOString().split('T')[0] : null\n        });\n        \n        // Optimistisches Update: User in allUsers und users aktualisieren\n        setAllUsers(prevUsers => \n          prevUsers.map(user => \n            user.id === updatedData.id ? updatedData : user\n          )\n        );\n        \n        // Benutzerliste neu filtern basierend auf aktuellem Tab\n        filterUsersByActiveStatus(userFilterTab, allUsers.map(user => \n          user.id === updatedData.id ? updatedData : user\n        ));\n        \n        showMessage('Benutzerprofil erfolgreich aktualisiert', 'success');\n        setIsEditingUser(false);\n      }\n    } catch (err) {\n      console.error('Fehler beim Speichern der Benutzerdaten:', err);\n      // Bei Fehler: Rollback durch vollstndiges Reload\n      await fetchAllUsers();\n      if (err.response?.status === 400) {\n        const errorMsg = `Validierungsfehler: ${err.response?.data?.message || 'Bitte berprfe die eingegebenen Daten'}`;\n        handleErrorContext({ message: errorMsg });\n        showMessage(errorMsg, 'error');\n      } else if (err.response?.status === 404) {\n        handleErrorContext({ message: 'Benutzer wurde nicht gefunden' });\n        showMessage('Benutzer wurde nicht gefunden', 'error');\n      } else {\n        handleError(err);\n      }\n    }\n  };\n\n  // Benutzer aktivieren/deaktivieren\n  const handleToggleActive = async () => {\n    if (!selectedUser || !selectedUser.id) {\n      showMessage('Kein Benutzer ausgewhlt', 'error');\n      return;\n    }\n\n    // Verhindere, dass der Admin-Benutzer sich selbst deaktiviert\n    const currentUserId = parseInt(localStorage.getItem('userId') || '0', 10);\n    if (selectedUser.id === currentUserId) {\n      showMessage('Du kannst dich nicht selbst deaktivieren', 'warning');\n      return;\n    }\n\n    try {\n      // Aktueller Status: wenn undefined, dann true (Default)\n      const currentActiveStatus = selectedUser.active !== undefined ? selectedUser.active : true;\n      const newActiveStatus = !currentActiveStatus;\n      \n      logger.log('Toggle active:', { \n        currentActiveStatus, \n        newActiveStatus, \n        selectedUser,\n        selectedUserActive: selectedUser.active,\n        userId: selectedUser.id\n      });\n      \n      const updatePayload = { active: newActiveStatus };\n      logger.log('Sending update payload:', updatePayload, 'Type of active:', typeof newActiveStatus);\n      \n      // Update Benutzer\n      const response = await userApi.update(selectedUser.id, updatePayload);\n      \n      logger.log('Update response:', response.data);\n\n      if (response.data) {\n        const updatedData = {\n          ...response.data,\n          active: response.data.active !== undefined ? response.data.active : true,\n          birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n        };\n        \n        logger.log('Updated user data:', updatedData);\n        \n        setSelectedUser(updatedData);\n        setUserFormData({\n          ...updatedData,\n          birthday: updatedData.birthday ? new Date(updatedData.birthday).toISOString().split('T')[0] : null\n        });\n        \n        // Optimistisches Update: Berechne den aktualisierten Array direkt (vor State-Update)\n        // Dies verhindert Race Conditions bei schnellen, aufeinanderfolgenden Updates\n        const updatedAllUsers = allUsers.map(user => \n          user.id === updatedData.id ? updatedData : user\n        );\n        \n        // Update State mit dem berechneten Array\n        setAllUsers(updatedAllUsers);\n        \n        // Filtere mit dem aktualisierten Array (nicht mit allUsers, da State-Update asynchron ist)\n        filterUsersByActiveStatus(userFilterTab, updatedAllUsers);\n        \n        // fetchAllUsers() entfernt - optimistisches Update reicht aus\n        // Backend speichert korrekt, State ist bereits aktualisiert\n        // Nur bei Fehler wird fetchAllUsers() aufgerufen (siehe catch-Block)\n        \n        showMessage(\n          newActiveStatus \n            ? 'Benutzer erfolgreich aktiviert' \n            : 'Benutzer erfolgreich deaktiviert',\n          'success'\n        );\n      }\n    } catch (err) {\n      console.error('Fehler beim Aktivieren/Deaktivieren des Benutzers:', err);\n      handleError(err);\n      // Bei Fehler: Benutzerliste neu laden\n      await fetchAllUsers();\n    }\n  };\n\n  // Toggle Rolle fr einen Benutzer (hinzufgen/entfernen)\n  const toggleRole = async (roleId: number) => {\n    if (!roleId || !selectedUser) return;\n    \n    // Prfe, ob es sich um eine fixe Rolle handelt - Nur fr Admin-Benutzer (ID: 1) sind Admin-Rollen (ID: 1) nicht entfernbar\n    if (roleId === 1 && selectedUser.id === 1 && selectedRoles.includes(roleId)) {\n      showMessage('Die Admin-Rolle kann vom Admin-Benutzer nicht entfernt werden', 'warning');\n      return;\n    }\n    \n    try {\n      logger.log('Toggle Rolle:', roleId, 'fr Benutzer:', selectedUser.id);\n      logger.log('Aktuelle ausgewhlte Rollen:', selectedRoles);\n      \n      // berprfen, ob die Rolle bereits zugewiesen ist\n      const isRoleSelected = selectedRoles.includes(roleId);\n      \n      const newSelectedRoles = isRoleSelected\n        ? selectedRoles.filter(id => id !== roleId)\n        : [...selectedRoles, roleId];\n      \n      logger.log('Neue ausgewhlte Rollen:', newSelectedRoles);\n      \n      // Optimistisches UI-Update\n      setSelectedRoles(newSelectedRoles);\n      \n      // API-Aufruf zur Aktualisierung der Rollen\n      logger.log('Sende Rollenaktualisierung an API:', { userId: selectedUser.id, roleIds: newSelectedRoles });\n      const response = await userApi.updateRoles(selectedUser.id, newSelectedRoles);\n      logger.log('API-Antwort bei Rollenaktualisierung:', response.data);\n      \n      // Benutzer nach dem Update neu laden\n      await fetchUserDetails(selectedUser.id);\n      \n      // Erfolgsmeldung anzeigen mit showMessage statt setUserSuccess\n      showMessage(\n        isRoleSelected\n          ? `Rolle erfolgreich entfernt`\n          : `Rolle erfolgreich zugewiesen`,\n        'success'\n      );\n    } catch (error) {\n      // Bei Fehler auf vorherigen Zustand zurcksetzen\n      console.error('Fehler beim Aktualisieren der Rollen:', error);\n      fetchUserDetails(selectedUser.id);\n      handleError(error);\n      showMessage('Fehler beim Aktualisieren der Rollen', 'error');\n    }\n  };\n\n  // Toggle Branch fr einen Benutzer (hinzufgen/entfernen)\n  const toggleBranch = async (branchId: number) => {\n    if (!branchId || !selectedUser) return;\n    \n    try {\n      logger.log('Toggle Branch:', branchId, 'fr Benutzer:', selectedUser.id);\n      logger.log('Aktuelle ausgewhlte Branches:', selectedBranches);\n      \n      // berprfen, ob die Branch bereits zugewiesen ist\n      const isBranchSelected = selectedBranches.includes(branchId);\n      \n      const newSelectedBranches = isBranchSelected\n        ? selectedBranches.filter(id => id !== branchId)\n        : [...selectedBranches, branchId];\n      \n      logger.log('Neue ausgewhlte Branches:', newSelectedBranches);\n      \n      // Optimistisches UI-Update\n      setSelectedBranches(newSelectedBranches);\n      \n      // API-Aufruf zur Aktualisierung der Branches\n      logger.log('Sende Branch-Aktualisierung an API:', { userId: selectedUser.id, branchIds: newSelectedBranches });\n      const response = await userApi.updateBranches(selectedUser.id, newSelectedBranches);\n      logger.log('API-Antwort bei Branch-Aktualisierung:', response.data);\n      \n      // Benutzer nach dem Update neu laden\n      await fetchUserDetails(selectedUser.id);\n      \n      // Erfolgsmeldung anzeigen\n      showMessage(\n        isBranchSelected\n          ? `Branch erfolgreich entfernt`\n          : `Branch erfolgreich zugewiesen`,\n        'success'\n      );\n    } catch (error) {\n      // Bei Fehler auf vorherigen Zustand zurcksetzen\n      console.error('Fehler beim Aktualisieren der Branches:', error);\n      fetchUserDetails(selectedUser.id);\n      handleError(error);\n      showMessage('Fehler beim Aktualisieren der Branches', 'error');\n    }\n  };\n\n  // Initialisiere FormData wenn Benutzer ausgewhlt wird\n  useEffect(() => {\n    if (selectedUser) {\n      setUserFormData({\n        ...selectedUser,\n        birthday: selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : null\n      });\n      setIsEditingUser(false); // Starte im Read-Only Modus\n    }\n  }, [selectedUser]);\n\n  // Handler fr neue Benutzer-Formular\n  const handleNewUserInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setNewUserFormData({ ...newUserFormData, [name]: value });\n  };\n\n  // Neuen Benutzer erstellen\n  const handleCreateUser = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Validierung\n    if (!newUserFormData.email || !newUserFormData.password || !newUserFormData.firstName || !newUserFormData.lastName) {\n      showMessage('Bitte fllen Sie alle Felder aus', 'error');\n      return;\n    }\n\n    // E-Mail-Format validieren\n    if (!newUserFormData.email.match(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/)) {\n      showMessage('Ungltiges E-Mail-Format', 'error');\n      return;\n    }\n\n    try {\n      const response = await userApi.create(newUserFormData);\n      \n      // Optimistisches Update: User zu allUsers hinzufgen\n      if (response.data) {\n        const newUser = {\n          ...response.data,\n          active: response.data.active !== undefined ? response.data.active : true\n        };\n        setAllUsers(prevUsers => [newUser, ...prevUsers]);\n        \n        // Wenn aktueller Tab \"active\" ist und neuer User aktiv ist, auch zu users hinzufgen\n        if (userFilterTab === 'active' && newUser.active) {\n          setUsers(prevUsers => [newUser, ...prevUsers]);\n        }\n      }\n      \n      showMessage('Benutzer erfolgreich erstellt', 'success');\n      setIsCreateModalOpen(false);\n      setNewUserFormData({\n        email: '',\n        password: '',\n        firstName: '',\n        lastName: ''\n      });\n    } catch (err: any) {\n      // Bei Fehler: Rollback durch vollstndiges Reload\n      await fetchAllUsers();\n      const errorMessage = err.response?.data?.message || 'Fehler beim Erstellen des Benutzers';\n      showMessage(errorMessage, 'error');\n      handleErrorContext({ message: errorMessage });\n    }\n  };\n\n  return (\n    <div className=\"container mx-auto px-4 pb-6\">\n      {/* Die lokale Erfolgsmeldungs-Anzeige wird entfernt, da wir jetzt HeaderMessage verwenden */}\n      {/* {userSuccess && (\n        <div className=\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4\">\n          {userSuccess}\n        </div>\n      )} */}\n\n      {/* Titelzeile: Button links, Dropdown rechts */}\n      <div className=\"mb-6\">\n        <div className=\"flex items-start gap-4\">\n          {/* Linke Seite: \"Neuer Benutzer\"-Button */}\n          <div className=\"flex items-center pt-8\">\n            {isAdmin() && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsCreateModalOpen(true)}\n                  className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                  style={{ width: '30.19px', height: '30.19px' }}\n                  aria-label={t('users.create')}\n                >\n                  <PlusIcon className=\"h-4 w-4\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('users.create')}\n                </div>\n              </div>\n            )}\n          </div>\n          \n          {/* Rechts: Benutzer-Dropdown mit Active/Inactive Tabs */}\n          <div className=\"flex-1\">\n            {/* Active/Inactive Tabs */}\n            <div className=\"flex gap-2 mb-2\">\n              <button\n                type=\"button\"\n                onClick={() => setUserFilterTab('active')}\n                className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${\n                  userFilterTab === 'active'\n                    ? 'bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400'\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600'\n                }`}\n              >\n                {t('users.active')}\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setUserFilterTab('inactive')}\n                className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${\n                  userFilterTab === 'inactive'\n                    ? 'bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400'\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600'\n                }`}\n              >\n                {t('users.inactive')}\n              </button>\n            </div>\n            \n            <select\n              id=\"userSelect\"\n              onChange={handleUserSelect}\n              className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n            >\n              <option value=\"\">-- {t('common.select')} --</option>\n              {users.map(user => (\n                <option key={user.id} value={user.id}>\n                  {user.firstName} {user.lastName} ({user.username})\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n      </div>\n\n      {selectedUser && (\n        <div>\n          {/* Tabs fr Benutzerdetails, Dokumente und Rollen - zusammenhngende Box ohne Shadow/Border */}\n          <div className=\"bg-white dark:bg-gray-800 mb-6\">\n            {/* Tab-Navigation */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n              <nav className=\"flex -mb-px\">\n                <button\n                  onClick={() => setActiveUserTab('details')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'details'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <UserCircleIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('users.title')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('documents')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'documents'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <DocumentTextIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('profile.documents')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('roles')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'roles'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <ShieldCheckIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('roles.title')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('branches')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'branches'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <MapPinIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('branches.title') || 'Niederlassungen'}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('lifecycle')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'lifecycle'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <BuildingOfficeIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('lifecycle.tabTitle')}\n                </button>\n              </nav>\n          </div>\n\n            {/* Tab-Inhalte */}\n          {/* Benutzerdetails Formular */}\n          {activeUserTab === 'details' && (\n              <form onSubmit={handleUserSubmit} className=\"p-6\">\n              {/* Benutzerdetails - gleiche Reihenfolge wie Profile.tsx */}\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-6\">\n                {/* 1. Username, Email (nebeneinander - 2 Spalten) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.username')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"username\"\n                    value={userFormData.username || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.email')}\n                  </label>\n                  <input\n                    type=\"email\"\n                    name=\"email\"\n                    value={userFormData.email || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* 2. Language (allein - 1 Spalte) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.language')} <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    name=\"language\"\n                    value={userFormData.language || 'es'}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    required\n                  >\n                    {LANGUAGES.map((language) => (\n                      <option key={language.code} value={language.code}>\n                        {language.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                {/* 3. Dokumenten-Upload (prominent - volle Breite) */}\n                {selectedUser && (\n                  <div className=\"sm:col-span-2\">\n                    <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <h3 className=\"text-sm font-medium text-blue-900 dark:text-blue-200 mb-1\">\n                            {t('profile.identificationDocument', { defaultValue: 'Identifikationsdokument' })}\n                          </h3>\n                          <p className=\"text-xs text-blue-700 dark:text-blue-300\">\n                            {t('profile.uploadDocumentHint', { defaultValue: 'Bitte laden Sie das Identifikationsdokument (Cdula oder Pasaporte) hoch. Die Felder werden automatisch ausgefllt.' })}\n                          </p>\n                        </div>\n                        <input\n                          type=\"file\"\n                          id=\"documentUploadUserManagement\"\n                          accept=\"image/*\"\n                          className=\"hidden\"\n                          onChange={handleDirectDocumentUploadWrapper}\n                          disabled={isUploading}\n                        />\n                        <label\n                          htmlFor=\"documentUploadUserManagement\"\n                          className={`p-2 text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer ${isUploading ? 'opacity-50 cursor-not-allowed' : ''}`}\n                          title={t('profile.uploadDocument', { defaultValue: 'Dokument hochladen' })}\n                        >\n                          <DocumentTextIcon className=\"h-5 w-5\" />\n                        </label>\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {/* 4. ID-Dokument-Daten (readonly, alle Felder - korrekte Reihenfolge) */}\n                {/* Zeige Felder an, wenn User-Daten vorhanden sind (werden beim Upload extrahiert) */}\n                {(selectedUser.firstName || selectedUser.lastName || selectedUser.birthday || selectedUser.identificationNumber) && (\n                  <>\n                    {(() => {\n                      const latestDoc = selectedUser.identificationDocuments && selectedUser.identificationDocuments.length > 0 ? selectedUser.identificationDocuments[0] : null;\n                      return (\n                        <>\n                          {/* 1. Vorname */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('users.form.firstName')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.firstName || ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 2. Nachname */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('users.form.lastName')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.lastName || ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 3. Geburtsdatum */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.birthday')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 4. Land */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.country')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.country ? COUNTRIES.find(c => c.code === selectedUser.country)?.name || selectedUser.country : ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 5. Geschlecht (editierbar, falls KI nicht richtig erkannt hat) */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.gender')}\n                            </label>\n                            <select\n                              name=\"gender\"\n                              value={userFormData.gender || ''}\n                              onChange={handleUserInputChange}\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                            >\n                              <option value=\"\">{t('profile.selectGender')}</option>\n                              <option value=\"male\">{t('profile.genderMale')}</option>\n                              <option value=\"female\">{t('profile.genderFemale')}</option>\n                              <option value=\"other\">{t('profile.genderOther')}</option>\n                            </select>\n                          </div>\n\n                          {/* 6. Dokument-Typ */}\n                          {latestDoc && (\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.identificationType')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={\n                                latestDoc.documentType\n                                  ? (() => {\n                                      const typeMap: Record<string, string> = {\n                                        passport: t('identificationDocuments.types.passport'),\n                                        national_id: t('identificationDocuments.types.national_id'),\n                                        driving_license: t('identificationDocuments.types.driving_license'),\n                                        residence_permit: t('identificationDocuments.types.residence_permit'),\n                                        work_permit: t('identificationDocuments.types.work_permit'),\n                                        tax_id: t('identificationDocuments.types.tax_id'),\n                                        social_security: t('identificationDocuments.types.social_security'),\n                                      };\n                                      return typeMap[latestDoc.documentType] || latestDoc.documentType;\n                                    })()\n                                  : ''\n                              }\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n                          )}\n\n                          {/* 7. Dokument-Nummer */}\n                          {(selectedUser.identificationNumber || latestDoc?.documentNumber) && (\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.identificationNumber')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.identificationNumber || latestDoc?.documentNumber || ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n                          )}\n\n                          {/* 8. Ausstellungsdatum */}\n                          {latestDoc?.issueDate && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.identificationIssueDate') || 'Ausstellungsdatum'}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={new Date(latestDoc.issueDate).toISOString().split('T')[0]}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n\n                          {/* 9. Ablaufdatum */}\n                          {latestDoc?.expiryDate && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.identificationExpiryDate')}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={new Date(latestDoc.expiryDate).toISOString().split('T')[0]}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n\n                          {/* 10. Ausstellungsland */}\n                          {latestDoc?.issuingCountry && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.issuingCountry')}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={latestDoc.issuingCountry}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n\n                          {/* 11. Ausstellungsbehrde */}\n                          {latestDoc?.issuingAuthority && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.issuingAuthority')}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={latestDoc.issuingAuthority}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n                        </>\n                      );\n                    })()}\n                  </>\n                )}\n\n                {/* 5. Phone Number (allein - 1 Spalte, da Geschlecht jetzt in ID-Dokument-Daten) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.phoneNumber')}\n                  </label>\n                  <input\n                    type=\"tel\"\n                    name=\"phoneNumber\"\n                    value={userFormData.phoneNumber || ''}\n                    onChange={handleUserInputChange}\n                    placeholder=\"+573001234567\"\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                    {t('profile.phoneNumberHint')}\n                  </p>\n                </div>\n\n                {/* 6. Finanzdaten (Bank Details - 1 Spalte) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.bankDetails')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"bankDetails\"\n                    value={userFormData.bankDetails || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Contract, Salary, Normal Working Hours ENTFERNEN - werden zu Lifecycle verschoben */}\n              </div>\n\n              {/* Lohnabrechnung-Einstellungen */}\n              <div className=\"mt-4 border-t pt-4\">\n                <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('users.form.payrollSettings')}</h3>\n                \n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('users.form.payrollCountry')}\n                    </label>\n                    <select\n                      name=\"payrollCountry\"\n                      value={userFormData.payrollCountry || selectedUser.payrollCountry || 'CH'}\n                      onChange={handleUserInputChange}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    >\n                      {PAYROLL_COUNTRIES.map(country => (\n                        <option key={country.code} value={country.code}>\n                          {country.name}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  \n                  {(userFormData.payrollCountry === 'CO' || \n                    (selectedUser.payrollCountry === 'CO' && !userFormData.payrollCountry)) && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('users.form.contractType')}\n                      </label>\n                      <select\n                        name=\"contractType\"\n                        value={userFormData.contractType || ''}\n                        onChange={handleUserInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      >\n                        <option value=\"\">Bitte auswhlen</option>\n                        {CONTRACT_TYPES.map(type => (\n                          <option key={type.code} value={type.code}>\n                            {type.name}\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                  )}\n                </div>\n                \n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('users.form.hourlyRate')} ({(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? 'CHF' : 'COP'})\n                    </label>\n                    <input\n                      type=\"number\"\n                      name=\"hourlyRate\"\n                      min=\"0\"\n                      step={(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? '0.05' : '1'}\n                      value={userFormData.hourlyRate === null || userFormData.hourlyRate === undefined ? '' : userFormData.hourlyRate}\n                      onChange={handleUserInputChange}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      placeholder={(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? 'z.B. 45.00' : 'z.B. 50000'}\n                    />\n                  </div>\n                  \n                  {((userFormData.payrollCountry === 'CO' || selectedUser.payrollCountry === 'CO') && \n                    (userFormData.contractType !== 'servicios_externos' && selectedUser.contractType !== 'servicios_externos') &&\n                    (userFormData.contractType || selectedUser.contractType)) && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('users.form.monthlySalary')} (COP)\n                      </label>\n                      <input\n                        type=\"number\"\n                        name=\"monthlySalary\"\n                        min=\"0\"\n                        step=\"1000\"\n                        value={userFormData.monthlySalary === null || userFormData.monthlySalary === undefined ? '' : userFormData.monthlySalary}\n                        onChange={handleUserInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                        placeholder=\"z.B. 3500000\"\n                      />\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {isEditingUser && (\n                <div className=\"mt-4 flex justify-end gap-3\">\n                  <div className=\"relative group\">\n                    <button\n                      type=\"button\"\n                      onClick={handleCancelEdit}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {t('common.cancel')}\n                    </div>\n                  </div>\n                  <div className=\"relative group\">\n                    <button\n                      type=\"submit\"\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                    >\n                      <CheckIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {t('common.save')}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* Status-Badge und Activate/Deactivate Button unter den Profil-Feldern */}\n              <div className=\"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-between items-center\">\n                {selectedUser.active !== undefined && (\n                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                    selectedUser.active \n                      ? 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300' \n                      : 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300'\n                  }`}>\n                    {selectedUser.active ? t('users.active') : t('users.inactive')}\n                  </span>\n                )}\n                {isAdmin() && (\n                  <button\n                    onClick={handleToggleActive}\n                    className={`relative group flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${\n                      selectedUser.active\n                        ? 'bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30'\n                        : 'bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900/20 dark:text-green-400 dark:hover:bg-green-900/30'\n                    }`}\n                  >\n                    {selectedUser.active ? (\n                      <>\n                        <XMarkIcon className=\"h-5 w-5\" />\n                        {t('users.deactivate')}\n                      </>\n                    ) : (\n                      <>\n                        <CheckIcon className=\"h-5 w-5\" />\n                        {t('users.activate')}\n                      </>\n                    )}\n                  </button>\n                )}\n              </div>\n            </form>\n          )}\n\n          {/* Identifikationsdokumente Tab */}\n          {activeUserTab === 'documents' && (\n              <div className=\"p-6\">\n            <IdentificationDocumentList userId={selectedUser.id} isAdmin={true} ref={documentListRef} />\n              </div>\n          )}\n\n          {/* Rollen Tab */}\n          {activeUserTab === 'roles' && (\n              <div className=\"p-6\">\n              {/* Rollenzuweisung - nur anzeigen, wenn Rollen geladen wurden */}\n              {loadingRoles ? (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('roleAssignment.title')}</h3>\n                  <p className=\"dark:text-gray-300\">{t('roleAssignment.loading')}</p>\n                </div>\n              ) : roles.length > 0 && (\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('roleAssignment.title')}</h3>\n                  \n                  {/* berprfung auf unbekannte Rollen */}\n                  {selectedRoles.some(roleId => !roles.some(role => role.id === roleId)) && (\n                    <div className=\"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4\">\n                      <p className=\"font-bold\">{t('roleAssignment.unknownRolesWarning')}</p>\n                      <p>{t('roleAssignment.unknownRolesMessage', { ids: selectedRoles.filter(roleId => !roles.some(role => role.id === roleId)).join(', ') })}</p>\n                      <p className=\"mt-2 text-sm\">{t('roleAssignment.availableRoleIds', { ids: roles.map(r => r.id).join(', ') })}</p>\n                    </div>\n                  )}\n                  \n                  {/* Aktuell zugewiesene Rollen */}\n                  <div className=\"mb-4\">\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('roleAssignment.currentRoles')}</h4>\n                    {selectedRoles.length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('roleAssignment.noRolesAssigned')}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {/* Bekannte zugewiesene Rollen */}\n                        {roles\n                          .filter(role => selectedRoles.includes(role.id))\n                          .map(role => {\n                            // Eine Rolle ist nur dann nicht entfernbar, wenn es sich um die Admin-Rolle (ID: 1) fr den Admin-Benutzer (ID: 1) handelt\n                            const isFixedRole = role.id === 1 && selectedUser && selectedUser.id === 1;\n                            return (\n                              <div \n                                key={role.id} \n                                className={`border rounded-lg p-4 ${isFixedRole ? 'border-green-500 bg-green-50 dark:bg-green-900/20 dark:border-green-700 cursor-not-allowed' : 'border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 cursor-pointer'}`}\n                                onClick={() => !isFixedRole && toggleRole(role.id)}\n                              >\n                                <div className=\"flex justify-between items-center\">\n                                  <div>\n                                    <h4 className=\"font-medium flex items-center dark:text-white\">\n                                      {role.name}\n                                      {isFixedRole && (\n                                        <span className=\"ml-2 text-xs bg-green-600 text-white px-2 py-0.5 rounded-full\">\n                                          {t('roleAssignment.fixed')}\n                                        </span>\n                                      )}\n                                    </h4>\n                                    <p className=\"text-sm text-gray-600 dark:text-gray-400\">{role.description}</p>\n                                  </div>\n                                  <div className={`flex items-center ${isFixedRole ? 'text-gray-400 dark:text-gray-500' : 'text-blue-600 dark:text-blue-400'}`}>\n                                    <span className=\"mr-2 text-sm\">{isFixedRole ? t('roleAssignment.fixedAssigned') : t('roleAssignment.remove')}</span>\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </div>\n                                </div>\n                              </div>\n                            );\n                          })}\n                        \n                        {/* Unbekannte zugewiesene Rollen */}\n                        {selectedRoles\n                          .filter(roleId => !roles.some(role => role.id === roleId))\n                          .map(roleId => (\n                            <div \n                              key={`unknown-${roleId}`} \n                              className=\"border border-orange-500 bg-orange-50 rounded-lg p-4\"\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{t('roleAssignment.unknownRole', { id: roleId })}</h4>\n                                  <p className=\"text-sm text-orange-600\">{t('roleAssignment.unknownRoleDescription')}</p>\n                                </div>\n                                <div className=\"flex items-center text-orange-600\">\n                                  <span className=\"mr-2 text-sm\">{t('roleAssignment.remove')}</span>\n                                  <button \n                                    onClick={() => toggleRole(roleId)}\n                                    className=\"focus:outline-none\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </button>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Verfgbare Rollen */}\n                  <div>\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('roleAssignment.availableRoles')}</h4>\n                    {roles.filter(role => !selectedRoles.includes(role.id)).length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('roleAssignment.noRolesAvailable')}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {roles\n                          .filter(role => !selectedRoles.includes(role.id))\n                          .map(role => (\n                            <div \n                              key={role.id} \n                              className=\"border border-gray-300 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50\"\n                              onClick={() => toggleRole(role.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{role.name}</h4>\n                                  <p className=\"text-sm text-gray-600\">{role.description}</p>\n                                </div>\n                                <div className=\"flex items-center text-gray-500 hover:text-blue-600\">\n                                  <span className=\"mr-2 text-sm\">{t('roleAssignment.add')}</span>\n                                  <PlusIcon className=\"h-5 w-5\" />\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Branches Tab */}\n          {activeUserTab === 'branches' && (\n              <div className=\"p-6\">\n              {/* Branch-Zuweisung - nur anzeigen, wenn Branches geladen wurden */}\n              {loadingBranches ? (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('branchAssignment.title') || 'Niederlassungszuweisung'}</h3>\n                  <p className=\"dark:text-gray-300\">{t('branchAssignment.loading') || 'Lade Niederlassungen...'}</p>\n                </div>\n              ) : branches.length > 0 && (\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('branchAssignment.title') || 'Niederlassungszuweisung'}</h3>\n                  \n                  {/* berprfung auf unbekannte Branches */}\n                  {selectedBranches.some(branchId => !branches.some(branch => branch.id === branchId)) && (\n                    <div className=\"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4\">\n                      <p className=\"font-bold\">{t('branchAssignment.unknownBranchesWarning') || 'Unbekannte Niederlassungen zugewiesen'}</p>\n                      <p>{t('branchAssignment.unknownBranchesMessage', { ids: selectedBranches.filter(branchId => !branches.some(branch => branch.id === branchId)).join(', ') }) || `Die folgenden Niederlassungs-IDs sind zugewiesen, aber nicht verfgbar: ${selectedBranches.filter(branchId => !branches.some(branch => branch.id === branchId)).join(', ')}`}</p>\n                      <p className=\"mt-2 text-sm\">{t('branchAssignment.availableBranchIds', { ids: branches.map(b => b.id).join(', ') }) || `Verfgbare Niederlassungs-IDs: ${branches.map(b => b.id).join(', ')}`}</p>\n                    </div>\n                  )}\n                  \n                  {/* Aktuell zugewiesene Branches */}\n                  <div className=\"mb-4\">\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('branchAssignment.currentBranches') || 'Aktuell zugewiesene Niederlassungen'}</h4>\n                    {selectedBranches.length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('branchAssignment.noBranchesAssigned') || 'Keine Niederlassungen zugewiesen'}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {/* Bekannte zugewiesene Branches */}\n                        {branches\n                          .filter(branch => selectedBranches.includes(branch.id))\n                          .map(branch => (\n                            <div \n                              key={branch.id} \n                              className=\"border border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 rounded-lg p-4 cursor-pointer\"\n                              onClick={() => toggleBranch(branch.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium dark:text-white\">\n                                    {branch.name}\n                                  </h4>\n                                </div>\n                                <div className=\"flex items-center text-blue-600 dark:text-blue-400\">\n                                  <span className=\"mr-2 text-sm\">{t('branchAssignment.remove') || 'Entfernen'}</span>\n                                  <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                  </svg>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                        \n                        {/* Unbekannte zugewiesene Branches */}\n                        {selectedBranches\n                          .filter(branchId => !branches.some(branch => branch.id === branchId))\n                          .map(branchId => (\n                            <div \n                              key={`unknown-${branchId}`} \n                              className=\"border border-orange-500 bg-orange-50 rounded-lg p-4\"\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{t('branchAssignment.unknownBranch', { id: branchId }) || `Unbekannte Niederlassung (ID: ${branchId})`}</h4>\n                                  <p className=\"text-sm text-orange-600\">{t('branchAssignment.unknownBranchDescription') || 'Diese Niederlassung existiert nicht mehr oder ist nicht verfgbar.'}</p>\n                                </div>\n                                <div className=\"flex items-center text-orange-600\">\n                                  <span className=\"mr-2 text-sm\">{t('branchAssignment.remove') || 'Entfernen'}</span>\n                                  <button \n                                    onClick={() => toggleBranch(branchId)}\n                                    className=\"focus:outline-none\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </button>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Verfgbare Branches */}\n                  <div>\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('branchAssignment.availableBranches') || 'Verfgbare Niederlassungen'}</h4>\n                    {branches.filter(branch => !selectedBranches.includes(branch.id)).length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('branchAssignment.noBranchesAvailable') || 'Keine weiteren Niederlassungen verfgbar'}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {branches\n                          .filter(branch => !selectedBranches.includes(branch.id))\n                          .map(branch => (\n                            <div \n                              key={branch.id} \n                              className=\"border border-gray-300 dark:border-gray-600 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20\"\n                              onClick={() => toggleBranch(branch.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium dark:text-white\">{branch.name}</h4>\n                                </div>\n                                <div className=\"flex items-center text-gray-500 hover:text-blue-600 dark:hover:text-blue-400\">\n                                  <span className=\"mr-2 text-sm\">{t('branchAssignment.add') || 'Hinzufgen'}</span>\n                                  <PlusIcon className=\"h-5 w-5\" />\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n              {!loadingBranches && branches.length === 0 && (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('branchAssignment.title') || 'Niederlassungszuweisung'}</h3>\n                  <p className=\"text-gray-500 dark:text-gray-400\">{t('branchAssignment.noBranchesFound') || 'Keine Niederlassungen gefunden'}</p>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Lebenszyklus Tab */}\n          {activeUserTab === 'lifecycle' && selectedUser && (\n              <div className=\"p-6\">\n            <LifecycleView \n              key={`lifecycle-${selectedUser.id}-${lifecycleRefreshKey}`}\n              userId={selectedUser.id} \n              userName={`${selectedUser.firstName} ${selectedUser.lastName}`}\n            />\n              </div>\n          )}\n          </div>\n        </div>\n      )}\n\n      {/* Sidepane/Modal fr Benutzererstellung */}\n      {isCreateModalOpen && (\n        <>\n          {/* Fr Mobile (unter 640px) - klassisches Modal */}\n          {isMobile ? (\n            <Dialog open={isCreateModalOpen} onClose={() => setIsCreateModalOpen(false)} className=\"relative z-50\">\n              <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n              \n              <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                  {/* Header */}\n                  <div className=\"px-6 py-4 border-b dark:border-gray-700\">\n                    <div className=\"flex items-center justify-between\">\n                      <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                        {t('organisation.createUser.title')}\n                      </Dialog.Title>\n                      <button\n                        onClick={() => setIsCreateModalOpen(false)}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                      >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                      </button>\n                    </div>\n                  </div>\n                  \n                  {/* Form */}\n                  <form onSubmit={handleCreateUser} className=\"p-6\">\n                    <div className=\"space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.email')} *\n                        </label>\n                        <input\n                          type=\"email\"\n                          name=\"email\"\n                          value={newUserFormData.email}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.password')} *\n                        </label>\n                        <input\n                          type=\"password\"\n                          name=\"password\"\n                          value={newUserFormData.password}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.firstName')} *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"firstName\"\n                          value={newUserFormData.firstName}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.lastName')} *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"lastName\"\n                          value={newUserFormData.lastName}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                    </div>\n                    \n                    {/* Footer */}\n                    <div className=\"mt-6 flex justify-end gap-3\">\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          onClick={() => setIsCreateModalOpen(false)}\n                          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                        >\n                          <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('common.cancel')}\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          type=\"submit\"\n                          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                        >\n                          <CheckIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('organisation.createUser.create')}\n                        </div>\n                      </div>\n                    </div>\n                  </form>\n                </Dialog.Panel>\n              </div>\n            </Dialog>\n          ) : (\n            // Fr Desktop (ab 640px) - Sidepane\n            // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n            <>\n              {/* Backdrop - nur wenn offen und <= 1070px */}\n              {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n              {isCreateModalOpen && !isLargeScreen && (\n                <div \n                  className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                  aria-hidden=\"true\" \n                  style={{\n                    opacity: isCreateModalOpen ? 1 : 0,\n                    transition: 'opacity 300ms ease-out'\n                  }}\n                />\n              )}\n              \n              {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n              <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isCreateModalOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                  transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                  pointerEvents: isCreateModalOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isCreateModalOpen}\n                role=\"dialog\"\n                aria-modal={isCreateModalOpen}\n              >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                  <h2 className=\"text-lg font-semibold dark:text-white\">\n                    {t('organisation.createUser.title')}\n                  </h2>\n                  <button\n                    onClick={() => setIsCreateModalOpen(false)}\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                <div className=\"flex flex-col flex-1 min-h-0\">\n                  <form onSubmit={handleCreateUser} className=\"flex flex-col flex-1 min-h-0\">\n                    <div className=\"p-4 overflow-y-auto flex-1 min-h-0 space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.email')} *\n                        </label>\n                      <input\n                        type=\"email\"\n                        name=\"email\"\n                        value={newUserFormData.email}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.password')} *\n                      </label>\n                      <input\n                        type=\"password\"\n                        name=\"password\"\n                        value={newUserFormData.password}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.firstName')} *\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"firstName\"\n                        value={newUserFormData.firstName}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.lastName')} *\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"lastName\"\n                        value={newUserFormData.lastName}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                      </div>\n                    </div>\n                    \n                    {/* Footer */}\n                    <div className=\"flex justify-end gap-3 border-t dark:border-gray-700 pt-4 px-4 flex-shrink-0\">\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          onClick={() => setIsCreateModalOpen(false)}\n                          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                        >\n                          <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('common.cancel')}\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          type=\"submit\"\n                          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                        >\n                          <CheckIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('organisation.createUser.create')}\n                        </div>\n                      </div>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default UserManagementTab; ","/**\n * PERMISSION STRUCTURE - Zentrale Definition gem Plan\n * \n * Ausprgungen:\n * - PAGE: ja/nein (2 Optionen)  'all_both' = ja, 'none' = nein\n * - BOX mit Daten: alle/eigene/nein (3 Optionen)  'all_both', 'own_both', 'none'\n * - TAB: alle/eigene/nein (3 Optionen)  'all_both', 'own_both', 'none'\n * - BUTTON: \n *   - ja/nein (2 Optionen)  'all_both' = ja, 'none' = nein\n *   - ODER alle/eigene/nein (3 Optionen)  'all_both', 'own_both', 'none'\n */\n\nexport type PermissionType = 'page' | 'box' | 'tab' | 'button';\nexport type PermissionOptions = 'binary' | 'ternary'; // binary = ja/nein, ternary = alle/eigene/nein\n\nexport interface PermissionButton {\n  entity: string;\n  label: string;\n  options: PermissionOptions;\n}\n\nexport interface PermissionTab {\n  entity: string;\n  label: string;\n  options: PermissionOptions;\n  buttons?: PermissionButton[];\n}\n\nexport interface PermissionBox {\n  entity: string;\n  label: string;\n  options: PermissionOptions | null; // null = Container ohne eigene Berechtigung\n  buttons?: PermissionButton[];\n  tabs?: PermissionTab[];\n}\n\nexport interface PermissionPage {\n  entity: string;\n  label: string;\n  options: PermissionOptions; // immer 'binary' fr Pages\n  boxes?: PermissionBox[];\n  tabs?: PermissionTab[];\n}\n\n/**\n * KOMPLETTE PERMISSION-STRUKTUR gem Plan\n */\nexport const PERMISSION_STRUCTURE: PermissionPage[] = [\n  // ================== PAGE: Dashboard ==================\n  {\n    entity: 'dashboard',\n    label: 'Dashboard',\n    options: 'binary',\n    boxes: [\n      {\n        entity: 'requests',\n        label: 'Solicitudes',\n        options: 'ternary',\n        buttons: [\n          { entity: 'request_create', label: 'Erstellen', options: 'ternary' },\n          { entity: 'request_edit', label: 'Bearbeiten', options: 'ternary' },\n          { entity: 'request_delete', label: 'Lschen', options: 'ternary' }\n        ]\n      }\n    ]\n  },\n\n  // ================== PAGE: Worktracker ==================\n  {\n    entity: 'worktracker',\n    label: 'Worktracker',\n    options: 'binary',\n    boxes: [\n      {\n        entity: 'zeiterfassung',\n        label: 'Zeiterfassung',\n        options: null, // Container ohne eigene Berechtigung\n        buttons: [\n          { entity: 'worktime_start', label: 'Starten', options: 'binary' },\n          { entity: 'worktime_stop', label: 'Stoppen', options: 'binary' }\n        ]\n      }\n    ],\n    tabs: [\n      {\n        entity: 'todos',\n        label: \"To Do's\",\n        options: 'ternary',\n        buttons: [\n          { entity: 'todo_create', label: 'Erstellen', options: 'ternary' },\n          { entity: 'todo_edit', label: 'Bearbeiten', options: 'ternary' },\n          { entity: 'todo_delete', label: 'Lschen', options: 'ternary' }\n        ]\n      },\n      {\n        entity: 'reservations',\n        label: 'Reservierungen',\n        options: 'ternary',\n        buttons: [\n          { entity: 'reservation_create', label: 'Erstellen', options: 'ternary' },\n          { entity: 'reservation_edit', label: 'Bearbeiten', options: 'ternary' },\n          { entity: 'reservation_delete', label: 'Lschen', options: 'ternary' }\n        ]\n      },\n      {\n        entity: 'tour_bookings',\n        label: 'Touren',\n        options: 'ternary',\n        buttons: [\n          { entity: 'tour_booking_create', label: 'Erstellen', options: 'ternary' },\n          { entity: 'tour_booking_edit', label: 'Bearbeiten', options: 'ternary' },\n          { entity: 'tour_booking_delete', label: 'Lschen', options: 'ternary' }\n        ]\n      }\n    ]\n  },\n\n  // ================== PAGE: Consultas ==================\n  {\n    entity: 'consultations',\n    label: 'Consultas',\n    options: 'binary',\n    boxes: [\n      {\n        entity: 'consultas_box',\n        label: 'Consultas',\n        options: null, // Container ohne eigene Berechtigung\n        buttons: [\n          { entity: 'consultation_start', label: 'Starten', options: 'binary' },\n          { entity: 'consultation_stop', label: 'Stoppen', options: 'binary' },\n          { entity: 'consultation_plan', label: 'Planen', options: 'binary' },\n          { entity: 'client_create', label: 'Client anlegen', options: 'binary' }\n        ]\n      },\n      {\n        entity: 'consultation_list',\n        label: 'Beratungsliste',\n        options: 'ternary',\n        buttons: [\n          { entity: 'consultation_edit', label: 'Bearbeiten', options: 'ternary' },\n          { entity: 'consultation_delete', label: 'Lschen', options: 'ternary' }\n        ]\n      }\n    ]\n  },\n\n  // ================== PAGE: Workcenter ==================\n  {\n    entity: 'team_worktime_control',\n    label: 'Workcenter',\n    options: 'binary',\n    tabs: [\n      {\n        entity: 'arbeitszeiten',\n        label: 'Arbeitszeiten',\n        options: 'ternary',\n        buttons: [\n          { entity: 'team_worktime_create', label: 'Erstellen', options: 'ternary' },\n          { entity: 'team_worktime_edit', label: 'Bearbeiten', options: 'ternary' },\n          { entity: 'team_worktime_delete', label: 'Lschen', options: 'ternary' }\n        ]\n      },\n      {\n        entity: 'plan_de_turnos',\n        label: 'Schichtplan',\n        options: 'ternary',\n        buttons: [\n          { entity: 'shift_create', label: 'Erstellen', options: 'binary' },\n          { entity: 'shift_edit', label: 'Bearbeiten', options: 'binary' },\n          { entity: 'shift_delete', label: 'Lschen', options: 'binary' },\n          { entity: 'shift_exchange_request', label: 'Tausch-Anfragen', options: 'binary' }\n        ]\n      },\n      {\n        entity: 'task_analytics',\n        label: 'Task Analytics',\n        options: 'ternary'\n      },\n      {\n        entity: 'request_analytics',\n        label: 'Request Analytics',\n        options: 'ternary'\n      }\n    ]\n  },\n\n  // ================== PAGE: Nmina ==================\n  {\n    entity: 'payroll',\n    label: 'Nmina',\n    options: 'binary',\n    tabs: [\n      {\n        entity: 'consultation_invoices',\n        label: 'Beratungsrechnungen',\n        options: 'ternary'\n      },\n      {\n        entity: 'monthly_reports',\n        label: 'Monatsrechnungen',\n        options: 'ternary'\n      },\n      {\n        entity: 'payroll_reports',\n        label: 'Lohnabrechnungen',\n        options: 'ternary'\n      }\n    ]\n  },\n\n  // ================== PAGE: Cerebro ==================\n  {\n    entity: 'cerebro',\n    label: 'Cerebro',\n    options: 'binary'\n  },\n\n  // ================== PAGE: Organisation ==================\n  {\n    entity: 'organization_management',\n    label: 'Organisation',\n    options: 'binary',\n    tabs: [\n      {\n        entity: 'users',\n        label: 'Benutzer',\n        options: 'ternary',\n        buttons: [\n          { entity: 'user_create', label: 'Erstellen', options: 'binary' },\n          { entity: 'user_edit', label: 'Bearbeiten', options: 'binary' },\n          { entity: 'user_delete', label: 'Lschen', options: 'binary' }\n        ]\n      },\n      {\n        entity: 'roles',\n        label: 'Rollen',\n        options: 'ternary',\n        buttons: [\n          { entity: 'role_create', label: 'Erstellen', options: 'binary' },\n          { entity: 'role_edit', label: 'Bearbeiten', options: 'binary' },\n          { entity: 'role_delete', label: 'Lschen', options: 'binary' }\n        ]\n      },\n      {\n        entity: 'branches',\n        label: 'Niederlassungen',\n        options: 'ternary',\n        buttons: [\n          { entity: 'branch_create', label: 'Erstellen', options: 'binary' },\n          { entity: 'branch_edit', label: 'Bearbeiten', options: 'binary' },\n          { entity: 'branch_delete', label: 'Lschen', options: 'binary' }\n        ]\n      },\n      {\n        entity: 'tour_providers',\n        label: 'Tour-Anbieter',\n        options: 'ternary',\n        buttons: [\n          { entity: 'tour_provider_create', label: 'Anbieter erstellen', options: 'binary' },\n          { entity: 'tour_provider_edit', label: 'Anbieter bearbeiten', options: 'binary' },\n          { entity: 'tour_provider_delete', label: 'Anbieter lschen', options: 'binary' },\n          { entity: 'tour_create', label: 'Tour erstellen', options: 'binary' },\n          { entity: 'tour_edit', label: 'Tour bearbeiten', options: 'binary' },\n          { entity: 'tour_delete', label: 'Tour lschen', options: 'binary' }\n        ]\n      },\n      {\n        entity: 'organization_settings',\n        label: 'Organisation',\n        options: 'ternary',\n        buttons: [\n          { entity: 'organization_create', label: 'Erstellen', options: 'binary' },\n          { entity: 'organization_edit', label: 'Bearbeiten', options: 'binary' },\n          { entity: 'organization_delete', label: 'Lschen', options: 'binary' }\n        ]\n      }\n    ]\n  },\n\n  // ================== PAGE: Price Analysis ==================\n  {\n    entity: 'price_analysis',\n    label: 'Preisanalyse',\n    options: 'binary'\n  },\n\n  // ================== PAGE: Configuration ==================\n  {\n    entity: 'settings',\n    label: 'Konfiguration',\n    options: 'binary',\n    tabs: [\n      {\n        entity: 'password_manager',\n        label: 'Passwort-Manager',\n        options: 'ternary'\n      },\n      {\n        entity: 'system',\n        label: 'System',\n        options: 'ternary'\n      }\n    ]\n  },\n\n  // ================== PAGE: Profile ==================\n  {\n    entity: 'profile',\n    label: 'Profil',\n    options: 'binary'\n  }\n];\n\n/**\n * Initialisiert alle Permissions aus PERMISSION_STRUCTURE mit Standardwerten\n * und bernimmt dann die gespeicherten Werte (falls vorhanden)\n */\nexport const initializePermissions = (\n  savedPermissions: { entity: string; entityType: string; accessLevel: string }[] = []\n): { entity: string; entityType: string; accessLevel: string }[] => {\n  const allEntities = getAllEntities();\n  const initialized: { entity: string; entityType: string; accessLevel: string }[] = [];\n\n  allEntities.forEach(({ entity, type }) => {\n    // Suche gespeicherten Wert\n    const saved = savedPermissions.find(\n      p => p.entity === entity && p.entityType === type\n    );\n\n    // Verwende gespeicherten Wert oder Standard 'none'\n    initialized.push({\n      entity,\n      entityType: type,\n      accessLevel: saved?.accessLevel || 'none'\n    });\n  });\n\n  return initialized;\n};\n\n/**\n * Hilfsfunktion: Alle Entities aus der Struktur extrahieren\n */\nexport const getAllEntities = (): { entity: string; type: PermissionType; options: PermissionOptions }[] => {\n  const entities: { entity: string; type: PermissionType; options: PermissionOptions }[] = [];\n\n  PERMISSION_STRUCTURE.forEach(page => {\n    entities.push({ entity: page.entity, type: 'page', options: page.options });\n\n    page.boxes?.forEach(box => {\n      if (box.options) {\n        entities.push({ entity: box.entity, type: 'box', options: box.options });\n      }\n      box.buttons?.forEach(button => {\n        entities.push({ entity: button.entity, type: 'button', options: button.options });\n      });\n      box.tabs?.forEach(tab => {\n        entities.push({ entity: tab.entity, type: 'tab', options: tab.options });\n        tab.buttons?.forEach(button => {\n          entities.push({ entity: button.entity, type: 'button', options: button.options });\n        });\n      });\n    });\n\n    page.tabs?.forEach(tab => {\n      entities.push({ entity: tab.entity, type: 'tab', options: tab.options });\n      tab.buttons?.forEach(button => {\n        entities.push({ entity: button.entity, type: 'button', options: button.options });\n      });\n    });\n  });\n\n  return entities;\n};\n\n/**\n * Standard-Berechtigungen fr Rollen\n */\nexport const getDefaultPermissionsForRole = (roleName: string): { entity: string; entityType: string; accessLevel: string }[] => {\n  const permissions: { entity: string; entityType: string; accessLevel: string }[] = [];\n  const allEntities = getAllEntities();\n\n  allEntities.forEach(({ entity, type, options }) => {\n    let accessLevel: string;\n\n    switch (roleName.toLowerCase()) {\n      case 'admin':\n        // Admin hat berall Vollzugriff\n        accessLevel = 'all_both';\n        break;\n      case 'user':\n        // User sieht meistens nur eigene\n        accessLevel = options === 'binary' ? 'all_both' : 'own_both';\n        break;\n      case 'hamburger':\n        // Hamburger sieht nur eigene und darf nichts\n        if (type === 'page') {\n          accessLevel = 'all_both'; // Seiten sehen ja\n        } else if (type === 'button') {\n          accessLevel = 'none'; // Keine Button-Aktionen\n        } else {\n          accessLevel = 'own_both'; // Nur eigene Daten\n        }\n        break;\n      default:\n        accessLevel = 'none';\n    }\n\n    permissions.push({\n      entity,\n      entityType: type,\n      accessLevel\n    });\n  });\n\n  return permissions;\n};\n\n/**\n * Optionen fr Dropdown basierend auf PermissionOptions\n */\nexport const getAccessLevelOptions = (options: PermissionOptions): string[] => {\n  if (options === 'binary') {\n    return ['none', 'all_both']; // Nein / Ja\n  }\n  return ['none', 'own_both', 'all_both']; // Nein / Eigene / Alle\n};\n\n/**\n * Label fr AccessLevel\n */\nexport const getAccessLevelLabel = (accessLevel: string, options: PermissionOptions): string => {\n  if (options === 'binary') {\n    return accessLevel === 'none' ? 'Nein' : 'Ja';\n  }\n  switch (accessLevel) {\n    case 'none': return 'Nein';\n    case 'own_both': return 'Eigene';\n    case 'own_read': return 'Eigene';\n    case 'all_both': return 'Alle';\n    case 'all_read': return 'Alle';\n    default: return 'Nein';\n  }\n};\n","/**\n * PermissionEditor - Komponente zum Bearbeiten von Berechtigungen gem Plan\n * \n * Rendert die hierarchische Berechtigungsstruktur:\n * PAGE > BOX/TAB > BUTTON\n * \n * Mit korrekten Ausprgungen:\n * - PAGE: ja/nein (binary)\n * - BOX/TAB: alle/eigene/nein (ternary)\n * - BUTTON: je nach Definition (binary oder ternary)\n */\n\nimport React from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n  PERMISSION_STRUCTURE,\n  PermissionPage,\n  PermissionBox,\n  PermissionTab,\n  PermissionButton,\n  PermissionOptions,\n  getAccessLevelOptions\n} from '../config/permissionStructure.ts';\nimport { AccessLevel } from '../types/interfaces.ts';\nimport { AccessLevel as NewAccessLevel, convertLegacyAccessLevel } from '../config/permissions.ts';\n\ninterface Permission {\n  entity: string;\n  entityType: string;\n  accessLevel: AccessLevel;\n}\n\ninterface PermissionEditorProps {\n  permissions: Permission[];\n  onChange: (permissions: Permission[]) => void;\n  disabled?: boolean;\n}\n\n// Hilfsfunktion: bersetze Label (falls es ein Standard-Label ist)\nconst translateLabel = (label: string, t: (key: string) => string): string => {\n  // Standard-Button-Labels bersetzen\n  const labelMap: Record<string, string> = {\n    'Erstellen': t('common.create'),\n    'Bearbeiten': t('common.edit'),\n    'Lschen': t('common.delete'),\n    'Starten': t('common.start') || 'Starten',\n    'Stoppen': t('common.stop') || 'Stoppen',\n    'Planen': t('common.plan') || 'Planen',\n    'Client anlegen': t('roles.buttons.client_create') || 'Client anlegen',\n    'Anbieter erstellen': t('roles.buttons.tour_provider_create') || 'Anbieter erstellen',\n    'Anbieter bearbeiten': t('roles.buttons.tour_provider_edit') || 'Anbieter bearbeiten',\n    'Anbieter lschen': t('roles.buttons.tour_provider_delete') || 'Anbieter lschen',\n    'Tour erstellen': t('roles.buttons.tour_create') || 'Tour erstellen',\n    'Tour bearbeiten': t('roles.buttons.tour_edit') || 'Tour bearbeiten',\n    'Tour lschen': t('roles.buttons.tour_delete') || 'Tour lschen',\n    'Tausch-Anfragen': t('common.exchangeRequests') || 'Tausch-Anfragen'\n  };\n  \n  return labelMap[label] || label;\n};\n\n// Hilfsfunktion: Finde Permission fr Entity\nconst findPermission = (permissions: Permission[], entity: string): Permission | undefined => {\n  return permissions.find(p => p.entity === entity);\n};\n\n// Hilfsfunktion: Aktualisiere Permission\nconst updatePermission = (\n  permissions: Permission[],\n  entity: string,\n  entityType: string,\n  newAccessLevel: string\n): Permission[] => {\n  const existingIndex = permissions.findIndex(p => p.entity === entity);\n  \n  if (existingIndex >= 0) {\n    const newPermissions = [...permissions];\n    newPermissions[existingIndex] = {\n      ...newPermissions[existingIndex],\n      accessLevel: newAccessLevel as AccessLevel\n    };\n    return newPermissions;\n  }\n  \n  // Falls nicht vorhanden, hinzufgen\n  return [\n    ...permissions,\n    { entity, entityType, accessLevel: newAccessLevel as AccessLevel }\n  ];\n};\n\n// AccessLevel Dropdown Komponente\nconst AccessLevelDropdown: React.FC<{\n  value: AccessLevel;\n  options: PermissionOptions;\n  onChange: (value: string) => void;\n  disabled?: boolean;\n}> = ({ value, options, onChange, disabled }) => {\n  const { t } = useTranslation();\n  const normalizedValue = convertLegacyAccessLevel(value);\n  const optionValues = getAccessLevelOptions(options);\n  \n  // Normalisiere Wert auf gltige Option\n  const displayValue = optionValues.includes(normalizedValue as any)\n    ? normalizedValue\n    : (normalizedValue === 'own_read' || normalizedValue === 'own_both')\n      ? (optionValues.includes('own_both') ? 'own_both' : 'all_both')\n      : (normalizedValue === 'all_read' || normalizedValue === 'all_both')\n        ? 'all_both'\n        : 'none';\n\n  const getColorClass = (level: string): string => {\n    switch (level) {\n      case 'none': return 'bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400';\n      case 'own_both': return 'bg-orange-100 text-orange-700 dark:bg-orange-900 dark:text-orange-300';\n      case 'all_both': return 'bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300';\n      default: return 'bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400';\n    }\n  };\n\n  return (\n    <select\n      value={displayValue}\n      onChange={(e) => onChange(e.target.value)}\n      disabled={disabled}\n      className={`text-xs px-1.5 py-0.5 ${getColorClass(displayValue)} rounded border-0 cursor-pointer focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed max-w-[90px]`}\n    >\n      {optionValues.map((level) => (\n        <option key={level} value={level}>\n          {t(`roles.accessLevels.${level}`)}\n        </option>\n      ))}\n    </select>\n  );\n};\n\n// Button-Eintrag rendern\nconst ButtonEntry: React.FC<{\n  button: PermissionButton;\n  permissions: Permission[];\n  onChange: (permissions: Permission[]) => void;\n  disabled?: boolean;\n}> = ({ button, permissions, onChange, disabled }) => {\n  const { t } = useTranslation();\n  const perm = findPermission(permissions, button.entity);\n  const currentValue = perm?.accessLevel || 'none';\n\n  return (\n    <div className=\"flex items-center justify-between mt-1 pl-12 border-l-2 border-gray-300 dark:border-gray-600\">\n      <span className=\"text-xs text-gray-600 dark:text-gray-400 truncate mr-2\"> {translateLabel(button.label, t)}</span>\n      <AccessLevelDropdown\n        value={currentValue}\n        options={button.options}\n        onChange={(newValue) => {\n          onChange(updatePermission(permissions, button.entity, 'button', newValue));\n        }}\n        disabled={disabled}\n      />\n    </div>\n  );\n};\n\n// Tab-Eintrag rendern\nconst TabEntry: React.FC<{\n  tab: PermissionTab;\n  permissions: Permission[];\n  onChange: (permissions: Permission[]) => void;\n  disabled?: boolean;\n}> = ({ tab, permissions, onChange, disabled }) => {\n  const { t } = useTranslation();\n  const perm = findPermission(permissions, tab.entity);\n  const currentValue = perm?.accessLevel || 'none';\n\n  return (\n    <div className=\"mt-2\">\n      <div className=\"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600\">\n        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300 truncate mr-2\"> {translateLabel(tab.label, t)}</span>\n        <AccessLevelDropdown\n          value={currentValue}\n          options={tab.options}\n          onChange={(newValue) => {\n            onChange(updatePermission(permissions, tab.entity, 'tab', newValue));\n          }}\n          disabled={disabled}\n        />\n      </div>\n      {tab.buttons?.map((button) => (\n        <ButtonEntry\n          key={button.entity}\n          button={button}\n          permissions={permissions}\n          onChange={onChange}\n          disabled={disabled}\n        />\n      ))}\n    </div>\n  );\n};\n\n// Box-Eintrag rendern\nconst BoxEntry: React.FC<{\n  box: PermissionBox;\n  permissions: Permission[];\n  onChange: (permissions: Permission[]) => void;\n  disabled?: boolean;\n}> = ({ box, permissions, onChange, disabled }) => {\n  const { t } = useTranslation();\n  const perm = findPermission(permissions, box.entity);\n  const currentValue = perm?.accessLevel || 'none';\n\n  return (\n    <div className=\"mt-2\">\n      <div className=\"flex items-center justify-between pl-6 border-l-2 border-purple-300 dark:border-purple-600\">\n        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300 truncate mr-2\"> {translateLabel(box.label, t)}</span>\n        {box.options ? (\n          <AccessLevelDropdown\n            value={currentValue}\n            options={box.options}\n            onChange={(newValue) => {\n              onChange(updatePermission(permissions, box.entity, 'box', newValue));\n            }}\n            disabled={disabled}\n          />\n        ) : (\n          <span className=\"text-xs text-gray-400\">-</span>\n        )}\n      </div>\n      {box.buttons?.map((button) => (\n        <ButtonEntry\n          key={button.entity}\n          button={button}\n          permissions={permissions}\n          onChange={onChange}\n          disabled={disabled}\n        />\n      ))}\n      {box.tabs?.map((tab) => (\n        <TabEntry\n          key={tab.entity}\n          tab={tab}\n          permissions={permissions}\n          onChange={onChange}\n          disabled={disabled}\n        />\n      ))}\n    </div>\n  );\n};\n\n// Page-Eintrag rendern\nconst PageEntry: React.FC<{\n  page: PermissionPage;\n  permissions: Permission[];\n  onChange: (permissions: Permission[]) => void;\n  disabled?: boolean;\n  isExpanded: boolean;\n  onToggle: () => void;\n}> = ({ page, permissions, onChange, disabled, isExpanded, onToggle }) => {\n  const { t } = useTranslation();\n  const perm = findPermission(permissions, page.entity);\n  const currentValue = perm?.accessLevel || 'none';\n  const hasChildren = (page.boxes && page.boxes.length > 0) || (page.tabs && page.tabs.length > 0);\n\n  return (\n    <div className=\"border-b border-gray-200 dark:border-gray-700 pb-3 mb-3\">\n      <div \n        className=\"flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded p-1\"\n        onClick={hasChildren ? onToggle : undefined}\n      >\n        <div className=\"flex items-center gap-2\">\n          {hasChildren && (\n            <span className={`text-gray-400 transform transition-transform ${isExpanded ? 'rotate-90' : ''}`}>\n              \n            </span>\n          )}\n          <span className=\"text-sm font-semibold text-gray-900 dark:text-gray-100\">{translateLabel(page.label, t)}</span>\n        </div>\n        <AccessLevelDropdown\n          value={currentValue}\n          options={page.options}\n          onChange={(newValue) => {\n            onChange(updatePermission(permissions, page.entity, 'page', newValue));\n          }}\n          disabled={disabled}\n        />\n      </div>\n      \n      {isExpanded && hasChildren && (\n        <div className=\"mt-2 ml-4\">\n          {page.boxes?.map((box) => (\n            <BoxEntry\n              key={box.entity}\n              box={box}\n              permissions={permissions}\n              onChange={onChange}\n              disabled={disabled}\n            />\n          ))}\n          {page.tabs?.map((tab) => (\n            <TabEntry\n              key={tab.entity}\n              tab={tab}\n              permissions={permissions}\n              onChange={onChange}\n              disabled={disabled}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\n// Hauptkomponente\nconst PermissionEditor: React.FC<PermissionEditorProps> = ({\n  permissions,\n  onChange,\n  disabled = false\n}) => {\n  const { t } = useTranslation();\n  const [expandedPages, setExpandedPages] = React.useState<Set<string>>(new Set());\n\n  const togglePage = (pageEntity: string) => {\n    const newExpanded = new Set(expandedPages);\n    if (newExpanded.has(pageEntity)) {\n      newExpanded.delete(pageEntity);\n    } else {\n      newExpanded.add(pageEntity);\n    }\n    setExpandedPages(newExpanded);\n  };\n\n  const expandAll = () => {\n    setExpandedPages(new Set(PERMISSION_STRUCTURE.map(p => p.entity)));\n  };\n\n  const collapseAll = () => {\n    setExpandedPages(new Set());\n  };\n\n  // Setze alle Permissions auf einen Wert\n  const setAllTo = (value: string) => {\n    let newPermissions = [...permissions];\n    PERMISSION_STRUCTURE.forEach(page => {\n      newPermissions = updatePermission(newPermissions, page.entity, 'page', value);\n      page.boxes?.forEach(box => {\n        if (box.options) {\n          newPermissions = updatePermission(newPermissions, box.entity, 'box', value);\n        }\n        box.buttons?.forEach(button => {\n          newPermissions = updatePermission(newPermissions, button.entity, 'button', value);\n        });\n        box.tabs?.forEach(tab => {\n          newPermissions = updatePermission(newPermissions, tab.entity, 'tab', value);\n          tab.buttons?.forEach(button => {\n            newPermissions = updatePermission(newPermissions, button.entity, 'button', value);\n          });\n        });\n      });\n      page.tabs?.forEach(tab => {\n        newPermissions = updatePermission(newPermissions, tab.entity, 'tab', value);\n        tab.buttons?.forEach(button => {\n          newPermissions = updatePermission(newPermissions, button.entity, 'button', value);\n        });\n      });\n    });\n    onChange(newPermissions);\n  };\n\n  return (\n    <div className=\"space-y-2\">\n      {/* Quick Actions */}\n      <div className=\"flex flex-wrap gap-2 mb-4\">\n        <button\n          type=\"button\"\n          onClick={expandAll}\n          className=\"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200\"\n        >\n          {t('common.expandAll') || 'Alle aufklappen'}\n        </button>\n        <button\n          type=\"button\"\n          onClick={collapseAll}\n          className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200\"\n        >\n          {t('common.collapseAll') || 'Alle zuklappen'}\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => setAllTo('all_both')}\n          className=\"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200\"\n        >\n          {t('roles.form.setAllToYes')}\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => setAllTo('none')}\n          className=\"px-2 py-1 text-xs bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded hover:bg-red-200\"\n        >\n          {t('roles.form.setAllToNo')}\n        </button>\n      </div>\n\n      {/* Permission Structure */}\n      <div className=\"border rounded-lg p-4 dark:border-gray-600 max-h-[400px] overflow-y-auto\">\n        {PERMISSION_STRUCTURE.map((page) => (\n          <PageEntry\n            key={page.entity}\n            page={page}\n            permissions={permissions}\n            onChange={onChange}\n            disabled={disabled}\n            isExpanded={expandedPages.has(page.entity)}\n            onToggle={() => togglePage(page.entity)}\n          />\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default PermissionEditor;\n","import React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { roleApi, branchApi } from '../api/apiClient.ts';\nimport { Role, AccessLevel } from '../types/interfaces.ts';\nimport { PencilIcon, TrashIcon, PlusIcon, FunnelIcon, XMarkIcon, CheckIcon, ArrowPathIcon, DocumentDuplicateIcon, ChevronDownIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { useFilterContext } from '../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { ErrorCategory } from '../services/ErrorHandler.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport { logger } from '../utils/logger.ts';\nimport { \n  AccessLevel as NewAccessLevel, \n  AccessLevelValues,\n  convertLegacyAccessLevel\n} from '../config/permissions.ts';\nimport {\n  PERMISSION_STRUCTURE,\n  PermissionPage,\n  PermissionBox,\n  PermissionTab,\n  PermissionButton,\n  PermissionOptions,\n  getAllEntities,\n  getAccessLevelOptions,\n  initializePermissions\n} from '../config/permissionStructure.ts';\nimport PermissionEditor from './PermissionEditor.tsx';\n\n// AccessLevel-Optionen fr Dropdowns (sortiert nach Berechtigung)\nconst ACCESS_LEVEL_OPTIONS: NewAccessLevel[] = ['none', 'own_read', 'own_both', 'all_read', 'all_both'];\n\ninterface RoleManagementTabProps {\n  onRolesChange?: () => void;\n  onError?: (error: string) => void;\n  readOnly?: boolean;\n}\n\n// Definiere Seiten, die immer sichtbar sein sollen (ohne Berechtigungsprfung)\nconst alwaysVisiblePages = ['dashboard', 'worktracker', 'cerebro', 'settings', 'profile'];\n\n// ALLE SEITEN IM SYSTEM (synchron mit Backend)\nconst defaultPages = [\n  'dashboard',\n  'worktracker',\n  'consultations',\n  'team_worktime_control', // = workcenter\n  'payroll', // = lohnabrechnung\n  'organization_management', // = organisation (Hauptseite)\n  'cerebro',\n  'settings',\n  'profile',\n  'tour_management', // NEU: Touren-Verwaltung\n  'password_manager', // NEU: Passwort-Manager\n  'price_analysis' // NEU: Preisanalyse\n];\n\n// ALLE TABELLEN IM SYSTEM (synchron mit Backend)\nconst defaultTables = [\n  'requests',           // auf dashboard\n  'tasks',             // auf worktracker\n  'reservations',      // auf worktracker (in To Do's Box)\n  'users',             // auf organization_management\n  'roles',             // auf organization_management\n  'organization',      // auf organization_management\n  'organization_join_requests', // auf organization_management\n  'organization_users',  // auf organization_management\n  'team_worktime',     // auf team_worktime_control\n  'worktime',          // auf worktracker\n  'clients',           // auf consultations\n  'consultation_invoices', // auf consultations\n  'branches',          // auf settings/system\n  'notifications',     // allgemein\n  'settings',          // auf settings\n  'monthly_reports',    // auf consultations/reports\n  'tours',             // NEU: auf tour_management\n  'tour_bookings',     // NEU: auf tour_management\n  'ota_listings',      // NEU: auf price_analysis\n  'price_analyses',    // NEU: auf price_analysis\n  'price_recommendations', // NEU: auf price_analysis\n  'pricing_rules',     // NEU: auf price_analysis\n  'rate_shopping_jobs' // NEU: auf price_analysis\n];\n\n// ALLE BUTTONS IM SYSTEM (synchron mit Backend)\nconst defaultButtons = [\n  // Database Management Buttons (Settings/System)\n  'database_reset_table',\n  'database_logs',\n  \n  // Invoice Functions Buttons\n  'invoice_create',\n  'invoice_download', \n  'invoice_mark_paid',\n  'invoice_settings',\n  \n  // Todo/Task Buttons (Worktracker)\n  'todo_create',\n  'todo_edit',\n  'todo_delete',\n  'task_create',\n  'task_edit', \n  'task_delete',\n  \n  // User Management Buttons\n  'user_create',\n  'user_edit',\n  'user_delete',\n  'role_assign',\n  'role_create',\n  'role_edit',\n  'role_delete',\n  \n  // Organization Management Buttons\n  'organization_create',\n  'organization_edit',\n  'organization_delete',\n  \n  // Worktime Buttons\n  'worktime_start',\n  'worktime_stop', \n  'worktime_edit',\n  'worktime_delete',\n  \n  // General Cerebro Button\n  'cerebro',\n  \n  // Consultation Buttons\n  'consultation_start',\n  'consultation_stop',\n  'consultation_edit',\n  \n  // Client Management Buttons\n  'client_create',\n  'client_edit',\n  'client_delete',\n  \n  // Settings Buttons\n  'settings_system',\n  'settings_notifications',\n  'settings_profile',\n  \n  // Payroll Buttons\n  'payroll_generate',\n  'payroll_export',\n  'payroll_edit',\n  \n  // Tour Management Buttons\n  'tour_create',\n  'tour_edit',\n  'tour_delete',\n  'tour_view',\n  'tour_booking_create',\n  'tour_booking_edit',\n  'tour_booking_cancel',\n  'tour_provider_create',\n  'tour_provider_edit',\n  'tour_provider_delete',\n  \n  // Password Manager Buttons\n  'password_entry_create',\n  'password_entry_edit',\n  'password_entry_delete',\n  \n  // Price Analysis Buttons\n  'price_analysis_create_rule',\n  'price_analysis_edit_rule',\n  'price_analysis_delete_rule',\n  'price_analysis_apply_recommendation',\n  'price_analysis_reject_recommendation',\n  'price_analysis_run_rate_shopping'\n];\n\n// Definiert die Zuordnung von Tabellen zu ihren bergeordneten Seiten\nconst tableToPageMapping = {\n  'requests': 'dashboard',\n  'tasks': 'worktracker',\n  'reservations': 'worktracker',\n  'users': 'organization_management',\n  'roles': 'organization_management',\n  'organization': 'organization_management',\n  'organization_join_requests': 'organization_management',\n  'organization_users': 'organization_management',\n  'team_worktime': 'team_worktime_control',\n  'worktime': 'worktracker',\n  'clients': 'consultations',\n  'consultation_invoices': 'consultations',\n  'branches': 'settings',\n  'notifications': 'general',\n  'settings': 'settings',\n  'monthly_reports': 'consultations',\n  'tours': 'tour_management',\n  'tour_bookings': 'tour_management',\n  'ota_listings': 'price_analysis',\n  'price_analyses': 'price_analysis',\n  'price_recommendations': 'price_analysis',\n  'pricing_rules': 'price_analysis',\n  'rate_shopping_jobs': 'price_analysis'\n};\n\n// Definiert die Zuordnung von Buttons zu ihren bergeordneten Seiten/Bereichen\nconst buttonToPageMapping = {\n  'database_reset_table': 'settings',\n  'database_logs': 'settings',\n  'invoice_create': 'consultations',\n  'invoice_download': 'consultations',\n  'invoice_mark_paid': 'consultations',\n  'invoice_settings': 'consultations',\n  'todo_create': 'worktracker',\n  'todo_edit': 'worktracker',\n  'todo_delete': 'worktracker',\n  'task_create': 'worktracker',\n  'task_edit': 'worktracker',\n  'task_delete': 'worktracker',\n  'user_create': 'organization_management',\n  'user_edit': 'organization_management',\n  'user_delete': 'organization_management',\n  'role_assign': 'organization_management',\n  'role_create': 'organization_management',\n  'role_edit': 'organization_management',\n  'role_delete': 'organization_management',\n  'organization_create': 'organization_management',\n  'organization_edit': 'organization_management',\n  'organization_delete': 'organization_management',\n  'worktime_start': 'worktracker',\n  'worktime_stop': 'worktracker',\n  'worktime_edit': 'worktracker',\n  'worktime_delete': 'worktracker',\n  'cerebro': 'cerebro',\n  'consultation_start': 'consultations',\n  'consultation_stop': 'consultations',\n  'consultation_edit': 'consultations',\n  'client_create': 'consultations',\n  'client_edit': 'consultations',\n  'client_delete': 'consultations',\n  'settings_system': 'settings',\n  'settings_notifications': 'settings',\n  'settings_profile': 'settings',\n  'payroll_generate': 'payroll',\n  'payroll_export': 'payroll',\n  'payroll_edit': 'payroll',\n  'tour_create': 'tour_management',\n  'tour_edit': 'tour_management',\n  'tour_delete': 'tour_management',\n  'tour_view': 'tour_management',\n  'tour_booking_create': 'tour_management',\n  'tour_booking_edit': 'tour_management',\n  'tour_booking_cancel': 'tour_management',\n  'tour_provider_create': 'tour_management',\n  'tour_provider_edit': 'tour_management',\n  'tour_provider_delete': 'tour_management',\n  'password_entry_create': 'password_manager',\n  'password_entry_edit': 'password_manager',\n  'password_entry_delete': 'password_manager',\n  'price_analysis_create_rule': 'price_analysis',\n  'price_analysis_edit_rule': 'price_analysis',\n  'price_analysis_delete_rule': 'price_analysis',\n  'price_analysis_apply_recommendation': 'price_analysis',\n  'price_analysis_reject_recommendation': 'price_analysis',\n  'price_analysis_run_rate_shopping': 'price_analysis'\n};\n\n// Definiert die Zuordnung von Buttons zu ihren zugehrigen Tabellen\nconst buttonToTableMapping: Record<string, string | null> = {\n  // Worktime Buttons  worktime Tabelle\n  'worktime_start': 'worktime',\n  'worktime_stop': 'worktime',\n  'worktime_edit': 'worktime',\n  'worktime_delete': 'worktime',\n  // Task/Todo Buttons  tasks Tabelle\n  'task_create': 'tasks',\n  'task_edit': 'tasks',\n  'task_delete': 'tasks',\n  'todo_create': 'tasks',\n  'todo_edit': 'tasks',\n  'todo_delete': 'tasks',\n  // Client Buttons  clients Tabelle\n  'client_create': 'clients',\n  'client_edit': 'clients',\n  'client_delete': 'clients',\n  'consultation_start': 'clients',\n  'consultation_stop': 'clients',\n  'consultation_edit': 'clients',\n  // Invoice Buttons  consultation_invoices Tabelle\n  'invoice_create': 'consultation_invoices',\n  'invoice_download': 'consultation_invoices',\n  'invoice_mark_paid': 'consultation_invoices',\n  'invoice_settings': 'consultation_invoices',\n  // User Management Buttons  users/roles Tabellen\n  'user_create': 'users',\n  'user_edit': 'users',\n  'user_delete': 'users',\n  'role_assign': 'roles',\n  'role_create': 'roles',\n  'role_edit': 'roles',\n  'role_delete': 'roles',\n  // Organization Management Buttons  organization Tabelle\n  'organization_create': 'organization',\n  'organization_edit': 'organization',\n  'organization_delete': 'organization',\n  // Settings Buttons  settings Tabelle\n  'settings_system': 'settings',\n  'settings_notifications': 'settings',\n  'settings_profile': 'settings',\n  // Tour Management Buttons  tours/tour_bookings Tabellen\n  'tour_create': 'tours',\n  'tour_edit': 'tours',\n  'tour_delete': 'tours',\n  'tour_view': 'tours',\n  'tour_booking_create': 'tour_bookings',\n  'tour_booking_edit': 'tour_bookings',\n  'tour_booking_cancel': 'tour_bookings',\n  'tour_provider_create': null, // Keine direkte Tabelle\n  'tour_provider_edit': null,\n  'tour_provider_delete': null,\n  // Password Manager Buttons  keine direkte Tabelle (entry-level permissions)\n  'password_entry_create': null,\n  'password_entry_edit': null,\n  'password_entry_delete': null,\n  // Price Analysis Buttons  entsprechende Tabellen\n  'price_analysis_create_rule': 'pricing_rules',\n  'price_analysis_edit_rule': 'pricing_rules',\n  'price_analysis_delete_rule': 'pricing_rules',\n  'price_analysis_apply_recommendation': 'price_recommendations',\n  'price_analysis_reject_recommendation': 'price_recommendations',\n  'price_analysis_run_rate_shopping': 'rate_shopping_jobs',\n  // Buttons ohne direkte Tabelle-Zuordnung\n  'database_reset_table': null,\n  'database_logs': null,\n  'cerebro': null,\n  'payroll_generate': null,\n  'payroll_export': null,\n  'payroll_edit': null\n};\n\n// Display-Name-Mapping fr Seiten (DB-Interne Bezeichnung  Frontend-Bezeichnung)\n// Wird dynamisch aus bersetzungen geladen\n\n// Display-Name-Mapping fr Tabellen (DB-Interne Bezeichnung  Frontend-Bezeichnung)\n// Wird dynamisch aus bersetzungen geladen\n\n// Display-Name-Mapping fr Buttons wird dynamisch in der Komponente geladen\n\n// TableID fr gespeicherte Filter\nconst ROLES_TABLE_ID = 'roles-table';\n\n// ============================================\n// ACCESS LEVEL DROPDOWN KOMPONENTE\n// ============================================\ninterface AccessLevelSelectProps {\n  value: AccessLevel;\n  onChange: (newValue: NewAccessLevel) => void;\n  disabled?: boolean;\n  size?: 'sm' | 'md';\n  t: (key: string) => string;\n  permOptions: PermissionOptions; // 'binary' = ja/nein, 'ternary' = alle/eigene/nein\n}\n\nconst AccessLevelSelect: React.FC<AccessLevelSelectProps> = ({ \n  value, \n  onChange, \n  disabled = false,\n  size = 'md',\n  t,\n  permOptions\n}) => {\n  // Konvertiere Legacy-Werte zu neuen Werten\n  const normalizedValue = convertLegacyAccessLevel(value);\n  \n  // Hole Optionen basierend auf PermissionOptions\n  const options = getAccessLevelOptions(permOptions) as NewAccessLevel[];\n  \n  // Normalisiere den Wert auf gltige Option\n  const displayValue = options.includes(normalizedValue) \n    ? normalizedValue \n    : (normalizedValue === 'own_read' || normalizedValue === 'own_both') \n      ? (options.includes('own_both' as NewAccessLevel) ? 'own_both' : 'all_both')\n      : (normalizedValue === 'all_read' || normalizedValue === 'all_both')\n        ? 'all_both'\n        : 'none';\n  \n  // Farbe basierend auf AccessLevel\n  const getColorClass = (level: NewAccessLevel): string => {\n    switch (level) {\n      case 'none': return 'bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400';\n      case 'own_both': return 'bg-orange-100 text-orange-700 dark:bg-orange-900 dark:text-orange-300';\n      case 'all_both': return 'bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300';\n      default: return 'bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400';\n    }\n  };\n\n  const sizeClasses = size === 'sm' \n    ? 'text-xs px-1.5 py-0.5' \n    : 'text-sm px-2 py-1';\n\n  return (\n    <select\n      value={displayValue}\n      onChange={(e) => onChange(e.target.value as NewAccessLevel)}\n      disabled={disabled}\n      className={`${sizeClasses} ${getColorClass(displayValue as NewAccessLevel)} rounded border-0 cursor-pointer focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed max-w-[100px]`}\n    >\n      {options.map((level) => (\n        <option key={level} value={level}>\n          {t(`roles.accessLevels.${level}`)}\n        </option>\n      ))}\n    </select>\n  );\n};\n\n// Standardrollen-IDs (fr Rollen ohne Organisation)\nconst STANDARD_ROLE_IDS = [1, 2, 999]; // Admin (1), User (2), Hamburger (999)\n\n// Standardrollen-Namen (drfen nicht bearbeitet/gelscht werden, egal von welcher Organisation)\nconst STANDARD_ROLE_NAMES = ['Admin', 'User', 'Hamburger'];\n\n// Helper-Funktion zur Prfung ob es sich um eine Standardrolle handelt\nconst isStandardRole = (roleId: number, roleName?: string): boolean => {\n  // Prfe zuerst auf Standard-IDs (fr Rollen ohne Organisation)\n  if (STANDARD_ROLE_IDS.includes(roleId)) {\n    return true;\n  }\n  // Prfe auf Standard-Namen (fr Rollen in Organisationen)\n  if (roleName && STANDARD_ROLE_NAMES.includes(roleName)) {\n    return true;\n  }\n  return false;\n};\n\ninterface RoleFormData {\n  name: string;\n  description: string;\n  permissions: {\n    entity: string;\n    entityType: string;\n    accessLevel: AccessLevel;\n  }[];\n}\n\n\n// RoleCard-Komponente fr mobile Ansicht\nconst RoleCard: React.FC<{\n  role: Role;\n  onEdit: (role: Role) => void;\n  onDelete: (roleId: number) => void;\n  onCopy: (role: Role) => void;\n  canEdit: boolean;\n  canDelete: boolean;\n  canCopy: boolean;\n}> = ({ role, onEdit, onDelete, onCopy, canEdit, canDelete, canCopy }) => {\n  const { t } = useTranslation();\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4 mb-4\">\n      {/* Header mit Rollenname und Aktionen */}\n      <div className=\"flex justify-between items-start mb-2\">\n        <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{role.name}</h3>\n        \n        <div className=\"flex space-x-2\">\n          {canCopy && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => onCopy(role)}\n                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n              >\n                <DocumentDuplicateIcon className=\"h-5 w-5\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('roles.actions.copy')}\n              </div>\n            </div>\n          )}\n          \n          {canEdit && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => onEdit(role)}\n                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n              >\n                <PencilIcon className=\"h-5 w-5\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('roles.actions.edit')}\n              </div>\n            </div>\n          )}\n          \n          {canDelete && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => onDelete(role.id)}\n                className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n              >\n                <TrashIcon className=\"h-5 w-5\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('roles.actions.delete')}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n      \n      {/* Beschreibung */}\n      <p className=\"text-sm text-gray-600 dark:text-gray-400\">{role.description || t('roles.noDescription')}</p>\n      \n      {/* Branch-Zuweisungen */}\n      <div className=\"mt-2\">\n        <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n          {role.allBranches ? (\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300\">\n              {t('roles.form.allBranches') || 'Alle Branches'}\n            </span>\n          ) : role.branches && role.branches.length > 0 ? (\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300\">\n              {role.branches.length} {t('roles.form.specificBranches') || 'Branches'}\n            </span>\n          ) : (\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400\">\n              {t('roles.form.noBranches') || 'Keine Branches'}\n            </span>\n          )}\n        </span>\n      </div>\n      \n      {/* Berechtigungen - kompakt */}\n      <div className=\"mt-2\">\n        <h4 className=\"text-sm font-medium text-gray-900 dark:text-white mb-1\">{t('roles.permissions')}:</h4>\n        <div className=\"flex flex-wrap gap-1\">\n          {role.permissions\n            .filter(perm => perm.accessLevel !== 'none') // Nur relevante Berechtigungen anzeigen\n            .slice(0, 8) // Begrenze die Anzahl der angezeigten Berechtigungen\n            .map(permission => (\n              <span \n                key={`${permission.entity}-${permission.entityType}`}\n                className=\"text-xs bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 px-2 py-1 rounded\"\n              >\n                {permission.entity}: {permission.accessLevel}\n              </span>\n            ))}\n          {role.permissions.filter(perm => perm.accessLevel !== 'none').length > 8 && (\n            <span className=\"text-xs bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-300 px-2 py-1 rounded\">\n                +{role.permissions.filter(perm => perm.accessLevel !== 'none').length - 8} {t('common.showMore')}\n            </span>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst RoleManagementTab: React.FC<RoleManagementTabProps> = ({ onRolesChange, onError, readOnly = false }) => {\n  const { t } = useTranslation();\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [editingRole, setEditingRole] = useState<Role | null>(null);\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loading, setLoading] = useState(true);\n  \n  // Display-Name-Mapping fr Seiten (dynamisch aus bersetzungen)\n  const pageDisplayNames = useMemo(() => ({\n    'dashboard': t('roles.pages.dashboard'),\n    'worktracker': t('roles.pages.worktracker'),\n    'consultations': t('roles.pages.consultations'),\n    'team_worktime_control': t('roles.pages.team_worktime_control'),\n    'payroll': t('roles.pages.payroll'),\n    'organization_management': t('roles.pages.organization_management'), // Organisation-Seite (Hauptseite)\n    'cerebro': t('roles.pages.cerebro'),\n    'settings': t('roles.pages.settings'),\n    'profile': t('roles.pages.profile'),\n    'tour_management': t('roles.pages.tour_management', 'Touren-Verwaltung'),\n    'password_manager': t('roles.pages.password_manager', 'Passwort-Manager')\n  }), [t]);\n\n  // Display-Name-Mapping fr Tabellen (dynamisch aus bersetzungen)\n  const tableDisplayNames = useMemo(() => ({\n    'tasks': t('roles.tables.tasks'),\n    'reservations': t('roles.tables.reservations'),\n    'worktime': t('roles.tables.worktime'),\n    'users': t('roles.tables.users'),\n    'roles': t('roles.tables.roles'),\n    'organization': t('roles.tables.organization'),\n    'organization_join_requests': t('roles.tables.organization_join_requests'),\n    'organization_users': t('roles.tables.organization_users'),\n    'clients': t('roles.tables.clients'),\n    'consultation_invoices': t('roles.tables.consultation_invoices'),\n    'requests': t('roles.tables.requests'),\n    'team_worktime': t('roles.tables.team_worktime'),\n    'settings': t('roles.tables.settings'),\n    'notifications': t('roles.tables.notifications'),\n    'branches': t('roles.tables.branches'),\n    'monthly_reports': t('roles.tables.monthly_reports'),\n    'tours': t('roles.tables.tours', 'Touren'),\n    'tour_bookings': t('roles.tables.tour_bookings', 'Tour-Buchungen')\n  }), [t]);\n\n  // Display-Name-Mapping fr Buttons (dynamisch aus bersetzungen)\n  const buttonDisplayNames = useMemo(() => ({\n    'worktime_start': t('roles.buttons.worktime_start'),\n    'worktime_stop': t('roles.buttons.worktime_stop'),\n    'worktime_edit': t('roles.buttons.worktime_edit'),\n    'worktime_delete': t('roles.buttons.worktime_delete'),\n    'task_create': t('roles.buttons.task_create'),\n    'task_edit': t('roles.buttons.task_edit'),\n    'task_delete': t('roles.buttons.task_delete'),\n    'todo_create': t('roles.buttons.todo_create'),\n    'todo_edit': t('roles.buttons.todo_edit'),\n    'todo_delete': t('roles.buttons.todo_delete'),\n    'client_create': t('roles.buttons.client_create'),\n    'client_edit': t('roles.buttons.client_edit'),\n    'client_delete': t('roles.buttons.client_delete'),\n    'consultation_start': t('roles.buttons.consultation_start'),\n    'consultation_stop': t('roles.buttons.consultation_stop'),\n    'consultation_edit': t('roles.buttons.consultation_edit'),\n    'invoice_create': t('roles.buttons.invoice_create'),\n    'invoice_download': t('roles.buttons.invoice_download'),\n    'invoice_mark_paid': t('roles.buttons.invoice_mark_paid'),\n    'invoice_settings': t('roles.buttons.invoice_settings'),\n    'user_create': t('roles.buttons.user_create'),\n    'user_edit': t('roles.buttons.user_edit'),\n    'user_delete': t('roles.buttons.user_delete'),\n    'role_assign': t('roles.buttons.role_assign'),\n    'role_create': t('roles.buttons.role_create'),\n    'role_edit': t('roles.buttons.role_edit'),\n    'role_delete': t('roles.buttons.role_delete'),\n    'organization_create': t('roles.buttons.organization_create'),\n    'organization_edit': t('roles.buttons.organization_edit'),\n    'organization_delete': t('roles.buttons.organization_delete'),\n    'settings_system': t('roles.buttons.settings_system'),\n    'settings_notifications': t('roles.buttons.settings_notifications'),\n    'settings_profile': t('roles.buttons.settings_profile'),\n    'database_reset_table': t('roles.buttons.database_reset_table'),\n    'database_logs': t('roles.buttons.database_logs'),\n    'payroll_generate': t('roles.buttons.payroll_generate'),\n    'payroll_export': t('roles.buttons.payroll_export'),\n    'payroll_edit': t('roles.buttons.payroll_edit'),\n    'cerebro': t('roles.buttons.cerebro')\n  }), [t]);\n  const [formData, setFormData] = useState<RoleFormData>({\n    name: '',\n    description: '',\n    permissions: [\n      // Seiten-Berechtigungen\n      ...defaultPages.map(page => ({\n        entity: page,\n        entityType: 'page',\n        accessLevel: 'none' as AccessLevel\n      })),\n      // Tabellen-Berechtigungen\n      ...defaultTables.map(table => ({\n        entity: table,\n        entityType: 'table',\n        accessLevel: 'none' as AccessLevel\n      })),\n      // Button-Berechtigungen\n      ...defaultButtons.map(button => ({\n        entity: button,\n        entityType: 'button',\n        accessLevel: 'none' as AccessLevel\n      }))\n    ]\n  });\n  const [error, setError] = useState<string | null>(null);\n  const { hasPermission } = usePermissions();\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n  \n  // States fr Branch-Zuweisungen\n  const [allBranches, setAllBranches] = useState<boolean>(true);\n  const [selectedBranchIds, setSelectedBranchIds] = useState<number[]>([]);\n  const [branches, setBranches] = useState<Array<{ id: number; name: string }>>([]);\n  const [loadingBranches, setLoadingBranches] = useState(false);\n  \n  // Neue State-Variablen fr erweiterte Filterbedingungen\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  // Responsiveness Hook (640px wie Standard)\n  const [isMobile, setIsMobile] = useState<boolean>(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  \n  // Fehlerbehandlung mit Fallback - useRef fr stabile onError-Referenz\n  const onErrorRef = useRef(onError);\n  useEffect(() => {\n    onErrorRef.current = onError;\n  }, [onError]);\n\n  const errorContext = useError();\n  const handleError = useCallback((err: any, context?: Record<string, any>) => {\n    if (errorContext?.handleError) {\n      errorContext.handleError(err, context);\n    } else {\n      console.error('Fehler:', err, context);\n      if (onErrorRef.current) {\n        onErrorRef.current(err?.message || 'Ein Fehler ist aufgetreten');\n      }\n    }\n  }, [errorContext]);\n\n  const handleValidationError = useCallback((message: string, fieldErrors?: Record<string, string>) => {\n    if (errorContext?.handleValidationError) {\n      errorContext.handleValidationError(message, fieldErrors);\n    } else {\n      console.error('Validierungsfehler:', message, fieldErrors);\n      if (onErrorRef.current) {\n        onErrorRef.current(message);\n      }\n    }\n  }, [errorContext]);\n  \n  // Neue State-Variablen fr die Berechtigungen\n  const [isAddPermissionModalOpen, setIsAddPermissionModalOpen] = useState(false);\n  const [selectedPermission, setSelectedPermission] = useState<string | null>(null);\n  const [displayLimit, setDisplayLimit] = useState<number>(10);\n  \n  // berwache Bildschirmgre\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isModalOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isModalOpen, openSidepane, closeSidepane]);\n\n  // Funktion zum Laden der Branches\n  const fetchBranches = useCallback(async () => {\n    setLoadingBranches(true);\n    try {\n      const response = await branchApi.getAll();\n      setBranches(response.data);\n    } catch (error) {\n      console.error('Fehler beim Laden der Branches:', error);\n    } finally {\n      setLoadingBranches(false);\n    }\n  }, []);\n\n  // Aktualisiere die fetchRoles-Funktion, um den neuen ErrorHandler zu nutzen\n  const fetchRoles = useCallback(async () => {\n    setLoading(true);\n    logger.log('DEBUGAUSGABE: Hole Rollen vom Server...');\n    \n    try {\n      const response = await roleApi.getAll();\n      logger.log('DEBUGAUSGABE: Rollen erfolgreich geholt:', response.data);\n      setRoles(response.data);\n      setError(null);\n    } catch (error) {\n      console.error('DEBUGAUSGABE: Fehler beim Abrufen der Rollen:', error);\n      // Nutze den neuen ErrorHandler\n      handleError(error, { \n        component: 'RoleManagementTab', \n        action: 'fetchRoles' \n      });\n      // Rufe auch den bergebenen onError auf, falls vorhanden\n      if (onError) {\n        onError('Fehler beim Laden der Rollen');\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [handleError]);\n\n  //  ENTFERNT: Direkt Rollen laden - wird jetzt durch Standard-Pattern gemacht (nach Default-Filter-Anwendung)\n\n  // Branches beim ffnen des Modals laden\n  useEffect(() => {\n    if (isModalOpen) {\n      fetchBranches();\n    }\n  }, [isModalOpen, fetchBranches]);\n\n  // Speichern einer Rolle\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n\n    // Validierung: Wenn allBranches = false, mssen Branches ausgewhlt sein\n    if (!allBranches && selectedBranchIds.length === 0) {\n      handleError(t('roles.form.branchSelectionRequired') || 'Bitte whlen Sie mindestens eine Branch aus oder aktivieren Sie \"Fr alle Branches gltig\"', {\n        component: 'RoleManagementTab'\n      });\n      return;\n    }\n    \n    if (!formData.name) {\n      handleValidationError('Rollenname darf nicht leer sein', { name: 'Rollenname ist erforderlich' });\n      return;\n    }\n    \n    if (editingRole) {\n      // Stelle sicher, dass die immer sichtbaren Seiten auch tatschlich auf 'both' gesetzt sind\n      const updatedPermissions = formData.permissions.map(permission => {\n        if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n          return { ...permission, accessLevel: 'both' };\n        }\n        return permission;\n      });\n      \n      // Filtere nur die relevanten Berechtigungen (nicht 'none')\n      const filteredPermissions = updatedPermissions\n        .filter(permission => permission.accessLevel !== 'none')\n        .map(permission => ({\n          entity: permission.entity,\n          entityType: permission.entityType,\n          accessLevel: permission.accessLevel\n        }));\n      \n      if (!editingRole.id || isNaN(editingRole.id)) {\n        console.warn('DEBUGAUSGABE: Ungltige Rollen-ID erkannt, Bearbeitung abgebrochen');\n        handleError('Ungltige Rollen-ID, Bearbeitung abgebrochen', { \n          component: 'RoleManagementTab',\n          roleId: editingRole.id\n        });\n        return;\n      }\n      \n      // berprfen, ob es sich um eine geschtzte Rolle handelt\n      if (isStandardRole(editingRole.id, editingRole.name)) {\n        console.warn(`DEBUGAUSGABE: Versuch, geschtzte Rolle mit ID ${editingRole.id} zu bearbeiten`);\n        handleError({\n          message: 'Geschtzte Systemrollen knnen nicht bearbeitet werden',\n          name: 'PermissionError'\n        }, {\n          component: 'RoleManagementTab',\n          roleId: editingRole.id,\n          category: ErrorCategory.PERMISSION\n        });\n        setIsModalOpen(false);\n        return;\n      }\n      \n      // berprfen, ob die Rolle noch in der aktuellen Liste existiert\n      const roleExists = roles.some(r => r.id === editingRole.id);\n      if (!roleExists) {\n        console.error(`DEBUGAUSGABE: Rolle mit ID ${editingRole.id} existiert nicht in der aktuellen Liste`);\n        handleError(`Rolle mit ID ${editingRole.id} existiert nicht mehr. Bitte aktualisieren Sie die Seite.`, {\n          component: 'RoleManagementTab',\n          roleId: editingRole.id\n        });\n        setIsModalOpen(false);\n        // Rollen neu laden, um die Anzeige zu aktualisieren\n        await fetchRoles();\n        return;\n      }\n      \n      logger.log(`DEBUGAUSGABE: Bearbeite Rolle mit ID ${editingRole.id}`);\n      \n      try {\n        logger.log('DEBUGAUSGABE: Sende Aktualisierung an API:', {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        });\n        \n        const dataToSend = {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions,\n          allBranches: allBranches,\n          branchIds: allBranches ? [] : selectedBranchIds\n        };\n        \n        logger.log('DEBUGAUSGABE: Vor dem API-Aufruf roleApi.update');\n        const response = await roleApi.update(editingRole.id, dataToSend);\n        logger.log('DEBUGAUSGABE: Nach dem API-Aufruf roleApi.update');\n        logger.log('DEBUGAUSGABE: API-Antwort bei Rollenaktualisierung:', response);\n        await fetchRoles();\n      } catch (updateError) {\n        console.error('DEBUGAUSGABE: Fehler bei Rollenaktualisierung:', updateError);\n        if (updateError.response) {\n          // Spezifischere Fehlerbehandlung\n          if (updateError.response.data.meta && updateError.response.data.meta.cause === \"Record to update not found.\") {\n            handleError('Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.', {\n              component: 'RoleManagementTab',\n              roleId: editingRole.id\n            });\n            setIsModalOpen(false);\n            // Rollenliste aktualisieren, um Frontend zu synchronisieren\n            await fetchRoles();\n          } else {\n            handleError(updateError.response.data.message || 'Fehler beim Aktualisieren der Rolle', {\n              component: 'RoleManagementTab',\n              roleId: editingRole.id\n            });\n          }\n        } else {\n          handleError('Fehler beim Aktualisieren der Rolle', {\n            component: 'RoleManagementTab',\n            roleId: editingRole.id\n          });\n        }\n        return;\n      }\n    } else {\n      // Erstellen einer neuen Rolle\n      try {\n        // Stelle sicher, dass die immer sichtbaren Seiten auch tatschlich auf 'both' gesetzt sind\n        const updatedPermissions = formData.permissions.map(permission => {\n          if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n            return { ...permission, accessLevel: 'both' };\n          }\n          return permission;\n        });\n        \n        // Filtere nur die relevanten Berechtigungen (nicht 'none')\n        const filteredPermissions = updatedPermissions\n          .filter(permission => permission.accessLevel !== 'none')\n          .map(permission => ({\n            entity: permission.entity,\n            entityType: permission.entityType,\n            accessLevel: permission.accessLevel\n          }));\n        \n        logger.log('DEBUGAUSGABE: Sende Daten an API fr neue Rolle:', {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        });\n        \n        const dataToSend = {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions,\n          allBranches: allBranches,\n          branchIds: allBranches ? [] : selectedBranchIds\n        };\n        \n        logger.log('DEBUGAUSGABE: Vor dem API-Aufruf roleApi.create');\n        const response = await roleApi.create(dataToSend);\n        logger.log('DEBUGAUSGABE: Nach dem API-Aufruf roleApi.create');\n        logger.log('DEBUGAUSGABE: API-Antwort beim Erstellen der Rolle:', response);\n        await fetchRoles();\n      } catch (createError) {\n        console.error('DEBUGAUSGABE: Fehler bei API-Anfrage zum Erstellen der Rolle:', createError);\n        if (createError.response) {\n          handleError(createError.response.data.message || 'Fehler beim Erstellen der Rolle', {\n            component: 'RoleManagementTab'\n          });\n        } else {\n          handleError('Fehler beim Erstellen der Rolle', {\n            component: 'RoleManagementTab'\n          });\n        }\n        return;\n      }\n    }\n    \n    if (onRolesChange) onRolesChange();\n    \n    setIsModalOpen(false);\n    resetForm();\n  };\n\n  // Lschen einer Rolle\n  const handleDelete = async (roleId: number) => {\n    if (!roleId || isNaN(roleId)) {\n      console.warn('Ungltige Rollen-ID erkannt, Lschvorgang abgebrochen');\n      handleError('Ungltige Rollen-ID, Lschvorgang abgebrochen', {\n        component: 'RoleManagementTab',\n        roleId: roleId\n      });\n      return;\n    }\n    \n    // Finde die Rolle in der Liste, um den Namen zu prfen\n    const role = roles.find(r => r.id === roleId);\n    \n    // berprfen, ob es sich um eine geschtzte Rolle handelt\n    if (role && isStandardRole(roleId, role.name)) {\n      console.warn(`Versuch, geschtzte Rolle mit ID ${roleId} (${role.name}) zu lschen`);\n      handleError('Geschtzte Systemrollen knnen nicht gelscht werden', {\n        component: 'RoleManagementTab',\n        roleId: roleId\n      });\n      return;\n    }\n    \n    if (!window.confirm('Mchten Sie diese Rolle wirklich lschen?')) return;\n    \n    try {\n      logger.log(`Starte Lschvorgang fr Rolle mit ID ${roleId}`);\n      \n      // berprfen, ob die Rolle in der aktuellen Liste existiert\n      const roleExists = roles.some(r => r.id === roleId);\n      if (!roleExists) {\n        console.error(`Rolle mit ID ${roleId} existiert nicht in der aktuellen Liste`);\n        handleError(`Rolle mit ID ${roleId} existiert nicht mehr. Bitte aktualisieren Sie die Seite.`, {\n          component: 'RoleManagementTab',\n          roleId: roleId\n        });\n        // Rollen neu laden, um die Anzeige zu aktualisieren\n        await fetchRoles();\n        return;\n      }\n      \n      // Bei Mock-Daten lokales Lschen (wird nicht verwendet)\n      if (false) {\n        logger.log('Lsche Mock-Rolle');\n        const updatedRoles = roles.filter(role => role.id !== roleId);\n        setRoles(updatedRoles);\n      } else {\n        logger.log('Sende Lschanfrage an API');\n        \n        try {\n          const response = await roleApi.delete(roleId);\n          logger.log('API-Antwort beim Lschen der Rolle:', response);\n          \n          // Nach erfolgreichem Lschen die Rollenliste aktualisieren\n          await fetchRoles();\n          logger.log('Rollenliste nach Lschen aktualisiert');\n        } catch (deleteError) {\n          console.error('API-Fehler beim Lschen der Rolle:', deleteError);\n          \n          if (deleteError.response) {\n            console.error('API-Fehlerdaten:', deleteError.response.data);\n            \n            // Spezifischere Fehlerbehandlung\n            if (deleteError.response.data.meta && deleteError.response.data.meta.cause === \"Record to delete does not exist.\") {\n              handleError('Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.', {\n                component: 'RoleManagementTab',\n                roleId: roleId\n              });\n              // Rollenliste aktualisieren, um Frontend zu synchronisieren\n              await fetchRoles();\n            } else {\n              handleError(deleteError.response.data.message || t('roleManagement.deleteError'), {\n                component: 'RoleManagementTab',\n                roleId: roleId\n              });\n            }\n          } else {\n            handleError(t('roleManagement.networkError'), {\n              component: 'RoleManagementTab',\n              roleId: roleId\n            });\n          }\n          return;\n        }\n      }\n      \n      logger.log('Rolle erfolgreich gelscht');\n      if (onRolesChange) onRolesChange();\n    } catch (err) {\n      console.error(t('roleManagement.unhandledError'), err);\n      handleError(err);\n      \n      // Bei einem unbehandelten Fehler trotzdem versuchen, die Rollenliste zu aktualisieren\n      try {\n        await fetchRoles();\n      } catch (refreshError) {\n        console.error('Fehler beim Aktualisieren der Rollenliste nach fehlgeschlagenem Lschvorgang:', refreshError);\n      }\n    }\n  };\n\n  // Kopieren einer Rolle (fr Standardrollen)\n  const handleCopyRole = async (role: Role) => {\n    try {\n      if (!role || !role.id) {\n        handleError('Ungltige Rolle zum Kopieren', {\n          component: 'RoleManagementTab'\n        });\n        return;\n      }\n\n      // Kopie der Rolle erstellen mit angepasstem Namen\n      const copiedRoleData = {\n        name: `${role.name}-Kopie`,\n        description: role.description || '',\n        permissions: role.permissions\n          .filter(permission => permission.accessLevel !== 'none')\n          .map(permission => ({\n            entity: permission.entity,\n            entityType: permission.entityType,\n            accessLevel: permission.accessLevel\n          }))\n      };\n\n      logger.log('DEBUGAUSGABE: Kopiere Rolle:', role.name, 'mit Daten:', copiedRoleData);\n\n      // Rolle erstellen\n      const response = await roleApi.create(copiedRoleData);\n      logger.log('DEBUGAUSGABE: Rolle erfolgreich kopiert:', response.data);\n\n      // Optimistisches Update: Neue Rolle zur Liste hinzufgen\n      setRoles(prevRoles => [response.data, ...prevRoles]);\n      \n      // Bearbeitungsmodal fr die kopierte Rolle ffnen\n      prepareRoleForEditing(response.data);\n      \n      if (onRolesChange) onRolesChange();\n    } catch (err) {\n      console.error('DEBUGAUSGABE: Fehler beim Kopieren der Rolle:', err);\n      handleError(err, {\n        component: 'RoleManagementTab',\n        roleId: role.id\n      });\n    }\n  };\n\n  // Rolle zum Bearbeiten vorbereiten\n  const prepareRoleForEditing = async (role: Role) => {\n    // Verhindere das Bearbeiten von geschtzten Rollen\n    if (isStandardRole(role.id, role.name)) {\n      handleError('Geschtzte Systemrollen knnen nicht bearbeitet werden', {\n        component: 'RoleManagementTab',\n        roleId: role.id\n      });\n      return;\n    }\n    \n    //  FIX: Initialisiere ALLE Permissions aus PERMISSION_STRUCTURE\n    // und bernehme dann die gespeicherten Werte\n    const allPermissions = initializePermissions(role.permissions).map(p => ({\n      ...p,\n      accessLevel: p.accessLevel as AccessLevel\n    }));\n\n    // Stelle sicher, dass alwaysVisiblePages immer 'both' haben\n    allPermissions.forEach(perm => {\n      if (perm.entityType === 'page' && alwaysVisiblePages.includes(perm.entity)) {\n        perm.accessLevel = 'both';\n      }\n    });\n\n    setFormData({\n      name: role.name,\n      description: role.description || '',\n      permissions: allPermissions\n    });\n    \n    // Lade Branch-Zuweisungen der Rolle\n    if (role.id) {\n      try {\n        const branchResponse = await roleApi.getRoleBranches(role.id);\n        const branchData = branchResponse.data;\n        setAllBranches(branchData.allBranches || false);\n        setSelectedBranchIds(branchData.branches?.map((b: any) => b.id) || []);\n      } catch (error) {\n        console.error('Fehler beim Laden der Branch-Zuweisungen:', error);\n        setAllBranches(true);\n        setSelectedBranchIds([]);\n      }\n    }\n    \n    setEditingRole(role);\n    setIsModalOpen(true);\n  };\n\n  // Formular fr neue Rolle zurcksetzen\n  const resetForm = () => {\n    setEditingRole(null);\n    setAllBranches(true);\n    setSelectedBranchIds([]);\n    setFormData({\n      name: '',\n      description: '',\n      permissions: [\n        // Seiten-Berechtigungen\n        ...defaultPages.map(page => ({\n          entity: page,\n          entityType: 'page',\n          // Fr die immer sichtbaren Seiten 'both' als Standard setzen\n          accessLevel: alwaysVisiblePages.includes(page) ? 'both' as AccessLevel : 'none' as AccessLevel\n        })),\n        // Tabellen-Berechtigungen\n        ...defaultTables.map(table => ({\n          entity: table,\n          entityType: 'table',\n          accessLevel: 'none' as AccessLevel\n        })),\n        // Button-Berechtigungen\n        ...defaultButtons.map(button => ({\n          entity: button,\n          entityType: 'button',\n          accessLevel: 'none' as AccessLevel\n        }))\n      ]\n    });\n  };\n\n  // Setzt alle Seitenberechtigungen (auer die immer sichtbaren) auf den gleichen Wert\n  const setAllPagePermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'page' && !alwaysVisiblePages.includes(p.entity))\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Setzt alle Tabellen-Berechtigungen auf den gleichen Wert\n  const setAllTablePermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'table')\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Setzt alle Button-Berechtigungen auf den gleichen Wert\n  const setAllButtonPermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'button')\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Funktion zum Zhlen der aktiven Filter\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  // Filtern und sortieren der Rollen\n  const filteredAndSortedRoles = useMemo(() => {\n    return roles\n      .filter(role => {\n        // Globale Suche\n        if (searchTerm) {\n          const searchLower = searchTerm.toLowerCase();\n          \n          //  OPTIMIERUNG: Frhes Beenden bei Match\n          if (role.name.toLowerCase().includes(searchLower)) return true;\n          if (role.description && role.description.toLowerCase().includes(searchLower)) return true;\n          \n          return false; // Kein Match gefunden\n        }\n        \n        // Prfe erweiterte Filterbedingungen, wenn vorhanden\n        if (filterConditions.length > 0) {\n          // Implementiere die logische Verknpfung der Bedingungen (UND/ODER)\n          let result = filterConditions.length > 0;\n          \n          for (let i = 0; i < filterConditions.length; i++) {\n            const condition = filterConditions[i];\n            let conditionMet = false;\n            \n            switch (condition.column) {\n              case 'name':\n                //  OPTIMIERUNG: toLowerCase() nur einmal pro Wert\n                const roleNameLower = role.name.toLowerCase();\n                const nameConditionValueLower = (condition.value as string || '').toLowerCase();\n                if (condition.operator === 'equals') {\n                  conditionMet = roleNameLower === nameConditionValueLower;\n                } else if (condition.operator === 'contains') {\n                  conditionMet = roleNameLower.includes(nameConditionValueLower);\n                } else if (condition.operator === 'startsWith') {\n                  conditionMet = roleNameLower.startsWith(nameConditionValueLower);\n                }\n                break;\n\n              case 'description':\n                if (!role.description) {\n                  conditionMet = false;\n                  break;\n                }\n\n                //  OPTIMIERUNG: toLowerCase() nur einmal pro Wert\n                const roleDescLower = role.description.toLowerCase();\n                const descConditionValueLower = (condition.value as string || '').toLowerCase();\n                if (condition.operator === 'equals') {\n                  conditionMet = roleDescLower === descConditionValueLower;\n                } else if (condition.operator === 'contains') {\n                  conditionMet = roleDescLower.includes(descConditionValueLower);\n                } else if (condition.operator === 'startsWith') {\n                  conditionMet = roleDescLower.startsWith(descConditionValueLower);\n                }\n                break;\n              \n              case 'permissions':\n                // Vereinfachter Filter fr Berechtigungen - zhle die Anzahl der Berechtigungen mit dem angegebenen Level\n                const accessLevel = condition.value as AccessLevel;\n                const count = role.permissions.filter(p => p.accessLevel === accessLevel).length;\n                \n                if (condition.operator === 'greaterThan') {\n                  conditionMet = count > 0;\n                } else if (condition.operator === 'equals') {\n                  conditionMet = count > 0;\n                }\n                break;\n            }\n            \n            // Verknpfe das Ergebnis dieser Bedingung mit dem Gesamtergebnis\n            if (i === 0) {\n              result = conditionMet;\n            } else {\n              const operator = filterLogicalOperators[i - 1];\n              result = operator === 'AND' ? (result && conditionMet) : (result || conditionMet);\n            }\n          }\n          \n          if (!result) return false;\n        }\n        \n        return true;\n      })\n      .sort((a, b) => {\n        //  OPTIMIERUNG: toLowerCase() fr konsistente Sortierung\n        return a.name.toLowerCase().localeCompare(b.name.toLowerCase());\n      });\n  }, [roles, searchTerm, filterConditions, filterLogicalOperators]);\n\n  // Mobile Ansicht renderRoles-Funktion\n  const renderRoles = () => {\n    if (roles.length === 0) {\n      return (\n        <div className=\"p-4 bg-gray-50 rounded text-center\">\n          <p>Keine Rollen gefunden. Erstellen Sie eine neue Rolle mit dem Button oben.</p>\n        </div>\n      );\n    }\n    \n    if (isMobile) {\n      // Mobile Ansicht mit Karten\n      return (\n        <>\n          <div className=\"space-y-4\">\n            {filteredAndSortedRoles.slice(0, displayLimit).map((role) => (\n              <RoleCard \n                key={role.id} \n                role={role} \n                onEdit={prepareRoleForEditing}\n                onDelete={handleDelete}\n                onCopy={handleCopyRole}\n                canEdit={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canDelete={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canCopy={!readOnly && hasPermission('roles', 'write', 'table') && isStandardRole(role.id, role.name)}\n              />\n            ))}\n          </div>\n          \n          {/* \"Mehr anzeigen\" Button - Mobil */}\n          {filteredAndSortedRoles.length > displayLimit && (\n            <div className=\"mt-4 flex justify-center\">\n              <div className=\"relative group\">\n                <button\n                  className=\"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                  onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                >\n                  <ChevronDownIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('common.showMore')} ({filteredAndSortedRoles.length - displayLimit} {t('common.remaining')})\n                </div>\n              </div>\n            </div>\n          )}\n        </>\n      );\n    } else {\n      // Card-Ansicht fr grere Bildschirme\n      return (\n        <>\n          <div className=\"space-y-4\">\n            {filteredAndSortedRoles.slice(0, displayLimit).map((role) => (\n              <RoleCard \n                key={role.id} \n                role={role} \n                onEdit={prepareRoleForEditing}\n                onDelete={handleDelete}\n                onCopy={handleCopyRole}\n                canEdit={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canDelete={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canCopy={!readOnly && hasPermission('roles', 'write', 'table') && isStandardRole(role.id, role.name)}\n              />\n            ))}\n          </div>\n          \n          {/* \"Mehr anzeigen\" Button - Desktop */}\n          {filteredAndSortedRoles.length > displayLimit && (\n            <div className=\"mt-4 flex justify-center\">\n              <div className=\"relative group\">\n                <button\n                  className=\"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                  onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                >\n                  <ChevronDownIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('common.showMore')} ({filteredAndSortedRoles.length - displayLimit} {t('common.remaining')})\n                </div>\n              </div>\n            </div>\n          )}\n        </>\n      );\n    }\n  };\n\n  // Standard-Filter erstellen und speichern\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(ROLES_TABLE_ID)\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        const alleFilterExists = existingFilters.some(filter => filter.name === 'Alle');\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: ROLES_TABLE_ID,\n            name: 'Alle',\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\n            alleFilter\n          );\n          logger.log('Alle-Filter fr Rollen erstellt');\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []);\n\n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  // Funktion zum Anwenden von Filterbedingungen\n  const applyFilterConditions = useCallback((conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  }, []);\n  \n  // Funktion zum Zurcksetzen der Filter\n  const resetFilterConditions = useCallback(() => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  }, []);\n  \n  // Filter Change Handler (Controlled Mode) - VOR useEffect definiert\n  const handleFilterChange = useCallback(async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  }, [applyFilterConditions]);\n  \n  useEffect(() => {\n    const initialize = async () => {\n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(ROLES_TABLE_ID);\n      \n      // 2. Default-Filter anwenden (IMMER vorhanden!)\n      const defaultFilter = filters.find(f => f.name === 'Alle');\n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        }\n      \n      // 3. Rollen laden (immer, auch mit Default-Filter)\n      await fetchRoles();\n    };\n    \n    initialize();\n  }, [loadFilters, handleFilterChange, fetchRoles]);\n\n  return (\n    <div>\n      {/* Spaltenanzeige und Suche */}\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          {/* Linke Seite: \"Neue Rolle erstellen\"-Button */}\n          <div className=\"flex items-center\">\n            {!readOnly && hasPermission('roles', 'write', 'table') && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsModalOpen(true)}\n                  className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                  style={{ width: '30.19px', height: '30.19px' }}\n                  aria-label={t('roles.createRole')}\n                >\n                  <PlusIcon className=\"h-4 w-4\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('roles.createRole')}\n                </div>\n              </div>\n            )}\n          </div>\n          \n          {/* Mitte: Titel - Kein Titel in der Mitte notwendig bei dieser Komponente, da der Tab-Header bereits den Titel zeigt */}\n          <div></div>\n          \n          {/* Rechte Seite: Suchfeld, Filter-Button, Spalten-Konfiguration */}\n          <div className=\"flex items-center gap-1.5\">\n            <input\n              type=\"text\"\n              placeholder=\"Suchen...\"\n              className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n            <div className=\"relative group ml-1\">\n              <button\n                className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100'}`}\n                onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n              >\n                <FunnelIcon className=\"w-5 h-5\" />\n                {getActiveFilterCount() > 0 && (\n                  <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                    {getActiveFilterCount()}\n                  </span>\n                )}\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                Filter\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Filter-Modal */}\n        {isFilterModalOpen && (\n          <FilterPane\n            columns={[\n              { id: 'name', label: 'Name' },\n              { id: 'description', label: 'Beschreibung' },\n              { id: 'permissions', label: 'Berechtigungen' }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={ROLES_TABLE_ID}\n          />\n        )}\n        \n        {/* Gespeicherte Filter als Tags anzeigen */}\n        <SavedFilterTags\n          tableId={ROLES_TABLE_ID}\n          onSelectFilter={applyFilterConditions}\n          onReset={resetFilterConditions}\n          activeFilterName={activeFilterName}\n          selectedFilterId={selectedFilterId}\n          onFilterChange={handleFilterChange}\n          defaultFilterName=\"Alle\"\n        />\n\n        {loading ? (\n          <div className=\"flex justify-center items-center py-8\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n          </div>\n        ) : (\n          renderRoles()\n        )}\n      </div>\n\n      {/* Modal/Sidepane fr Rollenerstellung/Bearbeitung */}\n      {isModalOpen && (\n        <>\n          {/* Mobile (unter 640px) - Modal */}\n          {isMobile ? (\n            <Dialog open={isModalOpen} onClose={() => setIsModalOpen(false)} className=\"relative z-50\">\n              <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n              \n              <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden\">\n                  {/* Header */}\n                  <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <div className=\"flex items-center justify-between\">\n                      <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                        {editingRole ? t('roles.editRole') : t('roles.createRole')}\n                      </Dialog.Title>\n                      <button\n                        onClick={() => setIsModalOpen(false)}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                      >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                      </button>\n                    </div>\n                  </div>\n                  \n                  {/* Form */}\n                  <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\n                    {/* Content - scrollbarer Bereich */}\n                    <div className=\"flex-1 overflow-y-auto min-h-0\">\n                      <div className=\"p-6 space-y-5\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Name</label>\n                  <input\n                    type=\"text\"\n                    value={formData.name}\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    required\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Beschreibung</label>\n                  <input\n                    type=\"text\"\n                    value={formData.description}\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n                  </div>\n                  \n                  {/* Branch-Zuweisungen */}\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      {t('roles.form.branchAssignment') || 'Branch-Zuweisung'}\n                    </label>\n                    <div className=\"space-y-3\">\n                      <label className=\"flex items-center\">\n                        <input\n                          type=\"checkbox\"\n                          checked={allBranches}\n                          onChange={(e) => {\n                            setAllBranches(e.target.checked);\n                            if (e.target.checked) {\n                              setSelectedBranchIds([]);\n                            }\n                          }}\n                          className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                        />\n                        <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                          {t('roles.form.allBranches') || 'Fr alle Branches gltig'}\n                        </span>\n                      </label>\n                      \n                      {!allBranches && (\n                        <div className=\"ml-6\">\n                          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                            {t('roles.form.specificBranches') || 'Spezifische Branches:'}\n                          </label>\n                          {loadingBranches ? (\n                            <div className=\"text-sm text-gray-500\">Lade Branches...</div>\n                          ) : branches.length === 0 ? (\n                            <div className=\"text-sm text-gray-500\">Keine Branches verfgbar</div>\n                          ) : (\n                            <div className=\"space-y-2 max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2\">\n                              {branches.map((branch) => (\n                                <label key={branch.id} className=\"flex items-center\">\n                                  <input\n                                    type=\"checkbox\"\n                                    checked={selectedBranchIds.includes(branch.id)}\n                                    onChange={(e) => {\n                                      if (e.target.checked) {\n                                        setSelectedBranchIds([...selectedBranchIds, branch.id]);\n                                      } else {\n                                        setSelectedBranchIds(selectedBranchIds.filter(id => id !== branch.id));\n                                      }\n                                    }}\n                                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                                  />\n                                  <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                                    {branch.name}\n                                  </span>\n                                </label>\n                              ))}\n                            </div>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  \n                  {/* Berechtigungen - Neue strukturierte Komponente */}\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      {t('roles.form.detailedPermissions')}\n                    </label>\n                    <PermissionEditor\n                      permissions={formData.permissions}\n                      onChange={(newPermissions) => setFormData({ ...formData, permissions: newPermissions })}\n                    />\n                  </div>\n                      </div>\n                    </div>\n                  \n                  {/* Footer */}\n                  <div className=\"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-end gap-2 border-t dark:border-gray-600 flex-shrink-0\">\n                    <div className=\"relative group\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setIsModalOpen(false)}\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                      >\n                        <XMarkIcon className=\"h-5 w-5\" />\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        Abbrechen\n                      </div>\n                    </div>\n                    <div className=\"relative group\">\n                      <button\n                        type=\"submit\"\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                      >\n                        <CheckIcon className=\"h-5 w-5\" />\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {editingRole ? 'Aktualisieren' : 'Erstellen'}\n                      </div>\n                    </div>\n                  </div>\n                </form>\n              </Dialog.Panel>\n            </div>\n          </Dialog>\n          ) : (\n            /* Desktop (ab 640px) - Sidepane */\n            /* WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition */\n            <>\n              {/* Backdrop - nur wenn offen und <= 1070px */}\n              {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n              {isModalOpen && !isLargeScreen && (\n                <div \n                  className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                  aria-hidden=\"true\" \n                  style={{\n                    opacity: isModalOpen ? 1 : 0,\n                    transition: 'opacity 300ms ease-out'\n                  }}\n                />\n              )}\n              \n              {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n              <div \n                className={`fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isModalOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                  transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                  pointerEvents: isModalOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isModalOpen}\n                role=\"dialog\"\n                aria-modal={isModalOpen}\n              >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                  <h2 className=\"text-lg font-semibold dark:text-white\">\n                    {editingRole ? t('roles.editRole') : t('roles.createRole')}\n                  </h2>\n                  <button\n                    onClick={() => setIsModalOpen(false)}\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                  <form onSubmit={handleSubmit} className=\"space-y-5\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.name')}</label>\n                        <input\n                          type=\"text\"\n                          value={formData.name}\n                          onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                          className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.description')}</label>\n                        <input\n                          type=\"text\"\n                          value={formData.description}\n                          onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                          className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                        />\n                      </div>\n                    </div>\n                    \n                    {/* Berechtigungen - Neue strukturierte Komponente */}\n                    <div className=\"mt-4\">\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                        {t('roles.form.detailedPermissions')}\n                      </label>\n                      <PermissionEditor\n                        permissions={formData.permissions}\n                        onChange={(newPermissions) => setFormData({ ...formData, permissions: newPermissions })}\n                      />\n                    </div>\n\n                    {/* Buttons */}\n                    <div className=\"flex justify-end pt-4 gap-2\">\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          onClick={() => setIsModalOpen(false)}\n                          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                        >\n                          <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          Abbrechen\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          type=\"submit\"\n                          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                        >\n                          <CheckIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {editingRole ? 'Aktualisieren' : 'Erstellen'}\n                        </div>\n                      </div>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default RoleManagementTab; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PencilIcon, CheckIcon, XMarkIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\n\ninterface RoomDescription {\n  text?: string;\n  imageUrl?: string;\n  videoUrl?: string;\n}\n\ninterface RoomDescriptionsSectionProps {\n  branchId: number;\n}\n\nconst RoomDescriptionsSection: React.FC<RoomDescriptionsSectionProps> = ({ branchId }) => {\n  const { t } = useTranslation();\n  const [roomDescriptions, setRoomDescriptions] = useState<Record<number, RoomDescription>>({});\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [editingCategoryId, setEditingCategoryId] = useState<number | null>(null);\n  const [editForm, setEditForm] = useState<RoomDescription>({ text: '', imageUrl: '', videoUrl: '' });\n  const [rooms, setRooms] = useState<Array<{ categoryId: number; roomName: string; roomType: 'compartida' | 'privada' }>>([]);\n  const [loadingRooms, setLoadingRooms] = useState(false);\n\n  // Lade Zimmer-Beschreibungen\n  const loadRoomDescriptions = async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.ROOM_DESCRIPTIONS(branchId));\n      setRoomDescriptions(response.data || {});\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Zimmer-Beschreibungen:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Lade Zimmer-Liste aus Reservierungen\n  const loadRooms = async () => {\n    try {\n      setLoadingRooms(true);\n      // Lade Reservierungen mit categoryId\n      const response = await axiosInstance.get(API_ENDPOINTS.RESERVATION.BASE, {\n        params: {\n          branchId: branchId,\n          limit: 1000 // Lade viele Reservierungen, um alle Zimmer zu finden\n        }\n      });\n      \n      // Extrahiere eindeutige categoryIds\n      const categoryMap = new Map<number, { roomName: string; roomType: 'compartida' | 'privada' }>();\n      \n      // Backend gibt data.data zurck (nicht data.reservations)\n      const reservations = response.data.data || [];\n      \n      reservations.forEach((reservation: any) => {\n        if (reservation.categoryId && reservation.roomNumber) {\n          // Bestimme roomType basierend auf roomNumber (Dorms enthalten \"(\")\n          const isDorm = reservation.roomNumber.includes('(');\n          const roomType = isDorm ? 'compartida' : 'privada';\n          \n          // Extrahiere Zimmername (fr Dorms: vor \"(\")\n          const roomName = isDorm \n            ? reservation.roomNumber.split('(')[0].trim()\n            : reservation.roomNumber;\n          \n          if (!categoryMap.has(reservation.categoryId)) {\n            categoryMap.set(reservation.categoryId, { roomName, roomType });\n          }\n        }\n      });\n      \n      // Konvertiere Map zu Array\n      const roomsArray = Array.from(categoryMap.entries()).map(([categoryId, data]) => ({\n        categoryId,\n        ...data\n      }));\n      \n      setRooms(roomsArray.sort((a, b) => a.roomName.localeCompare(b.roomName)));\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Zimmer:', error);\n    } finally {\n      setLoadingRooms(false);\n    }\n  };\n\n  useEffect(() => {\n    if (branchId) {\n      loadRoomDescriptions();\n      loadRooms();\n    }\n  }, [branchId]);\n\n  // Starte Bearbeitung\n  const handleEdit = (categoryId: number) => {\n    const description = roomDescriptions[categoryId] || { text: '', imageUrl: '', videoUrl: '' };\n    setEditForm(description);\n    setEditingCategoryId(categoryId);\n  };\n\n  // Speichere Beschreibung\n  const handleSave = async () => {\n    if (editingCategoryId === null) return;\n    \n    try {\n      setSaving(true);\n      const updatedDescriptions = {\n        ...roomDescriptions,\n        [editingCategoryId]: editForm\n      };\n      \n      await axiosInstance.put(\n        API_ENDPOINTS.BRANCHES.ROOM_DESCRIPTIONS(branchId),\n        { roomDescriptions: updatedDescriptions }\n      );\n      \n      // Lade Daten neu vom Backend, um sicherzustellen, dass sie korrekt gespeichert wurden\n      await loadRoomDescriptions();\n      \n      setEditingCategoryId(null);\n      setEditForm({ text: '', imageUrl: '', videoUrl: '' });\n    } catch (error: any) {\n      console.error('Fehler beim Speichern der Zimmer-Beschreibung:', error);\n      alert(t('branches.roomDescriptions.saveError', { defaultValue: 'Fehler beim Speichern der Beschreibung' }));\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  // Abbrechen\n  const handleCancel = () => {\n    setEditingCategoryId(null);\n    setEditForm({ text: '', imageUrl: '', videoUrl: '' });\n  };\n\n  if (loading || loadingRooms) {\n    return (\n      <div className=\"mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n          {t('common.loading', { defaultValue: 'Lade...' })}\n        </p>\n      </div>\n    );\n  }\n\n  if (rooms.length === 0) {\n    return (\n      <div className=\"mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n          {t('branches.roomDescriptions.noRooms', { \n            defaultValue: 'Keine Zimmer gefunden. Importieren Sie zuerst Reservierungen aus LobbyPMS.' \n          })}\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"mt-6 border-t border-gray-200 dark:border-gray-700 pt-6\">\n      <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n        {t('branches.roomDescriptions.title', { defaultValue: 'Zimmer-Beschreibungen' })}\n      </h5>\n      <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-4\">\n        {t('branches.roomDescriptions.description', { \n          defaultValue: 'Beschreibungen, wie man zu den Zimmern kommt. Diese werden in den Check-in-Nachrichten verwendet.' \n        })}\n      </p>\n      \n      <div className=\"space-y-4\">\n        {rooms.map((room) => {\n          const isEditing = editingCategoryId === room.categoryId;\n          const description = roomDescriptions[room.categoryId] || null;\n          \n          return (\n            <div\n              key={room.categoryId}\n              className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-white dark:bg-gray-800\"\n            >\n              <div className=\"flex items-start justify-between mb-2\">\n                <div>\n                  <h6 className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                    {room.roomName}\n                  </h6>\n                  <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                    {room.roomType === 'compartida' \n                      ? t('branches.roomDescriptions.dorm', { defaultValue: 'Dorm' })\n                      : t('branches.roomDescriptions.private', { defaultValue: 'Privatzimmer' })}\n                    {'  '}\n                    {t('branches.roomDescriptions.categoryId', { defaultValue: 'Category ID' })}: {room.categoryId}\n                  </span>\n                </div>\n                {!isEditing && (\n                  <button\n                    onClick={() => handleEdit(room.categoryId)}\n                    className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                    title={t('common.edit', { defaultValue: 'Bearbeiten' })}\n                  >\n                    <PencilIcon className=\"h-4 w-4\" />\n                  </button>\n                )}\n              </div>\n              \n              {isEditing ? (\n                <div className=\"space-y-3 mt-3\">\n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('branches.roomDescriptions.text', { defaultValue: 'Text' })}\n                    </label>\n                    <textarea\n                      value={editForm.text || ''}\n                      onChange={(e) => setEditForm({ ...editForm, text: e.target.value })}\n                      rows={3}\n                      placeholder={t('branches.roomDescriptions.textPlaceholder', { \n                        defaultValue: 'Beschreibung, wie man zum Zimmer kommt...' \n                      })}\n                      className=\"w-full text-sm rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white px-3 py-2\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('branches.roomDescriptions.imageUrl', { defaultValue: 'Bild-URL' })}\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={editForm.imageUrl || ''}\n                      onChange={(e) => setEditForm({ ...editForm, imageUrl: e.target.value })}\n                      placeholder=\"https://example.com/image.jpg\"\n                      className=\"w-full text-sm rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white px-3 py-2\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('branches.roomDescriptions.videoUrl', { defaultValue: 'Video-URL' })}\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={editForm.videoUrl || ''}\n                      onChange={(e) => setEditForm({ ...editForm, videoUrl: e.target.value })}\n                      placeholder=\"https://example.com/video.mp4\"\n                      className=\"w-full text-sm rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white px-3 py-2\"\n                    />\n                  </div>\n                  \n                  <div className=\"flex justify-end space-x-2\">\n                    <button\n                      onClick={handleCancel}\n                      disabled={saving}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50\"\n                      title={t('common.cancel', { defaultValue: 'Abbrechen' })}\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      onClick={handleSave}\n                      disabled={saving}\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 dark:bg-blue-500 dark:hover:bg-blue-600\"\n                      title={saving ? t('common.saving', { defaultValue: 'Speichere...' }) : t('common.save', { defaultValue: 'Speichern' })}\n                    >\n                      <CheckIcon className=\"h-5 w-5\" />\n                    </button>\n                  </div>\n                </div>\n              ) : (\n                <div className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\n                  {description ? (\n                    <div className=\"space-y-1\">\n                      {description.text && (\n                        <p>{description.text}</p>\n                      )}\n                      {description.imageUrl && (\n                        <p>\n                          <span className=\"font-medium\">{t('branches.roomDescriptions.image', { defaultValue: 'Bild' })}:</span>{' '}\n                          <a href={description.imageUrl} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 dark:text-blue-400 hover:underline\">\n                            {description.imageUrl}\n                          </a>\n                        </p>\n                      )}\n                      {description.videoUrl && (\n                        <p>\n                          <span className=\"font-medium\">{t('branches.roomDescriptions.video', { defaultValue: 'Video' })}:</span>{' '}\n                          <a href={description.videoUrl} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 dark:text-blue-400 hover:underline\">\n                            {description.videoUrl}\n                          </a>\n                        </p>\n                      )}\n                    </div>\n                  ) : (\n                    <p className=\"text-gray-400 dark:text-gray-500 italic\">\n                      {t('branches.roomDescriptions.noDescription', { defaultValue: 'Keine Beschreibung vorhanden' })}\n                    </p>\n                  )}\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default RoomDescriptionsSection;\n\n","import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { PencilIcon, TrashIcon, PlusIcon, XMarkIcon, CheckIcon, FunnelIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { useFilterContext } from '../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport RoomDescriptionsSection from './branches/RoomDescriptionsSection.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { logger } from '../utils/logger.ts';\n\ninterface Branch {\n    id: number;\n    name: string;\n    whatsappSettings?: any;\n    lobbyPmsSettings?: any;\n    boldPaymentSettings?: any;\n    doorSystemSettings?: any;\n    emailSettings?: any;\n}\n\ninterface BranchManagementTabProps {\n}\n\n// BranchCard-Komponente fr mobile und Desktop-Ansicht\nconst BranchCard: React.FC<{\n    branch: Branch;\n    onEdit: (branch: Branch) => void;\n    onDelete: (branchId: number) => void;\n    canEdit: boolean;\n    canDelete: boolean;\n}> = ({ branch, onEdit, onDelete, canEdit, canDelete }) => {\n    const { t } = useTranslation();\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4\">\n            {/* Header mit Branchname und Aktionen */}\n            <div className=\"flex justify-between items-start mb-2\">\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{branch.name}</h3>\n                \n                <div className=\"flex space-x-2\">\n                    {canEdit && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onEdit(branch)}\n                                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                            >\n                                <PencilIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.edit', { defaultValue: 'Bearbeiten' })}\n                            </div>\n                        </div>\n                    )}\n                    \n                    {canDelete && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onDelete(branch.id)}\n                                className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n                            >\n                                <TrashIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.delete', { defaultValue: 'Lschen' })}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\n// TableID fr gespeicherte Filter\nconst BRANCHES_TABLE_ID = 'branches-table';\n\nconst BranchManagementTab: React.FC<BranchManagementTabProps> = () => {\n    const { t } = useTranslation();\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [editingBranch, setEditingBranch] = useState<Branch | null>(null);\n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [formData, setFormData] = useState({ \n        name: '',\n        address: '',\n        city: '',\n        country: '',\n        whatsappSettings: {\n            provider: 'whatsapp-business-api' as 'twilio' | 'whatsapp-business-api',\n            apiKey: '',\n            apiSecret: '',\n            phoneNumberId: '',\n            ai: {\n                enabled: false,\n                model: 'gpt-4o',\n                systemPrompt: '',\n                rules: [] as string[],\n                sources: [] as string[],\n                temperature: 0.7,\n                maxTokens: 500\n            }\n        },\n        lobbyPmsSettings: {\n            apiUrl: '',\n            apiKey: '',\n            propertyId: '',\n            syncEnabled: true,\n            autoCreateTasks: false,\n            lateCheckInThreshold: '22:00',\n            notificationChannels: ['email'] as string[],\n            autoSendInvitation: false\n        },\n        boldPaymentSettings: {\n            apiKey: '',\n            merchantId: '',\n            environment: 'sandbox' as 'sandbox' | 'production'\n        },\n        doorSystemSettings: {\n            clientId: '',\n            clientSecret: '',\n            username: '',\n            password: '',\n            apiUrl: 'https://euopen.ttlock.com',\n            lockIds: [] as string[],\n            appName: 'TTLock'\n        },\n        emailSettings: {\n            smtpHost: '',\n            smtpPort: 587,\n            smtpUser: '',\n            smtpPass: '',\n            smtpFromEmail: '',\n            smtpFromName: '',\n            imap: {\n                enabled: false,\n                host: '',\n                port: 993,\n                secure: true,\n                user: '',\n                password: '',\n                folder: 'INBOX',\n                processedFolder: ''\n            }\n        },\n        messageTemplates: {\n            checkInInvitation: {\n                en: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                es: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                de: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                }\n            },\n            checkInConfirmation: {\n                en: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                es: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                de: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                }\n            }\n        },\n        autoSendReservationInvitation: false\n    });\n    const [activeSettingsTab, setActiveSettingsTab] = useState<'whatsapp' | 'lobbypms' | 'boldpayment' | 'doorsystem' | 'email' | 'messages'>('whatsapp');\n    const [showSecrets, setShowSecrets] = useState<Record<string, boolean>>({});\n    const [selectedTemplateType, setSelectedTemplateType] = useState<'checkInInvitation' | 'checkInConfirmation'>('checkInInvitation');\n    const [selectedLanguage, setSelectedLanguage] = useState<'en' | 'es' | 'de'>('en');\n    const [searchTerm, setSearchTerm] = useState('');\n    const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n    const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n    const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [activeFilterName, setActiveFilterName] = useState<string>('');\n    const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n    const [displayLimit, setDisplayLimit] = useState(10);\n    const { hasPermission } = usePermissions();\n    const { openSidepane, closeSidepane } = useSidepane();\n    const { handleError: handleErrorContext } = useError();\n\n    // Berechtigungen prfen\n    const canCreate = hasPermission('branches', 'write', 'table');\n    const canEdit = hasPermission('branches', 'write', 'table');\n    const canDelete = hasPermission('branches', 'write', 'table');\n\n    // Branches laden\n    const fetchBranches = useCallback(async () => {\n        setLoading(true);\n        try {\n            const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n            setBranches(response.data);\n        } catch (error: any) {\n            console.error('Fehler beim Laden der Niederlassungen:', error);\n            handleErrorContext(error);\n        } finally {\n            setLoading(false);\n        }\n    }, [handleErrorContext]);\n\n    useEffect(() => {\n        fetchBranches();\n    }, [fetchBranches]);\n\n    // Sidepane ffnen/schlieen basierend auf Modal-Status\n    useEffect(() => {\n        if (isModalOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isModalOpen, openSidepane, closeSidepane]);\n\n    // Formular zurcksetzen\n    const resetForm = () => {\n        setFormData({ \n            name: '',\n            address: '',\n            city: '',\n            country: '',\n            whatsappSettings: {\n                provider: 'whatsapp-business-api' as 'twilio' | 'whatsapp-business-api',\n                apiKey: '',\n                apiSecret: '',\n                phoneNumberId: '',\n                ai: {\n                    enabled: false,\n                    model: 'gpt-4o',\n                    systemPrompt: '',\n                    rules: [] as string[],\n                    sources: [] as string[],\n                    temperature: 0.7,\n                    maxTokens: 500\n                }\n            },\n            lobbyPmsSettings: {\n                apiUrl: '',\n                apiKey: '',\n                propertyId: '',\n                syncEnabled: true,\n                autoCreateTasks: false,\n                lateCheckInThreshold: '22:00',\n                notificationChannels: ['email'] as string[],\n                autoSendInvitation: false\n            },\n            boldPaymentSettings: {\n                apiKey: '',\n                merchantId: '',\n                environment: 'sandbox' as 'sandbox' | 'production'\n            },\n            doorSystemSettings: {\n                clientId: '',\n                clientSecret: '',\n                username: '',\n                password: '',\n                apiUrl: 'https://euopen.ttlock.com',\n                lockIds: [] as string[],\n                appName: 'TTLock'\n            },\n            sireSettings: {\n                enabled: false,\n                autoRegisterOnCheckIn: false,\n                apiUrl: '',\n                apiKey: '',\n                apiSecret: '',\n                propertyCode: ''\n            },\n            emailSettings: {\n                smtpHost: '',\n                smtpPort: 587,\n                smtpUser: '',\n                smtpPass: '',\n                smtpFromEmail: '',\n                smtpFromName: '',\n                imap: {\n                    enabled: false,\n                    host: '',\n                    port: 993,\n                    secure: true,\n                    user: '',\n                    password: '',\n                    folder: 'INBOX',\n                    processedFolder: ''\n                }\n            },\n            messageTemplates: {\n                checkInInvitation: {\n                    en: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    es: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    de: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    }\n                },\n                checkInConfirmation: {\n                    en: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    es: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    de: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    }\n                }\n            },\n            autoSendReservationInvitation: false\n        });\n        setActiveSettingsTab('whatsapp');\n        setEditingBranch(null);\n    };\n\n    // Modal ffnen fr neue Branch\n    const handleCreate = () => {\n        resetForm();\n        setIsModalOpen(true);\n    };\n\n    // Modal ffnen fr Bearbeitung\n    const handleEdit = async (branch: Branch) => {\n        setEditingBranch(branch);\n        const existingWhatsapp = branch.whatsappSettings || {};\n        const existingLobbyPms = branch.lobbyPmsSettings || {};\n        // Bold Payment Settings: Prfe ob es ein String ist (JSON) oder bereits ein Objekt\n        let existingBoldPayment: any = branch.boldPaymentSettings;\n        if (!existingBoldPayment) {\n            existingBoldPayment = {};\n        } else if (typeof existingBoldPayment === 'string') {\n            try {\n                existingBoldPayment = JSON.parse(existingBoldPayment);\n            } catch (e) {\n                console.error('Fehler beim Parsen von boldPaymentSettings:', e);\n                existingBoldPayment = {};\n            }\n        }\n        // Stelle sicher, dass verschlsselte Werte (mit ':') auch angezeigt werden\n        // Wenn Entschlsselung fehlgeschlagen ist, bleiben die verschlsselten Strings erhalten\n        const existingDoorSystem = branch.doorSystemSettings || {};\n        const existingEmail = branch.emailSettings || {};\n        const existingMessageTemplates = (branch as any).messageTemplates || {};\n        const existingAutoSend = (branch as any).autoSendReservationInvitation || false;\n        \n        setFormData({ \n            name: branch.name,\n            address: (branch as any).address || '',\n            city: (branch as any).city || '',\n            country: (branch as any).country || '',\n            whatsappSettings: {\n                provider: existingWhatsapp.provider || 'whatsapp-business-api',\n                apiKey: existingWhatsapp.apiKey || '',\n                apiSecret: existingWhatsapp.apiSecret || '',\n                phoneNumberId: existingWhatsapp.phoneNumberId || '',\n                ai: existingWhatsapp.ai || {\n                    enabled: false,\n                    model: 'gpt-4o',\n                    systemPrompt: '',\n                    rules: [],\n                    sources: [],\n                    temperature: 0.7,\n                    maxTokens: 500\n                }\n            },\n            lobbyPmsSettings: {\n                apiUrl: existingLobbyPms.apiUrl || '',\n                apiKey: existingLobbyPms.apiKey || '',\n                propertyId: existingLobbyPms.propertyId || '',\n                syncEnabled: existingLobbyPms.syncEnabled !== undefined ? existingLobbyPms.syncEnabled : true,\n                autoCreateTasks: existingLobbyPms.autoCreateTasks || false,\n                lateCheckInThreshold: existingLobbyPms.lateCheckInThreshold || '22:00',\n                notificationChannels: existingLobbyPms.notificationChannels || ['email'],\n                autoSendInvitation: existingLobbyPms.autoSendInvitation || false\n            },\n            boldPaymentSettings: {\n                // Wenn Entschlsselung fehlgeschlagen ist, sind die Werte verschlsselt (Format: \"iv:authTag:encrypted\")\n                // Diese sollten NICHT im Frontend angezeigt werden (Sicherheit)\n                // ABER: Wir speichern einen Flag, dass verschlsselte Werte vorhanden sind\n                // Die verschlsselten Werte bleiben in der DB, damit Payment-Links weiter funktionieren\n                apiKey: (existingBoldPayment.apiKey && !existingBoldPayment.apiKey.includes(':')) \n                    ? existingBoldPayment.apiKey \n                    : '',\n                merchantId: (existingBoldPayment.merchantId && !existingBoldPayment.merchantId.includes(':')) \n                    ? existingBoldPayment.merchantId \n                    : '',\n                environment: existingBoldPayment.environment || 'sandbox',\n                // Flag: Gibt an, ob verschlsselte Werte vorhanden sind (aber nicht entschlsselbar)\n                _hasEncryptedValues: (existingBoldPayment.apiKey && existingBoldPayment.apiKey.includes(':')) ||\n                                     (existingBoldPayment.merchantId && existingBoldPayment.merchantId.includes(':'))\n            },\n            doorSystemSettings: {\n                clientId: existingDoorSystem.clientId || '',\n                clientSecret: existingDoorSystem.clientSecret || '',\n                username: existingDoorSystem.username || '',\n                password: existingDoorSystem.password || '',\n                apiUrl: existingDoorSystem.apiUrl || 'https://euopen.ttlock.com',\n                lockIds: existingDoorSystem.lockIds || [],\n                appName: existingDoorSystem.appName || 'TTLock'\n            },\n            emailSettings: {\n                smtpHost: existingEmail.smtpHost || '',\n                smtpPort: existingEmail.smtpPort || 587,\n                smtpUser: existingEmail.smtpUser || '',\n                smtpPass: existingEmail.smtpPass || '',\n                smtpFromEmail: existingEmail.smtpFromEmail || '',\n                smtpFromName: existingEmail.smtpFromName || '',\n                imap: existingEmail.imap || {\n                    enabled: false,\n                    host: '',\n                    port: 993,\n                    secure: true,\n                    user: '',\n                    password: '',\n                    folder: 'INBOX',\n                    processedFolder: ''\n                }\n            },\n            messageTemplates: existingMessageTemplates || {\n                checkInInvitation: {\n                    en: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    es: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    de: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' }\n                },\n                checkInConfirmation: {\n                    en: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    es: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    de: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' }\n                }\n            },\n            autoSendReservationInvitation: existingAutoSend\n        });\n        setIsModalOpen(true);\n    };\n\n    // Modal schlieen\n    const handleCloseModal = () => {\n        setIsModalOpen(false);\n        resetForm();\n    };\n\n    // Formular absenden\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        \n        if (!formData.name.trim()) {\n            handleErrorContext({ message: t('branches.nameRequired') });\n            return;\n        }\n\n        try {\n            if (editingBranch) {\n                // Branch aktualisieren\n                await axiosInstance.put(API_ENDPOINTS.BRANCHES.UPDATE(editingBranch.id), {\n                    name: formData.name.trim(),\n                    address: formData.address.trim() || null,\n                    city: formData.city.trim() || null,\n                    country: formData.country.trim() || null,\n                    whatsappSettings: formData.whatsappSettings,\n                    lobbyPmsSettings: formData.lobbyPmsSettings,\n                    boldPaymentSettings: {\n                        apiKey: formData.boldPaymentSettings.apiKey,\n                        merchantId: formData.boldPaymentSettings.merchantId,\n                        environment: formData.boldPaymentSettings.environment\n                    },\n                    doorSystemSettings: formData.doorSystemSettings,\n                    emailSettings: formData.emailSettings,\n                    messageTemplates: formData.messageTemplates,\n                    autoSendReservationInvitation: formData.autoSendReservationInvitation\n                });\n            } else {\n                // Neue Branch erstellen\n                await axiosInstance.post(API_ENDPOINTS.BRANCHES.CREATE, {\n                    name: formData.name.trim()\n                });\n            }\n            \n            await fetchBranches();\n            handleCloseModal();\n        } catch (error: any) {\n            console.error('Fehler beim Speichern der Niederlassung:', error);\n            handleErrorContext(error);\n        }\n    };\n\n    // Branch lschen\n    const handleDelete = async (branchId: number) => {\n        if (!window.confirm(t('branches.deleteConfirm', { defaultValue: 'Mchten Sie diese Niederlassung wirklich lschen?' }))) {\n            return;\n        }\n\n        try {\n            await axiosInstance.delete(API_ENDPOINTS.BRANCHES.DELETE(branchId));\n            await fetchBranches();\n        } catch (error: any) {\n            console.error('Fehler beim Lschen der Niederlassung:', error);\n            handleErrorContext(error);\n        }\n    };\n\n    // Funktion zum Zhlen der aktiven Filter\n    const getActiveFilterCount = () => {\n        return filterConditions.length;\n    };\n\n    // Filtern und sortieren der Branches\n    const filteredAndSortedBranches = useMemo(() => {\n        return branches\n            .filter(branch => {\n                // Globale Suche\n                if (searchTerm) {\n                    const searchLower = searchTerm.toLowerCase();\n                    const matchesSearch = branch.name.toLowerCase().includes(searchLower);\n                    \n                    if (!matchesSearch) return false;\n                }\n                \n                // Prfe erweiterte Filterbedingungen, wenn vorhanden\n                if (filterConditions.length > 0) {\n                    let result = filterConditions.length > 0;\n                    \n                    for (let i = 0; i < filterConditions.length; i++) {\n                        const condition = filterConditions[i];\n                        let conditionMet = false;\n                        \n                        switch (condition.column) {\n                            case 'name':\n                                //  OPTIMIERUNG: toLowerCase() nur einmal pro Wert\n                                const branchNameLower = branch.name.toLowerCase();\n                                const conditionValueLower = (condition.value as string || '').toLowerCase();\n                                if (condition.operator === 'equals') {\n                                    conditionMet = branchNameLower === conditionValueLower;\n                                } else if (condition.operator === 'contains') {\n                                    conditionMet = branchNameLower.includes(conditionValueLower);\n                                } else if (condition.operator === 'startsWith') {\n                                    conditionMet = branchNameLower.startsWith(conditionValueLower);\n                                }\n                                break;\n                        }\n                        \n                        // Verknpfe das Ergebnis dieser Bedingung mit dem Gesamtergebnis\n                        if (i === 0) {\n                            result = conditionMet;\n                        } else {\n                            const operator = filterLogicalOperators[i - 1];\n                            result = operator === 'AND' ? (result && conditionMet) : (result || conditionMet);\n                        }\n                    }\n                    \n                    if (!result) return false;\n                }\n                \n                return true;\n            })\n            .sort((a, b) => {\n                //  OPTIMIERUNG: toLowerCase() fr konsistente Sortierung\n                return a.name.toLowerCase().localeCompare(b.name.toLowerCase());\n            });\n    }, [branches, searchTerm, filterConditions, filterLogicalOperators]);\n\n    // Funktion zum Anwenden von Filterbedingungen\n    const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setFilterConditions(conditions);\n        setFilterLogicalOperators(operators);\n    };\n    \n    // Funktion zum Zurcksetzen der Filter\n    const resetFilterConditions = () => {\n        setFilterConditions([]);\n        setFilterLogicalOperators([]);\n        setActiveFilterName('');\n        setSelectedFilterId(null);\n    };\n    \n    // Filter Change Handler (Controlled Mode)\n    const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setActiveFilterName(name);\n        setSelectedFilterId(id);\n        applyFilterConditions(conditions, operators);\n    };\n    \n    //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n    const filterContext = useFilterContext();\n    const { loadFilters } = filterContext;\n    \n    useEffect(() => {\n        const initialize = async () => {\n            // 1. Filter laden (wartet auf State-Update)\n            const filters = await loadFilters(BRANCHES_TABLE_ID);\n            \n            // 2. Default-Filter anwenden (IMMER vorhanden!)\n            const defaultFilter = filters.find(f => f.name === 'Alle');\n            if (defaultFilter) {\n                await handleFilterChange(\n                    defaultFilter.name,\n                    defaultFilter.id,\n                    defaultFilter.conditions,\n                    defaultFilter.operators\n                );\n                return; // Filter wird angewendet\n            }\n            \n            // 3. Fallback: Kein Filter (sollte nie passieren)\n            // BranchManagementTab filtert client-seitig, daher keine Daten-Lade-Funktion ntig\n        };\n        \n        initialize();\n    }, [loadFilters, handleFilterChange]);\n\n    // Standard-Filter erstellen und speichern\n    useEffect(() => {\n        const createStandardFilters = async () => {\n            try {\n                const token = localStorage.getItem('token');\n                \n                if (!token) {\n                    console.error(t('common.notAuthenticated'));\n                    return;\n                }\n\n                // Prfen, ob die Standard-Filter bereits existieren\n                const existingFiltersResponse = await axiosInstance.get(\n                    API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(BRANCHES_TABLE_ID)\n                );\n\n                const existingFilters = existingFiltersResponse.data || [];\n                const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\n\n                // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n                if (!alleFilterExists) {\n                    const alleFilter = {\n                        tableId: BRANCHES_TABLE_ID,\n                        name: 'Alle',\n                        conditions: [],\n                        operators: []\n                    };\n\n                    await axiosInstance.post(\n                        API_ENDPOINTS.SAVED_FILTERS.BASE,\n                        alleFilter\n                    );\n                    if (process.env.NODE_ENV === 'development') {\n                    logger.log(t('branches.filterCreated'));\n                    }\n                }\n            } catch (error) {\n                console.error(t('branches.createStandardFiltersError'), error);\n            }\n        };\n\n        createStandardFilters();\n    }, []);\n\n\n    // Branches rendern\n    const renderBranches = () => {\n        if (filteredAndSortedBranches.length === 0) {\n            return (\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded text-center\">\n                    <p className=\"text-gray-600 dark:text-gray-400\">\n                        {t('branches.noBranches', { defaultValue: 'Keine Niederlassungen gefunden. Erstellen Sie eine neue Niederlassung mit dem Button oben.' })}\n                    </p>\n                </div>\n            );\n        }\n        \n        // Card-Ansicht\n        return (\n            <>\n                <div className=\"space-y-4\">\n                    {filteredAndSortedBranches.slice(0, displayLimit).map((branch) => (\n                        <BranchCard \n                            key={branch.id} \n                            branch={branch} \n                            onEdit={handleEdit}\n                            onDelete={handleDelete}\n                            canEdit={canEdit}\n                            canDelete={canDelete}\n                        />\n                    ))}\n                </div>\n                \n                {/* \"Mehr anzeigen\" Button */}\n                {filteredAndSortedBranches.length > displayLimit && (\n                    <div className=\"mt-4 flex justify-center\">\n                        <button\n                            className=\"px-4 py-2 text-sm font-medium text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                            onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                        >\n                            {t('common.showMore', { defaultValue: 'Mehr anzeigen' })} ({filteredAndSortedBranches.length - displayLimit} {t('common.remaining', { defaultValue: 'verbleibend' })})\n                        </button>\n                    </div>\n                )}\n            </>\n        );\n    };\n\n    // Mobile-Erkennung\n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    \n    useEffect(() => {\n        const handleResize = () => {\n            setIsMobile(window.innerWidth < 640);\n        };\n        window.addEventListener('resize', handleResize);\n        return () => window.removeEventListener('resize', handleResize);\n    }, []);\n\n    return (\n        <div>\n            {/* Spaltenanzeige und Suche */}\n            <div className=\"space-y-4\">\n                <div className=\"flex items-center justify-between mb-4\">\n                    {/* Linke Seite: \"Neue Niederlassung erstellen\"-Button */}\n                    <div className=\"flex items-center\">\n                        {canCreate && (\n                            <div className=\"relative group\">\n                                <button\n                                    onClick={handleCreate}\n                                    className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                                    style={{ width: '30.19px', height: '30.19px' }}\n                                    aria-label={t('branches.create', { defaultValue: 'Neue Niederlassung' })}\n                                >\n                                    <PlusIcon className=\"h-4 w-4\" />\n                                </button>\n                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                    {t('branches.create', { defaultValue: 'Neue Niederlassung' })}\n                                </div>\n                            </div>\n                        )}\n                    </div>\n                    \n                    {/* Mitte: Titel - Kein Titel in der Mitte notwendig bei dieser Komponente, da der Tab-Header bereits den Titel zeigt */}\n                    <div></div>\n                    \n                    {/* Rechte Seite: Suchfeld, Filter-Button */}\n                    <div className=\"flex items-center gap-1.5\">\n                        <input\n                            type=\"text\"\n                            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n                            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                        />\n                        <div className=\"relative group ml-1\">\n                            <button\n                                className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100'} relative`}\n                                onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                            >\n                                <FunnelIcon className=\"w-5 h-5\" />\n                                {getActiveFilterCount() > 0 && (\n                                    <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                        {getActiveFilterCount()}\n                                    </span>\n                                )}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.filter', { defaultValue: 'Filter' })}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Filter-Modal */}\n                {isFilterModalOpen && (\n                    <FilterPane\n                        columns={[\n                            { id: 'name', label: t('branches.name', { defaultValue: 'Name' }) }\n                        ]}\n                        onApply={applyFilterConditions}\n                        onReset={resetFilterConditions}\n                        savedConditions={filterConditions}\n                        savedOperators={filterLogicalOperators}\n                        tableId={BRANCHES_TABLE_ID}\n                    />\n                )}\n                \n                {/* Gespeicherte Filter als Tags anzeigen */}\n                <SavedFilterTags\n                    tableId={BRANCHES_TABLE_ID}\n                    onSelectFilter={applyFilterConditions}\n                    onReset={resetFilterConditions}\n                    activeFilterName={activeFilterName}\n                    selectedFilterId={selectedFilterId}\n                    onFilterChange={handleFilterChange}\n                    defaultFilterName=\"Alle\"\n                />\n\n                {loading ? (\n                    <div className=\"flex justify-center items-center py-8\">\n                        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n                    </div>\n                ) : (\n                    renderBranches()\n                )}\n            </div>\n\n            {/* Modal/Sidepane fr Branch-Erstellung/Bearbeitung */}\n            {isModalOpen && (\n                <>\n                    {/* Mobile (unter 640px) - Modal */}\n                    {isMobile ? (\n                        <Dialog open={isModalOpen} onClose={handleCloseModal} className=\"relative z-50\">\n                            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                            \n                            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                                <Dialog.Panel className=\"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                                    {/* Header */}\n                                    <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                                        <div className=\"flex items-center justify-between\">\n                                            <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                                                {editingBranch \n                                                    ? t('branches.edit', { defaultValue: 'Niederlassung bearbeiten' })\n                                                    : t('branches.create', { defaultValue: 'Neue Niederlassung' })\n                                                }\n                                            </Dialog.Title>\n                                            <button\n                                                onClick={handleCloseModal}\n                                                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                            >\n                                                <XMarkIcon className=\"h-6 w-6\" />\n                                            </button>\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Form */}\n                                    <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.name', { defaultValue: 'Name' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.name}\n                                                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                required\n                                                autoFocus\n                                            />\n                                        </div>\n\n                                        {/* Adress-Felder */}\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.address', { defaultValue: 'Adresse' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.address}\n                                                onChange={(e) => setFormData({ ...formData, address: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.addressPlaceholder', { defaultValue: 'Strae und Hausnummer' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.city', { defaultValue: 'Stadt' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.city}\n                                                onChange={(e) => setFormData({ ...formData, city: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.cityPlaceholder', { defaultValue: 'z.B. Medelln' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.country', { defaultValue: 'Land' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.country}\n                                                onChange={(e) => setFormData({ ...formData, country: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.countryPlaceholder', { defaultValue: 'z.B. Kolumbien' })}\n                                            />\n                                        </div>\n\n                                        {/* Settings Tabs - nur beim Bearbeiten */}\n                                        {editingBranch && (\n                                            <>\n                                                {/* Tab Navigation */}\n                                                <div className=\"border-b border-gray-200 dark:border-gray-700 mb-4\">\n                                                    <nav className=\"-mb-px flex space-x-2 overflow-x-auto\">\n                                                        {['whatsapp', 'lobbypms', 'boldpayment', 'doorsystem', 'email', 'messages'].map((tab) => (\n                                                            <button\n                                                                key={tab}\n                                                                type=\"button\"\n                                                                onClick={() => setActiveSettingsTab(tab as any)}\n                                                                className={`py-2 px-2 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ${\n                                                                    activeSettingsTab === tab\n                                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                                }`}\n                                                            >\n                                                                {tab === 'whatsapp' ? 'WhatsApp' : tab === 'lobbypms' ? 'LobbyPMS' : tab === 'boldpayment' ? 'Bold Payment' : tab === 'doorsystem' ? 'TTLock' : tab === 'email' ? 'Email' : t('branches.messagesTab', { defaultValue: 'Nachrichten' })}\n                                                            </button>\n                                                        ))}\n                                                    </nav>\n                                                </div>\n\n                                                {/* Tab Content */}\n                                                <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n                                                    {/* WhatsApp Settings Tab */}\n                                                    {activeSettingsTab === 'whatsapp' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                WhatsApp Settings\n                                                            </h4>\n                                                \n                                                <div className=\"space-y-4\">\n                                                    <div>\n                                                        <label htmlFor=\"whatsappProvider\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            Provider\n                                                        </label>\n                                                        <select\n                                                            id=\"whatsappProvider\"\n                                                            value={formData.whatsappSettings.provider}\n                                                            onChange={(e) => setFormData({\n                                                                ...formData,\n                                                                whatsappSettings: {\n                                                                    ...formData.whatsappSettings,\n                                                                    provider: e.target.value as 'twilio' | 'whatsapp-business-api'\n                                                                }\n                                                            })}\n                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                        >\n                                                            <option value=\"twilio\">Twilio</option>\n                                                            <option value=\"whatsapp-business-api\">WhatsApp Business API</option>\n                                                        </select>\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiKey\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Key / Access Token\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiKey'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiKey\"\n                                                                value={formData.whatsappSettings.apiKey}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiKey: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Key / Access Token\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiKey: !prev.whatsappApiKey }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiKey'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappPhoneNumberId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            Phone Number ID\n                                                        </label>\n                                                        <input\n                                                            type=\"text\"\n                                                            id=\"whatsappPhoneNumberId\"\n                                                            value={formData.whatsappSettings.phoneNumberId}\n                                                            onChange={(e) => setFormData({\n                                                                ...formData,\n                                                                whatsappSettings: {\n                                                                    ...formData.whatsappSettings,\n                                                                    phoneNumberId: e.target.value\n                                                                }\n                                                            })}\n                                                            placeholder=\"Phone Number ID\"\n                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                        />\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiSecret\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Secret\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiSecret'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiSecret\"\n                                                                value={formData.whatsappSettings.apiSecret}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiSecret: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Secret\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiSecret: !prev.whatsappApiSecret }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiSecret'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    {/* AI Configuration */}\n                                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                        <div className=\"flex items-center justify-between mb-4\">\n                                                            <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                KI-Konfiguration (AI)\n                                                            </h5>\n                                                            <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                <input\n                                                                    type=\"checkbox\"\n                                                                    checked={formData.whatsappSettings.ai.enabled}\n                                                                    onChange={(e) => setFormData({\n                                                                        ...formData,\n                                                                        whatsappSettings: {\n                                                                            ...formData.whatsappSettings,\n                                                                            ai: {\n                                                                                ...formData.whatsappSettings.ai,\n                                                                                enabled: e.target.checked\n                                                                            }\n                                                                        }\n                                                                    })}\n                                                                    className=\"sr-only peer\"\n                                                                />\n                                                                <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                    {formData.whatsappSettings.ai.enabled ? 'Aktiviert' : 'Deaktiviert'}\n                                                                </span>\n                                                            </label>\n                                                        </div>\n\n                                                        {formData.whatsappSettings.ai.enabled && (\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label htmlFor=\"aiModel\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Modell\n                                                                    </label>\n                                                                    <select\n                                                                        id=\"aiModel\"\n                                                                        value={formData.whatsappSettings.ai.model}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    model: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"gpt-4o\">GPT-4o</option>\n                                                                        <option value=\"gpt-4\">GPT-4</option>\n                                                                        <option value=\"gpt-3.5-turbo\">GPT-3.5 Turbo</option>\n                                                                    </select>\n                                                                </div>\n\n                                                                <div>\n                                                                    <label htmlFor=\"aiSystemPrompt\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        System Prompt\n                                                                    </label>\n                                                                    <textarea\n                                                                        id=\"aiSystemPrompt\"\n                                                                        value={formData.whatsappSettings.ai.systemPrompt}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    systemPrompt: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={4}\n                                                                        placeholder=\"Du bist ein hilfreicher Assistent fr...\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Regeln (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.rules.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    rules: e.target.value.split('\\n').filter(r => r.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={3}\n                                                                        placeholder=\"Antworte immer auf Spanisch&#10;Sei freundlich und professionell\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Quellen/URLs (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.sources.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    sources: e.target.value.split('\\n').filter(s => s.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={2}\n                                                                        placeholder=\"https://wiki.example.com/manila-procedures&#10;https://wiki.example.com/faq\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div className=\"grid grid-cols-2 gap-4\">\n                                                                    <div>\n                                                                        <label htmlFor=\"aiTemperature\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Temperature ({formData.whatsappSettings.ai.temperature})\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"range\"\n                                                                            id=\"aiTemperature\"\n                                                                            min=\"0\"\n                                                                            max=\"2\"\n                                                                            step=\"0.1\"\n                                                                            value={formData.whatsappSettings.ai.temperature}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        temperature: parseFloat(e.target.value)\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full\"\n                                                                        />\n                                                                    </div>\n\n                                                                    <div>\n                                                                        <label htmlFor=\"aiMaxTokens\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Max Tokens\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"number\"\n                                                                            id=\"aiMaxTokens\"\n                                                                            min=\"100\"\n                                                                            max=\"4000\"\n                                                                            step=\"100\"\n                                                                            value={formData.whatsappSettings.ai.maxTokens}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        maxTokens: parseInt(e.target.value) || 500\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        />\n                                                                    </div>\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                                    {/* LobbyPMS Settings Tab */}\n                                                    {activeSettingsTab === 'lobbypms' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                LobbyPMS Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API URL\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.apiUrl}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiUrl: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"https://api.lobbypms.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['lobbyPmsApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.lobbyPmsSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiKey: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Property ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.propertyId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, propertyId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Property ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                            \n                                                            {/* Zimmer-Beschreibungen Sektion */}\n                                                            {editingBranch && (\n                                                                <RoomDescriptionsSection branchId={editingBranch.id} />\n                                                            )}\n                                                        </div>\n                                                    )}\n\n                                                    {/* Bold Payment Settings Tab */}\n                                                    {activeSettingsTab === 'boldpayment' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Bold Payment Settings\n                                                            </h4>\n                                                            {formData.boldPaymentSettings._hasEncryptedValues && (\n                                                                <div className=\"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md\">\n                                                                    <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n                                                                        <strong>Hinweis:</strong> Es sind verschlsselte Werte vorhanden, die mit einem alten Schlssel verschlsselt wurden und nicht mehr entschlsselt werden knnen. \n                                                                        Die Payment-Links funktionieren weiterhin. Um die Werte zu ndern, geben Sie sie neu ein.\n                                                                    </p>\n                                                                </div>\n                                                            )}\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, apiKey: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Merchant ID\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentMerchantId'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.merchantId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, merchantId: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"Merchant ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Environment\n                                                                    </label>\n                                                                    <select\n                                                                        value={formData.boldPaymentSettings.environment}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, environment: e.target.value as 'sandbox' | 'production' }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"sandbox\">Sandbox</option>\n                                                                        <option value=\"production\">Production</option>\n                                                                    </select>\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* TTLock Settings Tab */}\n                                                    {activeSettingsTab === 'doorsystem' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                TTLock Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.clientId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client Secret\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemClientSecret'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.clientSecret}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientSecret: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client Secret\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Username\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.username}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, username: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Username\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Password\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemPassword'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.password}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, password: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Password\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* Email Settings Tab */}\n                                                    {activeSettingsTab === 'email' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Email Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Host\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpHost}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpHost: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"smtp.example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Port\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"number\"\n                                                                        value={formData.emailSettings.smtpPort}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpPort: parseInt(e.target.value) || 587 }\n                                                                        })}\n                                                                        placeholder=\"587\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP User\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpUser}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpUser: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"user@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Password\n                                                                    </label>\n                                                                    <div className=\"relative\">\n                                                                        <input\n                                                                            type={showSecrets['emailSmtpPass'] ? 'text' : 'password'}\n                                                                            value={formData.emailSettings.smtpPass}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                emailSettings: { ...formData.emailSettings, smtpPass: e.target.value }\n                                                                            })}\n                                                                            placeholder=\"Password\"\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                        />\n                                                                        <button\n                                                                            type=\"button\"\n                                                                            onClick={() => setShowSecrets({ ...showSecrets, emailSmtpPass: !showSecrets['emailSmtpPass'] })}\n                                                                            className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                        >\n                                                                            {showSecrets['emailSmtpPass'] ? (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                </svg>\n                                                                            ) : (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                </svg>\n                                                                            )}\n                                                                        </button>\n                                                                    </div>\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Email\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"email\"\n                                                                        value={formData.emailSettings.smtpFromEmail}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromEmail: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"noreply@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Name\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpFromName}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromName: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Branch Name\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                {/* IMAP Settings Section */}\n                                                                <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                                    <div className=\"flex items-center justify-between mb-4\">\n                                                                        <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                            IMAP Settings (Email Reading)\n                                                                        </h5>\n                                                                        <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                            <input\n                                                                                type=\"checkbox\"\n                                                                                checked={formData.emailSettings.imap.enabled}\n                                                                                onChange={(e) => setFormData({\n                                                                                    ...formData,\n                                                                                    emailSettings: {\n                                                                                        ...formData.emailSettings,\n                                                                                        imap: {\n                                                                                            ...formData.emailSettings.imap,\n                                                                                            enabled: e.target.checked\n                                                                                        }\n                                                                                    }\n                                                                                })}\n                                                                                className=\"sr-only peer\"\n                                                                            />\n                                                                            <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                            <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                {formData.emailSettings.imap.enabled ? 'Enabled' : 'Disabled'}\n                                                                            </span>\n                                                                        </label>\n                                                                    </div>\n\n                                                                    {formData.emailSettings.imap.enabled && (\n                                                                        <div className=\"space-y-4\">\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Host\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.host}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, host: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"imap.example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Port\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"number\"\n                                                                                    value={formData.emailSettings.imap.port}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, port: parseInt(e.target.value) || 993 }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"993\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                                    <input\n                                                                                        type=\"checkbox\"\n                                                                                        checked={formData.emailSettings.imap.secure}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, secure: e.target.checked }\n                                                                                            }\n                                                                                        })}\n                                                                                        className=\"sr-only peer\"\n                                                                                    />\n                                                                                    <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                                    <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                        Secure (SSL/TLS)\n                                                                                    </span>\n                                                                                </label>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP User\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.user}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, user: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"user@example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Password\n                                                                                </label>\n                                                                                <div className=\"relative\">\n                                                                                    <input\n                                                                                        type={showSecrets['emailImapPass'] ? 'text' : 'password'}\n                                                                                        value={formData.emailSettings.imap.password}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, password: e.target.value }\n                                                                                            }\n                                                                                        })}\n                                                                                        placeholder=\"Password\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                                    />\n                                                                                    <button\n                                                                                        type=\"button\"\n                                                                                        onClick={() => setShowSecrets({ ...showSecrets, emailImapPass: !showSecrets['emailImapPass'] })}\n                                                                                        className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        {showSecrets['emailImapPass'] ? (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                            </svg>\n                                                                                        ) : (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                            </svg>\n                                                                                        )}\n                                                                                    </button>\n                                                                                </div>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Folder\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.folder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, folder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"INBOX\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    Processed Folder (optional)\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.processedFolder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, processedFolder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"Processed\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                        </div>\n                                                                    )}\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n                                                </div>\n                                            </>\n                                        )}\n\n                                        {/* Buttons */}\n                                        <div className=\"flex justify-end pt-4 gap-2\">\n                                            <div className=\"relative group\">\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={handleCloseModal}\n                                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                                                >\n                                                    <XMarkIcon className=\"h-5 w-5\" />\n                                                </button>\n                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                    {t('common.cancel', { defaultValue: 'Abbrechen' })}\n                                                </div>\n                                            </div>\n                                            <div className=\"relative group\">\n                                                <button\n                                                    type=\"submit\"\n                                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                                                >\n                                                    <CheckIcon className=\"h-5 w-5\" />\n                                                </button>\n                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                    {editingBranch ? t('common.update', { defaultValue: 'Aktualisieren' }) : t('common.create', { defaultValue: 'Erstellen' })}\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </form>\n                                </Dialog.Panel>\n                            </div>\n                        </Dialog>\n                    ) : (\n                        // Desktop - Sidepane (dynamische Breite basierend auf Tab-Anzahl)\n                        <div className=\"fixed inset-y-0 right-0 w-full sm:min-w-[500px] sm:max-w-[600px] bg-white dark:bg-gray-800 shadow-xl z-50 flex flex-col\">\n                            {/* Header */}\n                            <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                                <div className=\"flex items-center justify-between\">\n                                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                                        {editingBranch \n                                            ? t('branches.edit', { defaultValue: 'Niederlassung bearbeiten' })\n                                            : t('branches.create', { defaultValue: 'Neue Niederlassung' })\n                                        }\n                                    </h2>\n                                    <button\n                                        onClick={handleCloseModal}\n                                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                    >\n                                        <XMarkIcon className=\"h-6 w-6\" />\n                                    </button>\n                                </div>\n                            </div>\n                            \n                            {/* Form */}\n                            <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\n                                <div className=\"flex-1 overflow-y-auto min-h-0\">\n                                    <div className=\"p-6 space-y-4\">\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.name', { defaultValue: 'Name' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.name}\n                                                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                required\n                                                autoFocus\n                                            />\n                                        </div>\n\n                                        {/* Adress-Felder */}\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.address', { defaultValue: 'Adresse' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.address}\n                                                onChange={(e) => setFormData({ ...formData, address: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.addressPlaceholder', { defaultValue: 'Strae und Hausnummer' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.city', { defaultValue: 'Stadt' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.city}\n                                                onChange={(e) => setFormData({ ...formData, city: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.cityPlaceholder', { defaultValue: 'z.B. Medelln' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.country', { defaultValue: 'Land' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.country}\n                                                onChange={(e) => setFormData({ ...formData, country: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.countryPlaceholder', { defaultValue: 'z.B. Kolumbien' })}\n                                            />\n                                        </div>\n\n                                        {/* Settings Tabs - nur beim Bearbeiten */}\n                                        {editingBranch && (\n                                            <>\n                                                {/* Tab Navigation */}\n                                                <div className=\"border-b border-gray-200 dark:border-gray-700 mb-4\">\n                                                    <nav className=\"-mb-px flex space-x-2 overflow-x-auto\">\n                                                        {['whatsapp', 'lobbypms', 'boldpayment', 'doorsystem', 'email', 'messages'].map((tab) => (\n                                                            <button\n                                                                key={tab}\n                                                                type=\"button\"\n                                                                onClick={() => setActiveSettingsTab(tab as any)}\n                                                                className={`py-2 px-2 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ${\n                                                                    activeSettingsTab === tab\n                                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                                }`}\n                                                            >\n                                                                {tab === 'whatsapp' ? 'WhatsApp' : tab === 'lobbypms' ? 'LobbyPMS' : tab === 'boldpayment' ? 'Bold Payment' : tab === 'doorsystem' ? 'TTLock' : tab === 'email' ? 'Email' : t('branches.messagesTab', { defaultValue: 'Nachrichten' })}\n                                                            </button>\n                                                        ))}\n                                                    </nav>\n                                                </div>\n\n                                                {/* Tab Content */}\n                                                <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n                                                    {/* WhatsApp Settings Tab */}\n                                                    {activeSettingsTab === 'whatsapp' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                WhatsApp Settings\n                                                            </h4>\n                                                            \n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label htmlFor=\"whatsappProviderDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Provider\n                                                                    </label>\n                                                                    <select\n                                                                        id=\"whatsappProviderDesktop\"\n                                                                        value={formData.whatsappSettings.provider}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                provider: e.target.value as 'twilio' | 'whatsapp-business-api'\n                                                                            }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"twilio\">Twilio</option>\n                                                                        <option value=\"whatsapp-business-api\">WhatsApp Business API</option>\n                                                                    </select>\n                                                                </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiKey\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Key / Access Token\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiKey'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiKey\"\n                                                                value={formData.whatsappSettings.apiKey}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiKey: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Key / Access Token\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiKey: !prev.whatsappApiKey }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiKey'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappPhoneNumberId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            Phone Number ID\n                                                        </label>\n                                                        <input\n                                                            type=\"text\"\n                                                            id=\"whatsappPhoneNumberId\"\n                                                            value={formData.whatsappSettings.phoneNumberId}\n                                                            onChange={(e) => setFormData({\n                                                                ...formData,\n                                                                whatsappSettings: {\n                                                                    ...formData.whatsappSettings,\n                                                                    phoneNumberId: e.target.value\n                                                                }\n                                                            })}\n                                                            placeholder=\"Phone Number ID\"\n                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                        />\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiSecretDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Secret\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiSecret'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiSecretDesktop\"\n                                                                value={formData.whatsappSettings.apiSecret}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiSecret: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Secret\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiSecret: !prev.whatsappApiSecret }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiSecret'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    {/* AI Configuration */}\n                                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                        <div className=\"flex items-center justify-between mb-4\">\n                                                            <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                KI-Konfiguration (AI)\n                                                            </h5>\n                                                            <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                <input\n                                                                    type=\"checkbox\"\n                                                                    checked={formData.whatsappSettings.ai.enabled}\n                                                                    onChange={(e) => setFormData({\n                                                                        ...formData,\n                                                                        whatsappSettings: {\n                                                                            ...formData.whatsappSettings,\n                                                                            ai: {\n                                                                                ...formData.whatsappSettings.ai,\n                                                                                enabled: e.target.checked\n                                                                            }\n                                                                        }\n                                                                    })}\n                                                                    className=\"sr-only peer\"\n                                                                />\n                                                                <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                    {formData.whatsappSettings.ai.enabled ? 'Aktiviert' : 'Deaktiviert'}\n                                                                </span>\n                                                            </label>\n                                                        </div>\n\n                                                        {formData.whatsappSettings.ai.enabled && (\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label htmlFor=\"aiModelDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Modell\n                                                                    </label>\n                                                                    <select\n                                                                        id=\"aiModelDesktop\"\n                                                                        value={formData.whatsappSettings.ai.model}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    model: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"gpt-4o\">GPT-4o</option>\n                                                                        <option value=\"gpt-4\">GPT-4</option>\n                                                                        <option value=\"gpt-3.5-turbo\">GPT-3.5 Turbo</option>\n                                                                    </select>\n                                                                </div>\n\n                                                                <div>\n                                                                    <label htmlFor=\"aiSystemPromptDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        System Prompt\n                                                                    </label>\n                                                                    <textarea\n                                                                        id=\"aiSystemPromptDesktop\"\n                                                                        value={formData.whatsappSettings.ai.systemPrompt}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    systemPrompt: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={4}\n                                                                        placeholder=\"Du bist ein hilfreicher Assistent fr...\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Regeln (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.rules.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    rules: e.target.value.split('\\n').filter(r => r.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={3}\n                                                                        placeholder=\"Antworte immer auf Spanisch&#10;Sei freundlich und professionell\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Quellen/URLs (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.sources.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    sources: e.target.value.split('\\n').filter(s => s.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={2}\n                                                                        placeholder=\"https://wiki.example.com/manila-procedures&#10;https://wiki.example.com/faq\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div className=\"grid grid-cols-2 gap-4\">\n                                                                    <div>\n                                                                        <label htmlFor=\"aiTemperatureDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Temperature ({formData.whatsappSettings.ai.temperature})\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"range\"\n                                                                            id=\"aiTemperatureDesktop\"\n                                                                            min=\"0\"\n                                                                            max=\"2\"\n                                                                            step=\"0.1\"\n                                                                            value={formData.whatsappSettings.ai.temperature}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        temperature: parseFloat(e.target.value)\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full\"\n                                                                        />\n                                                                    </div>\n\n                                                                    <div>\n                                                                        <label htmlFor=\"aiMaxTokensDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Max Tokens\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"number\"\n                                                                            id=\"aiMaxTokensDesktop\"\n                                                                            min=\"100\"\n                                                                            max=\"4000\"\n                                                                            step=\"100\"\n                                                                            value={formData.whatsappSettings.ai.maxTokens}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        maxTokens: parseInt(e.target.value) || 500\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        />\n                                                                    </div>\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                                    {/* LobbyPMS Settings Tab */}\n                                                    {activeSettingsTab === 'lobbypms' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                LobbyPMS Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API URL\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.apiUrl}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiUrl: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"https://api.lobbypms.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['lobbyPmsApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.lobbyPmsSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiKey: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Property ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.propertyId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, propertyId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Property ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                            \n                                                            {/* Zimmer-Beschreibungen Sektion */}\n                                                            {editingBranch && (\n                                                                <RoomDescriptionsSection branchId={editingBranch.id} />\n                                                            )}\n                                                        </div>\n                                                    )}\n\n                                                    {/* Bold Payment Settings Tab */}\n                                                    {activeSettingsTab === 'boldpayment' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Bold Payment Settings\n                                                            </h4>\n                                                            {formData.boldPaymentSettings._hasEncryptedValues && (\n                                                                <div className=\"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md\">\n                                                                    <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n                                                                        <strong>Hinweis:</strong> Es sind verschlsselte Werte vorhanden, die mit einem alten Schlssel verschlsselt wurden und nicht mehr entschlsselt werden knnen. \n                                                                        Die Payment-Links funktionieren weiterhin. Um die Werte zu ndern, geben Sie sie neu ein.\n                                                                    </p>\n                                                                </div>\n                                                            )}\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, apiKey: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Merchant ID\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentMerchantId'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.merchantId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, merchantId: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"Merchant ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Environment\n                                                                    </label>\n                                                                    <select\n                                                                        value={formData.boldPaymentSettings.environment}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, environment: e.target.value as 'sandbox' | 'production' }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"sandbox\">Sandbox</option>\n                                                                        <option value=\"production\">Production</option>\n                                                                    </select>\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* TTLock Settings Tab */}\n                                                    {activeSettingsTab === 'doorsystem' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                TTLock Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.clientId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client Secret\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemClientSecret'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.clientSecret}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientSecret: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client Secret\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Username\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.username}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, username: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Username\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Password\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemPassword'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.password}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, password: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Password\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* Email Settings Tab */}\n                                                    {activeSettingsTab === 'email' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Email Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Host\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpHost}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpHost: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"smtp.example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Port\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"number\"\n                                                                        value={formData.emailSettings.smtpPort}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpPort: parseInt(e.target.value) || 587 }\n                                                                        })}\n                                                                        placeholder=\"587\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP User\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpUser}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpUser: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"user@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Password\n                                                                    </label>\n                                                                    <div className=\"relative\">\n                                                                        <input\n                                                                            type={showSecrets['emailSmtpPass'] ? 'text' : 'password'}\n                                                                            value={formData.emailSettings.smtpPass}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                emailSettings: { ...formData.emailSettings, smtpPass: e.target.value }\n                                                                            })}\n                                                                            placeholder=\"Password\"\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                        />\n                                                                        <button\n                                                                            type=\"button\"\n                                                                            onClick={() => setShowSecrets({ ...showSecrets, emailSmtpPass: !showSecrets['emailSmtpPass'] })}\n                                                                            className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                        >\n                                                                            {showSecrets['emailSmtpPass'] ? (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                </svg>\n                                                                            ) : (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                </svg>\n                                                                            )}\n                                                                        </button>\n                                                                    </div>\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Email\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"email\"\n                                                                        value={formData.emailSettings.smtpFromEmail}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromEmail: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"noreply@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Name\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpFromName}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromName: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Branch Name\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                {/* IMAP Settings Section */}\n                                                                <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                                    <div className=\"flex items-center justify-between mb-4\">\n                                                                        <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                            IMAP Settings (Email Reading)\n                                                                        </h5>\n                                                                        <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                            <input\n                                                                                type=\"checkbox\"\n                                                                                checked={formData.emailSettings.imap.enabled}\n                                                                                onChange={(e) => setFormData({\n                                                                                    ...formData,\n                                                                                    emailSettings: {\n                                                                                        ...formData.emailSettings,\n                                                                                        imap: {\n                                                                                            ...formData.emailSettings.imap,\n                                                                                            enabled: e.target.checked\n                                                                                        }\n                                                                                    }\n                                                                                })}\n                                                                                className=\"sr-only peer\"\n                                                                            />\n                                                                            <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                            <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                {formData.emailSettings.imap.enabled ? 'Enabled' : 'Disabled'}\n                                                                            </span>\n                                                                        </label>\n                                                                    </div>\n\n                                                                    {formData.emailSettings.imap.enabled && (\n                                                                        <div className=\"space-y-4\">\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Host\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.host}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, host: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"imap.example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Port\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"number\"\n                                                                                    value={formData.emailSettings.imap.port}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, port: parseInt(e.target.value) || 993 }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"993\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                                    <input\n                                                                                        type=\"checkbox\"\n                                                                                        checked={formData.emailSettings.imap.secure}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, secure: e.target.checked }\n                                                                                            }\n                                                                                        })}\n                                                                                        className=\"sr-only peer\"\n                                                                                    />\n                                                                                    <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                                    <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                        Secure (SSL/TLS)\n                                                                                    </span>\n                                                                                </label>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP User\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.user}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, user: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"user@example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Password\n                                                                                </label>\n                                                                                <div className=\"relative\">\n                                                                                    <input\n                                                                                        type={showSecrets['emailImapPass'] ? 'text' : 'password'}\n                                                                                        value={formData.emailSettings.imap.password}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, password: e.target.value }\n                                                                                            }\n                                                                                        })}\n                                                                                        placeholder=\"Password\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                                    />\n                                                                                    <button\n                                                                                        type=\"button\"\n                                                                                        onClick={() => setShowSecrets({ ...showSecrets, emailImapPass: !showSecrets['emailImapPass'] })}\n                                                                                        className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        {showSecrets['emailImapPass'] ? (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                            </svg>\n                                                                                        ) : (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                            </svg>\n                                                                                        )}\n                                                                                    </button>\n                                                                                </div>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Folder\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.folder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, folder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"INBOX\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    Processed Folder (optional)\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.processedFolder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, processedFolder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"Processed\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                        </div>\n                                                                    )}\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* Messages Tab */}\n                                                    {activeSettingsTab === 'messages' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                {t('branches.messagesTab', { defaultValue: 'Nachrichten' })}\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                {/* Automatisches Versenden */}\n                                                                <div className=\"border-b border-gray-200 dark:border-gray-700 pb-4\">\n                                                                    <div className=\"flex items-center justify-between\">\n                                                                        <div>\n                                                                            <label className=\"block text-sm font-medium text-gray-900 dark:text-white mb-1\">\n                                                                                {t('branches.autoSendInvitation', { defaultValue: 'Automatisches Versenden aktivieren' })}\n                                                                            </label>\n                                                                            <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                                                                {t('branches.autoSendInvitationDescription', { defaultValue: 'Sendet Check-in-Einladungen automatisch 1 Tag vor Check-in-Date um 08:00 Uhr' })}\n                                                                            </p>\n                                                                        </div>\n                                                                        <input\n                                                                            type=\"checkbox\"\n                                                                            checked={formData.autoSendReservationInvitation}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                autoSendReservationInvitation: e.target.checked\n                                                                            })}\n                                                                            className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                                                                        />\n                                                                    </div>\n                                                                </div>\n\n                                                                {/* Mitteilungsvorlagen */}\n                                                                <div>\n                                                                    <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\n                                                                        {t('branches.messageTemplates', { defaultValue: 'Mitteilungsvorlagen' })}\n                                                                    </h5>\n                                                                    \n                                                                    <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-4\">\n                                                                        {t('branches.messageTemplatesDescription', { defaultValue: 'Konfiguriere die Vorlagen fr Check-in-Einladungen und Check-in-Besttigungen' })}\n                                                                    </p>\n\n                                                                    {/* Template Type Selector */}\n                                                                    <div className=\"mb-4\">\n                                                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                                                            {t('branches.messageType', { defaultValue: 'Mitteilungstyp' })}\n                                                                        </label>\n                                                                        <select\n                                                                            value={selectedTemplateType}\n                                                                            onChange={(e) => setSelectedTemplateType(e.target.value as 'checkInInvitation' | 'checkInConfirmation')}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        >\n                                                                            <option value=\"checkInInvitation\">\n                                                                                {t('branches.messageType.checkInInvitation', { defaultValue: 'Check-in-Einladung' })}\n                                                                            </option>\n                                                                            <option value=\"checkInConfirmation\">\n                                                                                {t('branches.messageType.checkInConfirmation', { defaultValue: 'Check-in-Besttigung' })}\n                                                                            </option>\n                                                                        </select>\n                                                                    </div>\n\n                                                                    {/* Language Selector */}\n                                                                    <div className=\"mb-4\">\n                                                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                                                            {t('branches.language', { defaultValue: 'Sprache' })}\n                                                                        </label>\n                                                                        <select\n                                                                            value={selectedLanguage}\n                                                                            onChange={(e) => setSelectedLanguage(e.target.value as 'en' | 'es' | 'de')}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        >\n                                                                            <option value=\"en\">{t('branches.language.en', { defaultValue: 'Englisch' })}</option>\n                                                                            <option value=\"es\">{t('branches.language.es', { defaultValue: 'Spanisch' })}</option>\n                                                                            <option value=\"de\">{t('branches.language.de', { defaultValue: 'Deutsch' })}</option>\n                                                                        </select>\n                                                                    </div>\n\n                                                                    {/* Template Fields */}\n                                                                    {(() => {\n                                                                        const currentTemplate = formData.messageTemplates?.[selectedTemplateType]?.[selectedLanguage] || {\n                                                                            whatsappTemplateName: '',\n                                                                            whatsappTemplateParams: [] as string[],\n                                                                            emailSubject: '',\n                                                                            emailContent: ''\n                                                                        };\n                                                                        \n                                                                        return (\n                                                                            <div className=\"space-y-4\">\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.whatsappTemplateName', { defaultValue: 'WhatsApp Template Name' })}\n                                                                                    </label>\n                                                                                    <input\n                                                                                        type=\"text\"\n                                                                                        value={currentTemplate.whatsappTemplateName || ''}\n                                                                                        onChange={(e) => {\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            whatsappTemplateName: e.target.value\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"reservation_checkin_invitation_en\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                </div>\n\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.whatsappTemplateParams', { defaultValue: 'WhatsApp Template Parameter' })}\n                                                                                    </label>\n                                                                                    <input\n                                                                                        type=\"text\"\n                                                                                        value={Array.isArray(currentTemplate.whatsappTemplateParams) ? currentTemplate.whatsappTemplateParams.join(', ') : (currentTemplate.whatsappTemplateParams || '')}\n                                                                                        onChange={(e) => {\n                                                                                            const params = e.target.value.split(',').map(p => p.trim()).filter(p => p);\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            whatsappTemplateParams: params\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"{{1}}, {{2}}, {{3}}\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                                                                                        {t('branches.whatsappTemplateParamsHint', { defaultValue: 'Komma-separiert, z.B. {{1}}, {{2}}, {{3}}' })}\n                                                                                    </p>\n                                                                                </div>\n\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.emailSubject', { defaultValue: 'Email Betreff' })}\n                                                                                    </label>\n                                                                                    <input\n                                                                                        type=\"text\"\n                                                                                        value={currentTemplate.emailSubject || ''}\n                                                                                        onChange={(e) => {\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            emailSubject: e.target.value\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"Welcome to La Familia Hostel - Online Check-in\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                </div>\n\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.emailContent', { defaultValue: 'Email Inhalt' })}\n                                                                                    </label>\n                                                                                    <textarea\n                                                                                        rows={10}\n                                                                                        value={currentTemplate.emailContent || ''}\n                                                                                        onChange={(e) => {\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            emailContent: e.target.value\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"Hello {{guestName}}, ...\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                                                                                        {t('branches.templateVariables', { defaultValue: 'Verfgbare Variablen' })}: \n                                                                                        <span className=\"font-mono\">\n                                                                                            {selectedTemplateType === 'checkInInvitation' \n                                                                                                ? t('branches.templateVariables.checkInInvitation', { defaultValue: '{{guestName}}, {{checkInLink}}, {{paymentLink}}' })\n                                                                                                : t('branches.templateVariables.checkInConfirmation', { defaultValue: '{{guestName}}, {{roomDisplay}}, {{doorPin}}, {{doorAppName}}' })\n                                                                                            }\n                                                                                        </span>\n                                                                                    </p>\n                                                                                </div>\n                                                                            </div>\n                                                                        );\n                                                                    })()}\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n                                                </div>\n                                            </>\n                                        )}\n                                    </div>\n                                </div>\n\n                                {/* Buttons */}\n                                <div className=\"flex justify-end pt-4 gap-2 px-6 pb-6 border-t dark:border-gray-700\">\n                                    <div className=\"relative group\">\n                                        <button\n                                            type=\"button\"\n                                            onClick={handleCloseModal}\n                                            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                                        >\n                                            <XMarkIcon className=\"h-5 w-5\" />\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {t('common.cancel', { defaultValue: 'Abbrechen' })}\n                                        </div>\n                                    </div>\n                                    <div className=\"relative group\">\n                                        <button\n                                            type=\"submit\"\n                                            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                                        >\n                                            <CheckIcon className=\"h-5 w-5\" />\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {editingBranch ? t('common.update', { defaultValue: 'Aktualisieren' }) : t('common.create', { defaultValue: 'Erstellen' })}\n                                        </div>\n                                    </div>\n                                </div>\n                            </form>\n                        </div>\n                    )}\n                </>\n            )}\n        </div>\n    );\n};\n\nexport default BranchManagementTab;\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface CreateTourProviderModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onProviderCreated: (newProvider: TourProvider) => void;\n}\n\nconst CreateTourProviderModal = ({ isOpen, onClose, onProviderCreated }: CreateTourProviderModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [name, setName] = useState('');\n    const [phone, setPhone] = useState('');\n    const [email, setEmail] = useState('');\n    const [contactPerson, setContactPerson] = useState('');\n    const [notes, setNotes] = useState('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const branchesRes = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Reset form when modal opens/closes\n    useEffect(() => {\n        if (!isOpen) {\n            setName('');\n            setPhone('');\n            setEmail('');\n            setContactPerson('');\n            setNotes('');\n            setBranchId('');\n            setError(null);\n        }\n    }, [isOpen]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierung\n        if (!name.trim()) {\n            setError(t('tours.providers.validation.nameRequired', { defaultValue: 'Name ist erforderlich' }));\n            return;\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.post(API_ENDPOINTS.TOUR_PROVIDERS.BASE, {\n                name: name.trim(),\n                phone: phone.trim() || null,\n                email: email.trim() || null,\n                contactPerson: contactPerson.trim() || null,\n                notes: notes.trim() || null,\n                branchId: branchId ? Number(branchId) : null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tours.providers.created', { defaultValue: 'Tour-Provider erfolgreich erstellt' }),\n                    'success'\n                );\n                onProviderCreated(response.data.data);\n                handleClose();\n            } else {\n                throw new Error(response.data?.message || t('tours.providers.createError', { defaultValue: 'Fehler beim Erstellen des Providers' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error creating provider:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        setName('');\n        setPhone('');\n        setEmail('');\n        setContactPerson('');\n        setNotes('');\n        setBranchId('');\n        setError(null);\n        onClose();\n    };\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.providers.create', { defaultValue: 'Neuer Tour-Provider' })}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.providers.create', { defaultValue: 'Neuer Tour-Provider' })}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default CreateTourProviderModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface EditTourProviderModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    provider: TourProvider | null;\n    onProviderUpdated: (updatedProvider: TourProvider) => void;\n}\n\nconst EditTourProviderModal = ({ isOpen, onClose, provider, onProviderUpdated }: EditTourProviderModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [name, setName] = useState('');\n    const [phone, setPhone] = useState('');\n    const [email, setEmail] = useState('');\n    const [contactPerson, setContactPerson] = useState('');\n    const [notes, setNotes] = useState('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches und setze Form-Daten\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const branchesRes = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Setze Form-Daten wenn Provider geladen wird\n    useEffect(() => {\n        if (provider) {\n            setName(provider.name || '');\n            setPhone(provider.phone || '');\n            setEmail(provider.email || '');\n            setContactPerson(provider.contactPerson || '');\n            setNotes(provider.notes || '');\n            setBranchId(provider.branchId || '');\n        } else {\n            setName('');\n            setPhone('');\n            setEmail('');\n            setContactPerson('');\n            setNotes('');\n            setBranchId('');\n        }\n        setError(null);\n    }, [provider, isOpen]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!provider) return;\n        setError(null);\n\n        // Validierung\n        if (!name.trim()) {\n            setError(t('tours.providers.validation.nameRequired', { defaultValue: 'Name ist erforderlich' }));\n            return;\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.put(API_ENDPOINTS.TOUR_PROVIDERS.BY_ID(provider.id), {\n                name: name.trim(),\n                phone: phone.trim() || null,\n                email: email.trim() || null,\n                contactPerson: contactPerson.trim() || null,\n                notes: notes.trim() || null,\n                branchId: branchId ? Number(branchId) : null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tours.providers.updated', { defaultValue: 'Tour-Provider erfolgreich aktualisiert' }),\n                    'success'\n                );\n                onProviderUpdated(response.data.data);\n                handleClose();\n            } else {\n                throw new Error(response.data?.message || t('tours.providers.updateError', { defaultValue: 'Fehler beim Aktualisieren des Providers' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error updating provider:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        onClose();\n    };\n\n    if (!provider) return null;\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.providers.edit', { defaultValue: 'Tour-Provider bearbeiten' })}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.providers.edit', { defaultValue: 'Tour-Provider bearbeiten' })}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default EditTourProviderModal;\n\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PencilIcon, TrashIcon, PlusIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport { TourProvider } from '../../types/tour.ts';\nimport CreateTourProviderModal from './CreateTourProviderModal.tsx';\nimport EditTourProviderModal from './EditTourProviderModal.tsx';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useError } from '../../contexts/ErrorContext.tsx';\n\ninterface TourProvidersTabProps {\n}\n\n// ProviderCard-Komponente fr mobile und Desktop-Ansicht\nconst ProviderCard: React.FC<{\n    provider: TourProvider;\n    onEdit: (provider: TourProvider) => void;\n    onDelete: (providerId: number) => void;\n    canEdit: boolean;\n    canDelete: boolean;\n}> = ({ provider, onEdit, onDelete, canEdit, canDelete }) => {\n    const { t } = useTranslation();\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4\">\n            {/* Header mit Provider-Name und Aktionen */}\n            <div className=\"flex justify-between items-start mb-2\">\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{provider.name}</h3>\n                \n                <div className=\"flex space-x-2\">\n                    {canEdit && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onEdit(provider)}\n                                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                                title={t('common.edit', { defaultValue: 'Bearbeiten' })}\n                            >\n                                <PencilIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.edit', { defaultValue: 'Bearbeiten' })}\n                            </div>\n                        </div>\n                    )}\n                    \n                    {canDelete && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onDelete(provider.id)}\n                                className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n                                title={t('common.delete', { defaultValue: 'Lschen' })}\n                            >\n                                <TrashIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.delete', { defaultValue: 'Lschen' })}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Details */}\n            <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                {provider.contactPerson && (\n                    <p>\n                        <span className=\"font-medium\">{t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}:</span>{' '}\n                        {provider.contactPerson}\n                    </p>\n                )}\n                {provider.phone && (\n                    <p>\n                        <span className=\"font-medium\">{t('tours.providers.phone', { defaultValue: 'Telefon' })}:</span>{' '}\n                        {provider.phone}\n                    </p>\n                )}\n                {provider.email && (\n                    <p>\n                        <span className=\"font-medium\">{t('tours.providers.email', { defaultValue: 'E-Mail' })}:</span>{' '}\n                        {provider.email}\n                    </p>\n                )}\n                {provider.notes && (\n                    <p className=\"mt-2 text-xs\">\n                        <span className=\"font-medium\">{t('tours.providers.notes', { defaultValue: 'Notizen' })}:</span>{' '}\n                        {provider.notes}\n                    </p>\n                )}\n            </div>\n        </div>\n    );\n};\n\nconst TourProvidersTab: React.FC<TourProvidersTabProps> = () => {\n    const { t } = useTranslation();\n    const { showMessage } = useMessage();\n    \n    // Fehlerbehandlung mit Fallback\n    const errorContext = useError();\n    const handleErrorContext = errorContext?.handleError || ((err: unknown, context?: Record<string, unknown>) => {\n        console.error('Error:', err, context);\n        const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                             (err as { message?: string })?.message || \n                             t('errors.unknownError', { defaultValue: 'Ein Fehler ist aufgetreten' });\n        showMessage(errorMessage, 'error');\n    });\n    const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n    const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n    const [editingProvider, setEditingProvider] = useState<TourProvider | null>(null);\n    const [providers, setProviders] = useState<TourProvider[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [searchTerm, setSearchTerm] = useState('');\n    const { hasPermission } = usePermissions();\n\n    // Berechtigungen prfen\n    const canCreate = hasPermission('tour_providers', 'write', 'table');\n    const canEdit = hasPermission('tour_providers', 'write', 'table');\n    const canDelete = hasPermission('tour_providers', 'write', 'table');\n\n    // Providers laden\n    const fetchProviders = useCallback(async () => {\n        setLoading(true);\n        try {\n            const response = await axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS.BASE);\n            const data = response.data?.data || response.data || [];\n            setProviders(Array.isArray(data) ? data : []);\n        } catch (error: unknown) {\n            console.error('Error loading tour providers:', error);\n            handleErrorContext(error);\n            const errorMessage = error.response?.data?.message || t('tours.providers.loadError', { defaultValue: 'Fehler beim Laden der Provider' });\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    }, [handleErrorContext]);\n\n    useEffect(() => {\n        fetchProviders();\n    }, [fetchProviders]);\n\n    // Gefilterte Provider\n    const filteredProviders = providers.filter(provider => {\n        if (!searchTerm) return true;\n        const search = searchTerm.toLowerCase();\n        return (\n            provider.name.toLowerCase().includes(search) ||\n            provider.contactPerson?.toLowerCase().includes(search) ||\n            provider.phone?.toLowerCase().includes(search) ||\n            provider.email?.toLowerCase().includes(search) ||\n            provider.notes?.toLowerCase().includes(search)\n        );\n    });\n\n    // Handler fr Create\n    const handleCreate = () => {\n        setIsCreateModalOpen(true);\n    };\n\n    // Handler fr Edit\n    const handleEdit = (provider: TourProvider) => {\n        setEditingProvider(provider);\n        setIsEditModalOpen(true);\n    };\n\n    // Handler fr Delete\n    const handleDelete = async (providerId: number) => {\n        if (!window.confirm(t('tours.providers.deleteConfirm', { defaultValue: 'Mchten Sie diesen Provider wirklich lschen?' }))) {\n            return;\n        }\n\n        try {\n            await axiosInstance.delete(API_ENDPOINTS.TOUR_PROVIDERS.BY_ID(providerId));\n            showMessage(\n                t('tours.providers.deleted', { defaultValue: 'Tour-Provider erfolgreich gelscht' }),\n                'success'\n            );\n            fetchProviders();\n        } catch (error: any) {\n            console.error('Error deleting provider:', error);\n            handleErrorContext(error);\n            const errorMessage = error.response?.data?.message || t('errors.unknownError');\n            showMessage(errorMessage, 'error');\n        }\n    };\n\n    // Handler fr Provider erstellt\n    const handleProviderCreated = (newProvider: TourProvider) => {\n        fetchProviders();\n    };\n\n    // Handler fr Provider aktualisiert\n    const handleProviderUpdated = (updatedProvider: TourProvider) => {\n        fetchProviders();\n    };\n\n    if (loading) {\n        return (\n            <div className=\"flex justify-center items-center py-12\">\n                <div className=\"text-gray-500 dark:text-gray-400\">{t('common.loading', { defaultValue: 'Lade...' })}</div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"space-y-4\">\n            {/* Header mit Suche und Create-Button */}\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n                <div className=\"flex-1 w-full sm:max-w-md\">\n                    <input\n                        type=\"text\"\n                        placeholder={t('tours.providers.search', { defaultValue: 'Provider suchen...' })}\n                        value={searchTerm}\n                        onChange={(e) => setSearchTerm(e.target.value)}\n                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                </div>\n                {canCreate && (\n                    <div className=\"relative group\">\n                        <button \n                            onClick={handleCreate}\n                            className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                            style={{ width: '30.19px', height: '30.19px' }}\n                            aria-label={t('tours.providers.create', { defaultValue: 'Neuer Provider' })}\n                        >\n                            <PlusIcon className=\"h-4 w-4\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {t('tours.providers.create', { defaultValue: 'Neuer Provider' })}\n                        </div>\n                    </div>\n                )}\n            </div>\n\n            {/* Provider-Liste */}\n            {filteredProviders.length === 0 ? (\n                <div className=\"text-center py-12 text-gray-500 dark:text-gray-400\">\n                    {searchTerm\n                        ? t('tours.providers.noResults', { defaultValue: 'Keine Provider gefunden' })\n                        : t('tours.providers.empty', { defaultValue: 'Keine Tour-Provider vorhanden' })}\n                </div>\n            ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                    {filteredProviders.map(provider => (\n                        <ProviderCard\n                            key={provider.id}\n                            provider={provider}\n                            onEdit={handleEdit}\n                            onDelete={handleDelete}\n                            canEdit={canEdit}\n                            canDelete={canDelete}\n                        />\n                    ))}\n                </div>\n            )}\n\n            {/* Modals */}\n            <CreateTourProviderModal\n                isOpen={isCreateModalOpen}\n                onClose={() => setIsCreateModalOpen(false)}\n                onProviderCreated={handleProviderCreated}\n            />\n            <EditTourProviderModal\n                isOpen={isEditModalOpen}\n                onClose={() => {\n                    setIsEditModalOpen(false);\n                    setEditingProvider(null);\n                }}\n                provider={editingProvider}\n                onProviderUpdated={handleProviderUpdated}\n            />\n        </div>\n    );\n};\n\nexport default TourProvidersTab;\n\n","export enum TourType {\r\n  OWN = 'own',\r\n  EXTERNAL = 'external'\r\n}\r\n\r\nexport enum TourBookingStatus {\r\n  CONFIRMED = 'confirmed',\r\n  CANCELLED = 'cancelled',\r\n  COMPLETED = 'completed',\r\n  NO_SHOW = 'no_show'\r\n}\r\n\r\nexport enum MessageDirection {\r\n  OUTGOING = 'outgoing',\r\n  INCOMING = 'incoming'\r\n}\r\n\r\nexport enum MessageStatus {\r\n  SENT = 'sent',\r\n  DELIVERED = 'delivered',\r\n  READ = 'read',\r\n  FAILED = 'failed'\r\n}\r\n\r\nexport interface Tour {\r\n  id: number;\r\n  title: string;\r\n  description?: string | null;\r\n  type: TourType;\r\n  isActive: boolean;\r\n  duration?: number | null;\r\n  maxParticipants?: number | null;\r\n  minParticipants?: number | null;\r\n  price?: number | string | null;\r\n  currency?: string | null;\r\n  location?: string | null;\r\n  meetingPoint?: string | null;\r\n  includes?: string | null;\r\n  excludes?: string | null;\r\n  requirements?: string | null;\r\n  totalCommission?: number | string | null;\r\n  totalCommissionPercent?: number | string | null;\r\n  sellerCommissionPercent?: number | string | null;\r\n  sellerCommissionFixed?: number | string | null;\r\n  externalProviderId?: number | null;\r\n  externalProvider?: TourProvider | null;\r\n  externalBookingUrl?: string | null;\r\n  imageUrl?: string | null;\r\n  galleryUrls?: string[] | null;\r\n  availableFrom?: string | null;\r\n  availableTo?: string | null;\r\n  recurringSchedule?: any | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  branch?: { id: number; name: string } | null;\r\n  createdById?: number | null;\r\n  createdBy?: { id: number; firstName: string; lastName: string } | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourProvider {\r\n  id: number;\r\n  name: string;\r\n  phone?: string | null;\r\n  email?: string | null;\r\n  contactPerson?: string | null;\r\n  notes?: string | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourBooking {\r\n  id: number;\r\n  tourId: number;\r\n  tour?: Tour | null;\r\n  bookingDate: string;\r\n  tourDate: string;\r\n  numberOfParticipants: number;\r\n  totalPrice: number | string;\r\n  currency: string;\r\n  customerName: string;\r\n  customerEmail?: string | null;\r\n  customerPhone?: string | null;\r\n  customerNotes?: string | null;\r\n  paymentStatus: 'pending' | 'paid' | 'partially_paid' | 'refunded';\r\n  amountPaid?: number | string | null;\r\n  amountPending?: number | string | null;\r\n  paymentLink?: string | null;\r\n  paymentDeadline?: string | null;\r\n  autoCancelEnabled?: boolean;\r\n  reservedUntil?: string | null;\r\n  bookedById?: number | null;\r\n  bookedBy?: { id: number; firstName: string; lastName: string } | null;\r\n  commissionAmount?: number | string | null;\r\n  commissionCalculatedAt?: string | null;\r\n  status: TourBookingStatus;\r\n  cancelledBy?: string | null;\r\n  cancelledAt?: string | null;\r\n  cancelledReason?: string | null;\r\n  isExternal: boolean;\r\n  externalBookingId?: string | null;\r\n  externalStatus?: string | null;\r\n  externalMessage?: string | null;\r\n  alternativeTours?: number[] | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  branch?: { id: number; name: string } | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourReservation {\r\n  id: number;\r\n  tourId: number;\r\n  tour?: Tour | null;\r\n  bookingId: number;\r\n  booking?: TourBooking | null;\r\n  reservationId: number;\r\n  reservation?: any | null;\r\n  tourPrice: number | string;\r\n  accommodationPrice: number | string;\r\n  currency: string;\r\n  tourPricePaid?: number | string | null;\r\n  tourPricePending?: number | string | null;\r\n  accommodationPaid?: number | string | null;\r\n  accommodationPending?: number | string | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourWhatsAppMessage {\r\n  id: number;\r\n  bookingId: number;\r\n  booking?: TourBooking | null;\r\n  direction: MessageDirection;\r\n  message: string;\r\n  phoneNumber: string;\r\n  sentAt: string;\r\n  status: MessageStatus;\r\n  errorMessage?: string | null;\r\n  processed: boolean;\r\n  processedAt?: string | null;\r\n  action?: string | null;\r\n  extractedData?: any | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourType, TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface CreateTourModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTourCreated: (newTour: Tour) => void;\n}\n\nconst CreateTourModal = ({ isOpen, onClose, onTourCreated }: CreateTourModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [title, setTitle] = useState('');\n    const [description, setDescription] = useState('');\n    const [type, setType] = useState<TourType>(TourType.OWN);\n    const [isActive, setIsActive] = useState(true);\n    const [duration, setDuration] = useState<number | ''>('');\n    const [maxParticipants, setMaxParticipants] = useState<number | ''>('');\n    const [minParticipants, setMinParticipants] = useState<number | ''>('');\n    const [price, setPrice] = useState<number | ''>('');\n    const [currency, setCurrency] = useState('COP');\n    const [location, setLocation] = useState('');\n    const [meetingPoint, setMeetingPoint] = useState('');\n    const [includes, setIncludes] = useState('');\n    const [excludes, setExcludes] = useState('');\n    const [requirements, setRequirements] = useState('');\n    const [totalCommission, setTotalCommission] = useState<number | ''>('');\n    const [totalCommissionPercent, setTotalCommissionPercent] = useState<number | ''>('');\n    const [sellerCommissionPercent, setSellerCommissionPercent] = useState<number | ''>('');\n    const [sellerCommissionFixed, setSellerCommissionFixed] = useState<number | ''>('');\n    const [externalProviderId, setExternalProviderId] = useState<number | ''>('');\n    const [externalBookingUrl, setExternalBookingUrl] = useState('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    const [imageFile, setImageFile] = useState<File | null>(null);\n    const [imagePreview, setImagePreview] = useState<string | null>(null);\n    const [galleryFiles, setGalleryFiles] = useState<File[]>([]);\n    const [galleryPreviews, setGalleryPreviews] = useState<string[]>([]);\n    const [uploadingImage, setUploadingImage] = useState(false);\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [tourProviders, setTourProviders] = useState<TourProvider[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches und TourProviders\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const [branchesRes, providersRes] = await Promise.all([\n                    axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE),\n                    axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS?.BASE || '/api/tour-providers')\n                ]);\n                \n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n                setTourProviders(providersRes.data?.data || providersRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Reset form when modal opens/closes\n    useEffect(() => {\n        if (!isOpen) {\n            setTitle('');\n            setDescription('');\n            setType(TourType.OWN);\n            setIsActive(true);\n            setDuration('');\n            setMaxParticipants('');\n            setMinParticipants('');\n            setPrice('');\n            setCurrency('COP');\n            setLocation('');\n            setMeetingPoint('');\n            setIncludes('');\n            setExcludes('');\n            setRequirements('');\n            setTotalCommission('');\n            setTotalCommissionPercent('');\n            setSellerCommissionPercent('');\n            setSellerCommissionFixed('');\n            setExternalProviderId('');\n            setExternalBookingUrl('');\n            setBranchId('');\n            setImageFile(null);\n            setImagePreview(null);\n            setGalleryFiles([]);\n            setGalleryPreviews([]);\n            setError(null);\n        }\n    }, [isOpen]);\n    \n    // Bild-Vorschau erstellen\n    const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (file) {\n            setImageFile(file);\n            const reader = new FileReader();\n            reader.onloadend = () => {\n                setImagePreview(reader.result as string);\n            };\n            reader.readAsDataURL(file);\n        }\n    };\n    \n    const handleGalleryChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const files = Array.from(e.target.files || []);\n        if (files.length > 0) {\n            setGalleryFiles(prev => [...prev, ...files]);\n            files.forEach(file => {\n                const reader = new FileReader();\n                reader.onloadend = () => {\n                    setGalleryPreviews(prev => [...prev, reader.result as string]);\n                };\n                reader.readAsDataURL(file);\n            });\n        }\n    };\n    \n    const removeGalleryImage = (index: number) => {\n        setGalleryFiles(prev => prev.filter((_, i) => i !== index));\n        setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierungen\n        if (!title.trim() || title.trim().length < 3) {\n            setError(t('tours.validation.titleMinLength', { defaultValue: 'Titel muss mindestens 3 Zeichen lang sein' }));\n            return;\n        }\n\n        const maxPart = maxParticipants ? Number(maxParticipants) : null;\n        const minPart = minParticipants ? Number(minParticipants) : null;\n        if (maxPart !== null && minPart !== null && maxPart < minPart) {\n            setError(t('tours.validation.maxParticipantsMin', { defaultValue: 'Maximale Teilnehmeranzahl muss >= minimale Teilnehmeranzahl sein' }));\n            return;\n        }\n\n        if (type === TourType.EXTERNAL && !externalProviderId) {\n            setError(t('tours.validation.externalProviderRequired', { defaultValue: 'Externer Anbieter ist bei externen Touren erforderlich' }));\n            return;\n        }\n\n        // availableFrom <= availableTo Validierung (falls beide gesetzt) - wird im Backend validiert\n\n        // Preise >= 0\n        if (price !== '' && Number(price) < 0) {\n            setError(t('tours.validation.priceNonNegative', { defaultValue: 'Preis muss >= 0 sein' }));\n            return;\n        }\n\n        if (totalCommission !== '' && Number(totalCommission) < 0) {\n            setError(t('tours.validation.commissionNonNegative', { defaultValue: 'Kommission muss >= 0 sein' }));\n            return;\n        }\n\n        setLoading(true);\n\n        try {\n            const tourData: {\n                title: string;\n                description: string | null;\n                type: TourType;\n                isActive: boolean;\n                duration: number | null;\n                maxParticipants: number | null;\n                minParticipants: number | null;\n                price: number | null;\n                currency: string;\n                location: string | null;\n                meetingPoint: string | null;\n                includes: string | null;\n                excludes: string | null;\n                requirements: string | null;\n                totalCommission: number | null;\n                totalCommissionPercent: number | null;\n                sellerCommissionPercent: number | null;\n                sellerCommissionFixed: number | null;\n                externalProviderId: number | null;\n                externalBookingUrl: string | null;\n                branchId: number | null;\n            } = {\n                title,\n                description: description || null,\n                type,\n                isActive,\n                duration: duration ? Number(duration) : null,\n                maxParticipants: maxParticipants ? Number(maxParticipants) : null,\n                minParticipants: minParticipants ? Number(minParticipants) : null,\n                price: price ? Number(price) : null,\n                currency: currency || 'COP',\n                location: location || null,\n                meetingPoint: meetingPoint || null,\n                includes: includes || null,\n                excludes: excludes || null,\n                requirements: requirements || null,\n                totalCommission: totalCommission ? Number(totalCommission) : null,\n                totalCommissionPercent: totalCommissionPercent ? Number(totalCommissionPercent) : null,\n                sellerCommissionPercent: sellerCommissionPercent ? Number(sellerCommissionPercent) : null,\n                sellerCommissionFixed: sellerCommissionFixed ? Number(sellerCommissionFixed) : null,\n                externalProviderId: externalProviderId ? Number(externalProviderId) : null,\n                externalBookingUrl: externalBookingUrl || null,\n                branchId: branchId ? Number(branchId) : null\n            };\n\n            const response = await axiosInstance.post(API_ENDPOINTS.TOURS.BASE, tourData);\n            \n            if (response.data.success) {\n                const createdTour = response.data.data;\n                \n                // Hauptbild hochladen (falls vorhanden)\n                if (imageFile && createdTour.id) {\n                    try {\n                        setUploadingImage(true);\n                        const formData = new FormData();\n                        formData.append('image', imageFile);\n                        await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_IMAGE(createdTour.id), formData, {\n                            headers: { 'Content-Type': 'multipart/form-data' }\n                        });\n                    } catch (imgErr: unknown) {\n                        console.error('Error uploading main image:', imgErr);\n                        showMessage(t('tours.imageUploadError', 'Tour erstellt, aber Fehler beim Hochladen des Bildes'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                // Galerie-Bilder hochladen (falls vorhanden)\n                if (galleryFiles.length > 0 && createdTour.id) {\n                    try {\n                        setUploadingImage(true);\n                        for (const file of galleryFiles) {\n                            const formData = new FormData();\n                            formData.append('image', file);\n                            await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_GALLERY(createdTour.id), formData, {\n                                headers: { 'Content-Type': 'multipart/form-data' }\n                            });\n                        }\n                    } catch (galleryErr: unknown) {\n                        console.error('Error uploading gallery images:', galleryErr);\n                        showMessage(t('tours.galleryUploadError', 'Tour erstellt, aber Fehler beim Hochladen der Galerie-Bilder'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                showMessage(t('tours.createSuccess', 'Tour erfolgreich erstellt'), 'success');\n                // Lade Tour neu, um Bilder zu erhalten\n                const updatedResponse = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(createdTour.id));\n                onTourCreated(updatedResponse.data.data);\n                handleClose();\n            } else {\n                setError(response.data.message || t('errors.saveError'));\n            }\n        } catch (err: unknown) {\n            console.error('Error creating tour:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.saveError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        setTitle('');\n        setDescription('');\n        setType(TourType.OWN);\n        setIsActive(true);\n        setDuration('');\n        setMaxParticipants('');\n        setMinParticipants('');\n        setPrice('');\n        setCurrency('COP');\n        setLocation('');\n        setMeetingPoint('');\n        setIncludes('');\n        setExcludes('');\n        setRequirements('');\n        setTotalCommission('');\n        setTotalCommissionPercent('');\n        setSellerCommissionPercent('');\n        setSellerCommissionFixed('');\n        setExternalProviderId('');\n        setExternalBookingUrl('');\n        setBranchId('');\n        setImageFile(null);\n        setImagePreview(null);\n        setGalleryFiles([]);\n        setGalleryPreviews([]);\n        setError(null);\n        onClose();\n    };\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\n                        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.create', 'Neue Tour erstellen')}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.create', 'Neue Tour erstellen')}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Bilder */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.images', 'Bilder')}\n                            </h3>\n                            \n                            {/* Hauptbild */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.mainImage', 'Hauptbild')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    onChange={handleImageChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {imagePreview && (\n                                    <div className=\"mt-2 relative inline-block\">\n                                        <img\n                                            src={imagePreview}\n                                            alt=\"Vorschau\"\n                                            className=\"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                        />\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* Galerie */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.gallery', 'Galerie')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    multiple\n                                    onChange={handleGalleryChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {galleryPreviews.length > 0 && (\n                                    <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                                        {galleryPreviews.map((preview, index) => (\n                                            <div key={index} className=\"relative\">\n                                                <img\n                                                    src={preview}\n                                                    alt={`Galerie ${index + 1}`}\n                                                    className=\"w-full h-24 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                                />\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={() => removeGalleryImage(index)}\n                                                    className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                    title={t('tours.deleteImage', 'Bild lschen')}\n                                                >\n                                                    <XMarkIcon className=\"h-4 w-4\" />\n                                                </button>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default CreateTourModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS, getTourImageUrl, getTourGalleryImageUrl } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourType, TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface EditTourModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTourUpdated: (updatedTour: Tour) => void;\n    tour: Tour | null;\n}\n\nconst EditTourModal = ({ isOpen, onClose, onTourUpdated, tour }: EditTourModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [title, setTitle] = useState(tour?.title || '');\n    const [description, setDescription] = useState(tour?.description || '');\n    const [type, setType] = useState<TourType>(tour?.type || TourType.OWN);\n    const [isActive, setIsActive] = useState(tour?.isActive ?? true);\n    const [duration, setDuration] = useState<number | ''>(tour?.duration || '');\n    const [maxParticipants, setMaxParticipants] = useState<number | ''>(tour?.maxParticipants || '');\n    const [minParticipants, setMinParticipants] = useState<number | ''>(tour?.minParticipants || '');\n    const [price, setPrice] = useState<number | ''>(tour?.price ? (typeof tour.price === 'string' ? parseFloat(tour.price) : tour.price) : '');\n    const [currency, setCurrency] = useState(tour?.currency || 'COP');\n    const [location, setLocation] = useState(tour?.location || '');\n    const [meetingPoint, setMeetingPoint] = useState(tour?.meetingPoint || '');\n    const [includes, setIncludes] = useState(tour?.includes || '');\n    const [excludes, setExcludes] = useState(tour?.excludes || '');\n    const [requirements, setRequirements] = useState(tour?.requirements || '');\n    const [totalCommission, setTotalCommission] = useState<number | ''>(tour?.totalCommission ? (typeof tour.totalCommission === 'string' ? parseFloat(tour.totalCommission) : tour.totalCommission) : '');\n    const [totalCommissionPercent, setTotalCommissionPercent] = useState<number | ''>(tour?.totalCommissionPercent ? (typeof tour.totalCommissionPercent === 'string' ? parseFloat(tour.totalCommissionPercent) : tour.totalCommissionPercent) : '');\n    const [sellerCommissionPercent, setSellerCommissionPercent] = useState<number | ''>(tour?.sellerCommissionPercent ? (typeof tour.sellerCommissionPercent === 'string' ? parseFloat(tour.sellerCommissionPercent) : tour.sellerCommissionPercent) : '');\n    const [sellerCommissionFixed, setSellerCommissionFixed] = useState<number | ''>(tour?.sellerCommissionFixed ? (typeof tour.sellerCommissionFixed === 'string' ? parseFloat(tour.sellerCommissionFixed) : tour.sellerCommissionFixed) : '');\n    const [externalProviderId, setExternalProviderId] = useState<number | ''>(tour?.externalProviderId || '');\n    const [externalBookingUrl, setExternalBookingUrl] = useState(tour?.externalBookingUrl || '');\n    const [branchId, setBranchId] = useState<number | ''>(tour?.branchId || '');\n    const [imageFile, setImageFile] = useState<File | null>(null);\n    const [imagePreview, setImagePreview] = useState<string | null>(tour?.imageUrl ? getTourImageUrl(tour.id) : null);\n    const [galleryFiles, setGalleryFiles] = useState<File[]>([]);\n    const [galleryPreviews, setGalleryPreviews] = useState<string[]>(tour?.galleryUrls?.map((url, index) => getTourGalleryImageUrl(tour.id, index)) || []);\n    const [uploadingImage, setUploadingImage] = useState(false);\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [tourProviders, setTourProviders] = useState<TourProvider[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches und TourProviders\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const [branchesRes, providersRes] = await Promise.all([\n                    axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE),\n                    axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS?.BASE || '/api/tour-providers')\n                ]);\n                \n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n                setTourProviders(providersRes.data?.data || providersRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Update form when tour changes\n    useEffect(() => {\n        if (tour) {\n            setTitle(tour.title || '');\n            setDescription(tour.description || '');\n            setType(tour.type || TourType.OWN);\n            setIsActive(tour.isActive ?? true);\n            setDuration(tour.duration || '');\n            setMaxParticipants(tour.maxParticipants || '');\n            setMinParticipants(tour.minParticipants || '');\n            setPrice(tour.price ? (typeof tour.price === 'string' ? parseFloat(tour.price) : tour.price) : '');\n            setCurrency(tour.currency || 'COP');\n            setLocation(tour.location || '');\n            setMeetingPoint(tour.meetingPoint || '');\n            setIncludes(tour.includes || '');\n            setExcludes(tour.excludes || '');\n            setRequirements(tour.requirements || '');\n            setTotalCommission(tour.totalCommission ? (typeof tour.totalCommission === 'string' ? parseFloat(tour.totalCommission) : tour.totalCommission) : '');\n            setTotalCommissionPercent(tour.totalCommissionPercent ? (typeof tour.totalCommissionPercent === 'string' ? parseFloat(tour.totalCommissionPercent) : tour.totalCommissionPercent) : '');\n            setSellerCommissionPercent(tour.sellerCommissionPercent ? (typeof tour.sellerCommissionPercent === 'string' ? parseFloat(tour.sellerCommissionPercent) : tour.sellerCommissionPercent) : '');\n            setSellerCommissionFixed(tour.sellerCommissionFixed ? (typeof tour.sellerCommissionFixed === 'string' ? parseFloat(tour.sellerCommissionFixed) : tour.sellerCommissionFixed) : '');\n            setExternalProviderId(tour.externalProviderId || '');\n            setExternalBookingUrl(tour.externalBookingUrl || '');\n            setBranchId(tour.branchId || '');\n            setImagePreview(tour.imageUrl ? getTourImageUrl(tour.id) : null);\n            setGalleryPreviews(tour.galleryUrls?.map((url, index) => getTourGalleryImageUrl(tour.id, index)) || []);\n        }\n    }, [tour]);\n    \n    // Bild-Vorschau erstellen\n    const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (file) {\n            setImageFile(file);\n            const reader = new FileReader();\n            reader.onloadend = () => {\n                setImagePreview(reader.result as string);\n            };\n            reader.readAsDataURL(file);\n        }\n    };\n    \n    const handleGalleryChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const files = Array.from(e.target.files || []);\n        if (files.length > 0) {\n            setGalleryFiles(prev => [...prev, ...files]);\n            files.forEach(file => {\n                const reader = new FileReader();\n                reader.onloadend = () => {\n                    setGalleryPreviews(prev => [...prev, reader.result as string]);\n                };\n                reader.readAsDataURL(file);\n            });\n        }\n    };\n    \n    const removeMainImage = async () => {\n        if (!tour?.imageUrl) return;\n        \n        try {\n            await axiosInstance.delete(API_ENDPOINTS.TOURS.DELETE_IMAGE(tour.id));\n            // Sofort lokale States aktualisieren (UI-Update)\n            setImagePreview(null);\n            setImageFile(null);\n            // Lade Tour neu fr Datenbank-Sync\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tour.id));\n            if (response.data.success) {\n                onTourUpdated(response.data.data);\n                showMessage(t('tours.imageDeleted', 'Hauptbild erfolgreich gelscht'), 'success');\n            }\n        } catch (err: unknown) {\n            console.error('Error deleting main image:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.deleteError');\n            showMessage(errorMessage, 'error');\n        }\n    };\n    \n    const removeGalleryImage = async (index: number) => {\n        if (!tour) return;\n        // Wenn es ein existierendes Bild ist (aus tour.galleryUrls), lsche es vom Server\n        const currentGallery = tour.galleryUrls || [];\n        if (index < currentGallery.length) {\n            try {\n                await axiosInstance.delete(API_ENDPOINTS.TOURS.DELETE_GALLERY_IMAGE(tour.id, index));\n                // Sofort lokale States aktualisieren (UI-Update)\n                setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\n                // Lade Tour neu fr Datenbank-Sync\n                const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tour.id));\n                if (response.data.success) {\n                    onTourUpdated(response.data.data);\n                    showMessage(t('tours.galleryImageDeleted', 'Galerie-Bild erfolgreich gelscht'), 'success');\n                }\n            } catch (err: unknown) {\n                console.error('Error deleting gallery image:', err);\n                const errorMessage = (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.deleteError');\n                showMessage(errorMessage, 'error');\n            }\n        } else {\n            // Wenn es ein neues Bild ist (noch nicht hochgeladen), entferne es nur aus dem State\n            const newIndex = index - currentGallery.length;\n            setGalleryFiles(prev => prev.filter((_, i) => i !== newIndex));\n            setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\n        }\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierungen\n        if (!title.trim() || title.trim().length < 3) {\n            setError(t('tours.validation.titleMinLength', { defaultValue: 'Titel muss mindestens 3 Zeichen lang sein' }));\n            return;\n        }\n\n        const maxPart = maxParticipants ? Number(maxParticipants) : null;\n        const minPart = minParticipants ? Number(minParticipants) : null;\n        if (maxPart !== null && minPart !== null && maxPart < minPart) {\n            setError(t('tours.validation.maxParticipantsMin', { defaultValue: 'Maximale Teilnehmeranzahl muss >= minimale Teilnehmeranzahl sein' }));\n            return;\n        }\n\n        if (type === TourType.EXTERNAL && !externalProviderId) {\n            setError(t('tours.validation.externalProviderRequired', { defaultValue: 'Externer Anbieter ist bei externen Touren erforderlich' }));\n            return;\n        }\n\n        // Preise >= 0\n        if (price !== '' && Number(price) < 0) {\n            setError(t('tours.validation.priceNonNegative', { defaultValue: 'Preis muss >= 0 sein' }));\n            return;\n        }\n\n        if (totalCommission !== '' && Number(totalCommission) < 0) {\n            setError(t('tours.validation.commissionNonNegative', { defaultValue: 'Kommission muss >= 0 sein' }));\n            return;\n        }\n\n        setLoading(true);\n\n        try {\n            const tourData: Partial<Tour> & {\n                imageFile?: File | null;\n                galleryFiles?: File[];\n            } = {\n                title,\n                description: description || null,\n                type,\n                isActive,\n                duration: duration ? Number(duration) : null,\n                maxParticipants: maxParticipants ? Number(maxParticipants) : null,\n                minParticipants: minParticipants ? Number(minParticipants) : null,\n                price: price ? Number(price) : null,\n                currency: currency || 'COP',\n                location: location || null,\n                meetingPoint: meetingPoint || null,\n                includes: includes || null,\n                excludes: excludes || null,\n                requirements: requirements || null,\n                totalCommission: totalCommission ? Number(totalCommission) : null,\n                totalCommissionPercent: totalCommissionPercent ? Number(totalCommissionPercent) : null,\n                sellerCommissionPercent: sellerCommissionPercent ? Number(sellerCommissionPercent) : null,\n                sellerCommissionFixed: sellerCommissionFixed ? Number(sellerCommissionFixed) : null,\n                externalProviderId: externalProviderId ? Number(externalProviderId) : null,\n                externalBookingUrl: externalBookingUrl || null,\n                branchId: branchId ? Number(branchId) : null\n            };\n\n            const response = await axiosInstance.put(API_ENDPOINTS.TOURS.BY_ID(tour.id), tourData);\n            \n            if (response.data.success) {\n                const updatedTour = response.data.data;\n                \n                // Hauptbild hochladen (falls gendert)\n                if (imageFile) {\n                    try {\n                        setUploadingImage(true);\n                        const formData = new FormData();\n                        formData.append('image', imageFile);\n                        await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_IMAGE(tourId), formData, {\n                            headers: { 'Content-Type': 'multipart/form-data' }\n                        });\n                    } catch (imgErr: unknown) {\n                        console.error('Error uploading main image:', imgErr);\n                        showMessage(t('tours.imageUploadError', 'Tour aktualisiert, aber Fehler beim Hochladen des Bildes'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                // Neue Galerie-Bilder hochladen (falls vorhanden)\n                if (galleryFiles.length > 0) {\n                    try {\n                        setUploadingImage(true);\n                        for (const file of galleryFiles) {\n                            const formData = new FormData();\n                            formData.append('image', file);\n                            await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_GALLERY(tourId), formData, {\n                                headers: { 'Content-Type': 'multipart/form-data' }\n                            });\n                        }\n                    } catch (galleryErr: unknown) {\n                        console.error('Error uploading gallery images:', galleryErr);\n                        showMessage(t('tours.galleryUploadError', 'Tour aktualisiert, aber Fehler beim Hochladen der Galerie-Bilder'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                showMessage(t('tours.updateSuccess', 'Tour erfolgreich aktualisiert'), 'success');\n                // Lade Tour neu, um aktualisierte Bilder zu erhalten\n                const updatedResponse = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tourId));\n                onTourUpdated(updatedResponse.data.data);\n                handleClose();\n            } else {\n                setError(response.data.message || t('errors.saveError'));\n            }\n        } catch (err: unknown) {\n            console.error('Error updating tour:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.saveError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        onClose();\n    };\n\n    if (!tour) return null;\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\n                        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.edit', 'Tour bearbeiten')}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Bild-Upload */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.images', 'Bilder')}\n                            </h3>\n                            \n                            {/* Hauptbild */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.mainImage', 'Hauptbild')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    onChange={handleImageChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {imagePreview && (\n                                    <div className=\"mt-2 relative inline-block\">\n                                        <img\n                                            src={imagePreview}\n                                            alt=\"Vorschau\"\n                                            className=\"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                        />\n                                        {tour?.imageUrl && (\n                                            <button\n                                                type=\"button\"\n                                                onClick={removeMainImage}\n                                                className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                title={t('tours.deleteImage', 'Hauptbild lschen')}\n                                            >\n                                                <XMarkIcon className=\"h-4 w-4\" />\n                                            </button>\n                                        )}\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* Galerie */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.gallery', 'Galerie')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    multiple\n                                    onChange={handleGalleryChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {galleryPreviews.length > 0 && (\n                                    <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                                        {galleryPreviews.map((preview, index) => (\n                                            <div key={index} className=\"relative\">\n                                                <img\n                                                    src={preview}\n                                                    alt={`Galerie ${index + 1}`}\n                                                    className=\"w-full h-32 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                                />\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={() => removeGalleryImage(index)}\n                                                    className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600\"\n                                                >\n                                                    <XMarkIcon className=\"h-4 w-4\" />\n                                                </button>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData || uploadingImage}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.edit', 'Tour bearbeiten')}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Bilder */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.images', 'Bilder')}\n                            </h3>\n                            \n                            {/* Hauptbild */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.mainImage', 'Hauptbild')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    onChange={handleImageChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {imagePreview && (\n                                    <div className=\"mt-2 relative inline-block\">\n                                        <img\n                                            src={imagePreview}\n                                            alt=\"Vorschau\"\n                                            className=\"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                        />\n                                        {tour?.imageUrl && (\n                                            <button\n                                                type=\"button\"\n                                                onClick={removeMainImage}\n                                                className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                title={t('tours.deleteImage', 'Hauptbild lschen')}\n                                            >\n                                                <XMarkIcon className=\"h-4 w-4\" />\n                                            </button>\n                                        )}\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* Galerie */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.gallery', 'Galerie')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    multiple\n                                    onChange={handleGalleryChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {galleryPreviews.length > 0 && (\n                                    <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                                        {galleryPreviews.map((preview, index) => (\n                                            <div key={index} className=\"relative\">\n                                                <img\n                                                    src={preview}\n                                                    alt={`Galerie ${index + 1}`}\n                                                    className=\"w-full h-24 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                                />\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={() => removeGalleryImage(index)}\n                                                    className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                    title={t('tours.deleteImage', 'Bild lschen')}\n                                                >\n                                                    <XMarkIcon className=\"h-4 w-4\" />\n                                                </button>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData || uploadingImage}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default EditTourModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, MapPinIcon, ClockIcon, UsersIcon, CurrencyDollarIcon, BuildingOfficeIcon, UserIcon, PlusIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { Tour, TourType, TourBooking } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport CreateTourBookingModal from './CreateTourBookingModal.tsx';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\n\ninterface TourDetailsModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    tourId: number;\n    onTourUpdated?: (updatedTour: Tour) => void;\n}\n\nconst TourDetailsModal = ({ isOpen, onClose, tourId, onTourUpdated }: TourDetailsModalProps) => {\n    const { t } = useTranslation();\n    const { showMessage } = useMessage();\n    const { hasPermission } = usePermissions();\n    const [tour, setTour] = useState<Tour | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n    const [isCreateBookingModalOpen, setIsCreateBookingModalOpen] = useState(false);\n\n    useEffect(() => {\n        if (isOpen && tourId) {\n            loadTour();\n        }\n    }, [isOpen, tourId]);\n\n    const loadTour = async () => {\n        try {\n            setLoading(true);\n            setError(null);\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tourId));\n            if (response.data.success) {\n                setTour(response.data.data);\n            } else {\n                setError(response.data.message || t('errors.loadError'));\n            }\n        } catch (err: unknown) {\n            console.error('Error loading tour:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.loadError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                            {t('tours.details', 'Tour-Details')}\n                        </Dialog.Title>\n                        <div className=\"flex items-center gap-3\">\n                            {hasPermission('tour_bookings', 'write', 'table') && tour && tour.isActive && (\n                                <div className=\"relative group\">\n                                    <button\n                                        onClick={() => setIsCreateBookingModalOpen(true)}\n                                        className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                        style={{ width: '30.19px', height: '30.19px' }}\n                                        aria-label={t('tourBookings.create', 'Buchung erstellen')}\n                                    >\n                                        <PlusIcon className=\"h-4 w-4\" />\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tourBookings.create', 'Buchung erstellen')}\n                                    </div>\n                                </div>\n                            )}\n                            <button\n                                onClick={onClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n                    </div>\n\n                    <div className=\"p-6\">\n                        {loading ? (\n                            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                                {t('common.loading')}\n                            </div>\n                        ) : error ? (\n                            <div className=\"text-center py-8 text-red-500 dark:text-red-400\">\n                                {error}\n                            </div>\n                        ) : !tour ? (\n                            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                                {t('tours.notFound', 'Tour nicht gefunden')}\n                            </div>\n                        ) : (\n                            <div className=\"space-y-6\">\n                                {/* Header */}\n                                <div>\n                                    <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\n                                        {tour.title || '-'}\n                                    </h2>\n                                    <div className=\"flex items-center gap-2\">\n                                        <span className={`px-3 py-1 text-sm rounded-full ${\n                                            tour.type === TourType.OWN\n                                                ? 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200'\n                                                : 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200'\n                                        }`}>\n                                            {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                        </span>\n                                        <span className={`px-3 py-1 text-sm rounded-full ${\n                                            tour.isActive\n                                                ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'\n                                                : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                        }`}>\n                                            {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                        </span>\n                                    </div>\n                                </div>\n\n                                {/* Beschreibung */}\n                                {tour.description && (\n                                    <div>\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\n                                            {t('tours.description')}\n                                        </h3>\n                                        <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                            {tour.description}\n                                        </p>\n                                    </div>\n                                )}\n\n                                {/* Tour-Details Grid */}\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                                    {/* Linke Spalte */}\n                                    <div className=\"space-y-4\">\n                                        {tour.duration && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <ClockIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.duration')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.duration} {t('common.hours', 'h')}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {(tour.minParticipants || tour.maxParticipants) && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <UsersIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.participants', 'Teilnehmer')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.minParticipants && tour.maxParticipants\n                                                            ? `${tour.minParticipants} - ${tour.maxParticipants}`\n                                                            : tour.minParticipants\n                                                            ? `${tour.minParticipants}+`\n                                                            : tour.maxParticipants\n                                                            ? `bis ${tour.maxParticipants}`\n                                                            : '-'}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.price && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <CurrencyDollarIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.price')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white font-semibold\">\n                                                        {Number(tour.price).toLocaleString()} {tour.currency || 'COP'}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.location && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <MapPinIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.location')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.location}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.meetingPoint && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <MapPinIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.meetingPoint')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.meetingPoint}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n                                    </div>\n\n                                    {/* Rechte Spalte */}\n                                    <div className=\"space-y-4\">\n                                        {tour.branch && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <BuildingOfficeIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.branch')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.branch.name}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.createdBy && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <UserIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.columns.createdBy')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.createdBy.firstName} {tour.createdBy.lastName}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.createdAt && (\n                                            <div>\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                    {t('common.createdAt', 'Erstellt am')}\n                                                </div>\n                                                <div className=\"text-gray-900 dark:text-white\">\n                                                    {format(new Date(tour.createdAt), 'dd.MM.yyyy HH:mm', { locale: de })}\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.externalProvider && (\n                                            <div>\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                    {t('tours.externalProvider')}\n                                                </div>\n                                                <div className=\"text-gray-900 dark:text-white\">\n                                                    {tour.externalProvider.name}\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.externalBookingUrl && (\n                                            <div>\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                    {t('tours.externalBookingUrl')}\n                                                </div>\n                                                <a\n                                                    href={tour.externalBookingUrl}\n                                                    target=\"_blank\"\n                                                    rel=\"noopener noreferrer\"\n                                                    className=\"text-blue-600 dark:text-blue-400 hover:underline\"\n                                                >\n                                                    {tour.externalBookingUrl}\n                                                </a>\n                                            </div>\n                                        )}\n                                    </div>\n                                </div>\n\n                                {/* Kommissionen */}\n                                {(tour.totalCommission || tour.totalCommissionPercent || tour.sellerCommissionPercent || tour.sellerCommissionFixed) && (\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                                            {t('tours.commissions')}\n                                        </h3>\n                                        <div className=\"grid grid-cols-2 gap-4\">\n                                            {tour.totalCommission && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.totalCommission')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.totalCommission).toLocaleString()} {tour.currency || 'COP'}\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.totalCommissionPercent && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.totalCommissionPercent')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.totalCommissionPercent)}%\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.sellerCommissionPercent && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.sellerCommissionPercent')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.sellerCommissionPercent)}%\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.sellerCommissionFixed && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.sellerCommissionFixed')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.sellerCommissionFixed).toLocaleString()} {tour.currency || 'COP'}\n                                                    </div>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n\n                                {/* Zustzliche Informationen */}\n                                {(tour.includes || tour.excludes || tour.requirements) && (\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                                            {t('tours.additionalInfo')}\n                                        </h3>\n                                        <div className=\"space-y-4\">\n                                            {tour.includes && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                                        {t('tours.includes')}\n                                                    </div>\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                                        {tour.includes}\n                                                    </p>\n                                                </div>\n                                            )}\n                                            {tour.excludes && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                                        {t('tours.excludes')}\n                                                    </div>\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                                        {tour.excludes}\n                                                    </p>\n                                                </div>\n                                            )}\n                                            {tour.requirements && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                                        {t('tours.requirements')}\n                                                    </div>\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                                        {tour.requirements}\n                                                    </p>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n\n                                {/* Verfgbarkeit */}\n                                {(tour.availableFrom || tour.availableTo) && (\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                                            {t('tours.availability', 'Verfgbarkeit')}\n                                        </h3>\n                                        <div className=\"grid grid-cols-2 gap-4\">\n                                            {tour.availableFrom && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.availableFrom', 'Verfgbar ab')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {format(new Date(tour.availableFrom), 'dd.MM.yyyy', { locale: de })}\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.availableTo && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.availableTo', 'Verfgbar bis')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {format(new Date(tour.availableTo), 'dd.MM.yyyy', { locale: de })}\n                                                    </div>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n                        )}\n                    </div>\n\n                    <div className=\"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700\">\n                        <button\n                            onClick={onClose}\n                            className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\n                        >\n                            {t('common.close', 'Schlieen')}\n                        </button>\n                    </div>\n                </Dialog.Panel>\n            </div>\n            \n            {/* Create Tour Booking Modal */}\n            {tour && (\n                <CreateTourBookingModal\n                    isOpen={isCreateBookingModalOpen}\n                    onClose={() => setIsCreateBookingModalOpen(false)}\n                    tour={tour}\n                    onBookingCreated={async (newBooking: TourBooking) => {\n                        showMessage(\n                            t('tourBookings.created', { defaultValue: 'Tour-Buchung erfolgreich erstellt' }),\n                            'success'\n                        );\n                        setIsCreateBookingModalOpen(false);\n                    }}\n                />\n            )}\n        </Dialog>\n    );\n};\n\nexport default TourDetailsModal;\n\n","import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ArrowDownTrayIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../../config/axios.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { Tour } from '../../types/tour.ts';\n\ninterface TourExportDialogProps {\n    isOpen: boolean;\n    onClose: () => void;\n    tourCount: number;\n}\n\nconst TourExportDialog = ({ isOpen, onClose, tourCount }: TourExportDialogProps) => {\n    const { t } = useTranslation();\n    const { showMessage } = useMessage();\n    \n    const [selectedFields, setSelectedFields] = useState<string[]>([\n        'id', 'title', 'description', 'type', 'price', 'currency', 'duration',\n        'maxParticipants', 'minParticipants', 'location', 'meetingPoint',\n        'imageUrl', 'galleryUrls', 'availableFrom', 'availableTo'\n    ]);\n    const [exporting, setExporting] = useState(false);\n    const [format, setFormat] = useState<'json' | 'csv'>('json');\n\n    const availableFields = [\n        { id: 'id', label: t('tours.columns.title', 'Titel') },\n        { id: 'title', label: t('tours.name', 'Titel') },\n        { id: 'description', label: t('tours.description', 'Beschreibung') },\n        { id: 'type', label: t('tours.type', 'Typ') },\n        { id: 'price', label: t('tours.price', 'Preis') },\n        { id: 'currency', label: t('tours.currency', 'Whrung') },\n        { id: 'duration', label: t('tours.duration', 'Dauer') },\n        { id: 'maxParticipants', label: t('tours.maxParticipants', 'Max. Teilnehmer') },\n        { id: 'minParticipants', label: t('tours.minParticipants', 'Min. Teilnehmer') },\n        { id: 'location', label: t('tours.location', 'Ort') },\n        { id: 'meetingPoint', label: t('tours.meetingPoint', 'Treffpunkt') },\n        { id: 'includes', label: t('tours.includes', 'Enthlt') },\n        { id: 'excludes', label: t('tours.excludes', 'Nicht enthalten') },\n        { id: 'requirements', label: t('tours.requirements', 'Anforderungen') },\n        { id: 'imageUrl', label: t('tours.mainImage', 'Hauptbild') },\n        { id: 'galleryUrls', label: t('tours.gallery', 'Galerie') },\n        { id: 'availableFrom', label: t('tours.availableFrom', 'Verfgbar ab') },\n        { id: 'availableTo', label: t('tours.availableTo', 'Verfgbar bis') },\n        { id: 'externalBookingUrl', label: t('tours.externalBookingUrl', 'Externe Buchungs-URL') },\n        { id: 'branch', label: t('tours.branch', 'Niederlassung') },\n        { id: 'externalProvider', label: t('tours.externalProvider', 'Externer Anbieter') }\n    ];\n\n    const toggleField = (fieldId: string) => {\n        setSelectedFields(prev =>\n            prev.includes(fieldId)\n                ? prev.filter(f => f !== fieldId)\n                : [...prev, fieldId]\n        );\n    };\n\n    const selectAll = () => {\n        setSelectedFields(availableFields.map(f => f.id));\n    };\n\n    const deselectAll = () => {\n        setSelectedFields([]);\n    };\n\n    const handleExport = async () => {\n        if (selectedFields.length === 0) {\n            showMessage(t('tours.export.noFieldsSelected', 'Bitte whlen Sie mindestens ein Feld aus'), 'error');\n            return;\n        }\n\n        setExporting(true);\n        try {\n            const fieldsParam = selectedFields.join(',');\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.EXPORT, {\n                params: { fields: fieldsParam }\n            });\n\n            const tours = response.data.tours || response.data;\n\n            if (format === 'json') {\n                // JSON-Export\n                const blob = new Blob([JSON.stringify(tours, null, 2)], { type: 'application/json' });\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = `tours-export-${new Date().toISOString().split('T')[0]}.json`;\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                window.URL.revokeObjectURL(url);\n            } else {\n                // CSV-Export\n                if (!Array.isArray(tours) || tours.length === 0) {\n                    showMessage(t('tours.export.noData', 'Keine Daten zum Exportieren'), 'warning');\n                    return;\n                }\n\n                // CSV-Header\n                const headers = selectedFields.map(fieldId => {\n                    const field = availableFields.find(f => f.id === fieldId);\n                    return field?.label || fieldId;\n                });\n\n                // CSV-Rows\n                const rows = tours.map((tour: Tour) => {\n                    return selectedFields.map(fieldId => {\n                        let value = tour[fieldId];\n                        if (value === null || value === undefined) return '';\n                        if (typeof value === 'object') {\n                            if (fieldId === 'branch') return value?.name || '';\n                            if (fieldId === 'externalProvider') return value?.name || '';\n                            if (fieldId === 'galleryUrls' && Array.isArray(value)) return value.join('; ');\n                            return JSON.stringify(value);\n                        }\n                        if (typeof value === 'boolean') return value ? 'Ja' : 'Nein';\n                        return String(value);\n                    });\n                });\n\n                // CSV-String erstellen\n                const csvContent = [\n                    headers.join(','),\n                    ...rows.map(row => row.map(cell => `\"${String(cell).replace(/\"/g, '\"\"')}\"`).join(','))\n                ].join('\\n');\n\n                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = `tours-export-${new Date().toISOString().split('T')[0]}.csv`;\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                window.URL.revokeObjectURL(url);\n            }\n\n            showMessage(t('tours.export.success', 'Export erfolgreich'), 'success');\n            onClose();\n        } catch (err: unknown) {\n            console.error('Error exporting:', err);\n            showMessage(err.response?.data?.message || t('tours.export.error', 'Fehler beim Exportieren'), 'error');\n        } finally {\n            setExporting(false);\n        }\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                            {t('tours.export.title', 'Touren exportieren')} ({tourCount})\n                        </Dialog.Title>\n                        <button\n                            onClick={onClose}\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                        >\n                            <XMarkIcon className=\"h-6 w-6\" />\n                        </button>\n                    </div>\n\n                    <div className=\"p-6 space-y-6\">\n                        {/* Format-Auswahl */}\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                {t('tours.export.format', 'Export-Format')}\n                            </label>\n                            <div className=\"flex gap-4\">\n                                <label className=\"flex items-center\">\n                                    <input\n                                        type=\"radio\"\n                                        value=\"json\"\n                                        checked={format === 'json'}\n                                        onChange={(e) => setFormat(e.target.value as 'json' | 'csv')}\n                                        className=\"mr-2\"\n                                    />\n                                    JSON\n                                </label>\n                                <label className=\"flex items-center\">\n                                    <input\n                                        type=\"radio\"\n                                        value=\"csv\"\n                                        checked={format === 'csv'}\n                                        onChange={(e) => setFormat(e.target.value as 'json' | 'csv')}\n                                        className=\"mr-2\"\n                                    />\n                                    CSV\n                                </label>\n                            </div>\n                        </div>\n\n                        {/* Feldauswahl */}\n                        <div>\n                            <div className=\"flex items-center justify-between mb-3\">\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                    {t('tours.export.selectFields', 'Felder auswhlen')}\n                                </label>\n                                <div className=\"flex gap-2\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={selectAll}\n                                        className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\"\n                                    >\n                                        {t('common.selectAll', 'Alle auswhlen')}\n                                    </button>\n                                    <span className=\"text-gray-400\">|</span>\n                                    <button\n                                        type=\"button\"\n                                        onClick={deselectAll}\n                                        className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\"\n                                    >\n                                        {t('common.deselectAll', 'Alle abwhlen')}\n                                    </button>\n                                </div>\n                            </div>\n                            <div className=\"border border-gray-300 dark:border-gray-600 rounded-md p-4 max-h-96 overflow-y-auto\">\n                                <div className=\"grid grid-cols-2 gap-2\">\n                                    {availableFields.map(field => (\n                                        <label key={field.id} className=\"flex items-center\">\n                                            <input\n                                                type=\"checkbox\"\n                                                checked={selectedFields.includes(field.id)}\n                                                onChange={() => toggleField(field.id)}\n                                                className=\"mr-2 rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                                            />\n                                            <span className=\"text-sm text-gray-700 dark:text-gray-300\">\n                                                {field.label}\n                                            </span>\n                                        </label>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"flex justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                            title={t('common.cancel', 'Abbrechen')}\n                        >\n                            <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <button\n                            type=\"button\"\n                            onClick={handleExport}\n                            disabled={exporting || selectedFields.length === 0}\n                            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                            title={exporting ? t('common.exporting', 'Exportiere...') : t('common.export', 'Exportieren')}\n                        >\n                            <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                        </button>\n                    </div>\n                </Dialog.Panel>\n            </div>\n        </Dialog>\n    );\n};\n\nexport default TourExportDialog;\n\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { \r\n  XMarkIcon, \r\n  ChevronLeftIcon, \r\n  ChevronRightIcon,\r\n  MagnifyingGlassPlusIcon,\r\n  MagnifyingGlassMinusIcon,\r\n  ArrowPathIcon\r\n} from '@heroicons/react/24/outline';\r\nimport { getTourImageUrl, getTourGalleryImageUrl } from '../../config/api.ts';\r\n\r\ninterface TourImageLightboxProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  tourId: number;\r\n  initialImageIndex?: number;\r\n  imageUrl?: string | null;\r\n  galleryUrls?: string[] | null;\r\n  tourTitle?: string;\r\n}\r\n\r\nconst TourImageLightbox: React.FC<TourImageLightboxProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  tourId,\r\n  initialImageIndex = 0,\r\n  imageUrl,\r\n  galleryUrls,\r\n  tourTitle\r\n}) => {\r\n  const { t } = useTranslation();\r\n  \r\n  // State\r\n  const [currentImageIndex, setCurrentImageIndex] = useState(initialImageIndex);\r\n  const [zoomLevel, setZoomLevel] = useState(1.0);\r\n  const [imageLoading, setImageLoading] = useState(true);\r\n  const [imageError, setImageError] = useState(false);\r\n\r\n  // Konstruiere Bild-Array: Hauptbild + Galerie\r\n  const images: string[] = [];\r\n  if (imageUrl) {\r\n    images.push(getTourImageUrl(tourId)); // Index 0\r\n  }\r\n  if (galleryUrls && galleryUrls.length > 0) {\r\n    galleryUrls.forEach((_, index) => {\r\n      images.push(getTourGalleryImageUrl(tourId, index)); // Index 1+\r\n    });\r\n  }\r\n\r\n  // Reset state wenn Lightbox geffnet wird\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setCurrentImageIndex(initialImageIndex);\r\n      setZoomLevel(1.0);\r\n      setImageLoading(true);\r\n      setImageError(false);\r\n    }\r\n  }, [isOpen, initialImageIndex]);\r\n\r\n  // Navigation\r\n  const handlePrevious = useCallback(() => {\r\n    if (currentImageIndex > 0) {\r\n      setCurrentImageIndex(currentImageIndex - 1);\r\n      setImageLoading(true);\r\n      setImageError(false);\r\n      setZoomLevel(1.0);\r\n    }\r\n  }, [currentImageIndex]);\r\n\r\n  const handleNext = useCallback(() => {\r\n    if (currentImageIndex < images.length - 1) {\r\n      setCurrentImageIndex(currentImageIndex + 1);\r\n      setImageLoading(true);\r\n      setImageError(false);\r\n      setZoomLevel(1.0);\r\n    }\r\n  }, [currentImageIndex, images.length]);\r\n\r\n  // Zoom\r\n  const handleZoomIn = useCallback(() => {\r\n    setZoomLevel(prev => {\r\n      if (prev >= 3.0) return 3.0;\r\n      if (prev < 1.5) return 1.5;\r\n      if (prev < 2.0) return 2.0;\r\n      if (prev < 2.5) return 2.5;\r\n      return 3.0;\r\n    });\r\n  }, []);\r\n\r\n  const handleZoomOut = useCallback(() => {\r\n    setZoomLevel(prev => {\r\n      if (prev <= 1.0) return 1.0;\r\n      if (prev > 2.5) return 2.5;\r\n      if (prev > 2.0) return 2.0;\r\n      if (prev > 1.5) return 1.5;\r\n      return 1.0;\r\n    });\r\n  }, []);\r\n\r\n  const handleZoomReset = useCallback(() => {\r\n    setZoomLevel(1.0);\r\n  }, []);\r\n\r\n  // Bild-Events\r\n  const handleImageLoad = () => {\r\n    setImageLoading(false);\r\n    setImageError(false);\r\n  };\r\n\r\n  const handleImageError = () => {\r\n    setImageLoading(false);\r\n    setImageError(true);\r\n  };\r\n\r\n  // Keyboard-Navigation\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        onClose();\r\n      } else if (e.key === 'ArrowLeft' && currentImageIndex > 0) {\r\n        handlePrevious();\r\n      } else if (e.key === 'ArrowRight' && currentImageIndex < images.length - 1) {\r\n        handleNext();\r\n      } else if ((e.key === '+' || e.key === '=') && !e.shiftKey) {\r\n        handleZoomIn();\r\n      } else if (e.key === '-' || (e.key === '_' && e.shiftKey)) {\r\n        handleZoomOut();\r\n      } else if (e.key === '0') {\r\n        handleZoomReset();\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, [isOpen, currentImageIndex, images.length, handlePrevious, handleNext, handleZoomIn, handleZoomOut, handleZoomReset, onClose]);\r\n\r\n  // Prfe ob Bilder vorhanden\r\n  if (images.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const currentImage = images[currentImageIndex];\r\n  const canGoPrevious = currentImageIndex > 0;\r\n  const canGoNext = currentImageIndex < images.length - 1;\r\n  const canZoomIn = zoomLevel < 3.0;\r\n  const canZoomOut = zoomLevel > 1.0;\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      {/* Overlay */}\r\n      <div className=\"fixed inset-0 bg-black/80\" aria-hidden=\"true\" />\r\n      \r\n      {/* Dialog Panel */}\r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"mx-auto max-w-7xl w-full h-full flex flex-col bg-black/90 rounded-lg shadow-xl overflow-hidden\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between p-4 border-b border-gray-700 flex-shrink-0\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <Dialog.Title className=\"text-lg font-semibold text-white\">\r\n                {tourTitle && `${tourTitle} - `}\r\n                {t('tours.imageLightbox.title', 'Bild {{current}} von {{total}}', {\r\n                  current: currentImageIndex + 1,\r\n                  total: images.length\r\n                })}\r\n              </Dialog.Title>\r\n              \r\n              {/* Zoom Controls */}\r\n              <div className=\"flex items-center gap-2\">\r\n                <button\r\n                  onClick={handleZoomOut}\r\n                  disabled={!canZoomOut}\r\n                  className=\"p-2 text-white hover:bg-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  aria-label={t('tours.imageLightbox.zoomOut', 'Verkleinern')}\r\n                  title={t('tours.imageLightbox.zoomOut', 'Verkleinern')}\r\n                >\r\n                  <MagnifyingGlassMinusIcon className=\"h-5 w-5\" />\r\n                </button>\r\n                <button\r\n                  onClick={handleZoomReset}\r\n                  className=\"p-2 text-white hover:bg-gray-700 rounded transition-colors\"\r\n                  aria-label={t('tours.imageLightbox.zoomReset', 'Zoom zurcksetzen')}\r\n                  title={t('tours.imageLightbox.zoomReset', 'Zoom zurcksetzen')}\r\n                >\r\n                  <ArrowPathIcon className=\"h-5 w-5\" />\r\n                </button>\r\n                <button\r\n                  onClick={handleZoomIn}\r\n                  disabled={!canZoomIn}\r\n                  className=\"p-2 text-white hover:bg-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  aria-label={t('tours.imageLightbox.zoomIn', 'Vergrern')}\r\n                  title={t('tours.imageLightbox.zoomIn', 'Vergrern')}\r\n                >\r\n                  <MagnifyingGlassPlusIcon className=\"h-5 w-5\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Close Button */}\r\n            <button\r\n              onClick={onClose}\r\n              className=\"p-2 text-white hover:bg-gray-700 rounded transition-colors\"\r\n              aria-label={t('tours.imageLightbox.close', 'Schlieen')}\r\n            >\r\n              <XMarkIcon className=\"h-6 w-6\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Content */}\r\n          <div className=\"flex-1 relative overflow-hidden flex items-center justify-center\">\r\n            {/* Previous Button */}\r\n            {images.length > 1 && (\r\n              <button\r\n                onClick={handlePrevious}\r\n                disabled={!canGoPrevious}\r\n                className=\"absolute left-4 z-10 p-3 bg-black/50 hover:bg-black/70 text-white rounded-full disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\r\n                aria-label={t('tours.imageLightbox.previous', 'Vorheriges Bild')}\r\n              >\r\n                <ChevronLeftIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            )}\r\n\r\n            {/* Image Container */}\r\n            <div className=\"flex-1 flex items-center justify-center h-full p-4\">\r\n              {imageLoading && !imageError && (\r\n                <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                  <div className=\"text-white\">\r\n                    <ArrowPathIcon className=\"h-8 w-8 animate-spin\" />\r\n                    <p className=\"mt-2 text-sm\">{t('tours.imageLightbox.loading', 'Bild wird geladen...')}</p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {imageError && (\r\n                <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                  <div className=\"text-white text-center\">\r\n                    <p className=\"text-lg\">{t('tours.imageLightbox.error', 'Bild konnte nicht geladen werden')}</p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {!imageError && (\r\n                <img\r\n                  src={currentImage}\r\n                  alt={`${tourTitle || 'Tour'} - Bild ${currentImageIndex + 1}`}\r\n                  className={`max-w-full max-h-full object-contain transition-transform duration-200 ${\r\n                    imageLoading ? 'opacity-0' : 'opacity-100'\r\n                  }`}\r\n                  style={{\r\n                    transform: `scale(${zoomLevel})`,\r\n                    cursor: zoomLevel > 1.0 ? 'move' : 'default'\r\n                  }}\r\n                  onLoad={handleImageLoad}\r\n                  onError={handleImageError}\r\n                />\r\n              )}\r\n            </div>\r\n\r\n            {/* Next Button */}\r\n            {images.length > 1 && (\r\n              <button\r\n                onClick={handleNext}\r\n                disabled={!canGoNext}\r\n                className=\"absolute right-4 z-10 p-3 bg-black/50 hover:bg-black/70 text-white rounded-full disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\r\n                aria-label={t('tours.imageLightbox.next', 'Nchstes Bild')}\r\n              >\r\n                <ChevronRightIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            )}\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default TourImageLightbox;\r\n\r\n","import React, { useState, useEffect, useMemo, useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PencilIcon, PlusIcon, ArrowsUpDownIcon, FunnelIcon, InformationCircleIcon, Squares2X2Icon, TableCellsIcon, ArrowDownTrayIcon, PhotoIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS, getTourImageUrl, getTourGalleryImageUrl } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\nimport CardGrid from '../shared/CardGrid.tsx';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport { useTableSettings } from '../../hooks/useTableSettings.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useError } from '../../contexts/ErrorContext.tsx';\nimport TableColumnConfig from '../TableColumnConfig.tsx';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport CreateTourModal from './CreateTourModal.tsx';\nimport EditTourModal from './EditTourModal.tsx';\nimport TourDetailsModal from './TourDetailsModal.tsx';\nimport TourExportDialog from './TourExportDialog.tsx';\nimport TourImageLightbox from './TourImageLightbox.tsx';\nimport { Tour, TourType } from '../../types/tour.ts';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport { applyFilters, evaluateUserRoleCondition } from '../../utils/filterLogic.ts';\n\ninterface ToursTabProps {\n}\n\ninterface TourSortConfig {\n    key: 'title' | 'type' | 'price' | 'location' | 'duration' | 'branch' | 'createdBy' | 'isActive';\n    direction: 'asc' | 'desc';\n}\n\nconst TOURS_TABLE_ID = 'worktracker-tours';\n\nconst defaultTourColumnOrder = ['title', 'type', 'price', 'location', 'duration', 'branch', 'isActive', 'actions'];\n\n//  ENTFERNT: defaultTourCardSortDirections\n// Hauptsortierung wird jetzt aus Settings geladen (pro Benutzer gespeichert)\n\nconst tourCardToTableMapping: Record<string, string> = {\n    'title': 'title',\n    'type': 'type',\n    'price': 'price',\n    'location': 'location',\n    'duration': 'duration',\n    'branch': 'branch',\n    'createdBy': 'createdBy',\n    'isActive': 'isActive'\n};\n\nconst getTourCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n    const cardMetadata: string[] = [];\n    columnOrder.forEach(tableCol => {\n        const cardMeta = tourCardToTableMapping[tableCol] || [];\n        if (cardMeta && typeof cardMeta === 'string') {\n            cardMetadata.push(cardMeta);\n        }\n    });\n    return cardMetadata;\n};\n\nconst getTourHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n    const hiddenCardMetadata = new Set<string>();\n    hiddenTableColumns.forEach(tableCol => {\n        const cardMeta = tourCardToTableMapping[tableCol];\n        if (cardMeta) {\n            hiddenCardMetadata.add(cardMeta);\n        }\n    });\n    return hiddenCardMetadata;\n};\n\nconst ToursTab: React.FC<ToursTabProps> = () => {\n    const { t } = useTranslation();\n    const { hasPermission, loading: permissionsLoading } = usePermissions();\n    const { showMessage } = useMessage();\n    \n    // Fehlerbehandlung mit Fallback\n    const errorContext = useError();\n    const handleErrorContext = errorContext?.handleError || ((err: unknown, context?: Record<string, unknown>) => {\n        console.error('Error:', err, context);\n        const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                             (err as { message?: string })?.message || \n                             'Ein Fehler ist aufgetreten';\n        showMessage(errorMessage, 'error');\n    });\n    \n    // Tour-States\n    const [tours, setTours] = useState<Tour[]>([]);\n    const [toursLoading, setToursLoading] = useState(false);\n    const [toursError, setToursError] = useState<string | null>(null);\n    const [tourSearchTerm, setTourSearchTerm] = useState('');\n    const [tourFilterConditions, setTourFilterConditions] = useState<FilterCondition[]>([]);\n    const [tourFilterLogicalOperators, setTourFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [tourActiveFilterName, setTourActiveFilterName] = useState<string>(t('tours.filters.current', 'Aktuell'));\n    const [tourSelectedFilterId, setTourSelectedFilterId] = useState<number | null>(null);\n    \n    //  PERFORMANCE: Ref-Pattern fr tourFilterLogicalOperators (verhindert Re-Creation von loadTours)\n    const tourFilterLogicalOperatorsRef = useRef(tourFilterLogicalOperators);\n    \n    useEffect(() => {\n        tourFilterLogicalOperatorsRef.current = tourFilterLogicalOperators;\n    }, [tourFilterLogicalOperators]);\n    const [isCreateTourModalOpen, setIsCreateTourModalOpen] = useState(false);\n    const [isEditTourModalOpen, setIsEditTourModalOpen] = useState(false);\n    const [isTourDetailsModalOpen, setIsTourDetailsModalOpen] = useState(false);\n    const [isTourExportDialogOpen, setIsTourExportDialogOpen] = useState(false);\n    const [lightboxOpen, setLightboxOpen] = useState(false);\n    const [selectedTourForLightbox, setSelectedTourForLightbox] = useState<Tour | null>(null);\n    const [initialImageIndex, setInitialImageIndex] = useState(0);\n    const [selectedTour, setSelectedTour] = useState<Tour | null>(null);\n    const [selectedTourId, setSelectedTourId] = useState<number | null>(null);\n    const [displayLimit, setDisplayLimit] = useState<number>(10);\n    const [draggedColumn, setDraggedColumn] = useState<string | null>(null);\n    const [dragOverColumn, setDragOverColumn] = useState<string | null>(null);\n    const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n    \n    // Bildgenerierung States\n    const [generatingImages, setGeneratingImages] = useState<Record<number, boolean>>({});\n    const [imageGenerationJobs, setImageGenerationJobs] = useState<Record<number, string | null>>({});\n    const pollingIntervalsRef = useRef<Record<number, NodeJS.Timeout>>({});\n    const pollCountRef = useRef<Record<number, number>>({});\n    \n    // Tabellen-Einstellungen\n    const {\n        settings,\n        isLoading: isLoadingSettings,\n        updateColumnOrder,\n        updateHiddenColumns,\n        toggleColumnVisibility,\n        isColumnVisible,\n        updateViewMode,\n        updateSortConfig\n    } = useTableSettings(TOURS_TABLE_ID, {\n        defaultColumnOrder: defaultTourColumnOrder,\n        defaultHiddenColumns: [],\n        defaultViewMode: 'cards'\n    });\n    \n    // Hauptsortierung aus Settings laden (fr Table & Cards synchron)\n    const tourTableSortConfig: TourSortConfig = settings?.sortConfig || { key: 'title', direction: 'asc' };\n    \n    // Hauptsortierung Handler (fr Table & Cards synchron)\n    const handleMainSortChange = (key: string, direction: 'asc' | 'desc') => {\n        updateSortConfig({ key: key as TourSortConfig['key'], direction });\n    };\n    \n    // Tours-Spalten\n    const availableTourColumns = useMemo(() => [\n        { id: 'title', label: t('tours.columns.title', 'Titel'), shortLabel: t('tours.columns.title', 'Titel').substring(0, 4) },\n        { id: 'type', label: t('tours.columns.type', 'Typ'), shortLabel: t('tours.columns.type', 'Typ').substring(0, 3) },\n        { id: 'price', label: t('tours.columns.price', 'Preis'), shortLabel: t('tours.columns.price', 'Preis').substring(0, 3) },\n        { id: 'location', label: t('tours.columns.location', 'Ort'), shortLabel: t('tours.columns.location', 'Ort').substring(0, 3) },\n        { id: 'duration', label: t('tours.columns.duration', 'Dauer'), shortLabel: t('tours.columns.duration', 'Dauer').substring(0, 3) },\n        { id: 'branch', label: t('tours.columns.branch', 'Niederlassung'), shortLabel: t('tours.columns.branch', 'Niederlassung').substring(0, 5) },\n        { id: 'createdBy', label: t('tours.columns.createdBy', 'Erstellt von'), shortLabel: t('tours.columns.createdBy', 'Erstellt von').substring(0, 5) },\n        { id: 'isActive', label: t('tours.columns.status', 'Status'), shortLabel: t('tours.columns.status', 'Status').substring(0, 3) },\n        { id: 'actions', label: t('tours.columns.actions', 'Aktionen'), shortLabel: t('common.actions').substring(0, 3) },\n    ], [t]);\n    \n    const tourFilterOnlyColumns = useMemo(() => [\n        { id: 'description', label: t('tours.columns.description', 'Beschreibung'), shortLabel: t('tours.columns.description', 'Beschreibung').substring(0, 3) },\n        { id: 'maxParticipants', label: t('tours.columns.maxParticipants', 'Max. Teilnehmer'), shortLabel: t('tours.columns.maxParticipants', 'Max. Teilnehmer').substring(0, 3) },\n        { id: 'minParticipants', label: t('tours.columns.minParticipants', 'Min. Teilnehmer'), shortLabel: t('tours.columns.minParticipants', 'Min. Teilnehmer').substring(0, 3) },\n    ], [t]);\n    \n    //  ENTFERNT: tourCardSortDirections und handleTourCardSortDirectionChange\n    // Hauptsortierung wird jetzt aus Settings geladen (pro Benutzer gespeichert)\n    \n    const viewMode = settings?.viewMode || 'cards';\n    \n    // Card-Metadaten-Reihenfolge aus columnOrder ableiten\n    const cardMetadataOrder = useMemo(() => {\n        return getTourCardMetadataFromColumnOrder(settings?.columnOrder || defaultTourColumnOrder);\n    }, [settings?.columnOrder]);\n    \n    // Versteckte Card-Metadaten aus hiddenColumns ableiten\n    const hiddenCardMetadata = useMemo(() => {\n        return getTourHiddenCardMetadata(settings?.hiddenColumns || []);\n    }, [settings?.hiddenColumns]);\n    \n    // Sichtbare Card-Metadaten\n    const visibleCardMetadata = useMemo(() => {\n        return new Set(cardMetadataOrder.filter(meta => !hiddenCardMetadata.has(meta)));\n    }, [cardMetadataOrder, hiddenCardMetadata]);\n    \n    // Funktion zum Laden der Tours\n    //  PERFORMANCE: Ref-Pattern verwendet (tourFilterLogicalOperatorsRef) statt State als Dependency\n    const loadTours = useCallback(async (filterId?: number, filterConditions?: any[], background = false) => {\n        try {\n            if (!background) {\n                setToursLoading(true);\n                setToursError(null);\n            }\n            \n            const params: Record<string, unknown> = {};\n            if (filterId) {\n                params.filterId = filterId;\n            } else if (filterConditions && filterConditions.length > 0) {\n                params.filterConditions = JSON.stringify({\n                    conditions: filterConditions,\n                    operators: tourFilterLogicalOperatorsRef.current  //  Ref verwenden statt State\n                });\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BASE, { params });\n            if (response.data.success) {\n                const rawData = response.data.data || [];\n                const toursData = Array.isArray(rawData) \n                    ? rawData.filter((tour: Tour | null) => \n                        tour != null && \n                        typeof tour === 'object' && \n                        tour.title != null && \n                        typeof tour.title === 'string'\n                    )\n                    : [];\n                if (!background) {\n                    setTours(toursData);\n                }\n            } else {\n                const errorMessage = response.data.message || t('errors.loadError');\n                if (!background) {\n                    setToursError(errorMessage);\n                    showMessage(errorMessage, 'error');\n                }\n            }\n        } catch (err: any) {\n            console.error('Fehler beim Laden der Touren:', err);\n            const errorMessage = err.response?.data?.message || t('errors.loadError');\n            if (!background) {\n                setToursError(errorMessage);\n                showMessage(errorMessage, 'error');\n            }\n        } finally {\n            if (!background) {\n                setToursLoading(false);\n            }\n        }\n    }, [t, showMessage]);  //  tourFilterLogicalOperators entfernt (Ref verwendet)\n    \n    // Handler fr Bildgenerierung\n    const handleGenerateImages = useCallback(async (tourId: number) => {\n        try {\n            setGeneratingImages(prev => ({ ...prev, [tourId]: true }));\n            \n            const response = await axiosInstance.post(API_ENDPOINTS.TOURS.GENERATE_IMAGES(tourId));\n            \n            if (response.data.success) {\n                if (response.data.mode === 'synchronous') {\n                    // Synchroner Modus: Fertig\n                    showMessage(\n                        t('tours.imagesGenerated', { defaultValue: 'Bilder erfolgreich generiert' }),\n                        'success'\n                    );\n                    setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                    await loadTours();\n                } else {\n                    // Asynchroner Modus: Polling starten\n                    const jobId = response.data.jobId;\n                    setImageGenerationJobs(prev => ({ ...prev, [tourId]: jobId }));\n                    showMessage(\n                        t('tours.imageGenerationStarted', { defaultValue: 'Bildgenerierung gestartet' }),\n                        'info'\n                    );\n                }\n            } else {\n                throw new Error(response.data.message || t('tours.imageGenerationFailed', { defaultValue: 'Fehler beim Starten der Bildgenerierung' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error starting image generation:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('tours.imageGenerationFailed', { defaultValue: 'Fehler bei Bildgenerierung' });\n            showMessage(errorMessage, 'error');\n            setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n        }\n    }, [t, showMessage, loadTours]);\n    \n    // Polling fr Bildgenerierungs-Status\n    useEffect(() => {\n        // Starte Polling nur fr neue Jobs (die noch kein Intervall haben)\n        Object.entries(imageGenerationJobs).forEach(([tourIdStr, jobId]) => {\n            if (!jobId) return;\n            \n            const tourId = parseInt(tourIdStr, 10);\n            \n            // berspringe, wenn bereits ein Polling luft\n            if (pollingIntervalsRef.current[tourId]) {\n                return;\n            }\n            \n            // Initialisiere Poll-Count fr diesen Job\n            if (!pollCountRef.current[tourId]) {\n                pollCountRef.current[tourId] = 0;\n            }\n            \n            const maxPolls = 30; // Max. 60 Sekunden (30 * 2 Sekunden)\n            \n            // Polling-Intervall starten\n            pollingIntervalsRef.current[tourId] = setInterval(async () => {\n                try {\n                    pollCountRef.current[tourId] = (pollCountRef.current[tourId] || 0) + 1;\n                    \n                    // Timeout nach 60 Sekunden\n                    if (pollCountRef.current[tourId] > maxPolls) {\n                        clearInterval(pollingIntervalsRef.current[tourId]);\n                        delete pollingIntervalsRef.current[tourId];\n                        delete pollCountRef.current[tourId];\n                        setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                        setImageGenerationJobs(prev => {\n                            const newJobs = { ...prev };\n                            delete newJobs[tourId];\n                            return newJobs;\n                        });\n                        showMessage(\n                            t('tours.imageGenerationTimeout', { defaultValue: 'Bildgenerierung hat zu lange gedauert' }),\n                            'warning'\n                        );\n                        return;\n                    }\n                    \n                    const response = await axiosInstance.get(\n                        API_ENDPOINTS.TOURS.GENERATE_IMAGES_STATUS(tourId),\n                        { params: { jobId } }\n                    );\n                    \n                    if (response.data.success) {\n                        const status = response.data.status;\n                        const progress = response.data.progress || 0;\n                        \n                        if (status === 'completed') {\n                            // Erfolg: Polling stoppen\n                            clearInterval(pollingIntervalsRef.current[tourId]);\n                            delete pollingIntervalsRef.current[tourId];\n                            delete pollCountRef.current[tourId];\n                            setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                            setImageGenerationJobs(prev => {\n                                const newJobs = { ...prev };\n                                delete newJobs[tourId];\n                                return newJobs;\n                            });\n                            showMessage(\n                                t('tours.imagesGenerated', { defaultValue: 'Bilder erfolgreich generiert' }),\n                                'success'\n                            );\n                            await loadTours();\n                        } else if (status === 'failed') {\n                            // Fehler: Polling stoppen\n                            clearInterval(pollingIntervalsRef.current[tourId]);\n                            delete pollingIntervalsRef.current[tourId];\n                            delete pollCountRef.current[tourId];\n                            setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                            setImageGenerationJobs(prev => {\n                                const newJobs = { ...prev };\n                                delete newJobs[tourId];\n                                return newJobs;\n                            });\n                            showMessage(\n                                t('tours.imageGenerationFailed', { defaultValue: 'Fehler bei Bildgenerierung' }),\n                                'error'\n                            );\n                        }\n                        // 'waiting' oder 'active': Weiter pollen\n                    }\n                } catch (err: unknown) {\n                    console.error('Error during polling:', err);\n                    // Fehler beim Polling: Wenn Job nicht gefunden, stoppe Polling\n                    if ((err as { response?: { status?: number } })?.response?.status === 404) {\n                        clearInterval(pollingIntervalsRef.current[tourId]);\n                        delete pollingIntervalsRef.current[tourId];\n                        delete pollCountRef.current[tourId];\n                        setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                        setImageGenerationJobs(prev => {\n                            const newJobs = { ...prev };\n                            delete newJobs[tourId];\n                            return newJobs;\n                        });\n                        showMessage(\n                            t('tours.imageGenerationFailed', { defaultValue: 'Fehler bei Bildgenerierung' }),\n                            'error'\n                        );\n                    }\n                    // Sonst: Weiter versuchen (nicht stoppen)\n                }\n            }, 2000); // Alle 2 Sekunden\n        });\n        \n        //  MEMORY LEAK PREVENTION: Cleanup-Funktion\n        return () => {\n            Object.values(pollingIntervalsRef.current).forEach(interval => clearInterval(interval));\n        };\n    }, [imageGenerationJobs, t, showMessage, loadTours]);\n    \n    //  MEMORY: Cleanup - Alle groen Arrays beim Unmount lschen\n    useEffect(() => {\n        return () => {\n            setTours([]);\n            setTourFilterConditions([]);\n        };\n    }, []); // Nur beim Unmount ausfhren\n    \n    //  ENTFERNT: Lade Tours beim Mount - wird jetzt durch Standard-Pattern gemacht\n    \n    // Tour-Filter-Funktionen\n    //  PERFORMANCE: Mit useCallback stabilisiert (verhindert Endlosschleife in useEffect)\n    const applyTourFilterConditions = useCallback((conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setTourFilterConditions(conditions);\n        setTourFilterLogicalOperators(operators);\n        loadTours(undefined, conditions, false);\n    }, [loadTours]);\n    \n    //  PERFORMANCE: Mit useCallback stabilisiert\n    const resetTourFilterConditions = useCallback(() => {\n        setTourFilterConditions([]);\n        setTourFilterLogicalOperators([]);\n        setTourActiveFilterName(t('tours.filters.current', 'Aktuell'));\n        setTourSelectedFilterId(null);\n        loadTours();\n    }, [loadTours, t]);\n    \n    //  PERFORMANCE: Mit useCallback stabilisiert (verhindert Endlosschleife in useEffect)\n    //  STANDARD: Wie in Requests.tsx - State setzen BEVOR Daten geladen werden\n    const handleTourFilterChange = useCallback(async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setTourSelectedFilterId(id);\n        setTourActiveFilterName(name);\n        if (id) {\n            //  STANDARD: State setzen BEVOR Daten geladen werden (wie in Requests.tsx:706-708)\n            setTourFilterConditions(conditions);\n            setTourFilterLogicalOperators(operators);\n            await loadTours(id);\n        } else {\n            await applyTourFilterConditions(conditions, operators);\n        }\n    }, [loadTours, applyTourFilterConditions]);\n    \n    //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n    const filterContext = useFilterContext();\n    const { loadFilters } = filterContext;\n    \n    //  PERFORMANCE: Ref verhindert mehrfache Anwendung des Default-Filters (Endlosschleife)\n    const initialLoadAttemptedRef = useRef(false);\n    \n    //  STANDARD: Filter-Laden und Default-Filter-Anwendung mit leeren Dependencies (wie in Requests.tsx)\n    useEffect(() => {\n        //  STANDARD: Warte bis Berechtigungen geladen sind\n        if (permissionsLoading) {\n            return;\n        }\n        \n        //  PERFORMANCE: Verhindere mehrfache Ausfhrung\n        if (initialLoadAttemptedRef.current) {\n            return;\n        }\n        \n        const initialize = async () => {\n            //  PERFORMANCE: Markiere als versucht, BEVOR async Operation startet\n            initialLoadAttemptedRef.current = true;\n            \n            try {\n                //  STANDARD: Prfe Berechtigung direkt (nicht in Dependencies!)\n                if (!hasPermission('tours', 'read', 'table')) {\n                    return;\n                }\n                \n                // 1. Filter laden (wartet auf State-Update)\n                const filters = await loadFilters(TOURS_TABLE_ID);\n                \n                // 2. Default-Filter anwenden (IMMER vorhanden!)\n                const defaultFilter = filters.find(f => f.name === 'Aktuell');\n                if (defaultFilter) {\n                    await handleTourFilterChange(\n                        defaultFilter.name,\n                        defaultFilter.id,\n                        defaultFilter.conditions,\n                        defaultFilter.operators\n                    );\n                    return; // Daten werden durch handleTourFilterChange geladen\n                }\n                \n                // 3. Fallback: Daten ohne Filter laden (sollte nie passieren)\n                await loadTours();\n            } catch (error) {\n                //  PERFORMANCE: Bei Fehler Ref zurcksetzen, damit Retry mglich ist\n                initialLoadAttemptedRef.current = false;\n                if (process.env.NODE_ENV === 'development') {\n                    console.error('[ToursTab] Error during initialization:', error);\n                }\n            }\n        };\n        \n        initialize();\n    }, [permissionsLoading]); //  STANDARD: permissionsLoading als Dependency (wird erneut ausgefhrt wenn Berechtigungen geladen sind)\n    \n    const handleTourSort = (key: TourSortConfig['key']) => {\n        // Table-Header-Sortierung: Aktualisiert Hauptsortierung direkt (synchron fr Table & Cards)\n        const newDirection = tourTableSortConfig.key === key && tourTableSortConfig.direction === 'asc' ? 'desc' : 'asc';\n        updateSortConfig({ key, direction: newDirection });\n    };\n    \n    // Drag & Drop Handler\n    const handleDragStart = (columnId: string) => {\n        setDraggedColumn(columnId);\n    };\n    \n    const handleDragOver = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n        if (draggedColumn && draggedColumn !== columnId) {\n            setDragOverColumn(columnId);\n        }\n    };\n    \n    const handleDrop = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n            if (draggedColumn && draggedColumn !== columnId) {\n                const columnOrder = settings?.columnOrder || defaultTourColumnOrder;\n                const dragIndex = columnOrder.indexOf(draggedColumn);\n                const hoverIndex = columnOrder.indexOf(columnId);\n\n                if (dragIndex > -1 && hoverIndex > -1) {\n                    const newColumnOrder = [...columnOrder];\n                const draggedColumn_ = newColumnOrder[dragIndex];\n                newColumnOrder.splice(dragIndex, 1);\n                newColumnOrder.splice(hoverIndex, 0, draggedColumn_);\n                updateColumnOrder(newColumnOrder);\n            }\n        }\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n    \n    const handleDragEnd = () => {\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n    \n    // Filtern und sortieren der Spalten gem den Benutzereinstellungen\n    const completeColumnOrder = useMemo(() => {\n        const currentOrder = settings?.columnOrder || [];\n        const validOrder = currentOrder.filter(id => id != null && typeof id === 'string');\n        const missingColumns = defaultTourColumnOrder.filter(id => !validOrder.includes(id));\n        return [...validOrder, ...missingColumns];\n    }, [settings?.columnOrder]);\n    \n    const visibleColumnIds = completeColumnOrder.filter(id => id != null && typeof id === 'string' && isColumnVisible(id));\n    \n    const getActiveFilterCount = () => {\n        return tourFilterConditions.length;\n    };\n    \n    // Filter- und Sortierlogik fr Tours\n    const filteredAndSortedTours = useMemo(() => {\n        // Sicherstellen, dass tours ein Array ist\n        if (!Array.isArray(tours)) {\n            return [];\n        }\n        \n        const validTours = tours.filter(tour => tour != null && tour.title != null && typeof tour.title === 'string');\n        \n        let filtered = validTours.filter(tour => {\n            // Such-Filter\n            if (tourSearchTerm) {\n                const searchLower = tourSearchTerm.toLowerCase();\n                \n                //  OPTIMIERUNG: Frhes Beenden bei Match\n                if (tour.title && tour.title.toLowerCase().includes(searchLower)) return true;\n                if (tour.location && tour.location.toLowerCase().includes(searchLower)) return true;\n                if (tour.description && tour.description.toLowerCase().includes(searchLower)) return true;\n                \n                return false; // Kein Match gefunden\n            }\n            \n            return true;\n        });\n\n        // Erweiterte Filterbedingungen anwenden\n        if (tourFilterConditions.length > 0) {\n            const columnEvaluators: Record<string, (tour: Tour, cond: FilterCondition) => boolean | null> = {\n                'title': (tour: Tour, cond: FilterCondition) => {\n                    if (!tour || !tour.title) return false;\n                    const value = (cond.value as string || '').toLowerCase();\n                    const title = (tour.title || '').toLowerCase();\n                    if (cond.operator === 'equals') return tour.title === cond.value;\n                    if (cond.operator === 'contains') return title.includes(value);\n                    if (cond.operator === 'startsWith') return title.startsWith(value);\n                    if (cond.operator === 'endsWith') return title.endsWith(value);\n                    return null;\n                },\n                'type': (tour: Tour, cond: FilterCondition) => {\n                    if (!tour || !tour.type) return false;\n                    if (cond.operator === 'equals') return tour.type === cond.value;\n                    if (cond.operator === 'notEquals') return tour.type !== cond.value;\n                    return null;\n                },\n                'isActive': (tour: Tour, cond: FilterCondition) => {\n                    const value = cond.value === 'true' || cond.value === true || cond.value === '1';\n                    if (cond.operator === 'equals') return tour.isActive === value;\n                    if (cond.operator === 'notEquals') return tour.isActive !== value;\n                    return null;\n                },\n                'price': (tour: Tour, cond: FilterCondition) => {\n                    const price = typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                    const compareValue = typeof cond.value === 'string' ? parseFloat(cond.value) : (cond.value || 0);\n                    if (isNaN(price) || isNaN(compareValue)) return false;\n                    if (cond.operator === 'equals') return Math.abs(price - compareValue) < 0.01;\n                    if (cond.operator === 'greaterThan') return price > compareValue;\n                    if (cond.operator === 'lessThan') return price < compareValue;\n                    return null;\n                },\n                'location': (tour: Tour, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const location = (tour.location || '').toLowerCase();\n                    if (cond.operator === 'equals') return tour.location === cond.value;\n                    if (cond.operator === 'contains') return location.includes(value);\n                    if (cond.operator === 'startsWith') return location.startsWith(value);\n                    if (cond.operator === 'endsWith') return location.endsWith(value);\n                    return null;\n                },\n                'branch': (tour: Tour, cond: FilterCondition) => {\n                    const branchName = (tour.branch?.name || '').toLowerCase();\n                    const value = (cond.value as string || '').toLowerCase();\n                    if (cond.operator === 'equals') return branchName === value;\n                    if (cond.operator === 'contains') return branchName.includes(value);\n                    return null;\n                },\n                'createdBy': (tour: Tour, cond: FilterCondition) => {\n                    const createdByName = tour.createdBy\n                        ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}`\n                        : '';\n                    return evaluateUserRoleCondition(\n                        tour.createdById || null,\n                        null,\n                        cond,\n                        createdByName\n                    );\n                }\n            };\n\n            const getFieldValue = (tour: Tour | null, columnId: string): string | number | boolean | null => {\n                if (!tour) return '';\n                switch (columnId) {\n                    case 'title': return tour.title || '';\n                    case 'type': return tour.type || '';\n                    case 'price': return typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                    case 'location': return tour.location || '';\n                    case 'duration': return tour.duration || 0;\n                    case 'branch': return tour.branch?.name || '';\n                    case 'createdBy': return tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}` : '';\n                    case 'isActive': return tour.isActive;\n                    default: return '';\n                }\n            };\n\n            filtered = applyFilters(\n                filtered,\n                tourFilterConditions,\n                tourFilterLogicalOperators,\n                getFieldValue,\n                columnEvaluators\n            );\n        }\n        \n        // Hilfsfunktion zum Extrahieren von Werten fr Sortierung\n        const getTourSortValue = (tour: Tour | null, columnId: string): string | number | boolean | null => {\n            if (!tour) return '';\n            switch (columnId) {\n                case 'title':\n                    return (tour.title || '').toLowerCase();\n                case 'type':\n                    return (tour.type || '').toLowerCase();\n                case 'price':\n                    return typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                case 'location':\n                    return (tour.location || '').toLowerCase();\n                case 'duration':\n                    return tour.duration || 0;\n                case 'branch':\n                    return (tour.branch?.name || '').toLowerCase();\n                case 'createdBy':\n                    return tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}`.toLowerCase() : '';\n                case 'isActive':\n                    return tour.isActive ? 1 : 0;\n                default:\n                    return '';\n            }\n        };\n        \n        // Sortierung basierend auf Prioritten\n        const sorted = filtered.sort((a, b) => {\n            // Null-Check fr a und b\n            if (!a || !b) {\n                if (!a && !b) return 0;\n                if (!a) return 1;\n                if (!b) return -1;\n            }\n            \n            // 2. Prioritt: Table-Header-Sortierung (temporre berschreibung, auch wenn Filter aktiv)\n            if (viewMode === 'table' && tourTableSortConfig.key) {\n                const valueA = getTourSortValue(a, tourTableSortConfig.key);\n                const valueB = getTourSortValue(b, tourTableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    //  OPTIMIERUNG: Vermeide String() Konvertierung wenn bereits String\n                    const strA = typeof valueA === 'string' ? valueA : String(valueA);\n                    const strB = typeof valueB === 'string' ? valueB : String(valueB);\n                    comparison = strA.localeCompare(strB);\n                }\n                \n                if (comparison !== 0) {\n                    return tourTableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 3. Hauptsortierung (tourTableSortConfig) - fr Table & Cards synchron\n            // (wird bereits oben in Prioritt 2 behandelt)\n            \n            // 4. Fallback: Titel (alphabetisch)\n            //  OPTIMIERUNG: toLowerCase() bereits in getTourSortValue, aber hier fr Fallback\n            const titleA = (a?.title || '').toLowerCase();\n            const titleB = (b?.title || '').toLowerCase();\n            return titleA.localeCompare(titleB);\n        });\n        \n        return sorted;\n    }, [tours, tourSearchTerm, tourFilterConditions, tourFilterLogicalOperators, viewMode, tourTableSortConfig]);\n\n    return (\n        <div className=\"space-y-4\">\n            {/* Header mit Suche, View-Toggle, Filter, Export, Create */}\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n                {/* Linke Seite: Suche */}\n                <div className=\"flex-1 w-full sm:max-w-md\">\n                    <input\n                        type=\"text\"\n                        placeholder={t('common.search') + '...'}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                        value={tourSearchTerm}\n                        onChange={(e) => setTourSearchTerm(e.target.value)}\n                    />\n                </div>\n                \n                {/* Rechte Seite: View-Toggle, Filter, Export, Create */}\n                <div className=\"flex items-center gap-1.5\">\n                    {/* View-Mode Toggle */}\n                    <div className=\"relative group\">\n                        <button\n                            className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n                                viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n                            }`}\n                            onClick={() => updateViewMode(viewMode === 'table' ? 'cards' : 'table')}\n                        >\n                            {viewMode === 'table' ? (\n                                <Squares2X2Icon className=\"h-5 w-5\" />\n                            ) : (\n                                <TableCellsIcon className=\"h-5 w-5\" />\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n                        </div>\n                    </div>\n                    \n                    {/* Filter-Button */}\n                    <div className=\"relative group ml-1\">\n                        <button\n                            className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n                            onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                        >\n                            <FunnelIcon className=\"h-5 w-5\" />\n                            {getActiveFilterCount() > 0 && (\n                                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                    {getActiveFilterCount()}\n                                </span>\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {t('common.filter')}\n                        </div>\n                    </div>\n                    \n                    {/* Export-Button */}\n                    {hasPermission('tour_edit', 'write', 'button') && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => setIsTourExportDialogOpen(true)}\n                                className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700\"\n                            >\n                                <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('tours.export', 'Exportieren')}\n                            </div>\n                        </div>\n                    )}\n                    \n                    {/* Spalten-Konfiguration */}\n                    <div className=\"ml-1\">\n                        <TableColumnConfig\n                            columns={viewMode === 'cards'\n                                ? [\n                                    { id: 'title', label: t('tours.columns.title', 'Titel') },\n                                    { id: 'type', label: t('tours.columns.type', 'Typ') },\n                                    { id: 'price', label: t('tours.columns.price', 'Preis') },\n                                    { id: 'location', label: t('tours.columns.location', 'Ort') },\n                                    { id: 'duration', label: t('tours.columns.duration', 'Dauer') },\n                                    { id: 'branch', label: t('tours.columns.branch', 'Niederlassung') },\n                                    { id: 'createdBy', label: t('tours.columns.createdBy', 'Erstellt von') },\n                                    { id: 'isActive', label: t('tours.columns.status', 'Status') }\n                                ]\n                                : availableTourColumns}\n                            visibleColumns={viewMode === 'cards'\n                                ? Array.from(visibleCardMetadata)\n                                : visibleColumnIds}\n                            columnOrder={viewMode === 'cards'\n                                ? cardMetadataOrder\n                                : settings.columnOrder}\n                            onToggleColumnVisibility={(columnId) => {\n                                if (viewMode === 'cards') {\n                                    const tableColumn = tourCardToTableMapping[columnId];\n                                    if (tableColumn) {\n                                        toggleColumnVisibility(tableColumn);\n                                    }\n                                } else {\n                                    toggleColumnVisibility(columnId);\n                                }\n                            }}\n                            onColumnOrderChange={(newOrder) => {\n                                if (viewMode === 'cards') {\n                                    const newTableOrder = newOrder.map(cardMeta => tourCardToTableMapping[cardMeta] || cardMeta).filter(Boolean);\n                                    updateColumnOrder(newTableOrder);\n                                } else {\n                                    updateColumnOrder(newOrder);\n                                }\n                            }}\n                            modalTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                            mainSortConfig={tourTableSortConfig}\n                            onMainSortChange={handleMainSortChange}\n                            showMainSort={true}\n                        />\n                    </div>\n                    \n                    {/* Create-Button */}\n                    {hasPermission('tour_create', 'write', 'button') && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => setIsCreateTourModalOpen(true)}\n                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                style={{ width: '30.19px', height: '30.19px' }}\n                                aria-label={t('tours.create', 'Neue Tour erstellen')}\n                            >\n                                <PlusIcon className=\"h-4 w-4\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('tours.create', 'Neue Tour erstellen')}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Filter-Pane */}\n            {isFilterModalOpen && (\n                <div className=\"px-3 sm:px-4 md:px-6\">\n                    <FilterPane\n                        columns={[...availableTourColumns, ...tourFilterOnlyColumns]}\n                        onApply={applyTourFilterConditions}\n                        onReset={resetTourFilterConditions}\n                        savedConditions={tourFilterConditions}\n                        savedOperators={tourFilterLogicalOperators}\n                        tableId={TOURS_TABLE_ID}\n                    />\n                </div>\n            )}\n\n            {/* Gespeicherte Filter als Tags */}\n            <SavedFilterTags\n                tableId={TOURS_TABLE_ID}\n                onSelectFilter={applyTourFilterConditions}\n                onReset={resetTourFilterConditions}\n                activeFilterName={tourActiveFilterName}\n                selectedFilterId={tourSelectedFilterId}\n                onFilterChange={handleTourFilterChange}\n                defaultFilterName=\"Aktuell\" //  FIX: Hardcodiert (konsistent mit DB)\n            />\n\n            {/* Table View */}\n            {viewMode === 'table' && (\n                <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                        <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                            <tr>\n                                {visibleColumnIds.map(columnId => {\n                                    const column = availableTourColumns.find(col => col.id === columnId);\n                                    if (!column) return null;\n                                    \n                                    return (\n                                        <th\n                                            key={columnId}\n                                            scope=\"col\"\n                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                            draggable={true}\n                                            onDragStart={() => handleDragStart(columnId)}\n                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                            onDrop={(e) => handleDrop(e, columnId)}\n                                            onDragEnd={handleDragEnd}\n                                        >\n                                            <div className=\"flex items-center\">\n                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                {columnId !== 'actions' && (\n                                                    <button \n                                                        onClick={() => handleTourSort(columnId as TourSortConfig['key'])}\n                                                        className=\"ml-1 focus:outline-none\"\n                                                    >\n                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                    </button>\n                                                )}\n                                            </div>\n                                        </th>\n                                    );\n                                })}\n                            </tr>\n                        </thead>\n                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                            {toursLoading ? (\n                                <tr>\n                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-gray-500 dark:text-gray-400\">\n                                        {t('common.loading')}\n                                    </td>\n                                </tr>\n                            ) : toursError ? (\n                                <tr>\n                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-red-500 dark:text-red-400\">\n                                        {toursError}\n                                    </td>\n                                </tr>\n                            ) : filteredAndSortedTours.length === 0 ? (\n                                <tr>\n                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-gray-500 dark:text-gray-400\">\n                                        {t('tours.noTours')}\n                                    </td>\n                                </tr>\n                            ) : (\n                                <>\n                                    {filteredAndSortedTours.slice(0, displayLimit).filter(tour => tour != null && tour.title != null).map(tour => (\n                                        <tr \n                                            key={tour.id} \n                                            className=\"hover:bg-gray-50 dark:hover:bg-gray-700\"\n                                        >\n                                            {visibleColumnIds.map(columnId => {\n                                                switch (columnId) {\n                                                    case 'title':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words\">\n                                                                    {tour?.title || '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'type':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'price':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.price ? `${Number(tour.price).toLocaleString()} ${tour.currency || 'COP'}` : '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'location':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.location || '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'duration':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.duration ? `${tour.duration} ${t('common.hours', 'h')}` : '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'branch':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.branch?.name || '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'createdBy':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}` : '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'isActive':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                {hasPermission('tour_edit', 'write', 'button') ? (\n                                                                    <button\n                                                                        onClick={async (e) => {\n                                                                            e.stopPropagation();\n                                                                            try {\n                                                                                await axiosInstance.put(API_ENDPOINTS.TOURS.TOGGLE_ACTIVE(tour.id));\n                                                                                showMessage(\n                                                                                    tour.isActive \n                                                                                        ? t('tours.deactivated', { defaultValue: 'Tour deaktiviert' })\n                                                                                        : t('tours.activated', { defaultValue: 'Tour aktiviert' }),\n                                                                                    'success'\n                                                                                );\n                                                                                await loadTours();\n                                                                            } catch (err: any) {\n                                                                                console.error('Fehler beim Toggle der Tour:', err);\n                                                                                showMessage(\n                                                                                    err.response?.data?.message || t('errors.unknownError'),\n                                                                                    'error'\n                                                                                );\n                                                                            }\n                                                                        }}\n                                                                        className={`px-2 py-1 text-xs rounded transition-colors ${\n                                                                            tour.isActive \n                                                                                ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 hover:bg-green-200 dark:hover:bg-green-800' \n                                                                                : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700'\n                                                                        }`}\n                                                                    >\n                                                                        {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                                                    </button>\n                                                                ) : (\n                                                                    <span className={`px-2 py-1 text-xs rounded ${\n                                                                        tour.isActive \n                                                                            ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' \n                                                                            : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                                                    }`}>\n                                                                        {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                                                    </span>\n                                                                )}\n                                                            </td>\n                                                        );\n                                                    case 'actions':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"flex space-x-2 action-buttons\">\n                                                                    <div className=\"relative group\">\n                                                                        <button\n                                                                            onClick={(e) => {\n                                                                                e.stopPropagation();\n                                                                                setSelectedTourId(tour.id);\n                                                                                setIsTourDetailsModalOpen(true);\n                                                                            }}\n                                                                            className=\"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                            title={t('common.viewDetails', { defaultValue: 'Details anzeigen' })}\n                                                                        >\n                                                                            <InformationCircleIcon className=\"h-4 w-4\" />\n                                                                        </button>\n                                                                        <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                            {t('common.viewDetails', 'Details anzeigen')}\n                                                                        </div>\n                                                                    </div>\n                                                                    {hasPermission('tour_edit', 'write', 'button') && (\n                                                                        <>\n                                                                            <div className=\"relative group\">\n                                                                                <button\n                                                                                    onClick={(e) => {\n                                                                                        e.stopPropagation();\n                                                                                        handleGenerateImages(tour.id);\n                                                                                    }}\n                                                                                    disabled={generatingImages[tour.id] || false}\n                                                                                    className={`p-1.5 transition-colors ${\n                                                                                        generatingImages[tour.id]\n                                                                                            ? 'text-gray-400 cursor-not-allowed'\n                                                                                            : 'text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300'\n                                                                                    }`}\n                                                                                    title={generatingImages[tour.id]\n                                                                                        ? t('tours.generatingImages', { defaultValue: 'Bilder werden generiert...' })\n                                                                                        : t('tours.generateImages', { defaultValue: 'Bilder generieren' })}\n                                                                                >\n                                                                                    <PhotoIcon className=\"h-4 w-4\" />\n                                                                                </button>\n                                                                                <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                    {generatingImages[tour.id]\n                                                                                        ? t('tours.generatingImages', { defaultValue: 'Bilder werden generiert...' })\n                                                                                        : t('tours.generateImages', { defaultValue: 'Bilder generieren' })}\n                                                                                </div>\n                                                                            </div>\n                                                                            <button\n                                                                                onClick={(e) => {\n                                                                                    e.stopPropagation();\n                                                                                    setSelectedTour(tour);\n                                                                                    setIsEditTourModalOpen(true);\n                                                                                }}\n                                                                                className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                title={t('tours.edit', { defaultValue: 'Bearbeiten' })}\n                                                                            >\n                                                                                <PencilIcon className=\"h-4 w-4\" />\n                                                                            </button>\n                                                                        </>\n                                                                    )}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    default:\n                                                        return null;\n                                                }\n                                            })}\n                                        </tr>\n                                    ))}\n                                </>\n                            )}\n                        </tbody>\n                    </table>\n                </div>\n            )}\n\n            {/* Card View */}\n            {viewMode === 'cards' && (\n                <CardGrid>\n                    {toursLoading ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                            {t('common.loading')}\n                        </div>\n                    ) : toursError ? (\n                        <div className=\"text-center py-8 text-red-500 dark:text-red-400\">\n                            {toursError}\n                        </div>\n                    ) : filteredAndSortedTours.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                            {t('tours.noTours')}\n                        </div>\n                    ) : (\n                        filteredAndSortedTours.slice(0, displayLimit).filter(tour => tour != null && tour.title != null).map((tour) => (\n                            <div\n                                key={tour.id}\n                                className=\"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 p-4 hover:shadow-md transition-shadow\"\n                            >\n                                {/* Bild-Anzeige */}\n                                {tour.imageUrl && (\n                                    <img \n                                        src={getTourImageUrl(tour.id)}\n                                        alt={tour.title || 'Tour Bild'}\n                                        className=\"w-full h-48 object-cover rounded-lg mb-2 cursor-pointer hover:opacity-90 transition-opacity\"\n                                        loading=\"lazy\"\n                                        onClick={() => {\n                                            setSelectedTourForLightbox(tour);\n                                            setInitialImageIndex(0);\n                                            setLightboxOpen(true);\n                                        }}\n                                    />\n                                )}\n                                \n                                {/* Galerie-Thumbnails */}\n                                {tour.galleryUrls && tour.galleryUrls.length > 0 && (\n                                    <div className=\"flex gap-2 mb-2 overflow-x-auto\">\n                                        {tour.galleryUrls.map((_, index) => (\n                                            <img\n                                                key={index}\n                                                src={getTourGalleryImageUrl(tour.id, index)}\n                                                alt={`${tour.title} - Galerie ${index + 1}`}\n                                                className=\"w-20 h-20 object-cover rounded cursor-pointer hover:opacity-90 transition-opacity flex-shrink-0\"\n                                                onClick={() => {\n                                                    setSelectedTourForLightbox(tour);\n                                                    setInitialImageIndex(index + 1); // +1 weil Index 0 = Hauptbild\n                                                    setLightboxOpen(true);\n                                                }}\n                                            />\n                                        ))}\n                                    </div>\n                                )}\n                                \n                                <div className=\"flex items-start justify-between mb-2\">\n                                    <h4 className=\"text-lg font-semibold dark:text-white\">{tour?.title || '-'}</h4>\n                                    {hasPermission('tour_edit', 'write', 'button') ? (\n                                        <button\n                                            onClick={async () => {\n                                                try {\n                                                    await axiosInstance.put(API_ENDPOINTS.TOURS.TOGGLE_ACTIVE(tour.id));\n                                                    showMessage(\n                                                        tour.isActive \n                                                            ? t('tours.deactivated', { defaultValue: 'Tour deaktiviert' })\n                                                            : t('tours.activated', { defaultValue: 'Tour aktiviert' }),\n                                                        'success'\n                                                    );\n                                                    await loadTours();\n                                                } catch (err: unknown) {\n                                                    console.error('Error toggling tour:', err);\n                                                    showMessage(\n                                                        (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.unknownError'),\n                                                        'error'\n                                                    );\n                                                }\n                                            }}\n                                            className={`px-2 py-1 text-xs rounded transition-colors ${\n                                                tour.isActive \n                                                    ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 hover:bg-green-200 dark:hover:bg-green-800' \n                                                    : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700'\n                                            }`}\n                                        >\n                                            {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                        </button>\n                                    ) : (\n                                        <span className={`px-2 py-1 text-xs rounded ${\n                                            tour.isActive \n                                                ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' \n                                                : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                        }`}>\n                                            {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                        </span>\n                                    )}\n                                </div>\n                                \n                                {tour.description && (\n                                    <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-2 line-clamp-2\">\n                                        {tour.description}\n                                    </p>\n                                )}\n\n                                <div className=\"flex items-center justify-between mt-4\">\n                                    <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                        <span className=\"font-medium\">{t('tours.type')}:</span>{' '}\n                                        {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                    </div>\n                                    {tour.price && (\n                                        <div className=\"text-sm font-semibold dark:text-white\">\n                                            {Number(tour.price).toLocaleString()} {tour.currency || 'COP'}\n                                        </div>\n                                    )}\n                                </div>\n                                \n                                {hasPermission('tour_edit', 'write', 'button') && (\n                                    <div className=\"mt-4 flex justify-end gap-2\">\n                                        {/* Bildgenerierungs-Button */}\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={() => handleGenerateImages(tour.id)}\n                                                disabled={generatingImages[tour.id] || false}\n                                                className={`p-1.5 rounded transition-colors ${\n                                                    generatingImages[tour.id]\n                                                        ? 'bg-gray-200 dark:bg-gray-600 text-gray-400 cursor-not-allowed'\n                                                        : 'text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/30'\n                                                }`}\n                                            >\n                                                <PhotoIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {generatingImages[tour.id]\n                                                    ? t('tours.generatingImages', { defaultValue: 'Bilder werden generiert...' })\n                                                    : t('tours.generateImages', { defaultValue: 'Bilder generieren' })}\n                                            </div>\n                                        </div>\n                                        <button\n                                            onClick={() => {\n                                                setSelectedTour(tour);\n                                                setIsEditTourModalOpen(true);\n                                            }}\n                                            className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                            title={t('tours.edit', { defaultValue: 'Bearbeiten' })}\n                                        >\n                                            <PencilIcon className=\"h-4 w-4\" />\n                                        </button>\n                                    </div>\n                                )}\n                            </div>\n                        ))\n                    )}\n                </CardGrid>\n            )}\n\n            {/* \"Mehr anzeigen\" Button */}\n            {filteredAndSortedTours.length > displayLimit && (\n                <div className=\"mt-4 flex justify-center\">\n                    <button\n                        className=\"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600\"\n                        onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                    >\n                        {t('common.showMore')} ({filteredAndSortedTours.length - displayLimit} {t('common.remaining')})\n                    </button>\n                </div>\n            )}\n\n            {/* Modals */}\n            <CreateTourModal\n                isOpen={isCreateTourModalOpen}\n                onClose={() => setIsCreateTourModalOpen(false)}\n                onTourCreated={async () => {\n                    await loadTours();\n                }}\n            />\n            \n            {selectedTour && (\n                <EditTourModal\n                    isOpen={isEditTourModalOpen}\n                    onClose={() => {\n                        setIsEditTourModalOpen(false);\n                        setSelectedTour(null);\n                    }}\n                    onTourUpdated={async (updatedTour) => {\n                        await loadTours();\n                        // Modal wird nur beim Speichern geschlossen, nicht beim Lschen von Bildern\n                        // setSelectedTour wird hier nicht auf null gesetzt, damit das Modal offen bleibt\n                    }}\n                    tour={selectedTour}\n                />\n            )}\n            \n            {selectedTourId && (\n                <TourDetailsModal\n                    isOpen={isTourDetailsModalOpen}\n                    onClose={() => {\n                        setIsTourDetailsModalOpen(false);\n                        setSelectedTourId(null);\n                    }}\n                    tourId={selectedTourId}\n                    onTourUpdated={async () => {\n                        await loadTours();\n                    }}\n                />\n            )}\n            \n            <TourExportDialog\n                isOpen={isTourExportDialogOpen}\n                onClose={() => setIsTourExportDialogOpen(false)}\n                tourCount={filteredAndSortedTours.length}\n            />\n            \n            {selectedTourForLightbox && (\n                <TourImageLightbox\n                    isOpen={lightboxOpen}\n                    onClose={() => {\n                        setLightboxOpen(false);\n                        setSelectedTourForLightbox(null);\n                    }}\n                    tourId={selectedTourForLightbox.id}\n                    initialImageIndex={initialImageIndex}\n                    imageUrl={selectedTourForLightbox.imageUrl}\n                    galleryUrls={selectedTourForLightbox.galleryUrls}\n                    tourTitle={selectedTourForLightbox.title}\n                />\n            )}\n        </div>\n    );\n};\n\nexport default ToursTab;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { CreateOrganizationRequest } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\nimport { useAuth } from '../../hooks/useAuth.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nconst CreateOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<CreateOrganizationRequest>({\n    name: '',\n    displayName: '',\n    domain: ''\n  });\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  const { fetchCurrentUser } = useAuth();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.name.trim()) {\n      newErrors.name = t('organization.create.nameRequired');\n    }\n    \n    if (!formData.displayName.trim()) {\n      newErrors.displayName = t('organization.create.displayNameRequired');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      await organizationService.createOrganization(formData);\n      setErrors({});\n      showMessage(t('organization.create.createSuccess'), 'success');\n      \n      // WICHTIG: User und Berechtigungen neu laden nach Erstellen der Organisation\n      // Der User wurde der Admin-Rolle zugeordnet und hat jetzt neue Berechtigungen\n      await fetchCurrentUser();\n      \n      // Formular zurcksetzen\n      setFormData({\n        name: '',\n        displayName: '',\n        domain: ''\n      });\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.create.createError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    setFormData({\n      name: '',\n      displayName: '',\n      domain: ''\n    });\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.create.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label \n                    htmlFor=\"name\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.name')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"name\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.name \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.name && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"displayName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.displayName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"displayName\"\n                    name=\"displayName\"\n                    value={formData.displayName}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.displayName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.displayName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"domain\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.domain')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"domain\"\n                    name=\"domain\"\n                    value={formData.domain}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.create.creating') : t('organization.create.createButton')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.create.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label \n                htmlFor=\"name\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.name')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.name \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.name && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"displayName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.displayName')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"displayName\"\n                name=\"displayName\"\n                value={formData.displayName}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.displayName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.displayName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"domain\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.domain')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"domain\"\n                name=\"domain\"\n                value={formData.domain}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? t('organization.create.creating') : t('organization.create.createButton')}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default CreateOrganizationModal; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { CreateJoinRequestRequest, Organization } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nconst JoinOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<CreateJoinRequestRequest>({\n    organizationName: '',\n    message: ''\n  });\n  const [loading, setLoading] = useState<boolean>(false);\n  const [searching, setSearching] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [organizations, setOrganizations] = useState<Organization[]>([]);\n  const [showDropdown, setShowDropdown] = useState<boolean>(false);\n  const [selectedOrganization, setSelectedOrganization] = useState<Organization | null>(null);\n  const searchTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  const { showMessage } = useMessage();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  // Click outside handler fr Dropdown\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setShowDropdown(false);\n      }\n    };\n\n    if (showDropdown) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showDropdown]);\n\n  const searchOrganizations = async (searchTerm: string) => {\n    if (searchTerm.length < 2) {\n      setOrganizations([]);\n      setShowDropdown(false);\n      return;\n    }\n\n    try {\n      setSearching(true);\n      const results = await organizationService.searchOrganizations(searchTerm);\n      setOrganizations(results);\n      setShowDropdown(true);\n    } catch (err: any) {\n      console.error('Fehler bei der Organisationen-Suche:', err);\n      setOrganizations([]);\n    } finally {\n      setSearching(false);\n    }\n  };\n\n  const handleOrganizationInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setFormData(prev => ({ ...prev, organizationName: value }));\n    setSelectedOrganization(null);\n    \n    // Fehler lschen\n    if (errors.organizationName) {\n      setErrors(prev => ({ ...prev, organizationName: '' }));\n    }\n\n    // Debounce fr Suche\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current);\n    }\n\n    searchTimeoutRef.current = setTimeout(() => {\n      searchOrganizations(value);\n    }, 300);\n  };\n\n  const handleSelectOrganization = (org: Organization) => {\n    setSelectedOrganization(org);\n    setFormData(prev => ({ ...prev, organizationName: org.name }));\n    setShowDropdown(false);\n    setOrganizations([]);\n  };\n\n  const handleMessageChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setFormData(prev => ({ ...prev, message: e.target.value }));\n    if (errors.message) {\n      setErrors(prev => ({ ...prev, message: '' }));\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.organizationName.trim()) {\n      newErrors.organizationName = t('organization.join.nameRequired');\n    } else if (!selectedOrganization) {\n      newErrors.organizationName = t('organization.join.selectFromList');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      await organizationService.createJoinRequest(formData);\n      setErrors({});\n      showMessage(t('organization.join.sendSuccess'), 'success');\n      // Formular zurcksetzen\n      setFormData({\n        organizationName: '',\n        message: ''\n      });\n      setSelectedOrganization(null);\n      setOrganizations([]);\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.join.sendError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    setFormData({\n      organizationName: '',\n      message: ''\n    });\n    setSelectedOrganization(null);\n    setOrganizations([]);\n    setErrors({});\n    setShowDropdown(false);\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current);\n    }\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.join.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div className=\"relative\" ref={dropdownRef}>\n                  <label \n                    htmlFor=\"organizationName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.join.search')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"organizationName\"\n                    name=\"organizationName\"\n                    value={formData.organizationName}\n                    onChange={handleOrganizationInputChange}\n                    placeholder={t('organization.join.searchPlaceholder')}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.organizationName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.organizationName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.organizationName}</p>\n                  )}\n                  \n                  {/* Autocomplete Dropdown */}\n                  {showDropdown && (organizations.length > 0 || searching) && (\n                    <div className=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto\">\n                      {searching ? (\n                        <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                          {t('organization.join.searching')}\n                        </div>\n                      ) : organizations.length > 0 ? (\n                        organizations.map(org => (\n                          <button\n                            key={org.id}\n                            type=\"button\"\n                            onClick={() => handleSelectOrganization(org)}\n                            className=\"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none\"\n                          >\n                            <div className=\"font-medium text-gray-900 dark:text-white\">\n                              {org.displayName || org.name}\n                            </div>\n                            {org.displayName && (\n                              <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                {org.name}\n                              </div>\n                            )}\n                          </button>\n                        ))\n                      ) : (\n                        <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                          {t('organization.join.noOrganizations')}\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"message\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.join.message')}\n                  </label>\n                  <textarea\n                    id=\"message\"\n                    name=\"message\"\n                    value={formData.message || ''}\n                    onChange={handleMessageChange}\n                    rows={3}\n                    placeholder={t('organization.join.messagePlaceholder')}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.join.sending') : t('organization.join.send')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.join.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"relative\" ref={dropdownRef}>\n              <label \n                htmlFor=\"organizationName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.join.search')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"organizationName\"\n                name=\"organizationName\"\n                value={formData.organizationName}\n                onChange={handleOrganizationInputChange}\n                placeholder={t('organization.join.searchPlaceholder')}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.organizationName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.organizationName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.organizationName}</p>\n              )}\n              \n              {/* Autocomplete Dropdown */}\n              {showDropdown && (organizations.length > 0 || searching) && (\n                <div className=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto\">\n                  {searching ? (\n                    <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                      {t('organization.join.searching')}\n                    </div>\n                  ) : organizations.length > 0 ? (\n                    organizations.map(org => (\n                      <button\n                        key={org.id}\n                        type=\"button\"\n                        onClick={() => handleSelectOrganization(org)}\n                        className=\"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none\"\n                      >\n                        <div className=\"font-medium text-gray-900 dark:text-white\">\n                          {org.displayName || org.name}\n                        </div>\n                        {org.displayName && (\n                          <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                            {org.name}\n                          </div>\n                        )}\n                      </button>\n                    ))\n                  ) : (\n                    <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                      {t('organization.join.noOrganizations')}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"message\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.join.message')}\n              </label>\n              <textarea\n                id=\"message\"\n                name=\"message\"\n                value={formData.message || ''}\n                onChange={handleMessageChange}\n                rows={3}\n                placeholder={t('organization.join.messagePlaceholder')}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? t('organization.join.sending') : t('organization.join.send')}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default JoinOrganizationModal; ","import React, { useState, useEffect, Suspense } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { UpdateOrganizationRequest, Organization } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\nimport { useLanguage } from '../../hooks/useLanguage.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\n//  PERFORMANCE: Lazy Loading fr Tab-Komponenten\nconst RoleConfigurationTab = React.lazy(() => import('./RoleConfigurationTab.tsx'));\nconst DocumentConfigurationTab = React.lazy(() => import('./DocumentConfigurationTab.tsx'));\nconst SMTPConfigurationTab = React.lazy(() => import('./SMTPConfigurationTab.tsx'));\nconst ApiConfigurationTab = React.lazy(() => import('./ApiConfigurationTab.tsx'));\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n  organization: Organization | null;\n}\n\nconst EditOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess, organization }) => {\n  const { t } = useTranslation();\n  const { fetchCurrentUser } = useAuth();\n  const [formData, setFormData] = useState<UpdateOrganizationRequest>({\n    displayName: '',\n    domain: '',\n    logo: '',\n    country: null,\n    nit: null,\n    settings: {}\n  });\n  //  PERFORMANCE: Organization mit Settings fr Tab-Komponenten\n  const [organizationWithSettings, setOrganizationWithSettings] = useState<Organization | null>(null);\n  const [selectedCountry, setSelectedCountry] = useState<string>('');\n  const [nit, setNit] = useState<string>('');\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  const { organizationLanguage, setOrganizationLanguage } = useLanguage();\n  const [selectedOrgLanguage, setSelectedOrgLanguage] = useState<string>('');\n  const [savingOrgLanguage, setSavingOrgLanguage] = useState<boolean>(false);\n  const [activeTab, setActiveTab] = useState<'general' | 'roles' | 'documents' | 'smtp' | 'api'>('general');\n  const [logoFile, setLogoFile] = useState<File | null>(null);\n  const [logoPreview, setLogoPreview] = useState<string | null>(null);\n\n  // Lnder-Liste\n  const COUNTRIES = [\n    { code: 'CO', name: t('countries.CO') },\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'DE', name: t('countries.DE') },\n    { code: 'AT', name: t('countries.AT') }\n  ];\n\n  // Lade Organisations-Daten wenn Modal geffnet wird\n  useEffect(() => {\n    if (isOpen && organization) {\n      //  PERFORMANCE: Settings laden wenn Modal geffnet wird und Settings fehlen\n      const loadSettingsIfNeeded = async () => {\n        let orgWithSettings = organization;\n        \n        // Settings laden wenn fehlen\n        if (!organization.settings) {\n          try {\n            orgWithSettings = await organizationService.getCurrentOrganization(undefined, true);\n          } catch (error) {\n            console.error('Fehler beim Laden der Settings:', error);\n          }\n        }\n        \n        //  PERFORMANCE: Organization mit Settings fr Tab-Komponenten speichern\n        setOrganizationWithSettings(orgWithSettings);\n        \n        const orgSettings = orgWithSettings.settings || {};\n        setFormData({\n          displayName: orgWithSettings.displayName || '',\n          domain: orgWithSettings.domain || '',\n          logo: orgWithSettings.logo || '',\n          country: orgWithSettings.country || null,\n          nit: orgWithSettings.nit || null,\n          settings: orgSettings\n        });\n        \n        // Setze Land direkt aus organization (statt aus settings)\n        setSelectedCountry(orgWithSettings.country || '');\n        setNit(orgWithSettings.nit || '');\n        \n        // Setze Logo-Preview wenn Logo vorhanden\n        if (orgWithSettings.logo) {\n          setLogoPreview(orgWithSettings.logo);\n        } else {\n          setLogoPreview(null);\n        }\n        setLogoFile(null);\n        \n        // Lade Organisation-Sprache\n        const loadOrgLanguage = async () => {\n          try {\n            const langResponse = await organizationService.getOrganizationLanguage();\n            setSelectedOrgLanguage(langResponse.language || '');\n          } catch (langError) {\n            console.error(t('organization.loadLanguageError'), langError);\n            setSelectedOrgLanguage('');\n          }\n        };\n        \n        loadOrgLanguage();\n      };\n      \n      loadSettingsIfNeeded();\n    } else if (!isOpen) {\n      //  PERFORMANCE: State zurcksetzen beim Schlieen\n      setOrganizationWithSettings(null);\n    }\n  }, [isOpen, organization, t]);\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    if (name === 'country') {\n      setSelectedCountry(value);\n      setFormData(prev => ({\n        ...prev,\n        country: value || null\n      }));\n      // Wenn Country nicht \"CO\" ist, NIT zurcksetzen\n      if (value !== 'CO') {\n        setNit('');\n        setFormData(prev => ({\n          ...prev,\n          nit: null\n        }));\n      }\n    } else if (name === 'nit') {\n      setNit(value);\n      setFormData(prev => ({\n        ...prev,\n        nit: value || null\n      }));\n    } else {\n      setFormData(prev => ({ ...prev, [name]: value }));\n    }\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleLogoFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Prfe Dateityp\n    if (!file.type.match('image/(png|jpeg|jpg)')) {\n      showMessage(t('organization.logoInvalidType') || 'Nur PNG und JPEG Dateien sind erlaubt', 'error');\n      return;\n    }\n\n    // Prfe Dateigre (max 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      showMessage(t('organization.logoTooLarge') || 'Logo darf maximal 5MB gro sein', 'error');\n      return;\n    }\n\n    setLogoFile(file);\n\n    // Erstelle Preview\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      const base64String = reader.result as string;\n      setLogoPreview(base64String);\n      setFormData(prev => ({ ...prev, logo: base64String }));\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    try {\n      setLoading(true);\n      setErrors({});\n      await organizationService.updateOrganization(formData);\n      showMessage(t('organization.updateSuccess'), 'success');\n      \n      // User-Daten neu laden, damit das Logo im Header aktualisiert wird\n      try {\n        await fetchCurrentUser();\n      } catch (error) {\n        console.error('Fehler beim Neuladen der User-Daten:', error);\n      }\n      \n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.updateError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    if (organization) {\n      const orgSettings = organization.settings || {};\n      setFormData({\n        displayName: organization.displayName || '',\n        domain: organization.domain || '',\n        logo: organization.logo || '',\n        country: organization.country || null,\n        nit: organization.nit || null,\n        settings: orgSettings\n      });\n      setSelectedCountry(organization.country || '');\n      setNit(organization.nit || '');\n    }\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.edit.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label \n                    htmlFor=\"displayName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.displayName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"displayName\"\n                    name=\"displayName\"\n                    value={formData.displayName || ''}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.displayName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.displayName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"domain\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.domain')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"domain\"\n                    name=\"domain\"\n                    value={formData.domain || ''}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"logo-mobile\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.logo') || 'Logo'}\n                  </label>\n                  <input\n                    type=\"file\"\n                    id=\"logo-mobile\"\n                    name=\"logo\"\n                    accept=\"image/png,image/jpeg,image/jpg\"\n                    onChange={handleLogoFileChange}\n                    className=\"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400\n                      file:mr-4 file:py-2 file:px-4\n                      file:rounded-md file:border-0\n                      file:text-sm file:font-semibold\n                      file:bg-blue-50 file:text-blue-700\n                      hover:file:bg-blue-100\n                      dark:file:bg-blue-900 dark:file:text-blue-300\n                      dark:hover:file:bg-blue-800\"\n                  />\n                  {logoPreview && (\n                    <div className=\"mt-2\">\n                      <img \n                        src={logoPreview} \n                        alt=\"Logo Preview\" \n                        className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                      />\n                    </div>\n                  )}\n                  {formData.logo && !logoPreview && (\n                    <div className=\"mt-2\">\n                      <img \n                        src={formData.logo} \n                        alt=\"Current Logo\" \n                        className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                      />\n                    </div>\n                  )}\n                </div>\n\n                {/* Land */}\n                <div className=\"border-t pt-4\">\n                  <label \n                    htmlFor=\"country\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.country')}\n                  </label>\n                  <select\n                    id=\"country\"\n                    name=\"country\"\n                    value={selectedCountry}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  >\n                    <option value=\"\">{t('organization.selectCountry')}</option>\n                    {COUNTRIES.map((country) => (\n                      <option key={country.code} value={country.code}>\n                        {country.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                {/* Organisation-Sprache */}\n                <div className=\"border-t pt-4\">\n                  <label \n                    htmlFor=\"organizationLanguage\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.language')}\n                  </label>\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\n                    {t('organization.languageDescription')}\n                  </p>\n                  <select\n                    id=\"organizationLanguage\"\n                    value={selectedOrgLanguage || organizationLanguage || ''}\n                    onChange={async (e) => {\n                      const newLanguage = e.target.value;\n                      setSelectedOrgLanguage(newLanguage);\n                      if (newLanguage && newLanguage !== organizationLanguage) {\n                        setSavingOrgLanguage(true);\n                        try {\n                          await setOrganizationLanguage(newLanguage);\n                          showMessage(t('common.save'), 'success');\n                        } catch (error) {\n                          console.error(t('organization.saveLanguageError'), error);\n                          showMessage(t('worktime.messages.orgLanguageError'), 'error');\n                        } finally {\n                          setSavingOrgLanguage(false);\n                        }\n                      }\n                    }}\n                    disabled={savingOrgLanguage || loading}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed\"\n                  >\n                    <option value=\"\">{t('settings.useOrganizationLanguage')} ({t('worktime.language.fallback')}: {t('worktime.language.german')})</option>\n                    <option value=\"de\">{t('worktime.language.german')}</option>\n                    <option value=\"es\">{t('worktime.language.spanish')}</option>\n                    <option value=\"en\">{t('worktime.language.english')}</option>\n                  </select>\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.saving') : t('common.save')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.edit.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        {/* Tabs Navigation */}\n        <div className=\"border-b border-gray-200 dark:border-gray-700\">\n          <nav className=\"-mb-px flex space-x-4 px-4\" aria-label=\"Tabs\">\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('general')}\n              className={`${\n                activeTab === 'general'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.general')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('roles')}\n              className={`${\n                activeTab === 'roles'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.roles')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('documents')}\n              className={`${\n                activeTab === 'documents'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.documents')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('smtp')}\n              className={`${\n                activeTab === 'smtp'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.smtp')}\n            </button>\n            {selectedCountry === 'CO' && (\n              <button\n                type=\"button\"\n                onClick={() => setActiveTab('api')}\n                className={`${\n                  activeTab === 'api'\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n              >\n                {t('organization.tabs.api')}\n              </button>\n            )}\n          </nav>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          {activeTab === 'general' && (\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label \n                htmlFor=\"displayName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.displayName')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"displayName\"\n                name=\"displayName\"\n                value={formData.displayName || ''}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.displayName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.displayName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"domain\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.domain')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"domain\"\n                name=\"domain\"\n                value={formData.domain || ''}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"logo\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.logo') || 'Logo'}\n              </label>\n              <input\n                type=\"file\"\n                id=\"logo\"\n                name=\"logo\"\n                accept=\"image/png,image/jpeg,image/jpg\"\n                onChange={handleLogoFileChange}\n                className=\"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400\n                  file:mr-4 file:py-2 file:px-4\n                  file:rounded-md file:border-0\n                  file:text-sm file:font-semibold\n                  file:bg-blue-50 file:text-blue-700\n                  hover:file:bg-blue-100\n                  dark:file:bg-blue-900 dark:file:text-blue-300\n                  dark:hover:file:bg-blue-800\"\n              />\n              {logoPreview && (\n                <div className=\"mt-2\">\n                  <img \n                    src={logoPreview} \n                    alt=\"Logo Preview\" \n                    className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                  />\n                </div>\n              )}\n              {formData.logo && !logoPreview && (\n                <div className=\"mt-2\">\n                  <img \n                    src={formData.logo} \n                    alt=\"Current Logo\" \n                    className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                  />\n                </div>\n              )}\n            </div>\n\n            {/* Land */}\n            <div className=\"border-t pt-4\">\n              <label \n                htmlFor=\"country\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.country')}\n              </label>\n              <select\n                id=\"country\"\n                name=\"country\"\n                value={selectedCountry}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              >\n                <option value=\"\">{t('organization.selectCountry')}</option>\n                {COUNTRIES.map((country) => (\n                  <option key={country.code} value={country.code}>\n                    {country.name}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            {/* NIT (nur fr Kolumbien) */}\n            {selectedCountry === 'CO' && (\n              <div>\n                <label \n                  htmlFor=\"nit\" \n                  className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                >\n                  {t('organization.nit')}\n                </label>\n                <input\n                  type=\"text\"\n                  id=\"nit\"\n                  name=\"nit\"\n                  value={nit}\n                  onChange={handleChange}\n                  placeholder={t('organization.nitDescription')}\n                  className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('organization.nitDescription')}\n                </p>\n              </div>\n            )}\n\n            {/* Organisation-Sprache */}\n            <div className=\"border-t pt-4\">\n              <label \n                htmlFor=\"organizationLanguage\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.language')}\n              </label>\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\n                {t('organization.languageDescription')}\n              </p>\n              <select\n                id=\"organizationLanguage\"\n                value={selectedOrgLanguage || organizationLanguage || ''}\n                onChange={async (e) => {\n                  const newLanguage = e.target.value;\n                  setSelectedOrgLanguage(newLanguage);\n                  if (newLanguage && newLanguage !== organizationLanguage) {\n                    setSavingOrgLanguage(true);\n                    try {\n                      await setOrganizationLanguage(newLanguage);\n                      showMessage(t('common.save'), 'success');\n                    } catch (error) {\n                      console.error('Fehler beim Speichern der Organisation-Sprache:', error);\n                      showMessage(t('worktime.messages.orgLanguageError'), 'error');\n                    } finally {\n                      setSavingOrgLanguage(false);\n                    }\n                  }\n                }}\n                disabled={savingOrgLanguage || loading}\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed\"\n              >\n                <option value=\"\">{t('settings.useOrganizationLanguage')} ({t('worktime.language.fallback')}: {t('worktime.language.german')})</option>\n                <option value=\"de\">{t('worktime.language.german')}</option>\n                <option value=\"es\">{t('worktime.language.spanish')}</option>\n                <option value=\"en\">{t('worktime.language.english')}</option>\n              </select>\n            </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.saving') : t('common.save')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          )}\n\n          {activeTab === 'roles' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <RoleConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n\n          {activeTab === 'documents' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <DocumentConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n\n          {activeTab === 'smtp' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <SMTPConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n\n          {activeTab === 'api' && selectedCountry === 'CO' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <ApiConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default EditOrganizationModal;\n\n","import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { XMarkIcon, ArrowPathIcon, FunnelIcon, ArrowUturnLeftIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport axiosInstance from '../../config/axios.ts';\nimport { logger } from '../../utils/logger.ts';\n\n// Status-Badge Funktionen\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case 'pending':\n      return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';\n    case 'approved':\n      return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\n    case 'rejected':\n      return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\n    case 'withdrawn':\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n    default:\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n  }\n};\n\nconst getStatusText = (status: string, t: any) => {\n  switch (status) {\n    case 'pending':\n      return t('joinRequestsList.status.pending');\n    case 'approved':\n      return t('joinRequestsList.status.approved');\n    case 'rejected':\n      return t('joinRequestsList.status.rejected');\n    case 'withdrawn':\n      return t('joinRequestsList.status.withdrawn');\n    default:\n      return status;\n  }\n};\n\nconst MY_JOIN_REQUESTS_TABLE_ID = 'my-join-requests-table';\n\nconst MyJoinRequestsList: React.FC = () => {\n  const { t } = useTranslation();\n  const [joinRequests, setJoinRequests] = useState<OrganizationJoinRequest[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState<boolean>(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const { showMessage } = useMessage();\n  const mountedRef = useRef(true);\n  const [withdrawingId, setWithdrawingId] = useState<number | null>(null);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n\n  useEffect(() => {\n    return () => {\n      mountedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    logger.log('MyJoinRequestsList: useEffect called - component mounted');\n    \n    // WICHTIG: State beim Mount zurcksetzen, um Caching zwischen Usern zu vermeiden\n    logger.log('MyJoinRequestsList: Resetting state on mount to prevent data leaks');\n    setJoinRequests([]);\n    setError(null);\n    setLoading(true);\n    \n    let isMounted = true;\n    \n    const fetchMyJoinRequests = async () => {\n      if (!isMounted) {\n        logger.log('MyJoinRequestsList: Component unmounted, skipping fetch');\n        return;\n      }\n      \n      logger.log('MyJoinRequestsList: Starting fetch');\n      \n      // Timeout nach 10 Sekunden\n      const timeoutId = setTimeout(() => {\n        if (isMounted) {\n          console.error('Request timeout after 10 seconds');\n          setError('Anfrage dauert zu lange. Bitte Seite neu laden.');\n          setLoading(false);\n        }\n      }, 10000);\n      \n      try {\n        logger.log('MyJoinRequestsList: Setting loading to true');\n        setLoading(true);\n        setError(null);\n        \n        // Debug: Log die URL die aufgerufen wird\n        logger.log('MyJoinRequestsList: Fetching my join requests from:', API_ENDPOINTS.ORGANIZATIONS.MY_JOIN_REQUESTS);\n        \n        const requests = await organizationService.getMyJoinRequests();\n        \n        logger.log('MyJoinRequestsList: Received requests:', requests);\n        logger.log('MyJoinRequestsList: Requests type:', typeof requests);\n        logger.log('MyJoinRequestsList: Requests isArray:', Array.isArray(requests));\n        logger.log('MyJoinRequestsList: Requests length:', requests?.length || 0);\n        \n        // SICHERHEIT: Validiere, dass alle Anfragen wirklich Arrays sind\n        if (!Array.isArray(requests)) {\n          console.error(' MyJoinRequestsList: Response is not an array!', requests);\n          throw new Error('Ungltige Antwort vom Server');\n        }\n        \n        clearTimeout(timeoutId);\n        \n        // State immer setzen, auch wenn Component unmounted ist\n        // (React kann den State trotzdem setzen, wenn Component wieder gemountet wird)\n        if (isMounted) {\n          logger.log('MyJoinRequestsList: Setting joinRequests state');\n          setJoinRequests(requests);\n          logger.log('MyJoinRequestsList: State updated with', requests.length, 'requests');\n        } else {\n          logger.log('MyJoinRequestsList: Component was unmounted, but setting state anyway');\n          setJoinRequests(requests);\n        }\n      } catch (err: any) {\n        clearTimeout(timeoutId);\n        \n        if (!isMounted) {\n          logger.log('MyJoinRequestsList: Component unmounted during error, skipping error handling');\n          return;\n        }\n        \n        console.error('MyJoinRequestsList: Error fetching my join requests:', err);\n        console.error('MyJoinRequestsList: Error response:', err.response);\n        console.error('MyJoinRequestsList: Error status:', err.response?.status);\n        console.error('MyJoinRequestsList: Error data:', err.response?.data);\n        \n        const errorMessage = err.response?.data?.message || err.message || t('myJoinRequests.loadError');\n        setError(errorMessage);\n        setTimeout(() => {\n          showMessage(errorMessage, 'error');\n        }, 0);\n      } finally {\n        if (isMounted) {\n          logger.log('MyJoinRequestsList: Setting loading to false');\n          setLoading(false);\n        } else {\n          // Auch wenn unmounted, loading auf false setzen\n          logger.log('MyJoinRequestsList: Component unmounted, but setting loading to false anyway');\n          setLoading(false);\n        }\n      }\n    };\n\n    // IMMER neu laden beim Mount (auch beim Tab-Wechsel zurck)\n    fetchMyJoinRequests();\n    \n    return () => {\n      logger.log('MyJoinRequestsList: useEffect cleanup - component unmounting');\n      isMounted = false;\n      mountedRef.current = false;\n      // State beim Unmount zurcksetzen\n      setJoinRequests([]);\n      setError(null);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleWithdraw = async (requestId: number) => {\n    if (!window.confirm(t('myJoinRequests.confirmWithdraw'))) {\n      return;\n    }\n\n    try {\n      setWithdrawingId(requestId);\n      await organizationService.withdrawJoinRequest(requestId);\n      \n      // Update local state\n      setJoinRequests(prev => \n        prev.map(req => \n          req.id === requestId \n            ? { ...req, status: 'withdrawn' as const, processedAt: new Date().toISOString() }\n            : req\n        )\n      );\n      \n      showMessage(t('myJoinRequests.withdrawSuccess'), 'success');\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('myJoinRequests.withdrawError');\n      showMessage(errorMessage, 'error');\n    } finally {\n      setWithdrawingId(null);\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('de-DE', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  // Filter-Funktionen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n\n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  useEffect(() => {\n    const initialize = async () => {\n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(MY_JOIN_REQUESTS_TABLE_ID);\n      \n      // 2. Default-Filter anwenden (IMMER vorhanden!)\n      const defaultFilter = filters.find(f => f.name === 'Alle');\n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        return; // Filter wird angewendet\n      }\n      \n      // 3. Fallback: Kein Filter (sollte nie passieren)\n      // MyJoinRequestsList filtert client-seitig, daher keine Daten-Lade-Funktion ntig\n    };\n    \n    initialize();\n  }, [loadFilters, handleFilterChange]);\n\n  // Standard-Filter erstellen und speichern\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(MY_JOIN_REQUESTS_TABLE_ID)\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: MY_JOIN_REQUESTS_TABLE_ID,\n            name: 'Alle',\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\n            alleFilter\n          );\n          logger.log('Alle-Filter fr Meine Beitrittsanfragen erstellt');\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []);\n\n  // Gefilterte Join-Requests\n  const filteredJoinRequests = useMemo(() => {\n    let filtered = [...joinRequests];\n\n    // Suchfeld-Filter\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(request => {\n        const orgName = (request.organization.displayName || request.organization.name || '').toLowerCase();\n        const message = request.message?.toLowerCase() || '';\n        return orgName.includes(searchLower) || message.includes(searchLower);\n      });\n    }\n\n    // Filter-Bedingungen aus FilterPane\n    if (filterConditions.length > 0) {\n      filtered = filterConditions.reduce((acc, condition, index) => {\n        if (!condition.column || condition.value === null || condition.value === '') {\n          return acc;\n        }\n\n        const operator = condition.operator;\n        const value = condition.value;\n\n        return acc.filter(request => {\n          switch (condition.column) {\n            case 'organization':\n              const orgName = (request.organization.displayName || request.organization.name || '').toLowerCase();\n              const searchValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return orgName.includes(searchValue);\n              } else if (operator === 'equals') {\n                return orgName === searchValue;\n              } else if (operator === 'startsWith') {\n                return orgName.startsWith(searchValue);\n              }\n              return false;\n\n            case 'message':\n              const message = request.message?.toLowerCase() || '';\n              const msgValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return message.includes(msgValue);\n              } else if (operator === 'equals') {\n                return message === msgValue;\n              } else if (operator === 'startsWith') {\n                return message.startsWith(msgValue);\n              }\n              return false;\n\n            case 'status':\n              if (operator === 'equals') {\n                return request.status === value;\n              }\n              return false;\n\n            default:\n              return true;\n          }\n        });\n      }, filtered);\n    }\n\n    return filtered;\n  }, [joinRequests, searchTerm, filterConditions, filterLogicalOperators]);\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n      {/* Titelzeile mit Icon, Suchfeld, Filter-Button */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <h2 className=\"text-xl font-semibold dark:text-white\">\n          {t('myJoinRequests.title')}\n        </h2>\n        \n        <div className=\"flex items-center gap-1.5\">\n          {/* Suchfeld */}\n          <input\n            type=\"text\"\n            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n\n          {/* Filter-Button */}\n          <button\n            className={`p-2 rounded-md border ${getActiveFilterCount() > 0 ? 'border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n            onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n            title={t('common.filter')}\n          >\n            <FunnelIcon className=\"h-5 w-5\" />\n            {getActiveFilterCount() > 0 && (\n              <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                {getActiveFilterCount()}\n              </span>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Filter-Panel */}\n      {isFilterPanelOpen && (\n        <div className=\"mb-4\">\n          <FilterPane\n            columns={[\n              { id: 'organization', label: t('myJoinRequests.filter.organization', { defaultValue: 'Organisation' }) },\n              { id: 'message', label: t('joinRequestsList.filter.message') },\n              { id: 'status', label: t('joinRequestsList.status.title', { defaultValue: 'Status' }) }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={MY_JOIN_REQUESTS_TABLE_ID}\n          />\n        </div>\n      )}\n\n      {/* Gespeicherte Filter als Tags anzeigen */}\n      <SavedFilterTags\n        tableId={MY_JOIN_REQUESTS_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n        defaultFilterName=\"Alle\"\n      />\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded\">\n          {error}\n        </div>\n      )}\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('myJoinRequests.loading')}</span>\n        </div>\n      ) : joinRequests.length === 0 ? (\n        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n          {t('myJoinRequests.noRequests')}\n        </div>\n      ) : (\n        /* Cards fr Join-Requests */\n        <div className=\"space-y-4\">\n          {filteredJoinRequests.map(request => (\n            <div\n              key={request.id}\n              className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\"\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                        {request.organization.displayName || request.organization.name}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        {formatDate(request.createdAt)}\n                      </p>\n                    </div>\n                    <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(request.status)}`}>\n                      {getStatusText(request.status, t)}\n                    </span>\n                  </div>\n\n                  {request.message && (\n                    <div className=\"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.filter.message')}:</span> {request.message}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.response && (\n                    <div className=\"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700\">\n                      <p className=\"text-sm text-blue-700 dark:text-blue-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.response')}:</span> {request.response}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.processor && (\n                    <div className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\n                      {t('myJoinRequests.processedBy')}: {request.processor.firstName} {request.processor.lastName}\n                      {request.processedAt && ` - ${formatDate(request.processedAt)}`}\n                    </div>\n                  )}\n\n                  {request.status === 'pending' && (\n                    <div className=\"mt-4 flex items-center gap-2\">\n                      <button \n                        onClick={() => handleWithdraw(request.id)}\n                        disabled={withdrawingId === request.id}\n                        className=\"p-2 bg-red-600 hover:bg-red-700 text-white rounded-md dark:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n                        title={withdrawingId === request.id ? t('myJoinRequests.withdrawing') : t('myJoinRequests.withdraw')}\n                      >\n                        {withdrawingId === request.id ? (\n                          <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                        ) : (\n                          <ArrowUturnLeftIcon className=\"h-5 w-5\" />\n                        )}\n                      </button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default MyJoinRequestsList;\n\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { BuildingOfficeIcon, PlusIcon, UserPlusIcon, UserGroupIcon, ShieldCheckIcon, EnvelopeIcon, ChartBarIcon, PencilIcon } from '@heroicons/react/24/outline';\nimport { useTranslation } from 'react-i18next';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { Organization } from '../../types/organization.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useOrganization } from '../../contexts/OrganizationContext.tsx';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport CreateOrganizationModal from './CreateOrganizationModal.tsx';\nimport JoinOrganizationModal from './JoinOrganizationModal.tsx';\nimport EditOrganizationModal from './EditOrganizationModal.tsx';\nimport MyJoinRequestsList from './MyJoinRequestsList.tsx';\n\ninterface OrganizationStats {\n  currentUsers: number;\n  maxUsers: number;\n  availableSlots: number;\n  utilizationPercent: number;\n  _count: {\n    roles: number;\n    joinRequests: number;\n    invitations: number;\n  };\n}\n\nconst OrganizationSettings: React.FC = () => {\n  const [organization, setOrganization] = useState<Organization | null>(null);\n  const [stats, setStats] = useState<OrganizationStats | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [loadingStats, setLoadingStats] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState<boolean>(false);\n  const [isJoinModalOpen, setIsJoinModalOpen] = useState<boolean>(false);\n  const [isEditModalOpen, setIsEditModalOpen] = useState<boolean>(false);\n  const { canViewOrganization, canManageOrganization, hasPermission, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  const { t } = useTranslation();\n  const { refreshOrganization } = useOrganization();\n  const { fetchCurrentUser } = useAuth();\n\n  const fetchOrganization = useCallback(async (includeSettings = false) => {\n    try {\n      setLoading(true);\n      setError(null);\n      //  PERFORMANCE: Settings nur laden wenn wirklich bentigt (beim Bearbeiten)\n      const org = await organizationService.getCurrentOrganization(undefined, includeSettings);\n      setOrganization(org);\n      \n      // Statistiken laden\n      try {\n        setLoadingStats(true);\n        const statsData = await organizationService.getOrganizationStats();\n        setStats(statsData);\n      } catch (statsErr: any) {\n        console.error('Fehler beim Laden der Statistiken:', statsErr);\n        // Statistiken-Fehler nicht kritisch, keine Error-Message\n      } finally {\n        setLoadingStats(false);\n      }\n    } catch (err: any) {\n      // Prfe ob es ein 404-Fehler ist (keine Organisation gefunden)\n      if (err.response?.status === 404 && err.response?.data?.hasOrganization === false) {\n        // Benutzer hat keine Organisation - das ist OK, setze Error aber nicht kritisch\n        // Verwende IMMER die bersetzung, nicht die Backend-Nachricht\n        setError(t('organization.notFound'));\n        setOrganization(null);\n        // Zeige Info-Message statt Error\n        showMessage(t('organization.notFound'), 'info');\n      } else {\n        // Andere Fehler - kritisch\n        const errorMessage = err.response?.data?.message || t('organization.loadError');\n        setError(errorMessage);\n        showMessage(errorMessage, 'error');\n      }\n    } finally {\n      setLoading(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const hasInitialLoadRef = useRef(false);\n\n  useEffect(() => {\n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      return;\n    }\n\n    // Nur einmal beim initialen Load ausfhren\n    if (hasInitialLoadRef.current) {\n      return;\n    }\n\n    const hasPermission = canViewOrganization();\n    if (hasPermission) {\n    hasInitialLoadRef.current = true;\n    //  PERFORMANCE: Initial OHNE Settings laden (nur beim Bearbeiten)\n    fetchOrganization(false);\n    } else {\n      setError(t('organization.noPermission'));\n      setLoading(false);\n      hasInitialLoadRef.current = true;\n    }\n    \n    //  MEMORY: Cleanup - Settings aus State entfernen beim Unmount\n    return () => {\n      setOrganization(null);\n      setStats(null);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [permissionsLoading]);\n\n  const handleEditSuccess = () => {\n    //  PERFORMANCE: Nach Bearbeiten Settings laden (fr Anzeige)\n    fetchOrganization(true);\n    // Aktualisiere auch den OrganizationContext\n    refreshOrganization();\n  };\n\n  //  MEMORY: Settings beim Schlieen des Modals lschen\n  const handleEditModalClose = () => {\n    setIsEditModalOpen(false);\n    // Settings aus State entfernen (nur Settings, nicht die gesamte Organization)\n    if (organization?.settings) {\n      setOrganization({\n        ...organization,\n        settings: undefined\n      });\n    }\n  };\n\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('common.loadingPermissions')}</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canViewOrganization()) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n          <div className=\"p-4 text-red-600 dark:text-red-400\">\n          {t('organization.noPermission')}\n        </div>\n      </div>\n    );\n  }\n\n  const handleCreateSuccess = () => {\n    //  PERFORMANCE: Nach Erstellen OHNE Settings laden (nicht bentigt)\n    fetchOrganization(false);\n  };\n\n  const handleJoinSuccess = async () => {\n    // Nach Beitritt: Organisation neu laden (OHNE Settings, nicht bentigt)\n    fetchOrganization(false);\n    // WICHTIG: User-Rollen neu laden, damit neue Rolle sichtbar wird\n    // OnboardingContext erkennt dann automatisch die neue Rolle\n    await fetchCurrentUser();\n  };\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        {/* Titelzeile mit Action-Buttons */}\n        <div className=\"flex items-center mb-4 sm:mb-4\">\n          {/* Linke Seite: Action-Buttons */}\n          <div className=\"flex items-center gap-1.5\" data-onboarding=\"organization-buttons\">\n            {/* Button: Neue Organisation erstellen - immer sichtbar (nicht nur fr Admins) */}\n            <button\n              onClick={() => setIsCreateModalOpen(true)}\n              data-onboarding=\"create-organization-button\"\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('organization.createOrganization')}\n              aria-label={t('organization.createOrganization')}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n            </button>\n            \n            {/* Button: Organisation beitreten - immer sichtbar */}\n            <button\n              onClick={() => setIsJoinModalOpen(true)}\n              data-onboarding=\"join-organization-button\"\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('organization.joinOrganization')}\n              aria-label={t('organization.joinOrganization')}\n            >\n              <UserPlusIcon className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('common.loadingOrganization')}</span>\n        </div>\n      ) : (\n        <>\n          {/* Error/Info Display */}\n          {error && (\n            <div className={`mb-4 p-4 border rounded ${\n              !organization \n                ? 'bg-blue-50 dark:bg-blue-900/30 border-blue-400 dark:border-blue-700 text-blue-700 dark:text-blue-300'\n                : 'bg-red-100 dark:bg-red-900 border-red-400 dark:border-red-700 text-red-700 dark:text-red-300'\n            }`}>\n              <div className=\"flex items-start\">\n                <div className=\"flex-shrink-0\">\n                  {!organization ? (\n                    <UserGroupIcon className=\"h-5 w-5\" />\n                  ) : (\n                    <span className=\"text-red-600 dark:text-red-400\"></span>\n                  )}\n                </div>\n                <div className=\"ml-3 flex-1\">\n                  <p className=\"font-medium\">{error}</p>\n                  {!organization && (\n                    <p className=\"mt-2 text-sm\">{t('organization.createOrJoinHint')}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Card-Ansicht - nur anzeigen wenn Organisation existiert */}\n          {organization ? (\n            <>\n            {/* Card mit Organisations-Infos */}\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-4\">\n            <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white flex items-center\">\n                        <BuildingOfficeIcon className=\"h-5 w-5 mr-2\" />\n                        {organization.displayName || organization.name}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                        {organization.domain || t('organization.noDomain')}\n                      </p>\n            </div>\n                    {/*  FIX: Prfe NUR organization_edit Button-Berechtigung (canManageOrganization entfernt) */}\n                    {hasPermission('organization_edit', 'write', 'button') && (\n                      <button\n                        onClick={() => {\n                          //  PERFORMANCE: Modal ffnet sofort - Settings werden im Modal geladen wenn bentigt\n                          setIsEditModalOpen(true);\n                        }}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                        title={t('organization.edit.title')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                      </button>\n                    )}\n            </div>\n\n                  {/* Organisations-Infos */}\n                  <div className=\"space-y-3\">\n                    {organization.subscriptionPlan && (\n            <div>\n                        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">{t('organization.subscriptionPlan')}:</span>\n                        <span className=\"ml-2 text-sm text-gray-900 dark:text-white capitalize\">{organization.subscriptionPlan}</span>\n              </div>\n            )}\n              </div>\n\n                  {/* Statistiken direkt in der Card */}\n          {stats && (\n                    <>\n            <div className=\"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700\">\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">{t('organization.statistics')}</h3>\n              {loadingStats ? (\n                <div className=\"flex items-center justify-center py-4\">\n                  <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-2\"></div>\n                  <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('common.loadingStatistics')}</span>\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {/* Benutzer Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-blue-100 dark:bg-blue-900/30 rounded-lg p-3\">\n                        <UserGroupIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.users')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats.currentUsers} / {stats.maxUsers}\n                        </p>\n                            {stats.utilizationPercent !== undefined && (\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            {stats.utilizationPercent}% {t('organization.utilizationPercent')}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Rollen Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-purple-100 dark:bg-purple-900/30 rounded-lg p-3\">\n                        <ShieldCheckIcon className=\"h-6 w-6 text-purple-600 dark:text-purple-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.roles')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats._count.roles}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Beitrittsanfragen Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg p-3\">\n                        <EnvelopeIcon className=\"h-6 w-6 text-yellow-600 dark:text-yellow-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.joinRequests')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats._count.joinRequests}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Einladungen Card */}\n                  {stats._count.invitations !== undefined && (\n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 bg-green-100 dark:bg-green-900/30 rounded-lg p-3\">\n                          <EnvelopeIcon className=\"h-6 w-6 text-green-600 dark:text-green-400\" />\n                        </div>\n                        <div className=\"ml-4\">\n                          <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.invitations')}</p>\n                          <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                            {stats._count.invitations}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Auslastung Card */}\n                  {stats.utilizationPercent !== undefined && (\n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg p-3\">\n                          <ChartBarIcon className=\"h-6 w-6 text-indigo-600 dark:text-indigo-400\" />\n                        </div>\n                        <div className=\"ml-4\">\n                          <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.utilization')}</p>\n                          <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                            {stats.utilizationPercent}%\n                          </p>\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            {stats.availableSlots} {t('organization.availableSlots')}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n                    </>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            </>\n          ) : (\n            /* Keine Organisation - zeige Hinweis */\n            <div className=\"text-center py-8\">\n            <UserGroupIcon className=\"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500 mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\n              {t('organization.notFound')}\n            </h3>\n            <p className=\"text-gray-600 dark:text-gray-400\">\n              {t('organization.createOrJoinHint')}\n            </p>\n          </div>\n        )}\n        </>\n      )}\n      </div>\n\n      {/* Meine Beitrittsanfragen - immer anzeigen */}\n      <MyJoinRequestsList />\n\n      {/* Modals */}\n      <CreateOrganizationModal\n        isOpen={isCreateModalOpen}\n        onClose={() => setIsCreateModalOpen(false)}\n        onSuccess={handleCreateSuccess}\n      />\n\n      <JoinOrganizationModal\n        isOpen={isJoinModalOpen}\n        onClose={() => setIsJoinModalOpen(false)}\n        onSuccess={handleJoinSuccess}\n      />\n\n      <EditOrganizationModal\n        isOpen={isEditModalOpen}\n        onClose={handleEditModalClose}\n        onSuccess={handleEditSuccess}\n        organization={organization}\n      />\n    </>\n  );\n};\n\nexport default OrganizationSettings; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon, XCircleIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest, ProcessJoinRequestRequest } from '../../types/organization.ts';\nimport { roleApi } from '../../api/apiClient.ts';\nimport { Role } from '../../types/interfaces.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  joinRequest: OrganizationJoinRequest | null;\n  onSuccess: () => void;\n}\n\nconst ProcessJoinRequestModal: React.FC<Props> = ({ isOpen, onClose, joinRequest, onSuccess }) => {\n  const { t } = useTranslation();\n  const [action, setAction] = useState<'approve' | 'reject'>('approve');\n  const [roleId, setRoleId] = useState<number | null>(null);\n  const [response, setResponse] = useState<string>('');\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState<boolean>(false);\n  const [saving, setSaving] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  useEffect(() => {\n    if (isOpen && joinRequest) {\n      // Reset form when modal opens\n      setAction('approve');\n      setRoleId(null);\n      setResponse('');\n      setErrors({});\n      \n      // Load roles for the organization\n      if (joinRequest.organizationId) {\n        fetchRoles();\n      }\n    }\n  }, [isOpen, joinRequest]);\n\n  const fetchRoles = async () => {\n    try {\n      setLoadingRoles(true);\n      const response = await roleApi.getAll();\n      if (response.data && Array.isArray(response.data)) {\n        setRoles(response.data);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Rollen:', err);\n      showMessage(t('joinRequest.loadRolesError'), 'error');\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (action === 'approve' && !roleId) {\n      newErrors.roleId = t('joinRequest.selectRoleError');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    if (!joinRequest) {\n      return;\n    }\n    \n    try {\n      setSaving(true);\n      const data: ProcessJoinRequestRequest = {\n        action,\n        response: response.trim() || undefined,\n        roleId: action === 'approve' ? roleId || undefined : undefined\n      };\n      \n      await organizationService.processJoinRequest(joinRequest.id, data);\n      showMessage(\n        action === 'approve' ? t('joinRequest.approveSuccess') : t('joinRequest.rejectSuccess'),\n        'success'\n      );\n      \n      // Reset form\n      setAction('approve');\n      setRoleId(null);\n      setResponse('');\n      setErrors({});\n      \n      onClose();\n      onSuccess();\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('joinRequest.processError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleClose = () => {\n    setAction('approve');\n    setRoleId(null);\n    setResponse('');\n    setErrors({});\n    onClose();\n  };\n\n  if (!joinRequest) {\n    return null;\n  }\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('joinRequest.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                {/* Antragsteller Info */}\n                <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                  <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.applicant')}:</p>\n                  <p className=\"text-sm text-gray-900 dark:text-white\">\n                    {joinRequest.requester.firstName} {joinRequest.requester.lastName}\n                  </p>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.requester.email}</p>\n                  {joinRequest.message && (\n                    <div className=\"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.message')}:</p>\n                      <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.message}</p>\n                    </div>\n                  )}\n                </div>\n\n                {/* Aktion (Genehmigen/Ablehnen) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('joinRequest.actionRequired')}\n                  </label>\n                  <div className=\"flex gap-4 mt-2\">\n                    <label className=\"flex items-center\">\n                      <input\n                        type=\"radio\"\n                        value=\"approve\"\n                        checked={action === 'approve'}\n                        onChange={(e) => {\n                          setAction(e.target.value as 'approve' | 'reject');\n                          setErrors({});\n                        }}\n                        className=\"mr-2 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.approve')}</span>\n                    </label>\n                    <label className=\"flex items-center\">\n                      <input\n                        type=\"radio\"\n                        value=\"reject\"\n                        checked={action === 'reject'}\n                        onChange={(e) => {\n                          setAction(e.target.value as 'approve' | 'reject');\n                          setErrors({});\n                        }}\n                        className=\"mr-2 text-red-600 focus:ring-red-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.reject')}</span>\n                    </label>\n                  </div>\n                </div>\n\n                {/* Rollenauswahl (nur bei Genehmigung) */}\n                {action === 'approve' && (\n                  <div>\n                    <label \n                      htmlFor=\"roleId\" \n                      className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                    >\n                      {t('joinRequest.assignRole')}\n                    </label>\n                    {loadingRoles ? (\n                      <div className=\"flex items-center py-2\">\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n                        <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('joinRequest.loadingRoles')}</span>\n                      </div>\n                    ) : (\n                      <select\n                        id=\"roleId\"\n                        value={roleId || ''}\n                        onChange={(e) => {\n                          setRoleId(Number(e.target.value) || null);\n                          if (errors.roleId) {\n                            setErrors(prev => ({ ...prev, roleId: '' }));\n                          }\n                        }}\n                        className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                          errors.roleId \n                            ? 'border-red-300 dark:border-red-600' \n                            : 'border-gray-300 dark:border-gray-600'\n                        }`}\n                      >\n                        <option value=\"\">{t('joinRequest.selectRole')}</option>\n                        {roles.map(role => (\n                          <option key={role.id} value={role.id}>\n                            {role.name} {role.description ? `- ${role.description}` : ''}\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                    {errors.roleId && (\n                      <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.roleId}</p>\n                    )}\n                  </div>\n                )}\n\n                {/* Antwort-Message */}\n                <div>\n                  <label \n                    htmlFor=\"response\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('joinRequest.response')}\n                  </label>\n                  <textarea\n                    id=\"response\"\n                    value={response}\n                    onChange={(e) => setResponse(e.target.value)}\n                    rows={3}\n                    placeholder={t('joinRequest.addOptional', { type: action === 'approve' ? t('joinRequest.welcomeMessage') : t('joinRequest.rejectionReason') })}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={saving}\n                  className={`p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ${\n                    action === 'approve'\n                      ? 'bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500'\n                      : 'bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500'\n                  }`}\n                  title={saving ? (action === 'approve' ? t('joinRequest.approving') : t('joinRequest.rejecting')) : (action === 'approve' ? t('joinRequest.approve') : t('joinRequest.reject'))}\n                >\n                  {saving ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : action === 'approve' ? (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  ) : (\n                    <XCircleIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('joinRequest.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Antragsteller Info */}\n            <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n              <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.applicant')}:</p>\n              <p className=\"text-sm text-gray-900 dark:text-white\">\n                {joinRequest.requester.firstName} {joinRequest.requester.lastName}\n              </p>\n              <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.requester.email}</p>\n              {joinRequest.message && (\n                <div className=\"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600\">\n                  <p className=\"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.message')}:</p>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.message}</p>\n                </div>\n              )}\n            </div>\n\n            {/* Aktion (Genehmigen/Ablehnen) */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('joinRequest.actionRequired')}\n              </label>\n              <div className=\"flex gap-4 mt-2\">\n                <label className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    value=\"approve\"\n                    checked={action === 'approve'}\n                    onChange={(e) => {\n                      setAction(e.target.value as 'approve' | 'reject');\n                      setErrors({});\n                    }}\n                    className=\"mr-2 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.approve')}</span>\n                </label>\n                <label className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    value=\"reject\"\n                    checked={action === 'reject'}\n                    onChange={(e) => {\n                      setAction(e.target.value as 'approve' | 'reject');\n                      setErrors({});\n                    }}\n                    className=\"mr-2 text-red-600 focus:ring-red-500\"\n                  />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.reject')}</span>\n                </label>\n              </div>\n            </div>\n\n            {/* Rollenauswahl (nur bei Genehmigung) */}\n            {action === 'approve' && (\n              <div>\n                <label \n                  htmlFor=\"roleId\" \n                  className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                >\n                  {t('joinRequest.assignRole')}\n                </label>\n                {loadingRoles ? (\n                  <div className=\"flex items-center py-2\">\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n                    <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('joinRequest.loadingRoles')}</span>\n                  </div>\n                ) : (\n                  <select\n                    id=\"roleId\"\n                    value={roleId || ''}\n                    onChange={(e) => {\n                      setRoleId(Number(e.target.value) || null);\n                      if (errors.roleId) {\n                        setErrors(prev => ({ ...prev, roleId: '' }));\n                      }\n                    }}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.roleId \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  >\n                    <option value=\"\">{t('joinRequest.selectRole')}</option>\n                    {roles.map(role => (\n                      <option key={role.id} value={role.id}>\n                        {role.name} {role.description ? `- ${role.description}` : ''}\n                      </option>\n                    ))}\n                  </select>\n                )}\n                {errors.roleId && (\n                  <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.roleId}</p>\n                )}\n              </div>\n            )}\n\n            {/* Antwort-Message */}\n            <div>\n              <label \n                htmlFor=\"response\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('joinRequest.response')}\n              </label>\n              <textarea\n                id=\"response\"\n                value={response}\n                onChange={(e) => setResponse(e.target.value)}\n                rows={3}\n                placeholder={t('joinRequest.addOptional', { type: action === 'approve' ? t('joinRequest.welcomeMessage') : t('joinRequest.rejectionReason') })}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={saving}\n                className={`p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ${\n                  action === 'approve'\n                    ? 'bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500'\n                    : 'bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500'\n                }`}\n                title={saving ? (action === 'approve' ? 'Genehmige...' : 'Lehne ab...') : (action === 'approve' ? 'Genehmigen' : 'Ablehnen')}\n              >\n                {saving ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : action === 'approve' ? (\n                  <CheckIcon className=\"h-5 w-5\" />\n                ) : (\n                  <XCircleIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default ProcessJoinRequestModal;\n\n","import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { UserPlusIcon, FunnelIcon, PencilIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest } from '../../types/organization.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport ProcessJoinRequestModal from './ProcessJoinRequestModal.tsx';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\nimport { logger } from '../../utils/logger.ts';\n\n// Status-Badge Funktionen\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case 'pending':\n      return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';\n    case 'approved':\n      return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\n    case 'rejected':\n      return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\n    case 'withdrawn':\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n    default:\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n  }\n};\n\nconst getStatusText = (status: string, t: any) => {\n  switch (status) {\n    case 'pending':\n      return t('joinRequestsList.status.pending');\n    case 'approved':\n      return t('joinRequestsList.status.approved');\n    case 'rejected':\n      return t('joinRequestsList.status.rejected');\n    case 'withdrawn':\n      return t('joinRequestsList.status.withdrawn');\n    default:\n      return status;\n  }\n};\n\nconst JOIN_REQUESTS_TABLE_ID = 'join-requests-table';\n\nconst JoinRequestsList: React.FC = () => {\n  const { t } = useTranslation();\n  const [joinRequests, setJoinRequests] = useState<OrganizationJoinRequest[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState<boolean>(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [isProcessModalOpen, setIsProcessModalOpen] = useState<boolean>(false);\n  const [selectedRequest, setSelectedRequest] = useState<OrganizationJoinRequest | null>(null);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  const { canViewJoinRequests, canManageJoinRequests, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  const mountedRef = useRef(true);\n  const hasInitialLoadRef = useRef(false);\n\n  // Debug: Log permissionsLoading nderungen\n  useEffect(() => {\n    logger.log('[JoinRequestsList] permissionsLoading gendert:', permissionsLoading);\n  }, [permissionsLoading]);\n\n  // Reset beim Mount - wichtig fr Neuladen wenn Komponente neu gemountet wird\n  useEffect(() => {\n    logger.log('[JoinRequestsList] Component mounted, reset hasInitialLoadRef');\n    hasInitialLoadRef.current = false;\n    mountedRef.current = true;\n    \n    return () => {\n      logger.log('[JoinRequestsList] Component unmounting');\n      mountedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    logger.log('[JoinRequestsList] useEffect triggered', { \n      permissionsLoading, \n      hasInitialLoad: hasInitialLoadRef.current,\n      joinRequestsCount: joinRequests.length \n    });\n    \n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      logger.log('[JoinRequestsList] Warte auf Berechtigungen...');\n      return;\n    }\n\n    // Prfe Berechtigung direkt\n    const hasPermission = canViewJoinRequests();\n    logger.log('[JoinRequestsList] Berechtigung geprft:', hasPermission);\n    \n    if (!hasPermission) {\n      logger.log('[JoinRequestsList] Keine Berechtigung zum Anzeigen');\n      setError(t('joinRequestsList.noPermission'));\n      setLoading(false);\n      hasInitialLoadRef.current = true;\n      return;\n    }\n\n    // WICHTIG: Nur laden wenn noch nicht erfolgreich geladen wurde\n    // Das verhindert unntige Re-Fetches bei jedem permissionsLoading-Change\n    if (hasInitialLoadRef.current) {\n      logger.log('[JoinRequestsList] Bereits geladen, berspringe Fetch');\n      return;\n    }\n\n    logger.log('[JoinRequestsList] Starte Fetch der Join Requests...');\n    \n    const fetchJoinRequests = async () => {\n      if (!mountedRef.current) {\n        logger.log('[JoinRequestsList] Component unmounted, breche ab');\n        return;\n      }\n      \n      try {\n        logger.log('[JoinRequestsList] Setze loading auf true');\n        setLoading(true);\n        setError(null);\n        \n        logger.log('[JoinRequestsList] Rufe organizationService.getJoinRequests() auf...');\n        logger.log('[JoinRequestsList] API Endpoint:', API_ENDPOINTS.ORGANIZATIONS.JOIN_REQUESTS);\n        \n        const requests = await organizationService.getJoinRequests();\n        \n        logger.log('[JoinRequestsList] Antwort erhalten:', requests);\n        logger.log('[JoinRequestsList] Antwort Typ:', typeof requests);\n        logger.log('[JoinRequestsList] Ist Array:', Array.isArray(requests));\n        logger.log('[JoinRequestsList] Ist null/undefined:', requests === null || requests === undefined);\n        \n        if (!mountedRef.current) {\n          logger.log('[JoinRequestsList] Component whrend Request unmounted');\n          return;\n        }\n        \n        // Validiere, dass die Antwort vorhanden ist\n        if (requests === null || requests === undefined) {\n          console.error('[JoinRequestsList]  Antwort ist null oder undefined!');\n          throw new Error('Ungltige Antwort vom Server: Antwort ist null oder undefined');\n        }\n        \n        // Validiere, dass die Antwort ein Array ist\n        if (!Array.isArray(requests)) {\n          console.error('[JoinRequestsList]  Antwort ist kein Array!', requests);\n          throw new Error('Ungltige Antwort vom Server: Erwartetes Array, erhalten: ' + typeof requests);\n        }\n        \n        logger.log('[JoinRequestsList]  Setze', requests.length, 'Join Requests');\n        setJoinRequests(requests);\n        setError(null); // Fehler zurcksetzen bei Erfolg\n        hasInitialLoadRef.current = true; // Nur bei Erfolg setzen\n      } catch (err: any) {\n        console.error('[JoinRequestsList]  Fehler beim Laden:', err);\n        console.error('[JoinRequestsList] Fehler Details:', {\n          message: err.message,\n          response: err.response,\n          status: err.response?.status,\n          data: err.response?.data,\n          stack: err.stack\n        });\n        \n        if (!mountedRef.current) {\n          logger.log('[JoinRequestsList] Component whrend Error-Handling unmounted');\n          return;\n        }\n        \n        const errorMessage = err.response?.data?.message || err.message || t('joinRequestsList.loadError', { defaultValue: 'Fehler beim Laden der Beitrittsanfragen' });\n        logger.log('[JoinRequestsList] Zeige Fehlermeldung:', errorMessage);\n        setError(errorMessage);\n        // showMessage nur auerhalb useEffect verwenden, um Re-Renders zu vermeiden\n        // Verwende setTimeout, um es asynchron auszufhren\n        setTimeout(() => {\n          showMessage(errorMessage, 'error');\n        }, 0);\n        // Bei Fehler NICHT hasInitialLoadRef setzen, damit bei nchstem permissionsLoading-Change neu geladen wird\n      } finally {\n        if (mountedRef.current) {\n          logger.log('[JoinRequestsList] Setze loading auf false');\n          setLoading(false);\n        }\n      }\n    };\n\n    fetchJoinRequests();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [permissionsLoading]); // canViewJoinRequests ist eine Funktion, nicht als Dependency\n\n  const handleOpenProcessModal = (request: OrganizationJoinRequest) => {\n    if (!canManageJoinRequests()) {\n      const errorMessage = t('joinRequestsList.noPermissionEdit');\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n      return;\n    }\n    setSelectedRequest(request);\n    setIsProcessModalOpen(true);\n  };\n\n  const handleProcessSuccess = async () => {\n    // Neulade die Liste nach erfolgreicher Bearbeitung\n    // Reset das Flag, damit neu geladen werden kann\n    hasInitialLoadRef.current = false;\n    \n    try {\n      setLoading(true);\n      const requests = await organizationService.getJoinRequests();\n      setJoinRequests(requests);\n      setError(null);\n      hasInitialLoadRef.current = true;\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || 'Fehler beim Laden der Beitrittsanfragen';\n      setError(errorMessage);\n      hasInitialLoadRef.current = true;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Filter-Funktionen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n\n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n  \n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  useEffect(() => {\n    const initialize = async () => {\n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(JOIN_REQUESTS_TABLE_ID);\n      \n      // 2. Default-Filter anwenden (IMMER vorhanden!)\n      const defaultFilter = filters.find(f => f.name === 'Alle');\n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        return; // Filter wird angewendet\n      }\n      \n      // 3. Fallback: Kein Filter (sollte nie passieren)\n      // fetchJoinRequests wird bereits durch useEffect aufgerufen\n    };\n    \n    initialize();\n  }, [loadFilters, handleFilterChange]);\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  //  PERFORMANCE: Filter werden von SavedFilterTags geladen (FilterContext)\n  //  PERFORMANCE: Standard-Filter wird im Seed erstellt (nicht mehr im Frontend)\n  // Keine redundanten API-Calls mehr ntig\n\n  // Gefilterte Join-Requests\n  const filteredJoinRequests = useMemo(() => {\n    let filtered = [...joinRequests];\n\n    // Suchfeld-Filter\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(request => {\n        const requesterName = `${request.requester.firstName} ${request.requester.lastName}`.toLowerCase();\n        const requesterEmail = request.requester.email?.toLowerCase() || '';\n        const message = request.message?.toLowerCase() || '';\n        return requesterName.includes(searchLower) || requesterEmail.includes(searchLower) || message.includes(searchLower);\n      });\n    }\n\n    // Filter-Bedingungen aus FilterPane\n    if (filterConditions.length > 0) {\n      filtered = filterConditions.reduce((acc, condition, index) => {\n        if (!condition.column || condition.value === null || condition.value === '') {\n          return acc;\n        }\n\n        const operator = condition.operator;\n        const value = condition.value;\n\n        return acc.filter(request => {\n          switch (condition.column) {\n            case 'requester':\n              const requesterName = `${request.requester.firstName} ${request.requester.lastName}`.toLowerCase();\n              const requesterEmail = request.requester.email?.toLowerCase() || '';\n              const searchValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return requesterName.includes(searchValue) || requesterEmail.includes(searchValue);\n              } else if (operator === 'equals') {\n                return requesterName === searchValue || requesterEmail === searchValue;\n              } else if (operator === 'startsWith') {\n                return requesterName.startsWith(searchValue) || requesterEmail.startsWith(searchValue);\n    }\n              return false;\n\n            case 'message':\n              const message = request.message?.toLowerCase() || '';\n              const msgValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return message.includes(msgValue);\n              } else if (operator === 'equals') {\n                return message === msgValue;\n              } else if (operator === 'startsWith') {\n                return message.startsWith(msgValue);\n              }\n              return false;\n\n            case 'status':\n              if (operator === 'equals') {\n                return request.status === value;\n              }\n              return false;\n\n            default:\n              return true;\n          }\n        });\n      }, filtered);\n    }\n\n    return filtered;\n  }, [joinRequests, searchTerm, filterConditions, filterLogicalOperators]);\n\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('joinRequestsList.loadingPermissions')}</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canViewJoinRequests()) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n      <div className=\"p-4 text-red-600 dark:text-red-400\">\n        {t('joinRequestsList.noPermission')}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 sm:p-6 mb-6\">\n      {/* Titelzeile mit Icon, Suchfeld, Filter-Button */}\n      <div className=\"flex items-center justify-between mb-4 sm:mb-4\">\n        <h2 className=\"text-xl sm:text-xl font-semibold flex items-center dark:text-white\">\n          <UserPlusIcon className=\"h-6 w-6 sm:h-6 sm:w-6 mr-2 sm:mr-2\" />\n          {t('joinRequestsList.title')}\n        </h2>\n        \n        <div className=\"flex items-center gap-1.5\">\n          {/* Suchfeld */}\n          <input\n            type=\"text\"\n            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n\n          {/* Filter-Button */}\n          <button\n            className={`p-2 rounded-md border ${getActiveFilterCount() > 0 ? 'border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n            onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n            title={t('common.filter')}\n          >\n            <FunnelIcon className=\"h-5 w-5\" />\n            {getActiveFilterCount() > 0 && (\n              <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                {getActiveFilterCount()}\n              </span>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Filter-Panel */}\n      {isFilterPanelOpen && (\n        <div className=\"mb-4\">\n          <FilterPane\n            columns={[\n              { id: 'requester', label: t('joinRequestsList.filter.requester') },\n              { id: 'message', label: t('joinRequestsList.filter.message') },\n              { id: 'status', label: t('joinRequestsList.status.title', { defaultValue: 'Status' }) }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={JOIN_REQUESTS_TABLE_ID}\n          />\n        </div>\n      )}\n\n      {/* Gespeicherte Filter als Tags anzeigen */}\n      <SavedFilterTags\n        tableId={JOIN_REQUESTS_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n        defaultFilterName=\"Alle\"\n      />\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded\">\n          {error}\n        </div>\n      )}\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('joinRequestsList.loading')}</span>\n        </div>\n      ) : filteredJoinRequests.length === 0 ? (\n        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n          {joinRequests.length === 0 \n            ? t('joinRequestsList.noRequests')\n            : t('joinRequestsList.noMatching')}\n        </div>\n      ) : (\n        /* Cards fr Join-Requests */\n        <div className=\"space-y-4\">\n          {filteredJoinRequests.map(request => (\n            <div\n              key={request.id}\n              className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\"\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                        {request.requester.firstName} {request.requester.lastName}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        {request.requester.email}\n              </p>\n                    </div>\n                    <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(request.status)}`}>\n                      {getStatusText(request.status, t)}\n                    </span>\n                  </div>\n\n                  {request.message && (\n                    <div className=\"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.filter.message')}:</span> {request.message}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.response && (\n                    <div className=\"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700\">\n                      <p className=\"text-sm text-blue-700 dark:text-blue-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.response')}:</span> {request.response}\n                      </p>\n                    </div>\n                  )}\n\n              {request.status === 'pending' && canManageJoinRequests() && (\n                    <div className=\"mt-4 flex items-center gap-2\">\n                  <button \n                        onClick={() => handleOpenProcessModal(request)}\n                        className=\"p-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                        title={t('joinRequestsList.edit')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Process Join Request Modal */}\n      <ProcessJoinRequestModal\n        isOpen={isProcessModalOpen}\n        onClose={() => {\n          setIsProcessModalOpen(false);\n          setSelectedRequest(null);\n        }}\n        joinRequest={selectedRequest}\n        onSuccess={handleProcessSuccess}\n      />\n    </div>\n  );\n};\n\nexport default JoinRequestsList; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { UserGroupIcon, UserIcon, ShieldCheckIcon, MapPinIcon, TruckIcon, CalendarIcon } from '@heroicons/react/24/outline';\nimport UserManagementTab from '../components/UserManagementTab.tsx';\nimport RoleManagementTab from '../components/RoleManagementTab.tsx';\nimport BranchManagementTab from '../components/BranchManagementTab.tsx';\nimport TourProvidersTab from '../components/tours/TourProvidersTab.tsx';\nimport ToursTab from '../components/tours/ToursTab.tsx';\nimport useMessage from '../hooks/useMessage.ts';\nimport OrganizationSettings from '../components/organization/OrganizationSettings.tsx';\nimport JoinRequestsList from '../components/organization/JoinRequestsList.tsx';\n\nconst Organisation: React.FC = () => {\n  const { t } = useTranslation();\n  // Gemeinsame States\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const { showMessage } = useMessage();\n\n  const { \n    isAdmin, \n    hasPermission, \n    canView,\n    canViewOrganization,\n    loading: permissionsLoading\n  } = usePermissions();\n\n  // Berechtigungen prfen\n  const canViewOrganisation = canView('organization_management', 'page');\n  //  FIX: Verwende korrekte Entity-Namen (synchron mit seed.ts)\n  const canViewUsers = canView('users', 'tab');\n  const canViewRoles = canView('roles', 'tab');\n  const canViewBranches = canView('branches', 'tab');\n  const canViewProviders = canView('tour_providers', 'tab');\n  const canViewOrg = canView('organization_settings', 'tab');\n\n  const [activeTabState, setActiveTabState] = useState<'users' | 'roles' | 'branches' | 'providers' | 'organization'>('users');\n  const [providersViewMode, setProvidersViewMode] = useState<'tours' | 'providers'>('tours');\n  const isInitialized = useRef(false);\n\n  // Tab beim ersten Laden basierend auf Berechtigungen setzen (nur wenn Berechtigungen geladen sind)\n  // Reihenfolge: users -> roles -> branches -> providers -> organization\n  useEffect(() => {\n    if (!permissionsLoading && !isInitialized.current) {\n      let defaultTab: 'users' | 'roles' | 'branches' | 'providers' | 'organization' = 'organization'; // Fallback\n      \n      if (canViewUsers) {\n        defaultTab = 'users';\n      } else if (canViewRoles) {\n        defaultTab = 'roles';\n      } else if (canViewBranches) {\n        defaultTab = 'branches';\n      } else if (canViewProviders) {\n        defaultTab = 'providers';\n      } else if (canViewOrg) {\n        defaultTab = 'organization';\n      }\n      \n      setActiveTabState(defaultTab);\n      isInitialized.current = true;\n    }\n  }, [permissionsLoading, canViewUsers, canViewRoles, canViewBranches, canViewProviders, canViewOrg]);\n\n  // Tab-Wechsel Handler - Fehler beim Wechsel zurcksetzen\n  const handleTabChange = (tab: 'users' | 'roles' | 'branches' | 'providers' | 'organization') => {\n    // Prfe Berechtigung fr den Tab\n    if (tab === 'users' && !canViewUsers) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'roles' && !canViewRoles) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'branches' && !canViewBranches) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'providers' && !canViewProviders) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'organization' && !canViewOrg) {\n      return; // Tab nicht aktivierbar\n    }\n    setActiveTabState(tab);\n    setError(null);\n  };\n\n  // Gemeinsame Fehlerbehandlung entfernt - ErrorContext wird jetzt verwendet\n\n  // Keine Berechtigung fr die Seite\n  if (!canViewOrganisation) {\n    return <div className=\"p-4 text-red-600 dark:text-red-400\">{t('organisation.noPermission')}</div>;\n  }\n\n  return (\n    <div className=\"min-h-screen dark:bg-gray-900\">\n      <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          {/* Header mit Icon */}\n          <div className=\"flex items-center mb-6\">\n            <UserGroupIcon className=\"h-6 w-6 mr-2 dark:text-white\" />\n            <h2 className=\"text-xl font-semibold dark:text-white\">{t('organisation.title')}</h2>\n          </div>\n\n          {/* Tabs fr Navigation */}\n          <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n            <nav className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden\">\n              {/*  FIX: Tabs komplett ausblenden wenn accessLevel === 'none' (keine PRO-Labels mehr) */}\n              {canViewUsers && (\n                <button\n                  className={`${\n                    activeTabState === 'users'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                  } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                  onClick={() => handleTabChange('users')}\n                >\n                  <UserIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                  {t('organisation.tabs.users')}\n                </button>\n              )}\n\n              {canViewRoles && (\n                <button\n                  className={`${\n                    activeTabState === 'roles'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                  } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                  onClick={() => handleTabChange('roles')}\n                >\n                  <ShieldCheckIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                  {t('organisation.tabs.roles')}\n                </button>\n              )}\n\n              {canViewBranches && (\n                <button\n                  className={`${\n                    activeTabState === 'branches'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                  } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                  onClick={() => handleTabChange('branches')}\n                >\n                  <MapPinIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                  {t('organisation.tabs.branches', { defaultValue: 'Niederlassungen' })}\n                </button>\n              )}\n\n              {canViewProviders && (\n                <button\n                  className={`${\n                    activeTabState === 'providers'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                  } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                  onClick={() => handleTabChange('providers')}\n                >\n                  <TruckIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                  {t('organisation.tabs.providers', { defaultValue: 'Proveedores' })}\n                </button>\n              )}\n\n              {canViewOrg && (\n                <button\n                  className={`${\n                    activeTabState === 'organization'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                  } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center flex-shrink-0`}\n                  onClick={() => handleTabChange('organization')}\n                >\n                  <UserGroupIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                  {t('organisation.tabs.organization')}\n                </button>\n              )}\n            </nav>\n          </div>\n\n          {error && (\n            <div className=\"bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded mb-4\">\n              <p className=\"font-bold\">{t('organisation.error')}</p>\n              <p>{error}</p>\n            </div>\n          )}\n\n          {loading && <div className=\"p-4 dark:text-gray-300\">{t('organisation.loading')}</div>}\n\n          {/* Tab Inhalte */}\n          <div className=\"mt-6\">\n            {/*  FIX: Tabs werden nur gerendert wenn sie sichtbar sind (keine PRO-Messages mehr) */}\n            {activeTabState === 'users' && canViewUsers && (\n              <UserManagementTab />\n            )}\n            {activeTabState === 'roles' && canViewRoles && (\n              <RoleManagementTab />\n            )}\n            {activeTabState === 'branches' && canViewBranches && (\n              <BranchManagementTab />\n            )}\n            {activeTabState === 'providers' && canViewProviders && (\n              <div className=\"space-y-4\">\n                {/* Switch fr Tours/Providers */}\n                <div className=\"flex gap-2 mb-4\">\n                  <button\n                    type=\"button\"\n                    onClick={() => setProvidersViewMode('tours')}\n                    className={`p-2 rounded-md transition-colors ${\n                      providersViewMode === 'tours'\n                        ? 'bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400'\n                        : 'text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700'\n                    }`}\n                    title={t('tours.title', 'Touren')}\n                  >\n                    <CalendarIcon className=\"h-5 w-5\" />\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => setProvidersViewMode('providers')}\n                    className={`p-2 rounded-md transition-colors ${\n                      providersViewMode === 'providers'\n                        ? 'bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400'\n                        : 'text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700'\n                    }`}\n                    title={t('organisation.tabs.providers', { defaultValue: 'Proveedores' })}\n                  >\n                    <TruckIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n                \n                {/* Bedingtes Rendering */}\n                {providersViewMode === 'tours' ? (\n                  <ToursTab />\n                ) : (\n                  <TourProvidersTab />\n                )}\n              </div>\n            )}\n            {activeTabState === 'organization' && canViewOrg && (\n              <div className=\"space-y-6\">\n                <OrganizationSettings />\n                <JoinRequestsList />\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Organisation;\n\n\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { EyeIcon, EyeSlashIcon, ArrowsUpDownIcon, ArrowUpIcon, ArrowDownIcon, XMarkIcon } from '@heroicons/react/24/outline';\n\ninterface Column {\n  id: string;\n  label: string;\n}\n\ninterface TableColumnConfigProps {\n  columns: Column[];\n  visibleColumns: string[];\n  columnOrder: string[];\n  onToggleColumnVisibility: (columnId: string) => void;\n  onMoveColumn?: (dragIndex: number, hoverIndex: number) => void; // Optional: Drag & Drop fr Spalten-Reihenfolge\n  onClose?: () => void; // Optional: Callback wenn Modal geschlossen wird\n  buttonTitle?: string; // Optional: Custom Button-Titel\n  modalTitle?: string; // Optional: Custom Modal-Titel\n  mainSortConfig?: { key: string; direction: 'asc' | 'desc' }; // Optional: Hauptsortierung (fr Table & Cards synchron)\n  onMainSortChange?: (key: string, direction: 'asc' | 'desc') => void; // Optional: Callback fr Hauptsortierung\n  showMainSort?: boolean; // Optional: Hauptsortierung anzeigen\n  isOpen?: boolean; // Optional: Externe Steuerung des Modal-Status (wenn nicht bergeben, wird interner State verwendet)\n  onOpenChange?: (open: boolean) => void; // Optional: Callback wenn Modal geffnet/geschlossen wird (fr externe Steuerung)\n}\n\ninterface DraggableItemProps {\n  id: string;\n  label: string;\n  index: number;\n  isVisible: boolean;\n  onToggleVisibility: (id: string) => void;\n  sortDirection?: 'asc' | 'desc'; // Optional: Sortierrichtung fr diese Spalte (wenn diese Spalte die Hauptsortierung ist)\n  onSortDirectionChange?: (id: string, direction: 'asc' | 'desc') => void; // Optional: Callback fr Hauptsortierung\n  showMainSort?: boolean; // Optional: Hauptsortierung anzeigen\n  isMainSort?: boolean; // Optional: Ist diese Spalte die Hauptsortierung?\n}\n\n// Komponente fr eine einzelne Spalte\nconst DraggableColumnItem: React.FC<DraggableItemProps> = ({ \n  id, \n  label, \n  index, \n  isVisible,\n  onToggleVisibility,\n  sortDirection,\n  onSortDirectionChange,\n  showMainSort = false,\n  isMainSort = false\n}) => {\n  const { t } = useTranslation();\n  \n  return (\n    <li \n      className=\"flex items-center justify-between px-2.5 py-2 rounded-md transition-colors duration-150 hover:bg-gray-50 dark:hover:bg-gray-700\"\n    >\n      <div className=\"flex items-center flex-1 min-w-0\">\n        <span className=\"text-sm dark:text-gray-300\">\n          {label}\n        </span>\n      </div>\n      <div className=\"flex items-center gap-2\">\n        {/* Hauptsortierung-Toggle: Nur anzeigen wenn onSortDirectionChange vorhanden ist */}\n        {onSortDirectionChange && (\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              // Wenn diese Spalte bereits die Hauptsortierung ist, toggle die Richtung\n              // Sonst setze diese Spalte als neue Hauptsortierung (Standard: 'asc')\n              const newDirection = isMainSort && sortDirection !== undefined \n                ? (sortDirection === 'asc' ? 'desc' : 'asc')\n                : 'asc';\n              onSortDirectionChange(id, newDirection);\n            }}\n            className={`inline-flex items-center justify-center p-1.5 rounded-md transition-colors duration-150 ${\n              isMainSort\n                ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-900/50'\n                : 'bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300'\n            }`}\n            title={\n              isMainSort && sortDirection !== undefined\n                ? `${t('tableColumn.mainSort')}: ${sortDirection === 'asc' ? t('tableColumn.ascending') : t('tableColumn.descending')} (${t('tableColumn.clickToToggle')})`\n                : `${t('tableColumn.setMainSort')} (${t('tableColumn.clickToSet')})`\n            }\n          >\n            {isMainSort && sortDirection === 'asc' ? (\n              <ArrowUpIcon className=\"h-4 w-4\" />\n            ) : isMainSort && sortDirection === 'desc' ? (\n              <ArrowDownIcon className=\"h-4 w-4\" />\n            ) : (\n              <ArrowsUpDownIcon className=\"h-4 w-4\" />\n            )}\n          </button>\n        )}\n        <button\n          onClick={() => onToggleVisibility(id)}\n          className=\"inline-flex items-center justify-center p-1.5 rounded-full bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150\"\n          title={isVisible ? t('tableColumn.hideColumn') : t('tableColumn.showColumn')}\n        >\n          {isVisible ? (\n            <EyeIcon className=\"w-4 h-4 dark:text-gray-300\" />\n          ) : (\n            <EyeSlashIcon className=\"w-4 h-4 text-gray-400 dark:text-gray-500\" />\n          )}\n        </button>\n      </div>\n    </li>\n  );\n};\n\nconst TableColumnConfig: React.FC<TableColumnConfigProps> = ({\n  columns,\n  visibleColumns,\n  columnOrder,\n  onToggleColumnVisibility,\n  onMoveColumn,\n  onClose,\n  buttonTitle,\n  modalTitle,\n  mainSortConfig,\n  onMainSortChange,\n  showMainSort = false,\n  isOpen: externalIsOpen,\n  onOpenChange\n}) => {\n  const { t } = useTranslation();\n  const defaultButtonTitle = buttonTitle || t('tableColumn.configure');\n  const defaultModalTitle = modalTitle || t('tableColumn.configure');\n  // Interner State nur verwenden, wenn keine externe Steuerung bergeben wurde\n  const [internalIsOpen, setInternalIsOpen] = useState(false);\n  const isOpen = externalIsOpen !== undefined ? externalIsOpen : internalIsOpen;\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  // Sortiere die Spalten gem der benutzerdefinierten Reihenfolge\n  const sortedColumns = [...columns].sort((a, b) => {\n    const indexA = columnOrder.indexOf(a.id);\n    const indexB = columnOrder.indexOf(b.id);\n    // Wenn eine Spalte nicht in columnOrder ist, platziere sie am Ende\n    if (indexA === -1) return 1;\n    if (indexB === -1) return -1;\n    return indexA - indexB;\n  });\n\n  // Handler zum Schlieen des Mens\n  const handleClose = useCallback(() => {\n    if (externalIsOpen !== undefined) {\n      // Externe Steuerung: onOpenChange aufrufen\n      onOpenChange?.(false);\n    } else {\n      // Interne Steuerung: internen State aktualisieren\n      setInternalIsOpen(false);\n    }\n    onClose?.();\n  }, [externalIsOpen, onOpenChange, onClose]);\n\n  // Handler zum ffnen des Mens\n  const handleOpen = useCallback(() => {\n    if (externalIsOpen !== undefined) {\n      // Externe Steuerung: onOpenChange aufrufen\n      onOpenChange?.(true);\n    } else {\n      // Interne Steuerung: internen State aktualisieren\n      setInternalIsOpen(true);\n    }\n  }, [externalIsOpen, onOpenChange]);\n\n  // Click outside handler\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n        handleClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [isOpen, handleClose]);\n\n  // Keyboard navigation: ESC zum Schlieen\n  useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 'Escape' && isOpen) {\n        handleClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleKeyDown);\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [isOpen, handleClose]);\n\n  return (\n    <div className=\"relative\" ref={menuRef}>\n      {/* Button nur anzeigen, wenn keine externe Steuerung vorhanden ist */}\n      {externalIsOpen === undefined && (\n        <button\n          className=\"inline-flex items-center justify-center p-2 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150\"\n          onClick={isOpen ? handleClose : handleOpen}\n          title={defaultButtonTitle}\n        >\n        {showMainSort ? (\n          <ArrowsUpDownIcon className=\"w-5 h-5\" />\n        ) : (\n          <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\" className=\"w-5 h-5\">\n            <path fillRule=\"evenodd\" d=\"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5A.75.75 0 012 10z\" clipRule=\"evenodd\" />\n          </svg>\n        )}\n        </button>\n      )}\n\n      {isOpen && (\n        <div \n          className=\"absolute right-0 mt-2 w-64 max-w-[calc(100vw-1rem)] bg-white dark:bg-gray-800 rounded-md shadow-lg z-50 border border-gray-300 dark:border-gray-600\"\n          role=\"dialog\"\n          aria-modal=\"true\"\n          aria-labelledby=\"table-column-config-title\"\n        >\n          <div className=\"px-3 py-2.5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between\">\n            <h3 id=\"table-column-config-title\" className=\"text-sm font-semibold text-gray-900 dark:text-white\">{defaultModalTitle}</h3>\n            <button\n              onClick={handleClose}\n              className=\"inline-flex items-center justify-center p-2 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150\"\n              title={t('common.close')}\n            >\n              <XMarkIcon className=\"w-5 h-5\" />\n            </button>\n          </div>\n          <ul className=\"px-2 py-1 max-h-64 overflow-y-auto\">\n            {sortedColumns.map((column, index) => {\n                const isVisible = visibleColumns.includes(column.id);\n                // Prfe ob diese Spalte die Hauptsortierung ist\n                const isMainSort = mainSortConfig?.key === column.id;\n                const sortDirection = isMainSort ? mainSortConfig.direction : undefined;\n                // Sort-Button fr alle Spalten anzeigen (unabhngig von Sichtbarkeit)\n                const showSortButton = showMainSort && onMainSortChange;\n                \n                return (\n                  <DraggableColumnItem\n                    key={column.id}\n                    id={column.id}\n                    label={column.label}\n                    index={index}\n                    isVisible={isVisible}\n                    onToggleVisibility={onToggleColumnVisibility}\n                    sortDirection={sortDirection}\n                    onSortDirectionChange={showSortButton ? onMainSortChange : undefined}\n                    showMainSort={showMainSort}\n                    isMainSort={isMainSort}\n                  />\n                );\n              })}\n          </ul>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default TableColumnConfig; "],"names":["_ref","children","columns","mobile","tablet","desktop","largeDesktop","gap","className","gapClass","sm","md","lg","_jsx","concat","getLocalStorageKey","tableId","tableSettingsApi","async","axiosInstance","get","data","error","console","localStorageKey","storedSettings","localStorage","getItem","JSON","parse","localError","columnOrder","hiddenColumns","post","settings","setItem","stringify","useTableSettings","options","setSettings","useState","defaultColumnOrder","defaultHiddenColumns","isLoading","setIsLoading","setError","useEffect","isMounted","loadedSettings","logger","log","length","viewMode","defaultViewMode","needsSave","sortConfig","defaultSortConfig","catch","err","Error","loadSettings","updateColumnOrder","useCallback","updatedSettings","_objectSpread","newColumnOrder","updateHiddenColumns","prevSettings","newHiddenColumns","toggleColumnVisibility","includes","columnId","filter","id","updateViewMode","newViewMode","updateSortConfig","newSortConfig","isColumnVisible","evaluateCondition","fieldValue","condition","operator","value","undefined","strField","strValue","fieldValueStr","String","lowerField","toLowerCase","valueStr","lowerValue","startsWith","typeof","endsWith","fieldDate","Date","valueDate","isNaN","getTime","fieldNum","parseFloat","valueNum","applyFilters","items","conditions","operators","getFieldValue","columnEvaluators","item","result","i","conditionMet","column","customResult","evaluateDateCondition","dateValue","date","dateYear","getUTCFullYear","dateMonth","getUTCMonth","dateDay","getUTCDate","normalizedDate","weekStart","startOfWeek","weekStartsOn","setHours","weekEnd","endOfWeek","monthStart","startOfMonth","monthEnd","endOfMonth","yearStart","startOfYear","yearEnd","endOfYear","conditionDate","localToday","conditionDateRaw","conditionYear","conditionMonth","conditionDay","evaluateUserRoleCondition","userId","roleId","textValue","targetUserId","parseInt","replace","matches","targetRoleId","textValueLower","valueLower","isOpen","onClose","onBookingCreated","tour","preselectedTour","t","useTranslation","user","useAuth","showMessage","useMessage","tourId","setTourId","tourDate","setTourDate","numberOfParticipants","setNumberOfParticipants","customerName","setCustomerName","customerEmail","setCustomerEmail","customerPhone","setCustomerPhone","customerNotes","setCustomerNotes","tours","setTours","selectedTour","setSelectedTour","loading","setLoading","loadingData","setLoadingData","_response$data","response","API_ENDPOINTS","TOURS","BASE","params","isActive","toursData","Array","isArray","loadData","find","Number","_jsxs","Dialog","open","Panel","Title","defaultValue","onClick","XMarkIcon","onSubmit","e","preventDefault","trim","numPart","minParticipants","min","max","maxParticipants","_response$data2","_response$data3","TOUR_BOOKINGS","_response$data4","success","message","_response","_response$data5","errorMessage","onChange","target","required","disabled","title","map","type","rows","CheckIcon","onCertificateCreated","userName","currentUser","isHR","isAdmin","permissionsLoading","usePermissions","openSidepane","closeSidepane","useSidepane","isMobile","setIsMobile","window","innerWidth","isLargeScreen","setIsLargeScreen","activeTab","setActiveTab","userData","setUserData","issueDate","setIssueDate","toISOString","split","certificateType","setCertificateType","pdfFile","setPdfFile","pdfPreviewUrl","setPdfPreviewUrl","uploading","setUploading","availableTemplates","setAvailableTemplates","selectedTemplate","setSelectedTemplate","useTemplate","setUseTemplate","fileInputRef","useRef","handleResize","addEventListener","removeEventListener","fetchUserData","fetchTemplates","documentTemplates","ORGANIZATION_LIFECYCLE","DOCUMENT_TEMPLATES","templates","employmentCertificate","push","version","path","userResponse","lifecycleResponse","Promise","all","USERS","BY_ID","LIFECYCLE","BY_USER","lifecycle","userDataObj","firstName","lastName","identificationNumber","contractStartDate","contractEndDate","contractType","salary","position","URL","revokeObjectURL","style","animation","DocumentTextIcon","_Fragment","UserIcon","CalendarIcon","toLocaleDateString","checked","template","ref","accept","event","_event$target$files","file","files","size","url","createObjectURL","name","toFixed","current","_fileInputRef$current","click","src","height","validationError","validateForm","issueDateObj","pdfPath","templateUsed","templateVersion","now","certificateData","CERTIFICATES","_err$response","_err$response$data","ArrowPathIcon","onContractCreated","setContractType","startDate","setStartDate","endDate","setEndDate","setSalary","workingHours","setWorkingHours","setPosition","employmentContract","toString","placeholder","CurrencyDollarIcon","step","startDateObj","endDateObj","contractData","CONTRACTS","onCertificateUpdated","certificate","existingPdfUrl","setExistingPdfUrl","CERTIFICATE_DOWNLOAD","handleSubmit","updateData","put","CERTIFICATE","onContractUpdated","contract","CONTRACT_DOWNLOAD","CONTRACT","lifecycleId","onUpdate","isLegal","registrations","setRegistrations","arl","eps","pension","caja","editingType","setEditingType","formData","setFormData","status","registrationNumber","provider","registrationDate","notes","saving","setSaving","loadingRef","abortControllerRef","loadRegistrations","abort","abortController","AbortController","registrationPromises","signal","aborted","registration","SOCIAL_SECURITY","timeout","_error$response","_error$message","code","warn","results","newRegistrations","forEach","_ref2","registrationType","number","registeredAt","completedAt","handleCancel","handleSave","resolve","setTimeout","_error$response2","_error$response2$data","getStatusIcon","CheckCircleIcon","ClockIcon","XCircleIcon","getStatusLabel","labelKey","getTypeLabel","isEditing","handleEdit","PencilIcon","onOffboardingStarted","exitDate","setExitDate","exitReason","setExitReason","validationErrors","setValidationErrors","today","errors","selectedDate","maxDate","setFullYear","getFullYear","Object","keys","STATUS","renderForm","ExclamationTriangleIcon","htmlFor","prev","ArrowRightIcon","opacity","transition","pointerEvents","role","onOffboardingCompleted","offboardingTasks","confirmText","setConfirmText","completedTasks","task","allTasksCompleted","requiredConfirmText","isCompleted","_lifecycleData$lifecy","lifecycleData","setLifecycleData","certificates","setCertificates","contracts","setContracts","setOffboardingTasks","isCertificateCreateModalOpen","setIsCertificateCreateModalOpen","isContractCreateModalOpen","setIsContractCreateModalOpen","editingCertificate","setEditingCertificate","editingContract","setEditingContract","downloadingCertId","setDownloadingCertId","downloadingContractId","setDownloadingContractId","isOffboardingStartModalOpen","setIsOffboardingStartModalOpen","isOffboardingCompleteModalOpen","setIsOffboardingCompleteModalOpen","isEditContractDatesModalOpen","setIsEditContractDatesModalOpen","editingContractStartDate","setEditingContractStartDate","editingContractEndDate","setEditingContractEndDate","fetchDataRef","isMountedRef","retryTimeoutRef","statusChangeTimeoutRef","fetchData","force","arguments","_certsResponse$data","_contractsResponse$da","_lifecycleResponse$da","_lifecycleResponse$da2","_lifecycleResponse$da3","_lifecycleResponse$da4","certsResponse","contractsResponse","tasksResponse","TASKS","allTasks","offboardingTaskTitles","filteredTasks","progress","percent","clearTimeout","handleEditContractDates","formatDate","dateString","year","month","day","socialSecurityRegistrations","BuildingOfficeIcon","clickable","config","onboarding","color","active","contract_change","offboarding","archived","getStatusBadge","onboardingStartedAt","onboardingCompletedAt","offboardingStartedAt","completed","total","width","totalTasks","Math","round","description","PlusIcon","cert","isLatest","generatedByUser","certId","responseType","blob","Blob","downloadUrl","link","document","createElement","href","download","body","appendChild","removeChild","handleDownloadCertificate","ArrowDownTrayIcon","toLocaleString","currency","contractId","handleDownloadContract","SocialSecurityEditor","CertificateCreationModal","ContractCreationModal","CertificateEditModal","ContractEditModal","OffboardingStartModal","OffboardingCompleteModal","CONTRACT_TYPES","UserManagementTab","handleError","handleErrorContext","useError","COUNTRIES","PAYROLL_COUNTRIES","LANGUAGES","users","setUsers","selectedUser","setSelectedUser","userFormData","setUserFormData","isEditingUser","setIsEditingUser","selectedRoles","setSelectedRoles","lifecycleRefreshKey","setLifecycleRefreshKey","isDebugMode","setIsDebugMode","roleWarning","setRoleWarning","roles","setRoles","loadingRoles","setLoadingRoles","branches","setBranches","loadingBranches","setLoadingBranches","selectedBranches","setSelectedBranches","activeUserTab","setActiveUserTab","userFilterTab","setUserFilterTab","isUploading","setIsUploading","documentListRef","isCreateModalOpen","setIsCreateModalOpen","newUserFormData","setNewUserFormData","email","password","allUsers","setAllUsers","fetchAllUsers","userApi","getAll","filterUsersByActiveStatus","sorted","sort","a","b","aUsername","username","bUsername","aFirstName","bFirstName","localeCompare","fetchUserDetails","getById","birthday","roleIds","userRole","r","branchIds","branch","userBranch","branchId","fallbackRoles","permissions","roleApi","fetchRoles","branchApi","fetchBranches","handleUserInputChange","finalValue","toggleRole","isRoleSelected","newSelectedRoles","updateRoles","toggleBranch","isBranchSelected","newSelectedBranches","updateBranches","handleNewUserInputChange","handleCreateUser","match","create","newUser","prevUsers","_err$response5","_err$response5$data","UserCircleIcon","ShieldCheckIcon","MapPinIcon","_userFormData$usernam","_userFormData$email","dataToSend","bankDetails","gender","phoneNumber","language","hourlyRate","monthlySalary","payrollCountry","update","updatedData","_err$response2","_err$response4","_err$response3","_err$response3$data","errorMsg","handleDirectDocumentUpload","_documentListRef$curr","loadDocuments","_COUNTRIES$find","latestDoc","identificationDocuments","readOnly","country","c","documentType","passport","national_id","driving_license","residence_permit","work_permit","tax_id","social_security","documentNumber","expiryDate","issuingCountry","issuingAuthority","handleCancelEdit","currentUserId","currentActiveStatus","newActiveStatus","selectedUserActive","updatePayload","updatedAllUsers","IdentificationDocumentList","some","ids","join","isFixedRole","xmlns","viewBox","fill","fillRule","d","clipRule","LifecycleView","PERMISSION_STRUCTURE","entity","label","boxes","buttons","tabs","getAllEntities","entities","page","_page$boxes","_page$tabs","box","_box$buttons","_box$tabs","button","tab","_tab$buttons","_tab$buttons2","translateLabel","findPermission","p","updatePermission","entityType","newAccessLevel","existingIndex","findIndex","newPermissions","accessLevel","AccessLevelDropdown","normalizedValue","convertLegacyAccessLevel","optionValues","getAccessLevelOptions","displayValue","level","getColorClass","ButtonEntry","perm","currentValue","newValue","TabEntry","_ref3","BoxEntry","_ref4","PageEntry","_ref5","isExpanded","onToggle","hasChildren","_ref6","expandedPages","setExpandedPages","React","Set","setAllTo","_page$boxes2","_page$tabs2","_box$buttons2","_box$tabs2","_tab$buttons3","expandAll","collapseAll","has","pageEntity","newExpanded","delete","add","togglePage","alwaysVisiblePages","defaultPages","defaultTables","defaultButtons","ROLES_TABLE_ID","STANDARD_ROLE_IDS","STANDARD_ROLE_NAMES","isStandardRole","roleName","RoleCard","onEdit","onDelete","onCopy","canEdit","canDelete","canCopy","DocumentDuplicateIcon","TrashIcon","allBranches","slice","permission","onRolesChange","onError","isModalOpen","setIsModalOpen","editingRole","setEditingRole","useMemo","table","hasPermission","searchTerm","setSearchTerm","isFilterModalOpen","setIsFilterModalOpen","setAllBranches","selectedBranchIds","setSelectedBranchIds","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","onErrorRef","errorContext","context","handleValidationError","fieldErrors","isAddPermissionModalOpen","setIsAddPermissionModalOpen","selectedPermission","setSelectedPermission","displayLimit","setDisplayLimit","component","action","filteredPermissions","category","ErrorCategory","PERMISSION","updateError","meta","cause","createError","resetForm","handleDelete","confirm","deleteError","refreshError","handleCopyRole","copiedRoleData","prevRoles","prepareRoleForEditing","allPermissions","savedPermissions","allEntities","initialized","saved","initializePermissions","_branchData$branches","branchData","getRoleBranches","getActiveFilterCount","filteredAndSortedRoles","searchLower","roleNameLower","nameConditionValueLower","roleDescLower","descConditionValueLower","count","existingFilters","SAVED_FILTERS","BY_TABLE","alleFilter","createStandardFilters","filterContext","useFilterContext","loadFilters","applyFilterConditions","resetFilterConditions","handleFilterChange","defaultFilter","f","initialize","FunnelIcon","FilterPane","onApply","onReset","savedConditions","savedOperators","SavedFilterTags","onSelectFilter","onFilterChange","defaultFilterName","prevLimit","ChevronDownIcon","PermissionEditor","roomDescriptions","setRoomDescriptions","editingCategoryId","setEditingCategoryId","editForm","setEditForm","text","imageUrl","videoUrl","rooms","setRooms","loadingRooms","setLoadingRooms","loadRoomDescriptions","BRANCHES","ROOM_DESCRIPTIONS","RESERVATION","limit","categoryMap","Map","reservation","categoryId","roomNumber","isDorm","roomType","roomName","set","roomsArray","from","entries","loadRooms","updatedDescriptions","alert","room","rel","BranchCard","BRANCHES_TABLE_ID","BranchManagementTab","editingBranch","setEditingBranch","address","city","whatsappSettings","apiKey","apiSecret","phoneNumberId","ai","enabled","model","systemPrompt","rules","sources","temperature","maxTokens","lobbyPmsSettings","apiUrl","propertyId","syncEnabled","autoCreateTasks","lateCheckInThreshold","notificationChannels","autoSendInvitation","boldPaymentSettings","merchantId","environment","doorSystemSettings","clientId","clientSecret","lockIds","appName","emailSettings","smtpHost","smtpPort","smtpUser","smtpPass","smtpFromEmail","smtpFromName","imap","host","port","secure","folder","processedFolder","messageTemplates","checkInInvitation","en","whatsappTemplateName","whatsappTemplateParams","emailSubject","emailContent","es","de","checkInConfirmation","autoSendReservationInvitation","activeSettingsTab","setActiveSettingsTab","showSecrets","setShowSecrets","selectedTemplateType","setSelectedTemplateType","selectedLanguage","setSelectedLanguage","canCreate","sireSettings","autoRegisterOnCheckIn","propertyCode","existingWhatsapp","existingLobbyPms","existingBoldPayment","existingDoorSystem","existingEmail","existingMessageTemplates","existingAutoSend","_hasEncryptedValues","handleCloseModal","UPDATE","CREATE","DELETE","filteredAndSortedBranches","branchNameLower","conditionValueLower","handleCreate","autoFocus","whatsappApiKey","stroke","strokeLinecap","strokeLinejoin","strokeWidth","whatsappApiSecret","s","RoomDescriptionsSection","emailSmtpPass","emailImapPass","_formData$messageTemp","_formData$messageTemp2","currentTemplate","_formData$messageTemp3","_formData$messageTemp4","_formData$messageTemp5","_formData$messageTemp6","onProviderCreated","setName","phone","setPhone","setEmail","contactPerson","setContactPerson","setNotes","setBranchId","_branchesRes$data","branchesRes","checkScreenSize","TOUR_PROVIDERS","handleClose","onProviderUpdated","ProviderCard","TourProvidersTab","isEditModalOpen","setIsEditModalOpen","editingProvider","setEditingProvider","providers","setProviders","fetchProviders","_error$response$data","filteredProviders","_provider$contactPers","_provider$phone","_provider$email","_provider$notes","search","providerId","CreateTourProviderModal","newProvider","EditTourProviderModal","updatedProvider","TourType","onTourCreated","setTitle","setDescription","setType","OWN","setIsActive","duration","setDuration","setMaxParticipants","setMinParticipants","price","setPrice","setCurrency","location","setLocation","meetingPoint","setMeetingPoint","setIncludes","excludes","setExcludes","requirements","setRequirements","totalCommission","setTotalCommission","totalCommissionPercent","setTotalCommissionPercent","sellerCommissionPercent","setSellerCommissionPercent","sellerCommissionFixed","setSellerCommissionFixed","externalProviderId","setExternalProviderId","externalBookingUrl","setExternalBookingUrl","imageFile","setImageFile","imagePreview","setImagePreview","galleryFiles","setGalleryFiles","galleryPreviews","setGalleryPreviews","uploadingImage","setUploadingImage","tourProviders","setTourProviders","_API_ENDPOINTS$TOUR_P","_providersRes$data","providersRes","maxPart","minPart","EXTERNAL","tourData","createdTour","FormData","append","UPLOAD_IMAGE","headers","imgErr","UPLOAD_GALLERY","galleryErr","updatedResponse","_e$target$files","reader","FileReader","onloadend","readAsDataURL","alt","multiple","preview","index","_","removeGalleryImage","_tour$isActive","_tour$galleryUrls","onTourUpdated","getTourImageUrl","galleryUrls","getTourGalleryImageUrl","_tour$isActive2","_tour$galleryUrls2","handleImageChange","handleGalleryChange","removeMainImage","DELETE_IMAGE","currentGallery","DELETE_GALLERY_IMAGE","_response2","_response2$data","newIndex","_response3","_response3$data","setTour","isCreateBookingModalOpen","setIsCreateBookingModalOpen","loadTour","UsersIcon","createdBy","createdAt","format","locale","externalProvider","availableFrom","availableTo","CreateTourBookingModal","tourCount","selectedFields","setSelectedFields","exporting","setExporting","setFormat","availableFields","selectAll","deselectAll","field","toggleField","fieldId","fieldsParam","EXPORT","fields","csvContent","row","cell","initialImageIndex","tourTitle","currentImageIndex","setCurrentImageIndex","zoomLevel","setZoomLevel","imageLoading","setImageLoading","imageError","setImageError","images","handlePrevious","handleNext","handleZoomIn","handleZoomOut","handleZoomReset","handleKeyDown","key","shiftKey","currentImage","canGoPrevious","canGoNext","canZoomIn","canZoomOut","MagnifyingGlassMinusIcon","MagnifyingGlassPlusIcon","ChevronLeftIcon","transform","cursor","onLoad","handleImageLoad","handleImageError","ChevronRightIcon","TOURS_TABLE_ID","defaultTourColumnOrder","tourCardToTableMapping","ToursTab","toursLoading","setToursLoading","toursError","setToursError","tourSearchTerm","setTourSearchTerm","tourFilterConditions","setTourFilterConditions","tourFilterLogicalOperators","setTourFilterLogicalOperators","tourActiveFilterName","setTourActiveFilterName","tourSelectedFilterId","setTourSelectedFilterId","tourFilterLogicalOperatorsRef","isCreateTourModalOpen","setIsCreateTourModalOpen","isEditTourModalOpen","setIsEditTourModalOpen","isTourDetailsModalOpen","setIsTourDetailsModalOpen","isTourExportDialogOpen","setIsTourExportDialogOpen","lightboxOpen","setLightboxOpen","selectedTourForLightbox","setSelectedTourForLightbox","setInitialImageIndex","selectedTourId","setSelectedTourId","draggedColumn","setDraggedColumn","dragOverColumn","setDragOverColumn","generatingImages","setGeneratingImages","imageGenerationJobs","setImageGenerationJobs","pollingIntervalsRef","pollCountRef","isLoadingSettings","tourTableSortConfig","direction","availableTourColumns","shortLabel","substring","tourFilterOnlyColumns","cardMetadataOrder","cardMetadata","tableCol","cardMeta","getTourCardMetadataFromColumnOrder","hiddenCardMetadata","hiddenTableColumns","getTourHiddenCardMetadata","visibleCardMetadata","loadTours","filterId","background","rawData","handleGenerateImages","GENERATE_IMAGES","mode","jobId","tourIdStr","setInterval","clearInterval","newJobs","GENERATE_IMAGES_STATUS","values","interval","applyTourFilterConditions","resetTourFilterConditions","handleTourFilterChange","initialLoadAttemptedRef","handleDragEnd","visibleColumnIds","validOrder","missingColumns","filteredAndSortedTours","filtered","cond","compareValue","abs","_tour$branch","branchName","createdByName","createdById","_tour$branch2","getTourSortValue","_tour$branch3","valueA","valueB","comparison","strA","strB","titleA","titleB","Squares2X2Icon","TableCellsIcon","TableColumnConfig","visibleColumns","onToggleColumnVisibility","tableColumn","onColumnOrderChange","newOrder","newTableOrder","Boolean","modalTitle","mainSortConfig","onMainSortChange","handleMainSortChange","showMainSort","col","scope","draggable","onDragStart","handleDragStart","onDragOver","handleDragOver","onDrop","handleDrop","dragIndex","indexOf","hoverIndex","draggedColumn_","splice","onDragEnd","newDirection","handleTourSort","ArrowsUpDownIcon","colSpan","_tour$branch4","stopPropagation","TOGGLE_ACTIVE","_err$response2$data","InformationCircleIcon","PhotoIcon","CardGrid","_response4","_response4$data","CreateTourModal","EditTourModal","TourDetailsModal","TourExportDialog","TourImageLightbox","onSuccess","displayName","domain","setErrors","fetchCurrentUser","handleChange","newErrors","organizationService","createOrganization","submit","organizationName","searching","setSearching","organizations","setOrganizations","showDropdown","setShowDropdown","selectedOrganization","setSelectedOrganization","searchTimeoutRef","dropdownRef","handleClickOutside","contains","handleOrganizationInputChange","searchOrganizations","handleSelectOrganization","org","handleMessageChange","createJoinRequest","RoleConfigurationTab","DocumentConfigurationTab","SMTPConfigurationTab","ApiConfigurationTab","organization","logo","nit","organizationWithSettings","setOrganizationWithSettings","selectedCountry","setSelectedCountry","setNit","organizationLanguage","setOrganizationLanguage","useLanguage","selectedOrgLanguage","setSelectedOrgLanguage","savingOrgLanguage","setSavingOrgLanguage","logoFile","setLogoFile","logoPreview","setLogoPreview","orgWithSettings","getCurrentOrganization","orgSettings","langResponse","getOrganizationLanguage","langError","loadOrgLanguage","loadSettingsIfNeeded","handleLogoFileChange","base64String","updateOrganization","newLanguage","Suspense","fallback","onSave","getStatusColor","getStatusText","MY_JOIN_REQUESTS_TABLE_ID","MyJoinRequestsList","joinRequests","setJoinRequests","isFilterPanelOpen","setIsFilterPanelOpen","mountedRef","withdrawingId","setWithdrawingId","timeoutId","ORGANIZATIONS","MY_JOIN_REQUESTS","requests","getMyJoinRequests","fetchMyJoinRequests","hour","minute","filteredJoinRequests","request","_request$message","orgName","reduce","acc","_request$message2","searchValue","msgValue","processor","processedAt","requestId","withdrawJoinRequest","req","_err$response4$data","handleWithdraw","ArrowUturnLeftIcon","OrganizationSettings","setOrganization","stats","setStats","loadingStats","setLoadingStats","isJoinModalOpen","setIsJoinModalOpen","canViewOrganization","canManageOrganization","refreshOrganization","useOrganization","fetchOrganization","includeSettings","statsData","getOrganizationStats","statsErr","hasOrganization","hasInitialLoadRef","UserPlusIcon","UserGroupIcon","subscriptionPlan","currentUsers","maxUsers","utilizationPercent","_count","EnvelopeIcon","invitations","ChartBarIcon","availableSlots","CreateOrganizationModal","handleCreateSuccess","JoinOrganizationModal","EditOrganizationModal","handleEditModalClose","handleEditSuccess","joinRequest","setAction","setRoleId","setResponse","organizationId","processJoinRequest","requester","JOIN_REQUESTS_TABLE_ID","JoinRequestsList","isProcessModalOpen","setIsProcessModalOpen","selectedRequest","setSelectedRequest","canViewJoinRequests","canManageJoinRequests","hasInitialLoad","joinRequestsCount","JOIN_REQUESTS","getJoinRequests","stack","fetchJoinRequests","_request$requester$em","requesterName","requesterEmail","_request$requester$em2","handleOpenProcessModal","ProcessJoinRequestModal","Organisation","canView","canViewOrganisation","canViewUsers","canViewRoles","canViewBranches","canViewProviders","canViewOrg","activeTabState","setActiveTabState","providersViewMode","setProvidersViewMode","isInitialized","defaultTab","handleTabChange","TruckIcon","RoleManagementTab","DraggableColumnItem","isVisible","onToggleVisibility","sortDirection","onSortDirectionChange","isMainSort","ArrowUpIcon","ArrowDownIcon","EyeIcon","EyeSlashIcon","onMoveColumn","buttonTitle","externalIsOpen","onOpenChange","defaultButtonTitle","defaultModalTitle","internalIsOpen","setInternalIsOpen","menuRef","sortedColumns","indexA","indexB","handleOpen","showSortButton"],"sourceRoot":""}