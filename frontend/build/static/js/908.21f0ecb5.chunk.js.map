{"version":3,"file":"static/js/908.21f0ecb5.chunk.js","mappings":"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","sources":["utils/filterLogic.ts","components/tours/CreateTourBookingModal.tsx","components/CertificateCreationModal.tsx","components/ContractCreationModal.tsx","components/CertificateEditModal.tsx","components/ContractEditModal.tsx","components/SocialSecurityEditor.tsx","components/OffboardingStartModal.tsx","components/OffboardingCompleteModal.tsx","components/LifecycleView.tsx","components/UserManagementTab.tsx","components/RoleManagementTab.tsx","components/branches/RoomDescriptionsSection.tsx","components/BranchManagementTab.tsx","components/tours/CreateTourProviderModal.tsx","components/tours/EditTourProviderModal.tsx","components/tours/TourProvidersTab.tsx","types/tour.ts","components/tours/CreateTourModal.tsx","components/tours/EditTourModal.tsx","components/tours/TourDetailsModal.tsx","components/tours/TourExportDialog.tsx","components/tours/TourImageLightbox.tsx","components/tours/ToursTab.tsx","components/organization/CreateOrganizationModal.tsx","components/organization/JoinOrganizationModal.tsx","components/organization/EditOrganizationModal.tsx","components/organization/MyJoinRequestsList.tsx","components/organization/OrganizationSettings.tsx","components/organization/ProcessJoinRequestModal.tsx","components/organization/JoinRequestsList.tsx","pages/Organisation.tsx"],"sourcesContent":["/**\r\n * Zentrale Filter-Logik zur Eliminierung von Code-Duplikation\r\n * \r\n * Diese Datei konsolidiert die Filter-Logik, die zuvor in mehreren Komponenten\r\n * dupliziert war (Requests.tsx, Worktracker.tsx, InvoiceManagementTab.tsx, etc.)\r\n * \r\n * WICHTIG: Die Logik ist exakt identisch mit der vorherigen Implementierung.\r\n * Nur die Code-Duplikation wurde entfernt, keine Funktionalittsnderung!\r\n */\r\n\r\nimport { startOfWeek, endOfWeek, startOfMonth, endOfMonth, startOfYear, endOfYear } from 'date-fns';\r\n\r\nexport interface FilterCondition {\r\n  column: string;\r\n  operator: string;\r\n  value: string | number | Date | null;\r\n}\r\n\r\n/**\r\n * Evaluates a single filter condition against a field value\r\n * @param fieldValue - The value to test against\r\n * @param condition - The filter condition to apply\r\n * @returns true if condition is met, false otherwise\r\n */\r\nexport const evaluateCondition = (\r\n  fieldValue: any,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  const { operator, value } = condition;\r\n  \r\n  // Sicherstellen, dass value definiert ist\r\n  if (value === undefined) {\r\n    console.error('evaluateCondition: value ist undefined', condition);\r\n    return false;\r\n  }\r\n  \r\n  // Handle null/undefined values\r\n  if (fieldValue == null && value == null) {\r\n    return operator === 'equals';\r\n  }\r\n  if (fieldValue == null || value == null) {\r\n    if (operator === 'notEquals') return true;\r\n    return false;\r\n  }\r\n\r\n  // String operations\r\n  // Sicherstellen, dass fieldValue und value Strings sind, bevor toLowerCase() aufgerufen wird\r\n  let strField: string = '';\r\n  let strValue: string = '';\r\n  \r\n  try {\r\n    // Konvertiere fieldValue zu String, auch wenn es ein Objekt ist\r\n    const fieldValueStr = fieldValue == null ? '' : (typeof fieldValue === 'string' ? fieldValue : String(fieldValue));\r\n    if (typeof fieldValueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerField = fieldValueStr.toLowerCase();\r\n    if (lowerField === undefined || lowerField === null || typeof lowerField !== 'string') {\r\n      return false;\r\n    }\r\n    strField = lowerField;\r\n    \r\n    // Konvertiere value zu String, auch wenn es ein Objekt ist\r\n    const valueStr = value == null ? '' : (typeof value === 'string' ? value : String(value));\r\n    if (typeof valueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerValue = valueStr.toLowerCase();\r\n    if (lowerValue === undefined || lowerValue === null || typeof lowerValue !== 'string') {\r\n      return false;\r\n    }\r\n    strValue = lowerValue;\r\n  } catch (error) {\r\n    // Falls toLowerCase() fehlschlgt, gebe false zurck\r\n    return false;\r\n  }\r\n\r\n  // Sicherstellen, dass strField und strValue Strings sind und nicht undefined\r\n  if (typeof strField !== 'string' || typeof strValue !== 'string' || strField === undefined || strValue === undefined || strField === null || strValue === null) {\r\n    return false;\r\n  }\r\n\r\n  switch (operator) {\r\n    case 'equals':\r\n      return strField === strValue;\r\n    case 'notEquals':\r\n      return strField !== strValue;\r\n    case 'contains':\r\n      return strField.includes(strValue);\r\n    case 'startsWith':\r\n      return strField.startsWith(strValue);\r\n    case 'endsWith':\r\n      // Explizite Prfung, dass strField und strValue Strings sind, bevor endsWith aufgerufen wird\r\n      if (strField === undefined || strField === null) {\r\n        console.error('endsWith: strField ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (strValue === undefined || strValue === null) {\r\n        console.error('endsWith: strValue ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strField !== 'string') {\r\n        console.error('endsWith: strField ist kein String', { strField, typeof: typeof strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strValue !== 'string') {\r\n        console.error('endsWith: strValue ist kein String', { strField, strValue, typeof: typeof strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      try {\r\n        return strField.endsWith(strValue);\r\n      } catch (error) {\r\n        console.error('endsWith: Fehler bei endsWith-Aufruf', error, { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n    case 'before':\r\n    case 'after': {\r\n      // Date operations\r\n      const fieldDate = new Date(fieldValue);\r\n      const valueDate = new Date(value as string);\r\n      if (isNaN(fieldDate.getTime()) || isNaN(valueDate.getTime())) {\r\n        return false;\r\n      }\r\n      return operator === 'before' \r\n        ? fieldDate < valueDate \r\n        : fieldDate > valueDate;\r\n    }\r\n    case 'greaterThan':\r\n    case 'lessThan': {\r\n      // Numeric operations\r\n      const fieldNum = parseFloat(String(fieldValue));\r\n      const valueNum = parseFloat(String(value));\r\n      if (isNaN(fieldNum) || isNaN(valueNum)) {\r\n        return false;\r\n      }\r\n      return operator === 'greaterThan'\r\n        ? fieldNum > valueNum\r\n        : fieldNum < valueNum;\r\n    }\r\n    default:\r\n      return true;\r\n  }\r\n};\r\n\r\n/**\r\n * Type for getting field values from items\r\n */\r\nexport type GetFieldValue<T> = (item: T, columnId: string) => any;\r\n\r\n/**\r\n * Type for column-specific evaluation handlers\r\n * Returns true if condition is met, false otherwise\r\n */\r\nexport type ColumnEvaluator<T> = (item: T, condition: FilterCondition) => boolean | null;\r\n\r\n/**\r\n * Applies filter conditions to an array of items\r\n * \r\n * @param items - Array of items to filter\r\n * @param conditions - Array of filter conditions\r\n * @param operators - Array of logical operators ('AND' | 'OR') between conditions\r\n * @param getFieldValue - Function to extract field values from items\r\n * @param columnEvaluators - Optional map of column-specific evaluators for custom logic\r\n * @returns Filtered array of items\r\n * \r\n * @example\r\n * // Standard usage with getFieldValue\r\n * const filtered = applyFilters(items, conditions, operators, (item, col) => item[col]);\r\n * \r\n * // With custom column evaluators\r\n * const filtered = applyFilters(\r\n *   items,\r\n *   conditions,\r\n *   operators,\r\n *   (item, col) => item[col],\r\n *   {\r\n *     'responsible': (item, condition) => {\r\n *       // Custom logic for responsible column\r\n *       return evaluateUserRoleCondition(item.responsible?.id, item.role?.id, condition);\r\n *     }\r\n *   }\r\n * );\r\n */\r\nexport const applyFilters = <T>(\r\n  items: T[],\r\n  conditions: FilterCondition[],\r\n  operators: ('AND' | 'OR')[],\r\n  getFieldValue: GetFieldValue<T>,\r\n  columnEvaluators?: Record<string, ColumnEvaluator<T>>\r\n): T[] => {\r\n  if (conditions.length === 0) {\r\n    return items;\r\n  }\r\n\r\n  return items.filter(item => {\r\n    let result = true;\r\n\r\n    for (let i = 0; i < conditions.length; i++) {\r\n      const condition = conditions[i];\r\n      let conditionMet = false;\r\n\r\n      // Check if there's a custom evaluator for this column\r\n      if (columnEvaluators && columnEvaluators[condition.column]) {\r\n        const customResult = columnEvaluators[condition.column](item, condition);\r\n        if (customResult !== null) {\r\n          conditionMet = customResult;\r\n        } else {\r\n          // Fallback to standard evaluation if custom evaluator returns null\r\n          const fieldValue = getFieldValue(item, condition.column);\r\n          conditionMet = evaluateCondition(fieldValue, condition);\r\n        }\r\n      } else {\r\n        // Standard evaluation\r\n        const fieldValue = getFieldValue(item, condition.column);\r\n        conditionMet = evaluateCondition(fieldValue, condition);\r\n      }\r\n\r\n      // Apply logical operators\r\n      if (i === 0) {\r\n        result = conditionMet;\r\n      } else {\r\n        const operator = operators[i - 1] || 'AND';\r\n        result = operator === 'AND' \r\n          ? (result && conditionMet) \r\n          : (result || conditionMet);\r\n      }\r\n    }\r\n\r\n    return result;\r\n  });\r\n};\r\n\r\n/**\r\n * Helper function to evaluate date conditions with proper date comparison\r\n * Supports __TODAY__ as a dynamic date value\r\n * \r\n * WICHTIG: Extrahiert nur den Datumsteil (Jahr, Monat, Tag) ohne Zeitzone,\r\n * um Zeitzone-Konvertierungsprobleme zu vermeiden (verhindert Tag-Versatz)\r\n */\r\nexport const evaluateDateCondition = (\r\n  dateValue: Date | string | null | undefined,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  if (!dateValue) {\r\n    return false;\r\n  }\r\n\r\n  const date = new Date(dateValue);\r\n  if (isNaN(date.getTime())) {\r\n    return false;\r\n  }\r\n\r\n  // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n  // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n  const dateYear = date.getUTCFullYear();\r\n  const dateMonth = date.getUTCMonth();\r\n  const dateDay = date.getUTCDate();\r\n  // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n  const normalizedDate = new Date(dateYear, dateMonth, dateDay);\r\n\r\n  //  PHASE 5: Handle Zeitraum-Platzhalter (__THIS_WEEK__, __THIS_MONTH__, __THIS_YEAR__)\r\n  // Diese funktionieren analog zu __TODAY__, aber fr Zeitrume\r\n  try {\r\n    if (condition.value === '__THIS_WEEK__') {\r\n      if (condition.operator === 'equals') {\r\n        const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekStart.setHours(0, 0, 0, 0);\r\n        const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= weekStart && normalizedDate <= weekEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Woche als einzelnes Datum\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < weekEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > weekStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_MONTH__') {\r\n      if (condition.operator === 'equals') {\r\n        const monthStart = startOfMonth(new Date());\r\n        monthStart.setHours(0, 0, 0, 0);\r\n        const monthEnd = endOfMonth(new Date());\r\n        monthEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= monthStart && normalizedDate <= monthEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Monat als einzelnes Datum\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < monthEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > monthStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_YEAR__') {\r\n      if (condition.operator === 'equals') {\r\n        const yearStart = startOfYear(new Date());\r\n        yearStart.setHours(0, 0, 0, 0);\r\n        const yearEnd = endOfYear(new Date());\r\n        yearEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= yearStart && normalizedDate <= yearEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Jahr als einzelnes Datum\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < yearEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > yearStart;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    // Handle __TODAY__, __WEEK_START__, __WEEK_END__, __MONTH_START__, __MONTH_END__, __YEAR_START__, __YEAR_END__ dynamic dates\r\n    let conditionDate: Date;\r\n    if (condition.value === '__TODAY__') {\r\n      // Get today's date in local timezone (set to midnight)\r\n      const localToday = new Date();\r\n      localToday.setHours(0, 0, 0, 0);\r\n      conditionDate = localToday;\r\n    } else if (condition.value === '__WEEK_START__') {\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      conditionDate = weekStart;\r\n    } else if (condition.value === '__WEEK_END__') {\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = weekEnd;\r\n    } else if (condition.value === '__MONTH_START__') {\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      conditionDate = monthStart;\r\n    } else if (condition.value === '__MONTH_END__') {\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = monthEnd;\r\n    } else if (condition.value === '__YEAR_START__') {\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      conditionDate = yearStart;\r\n    } else if (condition.value === '__YEAR_END__') {\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = yearEnd;\r\n    } else {\r\n      const conditionDateRaw = new Date(condition.value as string);\r\n      if (isNaN(conditionDateRaw.getTime())) {\r\n        return false;\r\n      }\r\n      // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n      // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n      const conditionYear = conditionDateRaw.getUTCFullYear();\r\n      const conditionMonth = conditionDateRaw.getUTCMonth();\r\n      const conditionDay = conditionDateRaw.getUTCDate();\r\n      // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n      conditionDate = new Date(conditionYear, conditionMonth, conditionDay);\r\n    }\r\n\r\n    switch (condition.operator) {\r\n      case 'equals':\r\n        return normalizedDate.getTime() === conditionDate.getTime();\r\n      case 'before':\r\n        return normalizedDate < conditionDate;\r\n      case 'after':\r\n        return normalizedDate > conditionDate;\r\n      default:\r\n        return true;\r\n    }\r\n  } catch (error) {\r\n    //  PHASE 5: Error Handling fr ungltige Platzhalter-Werte\r\n    console.error(`[evaluateDateCondition] Error with placeholder ${condition.value}:`, error);\r\n    return false; // Fallback: Filter schliet Datensatz aus\r\n  }\r\n};\r\n\r\n/**\r\n * Helper function to evaluate user/role conditions with user-{id} or role-{id} format\r\n * Supports both user-{id} and role-{id} formats, plus text fallback for legacy support\r\n */\r\nexport const evaluateUserRoleCondition = (\r\n  userId: number | null | undefined,\r\n  roleId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  textValue?: string  // Optional: text representation for fallback (e.g. \"John Doe\")\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = userId === targetUserId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = roleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  if (textValue !== undefined) {\r\n    const textValueLower = textValue.toLowerCase();\r\n    const valueLower = value.toLowerCase();\r\n    if (condition.operator === 'equals') {\r\n      return textValueLower === valueLower;\r\n    } else if (condition.operator === 'notEquals') {\r\n      return textValueLower !== valueLower;\r\n    } else if (condition.operator === 'contains') {\r\n      return textValueLower.includes(valueLower);\r\n    }\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n/**\r\n * Helper function for combined responsible/qualityControl filter (specific to Tasks)\r\n */\r\nexport const evaluateResponsibleAndQualityControl = (\r\n  responsibleId: number | null | undefined,\r\n  responsibleRoleId: number | null | undefined,\r\n  qualityControlId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  responsibleText?: string,\r\n  qualityControlText?: string\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format - matches either responsible OR qualityControl\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = (responsibleId === targetUserId) || (qualityControlId === targetUserId);\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format - only matches with responsible role\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = responsibleRoleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  const valueLower = value.toLowerCase();\r\n  if (condition.operator === 'equals') {\r\n    return (responsibleText?.toLowerCase() === valueLower) || (qualityControlText?.toLowerCase() === valueLower);\r\n  } else if (condition.operator === 'notEquals') {\r\n    return (responsibleText?.toLowerCase() !== valueLower) && (qualityControlText?.toLowerCase() !== valueLower);\r\n  } else if (condition.operator === 'contains') {\r\n    return (responsibleText?.toLowerCase()?.includes(valueLower) ?? false) || (qualityControlText?.toLowerCase()?.includes(valueLower) ?? false);\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourBooking, TourBookingStatus } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\n\ninterface CreateTourBookingModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onBookingCreated: (newBooking: TourBooking) => void;\n    tour?: Tour | null;\n}\n\nconst CreateTourBookingModal = ({ isOpen, onClose, onBookingCreated, tour: preselectedTour }: CreateTourBookingModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    \n    const [tourId, setTourId] = useState<number | ''>(preselectedTour?.id || '');\n    const [tourDate, setTourDate] = useState('');\n    const [numberOfParticipants, setNumberOfParticipants] = useState<number | ''>(1);\n    const [customerName, setCustomerName] = useState('');\n    const [customerEmail, setCustomerEmail] = useState('');\n    const [customerPhone, setCustomerPhone] = useState('');\n    const [customerNotes, setCustomerNotes] = useState('');\n    \n    const [tours, setTours] = useState<Tour[]>([]);\n    const [selectedTour, setSelectedTour] = useState<Tour | null>(preselectedTour || null);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Touren\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BASE, {\n                    params: { isActive: true }\n                });\n                const toursData = response.data?.data || response.data || [];\n                setTours(Array.isArray(toursData) ? toursData : []);\n            } catch (err: unknown) {\n                console.error('Error loading tours:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Setze preselectedTour wenn vorhanden\n    useEffect(() => {\n        if (preselectedTour) {\n            setTourId(preselectedTour.id);\n            setSelectedTour(preselectedTour);\n        }\n    }, [preselectedTour]);\n\n    // Update selectedTour when tourId changes\n    useEffect(() => {\n        if (tourId) {\n            const tour = tours.find(t => t.id === Number(tourId));\n            setSelectedTour(tour || null);\n        } else {\n            setSelectedTour(null);\n        }\n    }, [tourId, tours]);\n\n    // Reset form when modal opens/closes\n    useEffect(() => {\n        if (!isOpen) {\n            if (!preselectedTour) {\n                setTourId('');\n            }\n            setTourDate('');\n            setNumberOfParticipants(1);\n            setCustomerName('');\n            setCustomerEmail('');\n            setCustomerPhone('');\n            setCustomerNotes('');\n            setError(null);\n        }\n    }, [isOpen, preselectedTour]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierungen\n        if (!tourId) {\n            setError(t('tourBookings.validation.tourRequired', { defaultValue: 'Tour ist erforderlich' }));\n            return;\n        }\n\n        if (!tourDate) {\n            setError(t('tourBookings.validation.tourDateRequired', { defaultValue: 'Tour-Datum ist erforderlich' }));\n            return;\n        }\n\n        const tourDateObj = new Date(tourDate);\n        if (tourDateObj < new Date()) {\n            setError(t('tours.validation.tourDateFuture', { defaultValue: 'Tour-Datum muss in der Zukunft liegen' }));\n            return;\n        }\n\n        if (!numberOfParticipants || Number(numberOfParticipants) < 1) {\n            setError(t('tourBookings.validation.numberOfParticipantsMin', { defaultValue: 'Anzahl Teilnehmer muss >= 1 sein' }));\n            return;\n        }\n\n        if (!customerName.trim() || customerName.trim().length < 2) {\n            setError(t('tourBookings.validation.customerNameMinLength', { defaultValue: 'Kundenname muss mindestens 2 Zeichen lang sein' }));\n            return;\n        }\n\n        if (!customerPhone.trim() && !customerEmail.trim()) {\n            setError(t('tourBookings.validation.contactRequired', { defaultValue: 'Mindestens eine Kontaktinformation (Telefon oder E-Mail) ist erforderlich' }));\n            return;\n        }\n\n        // Validierung: Anzahl Teilnehmer zwischen min/max\n        if (selectedTour) {\n            const numPart = Number(numberOfParticipants);\n            if (selectedTour.minParticipants && numPart < selectedTour.minParticipants) {\n                setError(t('tours.validation.numberOfParticipantsRange', { \n                    defaultValue: 'Anzahl der Teilnehmer muss zwischen {min} und {max} sein',\n                    min: selectedTour.minParticipants,\n                    max: selectedTour.maxParticipants || ''\n                }));\n                return;\n            }\n            if (selectedTour.maxParticipants && numPart > selectedTour.maxParticipants) {\n                setError(t('tours.validation.numberOfParticipantsRange', { \n                    defaultValue: 'Anzahl der Teilnehmer muss zwischen {min} und {max} sein',\n                    min: selectedTour.minParticipants || 1,\n                    max: selectedTour.maxParticipants\n                }));\n                return;\n            }\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.post(API_ENDPOINTS.TOUR_BOOKINGS.BASE, {\n                tourId: Number(tourId),\n                tourDate,\n                numberOfParticipants: Number(numberOfParticipants),\n                customerName: customerName.trim(),\n                customerEmail: customerEmail.trim() || null,\n                customerPhone: customerPhone.trim() || null,\n                customerNotes: customerNotes.trim() || null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tourBookings.created', { defaultValue: 'Tour-Buchung erfolgreich erstellt' }),\n                    'success'\n                );\n                onBookingCreated(response.data.data);\n                onClose();\n            } else {\n                throw new Error(response.data?.message || t('tours.bookings.createError', { defaultValue: 'Fehler beim Erstellen der Buchung' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error creating booking:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                    <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                            {t('tourBookings.create', { defaultValue: 'Neue Tour-Buchung' })}\n                        </Dialog.Title>\n                        <button\n                            onClick={onClose}\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                        >\n                            <XMarkIcon className=\"h-6 w-6\" />\n                        </button>\n                    </div>\n\n                    <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.tour', { defaultValue: 'Tour' })} *\n                            </label>\n                            <select\n                                value={tourId}\n                                onChange={(e) => setTourId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData || !!preselectedTour}\n                            >\n                                <option value=\"\">{t('common.select', { defaultValue: 'Bitte whlen' })}</option>\n                                {tours.filter(t => t.isActive && t.title).map(tour => (\n                                    <option key={tour.id} value={tour.id}>\n                                        {tour.title || '-'}\n                                    </option>\n                                ))}\n                            </select>\n                            {selectedTour && (\n                                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                                    {selectedTour.minParticipants && selectedTour.maxParticipants\n                                        ? t('tourBookings.participantsRange', { \n                                            defaultValue: 'Teilnehmer: {min} - {max}',\n                                            min: selectedTour.minParticipants,\n                                            max: selectedTour.maxParticipants\n                                        })\n                                        : selectedTour.minParticipants\n                                        ? t('tourBookings.participantsMin', { \n                                            defaultValue: 'Min. Teilnehmer: {min}',\n                                            min: selectedTour.minParticipants\n                                        })\n                                        : selectedTour.maxParticipants\n                                        ? t('tourBookings.participantsMax', { \n                                            defaultValue: 'Max. Teilnehmer: {max}',\n                                            max: selectedTour.maxParticipants\n                                        })\n                                        : null}\n                                </p>\n                            )}\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.tourDate', { defaultValue: 'Tour-Datum' })} *\n                            </label>\n                            <input\n                                type=\"datetime-local\"\n                                value={tourDate}\n                                onChange={(e) => setTourDate(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.numberOfParticipants', { defaultValue: 'Anzahl Teilnehmer' })} *\n                            </label>\n                            <input\n                                type=\"number\"\n                                min={selectedTour?.minParticipants || 1}\n                                max={selectedTour?.maxParticipants || undefined}\n                                value={numberOfParticipants}\n                                onChange={(e) => setNumberOfParticipants(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerName', { defaultValue: 'Kundenname' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={customerName}\n                                onChange={(e) => setCustomerName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerPhone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={customerPhone}\n                                onChange={(e) => setCustomerPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerEmail', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={customerEmail}\n                                onChange={(e) => setCustomerEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerNotes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={customerNotes}\n                                onChange={(e) => setCustomerNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={onClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </Dialog.Panel>\n            </div>\n        </Dialog>\n    );\n};\n\nexport default CreateTourBookingModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, UserIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface CertificateCreationModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCertificateCreated: () => void;\n  userId: number;\n  userName: string;\n}\n\ninterface UserData {\n  firstName: string;\n  lastName: string;\n  identificationNumber: string | null;\n  contractStartDate: string | null;\n  contractEndDate: string | null;\n  contractType: string | null;\n  salary: number | null;\n  position: string | null;\n}\n\nconst CertificateCreationModal: React.FC<CertificateCreationModalProps> = ({\n  isOpen,\n  onClose,\n  onCertificateCreated,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { user: currentUser } = useAuth();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [activeTab, setActiveTab] = useState<'data' | 'text'>('data');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [userData, setUserData] = useState<UserData | null>(null);\n  const [issueDate, setIssueDate] = useState(new Date().toISOString().split('T')[0]);\n  const [certificateType, setCertificateType] = useState('employment');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [uploading, setUploading] = useState(false);\n  const [availableTemplates, setAvailableTemplates] = useState<Array<{type: string; version: string; path: string}>>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null);\n  const [useTemplate, setUseTemplate] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitszeugnisse erstellen', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      fetchUserData();\n      fetchTemplates();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const fetchTemplates = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      const templates: Array<{type: string; version: string; path: string}> = [];\n      \n      if (documentTemplates.employmentCertificate) {\n        templates.push({\n          type: 'employmentCertificate',\n          version: documentTemplates.employmentCertificate.version,\n          path: documentTemplates.employmentCertificate.path\n        });\n      }\n      \n      setAvailableTemplates(templates);\n      if (templates.length > 0) {\n        setSelectedTemplate(templates[0].type);\n        setUseTemplate(true);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Templates:', err);\n      // Kein Fehler anzeigen, Templates sind optional\n    }\n  };\n\n  const fetchUserData = async () => {\n    try {\n      const [userResponse, lifecycleResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.USERS.BY_ID(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId))\n      ]);\n\n      const user = userResponse.data;\n      const lifecycle = lifecycleResponse.data.lifecycle;\n\n      const userDataObj = {\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        identificationNumber: user.identificationNumber || null,\n        contractStartDate: lifecycle?.contractStartDate || null,\n        contractEndDate: lifecycle?.contractEndDate || null,\n        contractType: lifecycle?.contractType || null,\n        salary: user.salary || null,\n        position: null // TODO: Aus Rollen ableiten\n      };\n\n      setUserData(userDataObj);\n\n      // Automatische Vorausfllung: Ausstellungsdatum auf heute setzen (wenn noch nicht gesetzt)\n      if (!issueDate || issueDate === new Date().toISOString().split('T')[0]) {\n        setIssueDate(new Date().toISOString().split('T')[0]);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der User-Daten:', err);\n      setError('Fehler beim Laden der Daten');\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) { // 10MB\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      setUseTemplate(false); // Deaktiviere Template wenn PDF hochgeladen wird\n      // Erstelle Preview-URL\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n    }\n  };\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const validateForm = (): string | null => {\n    if (!useTemplate && !pdfFile) {\n      return 'Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch';\n    }\n    if (!issueDate) {\n      return 'Bitte geben Sie ein Ausstellungsdatum an';\n    }\n    const issueDateObj = new Date(issueDate);\n    if (isNaN(issueDateObj.getTime())) {\n      return 'Ungltiges Ausstellungsdatum';\n    }\n    if (issueDateObj > new Date()) {\n      return 'Ausstellungsdatum darf nicht in der Zukunft liegen';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Client-seitige Validierung\n    const validationError = validateForm();\n    if (validationError) {\n      setError(validationError);\n      showMessage(validationError, 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      let pdfPath: string | undefined = undefined;\n      let templateUsed: string | null = null;\n      let templateVersion: string | null = null;\n\n      // Wenn Template verwendet werden soll und kein PDF hochgeladen wurde\n      if (useTemplate && selectedTemplate && !pdfFile) {\n        const template = availableTemplates.find(t => t.type === selectedTemplate);\n        if (template) {\n          templateUsed = template.type;\n          templateVersion = template.version;\n          // PDF wird vom Backend generiert\n        }\n      } else if (pdfFile) {\n        // PDF wurde hochgeladen - verwende dieses\n        pdfPath = `temp-${Date.now()}-${pdfFile.name}`; // Temporr\n      } else {\n        showMessage('Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch', 'error');\n        setLoading(false);\n        return;\n      }\n\n      const certificateData = {\n        certificateType,\n        issueDate: new Date(issueDate),\n        pdfPath,\n        templateUsed,\n        templateVersion\n      };\n\n      await axiosInstance.post(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATES(userId),\n        certificateData\n      );\n\n      showMessage('Arbeitszeugnis erfolgreich erstellt', 'success');\n      onCertificateCreated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      setIssueDate(new Date().toISOString().split('T')[0]);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Erstellen des Arbeitszeugnisses:', err);\n      setError(err.response?.data?.message || 'Fehler beim Erstellen des Arbeitszeugnisses');\n      showMessage('Fehler beim Erstellen des Arbeitszeugnisses', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {/* Overlay - nur auf Mobile und Desktop (nicht Large Desktop) */}\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n          style={{\n            animation: isMobile ? 'none' : 'slideIn 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94)'\n          }}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitszeugnis erstellen\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Fr: <span className=\"font-medium dark:text-white\">{userName}</span>\n              </p>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n              <nav className=\"-mb-px flex space-x-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('data')}\n                  className={`${\n                    activeTab === 'data'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Daten\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('text')}\n                  className={`${\n                    activeTab === 'text'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  PDF hochladen\n                </button>\n              </nav>\n            </div>\n\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            {/* Tab Content */}\n            {activeTab === 'data' && (\n              <div className=\"space-y-4\">\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4\">\n                  <h3 className=\"text-sm font-semibold dark:text-white mb-3\">\n                    Automatisch erkannte Daten\n                  </h3>\n                  <div className=\"space-y-2 text-sm\">\n                    {userData && (\n                      <>\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4 text-gray-400\" />\n                          <span className=\"text-gray-600 dark:text-gray-400\">Name:</span>\n                          <span className=\"dark:text-white\">\n                            {userData.firstName} {userData.lastName}\n                          </span>\n                        </div>\n                        {userData.identificationNumber && (\n                          <div className=\"flex items-center space-x-2\">\n                            <DocumentTextIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Cdula:</span>\n                            <span className=\"dark:text-white\">{userData.identificationNumber}</span>\n                          </div>\n                        )}\n                        {userData.contractStartDate && (\n                          <div className=\"flex items-center space-x-2\">\n                            <CalendarIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Eintrittsdatum:</span>\n                            <span className=\"dark:text-white\">\n                              {new Date(userData.contractStartDate).toLocaleDateString('de-DE')}\n                            </span>\n                          </div>\n                        )}\n                        {userData.contractEndDate && (\n                          <div className=\"flex items-center space-x-2\">\n                            <CalendarIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Austrittsdatum:</span>\n                            <span className=\"dark:text-white\">\n                              {new Date(userData.contractEndDate).toLocaleDateString('de-DE')}\n                            </span>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Ausstellungsdatum <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={issueDate}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setIssueDate(value);\n                      // Validierung: Datum darf nicht in der Zukunft liegen\n                      if (value && new Date(value) > new Date()) {\n                        setError('Ausstellungsdatum darf nicht in der Zukunft liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    max={new Date().toISOString().split('T')[0]}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && issueDate && new Date(issueDate) > new Date()\n                        ? 'border-red-500 dark:border-red-500' \n                        : error && !issueDate\n                        ? 'border-red-500 dark:border-red-500'\n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    required\n                    aria-invalid={(!issueDate || (issueDate && new Date(issueDate) > new Date())) ? true : undefined}\n                    aria-describedby={(!issueDate || (issueDate && new Date(issueDate) > new Date())) ? \"issueDate-error\" : undefined}\n                  />\n                  {error && (!issueDate || (issueDate && new Date(issueDate) > new Date())) && (\n                    <p id=\"issueDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                  {!error && (\n                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                      Das Datum darf nicht in der Zukunft liegen\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Zertifikat-Typ <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={certificateType}\n                    onChange={(e) => setCertificateType(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    required\n                  >\n                    <option value=\"employment\">Arbeitszeugnis</option>\n                    <option value=\"salary\">Gehaltsbescheinigung</option>\n                    <option value=\"work_experience\">Arbeitsbescheinigung</option>\n                  </select>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'text' && (\n              <div className=\"space-y-4\">\n                {/* Template-Auswahl */}\n                {availableTemplates.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Template verwenden\n                    </label>\n                    <div className=\"flex items-center space-x-3 mb-4\">\n                      <input\n                        type=\"checkbox\"\n                        checked={useTemplate}\n                        onChange={(e) => {\n                          setUseTemplate(e.target.checked);\n                          if (e.target.checked && pdfFile) {\n                            // Wenn Template aktiviert wird, entferne PDF\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      />\n                      <label className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        Template fr automatische PDF-Generierung verwenden\n                      </label>\n                    </div>\n                    {useTemplate && (\n                      <select\n                        value={selectedTemplate || ''}\n                        onChange={(e) => setSelectedTemplate(e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4\"\n                      >\n                        {availableTemplates.map((template) => (\n                          <option key={template.type} value={template.type}>\n                            Arbeitszeugnis (Version {template.version})\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    {useTemplate ? 'ODER PDF-Datei hochladen' : 'PDF-Datei hochladen'} {!useTemplate && <span className=\"text-red-500\">*</span>}\n                  </label>\n                  <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\".pdf\"\n                      onChange={handleFileSelect}\n                      className=\"hidden\"\n                    />\n                    {!pdfFile ? (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => fileInputRef.current?.click()}\n                          className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                        >\n                          PDF-Datei auswhlen\n                        </button>\n                        <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                          oder Datei hierher ziehen\n                        </p>\n                        <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                          Max. 10MB\n                        </p>\n                      </div>\n                    ) : (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                        <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                          {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                        </p>\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                            if (fileInputRef.current) {\n                              fileInputRef.current.value = '';\n                            }\n                          }}\n                          className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                        >\n                          Datei entfernen\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* PDF-Vorschau */}\n                {pdfPreviewUrl && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl}#view=FitH`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || (!pdfFile && !useTemplate)}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird erstellt...' : 'Erstellen'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default CertificateCreationModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, UserIcon, CurrencyDollarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface ContractCreationModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onContractCreated: () => void;\n  userId: number;\n  userName: string;\n}\n\ninterface UserData {\n  firstName: string;\n  lastName: string;\n  identificationNumber: string | null;\n  contractStartDate: string | null;\n  contractEndDate: string | null;\n  contractType: string | null;\n  salary: number | null;\n  position: string | null;\n}\n\nconst ContractCreationModal: React.FC<ContractCreationModalProps> = ({\n  isOpen,\n  onClose,\n  onContractCreated,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { user: currentUser } = useAuth();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [activeTab, setActiveTab] = useState<'data' | 'text'>('data');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [userData, setUserData] = useState<UserData | null>(null);\n  const [contractType, setContractType] = useState('employment');\n  const [startDate, setStartDate] = useState(new Date().toISOString().split('T')[0]);\n  const [endDate, setEndDate] = useState<string>('');\n  const [salary, setSalary] = useState<string>('');\n  const [workingHours, setWorkingHours] = useState<string>('');\n  const [position, setPosition] = useState<string>('');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [availableTemplates, setAvailableTemplates] = useState<Array<{type: string; version: string; path: string}>>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null);\n  const [useTemplate, setUseTemplate] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitsvertrge erstellen', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      fetchUserData();\n      fetchTemplates();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const fetchTemplates = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      const templates: Array<{type: string; version: string; path: string}> = [];\n      \n      if (documentTemplates.employmentContract) {\n        templates.push({\n          type: 'employmentContract',\n          version: documentTemplates.employmentContract.version,\n          path: documentTemplates.employmentContract.path\n        });\n      }\n      \n      setAvailableTemplates(templates);\n      if (templates.length > 0) {\n        setSelectedTemplate(templates[0].type);\n        setUseTemplate(true);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Templates:', err);\n      // Kein Fehler anzeigen, Templates sind optional\n    }\n  };\n\n  const fetchUserData = async () => {\n    try {\n      const [userResponse, lifecycleResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.USERS.BY_ID(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId))\n      ]);\n\n      const user = userResponse.data;\n      const lifecycle = lifecycleResponse.data.lifecycle;\n\n      const data: UserData = {\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        identificationNumber: user.identificationNumber || null,\n        contractStartDate: lifecycle?.contractStartDate || null,\n        contractEndDate: lifecycle?.contractEndDate || null,\n        contractType: lifecycle?.contractType || null,\n        salary: user.salary || null,\n        position: null\n      };\n\n      setUserData(data);\n      \n      // Setze Standard-Werte\n      if (data.contractStartDate) {\n        setStartDate(new Date(data.contractStartDate).toISOString().split('T')[0]);\n      }\n      if (data.contractEndDate) {\n        setEndDate(new Date(data.contractEndDate).toISOString().split('T')[0]);\n      }\n      if (data.salary) {\n        setSalary(data.salary.toString());\n      }\n      if (data.contractType) {\n        setContractType(data.contractType);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der User-Daten:', err);\n      setError('Fehler beim Laden der Daten');\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) { // 10MB\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      setUseTemplate(false); // Deaktiviere Template wenn PDF hochgeladen wird\n      // Erstelle Preview-URL\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n    }\n  };\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const validateForm = (): string | null => {\n    if (!useTemplate && !pdfFile) {\n      return 'Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch';\n    }\n    if (!startDate) {\n      return 'Bitte geben Sie ein Startdatum an';\n    }\n    const startDateObj = new Date(startDate);\n    if (isNaN(startDateObj.getTime())) {\n      return 'Ungltiges Startdatum';\n    }\n    if (endDate) {\n      const endDateObj = new Date(endDate);\n      if (isNaN(endDateObj.getTime())) {\n        return 'Ungltiges Enddatum';\n      }\n      if (endDateObj < startDateObj) {\n        return 'Enddatum muss nach dem Startdatum liegen';\n      }\n    }\n    if (salary && parseFloat(salary) < 0) {\n      return 'Gehalt darf nicht negativ sein';\n    }\n    if (workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)) {\n      return 'Arbeitsstunden mssen zwischen 0 und 168 liegen';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Client-seitige Validierung\n    const validationError = validateForm();\n    if (validationError) {\n      setError(validationError);\n      showMessage(validationError, 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      let pdfPath: string | undefined = undefined;\n      let templateUsed: string | null = null;\n      let templateVersion: string | null = null;\n\n      // Wenn Template verwendet werden soll und kein PDF hochgeladen wurde\n      if (useTemplate && selectedTemplate && !pdfFile) {\n        const template = availableTemplates.find(t => t.type === selectedTemplate);\n        if (template) {\n          templateUsed = template.type;\n          templateVersion = template.version;\n          // PDF wird vom Backend generiert\n        }\n      } else if (pdfFile) {\n        // PDF wurde hochgeladen - verwende dieses\n        pdfPath = `temp-${Date.now()}-${pdfFile.name}`; // Temporr\n      } else {\n        showMessage('Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch', 'error');\n        setLoading(false);\n        return;\n      }\n\n      const contractData = {\n        contractType,\n        startDate: new Date(startDate),\n        endDate: endDate ? new Date(endDate) : null,\n        salary: salary ? parseFloat(salary) : null,\n        workingHours: workingHours ? parseFloat(workingHours) : null,\n        position: position || null,\n        pdfPath,\n        templateUsed,\n        templateVersion\n      };\n\n      await axiosInstance.post(\n        API_ENDPOINTS.LIFECYCLE.CONTRACTS(userId),\n        contractData\n      );\n\n      showMessage('Arbeitsvertrag erfolgreich erstellt', 'success');\n      onContractCreated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      setStartDate(new Date().toISOString().split('T')[0]);\n      setEndDate('');\n      setSalary('');\n      setWorkingHours('');\n      setPosition('');\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Erstellen des Arbeitsvertrags:', err);\n      setError(err.response?.data?.message || 'Fehler beim Erstellen des Arbeitsvertrags');\n      showMessage('Fehler beim Erstellen des Arbeitsvertrags', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {/* Overlay */}\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitsvertrag erstellen\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Fr: <span className=\"font-medium dark:text-white\">{userName}</span>\n              </p>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n              <nav className=\"-mb-px flex space-x-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('data')}\n                  className={`${\n                    activeTab === 'data'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Vertragsdaten\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('text')}\n                  className={`${\n                    activeTab === 'text'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  PDF hochladen\n                </button>\n              </nav>\n            </div>\n\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            {/* Tab Content */}\n            {activeTab === 'data' && (\n              <div className=\"space-y-4\">\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4\">\n                  <h3 className=\"text-sm font-semibold dark:text-white mb-3\">\n                    Automatisch erkannte Daten\n                  </h3>\n                  <div className=\"space-y-2 text-sm\">\n                    {userData && (\n                      <>\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4 text-gray-400\" />\n                          <span className=\"text-gray-600 dark:text-gray-400\">Name:</span>\n                          <span className=\"dark:text-white\">\n                            {userData.firstName} {userData.lastName}\n                          </span>\n                        </div>\n                        {userData.identificationNumber && (\n                          <div className=\"flex items-center space-x-2\">\n                            <DocumentTextIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Cdula:</span>\n                            <span className=\"dark:text-white\">{userData.identificationNumber}</span>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Vertragstyp <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={contractType}\n                    onChange={(e) => setContractType(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  >\n                    <option value=\"employment\">Arbeitsvertrag</option>\n                    <option value=\"amendment\">Vertragsnderung</option>\n                    <option value=\"extension\">Vertragsverlngerung</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Startdatum <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={startDate}\n                    onChange={(e) => {\n                      setStartDate(e.target.value);\n                      setError(null); // Clear error when user starts typing\n                    }}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && !startDate \n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    required\n                    aria-invalid={!startDate}\n                    aria-describedby={!startDate ? \"startDate-error\" : undefined}\n                  />\n                  {error && !startDate && (\n                    <p id=\"startDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Enddatum (optional)\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={endDate}\n                    onChange={(e) => {\n                      setEndDate(e.target.value);\n                      // Wenn Enddatum gesetzt wird, prfe ob es nach Startdatum liegt\n                      if (e.target.value && startDate && new Date(e.target.value) < new Date(startDate)) {\n                        setError('Enddatum muss nach dem Startdatum liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    min={startDate || undefined}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && endDate && startDate && new Date(endDate) < new Date(startDate)\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    aria-invalid={endDate && startDate && new Date(endDate) < new Date(startDate) ? true : undefined}\n                    aria-describedby={endDate && startDate && new Date(endDate) < new Date(startDate) ? \"endDate-error\" : undefined}\n                  />\n                  {error && endDate && startDate && new Date(endDate) < new Date(startDate) && (\n                    <p id=\"endDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Position\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={position}\n                    onChange={(e) => setPosition(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    placeholder=\"z.B. Frontend-Entwickler\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Gehalt (optional)\n                  </label>\n                  <div className=\"relative\">\n                    <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                    <input\n                      type=\"number\"\n                      value={salary}\n                      onChange={(e) => {\n                        const value = e.target.value;\n                        setSalary(value);\n                        // Validierung: Gehalt darf nicht negativ sein\n                        if (value && parseFloat(value) < 0) {\n                          setError('Gehalt darf nicht negativ sein');\n                        } else {\n                          setError(null); // Clear error when valid\n                        }\n                      }}\n                      className={`w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                        error && salary && parseFloat(salary) < 0\n                          ? 'border-red-500 dark:border-red-500' \n                          : 'border-gray-300 dark:border-gray-600'\n                      }`}\n                      placeholder=\"0.00\"\n                      step=\"0.01\"\n                      min=\"0\"\n                      aria-invalid={salary && parseFloat(salary) < 0 ? true : undefined}\n                      aria-describedby={salary && parseFloat(salary) < 0 ? \"salary-error\" : undefined}\n                    />\n                  </div>\n                  {error && salary && parseFloat(salary) < 0 && (\n                    <p id=\"salary-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Arbeitsstunden/Woche (optional)\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={workingHours}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setWorkingHours(value);\n                      // Validierung: Arbeitsstunden mssen zwischen 0 und 168 liegen\n                      if (value && (parseFloat(value) < 0 || parseFloat(value) > 168)) {\n                        setError('Arbeitsstunden mssen zwischen 0 und 168 liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    placeholder=\"40\"\n                    step=\"0.1\"\n                    min=\"0\"\n                    max=\"168\"\n                    aria-invalid={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? true : undefined}\n                    aria-describedby={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? \"workingHours-error\" : undefined}\n                  />\n                  {error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) && (\n                    <p id=\"workingHours-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                    Maximal 168 Stunden pro Woche (24h  7 Tage)\n                  </p>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'text' && (\n              <div className=\"space-y-4\">\n                {/* Template-Auswahl */}\n                {availableTemplates.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Template verwenden\n                    </label>\n                    <div className=\"flex items-center space-x-3 mb-4\">\n                      <input\n                        type=\"checkbox\"\n                        checked={useTemplate}\n                        onChange={(e) => {\n                          setUseTemplate(e.target.checked);\n                          if (e.target.checked && pdfFile) {\n                            // Wenn Template aktiviert wird, entferne PDF\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      />\n                      <label className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        Template fr automatische PDF-Generierung verwenden\n                      </label>\n                    </div>\n                    {useTemplate && (\n                      <select\n                        value={selectedTemplate || ''}\n                        onChange={(e) => setSelectedTemplate(e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4\"\n                      >\n                        {availableTemplates.map((template) => (\n                          <option key={template.type} value={template.type}>\n                            Arbeitsvertrag (Version {template.version})\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    {useTemplate ? 'ODER PDF-Datei hochladen' : 'PDF-Datei hochladen'} {!useTemplate && <span className=\"text-red-500\">*</span>}\n                  </label>\n                  <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\".pdf\"\n                      onChange={handleFileSelect}\n                      className=\"hidden\"\n                    />\n                    {!pdfFile ? (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => fileInputRef.current?.click()}\n                          className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                        >\n                          PDF-Datei auswhlen\n                        </button>\n                        <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                          oder Datei hierher ziehen\n                        </p>\n                        <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                          Max. 10MB\n                        </p>\n                      </div>\n                    ) : (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                        <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                          {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                        </p>\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                            if (fileInputRef.current) {\n                              fileInputRef.current.value = '';\n                            }\n                          }}\n                          className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                        >\n                          Datei entfernen\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* PDF-Vorschau */}\n                {pdfPreviewUrl && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl}#view=FitH`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || (!pdfFile && !useTemplate) || !startDate}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird erstellt...' : 'Erstellen'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default ContractCreationModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Certificate {\n  id: number;\n  certificateType: string;\n  issueDate: string;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n}\n\ninterface CertificateEditModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCertificateUpdated: () => void;\n  userId: number;\n  certificate: Certificate;\n}\n\nconst CertificateEditModal: React.FC<CertificateEditModalProps> = ({\n  isOpen,\n  onClose,\n  onCertificateUpdated,\n  userId,\n  certificate\n}) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [issueDate, setIssueDate] = useState(\n    certificate.issueDate ? new Date(certificate.issueDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]\n  );\n  const [certificateType, setCertificateType] = useState(certificate.certificateType || 'employment');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [existingPdfUrl, setExistingPdfUrl] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitszeugnisse bearbeiten', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Lade bestehende PDF-URL wenn vorhanden\n      if (certificate.id) {\n        setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certificate.id));\n      }\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane, certificate.id, userId]);\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) {\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      // Erstelle Preview-URL fr neue Datei\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n      setExistingPdfUrl(null); // Verstecke bestehende PDF wenn neue hochgeladen wird\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const updateData: any = {\n        issueDate: new Date(issueDate),\n        certificateType\n      };\n\n      // Nur pdfPath aktualisieren, wenn neue Datei hochgeladen wurde\n      if (pdfFile) {\n        updateData.pdfPath = `temp-${Date.now()}-${pdfFile.name}`;\n        updateData.templateVersion = certificate.templateVersion || '1.0';\n      }\n\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATE(userId, certificate.id),\n        updateData\n      );\n\n      showMessage('Arbeitszeugnis erfolgreich aktualisiert', 'success');\n      onCertificateUpdated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Aktualisieren des Arbeitszeugnisses:', err);\n      setError(err.response?.data?.message || 'Fehler beim Aktualisieren des Arbeitszeugnisses');\n      showMessage('Fehler beim Aktualisieren des Arbeitszeugnisses', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitszeugnis bearbeiten\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Ausstellungsdatum\n                </label>\n                <input\n                  type=\"date\"\n                  value={issueDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setIssueDate(value);\n                    // Validierung: Datum darf nicht in der Zukunft liegen\n                    if (value && new Date(value) > new Date()) {\n                      setError('Ausstellungsdatum darf nicht in der Zukunft liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  max={new Date().toISOString().split('T')[0]}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && issueDate && new Date(issueDate) > new Date()\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  aria-invalid={issueDate && new Date(issueDate) > new Date() ? true : undefined}\n                  aria-describedby={issueDate && new Date(issueDate) > new Date() ? \"issueDate-error\" : undefined}\n                />\n                {error && issueDate && new Date(issueDate) > new Date() && (\n                  <p id=\"issueDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n                {!error && (\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                    Das Datum darf nicht in der Zukunft liegen\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Zertifikat-Typ\n                </label>\n                <select\n                  value={certificateType}\n                  onChange={(e) => setCertificateType(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                >\n                  <option value=\"employment\">Arbeitszeugnis</option>\n                  <option value=\"salary\">Gehaltsbescheinigung</option>\n                  <option value=\"work_experience\">Arbeitsbescheinigung</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  PDF-Datei aktualisieren (optional)\n                </label>\n                <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  {!pdfFile ? (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                      <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                      >\n                        Neue PDF-Datei auswhlen\n                      </button>\n                      <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                        oder Datei hierher ziehen\n                      </p>\n                      <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                        Max. 10MB\n                      </p>\n                    </div>\n                  ) : (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                      <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                        {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          setPdfFile(null);\n                          if (pdfPreviewUrl) {\n                            URL.revokeObjectURL(pdfPreviewUrl);\n                            setPdfPreviewUrl(null);\n                          }\n                          setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certificate.id));\n                          if (fileInputRef.current) {\n                            fileInputRef.current.value = '';\n                          }\n                        }}\n                        className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                      >\n                        Datei entfernen\n                      </button>\n                    </div>\n                  )}\n                </div>\n\n                {/* PDF-Vorschau */}\n                {(pdfPreviewUrl || existingPdfUrl) && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl || existingPdfUrl}${pdfPreviewUrl ? '#view=FitH' : '?preview=true#view=FitH'}`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4\">\n                <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n                  <strong>Hinweis:</strong> Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt.\n                  Eine neue Version wird erstellt (isLatest = true).\n                </p>\n              </div>\n            </form>\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird aktualisiert...' : 'Aktualisieren'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default CertificateEditModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, CurrencyDollarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Contract {\n  id: number;\n  contractType: string;\n  startDate: string;\n  endDate: string | null;\n  salary: number | null;\n  workingHours: number | null;\n  position: string | null;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n}\n\ninterface ContractEditModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onContractUpdated: () => void;\n  userId: number;\n  contract: Contract;\n}\n\nconst ContractEditModal: React.FC<ContractEditModalProps> = ({\n  isOpen,\n  onClose,\n  onContractUpdated,\n  userId,\n  contract\n}) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [contractType, setContractType] = useState(contract.contractType || 'employment');\n  const [startDate, setStartDate] = useState(\n    contract.startDate ? new Date(contract.startDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]\n  );\n  const [endDate, setEndDate] = useState(\n    contract.endDate ? new Date(contract.endDate).toISOString().split('T')[0] : ''\n  );\n  const [salary, setSalary] = useState(contract.salary ? contract.salary.toString() : '');\n  const [workingHours, setWorkingHours] = useState(contract.workingHours ? contract.workingHours.toString() : '');\n  const [position, setPosition] = useState(contract.position || '');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [existingPdfUrl, setExistingPdfUrl] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitsvertrge bearbeiten', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Lade bestehende PDF-URL wenn vorhanden\n      if (contract.id) {\n        setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contract.id));\n      }\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane, contract.id, userId]);\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) {\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      // Erstelle Preview-URL fr neue Datei\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n      setExistingPdfUrl(null); // Verstecke bestehende PDF wenn neue hochgeladen wird\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!startDate) {\n      showMessage('Bitte geben Sie ein Startdatum an', 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const updateData: any = {\n        contractType,\n        startDate: new Date(startDate),\n        endDate: endDate ? new Date(endDate) : null,\n        salary: salary ? parseFloat(salary) : null,\n        workingHours: workingHours ? parseFloat(workingHours) : null,\n        position: position || null\n      };\n\n      // Nur pdfPath aktualisieren, wenn neue Datei hochgeladen wurde\n      if (pdfFile) {\n        updateData.pdfPath = `temp-${Date.now()}-${pdfFile.name}`;\n        updateData.templateVersion = contract.templateVersion || '1.0';\n      }\n\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.CONTRACT(userId, contract.id),\n        updateData\n      );\n\n      showMessage('Arbeitsvertrag erfolgreich aktualisiert', 'success');\n      onContractUpdated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Aktualisieren des Arbeitsvertrags:', err);\n      setError(err.response?.data?.message || 'Fehler beim Aktualisieren des Arbeitsvertrags');\n      showMessage('Fehler beim Aktualisieren des Arbeitsvertrags', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitsvertrag bearbeiten\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Vertragstyp <span className=\"text-red-500\">*</span>\n                </label>\n                <select\n                  value={contractType}\n                  onChange={(e) => setContractType(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                >\n                  <option value=\"employment\">Arbeitsvertrag</option>\n                  <option value=\"amendment\">Vertragsnderung</option>\n                  <option value=\"extension\">Vertragsverlngerung</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Startdatum <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"date\"\n                  value={startDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setStartDate(value);\n                    // Wenn Enddatum gesetzt ist, prfe ob es nach Startdatum liegt\n                    if (endDate && value && new Date(endDate) < new Date(value)) {\n                      setError('Enddatum muss nach dem Startdatum liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && !startDate \n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  required\n                  aria-invalid={!startDate ? true : undefined}\n                  aria-describedby={!startDate ? \"startDate-error\" : undefined}\n                />\n                {error && !startDate && (\n                  <p id=\"startDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Enddatum (optional)\n                </label>\n                <input\n                  type=\"date\"\n                  value={endDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setEndDate(value);\n                    // Wenn Enddatum gesetzt wird, prfe ob es nach Startdatum liegt\n                    if (value && startDate && new Date(value) < new Date(startDate)) {\n                      setError('Enddatum muss nach dem Startdatum liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  min={startDate || undefined}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && endDate && startDate && new Date(endDate) < new Date(startDate)\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  aria-invalid={endDate && startDate && new Date(endDate) < new Date(startDate) ? true : undefined}\n                  aria-describedby={endDate && startDate && new Date(endDate) < new Date(startDate) ? \"endDate-error\" : undefined}\n                />\n                {error && endDate && startDate && new Date(endDate) < new Date(startDate) && (\n                  <p id=\"endDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Position\n                </label>\n                <input\n                  type=\"text\"\n                  value={position}\n                  onChange={(e) => setPosition(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  placeholder=\"z.B. Frontend-Entwickler\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Gehalt (optional)\n                </label>\n                <div className=\"relative\">\n                  <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                  <input\n                    type=\"number\"\n                    value={salary}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setSalary(value);\n                      // Validierung: Gehalt darf nicht negativ sein\n                      if (value && parseFloat(value) < 0) {\n                        setError('Gehalt darf nicht negativ sein');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    className={`w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && salary && parseFloat(salary) < 0\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    placeholder=\"0.00\"\n                    step=\"0.01\"\n                    min=\"0\"\n                    aria-invalid={salary && parseFloat(salary) < 0 ? true : undefined}\n                    aria-describedby={salary && parseFloat(salary) < 0 ? \"salary-error\" : undefined}\n                  />\n                </div>\n                {error && salary && parseFloat(salary) < 0 && (\n                  <p id=\"salary-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Arbeitsstunden/Woche (optional)\n                </label>\n                <input\n                  type=\"number\"\n                  value={workingHours}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setWorkingHours(value);\n                    // Validierung: Arbeitsstunden mssen zwischen 0 und 168 liegen\n                    if (value && (parseFloat(value) < 0 || parseFloat(value) > 168)) {\n                      setError('Arbeitsstunden mssen zwischen 0 und 168 liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  placeholder=\"40\"\n                  step=\"0.1\"\n                  min=\"0\"\n                  max=\"168\"\n                  aria-invalid={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? true : undefined}\n                  aria-describedby={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? \"workingHours-error\" : undefined}\n                />\n                {error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) && (\n                  <p id=\"workingHours-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  Maximal 168 Stunden pro Woche (24h  7 Tage)\n                </p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  PDF-Datei aktualisieren (optional)\n                </label>\n                <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  {!pdfFile ? (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                      <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                      >\n                        Neue PDF-Datei auswhlen\n                      </button>\n                      <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                        oder Datei hierher ziehen\n                      </p>\n                      <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                        Max. 10MB\n                      </p>\n                    </div>\n                  ) : (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                      <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                        {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          setPdfFile(null);\n                          if (pdfPreviewUrl) {\n                            URL.revokeObjectURL(pdfPreviewUrl);\n                            setPdfPreviewUrl(null);\n                          }\n                          setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contract.id));\n                          if (fileInputRef.current) {\n                            fileInputRef.current.value = '';\n                          }\n                        }}\n                        className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                      >\n                        Datei entfernen\n                      </button>\n                    </div>\n                  )}\n                </div>\n\n                {/* PDF-Vorschau */}\n                {(pdfPreviewUrl || existingPdfUrl) && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl || existingPdfUrl}${pdfPreviewUrl ? '#view=FitH' : '?preview=true#view=FitH'}`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4\">\n                <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n                  <strong>Hinweis:</strong> Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt.\n                  Eine neue Version wird erstellt (isLatest = true).\n                </p>\n              </div>\n            </form>\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || !startDate}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird aktualisiert...' : 'Aktualisieren'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default ContractEditModal;\n\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n  CheckCircleIcon,\n  ClockIcon,\n  XCircleIcon,\n  PencilIcon,\n  EnvelopeIcon,\n  DocumentTextIcon,\n  XMarkIcon,\n  ArrowPathIcon\n} from '@heroicons/react/24/outline';\n// Social Security Editor Component\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface SocialSecurityRegistration {\n  id: number;\n  registrationType: string;\n  registrationNumber: string | null;\n  provider: string | null;\n  registrationDate: string | null;\n  status: string;\n  notes: string | null;\n  completedAt: string | null;\n}\n\ninterface SocialSecurityEditorProps {\n  userId: number;\n  lifecycleId: number;\n  onUpdate?: () => void;\n}\n\ntype SocialSecurityType = 'arl' | 'eps' | 'pension' | 'caja';\n\nconst SocialSecurityEditor: React.FC<SocialSecurityEditorProps> = ({\n  userId,\n  lifecycleId,\n  onUpdate\n}) => {\n  const { t } = useTranslation();\n  const { isLegal, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  \n  const [registrations, setRegistrations] = useState<Record<SocialSecurityType, SocialSecurityRegistration | null>>({\n    arl: null,\n    eps: null,\n    pension: null,\n    caja: null\n  });\n  const [loading, setLoading] = useState(true);\n  const [editingType, setEditingType] = useState<SocialSecurityType | null>(null);\n  const [formData, setFormData] = useState({\n    status: 'pending' as string,\n    registrationNumber: '',\n    provider: '',\n    registrationDate: '',\n    notes: ''\n  });\n  const [saving, setSaving] = useState(false);\n  const loadingRef = useRef(false);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  // loadRegistrations auerhalb von useEffect definieren, damit es von handleSave aufgerufen werden kann\n  const loadRegistrations = useCallback(async () => {\n    // Erstelle neuen AbortController\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n    const abortController = new AbortController();\n    abortControllerRef.current = abortController;\n\n    loadingRef.current = true;\n    setLoading(true);\n    try {\n      const types: SocialSecurityType[] = ['arl', 'eps', 'pension', 'caja'];\n      const registrationPromises = types.map(async (type) => {\n        // Prfe ob Request abgebrochen wurde\n        if (abortController.signal.aborted) {\n          return { type, registration: null };\n        }\n\n        try {\n          const response = await axiosInstance.get(\n            API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, type),\n            {\n              timeout: 5000, // 5 Sekunden Timeout\n              signal: abortController.signal\n            }\n          );\n          return { type, registration: response.data };\n        } catch (error: any) {\n          // Ignoriere Abort-Errors (AbortError oder CanceledError von Axios)\n          if (error.name === 'AbortError' || error.name === 'CanceledError' || abortController.signal.aborted) {\n            return { type, registration: null };\n          }\n          // Behandle 404 als \"nicht vorhanden\" (normal)\n          if (error.response?.status === 404) {\n            return { type, registration: null };\n          }\n          // Behandle Network Errors und Timeouts\n          if (error.code === 'ERR_NETWORK' || error.code === 'ECONNABORTED' || error.message?.includes('ERR_INSUFFICIENT_RESOURCES')) {\n            console.warn(`Network error loading ${type}, treating as not found`);\n            return { type, registration: null };\n          }\n          console.error(`Error loading ${type}:`, error);\n          return { type, registration: null };\n        }\n      });\n\n      const results = await Promise.all(registrationPromises);\n      \n      // Prfe erneut ob Request abgebrochen wurde\n      if (abortController.signal.aborted) {\n        return;\n      }\n\n      const newRegistrations: Record<SocialSecurityType, SocialSecurityRegistration | null> = {\n        arl: null,\n        eps: null,\n        pension: null,\n        caja: null\n      };\n\n      results.forEach(({ type, registration }) => {\n        if (registration) {\n          // Backend gibt zurck: { id, type, status, number, provider, registeredAt, notes, completedAt }\n          // Mappe auf Frontend-Format: { id, registrationType, registrationNumber, provider, registrationDate, status, notes, completedAt }\n          newRegistrations[type as SocialSecurityType] = {\n            id: registration.id || 0,\n            registrationType: type,\n            registrationNumber: registration.number || registration.registrationNumber || null,\n            provider: registration.provider || null,\n            registrationDate: registration.registeredAt || registration.registrationDate || null,\n            status: registration.status || 'pending',\n            notes: registration.notes || null,\n            completedAt: registration.completedAt || null\n          };\n        }\n      });\n\n      setRegistrations(newRegistrations);\n    } catch (error: any) {\n      // Ignoriere Abort-Errors (AbortError oder CanceledError von Axios)\n      if (error.name === 'AbortError' || error.name === 'CanceledError' || abortController.signal.aborted) {\n        return;\n      }\n      console.error('Error loading registrations:', error);\n      showMessage(t('socialSecurity.loadError'), 'error');\n    } finally {\n      // Setze loading immer auf false, auch bei Abbruch\n      setLoading(false);\n      loadingRef.current = false;\n    }\n  }, [userId, t, showMessage]);\n\n  useEffect(() => {\n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      return;\n    }\n    \n    // Prfe Berechtigung und lade nur einmal pro userId/lifecycleId\n    const hasPermission = isLegal() || isAdmin();\n    if (!hasPermission || !userId || !lifecycleId) {\n      setLoading(false);\n      return;\n    }\n\n    // Verhindere mehrfaches gleichzeitiges Laden\n    if (loadingRef.current) {\n      return;\n    }\n\n    loadRegistrations();\n\n    // Cleanup: Breche Request ab wenn Component unmountet oder Dependencies sich ndern\n    return () => {\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n      loadingRef.current = false;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userId, lifecycleId, permissionsLoading]); // permissionsLoading als Dependency hinzugefgt\n\n  const handleEdit = (type: SocialSecurityType) => {\n    const registration = registrations[type];\n    if (registration) {\n      setFormData({\n        status: registration.status,\n        registrationNumber: registration.registrationNumber || '',\n        provider: registration.provider || '',\n        registrationDate: registration.registrationDate \n          ? new Date(registration.registrationDate).toISOString().split('T')[0]\n          : '',\n        notes: registration.notes || ''\n      });\n    } else {\n      setFormData({\n        status: 'pending',\n        registrationNumber: '',\n        provider: '',\n        registrationDate: '',\n        notes: ''\n      });\n    }\n    setEditingType(type);\n  };\n\n  const handleCancel = () => {\n    setEditingType(null);\n    setFormData({\n      status: 'pending',\n      registrationNumber: '',\n      provider: '',\n      registrationDate: '',\n      notes: ''\n    });\n  };\n\n  const handleSave = async () => {\n    if (!editingType) return;\n    \n    // Prfe Berechtigung nochmal vor dem Speichern\n    if (permissionsLoading) {\n      showMessage(t('common.loading', { defaultValue: 'Berechtigungen werden geladen...' }), 'warning');\n      return;\n    }\n    \n    if (!isLegal() && !isAdmin()) {\n      showMessage(t('lifecycle.noPermission', { defaultValue: 'Keine Berechtigung - nur Legal oder Admin' }), 'error');\n      return;\n    }\n\n    setSaving(true);\n    try {\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, editingType),\n        {\n          status: formData.status,\n          number: formData.registrationNumber || undefined,\n          provider: formData.provider || undefined,\n          registrationDate: formData.registrationDate \n            ? new Date(formData.registrationDate).toISOString()\n            : undefined,\n          notes: formData.notes || undefined\n        }\n      );\n\n      showMessage('Sozialversicherung erfolgreich aktualisiert', 'success');\n      setEditingType(null);\n      \n      // Warte kurz, damit Backend die Daten aktualisiert hat\n      await new Promise(resolve => setTimeout(resolve, 200));\n      \n      // Lade Registrierungen neu nach Update\n      await loadRegistrations();\n      \n      // onUpdate nur aufrufen, wenn es eine Funktion ist (verhindert Re-Render-Loops)\n      if (onUpdate && typeof onUpdate === 'function') {\n        // Rufe onUpdate auf, um LifecycleView zu aktualisieren\n        onUpdate();\n      }\n    } catch (error: any) {\n      console.error('Error updating social security:', error);\n      showMessage(\n        error.response?.data?.message || t('socialSecurity.updateError'),\n        'error'\n      );\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'registered':\n        return <CheckCircleIcon className=\"h-5 w-5 text-green-500\" />;\n      case 'pending':\n        return <ClockIcon className=\"h-5 w-5 text-yellow-500\" />;\n      case 'failed':\n        return <XCircleIcon className=\"h-5 w-5 text-red-500\" />;\n      case 'not_required':\n        return <CheckCircleIcon className=\"h-5 w-5 text-gray-400\" />;\n      case 'deregistered':\n        return <XCircleIcon className=\"h-5 w-5 text-gray-400\" />;\n      default:\n        return <ClockIcon className=\"h-5 w-5 text-gray-400\" />;\n    }\n  };\n\n  const getStatusLabel = (status: string) => {\n    const labelKey = `lifecycle.socialSecurityStatus.${status}`;\n    return t(labelKey) || status;\n  };\n\n  const getTypeLabel = (type: SocialSecurityType) => {\n    const labels: Record<SocialSecurityType, string> = {\n      arl: 'ARL (Risiko-Arbeit)',\n      eps: 'EPS (Gesundheit)',\n      pension: 'Pension',\n      caja: 'Caja de Compensacin'\n    };\n    return labels[type];\n  };\n\n  // Warte bis Berechtigungen geladen sind\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isLegal() && !isAdmin()) {\n    return null;\n  }\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  const types: SocialSecurityType[] = ['arl', 'eps', 'pension', 'caja'];\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n          <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n          {t('lifecycle.socialSecurity', { defaultValue: 'Sozialversicherungen' })}\n        </h3>\n      </div>\n\n      <div className=\"space-y-4\">\n        {types.map((type) => {\n          const registration = registrations[type];\n          const isEditing = editingType === type;\n\n          return (\n            <div\n              key={type}\n              className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\"\n            >\n              {!isEditing ? (\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex items-start space-x-3 flex-1\">\n                    {getStatusIcon(registration?.status || 'pending')}\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center space-x-2 mb-2\">\n                        <h4 className=\"font-medium dark:text-white uppercase\">\n                          {getTypeLabel(type)}\n                        </h4>\n                        <span className=\"text-sm font-medium dark:text-white\">\n                          {getStatusLabel(registration?.status || 'pending')}\n                        </span>\n                      </div>\n                      {registration && (\n                        <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                          {registration.provider && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.provider')}:</span> {registration.provider}\n                            </div>\n                          )}\n                          {registration.registrationNumber && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.number')}:</span> {registration.registrationNumber}\n                            </div>\n                          )}\n                          {registration.registrationDate && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.registrationDate')}:</span>{' '}\n                              {new Date(registration.registrationDate).toLocaleDateString('de-DE')}\n                            </div>\n                          )}\n                          {registration.notes && (\n                            <div className=\"mt-2\">\n                              <span className=\"font-medium\">{t('socialSecurity.notes')}:</span>\n                              <p className=\"text-gray-500 dark:text-gray-400 mt-1\">\n                                {registration.notes}\n                              </p>\n                            </div>\n                          )}\n                          {registration.completedAt && (\n                            <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\n                              {t('socialSecurity.completedAt')}{' '}\n                              {new Date(registration.completedAt).toLocaleDateString('de-DE')}\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      {!registration && (\n                        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                          {t('socialSecurity.notRegistered')}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                  <button\n                    onClick={() => handleEdit(type)}\n                    className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition ml-4\"\n                    title={t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  >\n                    <PencilIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium dark:text-white uppercase mb-3\">\n                    {t('socialSecurity.editType', { type: getTypeLabel(type) })}\n                  </h4>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('socialSecurity.status')} <span className=\"text-red-500\">*</span>\n                    </label>\n                    <select\n                      value={formData.status}\n                      onChange={(e) => setFormData({ ...formData, status: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    >\n                      <option value=\"not_required\">Nicht erforderlich</option>\n                      <option value=\"pending\">Ausstehend</option>\n                      <option value=\"registered\">Registriert</option>\n                      <option value=\"failed\">Fehlgeschlagen</option>\n                      <option value=\"deregistered\">Abgemeldet</option>\n                    </select>\n                  </div>\n\n                  {formData.status === 'registered' && (\n                    <>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.registrationNumber')}\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={formData.registrationNumber}\n                          onChange={(e) => setFormData({ ...formData, registrationNumber: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                          placeholder=\"z.B. 123456789\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.provider')}\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={formData.provider}\n                          onChange={(e) => setFormData({ ...formData, provider: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                          placeholder=\"z.B. ARL Sura, EPS Sanitas\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.registrationDate')}\n                        </label>\n                        <input\n                          type=\"date\"\n                          value={formData.registrationDate}\n                          onChange={(e) => setFormData({ ...formData, registrationDate: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                        />\n                      </div>\n                    </>\n                  )}\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('socialSecurity.notes')}\n                    </label>\n                    <textarea\n                      value={formData.notes}\n                      onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      rows={3}\n                      placeholder={t('socialSecurity.additionalInfo')}\n                    />\n                  </div>\n\n                  <div className=\"flex items-center justify-end space-x-3\">\n                    <button\n                      onClick={handleCancel}\n                      disabled={saving}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={t('common.cancel')}\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      onClick={handleSave}\n                      disabled={saving}\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={saving ? t('common.saving') : t('common.save')}\n                    >\n                      {saving ? (\n                        <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                      ) : (\n                        <CheckCircleIcon className=\"h-5 w-5\" />\n                      )}\n                    </button>\n                  </div>\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default SocialSecurityEditor;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ExclamationTriangleIcon, CalendarIcon, ArrowPathIcon, ArrowRightIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface OffboardingStartModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onOffboardingStarted: () => void;\n  userId: number;\n  userName: string;\n}\n\nconst OffboardingStartModal: React.FC<OffboardingStartModalProps> = ({\n  isOpen,\n  onClose,\n  onOffboardingStarted,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [exitDate, setExitDate] = useState('');\n  const [exitReason, setExitReason] = useState('');\n  \n  // Validierung\n  const [validationErrors, setValidationErrors] = useState<{\n    exitDate?: string;\n    exitReason?: string;\n  }>({});\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Setze Standard-Datum auf heute\n      const today = new Date().toISOString().split('T')[0];\n      setExitDate(today);\n      setExitReason('');\n      setError(null);\n      setValidationErrors({});\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = (): boolean => {\n    const errors: { exitDate?: string; exitReason?: string } = {};\n\n    // Validierung: exitDate\n    if (!exitDate) {\n      errors.exitDate = t('lifecycle.offboarding.exitDateRequired', { defaultValue: 'Austrittsdatum ist erforderlich' });\n    } else {\n      const selectedDate = new Date(exitDate);\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      \n      // exitDate darf in der Vergangenheit liegen (rckwirkende Erfassung erlaubt)\n      // Aber nicht zu weit in der Zukunft (max. 1 Jahr)\n      const maxDate = new Date();\n      maxDate.setFullYear(maxDate.getFullYear() + 1);\n      \n      if (selectedDate > maxDate) {\n        errors.exitDate = t('lifecycle.offboarding.exitDateTooFar', { defaultValue: 'Austrittsdatum darf nicht mehr als 1 Jahr in der Zukunft liegen' });\n      }\n    }\n\n    // Validierung: exitReason\n    if (!exitReason || exitReason.trim().length === 0) {\n      errors.exitReason = t('lifecycle.offboarding.exitReasonRequired', { defaultValue: 'Austrittsgrund ist erforderlich' });\n    } else if (exitReason.trim().length < 10) {\n      errors.exitReason = t('lifecycle.offboarding.exitReasonTooShort', { defaultValue: 'Austrittsgrund muss mindestens 10 Zeichen lang sein' });\n    }\n\n    setValidationErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\n        status: 'offboarding',\n        exitDate: exitDate,\n        exitReason: exitReason.trim()\n      });\n\n      showMessage(\n        t('lifecycle.offboarding.started', { defaultValue: 'Offboarding erfolgreich gestartet' }),\n        'success'\n      );\n      \n      onOffboardingStarted();\n      onClose();\n    } catch (err: any) {\n      console.error('Fehler beim Starten des Offboarding:', err);\n      const errorMessage = err.response?.data?.message || \n        t('lifecycle.offboarding.startError', { defaultValue: 'Fehler beim Starten des Offboarding' });\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const renderForm = () => (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      {/* Warnung */}\n      <div className=\"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4\">\n        <div className=\"flex items-start\">\n          <ExclamationTriangleIcon className=\"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5 mr-3 flex-shrink-0\" />\n          <div className=\"text-sm text-orange-800 dark:text-orange-200\">\n            <p className=\"font-medium mb-1\">\n              {t('lifecycle.offboarding.warningTitle', { defaultValue: 'Wichtiger Hinweis' })}\n            </p>\n            <p>\n              {t('lifecycle.offboarding.warningText', { defaultValue: 'Durch das Starten des Offboarding-Prozesses werden automatisch Tasks erstellt. Dieser Vorgang kann nicht rckgngig gemacht werden.' })}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* User-Info */}\n      <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">\n          {t('lifecycle.offboarding.user', { defaultValue: 'Mitarbeiter' })}\n        </p>\n        <p className=\"font-medium dark:text-white\">{userName}</p>\n      </div>\n\n      {/* exitDate */}\n      <div>\n        <label htmlFor=\"exitDate\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {t('lifecycle.offboarding.exitDate', { defaultValue: 'Austrittsdatum' })} *\n        </label>\n        <div className=\"relative\">\n          <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n            <CalendarIcon className=\"h-5 w-5 text-gray-400\" />\n          </div>\n          <input\n            type=\"date\"\n            id=\"exitDate\"\n            value={exitDate}\n            onChange={(e) => {\n              setExitDate(e.target.value);\n              if (validationErrors.exitDate) {\n                setValidationErrors(prev => ({ ...prev, exitDate: undefined }));\n              }\n            }}\n            className={`block w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n              validationErrors.exitDate\n                ? 'border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500'\n                : 'border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500'\n            }`}\n            required\n          />\n        </div>\n        {validationErrors.exitDate && (\n          <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{validationErrors.exitDate}</p>\n        )}\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n          {t('lifecycle.offboarding.exitDateHint', { defaultValue: 'Das Datum, an dem der Mitarbeiter die Organisation verlsst' })}\n        </p>\n      </div>\n\n      {/* exitReason */}\n      <div>\n        <label htmlFor=\"exitReason\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {t('lifecycle.offboarding.exitReason', { defaultValue: 'Austrittsgrund' })} *\n        </label>\n        <textarea\n          id=\"exitReason\"\n          value={exitReason}\n          onChange={(e) => {\n            setExitReason(e.target.value);\n            if (validationErrors.exitReason) {\n              setValidationErrors(prev => ({ ...prev, exitReason: undefined }));\n            }\n          }}\n          rows={4}\n          className={`block w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n            validationErrors.exitReason\n              ? 'border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500'\n              : 'border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500'\n          }`}\n          placeholder={t('lifecycle.offboarding.exitReasonPlaceholder', { defaultValue: 'z.B. Kndigung, Vertragsende, etc.' })}\n          required\n        />\n        {validationErrors.exitReason && (\n          <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{validationErrors.exitReason}</p>\n        )}\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n          {t('lifecycle.offboarding.exitReasonHint', { defaultValue: 'Mindestens 10 Zeichen. Beschreiben Sie den Grund fr den Austritt.' })}\n        </p>\n      </div>\n\n      {/* Error-Message */}\n      {error && (\n        <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n          <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n        </div>\n      )}\n\n      {/* Buttons */}\n      <div className=\"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n        <button\n          type=\"button\"\n          onClick={onClose}\n          disabled={loading}\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\n          title={t('common.cancel', { defaultValue: 'Abbrechen' })}\n        >\n          <XMarkIcon className=\"h-5 w-5\" />\n        </button>\n        <button\n          type=\"submit\"\n          disabled={loading}\n          className=\"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n          title={loading ? t('common.saving', { defaultValue: 'Speichern...' }) : t('lifecycle.offboarding.startButton', { defaultValue: 'Offboarding starten' })}\n        >\n          {loading ? (\n            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n          ) : (\n            <ArrowRightIcon className=\"h-5 w-5\" />\n          )}\n        </button>\n      </div>\n    </form>\n  );\n\n  if (!isOpen) return null;\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('lifecycle.offboarding.startTitle', { defaultValue: 'Offboarding starten' })}\n              </Dialog.Title>\n              <button\n                onClick={onClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <div className=\"p-4\">\n              {renderForm()}\n            </div>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={onClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('lifecycle.offboarding.startTitle', { defaultValue: 'Offboarding starten' })}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {renderForm()}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default OffboardingStartModal;\n\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, ExclamationTriangleIcon, CheckCircleIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\r\nimport useMessage from '../hooks/useMessage.ts';\r\n\r\ninterface Task {\r\n  id: number;\r\n  title: string;\r\n  description: string | null;\r\n  status: string;\r\n  dueDate: string | null;\r\n  createdAt: string;\r\n}\r\n\r\ninterface OffboardingCompleteModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onOffboardingCompleted: () => void;\r\n  userId: number;\r\n  userName: string;\r\n  offboardingTasks: Task[];\r\n}\r\n\r\nconst OffboardingCompleteModal: React.FC<OffboardingCompleteModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onOffboardingCompleted,\r\n  userId,\r\n  userName,\r\n  offboardingTasks\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const { showMessage } = useMessage();\r\n  \r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [confirmText, setConfirmText] = useState('');\r\n  \r\n  // Prfe, ob alle Tasks abgeschlossen sind\r\n  const completedTasks = offboardingTasks.filter(task => task.status === 'done');\r\n  const allTasksCompleted = offboardingTasks.length > 0 && completedTasks.length === offboardingTasks.length;\r\n  const requiredConfirmText = userName.trim().toLowerCase();\r\n  \r\n  // Responsive Erkennung\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n  \r\n  // Sidepane-Status verwalten\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      // Reset form on open\r\n      setConfirmText('');\r\n      setError(null);\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane]);\r\n  \r\n  const validateForm = () => {\r\n    if (confirmText.trim().toLowerCase() !== requiredConfirmText) {\r\n      setError(t('lifecycle.offboarding.complete.confirmTextMismatch', { defaultValue: 'Besttigungstext stimmt nicht berein' }));\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  \r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\r\n        status: 'archived'\r\n      });\r\n      \r\n      showMessage(\r\n        t('lifecycle.offboarding.complete.success', { defaultValue: 'Offboarding erfolgreich abgeschlossen' }),\r\n        'success'\r\n      );\r\n      \r\n      onOffboardingCompleted();\r\n      onClose();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Abschlieen des Offboarding:', err);\r\n      const errorMessage = err.response?.data?.message || \r\n        t('lifecycle.offboarding.complete.error', { defaultValue: 'Fehler beim Abschlieen des Offboarding' });\r\n      setError(errorMessage);\r\n      showMessage(errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  const renderForm = () => (\r\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n      {/* User Info */}\r\n      <div className=\"bg-gray-50 dark:bg-gray-700 p-3 rounded-md flex items-center space-x-3\">\r\n        <CheckCircleIcon className=\"h-5 w-5 text-gray-500 dark:text-gray-400\" />\r\n        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n          {t('lifecycle.offboarding.complete.user', { defaultValue: 'Mitarbeiter' })}: {userName}\r\n        </span>\r\n      </div>\r\n      \r\n      {/* Tasks Status */}\r\n      {offboardingTasks.length > 0 && (\r\n        <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-md\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n            {t('lifecycle.offboarding.complete.tasksStatus', { defaultValue: 'Status der Offboarding-Aufgaben' })}\r\n          </h4>\r\n          <div className=\"space-y-2\">\r\n            {offboardingTasks.map((task) => {\r\n                  const isCompleted = task.status === 'done';\r\n              return (\r\n                <div\r\n                  key={task.id}\r\n                  className={`flex items-center space-x-2 text-sm ${\r\n                    isCompleted\r\n                      ? 'text-green-700 dark:text-green-300'\r\n                      : 'text-orange-700 dark:text-orange-300'\r\n                  }`}\r\n                >\r\n                  {isCompleted ? (\r\n                    <CheckCircleIcon className=\"h-4 w-4 flex-shrink-0\" />\r\n                  ) : (\r\n                    <ExclamationTriangleIcon className=\"h-4 w-4 flex-shrink-0\" />\r\n                  )}\r\n                  <span>{task.title}</span>\r\n                  <span className=\"ml-auto text-xs\">\r\n                    {isCompleted\r\n                      ? `(${t('common.done', { defaultValue: 'Abgeschlossen' })})`\r\n                      : `(${t('common.open', { defaultValue: 'Offen' })})`}\r\n                  </span>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Warning wenn nicht alle Tasks abgeschlossen */}\r\n      {!allTasksCompleted && offboardingTasks.length > 0 && (\r\n        <div className=\"bg-orange-50 dark:bg-orange-900/20 border-l-4 border-orange-400 p-4\">\r\n          <div className=\"flex\">\r\n            <div className=\"flex-shrink-0\">\r\n              <ExclamationTriangleIcon className=\"h-5 w-5 text-orange-400\" aria-hidden=\"true\" />\r\n            </div>\r\n            <div className=\"ml-3\">\r\n              <h3 className=\"text-sm font-medium text-orange-800 dark:text-orange-300\">\r\n                {t('lifecycle.offboarding.complete.warningTitle', { defaultValue: 'Nicht alle Aufgaben abgeschlossen' })}\r\n              </h3>\r\n              <div className=\"mt-2 text-sm text-orange-700 dark:text-orange-200\">\r\n                <p>\r\n                  {t('lifecycle.offboarding.complete.warningText', { \r\n                    defaultValue: 'Es sind noch nicht alle Offboarding-Aufgaben abgeschlossen. Sie knnen das Offboarding trotzdem abschlieen, aber es wird empfohlen, alle Aufgaben zuerst zu erledigen.'\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Info wenn alle Tasks abgeschlossen */}\r\n      {allTasksCompleted && (\r\n        <div className=\"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-400 p-4\">\r\n          <div className=\"flex\">\r\n            <div className=\"flex-shrink-0\">\r\n              <CheckCircleIcon className=\"h-5 w-5 text-green-400\" aria-hidden=\"true\" />\r\n            </div>\r\n            <div className=\"ml-3\">\r\n              <h3 className=\"text-sm font-medium text-green-800 dark:text-green-300\">\r\n                {t('lifecycle.offboarding.complete.allTasksCompleted', { defaultValue: 'Alle Aufgaben abgeschlossen' })}\r\n              </h3>\r\n              <div className=\"mt-2 text-sm text-green-700 dark:text-green-200\">\r\n                <p>\r\n                  {t('lifecycle.offboarding.complete.allTasksCompletedText', { \r\n                    defaultValue: 'Alle Offboarding-Aufgaben sind abgeschlossen. Sie knnen das Offboarding jetzt abschlieen.'\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Confirm Text Input */}\r\n      <div>\r\n        <label htmlFor=\"confirmText\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('lifecycle.offboarding.complete.confirmLabel', { userName }) || \r\n            `Besttigen Sie durch Eingabe des Namens: \"${userName}\"`} *\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"confirmText\"\r\n          value={confirmText}\r\n          onChange={(e) => {\r\n            setConfirmText(e.target.value);\r\n            setError(null);\r\n          }}\r\n          className={`w-full px-3 py-2 border ${\r\n            error && error.includes('Besttigung') ? 'border-red-500' : 'border-gray-300'\r\n          } dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500`}\r\n          placeholder={userName}\r\n          required\r\n        />\r\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n          {t('lifecycle.offboarding.complete.confirmHint', { \r\n            defaultValue: 'Geben Sie den vollstndigen Namen des Mitarbeiters ein, um das Offboarding abzuschlieen'\r\n          })}\r\n        </p>\r\n      </div>\r\n      \r\n      {/* Final Warning */}\r\n      <div className=\"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\r\n        <div className=\"flex\">\r\n          <div className=\"flex-shrink-0\">\r\n            <ExclamationTriangleIcon className=\"h-5 w-5 text-red-400\" aria-hidden=\"true\" />\r\n          </div>\r\n          <div className=\"ml-3\">\r\n            <h3 className=\"text-sm font-medium text-red-800 dark:text-red-300\">\r\n              {t('lifecycle.offboarding.complete.finalWarningTitle', { defaultValue: 'Wichtiger Hinweis' })}\r\n            </h3>\r\n            <div className=\"mt-2 text-sm text-red-700 dark:text-red-200\">\r\n              <p>\r\n                {t('lifecycle.offboarding.complete.finalWarningText', { \r\n                  defaultValue: 'Durch das Abschlieen des Offboarding wird der Mitarbeiter archiviert. Dieser Vorgang kann nicht rckgngig gemacht werden.'\r\n                })}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Submit Button */}\r\n      <div className=\"flex justify-end space-x-3\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={onClose}\r\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          disabled={loading}\r\n          title={t('common.cancel', { defaultValue: 'Abbrechen' })}\r\n        >\r\n          <XMarkIcon className=\"h-5 w-5\" />\r\n        </button>\r\n        <button\r\n          type=\"submit\"\r\n          className=\"p-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          disabled={loading || confirmText.trim().toLowerCase() !== requiredConfirmText}\r\n          title={loading ? t('common.saving', { defaultValue: 'Speichern...' }) : t('lifecycle.offboarding.complete.button', { defaultValue: 'Offboarding abschlieen' })}\r\n        >\r\n          {loading ? (\r\n            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n          ) : (\r\n            <CheckCircleIcon className=\"h-5 w-5\" />\r\n          )}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n  \r\n  if (!isOpen) return null;\r\n  \r\n  // Fr Mobile (unter 640px) - klassisches Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n            {/* Header */}\r\n            <div className=\"px-6 py-4 border-b dark:border-gray-700\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                  {t('lifecycle.offboarding.complete.title', { defaultValue: 'Offboarding abschlieen' })}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Form */}\r\n            <div className=\"p-6\">\r\n              {error && (\r\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\r\n                  {error}\r\n                </div>\r\n              )}\r\n              {renderForm()}\r\n            </div>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n  \r\n  // Fr Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div\r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\"\r\n          aria-hidden=\"true\"\r\n          onClick={onClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div\r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${\r\n          isOpen ? 'translate-x-0' : 'translate-x-full'\r\n        }`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('lifecycle.offboarding.complete.title', { defaultValue: 'Offboarding abschlieen' })}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n        \r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {error && (\r\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\r\n              {error}\r\n            </div>\r\n          )}\r\n          {renderForm()}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default OffboardingCompleteModal;\r\n\r\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { \n  CheckCircleIcon, \n  ClockIcon, \n  XCircleIcon,\n  DocumentTextIcon,\n  BuildingOfficeIcon,\n  PlusIcon,\n  PencilIcon,\n  ArrowDownTrayIcon,\n  CalendarIcon,\n  UserIcon,\n  ArrowRightIcon\n} from '@heroicons/react/24/outline';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport useMessage from '../hooks/useMessage.ts';\nimport CertificateCreationModal from './CertificateCreationModal.tsx';\nimport ContractCreationModal from './ContractCreationModal.tsx';\nimport CertificateEditModal from './CertificateEditModal.tsx';\nimport ContractEditModal from './ContractEditModal.tsx';\nimport SocialSecurityEditor from './SocialSecurityEditor.tsx';\nimport OffboardingStartModal from './OffboardingStartModal.tsx';\nimport OffboardingCompleteModal from './OffboardingCompleteModal.tsx';\n\ninterface LifecycleViewProps {\n  userId: number;\n  userName: string;\n}\n\ninterface LifecycleData {\n  lifecycle: {\n    id: number;\n    status: string;\n    onboardingStartedAt: string | null;\n    onboardingCompletedAt: string | null;\n    contractStartDate: string | null;\n    contractEndDate: string | null;\n    exitDate: string | null;\n    exitReason: string | null;\n    offboardingStartedAt: string | null;\n    offboardingCompletedAt: string | null;\n  };\n  progress: {\n    completed: number;\n    total: number;\n    percent: number;\n  };\n  socialSecurityRegistrations?: Array<{\n    id: number;\n    registrationType: string;\n    status: string;\n    registrationNumber: string | null;\n    provider: string | null;\n    registrationDate: string | null;\n  }>;\n}\n\ninterface Task {\n  id: number;\n  title: string;\n  description: string | null;\n  status: string;\n  dueDate: string | null;\n  createdAt: string;\n}\n\ninterface Certificate {\n  id: number;\n  certificateType: string;\n  issueDate: string;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n  generatedBy: number | null;\n  generatedByUser: {\n    id: number;\n    firstName: string;\n    lastName: string;\n  } | null;\n  createdAt: string;\n}\n\ninterface Contract {\n  id: number;\n  contractType: string;\n  startDate: string;\n  endDate: string | null;\n  salary: number | null;\n  workingHours: number | null;\n  position: string | null;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n  generatedBy: number | null;\n  generatedByUser: {\n    id: number;\n    firstName: string;\n    lastName: string;\n  } | null;\n  createdAt: string;\n}\n\nconst LifecycleView: React.FC<LifecycleViewProps> = ({ userId, userName }) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin } = usePermissions();\n  const { showMessage } = useMessage();\n  \n  const [lifecycleData, setLifecycleData] = useState<LifecycleData | null>(null);\n  const [certificates, setCertificates] = useState<Certificate[]>([]);\n  const [contracts, setContracts] = useState<Contract[]>([]);\n  const [offboardingTasks, setOffboardingTasks] = useState<Task[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Modal States\n  const [isCertificateCreateModalOpen, setIsCertificateCreateModalOpen] = useState(false);\n  const [isContractCreateModalOpen, setIsContractCreateModalOpen] = useState(false);\n  const [editingCertificate, setEditingCertificate] = useState<Certificate | null>(null);\n  const [editingContract, setEditingContract] = useState<Contract | null>(null);\n  \n  const [downloadingCertId, setDownloadingCertId] = useState<number | null>(null);\n  const [downloadingContractId, setDownloadingContractId] = useState<number | null>(null);\n  const [isOffboardingStartModalOpen, setIsOffboardingStartModalOpen] = useState(false);\n  const [isOffboardingCompleteModalOpen, setIsOffboardingCompleteModalOpen] = useState(false);\n  const [isEditContractDatesModalOpen, setIsEditContractDatesModalOpen] = useState(false);\n  const [editingContractStartDate, setEditingContractStartDate] = useState<string>('');\n  const [editingContractEndDate, setEditingContractEndDate] = useState<string>('');\n\n  const fetchDataRef = useRef(false);\n  //  MEMORY FIX: Ref fr Mounted-Status und Timer-Cleanup\n  const isMountedRef = useRef(true);\n  const retryTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const statusChangeTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  const fetchData = useCallback(async (force: boolean = false) => {\n    // Verhindere mehrfaches gleichzeitiges Laden (auer wenn force=true)\n    if (fetchDataRef.current && !force) {\n      // Wenn bereits geladen wird, warte kurz und versuche es erneut\n      retryTimeoutRef.current = setTimeout(() => {\n        if (!fetchDataRef.current && isMountedRef.current) {\n          fetchData(true);\n        }\n      }, 500);\n      return;\n    }\n    \n    try {\n      fetchDataRef.current = true;\n      setLoading(true);\n      const [lifecycleResponse, certsResponse, contractsResponse, tasksResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.CERTIFICATES(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.CONTRACTS(userId)),\n        axiosInstance.get(API_ENDPOINTS.TASKS.BY_USER(userId)).catch(() => ({ data: [] })) // Optional, falls fehlschlgt\n      ]);\n      \n      //  MEMORY FIX: Nur State setzen wenn noch gemounted\n      if (!isMountedRef.current) return;\n      \n      setLifecycleData(lifecycleResponse.data);\n      setCertificates(certsResponse.data?.certificates || []);\n      setContracts(contractsResponse.data?.contracts || []);\n      \n      // Filtere Offboarding-Tasks (die 3 spezifischen Tasks)\n      const allTasks = tasksResponse.data || [];\n      const offboardingTaskTitles = [\n        'Crear certificado laboral',\n        'Realizar liquidacin final',\n        'Desafiliar de seguridad social'\n      ];\n      const filteredTasks = allTasks.filter((task: Task) => \n        offboardingTaskTitles.includes(task.title)\n      );\n      setOffboardingTasks(filteredTasks);\n      \n      // Prfe ob automatische Status-nderung ntig ist (wird im Backend gemacht, aber hier prfen wir fr UI-Feedback)\n      if (lifecycleResponse.data?.lifecycle?.status === 'onboarding' && lifecycleResponse.data?.progress?.percent === 100) {\n        // Status wird automatisch im Backend gendert, lade Daten nach kurzer Verzgerung neu\n        statusChangeTimeoutRef.current = setTimeout(() => {\n          if (isMountedRef.current) {\n            fetchData();\n          }\n        }, 1000);\n      }\n      \n      setError(null);\n    } catch (err: any) {\n      if (!isMountedRef.current) return;\n      console.error('Fehler beim Laden der Lebenszyklus-Daten:', err);\n      setError(err.response?.data?.message || 'Fehler beim Laden der Daten');\n      showMessage('Fehler beim Laden der Daten', 'error');\n    } finally {\n      setLoading(false);\n      fetchDataRef.current = false;\n    }\n  }, [userId]); // showMessage entfernt, da es sich ndern kann\n\n  useEffect(() => {\n    isMountedRef.current = true;\n    fetchDataRef.current = false; // Reset beim userId-Wechsel\n    fetchData();\n    \n    //  MEMORY FIX: Cleanup Timer bei Unmount\n    return () => {\n      isMountedRef.current = false;\n      if (retryTimeoutRef.current) clearTimeout(retryTimeoutRef.current);\n      if (statusChangeTimeoutRef.current) clearTimeout(statusChangeTimeoutRef.current);\n    };\n  }, [fetchData]);\n\n  const handleDownloadCertificate = async (certId: number) => {\n    setDownloadingCertId(certId);\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certId),\n        { responseType: 'blob' }\n      );\n      \n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = `arbeitszeugnis-${certId}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadUrl);\n      \n      showMessage('Arbeitszeugnis erfolgreich heruntergeladen', 'success');\n    } catch (err: any) {\n      console.error('Fehler beim Herunterladen:', err);\n      showMessage('Fehler beim Herunterladen des Arbeitszeugnisses', 'error');\n    } finally {\n      setDownloadingCertId(null);\n    }\n  };\n\n  const handleEditContractDates = () => {\n    if (!lifecycleData?.lifecycle) return;\n    \n    setEditingContractStartDate(\n      lifecycleData.lifecycle.contractStartDate \n        ? new Date(lifecycleData.lifecycle.contractStartDate).toISOString().split('T')[0]\n        : ''\n    );\n    setEditingContractEndDate(\n      lifecycleData.lifecycle.contractEndDate \n        ? new Date(lifecycleData.lifecycle.contractEndDate).toISOString().split('T')[0]\n        : ''\n    );\n    setIsEditContractDatesModalOpen(true);\n  };\n\n  const handleSaveContractDates = async () => {\n    try {\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\n        status: lifecycleData?.lifecycle.status || 'active',\n        contractStartDate: editingContractStartDate || null,\n        contractEndDate: editingContractEndDate || null\n      });\n      \n      showMessage('Vertragsdaten erfolgreich aktualisiert', 'success');\n      setIsEditContractDatesModalOpen(false);\n      fetchData();\n    } catch (err: any) {\n      console.error('Fehler beim Speichern der Vertragsdaten:', err);\n      showMessage('Fehler beim Speichern der Vertragsdaten', 'error');\n    }\n  };\n\n\n  const handleDownloadContract = async (contractId: number) => {\n    setDownloadingContractId(contractId);\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contractId),\n        { responseType: 'blob' }\n      );\n      \n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = `arbeitsvertrag-${contractId}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadUrl);\n      \n      showMessage('Arbeitsvertrag erfolgreich heruntergeladen', 'success');\n    } catch (err: any) {\n      console.error('Fehler beim Herunterladen:', err);\n      showMessage('Fehler beim Herunterladen des Arbeitsvertrags', 'error');\n    } finally {\n      setDownloadingContractId(null);\n    }\n  };\n\n  const getStatusBadge = (status: string, clickable: boolean = false) => {\n    const statusConfig: Record<string, { color: string; labelKey: string }> = {\n      onboarding: { color: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300', labelKey: 'lifecycle.status.onboarding' },\n      active: { color: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300', labelKey: 'lifecycle.status.active' },\n      contract_change: { color: 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300', labelKey: 'lifecycle.status.contract_change' },\n      offboarding: { color: 'bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300', labelKey: 'lifecycle.status.offboarding' },\n      archived: { color: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300', labelKey: 'lifecycle.status.archived' }\n    };\n\n    const config = statusConfig[status] || { color: 'bg-gray-100 text-gray-800', labelKey: status };\n    \n    return (\n      <span className={`px-3 py-1 rounded-full text-sm font-medium ${config.color} ${clickable ? 'cursor-pointer hover:opacity-80' : ''}`}>\n        {t(config.labelKey) || status}\n      </span>\n    );\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('de-DE', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n          <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!lifecycleData) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <p className=\"text-gray-500 dark:text-gray-400\">{t('lifecycle.noData', { defaultValue: 'Keine Lebenszyklus-Daten verfgbar' })}</p>\n      </div>\n    );\n  }\n\n  // Extrahiere socialSecurityRegistrations aus lifecycle (falls direkt vorhanden) oder aus lifecycleData\n  const socialSecurityRegistrations = lifecycleData.lifecycle?.socialSecurityRegistrations || lifecycleData.socialSecurityRegistrations || [];\n  const { lifecycle, progress } = lifecycleData;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Status-Box */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <BuildingOfficeIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.statusTitle')}\n          </h3>\n          <div className=\"flex items-center space-x-3\">\n          {/* Status-Badge (nur Anzeige, keine nderung mglich) */}\n          {getStatusBadge(lifecycle.status)}\n            {/* Offboarding-Start-Button (nur fr HR/Admin, nur wenn Status = \"active\") */}\n            {(isHR() || isAdmin()) && lifecycle.status === 'active' && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsOffboardingStartModalOpen(true)}\n                  className=\"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500\"\n                >\n                  <ArrowRightIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('lifecycle.offboarding.startButton', { defaultValue: 'Offboarding starten' })}\n                </div>\n              </div>\n            )}\n            {/* Offboarding-Abschluss-Button (nur fr HR/Admin, nur wenn Status = \"offboarding\") */}\n            {(isHR() || isAdmin()) && lifecycle.status === 'offboarding' && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsOffboardingCompleteModalOpen(true)}\n                  className=\"p-2 bg-red-600 dark:bg-red-700 text-white rounded-md hover:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n                >\n                  <CheckCircleIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('lifecycle.offboarding.complete.button', { defaultValue: 'Offboarding abschlieen' })}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        <div className=\"space-y-2 text-sm\">\n          {lifecycle.onboardingStartedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.onboardingStarted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.onboardingStartedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.onboardingCompletedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.onboardingCompleted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.onboardingCompletedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.contractStart')}</span>\n            <div className=\"flex items-center space-x-2\">\n              {lifecycle.contractStartDate ? (\n                <span className=\"dark:text-white\">\n                  {new Date(lifecycle.contractStartDate).toLocaleDateString('de-DE')}\n                </span>\n              ) : (\n                <span className=\"text-gray-400 italic text-sm\">{t('lifecycle.notSet', { defaultValue: 'Nicht gesetzt' })}</span>\n              )}\n              {(isHR() || isAdmin()) && (\n                <div className=\"relative group\">\n                  <button\n                    onClick={() => handleEditContractDates()}\n                    className=\"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition\"\n                  >\n                    <PencilIcon className=\"h-4 w-4\" />\n                  </button>\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                    {t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.contractEnd')}</span>\n            <div className=\"flex items-center space-x-2\">\n              {lifecycle.contractEndDate ? (\n                <span className=\"dark:text-white\">\n                  {new Date(lifecycle.contractEndDate).toLocaleDateString('de-DE')}\n                </span>\n              ) : (\n                <span className=\"text-gray-400 italic text-sm\">{t('lifecycle.notSet', { defaultValue: 'Nicht gesetzt' })}</span>\n              )}\n              {(isHR() || isAdmin()) && (\n                <div className=\"relative group\">\n                  <button\n                    onClick={() => handleEditContractDates()}\n                    className=\"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition\"\n                  >\n                    <PencilIcon className=\"h-4 w-4\" />\n                  </button>\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                    {t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n          {lifecycle.offboardingStartedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.offboardingStarted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.offboardingStartedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.exitDate && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.exitDate')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.exitDate).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.exitReason && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.exitReason')}</span>\n              <span className=\"dark:text-white\">{lifecycle.exitReason}</span>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Progress-Bar - Onboarding */}\n      {lifecycle.status === 'onboarding' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold dark:text-white mb-4\">{t('lifecycle.progressTitle')}</h3>\n          <div className=\"space-y-2\">\n            <div className=\"flex justify-between text-sm mb-2\">\n              <span className=\"text-gray-600 dark:text-gray-400\">\n                {t('lifecycle.progressSteps', { completed: progress.completed, total: progress.total })}\n              </span>\n              <span className=\"font-medium dark:text-white\">{progress.percent}%</span>\n            </div>\n            <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3\">\n              <div\n                className=\"bg-blue-600 h-3 rounded-full transition-all duration-300\"\n                style={{ width: `${progress.percent}%` }}\n              ></div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Progress-Bar - Offboarding */}\n      {lifecycle.status === 'offboarding' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold dark:text-white mb-4\">{t('lifecycle.offboarding.progressTitle', { defaultValue: 'Offboarding-Fortschritt' })}</h3>\n          <div className=\"space-y-4\">\n            {/* Progress-Bar */}\n            {(() => {\n              const completedTasks = offboardingTasks.filter(task => task.status === 'done').length;\n              const totalTasks = offboardingTasks.length || 3; // Fallback: 3 Tasks\n              const percent = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;\n              \n              return (\n                <>\n                  <div className=\"flex justify-between text-sm mb-2\">\n                    <span className=\"text-gray-600 dark:text-gray-400\">\n                      {t('lifecycle.offboarding.progressSteps', { completed: completedTasks, total: totalTasks }) || `${completedTasks} von ${totalTasks} Schritten abgeschlossen`}\n                    </span>\n                    <span className=\"font-medium dark:text-white\">{percent}%</span>\n                  </div>\n                  <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3\">\n                    <div\n                      className=\"bg-orange-600 h-3 rounded-full transition-all duration-300\"\n                      style={{ width: `${percent}%` }}\n                    ></div>\n                  </div>\n                </>\n              );\n            })()}\n            \n            {/* Offboarding-Tasks Liste */}\n            {offboardingTasks.length > 0 && (\n              <div className=\"mt-4 space-y-2\">\n                <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  {t('lifecycle.offboarding.tasksTitle', { defaultValue: 'Offboarding-Aufgaben' })}\n                </h4>\n                {offboardingTasks.map((task) => {\n                  const isCompleted = task.status === 'done';\n                  return (\n                    <div\n                      key={task.id}\n                      className={`flex items-center justify-between p-3 rounded-lg border ${\n                        isCompleted\n                          ? 'bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800'\n                          : 'bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600'\n                      }`}\n                    >\n                      <div className=\"flex items-center space-x-3 flex-1\">\n                        {isCompleted ? (\n                          <CheckCircleIcon className=\"h-5 w-5 text-green-600 dark:text-green-400 flex-shrink-0\" />\n                        ) : (\n                          <ClockIcon className=\"h-5 w-5 text-orange-600 dark:text-orange-400 flex-shrink-0\" />\n                        )}\n                        <div className=\"flex-1 min-w-0\">\n                          <p className={`text-sm font-medium ${isCompleted ? 'text-green-800 dark:text-green-200' : 'text-gray-800 dark:text-gray-200'}`}>\n                            {task.title}\n                          </p>\n                          {task.description && (\n                            <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-1 truncate\">\n                              {task.description}\n                            </p>\n                          )}\n                        </div>\n                      </div>\n                      <span className={`text-xs px-2 py-1 rounded ${\n                        isCompleted\n                          ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200'\n                          : 'bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200'\n                      }`}>\n                        {isCompleted\n                          ? t('common.done', { defaultValue: 'Abgeschlossen' })\n                          : t('common.open', { defaultValue: 'Offen' })}\n                      </span>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Dokumente - Arbeitszeugnisse */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.certificates')}\n          </h3>\n          {(isHR() || isAdmin()) && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => setIsCertificateCreateModalOpen(true)}\n                className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                style={{ width: '30.19px', height: '30.19px' }}\n                aria-label={t('lifecycle.createCertificate')}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('lifecycle.createCertificate')}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {certificates.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noCertificates')}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {certificates.map((cert) => (\n              <div\n                key={cert.id}\n                className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition\"\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <h4 className=\"font-medium dark:text-white\">\n                        {t('lifecycle.certificate')}\n                        {cert.certificateType !== 'employment' && ` (${cert.certificateType})`}\n                      </h4>\n                      {cert.isLatest && (\n                        <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center\">\n                          <CheckCircleIcon className=\"h-3 w-3 mr-1\" />\n                          {t('lifecycle.current')}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                      <div className=\"flex items-center space-x-2\">\n                        <CalendarIcon className=\"h-4 w-4\" />\n                        <span>{t('lifecycle.issuedOn')} {formatDate(cert.issueDate)}</span>\n                      </div>\n                      {cert.generatedByUser && (\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4\" />\n                          <span>\n                            {t('lifecycle.createdBy')} {cert.generatedByUser.firstName} {cert.generatedByUser.lastName}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2 ml-4\">\n                    {(isHR() || isAdmin()) && (\n                      <div className=\"relative group\">\n                        <button\n                          onClick={() => setEditingCertificate(cert)}\n                          className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition\"\n                        >\n                          <PencilIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('lifecycle.edit')}\n                        </div>\n                      </div>\n                    )}\n                    <div className=\"relative group\">\n                      <button\n                        onClick={() => handleDownloadCertificate(cert.id)}\n                        disabled={downloadingCertId === cert.id}\n                        className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {downloadingCertId === cert.id ? (\n                          <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                        ) : (\n                          <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                        )}\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('lifecycle.download')}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Dokumente - Arbeitsvertrge */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center mb-4\">\n          {(isHR() || isAdmin()) && (\n            <div className=\"relative group mr-3\">\n              <button\n                onClick={() => setIsContractCreateModalOpen(true)}\n                className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                style={{ width: '30.19px', height: '30.19px' }}\n                aria-label={t('lifecycle.createContract')}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('lifecycle.createContract')}\n              </div>\n            </div>\n          )}\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.contracts')}\n          </h3>\n        </div>\n\n        {contracts.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noContracts')}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {contracts.map((contract) => (\n              <div\n                key={contract.id}\n                className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition\"\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <h4 className=\"font-medium dark:text-white\">\n                        {t('lifecycle.contract')}\n                        {contract.contractType !== 'employment' && ` (${contract.contractType})`}\n                      </h4>\n                      {contract.isLatest && (\n                        <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center\">\n                          <CheckCircleIcon className=\"h-3 w-3 mr-1\" />\n                          {t('lifecycle.current')}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                      <div className=\"flex items-center space-x-2\">\n                        <CalendarIcon className=\"h-4 w-4\" />\n                        <span>\n                          {formatDate(contract.startDate)}\n                          {contract.endDate && ` - ${formatDate(contract.endDate)}`}\n                        </span>\n                      </div>\n                      {contract.position && (\n                        <div>{t('lifecycle.position')} {contract.position}</div>\n                      )}\n                      {contract.salary && (\n                        <div>{t('lifecycle.salary')} {contract.salary.toLocaleString('de-DE', { style: 'currency', currency: 'EUR' })}</div>\n                      )}\n                      {contract.workingHours && (\n                        <div>{t('lifecycle.workingHours')} {contract.workingHours}h/Woche</div>\n                      )}\n                      {contract.generatedByUser && (\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4\" />\n                          <span>\n                            {t('lifecycle.createdBy')} {contract.generatedByUser.firstName} {contract.generatedByUser.lastName}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2 ml-4\">\n                    {(isHR() || isAdmin()) && (\n                      <div className=\"relative group\">\n                        <button\n                          onClick={() => setEditingContract(contract)}\n                          className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition\"\n                        >\n                          <PencilIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('lifecycle.edit')}\n                        </div>\n                      </div>\n                    )}\n                    <div className=\"relative group\">\n                      <button\n                        onClick={() => handleDownloadContract(contract.id)}\n                        disabled={downloadingContractId === contract.id}\n                        className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {downloadingContractId === contract.id ? (\n                          <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                        ) : (\n                          <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                        )}\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('lifecycle.download')}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Social Security Editor - Nur fr Legal/Admin */}\n      {lifecycleData?.lifecycle && (\n        <SocialSecurityEditor\n          userId={userId}\n          lifecycleId={lifecycleData.lifecycle.id}\n          onUpdate={() => fetchData(true)}\n        />\n      )}\n\n      {/* Modals */}\n      <CertificateCreationModal\n        isOpen={isCertificateCreateModalOpen}\n        onClose={() => setIsCertificateCreateModalOpen(false)}\n        onCertificateCreated={() => {\n          fetchData();\n          setIsCertificateCreateModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n\n      <ContractCreationModal\n        isOpen={isContractCreateModalOpen}\n        onClose={() => setIsContractCreateModalOpen(false)}\n        onContractCreated={() => {\n          fetchData();\n          setIsContractCreateModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n\n      {editingCertificate && (\n        <CertificateEditModal\n          isOpen={!!editingCertificate}\n          onClose={() => setEditingCertificate(null)}\n          onCertificateUpdated={() => {\n            fetchData();\n            setEditingCertificate(null);\n          }}\n          userId={userId}\n          certificate={editingCertificate}\n        />\n      )}\n\n      {editingContract && (\n        <ContractEditModal\n          isOpen={!!editingContract}\n          onClose={() => setEditingContract(null)}\n          onContractUpdated={() => {\n            fetchData();\n            setEditingContract(null);\n          }}\n          userId={userId}\n          contract={editingContract}\n        />\n      )}\n\n      {/* Offboarding-Start-Modal */}\n      <OffboardingStartModal\n        isOpen={isOffboardingStartModalOpen}\n        onClose={() => setIsOffboardingStartModalOpen(false)}\n        onOffboardingStarted={() => {\n          fetchData();\n          setIsOffboardingStartModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n      \n      {/* Offboarding-Abschluss-Modal */}\n      <OffboardingCompleteModal\n        isOpen={isOffboardingCompleteModalOpen}\n        onClose={() => setIsOffboardingCompleteModalOpen(false)}\n        onOffboardingCompleted={() => {\n          fetchData();\n          setIsOffboardingCompleteModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n        offboardingTasks={offboardingTasks}\n      />\n\n      {/* Modal zum Bearbeiten der Vertragsdaten */}\n      {isEditContractDatesModalOpen && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md mx-4\">\n            <h2 className=\"text-xl font-semibold dark:text-white mb-4\">\n              {t('lifecycle.editContractDates', { defaultValue: 'Vertragsdaten bearbeiten' })}\n            </h2>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('lifecycle.contractStart', { defaultValue: 'Vertragsbeginn' })} *\n                </label>\n                <input\n                  type=\"date\"\n                  value={editingContractStartDate}\n                  onChange={(e) => setEditingContractStartDate(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  required\n                />\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('lifecycle.contractEnd', { defaultValue: 'Vertragsende' })} (optional)\n                </label>\n                <input\n                  type=\"date\"\n                  value={editingContractEndDate}\n                  onChange={(e) => setEditingContractEndDate(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('lifecycle.contractEndHint', { defaultValue: 'Nur bei befristeten Vertrgen ausfllen' })}\n                </p>\n              </div>\n            </div>\n            \n            <div className=\"flex justify-end space-x-3 mt-6\">\n              <button\n                onClick={() => setIsEditContractDatesModalOpen(false)}\n                className=\"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition\"\n              >\n                {t('common.cancel', { defaultValue: 'Abbrechen' })}\n              </button>\n              <button\n                onClick={handleSaveContractDates}\n                disabled={!editingContractStartDate}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {t('common.save', { defaultValue: 'Speichern' })}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LifecycleView;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { userApi, roleApi, branchApi } from '../api/apiClient.ts';\nimport { User, Role } from '../types/interfaces.ts';\nimport { CheckIcon, PlusIcon, PencilIcon, DocumentTextIcon, UserCircleIcon, ShieldCheckIcon, XMarkIcon, ArrowPathIcon, BuildingOfficeIcon, MapPinIcon } from '@heroicons/react/24/outline';\nimport useMessage from '../hooks/useMessage.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport IdentificationDocumentList from './IdentificationDocumentList.tsx';\nimport LifecycleView from './LifecycleView.tsx';\nimport { handleDirectDocumentUpload } from '../utils/documentUploadHandler.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { logger } from '../utils/logger.ts';\n\ninterface UserManagementTabProps {\n}\n\n// Lnder und Sprachen werden dynamisch aus bersetzungen geladen\n\n// Definiere Rollen, die immer vorhanden sein sollten (z.B. Admin-Rolle)\nconst fixedRoles = [1, 2, 999]; // Admin (1), User (2) und Hamburger (999) sind fixe Rollen\n\n// Vertragstypen fr Kolumbien (CO)\nconst CONTRACT_TYPES = [\n  { code: 'tiempo_completo', name: 'Tiempo Completo (>21 Tage/Monat)' },\n  { code: 'tiempo_parcial_7', name: 'Tiempo Parcial (7 Tage/Monat)' },\n  { code: 'tiempo_parcial_14', name: 'Tiempo Parcial (14 Tage/Monat)' },\n  { code: 'tiempo_parcial_21', name: 'Tiempo Parcial (21 Tage/Monat)' },\n  { code: 'prestacion_de_servicios', name: 'Prestacin de Servicios' },\n  { code: 'externo', name: 'Externo' }\n];\n\n// Gemeinsame Debug-Komponente hinzufgen\nconst RoleDebugInfo = ({ title, data }: { title: string, data: any }) => (\n  <div className=\"mb-2 p-2 border border-gray-300 rounded bg-gray-50\">\n    <h5 className=\"font-bold text-sm\">{title}</h5>\n    <pre className=\"text-xs overflow-auto max-h-24\">\n      {JSON.stringify(data, null, 2)}\n    </pre>\n  </div>\n);\n\nconst UserManagementTab = (): JSX.Element => {\n  const { t } = useTranslation();\n  const { handleError: handleErrorContext } = useError();\n  \n  // Lnder fr die Auswahl (dynamisch aus bersetzungen)\n  const COUNTRIES = [\n    { code: 'CO', name: t('countries.CO') },\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'DE', name: t('countries.DE') },\n    { code: 'AT', name: t('countries.AT') }\n  ];\n\n  // Lnder fr die Payroll-Auswahl (dynamisch aus bersetzungen)\n  const PAYROLL_COUNTRIES = [\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'CO', name: t('countries.CO') }\n  ];\n\n  // Sprachen fr die Auswahl (dynamisch aus bersetzungen)\n  const LANGUAGES = [\n    { code: 'es', name: t('languages.es') },\n    { code: 'de', name: t('languages.de') },\n    { code: 'en', name: t('languages.en') }\n  ];\n  \n  // Benutzer-States\n  const [users, setUsers] = useState<User[]>([]);\n  const [selectedUser, setSelectedUser] = useState<User | null>(null);\n  const [userFormData, setUserFormData] = useState<Partial<User>>({});\n  const [isEditingUser, setIsEditingUser] = useState(false);\n  const [selectedRoles, setSelectedRoles] = useState<number[]>([]);\n  const [lifecycleRefreshKey, setLifecycleRefreshKey] = useState(0);\n  const [isDebugMode, setIsDebugMode] = useState(false);\n  const [roleWarning, setRoleWarning] = useState<string | null>(null);\n  const { showMessage } = useMessage();\n  const { isAdmin } = usePermissions();\n  \n  // Neuer State fr Rollen\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState(false);\n  \n  // State fr Branches\n  const [branches, setBranches] = useState<Array<{ id: number; name: string }>>([]);\n  const [loadingBranches, setLoadingBranches] = useState(false);\n  const [selectedBranches, setSelectedBranches] = useState<number[]>([]);\n  \n  // Neuer State fr die aktive Unterseite\n  const [activeUserTab, setActiveUserTab] = useState<'details' | 'documents' | 'roles' | 'branches' | 'lifecycle'>('details');\n  \n  // State fr Active/Inactive Filter\n  const [userFilterTab, setUserFilterTab] = useState<'active' | 'inactive'>('active');\n  \n  // State fr Dokument-Upload\n  const [isUploading, setIsUploading] = useState(false);\n  const documentListRef = useRef<{ loadDocuments: () => void }>(null);\n  \n  // State fr Benutzererstellung\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n  const [isMobile, setIsMobile] = useState<boolean>(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [newUserFormData, setNewUserFormData] = useState({\n    email: '',\n    password: '',\n    firstName: '',\n    lastName: ''\n  });\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isCreateModalOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isCreateModalOpen, openSidepane, closeSidepane]);\n\n  // Alle Benutzer (fr Filterung)\n  const [allUsers, setAllUsers] = useState<User[]>([]);\n\n  // Initialisierung - Laden von Benutzern\n  useEffect(() => {\n    fetchAllUsers();\n  }, []);\n\n  // Benutzerdaten laden - Verwende gefilterten Endpoint, damit nur Benutzer der eigenen Organisation angezeigt werden\n  const fetchAllUsers = async () => {\n    try {\n      const response = await userApi.getAll();\n      setAllUsers(response.data);\n      // Initial: Nur aktive Benutzer anzeigen\n      filterUsersByActiveStatus('active', response.data);\n    } catch (err) {\n      handleError(err);\n    }\n  };\n\n  // Benutzer nach Active/Inactive filtern und alphabetisch sortieren\n  const filterUsersByActiveStatus = (status: 'active' | 'inactive', usersToFilter: User[] = allUsers) => {\n    const filtered = usersToFilter.filter(user => {\n      const isActive = user.active !== undefined ? user.active : true; // Default: true\n      return status === 'active' ? isActive : !isActive;\n    });\n    \n    // Alphabetisch sortieren nach username, dann firstName\n    const sorted = filtered.sort((a, b) => {\n      const aUsername = (a.username || '').toLowerCase();\n      const bUsername = (b.username || '').toLowerCase();\n      const aFirstName = (a.firstName || '').toLowerCase();\n      const bFirstName = (b.firstName || '').toLowerCase();\n      \n      // Zuerst nach username sortieren\n      if (aUsername !== bUsername) {\n        return aUsername.localeCompare(bUsername);\n      }\n      // Wenn username gleich, nach Vorname sortieren\n      return aFirstName.localeCompare(bFirstName);\n    });\n    \n    setUsers(sorted);\n  };\n\n  // Wenn Filter-Tab wechselt, Benutzerliste neu filtern\n  useEffect(() => {\n    if (allUsers.length > 0) {\n      filterUsersByActiveStatus(userFilterTab, allUsers);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userFilterTab]);\n  \n  // Rollen laden - Wird erst aufgerufen, wenn ein Benutzer ausgewhlt wurde\n  const fetchRoles = async () => {\n    try {\n      setLoadingRoles(true);\n      \n      // Fallback-Rollen fr den Notfall bereithalten\n      const fallbackRoles = [\n        { id: 1, name: 'admin', description: 'Administrator mit allen Rechten', permissions: [] },\n        { id: 2, name: 'user', description: 'Standardbenutzer', permissions: [] },\n        { id: 999, name: 'hamburger', description: 'Hamburger-Rolle fr neue Benutzer', permissions: [] }\n      ];\n      \n      try {\n        const response = await roleApi.getAll();\n        if (response.data && Array.isArray(response.data) && response.data.length > 0) {\n          setRoles(response.data);\n          logger.log(`${response.data.length} Rollen erfolgreich geladen`);\n        } else {\n          console.warn('Keine Rollen vom Server erhalten, verwende Fallback');\n          setRoles(fallbackRoles);\n        }\n      } catch (error) {\n        console.warn('Fehler beim Laden der Rollen, verwende Fallback:', error);\n        setRoles(fallbackRoles);\n      }\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  // Branches laden - Wird erst aufgerufen, wenn ein Benutzer ausgewhlt wurde\n  const fetchBranches = async () => {\n    try {\n      setLoadingBranches(true);\n      \n      try {\n        const response = await branchApi.getAll();\n        if (response.data && Array.isArray(response.data) && response.data.length > 0) {\n          setBranches(response.data);\n          logger.log(`${response.data.length} Branches erfolgreich geladen`);\n        } else {\n          console.warn('Keine Branches vom Server erhalten');\n          setBranches([]);\n        }\n      } catch (error) {\n        console.warn('Fehler beim Laden der Branches:', error);\n        setBranches([]);\n      }\n    } finally {\n      setLoadingBranches(false);\n    }\n  };\n\n  const handleDirectDocumentUploadWrapper = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (!e.target.files || e.target.files.length === 0) return;\n    if (!selectedUser) return;\n    \n    setIsUploading(true);\n    \n    const result = await handleDirectDocumentUpload(\n      e.target.files[0],\n      selectedUser.id,\n      async () => {\n        await fetchUserDetails(selectedUser.id);\n        // Warte kurz, damit Backend verarbeitet\n        await new Promise(resolve => setTimeout(resolve, 500));\n        // Lade Dokumente neu, wenn die Komponente gemountet ist\n        documentListRef.current?.loadDocuments();\n        showMessage(t('profile.documentUploadSuccess', { defaultValue: 'Dokument erfolgreich hochgeladen. Felder werden automatisch ausgefllt.' }), 'success');\n      },\n      (error) => {\n        showMessage(error, 'error');\n      }\n    );\n    \n    setIsUploading(false);\n    e.target.value = '';\n  };\n\n  // Detaillierte Benutzerdaten laden\n  const fetchUserDetails = async (userId: number) => {\n    try {\n      if (!userId || isNaN(userId)) {\n        setSelectedUser(null);\n        return;\n      }\n      \n      logger.log('Lade Benutzerdetails fr ID:', userId);\n      const response = await userApi.getById(userId);\n      \n      const userData = {\n        ...response.data,\n        active: response.data.active !== undefined ? response.data.active : true,\n        birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n      };\n      \n      // Extrahiere Rollen-IDs aus der verschachtelten Struktur\n      let roleIds: number[] = [];\n      \n      if (response.data.roles && Array.isArray(response.data.roles)) {\n        logger.log('Rollenstruktur (Typ):', typeof response.data.roles, 'Lnge:', response.data.roles.length);\n        \n        // Struktur: roles: [{ role: { id, name, ... } }]\n        if (response.data.roles.length > 0 && response.data.roles[0].role) {\n          roleIds = response.data.roles.map(userRole => userRole.role.id);\n          logger.log('Extrahierte Rollen-IDs aus verschachtelter Struktur:', roleIds);\n        }\n        // Fallback fr andere Formate\n        else if (response.data.roles.length > 0) {\n          if (typeof response.data.roles[0] === 'number') {\n            roleIds = response.data.roles;\n          } else if (response.data.roles[0].roleId) {\n            roleIds = response.data.roles.map(role => role.roleId);\n          } else if (response.data.roles[0].id) {\n            roleIds = response.data.roles.map(role => role.id);\n          }\n        }\n      } else {\n        console.warn('Rollen fehlen oder sind kein Array:', response.data.roles);\n      }\n      \n      // Wenn keine Rollen gefunden wurden, probieren wir, diese aus roles in der Response direkt zu extrahieren\n      if (roleIds.length === 0 && response.data.role) {\n        logger.log('Versuche Rollen aus role-Eigenschaft zu extrahieren:', response.data.role);\n        if (Array.isArray(response.data.role)) {\n          roleIds = response.data.role.map((r: any) => r.id);\n        } else if (typeof response.data.role === 'object' && response.data.role !== null) {\n          roleIds = [response.data.role.id];\n        }\n      }\n      \n      logger.log('Endgltige extrahierte Rollen-IDs:', roleIds);\n      \n      // Extrahiere Branch-IDs aus der verschachtelten Struktur\n      let branchIds: number[] = [];\n      \n      if (response.data.branches && Array.isArray(response.data.branches)) {\n        logger.log('Branches-Struktur (Typ):', typeof response.data.branches, 'Lnge:', response.data.branches.length);\n        \n        // Struktur: branches: [{ branch: { id, name, ... } }]\n        if (response.data.branches.length > 0 && response.data.branches[0].branch) {\n          branchIds = response.data.branches.map(userBranch => userBranch.branch.id);\n          logger.log('Extrahierte Branch-IDs aus verschachtelter Struktur:', branchIds);\n        }\n        // Fallback fr andere Formate\n        else if (response.data.branches.length > 0) {\n          if (typeof response.data.branches[0] === 'number') {\n            branchIds = response.data.branches;\n          } else if (response.data.branches[0].branchId) {\n            branchIds = response.data.branches.map(branch => branch.branchId);\n          } else if (response.data.branches[0].id) {\n            branchIds = response.data.branches.map(branch => branch.id);\n          }\n        }\n      } else {\n        console.warn('Branches fehlen oder sind kein Array:', response.data.branches);\n      }\n      \n      logger.log('Endgltige extrahierte Branch-IDs:', branchIds);\n      \n      setSelectedUser(userData);\n      setUserFormData(userData);\n      setSelectedRoles(roleIds);\n      setSelectedBranches(branchIds);\n      \n      // Rollen nur einmal laden, wenn sie noch nicht geladen wurden\n      if (roles.length === 0) {\n        await fetchRoles();\n      }\n      \n      // Branches nur einmal laden, wenn sie noch nicht geladen wurden\n      if (branches.length === 0) {\n        await fetchBranches();\n      }\n    } catch (err) {\n      console.error('Fehler beim Laden der Benutzerdetails:', err);\n      handleError(err);\n    }\n  };\n\n  // Fehlerbehandlung\n  const handleError = (err: any) => {\n    let message = 'Ein Fehler ist aufgetreten';\n    if (err.response?.data?.message) {\n      message = err.response.data.message;\n    } else if (err instanceof Error) {\n      message = err.message;\n    }\n    \n    // Fehler \"Ungltige Rollen-ID\" nicht weitergeben, wenn kein Benutzer ausgewhlt ist\n    if (message.includes('Ungltige Rollen-ID') && !selectedUser) {\n      console.warn('Fehler unterdrckt, da kein Benutzer ausgewhlt ist:', message);\n      return;\n    }\n    \n    handleErrorContext({ message });\n  };\n\n  // Handler fr Auswahl eines Benutzers\n  const handleUserSelect = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const userId = parseInt(event.target.value, 10);\n    if (userId && !isNaN(userId)) {\n      fetchUserDetails(userId);\n    } else {\n      setSelectedUser(null);\n      setUserFormData({});\n      setSelectedRoles([]);\n    }\n  };\n\n  // Erweitere den handleUserInputChange\n  const handleUserInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value, type } = e.target;\n    let finalValue: string | number | null = value;\n    \n    // Korrekte Typenkonvertierung fr numerische Felder\n    if (type === 'number') {\n      // Wenn das Feld leer ist, setzen wir null statt NaN\n      finalValue = value === '' ? null : Number(value);\n    }\n    \n    setUserFormData({ ...userFormData, [name]: finalValue });\n    setIsEditingUser(true); // Aktiviere Edit-Modus sobald etwas gendert wird\n  };\n\n  // Abbrechen der Bearbeitung\n  const handleCancelEdit = () => {\n    if (selectedUser) {\n      setUserFormData({\n        ...selectedUser,\n        birthday: selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : null\n      });\n    }\n    setIsEditingUser(false);\n  };\n\n  // Speichern der Benutzerdaten\n  const handleUserSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!selectedUser || !selectedUser.id) {\n      handleErrorContext({ message: 'Kein Benutzer ausgewhlt' });\n      showMessage('Kein Benutzer ausgewhlt', 'error');\n      return;\n    }\n\n    try {\n      // Validierung\n      if (!userFormData.username?.trim()) throw new Error('Benutzername ist erforderlich');\n      if (!userFormData.email?.trim()) throw new Error('E-Mail ist erforderlich');\n      // firstName, lastName, birthday werden nur von KI aus Dokument gesetzt, nicht manuell validiert\n\n      // Bereite die Daten korrekt vor\n      // Contract, Salary, Normal Working Hours werden zu Lifecycle verschoben\n      // firstName, lastName, birthday werden nur von KI aus Dokument gesetzt, nicht manuell editierbar\n      const dataToSend = {\n        username: userFormData.username,\n        email: userFormData.email,\n        bankDetails: userFormData.bankDetails || null,\n        gender: userFormData.gender || null,\n        phoneNumber: userFormData.phoneNumber || null,\n        language: userFormData.language || null,\n        // Payroll-Felder bleiben (sind separate Sektion)\n        hourlyRate: userFormData.hourlyRate === null || userFormData.hourlyRate === undefined || userFormData.hourlyRate === '' as any\n          ? null \n          : typeof userFormData.hourlyRate === 'string' \n            ? userFormData.hourlyRate  // Keine Konvertierung fr Decimal-Werte, da sie als Strings bergeben werden sollten\n            : userFormData.hourlyRate.toString(),  // Konvertierung zu String fr Decimal-Werte\n        monthlySalary: userFormData.monthlySalary === null || userFormData.monthlySalary === undefined || userFormData.monthlySalary === '' as any\n          ? null \n          : typeof userFormData.monthlySalary === 'string' \n            ? parseFloat(userFormData.monthlySalary) \n            : userFormData.monthlySalary,\n        payrollCountry: userFormData.payrollCountry || null,\n        contractType: userFormData.contractType || null,\n      };\n\n      logger.log('Sende Daten zum Server:', dataToSend);\n\n      // Update Benutzerdaten\n      const response = await userApi.update(selectedUser.id, dataToSend);\n\n      if (response.data) {\n        const updatedData = {\n          ...response.data,\n          birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n        };\n        setSelectedUser(updatedData);\n        setUserFormData({\n          ...updatedData,\n          birthday: updatedData.birthday ? new Date(updatedData.birthday).toISOString().split('T')[0] : null\n        });\n        \n        // Optimistisches Update: User in allUsers und users aktualisieren\n        setAllUsers(prevUsers => \n          prevUsers.map(user => \n            user.id === updatedData.id ? updatedData : user\n          )\n        );\n        \n        // Benutzerliste neu filtern basierend auf aktuellem Tab\n        filterUsersByActiveStatus(userFilterTab, allUsers.map(user => \n          user.id === updatedData.id ? updatedData : user\n        ));\n        \n        showMessage('Benutzerprofil erfolgreich aktualisiert', 'success');\n        setIsEditingUser(false);\n      }\n    } catch (err) {\n      console.error('Fehler beim Speichern der Benutzerdaten:', err);\n      // Bei Fehler: Rollback durch vollstndiges Reload\n      await fetchAllUsers();\n      if (err.response?.status === 400) {\n        const errorMsg = `Validierungsfehler: ${err.response?.data?.message || 'Bitte berprfe die eingegebenen Daten'}`;\n        handleErrorContext({ message: errorMsg });\n        showMessage(errorMsg, 'error');\n      } else if (err.response?.status === 404) {\n        handleErrorContext({ message: 'Benutzer wurde nicht gefunden' });\n        showMessage('Benutzer wurde nicht gefunden', 'error');\n      } else {\n        handleError(err);\n      }\n    }\n  };\n\n  // Benutzer aktivieren/deaktivieren\n  const handleToggleActive = async () => {\n    if (!selectedUser || !selectedUser.id) {\n      showMessage('Kein Benutzer ausgewhlt', 'error');\n      return;\n    }\n\n    // Verhindere, dass der Admin-Benutzer sich selbst deaktiviert\n    const currentUserId = parseInt(localStorage.getItem('userId') || '0', 10);\n    if (selectedUser.id === currentUserId) {\n      showMessage('Du kannst dich nicht selbst deaktivieren', 'warning');\n      return;\n    }\n\n    try {\n      // Aktueller Status: wenn undefined, dann true (Default)\n      const currentActiveStatus = selectedUser.active !== undefined ? selectedUser.active : true;\n      const newActiveStatus = !currentActiveStatus;\n      \n      logger.log('Toggle active:', { \n        currentActiveStatus, \n        newActiveStatus, \n        selectedUser,\n        selectedUserActive: selectedUser.active,\n        userId: selectedUser.id\n      });\n      \n      const updatePayload = { active: newActiveStatus };\n      logger.log('Sending update payload:', updatePayload, 'Type of active:', typeof newActiveStatus);\n      \n      // Update Benutzer\n      const response = await userApi.update(selectedUser.id, updatePayload);\n      \n      logger.log('Update response:', response.data);\n\n      if (response.data) {\n        const updatedData = {\n          ...response.data,\n          active: response.data.active !== undefined ? response.data.active : true,\n          birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n        };\n        \n        logger.log('Updated user data:', updatedData);\n        \n        setSelectedUser(updatedData);\n        setUserFormData({\n          ...updatedData,\n          birthday: updatedData.birthday ? new Date(updatedData.birthday).toISOString().split('T')[0] : null\n        });\n        \n        // Optimistisches Update: Berechne den aktualisierten Array direkt (vor State-Update)\n        // Dies verhindert Race Conditions bei schnellen, aufeinanderfolgenden Updates\n        const updatedAllUsers = allUsers.map(user => \n          user.id === updatedData.id ? updatedData : user\n        );\n        \n        // Update State mit dem berechneten Array\n        setAllUsers(updatedAllUsers);\n        \n        // Filtere mit dem aktualisierten Array (nicht mit allUsers, da State-Update asynchron ist)\n        filterUsersByActiveStatus(userFilterTab, updatedAllUsers);\n        \n        // fetchAllUsers() entfernt - optimistisches Update reicht aus\n        // Backend speichert korrekt, State ist bereits aktualisiert\n        // Nur bei Fehler wird fetchAllUsers() aufgerufen (siehe catch-Block)\n        \n        showMessage(\n          newActiveStatus \n            ? 'Benutzer erfolgreich aktiviert' \n            : 'Benutzer erfolgreich deaktiviert',\n          'success'\n        );\n      }\n    } catch (err) {\n      console.error('Fehler beim Aktivieren/Deaktivieren des Benutzers:', err);\n      handleError(err);\n      // Bei Fehler: Benutzerliste neu laden\n      await fetchAllUsers();\n    }\n  };\n\n  // Toggle Rolle fr einen Benutzer (hinzufgen/entfernen)\n  const toggleRole = async (roleId: number) => {\n    if (!roleId || !selectedUser) return;\n    \n    // Prfe, ob es sich um eine fixe Rolle handelt - Nur fr Admin-Benutzer (ID: 1) sind Admin-Rollen (ID: 1) nicht entfernbar\n    if (roleId === 1 && selectedUser.id === 1 && selectedRoles.includes(roleId)) {\n      showMessage('Die Admin-Rolle kann vom Admin-Benutzer nicht entfernt werden', 'warning');\n      return;\n    }\n    \n    try {\n      logger.log('Toggle Rolle:', roleId, 'fr Benutzer:', selectedUser.id);\n      logger.log('Aktuelle ausgewhlte Rollen:', selectedRoles);\n      \n      // berprfen, ob die Rolle bereits zugewiesen ist\n      const isRoleSelected = selectedRoles.includes(roleId);\n      \n      const newSelectedRoles = isRoleSelected\n        ? selectedRoles.filter(id => id !== roleId)\n        : [...selectedRoles, roleId];\n      \n      logger.log('Neue ausgewhlte Rollen:', newSelectedRoles);\n      \n      // Optimistisches UI-Update\n      setSelectedRoles(newSelectedRoles);\n      \n      // API-Aufruf zur Aktualisierung der Rollen\n      logger.log('Sende Rollenaktualisierung an API:', { userId: selectedUser.id, roleIds: newSelectedRoles });\n      const response = await userApi.updateRoles(selectedUser.id, newSelectedRoles);\n      logger.log('API-Antwort bei Rollenaktualisierung:', response.data);\n      \n      // Benutzer nach dem Update neu laden\n      await fetchUserDetails(selectedUser.id);\n      \n      // Erfolgsmeldung anzeigen mit showMessage statt setUserSuccess\n      showMessage(\n        isRoleSelected\n          ? `Rolle erfolgreich entfernt`\n          : `Rolle erfolgreich zugewiesen`,\n        'success'\n      );\n    } catch (error) {\n      // Bei Fehler auf vorherigen Zustand zurcksetzen\n      console.error('Fehler beim Aktualisieren der Rollen:', error);\n      fetchUserDetails(selectedUser.id);\n      handleError(error);\n      showMessage('Fehler beim Aktualisieren der Rollen', 'error');\n    }\n  };\n\n  // Toggle Branch fr einen Benutzer (hinzufgen/entfernen)\n  const toggleBranch = async (branchId: number) => {\n    if (!branchId || !selectedUser) return;\n    \n    try {\n      logger.log('Toggle Branch:', branchId, 'fr Benutzer:', selectedUser.id);\n      logger.log('Aktuelle ausgewhlte Branches:', selectedBranches);\n      \n      // berprfen, ob die Branch bereits zugewiesen ist\n      const isBranchSelected = selectedBranches.includes(branchId);\n      \n      const newSelectedBranches = isBranchSelected\n        ? selectedBranches.filter(id => id !== branchId)\n        : [...selectedBranches, branchId];\n      \n      logger.log('Neue ausgewhlte Branches:', newSelectedBranches);\n      \n      // Optimistisches UI-Update\n      setSelectedBranches(newSelectedBranches);\n      \n      // API-Aufruf zur Aktualisierung der Branches\n      logger.log('Sende Branch-Aktualisierung an API:', { userId: selectedUser.id, branchIds: newSelectedBranches });\n      const response = await userApi.updateBranches(selectedUser.id, newSelectedBranches);\n      logger.log('API-Antwort bei Branch-Aktualisierung:', response.data);\n      \n      // Benutzer nach dem Update neu laden\n      await fetchUserDetails(selectedUser.id);\n      \n      // Erfolgsmeldung anzeigen\n      showMessage(\n        isBranchSelected\n          ? `Branch erfolgreich entfernt`\n          : `Branch erfolgreich zugewiesen`,\n        'success'\n      );\n    } catch (error) {\n      // Bei Fehler auf vorherigen Zustand zurcksetzen\n      console.error('Fehler beim Aktualisieren der Branches:', error);\n      fetchUserDetails(selectedUser.id);\n      handleError(error);\n      showMessage('Fehler beim Aktualisieren der Branches', 'error');\n    }\n  };\n\n  // Initialisiere FormData wenn Benutzer ausgewhlt wird\n  useEffect(() => {\n    if (selectedUser) {\n      setUserFormData({\n        ...selectedUser,\n        birthday: selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : null\n      });\n      setIsEditingUser(false); // Starte im Read-Only Modus\n    }\n  }, [selectedUser]);\n\n  // Handler fr neue Benutzer-Formular\n  const handleNewUserInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setNewUserFormData({ ...newUserFormData, [name]: value });\n  };\n\n  // Neuen Benutzer erstellen\n  const handleCreateUser = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Validierung\n    if (!newUserFormData.email || !newUserFormData.password || !newUserFormData.firstName || !newUserFormData.lastName) {\n      showMessage('Bitte fllen Sie alle Felder aus', 'error');\n      return;\n    }\n\n    // E-Mail-Format validieren\n    if (!newUserFormData.email.match(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/)) {\n      showMessage('Ungltiges E-Mail-Format', 'error');\n      return;\n    }\n\n    try {\n      const response = await userApi.create(newUserFormData);\n      \n      // Optimistisches Update: User zu allUsers hinzufgen\n      if (response.data) {\n        const newUser = {\n          ...response.data,\n          active: response.data.active !== undefined ? response.data.active : true\n        };\n        setAllUsers(prevUsers => [newUser, ...prevUsers]);\n        \n        // Wenn aktueller Tab \"active\" ist und neuer User aktiv ist, auch zu users hinzufgen\n        if (userFilterTab === 'active' && newUser.active) {\n          setUsers(prevUsers => [newUser, ...prevUsers]);\n        }\n      }\n      \n      showMessage('Benutzer erfolgreich erstellt', 'success');\n      setIsCreateModalOpen(false);\n      setNewUserFormData({\n        email: '',\n        password: '',\n        firstName: '',\n        lastName: ''\n      });\n    } catch (err: any) {\n      // Bei Fehler: Rollback durch vollstndiges Reload\n      await fetchAllUsers();\n      const errorMessage = err.response?.data?.message || 'Fehler beim Erstellen des Benutzers';\n      showMessage(errorMessage, 'error');\n      handleErrorContext({ message: errorMessage });\n    }\n  };\n\n  return (\n    <div className=\"container mx-auto px-4 pb-6\">\n      {/* Die lokale Erfolgsmeldungs-Anzeige wird entfernt, da wir jetzt HeaderMessage verwenden */}\n      {/* {userSuccess && (\n        <div className=\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4\">\n          {userSuccess}\n        </div>\n      )} */}\n\n      {/* Titelzeile: Button links, Dropdown rechts */}\n      <div className=\"mb-6\">\n        <div className=\"flex items-start gap-4\">\n          {/* Linke Seite: \"Neuer Benutzer\"-Button */}\n          <div className=\"flex items-center pt-8\">\n            {isAdmin() && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsCreateModalOpen(true)}\n                  className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                  style={{ width: '30.19px', height: '30.19px' }}\n                  aria-label={t('users.create')}\n                >\n                  <PlusIcon className=\"h-4 w-4\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('users.create')}\n                </div>\n              </div>\n            )}\n          </div>\n          \n          {/* Rechts: Benutzer-Dropdown mit Active/Inactive Tabs */}\n          <div className=\"flex-1\">\n            {/* Active/Inactive Tabs */}\n            <div className=\"flex gap-2 mb-2\">\n              <button\n                type=\"button\"\n                onClick={() => setUserFilterTab('active')}\n                className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${\n                  userFilterTab === 'active'\n                    ? 'bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400'\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600'\n                }`}\n              >\n                {t('users.active')}\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setUserFilterTab('inactive')}\n                className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${\n                  userFilterTab === 'inactive'\n                    ? 'bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400'\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600'\n                }`}\n              >\n                {t('users.inactive')}\n              </button>\n            </div>\n            \n            <select\n              id=\"userSelect\"\n              onChange={handleUserSelect}\n              className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n            >\n              <option value=\"\">-- {t('common.select')} --</option>\n              {users.map(user => (\n                <option key={user.id} value={user.id}>\n                  {user.firstName} {user.lastName} ({user.username})\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n      </div>\n\n      {selectedUser && (\n        <div>\n          {/* Tabs fr Benutzerdetails, Dokumente und Rollen - zusammenhngende Box ohne Shadow/Border */}\n          <div className=\"bg-white dark:bg-gray-800 mb-6\">\n            {/* Tab-Navigation */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n              <nav className=\"flex -mb-px\">\n                <button\n                  onClick={() => setActiveUserTab('details')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'details'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <UserCircleIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('users.title')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('documents')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'documents'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <DocumentTextIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('profile.documents')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('roles')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'roles'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <ShieldCheckIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('roles.title')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('branches')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'branches'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <MapPinIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('branches.title') || 'Niederlassungen'}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('lifecycle')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'lifecycle'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <BuildingOfficeIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('lifecycle.tabTitle')}\n                </button>\n              </nav>\n          </div>\n\n            {/* Tab-Inhalte */}\n          {/* Benutzerdetails Formular */}\n          {activeUserTab === 'details' && (\n              <form onSubmit={handleUserSubmit} className=\"p-6\">\n              {/* Benutzerdetails - gleiche Reihenfolge wie Profile.tsx */}\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-6\">\n                {/* 1. Username, Email (nebeneinander - 2 Spalten) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.username')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"username\"\n                    value={userFormData.username || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.email')}\n                  </label>\n                  <input\n                    type=\"email\"\n                    name=\"email\"\n                    value={userFormData.email || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* 2. Language (allein - 1 Spalte) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.language')} <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    name=\"language\"\n                    value={userFormData.language || 'es'}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    required\n                  >\n                    {LANGUAGES.map((language) => (\n                      <option key={language.code} value={language.code}>\n                        {language.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                {/* 3. Dokumenten-Upload (prominent - volle Breite) */}\n                {selectedUser && (\n                  <div className=\"sm:col-span-2\">\n                    <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <h3 className=\"text-sm font-medium text-blue-900 dark:text-blue-200 mb-1\">\n                            {t('profile.identificationDocument', { defaultValue: 'Identifikationsdokument' })}\n                          </h3>\n                          <p className=\"text-xs text-blue-700 dark:text-blue-300\">\n                            {t('profile.uploadDocumentHint', { defaultValue: 'Bitte laden Sie das Identifikationsdokument (Cdula oder Pasaporte) hoch. Die Felder werden automatisch ausgefllt.' })}\n                          </p>\n                        </div>\n                        <input\n                          type=\"file\"\n                          id=\"documentUploadUserManagement\"\n                          accept=\"image/*\"\n                          className=\"hidden\"\n                          onChange={handleDirectDocumentUploadWrapper}\n                          disabled={isUploading}\n                        />\n                        <label\n                          htmlFor=\"documentUploadUserManagement\"\n                          className={`p-2 text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer ${isUploading ? 'opacity-50 cursor-not-allowed' : ''}`}\n                          title={t('profile.uploadDocument', { defaultValue: 'Dokument hochladen' })}\n                        >\n                          <DocumentTextIcon className=\"h-5 w-5\" />\n                        </label>\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {/* 4. ID-Dokument-Daten (readonly, alle Felder - korrekte Reihenfolge) */}\n                {/* Zeige Felder an, wenn User-Daten vorhanden sind (werden beim Upload extrahiert) */}\n                {(selectedUser.firstName || selectedUser.lastName || selectedUser.birthday || selectedUser.identificationNumber) && (\n                  <>\n                    {(() => {\n                      const latestDoc = selectedUser.identificationDocuments && selectedUser.identificationDocuments.length > 0 ? selectedUser.identificationDocuments[0] : null;\n                      return (\n                        <>\n                          {/* 1. Vorname */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('users.form.firstName')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.firstName || ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 2. Nachname */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('users.form.lastName')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.lastName || ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 3. Geburtsdatum */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.birthday')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 4. Land */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.country')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.country ? COUNTRIES.find(c => c.code === selectedUser.country)?.name || selectedUser.country : ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 5. Geschlecht (editierbar, falls KI nicht richtig erkannt hat) */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.gender')}\n                            </label>\n                            <select\n                              name=\"gender\"\n                              value={userFormData.gender || ''}\n                              onChange={handleUserInputChange}\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                            >\n                              <option value=\"\">{t('profile.selectGender')}</option>\n                              <option value=\"male\">{t('profile.genderMale')}</option>\n                              <option value=\"female\">{t('profile.genderFemale')}</option>\n                              <option value=\"other\">{t('profile.genderOther')}</option>\n                            </select>\n                          </div>\n\n                          {/* 6. Dokument-Typ */}\n                          {latestDoc && (\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.identificationType')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={\n                                latestDoc.documentType\n                                  ? (() => {\n                                      const typeMap: Record<string, string> = {\n                                        passport: t('identificationDocuments.types.passport'),\n                                        national_id: t('identificationDocuments.types.national_id'),\n                                        driving_license: t('identificationDocuments.types.driving_license'),\n                                        residence_permit: t('identificationDocuments.types.residence_permit'),\n                                        work_permit: t('identificationDocuments.types.work_permit'),\n                                        tax_id: t('identificationDocuments.types.tax_id'),\n                                        social_security: t('identificationDocuments.types.social_security'),\n                                      };\n                                      return typeMap[latestDoc.documentType] || latestDoc.documentType;\n                                    })()\n                                  : ''\n                              }\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n                          )}\n\n                          {/* 7. Dokument-Nummer */}\n                          {(selectedUser.identificationNumber || latestDoc?.documentNumber) && (\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.identificationNumber')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.identificationNumber || latestDoc?.documentNumber || ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n                          )}\n\n                          {/* 8. Ausstellungsdatum */}\n                          {latestDoc?.issueDate && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.identificationIssueDate') || 'Ausstellungsdatum'}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={new Date(latestDoc.issueDate).toISOString().split('T')[0]}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n\n                          {/* 9. Ablaufdatum */}\n                          {latestDoc?.expiryDate && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.identificationExpiryDate')}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={new Date(latestDoc.expiryDate).toISOString().split('T')[0]}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n\n                          {/* 10. Ausstellungsland */}\n                          {latestDoc?.issuingCountry && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.issuingCountry')}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={latestDoc.issuingCountry}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n\n                          {/* 11. Ausstellungsbehrde */}\n                          {latestDoc?.issuingAuthority && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.issuingAuthority')}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={latestDoc.issuingAuthority}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n                        </>\n                      );\n                    })()}\n                  </>\n                )}\n\n                {/* 5. Phone Number (allein - 1 Spalte, da Geschlecht jetzt in ID-Dokument-Daten) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.phoneNumber')}\n                  </label>\n                  <input\n                    type=\"tel\"\n                    name=\"phoneNumber\"\n                    value={userFormData.phoneNumber || ''}\n                    onChange={handleUserInputChange}\n                    placeholder=\"+573001234567\"\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                    {t('profile.phoneNumberHint')}\n                  </p>\n                </div>\n\n                {/* 6. Finanzdaten (Bank Details - 1 Spalte) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.bankDetails')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"bankDetails\"\n                    value={userFormData.bankDetails || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Contract, Salary, Normal Working Hours ENTFERNEN - werden zu Lifecycle verschoben */}\n              </div>\n\n              {/* Lohnabrechnung-Einstellungen */}\n              <div className=\"mt-4 border-t pt-4\">\n                <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('users.form.payrollSettings')}</h3>\n                \n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('users.form.payrollCountry')}\n                    </label>\n                    <select\n                      name=\"payrollCountry\"\n                      value={userFormData.payrollCountry || selectedUser.payrollCountry || 'CH'}\n                      onChange={handleUserInputChange}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    >\n                      {PAYROLL_COUNTRIES.map(country => (\n                        <option key={country.code} value={country.code}>\n                          {country.name}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  \n                  {(userFormData.payrollCountry === 'CO' || \n                    (selectedUser.payrollCountry === 'CO' && !userFormData.payrollCountry)) && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('users.form.contractType')}\n                      </label>\n                      <select\n                        name=\"contractType\"\n                        value={userFormData.contractType || ''}\n                        onChange={handleUserInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      >\n                        <option value=\"\">Bitte auswhlen</option>\n                        {CONTRACT_TYPES.map(type => (\n                          <option key={type.code} value={type.code}>\n                            {type.name}\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                  )}\n                </div>\n                \n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('users.form.hourlyRate')} ({(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? 'CHF' : 'COP'})\n                    </label>\n                    <input\n                      type=\"number\"\n                      name=\"hourlyRate\"\n                      min=\"0\"\n                      step={(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? '0.05' : '1'}\n                      value={userFormData.hourlyRate === null || userFormData.hourlyRate === undefined ? '' : userFormData.hourlyRate}\n                      onChange={handleUserInputChange}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      placeholder={(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? 'z.B. 45.00' : 'z.B. 50000'}\n                    />\n                  </div>\n                  \n                  {((userFormData.payrollCountry === 'CO' || selectedUser.payrollCountry === 'CO') && \n                    (userFormData.contractType !== 'servicios_externos' && selectedUser.contractType !== 'servicios_externos') &&\n                    (userFormData.contractType || selectedUser.contractType)) && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('users.form.monthlySalary')} (COP)\n                      </label>\n                      <input\n                        type=\"number\"\n                        name=\"monthlySalary\"\n                        min=\"0\"\n                        step=\"1000\"\n                        value={userFormData.monthlySalary === null || userFormData.monthlySalary === undefined ? '' : userFormData.monthlySalary}\n                        onChange={handleUserInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                        placeholder=\"z.B. 3500000\"\n                      />\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {isEditingUser && (\n                <div className=\"mt-4 flex justify-end gap-3\">\n                  <div className=\"relative group\">\n                    <button\n                      type=\"button\"\n                      onClick={handleCancelEdit}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {t('common.cancel')}\n                    </div>\n                  </div>\n                  <div className=\"relative group\">\n                    <button\n                      type=\"submit\"\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                    >\n                      <CheckIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {t('common.save')}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* Status-Badge und Activate/Deactivate Button unter den Profil-Feldern */}\n              <div className=\"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-between items-center\">\n                {selectedUser.active !== undefined && (\n                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                    selectedUser.active \n                      ? 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300' \n                      : 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300'\n                  }`}>\n                    {selectedUser.active ? t('users.active') : t('users.inactive')}\n                  </span>\n                )}\n                {isAdmin() && (\n                  <button\n                    onClick={handleToggleActive}\n                    className={`relative group flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${\n                      selectedUser.active\n                        ? 'bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30'\n                        : 'bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900/20 dark:text-green-400 dark:hover:bg-green-900/30'\n                    }`}\n                  >\n                    {selectedUser.active ? (\n                      <>\n                        <XMarkIcon className=\"h-5 w-5\" />\n                        {t('users.deactivate')}\n                      </>\n                    ) : (\n                      <>\n                        <CheckIcon className=\"h-5 w-5\" />\n                        {t('users.activate')}\n                      </>\n                    )}\n                  </button>\n                )}\n              </div>\n            </form>\n          )}\n\n          {/* Identifikationsdokumente Tab */}\n          {activeUserTab === 'documents' && (\n              <div className=\"p-6\">\n            <IdentificationDocumentList userId={selectedUser.id} isAdmin={true} ref={documentListRef} />\n              </div>\n          )}\n\n          {/* Rollen Tab */}\n          {activeUserTab === 'roles' && (\n              <div className=\"p-6\">\n              {/* Rollenzuweisung - nur anzeigen, wenn Rollen geladen wurden */}\n              {loadingRoles ? (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('roleAssignment.title')}</h3>\n                  <p className=\"dark:text-gray-300\">{t('roleAssignment.loading')}</p>\n                </div>\n              ) : roles.length > 0 && (\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('roleAssignment.title')}</h3>\n                  \n                  {/* berprfung auf unbekannte Rollen */}\n                  {selectedRoles.some(roleId => !roles.some(role => role.id === roleId)) && (\n                    <div className=\"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4\">\n                      <p className=\"font-bold\">{t('roleAssignment.unknownRolesWarning')}</p>\n                      <p>{t('roleAssignment.unknownRolesMessage', { ids: selectedRoles.filter(roleId => !roles.some(role => role.id === roleId)).join(', ') })}</p>\n                      <p className=\"mt-2 text-sm\">{t('roleAssignment.availableRoleIds', { ids: roles.map(r => r.id).join(', ') })}</p>\n                    </div>\n                  )}\n                  \n                  {/* Aktuell zugewiesene Rollen */}\n                  <div className=\"mb-4\">\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('roleAssignment.currentRoles')}</h4>\n                    {selectedRoles.length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('roleAssignment.noRolesAssigned')}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {/* Bekannte zugewiesene Rollen */}\n                        {roles\n                          .filter(role => selectedRoles.includes(role.id))\n                          .map(role => {\n                            // Eine Rolle ist nur dann nicht entfernbar, wenn es sich um die Admin-Rolle (ID: 1) fr den Admin-Benutzer (ID: 1) handelt\n                            const isFixedRole = role.id === 1 && selectedUser && selectedUser.id === 1;\n                            return (\n                              <div \n                                key={role.id} \n                                className={`border rounded-lg p-4 ${isFixedRole ? 'border-green-500 bg-green-50 dark:bg-green-900/20 dark:border-green-700 cursor-not-allowed' : 'border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 cursor-pointer'}`}\n                                onClick={() => !isFixedRole && toggleRole(role.id)}\n                              >\n                                <div className=\"flex justify-between items-center\">\n                                  <div>\n                                    <h4 className=\"font-medium flex items-center dark:text-white\">\n                                      {role.name}\n                                      {isFixedRole && (\n                                        <span className=\"ml-2 text-xs bg-green-600 text-white px-2 py-0.5 rounded-full\">\n                                          {t('roleAssignment.fixed')}\n                                        </span>\n                                      )}\n                                    </h4>\n                                    <p className=\"text-sm text-gray-600 dark:text-gray-400\">{role.description}</p>\n                                  </div>\n                                  <div className={`flex items-center ${isFixedRole ? 'text-gray-400 dark:text-gray-500' : 'text-blue-600 dark:text-blue-400'}`}>\n                                    <span className=\"mr-2 text-sm\">{isFixedRole ? t('roleAssignment.fixedAssigned') : t('roleAssignment.remove')}</span>\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </div>\n                                </div>\n                              </div>\n                            );\n                          })}\n                        \n                        {/* Unbekannte zugewiesene Rollen */}\n                        {selectedRoles\n                          .filter(roleId => !roles.some(role => role.id === roleId))\n                          .map(roleId => (\n                            <div \n                              key={`unknown-${roleId}`} \n                              className=\"border border-orange-500 bg-orange-50 rounded-lg p-4\"\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{t('roleAssignment.unknownRole', { id: roleId })}</h4>\n                                  <p className=\"text-sm text-orange-600\">{t('roleAssignment.unknownRoleDescription')}</p>\n                                </div>\n                                <div className=\"flex items-center text-orange-600\">\n                                  <span className=\"mr-2 text-sm\">{t('roleAssignment.remove')}</span>\n                                  <button \n                                    onClick={() => toggleRole(roleId)}\n                                    className=\"focus:outline-none\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </button>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Verfgbare Rollen */}\n                  <div>\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('roleAssignment.availableRoles')}</h4>\n                    {roles.filter(role => !selectedRoles.includes(role.id)).length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('roleAssignment.noRolesAvailable')}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {roles\n                          .filter(role => !selectedRoles.includes(role.id))\n                          .map(role => (\n                            <div \n                              key={role.id} \n                              className=\"border border-gray-300 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50\"\n                              onClick={() => toggleRole(role.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{role.name}</h4>\n                                  <p className=\"text-sm text-gray-600\">{role.description}</p>\n                                </div>\n                                <div className=\"flex items-center text-gray-500 hover:text-blue-600\">\n                                  <span className=\"mr-2 text-sm\">{t('roleAssignment.add')}</span>\n                                  <PlusIcon className=\"h-5 w-5\" />\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Branches Tab */}\n          {activeUserTab === 'branches' && (\n              <div className=\"p-6\">\n              {/* Branch-Zuweisung - nur anzeigen, wenn Branches geladen wurden */}\n              {loadingBranches ? (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('branchAssignment.title') || 'Niederlassungszuweisung'}</h3>\n                  <p className=\"dark:text-gray-300\">{t('branchAssignment.loading') || 'Lade Niederlassungen...'}</p>\n                </div>\n              ) : branches.length > 0 && (\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('branchAssignment.title') || 'Niederlassungszuweisung'}</h3>\n                  \n                  {/* berprfung auf unbekannte Branches */}\n                  {selectedBranches.some(branchId => !branches.some(branch => branch.id === branchId)) && (\n                    <div className=\"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4\">\n                      <p className=\"font-bold\">{t('branchAssignment.unknownBranchesWarning') || 'Unbekannte Niederlassungen zugewiesen'}</p>\n                      <p>{t('branchAssignment.unknownBranchesMessage', { ids: selectedBranches.filter(branchId => !branches.some(branch => branch.id === branchId)).join(', ') }) || `Die folgenden Niederlassungs-IDs sind zugewiesen, aber nicht verfgbar: ${selectedBranches.filter(branchId => !branches.some(branch => branch.id === branchId)).join(', ')}`}</p>\n                      <p className=\"mt-2 text-sm\">{t('branchAssignment.availableBranchIds', { ids: branches.map(b => b.id).join(', ') }) || `Verfgbare Niederlassungs-IDs: ${branches.map(b => b.id).join(', ')}`}</p>\n                    </div>\n                  )}\n                  \n                  {/* Aktuell zugewiesene Branches */}\n                  <div className=\"mb-4\">\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('branchAssignment.currentBranches') || 'Aktuell zugewiesene Niederlassungen'}</h4>\n                    {selectedBranches.length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('branchAssignment.noBranchesAssigned') || 'Keine Niederlassungen zugewiesen'}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {/* Bekannte zugewiesene Branches */}\n                        {branches\n                          .filter(branch => selectedBranches.includes(branch.id))\n                          .map(branch => (\n                            <div \n                              key={branch.id} \n                              className=\"border border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 rounded-lg p-4 cursor-pointer\"\n                              onClick={() => toggleBranch(branch.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium dark:text-white\">\n                                    {branch.name}\n                                  </h4>\n                                </div>\n                                <div className=\"flex items-center text-blue-600 dark:text-blue-400\">\n                                  <span className=\"mr-2 text-sm\">{t('branchAssignment.remove') || 'Entfernen'}</span>\n                                  <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                  </svg>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                        \n                        {/* Unbekannte zugewiesene Branches */}\n                        {selectedBranches\n                          .filter(branchId => !branches.some(branch => branch.id === branchId))\n                          .map(branchId => (\n                            <div \n                              key={`unknown-${branchId}`} \n                              className=\"border border-orange-500 bg-orange-50 rounded-lg p-4\"\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{t('branchAssignment.unknownBranch', { id: branchId }) || `Unbekannte Niederlassung (ID: ${branchId})`}</h4>\n                                  <p className=\"text-sm text-orange-600\">{t('branchAssignment.unknownBranchDescription') || 'Diese Niederlassung existiert nicht mehr oder ist nicht verfgbar.'}</p>\n                                </div>\n                                <div className=\"flex items-center text-orange-600\">\n                                  <span className=\"mr-2 text-sm\">{t('branchAssignment.remove') || 'Entfernen'}</span>\n                                  <button \n                                    onClick={() => toggleBranch(branchId)}\n                                    className=\"focus:outline-none\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </button>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Verfgbare Branches */}\n                  <div>\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('branchAssignment.availableBranches') || 'Verfgbare Niederlassungen'}</h4>\n                    {branches.filter(branch => !selectedBranches.includes(branch.id)).length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('branchAssignment.noBranchesAvailable') || 'Keine weiteren Niederlassungen verfgbar'}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {branches\n                          .filter(branch => !selectedBranches.includes(branch.id))\n                          .map(branch => (\n                            <div \n                              key={branch.id} \n                              className=\"border border-gray-300 dark:border-gray-600 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20\"\n                              onClick={() => toggleBranch(branch.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium dark:text-white\">{branch.name}</h4>\n                                </div>\n                                <div className=\"flex items-center text-gray-500 hover:text-blue-600 dark:hover:text-blue-400\">\n                                  <span className=\"mr-2 text-sm\">{t('branchAssignment.add') || 'Hinzufgen'}</span>\n                                  <PlusIcon className=\"h-5 w-5\" />\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n              {!loadingBranches && branches.length === 0 && (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('branchAssignment.title') || 'Niederlassungszuweisung'}</h3>\n                  <p className=\"text-gray-500 dark:text-gray-400\">{t('branchAssignment.noBranchesFound') || 'Keine Niederlassungen gefunden'}</p>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Lebenszyklus Tab */}\n          {activeUserTab === 'lifecycle' && selectedUser && (\n              <div className=\"p-6\">\n            <LifecycleView \n              key={`lifecycle-${selectedUser.id}-${lifecycleRefreshKey}`}\n              userId={selectedUser.id} \n              userName={`${selectedUser.firstName} ${selectedUser.lastName}`}\n            />\n              </div>\n          )}\n          </div>\n        </div>\n      )}\n\n      {/* Sidepane/Modal fr Benutzererstellung */}\n      {isCreateModalOpen && (\n        <>\n          {/* Fr Mobile (unter 640px) - klassisches Modal */}\n          {isMobile ? (\n            <Dialog open={isCreateModalOpen} onClose={() => setIsCreateModalOpen(false)} className=\"relative z-50\">\n              <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n              \n              <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                  {/* Header */}\n                  <div className=\"px-6 py-4 border-b dark:border-gray-700\">\n                    <div className=\"flex items-center justify-between\">\n                      <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                        {t('organisation.createUser.title')}\n                      </Dialog.Title>\n                      <button\n                        onClick={() => setIsCreateModalOpen(false)}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                      >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                      </button>\n                    </div>\n                  </div>\n                  \n                  {/* Form */}\n                  <form onSubmit={handleCreateUser} className=\"p-6\">\n                    <div className=\"space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.email')} *\n                        </label>\n                        <input\n                          type=\"email\"\n                          name=\"email\"\n                          value={newUserFormData.email}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.password')} *\n                        </label>\n                        <input\n                          type=\"password\"\n                          name=\"password\"\n                          value={newUserFormData.password}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.firstName')} *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"firstName\"\n                          value={newUserFormData.firstName}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.lastName')} *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"lastName\"\n                          value={newUserFormData.lastName}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                    </div>\n                    \n                    {/* Footer */}\n                    <div className=\"mt-6 flex justify-end gap-3\">\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          onClick={() => setIsCreateModalOpen(false)}\n                          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                        >\n                          <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('common.cancel')}\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          type=\"submit\"\n                          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                        >\n                          <CheckIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('organisation.createUser.create')}\n                        </div>\n                      </div>\n                    </div>\n                  </form>\n                </Dialog.Panel>\n              </div>\n            </Dialog>\n          ) : (\n            // Fr Desktop (ab 640px) - Sidepane\n            // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n            <>\n              {/* Backdrop - nur wenn offen und <= 1070px */}\n              {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n              {isCreateModalOpen && !isLargeScreen && (\n                <div \n                  className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                  aria-hidden=\"true\" \n                  style={{\n                    opacity: isCreateModalOpen ? 1 : 0,\n                    transition: 'opacity 300ms ease-out'\n                  }}\n                />\n              )}\n              \n              {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n              <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isCreateModalOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                  transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                  pointerEvents: isCreateModalOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isCreateModalOpen}\n                role=\"dialog\"\n                aria-modal={isCreateModalOpen}\n              >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                  <h2 className=\"text-lg font-semibold dark:text-white\">\n                    {t('organisation.createUser.title')}\n                  </h2>\n                  <button\n                    onClick={() => setIsCreateModalOpen(false)}\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                <div className=\"flex flex-col flex-1 min-h-0\">\n                  <form onSubmit={handleCreateUser} className=\"flex flex-col flex-1 min-h-0\">\n                    <div className=\"p-4 overflow-y-auto flex-1 min-h-0 space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.email')} *\n                        </label>\n                      <input\n                        type=\"email\"\n                        name=\"email\"\n                        value={newUserFormData.email}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.password')} *\n                      </label>\n                      <input\n                        type=\"password\"\n                        name=\"password\"\n                        value={newUserFormData.password}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.firstName')} *\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"firstName\"\n                        value={newUserFormData.firstName}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.lastName')} *\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"lastName\"\n                        value={newUserFormData.lastName}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                      </div>\n                    </div>\n                    \n                    {/* Footer */}\n                    <div className=\"flex justify-end gap-3 border-t dark:border-gray-700 pt-4 px-4 flex-shrink-0\">\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          onClick={() => setIsCreateModalOpen(false)}\n                          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                        >\n                          <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('common.cancel')}\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          type=\"submit\"\n                          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                        >\n                          <CheckIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('organisation.createUser.create')}\n                        </div>\n                      </div>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default UserManagementTab; ","import React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { roleApi, branchApi } from '../api/apiClient.ts';\nimport { Role, AccessLevel } from '../types/interfaces.ts';\nimport { PencilIcon, TrashIcon, PlusIcon, FunnelIcon, XMarkIcon, CheckIcon, ArrowPathIcon, DocumentDuplicateIcon, ChevronDownIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { useFilterContext } from '../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { ErrorCategory } from '../services/ErrorHandler.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport { logger } from '../utils/logger.ts';\n\ninterface RoleManagementTabProps {\n  onRolesChange?: () => void;\n  onError?: (error: string) => void;\n  readOnly?: boolean;\n}\n\n// Definiere Seiten, die immer sichtbar sein sollen (ohne Berechtigungsprfung)\nconst alwaysVisiblePages = ['dashboard', 'worktracker', 'cerebro', 'settings', 'profile'];\n\n// ALLE SEITEN IM SYSTEM (synchron mit Backend)\nconst defaultPages = [\n  'dashboard',\n  'worktracker',\n  'consultations',\n  'team_worktime_control', // = workcenter\n  'payroll', // = lohnabrechnung\n  'organization_management', // = organisation (Hauptseite)\n  'cerebro',\n  'settings',\n  'profile',\n  'tour_management', // NEU: Touren-Verwaltung\n  'password_manager', // NEU: Passwort-Manager\n  'price_analysis' // NEU: Preisanalyse\n];\n\n// ALLE TABELLEN IM SYSTEM (synchron mit Backend)\nconst defaultTables = [\n  'requests',           // auf dashboard\n  'tasks',             // auf worktracker\n  'reservations',      // auf worktracker (in To Do's Box)\n  'users',             // auf organization_management\n  'roles',             // auf organization_management\n  'organization',      // auf organization_management\n  'organization_join_requests', // auf organization_management\n  'organization_users',  // auf organization_management\n  'team_worktime',     // auf team_worktime_control\n  'worktime',          // auf worktracker\n  'clients',           // auf consultations\n  'consultation_invoices', // auf consultations\n  'branches',          // auf settings/system\n  'notifications',     // allgemein\n  'settings',          // auf settings\n  'monthly_reports',    // auf consultations/reports\n  'tours',             // NEU: auf tour_management\n  'tour_bookings',     // NEU: auf tour_management\n  'ota_listings',      // NEU: auf price_analysis\n  'price_analyses',    // NEU: auf price_analysis\n  'price_recommendations', // NEU: auf price_analysis\n  'pricing_rules',     // NEU: auf price_analysis\n  'rate_shopping_jobs' // NEU: auf price_analysis\n];\n\n// ALLE BUTTONS IM SYSTEM (synchron mit Backend)\nconst defaultButtons = [\n  // Database Management Buttons (Settings/System)\n  'database_reset_table',\n  'database_logs',\n  \n  // Invoice Functions Buttons\n  'invoice_create',\n  'invoice_download', \n  'invoice_mark_paid',\n  'invoice_settings',\n  \n  // Todo/Task Buttons (Worktracker)\n  'todo_create',\n  'todo_edit',\n  'todo_delete',\n  'task_create',\n  'task_edit', \n  'task_delete',\n  \n  // User Management Buttons\n  'user_create',\n  'user_edit',\n  'user_delete',\n  'role_assign',\n  'role_create',\n  'role_edit',\n  'role_delete',\n  \n  // Organization Management Buttons\n  'organization_create',\n  'organization_edit',\n  'organization_delete',\n  \n  // Worktime Buttons\n  'worktime_start',\n  'worktime_stop', \n  'worktime_edit',\n  'worktime_delete',\n  \n  // General Cerebro Button\n  'cerebro',\n  \n  // Consultation Buttons\n  'consultation_start',\n  'consultation_stop',\n  'consultation_edit',\n  \n  // Client Management Buttons\n  'client_create',\n  'client_edit',\n  'client_delete',\n  \n  // Settings Buttons\n  'settings_system',\n  'settings_notifications',\n  'settings_profile',\n  \n  // Payroll Buttons\n  'payroll_generate',\n  'payroll_export',\n  'payroll_edit',\n  \n  // Tour Management Buttons\n  'tour_create',\n  'tour_edit',\n  'tour_delete',\n  'tour_view',\n  'tour_booking_create',\n  'tour_booking_edit',\n  'tour_booking_cancel',\n  'tour_provider_create',\n  'tour_provider_edit',\n  'tour_provider_delete',\n  \n  // Password Manager Buttons\n  'password_entry_create',\n  'password_entry_edit',\n  'password_entry_delete',\n  \n  // Price Analysis Buttons\n  'price_analysis_create_rule',\n  'price_analysis_edit_rule',\n  'price_analysis_delete_rule',\n  'price_analysis_apply_recommendation',\n  'price_analysis_reject_recommendation',\n  'price_analysis_run_rate_shopping'\n];\n\n// Definiert die Zuordnung von Tabellen zu ihren bergeordneten Seiten\nconst tableToPageMapping = {\n  'requests': 'dashboard',\n  'tasks': 'worktracker',\n  'reservations': 'worktracker',\n  'users': 'organization_management',\n  'roles': 'organization_management',\n  'organization': 'organization_management',\n  'organization_join_requests': 'organization_management',\n  'organization_users': 'organization_management',\n  'team_worktime': 'team_worktime_control',\n  'worktime': 'worktracker',\n  'clients': 'consultations',\n  'consultation_invoices': 'consultations',\n  'branches': 'settings',\n  'notifications': 'general',\n  'settings': 'settings',\n  'monthly_reports': 'consultations',\n  'tours': 'tour_management',\n  'tour_bookings': 'tour_management',\n  'ota_listings': 'price_analysis',\n  'price_analyses': 'price_analysis',\n  'price_recommendations': 'price_analysis',\n  'pricing_rules': 'price_analysis',\n  'rate_shopping_jobs': 'price_analysis'\n};\n\n// Definiert die Zuordnung von Buttons zu ihren bergeordneten Seiten/Bereichen\nconst buttonToPageMapping = {\n  'database_reset_table': 'settings',\n  'database_logs': 'settings',\n  'invoice_create': 'consultations',\n  'invoice_download': 'consultations',\n  'invoice_mark_paid': 'consultations',\n  'invoice_settings': 'consultations',\n  'todo_create': 'worktracker',\n  'todo_edit': 'worktracker',\n  'todo_delete': 'worktracker',\n  'task_create': 'worktracker',\n  'task_edit': 'worktracker',\n  'task_delete': 'worktracker',\n  'user_create': 'organization_management',\n  'user_edit': 'organization_management',\n  'user_delete': 'organization_management',\n  'role_assign': 'organization_management',\n  'role_create': 'organization_management',\n  'role_edit': 'organization_management',\n  'role_delete': 'organization_management',\n  'organization_create': 'organization_management',\n  'organization_edit': 'organization_management',\n  'organization_delete': 'organization_management',\n  'worktime_start': 'worktracker',\n  'worktime_stop': 'worktracker',\n  'worktime_edit': 'worktracker',\n  'worktime_delete': 'worktracker',\n  'cerebro': 'cerebro',\n  'consultation_start': 'consultations',\n  'consultation_stop': 'consultations',\n  'consultation_edit': 'consultations',\n  'client_create': 'consultations',\n  'client_edit': 'consultations',\n  'client_delete': 'consultations',\n  'settings_system': 'settings',\n  'settings_notifications': 'settings',\n  'settings_profile': 'settings',\n  'payroll_generate': 'payroll',\n  'payroll_export': 'payroll',\n  'payroll_edit': 'payroll',\n  'tour_create': 'tour_management',\n  'tour_edit': 'tour_management',\n  'tour_delete': 'tour_management',\n  'tour_view': 'tour_management',\n  'tour_booking_create': 'tour_management',\n  'tour_booking_edit': 'tour_management',\n  'tour_booking_cancel': 'tour_management',\n  'tour_provider_create': 'tour_management',\n  'tour_provider_edit': 'tour_management',\n  'tour_provider_delete': 'tour_management',\n  'password_entry_create': 'password_manager',\n  'password_entry_edit': 'password_manager',\n  'password_entry_delete': 'password_manager',\n  'price_analysis_create_rule': 'price_analysis',\n  'price_analysis_edit_rule': 'price_analysis',\n  'price_analysis_delete_rule': 'price_analysis',\n  'price_analysis_apply_recommendation': 'price_analysis',\n  'price_analysis_reject_recommendation': 'price_analysis',\n  'price_analysis_run_rate_shopping': 'price_analysis'\n};\n\n// Definiert die Zuordnung von Buttons zu ihren zugehrigen Tabellen\nconst buttonToTableMapping: Record<string, string | null> = {\n  // Worktime Buttons  worktime Tabelle\n  'worktime_start': 'worktime',\n  'worktime_stop': 'worktime',\n  'worktime_edit': 'worktime',\n  'worktime_delete': 'worktime',\n  // Task/Todo Buttons  tasks Tabelle\n  'task_create': 'tasks',\n  'task_edit': 'tasks',\n  'task_delete': 'tasks',\n  'todo_create': 'tasks',\n  'todo_edit': 'tasks',\n  'todo_delete': 'tasks',\n  // Client Buttons  clients Tabelle\n  'client_create': 'clients',\n  'client_edit': 'clients',\n  'client_delete': 'clients',\n  'consultation_start': 'clients',\n  'consultation_stop': 'clients',\n  'consultation_edit': 'clients',\n  // Invoice Buttons  consultation_invoices Tabelle\n  'invoice_create': 'consultation_invoices',\n  'invoice_download': 'consultation_invoices',\n  'invoice_mark_paid': 'consultation_invoices',\n  'invoice_settings': 'consultation_invoices',\n  // User Management Buttons  users/roles Tabellen\n  'user_create': 'users',\n  'user_edit': 'users',\n  'user_delete': 'users',\n  'role_assign': 'roles',\n  'role_create': 'roles',\n  'role_edit': 'roles',\n  'role_delete': 'roles',\n  // Organization Management Buttons  organization Tabelle\n  'organization_create': 'organization',\n  'organization_edit': 'organization',\n  'organization_delete': 'organization',\n  // Settings Buttons  settings Tabelle\n  'settings_system': 'settings',\n  'settings_notifications': 'settings',\n  'settings_profile': 'settings',\n  // Tour Management Buttons  tours/tour_bookings Tabellen\n  'tour_create': 'tours',\n  'tour_edit': 'tours',\n  'tour_delete': 'tours',\n  'tour_view': 'tours',\n  'tour_booking_create': 'tour_bookings',\n  'tour_booking_edit': 'tour_bookings',\n  'tour_booking_cancel': 'tour_bookings',\n  'tour_provider_create': null, // Keine direkte Tabelle\n  'tour_provider_edit': null,\n  'tour_provider_delete': null,\n  // Password Manager Buttons  keine direkte Tabelle (entry-level permissions)\n  'password_entry_create': null,\n  'password_entry_edit': null,\n  'password_entry_delete': null,\n  // Price Analysis Buttons  entsprechende Tabellen\n  'price_analysis_create_rule': 'pricing_rules',\n  'price_analysis_edit_rule': 'pricing_rules',\n  'price_analysis_delete_rule': 'pricing_rules',\n  'price_analysis_apply_recommendation': 'price_recommendations',\n  'price_analysis_reject_recommendation': 'price_recommendations',\n  'price_analysis_run_rate_shopping': 'rate_shopping_jobs',\n  // Buttons ohne direkte Tabelle-Zuordnung\n  'database_reset_table': null,\n  'database_logs': null,\n  'cerebro': null,\n  'payroll_generate': null,\n  'payroll_export': null,\n  'payroll_edit': null\n};\n\n// Display-Name-Mapping fr Seiten (DB-Interne Bezeichnung  Frontend-Bezeichnung)\n// Wird dynamisch aus bersetzungen geladen\n\n// Display-Name-Mapping fr Tabellen (DB-Interne Bezeichnung  Frontend-Bezeichnung)\n// Wird dynamisch aus bersetzungen geladen\n\n// Display-Name-Mapping fr Buttons wird dynamisch in der Komponente geladen\n\n// TableID fr gespeicherte Filter\nconst ROLES_TABLE_ID = 'roles-table';\n\n// Standardrollen-IDs (fr Rollen ohne Organisation)\nconst STANDARD_ROLE_IDS = [1, 2, 999]; // Admin (1), User (2), Hamburger (999)\n\n// Standardrollen-Namen (drfen nicht bearbeitet/gelscht werden, egal von welcher Organisation)\nconst STANDARD_ROLE_NAMES = ['Admin', 'User', 'Hamburger'];\n\n// Helper-Funktion zur Prfung ob es sich um eine Standardrolle handelt\nconst isStandardRole = (roleId: number, roleName?: string): boolean => {\n  // Prfe zuerst auf Standard-IDs (fr Rollen ohne Organisation)\n  if (STANDARD_ROLE_IDS.includes(roleId)) {\n    return true;\n  }\n  // Prfe auf Standard-Namen (fr Rollen in Organisationen)\n  if (roleName && STANDARD_ROLE_NAMES.includes(roleName)) {\n    return true;\n  }\n  return false;\n};\n\ninterface RoleFormData {\n  name: string;\n  description: string;\n  permissions: {\n    entity: string;\n    entityType: string;\n    accessLevel: AccessLevel;\n  }[];\n}\n\n\n// RoleCard-Komponente fr mobile Ansicht\nconst RoleCard: React.FC<{\n  role: Role;\n  onEdit: (role: Role) => void;\n  onDelete: (roleId: number) => void;\n  onCopy: (role: Role) => void;\n  canEdit: boolean;\n  canDelete: boolean;\n  canCopy: boolean;\n}> = ({ role, onEdit, onDelete, onCopy, canEdit, canDelete, canCopy }) => {\n  const { t } = useTranslation();\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4 mb-4\">\n      {/* Header mit Rollenname und Aktionen */}\n      <div className=\"flex justify-between items-start mb-2\">\n        <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{role.name}</h3>\n        \n        <div className=\"flex space-x-2\">\n          {canCopy && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => onCopy(role)}\n                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n              >\n                <DocumentDuplicateIcon className=\"h-5 w-5\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('roles.actions.copy')}\n              </div>\n            </div>\n          )}\n          \n          {canEdit && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => onEdit(role)}\n                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n              >\n                <PencilIcon className=\"h-5 w-5\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('roles.actions.edit')}\n              </div>\n            </div>\n          )}\n          \n          {canDelete && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => onDelete(role.id)}\n                className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n              >\n                <TrashIcon className=\"h-5 w-5\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('roles.actions.delete')}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n      \n      {/* Beschreibung */}\n      <p className=\"text-sm text-gray-600 dark:text-gray-400\">{role.description || t('roles.noDescription')}</p>\n      \n      {/* Branch-Zuweisungen */}\n      <div className=\"mt-2\">\n        <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n          {role.allBranches ? (\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300\">\n              {t('roles.form.allBranches') || 'Alle Branches'}\n            </span>\n          ) : role.branches && role.branches.length > 0 ? (\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300\">\n              {role.branches.length} {t('roles.form.specificBranches') || 'Branches'}\n            </span>\n          ) : (\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400\">\n              {t('roles.form.noBranches') || 'Keine Branches'}\n            </span>\n          )}\n        </span>\n      </div>\n      \n      {/* Berechtigungen - kompakt */}\n      <div className=\"mt-2\">\n        <h4 className=\"text-sm font-medium text-gray-900 dark:text-white mb-1\">{t('roles.permissions')}:</h4>\n        <div className=\"flex flex-wrap gap-1\">\n          {role.permissions\n            .filter(perm => perm.accessLevel !== 'none') // Nur relevante Berechtigungen anzeigen\n            .slice(0, 8) // Begrenze die Anzahl der angezeigten Berechtigungen\n            .map(permission => (\n              <span \n                key={`${permission.entity}-${permission.entityType}`}\n                className=\"text-xs bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 px-2 py-1 rounded\"\n              >\n                {permission.entity}: {permission.accessLevel}\n              </span>\n            ))}\n          {role.permissions.filter(perm => perm.accessLevel !== 'none').length > 8 && (\n            <span className=\"text-xs bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-300 px-2 py-1 rounded\">\n                +{role.permissions.filter(perm => perm.accessLevel !== 'none').length - 8} {t('common.showMore')}\n            </span>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst RoleManagementTab: React.FC<RoleManagementTabProps> = ({ onRolesChange, onError, readOnly = false }) => {\n  const { t } = useTranslation();\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [editingRole, setEditingRole] = useState<Role | null>(null);\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loading, setLoading] = useState(true);\n  \n  // Display-Name-Mapping fr Seiten (dynamisch aus bersetzungen)\n  const pageDisplayNames = useMemo(() => ({\n    'dashboard': t('roles.pages.dashboard'),\n    'worktracker': t('roles.pages.worktracker'),\n    'consultations': t('roles.pages.consultations'),\n    'team_worktime_control': t('roles.pages.team_worktime_control'),\n    'payroll': t('roles.pages.payroll'),\n    'organization_management': t('roles.pages.organization_management'), // Organisation-Seite (Hauptseite)\n    'cerebro': t('roles.pages.cerebro'),\n    'settings': t('roles.pages.settings'),\n    'profile': t('roles.pages.profile'),\n    'tour_management': t('roles.pages.tour_management', 'Touren-Verwaltung'),\n    'password_manager': t('roles.pages.password_manager', 'Passwort-Manager')\n  }), [t]);\n\n  // Display-Name-Mapping fr Tabellen (dynamisch aus bersetzungen)\n  const tableDisplayNames = useMemo(() => ({\n    'tasks': t('roles.tables.tasks'),\n    'reservations': t('roles.tables.reservations'),\n    'worktime': t('roles.tables.worktime'),\n    'users': t('roles.tables.users'),\n    'roles': t('roles.tables.roles'),\n    'organization': t('roles.tables.organization'),\n    'organization_join_requests': t('roles.tables.organization_join_requests'),\n    'organization_users': t('roles.tables.organization_users'),\n    'clients': t('roles.tables.clients'),\n    'consultation_invoices': t('roles.tables.consultation_invoices'),\n    'requests': t('roles.tables.requests'),\n    'team_worktime': t('roles.tables.team_worktime'),\n    'settings': t('roles.tables.settings'),\n    'notifications': t('roles.tables.notifications'),\n    'branches': t('roles.tables.branches'),\n    'monthly_reports': t('roles.tables.monthly_reports'),\n    'tours': t('roles.tables.tours', 'Touren'),\n    'tour_bookings': t('roles.tables.tour_bookings', 'Tour-Buchungen')\n  }), [t]);\n\n  // Display-Name-Mapping fr Buttons (dynamisch aus bersetzungen)\n  const buttonDisplayNames = useMemo(() => ({\n    'worktime_start': t('roles.buttons.worktime_start'),\n    'worktime_stop': t('roles.buttons.worktime_stop'),\n    'worktime_edit': t('roles.buttons.worktime_edit'),\n    'worktime_delete': t('roles.buttons.worktime_delete'),\n    'task_create': t('roles.buttons.task_create'),\n    'task_edit': t('roles.buttons.task_edit'),\n    'task_delete': t('roles.buttons.task_delete'),\n    'todo_create': t('roles.buttons.todo_create'),\n    'todo_edit': t('roles.buttons.todo_edit'),\n    'todo_delete': t('roles.buttons.todo_delete'),\n    'client_create': t('roles.buttons.client_create'),\n    'client_edit': t('roles.buttons.client_edit'),\n    'client_delete': t('roles.buttons.client_delete'),\n    'consultation_start': t('roles.buttons.consultation_start'),\n    'consultation_stop': t('roles.buttons.consultation_stop'),\n    'consultation_edit': t('roles.buttons.consultation_edit'),\n    'invoice_create': t('roles.buttons.invoice_create'),\n    'invoice_download': t('roles.buttons.invoice_download'),\n    'invoice_mark_paid': t('roles.buttons.invoice_mark_paid'),\n    'invoice_settings': t('roles.buttons.invoice_settings'),\n    'user_create': t('roles.buttons.user_create'),\n    'user_edit': t('roles.buttons.user_edit'),\n    'user_delete': t('roles.buttons.user_delete'),\n    'role_assign': t('roles.buttons.role_assign'),\n    'role_create': t('roles.buttons.role_create'),\n    'role_edit': t('roles.buttons.role_edit'),\n    'role_delete': t('roles.buttons.role_delete'),\n    'organization_create': t('roles.buttons.organization_create'),\n    'organization_edit': t('roles.buttons.organization_edit'),\n    'organization_delete': t('roles.buttons.organization_delete'),\n    'settings_system': t('roles.buttons.settings_system'),\n    'settings_notifications': t('roles.buttons.settings_notifications'),\n    'settings_profile': t('roles.buttons.settings_profile'),\n    'database_reset_table': t('roles.buttons.database_reset_table'),\n    'database_logs': t('roles.buttons.database_logs'),\n    'payroll_generate': t('roles.buttons.payroll_generate'),\n    'payroll_export': t('roles.buttons.payroll_export'),\n    'payroll_edit': t('roles.buttons.payroll_edit'),\n    'cerebro': t('roles.buttons.cerebro')\n  }), [t]);\n  const [formData, setFormData] = useState<RoleFormData>({\n    name: '',\n    description: '',\n    permissions: [\n      // Seiten-Berechtigungen\n      ...defaultPages.map(page => ({\n        entity: page,\n        entityType: 'page',\n        accessLevel: 'none' as AccessLevel\n      })),\n      // Tabellen-Berechtigungen\n      ...defaultTables.map(table => ({\n        entity: table,\n        entityType: 'table',\n        accessLevel: 'none' as AccessLevel\n      })),\n      // Button-Berechtigungen\n      ...defaultButtons.map(button => ({\n        entity: button,\n        entityType: 'button',\n        accessLevel: 'none' as AccessLevel\n      }))\n    ]\n  });\n  const [error, setError] = useState<string | null>(null);\n  const { hasPermission } = usePermissions();\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n  \n  // States fr Branch-Zuweisungen\n  const [allBranches, setAllBranches] = useState<boolean>(true);\n  const [selectedBranchIds, setSelectedBranchIds] = useState<number[]>([]);\n  const [branches, setBranches] = useState<Array<{ id: number; name: string }>>([]);\n  const [loadingBranches, setLoadingBranches] = useState(false);\n  \n  // Neue State-Variablen fr erweiterte Filterbedingungen\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  // Responsiveness Hook (640px wie Standard)\n  const [isMobile, setIsMobile] = useState<boolean>(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  \n  // Fehlerbehandlung mit Fallback - useRef fr stabile onError-Referenz\n  const onErrorRef = useRef(onError);\n  useEffect(() => {\n    onErrorRef.current = onError;\n  }, [onError]);\n\n  const errorContext = useError();\n  const handleError = useCallback((err: any, context?: Record<string, any>) => {\n    if (errorContext?.handleError) {\n      errorContext.handleError(err, context);\n    } else {\n      console.error('Fehler:', err, context);\n      if (onErrorRef.current) {\n        onErrorRef.current(err?.message || 'Ein Fehler ist aufgetreten');\n      }\n    }\n  }, [errorContext]);\n\n  const handleValidationError = useCallback((message: string, fieldErrors?: Record<string, string>) => {\n    if (errorContext?.handleValidationError) {\n      errorContext.handleValidationError(message, fieldErrors);\n    } else {\n      console.error('Validierungsfehler:', message, fieldErrors);\n      if (onErrorRef.current) {\n        onErrorRef.current(message);\n      }\n    }\n  }, [errorContext]);\n  \n  // Neue State-Variablen fr die Berechtigungen\n  const [isAddPermissionModalOpen, setIsAddPermissionModalOpen] = useState(false);\n  const [selectedPermission, setSelectedPermission] = useState<string | null>(null);\n  const [displayLimit, setDisplayLimit] = useState<number>(10);\n  \n  // berwache Bildschirmgre\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isModalOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isModalOpen, openSidepane, closeSidepane]);\n\n  // Funktion zum Laden der Branches\n  const fetchBranches = useCallback(async () => {\n    setLoadingBranches(true);\n    try {\n      const response = await branchApi.getAll();\n      setBranches(response.data);\n    } catch (error) {\n      console.error('Fehler beim Laden der Branches:', error);\n    } finally {\n      setLoadingBranches(false);\n    }\n  }, []);\n\n  // Aktualisiere die fetchRoles-Funktion, um den neuen ErrorHandler zu nutzen\n  const fetchRoles = useCallback(async () => {\n    setLoading(true);\n    logger.log('DEBUGAUSGABE: Hole Rollen vom Server...');\n    \n    try {\n      const response = await roleApi.getAll();\n      logger.log('DEBUGAUSGABE: Rollen erfolgreich geholt:', response.data);\n      setRoles(response.data);\n      setError(null);\n    } catch (error) {\n      console.error('DEBUGAUSGABE: Fehler beim Abrufen der Rollen:', error);\n      // Nutze den neuen ErrorHandler\n      handleError(error, { \n        component: 'RoleManagementTab', \n        action: 'fetchRoles' \n      });\n      // Rufe auch den bergebenen onError auf, falls vorhanden\n      if (onError) {\n        onError('Fehler beim Laden der Rollen');\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [handleError]);\n\n  //  ENTFERNT: Direkt Rollen laden - wird jetzt durch Standard-Pattern gemacht (nach Default-Filter-Anwendung)\n\n  // Branches beim ffnen des Modals laden\n  useEffect(() => {\n    if (isModalOpen) {\n      fetchBranches();\n    }\n  }, [isModalOpen, fetchBranches]);\n\n  // Speichern einer Rolle\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n\n    // Validierung: Wenn allBranches = false, mssen Branches ausgewhlt sein\n    if (!allBranches && selectedBranchIds.length === 0) {\n      handleError(t('roles.form.branchSelectionRequired') || 'Bitte whlen Sie mindestens eine Branch aus oder aktivieren Sie \"Fr alle Branches gltig\"', {\n        component: 'RoleManagementTab'\n      });\n      return;\n    }\n    \n    if (!formData.name) {\n      handleValidationError('Rollenname darf nicht leer sein', { name: 'Rollenname ist erforderlich' });\n      return;\n    }\n    \n    if (editingRole) {\n      // Stelle sicher, dass die immer sichtbaren Seiten auch tatschlich auf 'both' gesetzt sind\n      const updatedPermissions = formData.permissions.map(permission => {\n        if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n          return { ...permission, accessLevel: 'both' };\n        }\n        return permission;\n      });\n      \n      // Filtere nur die relevanten Berechtigungen (nicht 'none')\n      const filteredPermissions = updatedPermissions\n        .filter(permission => permission.accessLevel !== 'none')\n        .map(permission => ({\n          entity: permission.entity,\n          entityType: permission.entityType,\n          accessLevel: permission.accessLevel\n        }));\n      \n      if (!editingRole.id || isNaN(editingRole.id)) {\n        console.warn('DEBUGAUSGABE: Ungltige Rollen-ID erkannt, Bearbeitung abgebrochen');\n        handleError('Ungltige Rollen-ID, Bearbeitung abgebrochen', { \n          component: 'RoleManagementTab',\n          roleId: editingRole.id\n        });\n        return;\n      }\n      \n      // berprfen, ob es sich um eine geschtzte Rolle handelt\n      if (isStandardRole(editingRole.id, editingRole.name)) {\n        console.warn(`DEBUGAUSGABE: Versuch, geschtzte Rolle mit ID ${editingRole.id} zu bearbeiten`);\n        handleError({\n          message: 'Geschtzte Systemrollen knnen nicht bearbeitet werden',\n          name: 'PermissionError'\n        }, {\n          component: 'RoleManagementTab',\n          roleId: editingRole.id,\n          category: ErrorCategory.PERMISSION\n        });\n        setIsModalOpen(false);\n        return;\n      }\n      \n      // berprfen, ob die Rolle noch in der aktuellen Liste existiert\n      const roleExists = roles.some(r => r.id === editingRole.id);\n      if (!roleExists) {\n        console.error(`DEBUGAUSGABE: Rolle mit ID ${editingRole.id} existiert nicht in der aktuellen Liste`);\n        handleError(`Rolle mit ID ${editingRole.id} existiert nicht mehr. Bitte aktualisieren Sie die Seite.`, {\n          component: 'RoleManagementTab',\n          roleId: editingRole.id\n        });\n        setIsModalOpen(false);\n        // Rollen neu laden, um die Anzeige zu aktualisieren\n        await fetchRoles();\n        return;\n      }\n      \n      logger.log(`DEBUGAUSGABE: Bearbeite Rolle mit ID ${editingRole.id}`);\n      \n      try {\n        logger.log('DEBUGAUSGABE: Sende Aktualisierung an API:', {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        });\n        \n        const dataToSend = {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions,\n          allBranches: allBranches,\n          branchIds: allBranches ? [] : selectedBranchIds\n        };\n        \n        logger.log('DEBUGAUSGABE: Vor dem API-Aufruf roleApi.update');\n        const response = await roleApi.update(editingRole.id, dataToSend);\n        logger.log('DEBUGAUSGABE: Nach dem API-Aufruf roleApi.update');\n        logger.log('DEBUGAUSGABE: API-Antwort bei Rollenaktualisierung:', response);\n        await fetchRoles();\n      } catch (updateError) {\n        console.error('DEBUGAUSGABE: Fehler bei Rollenaktualisierung:', updateError);\n        if (updateError.response) {\n          // Spezifischere Fehlerbehandlung\n          if (updateError.response.data.meta && updateError.response.data.meta.cause === \"Record to update not found.\") {\n            handleError('Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.', {\n              component: 'RoleManagementTab',\n              roleId: editingRole.id\n            });\n            setIsModalOpen(false);\n            // Rollenliste aktualisieren, um Frontend zu synchronisieren\n            await fetchRoles();\n          } else {\n            handleError(updateError.response.data.message || 'Fehler beim Aktualisieren der Rolle', {\n              component: 'RoleManagementTab',\n              roleId: editingRole.id\n            });\n          }\n        } else {\n          handleError('Fehler beim Aktualisieren der Rolle', {\n            component: 'RoleManagementTab',\n            roleId: editingRole.id\n          });\n        }\n        return;\n      }\n    } else {\n      // Erstellen einer neuen Rolle\n      try {\n        // Stelle sicher, dass die immer sichtbaren Seiten auch tatschlich auf 'both' gesetzt sind\n        const updatedPermissions = formData.permissions.map(permission => {\n          if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n            return { ...permission, accessLevel: 'both' };\n          }\n          return permission;\n        });\n        \n        // Filtere nur die relevanten Berechtigungen (nicht 'none')\n        const filteredPermissions = updatedPermissions\n          .filter(permission => permission.accessLevel !== 'none')\n          .map(permission => ({\n            entity: permission.entity,\n            entityType: permission.entityType,\n            accessLevel: permission.accessLevel\n          }));\n        \n        logger.log('DEBUGAUSGABE: Sende Daten an API fr neue Rolle:', {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        });\n        \n        const dataToSend = {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions,\n          allBranches: allBranches,\n          branchIds: allBranches ? [] : selectedBranchIds\n        };\n        \n        logger.log('DEBUGAUSGABE: Vor dem API-Aufruf roleApi.create');\n        const response = await roleApi.create(dataToSend);\n        logger.log('DEBUGAUSGABE: Nach dem API-Aufruf roleApi.create');\n        logger.log('DEBUGAUSGABE: API-Antwort beim Erstellen der Rolle:', response);\n        await fetchRoles();\n      } catch (createError) {\n        console.error('DEBUGAUSGABE: Fehler bei API-Anfrage zum Erstellen der Rolle:', createError);\n        if (createError.response) {\n          handleError(createError.response.data.message || 'Fehler beim Erstellen der Rolle', {\n            component: 'RoleManagementTab'\n          });\n        } else {\n          handleError('Fehler beim Erstellen der Rolle', {\n            component: 'RoleManagementTab'\n          });\n        }\n        return;\n      }\n    }\n    \n    if (onRolesChange) onRolesChange();\n    \n    setIsModalOpen(false);\n    resetForm();\n  };\n\n  // Lschen einer Rolle\n  const handleDelete = async (roleId: number) => {\n    if (!roleId || isNaN(roleId)) {\n      console.warn('Ungltige Rollen-ID erkannt, Lschvorgang abgebrochen');\n      handleError('Ungltige Rollen-ID, Lschvorgang abgebrochen', {\n        component: 'RoleManagementTab',\n        roleId: roleId\n      });\n      return;\n    }\n    \n    // Finde die Rolle in der Liste, um den Namen zu prfen\n    const role = roles.find(r => r.id === roleId);\n    \n    // berprfen, ob es sich um eine geschtzte Rolle handelt\n    if (role && isStandardRole(roleId, role.name)) {\n      console.warn(`Versuch, geschtzte Rolle mit ID ${roleId} (${role.name}) zu lschen`);\n      handleError('Geschtzte Systemrollen knnen nicht gelscht werden', {\n        component: 'RoleManagementTab',\n        roleId: roleId\n      });\n      return;\n    }\n    \n    if (!window.confirm('Mchten Sie diese Rolle wirklich lschen?')) return;\n    \n    try {\n      logger.log(`Starte Lschvorgang fr Rolle mit ID ${roleId}`);\n      \n      // berprfen, ob die Rolle in der aktuellen Liste existiert\n      const roleExists = roles.some(r => r.id === roleId);\n      if (!roleExists) {\n        console.error(`Rolle mit ID ${roleId} existiert nicht in der aktuellen Liste`);\n        handleError(`Rolle mit ID ${roleId} existiert nicht mehr. Bitte aktualisieren Sie die Seite.`, {\n          component: 'RoleManagementTab',\n          roleId: roleId\n        });\n        // Rollen neu laden, um die Anzeige zu aktualisieren\n        await fetchRoles();\n        return;\n      }\n      \n      // Bei Mock-Daten lokales Lschen (wird nicht verwendet)\n      if (false) {\n        logger.log('Lsche Mock-Rolle');\n        const updatedRoles = roles.filter(role => role.id !== roleId);\n        setRoles(updatedRoles);\n      } else {\n        logger.log('Sende Lschanfrage an API');\n        \n        try {\n          const response = await roleApi.delete(roleId);\n          logger.log('API-Antwort beim Lschen der Rolle:', response);\n          \n          // Nach erfolgreichem Lschen die Rollenliste aktualisieren\n          await fetchRoles();\n          logger.log('Rollenliste nach Lschen aktualisiert');\n        } catch (deleteError) {\n          console.error('API-Fehler beim Lschen der Rolle:', deleteError);\n          \n          if (deleteError.response) {\n            console.error('API-Fehlerdaten:', deleteError.response.data);\n            \n            // Spezifischere Fehlerbehandlung\n            if (deleteError.response.data.meta && deleteError.response.data.meta.cause === \"Record to delete does not exist.\") {\n              handleError('Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.', {\n                component: 'RoleManagementTab',\n                roleId: roleId\n              });\n              // Rollenliste aktualisieren, um Frontend zu synchronisieren\n              await fetchRoles();\n            } else {\n              handleError(deleteError.response.data.message || t('roleManagement.deleteError'), {\n                component: 'RoleManagementTab',\n                roleId: roleId\n              });\n            }\n          } else {\n            handleError(t('roleManagement.networkError'), {\n              component: 'RoleManagementTab',\n              roleId: roleId\n            });\n          }\n          return;\n        }\n      }\n      \n      logger.log('Rolle erfolgreich gelscht');\n      if (onRolesChange) onRolesChange();\n    } catch (err) {\n      console.error(t('roleManagement.unhandledError'), err);\n      handleError(err);\n      \n      // Bei einem unbehandelten Fehler trotzdem versuchen, die Rollenliste zu aktualisieren\n      try {\n        await fetchRoles();\n      } catch (refreshError) {\n        console.error('Fehler beim Aktualisieren der Rollenliste nach fehlgeschlagenem Lschvorgang:', refreshError);\n      }\n    }\n  };\n\n  // Kopieren einer Rolle (fr Standardrollen)\n  const handleCopyRole = async (role: Role) => {\n    try {\n      if (!role || !role.id) {\n        handleError('Ungltige Rolle zum Kopieren', {\n          component: 'RoleManagementTab'\n        });\n        return;\n      }\n\n      // Kopie der Rolle erstellen mit angepasstem Namen\n      const copiedRoleData = {\n        name: `${role.name}-Kopie`,\n        description: role.description || '',\n        permissions: role.permissions\n          .filter(permission => permission.accessLevel !== 'none')\n          .map(permission => ({\n            entity: permission.entity,\n            entityType: permission.entityType,\n            accessLevel: permission.accessLevel\n          }))\n      };\n\n      logger.log('DEBUGAUSGABE: Kopiere Rolle:', role.name, 'mit Daten:', copiedRoleData);\n\n      // Rolle erstellen\n      const response = await roleApi.create(copiedRoleData);\n      logger.log('DEBUGAUSGABE: Rolle erfolgreich kopiert:', response.data);\n\n      // Optimistisches Update: Neue Rolle zur Liste hinzufgen\n      setRoles(prevRoles => [response.data, ...prevRoles]);\n      \n      // Bearbeitungsmodal fr die kopierte Rolle ffnen\n      prepareRoleForEditing(response.data);\n      \n      if (onRolesChange) onRolesChange();\n    } catch (err) {\n      console.error('DEBUGAUSGABE: Fehler beim Kopieren der Rolle:', err);\n      handleError(err, {\n        component: 'RoleManagementTab',\n        roleId: role.id\n      });\n    }\n  };\n\n  // Rolle zum Bearbeiten vorbereiten\n  const prepareRoleForEditing = async (role: Role) => {\n    // Verhindere das Bearbeiten von geschtzten Rollen\n    if (isStandardRole(role.id, role.name)) {\n      handleError('Geschtzte Systemrollen knnen nicht bearbeitet werden', {\n        component: 'RoleManagementTab',\n        roleId: role.id\n      });\n      return;\n    }\n    \n    // Alle mglichen Berechtigungen erstellen (Seiten, Tabellen und Buttons)\n    const allPermissions = [\n      ...defaultPages.map(page => ({\n        entity: page,\n        entityType: 'page',\n        // Fr die immer sichtbaren Seiten 'both' als Standard setzen\n        accessLevel: alwaysVisiblePages.includes(page) ? 'both' as AccessLevel : 'none' as AccessLevel\n      })),\n      ...defaultTables.map(table => ({\n        entity: table,\n        entityType: 'table',\n        accessLevel: 'none' as AccessLevel\n      })),\n      ...defaultButtons.map(button => ({\n        entity: button,\n        entityType: 'button',\n        accessLevel: 'none' as AccessLevel\n      }))\n    ];\n\n    // Vorhandene Berechtigungen bernehmen\n    role.permissions.forEach(permission => {\n      const existingPermIndex = allPermissions.findIndex(\n        p => p.entity === permission.entity && p.entityType === permission.entityType\n      );\n      \n      if (existingPermIndex !== -1) {\n        // Stelle sicher, dass alwaysVisiblePages immer 'both' als AccessLevel haben\n        if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n          allPermissions[existingPermIndex].accessLevel = 'both';\n        } else {\n          allPermissions[existingPermIndex].accessLevel = permission.accessLevel;\n        }\n      }\n    });\n\n    setFormData({\n      name: role.name,\n      description: role.description || '',\n      permissions: allPermissions\n    });\n    \n    // Lade Branch-Zuweisungen der Rolle\n    if (role.id) {\n      try {\n        const branchResponse = await roleApi.getRoleBranches(role.id);\n        const branchData = branchResponse.data;\n        setAllBranches(branchData.allBranches || false);\n        setSelectedBranchIds(branchData.branches?.map((b: any) => b.id) || []);\n      } catch (error) {\n        console.error('Fehler beim Laden der Branch-Zuweisungen:', error);\n        setAllBranches(true);\n        setSelectedBranchIds([]);\n      }\n    }\n    \n    setEditingRole(role);\n    setIsModalOpen(true);\n  };\n\n  // Formular fr neue Rolle zurcksetzen\n  const resetForm = () => {\n    setEditingRole(null);\n    setAllBranches(true);\n    setSelectedBranchIds([]);\n    setFormData({\n      name: '',\n      description: '',\n      permissions: [\n        // Seiten-Berechtigungen\n        ...defaultPages.map(page => ({\n          entity: page,\n          entityType: 'page',\n          // Fr die immer sichtbaren Seiten 'both' als Standard setzen\n          accessLevel: alwaysVisiblePages.includes(page) ? 'both' as AccessLevel : 'none' as AccessLevel\n        })),\n        // Tabellen-Berechtigungen\n        ...defaultTables.map(table => ({\n          entity: table,\n          entityType: 'table',\n          accessLevel: 'none' as AccessLevel\n        })),\n        // Button-Berechtigungen\n        ...defaultButtons.map(button => ({\n          entity: button,\n          entityType: 'button',\n          accessLevel: 'none' as AccessLevel\n        }))\n      ]\n    });\n  };\n\n  // Setzt alle Seitenberechtigungen (auer die immer sichtbaren) auf den gleichen Wert\n  const setAllPagePermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'page' && !alwaysVisiblePages.includes(p.entity))\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Setzt alle Tabellen-Berechtigungen auf den gleichen Wert\n  const setAllTablePermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'table')\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Setzt alle Button-Berechtigungen auf den gleichen Wert\n  const setAllButtonPermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'button')\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Funktion zum Zhlen der aktiven Filter\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  // Filtern und sortieren der Rollen\n  const filteredAndSortedRoles = useMemo(() => {\n    return roles\n      .filter(role => {\n        // Globale Suche\n        if (searchTerm) {\n          const searchLower = searchTerm.toLowerCase();\n          \n          //  OPTIMIERUNG: Frhes Beenden bei Match\n          if (role.name.toLowerCase().includes(searchLower)) return true;\n          if (role.description && role.description.toLowerCase().includes(searchLower)) return true;\n          \n          return false; // Kein Match gefunden\n        }\n        \n        // Prfe erweiterte Filterbedingungen, wenn vorhanden\n        if (filterConditions.length > 0) {\n          // Implementiere die logische Verknpfung der Bedingungen (UND/ODER)\n          let result = filterConditions.length > 0;\n          \n          for (let i = 0; i < filterConditions.length; i++) {\n            const condition = filterConditions[i];\n            let conditionMet = false;\n            \n            switch (condition.column) {\n              case 'name':\n                //  OPTIMIERUNG: toLowerCase() nur einmal pro Wert\n                const roleNameLower = role.name.toLowerCase();\n                const nameConditionValueLower = (condition.value as string || '').toLowerCase();\n                if (condition.operator === 'equals') {\n                  conditionMet = roleNameLower === nameConditionValueLower;\n                } else if (condition.operator === 'contains') {\n                  conditionMet = roleNameLower.includes(nameConditionValueLower);\n                } else if (condition.operator === 'startsWith') {\n                  conditionMet = roleNameLower.startsWith(nameConditionValueLower);\n                }\n                break;\n\n              case 'description':\n                if (!role.description) {\n                  conditionMet = false;\n                  break;\n                }\n\n                //  OPTIMIERUNG: toLowerCase() nur einmal pro Wert\n                const roleDescLower = role.description.toLowerCase();\n                const descConditionValueLower = (condition.value as string || '').toLowerCase();\n                if (condition.operator === 'equals') {\n                  conditionMet = roleDescLower === descConditionValueLower;\n                } else if (condition.operator === 'contains') {\n                  conditionMet = roleDescLower.includes(descConditionValueLower);\n                } else if (condition.operator === 'startsWith') {\n                  conditionMet = roleDescLower.startsWith(descConditionValueLower);\n                }\n                break;\n              \n              case 'permissions':\n                // Vereinfachter Filter fr Berechtigungen - zhle die Anzahl der Berechtigungen mit dem angegebenen Level\n                const accessLevel = condition.value as AccessLevel;\n                const count = role.permissions.filter(p => p.accessLevel === accessLevel).length;\n                \n                if (condition.operator === 'greaterThan') {\n                  conditionMet = count > 0;\n                } else if (condition.operator === 'equals') {\n                  conditionMet = count > 0;\n                }\n                break;\n            }\n            \n            // Verknpfe das Ergebnis dieser Bedingung mit dem Gesamtergebnis\n            if (i === 0) {\n              result = conditionMet;\n            } else {\n              const operator = filterLogicalOperators[i - 1];\n              result = operator === 'AND' ? (result && conditionMet) : (result || conditionMet);\n            }\n          }\n          \n          if (!result) return false;\n        }\n        \n        return true;\n      })\n      .sort((a, b) => {\n        //  OPTIMIERUNG: toLowerCase() fr konsistente Sortierung\n        return a.name.toLowerCase().localeCompare(b.name.toLowerCase());\n      });\n  }, [roles, searchTerm, filterConditions, filterLogicalOperators]);\n\n  // Mobile Ansicht renderRoles-Funktion\n  const renderRoles = () => {\n    if (roles.length === 0) {\n      return (\n        <div className=\"p-4 bg-gray-50 rounded text-center\">\n          <p>Keine Rollen gefunden. Erstellen Sie eine neue Rolle mit dem Button oben.</p>\n        </div>\n      );\n    }\n    \n    if (isMobile) {\n      // Mobile Ansicht mit Karten\n      return (\n        <>\n          <div className=\"space-y-4\">\n            {filteredAndSortedRoles.slice(0, displayLimit).map((role) => (\n              <RoleCard \n                key={role.id} \n                role={role} \n                onEdit={prepareRoleForEditing}\n                onDelete={handleDelete}\n                onCopy={handleCopyRole}\n                canEdit={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canDelete={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canCopy={!readOnly && hasPermission('roles', 'write', 'table') && isStandardRole(role.id, role.name)}\n              />\n            ))}\n          </div>\n          \n          {/* \"Mehr anzeigen\" Button - Mobil */}\n          {filteredAndSortedRoles.length > displayLimit && (\n            <div className=\"mt-4 flex justify-center\">\n              <div className=\"relative group\">\n                <button\n                  className=\"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                  onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                >\n                  <ChevronDownIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {`Mehr anzeigen (${filteredAndSortedRoles.length - displayLimit} verbleibend)`}\n                </div>\n              </div>\n            </div>\n          )}\n        </>\n      );\n    } else {\n      // Card-Ansicht fr grere Bildschirme\n      return (\n        <>\n          <div className=\"space-y-4\">\n            {filteredAndSortedRoles.slice(0, displayLimit).map((role) => (\n              <RoleCard \n                key={role.id} \n                role={role} \n                onEdit={prepareRoleForEditing}\n                onDelete={handleDelete}\n                onCopy={handleCopyRole}\n                canEdit={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canDelete={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canCopy={!readOnly && hasPermission('roles', 'write', 'table') && isStandardRole(role.id, role.name)}\n              />\n            ))}\n          </div>\n          \n          {/* \"Mehr anzeigen\" Button - Desktop */}\n          {filteredAndSortedRoles.length > displayLimit && (\n            <div className=\"mt-4 flex justify-center\">\n              <div className=\"relative group\">\n                <button\n                  className=\"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                  onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                >\n                  <ChevronDownIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {`Mehr anzeigen (${filteredAndSortedRoles.length - displayLimit} verbleibend)`}\n                </div>\n              </div>\n            </div>\n          )}\n        </>\n      );\n    }\n  };\n\n  // Standard-Filter erstellen und speichern\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(ROLES_TABLE_ID)\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        const alleFilterExists = existingFilters.some(filter => filter.name === 'Alle');\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: ROLES_TABLE_ID,\n            name: 'Alle',\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\n            alleFilter\n          );\n          logger.log('Alle-Filter fr Rollen erstellt');\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []);\n\n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  // Funktion zum Anwenden von Filterbedingungen\n  const applyFilterConditions = useCallback((conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  }, []);\n  \n  // Funktion zum Zurcksetzen der Filter\n  const resetFilterConditions = useCallback(() => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  }, []);\n  \n  // Filter Change Handler (Controlled Mode) - VOR useEffect definiert\n  const handleFilterChange = useCallback(async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  }, [applyFilterConditions]);\n  \n  useEffect(() => {\n    const initialize = async () => {\n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(ROLES_TABLE_ID);\n      \n      // 2. Default-Filter anwenden (IMMER vorhanden!)\n      const defaultFilter = filters.find(f => f.name === 'Alle');\n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        }\n      \n      // 3. Rollen laden (immer, auch mit Default-Filter)\n      await fetchRoles();\n    };\n    \n    initialize();\n  }, [loadFilters, handleFilterChange, fetchRoles]);\n\n  return (\n    <div>\n      {/* Spaltenanzeige und Suche */}\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          {/* Linke Seite: \"Neue Rolle erstellen\"-Button */}\n          <div className=\"flex items-center\">\n            {!readOnly && hasPermission('roles', 'write', 'table') && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsModalOpen(true)}\n                  className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                  style={{ width: '30.19px', height: '30.19px' }}\n                  aria-label={t('roles.createRole')}\n                >\n                  <PlusIcon className=\"h-4 w-4\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('roles.createRole')}\n                </div>\n              </div>\n            )}\n          </div>\n          \n          {/* Mitte: Titel - Kein Titel in der Mitte notwendig bei dieser Komponente, da der Tab-Header bereits den Titel zeigt */}\n          <div></div>\n          \n          {/* Rechte Seite: Suchfeld, Filter-Button, Spalten-Konfiguration */}\n          <div className=\"flex items-center gap-1.5\">\n            <input\n              type=\"text\"\n              placeholder=\"Suchen...\"\n              className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n            <div className=\"relative group ml-1\">\n              <button\n                className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100'}`}\n                onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n              >\n                <FunnelIcon className=\"w-5 h-5\" />\n                {getActiveFilterCount() > 0 && (\n                  <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                    {getActiveFilterCount()}\n                  </span>\n                )}\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                Filter\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Filter-Modal */}\n        {isFilterModalOpen && (\n          <FilterPane\n            columns={[\n              { id: 'name', label: 'Name' },\n              { id: 'description', label: 'Beschreibung' },\n              { id: 'permissions', label: 'Berechtigungen' }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={ROLES_TABLE_ID}\n          />\n        )}\n        \n        {/* Gespeicherte Filter als Tags anzeigen */}\n        <SavedFilterTags\n          tableId={ROLES_TABLE_ID}\n          onSelectFilter={applyFilterConditions}\n          onReset={resetFilterConditions}\n          activeFilterName={activeFilterName}\n          selectedFilterId={selectedFilterId}\n          onFilterChange={handleFilterChange}\n          defaultFilterName=\"Alle\"\n        />\n\n        {loading ? (\n          <div className=\"flex justify-center items-center py-8\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n          </div>\n        ) : (\n          renderRoles()\n        )}\n      </div>\n\n      {/* Modal/Sidepane fr Rollenerstellung/Bearbeitung */}\n      {isModalOpen && (\n        <>\n          {/* Mobile (unter 640px) - Modal */}\n          {isMobile ? (\n            <Dialog open={isModalOpen} onClose={() => setIsModalOpen(false)} className=\"relative z-50\">\n              <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n              \n              <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden\">\n                  {/* Header */}\n                  <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <div className=\"flex items-center justify-between\">\n                      <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                        {editingRole ? t('roles.editRole') : t('roles.createRole')}\n                      </Dialog.Title>\n                      <button\n                        onClick={() => setIsModalOpen(false)}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                      >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                      </button>\n                    </div>\n                  </div>\n                  \n                  {/* Form */}\n                  <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\n                    {/* Content - scrollbarer Bereich */}\n                    <div className=\"flex-1 overflow-y-auto min-h-0\">\n                      <div className=\"p-6 space-y-5\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Name</label>\n                  <input\n                    type=\"text\"\n                    value={formData.name}\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    required\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Beschreibung</label>\n                  <input\n                    type=\"text\"\n                    value={formData.description}\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n                  </div>\n                  \n                  {/* Branch-Zuweisungen */}\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      {t('roles.form.branchAssignment') || 'Branch-Zuweisung'}\n                    </label>\n                    <div className=\"space-y-3\">\n                      <label className=\"flex items-center\">\n                        <input\n                          type=\"checkbox\"\n                          checked={allBranches}\n                          onChange={(e) => {\n                            setAllBranches(e.target.checked);\n                            if (e.target.checked) {\n                              setSelectedBranchIds([]);\n                            }\n                          }}\n                          className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                        />\n                        <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                          {t('roles.form.allBranches') || 'Fr alle Branches gltig'}\n                        </span>\n                      </label>\n                      \n                      {!allBranches && (\n                        <div className=\"ml-6\">\n                          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                            {t('roles.form.specificBranches') || 'Spezifische Branches:'}\n                          </label>\n                          {loadingBranches ? (\n                            <div className=\"text-sm text-gray-500\">Lade Branches...</div>\n                          ) : branches.length === 0 ? (\n                            <div className=\"text-sm text-gray-500\">Keine Branches verfgbar</div>\n                          ) : (\n                            <div className=\"space-y-2 max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2\">\n                              {branches.map((branch) => (\n                                <label key={branch.id} className=\"flex items-center\">\n                                  <input\n                                    type=\"checkbox\"\n                                    checked={selectedBranchIds.includes(branch.id)}\n                                    onChange={(e) => {\n                                      if (e.target.checked) {\n                                        setSelectedBranchIds([...selectedBranchIds, branch.id]);\n                                      } else {\n                                        setSelectedBranchIds(selectedBranchIds.filter(id => id !== branch.id));\n                                      }\n                                    }}\n                                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                                  />\n                                  <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                                    {branch.name}\n                                  </span>\n                                </label>\n                              ))}\n                            </div>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  \n                  <div className=\"mt-2\">\n                    <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.detailedPermissions')}</label>\n                        {/* Bulk Actions - kompakt integriert */}\n                        <div className=\"flex flex-wrap items-center gap-1.5\">\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllPagePermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800\"\n                            >\n                              {t('roles.form.pagesChecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.activateAllPages')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllPagePermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              {t('roles.form.pagesUnchecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.deactivateAllPages')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllTablePermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800\"\n                            >\n                              {t('roles.form.tablesChecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.activateAllTables')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllTablePermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              {t('roles.form.tablesUnchecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.deactivateAllTables')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllButtonPermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800\"\n                            >\n                              {t('roles.form.buttonsChecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.activateAllButtons')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllButtonPermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              {t('roles.form.buttonsUnchecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.deactivateAllButtons')}\n                            </div>\n                          </div>\n                        </div>\n                    </div>\n                    \n                    <div className=\"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600\">\n                    {formData.permissions\n                      .filter(permission => \n                        permission.entityType === 'page'\n                      )\n                      .map((permission, index) => {\n                        const permIndex = formData.permissions.indexOf(permission);\n                        const isActive = permission.accessLevel === 'both';\n                        return (\n                          <div key={`permission-page-${permission.entity}-${index}`}>\n                            <div className=\"flex items-center justify-between\">\n                              <span className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">{pageDisplayNames[permission.entity] || permission.entity}</span>\n                              <label className={`inline-flex items-center ${alwaysVisiblePages.includes(permission.entity) ? 'cursor-not-allowed opacity-80' : 'cursor-pointer'}`}>\n                                <input\n                                  type=\"checkbox\"\n                                  className=\"sr-only peer\"\n                                  checked={isActive}\n                                  disabled={alwaysVisiblePages.includes(permission.entity)}\n                                  onChange={() => {\n                                    const newPermissions = [...formData.permissions];\n                                    newPermissions[permIndex] = {\n                                      ...permission,\n                                      accessLevel: isActive ? 'none' : 'both'\n                                    };\n                                    setFormData({ ...formData, permissions: newPermissions });\n                                  }}\n                                />\n                                <div className={`relative w-11 h-6 ${alwaysVisiblePages.includes(permission.entity) ? 'bg-blue-600 dark:bg-blue-700' : 'bg-gray-200 dark:bg-gray-700'} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700`}>\n                                  {alwaysVisiblePages.includes(permission.entity) && (\n                                    <span className=\"absolute inset-0 flex items-center justify-center text-xs text-white font-medium\">\n                                      Fix\n                                    </span>\n                                  )}\n                                </div>\n                              </label>\n                            </div>\n                            \n                            {/* Tabellen-Berechtigungen mit zugehrigen Buttons gruppiert */}\n                            {formData.permissions\n                              .filter(tablePerm => \n                                tablePerm.entityType === 'table' && \n                                tableToPageMapping[tablePerm.entity] === permission.entity\n                              )\n                              .sort((a, b) => {\n                                const aName = tableDisplayNames[a.entity] || a.entity;\n                                const bName = tableDisplayNames[b.entity] || b.entity;\n                                // Sortierung: users, roles, organization zuerst (in dieser Reihenfolge)\n                                const priorityOrder = ['users', 'roles', 'organization'];\n                                const aIndex = priorityOrder.indexOf(a.entity);\n                                const bIndex = priorityOrder.indexOf(b.entity);\n                                if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                if (aIndex !== -1) return -1;\n                                if (bIndex !== -1) return 1;\n                                return aName.localeCompare(bName);\n                              })\n                              .map((tablePerm, tableIndex) => {\n                                const tablePermIndex = formData.permissions.indexOf(tablePerm);\n                                const isTableActive = tablePerm.accessLevel === 'both';\n                                const tableEntity = tablePerm.entity;\n                                const tableDisplayName = tableDisplayNames[tableEntity] || tableEntity;\n                                \n                                // Finde alle Buttons, die zu dieser Tabelle gehren\n                                // Filtere Duplikate: task_* und todo_* sind dasselbe, nur task_* behalten\n                                const relatedButtons = formData.permissions\n                                  .filter(buttonPerm => \n                                    buttonPerm.entityType === 'button' && \n                                    buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                    buttonToTableMapping[buttonPerm.entity] === tableEntity &&\n                                    // Entferne todo_* Buttons wenn task_* existiert (sind dasselbe)\n                                    !(tableEntity === 'tasks' && buttonPerm.entity.startsWith('todo_'))\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = buttonDisplayNames[a.entity] || a.entity;\n                                    const bName = buttonDisplayNames[b.entity] || b.entity;\n                                    // Logische Reihenfolge: Start, Stop, Erstellen, Bearbeiten, Lschen, dann alphabetisch\n                                    const order = [\n                                      t('roleManagement.buttonOrder.start'),\n                                      t('roleManagement.buttonOrder.stop'),\n                                      t('roleManagement.buttonOrder.create'),\n                                      t('roleManagement.buttonOrder.edit'),\n                                      t('roleManagement.buttonOrder.delete')\n                                    ];\n                                    const aIndex = order.indexOf(aName);\n                                    const bIndex = order.indexOf(bName);\n                                    if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                    if (aIndex !== -1) return -1;\n                                    if (bIndex !== -1) return 1;\n                                    return aName.localeCompare(bName);\n                                  });\n                                \n                                return (\n                                  <div key={`table-permission-${tableEntity}-${tableIndex}`} className=\"mt-3\">\n                                    {/* Tabelle selbst */}\n                                    <div className=\"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600\">\n                                      <span className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\"> {tableDisplayName}</span>\n                                      <label className=\"inline-flex items-center cursor-pointer\">\n                                        <input\n                                          type=\"checkbox\"\n                                          className=\"sr-only peer\"\n                                          checked={isTableActive}\n                                          onChange={() => {\n                                            const newPermissions = [...formData.permissions];\n                                            newPermissions[tablePermIndex] = {\n                                              ...tablePerm,\n                                              accessLevel: isTableActive ? 'none' : 'both'\n                                            };\n                                            setFormData({ ...formData, permissions: newPermissions });\n                                          }}\n                                        />\n                                        <div className=\"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                        </div>\n                                      </label>\n                                    </div>\n                                    \n                                    {/* Zu dieser Tabelle gehrige Buttons */}\n                                    {relatedButtons.map((buttonPerm, buttonIndex) => {\n                                      const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                      const isButtonActive = buttonPerm.accessLevel === 'both';\n                                      const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                      return (\n                                        <div key={`button-permission-${buttonPerm.entity}-${buttonIndex}`} \n                                          className=\"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600\">\n                                          <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                          <label className=\"inline-flex items-center cursor-pointer\">\n                                            <input\n                                              type=\"checkbox\"\n                                              className=\"sr-only peer\"\n                                              checked={isButtonActive}\n                                              onChange={() => {\n                                                const newPermissions = [...formData.permissions];\n                                                newPermissions[buttonPermIndex] = {\n                                                  ...buttonPerm,\n                                                  accessLevel: isButtonActive ? 'none' : 'both'\n                                                };\n                                                setFormData({ ...formData, permissions: newPermissions });\n                                              }}\n                                            />\n                                            <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                            </div>\n                                          </label>\n                                        </div>\n                                      );\n                                    })}\n                                  </div>\n                                );\n                              })\n                            }\n                              \n                              {/* Button-Berechtigungen ohne Tabelle-Zuordnung (am Ende) */}\n                              {formData.permissions\n                                .filter(buttonPerm => \n                                  buttonPerm.entityType === 'button' && \n                                  buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                  !buttonToTableMapping[buttonPerm.entity]\n                                )\n                                .sort((a, b) => {\n                                  const aName = buttonDisplayNames[a.entity] || a.entity;\n                                  const bName = buttonDisplayNames[b.entity] || b.entity;\n                                  return aName.localeCompare(bName);\n                                })\n                                .map((buttonPerm, buttonIndex) => {\n                                  const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                  const isButtonActive = buttonPerm.accessLevel === 'both';\n                                  const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                  return (\n                                    <div key={`button-permission-${buttonPerm.entity}-${buttonIndex}`} \n                                      className=\"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600\">\n                                      <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                      <label className=\"inline-flex items-center cursor-pointer\">\n                                        <input\n                                          type=\"checkbox\"\n                                          className=\"sr-only peer\"\n                                          checked={isButtonActive}\n                                          onChange={() => {\n                                            const newPermissions = [...formData.permissions];\n                                            newPermissions[buttonPermIndex] = {\n                                              ...buttonPerm,\n                                              accessLevel: isButtonActive ? 'none' : 'both'\n                                            };\n                                            setFormData({ ...formData, permissions: newPermissions });\n                                          }}\n                                        />\n                                        <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                        </div>\n                                      </label>\n                          </div>\n                        );\n                      })\n                    }\n                            </div>\n                          );\n                        })\n                      }\n                    </div>\n                  </div>\n                    </div>\n                  </div>\n                  \n                  {/* Footer */}\n                  <div className=\"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-end gap-2 border-t dark:border-gray-600 flex-shrink-0\">\n                    <div className=\"relative group\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setIsModalOpen(false)}\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                      >\n                        <XMarkIcon className=\"h-5 w-5\" />\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        Abbrechen\n                      </div>\n                    </div>\n                    <div className=\"relative group\">\n                      <button\n                        type=\"submit\"\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                      >\n                        <CheckIcon className=\"h-5 w-5\" />\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {editingRole ? 'Aktualisieren' : 'Erstellen'}\n                      </div>\n                    </div>\n                  </div>\n                </form>\n              </Dialog.Panel>\n            </div>\n          </Dialog>\n          ) : (\n            /* Desktop (ab 640px) - Sidepane */\n            /* WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition */\n            <>\n              {/* Backdrop - nur wenn offen und <= 1070px */}\n              {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n              {isModalOpen && !isLargeScreen && (\n                <div \n                  className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                  aria-hidden=\"true\" \n                  style={{\n                    opacity: isModalOpen ? 1 : 0,\n                    transition: 'opacity 300ms ease-out'\n                  }}\n                />\n              )}\n              \n              {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n              <div \n                className={`fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isModalOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                  transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                  pointerEvents: isModalOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isModalOpen}\n                role=\"dialog\"\n                aria-modal={isModalOpen}\n              >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                  <h2 className=\"text-lg font-semibold dark:text-white\">\n                    {editingRole ? 'Rolle bearbeiten' : 'Neue Rolle erstellen'}\n                  </h2>\n                  <button\n                    onClick={() => setIsModalOpen(false)}\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                  <form onSubmit={handleSubmit} className=\"space-y-5\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.name')}</label>\n                        <input\n                          type=\"text\"\n                          value={formData.name}\n                          onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                          className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.description')}</label>\n                        <input\n                          type=\"text\"\n                          value={formData.description}\n                          onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                          className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                        />\n                      </div>\n                    </div>\n                    \n                    <div className=\"mt-2\">\n                      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Detaillierte Berechtigungen</label>\n                        {/* Bulk Actions */}\n                        <div className=\"flex flex-wrap items-center gap-1.5\">\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllPagePermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800\"\n                            >\n                              Seiten \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Seiten aktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllPagePermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              Seiten \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Seiten deaktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllTablePermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800\"\n                            >\n                              Tabellen \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Tabellen aktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllTablePermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              Tabellen \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Tabellen deaktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllButtonPermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800\"\n                            >\n                              Buttons \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Buttons aktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllButtonPermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              Buttons \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Buttons deaktivieren\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                      \n                      <div className=\"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600 max-h-[60vh]\">\n                        {formData.permissions\n                          .filter(permission => \n                            permission.entityType === 'page'\n                          )\n                          .map((permission, index) => {\n                            const permIndex = formData.permissions.indexOf(permission);\n                            const isActive = permission.accessLevel === 'both';\n                            return (\n                              <div key={`permission-page-desktop-${permission.entity}-${index}`}>\n                                <div className=\"flex items-center justify-between\">\n                                  <span className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">{pageDisplayNames[permission.entity] || permission.entity}</span>\n                                  <label className={`inline-flex items-center ${alwaysVisiblePages.includes(permission.entity) ? 'cursor-not-allowed opacity-80' : 'cursor-pointer'}`}>\n                                    <input\n                                      type=\"checkbox\"\n                                      className=\"sr-only peer\"\n                                      checked={isActive}\n                                      disabled={alwaysVisiblePages.includes(permission.entity)}\n                                      onChange={() => {\n                                        const newPermissions = [...formData.permissions];\n                                        newPermissions[permIndex] = {\n                                          ...permission,\n                                          accessLevel: isActive ? 'none' : 'both'\n                                        };\n                                        setFormData({ ...formData, permissions: newPermissions });\n                                      }}\n                                    />\n                                    <div className={`relative w-11 h-6 ${alwaysVisiblePages.includes(permission.entity) ? 'bg-blue-600 dark:bg-blue-700' : 'bg-gray-200 dark:bg-gray-700'} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700`}>\n                                      {alwaysVisiblePages.includes(permission.entity) && (\n                                        <span className=\"absolute inset-0 flex items-center justify-center text-xs text-white font-medium\">\n                                          Fix\n                                        </span>\n                                      )}\n                                    </div>\n                                  </label>\n                                </div>\n                                \n                                {/* Tabellen-Berechtigungen mit zugehrigen Buttons gruppiert */}\n                                {formData.permissions\n                                  .filter(tablePerm => \n                                    tablePerm.entityType === 'table' && \n                                    tableToPageMapping[tablePerm.entity] === permission.entity\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = tableDisplayNames[a.entity] || a.entity;\n                                    const bName = tableDisplayNames[b.entity] || b.entity;\n                                    return aName.localeCompare(bName);\n                                  })\n                                  .map((tablePerm, tableIndex) => {\n                                    const tablePermIndex = formData.permissions.indexOf(tablePerm);\n                                    const isTableActive = tablePerm.accessLevel === 'both';\n                                    const tableEntity = tablePerm.entity;\n                                    const tableDisplayName = tableDisplayNames[tableEntity] || tableEntity;\n                                    \n                                    // Finde alle Buttons, die zu dieser Tabelle gehren\n                                    const relatedButtons = formData.permissions\n                                      .filter(buttonPerm => \n                                        buttonPerm.entityType === 'button' && \n                                        buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                        buttonToTableMapping[buttonPerm.entity] === tableEntity &&\n                                        !(tableEntity === 'tasks' && buttonPerm.entity.startsWith('todo_'))\n                                      )\n                                      .sort((a, b) => {\n                                        const aName = buttonDisplayNames[a.entity] || a.entity;\n                                        const bName = buttonDisplayNames[b.entity] || b.entity;\n                                        const order = [\n                                      t('roleManagement.buttonOrder.start'),\n                                      t('roleManagement.buttonOrder.stop'),\n                                      t('roleManagement.buttonOrder.create'),\n                                      t('roleManagement.buttonOrder.edit'),\n                                      t('roleManagement.buttonOrder.delete')\n                                    ];\n                                        const aIndex = order.indexOf(aName);\n                                        const bIndex = order.indexOf(bName);\n                                        if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                        if (aIndex !== -1) return -1;\n                                        if (bIndex !== -1) return 1;\n                                        return aName.localeCompare(bName);\n                                      });\n                                    \n                                    return (\n                                      <div key={`table-permission-desktop-${tableEntity}-${tableIndex}`} className=\"mt-3\">\n                                        {/* Tabelle selbst */}\n                                        <div className=\"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600\">\n                                          <span className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\"> {tableDisplayName}</span>\n                                          <label className=\"inline-flex items-center cursor-pointer\">\n                                            <input\n                                              type=\"checkbox\"\n                                              className=\"sr-only peer\"\n                                              checked={isTableActive}\n                                              onChange={() => {\n                                                const newPermissions = [...formData.permissions];\n                                                newPermissions[tablePermIndex] = {\n                                                  ...tablePerm,\n                                                  accessLevel: isTableActive ? 'none' : 'both'\n                                                };\n                                                setFormData({ ...formData, permissions: newPermissions });\n                                              }}\n                                            />\n                                            <div className=\"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                            </div>\n                                          </label>\n                                        </div>\n                                        \n                                        {/* Zu dieser Tabelle gehrige Buttons */}\n                                        {relatedButtons.map((buttonPerm, buttonIndex) => {\n                                          const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                          const isButtonActive = buttonPerm.accessLevel === 'both';\n                                          const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                          return (\n                                            <div key={`button-permission-desktop-${buttonPerm.entity}-${buttonIndex}`} \n                                              className=\"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600\">\n                                              <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                              <label className=\"inline-flex items-center cursor-pointer\">\n                                                <input\n                                                  type=\"checkbox\"\n                                                  className=\"sr-only peer\"\n                                                  checked={isButtonActive}\n                                                  onChange={() => {\n                                                    const newPermissions = [...formData.permissions];\n                                                    newPermissions[buttonPermIndex] = {\n                                                      ...buttonPerm,\n                                                      accessLevel: isButtonActive ? 'none' : 'both'\n                                                    };\n                                                    setFormData({ ...formData, permissions: newPermissions });\n                                                  }}\n                                                />\n                                                <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                                </div>\n                                              </label>\n                                            </div>\n                                          );\n                                        })}\n                                      </div>\n                                    );\n                                  })\n                                }\n                                  \n                                {/* Button-Berechtigungen ohne Tabelle-Zuordnung (am Ende) */}\n                                {formData.permissions\n                                  .filter(buttonPerm => \n                                    buttonPerm.entityType === 'button' && \n                                    buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                    !buttonToTableMapping[buttonPerm.entity]\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = buttonDisplayNames[a.entity] || a.entity;\n                                    const bName = buttonDisplayNames[b.entity] || b.entity;\n                                    return aName.localeCompare(bName);\n                                  })\n                                  .map((buttonPerm, buttonIndex) => {\n                                    const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                    const isButtonActive = buttonPerm.accessLevel === 'both';\n                                    const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                    return (\n                                      <div key={`button-permission-desktop-${buttonPerm.entity}-${buttonIndex}`} \n                                        className=\"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600\">\n                                        <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                        <label className=\"inline-flex items-center cursor-pointer\">\n                                          <input\n                                            type=\"checkbox\"\n                                            className=\"sr-only peer\"\n                                            checked={isButtonActive}\n                                            onChange={() => {\n                                              const newPermissions = [...formData.permissions];\n                                              newPermissions[buttonPermIndex] = {\n                                                ...buttonPerm,\n                                                accessLevel: isButtonActive ? 'none' : 'both'\n                                              };\n                                              setFormData({ ...formData, permissions: newPermissions });\n                                            }}\n                                          />\n                                          <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                          </div>\n                                        </label>\n                                      </div>\n                                    );\n                                  })\n                                }\n                              </div>\n                            );\n                          })\n                        }\n                      </div>\n                    </div>\n\n                    {/* Buttons */}\n                    <div className=\"flex justify-end pt-4 gap-2\">\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          onClick={() => setIsModalOpen(false)}\n                          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                        >\n                          <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          Abbrechen\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          type=\"submit\"\n                          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                        >\n                          <CheckIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {editingRole ? 'Aktualisieren' : 'Erstellen'}\n                        </div>\n                      </div>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default RoleManagementTab; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PencilIcon, CheckIcon, XMarkIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\n\ninterface RoomDescription {\n  text?: string;\n  imageUrl?: string;\n  videoUrl?: string;\n}\n\ninterface RoomDescriptionsSectionProps {\n  branchId: number;\n}\n\nconst RoomDescriptionsSection: React.FC<RoomDescriptionsSectionProps> = ({ branchId }) => {\n  const { t } = useTranslation();\n  const [roomDescriptions, setRoomDescriptions] = useState<Record<number, RoomDescription>>({});\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [editingCategoryId, setEditingCategoryId] = useState<number | null>(null);\n  const [editForm, setEditForm] = useState<RoomDescription>({ text: '', imageUrl: '', videoUrl: '' });\n  const [rooms, setRooms] = useState<Array<{ categoryId: number; roomName: string; roomType: 'compartida' | 'privada' }>>([]);\n  const [loadingRooms, setLoadingRooms] = useState(false);\n\n  // Lade Zimmer-Beschreibungen\n  const loadRoomDescriptions = async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.ROOM_DESCRIPTIONS(branchId));\n      setRoomDescriptions(response.data || {});\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Zimmer-Beschreibungen:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Lade Zimmer-Liste aus Reservierungen\n  const loadRooms = async () => {\n    try {\n      setLoadingRooms(true);\n      // Lade Reservierungen mit categoryId\n      const response = await axiosInstance.get(API_ENDPOINTS.RESERVATION.BASE, {\n        params: {\n          branchId: branchId,\n          limit: 1000 // Lade viele Reservierungen, um alle Zimmer zu finden\n        }\n      });\n      \n      // Extrahiere eindeutige categoryIds\n      const categoryMap = new Map<number, { roomName: string; roomType: 'compartida' | 'privada' }>();\n      \n      // Backend gibt data.data zurck (nicht data.reservations)\n      const reservations = response.data.data || [];\n      \n      reservations.forEach((reservation: any) => {\n        if (reservation.categoryId && reservation.roomNumber) {\n          // Bestimme roomType basierend auf roomNumber (Dorms enthalten \"(\")\n          const isDorm = reservation.roomNumber.includes('(');\n          const roomType = isDorm ? 'compartida' : 'privada';\n          \n          // Extrahiere Zimmername (fr Dorms: vor \"(\")\n          const roomName = isDorm \n            ? reservation.roomNumber.split('(')[0].trim()\n            : reservation.roomNumber;\n          \n          if (!categoryMap.has(reservation.categoryId)) {\n            categoryMap.set(reservation.categoryId, { roomName, roomType });\n          }\n        }\n      });\n      \n      // Konvertiere Map zu Array\n      const roomsArray = Array.from(categoryMap.entries()).map(([categoryId, data]) => ({\n        categoryId,\n        ...data\n      }));\n      \n      setRooms(roomsArray.sort((a, b) => a.roomName.localeCompare(b.roomName)));\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Zimmer:', error);\n    } finally {\n      setLoadingRooms(false);\n    }\n  };\n\n  useEffect(() => {\n    if (branchId) {\n      loadRoomDescriptions();\n      loadRooms();\n    }\n  }, [branchId]);\n\n  // Starte Bearbeitung\n  const handleEdit = (categoryId: number) => {\n    const description = roomDescriptions[categoryId] || { text: '', imageUrl: '', videoUrl: '' };\n    setEditForm(description);\n    setEditingCategoryId(categoryId);\n  };\n\n  // Speichere Beschreibung\n  const handleSave = async () => {\n    if (editingCategoryId === null) return;\n    \n    try {\n      setSaving(true);\n      const updatedDescriptions = {\n        ...roomDescriptions,\n        [editingCategoryId]: editForm\n      };\n      \n      await axiosInstance.put(\n        API_ENDPOINTS.BRANCHES.ROOM_DESCRIPTIONS(branchId),\n        { roomDescriptions: updatedDescriptions }\n      );\n      \n      // Lade Daten neu vom Backend, um sicherzustellen, dass sie korrekt gespeichert wurden\n      await loadRoomDescriptions();\n      \n      setEditingCategoryId(null);\n      setEditForm({ text: '', imageUrl: '', videoUrl: '' });\n    } catch (error: any) {\n      console.error('Fehler beim Speichern der Zimmer-Beschreibung:', error);\n      alert(t('branches.roomDescriptions.saveError', { defaultValue: 'Fehler beim Speichern der Beschreibung' }));\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  // Abbrechen\n  const handleCancel = () => {\n    setEditingCategoryId(null);\n    setEditForm({ text: '', imageUrl: '', videoUrl: '' });\n  };\n\n  if (loading || loadingRooms) {\n    return (\n      <div className=\"mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n          {t('common.loading', { defaultValue: 'Lade...' })}\n        </p>\n      </div>\n    );\n  }\n\n  if (rooms.length === 0) {\n    return (\n      <div className=\"mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n          {t('branches.roomDescriptions.noRooms', { \n            defaultValue: 'Keine Zimmer gefunden. Importieren Sie zuerst Reservierungen aus LobbyPMS.' \n          })}\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"mt-6 border-t border-gray-200 dark:border-gray-700 pt-6\">\n      <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n        {t('branches.roomDescriptions.title', { defaultValue: 'Zimmer-Beschreibungen' })}\n      </h5>\n      <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-4\">\n        {t('branches.roomDescriptions.description', { \n          defaultValue: 'Beschreibungen, wie man zu den Zimmern kommt. Diese werden in den Check-in-Nachrichten verwendet.' \n        })}\n      </p>\n      \n      <div className=\"space-y-4\">\n        {rooms.map((room) => {\n          const isEditing = editingCategoryId === room.categoryId;\n          const description = roomDescriptions[room.categoryId] || null;\n          \n          return (\n            <div\n              key={room.categoryId}\n              className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-white dark:bg-gray-800\"\n            >\n              <div className=\"flex items-start justify-between mb-2\">\n                <div>\n                  <h6 className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                    {room.roomName}\n                  </h6>\n                  <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                    {room.roomType === 'compartida' \n                      ? t('branches.roomDescriptions.dorm', { defaultValue: 'Dorm' })\n                      : t('branches.roomDescriptions.private', { defaultValue: 'Privatzimmer' })}\n                    {'  '}\n                    {t('branches.roomDescriptions.categoryId', { defaultValue: 'Category ID' })}: {room.categoryId}\n                  </span>\n                </div>\n                {!isEditing && (\n                  <button\n                    onClick={() => handleEdit(room.categoryId)}\n                    className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                    title={t('common.edit', { defaultValue: 'Bearbeiten' })}\n                  >\n                    <PencilIcon className=\"h-4 w-4\" />\n                  </button>\n                )}\n              </div>\n              \n              {isEditing ? (\n                <div className=\"space-y-3 mt-3\">\n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('branches.roomDescriptions.text', { defaultValue: 'Text' })}\n                    </label>\n                    <textarea\n                      value={editForm.text || ''}\n                      onChange={(e) => setEditForm({ ...editForm, text: e.target.value })}\n                      rows={3}\n                      placeholder={t('branches.roomDescriptions.textPlaceholder', { \n                        defaultValue: 'Beschreibung, wie man zum Zimmer kommt...' \n                      })}\n                      className=\"w-full text-sm rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white px-3 py-2\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('branches.roomDescriptions.imageUrl', { defaultValue: 'Bild-URL' })}\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={editForm.imageUrl || ''}\n                      onChange={(e) => setEditForm({ ...editForm, imageUrl: e.target.value })}\n                      placeholder=\"https://example.com/image.jpg\"\n                      className=\"w-full text-sm rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white px-3 py-2\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('branches.roomDescriptions.videoUrl', { defaultValue: 'Video-URL' })}\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={editForm.videoUrl || ''}\n                      onChange={(e) => setEditForm({ ...editForm, videoUrl: e.target.value })}\n                      placeholder=\"https://example.com/video.mp4\"\n                      className=\"w-full text-sm rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white px-3 py-2\"\n                    />\n                  </div>\n                  \n                  <div className=\"flex justify-end space-x-2\">\n                    <button\n                      onClick={handleCancel}\n                      disabled={saving}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50\"\n                      title={t('common.cancel', { defaultValue: 'Abbrechen' })}\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      onClick={handleSave}\n                      disabled={saving}\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 dark:bg-blue-500 dark:hover:bg-blue-600\"\n                      title={saving ? t('common.saving', { defaultValue: 'Speichere...' }) : t('common.save', { defaultValue: 'Speichern' })}\n                    >\n                      <CheckIcon className=\"h-5 w-5\" />\n                    </button>\n                  </div>\n                </div>\n              ) : (\n                <div className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\n                  {description ? (\n                    <div className=\"space-y-1\">\n                      {description.text && (\n                        <p>{description.text}</p>\n                      )}\n                      {description.imageUrl && (\n                        <p>\n                          <span className=\"font-medium\">{t('branches.roomDescriptions.image', { defaultValue: 'Bild' })}:</span>{' '}\n                          <a href={description.imageUrl} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 dark:text-blue-400 hover:underline\">\n                            {description.imageUrl}\n                          </a>\n                        </p>\n                      )}\n                      {description.videoUrl && (\n                        <p>\n                          <span className=\"font-medium\">{t('branches.roomDescriptions.video', { defaultValue: 'Video' })}:</span>{' '}\n                          <a href={description.videoUrl} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 dark:text-blue-400 hover:underline\">\n                            {description.videoUrl}\n                          </a>\n                        </p>\n                      )}\n                    </div>\n                  ) : (\n                    <p className=\"text-gray-400 dark:text-gray-500 italic\">\n                      {t('branches.roomDescriptions.noDescription', { defaultValue: 'Keine Beschreibung vorhanden' })}\n                    </p>\n                  )}\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default RoomDescriptionsSection;\n\n","import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { PencilIcon, TrashIcon, PlusIcon, XMarkIcon, CheckIcon, FunnelIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { useFilterContext } from '../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport RoomDescriptionsSection from './branches/RoomDescriptionsSection.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { logger } from '../utils/logger.ts';\n\ninterface Branch {\n    id: number;\n    name: string;\n    whatsappSettings?: any;\n    lobbyPmsSettings?: any;\n    boldPaymentSettings?: any;\n    doorSystemSettings?: any;\n    emailSettings?: any;\n}\n\ninterface BranchManagementTabProps {\n}\n\n// BranchCard-Komponente fr mobile und Desktop-Ansicht\nconst BranchCard: React.FC<{\n    branch: Branch;\n    onEdit: (branch: Branch) => void;\n    onDelete: (branchId: number) => void;\n    canEdit: boolean;\n    canDelete: boolean;\n}> = ({ branch, onEdit, onDelete, canEdit, canDelete }) => {\n    const { t } = useTranslation();\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4\">\n            {/* Header mit Branchname und Aktionen */}\n            <div className=\"flex justify-between items-start mb-2\">\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{branch.name}</h3>\n                \n                <div className=\"flex space-x-2\">\n                    {canEdit && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onEdit(branch)}\n                                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                            >\n                                <PencilIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.edit', { defaultValue: 'Bearbeiten' })}\n                            </div>\n                        </div>\n                    )}\n                    \n                    {canDelete && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onDelete(branch.id)}\n                                className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n                            >\n                                <TrashIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.delete', { defaultValue: 'Lschen' })}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\n// TableID fr gespeicherte Filter\nconst BRANCHES_TABLE_ID = 'branches-table';\n\nconst BranchManagementTab: React.FC<BranchManagementTabProps> = () => {\n    const { t } = useTranslation();\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [editingBranch, setEditingBranch] = useState<Branch | null>(null);\n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [formData, setFormData] = useState({ \n        name: '',\n        address: '',\n        city: '',\n        country: '',\n        whatsappSettings: {\n            provider: 'whatsapp-business-api' as 'twilio' | 'whatsapp-business-api',\n            apiKey: '',\n            apiSecret: '',\n            phoneNumberId: '',\n            ai: {\n                enabled: false,\n                model: 'gpt-4o',\n                systemPrompt: '',\n                rules: [] as string[],\n                sources: [] as string[],\n                temperature: 0.7,\n                maxTokens: 500\n            }\n        },\n        lobbyPmsSettings: {\n            apiUrl: '',\n            apiKey: '',\n            propertyId: '',\n            syncEnabled: true,\n            autoCreateTasks: false,\n            lateCheckInThreshold: '22:00',\n            notificationChannels: ['email'] as string[],\n            autoSendInvitation: false\n        },\n        boldPaymentSettings: {\n            apiKey: '',\n            merchantId: '',\n            environment: 'sandbox' as 'sandbox' | 'production'\n        },\n        doorSystemSettings: {\n            clientId: '',\n            clientSecret: '',\n            username: '',\n            password: '',\n            apiUrl: 'https://euopen.ttlock.com',\n            lockIds: [] as string[],\n            appName: 'TTLock'\n        },\n        emailSettings: {\n            smtpHost: '',\n            smtpPort: 587,\n            smtpUser: '',\n            smtpPass: '',\n            smtpFromEmail: '',\n            smtpFromName: '',\n            imap: {\n                enabled: false,\n                host: '',\n                port: 993,\n                secure: true,\n                user: '',\n                password: '',\n                folder: 'INBOX',\n                processedFolder: ''\n            }\n        },\n        messageTemplates: {\n            checkInInvitation: {\n                en: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                es: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                de: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                }\n            },\n            checkInConfirmation: {\n                en: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                es: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                de: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                }\n            }\n        },\n        autoSendReservationInvitation: false\n    });\n    const [activeSettingsTab, setActiveSettingsTab] = useState<'whatsapp' | 'lobbypms' | 'boldpayment' | 'doorsystem' | 'email' | 'messages'>('whatsapp');\n    const [showSecrets, setShowSecrets] = useState<Record<string, boolean>>({});\n    const [selectedTemplateType, setSelectedTemplateType] = useState<'checkInInvitation' | 'checkInConfirmation'>('checkInInvitation');\n    const [selectedLanguage, setSelectedLanguage] = useState<'en' | 'es' | 'de'>('en');\n    const [searchTerm, setSearchTerm] = useState('');\n    const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n    const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n    const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [activeFilterName, setActiveFilterName] = useState<string>('');\n    const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n    const [displayLimit, setDisplayLimit] = useState(10);\n    const { hasPermission } = usePermissions();\n    const { openSidepane, closeSidepane } = useSidepane();\n    const { handleError: handleErrorContext } = useError();\n\n    // Berechtigungen prfen\n    const canCreate = hasPermission('branches', 'write', 'table');\n    const canEdit = hasPermission('branches', 'write', 'table');\n    const canDelete = hasPermission('branches', 'write', 'table');\n\n    // Branches laden\n    const fetchBranches = useCallback(async () => {\n        setLoading(true);\n        try {\n            const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n            setBranches(response.data);\n        } catch (error: any) {\n            console.error('Fehler beim Laden der Niederlassungen:', error);\n            handleErrorContext(error);\n        } finally {\n            setLoading(false);\n        }\n    }, [handleErrorContext]);\n\n    useEffect(() => {\n        fetchBranches();\n    }, [fetchBranches]);\n\n    // Sidepane ffnen/schlieen basierend auf Modal-Status\n    useEffect(() => {\n        if (isModalOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isModalOpen, openSidepane, closeSidepane]);\n\n    // Formular zurcksetzen\n    const resetForm = () => {\n        setFormData({ \n            name: '',\n            address: '',\n            city: '',\n            country: '',\n            whatsappSettings: {\n                provider: 'whatsapp-business-api' as 'twilio' | 'whatsapp-business-api',\n                apiKey: '',\n                apiSecret: '',\n                phoneNumberId: '',\n                ai: {\n                    enabled: false,\n                    model: 'gpt-4o',\n                    systemPrompt: '',\n                    rules: [] as string[],\n                    sources: [] as string[],\n                    temperature: 0.7,\n                    maxTokens: 500\n                }\n            },\n            lobbyPmsSettings: {\n                apiUrl: '',\n                apiKey: '',\n                propertyId: '',\n                syncEnabled: true,\n                autoCreateTasks: false,\n                lateCheckInThreshold: '22:00',\n                notificationChannels: ['email'] as string[],\n                autoSendInvitation: false\n            },\n            boldPaymentSettings: {\n                apiKey: '',\n                merchantId: '',\n                environment: 'sandbox' as 'sandbox' | 'production'\n            },\n            doorSystemSettings: {\n                clientId: '',\n                clientSecret: '',\n                username: '',\n                password: '',\n                apiUrl: 'https://euopen.ttlock.com',\n                lockIds: [] as string[],\n                appName: 'TTLock'\n            },\n            sireSettings: {\n                enabled: false,\n                autoRegisterOnCheckIn: false,\n                apiUrl: '',\n                apiKey: '',\n                apiSecret: '',\n                propertyCode: ''\n            },\n            emailSettings: {\n                smtpHost: '',\n                smtpPort: 587,\n                smtpUser: '',\n                smtpPass: '',\n                smtpFromEmail: '',\n                smtpFromName: '',\n                imap: {\n                    enabled: false,\n                    host: '',\n                    port: 993,\n                    secure: true,\n                    user: '',\n                    password: '',\n                    folder: 'INBOX',\n                    processedFolder: ''\n                }\n            },\n            messageTemplates: {\n                checkInInvitation: {\n                    en: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    es: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    de: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    }\n                },\n                checkInConfirmation: {\n                    en: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    es: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    de: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    }\n                }\n            },\n            autoSendReservationInvitation: false\n        });\n        setActiveSettingsTab('whatsapp');\n        setEditingBranch(null);\n    };\n\n    // Modal ffnen fr neue Branch\n    const handleCreate = () => {\n        resetForm();\n        setIsModalOpen(true);\n    };\n\n    // Modal ffnen fr Bearbeitung\n    const handleEdit = async (branch: Branch) => {\n        setEditingBranch(branch);\n        const existingWhatsapp = branch.whatsappSettings || {};\n        const existingLobbyPms = branch.lobbyPmsSettings || {};\n        // Bold Payment Settings: Prfe ob es ein String ist (JSON) oder bereits ein Objekt\n        let existingBoldPayment: any = branch.boldPaymentSettings;\n        if (!existingBoldPayment) {\n            existingBoldPayment = {};\n        } else if (typeof existingBoldPayment === 'string') {\n            try {\n                existingBoldPayment = JSON.parse(existingBoldPayment);\n            } catch (e) {\n                console.error('Fehler beim Parsen von boldPaymentSettings:', e);\n                existingBoldPayment = {};\n            }\n        }\n        // Stelle sicher, dass verschlsselte Werte (mit ':') auch angezeigt werden\n        // Wenn Entschlsselung fehlgeschlagen ist, bleiben die verschlsselten Strings erhalten\n        const existingDoorSystem = branch.doorSystemSettings || {};\n        const existingEmail = branch.emailSettings || {};\n        const existingMessageTemplates = (branch as any).messageTemplates || {};\n        const existingAutoSend = (branch as any).autoSendReservationInvitation || false;\n        \n        setFormData({ \n            name: branch.name,\n            address: (branch as any).address || '',\n            city: (branch as any).city || '',\n            country: (branch as any).country || '',\n            whatsappSettings: {\n                provider: existingWhatsapp.provider || 'whatsapp-business-api',\n                apiKey: existingWhatsapp.apiKey || '',\n                apiSecret: existingWhatsapp.apiSecret || '',\n                phoneNumberId: existingWhatsapp.phoneNumberId || '',\n                ai: existingWhatsapp.ai || {\n                    enabled: false,\n                    model: 'gpt-4o',\n                    systemPrompt: '',\n                    rules: [],\n                    sources: [],\n                    temperature: 0.7,\n                    maxTokens: 500\n                }\n            },\n            lobbyPmsSettings: {\n                apiUrl: existingLobbyPms.apiUrl || '',\n                apiKey: existingLobbyPms.apiKey || '',\n                propertyId: existingLobbyPms.propertyId || '',\n                syncEnabled: existingLobbyPms.syncEnabled !== undefined ? existingLobbyPms.syncEnabled : true,\n                autoCreateTasks: existingLobbyPms.autoCreateTasks || false,\n                lateCheckInThreshold: existingLobbyPms.lateCheckInThreshold || '22:00',\n                notificationChannels: existingLobbyPms.notificationChannels || ['email'],\n                autoSendInvitation: existingLobbyPms.autoSendInvitation || false\n            },\n            boldPaymentSettings: {\n                // Wenn Entschlsselung fehlgeschlagen ist, sind die Werte verschlsselt (Format: \"iv:authTag:encrypted\")\n                // Diese sollten NICHT im Frontend angezeigt werden (Sicherheit)\n                // ABER: Wir speichern einen Flag, dass verschlsselte Werte vorhanden sind\n                // Die verschlsselten Werte bleiben in der DB, damit Payment-Links weiter funktionieren\n                apiKey: (existingBoldPayment.apiKey && !existingBoldPayment.apiKey.includes(':')) \n                    ? existingBoldPayment.apiKey \n                    : '',\n                merchantId: (existingBoldPayment.merchantId && !existingBoldPayment.merchantId.includes(':')) \n                    ? existingBoldPayment.merchantId \n                    : '',\n                environment: existingBoldPayment.environment || 'sandbox',\n                // Flag: Gibt an, ob verschlsselte Werte vorhanden sind (aber nicht entschlsselbar)\n                _hasEncryptedValues: (existingBoldPayment.apiKey && existingBoldPayment.apiKey.includes(':')) ||\n                                     (existingBoldPayment.merchantId && existingBoldPayment.merchantId.includes(':'))\n            },\n            doorSystemSettings: {\n                clientId: existingDoorSystem.clientId || '',\n                clientSecret: existingDoorSystem.clientSecret || '',\n                username: existingDoorSystem.username || '',\n                password: existingDoorSystem.password || '',\n                apiUrl: existingDoorSystem.apiUrl || 'https://euopen.ttlock.com',\n                lockIds: existingDoorSystem.lockIds || [],\n                appName: existingDoorSystem.appName || 'TTLock'\n            },\n            emailSettings: {\n                smtpHost: existingEmail.smtpHost || '',\n                smtpPort: existingEmail.smtpPort || 587,\n                smtpUser: existingEmail.smtpUser || '',\n                smtpPass: existingEmail.smtpPass || '',\n                smtpFromEmail: existingEmail.smtpFromEmail || '',\n                smtpFromName: existingEmail.smtpFromName || '',\n                imap: existingEmail.imap || {\n                    enabled: false,\n                    host: '',\n                    port: 993,\n                    secure: true,\n                    user: '',\n                    password: '',\n                    folder: 'INBOX',\n                    processedFolder: ''\n                }\n            },\n            messageTemplates: existingMessageTemplates || {\n                checkInInvitation: {\n                    en: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    es: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    de: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' }\n                },\n                checkInConfirmation: {\n                    en: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    es: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    de: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' }\n                }\n            },\n            autoSendReservationInvitation: existingAutoSend\n        });\n        setIsModalOpen(true);\n    };\n\n    // Modal schlieen\n    const handleCloseModal = () => {\n        setIsModalOpen(false);\n        resetForm();\n    };\n\n    // Formular absenden\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        \n        if (!formData.name.trim()) {\n            handleErrorContext({ message: t('branches.nameRequired') });\n            return;\n        }\n\n        try {\n            if (editingBranch) {\n                // Branch aktualisieren\n                await axiosInstance.put(API_ENDPOINTS.BRANCHES.UPDATE(editingBranch.id), {\n                    name: formData.name.trim(),\n                    address: formData.address.trim() || null,\n                    city: formData.city.trim() || null,\n                    country: formData.country.trim() || null,\n                    whatsappSettings: formData.whatsappSettings,\n                    lobbyPmsSettings: formData.lobbyPmsSettings,\n                    boldPaymentSettings: {\n                        apiKey: formData.boldPaymentSettings.apiKey,\n                        merchantId: formData.boldPaymentSettings.merchantId,\n                        environment: formData.boldPaymentSettings.environment\n                    },\n                    doorSystemSettings: formData.doorSystemSettings,\n                    emailSettings: formData.emailSettings,\n                    messageTemplates: formData.messageTemplates,\n                    autoSendReservationInvitation: formData.autoSendReservationInvitation\n                });\n            } else {\n                // Neue Branch erstellen\n                await axiosInstance.post(API_ENDPOINTS.BRANCHES.CREATE, {\n                    name: formData.name.trim()\n                });\n            }\n            \n            await fetchBranches();\n            handleCloseModal();\n        } catch (error: any) {\n            console.error('Fehler beim Speichern der Niederlassung:', error);\n            handleErrorContext(error);\n        }\n    };\n\n    // Branch lschen\n    const handleDelete = async (branchId: number) => {\n        if (!window.confirm(t('branches.deleteConfirm', { defaultValue: 'Mchten Sie diese Niederlassung wirklich lschen?' }))) {\n            return;\n        }\n\n        try {\n            await axiosInstance.delete(API_ENDPOINTS.BRANCHES.DELETE(branchId));\n            await fetchBranches();\n        } catch (error: any) {\n            console.error('Fehler beim Lschen der Niederlassung:', error);\n            handleErrorContext(error);\n        }\n    };\n\n    // Funktion zum Zhlen der aktiven Filter\n    const getActiveFilterCount = () => {\n        return filterConditions.length;\n    };\n\n    // Filtern und sortieren der Branches\n    const filteredAndSortedBranches = useMemo(() => {\n        return branches\n            .filter(branch => {\n                // Globale Suche\n                if (searchTerm) {\n                    const searchLower = searchTerm.toLowerCase();\n                    const matchesSearch = branch.name.toLowerCase().includes(searchLower);\n                    \n                    if (!matchesSearch) return false;\n                }\n                \n                // Prfe erweiterte Filterbedingungen, wenn vorhanden\n                if (filterConditions.length > 0) {\n                    let result = filterConditions.length > 0;\n                    \n                    for (let i = 0; i < filterConditions.length; i++) {\n                        const condition = filterConditions[i];\n                        let conditionMet = false;\n                        \n                        switch (condition.column) {\n                            case 'name':\n                                //  OPTIMIERUNG: toLowerCase() nur einmal pro Wert\n                                const branchNameLower = branch.name.toLowerCase();\n                                const conditionValueLower = (condition.value as string || '').toLowerCase();\n                                if (condition.operator === 'equals') {\n                                    conditionMet = branchNameLower === conditionValueLower;\n                                } else if (condition.operator === 'contains') {\n                                    conditionMet = branchNameLower.includes(conditionValueLower);\n                                } else if (condition.operator === 'startsWith') {\n                                    conditionMet = branchNameLower.startsWith(conditionValueLower);\n                                }\n                                break;\n                        }\n                        \n                        // Verknpfe das Ergebnis dieser Bedingung mit dem Gesamtergebnis\n                        if (i === 0) {\n                            result = conditionMet;\n                        } else {\n                            const operator = filterLogicalOperators[i - 1];\n                            result = operator === 'AND' ? (result && conditionMet) : (result || conditionMet);\n                        }\n                    }\n                    \n                    if (!result) return false;\n                }\n                \n                return true;\n            })\n            .sort((a, b) => {\n                //  OPTIMIERUNG: toLowerCase() fr konsistente Sortierung\n                return a.name.toLowerCase().localeCompare(b.name.toLowerCase());\n            });\n    }, [branches, searchTerm, filterConditions, filterLogicalOperators]);\n\n    // Funktion zum Anwenden von Filterbedingungen\n    const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setFilterConditions(conditions);\n        setFilterLogicalOperators(operators);\n    };\n    \n    // Funktion zum Zurcksetzen der Filter\n    const resetFilterConditions = () => {\n        setFilterConditions([]);\n        setFilterLogicalOperators([]);\n        setActiveFilterName('');\n        setSelectedFilterId(null);\n    };\n    \n    // Filter Change Handler (Controlled Mode)\n    const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setActiveFilterName(name);\n        setSelectedFilterId(id);\n        applyFilterConditions(conditions, operators);\n    };\n    \n    //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n    const filterContext = useFilterContext();\n    const { loadFilters } = filterContext;\n    \n    useEffect(() => {\n        const initialize = async () => {\n            // 1. Filter laden (wartet auf State-Update)\n            const filters = await loadFilters(BRANCHES_TABLE_ID);\n            \n            // 2. Default-Filter anwenden (IMMER vorhanden!)\n            const defaultFilter = filters.find(f => f.name === 'Alle');\n            if (defaultFilter) {\n                await handleFilterChange(\n                    defaultFilter.name,\n                    defaultFilter.id,\n                    defaultFilter.conditions,\n                    defaultFilter.operators\n                );\n                return; // Filter wird angewendet\n            }\n            \n            // 3. Fallback: Kein Filter (sollte nie passieren)\n            // BranchManagementTab filtert client-seitig, daher keine Daten-Lade-Funktion ntig\n        };\n        \n        initialize();\n    }, [loadFilters, handleFilterChange]);\n\n    // Standard-Filter erstellen und speichern\n    useEffect(() => {\n        const createStandardFilters = async () => {\n            try {\n                const token = localStorage.getItem('token');\n                \n                if (!token) {\n                    console.error(t('common.notAuthenticated'));\n                    return;\n                }\n\n                // Prfen, ob die Standard-Filter bereits existieren\n                const existingFiltersResponse = await axiosInstance.get(\n                    API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(BRANCHES_TABLE_ID)\n                );\n\n                const existingFilters = existingFiltersResponse.data || [];\n                const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\n\n                // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n                if (!alleFilterExists) {\n                    const alleFilter = {\n                        tableId: BRANCHES_TABLE_ID,\n                        name: 'Alle',\n                        conditions: [],\n                        operators: []\n                    };\n\n                    await axiosInstance.post(\n                        API_ENDPOINTS.SAVED_FILTERS.BASE,\n                        alleFilter\n                    );\n                    if (process.env.NODE_ENV === 'development') {\n                    logger.log(t('branches.filterCreated'));\n                    }\n                }\n            } catch (error) {\n                console.error(t('branches.createStandardFiltersError'), error);\n            }\n        };\n\n        createStandardFilters();\n    }, []);\n\n\n    // Branches rendern\n    const renderBranches = () => {\n        if (filteredAndSortedBranches.length === 0) {\n            return (\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded text-center\">\n                    <p className=\"text-gray-600 dark:text-gray-400\">\n                        {t('branches.noBranches', { defaultValue: 'Keine Niederlassungen gefunden. Erstellen Sie eine neue Niederlassung mit dem Button oben.' })}\n                    </p>\n                </div>\n            );\n        }\n        \n        // Card-Ansicht\n        return (\n            <>\n                <div className=\"space-y-4\">\n                    {filteredAndSortedBranches.slice(0, displayLimit).map((branch) => (\n                        <BranchCard \n                            key={branch.id} \n                            branch={branch} \n                            onEdit={handleEdit}\n                            onDelete={handleDelete}\n                            canEdit={canEdit}\n                            canDelete={canDelete}\n                        />\n                    ))}\n                </div>\n                \n                {/* \"Mehr anzeigen\" Button */}\n                {filteredAndSortedBranches.length > displayLimit && (\n                    <div className=\"mt-4 flex justify-center\">\n                        <button\n                            className=\"px-4 py-2 text-sm font-medium text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                            onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                        >\n                            {t('common.showMore', { defaultValue: 'Mehr anzeigen' })} ({filteredAndSortedBranches.length - displayLimit} {t('common.remaining', { defaultValue: 'verbleibend' })})\n                        </button>\n                    </div>\n                )}\n            </>\n        );\n    };\n\n    // Mobile-Erkennung\n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    \n    useEffect(() => {\n        const handleResize = () => {\n            setIsMobile(window.innerWidth < 640);\n        };\n        window.addEventListener('resize', handleResize);\n        return () => window.removeEventListener('resize', handleResize);\n    }, []);\n\n    return (\n        <div>\n            {/* Spaltenanzeige und Suche */}\n            <div className=\"space-y-4\">\n                <div className=\"flex items-center justify-between mb-4\">\n                    {/* Linke Seite: \"Neue Niederlassung erstellen\"-Button */}\n                    <div className=\"flex items-center\">\n                        {canCreate && (\n                            <div className=\"relative group\">\n                                <button\n                                    onClick={handleCreate}\n                                    className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                                    style={{ width: '30.19px', height: '30.19px' }}\n                                    aria-label={t('branches.create', { defaultValue: 'Neue Niederlassung' })}\n                                >\n                                    <PlusIcon className=\"h-4 w-4\" />\n                                </button>\n                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                    {t('branches.create', { defaultValue: 'Neue Niederlassung' })}\n                                </div>\n                            </div>\n                        )}\n                    </div>\n                    \n                    {/* Mitte: Titel - Kein Titel in der Mitte notwendig bei dieser Komponente, da der Tab-Header bereits den Titel zeigt */}\n                    <div></div>\n                    \n                    {/* Rechte Seite: Suchfeld, Filter-Button */}\n                    <div className=\"flex items-center gap-1.5\">\n                        <input\n                            type=\"text\"\n                            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n                            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                        />\n                        <div className=\"relative group ml-1\">\n                            <button\n                                className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100'} relative`}\n                                onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                            >\n                                <FunnelIcon className=\"w-5 h-5\" />\n                                {getActiveFilterCount() > 0 && (\n                                    <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                        {getActiveFilterCount()}\n                                    </span>\n                                )}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.filter', { defaultValue: 'Filter' })}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Filter-Modal */}\n                {isFilterModalOpen && (\n                    <FilterPane\n                        columns={[\n                            { id: 'name', label: t('branches.name', { defaultValue: 'Name' }) }\n                        ]}\n                        onApply={applyFilterConditions}\n                        onReset={resetFilterConditions}\n                        savedConditions={filterConditions}\n                        savedOperators={filterLogicalOperators}\n                        tableId={BRANCHES_TABLE_ID}\n                    />\n                )}\n                \n                {/* Gespeicherte Filter als Tags anzeigen */}\n                <SavedFilterTags\n                    tableId={BRANCHES_TABLE_ID}\n                    onSelectFilter={applyFilterConditions}\n                    onReset={resetFilterConditions}\n                    activeFilterName={activeFilterName}\n                    selectedFilterId={selectedFilterId}\n                    onFilterChange={handleFilterChange}\n                    defaultFilterName=\"Alle\"\n                />\n\n                {loading ? (\n                    <div className=\"flex justify-center items-center py-8\">\n                        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n                    </div>\n                ) : (\n                    renderBranches()\n                )}\n            </div>\n\n            {/* Modal/Sidepane fr Branch-Erstellung/Bearbeitung */}\n            {isModalOpen && (\n                <>\n                    {/* Mobile (unter 640px) - Modal */}\n                    {isMobile ? (\n                        <Dialog open={isModalOpen} onClose={handleCloseModal} className=\"relative z-50\">\n                            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                            \n                            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                                <Dialog.Panel className=\"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                                    {/* Header */}\n                                    <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                                        <div className=\"flex items-center justify-between\">\n                                            <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                                                {editingBranch \n                                                    ? t('branches.edit', { defaultValue: 'Niederlassung bearbeiten' })\n                                                    : t('branches.create', { defaultValue: 'Neue Niederlassung' })\n                                                }\n                                            </Dialog.Title>\n                                            <button\n                                                onClick={handleCloseModal}\n                                                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                            >\n                                                <XMarkIcon className=\"h-6 w-6\" />\n                                            </button>\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Form */}\n                                    <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.name', { defaultValue: 'Name' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.name}\n                                                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                required\n                                                autoFocus\n                                            />\n                                        </div>\n\n                                        {/* Adress-Felder */}\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.address', { defaultValue: 'Adresse' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.address}\n                                                onChange={(e) => setFormData({ ...formData, address: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.addressPlaceholder', { defaultValue: 'Strae und Hausnummer' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.city', { defaultValue: 'Stadt' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.city}\n                                                onChange={(e) => setFormData({ ...formData, city: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.cityPlaceholder', { defaultValue: 'z.B. Medelln' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.country', { defaultValue: 'Land' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.country}\n                                                onChange={(e) => setFormData({ ...formData, country: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.countryPlaceholder', { defaultValue: 'z.B. Kolumbien' })}\n                                            />\n                                        </div>\n\n                                        {/* Settings Tabs - nur beim Bearbeiten */}\n                                        {editingBranch && (\n                                            <>\n                                                {/* Tab Navigation */}\n                                                <div className=\"border-b border-gray-200 dark:border-gray-700 mb-4\">\n                                                    <nav className=\"-mb-px flex space-x-2 overflow-x-auto\">\n                                                        {['whatsapp', 'lobbypms', 'boldpayment', 'doorsystem', 'email', 'messages'].map((tab) => (\n                                                            <button\n                                                                key={tab}\n                                                                type=\"button\"\n                                                                onClick={() => setActiveSettingsTab(tab as any)}\n                                                                className={`py-2 px-2 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ${\n                                                                    activeSettingsTab === tab\n                                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                                }`}\n                                                            >\n                                                                {tab === 'whatsapp' ? 'WhatsApp' : tab === 'lobbypms' ? 'LobbyPMS' : tab === 'boldpayment' ? 'Bold Payment' : tab === 'doorsystem' ? 'TTLock' : tab === 'email' ? 'Email' : t('branches.messagesTab', { defaultValue: 'Nachrichten' })}\n                                                            </button>\n                                                        ))}\n                                                    </nav>\n                                                </div>\n\n                                                {/* Tab Content */}\n                                                <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n                                                    {/* WhatsApp Settings Tab */}\n                                                    {activeSettingsTab === 'whatsapp' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                WhatsApp Settings\n                                                            </h4>\n                                                \n                                                <div className=\"space-y-4\">\n                                                    <div>\n                                                        <label htmlFor=\"whatsappProvider\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            Provider\n                                                        </label>\n                                                        <select\n                                                            id=\"whatsappProvider\"\n                                                            value={formData.whatsappSettings.provider}\n                                                            onChange={(e) => setFormData({\n                                                                ...formData,\n                                                                whatsappSettings: {\n                                                                    ...formData.whatsappSettings,\n                                                                    provider: e.target.value as 'twilio' | 'whatsapp-business-api'\n                                                                }\n                                                            })}\n                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                        >\n                                                            <option value=\"twilio\">Twilio</option>\n                                                            <option value=\"whatsapp-business-api\">WhatsApp Business API</option>\n                                                        </select>\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiKey\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Key / Access Token\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiKey'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiKey\"\n                                                                value={formData.whatsappSettings.apiKey}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiKey: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Key / Access Token\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiKey: !prev.whatsappApiKey }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiKey'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappPhoneNumberId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            Phone Number ID\n                                                        </label>\n                                                        <input\n                                                            type=\"text\"\n                                                            id=\"whatsappPhoneNumberId\"\n                                                            value={formData.whatsappSettings.phoneNumberId}\n                                                            onChange={(e) => setFormData({\n                                                                ...formData,\n                                                                whatsappSettings: {\n                                                                    ...formData.whatsappSettings,\n                                                                    phoneNumberId: e.target.value\n                                                                }\n                                                            })}\n                                                            placeholder=\"Phone Number ID\"\n                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                        />\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiSecret\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Secret\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiSecret'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiSecret\"\n                                                                value={formData.whatsappSettings.apiSecret}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiSecret: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Secret\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiSecret: !prev.whatsappApiSecret }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiSecret'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    {/* AI Configuration */}\n                                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                        <div className=\"flex items-center justify-between mb-4\">\n                                                            <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                KI-Konfiguration (AI)\n                                                            </h5>\n                                                            <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                <input\n                                                                    type=\"checkbox\"\n                                                                    checked={formData.whatsappSettings.ai.enabled}\n                                                                    onChange={(e) => setFormData({\n                                                                        ...formData,\n                                                                        whatsappSettings: {\n                                                                            ...formData.whatsappSettings,\n                                                                            ai: {\n                                                                                ...formData.whatsappSettings.ai,\n                                                                                enabled: e.target.checked\n                                                                            }\n                                                                        }\n                                                                    })}\n                                                                    className=\"sr-only peer\"\n                                                                />\n                                                                <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                    {formData.whatsappSettings.ai.enabled ? 'Aktiviert' : 'Deaktiviert'}\n                                                                </span>\n                                                            </label>\n                                                        </div>\n\n                                                        {formData.whatsappSettings.ai.enabled && (\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label htmlFor=\"aiModel\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Modell\n                                                                    </label>\n                                                                    <select\n                                                                        id=\"aiModel\"\n                                                                        value={formData.whatsappSettings.ai.model}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    model: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"gpt-4o\">GPT-4o</option>\n                                                                        <option value=\"gpt-4\">GPT-4</option>\n                                                                        <option value=\"gpt-3.5-turbo\">GPT-3.5 Turbo</option>\n                                                                    </select>\n                                                                </div>\n\n                                                                <div>\n                                                                    <label htmlFor=\"aiSystemPrompt\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        System Prompt\n                                                                    </label>\n                                                                    <textarea\n                                                                        id=\"aiSystemPrompt\"\n                                                                        value={formData.whatsappSettings.ai.systemPrompt}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    systemPrompt: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={4}\n                                                                        placeholder=\"Du bist ein hilfreicher Assistent fr...\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Regeln (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.rules.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    rules: e.target.value.split('\\n').filter(r => r.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={3}\n                                                                        placeholder=\"Antworte immer auf Spanisch&#10;Sei freundlich und professionell\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Quellen/URLs (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.sources.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    sources: e.target.value.split('\\n').filter(s => s.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={2}\n                                                                        placeholder=\"https://wiki.example.com/manila-procedures&#10;https://wiki.example.com/faq\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div className=\"grid grid-cols-2 gap-4\">\n                                                                    <div>\n                                                                        <label htmlFor=\"aiTemperature\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Temperature ({formData.whatsappSettings.ai.temperature})\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"range\"\n                                                                            id=\"aiTemperature\"\n                                                                            min=\"0\"\n                                                                            max=\"2\"\n                                                                            step=\"0.1\"\n                                                                            value={formData.whatsappSettings.ai.temperature}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        temperature: parseFloat(e.target.value)\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full\"\n                                                                        />\n                                                                    </div>\n\n                                                                    <div>\n                                                                        <label htmlFor=\"aiMaxTokens\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Max Tokens\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"number\"\n                                                                            id=\"aiMaxTokens\"\n                                                                            min=\"100\"\n                                                                            max=\"4000\"\n                                                                            step=\"100\"\n                                                                            value={formData.whatsappSettings.ai.maxTokens}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        maxTokens: parseInt(e.target.value) || 500\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        />\n                                                                    </div>\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                                    {/* LobbyPMS Settings Tab */}\n                                                    {activeSettingsTab === 'lobbypms' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                LobbyPMS Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API URL\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.apiUrl}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiUrl: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"https://api.lobbypms.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['lobbyPmsApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.lobbyPmsSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiKey: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Property ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.propertyId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, propertyId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Property ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                            \n                                                            {/* Zimmer-Beschreibungen Sektion */}\n                                                            {editingBranch && (\n                                                                <RoomDescriptionsSection branchId={editingBranch.id} />\n                                                            )}\n                                                        </div>\n                                                    )}\n\n                                                    {/* Bold Payment Settings Tab */}\n                                                    {activeSettingsTab === 'boldpayment' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Bold Payment Settings\n                                                            </h4>\n                                                            {formData.boldPaymentSettings._hasEncryptedValues && (\n                                                                <div className=\"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md\">\n                                                                    <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n                                                                        <strong>Hinweis:</strong> Es sind verschlsselte Werte vorhanden, die mit einem alten Schlssel verschlsselt wurden und nicht mehr entschlsselt werden knnen. \n                                                                        Die Payment-Links funktionieren weiterhin. Um die Werte zu ndern, geben Sie sie neu ein.\n                                                                    </p>\n                                                                </div>\n                                                            )}\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, apiKey: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Merchant ID\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentMerchantId'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.merchantId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, merchantId: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"Merchant ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Environment\n                                                                    </label>\n                                                                    <select\n                                                                        value={formData.boldPaymentSettings.environment}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, environment: e.target.value as 'sandbox' | 'production' }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"sandbox\">Sandbox</option>\n                                                                        <option value=\"production\">Production</option>\n                                                                    </select>\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* TTLock Settings Tab */}\n                                                    {activeSettingsTab === 'doorsystem' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                TTLock Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.clientId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client Secret\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemClientSecret'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.clientSecret}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientSecret: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client Secret\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Username\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.username}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, username: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Username\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Password\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemPassword'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.password}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, password: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Password\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* Email Settings Tab */}\n                                                    {activeSettingsTab === 'email' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Email Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Host\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpHost}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpHost: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"smtp.example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Port\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"number\"\n                                                                        value={formData.emailSettings.smtpPort}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpPort: parseInt(e.target.value) || 587 }\n                                                                        })}\n                                                                        placeholder=\"587\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP User\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpUser}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpUser: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"user@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Password\n                                                                    </label>\n                                                                    <div className=\"relative\">\n                                                                        <input\n                                                                            type={showSecrets['emailSmtpPass'] ? 'text' : 'password'}\n                                                                            value={formData.emailSettings.smtpPass}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                emailSettings: { ...formData.emailSettings, smtpPass: e.target.value }\n                                                                            })}\n                                                                            placeholder=\"Password\"\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                        />\n                                                                        <button\n                                                                            type=\"button\"\n                                                                            onClick={() => setShowSecrets({ ...showSecrets, emailSmtpPass: !showSecrets['emailSmtpPass'] })}\n                                                                            className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                        >\n                                                                            {showSecrets['emailSmtpPass'] ? (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                </svg>\n                                                                            ) : (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                </svg>\n                                                                            )}\n                                                                        </button>\n                                                                    </div>\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Email\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"email\"\n                                                                        value={formData.emailSettings.smtpFromEmail}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromEmail: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"noreply@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Name\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpFromName}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromName: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Branch Name\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                {/* IMAP Settings Section */}\n                                                                <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                                    <div className=\"flex items-center justify-between mb-4\">\n                                                                        <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                            IMAP Settings (Email Reading)\n                                                                        </h5>\n                                                                        <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                            <input\n                                                                                type=\"checkbox\"\n                                                                                checked={formData.emailSettings.imap.enabled}\n                                                                                onChange={(e) => setFormData({\n                                                                                    ...formData,\n                                                                                    emailSettings: {\n                                                                                        ...formData.emailSettings,\n                                                                                        imap: {\n                                                                                            ...formData.emailSettings.imap,\n                                                                                            enabled: e.target.checked\n                                                                                        }\n                                                                                    }\n                                                                                })}\n                                                                                className=\"sr-only peer\"\n                                                                            />\n                                                                            <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                            <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                {formData.emailSettings.imap.enabled ? 'Enabled' : 'Disabled'}\n                                                                            </span>\n                                                                        </label>\n                                                                    </div>\n\n                                                                    {formData.emailSettings.imap.enabled && (\n                                                                        <div className=\"space-y-4\">\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Host\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.host}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, host: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"imap.example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Port\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"number\"\n                                                                                    value={formData.emailSettings.imap.port}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, port: parseInt(e.target.value) || 993 }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"993\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                                    <input\n                                                                                        type=\"checkbox\"\n                                                                                        checked={formData.emailSettings.imap.secure}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, secure: e.target.checked }\n                                                                                            }\n                                                                                        })}\n                                                                                        className=\"sr-only peer\"\n                                                                                    />\n                                                                                    <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                                    <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                        Secure (SSL/TLS)\n                                                                                    </span>\n                                                                                </label>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP User\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.user}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, user: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"user@example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Password\n                                                                                </label>\n                                                                                <div className=\"relative\">\n                                                                                    <input\n                                                                                        type={showSecrets['emailImapPass'] ? 'text' : 'password'}\n                                                                                        value={formData.emailSettings.imap.password}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, password: e.target.value }\n                                                                                            }\n                                                                                        })}\n                                                                                        placeholder=\"Password\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                                    />\n                                                                                    <button\n                                                                                        type=\"button\"\n                                                                                        onClick={() => setShowSecrets({ ...showSecrets, emailImapPass: !showSecrets['emailImapPass'] })}\n                                                                                        className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        {showSecrets['emailImapPass'] ? (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                            </svg>\n                                                                                        ) : (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                            </svg>\n                                                                                        )}\n                                                                                    </button>\n                                                                                </div>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Folder\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.folder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, folder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"INBOX\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    Processed Folder (optional)\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.processedFolder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, processedFolder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"Processed\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                        </div>\n                                                                    )}\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n                                                </div>\n                                            </>\n                                        )}\n\n                                        {/* Buttons */}\n                                        <div className=\"flex justify-end pt-4 gap-2\">\n                                            <div className=\"relative group\">\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={handleCloseModal}\n                                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                                                >\n                                                    <XMarkIcon className=\"h-5 w-5\" />\n                                                </button>\n                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                    {t('common.cancel', { defaultValue: 'Abbrechen' })}\n                                                </div>\n                                            </div>\n                                            <div className=\"relative group\">\n                                                <button\n                                                    type=\"submit\"\n                                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                                                >\n                                                    <CheckIcon className=\"h-5 w-5\" />\n                                                </button>\n                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                    {editingBranch ? t('common.update', { defaultValue: 'Aktualisieren' }) : t('common.create', { defaultValue: 'Erstellen' })}\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </form>\n                                </Dialog.Panel>\n                            </div>\n                        </Dialog>\n                    ) : (\n                        // Desktop - Sidepane (dynamische Breite basierend auf Tab-Anzahl)\n                        <div className=\"fixed inset-y-0 right-0 w-full sm:min-w-[500px] sm:max-w-[600px] bg-white dark:bg-gray-800 shadow-xl z-50 flex flex-col\">\n                            {/* Header */}\n                            <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                                <div className=\"flex items-center justify-between\">\n                                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                                        {editingBranch \n                                            ? t('branches.edit', { defaultValue: 'Niederlassung bearbeiten' })\n                                            : t('branches.create', { defaultValue: 'Neue Niederlassung' })\n                                        }\n                                    </h2>\n                                    <button\n                                        onClick={handleCloseModal}\n                                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                    >\n                                        <XMarkIcon className=\"h-6 w-6\" />\n                                    </button>\n                                </div>\n                            </div>\n                            \n                            {/* Form */}\n                            <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\n                                <div className=\"flex-1 overflow-y-auto min-h-0\">\n                                    <div className=\"p-6 space-y-4\">\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.name', { defaultValue: 'Name' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.name}\n                                                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                required\n                                                autoFocus\n                                            />\n                                        </div>\n\n                                        {/* Adress-Felder */}\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.address', { defaultValue: 'Adresse' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.address}\n                                                onChange={(e) => setFormData({ ...formData, address: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.addressPlaceholder', { defaultValue: 'Strae und Hausnummer' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.city', { defaultValue: 'Stadt' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.city}\n                                                onChange={(e) => setFormData({ ...formData, city: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.cityPlaceholder', { defaultValue: 'z.B. Medelln' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.country', { defaultValue: 'Land' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.country}\n                                                onChange={(e) => setFormData({ ...formData, country: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.countryPlaceholder', { defaultValue: 'z.B. Kolumbien' })}\n                                            />\n                                        </div>\n\n                                        {/* Settings Tabs - nur beim Bearbeiten */}\n                                        {editingBranch && (\n                                            <>\n                                                {/* Tab Navigation */}\n                                                <div className=\"border-b border-gray-200 dark:border-gray-700 mb-4\">\n                                                    <nav className=\"-mb-px flex space-x-2 overflow-x-auto\">\n                                                        {['whatsapp', 'lobbypms', 'boldpayment', 'doorsystem', 'email', 'messages'].map((tab) => (\n                                                            <button\n                                                                key={tab}\n                                                                type=\"button\"\n                                                                onClick={() => setActiveSettingsTab(tab as any)}\n                                                                className={`py-2 px-2 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ${\n                                                                    activeSettingsTab === tab\n                                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                                }`}\n                                                            >\n                                                                {tab === 'whatsapp' ? 'WhatsApp' : tab === 'lobbypms' ? 'LobbyPMS' : tab === 'boldpayment' ? 'Bold Payment' : tab === 'doorsystem' ? 'TTLock' : tab === 'email' ? 'Email' : t('branches.messagesTab', { defaultValue: 'Nachrichten' })}\n                                                            </button>\n                                                        ))}\n                                                    </nav>\n                                                </div>\n\n                                                {/* Tab Content */}\n                                                <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n                                                    {/* WhatsApp Settings Tab */}\n                                                    {activeSettingsTab === 'whatsapp' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                WhatsApp Settings\n                                                            </h4>\n                                                            \n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label htmlFor=\"whatsappProviderDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Provider\n                                                                    </label>\n                                                                    <select\n                                                                        id=\"whatsappProviderDesktop\"\n                                                                        value={formData.whatsappSettings.provider}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                provider: e.target.value as 'twilio' | 'whatsapp-business-api'\n                                                                            }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"twilio\">Twilio</option>\n                                                                        <option value=\"whatsapp-business-api\">WhatsApp Business API</option>\n                                                                    </select>\n                                                                </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiKey\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Key / Access Token\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiKey'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiKey\"\n                                                                value={formData.whatsappSettings.apiKey}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiKey: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Key / Access Token\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiKey: !prev.whatsappApiKey }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiKey'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappPhoneNumberId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            Phone Number ID\n                                                        </label>\n                                                        <input\n                                                            type=\"text\"\n                                                            id=\"whatsappPhoneNumberId\"\n                                                            value={formData.whatsappSettings.phoneNumberId}\n                                                            onChange={(e) => setFormData({\n                                                                ...formData,\n                                                                whatsappSettings: {\n                                                                    ...formData.whatsappSettings,\n                                                                    phoneNumberId: e.target.value\n                                                                }\n                                                            })}\n                                                            placeholder=\"Phone Number ID\"\n                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                        />\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiSecretDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Secret\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiSecret'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiSecretDesktop\"\n                                                                value={formData.whatsappSettings.apiSecret}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiSecret: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Secret\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiSecret: !prev.whatsappApiSecret }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiSecret'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    {/* AI Configuration */}\n                                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                        <div className=\"flex items-center justify-between mb-4\">\n                                                            <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                KI-Konfiguration (AI)\n                                                            </h5>\n                                                            <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                <input\n                                                                    type=\"checkbox\"\n                                                                    checked={formData.whatsappSettings.ai.enabled}\n                                                                    onChange={(e) => setFormData({\n                                                                        ...formData,\n                                                                        whatsappSettings: {\n                                                                            ...formData.whatsappSettings,\n                                                                            ai: {\n                                                                                ...formData.whatsappSettings.ai,\n                                                                                enabled: e.target.checked\n                                                                            }\n                                                                        }\n                                                                    })}\n                                                                    className=\"sr-only peer\"\n                                                                />\n                                                                <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                    {formData.whatsappSettings.ai.enabled ? 'Aktiviert' : 'Deaktiviert'}\n                                                                </span>\n                                                            </label>\n                                                        </div>\n\n                                                        {formData.whatsappSettings.ai.enabled && (\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label htmlFor=\"aiModelDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Modell\n                                                                    </label>\n                                                                    <select\n                                                                        id=\"aiModelDesktop\"\n                                                                        value={formData.whatsappSettings.ai.model}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    model: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"gpt-4o\">GPT-4o</option>\n                                                                        <option value=\"gpt-4\">GPT-4</option>\n                                                                        <option value=\"gpt-3.5-turbo\">GPT-3.5 Turbo</option>\n                                                                    </select>\n                                                                </div>\n\n                                                                <div>\n                                                                    <label htmlFor=\"aiSystemPromptDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        System Prompt\n                                                                    </label>\n                                                                    <textarea\n                                                                        id=\"aiSystemPromptDesktop\"\n                                                                        value={formData.whatsappSettings.ai.systemPrompt}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    systemPrompt: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={4}\n                                                                        placeholder=\"Du bist ein hilfreicher Assistent fr...\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Regeln (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.rules.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    rules: e.target.value.split('\\n').filter(r => r.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={3}\n                                                                        placeholder=\"Antworte immer auf Spanisch&#10;Sei freundlich und professionell\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Quellen/URLs (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.sources.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    sources: e.target.value.split('\\n').filter(s => s.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={2}\n                                                                        placeholder=\"https://wiki.example.com/manila-procedures&#10;https://wiki.example.com/faq\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div className=\"grid grid-cols-2 gap-4\">\n                                                                    <div>\n                                                                        <label htmlFor=\"aiTemperatureDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Temperature ({formData.whatsappSettings.ai.temperature})\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"range\"\n                                                                            id=\"aiTemperatureDesktop\"\n                                                                            min=\"0\"\n                                                                            max=\"2\"\n                                                                            step=\"0.1\"\n                                                                            value={formData.whatsappSettings.ai.temperature}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        temperature: parseFloat(e.target.value)\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full\"\n                                                                        />\n                                                                    </div>\n\n                                                                    <div>\n                                                                        <label htmlFor=\"aiMaxTokensDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Max Tokens\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"number\"\n                                                                            id=\"aiMaxTokensDesktop\"\n                                                                            min=\"100\"\n                                                                            max=\"4000\"\n                                                                            step=\"100\"\n                                                                            value={formData.whatsappSettings.ai.maxTokens}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        maxTokens: parseInt(e.target.value) || 500\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        />\n                                                                    </div>\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                                    {/* LobbyPMS Settings Tab */}\n                                                    {activeSettingsTab === 'lobbypms' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                LobbyPMS Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API URL\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.apiUrl}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiUrl: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"https://api.lobbypms.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['lobbyPmsApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.lobbyPmsSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiKey: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Property ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.propertyId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, propertyId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Property ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                            \n                                                            {/* Zimmer-Beschreibungen Sektion */}\n                                                            {editingBranch && (\n                                                                <RoomDescriptionsSection branchId={editingBranch.id} />\n                                                            )}\n                                                        </div>\n                                                    )}\n\n                                                    {/* Bold Payment Settings Tab */}\n                                                    {activeSettingsTab === 'boldpayment' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Bold Payment Settings\n                                                            </h4>\n                                                            {formData.boldPaymentSettings._hasEncryptedValues && (\n                                                                <div className=\"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md\">\n                                                                    <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n                                                                        <strong>Hinweis:</strong> Es sind verschlsselte Werte vorhanden, die mit einem alten Schlssel verschlsselt wurden und nicht mehr entschlsselt werden knnen. \n                                                                        Die Payment-Links funktionieren weiterhin. Um die Werte zu ndern, geben Sie sie neu ein.\n                                                                    </p>\n                                                                </div>\n                                                            )}\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, apiKey: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Merchant ID\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentMerchantId'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.merchantId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, merchantId: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"Merchant ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Environment\n                                                                    </label>\n                                                                    <select\n                                                                        value={formData.boldPaymentSettings.environment}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, environment: e.target.value as 'sandbox' | 'production' }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"sandbox\">Sandbox</option>\n                                                                        <option value=\"production\">Production</option>\n                                                                    </select>\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* TTLock Settings Tab */}\n                                                    {activeSettingsTab === 'doorsystem' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                TTLock Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.clientId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client Secret\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemClientSecret'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.clientSecret}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientSecret: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client Secret\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Username\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.username}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, username: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Username\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Password\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemPassword'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.password}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, password: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Password\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* Email Settings Tab */}\n                                                    {activeSettingsTab === 'email' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Email Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Host\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpHost}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpHost: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"smtp.example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Port\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"number\"\n                                                                        value={formData.emailSettings.smtpPort}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpPort: parseInt(e.target.value) || 587 }\n                                                                        })}\n                                                                        placeholder=\"587\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP User\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpUser}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpUser: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"user@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Password\n                                                                    </label>\n                                                                    <div className=\"relative\">\n                                                                        <input\n                                                                            type={showSecrets['emailSmtpPass'] ? 'text' : 'password'}\n                                                                            value={formData.emailSettings.smtpPass}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                emailSettings: { ...formData.emailSettings, smtpPass: e.target.value }\n                                                                            })}\n                                                                            placeholder=\"Password\"\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                        />\n                                                                        <button\n                                                                            type=\"button\"\n                                                                            onClick={() => setShowSecrets({ ...showSecrets, emailSmtpPass: !showSecrets['emailSmtpPass'] })}\n                                                                            className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                        >\n                                                                            {showSecrets['emailSmtpPass'] ? (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                </svg>\n                                                                            ) : (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                </svg>\n                                                                            )}\n                                                                        </button>\n                                                                    </div>\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Email\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"email\"\n                                                                        value={formData.emailSettings.smtpFromEmail}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromEmail: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"noreply@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Name\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpFromName}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromName: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Branch Name\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                {/* IMAP Settings Section */}\n                                                                <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                                    <div className=\"flex items-center justify-between mb-4\">\n                                                                        <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                            IMAP Settings (Email Reading)\n                                                                        </h5>\n                                                                        <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                            <input\n                                                                                type=\"checkbox\"\n                                                                                checked={formData.emailSettings.imap.enabled}\n                                                                                onChange={(e) => setFormData({\n                                                                                    ...formData,\n                                                                                    emailSettings: {\n                                                                                        ...formData.emailSettings,\n                                                                                        imap: {\n                                                                                            ...formData.emailSettings.imap,\n                                                                                            enabled: e.target.checked\n                                                                                        }\n                                                                                    }\n                                                                                })}\n                                                                                className=\"sr-only peer\"\n                                                                            />\n                                                                            <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                            <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                {formData.emailSettings.imap.enabled ? 'Enabled' : 'Disabled'}\n                                                                            </span>\n                                                                        </label>\n                                                                    </div>\n\n                                                                    {formData.emailSettings.imap.enabled && (\n                                                                        <div className=\"space-y-4\">\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Host\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.host}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, host: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"imap.example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Port\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"number\"\n                                                                                    value={formData.emailSettings.imap.port}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, port: parseInt(e.target.value) || 993 }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"993\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                                    <input\n                                                                                        type=\"checkbox\"\n                                                                                        checked={formData.emailSettings.imap.secure}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, secure: e.target.checked }\n                                                                                            }\n                                                                                        })}\n                                                                                        className=\"sr-only peer\"\n                                                                                    />\n                                                                                    <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                                    <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                        Secure (SSL/TLS)\n                                                                                    </span>\n                                                                                </label>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP User\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.user}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, user: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"user@example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Password\n                                                                                </label>\n                                                                                <div className=\"relative\">\n                                                                                    <input\n                                                                                        type={showSecrets['emailImapPass'] ? 'text' : 'password'}\n                                                                                        value={formData.emailSettings.imap.password}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, password: e.target.value }\n                                                                                            }\n                                                                                        })}\n                                                                                        placeholder=\"Password\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                                    />\n                                                                                    <button\n                                                                                        type=\"button\"\n                                                                                        onClick={() => setShowSecrets({ ...showSecrets, emailImapPass: !showSecrets['emailImapPass'] })}\n                                                                                        className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        {showSecrets['emailImapPass'] ? (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                            </svg>\n                                                                                        ) : (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                            </svg>\n                                                                                        )}\n                                                                                    </button>\n                                                                                </div>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Folder\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.folder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, folder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"INBOX\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    Processed Folder (optional)\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.processedFolder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, processedFolder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"Processed\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                        </div>\n                                                                    )}\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* Messages Tab */}\n                                                    {activeSettingsTab === 'messages' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                {t('branches.messagesTab', { defaultValue: 'Nachrichten' })}\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                {/* Automatisches Versenden */}\n                                                                <div className=\"border-b border-gray-200 dark:border-gray-700 pb-4\">\n                                                                    <div className=\"flex items-center justify-between\">\n                                                                        <div>\n                                                                            <label className=\"block text-sm font-medium text-gray-900 dark:text-white mb-1\">\n                                                                                {t('branches.autoSendInvitation', { defaultValue: 'Automatisches Versenden aktivieren' })}\n                                                                            </label>\n                                                                            <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                                                                {t('branches.autoSendInvitationDescription', { defaultValue: 'Sendet Check-in-Einladungen automatisch 1 Tag vor Check-in-Date um 08:00 Uhr' })}\n                                                                            </p>\n                                                                        </div>\n                                                                        <input\n                                                                            type=\"checkbox\"\n                                                                            checked={formData.autoSendReservationInvitation}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                autoSendReservationInvitation: e.target.checked\n                                                                            })}\n                                                                            className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                                                                        />\n                                                                    </div>\n                                                                </div>\n\n                                                                {/* Mitteilungsvorlagen */}\n                                                                <div>\n                                                                    <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\n                                                                        {t('branches.messageTemplates', { defaultValue: 'Mitteilungsvorlagen' })}\n                                                                    </h5>\n                                                                    \n                                                                    <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-4\">\n                                                                        {t('branches.messageTemplatesDescription', { defaultValue: 'Konfiguriere die Vorlagen fr Check-in-Einladungen und Check-in-Besttigungen' })}\n                                                                    </p>\n\n                                                                    {/* Template Type Selector */}\n                                                                    <div className=\"mb-4\">\n                                                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                                                            {t('branches.messageType', { defaultValue: 'Mitteilungstyp' })}\n                                                                        </label>\n                                                                        <select\n                                                                            value={selectedTemplateType}\n                                                                            onChange={(e) => setSelectedTemplateType(e.target.value as 'checkInInvitation' | 'checkInConfirmation')}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        >\n                                                                            <option value=\"checkInInvitation\">\n                                                                                {t('branches.messageType.checkInInvitation', { defaultValue: 'Check-in-Einladung' })}\n                                                                            </option>\n                                                                            <option value=\"checkInConfirmation\">\n                                                                                {t('branches.messageType.checkInConfirmation', { defaultValue: 'Check-in-Besttigung' })}\n                                                                            </option>\n                                                                        </select>\n                                                                    </div>\n\n                                                                    {/* Language Selector */}\n                                                                    <div className=\"mb-4\">\n                                                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                                                            {t('branches.language', { defaultValue: 'Sprache' })}\n                                                                        </label>\n                                                                        <select\n                                                                            value={selectedLanguage}\n                                                                            onChange={(e) => setSelectedLanguage(e.target.value as 'en' | 'es' | 'de')}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        >\n                                                                            <option value=\"en\">{t('branches.language.en', { defaultValue: 'Englisch' })}</option>\n                                                                            <option value=\"es\">{t('branches.language.es', { defaultValue: 'Spanisch' })}</option>\n                                                                            <option value=\"de\">{t('branches.language.de', { defaultValue: 'Deutsch' })}</option>\n                                                                        </select>\n                                                                    </div>\n\n                                                                    {/* Template Fields */}\n                                                                    {(() => {\n                                                                        const currentTemplate = formData.messageTemplates?.[selectedTemplateType]?.[selectedLanguage] || {\n                                                                            whatsappTemplateName: '',\n                                                                            whatsappTemplateParams: [] as string[],\n                                                                            emailSubject: '',\n                                                                            emailContent: ''\n                                                                        };\n                                                                        \n                                                                        return (\n                                                                            <div className=\"space-y-4\">\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.whatsappTemplateName', { defaultValue: 'WhatsApp Template Name' })}\n                                                                                    </label>\n                                                                                    <input\n                                                                                        type=\"text\"\n                                                                                        value={currentTemplate.whatsappTemplateName || ''}\n                                                                                        onChange={(e) => {\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            whatsappTemplateName: e.target.value\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"reservation_checkin_invitation_en\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                </div>\n\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.whatsappTemplateParams', { defaultValue: 'WhatsApp Template Parameter' })}\n                                                                                    </label>\n                                                                                    <input\n                                                                                        type=\"text\"\n                                                                                        value={Array.isArray(currentTemplate.whatsappTemplateParams) ? currentTemplate.whatsappTemplateParams.join(', ') : (currentTemplate.whatsappTemplateParams || '')}\n                                                                                        onChange={(e) => {\n                                                                                            const params = e.target.value.split(',').map(p => p.trim()).filter(p => p);\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            whatsappTemplateParams: params\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"{{1}}, {{2}}, {{3}}\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                                                                                        {t('branches.whatsappTemplateParamsHint', { defaultValue: 'Komma-separiert, z.B. {{1}}, {{2}}, {{3}}' })}\n                                                                                    </p>\n                                                                                </div>\n\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.emailSubject', { defaultValue: 'Email Betreff' })}\n                                                                                    </label>\n                                                                                    <input\n                                                                                        type=\"text\"\n                                                                                        value={currentTemplate.emailSubject || ''}\n                                                                                        onChange={(e) => {\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            emailSubject: e.target.value\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"Welcome to La Familia Hostel - Online Check-in\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                </div>\n\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.emailContent', { defaultValue: 'Email Inhalt' })}\n                                                                                    </label>\n                                                                                    <textarea\n                                                                                        rows={10}\n                                                                                        value={currentTemplate.emailContent || ''}\n                                                                                        onChange={(e) => {\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            emailContent: e.target.value\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"Hello {{guestName}}, ...\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                                                                                        {t('branches.templateVariables', { defaultValue: 'Verfgbare Variablen' })}: \n                                                                                        <span className=\"font-mono\">\n                                                                                            {selectedTemplateType === 'checkInInvitation' \n                                                                                                ? t('branches.templateVariables.checkInInvitation', { defaultValue: '{{guestName}}, {{checkInLink}}, {{paymentLink}}' })\n                                                                                                : t('branches.templateVariables.checkInConfirmation', { defaultValue: '{{guestName}}, {{roomDisplay}}, {{doorPin}}, {{doorAppName}}' })\n                                                                                            }\n                                                                                        </span>\n                                                                                    </p>\n                                                                                </div>\n                                                                            </div>\n                                                                        );\n                                                                    })()}\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n                                                </div>\n                                            </>\n                                        )}\n                                    </div>\n                                </div>\n\n                                {/* Buttons */}\n                                <div className=\"flex justify-end pt-4 gap-2 px-6 pb-6 border-t dark:border-gray-700\">\n                                    <div className=\"relative group\">\n                                        <button\n                                            type=\"button\"\n                                            onClick={handleCloseModal}\n                                            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                                        >\n                                            <XMarkIcon className=\"h-5 w-5\" />\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {t('common.cancel', { defaultValue: 'Abbrechen' })}\n                                        </div>\n                                    </div>\n                                    <div className=\"relative group\">\n                                        <button\n                                            type=\"submit\"\n                                            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                                        >\n                                            <CheckIcon className=\"h-5 w-5\" />\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {editingBranch ? t('common.update', { defaultValue: 'Aktualisieren' }) : t('common.create', { defaultValue: 'Erstellen' })}\n                                        </div>\n                                    </div>\n                                </div>\n                            </form>\n                        </div>\n                    )}\n                </>\n            )}\n        </div>\n    );\n};\n\nexport default BranchManagementTab;\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface CreateTourProviderModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onProviderCreated: (newProvider: TourProvider) => void;\n}\n\nconst CreateTourProviderModal = ({ isOpen, onClose, onProviderCreated }: CreateTourProviderModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [name, setName] = useState('');\n    const [phone, setPhone] = useState('');\n    const [email, setEmail] = useState('');\n    const [contactPerson, setContactPerson] = useState('');\n    const [notes, setNotes] = useState('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const branchesRes = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Reset form when modal opens/closes\n    useEffect(() => {\n        if (!isOpen) {\n            setName('');\n            setPhone('');\n            setEmail('');\n            setContactPerson('');\n            setNotes('');\n            setBranchId('');\n            setError(null);\n        }\n    }, [isOpen]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierung\n        if (!name.trim()) {\n            setError(t('tours.providers.validation.nameRequired', { defaultValue: 'Name ist erforderlich' }));\n            return;\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.post(API_ENDPOINTS.TOUR_PROVIDERS.BASE, {\n                name: name.trim(),\n                phone: phone.trim() || null,\n                email: email.trim() || null,\n                contactPerson: contactPerson.trim() || null,\n                notes: notes.trim() || null,\n                branchId: branchId ? Number(branchId) : null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tours.providers.created', { defaultValue: 'Tour-Provider erfolgreich erstellt' }),\n                    'success'\n                );\n                onProviderCreated(response.data.data);\n                handleClose();\n            } else {\n                throw new Error(response.data?.message || t('tours.providers.createError', { defaultValue: 'Fehler beim Erstellen des Providers' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error creating provider:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        setName('');\n        setPhone('');\n        setEmail('');\n        setContactPerson('');\n        setNotes('');\n        setBranchId('');\n        setError(null);\n        onClose();\n    };\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.providers.create', { defaultValue: 'Neuer Tour-Provider' })}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.providers.create', { defaultValue: 'Neuer Tour-Provider' })}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default CreateTourProviderModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface EditTourProviderModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    provider: TourProvider | null;\n    onProviderUpdated: (updatedProvider: TourProvider) => void;\n}\n\nconst EditTourProviderModal = ({ isOpen, onClose, provider, onProviderUpdated }: EditTourProviderModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [name, setName] = useState('');\n    const [phone, setPhone] = useState('');\n    const [email, setEmail] = useState('');\n    const [contactPerson, setContactPerson] = useState('');\n    const [notes, setNotes] = useState('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches und setze Form-Daten\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const branchesRes = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Setze Form-Daten wenn Provider geladen wird\n    useEffect(() => {\n        if (provider) {\n            setName(provider.name || '');\n            setPhone(provider.phone || '');\n            setEmail(provider.email || '');\n            setContactPerson(provider.contactPerson || '');\n            setNotes(provider.notes || '');\n            setBranchId(provider.branchId || '');\n        } else {\n            setName('');\n            setPhone('');\n            setEmail('');\n            setContactPerson('');\n            setNotes('');\n            setBranchId('');\n        }\n        setError(null);\n    }, [provider, isOpen]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!provider) return;\n        setError(null);\n\n        // Validierung\n        if (!name.trim()) {\n            setError(t('tours.providers.validation.nameRequired', { defaultValue: 'Name ist erforderlich' }));\n            return;\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.put(API_ENDPOINTS.TOUR_PROVIDERS.BY_ID(provider.id), {\n                name: name.trim(),\n                phone: phone.trim() || null,\n                email: email.trim() || null,\n                contactPerson: contactPerson.trim() || null,\n                notes: notes.trim() || null,\n                branchId: branchId ? Number(branchId) : null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tours.providers.updated', { defaultValue: 'Tour-Provider erfolgreich aktualisiert' }),\n                    'success'\n                );\n                onProviderUpdated(response.data.data);\n                handleClose();\n            } else {\n                throw new Error(response.data?.message || t('tours.providers.updateError', { defaultValue: 'Fehler beim Aktualisieren des Providers' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error updating provider:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        onClose();\n    };\n\n    if (!provider) return null;\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.providers.edit', { defaultValue: 'Tour-Provider bearbeiten' })}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.providers.edit', { defaultValue: 'Tour-Provider bearbeiten' })}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default EditTourProviderModal;\n\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PencilIcon, TrashIcon, PlusIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport { TourProvider } from '../../types/tour.ts';\nimport CreateTourProviderModal from './CreateTourProviderModal.tsx';\nimport EditTourProviderModal from './EditTourProviderModal.tsx';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useError } from '../../contexts/ErrorContext.tsx';\n\ninterface TourProvidersTabProps {\n}\n\n// ProviderCard-Komponente fr mobile und Desktop-Ansicht\nconst ProviderCard: React.FC<{\n    provider: TourProvider;\n    onEdit: (provider: TourProvider) => void;\n    onDelete: (providerId: number) => void;\n    canEdit: boolean;\n    canDelete: boolean;\n}> = ({ provider, onEdit, onDelete, canEdit, canDelete }) => {\n    const { t } = useTranslation();\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4\">\n            {/* Header mit Provider-Name und Aktionen */}\n            <div className=\"flex justify-between items-start mb-2\">\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{provider.name}</h3>\n                \n                <div className=\"flex space-x-2\">\n                    {canEdit && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onEdit(provider)}\n                                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                                title={t('common.edit', { defaultValue: 'Bearbeiten' })}\n                            >\n                                <PencilIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.edit', { defaultValue: 'Bearbeiten' })}\n                            </div>\n                        </div>\n                    )}\n                    \n                    {canDelete && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onDelete(provider.id)}\n                                className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n                                title={t('common.delete', { defaultValue: 'Lschen' })}\n                            >\n                                <TrashIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.delete', { defaultValue: 'Lschen' })}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Details */}\n            <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                {provider.contactPerson && (\n                    <p>\n                        <span className=\"font-medium\">{t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}:</span>{' '}\n                        {provider.contactPerson}\n                    </p>\n                )}\n                {provider.phone && (\n                    <p>\n                        <span className=\"font-medium\">{t('tours.providers.phone', { defaultValue: 'Telefon' })}:</span>{' '}\n                        {provider.phone}\n                    </p>\n                )}\n                {provider.email && (\n                    <p>\n                        <span className=\"font-medium\">{t('tours.providers.email', { defaultValue: 'E-Mail' })}:</span>{' '}\n                        {provider.email}\n                    </p>\n                )}\n                {provider.notes && (\n                    <p className=\"mt-2 text-xs\">\n                        <span className=\"font-medium\">{t('tours.providers.notes', { defaultValue: 'Notizen' })}:</span>{' '}\n                        {provider.notes}\n                    </p>\n                )}\n            </div>\n        </div>\n    );\n};\n\nconst TourProvidersTab: React.FC<TourProvidersTabProps> = () => {\n    const { t } = useTranslation();\n    const { showMessage } = useMessage();\n    \n    // Fehlerbehandlung mit Fallback\n    const errorContext = useError();\n    const handleErrorContext = errorContext?.handleError || ((err: unknown, context?: Record<string, unknown>) => {\n        console.error('Error:', err, context);\n        const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                             (err as { message?: string })?.message || \n                             t('errors.unknownError', { defaultValue: 'Ein Fehler ist aufgetreten' });\n        showMessage(errorMessage, 'error');\n    });\n    const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n    const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n    const [editingProvider, setEditingProvider] = useState<TourProvider | null>(null);\n    const [providers, setProviders] = useState<TourProvider[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [searchTerm, setSearchTerm] = useState('');\n    const { hasPermission } = usePermissions();\n\n    // Berechtigungen prfen\n    const canCreate = hasPermission('tour_providers', 'write', 'table');\n    const canEdit = hasPermission('tour_providers', 'write', 'table');\n    const canDelete = hasPermission('tour_providers', 'write', 'table');\n\n    // Providers laden\n    const fetchProviders = useCallback(async () => {\n        setLoading(true);\n        try {\n            const response = await axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS.BASE);\n            const data = response.data?.data || response.data || [];\n            setProviders(Array.isArray(data) ? data : []);\n        } catch (error: unknown) {\n            console.error('Error loading tour providers:', error);\n            handleErrorContext(error);\n            const errorMessage = error.response?.data?.message || t('tours.providers.loadError', { defaultValue: 'Fehler beim Laden der Provider' });\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    }, [handleErrorContext]);\n\n    useEffect(() => {\n        fetchProviders();\n    }, [fetchProviders]);\n\n    // Gefilterte Provider\n    const filteredProviders = providers.filter(provider => {\n        if (!searchTerm) return true;\n        const search = searchTerm.toLowerCase();\n        return (\n            provider.name.toLowerCase().includes(search) ||\n            provider.contactPerson?.toLowerCase().includes(search) ||\n            provider.phone?.toLowerCase().includes(search) ||\n            provider.email?.toLowerCase().includes(search) ||\n            provider.notes?.toLowerCase().includes(search)\n        );\n    });\n\n    // Handler fr Create\n    const handleCreate = () => {\n        setIsCreateModalOpen(true);\n    };\n\n    // Handler fr Edit\n    const handleEdit = (provider: TourProvider) => {\n        setEditingProvider(provider);\n        setIsEditModalOpen(true);\n    };\n\n    // Handler fr Delete\n    const handleDelete = async (providerId: number) => {\n        if (!window.confirm(t('tours.providers.deleteConfirm', { defaultValue: 'Mchten Sie diesen Provider wirklich lschen?' }))) {\n            return;\n        }\n\n        try {\n            await axiosInstance.delete(API_ENDPOINTS.TOUR_PROVIDERS.BY_ID(providerId));\n            showMessage(\n                t('tours.providers.deleted', { defaultValue: 'Tour-Provider erfolgreich gelscht' }),\n                'success'\n            );\n            fetchProviders();\n        } catch (error: any) {\n            console.error('Error deleting provider:', error);\n            handleErrorContext(error);\n            const errorMessage = error.response?.data?.message || t('errors.unknownError');\n            showMessage(errorMessage, 'error');\n        }\n    };\n\n    // Handler fr Provider erstellt\n    const handleProviderCreated = (newProvider: TourProvider) => {\n        fetchProviders();\n    };\n\n    // Handler fr Provider aktualisiert\n    const handleProviderUpdated = (updatedProvider: TourProvider) => {\n        fetchProviders();\n    };\n\n    if (loading) {\n        return (\n            <div className=\"flex justify-center items-center py-12\">\n                <div className=\"text-gray-500 dark:text-gray-400\">{t('common.loading', { defaultValue: 'Lade...' })}</div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"space-y-4\">\n            {/* Header mit Suche und Create-Button */}\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n                <div className=\"flex-1 w-full sm:max-w-md\">\n                    <input\n                        type=\"text\"\n                        placeholder={t('tours.providers.search', { defaultValue: 'Provider suchen...' })}\n                        value={searchTerm}\n                        onChange={(e) => setSearchTerm(e.target.value)}\n                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                </div>\n                {canCreate && (\n                    <div className=\"relative group\">\n                        <button \n                            onClick={handleCreate}\n                            className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                            style={{ width: '30.19px', height: '30.19px' }}\n                            aria-label={t('tours.providers.create', { defaultValue: 'Neuer Provider' })}\n                        >\n                            <PlusIcon className=\"h-4 w-4\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {t('tours.providers.create', { defaultValue: 'Neuer Provider' })}\n                        </div>\n                    </div>\n                )}\n            </div>\n\n            {/* Provider-Liste */}\n            {filteredProviders.length === 0 ? (\n                <div className=\"text-center py-12 text-gray-500 dark:text-gray-400\">\n                    {searchTerm\n                        ? t('tours.providers.noResults', { defaultValue: 'Keine Provider gefunden' })\n                        : t('tours.providers.empty', { defaultValue: 'Keine Tour-Provider vorhanden' })}\n                </div>\n            ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                    {filteredProviders.map(provider => (\n                        <ProviderCard\n                            key={provider.id}\n                            provider={provider}\n                            onEdit={handleEdit}\n                            onDelete={handleDelete}\n                            canEdit={canEdit}\n                            canDelete={canDelete}\n                        />\n                    ))}\n                </div>\n            )}\n\n            {/* Modals */}\n            <CreateTourProviderModal\n                isOpen={isCreateModalOpen}\n                onClose={() => setIsCreateModalOpen(false)}\n                onProviderCreated={handleProviderCreated}\n            />\n            <EditTourProviderModal\n                isOpen={isEditModalOpen}\n                onClose={() => {\n                    setIsEditModalOpen(false);\n                    setEditingProvider(null);\n                }}\n                provider={editingProvider}\n                onProviderUpdated={handleProviderUpdated}\n            />\n        </div>\n    );\n};\n\nexport default TourProvidersTab;\n\n","export enum TourType {\r\n  OWN = 'own',\r\n  EXTERNAL = 'external'\r\n}\r\n\r\nexport enum TourBookingStatus {\r\n  CONFIRMED = 'confirmed',\r\n  CANCELLED = 'cancelled',\r\n  COMPLETED = 'completed',\r\n  NO_SHOW = 'no_show'\r\n}\r\n\r\nexport enum MessageDirection {\r\n  OUTGOING = 'outgoing',\r\n  INCOMING = 'incoming'\r\n}\r\n\r\nexport enum MessageStatus {\r\n  SENT = 'sent',\r\n  DELIVERED = 'delivered',\r\n  READ = 'read',\r\n  FAILED = 'failed'\r\n}\r\n\r\nexport interface Tour {\r\n  id: number;\r\n  title: string;\r\n  description?: string | null;\r\n  type: TourType;\r\n  isActive: boolean;\r\n  duration?: number | null;\r\n  maxParticipants?: number | null;\r\n  minParticipants?: number | null;\r\n  price?: number | string | null;\r\n  currency?: string | null;\r\n  location?: string | null;\r\n  meetingPoint?: string | null;\r\n  includes?: string | null;\r\n  excludes?: string | null;\r\n  requirements?: string | null;\r\n  totalCommission?: number | string | null;\r\n  totalCommissionPercent?: number | string | null;\r\n  sellerCommissionPercent?: number | string | null;\r\n  sellerCommissionFixed?: number | string | null;\r\n  externalProviderId?: number | null;\r\n  externalProvider?: TourProvider | null;\r\n  externalBookingUrl?: string | null;\r\n  imageUrl?: string | null;\r\n  galleryUrls?: string[] | null;\r\n  availableFrom?: string | null;\r\n  availableTo?: string | null;\r\n  recurringSchedule?: any | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  branch?: { id: number; name: string } | null;\r\n  createdById?: number | null;\r\n  createdBy?: { id: number; firstName: string; lastName: string } | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourProvider {\r\n  id: number;\r\n  name: string;\r\n  phone?: string | null;\r\n  email?: string | null;\r\n  contactPerson?: string | null;\r\n  notes?: string | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourBooking {\r\n  id: number;\r\n  tourId: number;\r\n  tour?: Tour | null;\r\n  bookingDate: string;\r\n  tourDate: string;\r\n  numberOfParticipants: number;\r\n  totalPrice: number | string;\r\n  currency: string;\r\n  customerName: string;\r\n  customerEmail?: string | null;\r\n  customerPhone?: string | null;\r\n  customerNotes?: string | null;\r\n  paymentStatus: 'pending' | 'paid' | 'partially_paid' | 'refunded';\r\n  amountPaid?: number | string | null;\r\n  amountPending?: number | string | null;\r\n  paymentLink?: string | null;\r\n  paymentDeadline?: string | null;\r\n  autoCancelEnabled?: boolean;\r\n  reservedUntil?: string | null;\r\n  bookedById?: number | null;\r\n  bookedBy?: { id: number; firstName: string; lastName: string } | null;\r\n  commissionAmount?: number | string | null;\r\n  commissionCalculatedAt?: string | null;\r\n  status: TourBookingStatus;\r\n  cancelledBy?: string | null;\r\n  cancelledAt?: string | null;\r\n  cancelledReason?: string | null;\r\n  isExternal: boolean;\r\n  externalBookingId?: string | null;\r\n  externalStatus?: string | null;\r\n  externalMessage?: string | null;\r\n  alternativeTours?: number[] | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  branch?: { id: number; name: string } | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourReservation {\r\n  id: number;\r\n  tourId: number;\r\n  tour?: Tour | null;\r\n  bookingId: number;\r\n  booking?: TourBooking | null;\r\n  reservationId: number;\r\n  reservation?: any | null;\r\n  tourPrice: number | string;\r\n  accommodationPrice: number | string;\r\n  currency: string;\r\n  tourPricePaid?: number | string | null;\r\n  tourPricePending?: number | string | null;\r\n  accommodationPaid?: number | string | null;\r\n  accommodationPending?: number | string | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourWhatsAppMessage {\r\n  id: number;\r\n  bookingId: number;\r\n  booking?: TourBooking | null;\r\n  direction: MessageDirection;\r\n  message: string;\r\n  phoneNumber: string;\r\n  sentAt: string;\r\n  status: MessageStatus;\r\n  errorMessage?: string | null;\r\n  processed: boolean;\r\n  processedAt?: string | null;\r\n  action?: string | null;\r\n  extractedData?: any | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourType, TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface CreateTourModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTourCreated: (newTour: Tour) => void;\n}\n\nconst CreateTourModal = ({ isOpen, onClose, onTourCreated }: CreateTourModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [title, setTitle] = useState('');\n    const [description, setDescription] = useState('');\n    const [type, setType] = useState<TourType>(TourType.OWN);\n    const [isActive, setIsActive] = useState(true);\n    const [duration, setDuration] = useState<number | ''>('');\n    const [maxParticipants, setMaxParticipants] = useState<number | ''>('');\n    const [minParticipants, setMinParticipants] = useState<number | ''>('');\n    const [price, setPrice] = useState<number | ''>('');\n    const [currency, setCurrency] = useState('COP');\n    const [location, setLocation] = useState('');\n    const [meetingPoint, setMeetingPoint] = useState('');\n    const [includes, setIncludes] = useState('');\n    const [excludes, setExcludes] = useState('');\n    const [requirements, setRequirements] = useState('');\n    const [totalCommission, setTotalCommission] = useState<number | ''>('');\n    const [totalCommissionPercent, setTotalCommissionPercent] = useState<number | ''>('');\n    const [sellerCommissionPercent, setSellerCommissionPercent] = useState<number | ''>('');\n    const [sellerCommissionFixed, setSellerCommissionFixed] = useState<number | ''>('');\n    const [externalProviderId, setExternalProviderId] = useState<number | ''>('');\n    const [externalBookingUrl, setExternalBookingUrl] = useState('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    const [imageFile, setImageFile] = useState<File | null>(null);\n    const [imagePreview, setImagePreview] = useState<string | null>(null);\n    const [galleryFiles, setGalleryFiles] = useState<File[]>([]);\n    const [galleryPreviews, setGalleryPreviews] = useState<string[]>([]);\n    const [uploadingImage, setUploadingImage] = useState(false);\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [tourProviders, setTourProviders] = useState<TourProvider[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches und TourProviders\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const [branchesRes, providersRes] = await Promise.all([\n                    axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE),\n                    axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS?.BASE || '/api/tour-providers')\n                ]);\n                \n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n                setTourProviders(providersRes.data?.data || providersRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Reset form when modal opens/closes\n    useEffect(() => {\n        if (!isOpen) {\n            setTitle('');\n            setDescription('');\n            setType(TourType.OWN);\n            setIsActive(true);\n            setDuration('');\n            setMaxParticipants('');\n            setMinParticipants('');\n            setPrice('');\n            setCurrency('COP');\n            setLocation('');\n            setMeetingPoint('');\n            setIncludes('');\n            setExcludes('');\n            setRequirements('');\n            setTotalCommission('');\n            setTotalCommissionPercent('');\n            setSellerCommissionPercent('');\n            setSellerCommissionFixed('');\n            setExternalProviderId('');\n            setExternalBookingUrl('');\n            setBranchId('');\n            setImageFile(null);\n            setImagePreview(null);\n            setGalleryFiles([]);\n            setGalleryPreviews([]);\n            setError(null);\n        }\n    }, [isOpen]);\n    \n    // Bild-Vorschau erstellen\n    const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (file) {\n            setImageFile(file);\n            const reader = new FileReader();\n            reader.onloadend = () => {\n                setImagePreview(reader.result as string);\n            };\n            reader.readAsDataURL(file);\n        }\n    };\n    \n    const handleGalleryChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const files = Array.from(e.target.files || []);\n        if (files.length > 0) {\n            setGalleryFiles(prev => [...prev, ...files]);\n            files.forEach(file => {\n                const reader = new FileReader();\n                reader.onloadend = () => {\n                    setGalleryPreviews(prev => [...prev, reader.result as string]);\n                };\n                reader.readAsDataURL(file);\n            });\n        }\n    };\n    \n    const removeGalleryImage = (index: number) => {\n        setGalleryFiles(prev => prev.filter((_, i) => i !== index));\n        setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierungen\n        if (!title.trim() || title.trim().length < 3) {\n            setError(t('tours.validation.titleMinLength', { defaultValue: 'Titel muss mindestens 3 Zeichen lang sein' }));\n            return;\n        }\n\n        const maxPart = maxParticipants ? Number(maxParticipants) : null;\n        const minPart = minParticipants ? Number(minParticipants) : null;\n        if (maxPart !== null && minPart !== null && maxPart < minPart) {\n            setError(t('tours.validation.maxParticipantsMin', { defaultValue: 'Maximale Teilnehmeranzahl muss >= minimale Teilnehmeranzahl sein' }));\n            return;\n        }\n\n        if (type === TourType.EXTERNAL && !externalProviderId) {\n            setError(t('tours.validation.externalProviderRequired', { defaultValue: 'Externer Anbieter ist bei externen Touren erforderlich' }));\n            return;\n        }\n\n        // availableFrom <= availableTo Validierung (falls beide gesetzt) - wird im Backend validiert\n\n        // Preise >= 0\n        if (price !== '' && Number(price) < 0) {\n            setError(t('tours.validation.priceNonNegative', { defaultValue: 'Preis muss >= 0 sein' }));\n            return;\n        }\n\n        if (totalCommission !== '' && Number(totalCommission) < 0) {\n            setError(t('tours.validation.commissionNonNegative', { defaultValue: 'Kommission muss >= 0 sein' }));\n            return;\n        }\n\n        setLoading(true);\n\n        try {\n            const tourData: {\n                title: string;\n                description: string | null;\n                type: TourType;\n                isActive: boolean;\n                duration: number | null;\n                maxParticipants: number | null;\n                minParticipants: number | null;\n                price: number | null;\n                currency: string;\n                location: string | null;\n                meetingPoint: string | null;\n                includes: string | null;\n                excludes: string | null;\n                requirements: string | null;\n                totalCommission: number | null;\n                totalCommissionPercent: number | null;\n                sellerCommissionPercent: number | null;\n                sellerCommissionFixed: number | null;\n                externalProviderId: number | null;\n                externalBookingUrl: string | null;\n                branchId: number | null;\n            } = {\n                title,\n                description: description || null,\n                type,\n                isActive,\n                duration: duration ? Number(duration) : null,\n                maxParticipants: maxParticipants ? Number(maxParticipants) : null,\n                minParticipants: minParticipants ? Number(minParticipants) : null,\n                price: price ? Number(price) : null,\n                currency: currency || 'COP',\n                location: location || null,\n                meetingPoint: meetingPoint || null,\n                includes: includes || null,\n                excludes: excludes || null,\n                requirements: requirements || null,\n                totalCommission: totalCommission ? Number(totalCommission) : null,\n                totalCommissionPercent: totalCommissionPercent ? Number(totalCommissionPercent) : null,\n                sellerCommissionPercent: sellerCommissionPercent ? Number(sellerCommissionPercent) : null,\n                sellerCommissionFixed: sellerCommissionFixed ? Number(sellerCommissionFixed) : null,\n                externalProviderId: externalProviderId ? Number(externalProviderId) : null,\n                externalBookingUrl: externalBookingUrl || null,\n                branchId: branchId ? Number(branchId) : null\n            };\n\n            const response = await axiosInstance.post(API_ENDPOINTS.TOURS.BASE, tourData);\n            \n            if (response.data.success) {\n                const createdTour = response.data.data;\n                \n                // Hauptbild hochladen (falls vorhanden)\n                if (imageFile && createdTour.id) {\n                    try {\n                        setUploadingImage(true);\n                        const formData = new FormData();\n                        formData.append('image', imageFile);\n                        await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_IMAGE(createdTour.id), formData, {\n                            headers: { 'Content-Type': 'multipart/form-data' }\n                        });\n                    } catch (imgErr: unknown) {\n                        console.error('Error uploading main image:', imgErr);\n                        showMessage(t('tours.imageUploadError', 'Tour erstellt, aber Fehler beim Hochladen des Bildes'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                // Galerie-Bilder hochladen (falls vorhanden)\n                if (galleryFiles.length > 0 && createdTour.id) {\n                    try {\n                        setUploadingImage(true);\n                        for (const file of galleryFiles) {\n                            const formData = new FormData();\n                            formData.append('image', file);\n                            await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_GALLERY(createdTour.id), formData, {\n                                headers: { 'Content-Type': 'multipart/form-data' }\n                            });\n                        }\n                    } catch (galleryErr: unknown) {\n                        console.error('Error uploading gallery images:', galleryErr);\n                        showMessage(t('tours.galleryUploadError', 'Tour erstellt, aber Fehler beim Hochladen der Galerie-Bilder'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                showMessage(t('tours.createSuccess', 'Tour erfolgreich erstellt'), 'success');\n                // Lade Tour neu, um Bilder zu erhalten\n                const updatedResponse = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(createdTour.id));\n                onTourCreated(updatedResponse.data.data);\n                handleClose();\n            } else {\n                setError(response.data.message || t('errors.saveError'));\n            }\n        } catch (err: unknown) {\n            console.error('Error creating tour:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.saveError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        setTitle('');\n        setDescription('');\n        setType(TourType.OWN);\n        setIsActive(true);\n        setDuration('');\n        setMaxParticipants('');\n        setMinParticipants('');\n        setPrice('');\n        setCurrency('COP');\n        setLocation('');\n        setMeetingPoint('');\n        setIncludes('');\n        setExcludes('');\n        setRequirements('');\n        setTotalCommission('');\n        setTotalCommissionPercent('');\n        setSellerCommissionPercent('');\n        setSellerCommissionFixed('');\n        setExternalProviderId('');\n        setExternalBookingUrl('');\n        setBranchId('');\n        setImageFile(null);\n        setImagePreview(null);\n        setGalleryFiles([]);\n        setGalleryPreviews([]);\n        setError(null);\n        onClose();\n    };\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\n                        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.create', 'Neue Tour erstellen')}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.create', 'Neue Tour erstellen')}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Bilder */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.images', 'Bilder')}\n                            </h3>\n                            \n                            {/* Hauptbild */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.mainImage', 'Hauptbild')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    onChange={handleImageChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {imagePreview && (\n                                    <div className=\"mt-2 relative inline-block\">\n                                        <img\n                                            src={imagePreview}\n                                            alt=\"Vorschau\"\n                                            className=\"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                        />\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* Galerie */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.gallery', 'Galerie')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    multiple\n                                    onChange={handleGalleryChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {galleryPreviews.length > 0 && (\n                                    <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                                        {galleryPreviews.map((preview, index) => (\n                                            <div key={index} className=\"relative\">\n                                                <img\n                                                    src={preview}\n                                                    alt={`Galerie ${index + 1}`}\n                                                    className=\"w-full h-24 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                                />\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={() => removeGalleryImage(index)}\n                                                    className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                    title={t('tours.deleteImage', 'Bild lschen')}\n                                                >\n                                                    <XMarkIcon className=\"h-4 w-4\" />\n                                                </button>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default CreateTourModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS, getTourImageUrl, getTourGalleryImageUrl } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourType, TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface EditTourModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTourUpdated: (updatedTour: Tour) => void;\n    tour: Tour | null;\n}\n\nconst EditTourModal = ({ isOpen, onClose, onTourUpdated, tour }: EditTourModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [title, setTitle] = useState(tour?.title || '');\n    const [description, setDescription] = useState(tour?.description || '');\n    const [type, setType] = useState<TourType>(tour?.type || TourType.OWN);\n    const [isActive, setIsActive] = useState(tour?.isActive ?? true);\n    const [duration, setDuration] = useState<number | ''>(tour?.duration || '');\n    const [maxParticipants, setMaxParticipants] = useState<number | ''>(tour?.maxParticipants || '');\n    const [minParticipants, setMinParticipants] = useState<number | ''>(tour?.minParticipants || '');\n    const [price, setPrice] = useState<number | ''>(tour?.price ? (typeof tour.price === 'string' ? parseFloat(tour.price) : tour.price) : '');\n    const [currency, setCurrency] = useState(tour?.currency || 'COP');\n    const [location, setLocation] = useState(tour?.location || '');\n    const [meetingPoint, setMeetingPoint] = useState(tour?.meetingPoint || '');\n    const [includes, setIncludes] = useState(tour?.includes || '');\n    const [excludes, setExcludes] = useState(tour?.excludes || '');\n    const [requirements, setRequirements] = useState(tour?.requirements || '');\n    const [totalCommission, setTotalCommission] = useState<number | ''>(tour?.totalCommission ? (typeof tour.totalCommission === 'string' ? parseFloat(tour.totalCommission) : tour.totalCommission) : '');\n    const [totalCommissionPercent, setTotalCommissionPercent] = useState<number | ''>(tour?.totalCommissionPercent ? (typeof tour.totalCommissionPercent === 'string' ? parseFloat(tour.totalCommissionPercent) : tour.totalCommissionPercent) : '');\n    const [sellerCommissionPercent, setSellerCommissionPercent] = useState<number | ''>(tour?.sellerCommissionPercent ? (typeof tour.sellerCommissionPercent === 'string' ? parseFloat(tour.sellerCommissionPercent) : tour.sellerCommissionPercent) : '');\n    const [sellerCommissionFixed, setSellerCommissionFixed] = useState<number | ''>(tour?.sellerCommissionFixed ? (typeof tour.sellerCommissionFixed === 'string' ? parseFloat(tour.sellerCommissionFixed) : tour.sellerCommissionFixed) : '');\n    const [externalProviderId, setExternalProviderId] = useState<number | ''>(tour?.externalProviderId || '');\n    const [externalBookingUrl, setExternalBookingUrl] = useState(tour?.externalBookingUrl || '');\n    const [branchId, setBranchId] = useState<number | ''>(tour?.branchId || '');\n    const [imageFile, setImageFile] = useState<File | null>(null);\n    const [imagePreview, setImagePreview] = useState<string | null>(tour?.imageUrl ? getTourImageUrl(tour.id) : null);\n    const [galleryFiles, setGalleryFiles] = useState<File[]>([]);\n    const [galleryPreviews, setGalleryPreviews] = useState<string[]>(tour?.galleryUrls?.map((url, index) => getTourGalleryImageUrl(tour.id, index)) || []);\n    const [uploadingImage, setUploadingImage] = useState(false);\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [tourProviders, setTourProviders] = useState<TourProvider[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches und TourProviders\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const [branchesRes, providersRes] = await Promise.all([\n                    axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE),\n                    axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS?.BASE || '/api/tour-providers')\n                ]);\n                \n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n                setTourProviders(providersRes.data?.data || providersRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Update form when tour changes\n    useEffect(() => {\n        if (tour) {\n            setTitle(tour.title || '');\n            setDescription(tour.description || '');\n            setType(tour.type || TourType.OWN);\n            setIsActive(tour.isActive ?? true);\n            setDuration(tour.duration || '');\n            setMaxParticipants(tour.maxParticipants || '');\n            setMinParticipants(tour.minParticipants || '');\n            setPrice(tour.price ? (typeof tour.price === 'string' ? parseFloat(tour.price) : tour.price) : '');\n            setCurrency(tour.currency || 'COP');\n            setLocation(tour.location || '');\n            setMeetingPoint(tour.meetingPoint || '');\n            setIncludes(tour.includes || '');\n            setExcludes(tour.excludes || '');\n            setRequirements(tour.requirements || '');\n            setTotalCommission(tour.totalCommission ? (typeof tour.totalCommission === 'string' ? parseFloat(tour.totalCommission) : tour.totalCommission) : '');\n            setTotalCommissionPercent(tour.totalCommissionPercent ? (typeof tour.totalCommissionPercent === 'string' ? parseFloat(tour.totalCommissionPercent) : tour.totalCommissionPercent) : '');\n            setSellerCommissionPercent(tour.sellerCommissionPercent ? (typeof tour.sellerCommissionPercent === 'string' ? parseFloat(tour.sellerCommissionPercent) : tour.sellerCommissionPercent) : '');\n            setSellerCommissionFixed(tour.sellerCommissionFixed ? (typeof tour.sellerCommissionFixed === 'string' ? parseFloat(tour.sellerCommissionFixed) : tour.sellerCommissionFixed) : '');\n            setExternalProviderId(tour.externalProviderId || '');\n            setExternalBookingUrl(tour.externalBookingUrl || '');\n            setBranchId(tour.branchId || '');\n            setImagePreview(tour.imageUrl ? getTourImageUrl(tour.id) : null);\n            setGalleryPreviews(tour.galleryUrls?.map((url, index) => getTourGalleryImageUrl(tour.id, index)) || []);\n        }\n    }, [tour]);\n    \n    // Bild-Vorschau erstellen\n    const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (file) {\n            setImageFile(file);\n            const reader = new FileReader();\n            reader.onloadend = () => {\n                setImagePreview(reader.result as string);\n            };\n            reader.readAsDataURL(file);\n        }\n    };\n    \n    const handleGalleryChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const files = Array.from(e.target.files || []);\n        if (files.length > 0) {\n            setGalleryFiles(prev => [...prev, ...files]);\n            files.forEach(file => {\n                const reader = new FileReader();\n                reader.onloadend = () => {\n                    setGalleryPreviews(prev => [...prev, reader.result as string]);\n                };\n                reader.readAsDataURL(file);\n            });\n        }\n    };\n    \n    const removeMainImage = async () => {\n        if (!tour?.imageUrl) return;\n        \n        try {\n            await axiosInstance.delete(API_ENDPOINTS.TOURS.DELETE_IMAGE(tour.id));\n            // Sofort lokale States aktualisieren (UI-Update)\n            setImagePreview(null);\n            setImageFile(null);\n            // Lade Tour neu fr Datenbank-Sync\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tour.id));\n            if (response.data.success) {\n                onTourUpdated(response.data.data);\n                showMessage(t('tours.imageDeleted', 'Hauptbild erfolgreich gelscht'), 'success');\n            }\n        } catch (err: unknown) {\n            console.error('Error deleting main image:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.deleteError');\n            showMessage(errorMessage, 'error');\n        }\n    };\n    \n    const removeGalleryImage = async (index: number) => {\n        if (!tour) return;\n        // Wenn es ein existierendes Bild ist (aus tour.galleryUrls), lsche es vom Server\n        const currentGallery = tour.galleryUrls || [];\n        if (index < currentGallery.length) {\n            try {\n                await axiosInstance.delete(API_ENDPOINTS.TOURS.DELETE_GALLERY_IMAGE(tour.id, index));\n                // Sofort lokale States aktualisieren (UI-Update)\n                setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\n                // Lade Tour neu fr Datenbank-Sync\n                const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tour.id));\n                if (response.data.success) {\n                    onTourUpdated(response.data.data);\n                    showMessage(t('tours.galleryImageDeleted', 'Galerie-Bild erfolgreich gelscht'), 'success');\n                }\n            } catch (err: unknown) {\n                console.error('Error deleting gallery image:', err);\n                const errorMessage = (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.deleteError');\n                showMessage(errorMessage, 'error');\n            }\n        } else {\n            // Wenn es ein neues Bild ist (noch nicht hochgeladen), entferne es nur aus dem State\n            const newIndex = index - currentGallery.length;\n            setGalleryFiles(prev => prev.filter((_, i) => i !== newIndex));\n            setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\n        }\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierungen\n        if (!title.trim() || title.trim().length < 3) {\n            setError(t('tours.validation.titleMinLength', { defaultValue: 'Titel muss mindestens 3 Zeichen lang sein' }));\n            return;\n        }\n\n        const maxPart = maxParticipants ? Number(maxParticipants) : null;\n        const minPart = minParticipants ? Number(minParticipants) : null;\n        if (maxPart !== null && minPart !== null && maxPart < minPart) {\n            setError(t('tours.validation.maxParticipantsMin', { defaultValue: 'Maximale Teilnehmeranzahl muss >= minimale Teilnehmeranzahl sein' }));\n            return;\n        }\n\n        if (type === TourType.EXTERNAL && !externalProviderId) {\n            setError(t('tours.validation.externalProviderRequired', { defaultValue: 'Externer Anbieter ist bei externen Touren erforderlich' }));\n            return;\n        }\n\n        // Preise >= 0\n        if (price !== '' && Number(price) < 0) {\n            setError(t('tours.validation.priceNonNegative', { defaultValue: 'Preis muss >= 0 sein' }));\n            return;\n        }\n\n        if (totalCommission !== '' && Number(totalCommission) < 0) {\n            setError(t('tours.validation.commissionNonNegative', { defaultValue: 'Kommission muss >= 0 sein' }));\n            return;\n        }\n\n        setLoading(true);\n\n        try {\n            const tourData: Partial<Tour> & {\n                imageFile?: File | null;\n                galleryFiles?: File[];\n            } = {\n                title,\n                description: description || null,\n                type,\n                isActive,\n                duration: duration ? Number(duration) : null,\n                maxParticipants: maxParticipants ? Number(maxParticipants) : null,\n                minParticipants: minParticipants ? Number(minParticipants) : null,\n                price: price ? Number(price) : null,\n                currency: currency || 'COP',\n                location: location || null,\n                meetingPoint: meetingPoint || null,\n                includes: includes || null,\n                excludes: excludes || null,\n                requirements: requirements || null,\n                totalCommission: totalCommission ? Number(totalCommission) : null,\n                totalCommissionPercent: totalCommissionPercent ? Number(totalCommissionPercent) : null,\n                sellerCommissionPercent: sellerCommissionPercent ? Number(sellerCommissionPercent) : null,\n                sellerCommissionFixed: sellerCommissionFixed ? Number(sellerCommissionFixed) : null,\n                externalProviderId: externalProviderId ? Number(externalProviderId) : null,\n                externalBookingUrl: externalBookingUrl || null,\n                branchId: branchId ? Number(branchId) : null\n            };\n\n            const response = await axiosInstance.put(API_ENDPOINTS.TOURS.BY_ID(tour.id), tourData);\n            \n            if (response.data.success) {\n                const updatedTour = response.data.data;\n                \n                // Hauptbild hochladen (falls gendert)\n                if (imageFile) {\n                    try {\n                        setUploadingImage(true);\n                        const formData = new FormData();\n                        formData.append('image', imageFile);\n                        await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_IMAGE(tourId), formData, {\n                            headers: { 'Content-Type': 'multipart/form-data' }\n                        });\n                    } catch (imgErr: unknown) {\n                        console.error('Error uploading main image:', imgErr);\n                        showMessage(t('tours.imageUploadError', 'Tour aktualisiert, aber Fehler beim Hochladen des Bildes'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                // Neue Galerie-Bilder hochladen (falls vorhanden)\n                if (galleryFiles.length > 0) {\n                    try {\n                        setUploadingImage(true);\n                        for (const file of galleryFiles) {\n                            const formData = new FormData();\n                            formData.append('image', file);\n                            await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_GALLERY(tourId), formData, {\n                                headers: { 'Content-Type': 'multipart/form-data' }\n                            });\n                        }\n                    } catch (galleryErr: unknown) {\n                        console.error('Error uploading gallery images:', galleryErr);\n                        showMessage(t('tours.galleryUploadError', 'Tour aktualisiert, aber Fehler beim Hochladen der Galerie-Bilder'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                showMessage(t('tours.updateSuccess', 'Tour erfolgreich aktualisiert'), 'success');\n                // Lade Tour neu, um aktualisierte Bilder zu erhalten\n                const updatedResponse = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tourId));\n                onTourUpdated(updatedResponse.data.data);\n                handleClose();\n            } else {\n                setError(response.data.message || t('errors.saveError'));\n            }\n        } catch (err: unknown) {\n            console.error('Error updating tour:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.saveError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        onClose();\n    };\n\n    if (!tour) return null;\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\n                        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.edit', 'Tour bearbeiten')}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Bild-Upload */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.images', 'Bilder')}\n                            </h3>\n                            \n                            {/* Hauptbild */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.mainImage', 'Hauptbild')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    onChange={handleImageChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {imagePreview && (\n                                    <div className=\"mt-2 relative inline-block\">\n                                        <img\n                                            src={imagePreview}\n                                            alt=\"Vorschau\"\n                                            className=\"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                        />\n                                        {tour?.imageUrl && (\n                                            <button\n                                                type=\"button\"\n                                                onClick={removeMainImage}\n                                                className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                title={t('tours.deleteImage', 'Hauptbild lschen')}\n                                            >\n                                                <XMarkIcon className=\"h-4 w-4\" />\n                                            </button>\n                                        )}\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* Galerie */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.gallery', 'Galerie')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    multiple\n                                    onChange={handleGalleryChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {galleryPreviews.length > 0 && (\n                                    <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                                        {galleryPreviews.map((preview, index) => (\n                                            <div key={index} className=\"relative\">\n                                                <img\n                                                    src={preview}\n                                                    alt={`Galerie ${index + 1}`}\n                                                    className=\"w-full h-32 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                                />\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={() => removeGalleryImage(index)}\n                                                    className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600\"\n                                                >\n                                                    <XMarkIcon className=\"h-4 w-4\" />\n                                                </button>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData || uploadingImage}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.edit', 'Tour bearbeiten')}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Bilder */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.images', 'Bilder')}\n                            </h3>\n                            \n                            {/* Hauptbild */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.mainImage', 'Hauptbild')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    onChange={handleImageChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {imagePreview && (\n                                    <div className=\"mt-2 relative inline-block\">\n                                        <img\n                                            src={imagePreview}\n                                            alt=\"Vorschau\"\n                                            className=\"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                        />\n                                        {tour?.imageUrl && (\n                                            <button\n                                                type=\"button\"\n                                                onClick={removeMainImage}\n                                                className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                title={t('tours.deleteImage', 'Hauptbild lschen')}\n                                            >\n                                                <XMarkIcon className=\"h-4 w-4\" />\n                                            </button>\n                                        )}\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* Galerie */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.gallery', 'Galerie')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    multiple\n                                    onChange={handleGalleryChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {galleryPreviews.length > 0 && (\n                                    <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                                        {galleryPreviews.map((preview, index) => (\n                                            <div key={index} className=\"relative\">\n                                                <img\n                                                    src={preview}\n                                                    alt={`Galerie ${index + 1}`}\n                                                    className=\"w-full h-24 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                                />\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={() => removeGalleryImage(index)}\n                                                    className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                    title={t('tours.deleteImage', 'Bild lschen')}\n                                                >\n                                                    <XMarkIcon className=\"h-4 w-4\" />\n                                                </button>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData || uploadingImage}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default EditTourModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, MapPinIcon, ClockIcon, UsersIcon, CurrencyDollarIcon, BuildingOfficeIcon, UserIcon, PlusIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { Tour, TourType, TourBooking } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport CreateTourBookingModal from './CreateTourBookingModal.tsx';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\n\ninterface TourDetailsModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    tourId: number;\n    onTourUpdated?: (updatedTour: Tour) => void;\n}\n\nconst TourDetailsModal = ({ isOpen, onClose, tourId, onTourUpdated }: TourDetailsModalProps) => {\n    const { t } = useTranslation();\n    const { showMessage } = useMessage();\n    const { hasPermission } = usePermissions();\n    const [tour, setTour] = useState<Tour | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n    const [isCreateBookingModalOpen, setIsCreateBookingModalOpen] = useState(false);\n\n    useEffect(() => {\n        if (isOpen && tourId) {\n            loadTour();\n        }\n    }, [isOpen, tourId]);\n\n    const loadTour = async () => {\n        try {\n            setLoading(true);\n            setError(null);\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tourId));\n            if (response.data.success) {\n                setTour(response.data.data);\n            } else {\n                setError(response.data.message || t('errors.loadError'));\n            }\n        } catch (err: unknown) {\n            console.error('Error loading tour:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.loadError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                            {t('tours.details', 'Tour-Details')}\n                        </Dialog.Title>\n                        <div className=\"flex items-center gap-3\">\n                            {hasPermission('tour_bookings', 'write', 'table') && tour && tour.isActive && (\n                                <div className=\"relative group\">\n                                    <button\n                                        onClick={() => setIsCreateBookingModalOpen(true)}\n                                        className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                        style={{ width: '30.19px', height: '30.19px' }}\n                                        aria-label={t('tourBookings.create', 'Buchung erstellen')}\n                                    >\n                                        <PlusIcon className=\"h-4 w-4\" />\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tourBookings.create', 'Buchung erstellen')}\n                                    </div>\n                                </div>\n                            )}\n                            <button\n                                onClick={onClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n                    </div>\n\n                    <div className=\"p-6\">\n                        {loading ? (\n                            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                                {t('common.loading')}\n                            </div>\n                        ) : error ? (\n                            <div className=\"text-center py-8 text-red-500 dark:text-red-400\">\n                                {error}\n                            </div>\n                        ) : !tour ? (\n                            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                                {t('tours.notFound', 'Tour nicht gefunden')}\n                            </div>\n                        ) : (\n                            <div className=\"space-y-6\">\n                                {/* Header */}\n                                <div>\n                                    <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\n                                        {tour.title || '-'}\n                                    </h2>\n                                    <div className=\"flex items-center gap-2\">\n                                        <span className={`px-3 py-1 text-sm rounded-full ${\n                                            tour.type === TourType.OWN\n                                                ? 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200'\n                                                : 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200'\n                                        }`}>\n                                            {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                        </span>\n                                        <span className={`px-3 py-1 text-sm rounded-full ${\n                                            tour.isActive\n                                                ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'\n                                                : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                        }`}>\n                                            {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                        </span>\n                                    </div>\n                                </div>\n\n                                {/* Beschreibung */}\n                                {tour.description && (\n                                    <div>\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\n                                            {t('tours.description')}\n                                        </h3>\n                                        <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                            {tour.description}\n                                        </p>\n                                    </div>\n                                )}\n\n                                {/* Tour-Details Grid */}\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                                    {/* Linke Spalte */}\n                                    <div className=\"space-y-4\">\n                                        {tour.duration && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <ClockIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.duration')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.duration} {t('common.hours', 'h')}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {(tour.minParticipants || tour.maxParticipants) && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <UsersIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.participants', 'Teilnehmer')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.minParticipants && tour.maxParticipants\n                                                            ? `${tour.minParticipants} - ${tour.maxParticipants}`\n                                                            : tour.minParticipants\n                                                            ? `${tour.minParticipants}+`\n                                                            : tour.maxParticipants\n                                                            ? `bis ${tour.maxParticipants}`\n                                                            : '-'}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.price && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <CurrencyDollarIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.price')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white font-semibold\">\n                                                        {Number(tour.price).toLocaleString()} {tour.currency || 'COP'}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.location && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <MapPinIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.location')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.location}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.meetingPoint && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <MapPinIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.meetingPoint')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.meetingPoint}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n                                    </div>\n\n                                    {/* Rechte Spalte */}\n                                    <div className=\"space-y-4\">\n                                        {tour.branch && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <BuildingOfficeIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.branch')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.branch.name}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.createdBy && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <UserIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.columns.createdBy')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.createdBy.firstName} {tour.createdBy.lastName}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.createdAt && (\n                                            <div>\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                    {t('common.createdAt', 'Erstellt am')}\n                                                </div>\n                                                <div className=\"text-gray-900 dark:text-white\">\n                                                    {format(new Date(tour.createdAt), 'dd.MM.yyyy HH:mm', { locale: de })}\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.externalProvider && (\n                                            <div>\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                    {t('tours.externalProvider')}\n                                                </div>\n                                                <div className=\"text-gray-900 dark:text-white\">\n                                                    {tour.externalProvider.name}\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.externalBookingUrl && (\n                                            <div>\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                    {t('tours.externalBookingUrl')}\n                                                </div>\n                                                <a\n                                                    href={tour.externalBookingUrl}\n                                                    target=\"_blank\"\n                                                    rel=\"noopener noreferrer\"\n                                                    className=\"text-blue-600 dark:text-blue-400 hover:underline\"\n                                                >\n                                                    {tour.externalBookingUrl}\n                                                </a>\n                                            </div>\n                                        )}\n                                    </div>\n                                </div>\n\n                                {/* Kommissionen */}\n                                {(tour.totalCommission || tour.totalCommissionPercent || tour.sellerCommissionPercent || tour.sellerCommissionFixed) && (\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                                            {t('tours.commissions')}\n                                        </h3>\n                                        <div className=\"grid grid-cols-2 gap-4\">\n                                            {tour.totalCommission && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.totalCommission')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.totalCommission).toLocaleString()} {tour.currency || 'COP'}\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.totalCommissionPercent && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.totalCommissionPercent')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.totalCommissionPercent)}%\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.sellerCommissionPercent && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.sellerCommissionPercent')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.sellerCommissionPercent)}%\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.sellerCommissionFixed && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.sellerCommissionFixed')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.sellerCommissionFixed).toLocaleString()} {tour.currency || 'COP'}\n                                                    </div>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n\n                                {/* Zustzliche Informationen */}\n                                {(tour.includes || tour.excludes || tour.requirements) && (\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                                            {t('tours.additionalInfo')}\n                                        </h3>\n                                        <div className=\"space-y-4\">\n                                            {tour.includes && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                                        {t('tours.includes')}\n                                                    </div>\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                                        {tour.includes}\n                                                    </p>\n                                                </div>\n                                            )}\n                                            {tour.excludes && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                                        {t('tours.excludes')}\n                                                    </div>\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                                        {tour.excludes}\n                                                    </p>\n                                                </div>\n                                            )}\n                                            {tour.requirements && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                                        {t('tours.requirements')}\n                                                    </div>\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                                        {tour.requirements}\n                                                    </p>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n\n                                {/* Verfgbarkeit */}\n                                {(tour.availableFrom || tour.availableTo) && (\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                                            {t('tours.availability', 'Verfgbarkeit')}\n                                        </h3>\n                                        <div className=\"grid grid-cols-2 gap-4\">\n                                            {tour.availableFrom && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.availableFrom', 'Verfgbar ab')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {format(new Date(tour.availableFrom), 'dd.MM.yyyy', { locale: de })}\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.availableTo && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.availableTo', 'Verfgbar bis')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {format(new Date(tour.availableTo), 'dd.MM.yyyy', { locale: de })}\n                                                    </div>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n                        )}\n                    </div>\n\n                    <div className=\"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700\">\n                        <button\n                            onClick={onClose}\n                            className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\n                        >\n                            {t('common.close', 'Schlieen')}\n                        </button>\n                    </div>\n                </Dialog.Panel>\n            </div>\n            \n            {/* Create Tour Booking Modal */}\n            {tour && (\n                <CreateTourBookingModal\n                    isOpen={isCreateBookingModalOpen}\n                    onClose={() => setIsCreateBookingModalOpen(false)}\n                    tour={tour}\n                    onBookingCreated={async (newBooking: TourBooking) => {\n                        showMessage(\n                            t('tourBookings.created', { defaultValue: 'Tour-Buchung erfolgreich erstellt' }),\n                            'success'\n                        );\n                        setIsCreateBookingModalOpen(false);\n                    }}\n                />\n            )}\n        </Dialog>\n    );\n};\n\nexport default TourDetailsModal;\n\n","import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ArrowDownTrayIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../../config/axios.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { Tour } from '../../types/tour.ts';\n\ninterface TourExportDialogProps {\n    isOpen: boolean;\n    onClose: () => void;\n    tourCount: number;\n}\n\nconst TourExportDialog = ({ isOpen, onClose, tourCount }: TourExportDialogProps) => {\n    const { t } = useTranslation();\n    const { showMessage } = useMessage();\n    \n    const [selectedFields, setSelectedFields] = useState<string[]>([\n        'id', 'title', 'description', 'type', 'price', 'currency', 'duration',\n        'maxParticipants', 'minParticipants', 'location', 'meetingPoint',\n        'imageUrl', 'galleryUrls', 'availableFrom', 'availableTo'\n    ]);\n    const [exporting, setExporting] = useState(false);\n    const [format, setFormat] = useState<'json' | 'csv'>('json');\n\n    const availableFields = [\n        { id: 'id', label: t('tours.columns.title', 'Titel') },\n        { id: 'title', label: t('tours.name', 'Titel') },\n        { id: 'description', label: t('tours.description', 'Beschreibung') },\n        { id: 'type', label: t('tours.type', 'Typ') },\n        { id: 'price', label: t('tours.price', 'Preis') },\n        { id: 'currency', label: t('tours.currency', 'Whrung') },\n        { id: 'duration', label: t('tours.duration', 'Dauer') },\n        { id: 'maxParticipants', label: t('tours.maxParticipants', 'Max. Teilnehmer') },\n        { id: 'minParticipants', label: t('tours.minParticipants', 'Min. Teilnehmer') },\n        { id: 'location', label: t('tours.location', 'Ort') },\n        { id: 'meetingPoint', label: t('tours.meetingPoint', 'Treffpunkt') },\n        { id: 'includes', label: t('tours.includes', 'Enthlt') },\n        { id: 'excludes', label: t('tours.excludes', 'Nicht enthalten') },\n        { id: 'requirements', label: t('tours.requirements', 'Anforderungen') },\n        { id: 'imageUrl', label: t('tours.mainImage', 'Hauptbild') },\n        { id: 'galleryUrls', label: t('tours.gallery', 'Galerie') },\n        { id: 'availableFrom', label: t('tours.availableFrom', 'Verfgbar ab') },\n        { id: 'availableTo', label: t('tours.availableTo', 'Verfgbar bis') },\n        { id: 'externalBookingUrl', label: t('tours.externalBookingUrl', 'Externe Buchungs-URL') },\n        { id: 'branch', label: t('tours.branch', 'Niederlassung') },\n        { id: 'externalProvider', label: t('tours.externalProvider', 'Externer Anbieter') }\n    ];\n\n    const toggleField = (fieldId: string) => {\n        setSelectedFields(prev =>\n            prev.includes(fieldId)\n                ? prev.filter(f => f !== fieldId)\n                : [...prev, fieldId]\n        );\n    };\n\n    const selectAll = () => {\n        setSelectedFields(availableFields.map(f => f.id));\n    };\n\n    const deselectAll = () => {\n        setSelectedFields([]);\n    };\n\n    const handleExport = async () => {\n        if (selectedFields.length === 0) {\n            showMessage(t('tours.export.noFieldsSelected', 'Bitte whlen Sie mindestens ein Feld aus'), 'error');\n            return;\n        }\n\n        setExporting(true);\n        try {\n            const fieldsParam = selectedFields.join(',');\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.EXPORT, {\n                params: { fields: fieldsParam }\n            });\n\n            const tours = response.data.tours || response.data;\n\n            if (format === 'json') {\n                // JSON-Export\n                const blob = new Blob([JSON.stringify(tours, null, 2)], { type: 'application/json' });\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = `tours-export-${new Date().toISOString().split('T')[0]}.json`;\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                window.URL.revokeObjectURL(url);\n            } else {\n                // CSV-Export\n                if (!Array.isArray(tours) || tours.length === 0) {\n                    showMessage(t('tours.export.noData', 'Keine Daten zum Exportieren'), 'warning');\n                    return;\n                }\n\n                // CSV-Header\n                const headers = selectedFields.map(fieldId => {\n                    const field = availableFields.find(f => f.id === fieldId);\n                    return field?.label || fieldId;\n                });\n\n                // CSV-Rows\n                const rows = tours.map((tour: Tour) => {\n                    return selectedFields.map(fieldId => {\n                        let value = tour[fieldId];\n                        if (value === null || value === undefined) return '';\n                        if (typeof value === 'object') {\n                            if (fieldId === 'branch') return value?.name || '';\n                            if (fieldId === 'externalProvider') return value?.name || '';\n                            if (fieldId === 'galleryUrls' && Array.isArray(value)) return value.join('; ');\n                            return JSON.stringify(value);\n                        }\n                        if (typeof value === 'boolean') return value ? 'Ja' : 'Nein';\n                        return String(value);\n                    });\n                });\n\n                // CSV-String erstellen\n                const csvContent = [\n                    headers.join(','),\n                    ...rows.map(row => row.map(cell => `\"${String(cell).replace(/\"/g, '\"\"')}\"`).join(','))\n                ].join('\\n');\n\n                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = `tours-export-${new Date().toISOString().split('T')[0]}.csv`;\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                window.URL.revokeObjectURL(url);\n            }\n\n            showMessage(t('tours.export.success', 'Export erfolgreich'), 'success');\n            onClose();\n        } catch (err: unknown) {\n            console.error('Error exporting:', err);\n            showMessage(err.response?.data?.message || t('tours.export.error', 'Fehler beim Exportieren'), 'error');\n        } finally {\n            setExporting(false);\n        }\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                            {t('tours.export.title', 'Touren exportieren')} ({tourCount})\n                        </Dialog.Title>\n                        <button\n                            onClick={onClose}\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                        >\n                            <XMarkIcon className=\"h-6 w-6\" />\n                        </button>\n                    </div>\n\n                    <div className=\"p-6 space-y-6\">\n                        {/* Format-Auswahl */}\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                {t('tours.export.format', 'Export-Format')}\n                            </label>\n                            <div className=\"flex gap-4\">\n                                <label className=\"flex items-center\">\n                                    <input\n                                        type=\"radio\"\n                                        value=\"json\"\n                                        checked={format === 'json'}\n                                        onChange={(e) => setFormat(e.target.value as 'json' | 'csv')}\n                                        className=\"mr-2\"\n                                    />\n                                    JSON\n                                </label>\n                                <label className=\"flex items-center\">\n                                    <input\n                                        type=\"radio\"\n                                        value=\"csv\"\n                                        checked={format === 'csv'}\n                                        onChange={(e) => setFormat(e.target.value as 'json' | 'csv')}\n                                        className=\"mr-2\"\n                                    />\n                                    CSV\n                                </label>\n                            </div>\n                        </div>\n\n                        {/* Feldauswahl */}\n                        <div>\n                            <div className=\"flex items-center justify-between mb-3\">\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                    {t('tours.export.selectFields', 'Felder auswhlen')}\n                                </label>\n                                <div className=\"flex gap-2\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={selectAll}\n                                        className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\"\n                                    >\n                                        {t('common.selectAll', 'Alle auswhlen')}\n                                    </button>\n                                    <span className=\"text-gray-400\">|</span>\n                                    <button\n                                        type=\"button\"\n                                        onClick={deselectAll}\n                                        className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\"\n                                    >\n                                        {t('common.deselectAll', 'Alle abwhlen')}\n                                    </button>\n                                </div>\n                            </div>\n                            <div className=\"border border-gray-300 dark:border-gray-600 rounded-md p-4 max-h-96 overflow-y-auto\">\n                                <div className=\"grid grid-cols-2 gap-2\">\n                                    {availableFields.map(field => (\n                                        <label key={field.id} className=\"flex items-center\">\n                                            <input\n                                                type=\"checkbox\"\n                                                checked={selectedFields.includes(field.id)}\n                                                onChange={() => toggleField(field.id)}\n                                                className=\"mr-2 rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                                            />\n                                            <span className=\"text-sm text-gray-700 dark:text-gray-300\">\n                                                {field.label}\n                                            </span>\n                                        </label>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"flex justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                            title={t('common.cancel', 'Abbrechen')}\n                        >\n                            <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <button\n                            type=\"button\"\n                            onClick={handleExport}\n                            disabled={exporting || selectedFields.length === 0}\n                            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                            title={exporting ? t('common.exporting', 'Exportiere...') : t('common.export', 'Exportieren')}\n                        >\n                            <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                        </button>\n                    </div>\n                </Dialog.Panel>\n            </div>\n        </Dialog>\n    );\n};\n\nexport default TourExportDialog;\n\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { \r\n  XMarkIcon, \r\n  ChevronLeftIcon, \r\n  ChevronRightIcon,\r\n  MagnifyingGlassPlusIcon,\r\n  MagnifyingGlassMinusIcon,\r\n  ArrowPathIcon\r\n} from '@heroicons/react/24/outline';\r\nimport { getTourImageUrl, getTourGalleryImageUrl } from '../../config/api.ts';\r\n\r\ninterface TourImageLightboxProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  tourId: number;\r\n  initialImageIndex?: number;\r\n  imageUrl?: string | null;\r\n  galleryUrls?: string[] | null;\r\n  tourTitle?: string;\r\n}\r\n\r\nconst TourImageLightbox: React.FC<TourImageLightboxProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  tourId,\r\n  initialImageIndex = 0,\r\n  imageUrl,\r\n  galleryUrls,\r\n  tourTitle\r\n}) => {\r\n  const { t } = useTranslation();\r\n  \r\n  // State\r\n  const [currentImageIndex, setCurrentImageIndex] = useState(initialImageIndex);\r\n  const [zoomLevel, setZoomLevel] = useState(1.0);\r\n  const [imageLoading, setImageLoading] = useState(true);\r\n  const [imageError, setImageError] = useState(false);\r\n\r\n  // Konstruiere Bild-Array: Hauptbild + Galerie\r\n  const images: string[] = [];\r\n  if (imageUrl) {\r\n    images.push(getTourImageUrl(tourId)); // Index 0\r\n  }\r\n  if (galleryUrls && galleryUrls.length > 0) {\r\n    galleryUrls.forEach((_, index) => {\r\n      images.push(getTourGalleryImageUrl(tourId, index)); // Index 1+\r\n    });\r\n  }\r\n\r\n  // Reset state wenn Lightbox geffnet wird\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setCurrentImageIndex(initialImageIndex);\r\n      setZoomLevel(1.0);\r\n      setImageLoading(true);\r\n      setImageError(false);\r\n    }\r\n  }, [isOpen, initialImageIndex]);\r\n\r\n  // Navigation\r\n  const handlePrevious = useCallback(() => {\r\n    if (currentImageIndex > 0) {\r\n      setCurrentImageIndex(currentImageIndex - 1);\r\n      setImageLoading(true);\r\n      setImageError(false);\r\n      setZoomLevel(1.0);\r\n    }\r\n  }, [currentImageIndex]);\r\n\r\n  const handleNext = useCallback(() => {\r\n    if (currentImageIndex < images.length - 1) {\r\n      setCurrentImageIndex(currentImageIndex + 1);\r\n      setImageLoading(true);\r\n      setImageError(false);\r\n      setZoomLevel(1.0);\r\n    }\r\n  }, [currentImageIndex, images.length]);\r\n\r\n  // Zoom\r\n  const handleZoomIn = useCallback(() => {\r\n    setZoomLevel(prev => {\r\n      if (prev >= 3.0) return 3.0;\r\n      if (prev < 1.5) return 1.5;\r\n      if (prev < 2.0) return 2.0;\r\n      if (prev < 2.5) return 2.5;\r\n      return 3.0;\r\n    });\r\n  }, []);\r\n\r\n  const handleZoomOut = useCallback(() => {\r\n    setZoomLevel(prev => {\r\n      if (prev <= 1.0) return 1.0;\r\n      if (prev > 2.5) return 2.5;\r\n      if (prev > 2.0) return 2.0;\r\n      if (prev > 1.5) return 1.5;\r\n      return 1.0;\r\n    });\r\n  }, []);\r\n\r\n  const handleZoomReset = useCallback(() => {\r\n    setZoomLevel(1.0);\r\n  }, []);\r\n\r\n  // Bild-Events\r\n  const handleImageLoad = () => {\r\n    setImageLoading(false);\r\n    setImageError(false);\r\n  };\r\n\r\n  const handleImageError = () => {\r\n    setImageLoading(false);\r\n    setImageError(true);\r\n  };\r\n\r\n  // Keyboard-Navigation\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        onClose();\r\n      } else if (e.key === 'ArrowLeft' && currentImageIndex > 0) {\r\n        handlePrevious();\r\n      } else if (e.key === 'ArrowRight' && currentImageIndex < images.length - 1) {\r\n        handleNext();\r\n      } else if ((e.key === '+' || e.key === '=') && !e.shiftKey) {\r\n        handleZoomIn();\r\n      } else if (e.key === '-' || (e.key === '_' && e.shiftKey)) {\r\n        handleZoomOut();\r\n      } else if (e.key === '0') {\r\n        handleZoomReset();\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, [isOpen, currentImageIndex, images.length, handlePrevious, handleNext, handleZoomIn, handleZoomOut, handleZoomReset, onClose]);\r\n\r\n  // Prfe ob Bilder vorhanden\r\n  if (images.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const currentImage = images[currentImageIndex];\r\n  const canGoPrevious = currentImageIndex > 0;\r\n  const canGoNext = currentImageIndex < images.length - 1;\r\n  const canZoomIn = zoomLevel < 3.0;\r\n  const canZoomOut = zoomLevel > 1.0;\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      {/* Overlay */}\r\n      <div className=\"fixed inset-0 bg-black/80\" aria-hidden=\"true\" />\r\n      \r\n      {/* Dialog Panel */}\r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"mx-auto max-w-7xl w-full h-full flex flex-col bg-black/90 rounded-lg shadow-xl overflow-hidden\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between p-4 border-b border-gray-700 flex-shrink-0\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <Dialog.Title className=\"text-lg font-semibold text-white\">\r\n                {tourTitle && `${tourTitle} - `}\r\n                {t('tours.imageLightbox.title', 'Bild {{current}} von {{total}}', {\r\n                  current: currentImageIndex + 1,\r\n                  total: images.length\r\n                })}\r\n              </Dialog.Title>\r\n              \r\n              {/* Zoom Controls */}\r\n              <div className=\"flex items-center gap-2\">\r\n                <button\r\n                  onClick={handleZoomOut}\r\n                  disabled={!canZoomOut}\r\n                  className=\"p-2 text-white hover:bg-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  aria-label={t('tours.imageLightbox.zoomOut', 'Verkleinern')}\r\n                  title={t('tours.imageLightbox.zoomOut', 'Verkleinern')}\r\n                >\r\n                  <MagnifyingGlassMinusIcon className=\"h-5 w-5\" />\r\n                </button>\r\n                <button\r\n                  onClick={handleZoomReset}\r\n                  className=\"p-2 text-white hover:bg-gray-700 rounded transition-colors\"\r\n                  aria-label={t('tours.imageLightbox.zoomReset', 'Zoom zurcksetzen')}\r\n                  title={t('tours.imageLightbox.zoomReset', 'Zoom zurcksetzen')}\r\n                >\r\n                  <ArrowPathIcon className=\"h-5 w-5\" />\r\n                </button>\r\n                <button\r\n                  onClick={handleZoomIn}\r\n                  disabled={!canZoomIn}\r\n                  className=\"p-2 text-white hover:bg-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  aria-label={t('tours.imageLightbox.zoomIn', 'Vergrern')}\r\n                  title={t('tours.imageLightbox.zoomIn', 'Vergrern')}\r\n                >\r\n                  <MagnifyingGlassPlusIcon className=\"h-5 w-5\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Close Button */}\r\n            <button\r\n              onClick={onClose}\r\n              className=\"p-2 text-white hover:bg-gray-700 rounded transition-colors\"\r\n              aria-label={t('tours.imageLightbox.close', 'Schlieen')}\r\n            >\r\n              <XMarkIcon className=\"h-6 w-6\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Content */}\r\n          <div className=\"flex-1 relative overflow-hidden flex items-center justify-center\">\r\n            {/* Previous Button */}\r\n            {images.length > 1 && (\r\n              <button\r\n                onClick={handlePrevious}\r\n                disabled={!canGoPrevious}\r\n                className=\"absolute left-4 z-10 p-3 bg-black/50 hover:bg-black/70 text-white rounded-full disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\r\n                aria-label={t('tours.imageLightbox.previous', 'Vorheriges Bild')}\r\n              >\r\n                <ChevronLeftIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            )}\r\n\r\n            {/* Image Container */}\r\n            <div className=\"flex-1 flex items-center justify-center h-full p-4\">\r\n              {imageLoading && !imageError && (\r\n                <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                  <div className=\"text-white\">\r\n                    <ArrowPathIcon className=\"h-8 w-8 animate-spin\" />\r\n                    <p className=\"mt-2 text-sm\">{t('tours.imageLightbox.loading', 'Bild wird geladen...')}</p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {imageError && (\r\n                <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                  <div className=\"text-white text-center\">\r\n                    <p className=\"text-lg\">{t('tours.imageLightbox.error', 'Bild konnte nicht geladen werden')}</p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {!imageError && (\r\n                <img\r\n                  src={currentImage}\r\n                  alt={`${tourTitle || 'Tour'} - Bild ${currentImageIndex + 1}`}\r\n                  className={`max-w-full max-h-full object-contain transition-transform duration-200 ${\r\n                    imageLoading ? 'opacity-0' : 'opacity-100'\r\n                  }`}\r\n                  style={{\r\n                    transform: `scale(${zoomLevel})`,\r\n                    cursor: zoomLevel > 1.0 ? 'move' : 'default'\r\n                  }}\r\n                  onLoad={handleImageLoad}\r\n                  onError={handleImageError}\r\n                />\r\n              )}\r\n            </div>\r\n\r\n            {/* Next Button */}\r\n            {images.length > 1 && (\r\n              <button\r\n                onClick={handleNext}\r\n                disabled={!canGoNext}\r\n                className=\"absolute right-4 z-10 p-3 bg-black/50 hover:bg-black/70 text-white rounded-full disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\r\n                aria-label={t('tours.imageLightbox.next', 'Nchstes Bild')}\r\n              >\r\n                <ChevronRightIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            )}\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default TourImageLightbox;\r\n\r\n","import React, { useState, useEffect, useMemo, useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PencilIcon, PlusIcon, ArrowsUpDownIcon, FunnelIcon, InformationCircleIcon, Squares2X2Icon, TableCellsIcon, ArrowDownTrayIcon, PhotoIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS, getTourImageUrl, getTourGalleryImageUrl } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\nimport CardGrid from '../shared/CardGrid.tsx';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport { useTableSettings } from '../../hooks/useTableSettings.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useError } from '../../contexts/ErrorContext.tsx';\nimport TableColumnConfig from '../TableColumnConfig.tsx';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport CreateTourModal from './CreateTourModal.tsx';\nimport EditTourModal from './EditTourModal.tsx';\nimport TourDetailsModal from './TourDetailsModal.tsx';\nimport TourExportDialog from './TourExportDialog.tsx';\nimport TourImageLightbox from './TourImageLightbox.tsx';\nimport { Tour, TourType } from '../../types/tour.ts';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport { applyFilters, evaluateUserRoleCondition } from '../../utils/filterLogic.ts';\n\ninterface ToursTabProps {\n}\n\ninterface TourSortConfig {\n    key: 'title' | 'type' | 'price' | 'location' | 'duration' | 'branch' | 'createdBy' | 'isActive';\n    direction: 'asc' | 'desc';\n}\n\nconst TOURS_TABLE_ID = 'worktracker-tours';\n\nconst defaultTourColumnOrder = ['title', 'type', 'price', 'location', 'duration', 'branch', 'isActive', 'actions'];\n\n//  ENTFERNT: defaultTourCardSortDirections\n// Hauptsortierung wird jetzt aus Settings geladen (pro Benutzer gespeichert)\n\nconst tourCardToTableMapping: Record<string, string> = {\n    'title': 'title',\n    'type': 'type',\n    'price': 'price',\n    'location': 'location',\n    'duration': 'duration',\n    'branch': 'branch',\n    'createdBy': 'createdBy',\n    'isActive': 'isActive'\n};\n\nconst getTourCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n    const cardMetadata: string[] = [];\n    columnOrder.forEach(tableCol => {\n        const cardMeta = tourCardToTableMapping[tableCol] || [];\n        if (cardMeta && typeof cardMeta === 'string') {\n            cardMetadata.push(cardMeta);\n        }\n    });\n    return cardMetadata;\n};\n\nconst getTourHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n    const hiddenCardMetadata = new Set<string>();\n    hiddenTableColumns.forEach(tableCol => {\n        const cardMeta = tourCardToTableMapping[tableCol];\n        if (cardMeta) {\n            hiddenCardMetadata.add(cardMeta);\n        }\n    });\n    return hiddenCardMetadata;\n};\n\nconst ToursTab: React.FC<ToursTabProps> = () => {\n    const { t } = useTranslation();\n    const { hasPermission, loading: permissionsLoading } = usePermissions();\n    const { showMessage } = useMessage();\n    \n    // Fehlerbehandlung mit Fallback\n    const errorContext = useError();\n    const handleErrorContext = errorContext?.handleError || ((err: unknown, context?: Record<string, unknown>) => {\n        console.error('Error:', err, context);\n        const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                             (err as { message?: string })?.message || \n                             'Ein Fehler ist aufgetreten';\n        showMessage(errorMessage, 'error');\n    });\n    \n    // Tour-States\n    const [tours, setTours] = useState<Tour[]>([]);\n    const [toursLoading, setToursLoading] = useState(false);\n    const [toursError, setToursError] = useState<string | null>(null);\n    const [tourSearchTerm, setTourSearchTerm] = useState('');\n    const [tourFilterConditions, setTourFilterConditions] = useState<FilterCondition[]>([]);\n    const [tourFilterLogicalOperators, setTourFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [tourActiveFilterName, setTourActiveFilterName] = useState<string>(t('tours.filters.current', 'Aktuell'));\n    const [tourSelectedFilterId, setTourSelectedFilterId] = useState<number | null>(null);\n    \n    //  PERFORMANCE: Ref-Pattern fr tourFilterLogicalOperators (verhindert Re-Creation von loadTours)\n    const tourFilterLogicalOperatorsRef = useRef(tourFilterLogicalOperators);\n    \n    useEffect(() => {\n        tourFilterLogicalOperatorsRef.current = tourFilterLogicalOperators;\n    }, [tourFilterLogicalOperators]);\n    const [isCreateTourModalOpen, setIsCreateTourModalOpen] = useState(false);\n    const [isEditTourModalOpen, setIsEditTourModalOpen] = useState(false);\n    const [isTourDetailsModalOpen, setIsTourDetailsModalOpen] = useState(false);\n    const [isTourExportDialogOpen, setIsTourExportDialogOpen] = useState(false);\n    const [lightboxOpen, setLightboxOpen] = useState(false);\n    const [selectedTourForLightbox, setSelectedTourForLightbox] = useState<Tour | null>(null);\n    const [initialImageIndex, setInitialImageIndex] = useState(0);\n    const [selectedTour, setSelectedTour] = useState<Tour | null>(null);\n    const [selectedTourId, setSelectedTourId] = useState<number | null>(null);\n    const [displayLimit, setDisplayLimit] = useState<number>(10);\n    const [draggedColumn, setDraggedColumn] = useState<string | null>(null);\n    const [dragOverColumn, setDragOverColumn] = useState<string | null>(null);\n    const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n    \n    // Bildgenerierung States\n    const [generatingImages, setGeneratingImages] = useState<Record<number, boolean>>({});\n    const [imageGenerationJobs, setImageGenerationJobs] = useState<Record<number, string | null>>({});\n    const pollingIntervalsRef = useRef<Record<number, NodeJS.Timeout>>({});\n    const pollCountRef = useRef<Record<number, number>>({});\n    \n    // Tabellen-Einstellungen\n    const {\n        settings,\n        isLoading: isLoadingSettings,\n        updateColumnOrder,\n        updateHiddenColumns,\n        toggleColumnVisibility,\n        isColumnVisible,\n        updateViewMode,\n        updateSortConfig\n    } = useTableSettings(TOURS_TABLE_ID, {\n        defaultColumnOrder: defaultTourColumnOrder,\n        defaultHiddenColumns: [],\n        defaultViewMode: 'cards'\n    });\n    \n    // Hauptsortierung aus Settings laden (fr Table & Cards synchron)\n    const tourTableSortConfig: TourSortConfig = settings?.sortConfig || { key: 'title', direction: 'asc' };\n    \n    // Hauptsortierung Handler (fr Table & Cards synchron)\n    const handleMainSortChange = (key: string, direction: 'asc' | 'desc') => {\n        updateSortConfig({ key: key as TourSortConfig['key'], direction });\n    };\n    \n    // Tours-Spalten\n    const availableTourColumns = useMemo(() => [\n        { id: 'title', label: t('tours.columns.title', 'Titel'), shortLabel: t('tours.columns.title', 'Titel').substring(0, 4) },\n        { id: 'type', label: t('tours.columns.type', 'Typ'), shortLabel: t('tours.columns.type', 'Typ').substring(0, 3) },\n        { id: 'price', label: t('tours.columns.price', 'Preis'), shortLabel: t('tours.columns.price', 'Preis').substring(0, 3) },\n        { id: 'location', label: t('tours.columns.location', 'Ort'), shortLabel: t('tours.columns.location', 'Ort').substring(0, 3) },\n        { id: 'duration', label: t('tours.columns.duration', 'Dauer'), shortLabel: t('tours.columns.duration', 'Dauer').substring(0, 3) },\n        { id: 'branch', label: t('tours.columns.branch', 'Niederlassung'), shortLabel: t('tours.columns.branch', 'Niederlassung').substring(0, 5) },\n        { id: 'createdBy', label: t('tours.columns.createdBy', 'Erstellt von'), shortLabel: t('tours.columns.createdBy', 'Erstellt von').substring(0, 5) },\n        { id: 'isActive', label: t('tours.columns.status', 'Status'), shortLabel: t('tours.columns.status', 'Status').substring(0, 3) },\n        { id: 'actions', label: t('tours.columns.actions', 'Aktionen'), shortLabel: t('common.actions').substring(0, 3) },\n    ], [t]);\n    \n    const tourFilterOnlyColumns = useMemo(() => [\n        { id: 'description', label: t('tours.columns.description', 'Beschreibung'), shortLabel: t('tours.columns.description', 'Beschreibung').substring(0, 3) },\n        { id: 'maxParticipants', label: t('tours.columns.maxParticipants', 'Max. Teilnehmer'), shortLabel: t('tours.columns.maxParticipants', 'Max. Teilnehmer').substring(0, 3) },\n        { id: 'minParticipants', label: t('tours.columns.minParticipants', 'Min. Teilnehmer'), shortLabel: t('tours.columns.minParticipants', 'Min. Teilnehmer').substring(0, 3) },\n    ], [t]);\n    \n    //  ENTFERNT: tourCardSortDirections und handleTourCardSortDirectionChange\n    // Hauptsortierung wird jetzt aus Settings geladen (pro Benutzer gespeichert)\n    \n    const viewMode = settings?.viewMode || 'cards';\n    \n    // Card-Metadaten-Reihenfolge aus columnOrder ableiten\n    const cardMetadataOrder = useMemo(() => {\n        return getTourCardMetadataFromColumnOrder(settings?.columnOrder || defaultTourColumnOrder);\n    }, [settings?.columnOrder]);\n    \n    // Versteckte Card-Metadaten aus hiddenColumns ableiten\n    const hiddenCardMetadata = useMemo(() => {\n        return getTourHiddenCardMetadata(settings?.hiddenColumns || []);\n    }, [settings?.hiddenColumns]);\n    \n    // Sichtbare Card-Metadaten\n    const visibleCardMetadata = useMemo(() => {\n        return new Set(cardMetadataOrder.filter(meta => !hiddenCardMetadata.has(meta)));\n    }, [cardMetadataOrder, hiddenCardMetadata]);\n    \n    // Funktion zum Laden der Tours\n    //  PERFORMANCE: Ref-Pattern verwendet (tourFilterLogicalOperatorsRef) statt State als Dependency\n    const loadTours = useCallback(async (filterId?: number, filterConditions?: any[], background = false) => {\n        try {\n            if (!background) {\n                setToursLoading(true);\n                setToursError(null);\n            }\n            \n            const params: Record<string, unknown> = {};\n            if (filterId) {\n                params.filterId = filterId;\n            } else if (filterConditions && filterConditions.length > 0) {\n                params.filterConditions = JSON.stringify({\n                    conditions: filterConditions,\n                    operators: tourFilterLogicalOperatorsRef.current  //  Ref verwenden statt State\n                });\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BASE, { params });\n            if (response.data.success) {\n                const rawData = response.data.data || [];\n                const toursData = Array.isArray(rawData) \n                    ? rawData.filter((tour: Tour | null) => \n                        tour != null && \n                        typeof tour === 'object' && \n                        tour.title != null && \n                        typeof tour.title === 'string'\n                    )\n                    : [];\n                if (!background) {\n                    setTours(toursData);\n                }\n            } else {\n                const errorMessage = response.data.message || t('errors.loadError');\n                if (!background) {\n                    setToursError(errorMessage);\n                    showMessage(errorMessage, 'error');\n                }\n            }\n        } catch (err: any) {\n            console.error('Fehler beim Laden der Touren:', err);\n            const errorMessage = err.response?.data?.message || t('errors.loadError');\n            if (!background) {\n                setToursError(errorMessage);\n                showMessage(errorMessage, 'error');\n            }\n        } finally {\n            if (!background) {\n                setToursLoading(false);\n            }\n        }\n    }, [t, showMessage]);  //  tourFilterLogicalOperators entfernt (Ref verwendet)\n    \n    // Handler fr Bildgenerierung\n    const handleGenerateImages = useCallback(async (tourId: number) => {\n        try {\n            setGeneratingImages(prev => ({ ...prev, [tourId]: true }));\n            \n            const response = await axiosInstance.post(API_ENDPOINTS.TOURS.GENERATE_IMAGES(tourId));\n            \n            if (response.data.success) {\n                if (response.data.mode === 'synchronous') {\n                    // Synchroner Modus: Fertig\n                    showMessage(\n                        t('tours.imagesGenerated', { defaultValue: 'Bilder erfolgreich generiert' }),\n                        'success'\n                    );\n                    setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                    await loadTours();\n                } else {\n                    // Asynchroner Modus: Polling starten\n                    const jobId = response.data.jobId;\n                    setImageGenerationJobs(prev => ({ ...prev, [tourId]: jobId }));\n                    showMessage(\n                        t('tours.imageGenerationStarted', { defaultValue: 'Bildgenerierung gestartet' }),\n                        'info'\n                    );\n                }\n            } else {\n                throw new Error(response.data.message || t('tours.imageGenerationFailed', { defaultValue: 'Fehler beim Starten der Bildgenerierung' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error starting image generation:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('tours.imageGenerationFailed', { defaultValue: 'Fehler bei Bildgenerierung' });\n            showMessage(errorMessage, 'error');\n            setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n        }\n    }, [t, showMessage, loadTours]);\n    \n    // Polling fr Bildgenerierungs-Status\n    useEffect(() => {\n        // Starte Polling nur fr neue Jobs (die noch kein Intervall haben)\n        Object.entries(imageGenerationJobs).forEach(([tourIdStr, jobId]) => {\n            if (!jobId) return;\n            \n            const tourId = parseInt(tourIdStr, 10);\n            \n            // berspringe, wenn bereits ein Polling luft\n            if (pollingIntervalsRef.current[tourId]) {\n                return;\n            }\n            \n            // Initialisiere Poll-Count fr diesen Job\n            if (!pollCountRef.current[tourId]) {\n                pollCountRef.current[tourId] = 0;\n            }\n            \n            const maxPolls = 30; // Max. 60 Sekunden (30 * 2 Sekunden)\n            \n            // Polling-Intervall starten\n            pollingIntervalsRef.current[tourId] = setInterval(async () => {\n                try {\n                    pollCountRef.current[tourId] = (pollCountRef.current[tourId] || 0) + 1;\n                    \n                    // Timeout nach 60 Sekunden\n                    if (pollCountRef.current[tourId] > maxPolls) {\n                        clearInterval(pollingIntervalsRef.current[tourId]);\n                        delete pollingIntervalsRef.current[tourId];\n                        delete pollCountRef.current[tourId];\n                        setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                        setImageGenerationJobs(prev => {\n                            const newJobs = { ...prev };\n                            delete newJobs[tourId];\n                            return newJobs;\n                        });\n                        showMessage(\n                            t('tours.imageGenerationTimeout', { defaultValue: 'Bildgenerierung hat zu lange gedauert' }),\n                            'warning'\n                        );\n                        return;\n                    }\n                    \n                    const response = await axiosInstance.get(\n                        API_ENDPOINTS.TOURS.GENERATE_IMAGES_STATUS(tourId),\n                        { params: { jobId } }\n                    );\n                    \n                    if (response.data.success) {\n                        const status = response.data.status;\n                        const progress = response.data.progress || 0;\n                        \n                        if (status === 'completed') {\n                            // Erfolg: Polling stoppen\n                            clearInterval(pollingIntervalsRef.current[tourId]);\n                            delete pollingIntervalsRef.current[tourId];\n                            delete pollCountRef.current[tourId];\n                            setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                            setImageGenerationJobs(prev => {\n                                const newJobs = { ...prev };\n                                delete newJobs[tourId];\n                                return newJobs;\n                            });\n                            showMessage(\n                                t('tours.imagesGenerated', { defaultValue: 'Bilder erfolgreich generiert' }),\n                                'success'\n                            );\n                            await loadTours();\n                        } else if (status === 'failed') {\n                            // Fehler: Polling stoppen\n                            clearInterval(pollingIntervalsRef.current[tourId]);\n                            delete pollingIntervalsRef.current[tourId];\n                            delete pollCountRef.current[tourId];\n                            setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                            setImageGenerationJobs(prev => {\n                                const newJobs = { ...prev };\n                                delete newJobs[tourId];\n                                return newJobs;\n                            });\n                            showMessage(\n                                t('tours.imageGenerationFailed', { defaultValue: 'Fehler bei Bildgenerierung' }),\n                                'error'\n                            );\n                        }\n                        // 'waiting' oder 'active': Weiter pollen\n                    }\n                } catch (err: unknown) {\n                    console.error('Error during polling:', err);\n                    // Fehler beim Polling: Wenn Job nicht gefunden, stoppe Polling\n                    if ((err as { response?: { status?: number } })?.response?.status === 404) {\n                        clearInterval(pollingIntervalsRef.current[tourId]);\n                        delete pollingIntervalsRef.current[tourId];\n                        delete pollCountRef.current[tourId];\n                        setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                        setImageGenerationJobs(prev => {\n                            const newJobs = { ...prev };\n                            delete newJobs[tourId];\n                            return newJobs;\n                        });\n                        showMessage(\n                            t('tours.imageGenerationFailed', { defaultValue: 'Fehler bei Bildgenerierung' }),\n                            'error'\n                        );\n                    }\n                    // Sonst: Weiter versuchen (nicht stoppen)\n                }\n            }, 2000); // Alle 2 Sekunden\n        });\n        \n        //  MEMORY LEAK PREVENTION: Cleanup-Funktion\n        return () => {\n            Object.values(pollingIntervalsRef.current).forEach(interval => clearInterval(interval));\n        };\n    }, [imageGenerationJobs, t, showMessage, loadTours]);\n    \n    //  MEMORY: Cleanup - Alle groen Arrays beim Unmount lschen\n    useEffect(() => {\n        return () => {\n            setTours([]);\n            setTourFilterConditions([]);\n        };\n    }, []); // Nur beim Unmount ausfhren\n    \n    //  ENTFERNT: Lade Tours beim Mount - wird jetzt durch Standard-Pattern gemacht\n    \n    // Tour-Filter-Funktionen\n    //  PERFORMANCE: Mit useCallback stabilisiert (verhindert Endlosschleife in useEffect)\n    const applyTourFilterConditions = useCallback((conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setTourFilterConditions(conditions);\n        setTourFilterLogicalOperators(operators);\n        loadTours(undefined, conditions, false);\n    }, [loadTours]);\n    \n    //  PERFORMANCE: Mit useCallback stabilisiert\n    const resetTourFilterConditions = useCallback(() => {\n        setTourFilterConditions([]);\n        setTourFilterLogicalOperators([]);\n        setTourActiveFilterName(t('tours.filters.current', 'Aktuell'));\n        setTourSelectedFilterId(null);\n        loadTours();\n    }, [loadTours, t]);\n    \n    //  PERFORMANCE: Mit useCallback stabilisiert (verhindert Endlosschleife in useEffect)\n    //  STANDARD: Wie in Requests.tsx - State setzen BEVOR Daten geladen werden\n    const handleTourFilterChange = useCallback(async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setTourSelectedFilterId(id);\n        setTourActiveFilterName(name);\n        if (id) {\n            //  STANDARD: State setzen BEVOR Daten geladen werden (wie in Requests.tsx:706-708)\n            setTourFilterConditions(conditions);\n            setTourFilterLogicalOperators(operators);\n            await loadTours(id);\n        } else {\n            await applyTourFilterConditions(conditions, operators);\n        }\n    }, [loadTours, applyTourFilterConditions]);\n    \n    //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n    const filterContext = useFilterContext();\n    const { loadFilters } = filterContext;\n    \n    //  PERFORMANCE: Ref verhindert mehrfache Anwendung des Default-Filters (Endlosschleife)\n    const initialLoadAttemptedRef = useRef(false);\n    \n    //  STANDARD: Filter-Laden und Default-Filter-Anwendung mit leeren Dependencies (wie in Requests.tsx)\n    useEffect(() => {\n        //  STANDARD: Warte bis Berechtigungen geladen sind\n        if (permissionsLoading) {\n            return;\n        }\n        \n        //  PERFORMANCE: Verhindere mehrfache Ausfhrung\n        if (initialLoadAttemptedRef.current) {\n            return;\n        }\n        \n        const initialize = async () => {\n            //  PERFORMANCE: Markiere als versucht, BEVOR async Operation startet\n            initialLoadAttemptedRef.current = true;\n            \n            try {\n                //  STANDARD: Prfe Berechtigung direkt (nicht in Dependencies!)\n                if (!hasPermission('tours', 'read', 'table')) {\n                    return;\n                }\n                \n                // 1. Filter laden (wartet auf State-Update)\n                const filters = await loadFilters(TOURS_TABLE_ID);\n                \n                // 2. Default-Filter anwenden (IMMER vorhanden!)\n                const defaultFilter = filters.find(f => f.name === 'Aktuell');\n                if (defaultFilter) {\n                    await handleTourFilterChange(\n                        defaultFilter.name,\n                        defaultFilter.id,\n                        defaultFilter.conditions,\n                        defaultFilter.operators\n                    );\n                    return; // Daten werden durch handleTourFilterChange geladen\n                }\n                \n                // 3. Fallback: Daten ohne Filter laden (sollte nie passieren)\n                await loadTours();\n            } catch (error) {\n                //  PERFORMANCE: Bei Fehler Ref zurcksetzen, damit Retry mglich ist\n                initialLoadAttemptedRef.current = false;\n                if (process.env.NODE_ENV === 'development') {\n                    console.error('[ToursTab] Error during initialization:', error);\n                }\n            }\n        };\n        \n        initialize();\n    }, [permissionsLoading]); //  STANDARD: permissionsLoading als Dependency (wird erneut ausgefhrt wenn Berechtigungen geladen sind)\n    \n    const handleTourSort = (key: TourSortConfig['key']) => {\n        // Table-Header-Sortierung: Aktualisiert Hauptsortierung direkt (synchron fr Table & Cards)\n        const newDirection = tourTableSortConfig.key === key && tourTableSortConfig.direction === 'asc' ? 'desc' : 'asc';\n        updateSortConfig({ key, direction: newDirection });\n    };\n    \n    // Drag & Drop Handler\n    const handleDragStart = (columnId: string) => {\n        setDraggedColumn(columnId);\n    };\n    \n    const handleDragOver = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n        if (draggedColumn && draggedColumn !== columnId) {\n            setDragOverColumn(columnId);\n        }\n    };\n    \n    const handleDrop = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n            if (draggedColumn && draggedColumn !== columnId) {\n                const columnOrder = settings?.columnOrder || defaultTourColumnOrder;\n                const dragIndex = columnOrder.indexOf(draggedColumn);\n                const hoverIndex = columnOrder.indexOf(columnId);\n\n                if (dragIndex > -1 && hoverIndex > -1) {\n                    const newColumnOrder = [...columnOrder];\n                const draggedColumn_ = newColumnOrder[dragIndex];\n                newColumnOrder.splice(dragIndex, 1);\n                newColumnOrder.splice(hoverIndex, 0, draggedColumn_);\n                updateColumnOrder(newColumnOrder);\n            }\n        }\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n    \n    const handleDragEnd = () => {\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n    \n    // Filtern und sortieren der Spalten gem den Benutzereinstellungen\n    const completeColumnOrder = useMemo(() => {\n        const currentOrder = settings?.columnOrder || [];\n        const validOrder = currentOrder.filter(id => id != null && typeof id === 'string');\n        const missingColumns = defaultTourColumnOrder.filter(id => !validOrder.includes(id));\n        return [...validOrder, ...missingColumns];\n    }, [settings?.columnOrder]);\n    \n    const visibleColumnIds = completeColumnOrder.filter(id => id != null && typeof id === 'string' && isColumnVisible(id));\n    \n    const getActiveFilterCount = () => {\n        return tourFilterConditions.length;\n    };\n    \n    // Filter- und Sortierlogik fr Tours\n    const filteredAndSortedTours = useMemo(() => {\n        // Sicherstellen, dass tours ein Array ist\n        if (!Array.isArray(tours)) {\n            return [];\n        }\n        \n        const validTours = tours.filter(tour => tour != null && tour.title != null && typeof tour.title === 'string');\n        \n        let filtered = validTours.filter(tour => {\n            // Such-Filter\n            if (tourSearchTerm) {\n                const searchLower = tourSearchTerm.toLowerCase();\n                \n                //  OPTIMIERUNG: Frhes Beenden bei Match\n                if (tour.title && tour.title.toLowerCase().includes(searchLower)) return true;\n                if (tour.location && tour.location.toLowerCase().includes(searchLower)) return true;\n                if (tour.description && tour.description.toLowerCase().includes(searchLower)) return true;\n                \n                return false; // Kein Match gefunden\n            }\n            \n            return true;\n        });\n\n        // Erweiterte Filterbedingungen anwenden\n        if (tourFilterConditions.length > 0) {\n            const columnEvaluators: Record<string, (tour: Tour, cond: FilterCondition) => boolean | null> = {\n                'title': (tour: Tour, cond: FilterCondition) => {\n                    if (!tour || !tour.title) return false;\n                    const value = (cond.value as string || '').toLowerCase();\n                    const title = (tour.title || '').toLowerCase();\n                    if (cond.operator === 'equals') return tour.title === cond.value;\n                    if (cond.operator === 'contains') return title.includes(value);\n                    if (cond.operator === 'startsWith') return title.startsWith(value);\n                    if (cond.operator === 'endsWith') return title.endsWith(value);\n                    return null;\n                },\n                'type': (tour: Tour, cond: FilterCondition) => {\n                    if (!tour || !tour.type) return false;\n                    if (cond.operator === 'equals') return tour.type === cond.value;\n                    if (cond.operator === 'notEquals') return tour.type !== cond.value;\n                    return null;\n                },\n                'isActive': (tour: Tour, cond: FilterCondition) => {\n                    const value = cond.value === 'true' || cond.value === true || cond.value === '1';\n                    if (cond.operator === 'equals') return tour.isActive === value;\n                    if (cond.operator === 'notEquals') return tour.isActive !== value;\n                    return null;\n                },\n                'price': (tour: Tour, cond: FilterCondition) => {\n                    const price = typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                    const compareValue = typeof cond.value === 'string' ? parseFloat(cond.value) : (cond.value || 0);\n                    if (isNaN(price) || isNaN(compareValue)) return false;\n                    if (cond.operator === 'equals') return Math.abs(price - compareValue) < 0.01;\n                    if (cond.operator === 'greaterThan') return price > compareValue;\n                    if (cond.operator === 'lessThan') return price < compareValue;\n                    return null;\n                },\n                'location': (tour: Tour, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const location = (tour.location || '').toLowerCase();\n                    if (cond.operator === 'equals') return tour.location === cond.value;\n                    if (cond.operator === 'contains') return location.includes(value);\n                    if (cond.operator === 'startsWith') return location.startsWith(value);\n                    if (cond.operator === 'endsWith') return location.endsWith(value);\n                    return null;\n                },\n                'branch': (tour: Tour, cond: FilterCondition) => {\n                    const branchName = (tour.branch?.name || '').toLowerCase();\n                    const value = (cond.value as string || '').toLowerCase();\n                    if (cond.operator === 'equals') return branchName === value;\n                    if (cond.operator === 'contains') return branchName.includes(value);\n                    return null;\n                },\n                'createdBy': (tour: Tour, cond: FilterCondition) => {\n                    const createdByName = tour.createdBy\n                        ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}`\n                        : '';\n                    return evaluateUserRoleCondition(\n                        tour.createdById || null,\n                        null,\n                        cond,\n                        createdByName\n                    );\n                }\n            };\n\n            const getFieldValue = (tour: Tour | null, columnId: string): string | number | boolean | null => {\n                if (!tour) return '';\n                switch (columnId) {\n                    case 'title': return tour.title || '';\n                    case 'type': return tour.type || '';\n                    case 'price': return typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                    case 'location': return tour.location || '';\n                    case 'duration': return tour.duration || 0;\n                    case 'branch': return tour.branch?.name || '';\n                    case 'createdBy': return tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}` : '';\n                    case 'isActive': return tour.isActive;\n                    default: return '';\n                }\n            };\n\n            filtered = applyFilters(\n                filtered,\n                tourFilterConditions,\n                tourFilterLogicalOperators,\n                getFieldValue,\n                columnEvaluators\n            );\n        }\n        \n        // Hilfsfunktion zum Extrahieren von Werten fr Sortierung\n        const getTourSortValue = (tour: Tour | null, columnId: string): string | number | boolean | null => {\n            if (!tour) return '';\n            switch (columnId) {\n                case 'title':\n                    return (tour.title || '').toLowerCase();\n                case 'type':\n                    return (tour.type || '').toLowerCase();\n                case 'price':\n                    return typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                case 'location':\n                    return (tour.location || '').toLowerCase();\n                case 'duration':\n                    return tour.duration || 0;\n                case 'branch':\n                    return (tour.branch?.name || '').toLowerCase();\n                case 'createdBy':\n                    return tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}`.toLowerCase() : '';\n                case 'isActive':\n                    return tour.isActive ? 1 : 0;\n                default:\n                    return '';\n            }\n        };\n        \n        // Sortierung basierend auf Prioritten\n        const sorted = filtered.sort((a, b) => {\n            // Null-Check fr a und b\n            if (!a || !b) {\n                if (!a && !b) return 0;\n                if (!a) return 1;\n                if (!b) return -1;\n            }\n            \n            // 2. Prioritt: Table-Header-Sortierung (temporre berschreibung, auch wenn Filter aktiv)\n            if (viewMode === 'table' && tourTableSortConfig.key) {\n                const valueA = getTourSortValue(a, tourTableSortConfig.key);\n                const valueB = getTourSortValue(b, tourTableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    //  OPTIMIERUNG: Vermeide String() Konvertierung wenn bereits String\n                    const strA = typeof valueA === 'string' ? valueA : String(valueA);\n                    const strB = typeof valueB === 'string' ? valueB : String(valueB);\n                    comparison = strA.localeCompare(strB);\n                }\n                \n                if (comparison !== 0) {\n                    return tourTableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 3. Hauptsortierung (tourTableSortConfig) - fr Table & Cards synchron\n            // (wird bereits oben in Prioritt 2 behandelt)\n            \n            // 4. Fallback: Titel (alphabetisch)\n            //  OPTIMIERUNG: toLowerCase() bereits in getTourSortValue, aber hier fr Fallback\n            const titleA = (a?.title || '').toLowerCase();\n            const titleB = (b?.title || '').toLowerCase();\n            return titleA.localeCompare(titleB);\n        });\n        \n        return sorted;\n    }, [tours, tourSearchTerm, tourFilterConditions, tourFilterLogicalOperators, viewMode, tourTableSortConfig]);\n\n    return (\n        <div className=\"space-y-4\">\n            {/* Header mit Suche, View-Toggle, Filter, Export, Create */}\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n                {/* Linke Seite: Suche */}\n                <div className=\"flex-1 w-full sm:max-w-md\">\n                    <input\n                        type=\"text\"\n                        placeholder={t('common.search') + '...'}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                        value={tourSearchTerm}\n                        onChange={(e) => setTourSearchTerm(e.target.value)}\n                    />\n                </div>\n                \n                {/* Rechte Seite: View-Toggle, Filter, Export, Create */}\n                <div className=\"flex items-center gap-1.5\">\n                    {/* View-Mode Toggle */}\n                    <div className=\"relative group\">\n                        <button\n                            className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n                                viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n                            }`}\n                            onClick={() => updateViewMode(viewMode === 'table' ? 'cards' : 'table')}\n                        >\n                            {viewMode === 'table' ? (\n                                <Squares2X2Icon className=\"h-5 w-5\" />\n                            ) : (\n                                <TableCellsIcon className=\"h-5 w-5\" />\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n                        </div>\n                    </div>\n                    \n                    {/* Filter-Button */}\n                    <div className=\"relative group ml-1\">\n                        <button\n                            className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n                            onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                        >\n                            <FunnelIcon className=\"h-5 w-5\" />\n                            {getActiveFilterCount() > 0 && (\n                                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                    {getActiveFilterCount()}\n                                </span>\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {t('common.filter')}\n                        </div>\n                    </div>\n                    \n                    {/* Export-Button */}\n                    {hasPermission('tour_edit', 'write', 'button') && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => setIsTourExportDialogOpen(true)}\n                                className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700\"\n                            >\n                                <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('tours.export', 'Exportieren')}\n                            </div>\n                        </div>\n                    )}\n                    \n                    {/* Spalten-Konfiguration */}\n                    <div className=\"ml-1\">\n                        <TableColumnConfig\n                            columns={viewMode === 'cards'\n                                ? [\n                                    { id: 'title', label: t('tours.columns.title', 'Titel') },\n                                    { id: 'type', label: t('tours.columns.type', 'Typ') },\n                                    { id: 'price', label: t('tours.columns.price', 'Preis') },\n                                    { id: 'location', label: t('tours.columns.location', 'Ort') },\n                                    { id: 'duration', label: t('tours.columns.duration', 'Dauer') },\n                                    { id: 'branch', label: t('tours.columns.branch', 'Niederlassung') },\n                                    { id: 'createdBy', label: t('tours.columns.createdBy', 'Erstellt von') },\n                                    { id: 'isActive', label: t('tours.columns.status', 'Status') }\n                                ]\n                                : availableTourColumns}\n                            visibleColumns={viewMode === 'cards'\n                                ? Array.from(visibleCardMetadata)\n                                : visibleColumnIds}\n                            columnOrder={viewMode === 'cards'\n                                ? cardMetadataOrder\n                                : settings.columnOrder}\n                            onToggleColumnVisibility={(columnId) => {\n                                if (viewMode === 'cards') {\n                                    const tableColumn = tourCardToTableMapping[columnId];\n                                    if (tableColumn) {\n                                        toggleColumnVisibility(tableColumn);\n                                    }\n                                } else {\n                                    toggleColumnVisibility(columnId);\n                                }\n                            }}\n                            onColumnOrderChange={(newOrder) => {\n                                if (viewMode === 'cards') {\n                                    const newTableOrder = newOrder.map(cardMeta => tourCardToTableMapping[cardMeta] || cardMeta).filter(Boolean);\n                                    updateColumnOrder(newTableOrder);\n                                } else {\n                                    updateColumnOrder(newOrder);\n                                }\n                            }}\n                            modalTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                            mainSortConfig={tourTableSortConfig}\n                            onMainSortChange={handleMainSortChange}\n                            showMainSort={true}\n                        />\n                    </div>\n                    \n                    {/* Create-Button */}\n                    {hasPermission('tour_create', 'write', 'button') && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => setIsCreateTourModalOpen(true)}\n                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                style={{ width: '30.19px', height: '30.19px' }}\n                                aria-label={t('tours.create', 'Neue Tour erstellen')}\n                            >\n                                <PlusIcon className=\"h-4 w-4\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('tours.create', 'Neue Tour erstellen')}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Filter-Pane */}\n            {isFilterModalOpen && (\n                <div className=\"px-3 sm:px-4 md:px-6\">\n                    <FilterPane\n                        columns={[...availableTourColumns, ...tourFilterOnlyColumns]}\n                        onApply={applyTourFilterConditions}\n                        onReset={resetTourFilterConditions}\n                        savedConditions={tourFilterConditions}\n                        savedOperators={tourFilterLogicalOperators}\n                        tableId={TOURS_TABLE_ID}\n                    />\n                </div>\n            )}\n\n            {/* Gespeicherte Filter als Tags */}\n            <SavedFilterTags\n                tableId={TOURS_TABLE_ID}\n                onSelectFilter={applyTourFilterConditions}\n                onReset={resetTourFilterConditions}\n                activeFilterName={tourActiveFilterName}\n                selectedFilterId={tourSelectedFilterId}\n                onFilterChange={handleTourFilterChange}\n                defaultFilterName=\"Aktuell\" //  FIX: Hardcodiert (konsistent mit DB)\n            />\n\n            {/* Table View */}\n            {viewMode === 'table' && (\n                <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                        <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                            <tr>\n                                {visibleColumnIds.map(columnId => {\n                                    const column = availableTourColumns.find(col => col.id === columnId);\n                                    if (!column) return null;\n                                    \n                                    return (\n                                        <th\n                                            key={columnId}\n                                            scope=\"col\"\n                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                            draggable={true}\n                                            onDragStart={() => handleDragStart(columnId)}\n                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                            onDrop={(e) => handleDrop(e, columnId)}\n                                            onDragEnd={handleDragEnd}\n                                        >\n                                            <div className=\"flex items-center\">\n                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                {columnId !== 'actions' && (\n                                                    <button \n                                                        onClick={() => handleTourSort(columnId as TourSortConfig['key'])}\n                                                        className=\"ml-1 focus:outline-none\"\n                                                    >\n                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                    </button>\n                                                )}\n                                            </div>\n                                        </th>\n                                    );\n                                })}\n                            </tr>\n                        </thead>\n                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                            {toursLoading ? (\n                                <tr>\n                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-gray-500 dark:text-gray-400\">\n                                        {t('common.loading')}\n                                    </td>\n                                </tr>\n                            ) : toursError ? (\n                                <tr>\n                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-red-500 dark:text-red-400\">\n                                        {toursError}\n                                    </td>\n                                </tr>\n                            ) : filteredAndSortedTours.length === 0 ? (\n                                <tr>\n                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-gray-500 dark:text-gray-400\">\n                                        {t('tours.noTours')}\n                                    </td>\n                                </tr>\n                            ) : (\n                                <>\n                                    {filteredAndSortedTours.slice(0, displayLimit).filter(tour => tour != null && tour.title != null).map(tour => (\n                                        <tr \n                                            key={tour.id} \n                                            className=\"hover:bg-gray-50 dark:hover:bg-gray-700\"\n                                        >\n                                            {visibleColumnIds.map(columnId => {\n                                                switch (columnId) {\n                                                    case 'title':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words\">\n                                                                    {tour?.title || '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'type':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'price':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.price ? `${Number(tour.price).toLocaleString()} ${tour.currency || 'COP'}` : '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'location':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.location || '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'duration':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.duration ? `${tour.duration} ${t('common.hours', 'h')}` : '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'branch':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.branch?.name || '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'createdBy':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}` : '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'isActive':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                {hasPermission('tour_edit', 'write', 'button') ? (\n                                                                    <button\n                                                                        onClick={async (e) => {\n                                                                            e.stopPropagation();\n                                                                            try {\n                                                                                await axiosInstance.put(API_ENDPOINTS.TOURS.TOGGLE_ACTIVE(tour.id));\n                                                                                showMessage(\n                                                                                    tour.isActive \n                                                                                        ? t('tours.deactivated', { defaultValue: 'Tour deaktiviert' })\n                                                                                        : t('tours.activated', { defaultValue: 'Tour aktiviert' }),\n                                                                                    'success'\n                                                                                );\n                                                                                await loadTours();\n                                                                            } catch (err: any) {\n                                                                                console.error('Fehler beim Toggle der Tour:', err);\n                                                                                showMessage(\n                                                                                    err.response?.data?.message || t('errors.unknownError'),\n                                                                                    'error'\n                                                                                );\n                                                                            }\n                                                                        }}\n                                                                        className={`px-2 py-1 text-xs rounded transition-colors ${\n                                                                            tour.isActive \n                                                                                ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 hover:bg-green-200 dark:hover:bg-green-800' \n                                                                                : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700'\n                                                                        }`}\n                                                                    >\n                                                                        {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                                                    </button>\n                                                                ) : (\n                                                                    <span className={`px-2 py-1 text-xs rounded ${\n                                                                        tour.isActive \n                                                                            ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' \n                                                                            : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                                                    }`}>\n                                                                        {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                                                    </span>\n                                                                )}\n                                                            </td>\n                                                        );\n                                                    case 'actions':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"flex space-x-2 action-buttons\">\n                                                                    <div className=\"relative group\">\n                                                                        <button\n                                                                            onClick={(e) => {\n                                                                                e.stopPropagation();\n                                                                                setSelectedTourId(tour.id);\n                                                                                setIsTourDetailsModalOpen(true);\n                                                                            }}\n                                                                            className=\"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                            title={t('common.viewDetails', { defaultValue: 'Details anzeigen' })}\n                                                                        >\n                                                                            <InformationCircleIcon className=\"h-4 w-4\" />\n                                                                        </button>\n                                                                        <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                            {t('common.viewDetails', 'Details anzeigen')}\n                                                                        </div>\n                                                                    </div>\n                                                                    {hasPermission('tour_edit', 'write', 'button') && (\n                                                                        <>\n                                                                            <div className=\"relative group\">\n                                                                                <button\n                                                                                    onClick={(e) => {\n                                                                                        e.stopPropagation();\n                                                                                        handleGenerateImages(tour.id);\n                                                                                    }}\n                                                                                    disabled={generatingImages[tour.id] || false}\n                                                                                    className={`p-1.5 transition-colors ${\n                                                                                        generatingImages[tour.id]\n                                                                                            ? 'text-gray-400 cursor-not-allowed'\n                                                                                            : 'text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300'\n                                                                                    }`}\n                                                                                    title={generatingImages[tour.id]\n                                                                                        ? t('tours.generatingImages', { defaultValue: 'Bilder werden generiert...' })\n                                                                                        : t('tours.generateImages', { defaultValue: 'Bilder generieren' })}\n                                                                                >\n                                                                                    <PhotoIcon className=\"h-4 w-4\" />\n                                                                                </button>\n                                                                                <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                    {generatingImages[tour.id]\n                                                                                        ? t('tours.generatingImages', { defaultValue: 'Bilder werden generiert...' })\n                                                                                        : t('tours.generateImages', { defaultValue: 'Bilder generieren' })}\n                                                                                </div>\n                                                                            </div>\n                                                                            <button\n                                                                                onClick={(e) => {\n                                                                                    e.stopPropagation();\n                                                                                    setSelectedTour(tour);\n                                                                                    setIsEditTourModalOpen(true);\n                                                                                }}\n                                                                                className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                title={t('tours.edit', { defaultValue: 'Bearbeiten' })}\n                                                                            >\n                                                                                <PencilIcon className=\"h-4 w-4\" />\n                                                                            </button>\n                                                                        </>\n                                                                    )}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    default:\n                                                        return null;\n                                                }\n                                            })}\n                                        </tr>\n                                    ))}\n                                </>\n                            )}\n                        </tbody>\n                    </table>\n                </div>\n            )}\n\n            {/* Card View */}\n            {viewMode === 'cards' && (\n                <CardGrid>\n                    {toursLoading ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                            {t('common.loading')}\n                        </div>\n                    ) : toursError ? (\n                        <div className=\"text-center py-8 text-red-500 dark:text-red-400\">\n                            {toursError}\n                        </div>\n                    ) : filteredAndSortedTours.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                            {t('tours.noTours')}\n                        </div>\n                    ) : (\n                        filteredAndSortedTours.slice(0, displayLimit).filter(tour => tour != null && tour.title != null).map((tour) => (\n                            <div\n                                key={tour.id}\n                                className=\"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 p-4 hover:shadow-md transition-shadow\"\n                            >\n                                {/* Bild-Anzeige */}\n                                {tour.imageUrl && (\n                                    <img \n                                        src={getTourImageUrl(tour.id)}\n                                        alt={tour.title || 'Tour Bild'}\n                                        className=\"w-full h-48 object-cover rounded-lg mb-2 cursor-pointer hover:opacity-90 transition-opacity\"\n                                        loading=\"lazy\"\n                                        onClick={() => {\n                                            setSelectedTourForLightbox(tour);\n                                            setInitialImageIndex(0);\n                                            setLightboxOpen(true);\n                                        }}\n                                    />\n                                )}\n                                \n                                {/* Galerie-Thumbnails */}\n                                {tour.galleryUrls && tour.galleryUrls.length > 0 && (\n                                    <div className=\"flex gap-2 mb-2 overflow-x-auto\">\n                                        {tour.galleryUrls.map((_, index) => (\n                                            <img\n                                                key={index}\n                                                src={getTourGalleryImageUrl(tour.id, index)}\n                                                alt={`${tour.title} - Galerie ${index + 1}`}\n                                                className=\"w-20 h-20 object-cover rounded cursor-pointer hover:opacity-90 transition-opacity flex-shrink-0\"\n                                                onClick={() => {\n                                                    setSelectedTourForLightbox(tour);\n                                                    setInitialImageIndex(index + 1); // +1 weil Index 0 = Hauptbild\n                                                    setLightboxOpen(true);\n                                                }}\n                                            />\n                                        ))}\n                                    </div>\n                                )}\n                                \n                                <div className=\"flex items-start justify-between mb-2\">\n                                    <h4 className=\"text-lg font-semibold dark:text-white\">{tour?.title || '-'}</h4>\n                                    {hasPermission('tour_edit', 'write', 'button') ? (\n                                        <button\n                                            onClick={async () => {\n                                                try {\n                                                    await axiosInstance.put(API_ENDPOINTS.TOURS.TOGGLE_ACTIVE(tour.id));\n                                                    showMessage(\n                                                        tour.isActive \n                                                            ? t('tours.deactivated', { defaultValue: 'Tour deaktiviert' })\n                                                            : t('tours.activated', { defaultValue: 'Tour aktiviert' }),\n                                                        'success'\n                                                    );\n                                                    await loadTours();\n                                                } catch (err: unknown) {\n                                                    console.error('Error toggling tour:', err);\n                                                    showMessage(\n                                                        (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.unknownError'),\n                                                        'error'\n                                                    );\n                                                }\n                                            }}\n                                            className={`px-2 py-1 text-xs rounded transition-colors ${\n                                                tour.isActive \n                                                    ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 hover:bg-green-200 dark:hover:bg-green-800' \n                                                    : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700'\n                                            }`}\n                                        >\n                                            {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                        </button>\n                                    ) : (\n                                        <span className={`px-2 py-1 text-xs rounded ${\n                                            tour.isActive \n                                                ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' \n                                                : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                        }`}>\n                                            {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                        </span>\n                                    )}\n                                </div>\n                                \n                                {tour.description && (\n                                    <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-2 line-clamp-2\">\n                                        {tour.description}\n                                    </p>\n                                )}\n\n                                <div className=\"flex items-center justify-between mt-4\">\n                                    <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                        <span className=\"font-medium\">{t('tours.type')}:</span>{' '}\n                                        {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                    </div>\n                                    {tour.price && (\n                                        <div className=\"text-sm font-semibold dark:text-white\">\n                                            {Number(tour.price).toLocaleString()} {tour.currency || 'COP'}\n                                        </div>\n                                    )}\n                                </div>\n                                \n                                {hasPermission('tour_edit', 'write', 'button') && (\n                                    <div className=\"mt-4 flex justify-end gap-2\">\n                                        {/* Bildgenerierungs-Button */}\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={() => handleGenerateImages(tour.id)}\n                                                disabled={generatingImages[tour.id] || false}\n                                                className={`p-1.5 rounded transition-colors ${\n                                                    generatingImages[tour.id]\n                                                        ? 'bg-gray-200 dark:bg-gray-600 text-gray-400 cursor-not-allowed'\n                                                        : 'text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/30'\n                                                }`}\n                                            >\n                                                <PhotoIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {generatingImages[tour.id]\n                                                    ? t('tours.generatingImages', { defaultValue: 'Bilder werden generiert...' })\n                                                    : t('tours.generateImages', { defaultValue: 'Bilder generieren' })}\n                                            </div>\n                                        </div>\n                                        <button\n                                            onClick={() => {\n                                                setSelectedTour(tour);\n                                                setIsEditTourModalOpen(true);\n                                            }}\n                                            className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                            title={t('tours.edit', { defaultValue: 'Bearbeiten' })}\n                                        >\n                                            <PencilIcon className=\"h-4 w-4\" />\n                                        </button>\n                                    </div>\n                                )}\n                            </div>\n                        ))\n                    )}\n                </CardGrid>\n            )}\n\n            {/* \"Mehr anzeigen\" Button */}\n            {filteredAndSortedTours.length > displayLimit && (\n                <div className=\"mt-4 flex justify-center\">\n                    <button\n                        className=\"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600\"\n                        onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                    >\n                        {t('common.showMore')} ({filteredAndSortedTours.length - displayLimit} {t('common.remaining')})\n                    </button>\n                </div>\n            )}\n\n            {/* Modals */}\n            <CreateTourModal\n                isOpen={isCreateTourModalOpen}\n                onClose={() => setIsCreateTourModalOpen(false)}\n                onTourCreated={async () => {\n                    await loadTours();\n                }}\n            />\n            \n            {selectedTour && (\n                <EditTourModal\n                    isOpen={isEditTourModalOpen}\n                    onClose={() => {\n                        setIsEditTourModalOpen(false);\n                        setSelectedTour(null);\n                    }}\n                    onTourUpdated={async (updatedTour) => {\n                        await loadTours();\n                        // Modal wird nur beim Speichern geschlossen, nicht beim Lschen von Bildern\n                        // setSelectedTour wird hier nicht auf null gesetzt, damit das Modal offen bleibt\n                    }}\n                    tour={selectedTour}\n                />\n            )}\n            \n            {selectedTourId && (\n                <TourDetailsModal\n                    isOpen={isTourDetailsModalOpen}\n                    onClose={() => {\n                        setIsTourDetailsModalOpen(false);\n                        setSelectedTourId(null);\n                    }}\n                    tourId={selectedTourId}\n                    onTourUpdated={async () => {\n                        await loadTours();\n                    }}\n                />\n            )}\n            \n            <TourExportDialog\n                isOpen={isTourExportDialogOpen}\n                onClose={() => setIsTourExportDialogOpen(false)}\n                tourCount={filteredAndSortedTours.length}\n            />\n            \n            {selectedTourForLightbox && (\n                <TourImageLightbox\n                    isOpen={lightboxOpen}\n                    onClose={() => {\n                        setLightboxOpen(false);\n                        setSelectedTourForLightbox(null);\n                    }}\n                    tourId={selectedTourForLightbox.id}\n                    initialImageIndex={initialImageIndex}\n                    imageUrl={selectedTourForLightbox.imageUrl}\n                    galleryUrls={selectedTourForLightbox.galleryUrls}\n                    tourTitle={selectedTourForLightbox.title}\n                />\n            )}\n        </div>\n    );\n};\n\nexport default ToursTab;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { CreateOrganizationRequest } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\nimport { useAuth } from '../../hooks/useAuth.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nconst CreateOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<CreateOrganizationRequest>({\n    name: '',\n    displayName: '',\n    domain: ''\n  });\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  const { fetchCurrentUser } = useAuth();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.name.trim()) {\n      newErrors.name = t('organization.create.nameRequired');\n    }\n    \n    if (!formData.displayName.trim()) {\n      newErrors.displayName = t('organization.create.displayNameRequired');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      await organizationService.createOrganization(formData);\n      setErrors({});\n      showMessage(t('organization.create.createSuccess'), 'success');\n      \n      // WICHTIG: User und Berechtigungen neu laden nach Erstellen der Organisation\n      // Der User wurde der Admin-Rolle zugeordnet und hat jetzt neue Berechtigungen\n      await fetchCurrentUser();\n      \n      // Formular zurcksetzen\n      setFormData({\n        name: '',\n        displayName: '',\n        domain: ''\n      });\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.create.createError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    setFormData({\n      name: '',\n      displayName: '',\n      domain: ''\n    });\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.create.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label \n                    htmlFor=\"name\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.name')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"name\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.name \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.name && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"displayName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.displayName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"displayName\"\n                    name=\"displayName\"\n                    value={formData.displayName}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.displayName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.displayName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"domain\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.domain')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"domain\"\n                    name=\"domain\"\n                    value={formData.domain}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.create.creating') : t('organization.create.createButton')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.create.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label \n                htmlFor=\"name\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.name')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.name \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.name && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"displayName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.displayName')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"displayName\"\n                name=\"displayName\"\n                value={formData.displayName}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.displayName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.displayName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"domain\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.domain')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"domain\"\n                name=\"domain\"\n                value={formData.domain}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? t('organization.create.creating') : t('organization.create.createButton')}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default CreateOrganizationModal; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { CreateJoinRequestRequest, Organization } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nconst JoinOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<CreateJoinRequestRequest>({\n    organizationName: '',\n    message: ''\n  });\n  const [loading, setLoading] = useState<boolean>(false);\n  const [searching, setSearching] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [organizations, setOrganizations] = useState<Organization[]>([]);\n  const [showDropdown, setShowDropdown] = useState<boolean>(false);\n  const [selectedOrganization, setSelectedOrganization] = useState<Organization | null>(null);\n  const searchTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  const { showMessage } = useMessage();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  // Click outside handler fr Dropdown\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setShowDropdown(false);\n      }\n    };\n\n    if (showDropdown) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showDropdown]);\n\n  const searchOrganizations = async (searchTerm: string) => {\n    if (searchTerm.length < 2) {\n      setOrganizations([]);\n      setShowDropdown(false);\n      return;\n    }\n\n    try {\n      setSearching(true);\n      const results = await organizationService.searchOrganizations(searchTerm);\n      setOrganizations(results);\n      setShowDropdown(true);\n    } catch (err: any) {\n      console.error('Fehler bei der Organisationen-Suche:', err);\n      setOrganizations([]);\n    } finally {\n      setSearching(false);\n    }\n  };\n\n  const handleOrganizationInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setFormData(prev => ({ ...prev, organizationName: value }));\n    setSelectedOrganization(null);\n    \n    // Fehler lschen\n    if (errors.organizationName) {\n      setErrors(prev => ({ ...prev, organizationName: '' }));\n    }\n\n    // Debounce fr Suche\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current);\n    }\n\n    searchTimeoutRef.current = setTimeout(() => {\n      searchOrganizations(value);\n    }, 300);\n  };\n\n  const handleSelectOrganization = (org: Organization) => {\n    setSelectedOrganization(org);\n    setFormData(prev => ({ ...prev, organizationName: org.name }));\n    setShowDropdown(false);\n    setOrganizations([]);\n  };\n\n  const handleMessageChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setFormData(prev => ({ ...prev, message: e.target.value }));\n    if (errors.message) {\n      setErrors(prev => ({ ...prev, message: '' }));\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.organizationName.trim()) {\n      newErrors.organizationName = t('organization.join.nameRequired');\n    } else if (!selectedOrganization) {\n      newErrors.organizationName = t('organization.join.selectFromList');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      await organizationService.createJoinRequest(formData);\n      setErrors({});\n      showMessage(t('organization.join.sendSuccess'), 'success');\n      // Formular zurcksetzen\n      setFormData({\n        organizationName: '',\n        message: ''\n      });\n      setSelectedOrganization(null);\n      setOrganizations([]);\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.join.sendError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    setFormData({\n      organizationName: '',\n      message: ''\n    });\n    setSelectedOrganization(null);\n    setOrganizations([]);\n    setErrors({});\n    setShowDropdown(false);\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current);\n    }\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.join.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div className=\"relative\" ref={dropdownRef}>\n                  <label \n                    htmlFor=\"organizationName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.join.search')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"organizationName\"\n                    name=\"organizationName\"\n                    value={formData.organizationName}\n                    onChange={handleOrganizationInputChange}\n                    placeholder={t('organization.join.searchPlaceholder')}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.organizationName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.organizationName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.organizationName}</p>\n                  )}\n                  \n                  {/* Autocomplete Dropdown */}\n                  {showDropdown && (organizations.length > 0 || searching) && (\n                    <div className=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto\">\n                      {searching ? (\n                        <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                          {t('organization.join.searching')}\n                        </div>\n                      ) : organizations.length > 0 ? (\n                        organizations.map(org => (\n                          <button\n                            key={org.id}\n                            type=\"button\"\n                            onClick={() => handleSelectOrganization(org)}\n                            className=\"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none\"\n                          >\n                            <div className=\"font-medium text-gray-900 dark:text-white\">\n                              {org.displayName || org.name}\n                            </div>\n                            {org.displayName && (\n                              <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                {org.name}\n                              </div>\n                            )}\n                          </button>\n                        ))\n                      ) : (\n                        <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                          {t('organization.join.noOrganizations')}\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"message\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.join.message')}\n                  </label>\n                  <textarea\n                    id=\"message\"\n                    name=\"message\"\n                    value={formData.message || ''}\n                    onChange={handleMessageChange}\n                    rows={3}\n                    placeholder={t('organization.join.messagePlaceholder')}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.join.sending') : t('organization.join.send')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.join.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"relative\" ref={dropdownRef}>\n              <label \n                htmlFor=\"organizationName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.join.search')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"organizationName\"\n                name=\"organizationName\"\n                value={formData.organizationName}\n                onChange={handleOrganizationInputChange}\n                placeholder={t('organization.join.searchPlaceholder')}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.organizationName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.organizationName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.organizationName}</p>\n              )}\n              \n              {/* Autocomplete Dropdown */}\n              {showDropdown && (organizations.length > 0 || searching) && (\n                <div className=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto\">\n                  {searching ? (\n                    <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                      {t('organization.join.searching')}\n                    </div>\n                  ) : organizations.length > 0 ? (\n                    organizations.map(org => (\n                      <button\n                        key={org.id}\n                        type=\"button\"\n                        onClick={() => handleSelectOrganization(org)}\n                        className=\"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none\"\n                      >\n                        <div className=\"font-medium text-gray-900 dark:text-white\">\n                          {org.displayName || org.name}\n                        </div>\n                        {org.displayName && (\n                          <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                            {org.name}\n                          </div>\n                        )}\n                      </button>\n                    ))\n                  ) : (\n                    <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                      {t('organization.join.noOrganizations')}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"message\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.join.message')}\n              </label>\n              <textarea\n                id=\"message\"\n                name=\"message\"\n                value={formData.message || ''}\n                onChange={handleMessageChange}\n                rows={3}\n                placeholder={t('organization.join.messagePlaceholder')}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? t('organization.join.sending') : t('organization.join.send')}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default JoinOrganizationModal; ","import React, { useState, useEffect, Suspense } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { UpdateOrganizationRequest, Organization } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\nimport { useLanguage } from '../../hooks/useLanguage.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\n//  PERFORMANCE: Lazy Loading fr Tab-Komponenten\nconst RoleConfigurationTab = React.lazy(() => import('./RoleConfigurationTab.tsx'));\nconst DocumentConfigurationTab = React.lazy(() => import('./DocumentConfigurationTab.tsx'));\nconst SMTPConfigurationTab = React.lazy(() => import('./SMTPConfigurationTab.tsx'));\nconst ApiConfigurationTab = React.lazy(() => import('./ApiConfigurationTab.tsx'));\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n  organization: Organization | null;\n}\n\nconst EditOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess, organization }) => {\n  const { t } = useTranslation();\n  const { fetchCurrentUser } = useAuth();\n  const [formData, setFormData] = useState<UpdateOrganizationRequest>({\n    displayName: '',\n    domain: '',\n    logo: '',\n    country: null,\n    nit: null,\n    settings: {}\n  });\n  //  PERFORMANCE: Organization mit Settings fr Tab-Komponenten\n  const [organizationWithSettings, setOrganizationWithSettings] = useState<Organization | null>(null);\n  const [selectedCountry, setSelectedCountry] = useState<string>('');\n  const [nit, setNit] = useState<string>('');\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  const { organizationLanguage, setOrganizationLanguage } = useLanguage();\n  const [selectedOrgLanguage, setSelectedOrgLanguage] = useState<string>('');\n  const [savingOrgLanguage, setSavingOrgLanguage] = useState<boolean>(false);\n  const [activeTab, setActiveTab] = useState<'general' | 'roles' | 'documents' | 'smtp' | 'api'>('general');\n  const [logoFile, setLogoFile] = useState<File | null>(null);\n  const [logoPreview, setLogoPreview] = useState<string | null>(null);\n\n  // Lnder-Liste\n  const COUNTRIES = [\n    { code: 'CO', name: t('countries.CO') },\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'DE', name: t('countries.DE') },\n    { code: 'AT', name: t('countries.AT') }\n  ];\n\n  // Lade Organisations-Daten wenn Modal geffnet wird\n  useEffect(() => {\n    if (isOpen && organization) {\n      //  PERFORMANCE: Settings laden wenn Modal geffnet wird und Settings fehlen\n      const loadSettingsIfNeeded = async () => {\n        let orgWithSettings = organization;\n        \n        // Settings laden wenn fehlen\n        if (!organization.settings) {\n          try {\n            orgWithSettings = await organizationService.getCurrentOrganization(undefined, true);\n          } catch (error) {\n            console.error('Fehler beim Laden der Settings:', error);\n          }\n        }\n        \n        //  PERFORMANCE: Organization mit Settings fr Tab-Komponenten speichern\n        setOrganizationWithSettings(orgWithSettings);\n        \n        const orgSettings = orgWithSettings.settings || {};\n        setFormData({\n          displayName: orgWithSettings.displayName || '',\n          domain: orgWithSettings.domain || '',\n          logo: orgWithSettings.logo || '',\n          country: orgWithSettings.country || null,\n          nit: orgWithSettings.nit || null,\n          settings: orgSettings\n        });\n        \n        // Setze Land direkt aus organization (statt aus settings)\n        setSelectedCountry(orgWithSettings.country || '');\n        setNit(orgWithSettings.nit || '');\n        \n        // Setze Logo-Preview wenn Logo vorhanden\n        if (orgWithSettings.logo) {\n          setLogoPreview(orgWithSettings.logo);\n        } else {\n          setLogoPreview(null);\n        }\n        setLogoFile(null);\n        \n        // Lade Organisation-Sprache\n        const loadOrgLanguage = async () => {\n          try {\n            const langResponse = await organizationService.getOrganizationLanguage();\n            setSelectedOrgLanguage(langResponse.language || '');\n          } catch (langError) {\n            console.error(t('organization.loadLanguageError'), langError);\n            setSelectedOrgLanguage('');\n          }\n        };\n        \n        loadOrgLanguage();\n      };\n      \n      loadSettingsIfNeeded();\n    } else if (!isOpen) {\n      //  PERFORMANCE: State zurcksetzen beim Schlieen\n      setOrganizationWithSettings(null);\n    }\n  }, [isOpen, organization, t]);\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    if (name === 'country') {\n      setSelectedCountry(value);\n      setFormData(prev => ({\n        ...prev,\n        country: value || null\n      }));\n      // Wenn Country nicht \"CO\" ist, NIT zurcksetzen\n      if (value !== 'CO') {\n        setNit('');\n        setFormData(prev => ({\n          ...prev,\n          nit: null\n        }));\n      }\n    } else if (name === 'nit') {\n      setNit(value);\n      setFormData(prev => ({\n        ...prev,\n        nit: value || null\n      }));\n    } else {\n      setFormData(prev => ({ ...prev, [name]: value }));\n    }\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleLogoFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Prfe Dateityp\n    if (!file.type.match('image/(png|jpeg|jpg)')) {\n      showMessage(t('organization.logoInvalidType') || 'Nur PNG und JPEG Dateien sind erlaubt', 'error');\n      return;\n    }\n\n    // Prfe Dateigre (max 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      showMessage(t('organization.logoTooLarge') || 'Logo darf maximal 5MB gro sein', 'error');\n      return;\n    }\n\n    setLogoFile(file);\n\n    // Erstelle Preview\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      const base64String = reader.result as string;\n      setLogoPreview(base64String);\n      setFormData(prev => ({ ...prev, logo: base64String }));\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    try {\n      setLoading(true);\n      setErrors({});\n      await organizationService.updateOrganization(formData);\n      showMessage(t('organization.updateSuccess'), 'success');\n      \n      // User-Daten neu laden, damit das Logo im Header aktualisiert wird\n      try {\n        await fetchCurrentUser();\n      } catch (error) {\n        console.error('Fehler beim Neuladen der User-Daten:', error);\n      }\n      \n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.updateError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    if (organization) {\n      const orgSettings = organization.settings || {};\n      setFormData({\n        displayName: organization.displayName || '',\n        domain: organization.domain || '',\n        logo: organization.logo || '',\n        country: organization.country || null,\n        nit: organization.nit || null,\n        settings: orgSettings\n      });\n      setSelectedCountry(organization.country || '');\n      setNit(organization.nit || '');\n    }\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.edit.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label \n                    htmlFor=\"displayName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.displayName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"displayName\"\n                    name=\"displayName\"\n                    value={formData.displayName || ''}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.displayName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.displayName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"domain\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.domain')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"domain\"\n                    name=\"domain\"\n                    value={formData.domain || ''}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"logo-mobile\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.logo') || 'Logo'}\n                  </label>\n                  <input\n                    type=\"file\"\n                    id=\"logo-mobile\"\n                    name=\"logo\"\n                    accept=\"image/png,image/jpeg,image/jpg\"\n                    onChange={handleLogoFileChange}\n                    className=\"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400\n                      file:mr-4 file:py-2 file:px-4\n                      file:rounded-md file:border-0\n                      file:text-sm file:font-semibold\n                      file:bg-blue-50 file:text-blue-700\n                      hover:file:bg-blue-100\n                      dark:file:bg-blue-900 dark:file:text-blue-300\n                      dark:hover:file:bg-blue-800\"\n                  />\n                  {logoPreview && (\n                    <div className=\"mt-2\">\n                      <img \n                        src={logoPreview} \n                        alt=\"Logo Preview\" \n                        className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                      />\n                    </div>\n                  )}\n                  {formData.logo && !logoPreview && (\n                    <div className=\"mt-2\">\n                      <img \n                        src={formData.logo} \n                        alt=\"Current Logo\" \n                        className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                      />\n                    </div>\n                  )}\n                </div>\n\n                {/* Land */}\n                <div className=\"border-t pt-4\">\n                  <label \n                    htmlFor=\"country\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.country')}\n                  </label>\n                  <select\n                    id=\"country\"\n                    name=\"country\"\n                    value={selectedCountry}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  >\n                    <option value=\"\">{t('organization.selectCountry')}</option>\n                    {COUNTRIES.map((country) => (\n                      <option key={country.code} value={country.code}>\n                        {country.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                {/* Organisation-Sprache */}\n                <div className=\"border-t pt-4\">\n                  <label \n                    htmlFor=\"organizationLanguage\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.language')}\n                  </label>\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\n                    {t('organization.languageDescription')}\n                  </p>\n                  <select\n                    id=\"organizationLanguage\"\n                    value={selectedOrgLanguage || organizationLanguage || ''}\n                    onChange={async (e) => {\n                      const newLanguage = e.target.value;\n                      setSelectedOrgLanguage(newLanguage);\n                      if (newLanguage && newLanguage !== organizationLanguage) {\n                        setSavingOrgLanguage(true);\n                        try {\n                          await setOrganizationLanguage(newLanguage);\n                          showMessage(t('common.save'), 'success');\n                        } catch (error) {\n                          console.error(t('organization.saveLanguageError'), error);\n                          showMessage(t('worktime.messages.orgLanguageError'), 'error');\n                        } finally {\n                          setSavingOrgLanguage(false);\n                        }\n                      }\n                    }}\n                    disabled={savingOrgLanguage || loading}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed\"\n                  >\n                    <option value=\"\">{t('settings.useOrganizationLanguage')} ({t('worktime.language.fallback')}: {t('worktime.language.german')})</option>\n                    <option value=\"de\">{t('worktime.language.german')}</option>\n                    <option value=\"es\">{t('worktime.language.spanish')}</option>\n                    <option value=\"en\">{t('worktime.language.english')}</option>\n                  </select>\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.saving') : t('common.save')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.edit.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        {/* Tabs Navigation */}\n        <div className=\"border-b border-gray-200 dark:border-gray-700\">\n          <nav className=\"-mb-px flex space-x-4 px-4\" aria-label=\"Tabs\">\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('general')}\n              className={`${\n                activeTab === 'general'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.general')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('roles')}\n              className={`${\n                activeTab === 'roles'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.roles')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('documents')}\n              className={`${\n                activeTab === 'documents'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.documents')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('smtp')}\n              className={`${\n                activeTab === 'smtp'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.smtp')}\n            </button>\n            {selectedCountry === 'CO' && (\n              <button\n                type=\"button\"\n                onClick={() => setActiveTab('api')}\n                className={`${\n                  activeTab === 'api'\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n              >\n                {t('organization.tabs.api')}\n              </button>\n            )}\n          </nav>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          {activeTab === 'general' && (\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label \n                htmlFor=\"displayName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.displayName')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"displayName\"\n                name=\"displayName\"\n                value={formData.displayName || ''}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.displayName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.displayName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"domain\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.domain')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"domain\"\n                name=\"domain\"\n                value={formData.domain || ''}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"logo\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.logo') || 'Logo'}\n              </label>\n              <input\n                type=\"file\"\n                id=\"logo\"\n                name=\"logo\"\n                accept=\"image/png,image/jpeg,image/jpg\"\n                onChange={handleLogoFileChange}\n                className=\"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400\n                  file:mr-4 file:py-2 file:px-4\n                  file:rounded-md file:border-0\n                  file:text-sm file:font-semibold\n                  file:bg-blue-50 file:text-blue-700\n                  hover:file:bg-blue-100\n                  dark:file:bg-blue-900 dark:file:text-blue-300\n                  dark:hover:file:bg-blue-800\"\n              />\n              {logoPreview && (\n                <div className=\"mt-2\">\n                  <img \n                    src={logoPreview} \n                    alt=\"Logo Preview\" \n                    className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                  />\n                </div>\n              )}\n              {formData.logo && !logoPreview && (\n                <div className=\"mt-2\">\n                  <img \n                    src={formData.logo} \n                    alt=\"Current Logo\" \n                    className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                  />\n                </div>\n              )}\n            </div>\n\n            {/* Land */}\n            <div className=\"border-t pt-4\">\n              <label \n                htmlFor=\"country\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.country')}\n              </label>\n              <select\n                id=\"country\"\n                name=\"country\"\n                value={selectedCountry}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              >\n                <option value=\"\">{t('organization.selectCountry')}</option>\n                {COUNTRIES.map((country) => (\n                  <option key={country.code} value={country.code}>\n                    {country.name}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            {/* NIT (nur fr Kolumbien) */}\n            {selectedCountry === 'CO' && (\n              <div>\n                <label \n                  htmlFor=\"nit\" \n                  className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                >\n                  {t('organization.nit')}\n                </label>\n                <input\n                  type=\"text\"\n                  id=\"nit\"\n                  name=\"nit\"\n                  value={nit}\n                  onChange={handleChange}\n                  placeholder={t('organization.nitDescription')}\n                  className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('organization.nitDescription')}\n                </p>\n              </div>\n            )}\n\n            {/* Organisation-Sprache */}\n            <div className=\"border-t pt-4\">\n              <label \n                htmlFor=\"organizationLanguage\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.language')}\n              </label>\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\n                {t('organization.languageDescription')}\n              </p>\n              <select\n                id=\"organizationLanguage\"\n                value={selectedOrgLanguage || organizationLanguage || ''}\n                onChange={async (e) => {\n                  const newLanguage = e.target.value;\n                  setSelectedOrgLanguage(newLanguage);\n                  if (newLanguage && newLanguage !== organizationLanguage) {\n                    setSavingOrgLanguage(true);\n                    try {\n                      await setOrganizationLanguage(newLanguage);\n                      showMessage(t('common.save'), 'success');\n                    } catch (error) {\n                      console.error('Fehler beim Speichern der Organisation-Sprache:', error);\n                      showMessage(t('worktime.messages.orgLanguageError'), 'error');\n                    } finally {\n                      setSavingOrgLanguage(false);\n                    }\n                  }\n                }}\n                disabled={savingOrgLanguage || loading}\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed\"\n              >\n                <option value=\"\">{t('settings.useOrganizationLanguage')} ({t('worktime.language.fallback')}: {t('worktime.language.german')})</option>\n                <option value=\"de\">{t('worktime.language.german')}</option>\n                <option value=\"es\">{t('worktime.language.spanish')}</option>\n                <option value=\"en\">{t('worktime.language.english')}</option>\n              </select>\n            </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.saving') : t('common.save')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          )}\n\n          {activeTab === 'roles' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <RoleConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n\n          {activeTab === 'documents' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <DocumentConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n\n          {activeTab === 'smtp' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <SMTPConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n\n          {activeTab === 'api' && selectedCountry === 'CO' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <ApiConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default EditOrganizationModal;\n\n","import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { XMarkIcon, ArrowPathIcon, FunnelIcon, ArrowUturnLeftIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport axiosInstance from '../../config/axios.ts';\nimport { logger } from '../../utils/logger.ts';\n\n// Status-Badge Funktionen\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case 'pending':\n      return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';\n    case 'approved':\n      return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\n    case 'rejected':\n      return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\n    case 'withdrawn':\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n    default:\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n  }\n};\n\nconst getStatusText = (status: string, t: any) => {\n  switch (status) {\n    case 'pending':\n      return t('joinRequestsList.status.pending');\n    case 'approved':\n      return t('joinRequestsList.status.approved');\n    case 'rejected':\n      return t('joinRequestsList.status.rejected');\n    case 'withdrawn':\n      return t('joinRequestsList.status.withdrawn');\n    default:\n      return status;\n  }\n};\n\nconst MY_JOIN_REQUESTS_TABLE_ID = 'my-join-requests-table';\n\nconst MyJoinRequestsList: React.FC = () => {\n  const { t } = useTranslation();\n  const [joinRequests, setJoinRequests] = useState<OrganizationJoinRequest[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState<boolean>(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const { showMessage } = useMessage();\n  const mountedRef = useRef(true);\n  const [withdrawingId, setWithdrawingId] = useState<number | null>(null);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n\n  useEffect(() => {\n    return () => {\n      mountedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    logger.log('MyJoinRequestsList: useEffect called - component mounted');\n    \n    // WICHTIG: State beim Mount zurcksetzen, um Caching zwischen Usern zu vermeiden\n    logger.log('MyJoinRequestsList: Resetting state on mount to prevent data leaks');\n    setJoinRequests([]);\n    setError(null);\n    setLoading(true);\n    \n    let isMounted = true;\n    \n    const fetchMyJoinRequests = async () => {\n      if (!isMounted) {\n        logger.log('MyJoinRequestsList: Component unmounted, skipping fetch');\n        return;\n      }\n      \n      logger.log('MyJoinRequestsList: Starting fetch');\n      \n      // Timeout nach 10 Sekunden\n      const timeoutId = setTimeout(() => {\n        if (isMounted) {\n          console.error('Request timeout after 10 seconds');\n          setError('Anfrage dauert zu lange. Bitte Seite neu laden.');\n          setLoading(false);\n        }\n      }, 10000);\n      \n      try {\n        logger.log('MyJoinRequestsList: Setting loading to true');\n        setLoading(true);\n        setError(null);\n        \n        // Debug: Log die URL die aufgerufen wird\n        logger.log('MyJoinRequestsList: Fetching my join requests from:', API_ENDPOINTS.ORGANIZATIONS.MY_JOIN_REQUESTS);\n        \n        const requests = await organizationService.getMyJoinRequests();\n        \n        logger.log('MyJoinRequestsList: Received requests:', requests);\n        logger.log('MyJoinRequestsList: Requests type:', typeof requests);\n        logger.log('MyJoinRequestsList: Requests isArray:', Array.isArray(requests));\n        logger.log('MyJoinRequestsList: Requests length:', requests?.length || 0);\n        \n        // SICHERHEIT: Validiere, dass alle Anfragen wirklich Arrays sind\n        if (!Array.isArray(requests)) {\n          console.error(' MyJoinRequestsList: Response is not an array!', requests);\n          throw new Error('Ungltige Antwort vom Server');\n        }\n        \n        clearTimeout(timeoutId);\n        \n        // State immer setzen, auch wenn Component unmounted ist\n        // (React kann den State trotzdem setzen, wenn Component wieder gemountet wird)\n        if (isMounted) {\n          logger.log('MyJoinRequestsList: Setting joinRequests state');\n          setJoinRequests(requests);\n          logger.log('MyJoinRequestsList: State updated with', requests.length, 'requests');\n        } else {\n          logger.log('MyJoinRequestsList: Component was unmounted, but setting state anyway');\n          setJoinRequests(requests);\n        }\n      } catch (err: any) {\n        clearTimeout(timeoutId);\n        \n        if (!isMounted) {\n          logger.log('MyJoinRequestsList: Component unmounted during error, skipping error handling');\n          return;\n        }\n        \n        console.error('MyJoinRequestsList: Error fetching my join requests:', err);\n        console.error('MyJoinRequestsList: Error response:', err.response);\n        console.error('MyJoinRequestsList: Error status:', err.response?.status);\n        console.error('MyJoinRequestsList: Error data:', err.response?.data);\n        \n        const errorMessage = err.response?.data?.message || err.message || t('myJoinRequests.loadError');\n        setError(errorMessage);\n        setTimeout(() => {\n          showMessage(errorMessage, 'error');\n        }, 0);\n      } finally {\n        if (isMounted) {\n          logger.log('MyJoinRequestsList: Setting loading to false');\n          setLoading(false);\n        } else {\n          // Auch wenn unmounted, loading auf false setzen\n          logger.log('MyJoinRequestsList: Component unmounted, but setting loading to false anyway');\n          setLoading(false);\n        }\n      }\n    };\n\n    // IMMER neu laden beim Mount (auch beim Tab-Wechsel zurck)\n    fetchMyJoinRequests();\n    \n    return () => {\n      logger.log('MyJoinRequestsList: useEffect cleanup - component unmounting');\n      isMounted = false;\n      mountedRef.current = false;\n      // State beim Unmount zurcksetzen\n      setJoinRequests([]);\n      setError(null);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleWithdraw = async (requestId: number) => {\n    if (!window.confirm(t('myJoinRequests.confirmWithdraw'))) {\n      return;\n    }\n\n    try {\n      setWithdrawingId(requestId);\n      await organizationService.withdrawJoinRequest(requestId);\n      \n      // Update local state\n      setJoinRequests(prev => \n        prev.map(req => \n          req.id === requestId \n            ? { ...req, status: 'withdrawn' as const, processedAt: new Date().toISOString() }\n            : req\n        )\n      );\n      \n      showMessage(t('myJoinRequests.withdrawSuccess'), 'success');\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('myJoinRequests.withdrawError');\n      showMessage(errorMessage, 'error');\n    } finally {\n      setWithdrawingId(null);\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('de-DE', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  // Filter-Funktionen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n\n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  useEffect(() => {\n    const initialize = async () => {\n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(MY_JOIN_REQUESTS_TABLE_ID);\n      \n      // 2. Default-Filter anwenden (IMMER vorhanden!)\n      const defaultFilter = filters.find(f => f.name === 'Alle');\n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        return; // Filter wird angewendet\n      }\n      \n      // 3. Fallback: Kein Filter (sollte nie passieren)\n      // MyJoinRequestsList filtert client-seitig, daher keine Daten-Lade-Funktion ntig\n    };\n    \n    initialize();\n  }, [loadFilters, handleFilterChange]);\n\n  // Standard-Filter erstellen und speichern\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(MY_JOIN_REQUESTS_TABLE_ID)\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: MY_JOIN_REQUESTS_TABLE_ID,\n            name: 'Alle',\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\n            alleFilter\n          );\n          logger.log('Alle-Filter fr Meine Beitrittsanfragen erstellt');\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []);\n\n  // Gefilterte Join-Requests\n  const filteredJoinRequests = useMemo(() => {\n    let filtered = [...joinRequests];\n\n    // Suchfeld-Filter\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(request => {\n        const orgName = (request.organization.displayName || request.organization.name || '').toLowerCase();\n        const message = request.message?.toLowerCase() || '';\n        return orgName.includes(searchLower) || message.includes(searchLower);\n      });\n    }\n\n    // Filter-Bedingungen aus FilterPane\n    if (filterConditions.length > 0) {\n      filtered = filterConditions.reduce((acc, condition, index) => {\n        if (!condition.column || condition.value === null || condition.value === '') {\n          return acc;\n        }\n\n        const operator = condition.operator;\n        const value = condition.value;\n\n        return acc.filter(request => {\n          switch (condition.column) {\n            case 'organization':\n              const orgName = (request.organization.displayName || request.organization.name || '').toLowerCase();\n              const searchValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return orgName.includes(searchValue);\n              } else if (operator === 'equals') {\n                return orgName === searchValue;\n              } else if (operator === 'startsWith') {\n                return orgName.startsWith(searchValue);\n              }\n              return false;\n\n            case 'message':\n              const message = request.message?.toLowerCase() || '';\n              const msgValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return message.includes(msgValue);\n              } else if (operator === 'equals') {\n                return message === msgValue;\n              } else if (operator === 'startsWith') {\n                return message.startsWith(msgValue);\n              }\n              return false;\n\n            case 'status':\n              if (operator === 'equals') {\n                return request.status === value;\n              }\n              return false;\n\n            default:\n              return true;\n          }\n        });\n      }, filtered);\n    }\n\n    return filtered;\n  }, [joinRequests, searchTerm, filterConditions, filterLogicalOperators]);\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n      {/* Titelzeile mit Icon, Suchfeld, Filter-Button */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <h2 className=\"text-xl font-semibold dark:text-white\">\n          {t('myJoinRequests.title')}\n        </h2>\n        \n        <div className=\"flex items-center gap-1.5\">\n          {/* Suchfeld */}\n          <input\n            type=\"text\"\n            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n\n          {/* Filter-Button */}\n          <button\n            className={`p-2 rounded-md border ${getActiveFilterCount() > 0 ? 'border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n            onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n            title={t('common.filter')}\n          >\n            <FunnelIcon className=\"h-5 w-5\" />\n            {getActiveFilterCount() > 0 && (\n              <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                {getActiveFilterCount()}\n              </span>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Filter-Panel */}\n      {isFilterPanelOpen && (\n        <div className=\"mb-4\">\n          <FilterPane\n            columns={[\n              { id: 'organization', label: t('myJoinRequests.filter.organization', { defaultValue: 'Organisation' }) },\n              { id: 'message', label: t('joinRequestsList.filter.message') },\n              { id: 'status', label: t('joinRequestsList.status.title', { defaultValue: 'Status' }) }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={MY_JOIN_REQUESTS_TABLE_ID}\n          />\n        </div>\n      )}\n\n      {/* Gespeicherte Filter als Tags anzeigen */}\n      <SavedFilterTags\n        tableId={MY_JOIN_REQUESTS_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n        defaultFilterName=\"Alle\"\n      />\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded\">\n          {error}\n        </div>\n      )}\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('myJoinRequests.loading')}</span>\n        </div>\n      ) : joinRequests.length === 0 ? (\n        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n          {t('myJoinRequests.noRequests')}\n        </div>\n      ) : (\n        /* Cards fr Join-Requests */\n        <div className=\"space-y-4\">\n          {filteredJoinRequests.map(request => (\n            <div\n              key={request.id}\n              className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\"\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                        {request.organization.displayName || request.organization.name}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        {formatDate(request.createdAt)}\n                      </p>\n                    </div>\n                    <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(request.status)}`}>\n                      {getStatusText(request.status, t)}\n                    </span>\n                  </div>\n\n                  {request.message && (\n                    <div className=\"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.filter.message')}:</span> {request.message}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.response && (\n                    <div className=\"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700\">\n                      <p className=\"text-sm text-blue-700 dark:text-blue-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.response')}:</span> {request.response}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.processor && (\n                    <div className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\n                      {t('myJoinRequests.processedBy')}: {request.processor.firstName} {request.processor.lastName}\n                      {request.processedAt && ` - ${formatDate(request.processedAt)}`}\n                    </div>\n                  )}\n\n                  {request.status === 'pending' && (\n                    <div className=\"mt-4 flex items-center gap-2\">\n                      <button \n                        onClick={() => handleWithdraw(request.id)}\n                        disabled={withdrawingId === request.id}\n                        className=\"p-2 bg-red-600 hover:bg-red-700 text-white rounded-md dark:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n                        title={withdrawingId === request.id ? t('myJoinRequests.withdrawing') : t('myJoinRequests.withdraw')}\n                      >\n                        {withdrawingId === request.id ? (\n                          <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                        ) : (\n                          <ArrowUturnLeftIcon className=\"h-5 w-5\" />\n                        )}\n                      </button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default MyJoinRequestsList;\n\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { BuildingOfficeIcon, PlusIcon, UserPlusIcon, UserGroupIcon, ShieldCheckIcon, EnvelopeIcon, ChartBarIcon, PencilIcon } from '@heroicons/react/24/outline';\nimport { useTranslation } from 'react-i18next';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { Organization } from '../../types/organization.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useOrganization } from '../../contexts/OrganizationContext.tsx';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport CreateOrganizationModal from './CreateOrganizationModal.tsx';\nimport JoinOrganizationModal from './JoinOrganizationModal.tsx';\nimport EditOrganizationModal from './EditOrganizationModal.tsx';\nimport MyJoinRequestsList from './MyJoinRequestsList.tsx';\n\ninterface OrganizationStats {\n  currentUsers: number;\n  maxUsers: number;\n  availableSlots: number;\n  utilizationPercent: number;\n  _count: {\n    roles: number;\n    joinRequests: number;\n    invitations: number;\n  };\n}\n\nconst OrganizationSettings: React.FC = () => {\n  const [organization, setOrganization] = useState<Organization | null>(null);\n  const [stats, setStats] = useState<OrganizationStats | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [loadingStats, setLoadingStats] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState<boolean>(false);\n  const [isJoinModalOpen, setIsJoinModalOpen] = useState<boolean>(false);\n  const [isEditModalOpen, setIsEditModalOpen] = useState<boolean>(false);\n  const { canViewOrganization, canManageOrganization, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  const { t } = useTranslation();\n  const { refreshOrganization } = useOrganization();\n  const { fetchCurrentUser } = useAuth();\n\n  const fetchOrganization = useCallback(async (includeSettings = false) => {\n    try {\n      setLoading(true);\n      setError(null);\n      //  PERFORMANCE: Settings nur laden wenn wirklich bentigt (beim Bearbeiten)\n      const org = await organizationService.getCurrentOrganization(undefined, includeSettings);\n      setOrganization(org);\n      \n      // Statistiken laden\n      try {\n        setLoadingStats(true);\n        const statsData = await organizationService.getOrganizationStats();\n        setStats(statsData);\n      } catch (statsErr: any) {\n        console.error('Fehler beim Laden der Statistiken:', statsErr);\n        // Statistiken-Fehler nicht kritisch, keine Error-Message\n      } finally {\n        setLoadingStats(false);\n      }\n    } catch (err: any) {\n      // Prfe ob es ein 404-Fehler ist (keine Organisation gefunden)\n      if (err.response?.status === 404 && err.response?.data?.hasOrganization === false) {\n        // Benutzer hat keine Organisation - das ist OK, setze Error aber nicht kritisch\n        // Verwende IMMER die bersetzung, nicht die Backend-Nachricht\n        setError(t('organization.notFound'));\n        setOrganization(null);\n        // Zeige Info-Message statt Error\n        showMessage(t('organization.notFound'), 'info');\n      } else {\n        // Andere Fehler - kritisch\n        const errorMessage = err.response?.data?.message || t('organization.loadError');\n        setError(errorMessage);\n        showMessage(errorMessage, 'error');\n      }\n    } finally {\n      setLoading(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const hasInitialLoadRef = useRef(false);\n\n  useEffect(() => {\n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      return;\n    }\n\n    // Nur einmal beim initialen Load ausfhren\n    if (hasInitialLoadRef.current) {\n      return;\n    }\n\n    const hasPermission = canViewOrganization();\n    if (hasPermission) {\n    hasInitialLoadRef.current = true;\n    //  PERFORMANCE: Initial OHNE Settings laden (nur beim Bearbeiten)\n    fetchOrganization(false);\n    } else {\n      setError(t('organization.noPermission'));\n      setLoading(false);\n      hasInitialLoadRef.current = true;\n    }\n    \n    //  MEMORY: Cleanup - Settings aus State entfernen beim Unmount\n    return () => {\n      setOrganization(null);\n      setStats(null);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [permissionsLoading]);\n\n  const handleEditSuccess = () => {\n    //  PERFORMANCE: Nach Bearbeiten Settings laden (fr Anzeige)\n    fetchOrganization(true);\n    // Aktualisiere auch den OrganizationContext\n    refreshOrganization();\n  };\n\n  //  MEMORY: Settings beim Schlieen des Modals lschen\n  const handleEditModalClose = () => {\n    setIsEditModalOpen(false);\n    // Settings aus State entfernen (nur Settings, nicht die gesamte Organization)\n    if (organization?.settings) {\n      setOrganization({\n        ...organization,\n        settings: undefined\n      });\n    }\n  };\n\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('common.loadingPermissions')}</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canViewOrganization()) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n          <div className=\"p-4 text-red-600 dark:text-red-400\">\n          {t('organization.noPermission')}\n        </div>\n      </div>\n    );\n  }\n\n  const handleCreateSuccess = () => {\n    //  PERFORMANCE: Nach Erstellen OHNE Settings laden (nicht bentigt)\n    fetchOrganization(false);\n  };\n\n  const handleJoinSuccess = async () => {\n    // Nach Beitritt: Organisation neu laden (OHNE Settings, nicht bentigt)\n    fetchOrganization(false);\n    // WICHTIG: User-Rollen neu laden, damit neue Rolle sichtbar wird\n    // OnboardingContext erkennt dann automatisch die neue Rolle\n    await fetchCurrentUser();\n  };\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        {/* Titelzeile mit Action-Buttons */}\n        <div className=\"flex items-center mb-4 sm:mb-4\">\n          {/* Linke Seite: Action-Buttons */}\n          <div className=\"flex items-center gap-1.5\" data-onboarding=\"organization-buttons\">\n            {/* Button: Neue Organisation erstellen - immer sichtbar (nicht nur fr Admins) */}\n            <button\n              onClick={() => setIsCreateModalOpen(true)}\n              data-onboarding=\"create-organization-button\"\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('organization.createOrganization')}\n              aria-label={t('organization.createOrganization')}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n            </button>\n            \n            {/* Button: Organisation beitreten - immer sichtbar */}\n            <button\n              onClick={() => setIsJoinModalOpen(true)}\n              data-onboarding=\"join-organization-button\"\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('organization.joinOrganization')}\n              aria-label={t('organization.joinOrganization')}\n            >\n              <UserPlusIcon className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('common.loadingOrganization')}</span>\n        </div>\n      ) : (\n        <>\n          {/* Error/Info Display */}\n          {error && (\n            <div className={`mb-4 p-4 border rounded ${\n              !organization \n                ? 'bg-blue-50 dark:bg-blue-900/30 border-blue-400 dark:border-blue-700 text-blue-700 dark:text-blue-300'\n                : 'bg-red-100 dark:bg-red-900 border-red-400 dark:border-red-700 text-red-700 dark:text-red-300'\n            }`}>\n              <div className=\"flex items-start\">\n                <div className=\"flex-shrink-0\">\n                  {!organization ? (\n                    <UserGroupIcon className=\"h-5 w-5\" />\n                  ) : (\n                    <span className=\"text-red-600 dark:text-red-400\"></span>\n                  )}\n                </div>\n                <div className=\"ml-3 flex-1\">\n                  <p className=\"font-medium\">{error}</p>\n                  {!organization && (\n                    <p className=\"mt-2 text-sm\">{t('organization.createOrJoinHint')}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Card-Ansicht - nur anzeigen wenn Organisation existiert */}\n          {organization ? (\n            <>\n            {/* Card mit Organisations-Infos */}\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-4\">\n            <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white flex items-center\">\n                        <BuildingOfficeIcon className=\"h-5 w-5 mr-2\" />\n                        {organization.displayName || organization.name}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                        {organization.domain || t('organization.noDomain')}\n                      </p>\n            </div>\n                    {canManageOrganization() && (\n                      <button\n                        onClick={() => {\n                          //  PERFORMANCE: Modal ffnet sofort - Settings werden im Modal geladen wenn bentigt\n                          setIsEditModalOpen(true);\n                        }}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                        title={t('organization.edit.title')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                      </button>\n                    )}\n            </div>\n\n                  {/* Organisations-Infos */}\n                  <div className=\"space-y-3\">\n                    {organization.subscriptionPlan && (\n            <div>\n                        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">{t('organization.subscriptionPlan')}:</span>\n                        <span className=\"ml-2 text-sm text-gray-900 dark:text-white capitalize\">{organization.subscriptionPlan}</span>\n              </div>\n            )}\n              </div>\n\n                  {/* Statistiken direkt in der Card */}\n          {stats && (\n                    <>\n            <div className=\"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700\">\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">{t('organization.statistics')}</h3>\n              {loadingStats ? (\n                <div className=\"flex items-center justify-center py-4\">\n                  <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-2\"></div>\n                  <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('common.loadingStatistics')}</span>\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {/* Benutzer Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-blue-100 dark:bg-blue-900/30 rounded-lg p-3\">\n                        <UserGroupIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.users')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats.currentUsers} / {stats.maxUsers}\n                        </p>\n                            {stats.utilizationPercent !== undefined && (\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            {stats.utilizationPercent}% {t('organization.utilizationPercent')}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Rollen Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-purple-100 dark:bg-purple-900/30 rounded-lg p-3\">\n                        <ShieldCheckIcon className=\"h-6 w-6 text-purple-600 dark:text-purple-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.roles')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats._count.roles}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Beitrittsanfragen Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg p-3\">\n                        <EnvelopeIcon className=\"h-6 w-6 text-yellow-600 dark:text-yellow-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.joinRequests')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats._count.joinRequests}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Einladungen Card */}\n                  {stats._count.invitations !== undefined && (\n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 bg-green-100 dark:bg-green-900/30 rounded-lg p-3\">\n                          <EnvelopeIcon className=\"h-6 w-6 text-green-600 dark:text-green-400\" />\n                        </div>\n                        <div className=\"ml-4\">\n                          <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.invitations')}</p>\n                          <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                            {stats._count.invitations}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Auslastung Card */}\n                  {stats.utilizationPercent !== undefined && (\n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg p-3\">\n                          <ChartBarIcon className=\"h-6 w-6 text-indigo-600 dark:text-indigo-400\" />\n                        </div>\n                        <div className=\"ml-4\">\n                          <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.utilization')}</p>\n                          <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                            {stats.utilizationPercent}%\n                          </p>\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            {stats.availableSlots} {t('organization.availableSlots')}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n                    </>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            </>\n          ) : (\n            /* Keine Organisation - zeige Hinweis */\n            <div className=\"text-center py-8\">\n            <UserGroupIcon className=\"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500 mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\n              {t('organization.notFound')}\n            </h3>\n            <p className=\"text-gray-600 dark:text-gray-400\">\n              {t('organization.createOrJoinHint')}\n            </p>\n          </div>\n        )}\n        </>\n      )}\n      </div>\n\n      {/* Meine Beitrittsanfragen - immer anzeigen */}\n      <MyJoinRequestsList />\n\n      {/* Modals */}\n      <CreateOrganizationModal\n        isOpen={isCreateModalOpen}\n        onClose={() => setIsCreateModalOpen(false)}\n        onSuccess={handleCreateSuccess}\n      />\n\n      <JoinOrganizationModal\n        isOpen={isJoinModalOpen}\n        onClose={() => setIsJoinModalOpen(false)}\n        onSuccess={handleJoinSuccess}\n      />\n\n      <EditOrganizationModal\n        isOpen={isEditModalOpen}\n        onClose={handleEditModalClose}\n        onSuccess={handleEditSuccess}\n        organization={organization}\n      />\n    </>\n  );\n};\n\nexport default OrganizationSettings; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon, XCircleIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest, ProcessJoinRequestRequest } from '../../types/organization.ts';\nimport { roleApi } from '../../api/apiClient.ts';\nimport { Role } from '../../types/interfaces.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  joinRequest: OrganizationJoinRequest | null;\n  onSuccess: () => void;\n}\n\nconst ProcessJoinRequestModal: React.FC<Props> = ({ isOpen, onClose, joinRequest, onSuccess }) => {\n  const { t } = useTranslation();\n  const [action, setAction] = useState<'approve' | 'reject'>('approve');\n  const [roleId, setRoleId] = useState<number | null>(null);\n  const [response, setResponse] = useState<string>('');\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState<boolean>(false);\n  const [saving, setSaving] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  useEffect(() => {\n    if (isOpen && joinRequest) {\n      // Reset form when modal opens\n      setAction('approve');\n      setRoleId(null);\n      setResponse('');\n      setErrors({});\n      \n      // Load roles for the organization\n      if (joinRequest.organizationId) {\n        fetchRoles();\n      }\n    }\n  }, [isOpen, joinRequest]);\n\n  const fetchRoles = async () => {\n    try {\n      setLoadingRoles(true);\n      const response = await roleApi.getAll();\n      if (response.data && Array.isArray(response.data)) {\n        setRoles(response.data);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Rollen:', err);\n      showMessage(t('joinRequest.loadRolesError'), 'error');\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (action === 'approve' && !roleId) {\n      newErrors.roleId = t('joinRequest.selectRoleError');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    if (!joinRequest) {\n      return;\n    }\n    \n    try {\n      setSaving(true);\n      const data: ProcessJoinRequestRequest = {\n        action,\n        response: response.trim() || undefined,\n        roleId: action === 'approve' ? roleId || undefined : undefined\n      };\n      \n      await organizationService.processJoinRequest(joinRequest.id, data);\n      showMessage(\n        action === 'approve' ? t('joinRequest.approveSuccess') : t('joinRequest.rejectSuccess'),\n        'success'\n      );\n      \n      // Reset form\n      setAction('approve');\n      setRoleId(null);\n      setResponse('');\n      setErrors({});\n      \n      onClose();\n      onSuccess();\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('joinRequest.processError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleClose = () => {\n    setAction('approve');\n    setRoleId(null);\n    setResponse('');\n    setErrors({});\n    onClose();\n  };\n\n  if (!joinRequest) {\n    return null;\n  }\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('joinRequest.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                {/* Antragsteller Info */}\n                <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                  <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.applicant')}:</p>\n                  <p className=\"text-sm text-gray-900 dark:text-white\">\n                    {joinRequest.requester.firstName} {joinRequest.requester.lastName}\n                  </p>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.requester.email}</p>\n                  {joinRequest.message && (\n                    <div className=\"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.message')}:</p>\n                      <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.message}</p>\n                    </div>\n                  )}\n                </div>\n\n                {/* Aktion (Genehmigen/Ablehnen) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('joinRequest.actionRequired')}\n                  </label>\n                  <div className=\"flex gap-4 mt-2\">\n                    <label className=\"flex items-center\">\n                      <input\n                        type=\"radio\"\n                        value=\"approve\"\n                        checked={action === 'approve'}\n                        onChange={(e) => {\n                          setAction(e.target.value as 'approve' | 'reject');\n                          setErrors({});\n                        }}\n                        className=\"mr-2 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.approve')}</span>\n                    </label>\n                    <label className=\"flex items-center\">\n                      <input\n                        type=\"radio\"\n                        value=\"reject\"\n                        checked={action === 'reject'}\n                        onChange={(e) => {\n                          setAction(e.target.value as 'approve' | 'reject');\n                          setErrors({});\n                        }}\n                        className=\"mr-2 text-red-600 focus:ring-red-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.reject')}</span>\n                    </label>\n                  </div>\n                </div>\n\n                {/* Rollenauswahl (nur bei Genehmigung) */}\n                {action === 'approve' && (\n                  <div>\n                    <label \n                      htmlFor=\"roleId\" \n                      className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                    >\n                      {t('joinRequest.assignRole')}\n                    </label>\n                    {loadingRoles ? (\n                      <div className=\"flex items-center py-2\">\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n                        <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('joinRequest.loadingRoles')}</span>\n                      </div>\n                    ) : (\n                      <select\n                        id=\"roleId\"\n                        value={roleId || ''}\n                        onChange={(e) => {\n                          setRoleId(Number(e.target.value) || null);\n                          if (errors.roleId) {\n                            setErrors(prev => ({ ...prev, roleId: '' }));\n                          }\n                        }}\n                        className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                          errors.roleId \n                            ? 'border-red-300 dark:border-red-600' \n                            : 'border-gray-300 dark:border-gray-600'\n                        }`}\n                      >\n                        <option value=\"\">{t('joinRequest.selectRole')}</option>\n                        {roles.map(role => (\n                          <option key={role.id} value={role.id}>\n                            {role.name} {role.description ? `- ${role.description}` : ''}\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                    {errors.roleId && (\n                      <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.roleId}</p>\n                    )}\n                  </div>\n                )}\n\n                {/* Antwort-Message */}\n                <div>\n                  <label \n                    htmlFor=\"response\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('joinRequest.response')}\n                  </label>\n                  <textarea\n                    id=\"response\"\n                    value={response}\n                    onChange={(e) => setResponse(e.target.value)}\n                    rows={3}\n                    placeholder={t('joinRequest.addOptional', { type: action === 'approve' ? t('joinRequest.welcomeMessage') : t('joinRequest.rejectionReason') })}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={saving}\n                  className={`p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ${\n                    action === 'approve'\n                      ? 'bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500'\n                      : 'bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500'\n                  }`}\n                  title={saving ? (action === 'approve' ? t('joinRequest.approving') : t('joinRequest.rejecting')) : (action === 'approve' ? t('joinRequest.approve') : t('joinRequest.reject'))}\n                >\n                  {saving ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : action === 'approve' ? (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  ) : (\n                    <XCircleIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('joinRequest.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Antragsteller Info */}\n            <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n              <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.applicant')}:</p>\n              <p className=\"text-sm text-gray-900 dark:text-white\">\n                {joinRequest.requester.firstName} {joinRequest.requester.lastName}\n              </p>\n              <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.requester.email}</p>\n              {joinRequest.message && (\n                <div className=\"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600\">\n                  <p className=\"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.message')}:</p>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.message}</p>\n                </div>\n              )}\n            </div>\n\n            {/* Aktion (Genehmigen/Ablehnen) */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('joinRequest.actionRequired')}\n              </label>\n              <div className=\"flex gap-4 mt-2\">\n                <label className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    value=\"approve\"\n                    checked={action === 'approve'}\n                    onChange={(e) => {\n                      setAction(e.target.value as 'approve' | 'reject');\n                      setErrors({});\n                    }}\n                    className=\"mr-2 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.approve')}</span>\n                </label>\n                <label className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    value=\"reject\"\n                    checked={action === 'reject'}\n                    onChange={(e) => {\n                      setAction(e.target.value as 'approve' | 'reject');\n                      setErrors({});\n                    }}\n                    className=\"mr-2 text-red-600 focus:ring-red-500\"\n                  />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.reject')}</span>\n                </label>\n              </div>\n            </div>\n\n            {/* Rollenauswahl (nur bei Genehmigung) */}\n            {action === 'approve' && (\n              <div>\n                <label \n                  htmlFor=\"roleId\" \n                  className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                >\n                  {t('joinRequest.assignRole')}\n                </label>\n                {loadingRoles ? (\n                  <div className=\"flex items-center py-2\">\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n                    <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('joinRequest.loadingRoles')}</span>\n                  </div>\n                ) : (\n                  <select\n                    id=\"roleId\"\n                    value={roleId || ''}\n                    onChange={(e) => {\n                      setRoleId(Number(e.target.value) || null);\n                      if (errors.roleId) {\n                        setErrors(prev => ({ ...prev, roleId: '' }));\n                      }\n                    }}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.roleId \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  >\n                    <option value=\"\">{t('joinRequest.selectRole')}</option>\n                    {roles.map(role => (\n                      <option key={role.id} value={role.id}>\n                        {role.name} {role.description ? `- ${role.description}` : ''}\n                      </option>\n                    ))}\n                  </select>\n                )}\n                {errors.roleId && (\n                  <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.roleId}</p>\n                )}\n              </div>\n            )}\n\n            {/* Antwort-Message */}\n            <div>\n              <label \n                htmlFor=\"response\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('joinRequest.response')}\n              </label>\n              <textarea\n                id=\"response\"\n                value={response}\n                onChange={(e) => setResponse(e.target.value)}\n                rows={3}\n                placeholder={t('joinRequest.addOptional', { type: action === 'approve' ? t('joinRequest.welcomeMessage') : t('joinRequest.rejectionReason') })}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={saving}\n                className={`p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ${\n                  action === 'approve'\n                    ? 'bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500'\n                    : 'bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500'\n                }`}\n                title={saving ? (action === 'approve' ? 'Genehmige...' : 'Lehne ab...') : (action === 'approve' ? 'Genehmigen' : 'Ablehnen')}\n              >\n                {saving ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : action === 'approve' ? (\n                  <CheckIcon className=\"h-5 w-5\" />\n                ) : (\n                  <XCircleIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default ProcessJoinRequestModal;\n\n","import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { UserPlusIcon, FunnelIcon, PencilIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest } from '../../types/organization.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport ProcessJoinRequestModal from './ProcessJoinRequestModal.tsx';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\nimport { logger } from '../../utils/logger.ts';\n\n// Status-Badge Funktionen\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case 'pending':\n      return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';\n    case 'approved':\n      return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\n    case 'rejected':\n      return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\n    case 'withdrawn':\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n    default:\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n  }\n};\n\nconst getStatusText = (status: string, t: any) => {\n  switch (status) {\n    case 'pending':\n      return t('joinRequestsList.status.pending');\n    case 'approved':\n      return t('joinRequestsList.status.approved');\n    case 'rejected':\n      return t('joinRequestsList.status.rejected');\n    case 'withdrawn':\n      return t('joinRequestsList.status.withdrawn');\n    default:\n      return status;\n  }\n};\n\nconst JOIN_REQUESTS_TABLE_ID = 'join-requests-table';\n\nconst JoinRequestsList: React.FC = () => {\n  const { t } = useTranslation();\n  const [joinRequests, setJoinRequests] = useState<OrganizationJoinRequest[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState<boolean>(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [isProcessModalOpen, setIsProcessModalOpen] = useState<boolean>(false);\n  const [selectedRequest, setSelectedRequest] = useState<OrganizationJoinRequest | null>(null);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  const { canViewJoinRequests, canManageJoinRequests, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  const mountedRef = useRef(true);\n  const hasInitialLoadRef = useRef(false);\n\n  // Debug: Log permissionsLoading nderungen\n  useEffect(() => {\n    logger.log('[JoinRequestsList] permissionsLoading gendert:', permissionsLoading);\n  }, [permissionsLoading]);\n\n  // Reset beim Mount - wichtig fr Neuladen wenn Komponente neu gemountet wird\n  useEffect(() => {\n    logger.log('[JoinRequestsList] Component mounted, reset hasInitialLoadRef');\n    hasInitialLoadRef.current = false;\n    mountedRef.current = true;\n    \n    return () => {\n      logger.log('[JoinRequestsList] Component unmounting');\n      mountedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    logger.log('[JoinRequestsList] useEffect triggered', { \n      permissionsLoading, \n      hasInitialLoad: hasInitialLoadRef.current,\n      joinRequestsCount: joinRequests.length \n    });\n    \n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      logger.log('[JoinRequestsList] Warte auf Berechtigungen...');\n      return;\n    }\n\n    // Prfe Berechtigung direkt\n    const hasPermission = canViewJoinRequests();\n    logger.log('[JoinRequestsList] Berechtigung geprft:', hasPermission);\n    \n    if (!hasPermission) {\n      logger.log('[JoinRequestsList] Keine Berechtigung zum Anzeigen');\n      setError(t('joinRequestsList.noPermission'));\n      setLoading(false);\n      hasInitialLoadRef.current = true;\n      return;\n    }\n\n    // WICHTIG: Nur laden wenn noch nicht erfolgreich geladen wurde\n    // Das verhindert unntige Re-Fetches bei jedem permissionsLoading-Change\n    if (hasInitialLoadRef.current) {\n      logger.log('[JoinRequestsList] Bereits geladen, berspringe Fetch');\n      return;\n    }\n\n    logger.log('[JoinRequestsList] Starte Fetch der Join Requests...');\n    \n    const fetchJoinRequests = async () => {\n      if (!mountedRef.current) {\n        logger.log('[JoinRequestsList] Component unmounted, breche ab');\n        return;\n      }\n      \n      try {\n        logger.log('[JoinRequestsList] Setze loading auf true');\n        setLoading(true);\n        setError(null);\n        \n        logger.log('[JoinRequestsList] Rufe organizationService.getJoinRequests() auf...');\n        logger.log('[JoinRequestsList] API Endpoint:', API_ENDPOINTS.ORGANIZATIONS.JOIN_REQUESTS);\n        \n        const requests = await organizationService.getJoinRequests();\n        \n        logger.log('[JoinRequestsList] Antwort erhalten:', requests);\n        logger.log('[JoinRequestsList] Antwort Typ:', typeof requests);\n        logger.log('[JoinRequestsList] Ist Array:', Array.isArray(requests));\n        logger.log('[JoinRequestsList] Ist null/undefined:', requests === null || requests === undefined);\n        \n        if (!mountedRef.current) {\n          logger.log('[JoinRequestsList] Component whrend Request unmounted');\n          return;\n        }\n        \n        // Validiere, dass die Antwort vorhanden ist\n        if (requests === null || requests === undefined) {\n          console.error('[JoinRequestsList]  Antwort ist null oder undefined!');\n          throw new Error('Ungltige Antwort vom Server: Antwort ist null oder undefined');\n        }\n        \n        // Validiere, dass die Antwort ein Array ist\n        if (!Array.isArray(requests)) {\n          console.error('[JoinRequestsList]  Antwort ist kein Array!', requests);\n          throw new Error('Ungltige Antwort vom Server: Erwartetes Array, erhalten: ' + typeof requests);\n        }\n        \n        logger.log('[JoinRequestsList]  Setze', requests.length, 'Join Requests');\n        setJoinRequests(requests);\n        setError(null); // Fehler zurcksetzen bei Erfolg\n        hasInitialLoadRef.current = true; // Nur bei Erfolg setzen\n      } catch (err: any) {\n        console.error('[JoinRequestsList]  Fehler beim Laden:', err);\n        console.error('[JoinRequestsList] Fehler Details:', {\n          message: err.message,\n          response: err.response,\n          status: err.response?.status,\n          data: err.response?.data,\n          stack: err.stack\n        });\n        \n        if (!mountedRef.current) {\n          logger.log('[JoinRequestsList] Component whrend Error-Handling unmounted');\n          return;\n        }\n        \n        const errorMessage = err.response?.data?.message || err.message || t('joinRequestsList.loadError', { defaultValue: 'Fehler beim Laden der Beitrittsanfragen' });\n        logger.log('[JoinRequestsList] Zeige Fehlermeldung:', errorMessage);\n        setError(errorMessage);\n        // showMessage nur auerhalb useEffect verwenden, um Re-Renders zu vermeiden\n        // Verwende setTimeout, um es asynchron auszufhren\n        setTimeout(() => {\n          showMessage(errorMessage, 'error');\n        }, 0);\n        // Bei Fehler NICHT hasInitialLoadRef setzen, damit bei nchstem permissionsLoading-Change neu geladen wird\n      } finally {\n        if (mountedRef.current) {\n          logger.log('[JoinRequestsList] Setze loading auf false');\n          setLoading(false);\n        }\n      }\n    };\n\n    fetchJoinRequests();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [permissionsLoading]); // canViewJoinRequests ist eine Funktion, nicht als Dependency\n\n  const handleOpenProcessModal = (request: OrganizationJoinRequest) => {\n    if (!canManageJoinRequests()) {\n      const errorMessage = t('joinRequestsList.noPermissionEdit');\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n      return;\n    }\n    setSelectedRequest(request);\n    setIsProcessModalOpen(true);\n  };\n\n  const handleProcessSuccess = async () => {\n    // Neulade die Liste nach erfolgreicher Bearbeitung\n    // Reset das Flag, damit neu geladen werden kann\n    hasInitialLoadRef.current = false;\n    \n    try {\n      setLoading(true);\n      const requests = await organizationService.getJoinRequests();\n      setJoinRequests(requests);\n      setError(null);\n      hasInitialLoadRef.current = true;\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || 'Fehler beim Laden der Beitrittsanfragen';\n      setError(errorMessage);\n      hasInitialLoadRef.current = true;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Filter-Funktionen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n\n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n  \n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  useEffect(() => {\n    const initialize = async () => {\n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(JOIN_REQUESTS_TABLE_ID);\n      \n      // 2. Default-Filter anwenden (IMMER vorhanden!)\n      const defaultFilter = filters.find(f => f.name === 'Alle');\n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        return; // Filter wird angewendet\n      }\n      \n      // 3. Fallback: Kein Filter (sollte nie passieren)\n      // fetchJoinRequests wird bereits durch useEffect aufgerufen\n    };\n    \n    initialize();\n  }, [loadFilters, handleFilterChange]);\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  //  PERFORMANCE: Filter werden von SavedFilterTags geladen (FilterContext)\n  //  PERFORMANCE: Standard-Filter wird im Seed erstellt (nicht mehr im Frontend)\n  // Keine redundanten API-Calls mehr ntig\n\n  // Gefilterte Join-Requests\n  const filteredJoinRequests = useMemo(() => {\n    let filtered = [...joinRequests];\n\n    // Suchfeld-Filter\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(request => {\n        const requesterName = `${request.requester.firstName} ${request.requester.lastName}`.toLowerCase();\n        const requesterEmail = request.requester.email?.toLowerCase() || '';\n        const message = request.message?.toLowerCase() || '';\n        return requesterName.includes(searchLower) || requesterEmail.includes(searchLower) || message.includes(searchLower);\n      });\n    }\n\n    // Filter-Bedingungen aus FilterPane\n    if (filterConditions.length > 0) {\n      filtered = filterConditions.reduce((acc, condition, index) => {\n        if (!condition.column || condition.value === null || condition.value === '') {\n          return acc;\n        }\n\n        const operator = condition.operator;\n        const value = condition.value;\n\n        return acc.filter(request => {\n          switch (condition.column) {\n            case 'requester':\n              const requesterName = `${request.requester.firstName} ${request.requester.lastName}`.toLowerCase();\n              const requesterEmail = request.requester.email?.toLowerCase() || '';\n              const searchValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return requesterName.includes(searchValue) || requesterEmail.includes(searchValue);\n              } else if (operator === 'equals') {\n                return requesterName === searchValue || requesterEmail === searchValue;\n              } else if (operator === 'startsWith') {\n                return requesterName.startsWith(searchValue) || requesterEmail.startsWith(searchValue);\n    }\n              return false;\n\n            case 'message':\n              const message = request.message?.toLowerCase() || '';\n              const msgValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return message.includes(msgValue);\n              } else if (operator === 'equals') {\n                return message === msgValue;\n              } else if (operator === 'startsWith') {\n                return message.startsWith(msgValue);\n              }\n              return false;\n\n            case 'status':\n              if (operator === 'equals') {\n                return request.status === value;\n              }\n              return false;\n\n            default:\n              return true;\n          }\n        });\n      }, filtered);\n    }\n\n    return filtered;\n  }, [joinRequests, searchTerm, filterConditions, filterLogicalOperators]);\n\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('joinRequestsList.loadingPermissions')}</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canViewJoinRequests()) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n      <div className=\"p-4 text-red-600 dark:text-red-400\">\n        {t('joinRequestsList.noPermission')}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 sm:p-6 mb-6\">\n      {/* Titelzeile mit Icon, Suchfeld, Filter-Button */}\n      <div className=\"flex items-center justify-between mb-4 sm:mb-4\">\n        <h2 className=\"text-xl sm:text-xl font-semibold flex items-center dark:text-white\">\n          <UserPlusIcon className=\"h-6 w-6 sm:h-6 sm:w-6 mr-2 sm:mr-2\" />\n          {t('joinRequestsList.title')}\n        </h2>\n        \n        <div className=\"flex items-center gap-1.5\">\n          {/* Suchfeld */}\n          <input\n            type=\"text\"\n            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n\n          {/* Filter-Button */}\n          <button\n            className={`p-2 rounded-md border ${getActiveFilterCount() > 0 ? 'border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n            onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n            title={t('common.filter')}\n          >\n            <FunnelIcon className=\"h-5 w-5\" />\n            {getActiveFilterCount() > 0 && (\n              <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                {getActiveFilterCount()}\n              </span>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Filter-Panel */}\n      {isFilterPanelOpen && (\n        <div className=\"mb-4\">\n          <FilterPane\n            columns={[\n              { id: 'requester', label: t('joinRequestsList.filter.requester') },\n              { id: 'message', label: t('joinRequestsList.filter.message') },\n              { id: 'status', label: t('joinRequestsList.status.title', { defaultValue: 'Status' }) }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={JOIN_REQUESTS_TABLE_ID}\n          />\n        </div>\n      )}\n\n      {/* Gespeicherte Filter als Tags anzeigen */}\n      <SavedFilterTags\n        tableId={JOIN_REQUESTS_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n        defaultFilterName=\"Alle\"\n      />\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded\">\n          {error}\n        </div>\n      )}\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('joinRequestsList.loading')}</span>\n        </div>\n      ) : filteredJoinRequests.length === 0 ? (\n        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n          {joinRequests.length === 0 \n            ? t('joinRequestsList.noRequests')\n            : t('joinRequestsList.noMatching')}\n        </div>\n      ) : (\n        /* Cards fr Join-Requests */\n        <div className=\"space-y-4\">\n          {filteredJoinRequests.map(request => (\n            <div\n              key={request.id}\n              className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\"\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                        {request.requester.firstName} {request.requester.lastName}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        {request.requester.email}\n              </p>\n                    </div>\n                    <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(request.status)}`}>\n                      {getStatusText(request.status, t)}\n                    </span>\n                  </div>\n\n                  {request.message && (\n                    <div className=\"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.filter.message')}:</span> {request.message}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.response && (\n                    <div className=\"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700\">\n                      <p className=\"text-sm text-blue-700 dark:text-blue-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.response')}:</span> {request.response}\n                      </p>\n                    </div>\n                  )}\n\n              {request.status === 'pending' && canManageJoinRequests() && (\n                    <div className=\"mt-4 flex items-center gap-2\">\n                  <button \n                        onClick={() => handleOpenProcessModal(request)}\n                        className=\"p-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                        title={t('joinRequestsList.edit')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Process Join Request Modal */}\n      <ProcessJoinRequestModal\n        isOpen={isProcessModalOpen}\n        onClose={() => {\n          setIsProcessModalOpen(false);\n          setSelectedRequest(null);\n        }}\n        joinRequest={selectedRequest}\n        onSuccess={handleProcessSuccess}\n      />\n    </div>\n  );\n};\n\nexport default JoinRequestsList; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { UserGroupIcon, UserIcon, ShieldCheckIcon, MapPinIcon, TruckIcon, CalendarIcon } from '@heroicons/react/24/outline';\nimport UserManagementTab from '../components/UserManagementTab.tsx';\nimport RoleManagementTab from '../components/RoleManagementTab.tsx';\nimport BranchManagementTab from '../components/BranchManagementTab.tsx';\nimport TourProvidersTab from '../components/tours/TourProvidersTab.tsx';\nimport ToursTab from '../components/tours/ToursTab.tsx';\nimport useMessage from '../hooks/useMessage.ts';\nimport OrganizationSettings from '../components/organization/OrganizationSettings.tsx';\nimport JoinRequestsList from '../components/organization/JoinRequestsList.tsx';\n\nconst Organisation: React.FC = () => {\n  const { t } = useTranslation();\n  // Gemeinsame States\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const { showMessage } = useMessage();\n\n  const { \n    isAdmin, \n    hasPermission, \n    canViewOrganization,\n    loading: permissionsLoading\n  } = usePermissions();\n\n  // Berechtigungen prfen\n  const canViewOrganisation = hasPermission('organization_management', 'read', 'page');\n  const canViewUsers = hasPermission('users', 'read', 'table');\n  const canViewRoles = hasPermission('roles', 'read', 'table');\n  const canViewBranches = hasPermission('branches', 'read', 'table');\n  const canViewProviders = hasPermission('tour_providers', 'read', 'table');\n  const canViewOrg = canViewOrganization();\n\n  const [activeTabState, setActiveTabState] = useState<'users' | 'roles' | 'branches' | 'providers' | 'organization'>('users');\n  const [providersViewMode, setProvidersViewMode] = useState<'tours' | 'providers'>('tours');\n  const isInitialized = useRef(false);\n\n  // Tab beim ersten Laden basierend auf Berechtigungen setzen (nur wenn Berechtigungen geladen sind)\n  // Reihenfolge: users -> roles -> branches -> providers -> organization\n  useEffect(() => {\n    if (!permissionsLoading && !isInitialized.current) {\n      let defaultTab: 'users' | 'roles' | 'branches' | 'providers' | 'organization' = 'organization'; // Fallback\n      \n      if (canViewUsers) {\n        defaultTab = 'users';\n      } else if (canViewRoles) {\n        defaultTab = 'roles';\n      } else if (canViewBranches) {\n        defaultTab = 'branches';\n      } else if (canViewProviders) {\n        defaultTab = 'providers';\n      } else if (canViewOrg) {\n        defaultTab = 'organization';\n      }\n      \n      setActiveTabState(defaultTab);\n      isInitialized.current = true;\n    }\n  }, [permissionsLoading, canViewUsers, canViewRoles, canViewBranches, canViewProviders, canViewOrg]);\n\n  // Tab-Wechsel Handler - Fehler beim Wechsel zurcksetzen\n  const handleTabChange = (tab: 'users' | 'roles' | 'branches' | 'providers' | 'organization') => {\n    // Prfe Berechtigung fr den Tab\n    if (tab === 'users' && !canViewUsers) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'roles' && !canViewRoles) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'branches' && !canViewBranches) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'providers' && !canViewProviders) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'organization' && !canViewOrg) {\n      return; // Tab nicht aktivierbar\n    }\n    setActiveTabState(tab);\n    setError(null);\n  };\n\n  // Gemeinsame Fehlerbehandlung entfernt - ErrorContext wird jetzt verwendet\n\n  // Keine Berechtigung fr die Seite\n  if (!canViewOrganisation) {\n    return <div className=\"p-4 text-red-600 dark:text-red-400\">{t('organisation.noPermission')}</div>;\n  }\n\n  return (\n    <div className=\"min-h-screen dark:bg-gray-900\">\n      <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          {/* Header mit Icon */}\n          <div className=\"flex items-center mb-6\">\n            <UserGroupIcon className=\"h-6 w-6 mr-2 dark:text-white\" />\n            <h2 className=\"text-xl font-semibold dark:text-white\">{t('organisation.title')}</h2>\n          </div>\n\n          {/* Tabs fr Navigation */}\n          <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n            <nav className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden\">\n              {/* Users Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'users' && canViewUsers\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewUsers\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                onClick={() => canViewUsers && handleTabChange('users')}\n                disabled={!canViewUsers}\n              >\n                <UserIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                {t('organisation.tabs.users')}\n                {!canViewUsers && (\n                  <span className=\"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Roles Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'roles' && canViewRoles\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewRoles\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                onClick={() => canViewRoles && handleTabChange('roles')}\n                disabled={!canViewRoles}\n              >\n                <ShieldCheckIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                {t('organisation.tabs.roles')}\n                {!canViewRoles && (\n                  <span className=\"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Branches Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'branches' && canViewBranches\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewBranches\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                onClick={() => canViewBranches && handleTabChange('branches')}\n                disabled={!canViewBranches}\n              >\n                <MapPinIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                {t('organisation.tabs.branches', { defaultValue: 'Niederlassungen' })}\n                {!canViewBranches && (\n                  <span className=\"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Providers Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'providers' && canViewProviders\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewProviders\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                onClick={() => canViewProviders && handleTabChange('providers')}\n                disabled={!canViewProviders}\n              >\n                <TruckIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                {t('organisation.tabs.providers', { defaultValue: 'Proveedores' })}\n                {!canViewProviders && (\n                  <span className=\"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Organization Tab - sichtbar wenn berechtigt */}\n              {canViewOrg && (\n                <button\n                  className={`${\n                    activeTabState === 'organization'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                  } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center flex-shrink-0`}\n                  onClick={() => handleTabChange('organization')}\n                >\n                  <UserGroupIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                  {t('organisation.tabs.organization')}\n                </button>\n              )}\n            </nav>\n          </div>\n\n          {error && (\n            <div className=\"bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded mb-4\">\n              <p className=\"font-bold\">{t('organisation.error')}</p>\n              <p>{error}</p>\n            </div>\n          )}\n\n          {loading && <div className=\"p-4 dark:text-gray-300\">{t('organisation.loading')}</div>}\n\n          {/* Tab Inhalte */}\n          <div className=\"mt-6\">\n            {activeTabState === 'users' ? (\n              canViewUsers ? (\n                <UserManagementTab />\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.users')}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'roles' ? (\n              canViewRoles ? (\n                <RoleManagementTab />\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.roles')}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'branches' ? (\n              canViewBranches ? (\n                <BranchManagementTab />\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.branches', { defaultValue: 'Niederlassungs-Verwaltung ist eine PRO-Funktion' })}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'providers' ? (\n              canViewProviders ? (\n                <div className=\"space-y-4\">\n                  {/* Switch fr Tours/Providers */}\n                  <div className=\"flex gap-2 mb-4\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setProvidersViewMode('tours')}\n                      className={`p-2 rounded-md transition-colors ${\n                        providersViewMode === 'tours'\n                          ? 'bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400'\n                          : 'text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700'\n                      }`}\n                      title={t('tours.title', 'Touren')}\n                    >\n                      <CalendarIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={() => setProvidersViewMode('providers')}\n                      className={`p-2 rounded-md transition-colors ${\n                        providersViewMode === 'providers'\n                          ? 'bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400'\n                          : 'text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700'\n                      }`}\n                      title={t('organisation.tabs.providers', { defaultValue: 'Proveedores' })}\n                    >\n                      <TruckIcon className=\"h-5 w-5\" />\n                    </button>\n                  </div>\n                  \n                  {/* Bedingtes Rendering */}\n                  {providersViewMode === 'tours' ? (\n                    <ToursTab />\n                  ) : (\n                    <TourProvidersTab />\n                  )}\n                </div>\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.providers', { defaultValue: 'Tour-Provider-Verwaltung ist eine PRO-Funktion' })}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'organization' && canViewOrg ? (\n              <div className=\"space-y-6\">\n                <OrganizationSettings />\n                <JoinRequestsList />\n              </div>\n            ) : (\n              <div className=\"p-4 text-red-600 dark:text-red-400\">\n                {t('organisation.noPermissionForPage')}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Organisation;\n\n\n"],"names":["evaluateCondition","fieldValue","condition","operator","value","undefined","console","error","strField","strValue","fieldValueStr","String","lowerField","toLowerCase","valueStr","lowerValue","includes","startsWith","typeof","endsWith","fieldDate","Date","valueDate","isNaN","getTime","fieldNum","parseFloat","valueNum","applyFilters","items","conditions","operators","getFieldValue","columnEvaluators","length","filter","item","result","i","conditionMet","column","customResult","evaluateDateCondition","dateValue","date","dateYear","getUTCFullYear","dateMonth","getUTCMonth","dateDay","getUTCDate","normalizedDate","weekStart","startOfWeek","weekStartsOn","setHours","weekEnd","endOfWeek","monthStart","startOfMonth","monthEnd","endOfMonth","yearStart","startOfYear","yearEnd","endOfYear","conditionDate","localToday","conditionDateRaw","conditionYear","conditionMonth","conditionDay","concat","evaluateUserRoleCondition","userId","roleId","textValue","targetUserId","parseInt","replace","matches","targetRoleId","textValueLower","valueLower","_ref","isOpen","onClose","onBookingCreated","tour","preselectedTour","t","useTranslation","user","useAuth","showMessage","useMessage","tourId","setTourId","useState","id","tourDate","setTourDate","numberOfParticipants","setNumberOfParticipants","customerName","setCustomerName","customerEmail","setCustomerEmail","customerPhone","setCustomerPhone","customerNotes","setCustomerNotes","tours","setTours","selectedTour","setSelectedTour","setError","loading","setLoading","loadingData","setLoadingData","useEffect","async","_response$data","response","axiosInstance","get","API_ENDPOINTS","TOURS","BASE","params","isActive","toursData","data","Array","isArray","err","loadData","find","Number","_jsxs","Dialog","open","className","children","_jsx","Panel","Title","defaultValue","onClick","XMarkIcon","onSubmit","e","preventDefault","trim","numPart","minParticipants","min","max","maxParticipants","_response$data2","_response$data3","post","TOUR_BOOKINGS","_response$data4","success","Error","message","_response","_response$data5","errorMessage","onChange","target","required","disabled","title","map","type","rows","CheckIcon","onCertificateCreated","userName","currentUser","isHR","isAdmin","permissionsLoading","usePermissions","openSidepane","closeSidepane","useSidepane","isMobile","setIsMobile","window","innerWidth","isLargeScreen","setIsLargeScreen","activeTab","setActiveTab","userData","setUserData","issueDate","setIssueDate","toISOString","split","certificateType","setCertificateType","pdfFile","setPdfFile","pdfPreviewUrl","setPdfPreviewUrl","uploading","setUploading","availableTemplates","setAvailableTemplates","selectedTemplate","setSelectedTemplate","useTemplate","setUseTemplate","fileInputRef","useRef","handleResize","addEventListener","removeEventListener","fetchUserData","fetchTemplates","documentTemplates","ORGANIZATION_LIFECYCLE","DOCUMENT_TEMPLATES","templates","employmentCertificate","push","version","path","userResponse","lifecycleResponse","Promise","all","USERS","BY_ID","LIFECYCLE","BY_USER","lifecycle","userDataObj","firstName","lastName","identificationNumber","contractStartDate","contractEndDate","contractType","salary","position","URL","revokeObjectURL","style","animation","DocumentTextIcon","_Fragment","UserIcon","CalendarIcon","toLocaleDateString","checked","template","ref","accept","event","_event$target$files","file","files","size","url","createObjectURL","name","toFixed","current","_fileInputRef$current","click","src","height","validationError","validateForm","issueDateObj","pdfPath","templateUsed","templateVersion","now","certificateData","CERTIFICATES","_err$response","_err$response$data","ArrowPathIcon","onContractCreated","setContractType","startDate","setStartDate","endDate","setEndDate","setSalary","workingHours","setWorkingHours","setPosition","employmentContract","toString","placeholder","CurrencyDollarIcon","step","startDateObj","endDateObj","contractData","CONTRACTS","onCertificateUpdated","certificate","existingPdfUrl","setExistingPdfUrl","CERTIFICATE_DOWNLOAD","handleSubmit","updateData","put","CERTIFICATE","onContractUpdated","contract","CONTRACT_DOWNLOAD","CONTRACT","lifecycleId","onUpdate","isLegal","registrations","setRegistrations","arl","eps","pension","caja","editingType","setEditingType","formData","setFormData","status","registrationNumber","provider","registrationDate","notes","saving","setSaving","loadingRef","abortControllerRef","loadRegistrations","useCallback","abort","abortController","AbortController","registrationPromises","signal","aborted","registration","SOCIAL_SECURITY","timeout","_error$response","_error$message","code","warn","results","newRegistrations","forEach","_ref2","registrationType","number","registeredAt","completedAt","handleCancel","handleSave","resolve","setTimeout","_error$response2","_error$response2$data","getStatusIcon","CheckCircleIcon","ClockIcon","XCircleIcon","getStatusLabel","labelKey","getTypeLabel","isEditing","_objectSpread","handleEdit","PencilIcon","onOffboardingStarted","exitDate","setExitDate","exitReason","setExitReason","validationErrors","setValidationErrors","today","errors","selectedDate","maxDate","setFullYear","getFullYear","Object","keys","STATUS","renderForm","ExclamationTriangleIcon","htmlFor","prev","ArrowRightIcon","opacity","transition","pointerEvents","role","onOffboardingCompleted","offboardingTasks","confirmText","setConfirmText","completedTasks","task","allTasksCompleted","requiredConfirmText","isCompleted","_lifecycleData$lifecy","lifecycleData","setLifecycleData","certificates","setCertificates","contracts","setContracts","setOffboardingTasks","isCertificateCreateModalOpen","setIsCertificateCreateModalOpen","isContractCreateModalOpen","setIsContractCreateModalOpen","editingCertificate","setEditingCertificate","editingContract","setEditingContract","downloadingCertId","setDownloadingCertId","downloadingContractId","setDownloadingContractId","isOffboardingStartModalOpen","setIsOffboardingStartModalOpen","isOffboardingCompleteModalOpen","setIsOffboardingCompleteModalOpen","isEditContractDatesModalOpen","setIsEditContractDatesModalOpen","editingContractStartDate","setEditingContractStartDate","editingContractEndDate","setEditingContractEndDate","fetchDataRef","isMountedRef","retryTimeoutRef","statusChangeTimeoutRef","fetchData","force","arguments","_certsResponse$data","_contractsResponse$da","_lifecycleResponse$da","_lifecycleResponse$da2","_lifecycleResponse$da3","_lifecycleResponse$da4","certsResponse","contractsResponse","tasksResponse","TASKS","catch","allTasks","offboardingTaskTitles","filteredTasks","progress","percent","clearTimeout","handleEditContractDates","formatDate","dateString","year","month","day","socialSecurityRegistrations","BuildingOfficeIcon","clickable","config","onboarding","color","active","contract_change","offboarding","archived","getStatusBadge","onboardingStartedAt","onboardingCompletedAt","offboardingStartedAt","completed","total","width","totalTasks","Math","round","description","PlusIcon","cert","isLatest","generatedByUser","certId","responseType","blob","Blob","downloadUrl","link","document","createElement","href","download","body","appendChild","removeChild","handleDownloadCertificate","ArrowDownTrayIcon","toLocaleString","currency","contractId","handleDownloadContract","SocialSecurityEditor","CertificateCreationModal","ContractCreationModal","CertificateEditModal","ContractEditModal","OffboardingStartModal","OffboardingCompleteModal","CONTRACT_TYPES","UserManagementTab","handleError","handleErrorContext","useError","COUNTRIES","PAYROLL_COUNTRIES","LANGUAGES","users","setUsers","selectedUser","setSelectedUser","userFormData","setUserFormData","isEditingUser","setIsEditingUser","selectedRoles","setSelectedRoles","lifecycleRefreshKey","setLifecycleRefreshKey","isDebugMode","setIsDebugMode","roleWarning","setRoleWarning","roles","setRoles","loadingRoles","setLoadingRoles","branches","setBranches","loadingBranches","setLoadingBranches","selectedBranches","setSelectedBranches","activeUserTab","setActiveUserTab","userFilterTab","setUserFilterTab","isUploading","setIsUploading","documentListRef","isCreateModalOpen","setIsCreateModalOpen","newUserFormData","setNewUserFormData","email","password","allUsers","setAllUsers","fetchAllUsers","userApi","getAll","filterUsersByActiveStatus","sorted","sort","a","b","aUsername","username","bUsername","aFirstName","bFirstName","localeCompare","fetchUserDetails","logger","log","getById","birthday","roleIds","userRole","r","branchIds","branch","userBranch","branchId","fallbackRoles","permissions","roleApi","fetchRoles","branchApi","fetchBranches","handleUserInputChange","finalValue","toggleRole","isRoleSelected","newSelectedRoles","updateRoles","toggleBranch","isBranchSelected","newSelectedBranches","updateBranches","handleNewUserInputChange","handleCreateUser","match","create","newUser","prevUsers","_err$response5","_err$response5$data","UserCircleIcon","ShieldCheckIcon","MapPinIcon","_userFormData$usernam","_userFormData$email","dataToSend","bankDetails","gender","phoneNumber","language","hourlyRate","monthlySalary","payrollCountry","update","updatedData","_err$response2","_err$response4","_err$response3","_err$response3$data","errorMsg","handleDirectDocumentUpload","_documentListRef$curr","loadDocuments","_COUNTRIES$find","latestDoc","identificationDocuments","readOnly","country","c","documentType","passport","national_id","driving_license","residence_permit","work_permit","tax_id","social_security","documentNumber","expiryDate","issuingCountry","issuingAuthority","handleCancelEdit","currentUserId","localStorage","getItem","currentActiveStatus","newActiveStatus","selectedUserActive","updatePayload","updatedAllUsers","IdentificationDocumentList","some","ids","join","isFixedRole","xmlns","viewBox","fill","fillRule","d","clipRule","LifecycleView","alwaysVisiblePages","defaultPages","defaultTables","defaultButtons","tableToPageMapping","buttonToPageMapping","buttonToTableMapping","ROLES_TABLE_ID","STANDARD_ROLE_IDS","STANDARD_ROLE_NAMES","isStandardRole","roleName","RoleCard","onEdit","onDelete","onCopy","canEdit","canDelete","canCopy","DocumentDuplicateIcon","TrashIcon","allBranches","perm","accessLevel","slice","permission","entity","entityType","onRolesChange","onError","isModalOpen","setIsModalOpen","editingRole","setEditingRole","pageDisplayNames","useMemo","tableDisplayNames","buttonDisplayNames","page","table","button","hasPermission","searchTerm","setSearchTerm","isFilterModalOpen","setIsFilterModalOpen","setAllBranches","selectedBranchIds","setSelectedBranchIds","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","onErrorRef","errorContext","context","handleValidationError","fieldErrors","isAddPermissionModalOpen","setIsAddPermissionModalOpen","selectedPermission","setSelectedPermission","displayLimit","setDisplayLimit","component","action","filteredPermissions","category","ErrorCategory","PERMISSION","updateError","meta","cause","createError","resetForm","handleDelete","confirm","delete","deleteError","refreshError","handleCopyRole","copiedRoleData","prevRoles","prepareRoleForEditing","allPermissions","existingPermIndex","findIndex","p","_branchData$branches","branchData","getRoleBranches","setAllPagePermissions","newPermissions","permIndex","indexOf","setAllTablePermissions","setAllButtonPermissions","getActiveFilterCount","filteredAndSortedRoles","searchLower","roleNameLower","nameConditionValueLower","roleDescLower","descConditionValueLower","count","existingFilters","SAVED_FILTERS","BY_TABLE","alleFilter","tableId","createStandardFilters","filterContext","useFilterContext","loadFilters","applyFilterConditions","resetFilterConditions","handleFilterChange","defaultFilter","f","initialize","FunnelIcon","FilterPane","columns","label","onApply","onReset","savedConditions","savedOperators","SavedFilterTags","onSelectFilter","onFilterChange","defaultFilterName","prevLimit","ChevronDownIcon","index","tablePerm","aName","bName","priorityOrder","aIndex","bIndex","tableIndex","tablePermIndex","isTableActive","tableEntity","tableDisplayName","relatedButtons","buttonPerm","order","buttonIndex","buttonPermIndex","isButtonActive","buttonDisplayName","roomDescriptions","setRoomDescriptions","editingCategoryId","setEditingCategoryId","editForm","setEditForm","text","imageUrl","videoUrl","rooms","setRooms","loadingRooms","setLoadingRooms","loadRoomDescriptions","BRANCHES","ROOM_DESCRIPTIONS","RESERVATION","limit","categoryMap","Map","reservation","categoryId","roomNumber","isDorm","roomType","roomName","has","set","roomsArray","from","entries","loadRooms","updatedDescriptions","alert","room","rel","BranchCard","BRANCHES_TABLE_ID","BranchManagementTab","editingBranch","setEditingBranch","address","city","whatsappSettings","apiKey","apiSecret","phoneNumberId","ai","enabled","model","systemPrompt","rules","sources","temperature","maxTokens","lobbyPmsSettings","apiUrl","propertyId","syncEnabled","autoCreateTasks","lateCheckInThreshold","notificationChannels","autoSendInvitation","boldPaymentSettings","merchantId","environment","doorSystemSettings","clientId","clientSecret","lockIds","appName","emailSettings","smtpHost","smtpPort","smtpUser","smtpPass","smtpFromEmail","smtpFromName","imap","host","port","secure","folder","processedFolder","messageTemplates","checkInInvitation","en","whatsappTemplateName","whatsappTemplateParams","emailSubject","emailContent","es","de","checkInConfirmation","autoSendReservationInvitation","activeSettingsTab","setActiveSettingsTab","showSecrets","setShowSecrets","selectedTemplateType","setSelectedTemplateType","selectedLanguage","setSelectedLanguage","canCreate","sireSettings","autoRegisterOnCheckIn","propertyCode","existingWhatsapp","existingLobbyPms","existingBoldPayment","JSON","parse","existingDoorSystem","existingEmail","existingMessageTemplates","existingAutoSend","_hasEncryptedValues","handleCloseModal","UPDATE","CREATE","DELETE","filteredAndSortedBranches","branchNameLower","conditionValueLower","handleCreate","autoFocus","tab","whatsappApiKey","stroke","strokeLinecap","strokeLinejoin","strokeWidth","whatsappApiSecret","s","RoomDescriptionsSection","emailSmtpPass","emailImapPass","_formData$messageTemp","_formData$messageTemp2","currentTemplate","_formData$messageTemp3","_formData$messageTemp4","_formData$messageTemp5","_formData$messageTemp6","onProviderCreated","setName","phone","setPhone","setEmail","contactPerson","setContactPerson","setNotes","setBranchId","_branchesRes$data","branchesRes","checkScreenSize","TOUR_PROVIDERS","handleClose","onProviderUpdated","ProviderCard","TourProvidersTab","isEditModalOpen","setIsEditModalOpen","editingProvider","setEditingProvider","providers","setProviders","fetchProviders","_error$response$data","filteredProviders","_provider$contactPers","_provider$phone","_provider$email","_provider$notes","search","providerId","CreateTourProviderModal","newProvider","EditTourProviderModal","updatedProvider","TourType","onTourCreated","setTitle","setDescription","setType","OWN","setIsActive","duration","setDuration","setMaxParticipants","setMinParticipants","price","setPrice","setCurrency","location","setLocation","meetingPoint","setMeetingPoint","setIncludes","excludes","setExcludes","requirements","setRequirements","totalCommission","setTotalCommission","totalCommissionPercent","setTotalCommissionPercent","sellerCommissionPercent","setSellerCommissionPercent","sellerCommissionFixed","setSellerCommissionFixed","externalProviderId","setExternalProviderId","externalBookingUrl","setExternalBookingUrl","imageFile","setImageFile","imagePreview","setImagePreview","galleryFiles","setGalleryFiles","galleryPreviews","setGalleryPreviews","uploadingImage","setUploadingImage","tourProviders","setTourProviders","_API_ENDPOINTS$TOUR_P","_providersRes$data","providersRes","maxPart","minPart","EXTERNAL","tourData","createdTour","FormData","append","UPLOAD_IMAGE","headers","imgErr","UPLOAD_GALLERY","galleryErr","updatedResponse","_e$target$files","reader","FileReader","onloadend","readAsDataURL","alt","multiple","preview","_","removeGalleryImage","_tour$isActive","_tour$galleryUrls","onTourUpdated","getTourImageUrl","galleryUrls","getTourGalleryImageUrl","_tour$isActive2","_tour$galleryUrls2","handleImageChange","handleGalleryChange","removeMainImage","DELETE_IMAGE","currentGallery","DELETE_GALLERY_IMAGE","_response2","_response2$data","newIndex","_response3","_response3$data","setTour","isCreateBookingModalOpen","setIsCreateBookingModalOpen","loadTour","UsersIcon","createdBy","createdAt","format","locale","externalProvider","availableFrom","availableTo","CreateTourBookingModal","tourCount","selectedFields","setSelectedFields","exporting","setExporting","setFormat","availableFields","selectAll","deselectAll","field","toggleField","fieldId","fieldsParam","EXPORT","fields","stringify","csvContent","row","cell","initialImageIndex","tourTitle","currentImageIndex","setCurrentImageIndex","zoomLevel","setZoomLevel","imageLoading","setImageLoading","imageError","setImageError","images","handlePrevious","handleNext","handleZoomIn","handleZoomOut","handleZoomReset","handleKeyDown","key","shiftKey","currentImage","canGoPrevious","canGoNext","canZoomIn","canZoomOut","MagnifyingGlassMinusIcon","MagnifyingGlassPlusIcon","ChevronLeftIcon","transform","cursor","onLoad","handleImageLoad","handleImageError","ChevronRightIcon","TOURS_TABLE_ID","defaultTourColumnOrder","tourCardToTableMapping","ToursTab","toursLoading","setToursLoading","toursError","setToursError","tourSearchTerm","setTourSearchTerm","tourFilterConditions","setTourFilterConditions","tourFilterLogicalOperators","setTourFilterLogicalOperators","tourActiveFilterName","setTourActiveFilterName","tourSelectedFilterId","setTourSelectedFilterId","tourFilterLogicalOperatorsRef","isCreateTourModalOpen","setIsCreateTourModalOpen","isEditTourModalOpen","setIsEditTourModalOpen","isTourDetailsModalOpen","setIsTourDetailsModalOpen","isTourExportDialogOpen","setIsTourExportDialogOpen","lightboxOpen","setLightboxOpen","selectedTourForLightbox","setSelectedTourForLightbox","setInitialImageIndex","selectedTourId","setSelectedTourId","draggedColumn","setDraggedColumn","dragOverColumn","setDragOverColumn","generatingImages","setGeneratingImages","imageGenerationJobs","setImageGenerationJobs","pollingIntervalsRef","pollCountRef","settings","isLoading","isLoadingSettings","updateColumnOrder","updateHiddenColumns","toggleColumnVisibility","isColumnVisible","updateViewMode","updateSortConfig","useTableSettings","defaultColumnOrder","defaultHiddenColumns","defaultViewMode","tourTableSortConfig","sortConfig","direction","availableTourColumns","shortLabel","substring","tourFilterOnlyColumns","viewMode","cardMetadataOrder","columnOrder","cardMetadata","tableCol","cardMeta","getTourCardMetadataFromColumnOrder","hiddenCardMetadata","hiddenTableColumns","Set","add","getTourHiddenCardMetadata","hiddenColumns","visibleCardMetadata","loadTours","filterId","background","rawData","handleGenerateImages","GENERATE_IMAGES","mode","jobId","tourIdStr","setInterval","clearInterval","newJobs","GENERATE_IMAGES_STATUS","values","interval","applyTourFilterConditions","resetTourFilterConditions","handleTourFilterChange","initialLoadAttemptedRef","handleDragEnd","visibleColumnIds","validOrder","missingColumns","filteredAndSortedTours","filtered","cond","compareValue","abs","_tour$branch","branchName","createdByName","createdById","columnId","_tour$branch2","getTourSortValue","_tour$branch3","valueA","valueB","comparison","strA","strB","titleA","titleB","Squares2X2Icon","TableCellsIcon","TableColumnConfig","visibleColumns","onToggleColumnVisibility","tableColumn","onColumnOrderChange","newOrder","newTableOrder","Boolean","modalTitle","mainSortConfig","onMainSortChange","handleMainSortChange","showMainSort","col","scope","draggable","onDragStart","handleDragStart","onDragOver","handleDragOver","onDrop","handleDrop","dragIndex","hoverIndex","newColumnOrder","draggedColumn_","splice","onDragEnd","newDirection","handleTourSort","ArrowsUpDownIcon","colSpan","_tour$branch4","stopPropagation","TOGGLE_ACTIVE","_err$response2$data","InformationCircleIcon","PhotoIcon","CardGrid","_response4","_response4$data","CreateTourModal","EditTourModal","TourDetailsModal","TourExportDialog","TourImageLightbox","onSuccess","displayName","domain","setErrors","fetchCurrentUser","handleChange","newErrors","organizationService","createOrganization","submit","organizationName","searching","setSearching","organizations","setOrganizations","showDropdown","setShowDropdown","selectedOrganization","setSelectedOrganization","searchTimeoutRef","dropdownRef","handleClickOutside","contains","handleOrganizationInputChange","searchOrganizations","handleSelectOrganization","org","handleMessageChange","createJoinRequest","RoleConfigurationTab","React","DocumentConfigurationTab","SMTPConfigurationTab","ApiConfigurationTab","organization","logo","nit","organizationWithSettings","setOrganizationWithSettings","selectedCountry","setSelectedCountry","setNit","organizationLanguage","setOrganizationLanguage","useLanguage","selectedOrgLanguage","setSelectedOrgLanguage","savingOrgLanguage","setSavingOrgLanguage","logoFile","setLogoFile","logoPreview","setLogoPreview","orgWithSettings","getCurrentOrganization","orgSettings","langResponse","getOrganizationLanguage","langError","loadOrgLanguage","loadSettingsIfNeeded","handleLogoFileChange","base64String","updateOrganization","newLanguage","Suspense","fallback","onSave","getStatusColor","getStatusText","MY_JOIN_REQUESTS_TABLE_ID","MyJoinRequestsList","joinRequests","setJoinRequests","isFilterPanelOpen","setIsFilterPanelOpen","mountedRef","withdrawingId","setWithdrawingId","isMounted","timeoutId","ORGANIZATIONS","MY_JOIN_REQUESTS","requests","getMyJoinRequests","fetchMyJoinRequests","hour","minute","filteredJoinRequests","request","_request$message","orgName","reduce","acc","_request$message2","searchValue","msgValue","processor","processedAt","requestId","withdrawJoinRequest","req","_err$response4$data","handleWithdraw","ArrowUturnLeftIcon","OrganizationSettings","setOrganization","stats","setStats","loadingStats","setLoadingStats","isJoinModalOpen","setIsJoinModalOpen","canViewOrganization","canManageOrganization","refreshOrganization","useOrganization","fetchOrganization","includeSettings","statsData","getOrganizationStats","statsErr","hasOrganization","hasInitialLoadRef","UserPlusIcon","UserGroupIcon","subscriptionPlan","currentUsers","maxUsers","utilizationPercent","_count","EnvelopeIcon","invitations","ChartBarIcon","availableSlots","CreateOrganizationModal","handleCreateSuccess","JoinOrganizationModal","EditOrganizationModal","handleEditModalClose","handleEditSuccess","joinRequest","setAction","setRoleId","setResponse","organizationId","processJoinRequest","requester","JOIN_REQUESTS_TABLE_ID","JoinRequestsList","isProcessModalOpen","setIsProcessModalOpen","selectedRequest","setSelectedRequest","canViewJoinRequests","canManageJoinRequests","hasInitialLoad","joinRequestsCount","JOIN_REQUESTS","getJoinRequests","stack","fetchJoinRequests","_request$requester$em","requesterName","requesterEmail","_request$requester$em2","handleOpenProcessModal","ProcessJoinRequestModal","Organisation","canViewOrganisation","canViewUsers","canViewRoles","canViewBranches","canViewProviders","canViewOrg","activeTabState","setActiveTabState","providersViewMode","setProvidersViewMode","isInitialized","defaultTab","handleTabChange","TruckIcon","RoleManagementTab"],"sourceRoot":""}