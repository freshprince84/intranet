"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[350],{2023:(e,r,t)=>{t.d(r,{F:()=>c});var n=t(9379),o=t(5043),l=t(1923);const a=e=>"table_settings_".concat(e),s=async e=>{try{return(await l.A.get("/table-settings/".concat(e))).data}catch(r){console.error("Fehler beim Abrufen der Tabelleneinstellungen vom Server:",r);try{const r=a(e),t=localStorage.getItem(r);if(t)return JSON.parse(t)}catch(t){console.error("Fehler beim Laden aus localStorage:",t)}return{tableId:e,columnOrder:[],hiddenColumns:[]}}},i=async e=>{try{await l.A.post("/table-settings",e);const r=a(e.tableId);localStorage.setItem(r,JSON.stringify(e))}catch(r){console.error("Fehler beim Speichern der Tabelleneinstellungen auf dem Server:",r);try{const r=a(e.tableId);localStorage.setItem(r,JSON.stringify(e))}catch(t){console.error("Fehler beim Speichern im localStorage:",t)}}},c=(e,r)=>{const[t,l]=(0,o.useState)({tableId:e,columnOrder:(null===r||void 0===r?void 0:r.defaultColumnOrder)||[],hiddenColumns:(null===r||void 0===r?void 0:r.defaultHiddenColumns)||[]}),[a,c]=(0,o.useState)(!0),[d,u]=(0,o.useState)(null);(0,o.useEffect)((()=>{let t=!0;return(async()=>{try{c(!0);const n=await s(e);if(!t)return;console.log("Geladene Tabelleneinstellungen vom Server:",n),0===n.columnOrder.length&&null!==r&&void 0!==r&&r.defaultColumnOrder&&(n.columnOrder=r.defaultColumnOrder),!n.viewMode&&null!==r&&void 0!==r&&r.defaultViewMode&&(n.viewMode=r.defaultViewMode),console.log("Finale Tabelleneinstellungen nach Initialisierung:",n),l(n),u(null)}catch(n){if(!t)return;u(n instanceof Error?n:new Error("Fehler beim Laden der Einstellungen")),console.error("Fehler beim Laden der Tabelleneinstellungen:",n)}finally{t&&c(!1)}})(),()=>{t=!1}}),[e]);const g=(0,o.useCallback)((async e=>{try{const r=(0,n.A)((0,n.A)({},t),{},{columnOrder:e});l(r),await i(r)}catch(r){u(r instanceof Error?r:new Error("Fehler beim Speichern der Spaltenreihenfolge")),console.error("Fehler beim Speichern der Spaltenreihenfolge:",r)}}),[t]),h=(0,o.useCallback)((async e=>{try{const r=(0,n.A)((0,n.A)({},t),{},{hiddenColumns:e});l(r),await i(r)}catch(r){u(r instanceof Error?r:new Error("Fehler beim Speichern der versteckten Spalten")),console.error("Fehler beim Speichern der versteckten Spalten:",r)}}),[t]),f=(0,o.useCallback)((async e=>{try{let r;r=t.hiddenColumns.includes(e)?t.hiddenColumns.filter((r=>r!==e)):[...t.hiddenColumns,e];const o=(0,n.A)((0,n.A)({},t),{},{hiddenColumns:r});l(o),await i(o)}catch(r){u(r instanceof Error?r:new Error("Fehler beim \xc4ndern der Spaltenansicht")),console.error("Fehler beim \xc4ndern der Spaltenansicht:",r)}}),[t]),m=(0,o.useCallback)((async e=>{try{const r=(0,n.A)((0,n.A)({},t),{},{viewMode:e});l(r),await i(r)}catch(r){u(r instanceof Error?r:new Error("Fehler beim Speichern des View-Modes")),console.error("Fehler beim Speichern des View-Modes:",r)}}),[t]);return{settings:t,isLoading:a,error:d,updateColumnOrder:g,updateHiddenColumns:h,toggleColumnVisibility:f,isColumnVisible:e=>!t.hiddenColumns.includes(e),updateViewMode:m}}},6400:(e,r,t)=>{t.d(r,{Ac:()=>a,J1:()=>l,W5:()=>o,hw:()=>s});const n=(e,r)=>{const{operator:t,value:n}=r;if(void 0===n)return console.error("evaluateCondition: value ist undefined",r),!1;if(null==e&&null==n)return"equals"===t;if(null==e||null==n)return"notEquals"===t;let o="",l="";try{const r=null==e?"":"string"===typeof e?e:String(e);if("string"!==typeof r)return!1;const t=r.toLowerCase();if(void 0===t||null===t||"string"!==typeof t)return!1;o=t;const a=null==n?"":"string"===typeof n?n:String(n);if("string"!==typeof a)return!1;const s=a.toLowerCase();if(void 0===s||null===s||"string"!==typeof s)return!1;l=s}catch(a){return!1}if("string"!==typeof o||"string"!==typeof l||void 0===o||void 0===l||null===o||null===l)return!1;switch(t){case"equals":return o===l;case"notEquals":return o!==l;case"contains":return o.includes(l);case"startsWith":return o.startsWith(l);case"endsWith":if(void 0===o||null===o)return console.error("endsWith: strField ist undefined/null",{strField:o,strValue:l,fieldValue:e,value:n,condition:r}),!1;if(void 0===l||null===l)return console.error("endsWith: strValue ist undefined/null",{strField:o,strValue:l,fieldValue:e,value:n,condition:r}),!1;if("string"!==typeof o)return console.error("endsWith: strField ist kein String",{strField:o,typeof:typeof o,strValue:l,fieldValue:e,value:n,condition:r}),!1;if("string"!==typeof l)return console.error("endsWith: strValue ist kein String",{strField:o,strValue:l,typeof:typeof l,fieldValue:e,value:n,condition:r}),!1;try{return o.endsWith(l)}catch(a){return console.error("endsWith: Fehler bei endsWith-Aufruf",a,{strField:o,strValue:l,fieldValue:e,value:n,condition:r}),!1}case"before":case"after":{const r=new Date(e),o=new Date(n);return!isNaN(r.getTime())&&!isNaN(o.getTime())&&("before"===t?r<o:r>o)}case"greaterThan":case"lessThan":{const r=parseFloat(String(e)),o=parseFloat(String(n));return!isNaN(r)&&!isNaN(o)&&("greaterThan"===t?r>o:r<o)}default:return!0}},o=(e,r,t,o,l)=>0===r.length?e:e.filter((e=>{let a=!0;for(let s=0;s<r.length;s++){const i=r[s];let c=!1;if(l&&l[i.column]){const r=l[i.column](e,i);if(null!==r)c=r;else{const r=o(e,i.column);c=n(r,i)}}else{const r=o(e,i.column);c=n(r,i)}if(0===s)a=c;else{a="AND"===(t[s-1]||"AND")?a&&c:a||c}}return a})),l=(e,r)=>{if(!e)return!1;const t=new Date(e);if(isNaN(t.getTime()))return!1;const n=t.getUTCFullYear(),o=t.getUTCMonth(),l=t.getUTCDate(),a=new Date(n,o,l);let s;if("__TODAY__"===r.value){const e=new Date;e.setHours(0,0,0,0),s=e}else{const e=new Date(r.value);if(isNaN(e.getTime()))return!1;const t=e.getUTCFullYear(),n=e.getUTCMonth(),o=e.getUTCDate();s=new Date(t,n,o)}switch(r.operator){case"equals":return a.getTime()===s.getTime();case"before":return a<s;case"after":return a>s;default:return!0}},a=(e,r,t,n)=>{const o=t.value||"";if(o.startsWith("user-")){const r=parseInt(o.replace("user-",""),10);if(isNaN(r))return!1;const n=e===r;return"notEquals"===t.operator?!n:n}if(o.startsWith("role-")){const e=parseInt(o.replace("role-",""),10);if(isNaN(e))return!1;const n=r===e;return"notEquals"===t.operator?!n:n}if(""===o)return!0;if(void 0!==n){const e=n.toLowerCase(),r=o.toLowerCase();if("equals"===t.operator)return e===r;if("notEquals"===t.operator)return e!==r;if("contains"===t.operator)return e.includes(r)}return!1},s=(e,r,t,n,o,l)=>{const a=n.value||"";if(a.startsWith("user-")){const r=parseInt(a.replace("user-",""),10);if(isNaN(r))return!1;const o=e===r||t===r;return"notEquals"===n.operator?!o:o}if(a.startsWith("role-")){const e=parseInt(a.replace("role-",""),10);if(isNaN(e))return!1;const t=r===e;return"notEquals"===n.operator?!t:t}if(""===a)return!0;const s=a.toLowerCase();return"equals"===n.operator?(null===o||void 0===o?void 0:o.toLowerCase())===s||(null===l||void 0===l?void 0:l.toLowerCase())===s:"notEquals"===n.operator?(null===o||void 0===o?void 0:o.toLowerCase())!==s&&(null===l||void 0===l?void 0:l.toLowerCase())!==s:"contains"===n.operator&&(null!==(i=null===o||void 0===o||null===(c=o.toLowerCase())||void 0===c?void 0:c.includes(s))&&void 0!==i&&i||null!==(d=null===l||void 0===l||null===(u=l.toLowerCase())||void 0===u?void 0:u.includes(s))&&void 0!==d&&d);var i,c,d,u}},8897:(e,r,t)=>{t.d(r,{A:()=>f});var n=t(5043),o=t(4117),l=t(7030),a=t(9626),s=t(2311),i=t(9531),c=t(4832),d=t(1909),u=t(9422),g=t(579);const h=e=>{let{id:r,label:t,index:n,isVisible:d,isDragging:u,isOver:h,onDragStart:f,onDragOver:m,onDragEnd:v,onToggleVisibility:b,sortDirection:y,onSortDirectionChange:p,showSortDirection:x=!1,sortOrder:w}=e;const{t:C}=(0,o.Bd)();return(0,g.jsxs)("li",{draggable:!0,onDragStart:()=>f(n),onDragOver:e=>{e.preventDefault(),m(n)},onDragEnd:v,className:"flex items-center justify-between px-2.5 py-2 rounded-md transition-colors duration-150\n        ".concat(u?"opacity-50 bg-gray-100 dark:bg-gray-700":"","\n        ").concat(h?"border-t-2 border-blue-500 dark:border-blue-400":"","\n        ").concat(u||h?"":"hover:bg-gray-50 dark:hover:bg-gray-700"),children:[(0,g.jsxs)("div",{className:"flex items-center flex-1 min-w-0",children:[(0,g.jsx)(l.A,{className:"h-4 w-4 mr-2 text-gray-400 dark:text-gray-500 cursor-move flex-shrink-0"}),(0,g.jsxs)("span",{className:"text-sm dark:text-gray-300 flex items-center gap-2",children:[x&&void 0!==w&&d&&(0,g.jsx)("span",{className:"text-xs font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 px-1.5 py-0.5 rounded",children:w}),(0,g.jsx)("span",{children:t})]})]}),(0,g.jsxs)("div",{className:"flex items-center gap-1",children:[x&&d&&void 0!==y&&p&&(0,g.jsx)("button",{onClick:e=>{e.stopPropagation(),p(r,"asc"===y?"desc":"asc")},className:"inline-flex items-center justify-center p-1.5 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150",title:"".concat(C("tableColumn.sortDirection"),": ").concat(C("asc"===y?"tableColumn.ascending":"tableColumn.descending")," (").concat(C("tableColumn.clickToToggle"),")"),children:"asc"===y?(0,g.jsx)(a.A,{className:"h-4 w-4"}):(0,g.jsx)(s.A,{className:"h-4 w-4"})}),(0,g.jsx)("button",{onClick:()=>b(r),className:"inline-flex items-center justify-center p-1.5 rounded-full bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150",title:C(d?"tableColumn.hideColumn":"tableColumn.showColumn"),children:d?(0,g.jsx)(i.A,{className:"w-4 h-4 dark:text-gray-300"}):(0,g.jsx)(c.A,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"})})]})]})},f=e=>{let{columns:r,visibleColumns:t,columnOrder:l,onToggleColumnVisibility:a,onMoveColumn:s,onClose:i,buttonTitle:c,modalTitle:f,sortDirections:m={},onSortDirectionChange:v,showSortDirection:b=!1}=e;const{t:y}=(0,o.Bd)(),p=c||y("tableColumn.configure"),x=f||y("tableColumn.configure"),[w,C]=(0,n.useState)(!1),[N,S]=(0,n.useState)(null),[k,D]=(0,n.useState)(null),j=(0,n.useRef)(null),F=[...r].sort(((e,r)=>{const t=l.indexOf(e.id),n=l.indexOf(r.id);return-1===t?1:-1===n?-1:t-n})),T=e=>{S(e),D(e)},A=e=>{D(e)},E=()=>{null!==N&&null!==k&&N!==k&&s(N,k),S(null),D(null)},O=()=>{C(!1),i()};return(0,n.useEffect)((()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&O()};return w&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[w]),(0,g.jsxs)("div",{className:"relative",ref:j,children:[(0,g.jsx)("button",{className:"inline-flex items-center justify-center p-2 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150",onClick:()=>C(!w),title:p,children:b?(0,g.jsx)(d.A,{className:"w-5 h-5"}):(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:(0,g.jsx)("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5A.75.75 0 012 10z",clipRule:"evenodd"})})}),w&&(0,g.jsxs)("div",{className:"absolute right-0 mt-2 w-64 bg-white dark:bg-gray-800 rounded-md shadow-lg z-50 border border-gray-300 dark:border-gray-600",onDragOver:e=>e.preventDefault(),children:[(0,g.jsxs)("div",{className:"px-3 py-2.5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[(0,g.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:x}),(0,g.jsx)("button",{onClick:O,className:"inline-flex items-center justify-center p-2 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150",title:y("common.close"),children:(0,g.jsx)(u.A,{className:"w-5 h-5"})})]}),(0,g.jsx)("ul",{className:"px-2 py-1 max-h-64 overflow-y-auto",children:F.map(((e,r)=>{const n=F.filter((e=>t.includes(e.id))).findIndex((r=>r.id===e.id))+1,o=t.includes(e.id);return(0,g.jsx)(h,{id:e.id,label:e.label,index:r,isVisible:o,isDragging:N===r,isOver:k===r&&N!==r,onDragStart:T,onDragOver:A,onDragEnd:E,onToggleVisibility:a,sortDirection:b&&o?m[e.id]||"asc":void 0,onSortDirectionChange:b?v:void 0,showSortDirection:b,sortOrder:b&&o?n:void 0},e.id)}))})]})]})}}}]);
//# sourceMappingURL=350.5815557d.chunk.js.map