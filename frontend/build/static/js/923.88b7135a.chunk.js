"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[923],{637:(e,n,t)=>{t.d(n,{A:()=>r});t(5043);var o=t(579);const r=e=>{let{children:n,columns:t={mobile:1,tablet:1,desktop:1,largeDesktop:1},gap:r="md",className:i=""}=e;const a={sm:"gap-0.5",md:"gap-0.5",lg:"gap-1"}[r];return(0,o.jsx)("div",{className:"flex flex-col ".concat(a," ").concat(i),children:n})}},2023:(e,n,t)=>{t.d(n,{F:()=>c});var o=t(9379),r=t(5043),i=t(1923),a=t(8018);const s=e=>"table_settings_".concat(e),l=async e=>{try{return(await i.A.get("/table-settings/".concat(e))).data}catch(n){console.error("Fehler beim Abrufen der Tabelleneinstellungen vom Server:",n);try{const n=s(e),t=localStorage.getItem(n);if(t)return JSON.parse(t)}catch(t){console.error("Fehler beim Laden aus localStorage:",t)}return{tableId:e,columnOrder:[],hiddenColumns:[]}}},d=async e=>{try{await i.A.post("/table-settings",e);const n=s(e.tableId);localStorage.setItem(n,JSON.stringify(e))}catch(n){console.error("Fehler beim Speichern der Tabelleneinstellungen auf dem Server:",n);try{const n=s(e.tableId);localStorage.setItem(n,JSON.stringify(e))}catch(t){console.error("Fehler beim Speichern im localStorage:",t)}}},c=(e,n)=>{const[t,i]=(0,r.useState)({tableId:e,columnOrder:(null===n||void 0===n?void 0:n.defaultColumnOrder)||[],hiddenColumns:(null===n||void 0===n?void 0:n.defaultHiddenColumns)||[]}),[s,c]=(0,r.useState)(!0),[u,g]=(0,r.useState)(null);(0,r.useEffect)((()=>{let t=!0;return(async()=>{try{c(!0);const o=await l(e);if(!t)return;a.v.log("Geladene Tabelleneinstellungen vom Server:",o),0===o.columnOrder.length&&null!==n&&void 0!==n&&n.defaultColumnOrder&&(o.columnOrder=n.defaultColumnOrder),!o.viewMode&&null!==n&&void 0!==n&&n.defaultViewMode&&(o.viewMode=n.defaultViewMode);let r=!1;!o.sortConfig&&null!==n&&void 0!==n&&n.defaultSortConfig&&(o.sortConfig=n.defaultSortConfig,r=!0),a.v.log("Finale Tabelleneinstellungen nach Initialisierung:",o),i(o),g(null),r&&d(o).catch((e=>{g(e instanceof Error?e:new Error("Fehler beim Speichern der Standard-Sortierung")),console.error("Fehler beim Speichern der Standard-Sortierung:",e)}))}catch(o){if(!t)return;g(o instanceof Error?o:new Error("Fehler beim Laden der Einstellungen")),console.error("Fehler beim Laden der Tabelleneinstellungen:",o)}finally{t&&c(!1)}})(),()=>{t=!1}}),[e]);const h=(0,r.useCallback)((async e=>{try{const n=(0,o.A)((0,o.A)({},t),{},{columnOrder:e});i(n),await d(n)}catch(n){g(n instanceof Error?n:new Error("Fehler beim Speichern der Spaltenreihenfolge")),console.error("Fehler beim Speichern der Spaltenreihenfolge:",n)}}),[t]),m=(0,r.useCallback)((async e=>{try{i((n=>{const t=(0,o.A)((0,o.A)({},n),{},{hiddenColumns:e});return d(t).catch((e=>{g(e instanceof Error?e:new Error("Fehler beim Speichern der versteckten Spalten")),console.error("Fehler beim Speichern der versteckten Spalten:",e)})),t}))}catch(n){g(n instanceof Error?n:new Error("Fehler beim Speichern der versteckten Spalten")),console.error("Fehler beim Speichern der versteckten Spalten:",n)}}),[]),b=(0,r.useCallback)((async e=>{try{let n;n=t.hiddenColumns.includes(e)?t.hiddenColumns.filter((n=>n!==e)):[...t.hiddenColumns,e];const r=(0,o.A)((0,o.A)({},t),{},{hiddenColumns:n});i(r),await d(r)}catch(n){g(n instanceof Error?n:new Error("Fehler beim \xc4ndern der Spaltenansicht")),console.error("Fehler beim \xc4ndern der Spaltenansicht:",n)}}),[t]),f=(0,r.useCallback)((async e=>{try{i((n=>{const t=(0,o.A)((0,o.A)({},n),{},{viewMode:e});return d(t).catch((e=>{g(e instanceof Error?e:new Error("Fehler beim Speichern des View-Modes")),console.error("Fehler beim Speichern des View-Modes:",e)})),t}))}catch(n){g(n instanceof Error?n:new Error("Fehler beim Speichern des View-Modes")),console.error("Fehler beim Speichern des View-Modes:",n)}}),[]),p=(0,r.useCallback)((async e=>{fetch("http://127.0.0.1:7242/ingest/4b31729e-838f-41ed-a421-2153ac4e6c3c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"useTableSettings.ts:146",message:"updateSortConfig ENTRY",data:{newSortConfigKey:e.key,newSortConfigDirection:e.direction},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch((()=>{}));try{i((n=>{var t,r;fetch("http://127.0.0.1:7242/ingest/4b31729e-838f-41ed-a421-2153ac4e6c3c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"useTableSettings.ts:149",message:"updateSortConfig setSettings callback",data:{prevSortConfig:n.sortConfig,newSortConfigKey:e.key,newSortConfigDirection:e.direction},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch((()=>{}));const i=(0,o.A)((0,o.A)({},n),{},{sortConfig:e});return fetch("http://127.0.0.1:7242/ingest/4b31729e-838f-41ed-a421-2153ac4e6c3c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"useTableSettings.ts:151",message:"updateSortConfig returning updatedSettings",data:{updatedSortConfigKey:null===(t=i.sortConfig)||void 0===t?void 0:t.key,updatedSortConfigDirection:null===(r=i.sortConfig)||void 0===r?void 0:r.direction},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch((()=>{})),d(i).catch((e=>{g(e instanceof Error?e:new Error("Fehler beim Speichern der Sortierung")),console.error("Fehler beim Speichern der Sortierung:",e)})),i}))}catch(n){g(n instanceof Error?n:new Error("Fehler beim Speichern der Sortierung")),console.error("Fehler beim Speichern der Sortierung:",n)}}),[]);return{settings:t,isLoading:s,error:u,updateColumnOrder:h,updateHiddenColumns:m,toggleColumnVisibility:b,isColumnVisible:e=>!t.hiddenColumns.includes(e),updateViewMode:f,updateSortConfig:p}}},8897:(e,n,t)=>{t.d(n,{A:()=>h});var o=t(5043),r=t(4117),i=t(9626),a=t(2311),s=t(1909),l=t(9531),d=t(4832),c=t(7591),u=t(579);const g=e=>{let{id:n,label:t,index:o,isVisible:c,onToggleVisibility:g,sortDirection:h,onSortDirectionChange:m,showMainSort:b=!1,isMainSort:f=!1}=e;const{t:p}=(0,r.Bd)();return(0,u.jsxs)("li",{className:"flex items-center justify-between px-2.5 py-2 rounded-md transition-colors duration-150 hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,u.jsx)("div",{className:"flex items-center flex-1 min-w-0",children:(0,u.jsx)("span",{className:"text-sm dark:text-gray-300",children:t})}),(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[m&&(0,u.jsx)("button",{onClick:e=>{e.stopPropagation(),fetch("http://127.0.0.1:7242/ingest/4b31729e-838f-41ed-a421-2153ac4e6c3c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"TableColumnConfig.tsx:65",message:"Modal sort button click ENTRY",data:{columnId:n,isMainSort:f,sortDirection:h,willToggle:f&&void 0!==h},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"D"})}).catch((()=>{}));const t=f&&void 0!==h&&"asc"===h?"desc":"asc";fetch("http://127.0.0.1:7242/ingest/4b31729e-838f-41ed-a421-2153ac4e6c3c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"TableColumnConfig.tsx:70",message:"Modal sort button BEFORE onSortDirectionChange",data:{columnId:n,newDirection:t,isMainSort:f,sortDirection:h},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"D"})}).catch((()=>{})),m(n,t),fetch("http://127.0.0.1:7242/ingest/4b31729e-838f-41ed-a421-2153ac4e6c3c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"TableColumnConfig.tsx:73",message:"Modal sort button AFTER onSortDirectionChange",data:{called:!0},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"C"})}).catch((()=>{}))},className:"inline-flex items-center justify-center p-1.5 rounded-md transition-colors duration-150 ".concat(f?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-900/50":"bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300"),title:f&&void 0!==h?"".concat(p("tableColumn.mainSort"),": ").concat(p("asc"===h?"tableColumn.ascending":"tableColumn.descending")," (").concat(p("tableColumn.clickToToggle"),")"):"".concat(p("tableColumn.setMainSort")," (").concat(p("tableColumn.clickToSet"),")"),children:f&&"asc"===h?(0,u.jsx)(i.A,{className:"h-4 w-4"}):f&&"desc"===h?(0,u.jsx)(a.A,{className:"h-4 w-4"}):(0,u.jsx)(s.A,{className:"h-4 w-4"})}),(0,u.jsx)("button",{onClick:()=>g(n),className:"inline-flex items-center justify-center p-1.5 rounded-full bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150",title:p(c?"tableColumn.hideColumn":"tableColumn.showColumn"),children:c?(0,u.jsx)(l.A,{className:"w-4 h-4 dark:text-gray-300"}):(0,u.jsx)(d.A,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"})})]})]})},h=e=>{let{columns:n,visibleColumns:t,columnOrder:i,onToggleColumnVisibility:a,onMoveColumn:l,onClose:d,buttonTitle:h,modalTitle:m,mainSortConfig:b,onMainSortChange:f,showMainSort:p=!1,isOpen:y,onOpenChange:S}=e;const{t:v}=(0,r.Bd)(),C=o.useMemo((()=>b),[b]);o.useEffect((()=>{fetch("http://127.0.0.1:7242/ingest/4b31729e-838f-41ed-a421-2153ac4e6c3c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"TableColumnConfig.tsx:126",message:"TableColumnConfig render",data:{mainSortConfigKey:null===b||void 0===b?void 0:b.key,mainSortConfigDirection:null===b||void 0===b?void 0:b.direction,mainSortConfigIsUndefined:void 0===b,stableMainSortConfigKey:null===C||void 0===C?void 0:C.key,stableMainSortConfigDirection:null===C||void 0===C?void 0:C.direction,stableMainSortConfigIsUndefined:void 0===C,isOpen:void 0!==y?y:void 0,onMainSortChangeExists:!!f},timestamp:Date.now(),sessionId:"debug-session",runId:"run5",hypothesisId:"H"})}).catch((()=>{}))}),[b,C,y,f]);const x=h||v("tableColumn.configure"),w=m||v("tableColumn.configure"),[k,T]=(0,o.useState)(!1),I=void 0!==y?y:k,j=(0,o.useRef)(null),E=[...n].sort(((e,n)=>{const t=i.indexOf(e.id),o=i.indexOf(n.id);return-1===t?1:-1===o?-1:t-o})),O=(0,o.useCallback)((()=>{void 0!==y?null===S||void 0===S||S(!1):T(!1),null===d||void 0===d||d()}),[y,S,d]),M=(0,o.useCallback)((()=>{void 0!==y?null===S||void 0===S||S(!0):T(!0)}),[y,S]);return(0,o.useEffect)((()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&O()};return I&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[I,O]),(0,o.useEffect)((()=>{const e=e=>{"Escape"===e.key&&I&&O()};return I&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[I,O]),(0,o.useEffect)((()=>{I&&fetch("http://127.0.0.1:7242/ingest/4b31729e-838f-41ed-a421-2153ac4e6c3c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"TableColumnConfig.tsx:215",message:"BEFORE map - mainSortConfig check",data:{mainSortConfigKey:null===b||void 0===b?void 0:b.key,mainSortConfigDirection:null===b||void 0===b?void 0:b.direction,mainSortConfigIsUndefined:void 0===b,stableMainSortConfigKey:null===C||void 0===C?void 0:C.key,stableMainSortConfigDirection:null===C||void 0===C?void 0:C.direction,stableMainSortConfigIsUndefined:void 0===C,isOpen:I},timestamp:Date.now(),sessionId:"debug-session",runId:"run5",hypothesisId:"K"})}).catch((()=>{}))}),[I,b,C]),(0,u.jsxs)("div",{className:"relative",ref:j,children:[void 0===y&&(0,u.jsx)("button",{className:"inline-flex items-center justify-center p-2 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150",onClick:I?O:M,title:x,children:p?(0,u.jsx)(s.A,{className:"w-5 h-5"}):(0,u.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:(0,u.jsx)("path",{fillRule:"evenodd",d:"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5A.75.75 0 012 10z",clipRule:"evenodd"})})}),I&&(0,u.jsxs)("div",{className:"absolute right-0 mt-2 w-64 max-w-[calc(100vw-1rem)] bg-white dark:bg-gray-800 rounded-md shadow-lg z-50 border border-gray-300 dark:border-gray-600",role:"dialog","aria-modal":"true","aria-labelledby":"table-column-config-title",children:[(0,u.jsxs)("div",{className:"px-3 py-2.5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[(0,u.jsx)("h3",{id:"table-column-config-title",className:"text-sm font-semibold text-gray-900 dark:text-white",children:w}),(0,u.jsx)("button",{onClick:O,className:"inline-flex items-center justify-center p-2 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150",title:v("common.close"),children:(0,u.jsx)(c.A,{className:"w-5 h-5"})})]}),(0,u.jsx)("ul",{className:"px-2 py-1 max-h-64 overflow-y-auto",children:E.map(((e,n)=>{const o=t.includes(e.id),r=(null===C||void 0===C?void 0:C.key)===e.id,i=r?C.direction:void 0;fetch("http://127.0.0.1:7242/ingest/4b31729e-838f-41ed-a421-2153ac4e6c3c",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"TableColumnConfig.tsx:265",message:"Modal column render",data:{columnId:e.id,mainSortConfigKey:null===b||void 0===b?void 0:b.key,stableMainSortConfigKey:null===C||void 0===C?void 0:C.key,stableMainSortConfigDirection:null===C||void 0===C?void 0:C.direction,stableMainSortConfigIsUndefined:void 0===C,isMainSort:r,sortDirection:i,comparison:(null===C||void 0===C?void 0:C.key)+" === "+e.id},timestamp:Date.now(),sessionId:"debug-session",runId:"run5",hypothesisId:"I"})}).catch((()=>{}));const s=p&&f;return(0,u.jsx)(g,{id:e.id,label:e.label,index:n,isVisible:o,onToggleVisibility:a,sortDirection:i,onSortDirectionChange:s?f:void 0,showMainSort:p,isMainSort:r},e.id)}))})]})]})}}}]);
//# sourceMappingURL=923.88b7135a.chunk.js.map